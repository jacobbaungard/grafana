"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[5857],{96589:(Ye,pe,d)=>{d.d(pe,{w:()=>De});var f=d(32196),B=d(96540),he=d(40845);const X=10,De=({colorPalette:M,min:D,max:W,display:x,hoverValue:H,useStopsPercentage:Z})=>{const[q,P]=(0,B.useState)([]),[b,K]=(0,B.useState)({isShown:!1,value:0}),[G,ge]=(0,B.useState)(null),oe=(0,he.$j)(),F=ve(oe,q);(0,B.useEffect)(()=>{P(Y({colorArray:M,stops:X,useStopsPercentage:Z}))},[M,Z]);const Ve=z=>{const te=z.nativeEvent.offsetX,xe=z.currentTarget.offsetWidth,Se=Math.floor(te*100/xe+1),Le=Math.floor((W-D)*Se/100+D);K({isShown:!0,value:Le}),ge(Se)},ye=()=>{K({isShown:!1,value:0})};return(0,B.useEffect)(()=>{ge(H==null?null:c((H-D)/(W-D)))},[H,D,W]),B.createElement("div",{className:F.scaleWrapper,onMouseMove:Ve,onMouseLeave:ye},B.createElement("div",{className:F.scaleGradient},x&&(b.isShown||H!==void 0)&&B.createElement("div",{className:F.followerContainer},B.createElement("div",{className:F.follower,style:{left:`${G}%`}}))),x&&B.createElement("div",{className:F.followerContainer},B.createElement("div",{className:F.legendValues},B.createElement("span",{className:F.disabled},x(D)),B.createElement("span",{className:F.disabled},x(W))),G!=null&&(b.isShown||H!==void 0)&&B.createElement("span",{className:F.hoverValue,style:{left:`${G}%`}},x(H??b.value))))},Y=({colorArray:M,stops:D,useStopsPercentage:W=!0})=>{const x=M.length;if(W&&x<=20){const P=1/x*100;let b=0;const K=[];for(const G of M)b>0?K.push(`${G} ${b}%`):K.push(G),b+=P,K.push(`${G} ${b}%`);return K}const H=M[x-1],Z=Math.ceil(x/D),q=new Set;for(let P=0;P<x;P+=Z)q.add(M[P]);return q.add(H),[...q]};function c(M){return M>1?100:M<0?0:M*100}const ve=(M,D)=>({scaleWrapper:(0,f.css)({width:"100%",fontSize:"11px",opacity:1}),scaleGradient:(0,f.css)({background:`linear-gradient(90deg, ${D.join()})`,height:"9px",pointerEvents:"none",borderRadius:M.shape.radius.default}),legendValues:(0,f.css)({display:"flex",justifyContent:"space-between",pointerEvents:"none"}),hoverValue:(0,f.css)({position:"absolute",marginTop:"-14px",padding:"3px 15px",transform:"translateX(-50%)"}),followerContainer:(0,f.css)({position:"relative",pointerEvents:"none",whiteSpace:"nowrap"}),follower:(0,f.css)({position:"absolute",height:"13px",width:"13px",borderRadius:M.shape.radius.default,transform:"translateX(-50%) translateY(-50%)",border:`2px solid ${M.colors.text.primary}`,top:"5px"}),disabled:(0,f.css)({color:M.colors.text.disabled})})},26235:(Ye,pe,d)=>{d.r(pe),d.d(pe,{plugin:()=>ft});var f=d(96540),B=d(65158),he=d(37055),X=d(11261),De=d(27310),Y=d(32264),c=d(52622),ve=d(38248),M=d(11404),D=d(96589),W=d(27825),x=d(3290),H=d(32196),Z=d(94624),q=d(97152),P=d(40845),b=d(79041),K=d(67266),G=d(81297),ge=d(68268),oe=d(77455),F=d(62567),Ve=d(7874),ye=d(36613),z=d(41260),te=d(83195),xe=d(28240),Se=d(11389),Le=d(58749),We=d(52415),Me=d(79871),ze=d(14792),Ue=d(1819),je=d(21164),Je=d(22731),Xe=d(82915);function Ze(e,r,a,i,t,o,s){let u=e.current?.getContext("2d");if(u!=null){let l=o;for(;i[l-1]===i[o];)l--;let g=l+s,h=0,S=l;for(;S<g;){let Q=t[S];h=Math.max(h,Q),S++}let I=new Path2D,U=new Path2D;S=l;let A=0;for(;S<g;){let Q=t[S];if(Q>0){let V=Q/h,L=A/s,E=S===o?I:U;const R=r*L+1,N=r/s-1;E.rect(R,Math.round(a*(1-V)),N,Math.round(a*V))}S++,A++}u.clearRect(0,0,r,a),u.fillStyle="#2E3036",u.fill(U),u.fillStyle="#5794F2",u.fill(I)}}const Fe=(e,r)=>{const a=e.heatmapColors?.palette,i=e.heatmapColors?.values[r];let t;return i!=null&&(t=a[i]),{cellColor:t,colorPalette:a}},$e={year:1e3*60*60*24*365,month:1e3*60*60*24*30,week:1e3*60*60*24*7,day:1e3*60*60*24,h:1e3*60*60,m:1e3*60,s:1e3,ms:1},qe=new Set(["ms","s","m","h"]),_e=e=>{let r=1,a="ms";for(a in $e)if(e>=$e[a]){r=Math.floor(e/$e[a]);break}const t=r!==1&&!qe.has(a)?a+"s":a;return`${r} ${t}`},ke=(e,r,a)=>{let i;switch(r){case"x":i=a?e?.fields.find(({name:t})=>t==="x"||t==="xMin"||t==="xMax"):e?.fields[0];break;case"y":i=a?e?.fields.find(({name:t})=>t==="y"||t==="yMin"||t==="yMax"):e?.fields[1];break;case"count":i=a?e?.fields.find(({name:t})=>t==="count"):e?.fields[2];break}return i},Ie=(e,r)=>{let a=e.heatmap.fields,i=a.find(u=>u.name==="xMax"),t=a.find(u=>u.name==="yMin"),o=a.find(u=>u.name==="yMax"),s=i.config.interval;return{xBucketMin:i.values[r]-s,xBucketMax:i.values[r],yBucketMin:t.values[r],yBucketMax:o.values[r]}},et=e=>e.seriesIdx===2?f.createElement(Ue.e,{data:e.dataRef.current.exemplars,rowIndex:e.dataIdxs[2],header:"Exemplar",padding:8}):f.createElement(tt,{...e}),tt=({dataIdxs:e,dataRef:r,showHistogram:a,isPinned:i,showColorScale:t=!1,mode:o,annotate:s,maxHeight:u})=>{const n=e[1],l=r.current,[g]=(0,f.useState)(()=>l.heatmap?.meta?.type===z.m.HeatmapCells&&!(0,x.Nb)(l.heatmap)),h=ke(l.heatmap,"x",g),S=ke(l.heatmap,"y",g),I=ke(l.heatmap,"count",g),U=v=>h?.display?(0,te.cN)(h.display(v)):h?.type===X.PU.time?(0,ze.UA)().getCurrent()?.formatDate(v,"YYYY-MM-DD HH:mm:ss"):`${v}`,A=h.values,Q=S.values,V=I.values,L=(0,x.eE)(l.heatmap),E=S?.display?v=>(0,te.cN)(S.display(v)):v=>`${v}`;let R=h?.config.interval,N,p,_,$,O,ce=[];const ue=v=>v%(l.yBucketCount??1);let C=ue(n);const j=Math.floor(n/(l.yBucketCount??1)),T=(v=n)=>{if(L.yOrdinalDisplay){const y=l.yLayout===c.D7.le?C-1:C,k=l.yLayout===c.D7.le?C:C+1;N=y<0?L.yMinDisplay:`${L.yOrdinalDisplay[y]}`,p=`${L.yOrdinalDisplay[k]}`,(!L.yOrdinalLabel||Number.isNaN(+L.yOrdinalLabel[0]))&&(O=l.yLayout===c.D7.le?p:N)}else{const y=Q?.[C];if(l.yLayout===c.D7.le)if(p=`${y}`,l.yLog){let w=(l.yLog===2?Math.log2:Math.log10)(y)-1/l.yLogSplit;N=`${l.yLog**w}`}else N=`${y-l.yBucketSize}`;else if(N=`${y}`,l.yLog){let w=(l.yLog===2?Math.log2:Math.log10)(y)+1/l.yLogSplit;p=`${l.yLog**w}`}else p=`${y+l.yBucketSize}`}l.xLayout===c.D7.le?($=A[v],_=$-l.xBucketSize):(_=A[v],$=_+l.xBucketSize)};g?{xBucketMin:_,xBucketMax:$,yBucketMin:N,yBucketMax:p}=Ie(l,n):T();const{cellColor:ae,colorPalette:de}=Fe(l,n),ee=(v,y)=>{let k=[];for(let w=v;w<=y;w++){if(!V?.[w])continue;const ne=Fe(l,w).cellColor;J=me(w),g?{xBucketMin:_,xBucketMax:$,yBucketMin:N,yBucketMax:p}=Ie(l,w):(C=ue(w),T(w));const{label:gt,value:yt}=le()[0];k.push({label:gt,value:yt,color:ne??"#FFF",isActive:n===w})}return k},le=()=>{const v=o===c.$N.Multi&&!i;if(O)return v?[{label:`Name ${O}`,value:l.display(J)}]:[{label:"Name",value:O}];switch(l.yLayout){case c.D7.unknown:return v?[{label:E(N),value:l.display(J)}]:[{label:"",value:E(N)}]}return v?[{label:`Bucket ${E(N)}-${E(p)}`,value:l.display(J)}]:[{label:"Bucket",value:`${E(N)}-${E(p)}`}]},me=v=>V?.[v];let J=me(n);if(o===c.$N.Single||i){const v=R?[{label:"Duration",value:_e(R)}]:[];ce=[{label:(0,xe.Ct)(I,l.heatmap),value:l.display(J),color:ae??"#FFF",colorPlacement:Me.lJ.trailing,colorIndicator:Me.fX.value},...le(),...v]}if(o===c.$N.Multi&&!i){let v=h.values[n],y=n,k=n;for(;h.values[y-1]===v;)y--;for(;h.values[k+1]===v;)k++;ee(y,k).forEach(ne=>{ce.push({label:ne.label,value:ne.value,color:ne.color??"#FFF",colorIndicator:Me.fX.value,colorPlacement:Me.lJ.trailing,isActive:ne.isActive})})}let we;if(i){let v=[];const y=l.series?.fields[C+1];if(y!=null){const k=!y.config.custom?.hideFrom?.tooltip,w=(y.config.links?.length??0)>0;k&&w&&(v=(0,je.u)(y,j))}we=f.createElement(Le.S,{dataLinks:v,annotate:s})}let fe=(0,f.useRef)(null),Ke=264,Qe=64,Te=Math.round(Ke*ye.A.pxRatio),Ge=Math.round(Qe*ye.A.pxRatio);(0,f.useEffect)(()=>{a&&A!=null&&V!=null&&o===c.$N.Single&&Ze(fe,Te,Ge,A,V,n,l.yBucketCount)},[n]);const pt={label:"",value:U($)};let Ae=[];o===c.$N.Single&&(a&&!g&&Ae.push(f.createElement("canvas",{width:Te,height:Ge,ref:fe,style:{width:Ke+"px",height:Qe+"px"}})),de&&t&&Ae.push(f.createElement(D.w,{colorPalette:de,min:l.heatmapColors?.minValue,max:l.heatmapColors?.maxValue,display:l.display,hoverValue:J})));const ht=(0,P.of)(Je.$),vt=(0,P.$j)();return f.createElement("div",{className:ht.wrapper},f.createElement(We.A,{item:pt,isPinned:i}),f.createElement(Se.o,{items:ce,isPinned:i,scrollable:(0,Xe.T5)({mode:o,maxHeight:u}),maxHeight:u},Ae?.map((v,y)=>f.createElement("div",{key:y,style:{padding:`${vt.spacing(1)} 0`}},v))),we)};var Re=d(90708),at=d(73060),lt=d(57875),se=d(59809),ie=d(88891);function Pe(e,r,a,i,t,o=s=>s){if(!e?.length)return{};(0,xe.Fm)(e);const s=r?.find(n=>n.name==="exemplar");if(s?.fields.forEach(n=>{n.getLinks=(0,Re._M)(s,n,n.state?.scopedVars??{},o)}),a.calculate){if(Y.$.featureToggles.transformationsVariableSupport){const n={...a,calculation:{xBuckets:{...a.calculation?.xBuckets},yBuckets:{...a.calculation?.yBuckets}}};return n.calculation?.xBuckets?.value&&o!==void 0&&(n.calculation.xBuckets.value=o(n.calculation.xBuckets.value)),n.calculation?.yBuckets?.value&&o!==void 0&&(n.calculation.yBuckets.value=o(n.calculation.yBuckets.value)),Ne((0,x.VQ)(e,n.calculation??{}),s,n,i,t)}return Ne((0,x.VQ)(e,a.calculation??{}),s,a,i,t)}let u;for(const n of e)switch(n.meta?.type){case z.m.HeatmapCells:return(0,x.Nb)(n)?Ne(n,s,a,i,t):nt(n,s,a,i,t);case z.m.HeatmapRows:u=n}if(u==null)if(e.length>1)e.every(l=>!Number.isNaN((0,se.L)(l.fields[1].state?.displayName)))&&e.sort(se.Bm),u=(0,at.Fd)({frames:e,keepDisplayNames:!0});else{let n=e[0],l=n.fields.filter(h=>h.type===X.PU.number);l.every(h=>!Number.isNaN((0,se.L)(h.state?.displayName)))?(l.sort((h,S)=>(0,se.L)(h.state?.displayName)-(0,se.L)(S.state?.displayName)),u={...n,fields:[n.fields.find(h=>h.type===X.PU.time),...l]}):u=n}return u.fields.forEach(n=>{(n.config.links?.length??0)!==0&&(n.getLinks=(0,Re._M)(u,n,n.state?.scopedVars??{},o))}),{...Ne((0,x.yJ)({unit:a.yAxis?.unit,decimals:a.yAxis?.decimals,...a.rowsFrame,frame:u}),s,a,i,t),series:u}}const nt=(e,r,a,i,t)=>{if(e.meta?.type!==z.m.HeatmapCells||(0,x.Nb)(e))return{warning:"Expected sparse heatmap format",heatmap:e};Ce(e.fields[1],a.yAxis,t);const o=e.fields[3],s=Ce(o,a.cellValues,t);let[u,n]=(0,ie.g$)(o.values,a.color.min,a.color.max,a.filterValues?.le,a.filterValues?.ge);return{heatmap:e,heatmapColors:{palette:i,values:(0,ie.O4)(o.values,i,u,n),minValue:u,maxValue:n},exemplars:r,display:l=>(0,te.cN)(s(l))}},Ne=(e,r,a,i,t)=>{if(e.meta?.type!==z.m.HeatmapCells)return{warning:"Expected heatmap scanlines format",heatmap:e};if(e.fields.length<2||e.length<2)return{heatmap:e};const o=(0,x.eE)(e);let s,u,n;for(const p of e.fields)switch(p.name){case"y":u=p.name;case"yMin":case"yMax":{u||(u=p.name),o.yOrdinalDisplay==null&&Ce(p,a.yAxis,t);break}case"x":case"xMin":case"xMax":s=p.name;break;default:p.type===X.PU.number&&!n&&(n=p)}if(!u)return{warning:"Missing Y field",heatmap:e};if(!u)return{warning:"Missing X field",heatmap:e};if(!n)return{warning:"Missing value field",heatmap:e};const l=Ce(n,a.cellValues,t),g=e.fields[0].values,h=e.fields[1].values,S=g.length;let I=S-h.lastIndexOf(h[0]),U=S/I,A=h[1]-h[0],Q=g[I]-g[0],[V,L]=(0,ie.g$)(n.values,a.color.min,a.color.max,a.filterValues?.le,a.filterValues?.ge),E=a.calculation?.xBuckets,R=a.calculation?.yBuckets;return{heatmap:e,heatmapColors:{palette:i,values:(0,ie.O4)(n.values,i,V,L),minValue:V,maxValue:L},exemplars:r?.length?r:void 0,xBucketSize:Q,yBucketSize:A,xBucketCount:U,yBucketCount:I,yLog:R?.scale?.log??0,xLog:E?.scale?.log??0,xLogSplit:E?.scale?.log?+(E?.value??"1"):1,yLogSplit:R?.scale?.log?+(R?.value??"1"):1,xLayout:s==="xMax"?c.D7.le:s==="xMin"?c.D7.ge:c.D7.unknown,yLayout:u==="yMax"?c.D7.le:u==="yMin"?c.D7.ge:c.D7.unknown,display:p=>(0,te.cN)(l(p))}};function Ce(e,r,a){if(r?.unit?.length||r?.decimals!=null){const{unit:i,decimals:t}=r;e.display=void 0,e.config={...e.config},i?.length&&(e.config.unit=i),t!=null&&(e.config.decimals=t)}return e.display||(e.display=(0,lt.J)({field:e,theme:a})),e.display}var Oe=d(21313),ot=d(37634),He=d(84140),m=d(52995);const re=[{name:"BrBG",invert:"always"},{name:"PiYG",invert:"always"},{name:"PRGn",invert:"always"},{name:"PuOr",invert:"always"},{name:"RdBu",invert:"always"},{name:"RdGy",invert:"always"},{name:"RdYlBu",invert:"always"},{name:"RdYlGn",invert:"always"},{name:"Spectral",invert:"always"},{name:"Blues",invert:"dark"},{name:"Greens",invert:"dark"},{name:"Greys",invert:"dark"},{name:"Oranges",invert:"dark"},{name:"Purples",invert:"dark"},{name:"Reds",invert:"dark"},{name:"Turbo",invert:"light"},{name:"Cividis",invert:"light"},{name:"Viridis",invert:"light"},{name:"Magma",invert:"light"},{name:"Inferno",invert:"light"},{name:"Plasma",invert:"light"},{name:"Warm",invert:"light"},{name:"Cool",invert:"light"},{name:"Cubehelix",invert:"light",name2:"CubehelixDefault"},{name:"BuGn",invert:"dark"},{name:"BuPu",invert:"dark"},{name:"GnBu",invert:"dark"},{name:"OrRd",invert:"dark"},{name:"PuBuGn",invert:"dark"},{name:"PuBu",invert:"dark"},{name:"PuRd",invert:"dark"},{name:"RdPu",invert:"dark"},{name:"YlGnBu",invert:"dark"},{name:"YlGn",invert:"dark"},{name:"YlOrBr",invert:"dark"},{name:"YlOrRd",invert:"dark"},{name:"Rainbow",invert:"always"},{name:"Sinebow",invert:"always"}],st=re.find(e=>e.name==="Spectral");function Be(e,r){const a={...m.KQ.color,...e},i=[],t=(a.steps??128)-1;if(e.mode===m.P7.Opacity){const o=(0,He.A)(r.visualization.getColorByName(e.fill)).toPercentageRgb(),s=a.scale===m.uM.Exponential?Oe.scalePow().exponent(a.exponent).domain([0,1]).range([0,1]):Oe.scaleLinear().domain([0,1]).range([0,1]);for(let u=0;u<=t;u++)o.a=s(u/t),i.push((0,He.A)(o).toString("hex8"))}else{const o=re.find(n=>n.name===a.scheme)??st;let s="interpolate"+(o.name2??o.name);const u=ot[s];for(let n=0;n<=t;n++){let l=u(n/t),g=l.indexOf("rgb")===0?"#"+[...l.matchAll(/\d+/g)].map(h=>(+h[0]).toString(16).padStart(2,"0")).join(""):l;i.push(g)}(o.invert==="always"||o.invert==="dark"&&r.isDark||o.invert==="light"&&r.isLight)&&i.reverse(),e.reverse&&i.reverse()}return i}const it=({data:e,id:r,timeRange:a,timeZone:i,width:t,height:o,options:s,fieldConfig:u,eventBus:n,onChangeTimeRange:l,replaceVariables:g})=>{const h=(0,P.$j)(),S=(0,P.of)(rt),{sync:I,eventsScope:U,canAddAnnotations:A,onSelectRange:Q}=(0,b.d2)(),V=I?.()??Z.y.Off,[L,E]=(0,f.useState)(null);let R=(0,f.useRef)(a);R.current=a;const N=(0,f.useMemo)(()=>Be(s.color,h),[s.color,h]),p=(0,f.useMemo)(()=>{try{return Pe(e.series,e.annotations,s,N,h,g)}catch(C){return{warning:`${C}`}}},[e.series,e.annotations,s,N,h,g]),_=(0,f.useMemo)(()=>{let C=[],j=[];const T=(0,x.eE)(p.heatmap);return p.exemplars?.length&&(C=p.exemplars?.fields[0].values,T.yMatchWithLabel&&T.yOrdinalDisplay!=null?j=(p.exemplars?.fields.find(ee=>ee.name===T.yMatchWithLabel).values).map(ee=>T.yOrdinalLabel?.indexOf(ee)):j=p.exemplars?.fields[1].values),[null,p.heatmap?.fields.map(ae=>ae.values),[C,j]]},[p.heatmap,p.exemplars]),$=(0,f.useRef)(p);$.current=p;const O=(0,f.useMemo)(()=>{const C=$.current?.heatmap?.fields[1].config?.custom?.scaleDistribution;return(0,ie.Mv)({dataRef:$,theme:h,timeZone:i,getTimeRange:()=>R.current,cellGap:s.cellGap,hideLE:s.filterValues?.le,hideGE:s.filterValues?.ge,exemplarColor:s.exemplars?.color??"rgba(255,0,255,0.7)",yAxisConfig:s.yAxis,ySizeDivisor:C?.type===c.L4.Log?+(s.calculation?.yBuckets?.value||1):1,selectionMode:s.selectionMode})},[s,i,e.structureRev,V]),ce=()=>!p.heatmap||!s.legend.show?null:f.createElement(K.KU.Legend,{placement:"bottom",maxHeight:"20%"},f.createElement("div",{className:S.colorScaleWrapper},f.createElement(D.w,{hoverValue:void 0,colorPalette:N,min:$.current.heatmapColors?.minValue,max:$.current.heatmapColors?.maxValue,display:p.display})));if(p.warning||!p.heatmap)return f.createElement(q.a,{panelId:r,fieldConfig:u,data:e,needsNumberField:!0,message:p.warning});const ue=!!(A&&A());return f.createElement(f.Fragment,null,f.createElement(K.KU,{width:t,height:o,legend:ce()},(C,j)=>f.createElement(G.Z,{key:O.uid,config:O,data:_,width:C,height:j},V!==Z.y.Off&&f.createElement(ge.K,{config:O,eventBus:n,frame:p.series??p.heatmap}),s.tooltip.mode!==c.$N.None&&f.createElement(oe.xl,{config:O,hoverMode:s.tooltip.mode===c.$N.Single?oe.b3.xOne:oe.b3.xAll,queryZoom:l,onSelectRange:Q,syncMode:V,syncScope:U,render:(T,ae,de,ee,le,me,J)=>{if(ue&&me!=null){E(me),le();return}const we=()=>{let fe=T.posToVal(T.cursor.left,"x");E({from:fe,to:fe}),le()};return f.createElement(et,{mode:J?c.$N.Multi:s.tooltip.mode,dataIdxs:ae,seriesIdx:de,dataRef:$,isPinned:ee,dismiss:le,showHistogram:s.tooltip.yHistogram,showColorScale:s.tooltip.showColorScale,panelData:e,annotate:ue?we:void 0,maxHeight:s.tooltip.maxHeight})},maxWidth:s.tooltip.maxWidth}),f.createElement(F.W,{annotations:e.annotations??[],config:O,timeZone:i,newRange:L,setNewRange:E,canvasRegionRendering:!1}),f.createElement(Ve.U,{config:O,onChangeTimeRange:l}))))},rt=()=>({colorScaleWrapper:(0,H.css)({marginLeft:"25px",padding:"10px 0",maxWidth:"300px"})}),ct=e=>{if(Object.keys(e.options??{}).length===0)return be(e,"heatmap",{angular:e},e.fieldConfig);let r=e.options?.tooltip?.show;return r!==void 0&&(r===!0?e.options.tooltip.mode=c.$N.Single:r===!1&&(e.options.tooltip.mode=c.$N.None),delete e.options.tooltip?.show),e.options},be=(e,r,a,i)=>{if(r==="heatmap"&&a.angular){const{fieldConfig:t,options:o}=ut({...a.angular,fieldConfig:i});return e.fieldConfig=t,o}if(r==="heatmap-new"){const{bucketFrame:t,...o}=e.options;return t?{...o,rowsFrame:t}:e.options}return{}};function ut(e){const r={defaults:{},overrides:[]},a=e.dataFormat!=="tsbuckets",i={...m.KQ.calculation},t={logBase:1,...e.yAxis};a&&(e.xBucketSize?i.xBuckets={mode:c.J1.Size,value:`${e.xBucketSize}`}:e.xBucketNumber&&(i.xBuckets={mode:c.J1.Count,value:`${e.xBucketNumber}`}),e.yBucketSize?i.yBuckets={mode:c.J1.Size,value:`${e.yBucketSize}`}:e.xBucketNumber&&(i.yBuckets={mode:c.J1.Count,value:`${e.yBucketNumber}`}),t.logBase>1&&(i.yBuckets={mode:c.J1.Count,value:+t.splitFactor>0?`${t.splitFactor}`:void 0,scale:{type:c.L4.Log,log:t.logBase}}));const o=Ee(e.cards?.cardPadding,2),s={calculate:a,calculation:i,color:{...m.KQ.color,steps:128},cellGap:o||1,cellRadius:Ee(e.cards?.cardRound),yAxis:{axisPlacement:t.show===!1?c.vM.Hidden:c.vM.Left,reverse:!!e.reverseYBuckets,axisWidth:Ee(t.width),min:t.min,max:t.max,unit:t.format,decimals:t.decimals},cellValues:{decimals:Ee(e.tooltipDecimals)},rowsFrame:{layout:dt(e.yBucketBound)},legend:{show:!!e.legend?.show},showValue:c.yL.Never,tooltip:{mode:e.tooltip?.show?c.$N.Single:c.$N.None,yHistogram:!!e.tooltip?.showHistogram},exemplars:{...m.KQ.exemplars}};e.hideZeroBuckets&&(s.filterValues={...m.KQ.filterValues});const u=e.color??{};switch(u?.mode){case"spectrum":{s.color.mode=m.P7.Scheme;const n=u.colorScheme;let l=re.find(g=>g.name===n);l||(l=re.find(g=>n.indexOf(g.name)>=0)),s.color.scheme=l?l.name:m.KQ.color.scheme;break}case"opacity":{s.color.mode=m.P7.Opacity,s.color.scale=u.scale;break}}return s.color.fill=u.cardColor,s.color.min=u.min,s.color.max=u.max,typeof u.min=="number"&&typeof u.max=="number"&&u.min>u.max&&(s.color.min=u.max,s.color.max=u.min,s.color.reverse=!0),{fieldConfig:r,options:s}}function dt(e){switch(e){case"upper":return c.D7.ge;case"lower":return c.D7.le;case"middle":return c.D7.unknown}return c.D7.auto}function Ee(e,r){if(e==null||e==="")return r;const a=+e;return isNaN(a)?r:a}class mt{getSuggestionsForData(r){const{dataSummary:a}=r;if(!r.data?.series||!a.hasData||a.timeFieldCount<1||a.numberFieldCount<2||a.numberFieldCount>10)return;const i=Be(m.KQ.color,Y.$.theme2),t=Pe(r.data.series,void 0,m.KQ,i,Y.$.theme2);!t||t.warning||r.getListAppender({name:"",pluginId:"heatmap",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}})}}const ft=new B.m(it).useFieldConfig({disableStandardOptions:Object.values(he.uo).filter(e=>e!==he.uo.Links),useCustomConfig:e=>{e.addCustomEditor({id:"scaleDistribution",path:"scaleDistribution",name:"Y axis scale",category:["Heatmap"],editor:ve.W,override:ve.W,defaultValue:{type:c.L4.Linear},shouldApply:r=>r.type===X.PU.number,process:De.hS,hideFromDefaults:!0}),(0,M.e)(e)}}).setPanelChangeHandler(be).setMigrationHandler(ct).setPanelOptions((e,r)=>{const a=r.options??m.KQ;let i=!1;if(r.data.length>0)try{const o=Be(a.color,Y.$.theme2),s=Pe(r.data,void 0,a,o,Y.$.theme2);i=(0,x.eE)(s.heatmap).yOrdinalDisplay!=null}catch{}let t=["Heatmap"];e.addRadio({path:"calculate",name:"Calculate from data",defaultValue:m.KQ.calculate,category:t,settings:{options:[{label:"Yes",value:!0},{label:"No",value:!1}]}}),a.calculate&&(0,W.J)("calculation.",e,a.calculation,t),t=["Y Axis"],e.addRadio({path:"yAxis.axisPlacement",name:"Placement",defaultValue:m.KQ.yAxis.axisPlacement??c.vM.Left,category:t,settings:{options:[{label:"Left",value:c.vM.Left},{label:"Right",value:c.vM.Right},{label:"Hidden",value:c.vM.Hidden}]}}).addUnitPicker({category:t,path:"yAxis.unit",name:"Unit",defaultValue:void 0,settings:{isClearable:!0}}).addNumberInput({category:t,path:"yAxis.decimals",name:"Decimals",settings:{placeholder:"Auto"}}),i||e.addNumberInput({path:"yAxis.min",name:"Min value",settings:{placeholder:"Auto"},category:t}).addTextInput({path:"yAxis.max",name:"Max value",settings:{placeholder:"Auto"},category:t}),e.addNumberInput({path:"yAxis.axisWidth",name:"Axis width",defaultValue:m.KQ.yAxis.axisWidth,settings:{placeholder:"Auto",min:5},category:t}).addTextInput({path:"yAxis.axisLabel",name:"Axis label",defaultValue:m.KQ.yAxis.axisLabel,settings:{placeholder:"Auto"},category:t}),a.calculate||e.addRadio({path:"rowsFrame.layout",name:"Tick alignment",defaultValue:m.KQ.rowsFrame?.layout??c.D7.auto,category:t,settings:{options:[{label:"Auto",value:c.D7.auto},{label:"Top (LE)",value:c.D7.le},{label:"Middle",value:c.D7.unknown},{label:"Bottom (GE)",value:c.D7.ge}]}}),e.addBooleanSwitch({path:"yAxis.reverse",name:"Reverse",defaultValue:m.KQ.yAxis.reverse===!0,category:t}),t=["Colors"],e.addRadio({path:"color.mode",name:"Mode",defaultValue:m.KQ.color.mode,category:t,settings:{options:[{label:"Scheme",value:m.P7.Scheme},{label:"Opacity",value:m.P7.Opacity}]}}),e.addColorPicker({path:"color.fill",name:"Color",defaultValue:m.KQ.color.fill,category:t,showIf:o=>o.color.mode===m.P7.Opacity}),e.addRadio({path:"color.scale",name:"Scale",defaultValue:m.KQ.color.scale,category:t,settings:{options:[{label:"Exponential",value:m.uM.Exponential},{label:"Linear",value:m.uM.Linear}]},showIf:o=>o.color.mode===m.P7.Opacity}),e.addSliderInput({path:"color.exponent",name:"Exponent",defaultValue:m.KQ.color.exponent,category:t,settings:{min:.1,max:2,step:.1},showIf:o=>o.color.mode===m.P7.Opacity&&o.color.scale===m.uM.Exponential}),e.addSelect({path:"color.scheme",name:"Scheme",description:"",defaultValue:m.KQ.color.scheme,category:t,settings:{options:re.map(o=>({value:o.name,label:o.name}))},showIf:o=>o.color.mode!==m.P7.Opacity}),e.addSliderInput({path:"color.steps",name:"Steps",defaultValue:m.KQ.color.steps,category:t,settings:{min:2,max:128,step:1}}).addBooleanSwitch({path:"color.reverse",name:"Reverse",defaultValue:m.KQ.color.reverse,category:t}).addCustomEditor({id:"__scale__",path:"__scale__",name:"",category:t,editor:()=>{const o=Be(a.color,Y.$.theme2);return f.createElement("div",null,f.createElement(D.w,{colorPalette:o,min:1,max:100}))}}),e.addNumberInput({path:"color.min",name:"Start color scale from value",defaultValue:m.KQ.color.min,settings:{placeholder:"Auto (min)"},category:t}).addNumberInput({path:"color.max",name:"End color scale at value",defaultValue:m.KQ.color.max,settings:{placeholder:"Auto (max)"},category:t}),t=["Cell display"],a.calculate||e.addTextInput({path:"rowsFrame.value",name:"Value name",defaultValue:m.KQ.rowsFrame?.value,settings:{placeholder:"Value"},category:t}),e.addUnitPicker({category:t,path:"cellValues.unit",name:"Unit",defaultValue:void 0,settings:{isClearable:!0}}).addNumberInput({category:t,path:"cellValues.decimals",name:"Decimals",settings:{placeholder:"Auto"}}),e.addSliderInput({name:"Cell gap",path:"cellGap",defaultValue:m.KQ.cellGap,category:t,settings:{min:0,max:25}}).addNumberInput({path:"filterValues.le",name:"Hide cells with values <=",defaultValue:m.KQ.filterValues?.le,settings:{placeholder:"None"},category:t}).addNumberInput({path:"filterValues.ge",name:"Hide cells with values >=",defaultValue:m.KQ.filterValues?.ge,settings:{placeholder:"None"},category:t}),t=["Tooltip"],e.addRadio({path:"tooltip.mode",name:"Tooltip mode",category:t,defaultValue:c.$N.Single,settings:{options:[{value:c.$N.Single,label:"Single"},{value:c.$N.Multi,label:"All"},{value:c.$N.None,label:"Hidden"}]}}),e.addBooleanSwitch({path:"tooltip.yHistogram",name:"Show histogram (Y axis)",defaultValue:m.KQ.tooltip.yHistogram,category:t,showIf:o=>o.tooltip.mode===c.$N.Single}),e.addBooleanSwitch({path:"tooltip.showColorScale",name:"Show color scale",defaultValue:m.KQ.tooltip.showColorScale,category:t,showIf:o=>o.tooltip.mode===c.$N.Single}),e.addNumberInput({path:"tooltip.maxWidth",name:"Max width",category:t,settings:{integer:!0}}),e.addNumberInput({path:"tooltip.maxHeight",name:"Max height",category:t,defaultValue:void 0,settings:{integer:!0},showIf:o=>o.tooltip?.mode===c.$N.Multi}),t=["Legend"],e.addBooleanSwitch({path:"legend.show",name:"Show legend",defaultValue:m.KQ.legend.show,category:t}),t=["Exemplars"],e.addColorPicker({path:"exemplars.color",name:"Color",defaultValue:m.KQ.exemplars.color,category:t})}).setSuggestionsSupplier(new mt).setDataSupport({annotations:!0})}}]);

//# sourceMappingURL=heatmapPanel.e9515b7f86e6e53a707c.js.map