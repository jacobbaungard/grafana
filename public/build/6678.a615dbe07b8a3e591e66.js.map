{"version":3,"file":"6678.a615dbe07b8a3e591e66.js","mappings":"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","sources":["webpack://grafana/./public/app/core/components/PanelTypeFilter/PanelTypeFilter.tsx","webpack://grafana/./public/app/core/components/Select/SortPicker.tsx","webpack://grafana/./public/app/features/library-panels/components/DeleteLibraryPanelModal/reducer.ts","webpack://grafana/./public/app/features/library-panels/components/DeleteLibraryPanelModal/actions.ts","webpack://grafana/./public/app/features/library-panels/components/DeleteLibraryPanelModal/DeleteLibraryPanelModal.tsx","webpack://grafana/./public/app/features/library-panels/components/LibraryPanelCard/LibraryPanelCard.tsx","webpack://grafana/./public/app/core/components/FolderFilter/FolderFilter.tsx","webpack://grafana/./public/app/features/library-panels/components/LibraryPanelsSearch/LibraryPanelsSearch.tsx","webpack://grafana/./public/app/features/library-panels/components/LibraryPanelsView/LibraryPanelsView.tsx","webpack://grafana/./public/app/features/library-panels/components/LibraryPanelsView/actions.ts","webpack://grafana/./public/app/features/library-panels/components/LibraryPanelsView/reducer.ts","webpack://grafana/./public/app/features/library-panels/styles.ts"],"sourcesContent":["import { css } from '@emotion/css';\nimport React, { useCallback, useMemo, useState } from 'react';\n\nimport { GrafanaTheme2, PanelPluginMeta, SelectableValue } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { Icon, Button, MultiSelect, useStyles2 } from '@grafana/ui';\nimport { getAllPanelPluginMeta, getVizPluginMeta, getWidgetPluginMeta } from 'app/features/panel/state/util';\n\nexport interface Props {\n  onChange: (plugins: PanelPluginMeta[]) => void;\n  maxMenuHeight?: number;\n  isWidget?: boolean;\n}\n\nexport const PanelTypeFilter = ({ onChange: propsOnChange, maxMenuHeight, isWidget = false }: Props): JSX.Element => {\n  const getPluginMetaData = (): PanelPluginMeta[] => {\n    if (config.featureToggles.vizAndWidgetSplit) {\n      return isWidget ? getWidgetPluginMeta() : getVizPluginMeta();\n    } else {\n      return getAllPanelPluginMeta();\n    }\n  };\n\n  const plugins = useMemo<PanelPluginMeta[]>(getPluginMetaData, [isWidget]);\n  const options = useMemo(\n    () =>\n      plugins\n        .map((p) => ({ label: p.name, imgUrl: p.info.logos.small, value: p }))\n        .sort((a, b) => a.label?.localeCompare(b.label)),\n    [plugins]\n  );\n  const [value, setValue] = useState<Array<SelectableValue<PanelPluginMeta>>>([]);\n  const onChange = useCallback(\n    (plugins: Array<SelectableValue<PanelPluginMeta>>) => {\n      const changedPlugins = plugins.filter((p) => p.value).map((p) => p.value!);\n      propsOnChange(changedPlugins);\n      setValue(plugins);\n    },\n    [propsOnChange]\n  );\n  const styles = useStyles2(getStyles);\n\n  const selectOptions = {\n    defaultOptions: true,\n    getOptionLabel: (i: SelectableValue<PanelPluginMeta>) => i.label,\n    getOptionValue: (i: SelectableValue<PanelPluginMeta>) => i.value,\n    noOptionsMessage: 'No Panel types found',\n    placeholder: 'Filter by type',\n    maxMenuHeight,\n    options,\n    value,\n    onChange,\n  };\n\n  return (\n    <div className={styles.container}>\n      {value.length > 0 && (\n        <Button\n          size=\"xs\"\n          icon=\"trash-alt\"\n          fill=\"text\"\n          className={styles.clear}\n          onClick={() => onChange([])}\n          aria-label=\"Clear types\"\n        >\n          Clear types\n        </Button>\n      )}\n      <MultiSelect<PanelPluginMeta> {...selectOptions} prefix={<Icon name=\"filter\" />} aria-label=\"Panel Type filter\" />\n    </div>\n  );\n};\n\nfunction getStyles(theme: GrafanaTheme2) {\n  return {\n    container: css`\n      label: container;\n      position: relative;\n      min-width: 180px;\n      flex-grow: 1;\n    `,\n    clear: css`\n      label: clear;\n      font-size: ${theme.spacing(1.5)};\n      position: absolute;\n      top: -${theme.spacing(4.5)};\n      right: 0;\n    `,\n  };\n}\n","import React from 'react';\nimport { useAsync } from 'react-use';\n\nimport { SelectableValue } from '@grafana/data';\nimport { Icon, Select } from '@grafana/ui';\nimport { DEFAULT_SORT } from 'app/features/search/constants';\nimport { getGrafanaSearcher } from 'app/features/search/service';\n\nexport interface Props {\n  onChange: (sortValue: SelectableValue) => void;\n  value?: string;\n  placeholder?: string;\n  getSortOptions?: () => Promise<SelectableValue[]>;\n  filter?: string[];\n  isClearable?: boolean;\n}\n\nconst defaultSortOptionsGetter = (): Promise<SelectableValue[]> => {\n  return getGrafanaSearcher().getSortOptions();\n};\n\nexport function SortPicker({ onChange, value, placeholder, filter, getSortOptions, isClearable }: Props) {\n  // Using sync Select and manual options fetching here since we need to find the selected option by value\n  const options = useAsync<() => Promise<SelectableValue[]>>(async () => {\n    const vals = await (getSortOptions ?? defaultSortOptionsGetter)();\n    if (filter) {\n      return vals.filter((v) => filter.includes(v.value));\n    }\n    return vals;\n  }, [getSortOptions, filter]);\n\n  if (options.loading) {\n    return null;\n  }\n\n  const isDesc = Boolean(value?.includes('desc') || value?.startsWith('-')); // bluge syntax starts with \"-\"\n  return (\n    <Select\n      key={value}\n      width={28}\n      onChange={onChange}\n      value={options.value?.find((opt) => opt.value === value) ?? null}\n      options={options.value}\n      aria-label=\"Sort\"\n      placeholder={placeholder ?? `Sort (Default ${DEFAULT_SORT.label})`}\n      prefix={<Icon name={isDesc ? 'sort-amount-down' : 'sort-amount-up'} />}\n      isClearable={isClearable}\n    />\n  );\n}\n","import { createAction } from '@reduxjs/toolkit';\nimport { AnyAction } from 'redux';\n\nimport { LoadingState } from '@grafana/data';\nimport { DashboardSearchItem } from 'app/features/search/types';\n\nexport interface DeleteLibraryPanelModalState {\n  loadingState: LoadingState;\n  dashboardTitles: string[];\n}\n\nexport const initialDeleteLibraryPanelModalState: DeleteLibraryPanelModalState = {\n  loadingState: LoadingState.Loading,\n  dashboardTitles: [],\n};\n\nexport const searchCompleted = createAction<{ dashboards: DashboardSearchItem[] }>(\n  'libraryPanels/delete/searchCompleted'\n);\n\nexport const deleteLibraryPanelModalReducer = (\n  state: DeleteLibraryPanelModalState = initialDeleteLibraryPanelModalState,\n  action: AnyAction\n): DeleteLibraryPanelModalState => {\n  if (searchCompleted.match(action)) {\n    return {\n      ...state,\n      dashboardTitles: action.payload.dashboards.map((d) => d.title),\n      loadingState: LoadingState.Done,\n    };\n  }\n\n  return state;\n};\n","import { getConnectedDashboards as apiGetConnectedDashboards } from '../../state/api';\nimport { DispatchResult, LibraryElementDTO } from '../../types';\n\nimport { searchCompleted } from './reducer';\n\nexport function getConnectedDashboards(libraryPanel: LibraryElementDTO): DispatchResult {\n  return async function (dispatch) {\n    const dashboards = await apiGetConnectedDashboards(libraryPanel.uid);\n    dispatch(searchCompleted({ dashboards }));\n  };\n}\n","import React, { FC, useEffect, useMemo, useReducer } from 'react';\n\nimport { LoadingState } from '@grafana/data';\nimport { Button, Modal, useStyles2 } from '@grafana/ui';\n\nimport { getModalStyles } from '../../styles';\nimport { LibraryElementDTO } from '../../types';\nimport { asyncDispatcher } from '../LibraryPanelsView/actions';\n\nimport { getConnectedDashboards } from './actions';\nimport { deleteLibraryPanelModalReducer, initialDeleteLibraryPanelModalState } from './reducer';\n\ninterface Props {\n  libraryPanel: LibraryElementDTO;\n  onConfirm: () => void;\n  onDismiss: () => void;\n}\n\nexport const DeleteLibraryPanelModal: FC<Props> = ({ libraryPanel, onDismiss, onConfirm }) => {\n  const styles = useStyles2(getModalStyles);\n  const [{ dashboardTitles, loadingState }, dispatch] = useReducer(\n    deleteLibraryPanelModalReducer,\n    initialDeleteLibraryPanelModalState\n  );\n  const asyncDispatch = useMemo(() => asyncDispatcher(dispatch), [dispatch]);\n  useEffect(() => {\n    asyncDispatch(getConnectedDashboards(libraryPanel));\n  }, [asyncDispatch, libraryPanel]);\n  const connected = Boolean(dashboardTitles.length);\n  const done = loadingState === LoadingState.Done;\n\n  return (\n    <Modal className={styles.modal} title=\"Delete library panel\" icon=\"trash-alt\" onDismiss={onDismiss} isOpen={true}>\n      {!done ? <LoadingIndicator /> : null}\n      {done ? (\n        <div>\n          {connected ? <HasConnectedDashboards dashboardTitles={dashboardTitles} /> : null}\n          {!connected ? <Confirm /> : null}\n\n          <Modal.ButtonRow>\n            <Button variant=\"secondary\" onClick={onDismiss} fill=\"outline\">\n              Cancel\n            </Button>\n            <Button variant=\"destructive\" onClick={onConfirm} disabled={connected}>\n              Delete\n            </Button>\n          </Modal.ButtonRow>\n        </div>\n      ) : null}\n    </Modal>\n  );\n};\n\nconst LoadingIndicator = () => <span>Loading library panel...</span>;\n\nconst Confirm = () => {\n  const styles = useStyles2(getModalStyles);\n\n  return <div className={styles.modalText}>Do you want to delete this panel?</div>;\n};\n\nconst HasConnectedDashboards: FC<{ dashboardTitles: string[] }> = ({ dashboardTitles }) => {\n  const styles = useStyles2(getModalStyles);\n  const suffix = dashboardTitles.length === 1 ? 'dashboard.' : 'dashboards.';\n  const message = `${dashboardTitles.length} ${suffix}`;\n  if (dashboardTitles.length === 0) {\n    return null;\n  }\n\n  return (\n    <div>\n      <p className={styles.textInfo}>\n        {'This library panel can not be deleted because it is connected to '}\n        <strong>{message}</strong>\n        {' Remove the library panel from the dashboards listed below and retry.'}\n      </p>\n      <table className={styles.myTable}>\n        <thead>\n          <tr>\n            <th>Dashboard name</th>\n          </tr>\n        </thead>\n        <tbody>\n          {dashboardTitles.map((title, i) => (\n            <tr key={`dash-title-${i}`}>\n              <td>{title}</td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n};\n","import { css } from '@emotion/css';\nimport React, { ReactElement, useState } from 'react';\nimport Skeleton from 'react-loading-skeleton';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { Icon, Link, useStyles2 } from '@grafana/ui';\nimport { SkeletonComponent, attachSkeleton } from '@grafana/ui/src/unstable';\nimport { getPanelPluginNotFound } from 'app/features/panel/components/PanelPluginError';\nimport { PanelTypeCard } from 'app/features/panel/components/VizTypePicker/PanelTypeCard';\n\nimport { LibraryElementDTO } from '../../types';\nimport { DeleteLibraryPanelModal } from '../DeleteLibraryPanelModal/DeleteLibraryPanelModal';\n\nexport interface LibraryPanelCardProps {\n  libraryPanel: LibraryElementDTO;\n  onClick: (panel: LibraryElementDTO) => void;\n  onDelete?: (panel: LibraryElementDTO) => void;\n  showSecondaryActions?: boolean;\n}\n\ntype Props = LibraryPanelCardProps & { children?: JSX.Element | JSX.Element[] };\n\nconst LibraryPanelCardComponent = ({ libraryPanel, onClick, onDelete, showSecondaryActions }: Props) => {\n  const [showDeletionModal, setShowDeletionModal] = useState(false);\n\n  const onDeletePanel = () => {\n    onDelete?.(libraryPanel);\n    setShowDeletionModal(false);\n  };\n\n  const panelPlugin = config.panels[libraryPanel.model.type] ?? getPanelPluginNotFound(libraryPanel.model.type).meta;\n\n  return (\n    <>\n      <PanelTypeCard\n        isCurrent={false}\n        title={libraryPanel.name}\n        description={libraryPanel.description}\n        plugin={panelPlugin}\n        onClick={() => onClick?.(libraryPanel)}\n        onDelete={showSecondaryActions ? () => setShowDeletionModal(true) : undefined}\n      >\n        <FolderLink libraryPanel={libraryPanel} />\n      </PanelTypeCard>\n      {showDeletionModal && (\n        <DeleteLibraryPanelModal\n          libraryPanel={libraryPanel}\n          onConfirm={onDeletePanel}\n          onDismiss={() => setShowDeletionModal(false)}\n        />\n      )}\n    </>\n  );\n};\n\nconst LibraryPanelCardSkeleton: SkeletonComponent<Pick<Props, 'showSecondaryActions'>> = ({\n  showSecondaryActions,\n  rootProps,\n}) => {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <PanelTypeCard.Skeleton hasDelete={showSecondaryActions} {...rootProps}>\n      <Skeleton containerClassName={styles.metaContainer} width={80} />\n    </PanelTypeCard.Skeleton>\n  );\n};\n\nexport const LibraryPanelCard = attachSkeleton(LibraryPanelCardComponent, LibraryPanelCardSkeleton);\n\ninterface FolderLinkProps {\n  libraryPanel: LibraryElementDTO;\n}\n\nfunction FolderLink({ libraryPanel }: FolderLinkProps): ReactElement | null {\n  const styles = useStyles2(getStyles);\n\n  if (!libraryPanel.meta?.folderUid && !libraryPanel.meta?.folderName) {\n    return null;\n  }\n\n  if (!libraryPanel.meta.folderUid) {\n    return (\n      <span className={styles.metaContainer}>\n        <Icon name={'folder'} size=\"sm\" />\n        <span>{libraryPanel.meta.folderName}</span>\n      </span>\n    );\n  }\n\n  return (\n    <span className={styles.metaContainer}>\n      <Link href={`/dashboards/f/${libraryPanel.meta.folderUid}`}>\n        <Icon name={'folder-upload'} size=\"sm\" />\n        <span>{libraryPanel.meta.folderName}</span>\n      </Link>\n    </span>\n  );\n}\n\nfunction getStyles(theme: GrafanaTheme2) {\n  return {\n    metaContainer: css({\n      display: 'flex',\n      alignItems: 'center',\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.bodySmall.fontSize,\n      paddingTop: theme.spacing(0.5),\n\n      svg: {\n        marginRight: theme.spacing(0.5),\n        marginBottom: 3,\n      },\n    }),\n  };\n}\n","import { css } from '@emotion/css';\nimport debounce from 'debounce-promise';\nimport React, { useCallback, useMemo, useState } from 'react';\n\nimport { GrafanaTheme2, SelectableValue } from '@grafana/data';\nimport { AsyncMultiSelect, Icon, Button, useStyles2 } from '@grafana/ui';\nimport { getBackendSrv } from 'app/core/services/backend_srv';\nimport { DashboardSearchItemType } from 'app/features/search/types';\nimport { FolderInfo, PermissionLevelString } from 'app/types';\n\nexport interface FolderFilterProps {\n  onChange: (folder: FolderInfo[]) => void;\n  maxMenuHeight?: number;\n}\n\nexport function FolderFilter({ onChange, maxMenuHeight }: FolderFilterProps): JSX.Element {\n  const styles = useStyles2(getStyles);\n  const [loading, setLoading] = useState(false);\n  const getOptions = useCallback((searchString: string) => getFoldersAsOptions(searchString, setLoading), []);\n  const debouncedLoadOptions = useMemo(() => debounce(getOptions, 300), [getOptions]);\n\n  const [value, setValue] = useState<Array<SelectableValue<FolderInfo>>>([]);\n  const onSelectOptionChange = useCallback(\n    (folders: Array<SelectableValue<FolderInfo>>) => {\n      const changedFolderIds = folders.filter((f) => Boolean(f.value)).map((f) => f.value!);\n      onChange(changedFolderIds);\n      setValue(folders);\n    },\n    [onChange]\n  );\n\n  return (\n    <div className={styles.container}>\n      {value.length > 0 && (\n        <Button\n          size=\"xs\"\n          icon=\"trash-alt\"\n          fill=\"text\"\n          className={styles.clear}\n          onClick={() => onChange([])}\n          aria-label=\"Clear folders\"\n        >\n          Clear folders\n        </Button>\n      )}\n      <AsyncMultiSelect\n        value={value}\n        onChange={onSelectOptionChange}\n        isLoading={loading}\n        loadOptions={debouncedLoadOptions}\n        maxMenuHeight={maxMenuHeight}\n        placeholder=\"Filter by folder\"\n        noOptionsMessage=\"No folders found\"\n        prefix={<Icon name=\"filter\" />}\n        aria-label=\"Folder filter\"\n        defaultOptions\n      />\n    </div>\n  );\n}\n\nasync function getFoldersAsOptions(\n  searchString: string,\n  setLoading: (loading: boolean) => void\n): Promise<Array<SelectableValue<FolderInfo>>> {\n  setLoading(true);\n\n  const params = {\n    query: searchString,\n    type: DashboardSearchItemType.DashFolder,\n    permission: PermissionLevelString.View,\n  };\n\n  // FIXME: stop using id from search and use UID instead\n  const searchHits = await getBackendSrv().search(params);\n  const options = searchHits.map((d) => ({ label: d.title, value: { uid: d.uid, title: d.title } }));\n  if (!searchString || 'general'.includes(searchString.toLowerCase())) {\n    options.unshift({ label: 'General', value: { uid: 'general', title: 'General' } });\n  }\n\n  setLoading(false);\n\n  return options;\n}\n\nfunction getStyles(theme: GrafanaTheme2) {\n  return {\n    container: css({\n      label: 'container',\n      position: 'relative',\n      minWidth: '180px',\n      flexGrow: 1,\n    }),\n    clear: css({\n      label: 'clear',\n      fontSize: theme.spacing(1.5),\n      position: 'absolute',\n      top: -theme.spacing(4.5),\n      right: 0,\n    }),\n  };\n}\n","import { css } from '@emotion/css';\nimport React, { useCallback, useState } from 'react';\nimport { useDebounce } from 'react-use';\n\nimport { GrafanaTheme2, PanelPluginMeta, SelectableValue } from '@grafana/data';\nimport { useStyles2, VerticalGroup, FilterInput } from '@grafana/ui';\nimport { FolderInfo } from 'app/types';\n\nimport { FolderFilter } from '../../../../core/components/FolderFilter/FolderFilter';\nimport { PanelTypeFilter } from '../../../../core/components/PanelTypeFilter/PanelTypeFilter';\nimport { SortPicker } from '../../../../core/components/Select/SortPicker';\nimport { DEFAULT_PER_PAGE_PAGINATION } from '../../../../core/constants';\nimport { LibraryElementDTO } from '../../types';\nimport { LibraryPanelsView } from '../LibraryPanelsView/LibraryPanelsView';\n\nexport enum LibraryPanelsSearchVariant {\n  Tight = 'tight',\n  Spacious = 'spacious',\n}\n\nexport interface LibraryPanelsSearchProps {\n  onClick: (panel: LibraryElementDTO) => void;\n  variant?: LibraryPanelsSearchVariant;\n  showSort?: boolean;\n  showPanelFilter?: boolean;\n  showFolderFilter?: boolean;\n  showSecondaryActions?: boolean;\n  currentPanelId?: string;\n  currentFolderUID?: string;\n  perPage?: number;\n}\n\nexport const LibraryPanelsSearch = ({\n  onClick,\n  variant = LibraryPanelsSearchVariant.Spacious,\n  currentPanelId,\n  currentFolderUID,\n  perPage = DEFAULT_PER_PAGE_PAGINATION,\n  showPanelFilter = false,\n  showFolderFilter = false,\n  showSort = false,\n  showSecondaryActions = false,\n}: LibraryPanelsSearchProps): JSX.Element => {\n  const styles = useStyles2(getStyles, variant);\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const [debouncedSearchQuery, setDebouncedSearchQuery] = useState('');\n  useDebounce(() => setDebouncedSearchQuery(searchQuery), 200, [searchQuery]);\n\n  const [sortDirection, setSortDirection] = useState<SelectableValue<string>>({});\n  const [folderFilter, setFolderFilter] = useState<string[]>(currentFolderUID ? [currentFolderUID] : []);\n  const [panelFilter, setPanelFilter] = useState<string[]>([]);\n\n  const sortOrFiltersVisible = showSort || showPanelFilter || showFolderFilter;\n  const verticalGroupSpacing = variant === LibraryPanelsSearchVariant.Tight ? 'lg' : 'xs';\n\n  return (\n    <div className={styles.container}>\n      <VerticalGroup spacing={verticalGroupSpacing}>\n        <div className={styles.gridContainer}>\n          <div className={styles.filterInputWrapper}>\n            <FilterInput\n              value={searchQuery}\n              onChange={setSearchQuery}\n              placeholder=\"Search by name or description\"\n              width={0}\n              escapeRegex={false}\n            />\n          </div>\n          {sortOrFiltersVisible && (\n            <SearchControls\n              showSort={showSort}\n              showPanelFilter={showPanelFilter}\n              showFolderFilter={showFolderFilter}\n              onSortChange={setSortDirection}\n              onFolderFilterChange={setFolderFilter}\n              onPanelFilterChange={setPanelFilter}\n              sortDirection={sortDirection.value}\n              variant={variant}\n            />\n          )}\n        </div>\n\n        <div className={styles.libraryPanelsView}>\n          <LibraryPanelsView\n            onClickCard={onClick}\n            searchString={debouncedSearchQuery}\n            sortDirection={sortDirection.value}\n            panelFilter={panelFilter}\n            folderFilter={folderFilter}\n            currentPanelId={currentPanelId}\n            showSecondaryActions={showSecondaryActions}\n            perPage={perPage}\n          />\n        </div>\n      </VerticalGroup>\n    </div>\n  );\n};\n\nfunction getStyles(theme: GrafanaTheme2, variant: LibraryPanelsSearchVariant) {\n  const tightLayout = css`\n    flex-direction: row;\n    row-gap: ${theme.spacing(1)};\n  `;\n  return {\n    filterInputWrapper: css`\n      flex-grow: ${variant === LibraryPanelsSearchVariant.Tight ? 1 : 'initial'};\n    `,\n    container: css`\n      width: 100%;\n      overflow-y: auto;\n      padding: ${theme.spacing(1)};\n    `,\n    libraryPanelsView: css`\n      width: 100%;\n    `,\n    gridContainer: css`\n      ${variant === LibraryPanelsSearchVariant.Tight ? tightLayout : ''};\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n      column-gap: ${theme.spacing(1)};\n      row-gap: ${theme.spacing(1)};\n      padding-bottom: ${theme.spacing(2)};\n    `,\n  };\n}\n\ninterface SearchControlsProps {\n  showSort: boolean;\n  showPanelFilter: boolean;\n  showFolderFilter: boolean;\n  sortDirection?: string;\n  onSortChange: (sortValue: SelectableValue) => void;\n  onFolderFilterChange: (folder: string[]) => void;\n  onPanelFilterChange: (plugins: string[]) => void;\n  variant?: LibraryPanelsSearchVariant;\n}\n\nconst SearchControls = React.memo(\n  ({\n    variant = LibraryPanelsSearchVariant.Spacious,\n    showSort,\n    showPanelFilter,\n    showFolderFilter,\n    sortDirection,\n    onSortChange,\n    onFolderFilterChange,\n    onPanelFilterChange,\n  }: SearchControlsProps) => {\n    const styles = useStyles2(getRowStyles, variant);\n    const panelFilterChanged = useCallback(\n      (plugins: PanelPluginMeta[]) => onPanelFilterChange(plugins.map((p) => p.id)),\n      [onPanelFilterChange]\n    );\n    const folderFilterChanged = useCallback(\n      (folders: FolderInfo[]) => onFolderFilterChange(folders.map((f) => f.uid ?? '')),\n      [onFolderFilterChange]\n    );\n\n    return (\n      <div className={styles.container}>\n        {showSort && <SortPicker value={sortDirection} onChange={onSortChange} filter={['alpha-asc', 'alpha-desc']} />}\n        {(showFolderFilter || showPanelFilter) && (\n          <div className={styles.filterContainer}>\n            {showFolderFilter && <FolderFilter onChange={folderFilterChanged} />}\n            {showPanelFilter && <PanelTypeFilter onChange={panelFilterChanged} />}\n          </div>\n        )}\n      </div>\n    );\n  }\n);\nSearchControls.displayName = 'SearchControls';\n\nfunction getRowStyles(theme: GrafanaTheme2, variant = LibraryPanelsSearchVariant.Spacious) {\n  const searchRowContainer = css`\n    display: flex;\n    gap: ${theme.spacing(1)};\n    flex-grow: 1;\n    flex-direction: row;\n    justify-content: end;\n  `;\n  const searchRowContainerTight = css`\n    ${searchRowContainer};\n    flex-grow: initial;\n    flex-direction: column;\n    justify-content: normal;\n  `;\n  const filterContainer = css`\n    display: flex;\n    flex-direction: row;\n    margin-left: auto;\n    gap: 4px;\n  `;\n  const filterContainerTight = css`\n    ${filterContainer};\n    flex-direction: column;\n    margin-left: initial;\n  `;\n\n  switch (variant) {\n    case LibraryPanelsSearchVariant.Spacious:\n      return {\n        container: searchRowContainer,\n        filterContainer: filterContainer,\n      };\n    case LibraryPanelsSearchVariant.Tight:\n      return {\n        container: searchRowContainerTight,\n        filterContainer: filterContainerTight,\n      };\n  }\n}\n","import { css } from '@emotion/css';\nimport React, { useMemo, useReducer } from 'react';\nimport { useDebounce } from 'react-use';\n\nimport { GrafanaTheme2, LoadingState } from '@grafana/data';\nimport { Pagination, Stack, useStyles2 } from '@grafana/ui';\n\nimport { LibraryElementDTO } from '../../types';\nimport { LibraryPanelCard } from '../LibraryPanelCard/LibraryPanelCard';\n\nimport { asyncDispatcher, deleteLibraryPanel, searchForLibraryPanels } from './actions';\nimport { changePage, initialLibraryPanelsViewState, libraryPanelsViewReducer } from './reducer';\n\ninterface LibraryPanelViewProps {\n  onClickCard: (panel: LibraryElementDTO) => void;\n  showSecondaryActions?: boolean;\n  currentPanelId?: string;\n  searchString: string;\n  sortDirection?: string;\n  panelFilter?: string[];\n  folderFilter?: string[];\n  perPage?: number;\n  isWidget?: boolean;\n}\n\nexport const LibraryPanelsView = ({\n  onClickCard,\n  searchString,\n  sortDirection,\n  panelFilter,\n  folderFilter,\n  showSecondaryActions,\n  currentPanelId: currentPanel,\n  perPage: propsPerPage = 40,\n  isWidget,\n}: LibraryPanelViewProps) => {\n  const styles = useStyles2(getPanelViewStyles);\n  const [{ libraryPanels, page, perPage, numberOfPages, loadingState, currentPanelId }, dispatch] = useReducer(\n    libraryPanelsViewReducer,\n    {\n      ...initialLibraryPanelsViewState,\n      currentPanelId: currentPanel,\n      perPage: propsPerPage,\n    }\n  );\n  const asyncDispatch = useMemo(() => asyncDispatcher(dispatch), [dispatch]);\n  useDebounce(\n    () =>\n      asyncDispatch(\n        searchForLibraryPanels({\n          searchString,\n          sortDirection,\n          panelFilter,\n          folderFilterUIDs: folderFilter,\n          page,\n          perPage,\n          currentPanelId,\n          isWidget,\n        })\n      ),\n    300,\n    [searchString, sortDirection, panelFilter, folderFilter, page, asyncDispatch]\n  );\n  const onDelete = ({ uid }: LibraryElementDTO) =>\n    asyncDispatch(\n      deleteLibraryPanel(uid, {\n        searchString,\n        sortDirection,\n        panelFilter,\n        folderFilterUIDs: folderFilter,\n        page,\n        perPage,\n      })\n    );\n  const onPageChange = (page: number) => asyncDispatch(changePage({ page }));\n\n  return (\n    <Stack direction=\"column\" wrap=\"nowrap\">\n      {loadingState === LoadingState.Loading ? (\n        <>\n          <LibraryPanelCard.Skeleton showSecondaryActions={showSecondaryActions} />\n          <LibraryPanelCard.Skeleton showSecondaryActions={showSecondaryActions} />\n          <LibraryPanelCard.Skeleton showSecondaryActions={showSecondaryActions} />\n        </>\n      ) : libraryPanels.length < 1 ? (\n        <p className={styles.noPanelsFound}>No library panels found.</p>\n      ) : (\n        libraryPanels?.map((item, i) => (\n          <LibraryPanelCard\n            key={`library-panel=${i}`}\n            libraryPanel={item}\n            onDelete={onDelete}\n            onClick={onClickCard}\n            showSecondaryActions={showSecondaryActions}\n          />\n        ))\n      )}\n      {libraryPanels.length ? (\n        <div className={styles.pagination}>\n          <Pagination\n            currentPage={page}\n            numberOfPages={numberOfPages}\n            onNavigate={onPageChange}\n            hideWhenSinglePage={true}\n          />\n        </div>\n      ) : null}\n    </Stack>\n  );\n};\n\nconst getPanelViewStyles = (theme: GrafanaTheme2) => {\n  return {\n    pagination: css({\n      alignSelf: 'center',\n      marginTop: theme.spacing(1),\n    }),\n    noPanelsFound: css({\n      label: 'noPanelsFound',\n      minHeight: 200,\n    }),\n  };\n};\n","import { AnyAction } from '@reduxjs/toolkit';\nimport { Dispatch } from 'react';\nimport { from, merge, of, Subscription, timer } from 'rxjs';\nimport { catchError, finalize, mapTo, mergeMap, share, takeUntil } from 'rxjs/operators';\n\nimport { PanelPluginMeta } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { LibraryPanel } from '@grafana/schema';\nimport { getAllPanelPluginMeta } from 'app/features/panel/state/util';\n\nimport { deleteLibraryPanel as apiDeleteLibraryPanel, getLibraryPanels } from '../../state/api';\n\nimport { initialLibraryPanelsViewState, initSearch, searchCompleted } from './reducer';\n\ntype DispatchResult = (dispatch: Dispatch<AnyAction>) => void;\ninterface SearchArgs {\n  perPage: number;\n  page: number;\n  searchString: string;\n  sortDirection?: string;\n  panelFilter?: string[];\n  folderFilterUIDs?: string[];\n  currentPanelId?: string;\n  isWidget?: boolean;\n}\n\nexport function searchForLibraryPanels(args: SearchArgs): DispatchResult {\n  // Functions to support filtering out library panels per plugin type that have skipDataQuery set to true\n\n  const findPluginMeta = (pluginMeta: PanelPluginMeta, libraryPanel: LibraryPanel) =>\n    pluginMeta.id === libraryPanel.type;\n\n  const filterLibraryPanels = (libraryPanels: LibraryPanel[], isWidget: boolean) => {\n    const pluginMetaList = getAllPanelPluginMeta();\n\n    return libraryPanels.filter((libraryPanel) => {\n      const matchingPluginMeta = pluginMetaList.find((pluginMeta) => findPluginMeta(pluginMeta, libraryPanel));\n      // widget mode filter\n      if (isWidget) {\n        return !!matchingPluginMeta?.skipDataQuery;\n      }\n      // non-widget mode filter\n      return !matchingPluginMeta?.skipDataQuery;\n    });\n  };\n\n  return function (dispatch) {\n    const subscription = new Subscription();\n    const dataObservable = from(\n      getLibraryPanels({\n        searchString: args.searchString,\n        perPage: args.perPage,\n        page: args.page,\n        excludeUid: args.currentPanelId,\n        sortDirection: args.sortDirection,\n        typeFilter: args.panelFilter,\n        folderFilterUIDs: args.folderFilterUIDs,\n      })\n    ).pipe(\n      //filter out library panels per plugin type that have skipDataQuery set to true\n      mergeMap((libraryPanelsResult) => {\n        const { elements: libraryPanels } = libraryPanelsResult;\n\n        if (config.featureToggles.vizAndWidgetSplit && args.isWidget !== undefined) {\n          const filteredLibraryPanels = filterLibraryPanels(libraryPanels, args.isWidget);\n          return of({ ...libraryPanelsResult, elements: filteredLibraryPanels });\n        }\n\n        return of({ ...libraryPanelsResult, elements: libraryPanels });\n      }),\n      mergeMap(({ perPage, elements: libraryPanels, page, totalCount }) =>\n        of(searchCompleted({ libraryPanels, page, perPage, totalCount }))\n      ),\n      catchError((err) => {\n        console.error(err);\n        return of(searchCompleted({ ...initialLibraryPanelsViewState, page: args.page, perPage: args.perPage }));\n      }),\n      finalize(() => subscription.unsubscribe()), // make sure we unsubscribe\n      share()\n    );\n\n    subscription.add(\n      // If 50ms without a response dispatch a loading state\n      // mapTo will translate the timer event into a loading state\n      // takeUntil will cancel the timer emit when first response is received on the dataObservable\n      merge(timer(50).pipe(mapTo(initSearch()), takeUntil(dataObservable)), dataObservable).subscribe(dispatch)\n    );\n  };\n}\n\nexport function deleteLibraryPanel(uid: string, args: SearchArgs): DispatchResult {\n  return async function (dispatch) {\n    try {\n      await apiDeleteLibraryPanel(uid);\n      searchForLibraryPanels(args)(dispatch);\n    } catch (e) {\n      console.error(e);\n    }\n  };\n}\n\nexport function asyncDispatcher(dispatch: Dispatch<AnyAction>) {\n  return function (action: any) {\n    if (action instanceof Function) {\n      return action(dispatch);\n    }\n    return dispatch(action);\n  };\n}\n","import { createAction } from '@reduxjs/toolkit';\nimport { AnyAction } from 'redux';\n\nimport { LoadingState } from '@grafana/data';\n\nimport { LibraryElementDTO } from '../../types';\n\nexport interface LibraryPanelsViewState {\n  loadingState: LoadingState;\n  libraryPanels: LibraryElementDTO[];\n  totalCount: number;\n  perPage: number;\n  page: number;\n  numberOfPages: number;\n  currentPanelId?: string;\n}\n\nexport const initialLibraryPanelsViewState: LibraryPanelsViewState = {\n  loadingState: LoadingState.Loading,\n  libraryPanels: [],\n  totalCount: 0,\n  perPage: 40,\n  page: 1,\n  numberOfPages: 0,\n  currentPanelId: undefined,\n};\n\nexport const initSearch = createAction('libraryPanels/view/initSearch');\nexport const searchCompleted = createAction<\n  Omit<LibraryPanelsViewState, 'currentPanelId' | 'searchString' | 'loadingState' | 'numberOfPages'>\n>('libraryPanels/view/searchCompleted');\n\nexport const changePage = createAction<Pick<LibraryPanelsViewState, 'page'>>('libraryPanels/view/changePage');\n\nexport const libraryPanelsViewReducer = (state: LibraryPanelsViewState, action: AnyAction) => {\n  if (initSearch.match(action)) {\n    return { ...state, loadingState: LoadingState.Loading };\n  }\n\n  if (searchCompleted.match(action)) {\n    const { libraryPanels, page, perPage, totalCount } = action.payload;\n    const numberOfPages = Math.ceil(totalCount / perPage);\n    return {\n      ...state,\n      libraryPanels,\n      perPage,\n      totalCount,\n      loadingState: LoadingState.Done,\n      numberOfPages,\n      page: page > numberOfPages ? page - 1 : page,\n    };\n  }\n\n  if (changePage.match(action)) {\n    return { ...state, page: action.payload.page };\n  }\n\n  return state;\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nexport function getModalStyles(theme: GrafanaTheme2) {\n  return {\n    myTable: css`\n      max-height: 204px;\n      overflow-y: auto;\n      margin-top: 11px;\n      margin-bottom: 28px;\n      border-radius: ${theme.shape.radius.default};\n      border: 1px solid ${theme.colors.action.hover};\n      background: ${theme.colors.background.primary};\n      color: ${theme.colors.text.secondary};\n      font-size: ${theme.typography.h6.fontSize};\n      width: 100%;\n\n      thead {\n        color: #538ade;\n        font-size: ${theme.typography.bodySmall.fontSize};\n      }\n\n      th,\n      td {\n        padding: 6px 13px;\n        height: ${theme.spacing(4)};\n      }\n\n      tbody > tr:nth-child(odd) {\n        background: ${theme.colors.background.secondary};\n      }\n    `,\n    noteTextbox: css`\n      margin-bottom: ${theme.spacing(4)};\n    `,\n    textInfo: css`\n      color: ${theme.colors.text.secondary};\n      font-size: ${theme.typography.size.sm};\n    `,\n    dashboardSearch: css`\n      margin-top: ${theme.spacing(2)};\n    `,\n    modal: css`\n      width: 500px;\n    `,\n    modalText: css`\n      font-size: ${theme.typography.h4.fontSize};\n      color: ${theme.colors.text.primary};\n      margin-bottom: ${theme.spacing(4)};\n      padding-top: ${theme.spacing(2)};\n    `,\n  };\n}\n"],"names":["PanelTypeFilter","propsOnChange","maxMenuHeight","isWidget","getPluginMetaData","plugins","options","p","a","b","value","setValue","onChange","changedPlugins","styles","getStyles","selectOptions","i","theme","defaultSortOptionsGetter","SortPicker","placeholder","filter","getSortOptions","isClearable","vals","v","isDesc","opt","initialDeleteLibraryPanelModalState","searchCompleted","deleteLibraryPanelModalReducer","state","action","d","getConnectedDashboards","libraryPanel","dispatch","dashboards","api","DeleteLibraryPanelModal","onDismiss","onConfirm","dashboardTitles","loadingState","asyncDispatch","connected","done","Modal","LoadingIndicator","HasConnectedDashboards","Confirm","Button","suffix","message","title","LibraryPanelCardComponent","onClick","onDelete","showSecondaryActions","showDeletionModal","setShowDeletionModal","onDeletePanel","panelPlugin","config","PanelTypeCard","FolderLink","LibraryPanelCardSkeleton","rootProps","LibraryPanelCard","Link","Icon","FolderFilter","loading","setLoading","getOptions","searchString","getFoldersAsOptions","debouncedLoadOptions","onSelectOptionChange","folders","changedFolderIds","f","params","LibraryPanelsSearchVariant","LibraryPanelsSearch","variant","currentPanelId","currentFolderUID","perPage","showPanelFilter","showFolderFilter","showSort","searchQuery","setSearchQuery","debouncedSearchQuery","setDebouncedSearchQuery","useDebounce","sortDirection","setSortDirection","folderFilter","setFolderFilter","panelFilter","setPanelFilter","sortOrFiltersVisible","verticalGroupSpacing","FilterInput","SearchControls","LibraryPanelsView","tightLayout","onSortChange","onFolderFilterChange","onPanelFilterChange","getRowStyles","panelFilterChanged","folderFilterChanged","searchRowContainer","searchRowContainerTight","filterContainer","filterContainerTight","onClickCard","currentPanel","propsPerPage","getPanelViewStyles","libraryPanels","page","numberOfPages","uid","onPageChange","item","searchForLibraryPanels","args","findPluginMeta","pluginMeta","filterLibraryPanels","pluginMetaList","matchingPluginMeta","subscription","dataObservable","libraryPanelsResult","filteredLibraryPanels","totalCount","err","deleteLibraryPanel","e","asyncDispatcher","initialLibraryPanelsViewState","initSearch","changePage","libraryPanelsViewReducer","getModalStyles"],"sourceRoot":""}