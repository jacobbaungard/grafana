(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7166],{6191:(he,ae,y)=>{"use strict";y.d(ae,{X:()=>B});var j=y(32196),L=y(96540),D=y(40845);const B=({children:I})=>{const C=(0,D.of)(H);return L.createElement("div",{className:C.root},I)},H=I=>({root:(0,j.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:I.spacing(3),minHeight:I.spacing(4)})})},31347:(he,ae,y)=>{"use strict";y.d(ae,{Z:()=>L});var j=y(96540);const L=({grow:D,shrink:B})=>j.createElement("div",{style:{display:"block",flexGrow:D,flexShrink:B}})},22354:(he,ae,y)=>{"use strict";y.d(ae,{W:()=>Y});var j=y(32196),L=y(96540),D=y(40845),B=y(88323),H=y(4603),I=Object.defineProperty,C=Object.defineProperties,x=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,T=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable,z=(Be,Ue,Re)=>Ue in Be?I(Be,Ue,{enumerable:!0,configurable:!0,writable:!0,value:Re}):Be[Ue]=Re,M=(Be,Ue)=>{for(var Re in Ue||(Ue={}))T.call(Ue,Re)&&z(Be,Re,Ue[Re]);if(_)for(var Re of _(Ue))V.call(Ue,Re)&&z(Be,Re,Ue[Re]);return Be},U=(Be,Ue)=>C(Be,x(Ue)),K=(Be,Ue)=>{var Re={};for(var ar in Be)T.call(Be,ar)&&Ue.indexOf(ar)<0&&(Re[ar]=Be[ar]);if(Be!=null&&_)for(var ar of _(Be))Ue.indexOf(ar)<0&&V.call(Be,ar)&&(Re[ar]=Be[ar]);return Re};function Y(Be){var Ue=Be,{label:Re}=Ue,ar=K(Ue,["label"]);const Ke=(0,D.of)(Xe),[dr]=(0,L.useState)(()=>Math.random().toString(16).slice(2)),pr={SelectContainer:Te,ValueContainer:me,SingleValue:me};return L.createElement("div",{className:Ke.root},Re&&L.createElement("label",{className:Ke.label,htmlFor:dr},Re,":","\xA0"),L.createElement(B.l6,U(M({openMenuOnFocus:!0,inputId:dr},ar),{components:pr})))}const Te=Be=>{const{children:Ue}=Be,Re=(0,D.of)(Xe);return L.createElement(H.K,U(M({},Be),{className:(0,j.cx)(Be.className,Re.container)}),Ue)},me=Be=>{const{className:Ue,children:Re}=Be,ar=(0,D.of)(Xe);return L.createElement("div",{className:(0,j.cx)(Ue,ar.valueContainer)},Re)},Xe=Be=>({root:(0,j.css)({display:"flex",fontSize:12,alignItems:"center"}),label:(0,j.css)({color:Be.colors.text.secondary,whiteSpace:"nowrap"}),container:(0,j.css)({background:"none",borderColor:"transparent"}),valueContainer:(0,j.css)({display:"flex",alignItems:"center",flex:"initial",color:Be.colors.text.secondary,fontSize:12})})},10828:(he,ae,y)=>{"use strict";y.r(ae),y.d(ae,{AND:()=>M,AS:()=>V,ASC:()=>x,BY:()=>I,COMPARISON_OPERATORS:()=>me,DESC:()=>C,EQUALS:()=>Y,FROM:()=>L,GROUP:()=>B,LIMIT:()=>_,LOGICAL_OPERATORS:()=>K,NOT_EQUALS:()=>Te,OR:()=>U,ORDER:()=>H,SCHEMA:()=>z,SELECT:()=>j,STD_OPERATORS:()=>Xe,WHERE:()=>D,WITH:()=>T,conf:()=>Be,language:()=>Ue});const j="select",L="from",D="where",B="group",H="order",I="by",C="desc",x="asc",_="limit",T="with",V="as",z="schema",M="AND",U="OR",K=[M,U],Y="=",Te="!=",me=[Y,Te],Xe=[...me],Be={comments:{lineComment:"--",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}]},Ue={defaultToken:"",tokenPostfix:".sql",ignoreCase:!0,brackets:[{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"}],keywords:["ABORT","ABSOLUTE","ACTION","ADA","ADD","AFTER","ALL","ALLOCATE","ALTER","ALWAYS","ANALYZE","AND","ANY","ARE","AS","ASC","ASSERTION","AT","ATTACH","AUTHORIZATION","AUTOINCREMENT","AVG","BACKUP","BEFORE","BEGIN","BETWEEN","BIT","BIT_LENGTH","BOTH","BREAK","BROWSE","BULK","BY","CASCADE","CASCADED","CASE","CAST","CATALOG","CHAR","CHARACTER","CHARACTER_LENGTH","CHAR_LENGTH","CHECK","CHECKPOINT","CLOSE","CLUSTERED","COALESCE","COLLATE","COLLATION","COLUMN","COMMIT","COMPUTE","CONFLICT","CONNECT","CONNECTION","CONSTRAINT","CONSTRAINTS","CONTAINS","CONTAINSTABLE","CONTINUE","CONVERT","CORRESPONDING","COUNT","CREATE","CROSS","CURRENT","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATE","DAY","DBCC","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DENY","DESC","DESCRIBE","DESCRIPTOR","DETACH","DIAGNOSTICS","DISCONNECT","DISK","DISTINCT","DISTRIBUTED","DO","DOMAIN","DOUBLE","DROP","DUMP","EACH","ELSE","END","END-EXEC","ERRLVL","ESCAPE","EXCEPT","EXCEPTION","EXCLUDE","EXCLUSIVE","EXEC","EXECUTE","EXISTS","EXIT","EXPLAIN","EXTERNAL","EXTRACT","FAIL","FALSE","FETCH","FILE","FILLFACTOR","FILTER","FIRST","FLOAT","FOLLOWING","FOR","FOREIGN","FORTRAN","FOUND","FREETEXT","FREETEXTTABLE","FROM","FULL","FUNCTION","GENERATED","GET","GLOB","GLOBAL","GO","GOTO","GRANT","GROUP","GROUPS","HAVING","HOLDLOCK","HOUR","IDENTITY","IDENTITYCOL","IDENTITY_INSERT","IF","IGNORE","IMMEDIATE","IN","INCLUDE","INDEX","INDEXED","INDICATOR","INITIALLY","INNER","INPUT","INSENSITIVE","INSERT","INSTEAD","INT","INTEGER","INTERSECT","INTERVAL","INTO","IS","ISNULL","ISOLATION","JOIN","KEY","KILL","LANGUAGE","LAST","LEADING","LEFT","LEVEL","LIKE","LIMIT","LINENO","LOAD","LOCAL","LOWER","MATCH","MATERIALIZED","MAX","MERGE","MIN","MINUTE","MODULE","MONTH","NAMES","NATIONAL","NATURAL","NCHAR","NEXT","NO","NOCHECK","NONCLUSTERED","NONE","NOT","NOTHING","NOTNULL","NULL","NULLIF","NULLS","NUMERIC","OCTET_LENGTH","OF","OFF","OFFSET","OFFSETS","ON","ONLY","OPEN","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","OPTION","OR","ORDER","OTHERS","OUTER","OUTPUT","OVER","OVERLAPS","PAD","PARTIAL","PARTITION","PASCAL","PERCENT","PIVOT","PLAN","POSITION","PRAGMA","PRECEDING","PRECISION","PREPARE","PRESERVE","PRIMARY","PRINT","PRIOR","PRIVILEGES","PROC","PROCEDURE","PUBLIC","QUERY","RAISE","RAISERROR","RANGE","READ","READTEXT","REAL","RECONFIGURE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELATIVE","RELEASE","RENAME","REPLACE","REPLICATION","RESTORE","RESTRICT","RETURN","RETURNING","REVERT","REVOKE","RIGHT","ROLLBACK","ROW","ROWCOUNT","ROWGUIDCOL","ROWS","RULE","SAVE","SAVEPOINT","SCHEMA","SCROLL","SECOND","SECTION","SECURITYAUDIT","SELECT","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","SESSION","SESSION_USER","SET","SETUSER","SHUTDOWN","SIZE","SMALLINT","SOME","SPACE","SQL","SQLCA","SQLCODE","SQLERROR","SQLSTATE","SQLWARNING","STATISTICS","SUBSTRING","SUM","SYSTEM_USER","TABLE","TABLESAMPLE","TEMP","TEMPORARY","TEXTSIZE","THEN","TIES","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TOP","TRAILING","TRAN","TRANSACTION","TRANSLATE","TRANSLATION","TRIGGER","TRIM","TRUE","TRUNCATE","TRY_CONVERT","TSEQUAL","UNBOUNDED","UNION","UNIQUE","UNKNOWN","UNPIVOT","UPDATE","UPDATETEXT","UPPER","USAGE","USE","USER","USING","VACUUM","VALUE","VALUES","VARCHAR","VARYING","VIEW","VIRTUAL","WAITFOR","WHEN","WHENEVER","WHERE","WHILE","WINDOW","WITH","WITHIN GROUP","WITHOUT","WORK","WRITE","WRITETEXT","YEAR","ZONE"],operators:["EXCEPT","INTERSECT","UNION","APPLY","CROSS","FULL","INNER","JOIN","LEFT","OUTER","RIGHT","CONTAINS","FREETEXT","IS","NULL","PIVOT","UNPIVOT","MATCHED"],logicalOperators:["ALL","AND","ANY","BETWEEN","EXISTS","IN","LIKE","NOT","OR","SOME"],comparisonOperators:["<>",">","<",">=","<=","=","!=","&","~","^","%"],builtinFunctions:["AVG","CHECKSUM_AGG","COUNT","COUNT_BIG","GROUPING","GROUPING_ID","MAX","MIN","SUM","STDEV","STDEVP","VAR","VARP","CUME_DIST","FIRST_VALUE","LAG","LAST_VALUE","LEAD","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","COLLATE","COLLATIONPROPERTY","TERTIARY_WEIGHTS","FEDERATION_FILTERING_VALUE","CAST","CONVERT","PARSE","TRY_CAST","TRY_CONVERT","TRY_PARSE","ASYMKEY_ID","ASYMKEYPROPERTY","CERTPROPERTY","CERT_ID","CRYPT_GEN_RANDOM","DECRYPTBYASYMKEY","DECRYPTBYCERT","DECRYPTBYKEY","DECRYPTBYKEYAUTOASYMKEY","DECRYPTBYKEYAUTOCERT","DECRYPTBYPASSPHRASE","ENCRYPTBYASYMKEY","ENCRYPTBYCERT","ENCRYPTBYKEY","ENCRYPTBYPASSPHRASE","HASHBYTES","IS_OBJECTSIGNED","KEY_GUID","KEY_ID","KEY_NAME","SIGNBYASYMKEY","SIGNBYCERT","SYMKEYPROPERTY","VERIFYSIGNEDBYCERT","VERIFYSIGNEDBYASYMKEY","CURSOR_STATUS","DATALENGTH","IDENT_CURRENT","IDENT_INCR","IDENT_SEED","IDENTITY","SQL_VARIANT_PROPERTY","CURRENT_TIMESTAMP","DATEADD","DATEDIFF","DATEFROMPARTS","DATENAME","DATEPART","DATETIME2FROMPARTS","DATETIMEFROMPARTS","DATETIMEOFFSETFROMPARTS","DAY","EOMONTH","GETDATE","GETUTCDATE","ISDATE","MONTH","SMALLDATETIMEFROMPARTS","SWITCHOFFSET","SYSDATETIME","SYSDATETIMEOFFSET","SYSUTCDATETIME","TIMEFROMPARTS","TODATETIMEOFFSET","YEAR","CHOOSE","COALESCE","IIF","NULLIF","ABS","ACOS","ASIN","ATAN","ATN2","CEILING","COS","COT","DEGREES","EXP","FLOOR","LOG","LOG10","PI","POWER","RADIANS","RAND","ROUND","SIGN","SIN","SQRT","SQUARE","TAN","APP_NAME","APPLOCK_MODE","APPLOCK_TEST","ASSEMBLYPROPERTY","COL_LENGTH","COL_NAME","COLUMNPROPERTY","DATABASE_PRINCIPAL_ID","DATABASEPROPERTYEX","DB_ID","DB_NAME","FILE_ID","FILE_IDEX","FILE_NAME","FILEGROUP_ID","FILEGROUP_NAME","FILEGROUPPROPERTY","FILEPROPERTY","FULLTEXTCATALOGPROPERTY","FULLTEXTSERVICEPROPERTY","INDEX_COL","INDEXKEY_PROPERTY","INDEXPROPERTY","OBJECT_DEFINITION","OBJECT_ID","OBJECT_NAME","OBJECT_SCHEMA_NAME","OBJECTPROPERTY","OBJECTPROPERTYEX","ORIGINAL_DB_NAME","PARSENAME","SCHEMA_ID","SCHEMA_NAME","SCOPE_IDENTITY","SERVERPROPERTY","STATS_DATE","TYPE_ID","TYPE_NAME","TYPEPROPERTY","DENSE_RANK","NTILE","RANK","ROW_NUMBER","PUBLISHINGSERVERNAME","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","CERTENCODED","CERTPRIVATEKEY","CURRENT_USER","HAS_DBACCESS","HAS_PERMS_BY_NAME","IS_MEMBER","IS_ROLEMEMBER","IS_SRVROLEMEMBER","LOGINPROPERTY","ORIGINAL_LOGIN","PERMISSIONS","PWDENCRYPT","PWDCOMPARE","SESSION_USER","SESSIONPROPERTY","SUSER_ID","SUSER_NAME","SUSER_SID","SUSER_SNAME","SYSTEM_USER","USER","USER_ID","USER_NAME","ASCII","CHAR","CHARINDEX","CONCAT","DIFFERENCE","FORMAT","LEFT","LEN","LOWER","LTRIM","NCHAR","PATINDEX","QUOTENAME","REPLACE","REPLICATE","REVERSE","RIGHT","RTRIM","SOUNDEX","SPACE","STR","STUFF","SUBSTRING","UNICODE","UPPER","BINARY_CHECKSUM","CHECKSUM","CONNECTIONPROPERTY","CONTEXT_INFO","CURRENT_REQUEST_ID","ERROR_LINE","ERROR_NUMBER","ERROR_MESSAGE","ERROR_PROCEDURE","ERROR_SEVERITY","ERROR_STATE","FORMATMESSAGE","GETANSINULL","GET_FILESTREAM_TRANSACTION_CONTEXT","HOST_ID","HOST_NAME","ISNULL","ISNUMERIC","MIN_ACTIVE_ROWVERSION","NEWID","NEWSEQUENTIALID","ROWCOUNT_BIG","XACT_STATE","TEXTPTR","TEXTVALID","COLUMNS_UPDATED","EVENTDATA","TRIGGER_NESTLEVEL","UPDATE","CHANGETABLE","CHANGE_TRACKING_CONTEXT","CHANGE_TRACKING_CURRENT_VERSION","CHANGE_TRACKING_IS_COLUMN_IN_MASK","CHANGE_TRACKING_MIN_VALID_VERSION","CONTAINSTABLE","FREETEXTTABLE","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","FILETABLEROOTPATH","GETFILENAMESPACEPATH","GETPATHLOCATOR","PATHNAME","GET_TRANSMISSION_STATUS"],builtinVariables:["@@DATEFIRST","@@DBTS","@@LANGID","@@LANGUAGE","@@LOCK_TIMEOUT","@@MAX_CONNECTIONS","@@MAX_PRECISION","@@NESTLEVEL","@@OPTIONS","@@REMSERVER","@@SERVERNAME","@@SERVICENAME","@@SPID","@@TEXTSIZE","@@VERSION","@@CURSOR_ROWS","@@FETCH_STATUS","@@DATEFIRST","@@PROCID","@@ERROR","@@IDENTITY","@@ROWCOUNT","@@TRANCOUNT","@@CONNECTIONS","@@CPU_BUSY","@@IDLE","@@IO_BUSY","@@PACKET_ERRORS","@@PACK_RECEIVED","@@PACK_SENT","@@TIMETICKS","@@TOTAL_ERRORS","@@TOTAL_READ","@@TOTAL_WRITE"],pseudoColumns:["$ACTION","$IDENTITY","$ROWGUID","$PARTITION"],tokenizer:{root:[{include:"@templateVariables"},{include:"@macros"},{include:"@comments"},{include:"@whitespace"},{include:"@pseudoColumns"},{include:"@numbers"},{include:"@strings"},{include:"@complexIdentifiers"},{include:"@scopes"},{include:"@schemaTable"},[/[;,.]/,"delimiter"],[/[()]/,"@brackets"],[/[\w@#$|<|>|=|!|%|&|+|\|-|*|/|~|^]+/,{cases:{"@operators":"operator","@comparisonOperators":"operator","@logicalOperators":"operator","@builtinVariables":"predefined","@builtinFunctions":"predefined","@keywords":"keyword","@default":"identifier"}}]],templateVariables:[[/\$[a-zA-Z0-9]+/,"variable"]],macros:[[/\$__[a-zA-Z0-9-_]+/,"type"]],schemaTable:[[/(\w+)\./,"identifier"],[/(\w+\.\w+)/,"identifier"]],whitespace:[[/\s+/,"white"]],comments:[[/--+.*/,"comment"],[/\/\*/,{token:"comment.quote",next:"@comment"}]],comment:[[/[^*/]+/,"comment"],[/\*\//,{token:"comment.quote",next:"@pop"}],[/./,"comment"]],pseudoColumns:[[/[$][A-Za-z_][\w@#$]*/,{cases:{"@pseudoColumns":"predefined","@default":"identifier"}}]],numbers:[[/0[xX][0-9a-fA-F]*/,"number"],[/[$][+-]*\d*(\.\d*)?/,"number"],[/((\d+(\.\d*)?)|(\.\d+))([eE][\-+]?\d+)?/,"number"]],strings:[[/N'/,{token:"string",next:"@string"}],[/'/,{token:"string",next:"@string"}]],string:[[/[^']+/,"string"],[/''/,"string"],[/'/,{token:"string",next:"@pop"}]],complexIdentifiers:[[/\[/,{token:"identifier.quote",next:"@bracketedIdentifier"}],[/"/,{token:"identifier.quote",next:"@quotedIdentifier"}]],bracketedIdentifier:[[/[^\]]+/,"identifier"],[/]]/,"identifier"],[/]/,{token:"identifier.quote",next:"@pop"}]],quotedIdentifier:[[/[^"]+/,"identifier"],[/""/,"identifier"],[/"/,{token:"identifier.quote",next:"@pop"}]],scopes:[[/BEGIN\s+(DISTRIBUTED\s+)?TRAN(SACTION)?\b/i,"keyword"],[/BEGIN\s+TRY\b/i,{token:"keyword.try"}],[/END\s+TRY\b/i,{token:"keyword.try"}],[/BEGIN\s+CATCH\b/i,{token:"keyword.catch"}],[/END\s+CATCH\b/i,{token:"keyword.catch"}],[/(BEGIN|CASE)\b/i,{token:"keyword.block"}],[/END\b/i,{token:"keyword.block"}],[/WHEN\b/i,{token:"keyword.choice"}],[/THEN\b/i,{token:"keyword.choice"}]]}}},33125:(he,ae,y)=>{"use strict";y.d(ae,{N:()=>H});var j=y(98765);const L="column",D="'5m'",B=[{id:"$__timeFilter(dateColumn)",name:"$__timeFilter(dateColumn)",text:"$__timeFilter",args:[L],type:j.hh.Filter,description:"Will be replaced by a time range filter using the specified column name. For example, dateColumn BETWEEN FROM_UNIXTIME(1494410783) AND FROM_UNIXTIME(1494410983)"},{id:"$__timeFrom()",name:"$__timeFrom()",text:"$__timeFrom",args:[],type:j.hh.Filter,description:"Will be replaced by the start of the currently active time selection. For example, FROM_UNIXTIME(1494410783)"},{id:"$__timeTo()",name:"$__timeTo()",text:"$__timeTo",args:[],type:j.hh.Filter,description:"Will be replaced by the end of the currently active time selection. For example, FROM_UNIXTIME(1494410983)"},{id:"$__timeGroup(dateColumn, '5m')",name:"$__timeGroup(dateColumn, '5m')",text:"$__timeGroup",args:[L,D],type:j.hh.Value,description:"Will be replaced by an expression usable in GROUP BY clause. For example, *cast(cast(UNIX_TIMESTAMP(dateColumn)/(300) as signed)*300 as signed),*"},{id:"$__table",name:"$__table",text:"$__table",args:[],type:j.hh.Table,description:"Will be replaced by the query table."},{id:"$__column",name:"$__column",text:"$__column",args:[],type:j.hh.Column,description:"Will be replaced by the query column."}];function H(I,C){var x,_,T;const V={triggerCharacters:["."," ","$",",","(","'"]};C&&Array.isArray(C.builtinFunctions)&&(V.supportedFunctions=()=>C.builtinFunctions.map(M=>({id:M,name:M})));const z=[];return(x=C?.comparisonOperators)!=null&&x.length&&z.push(...C.comparisonOperators.map(M=>({id:M.toLocaleLowerCase(),operator:M,type:j.hu.Comparison}))),C.logicalOperators=(_=C.logicalOperators)!=null?_:C.operators,(T=C?.logicalOperators)!=null&&T.length&&z.push(...C.logicalOperators.map(M=>({id:M.toLocaleLowerCase(),operator:M,type:j.hu.Logical}))),V.supportedOperators=()=>z,V.supportedMacros=()=>B,V}},98765:(he,ae,y)=>{"use strict";y.d(ae,{Io:()=>C,X7:()=>B,_E:()=>x,hh:()=>L,hu:()=>j,ks:()=>D,lX:()=>_,mY:()=>I,ng:()=>H});var j=(T=>(T[T.Comparison=0]="Comparison",T[T.Logical=1]="Logical",T))(j||{}),L=(T=>(T[T.Value=0]="Value",T[T.Filter=1]="Filter",T[T.Group=2]="Group",T[T.Column=3]="Column",T[T.Table=4]="Table",T))(L||{}),D=(T=>(T.Parenthesis="delimiter.parenthesis.sql",T.Whitespace="white.sql",T.Keyword="keyword.sql",T.Delimiter="delimiter.sql",T.Operator="operator.sql",T.Identifier="identifier.sql",T.IdentifierQuote="identifier.quote.sql",T.Type="type.sql",T.Function="predefined.sql",T.Number="number.sql",T.String="string.sql",T.Variable="variable.sql",T))(D||{}),B=(T=>(T.Unknown="unknown",T.SelectKeyword="selectKeyword",T.WithKeyword="withKeyword",T.AfterSelectKeyword="afterSelectKeyword",T.AfterSelectArguments="afterSelectArguments",T.AfterSelectFuncFirstArgument="afterSelectFuncFirstArgument",T.SelectAlias="selectAlias",T.AfterFromKeyword="afterFromKeyword",T.AfterTable="afterTable",T.SchemaFuncFirstArgument="schemaFuncFirstArgument",T.SchemaFuncExtraArgument="schemaFuncExtraArgument",T.FromKeyword="fromKeyword",T.AfterFrom="afterFrom",T.WhereKeyword="whereKeyword",T.WhereComparisonOperator="whereComparisonOperator",T.WhereValue="whereValue",T.AfterWhereFunctionArgument="afterWhereFunctionArgument",T.AfterGroupByFunctionArgument="afterGroupByFunctionArgument",T.AfterWhereValue="afterWhereValue",T.AfterGroupByKeywords="afterGroupByKeywords",T.AfterGroupBy="afterGroupBy",T.AfterOrderByKeywords="afterOrderByKeywords",T.AfterOrderByFunction="afterOrderByFunction",T.AfterOrderByDirection="afterOrderByDirection",T.AfterIsOperator="afterIsOperator",T.AfterIsNotOperator="afterIsNotOperator",T.AfterSchema="afterSchema",T))(B||{}),H=(T=>(T.Schemas="schemas",T.Tables="tables",T.Columns="columns",T.SelectKeyword="selectKeyword",T.WithKeyword="withKeyword",T.FunctionsWithArguments="functionsWithArguments",T.FromKeyword="fromKeyword",T.WhereKeyword="whereKeyword",T.GroupByKeywords="groupByKeywords",T.OrderByKeywords="orderByKeywords",T.FunctionsWithoutArguments="functionsWithoutArguments",T.LimitKeyword="limitKeyword",T.SortOrderDirectionKeyword="sortOrderDirectionKeyword",T.ComparisonOperators="comparisonOperators",T.LogicalOperators="logicalOperators",T.SelectMacro="selectMacro",T.TableMacro="tableMacro",T.FilterMacro="filterMacro",T.GroupMacro="groupMacro",T.BoolValues="boolValues",T.NullValue="nullValue",T.NotKeyword="notKeyword",T.TemplateVariables="templateVariables",T.StarWildCard="starWildCard",T))(H||{}),I=(T=>(T.High="a",T.MediumHigh="d",T.Medium="g",T.MediumLow="k",T.Low="q",T))(I||{}),C=(T=>(T[T.Method=0]="Method",T[T.Function=1]="Function",T[T.Constructor=2]="Constructor",T[T.Field=3]="Field",T[T.Variable=4]="Variable",T[T.Class=5]="Class",T[T.Struct=6]="Struct",T[T.Interface=7]="Interface",T[T.Module=8]="Module",T[T.Property=9]="Property",T[T.Event=10]="Event",T[T.Operator=11]="Operator",T[T.Unit=12]="Unit",T[T.Value=13]="Value",T[T.Constant=14]="Constant",T[T.Enum=15]="Enum",T[T.EnumMember=16]="EnumMember",T[T.Keyword=17]="Keyword",T[T.Text=18]="Text",T[T.Color=19]="Color",T[T.File=20]="File",T[T.Reference=21]="Reference",T[T.Customcolor=22]="Customcolor",T[T.Folder=23]="Folder",T[T.TypeParameter=24]="TypeParameter",T[T.User=25]="User",T[T.Issue=26]="Issue",T[T.Snippet=27]="Snippet",T))(C||{}),x=(T=>(T[T.KeepWhitespace=1]="KeepWhitespace",T[T.InsertAsSnippet=4]="InsertAsSnippet",T))(x||{}),_=(T=>(T.Builder="builder",T.Code="code",T))(_||{})},44600:(he,ae,y)=>{"use strict";y.d(ae,{A:()=>z});var j,L=new Uint8Array(16);function D(){if(!j&&(j=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!j))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return j(L)}const B=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function H(M){return typeof M=="string"&&B.test(M)}const I=H;for(var C=[],x=0;x<256;++x)C.push((x+256).toString(16).substr(1));function _(M){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,K=(C[M[U+0]]+C[M[U+1]]+C[M[U+2]]+C[M[U+3]]+"-"+C[M[U+4]]+C[M[U+5]]+"-"+C[M[U+6]]+C[M[U+7]]+"-"+C[M[U+8]]+C[M[U+9]]+"-"+C[M[U+10]]+C[M[U+11]]+C[M[U+12]]+C[M[U+13]]+C[M[U+14]]+C[M[U+15]]).toLowerCase();if(!I(K))throw TypeError("Stringified UUID is invalid");return K}const T=_;function V(M,U,K){M=M||{};var Y=M.random||(M.rng||D)();if(Y[6]=Y[6]&15|64,Y[8]=Y[8]&63|128,U){K=K||0;for(var Te=0;Te<16;++Te)U[K+Te]=Y[Te];return U}return T(Y)}const z=V},49790:function(he){(function(ae,y){he.exports=y()})(this,function(){"use strict";var ae=Array.prototype.slice;function y(l,p){p&&(l.prototype=Object.create(p.prototype)),l.prototype.constructor=l}function j(l){return H(l)?l:sr(l)}y(L,j);function L(l){return I(l)?l:ct(l)}y(D,j);function D(l){return C(l)?l:Ir(l)}y(B,j);function B(l){return H(l)&&!x(l)?l:xt(l)}function H(l){return!!(l&&l[T])}function I(l){return!!(l&&l[V])}function C(l){return!!(l&&l[z])}function x(l){return I(l)||C(l)}function _(l){return!!(l&&l[M])}j.isIterable=H,j.isKeyed=I,j.isIndexed=C,j.isAssociative=x,j.isOrdered=_,j.Keyed=L,j.Indexed=D,j.Set=B;var T="@@__IMMUTABLE_ITERABLE__@@",V="@@__IMMUTABLE_KEYED__@@",z="@@__IMMUTABLE_INDEXED__@@",M="@@__IMMUTABLE_ORDERED__@@",U="delete",K=5,Y=1<<K,Te=Y-1,me={},Xe={value:!1},Be={value:!1};function Ue(l){return l.value=!1,l}function Re(l){l&&(l.value=!0)}function ar(){}function Ke(l,p){p=p||0;for(var S=Math.max(0,l.length-p),A=new Array(S),b=0;b<S;b++)A[b]=l[b+p];return A}function dr(l){return l.size===void 0&&(l.size=l.__iterate(rr)),l.size}function pr(l,p){if(typeof p!="number"){var S=p>>>0;if(""+S!==p||S===4294967295)return NaN;p=S}return p<0?dr(l)+p:p}function rr(){return!0}function tr(l,p,S){return(l===0||S!==void 0&&l<=-S)&&(p===void 0||S!==void 0&&p>=S)}function yr(l,p){return Xr(l,p,0)}function Pe(l,p){return Xr(l,p,p)}function Xr(l,p,S){return l===void 0?S:l<0?Math.max(0,p+l):p===void 0?l:Math.min(p,l)}var N=0,Wr=1,kr=2,Ee=typeof Symbol=="function"&&Symbol.iterator,ye="@@iterator",Ae=Ee||ye;function Ie(l){this.next=l}Ie.prototype.toString=function(){return"[Iterator]"},Ie.KEYS=N,Ie.VALUES=Wr,Ie.ENTRIES=kr,Ie.prototype.inspect=Ie.prototype.toSource=function(){return this.toString()},Ie.prototype[Ae]=function(){return this};function _e(l,p,S,A){var b=l===0?p:l===1?S:[p,S];return A?A.value=b:A={value:b,done:!1},A}function h(){return{value:void 0,done:!0}}function He(l){return!!nt(l)}function We(l){return l&&typeof l.next=="function"}function or(l){var p=nt(l);return p&&p.call(l)}function nt(l){var p=l&&(Ee&&l[Ee]||l[ye]);if(typeof p=="function")return p}function lt(l){return l&&typeof l.length=="number"}y(sr,j);function sr(l){return l==null?wr():H(l)?l.toSeq():Kt(l)}sr.of=function(){return sr(arguments)},sr.prototype.toSeq=function(){return this},sr.prototype.toString=function(){return this.__toString("Seq {","}")},sr.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},sr.prototype.__iterate=function(l,p){return Un(this,l,p,!0)},sr.prototype.__iterator=function(l,p){return Mt(this,l,p,!0)},y(ct,sr);function ct(l){return l==null?wr().toKeyedSeq():H(l)?I(l)?l.toSeq():l.fromEntrySeq():fn(l)}ct.prototype.toKeyedSeq=function(){return this},y(Ir,sr);function Ir(l){return l==null?wr():H(l)?I(l)?l.entrySeq():l.toIndexedSeq():Gt(l)}Ir.of=function(){return Ir(arguments)},Ir.prototype.toIndexedSeq=function(){return this},Ir.prototype.toString=function(){return this.__toString("Seq [","]")},Ir.prototype.__iterate=function(l,p){return Un(this,l,p,!1)},Ir.prototype.__iterator=function(l,p){return Mt(this,l,p,!1)},y(xt,sr);function xt(l){return(l==null?wr():H(l)?I(l)?l.entrySeq():l:Gt(l)).toSetSeq()}xt.of=function(){return xt(arguments)},xt.prototype.toSetSeq=function(){return this},sr.isSeq=La,sr.Keyed=ct,sr.Set=xt,sr.Indexed=Ir;var Rn="@@__IMMUTABLE_SEQ__@@";sr.prototype[Rn]=!0,y(ht,Ir);function ht(l){this._array=l,this.size=l.length}ht.prototype.get=function(l,p){return this.has(l)?this._array[pr(this,l)]:p},ht.prototype.__iterate=function(l,p){for(var S=this._array,A=S.length-1,b=0;b<=A;b++)if(l(S[p?A-b:b],b,this)===!1)return b+1;return b},ht.prototype.__iterator=function(l,p){var S=this._array,A=S.length-1,b=0;return new Ie(function(){return b>A?h():_e(l,b,S[p?A-b++:b++])})},y(yt,ct);function yt(l){var p=Object.keys(l);this._object=l,this._keys=p,this.size=p.length}yt.prototype.get=function(l,p){return p!==void 0&&!this.has(l)?p:this._object[l]},yt.prototype.has=function(l){return this._object.hasOwnProperty(l)},yt.prototype.__iterate=function(l,p){for(var S=this._object,A=this._keys,b=A.length-1,G=0;G<=b;G++){var X=A[p?b-G:G];if(l(S[X],X,this)===!1)return G+1}return G},yt.prototype.__iterator=function(l,p){var S=this._object,A=this._keys,b=A.length-1,G=0;return new Ie(function(){var X=A[p?b-G:G];return G++>b?h():_e(l,X,S[X])})},yt.prototype[M]=!0,y(ln,Ir);function ln(l){this._iterable=l,this.size=l.length||l.size}ln.prototype.__iterateUncached=function(l,p){if(p)return this.cacheResult().__iterate(l,p);var S=this._iterable,A=or(S),b=0;if(We(A))for(var G;!(G=A.next()).done&&l(G.value,b++,this)!==!1;);return b},ln.prototype.__iteratorUncached=function(l,p){if(p)return this.cacheResult().__iterator(l,p);var S=this._iterable,A=or(S);if(!We(A))return new Ie(h);var b=0;return new Ie(function(){var G=A.next();return G.done?G:_e(l,b++,G.value)})},y(Ut,Ir);function Ut(l){this._iterator=l,this._iteratorCache=[]}Ut.prototype.__iterateUncached=function(l,p){if(p)return this.cacheResult().__iterate(l,p);for(var S=this._iterator,A=this._iteratorCache,b=0;b<A.length;)if(l(A[b],b++,this)===!1)return b;for(var G;!(G=S.next()).done;){var X=G.value;if(A[b]=X,l(X,b++,this)===!1)break}return b},Ut.prototype.__iteratorUncached=function(l,p){if(p)return this.cacheResult().__iterator(l,p);var S=this._iterator,A=this._iteratorCache,b=0;return new Ie(function(){if(b>=A.length){var G=S.next();if(G.done)return G;A[b]=G.value}return _e(l,b,A[b++])})};function La(l){return!!(l&&l[Rn])}var cn;function wr(){return cn||(cn=new ht([]))}function fn(l){var p=Array.isArray(l)?new ht(l).fromEntrySeq():We(l)?new Ut(l).fromEntrySeq():He(l)?new ln(l).fromEntrySeq():typeof l=="object"?new yt(l):void 0;if(!p)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+l);return p}function Gt(l){var p=ta(l);if(!p)throw new TypeError("Expected Array or iterable object of values: "+l);return p}function Kt(l){var p=ta(l)||typeof l=="object"&&new yt(l);if(!p)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+l);return p}function ta(l){return lt(l)?new ht(l):We(l)?new Ut(l):He(l)?new ln(l):void 0}function Un(l,p,S,A){var b=l._cache;if(b){for(var G=b.length-1,X=0;X<=G;X++){var ne=b[S?G-X:X];if(p(ne[1],A?ne[0]:X,l)===!1)return X+1}return X}return l.__iterateUncached(p,S)}function Mt(l,p,S,A){var b=l._cache;if(b){var G=b.length-1,X=0;return new Ie(function(){var ne=b[S?G-X:X];return X++>G?h():_e(p,A?ne[0]:X-1,ne[1])})}return l.__iteratorUncached(p,S)}function Cn(l,p){return p?Ft(p,l,"",{"":l}):Ln(l)}function Ft(l,p,S,A){return Array.isArray(p)?l.call(A,S,Ir(p).map(function(b,G){return Ft(l,b,G,p)})):Gn(p)?l.call(A,S,ct(p).map(function(b,G){return Ft(l,b,G,p)})):p}function Ln(l){return Array.isArray(l)?Ir(l).map(Ln).toList():Gn(l)?ct(l).map(Ln).toMap():l}function Gn(l){return l&&(l.constructor===Object||l.constructor===void 0)}function qr(l,p){if(l===p||l!==l&&p!==p)return!0;if(!l||!p)return!1;if(typeof l.valueOf=="function"&&typeof p.valueOf=="function"){if(l=l.valueOf(),p=p.valueOf(),l===p||l!==l&&p!==p)return!0;if(!l||!p)return!1}return!!(typeof l.equals=="function"&&typeof p.equals=="function"&&l.equals(p))}function na(l,p){if(l===p)return!0;if(!H(p)||l.size!==void 0&&p.size!==void 0&&l.size!==p.size||l.__hash!==void 0&&p.__hash!==void 0&&l.__hash!==p.__hash||I(l)!==I(p)||C(l)!==C(p)||_(l)!==_(p))return!1;if(l.size===0&&p.size===0)return!0;var S=!x(l);if(_(l)){var A=l.entries();return p.every(function(ce,fe){var ve=A.next().value;return ve&&qr(ve[1],ce)&&(S||qr(ve[0],fe))})&&A.next().done}var b=!1;if(l.size===void 0)if(p.size===void 0)typeof l.cacheResult=="function"&&l.cacheResult();else{b=!0;var G=l;l=p,p=G}var X=!0,ne=p.__iterate(function(ce,fe){if(S?!l.has(ce):b?!qr(ce,l.get(fe,me)):!qr(l.get(fe,me),ce))return X=!1,!1});return X&&l.size===ne}y(ot,Ir);function ot(l,p){if(!(this instanceof ot))return new ot(l,p);if(this._value=l,this.size=p===void 0?1/0:Math.max(0,p),this.size===0){if(Ia)return Ia;Ia=this}}ot.prototype.toString=function(){return this.size===0?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},ot.prototype.get=function(l,p){return this.has(l)?this._value:p},ot.prototype.includes=function(l){return qr(this._value,l)},ot.prototype.slice=function(l,p){var S=this.size;return tr(l,p,S)?this:new ot(this._value,Pe(p,S)-yr(l,S))},ot.prototype.reverse=function(){return this},ot.prototype.indexOf=function(l){return qr(this._value,l)?0:-1},ot.prototype.lastIndexOf=function(l){return qr(this._value,l)?this.size:-1},ot.prototype.__iterate=function(l,p){for(var S=0;S<this.size;S++)if(l(this._value,S,this)===!1)return S+1;return S},ot.prototype.__iterator=function(l,p){var S=this,A=0;return new Ie(function(){return A<S.size?_e(l,A++,S._value):h()})},ot.prototype.equals=function(l){return l instanceof ot?qr(this._value,l._value):na(l)};var Ia;function Jr(l,p){if(!l)throw new Error(p)}y(ut,Ir);function ut(l,p,S){if(!(this instanceof ut))return new ut(l,p,S);if(Jr(S!==0,"Cannot step a Range by 0"),l=l||0,p===void 0&&(p=1/0),S=S===void 0?1:Math.abs(S),p<l&&(S=-S),this._start=l,this._end=p,this._step=S,this.size=Math.max(0,Math.ceil((p-l)/S-1)+1),this.size===0){if(ba)return ba;ba=this}}ut.prototype.toString=function(){return this.size===0?"Range []":"Range [ "+this._start+"..."+this._end+(this._step!==1?" by "+this._step:"")+" ]"},ut.prototype.get=function(l,p){return this.has(l)?this._start+pr(this,l)*this._step:p},ut.prototype.includes=function(l){var p=(l-this._start)/this._step;return p>=0&&p<this.size&&p===Math.floor(p)},ut.prototype.slice=function(l,p){return tr(l,p,this.size)?this:(l=yr(l,this.size),p=Pe(p,this.size),p<=l?new ut(0,0):new ut(this.get(l,this._end),this.get(p,this._end),this._step))},ut.prototype.indexOf=function(l){var p=l-this._start;if(p%this._step===0){var S=p/this._step;if(S>=0&&S<this.size)return S}return-1},ut.prototype.lastIndexOf=function(l){return this.indexOf(l)},ut.prototype.__iterate=function(l,p){for(var S=this.size-1,A=this._step,b=p?this._start+S*A:this._start,G=0;G<=S;G++){if(l(b,G,this)===!1)return G+1;b+=p?-A:A}return G},ut.prototype.__iterator=function(l,p){var S=this.size-1,A=this._step,b=p?this._start+S*A:this._start,G=0;return new Ie(function(){var X=b;return b+=p?-A:A,G>S?h():_e(l,G++,X)})},ut.prototype.equals=function(l){return l instanceof ut?this._start===l._start&&this._end===l._end&&this._step===l._step:na(this,l)};var ba;y(St,j);function St(){throw TypeError("Abstract")}y(In,St);function In(){}y(bn,St);function bn(){}y(Bn,St);function Bn(){}St.Keyed=In,St.Indexed=bn,St.Set=Bn;var dn=typeof Math.imul=="function"&&Math.imul(4294967295,2)===-2?Math.imul:function(p,S){p=p|0,S=S|0;var A=p&65535,b=S&65535;return A*b+((p>>>16)*b+A*(S>>>16)<<16>>>0)|0};function aa(l){return l>>>1&1073741824|l&3221225471}function Ot(l){if(l===!1||l===null||l===void 0||typeof l.valueOf=="function"&&(l=l.valueOf(),l===!1||l===null||l===void 0))return 0;if(l===!0)return 1;var p=typeof l;if(p==="number"){if(l!==l||l===1/0)return 0;var S=l|0;for(S!==l&&(S^=l*4294967295);l>4294967295;)l/=4294967295,S^=l;return aa(S)}if(p==="string")return l.length>Qr?Fa(l):Na(l);if(typeof l.hashCode=="function")return l.hashCode();if(p==="object")return Ja(l);if(typeof l.toString=="function")return Na(l.toString());throw new Error("Value type "+p+" cannot be hashed.")}function Fa(l){var p=pn[l];return p===void 0&&(p=Na(l),tn===Vt&&(tn=0,pn={}),tn++,pn[l]=p),p}function Na(l){for(var p=0,S=0;S<l.length;S++)p=31*p+l.charCodeAt(S)|0;return aa(p)}function Ja(l){var p;if(ia&&(p=wa.get(l),p!==void 0)||(p=l[Mr],p!==void 0)||!Dr&&(p=l.propertyIsEnumerable&&l.propertyIsEnumerable[Mr],p!==void 0||(p=Yt(l),p!==void 0)))return p;if(p=++Pa,Pa&1073741824&&(Pa=0),ia)wa.set(l,p);else{if(Qa!==void 0&&Qa(l)===!1)throw new Error("Non-extensible objects are not allowed as keys.");if(Dr)Object.defineProperty(l,Mr,{enumerable:!1,configurable:!1,writable:!1,value:p});else if(l.propertyIsEnumerable!==void 0&&l.propertyIsEnumerable===l.constructor.prototype.propertyIsEnumerable)l.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},l.propertyIsEnumerable[Mr]=p;else if(l.nodeType!==void 0)l[Mr]=p;else throw new Error("Unable to set a non-enumerable property on object.")}return p}var Qa=Object.isExtensible,Dr=function(){try{return Object.defineProperty({},"@",{}),!0}catch{return!1}}();function Yt(l){if(l&&l.nodeType>0)switch(l.nodeType){case 1:return l.uniqueID;case 9:return l.documentElement&&l.documentElement.uniqueID}}var ia=typeof WeakMap=="function",wa;ia&&(wa=new WeakMap);var Pa=0,Mr="__immutablehash__";typeof Symbol=="function"&&(Mr=Symbol(Mr));var Qr=16,Vt=255,tn=0,pn={};function Nt(l){Jr(l!==1/0,"Cannot perform this action with an infinite size.")}y(lr,In);function lr(l){return l==null?$r():Er(l)&&!_(l)?l:$r().withMutations(function(p){var S=L(l);Nt(S.size),S.forEach(function(A,b){return p.set(b,A)})})}lr.of=function(){var l=ae.call(arguments,0);return $r().withMutations(function(p){for(var S=0;S<l.length;S+=2){if(S+1>=l.length)throw new Error("Missing value for key: "+l[S]);p.set(l[S],l[S+1])}})},lr.prototype.toString=function(){return this.__toString("Map {","}")},lr.prototype.get=function(l,p){return this._root?this._root.get(0,void 0,l,p):p},lr.prototype.set=function(l,p){return ft(this,l,p)},lr.prototype.setIn=function(l,p){return this.updateIn(l,me,function(){return p})},lr.prototype.remove=function(l){return ft(this,l,me)},lr.prototype.deleteIn=function(l){return this.updateIn(l,function(){return me})},lr.prototype.update=function(l,p,S){return arguments.length===1?l(this):this.updateIn([l],p,S)},lr.prototype.updateIn=function(l,p,S){S||(S=p,p=void 0);var A=to(this,Ar(l),p,S);return A===me?void 0:A},lr.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):$r()},lr.prototype.merge=function(){return ri(this,void 0,arguments)},lr.prototype.mergeWith=function(l){var p=ae.call(arguments,1);return ri(this,l,p)},lr.prototype.mergeIn=function(l){var p=ae.call(arguments,1);return this.updateIn(l,$r(),function(S){return typeof S.merge=="function"?S.merge.apply(S,p):p[p.length-1]})},lr.prototype.mergeDeep=function(){return ri(this,eo,arguments)},lr.prototype.mergeDeepWith=function(l){var p=ae.call(arguments,1);return ri(this,Ni(l),p)},lr.prototype.mergeDeepIn=function(l){var p=ae.call(arguments,1);return this.updateIn(l,$r(),function(S){return typeof S.mergeDeep=="function"?S.mergeDeep.apply(S,p):p[p.length-1]})},lr.prototype.sort=function(l){return Vr(fa(this,l))},lr.prototype.sortBy=function(l,p){return Vr(fa(this,p,l))},lr.prototype.withMutations=function(l){var p=this.asMutable();return l(p),p.wasAltered()?p.__ensureOwner(this.__ownerID):this},lr.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new ar)},lr.prototype.asImmutable=function(){return this.__ensureOwner()},lr.prototype.wasAltered=function(){return this.__altered},lr.prototype.__iterator=function(l,p){return new Tt(this,l,p)},lr.prototype.__iterate=function(l,p){var S=this,A=0;return this._root&&this._root.iterate(function(b){return A++,l(b[1],b[0],S)},p),A},lr.prototype.__ensureOwner=function(l){return l===this.__ownerID?this:l?be(this.size,this._root,l,this.__hash):(this.__ownerID=l,this.__altered=!1,this)};function Er(l){return!!(l&&l[Ur])}lr.isMap=Er;var Ur="@@__IMMUTABLE_MAP__@@",Le=lr.prototype;Le[Ur]=!0,Le[U]=Le.remove,Le.removeIn=Le.deleteIn;function Wn(l,p){this.ownerID=l,this.entries=p}Wn.prototype.get=function(l,p,S,A){for(var b=this.entries,G=0,X=b.length;G<X;G++)if(qr(S,b[G][0]))return b[G][1];return A},Wn.prototype.update=function(l,p,S,A,b,G,X){for(var ne=b===me,ce=this.entries,fe=0,ve=ce.length;fe<ve&&!qr(A,ce[fe][0]);fe++);var Ve=fe<ve;if(Ve?ce[fe][1]===b:ne)return this;if(Re(X),(ne||!Ve)&&Re(G),!(ne&&ce.length===1)){if(!Ve&&!ne&&ce.length>=oa)return Zi(l,ce,A,b);var Ge=l&&l===this.ownerID,ur=Ge?ce:Ke(ce);return Ve?ne?fe===ve-1?ur.pop():ur[fe]=ur.pop():ur[fe]=[A,b]:ur.push([A,b]),Ge?(this.entries=ur,this):new Wn(l,ur)}};function Jt(l,p,S){this.ownerID=l,this.bitmap=p,this.nodes=S}Jt.prototype.get=function(l,p,S,A){p===void 0&&(p=Ot(S));var b=1<<((l===0?p:p>>>l)&Te),G=this.bitmap;return G&b?this.nodes[wi(G&b-1)].get(l+K,p,S,A):A},Jt.prototype.update=function(l,p,S,A,b,G,X){S===void 0&&(S=Ot(A));var ne=(p===0?S:S>>>p)&Te,ce=1<<ne,fe=this.bitmap,ve=(fe&ce)!==0;if(!ve&&b===me)return this;var Ve=wi(fe&ce-1),Ge=this.nodes,ur=ve?Ge[Ve]:void 0,cr=Za(ur,l,p+K,S,A,b,G,X);if(cr===ur)return this;if(!ve&&cr&&Ge.length>=ua)return Ko(l,Ge,fe,ne,cr);if(ve&&!cr&&Ge.length===2&&ei(Ge[Ve^1]))return Ge[Ve^1];if(ve&&cr&&Ge.length===1&&ei(cr))return cr;var Ce=l&&l===this.ownerID,Bt=ve?cr?fe:fe^ce:fe|ce,jt=ve?cr?Zt(Ge,Ve,cr,Ce):no(Ge,Ve,Ce):ti(Ge,Ve,cr,Ce);return Ce?(this.bitmap=Bt,this.nodes=jt,this):new Jt(l,Bt,jt)};function Fn(l,p,S){this.ownerID=l,this.count=p,this.nodes=S}Fn.prototype.get=function(l,p,S,A){p===void 0&&(p=Ot(S));var b=(l===0?p:p>>>l)&Te,G=this.nodes[b];return G?G.get(l+K,p,S,A):A},Fn.prototype.update=function(l,p,S,A,b,G,X){S===void 0&&(S=Ot(A));var ne=(p===0?S:S>>>p)&Te,ce=b===me,fe=this.nodes,ve=fe[ne];if(ce&&!ve)return this;var Ve=Za(ve,l,p+K,S,A,b,G,X);if(Ve===ve)return this;var Ge=this.count;if(!ve)Ge++;else if(!Ve&&(Ge--,Ge<Yo))return Ho(l,fe,Ge,ne);var ur=l&&l===this.ownerID,cr=Zt(fe,ne,Ve,ur);return ur?(this.count=Ge,this.nodes=cr,this):new Fn(l,Ge,cr)};function Qt(l,p,S){this.ownerID=l,this.keyHash=p,this.entries=S}Qt.prototype.get=function(l,p,S,A){for(var b=this.entries,G=0,X=b.length;G<X;G++)if(qr(S,b[G][0]))return b[G][1];return A},Qt.prototype.update=function(l,p,S,A,b,G,X){S===void 0&&(S=Ot(A));var ne=b===me;if(S!==this.keyHash)return ne?this:(Re(X),Re(G),$n(this,l,p,S,[A,b]));for(var ce=this.entries,fe=0,ve=ce.length;fe<ve&&!qr(A,ce[fe][0]);fe++);var Ve=fe<ve;if(Ve?ce[fe][1]===b:ne)return this;if(Re(X),(ne||!Ve)&&Re(G),ne&&ve===2)return new Ne(l,this.keyHash,ce[fe^1]);var Ge=l&&l===this.ownerID,ur=Ge?ce:Ke(ce);return Ve?ne?fe===ve-1?ur.pop():ur[fe]=ur.pop():ur[fe]=[A,b]:ur.push([A,b]),Ge?(this.entries=ur,this):new Qt(l,this.keyHash,ur)};function Ne(l,p,S){this.ownerID=l,this.keyHash=p,this.entry=S}Ne.prototype.get=function(l,p,S,A){return qr(S,this.entry[0])?this.entry[1]:A},Ne.prototype.update=function(l,p,S,A,b,G,X){var ne=b===me,ce=qr(A,this.entry[0]);if(ce?b===this.entry[1]:ne)return this;if(Re(X),ne){Re(G);return}return ce?l&&l===this.ownerID?(this.entry[1]=b,this):new Ne(l,this.keyHash,[A,b]):(Re(G),$n(this,l,p,Ot(A),[A,b]))},Wn.prototype.iterate=Qt.prototype.iterate=function(l,p){for(var S=this.entries,A=0,b=S.length-1;A<=b;A++)if(l(S[p?b-A:A])===!1)return!1},Jt.prototype.iterate=Fn.prototype.iterate=function(l,p){for(var S=this.nodes,A=0,b=S.length-1;A<=b;A++){var G=S[p?b-A:A];if(G&&G.iterate(l,p)===!1)return!1}},Ne.prototype.iterate=function(l,p){return l(this.entry)},y(Tt,Ie);function Tt(l,p,S){this._type=p,this._reverse=S,this._stack=l._root&&ue(l._root)}Tt.prototype.next=function(){for(var l=this._type,p=this._stack;p;){var S=p.node,A=p.index++,b;if(S.entry){if(A===0)return Q(l,S.entry)}else if(S.entries){if(b=S.entries.length-1,A<=b)return Q(l,S.entries[this._reverse?b-A:A])}else if(b=S.nodes.length-1,A<=b){var G=S.nodes[this._reverse?b-A:A];if(G){if(G.entry)return Q(l,G.entry);p=this._stack=ue(G,p)}continue}p=this._stack=this._stack.__prev}return h()};function Q(l,p){return _e(l,p[0],p[1])}function ue(l,p){return{node:l,index:0,__prev:p}}function be(l,p,S,A){var b=Object.create(Le);return b.size=l,b._root=p,b.__ownerID=S,b.__hash=A,b.__altered=!1,b}var nr;function $r(){return nr||(nr=be(0))}function ft(l,p,S){var A,b;if(l._root){var G=Ue(Xe),X=Ue(Be);if(A=Za(l._root,l.__ownerID,0,void 0,p,S,G,X),!X.value)return l;b=l.size+(G.value?S===me?-1:1:0)}else{if(S===me)return l;b=1,A=new Wn(l.__ownerID,[[p,S]])}return l.__ownerID?(l.size=b,l._root=A,l.__hash=void 0,l.__altered=!0,l):A?be(b,A):$r()}function Za(l,p,S,A,b,G,X,ne){return l?l.update(p,S,A,b,G,X,ne):G===me?l:(Re(ne),Re(X),new Ne(p,A,[b,G]))}function ei(l){return l.constructor===Ne||l.constructor===Qt}function $n(l,p,S,A,b){if(l.keyHash===A)return new Qt(p,A,[l.entry,b]);var G=(S===0?l.keyHash:l.keyHash>>>S)&Te,X=(S===0?A:A>>>S)&Te,ne,ce=G===X?[$n(l,p,S+K,A,b)]:(ne=new Ne(p,A,b),G<X?[l,ne]:[ne,l]);return new Jt(p,1<<G|1<<X,ce)}function Zi(l,p,S,A){l||(l=new ar);for(var b=new Ne(l,Ot(S),[S,A]),G=0;G<p.length;G++){var X=p[G];b=b.update(l,0,void 0,X[0],X[1])}return b}function Ho(l,p,S,A){for(var b=0,G=0,X=new Array(S),ne=0,ce=1,fe=p.length;ne<fe;ne++,ce<<=1){var ve=p[ne];ve!==void 0&&ne!==A&&(b|=ce,X[G++]=ve)}return new Jt(l,b,X)}function Ko(l,p,S,A,b){for(var G=0,X=new Array(Y),ne=0;S!==0;ne++,S>>>=1)X[ne]=S&1?p[G++]:void 0;return X[A]=b,new Fn(l,G+1,X)}function ri(l,p,S){for(var A=[],b=0;b<S.length;b++){var G=S[b],X=L(G);H(G)||(X=X.map(function(ne){return Cn(ne)})),A.push(X)}return ro(l,p,A)}function eo(l,p,S){return l&&l.mergeDeep&&H(p)?l.mergeDeep(p):qr(l,p)?l:p}function Ni(l){return function(p,S,A){if(p&&p.mergeDeepWith&&H(S))return p.mergeDeepWith(l,S);var b=l(p,S,A);return qr(p,b)?p:b}}function ro(l,p,S){return S=S.filter(function(A){return A.size!==0}),S.length===0?l:l.size===0&&!l.__ownerID&&S.length===1?l.constructor(S[0]):l.withMutations(function(A){for(var b=p?function(X,ne){A.update(ne,me,function(ce){return ce===me?X:p(ce,X,ne)})}:function(X,ne){A.set(ne,X)},G=0;G<S.length;G++)S[G].forEach(b)})}function to(l,p,S,A){var b=l===me,G=p.next();if(G.done){var X=b?S:l,ne=A(X);return ne===X?l:ne}Jr(b||l&&l.set,"invalid keyPath");var ce=G.value,fe=b?me:l.get(ce,me),ve=to(fe,p,S,A);return ve===fe?l:ve===me?l.remove(ce):(b?$r():l).set(ce,ve)}function wi(l){return l=l-(l>>1&1431655765),l=(l&858993459)+(l>>2&858993459),l=l+(l>>4)&252645135,l=l+(l>>8),l=l+(l>>16),l&127}function Zt(l,p,S,A){var b=A?l:Ke(l);return b[p]=S,b}function ti(l,p,S,A){var b=l.length+1;if(A&&p+1===b)return l[p]=S,l;for(var G=new Array(b),X=0,ne=0;ne<b;ne++)ne===p?(G[ne]=S,X=-1):G[ne]=l[ne+X];return G}function no(l,p,S){var A=l.length-1;if(S&&p===A)return l.pop(),l;for(var b=new Array(A),G=0,X=0;X<A;X++)X===p&&(G=1),b[X]=l[X+G];return b}var oa=Y/4,ua=Y/2,Yo=Y/4;y(Hr,bn);function Hr(l){var p=ai();if(l==null)return p;if(ao(l))return l;var S=D(l),A=S.size;return A===0?p:(Nt(A),A>0&&A<Y?Da(0,A,K,null,new Nn(S.toArray())):p.withMutations(function(b){b.setSize(A),S.forEach(function(G,X){return b.set(X,G)})}))}Hr.of=function(){return this(arguments)},Hr.prototype.toString=function(){return this.__toString("List [","]")},Hr.prototype.get=function(l,p){if(l=pr(this,l),l>=0&&l<this.size){l+=this._origin;var S=_i(this,l);return S&&S.array[l&Te]}return p},Hr.prototype.set=function(l,p){return zo(this,l,p)},Hr.prototype.remove=function(l){return this.has(l)?l===0?this.shift():l===this.size-1?this.pop():this.splice(l,1):this},Hr.prototype.insert=function(l,p){return this.splice(l,0,p)},Hr.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=K,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):ai()},Hr.prototype.push=function(){var l=arguments,p=this.size;return this.withMutations(function(S){wn(S,0,p+l.length);for(var A=0;A<l.length;A++)S.set(p+A,l[A])})},Hr.prototype.pop=function(){return wn(this,0,-1)},Hr.prototype.unshift=function(){var l=arguments;return this.withMutations(function(p){wn(p,-l.length);for(var S=0;S<l.length;S++)p.set(S,l[S])})},Hr.prototype.shift=function(){return wn(this,1)},Hr.prototype.merge=function(){return ii(this,void 0,arguments)},Hr.prototype.mergeWith=function(l){var p=ae.call(arguments,1);return ii(this,l,p)},Hr.prototype.mergeDeep=function(){return ii(this,eo,arguments)},Hr.prototype.mergeDeepWith=function(l){var p=ae.call(arguments,1);return ii(this,Ni(l),p)},Hr.prototype.setSize=function(l){return wn(this,0,l)},Hr.prototype.slice=function(l,p){var S=this.size;return tr(l,p,S)?this:wn(this,yr(l,S),Pe(p,S))},Hr.prototype.__iterator=function(l,p){var S=0,A=ni(this,p);return new Ie(function(){var b=A();return b===_a?h():_e(l,S++,b)})},Hr.prototype.__iterate=function(l,p){for(var S=0,A=ni(this,p),b;(b=A())!==_a&&l(b,S++,this)!==!1;);return S},Hr.prototype.__ensureOwner=function(l){return l===this.__ownerID?this:l?Da(this._origin,this._capacity,this._level,this._root,this._tail,l,this.__hash):(this.__ownerID=l,this)};function ao(l){return!!(l&&l[io])}Hr.isList=ao;var io="@@__IMMUTABLE_LIST__@@",wt=Hr.prototype;wt[io]=!0,wt[U]=wt.remove,wt.setIn=Le.setIn,wt.deleteIn=wt.removeIn=Le.removeIn,wt.update=Le.update,wt.updateIn=Le.updateIn,wt.mergeIn=Le.mergeIn,wt.mergeDeepIn=Le.mergeDeepIn,wt.withMutations=Le.withMutations,wt.asMutable=Le.asMutable,wt.asImmutable=Le.asImmutable,wt.wasAltered=Le.wasAltered;function Nn(l,p){this.array=l,this.ownerID=p}Nn.prototype.removeBefore=function(l,p,S){if(S===p?1<<p:this.array.length===0)return this;var A=S>>>p&Te;if(A>=this.array.length)return new Nn([],l);var b=A===0,G;if(p>0){var X=this.array[A];if(G=X&&X.removeBefore(l,p-K,S),G===X&&b)return this}if(b&&!G)return this;var ne=sa(this,l);if(!b)for(var ce=0;ce<A;ce++)ne.array[ce]=void 0;return G&&(ne.array[A]=G),ne},Nn.prototype.removeAfter=function(l,p,S){if(S===(p?1<<p:0)||this.array.length===0)return this;var A=S-1>>>p&Te;if(A>=this.array.length)return this;var b;if(p>0){var G=this.array[A];if(b=G&&G.removeAfter(l,p-K,S),b===G&&A===this.array.length-1)return this}var X=sa(this,l);return X.array.splice(A+1),b&&(X.array[A]=b),X};var _a={};function ni(l,p){var S=l._origin,A=l._capacity,b=Ma(A),G=l._tail;return X(l._root,l._level,0);function X(fe,ve,Ve){return ve===0?ne(fe,Ve):ce(fe,ve,Ve)}function ne(fe,ve){var Ve=ve===b?G&&G.array:fe&&fe.array,Ge=ve>S?0:S-ve,ur=A-ve;return ur>Y&&(ur=Y),function(){if(Ge===ur)return _a;var cr=p?--ur:Ge++;return Ve&&Ve[cr]}}function ce(fe,ve,Ve){var Ge,ur=fe&&fe.array,cr=Ve>S?0:S-Ve>>ve,Ce=(A-Ve>>ve)+1;return Ce>Y&&(Ce=Y),function(){do{if(Ge){var Bt=Ge();if(Bt!==_a)return Bt;Ge=null}if(cr===Ce)return _a;var jt=p?--Ce:cr++;Ge=X(ur&&ur[jt],ve-K,Ve+(jt<<ve))}while(!0)}}}function Da(l,p,S,A,b,G,X){var ne=Object.create(wt);return ne.size=p-l,ne._origin=l,ne._capacity=p,ne._level=S,ne._root=A,ne._tail=b,ne.__ownerID=G,ne.__hash=X,ne.__altered=!1,ne}var oo;function ai(){return oo||(oo=Da(0,0,K))}function zo(l,p,S){if(p=pr(l,p),p!==p)return l;if(p>=l.size||p<0)return l.withMutations(function(X){p<0?wn(X,p).set(0,S):wn(X,0,p+1).set(p,S)});p+=l._origin;var A=l._tail,b=l._root,G=Ue(Be);return p>=Ma(l._capacity)?A=Pi(A,l.__ownerID,0,p,S,G):b=Pi(b,l.__ownerID,l._level,p,S,G),G.value?l.__ownerID?(l._root=b,l._tail=A,l.__hash=void 0,l.__altered=!0,l):Da(l._origin,l._capacity,l._level,b,A):l}function Pi(l,p,S,A,b,G){var X=A>>>S&Te,ne=l&&X<l.array.length;if(!ne&&b===void 0)return l;var ce;if(S>0){var fe=l&&l.array[X],ve=Pi(fe,p,S-K,A,b,G);return ve===fe?l:(ce=sa(l,p),ce.array[X]=ve,ce)}return ne&&l.array[X]===b?l:(Re(G),ce=sa(l,p),b===void 0&&X===ce.array.length-1?ce.array.pop():ce.array[X]=b,ce)}function sa(l,p){return p&&l&&p===l.ownerID?l:new Nn(l?l.array.slice():[],p)}function _i(l,p){if(p>=Ma(l._capacity))return l._tail;if(p<1<<l._level+K){for(var S=l._root,A=l._level;S&&A>0;)S=S.array[p>>>A&Te],A-=K;return S}}function wn(l,p,S){p!==void 0&&(p=p|0),S!==void 0&&(S=S|0);var A=l.__ownerID||new ar,b=l._origin,G=l._capacity,X=b+p,ne=S===void 0?G:S<0?G+S:b+S;if(X===b&&ne===G)return l;if(X>=ne)return l.clear();for(var ce=l._level,fe=l._root,ve=0;X+ve<0;)fe=new Nn(fe&&fe.array.length?[void 0,fe]:[],A),ce+=K,ve+=1<<ce;ve&&(X+=ve,b+=ve,ne+=ve,G+=ve);for(var Ve=Ma(G),Ge=Ma(ne);Ge>=1<<ce+K;)fe=new Nn(fe&&fe.array.length?[fe]:[],A),ce+=K;var ur=l._tail,cr=Ge<Ve?_i(l,ne-1):Ge>Ve?new Nn([],A):ur;if(ur&&Ge>Ve&&X<G&&ur.array.length){fe=sa(fe,A);for(var Ce=fe,Bt=ce;Bt>K;Bt-=K){var jt=Ve>>>Bt&Te;Ce=Ce.array[jt]=sa(Ce.array[jt],A)}Ce.array[Ve>>>K&Te]=ur}if(ne<G&&(cr=cr&&cr.removeAfter(A,0,ne)),X>=Ge)X-=Ge,ne-=Ge,ce=K,fe=null,cr=cr&&cr.removeBefore(A,0,X);else if(X>b||Ge<Ve){for(ve=0;fe;){var ja=X>>>ce&Te;if(ja!==Ge>>>ce&Te)break;ja&&(ve+=(1<<ce)*ja),ce-=K,fe=fe.array[ja]}fe&&X>b&&(fe=fe.removeBefore(A,ce,X-ve)),fe&&Ge<Ve&&(fe=fe.removeAfter(A,ce,Ge-ve)),ve&&(X-=ve,ne-=ve)}return l.__ownerID?(l.size=ne-X,l._origin=X,l._capacity=ne,l._level=ce,l._root=fe,l._tail=cr,l.__hash=void 0,l.__altered=!0,l):Da(X,ne,ce,fe,cr)}function ii(l,p,S){for(var A=[],b=0,G=0;G<S.length;G++){var X=S[G],ne=D(X);ne.size>b&&(b=ne.size),H(X)||(ne=ne.map(function(ce){return Cn(ce)})),A.push(ne)}return b>l.size&&(l=l.setSize(b)),ro(l,p,A)}function Ma(l){return l<Y?0:l-1>>>K<<K}y(Vr,lr);function Vr(l){return l==null?ui():uo(l)?l:ui().withMutations(function(p){var S=L(l);Nt(S.size),S.forEach(function(A,b){return p.set(b,A)})})}Vr.of=function(){return this(arguments)},Vr.prototype.toString=function(){return this.__toString("OrderedMap {","}")},Vr.prototype.get=function(l,p){var S=this._map.get(l);return S!==void 0?this._list.get(S)[1]:p},Vr.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):ui()},Vr.prototype.set=function(l,p){return Va(this,l,p)},Vr.prototype.remove=function(l){return Va(this,l,me)},Vr.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},Vr.prototype.__iterate=function(l,p){var S=this;return this._list.__iterate(function(A){return A&&l(A[1],A[0],S)},p)},Vr.prototype.__iterator=function(l,p){return this._list.fromEntrySeq().__iterator(l,p)},Vr.prototype.__ensureOwner=function(l){if(l===this.__ownerID)return this;var p=this._map.__ensureOwner(l),S=this._list.__ensureOwner(l);return l?oi(p,S,l,this.__hash):(this.__ownerID=l,this._map=p,this._list=S,this)};function uo(l){return Er(l)&&_(l)}Vr.isOrderedMap=uo,Vr.prototype[M]=!0,Vr.prototype[U]=Vr.prototype.remove;function oi(l,p,S,A){var b=Object.create(Vr.prototype);return b.size=l?l.size:0,b._map=l,b._list=p,b.__ownerID=S,b.__hash=A,b}var so;function ui(){return so||(so=oi($r(),ai()))}function Va(l,p,S){var A=l._map,b=l._list,G=A.get(p),X=G!==void 0,ne,ce;if(S===me){if(!X)return l;b.size>=Y&&b.size>=A.size*2?(ce=b.filter(function(fe,ve){return fe!==void 0&&G!==ve}),ne=ce.toKeyedSeq().map(function(fe){return fe[0]}).flip().toMap(),l.__ownerID&&(ne.__ownerID=ce.__ownerID=l.__ownerID)):(ne=A.remove(p),ce=G===b.size-1?b.pop():b.set(G,void 0))}else if(X){if(S===b.get(G)[1])return l;ne=A,ce=b.set(G,[p,S])}else ne=A.set(p,b.size),ce=b.set(b.size,[p,S]);return l.__ownerID?(l.size=ne.size,l._map=ne,l._list=ce,l.__hash=void 0,l):oi(ne,ce)}y(zt,ct);function zt(l,p){this._iter=l,this._useKeys=p,this.size=l.size}zt.prototype.get=function(l,p){return this._iter.get(l,p)},zt.prototype.has=function(l){return this._iter.has(l)},zt.prototype.valueSeq=function(){return this._iter.valueSeq()},zt.prototype.reverse=function(){var l=this,p=vn(this,!0);return this._useKeys||(p.valueSeq=function(){return l._iter.toSeq().reverse()}),p},zt.prototype.map=function(l,p){var S=this,A=co(this,l,p);return this._useKeys||(A.valueSeq=function(){return S._iter.toSeq().map(l,p)}),A},zt.prototype.__iterate=function(l,p){var S=this,A;return this._iter.__iterate(this._useKeys?function(b,G){return l(b,G,S)}:(A=p?Pr(this):0,function(b){return l(b,p?--A:A++,S)}),p)},zt.prototype.__iterator=function(l,p){if(this._useKeys)return this._iter.__iterator(l,p);var S=this._iter.__iterator(Wr,p),A=p?Pr(this):0;return new Ie(function(){var b=S.next();return b.done?b:_e(l,p?--A:A++,b.value,b)})},zt.prototype[M]=!0,y(Hn,Ir);function Hn(l){this._iter=l,this.size=l.size}Hn.prototype.includes=function(l){return this._iter.includes(l)},Hn.prototype.__iterate=function(l,p){var S=this,A=0;return this._iter.__iterate(function(b){return l(b,A++,S)},p)},Hn.prototype.__iterator=function(l,p){var S=this._iter.__iterator(Wr,p),A=0;return new Ie(function(){var b=S.next();return b.done?b:_e(l,A++,b.value,b)})},y(la,xt);function la(l){this._iter=l,this.size=l.size}la.prototype.has=function(l){return this._iter.includes(l)},la.prototype.__iterate=function(l,p){var S=this;return this._iter.__iterate(function(A){return l(A,A,S)},p)},la.prototype.__iterator=function(l,p){var S=this._iter.__iterator(Wr,p);return new Ie(function(){var A=S.next();return A.done?A:_e(l,A.value,A.value,A)})},y(ca,ct);function ca(l){this._iter=l,this.size=l.size}ca.prototype.entrySeq=function(){return this._iter.toSeq()},ca.prototype.__iterate=function(l,p){var S=this;return this._iter.__iterate(function(A){if(A){Fr(A);var b=H(A);return l(b?A.get(1):A[1],b?A.get(0):A[0],S)}},p)},ca.prototype.__iterator=function(l,p){var S=this._iter.__iterator(Wr,p);return new Ie(function(){for(;;){var A=S.next();if(A.done)return A;var b=A.value;if(b){Fr(b);var G=H(b);return _e(l,G?b.get(0):b[0],G?b.get(1):b[1],A)}}})},Hn.prototype.cacheResult=zt.prototype.cacheResult=la.prototype.cacheResult=ca.prototype.cacheResult=we;function lo(l){var p=Se(l);return p._iter=l,p.size=l.size,p.flip=function(){return l},p.reverse=function(){var S=l.reverse.apply(this);return S.flip=function(){return l.reverse()},S},p.has=function(S){return l.includes(S)},p.includes=function(S){return l.has(S)},p.cacheResult=we,p.__iterateUncached=function(S,A){var b=this;return l.__iterate(function(G,X){return S(X,G,b)!==!1},A)},p.__iteratorUncached=function(S,A){if(S===kr){var b=l.__iterator(S,A);return new Ie(function(){var G=b.next();if(!G.done){var X=G.value[0];G.value[0]=G.value[1],G.value[1]=X}return G})}return l.__iterator(S===Wr?N:Wr,A)},p}function co(l,p,S){var A=Se(l);return A.size=l.size,A.has=function(b){return l.has(b)},A.get=function(b,G){var X=l.get(b,me);return X===me?G:p.call(S,X,b,l)},A.__iterateUncached=function(b,G){var X=this;return l.__iterate(function(ne,ce,fe){return b(p.call(S,ne,ce,fe),ce,X)!==!1},G)},A.__iteratorUncached=function(b,G){var X=l.__iterator(kr,G);return new Ie(function(){var ne=X.next();if(ne.done)return ne;var ce=ne.value,fe=ce[0];return _e(b,fe,p.call(S,ce[1],fe,l),ne)})},A}function vn(l,p){var S=Se(l);return S._iter=l,S.size=l.size,S.reverse=function(){return l},l.flip&&(S.flip=function(){var A=lo(l);return A.reverse=function(){return l.flip()},A}),S.get=function(A,b){return l.get(p?A:-1-A,b)},S.has=function(A){return l.has(p?A:-1-A)},S.includes=function(A){return l.includes(A)},S.cacheResult=we,S.__iterate=function(A,b){var G=this;return l.__iterate(function(X,ne){return A(X,ne,G)},!b)},S.__iterator=function(A,b){return l.__iterator(A,!b)},S}function fo(l,p,S,A){var b=Se(l);return A&&(b.has=function(G){var X=l.get(G,me);return X!==me&&!!p.call(S,X,G,l)},b.get=function(G,X){var ne=l.get(G,me);return ne!==me&&p.call(S,ne,G,l)?ne:X}),b.__iterateUncached=function(G,X){var ne=this,ce=0;return l.__iterate(function(fe,ve,Ve){if(p.call(S,fe,ve,Ve))return ce++,G(fe,A?ve:ce-1,ne)},X),ce},b.__iteratorUncached=function(G,X){var ne=l.__iterator(kr,X),ce=0;return new Ie(function(){for(;;){var fe=ne.next();if(fe.done)return fe;var ve=fe.value,Ve=ve[0],Ge=ve[1];if(p.call(S,Ge,Ve,l))return _e(G,A?Ve:ce++,Ge,fe)}})},b}function Xo(l,p,S){var A=lr().asMutable();return l.__iterate(function(b,G){A.update(p.call(S,b,G,l),0,function(X){return X+1})}),A.asImmutable()}function qo(l,p,S){var A=I(l),b=(_(l)?Vr():lr()).asMutable();l.__iterate(function(X,ne){b.update(p.call(S,X,ne,l),function(ce){return ce=ce||[],ce.push(A?[ne,X]:X),ce})});var G=$e(l);return b.map(function(X){return Qe(l,G(X))})}function Di(l,p,S,A){var b=l.size;if(p!==void 0&&(p=p|0),S!==void 0&&(S===1/0?S=b:S=S|0),tr(p,S,b))return l;var G=yr(p,b),X=Pe(S,b);if(G!==G||X!==X)return Di(l.toSeq().cacheResult(),p,S,A);var ne=X-G,ce;ne===ne&&(ce=ne<0?0:ne);var fe=Se(l);return fe.size=ce===0?ce:l.size&&ce||void 0,!A&&La(l)&&ce>=0&&(fe.get=function(ve,Ve){return ve=pr(this,ve),ve>=0&&ve<ce?l.get(ve+G,Ve):Ve}),fe.__iterateUncached=function(ve,Ve){var Ge=this;if(ce===0)return 0;if(Ve)return this.cacheResult().__iterate(ve,Ve);var ur=0,cr=!0,Ce=0;return l.__iterate(function(Bt,jt){if(!(cr&&(cr=ur++<G)))return Ce++,ve(Bt,A?jt:Ce-1,Ge)!==!1&&Ce!==ce}),Ce},fe.__iteratorUncached=function(ve,Ve){if(ce!==0&&Ve)return this.cacheResult().__iterator(ve,Ve);var Ge=ce!==0&&l.__iterator(ve,Ve),ur=0,cr=0;return new Ie(function(){for(;ur++<G;)Ge.next();if(++cr>ce)return h();var Ce=Ge.next();return A||ve===Wr?Ce:ve===N?_e(ve,cr-1,void 0,Ce):_e(ve,cr-1,Ce.value[1],Ce)})},fe}function Jo(l,p,S){var A=Se(l);return A.__iterateUncached=function(b,G){var X=this;if(G)return this.cacheResult().__iterate(b,G);var ne=0;return l.__iterate(function(ce,fe,ve){return p.call(S,ce,fe,ve)&&++ne&&b(ce,fe,X)}),ne},A.__iteratorUncached=function(b,G){var X=this;if(G)return this.cacheResult().__iterator(b,G);var ne=l.__iterator(kr,G),ce=!0;return new Ie(function(){if(!ce)return h();var fe=ne.next();if(fe.done)return fe;var ve=fe.value,Ve=ve[0],Ge=ve[1];return p.call(S,Ge,Ve,X)?b===kr?fe:_e(b,Ve,Ge,fe):(ce=!1,h())})},A}function Kn(l,p,S,A){var b=Se(l);return b.__iterateUncached=function(G,X){var ne=this;if(X)return this.cacheResult().__iterate(G,X);var ce=!0,fe=0;return l.__iterate(function(ve,Ve,Ge){if(!(ce&&(ce=p.call(S,ve,Ve,Ge))))return fe++,G(ve,A?Ve:fe-1,ne)}),fe},b.__iteratorUncached=function(G,X){var ne=this;if(X)return this.cacheResult().__iterator(G,X);var ce=l.__iterator(kr,X),fe=!0,ve=0;return new Ie(function(){var Ve,Ge,ur;do{if(Ve=ce.next(),Ve.done)return A||G===Wr?Ve:G===N?_e(G,ve++,void 0,Ve):_e(G,ve++,Ve.value[1],Ve);var cr=Ve.value;Ge=cr[0],ur=cr[1],fe&&(fe=p.call(S,ur,Ge,ne))}while(fe);return G===kr?Ve:_e(G,Ge,ur,Ve)})},b}function Qo(l,p){var S=I(l),A=[l].concat(p).map(function(X){return H(X)?S&&(X=L(X)):X=S?fn(X):Gt(Array.isArray(X)?X:[X]),X}).filter(function(X){return X.size!==0});if(A.length===0)return l;if(A.length===1){var b=A[0];if(b===l||S&&I(b)||C(l)&&C(b))return b}var G=new ht(A);return S?G=G.toKeyedSeq():C(l)||(G=G.toSetSeq()),G=G.flatten(!0),G.size=A.reduce(function(X,ne){if(X!==void 0){var ce=ne.size;if(ce!==void 0)return X+ce}},0),G}function po(l,p,S){var A=Se(l);return A.__iterateUncached=function(b,G){var X=0,ne=!1;function ce(fe,ve){var Ve=this;fe.__iterate(function(Ge,ur){return(!p||ve<p)&&H(Ge)?ce(Ge,ve+1):b(Ge,S?ur:X++,Ve)===!1&&(ne=!0),!ne},G)}return ce(l,0),X},A.__iteratorUncached=function(b,G){var X=l.__iterator(b,G),ne=[],ce=0;return new Ie(function(){for(;X;){var fe=X.next();if(fe.done!==!1){X=ne.pop();continue}var ve=fe.value;if(b===kr&&(ve=ve[1]),(!p||ne.length<p)&&H(ve))ne.push(X),X=ve.__iterator(b,G);else return S?fe:_e(b,ce++,ve,fe)}return h()})},A}function Zo(l,p,S){var A=$e(l);return l.toSeq().map(function(b,G){return A(p.call(S,b,G,l))}).flatten(!0)}function eu(l,p){var S=Se(l);return S.size=l.size&&l.size*2-1,S.__iterateUncached=function(A,b){var G=this,X=0;return l.__iterate(function(ne,ce){return(!X||A(p,X++,G)!==!1)&&A(ne,X++,G)!==!1},b),X},S.__iteratorUncached=function(A,b){var G=l.__iterator(Wr,b),X=0,ne;return new Ie(function(){return(!ne||X%2)&&(ne=G.next(),ne.done)?ne:X%2?_e(A,X++,p):_e(A,X++,ne.value,ne)})},S}function fa(l,p,S){p||(p=qe);var A=I(l),b=0,G=l.toSeq().map(function(X,ne){return[ne,X,b++,S?S(X,ne,l):X]}).toArray();return G.sort(function(X,ne){return p(X[3],ne[3])||X[2]-ne[2]}).forEach(A?function(X,ne){G[ne].length=2}:function(X,ne){G[ne]=X[1]}),A?ct(G):C(l)?Ir(G):xt(G)}function si(l,p,S){if(p||(p=qe),S){var A=l.toSeq().map(function(b,G){return[b,S(b,G,l)]}).reduce(function(b,G){return br(p,b[1],G[1])?G:b});return A&&A[0]}else return l.reduce(function(b,G){return br(p,b,G)?G:b})}function br(l,p,S){var A=l(S,p);return A===0&&S!==p&&(S==null||S!==S)||A>0}function Tr(l,p,S){var A=Se(l);return A.size=new ht(S).map(function(b){return b.size}).min(),A.__iterate=function(b,G){for(var X=this.__iterator(Wr,G),ne,ce=0;!(ne=X.next()).done&&b(ne.value,ce++,this)!==!1;);return ce},A.__iteratorUncached=function(b,G){var X=S.map(function(fe){return fe=j(fe),or(G?fe.reverse():fe)}),ne=0,ce=!1;return new Ie(function(){var fe;return ce||(fe=X.map(function(ve){return ve.next()}),ce=fe.some(function(ve){return ve.done})),ce?h():_e(b,ne++,p.apply(null,fe.map(function(ve){return ve.value})))})},A}function Qe(l,p){return La(l)?p:l.constructor(p)}function Fr(l){if(l!==Object(l))throw new TypeError("Expected [K, V] tuple: "+l)}function Pr(l){return Nt(l.size),dr(l)}function $e(l){return I(l)?L:C(l)?D:B}function Se(l){return Object.create((I(l)?ct:C(l)?Ir:xt).prototype)}function we(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):sr.prototype.cacheResult.call(this)}function qe(l,p){return l>p?1:l<p?-1:0}function Ar(l){var p=or(l);if(!p){if(!lt(l))throw new TypeError("Expected iterable or array-like: "+l);p=or(j(l))}return p}y(vr,In);function vr(l,p){var S,A=function(X){if(X instanceof A)return X;if(!(this instanceof A))return new A(X);if(!S){S=!0;var ne=Object.keys(l);ru(b,ne),b.size=ne.length,b._name=p,b._keys=ne,b._defaultValues=l}this._map=lr(X)},b=A.prototype=Object.create(Me);return b.constructor=A,A}vr.prototype.toString=function(){return this.__toString(jr(this)+" {","}")},vr.prototype.has=function(l){return this._defaultValues.hasOwnProperty(l)},vr.prototype.get=function(l,p){if(!this.has(l))return p;var S=this._defaultValues[l];return this._map?this._map.get(l,S):S},vr.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var l=this.constructor;return l._empty||(l._empty=li(this,$r()))},vr.prototype.set=function(l,p){if(!this.has(l))throw new Error('Cannot set unknown key "'+l+'" on '+jr(this));if(this._map&&!this._map.has(l)){var S=this._defaultValues[l];if(p===S)return this}var A=this._map&&this._map.set(l,p);return this.__ownerID||A===this._map?this:li(this,A)},vr.prototype.remove=function(l){if(!this.has(l))return this;var p=this._map&&this._map.remove(l);return this.__ownerID||p===this._map?this:li(this,p)},vr.prototype.wasAltered=function(){return this._map.wasAltered()},vr.prototype.__iterator=function(l,p){var S=this;return L(this._defaultValues).map(function(A,b){return S.get(b)}).__iterator(l,p)},vr.prototype.__iterate=function(l,p){var S=this;return L(this._defaultValues).map(function(A,b){return S.get(b)}).__iterate(l,p)},vr.prototype.__ensureOwner=function(l){if(l===this.__ownerID)return this;var p=this._map&&this._map.__ensureOwner(l);return l?li(this,p,l):(this.__ownerID=l,this._map=p,this)};var Me=vr.prototype;Me[U]=Me.remove,Me.deleteIn=Me.removeIn=Le.removeIn,Me.merge=Le.merge,Me.mergeWith=Le.mergeWith,Me.mergeIn=Le.mergeIn,Me.mergeDeep=Le.mergeDeep,Me.mergeDeepWith=Le.mergeDeepWith,Me.mergeDeepIn=Le.mergeDeepIn,Me.setIn=Le.setIn,Me.update=Le.update,Me.updateIn=Le.updateIn,Me.withMutations=Le.withMutations,Me.asMutable=Le.asMutable,Me.asImmutable=Le.asImmutable;function li(l,p,S){var A=Object.create(Object.getPrototypeOf(l));return A._map=p,A.__ownerID=S,A}function jr(l){return l._name||l.constructor.name||"Record"}function ru(l,p){try{p.forEach(_r.bind(void 0,l))}catch{}}function _r(l,p){Object.defineProperty(l,p,{get:function(){return this.get(p)},set:function(S){Jr(this.__ownerID,"Cannot set on an immutable record."),this.set(p,S)}})}y(Kr,Bn);function Kr(l){return l==null?Mi():gn(l)&&!_(l)?l:Mi().withMutations(function(p){var S=B(l);Nt(S.size),S.forEach(function(A){return p.add(A)})})}Kr.of=function(){return this(arguments)},Kr.fromKeys=function(l){return this(L(l).keySeq())},Kr.prototype.toString=function(){return this.__toString("Set {","}")},Kr.prototype.has=function(l){return this._map.has(l)},Kr.prototype.add=function(l){return da(this,this._map.set(l,!0))},Kr.prototype.remove=function(l){return da(this,this._map.remove(l))},Kr.prototype.clear=function(){return da(this,this._map.clear())},Kr.prototype.union=function(){var l=ae.call(arguments,0);return l=l.filter(function(p){return p.size!==0}),l.length===0?this:this.size===0&&!this.__ownerID&&l.length===1?this.constructor(l[0]):this.withMutations(function(p){for(var S=0;S<l.length;S++)B(l[S]).forEach(function(A){return p.add(A)})})},Kr.prototype.intersect=function(){var l=ae.call(arguments,0);if(l.length===0)return this;l=l.map(function(S){return B(S)});var p=this;return this.withMutations(function(S){p.forEach(function(A){l.every(function(b){return b.includes(A)})||S.remove(A)})})},Kr.prototype.subtract=function(){var l=ae.call(arguments,0);if(l.length===0)return this;l=l.map(function(S){return B(S)});var p=this;return this.withMutations(function(S){p.forEach(function(A){l.some(function(b){return b.includes(A)})&&S.remove(A)})})},Kr.prototype.merge=function(){return this.union.apply(this,arguments)},Kr.prototype.mergeWith=function(l){var p=ae.call(arguments,1);return this.union.apply(this,p)},Kr.prototype.sort=function(l){return Pt(fa(this,l))},Kr.prototype.sortBy=function(l,p){return Pt(fa(this,p,l))},Kr.prototype.wasAltered=function(){return this._map.wasAltered()},Kr.prototype.__iterate=function(l,p){var S=this;return this._map.__iterate(function(A,b){return l(b,b,S)},p)},Kr.prototype.__iterator=function(l,p){return this._map.map(function(S,A){return A}).__iterator(l,p)},Kr.prototype.__ensureOwner=function(l){if(l===this.__ownerID)return this;var p=this._map.__ensureOwner(l);return l?this.__make(p,l):(this.__ownerID=l,this._map=p,this)};function gn(l){return!!(l&&l[Yn])}Kr.isSet=gn;var Yn="@@__IMMUTABLE_SET__@@",Rr=Kr.prototype;Rr[Yn]=!0,Rr[U]=Rr.remove,Rr.mergeDeep=Rr.merge,Rr.mergeDeepWith=Rr.mergeWith,Rr.withMutations=Le.withMutations,Rr.asMutable=Le.asMutable,Rr.asImmutable=Le.asImmutable,Rr.__empty=Mi,Rr.__make=pa;function da(l,p){return l.__ownerID?(l.size=p.size,l._map=p,l):p===l._map?l:p.size===0?l.__empty():l.__make(p)}function pa(l,p){var S=Object.create(Rr);return S.size=l?l.size:0,S._map=l,S.__ownerID=p,S}var vo;function Mi(){return vo||(vo=pa($r()))}y(Pt,Kr);function Pt(l){return l==null?ga():at(l)?l:ga().withMutations(function(p){var S=B(l);Nt(S.size),S.forEach(function(A){return p.add(A)})})}Pt.of=function(){return this(arguments)},Pt.fromKeys=function(l){return this(L(l).keySeq())},Pt.prototype.toString=function(){return this.__toString("OrderedSet {","}")};function at(l){return gn(l)&&_(l)}Pt.isOrderedSet=at;var va=Pt.prototype;va[M]=!0,va.__empty=ga,va.__make=Vi;function Vi(l,p){var S=Object.create(va);return S.size=l?l.size:0,S._map=l,S.__ownerID=p,S}var ci;function ga(){return ci||(ci=Vi(ui()))}y(Zr,bn);function Zr(l){return l==null?xi():At(l)?l:xi().unshiftAll(l)}Zr.of=function(){return this(arguments)},Zr.prototype.toString=function(){return this.__toString("Stack [","]")},Zr.prototype.get=function(l,p){var S=this._head;for(l=pr(this,l);S&&l--;)S=S.next;return S?S.value:p},Zr.prototype.peek=function(){return this._head&&this._head.value},Zr.prototype.push=function(){if(arguments.length===0)return this;for(var l=this.size+arguments.length,p=this._head,S=arguments.length-1;S>=0;S--)p={value:arguments[S],next:p};return this.__ownerID?(this.size=l,this._head=p,this.__hash=void 0,this.__altered=!0,this):ma(l,p)},Zr.prototype.pushAll=function(l){if(l=D(l),l.size===0)return this;Nt(l.size);var p=this.size,S=this._head;return l.reverse().forEach(function(A){p++,S={value:A,next:S}}),this.__ownerID?(this.size=p,this._head=S,this.__hash=void 0,this.__altered=!0,this):ma(p,S)},Zr.prototype.pop=function(){return this.slice(1)},Zr.prototype.unshift=function(){return this.push.apply(this,arguments)},Zr.prototype.unshiftAll=function(l){return this.pushAll(l)},Zr.prototype.shift=function(){return this.pop.apply(this,arguments)},Zr.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):xi()},Zr.prototype.slice=function(l,p){if(tr(l,p,this.size))return this;var S=yr(l,this.size),A=Pe(p,this.size);if(A!==this.size)return bn.prototype.slice.call(this,l,p);for(var b=this.size-S,G=this._head;S--;)G=G.next;return this.__ownerID?(this.size=b,this._head=G,this.__hash=void 0,this.__altered=!0,this):ma(b,G)},Zr.prototype.__ensureOwner=function(l){return l===this.__ownerID?this:l?ma(this.size,this._head,l,this.__hash):(this.__ownerID=l,this.__altered=!1,this)},Zr.prototype.__iterate=function(l,p){if(p)return this.reverse().__iterate(l);for(var S=0,A=this._head;A&&l(A.value,S++,this)!==!1;)A=A.next;return S},Zr.prototype.__iterator=function(l,p){if(p)return this.reverse().__iterator(l);var S=0,A=this._head;return new Ie(function(){if(A){var b=A.value;return A=A.next,_e(l,S++,b)}return h()})};function At(l){return!!(l&&l[ji])}Zr.isStack=At;var ji="@@__IMMUTABLE_STACK__@@",zn=Zr.prototype;zn[ji]=!0,zn.withMutations=Le.withMutations,zn.asMutable=Le.asMutable,zn.asImmutable=Le.asImmutable,zn.wasAltered=Le.wasAltered;function ma(l,p,S,A){var b=Object.create(zn);return b.size=l,b._head=p,b.__ownerID=S,b.__hash=A,b.__altered=!1,b}var ki;function xi(){return ki||(ki=ma(0))}function en(l,p){var S=function(A){l.prototype[A]=p[A]};return Object.keys(p).forEach(S),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(p).forEach(S),l}j.Iterator=Ie,en(j,{toArray:function(){Nt(this.size);var l=new Array(this.size||0);return this.valueSeq().__iterate(function(p,S){l[S]=p}),l},toIndexedSeq:function(){return new Hn(this)},toJS:function(){return this.toSeq().map(function(l){return l&&typeof l.toJS=="function"?l.toJS():l}).__toJS()},toJSON:function(){return this.toSeq().map(function(l){return l&&typeof l.toJSON=="function"?l.toJSON():l}).__toJS()},toKeyedSeq:function(){return new zt(this,!0)},toMap:function(){return lr(this.toKeyedSeq())},toObject:function(){Nt(this.size);var l={};return this.__iterate(function(p,S){l[S]=p}),l},toOrderedMap:function(){return Vr(this.toKeyedSeq())},toOrderedSet:function(){return Pt(I(this)?this.valueSeq():this)},toSet:function(){return Kr(I(this)?this.valueSeq():this)},toSetSeq:function(){return new la(this)},toSeq:function(){return C(this)?this.toIndexedSeq():I(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Zr(I(this)?this.valueSeq():this)},toList:function(){return Hr(I(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(l,p){return this.size===0?l+p:l+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+p},concat:function(){var l=ae.call(arguments,0);return Qe(this,Qo(this,l))},includes:function(l){return this.some(function(p){return qr(p,l)})},entries:function(){return this.__iterator(kr)},every:function(l,p){Nt(this.size);var S=!0;return this.__iterate(function(A,b,G){if(!l.call(p,A,b,G))return S=!1,!1}),S},filter:function(l,p){return Qe(this,fo(this,l,p,!0))},find:function(l,p,S){var A=this.findEntry(l,p);return A?A[1]:S},forEach:function(l,p){return Nt(this.size),this.__iterate(p?l.bind(p):l)},join:function(l){Nt(this.size),l=l!==void 0?""+l:",";var p="",S=!0;return this.__iterate(function(A){S?S=!1:p+=l,p+=A!=null?A.toString():""}),p},keys:function(){return this.__iterator(N)},map:function(l,p){return Qe(this,co(this,l,p))},reduce:function(l,p,S){Nt(this.size);var A,b;return arguments.length<2?b=!0:A=p,this.__iterate(function(G,X,ne){b?(b=!1,A=G):A=l.call(S,A,G,X,ne)}),A},reduceRight:function(l,p,S){var A=this.toKeyedSeq().reverse();return A.reduce.apply(A,arguments)},reverse:function(){return Qe(this,vn(this,!0))},slice:function(l,p){return Qe(this,Di(this,l,p,!0))},some:function(l,p){return!this.every(fi(l),p)},sort:function(l){return Qe(this,fa(this,l))},values:function(){return this.__iterator(Wr)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return this.size!==void 0?this.size===0:!this.some(function(){return!0})},count:function(l,p){return dr(l?this.toSeq().filter(l,p):this)},countBy:function(l,p){return Xo(this,l,p)},equals:function(l){return na(this,l)},entrySeq:function(){var l=this;if(l._cache)return new ht(l._cache);var p=l.toSeq().map(mn).toIndexedSeq();return p.fromEntrySeq=function(){return l.toSeq()},p},filterNot:function(l,p){return this.filter(fi(l),p)},findEntry:function(l,p,S){var A=S;return this.__iterate(function(b,G,X){if(l.call(p,b,G,X))return A=[G,b],!1}),A},findKey:function(l,p){var S=this.findEntry(l,p);return S&&S[0]},findLast:function(l,p,S){return this.toKeyedSeq().reverse().find(l,p,S)},findLastEntry:function(l,p,S){return this.toKeyedSeq().reverse().findEntry(l,p,S)},findLastKey:function(l,p){return this.toKeyedSeq().reverse().findKey(l,p)},first:function(){return this.find(rr)},flatMap:function(l,p){return Qe(this,Zo(this,l,p))},flatten:function(l){return Qe(this,po(this,l,!0))},fromEntrySeq:function(){return new ca(this)},get:function(l,p){return this.find(function(S,A){return qr(A,l)},void 0,p)},getIn:function(l,p){for(var S=this,A=Ar(l),b;!(b=A.next()).done;){var G=b.value;if(S=S&&S.get?S.get(G,me):me,S===me)return p}return S},groupBy:function(l,p){return qo(this,l,p)},has:function(l){return this.get(l,me)!==me},hasIn:function(l){return this.getIn(l,me)!==me},isSubset:function(l){return l=typeof l.includes=="function"?l:j(l),this.every(function(p){return l.includes(p)})},isSuperset:function(l){return l=typeof l.isSubset=="function"?l:j(l),l.isSubset(this)},keyOf:function(l){return this.findKey(function(p){return qr(p,l)})},keySeq:function(){return this.toSeq().map(tu).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},lastKeyOf:function(l){return this.toKeyedSeq().reverse().keyOf(l)},max:function(l){return si(this,l)},maxBy:function(l,p){return si(this,p,l)},min:function(l){return si(this,l?ha(l):mo)},minBy:function(l,p){return si(this,p?ha(p):mo,l)},rest:function(){return this.slice(1)},skip:function(l){return this.slice(Math.max(0,l))},skipLast:function(l){return Qe(this,this.toSeq().reverse().skip(l).reverse())},skipWhile:function(l,p){return Qe(this,Kn(this,l,p,!0))},skipUntil:function(l,p){return this.skipWhile(fi(l),p)},sortBy:function(l,p){return Qe(this,fa(this,p,l))},take:function(l){return this.slice(0,Math.max(0,l))},takeLast:function(l){return Qe(this,this.toSeq().reverse().take(l).reverse())},takeWhile:function(l,p){return Qe(this,Jo(this,l,p))},takeUntil:function(l,p){return this.takeWhile(fi(l),p)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=Ui(this))}});var Rt=j.prototype;Rt[T]=!0,Rt[Ae]=Rt.values,Rt.__toJS=Rt.toArray,Rt.__toStringMapper=go,Rt.inspect=Rt.toSource=function(){return this.toString()},Rt.chain=Rt.flatMap,Rt.contains=Rt.includes,en(L,{flip:function(){return Qe(this,lo(this))},mapEntries:function(l,p){var S=this,A=0;return Qe(this,this.toSeq().map(function(b,G){return l.call(p,[G,b],A++,S)}).fromEntrySeq())},mapKeys:function(l,p){var S=this;return Qe(this,this.toSeq().flip().map(function(A,b){return l.call(p,A,b,S)}).flip())}});var Xt=L.prototype;Xt[V]=!0,Xt[Ae]=Rt.entries,Xt.__toJS=Rt.toObject,Xt.__toStringMapper=function(l,p){return JSON.stringify(p)+": "+go(l)},en(D,{toKeyedSeq:function(){return new zt(this,!1)},filter:function(l,p){return Qe(this,fo(this,l,p,!1))},findIndex:function(l,p){var S=this.findEntry(l,p);return S?S[0]:-1},indexOf:function(l){var p=this.keyOf(l);return p===void 0?-1:p},lastIndexOf:function(l){var p=this.lastKeyOf(l);return p===void 0?-1:p},reverse:function(){return Qe(this,vn(this,!1))},slice:function(l,p){return Qe(this,Di(this,l,p,!1))},splice:function(l,p){var S=arguments.length;if(p=Math.max(p|0,0),S===0||S===2&&!p)return this;l=yr(l,l<0?this.count():this.size);var A=this.slice(0,l);return Qe(this,S===1?A:A.concat(Ke(arguments,2),this.slice(l+p)))},findLastIndex:function(l,p){var S=this.findLastEntry(l,p);return S?S[0]:-1},first:function(){return this.get(0)},flatten:function(l){return Qe(this,po(this,l,!1))},get:function(l,p){return l=pr(this,l),l<0||this.size===1/0||this.size!==void 0&&l>this.size?p:this.find(function(S,A){return A===l},void 0,p)},has:function(l){return l=pr(this,l),l>=0&&(this.size!==void 0?this.size===1/0||l<this.size:this.indexOf(l)!==-1)},interpose:function(l){return Qe(this,eu(this,l))},interleave:function(){var l=[this].concat(Ke(arguments)),p=Tr(this.toSeq(),Ir.of,l),S=p.flatten(!0);return p.size&&(S.size=p.size*l.length),Qe(this,S)},keySeq:function(){return ut(0,this.size)},last:function(){return this.get(-1)},skipWhile:function(l,p){return Qe(this,Kn(this,l,p,!1))},zip:function(){var l=[this].concat(Ke(arguments));return Qe(this,Tr(this,nn,l))},zipWith:function(l){var p=Ke(arguments);return p[0]=this,Qe(this,Tr(this,l,p))}}),D.prototype[z]=!0,D.prototype[M]=!0,en(B,{get:function(l,p){return this.has(l)?l:p},includes:function(l){return this.has(l)},keySeq:function(){return this.valueSeq()}}),B.prototype.has=Rt.includes,B.prototype.contains=B.prototype.includes,en(ct,L.prototype),en(Ir,D.prototype),en(xt,B.prototype),en(In,L.prototype),en(bn,D.prototype),en(Bn,B.prototype);function tu(l,p){return p}function mn(l,p){return[p,l]}function fi(l){return function(){return!l.apply(this,arguments)}}function ha(l){return function(){return-l.apply(this,arguments)}}function go(l){return typeof l=="string"?JSON.stringify(l):String(l)}function nn(){return Ke(arguments)}function mo(l,p){return l<p?1:l>p?-1:0}function Ui(l){if(l.size===1/0)return 0;var p=_(l),S=I(l),A=p?1:0,b=l.__iterate(S?p?function(G,X){A=31*A+yo(Ot(G),Ot(X))|0}:function(G,X){A=A+yo(Ot(G),Ot(X))|0}:p?function(G){A=31*A+Ot(G)|0}:function(G){A=A+Ot(G)|0});return ho(b,A)}function ho(l,p){return p=dn(p,3432918353),p=dn(p<<15|p>>>-15,461845907),p=dn(p<<13|p>>>-13,5),p=(p+3864292196|0)^l,p=dn(p^p>>>16,2246822507),p=dn(p^p>>>13,3266489909),p=aa(p^p>>>16),p}function yo(l,p){return l^p+2654435769+(l<<6)+(l>>2)|0}var ya={Iterable:j,Seq:sr,Collection:St,Map:lr,OrderedMap:Vr,List:Hr,Stack:Zr,Set:Kr,OrderedSet:Pt,Record:vr,Range:ut,Repeat:ot,is:qr,fromJS:Cn};return ya})},81136:(he,ae)=>{"use strict";var y;/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j=60103,L=60106,D=60107,B=60108,H=60114,I=60109,C=60110,x=60112,_=60113,T=60120,V=60115,z=60116,M=60121,U=60122,K=60117,Y=60129,Te=60131;if(typeof Symbol=="function"&&Symbol.for){var me=Symbol.for;j=me("react.element"),L=me("react.portal"),D=me("react.fragment"),B=me("react.strict_mode"),H=me("react.profiler"),I=me("react.provider"),C=me("react.context"),x=me("react.forward_ref"),_=me("react.suspense"),T=me("react.suspense_list"),V=me("react.memo"),z=me("react.lazy"),M=me("react.block"),U=me("react.server.block"),K=me("react.fundamental"),Y=me("react.debug_trace_mode"),Te=me("react.legacy_hidden")}function Xe(Pe){if(typeof Pe=="object"&&Pe!==null){var Xr=Pe.$$typeof;switch(Xr){case j:switch(Pe=Pe.type,Pe){case D:case H:case B:case _:case T:return Pe;default:switch(Pe=Pe&&Pe.$$typeof,Pe){case C:case x:case z:case V:case I:return Pe;default:return Xr}}case L:return Xr}}}var Be=I,Ue=j,Re=x,ar=D,Ke=z,dr=V,pr=L,rr=H,tr=B,yr=_;y=C,y=Be,y=Ue,y=Re,y=ar,y=Ke,y=dr,y=pr,y=rr,y=tr,y=yr,y=function(){return!1},y=function(){return!1},ae.isContextConsumer=function(Pe){return Xe(Pe)===C},y=function(Pe){return Xe(Pe)===I},y=function(Pe){return typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===j},y=function(Pe){return Xe(Pe)===x},y=function(Pe){return Xe(Pe)===D},y=function(Pe){return Xe(Pe)===z},y=function(Pe){return Xe(Pe)===V},y=function(Pe){return Xe(Pe)===L},y=function(Pe){return Xe(Pe)===H},y=function(Pe){return Xe(Pe)===B},y=function(Pe){return Xe(Pe)===_},y=function(Pe){return typeof Pe=="string"||typeof Pe=="function"||Pe===D||Pe===H||Pe===Y||Pe===B||Pe===_||Pe===T||Pe===Te||typeof Pe=="object"&&Pe!==null&&(Pe.$$typeof===z||Pe.$$typeof===V||Pe.$$typeof===I||Pe.$$typeof===C||Pe.$$typeof===x||Pe.$$typeof===K||Pe.$$typeof===M||Pe[0]===U)},y=Xe},10636:(he,ae,y)=>{"use strict";he.exports=y(81136)},1779:(he,ae,y)=>{var j=y(48287).Buffer,L=function(){"use strict";function D(M,U){return U!=null&&M instanceof U}var B;try{B=Map}catch{B=function(){}}var H;try{H=Set}catch{H=function(){}}var I;try{I=Promise}catch{I=function(){}}function C(M,U,K,Y,Te){typeof U=="object"&&(K=U.depth,Y=U.prototype,Te=U.includeNonEnumerable,U=U.circular);var me=[],Xe=[],Be=typeof j<"u";typeof U>"u"&&(U=!0),typeof K>"u"&&(K=1/0);function Ue(Re,ar){if(Re===null)return null;if(ar===0)return Re;var Ke,dr;if(typeof Re!="object")return Re;if(D(Re,B))Ke=new B;else if(D(Re,H))Ke=new H;else if(D(Re,I))Ke=new I(function(kr,Ee){Re.then(function(ye){kr(Ue(ye,ar-1))},function(ye){Ee(Ue(ye,ar-1))})});else if(C.__isArray(Re))Ke=[];else if(C.__isRegExp(Re))Ke=new RegExp(Re.source,z(Re)),Re.lastIndex&&(Ke.lastIndex=Re.lastIndex);else if(C.__isDate(Re))Ke=new Date(Re.getTime());else{if(Be&&j.isBuffer(Re))return j.allocUnsafe?Ke=j.allocUnsafe(Re.length):Ke=new j(Re.length),Re.copy(Ke),Ke;D(Re,Error)?Ke=Object.create(Re):typeof Y>"u"?(dr=Object.getPrototypeOf(Re),Ke=Object.create(dr)):(Ke=Object.create(Y),dr=Y)}if(U){var pr=me.indexOf(Re);if(pr!=-1)return Xe[pr];me.push(Re),Xe.push(Ke)}D(Re,B)&&Re.forEach(function(kr,Ee){var ye=Ue(Ee,ar-1),Ae=Ue(kr,ar-1);Ke.set(ye,Ae)}),D(Re,H)&&Re.forEach(function(kr){var Ee=Ue(kr,ar-1);Ke.add(Ee)});for(var rr in Re){var tr;dr&&(tr=Object.getOwnPropertyDescriptor(dr,rr)),!(tr&&tr.set==null)&&(Ke[rr]=Ue(Re[rr],ar-1))}if(Object.getOwnPropertySymbols)for(var yr=Object.getOwnPropertySymbols(Re),rr=0;rr<yr.length;rr++){var Pe=yr[rr],Xr=Object.getOwnPropertyDescriptor(Re,Pe);Xr&&!Xr.enumerable&&!Te||(Ke[Pe]=Ue(Re[Pe],ar-1),Xr.enumerable||Object.defineProperty(Ke,Pe,{enumerable:!1}))}if(Te)for(var N=Object.getOwnPropertyNames(Re),rr=0;rr<N.length;rr++){var Wr=N[rr],Xr=Object.getOwnPropertyDescriptor(Re,Wr);Xr&&Xr.enumerable||(Ke[Wr]=Ue(Re[Wr],ar-1),Object.defineProperty(Ke,Wr,{enumerable:!1}))}return Ke}return Ue(M,K)}C.clonePrototype=function(U){if(U===null)return null;var K=function(){};return K.prototype=U,new K};function x(M){return Object.prototype.toString.call(M)}C.__objToStr=x;function _(M){return typeof M=="object"&&x(M)==="[object Date]"}C.__isDate=_;function T(M){return typeof M=="object"&&x(M)==="[object Array]"}C.__isArray=T;function V(M){return typeof M=="object"&&x(M)==="[object RegExp]"}C.__isRegExp=V;function z(M){var U="";return M.global&&(U+="g"),M.ignoreCase&&(U+="i"),M.multiline&&(U+="m"),U}return C.__getRegExpFlags=z,C}();he.exports&&(he.exports=L)},71928:(he,ae,y)=>{"use strict";y.d(ae,{jN:()=>nO,cG:()=>aO,gv:()=>Ue,oK:()=>eO,e_:()=>xd,X3:()=>oO,To:()=>Rn,oF:()=>lt,se:()=>oi,YW:()=>sr,nj:()=>sO});var j={};y.r(j),y.d(j,{applyToJS:()=>va,cleanJSX:()=>ci,deepEqual:()=>da,deepFreeze:()=>ma,defaultValue:()=>Rr,escapeRegExp:()=>Vi,getFirstDefined:()=>Rt,getLogger:()=>en,isDirtyJSX:()=>ga,isImmutable:()=>Pt,isJSX:()=>Zr,isJsonCompatible:()=>ki,isJsonLogic:()=>At,logger:()=>Xt,mergeArraysSmart:()=>zn,opDefKeysToOmit:()=>Yn,shallowEqual:()=>pa,sleep:()=>ji,toImmutableList:()=>at,uuid:()=>_r,widgetDefKeysToOmit:()=>gn});var L={};y.r(L),y.d(L,{getItemInListValues:()=>fe,getListValue:()=>cr,getTitleInListValues:()=>ve,getValueInListValues:()=>Ve,listValuesToArray:()=>ce,makeCustomListValue:()=>ne,mapListValues:()=>Ge,searchListValue:()=>ur,toListValue:()=>X});var D={};y.r(D),y.d(D,{expandTreePath:()=>Ce,expandTreeSubpath:()=>Bt,fixEmptyGroupsInTree:()=>Eo,fixPathsInTree:()=>Xn,getFlatTree:()=>Bd,getItemByPath:()=>jt,getLightTree:()=>ms,getSwitchValues:()=>hs,getTotalReordableNodesCountInTree:()=>Wd,getTotalRulesCountInTree:()=>nu,getTreeBadFields:()=>gs,hasChildren:()=>iu,immutableToJs:()=>va,isEmptyTree:()=>au,isImmutable:()=>Pt,jsToImmutable:()=>Gi,removeIsLockedInTree:()=>ja,toImmutableList:()=>at});var B={};y.r(B),y.d(B,{SqlString:()=>Ea,mongoEmptyValue:()=>Ns,spelEscape:()=>di,spelFixList:()=>ws,spelFormatConcat:()=>lp,spelImportConcat:()=>cp,sqlEmptyValue:()=>Fs,stringifyForDisplay:()=>Ps});var H={};y.r(H),y.d(H,{_loadFromJsonLogic:()=>Rs,_loadFromSpel:()=>Xs,checkTree:()=>Hd,getTree:()=>$d,isImmutableTree:()=>ys,isJsonLogic:()=>At,isTree:()=>Es,isValidTree:()=>Kd,jsToImmutable:()=>Gi,loadFromJsonLogic:()=>Xd,loadFromSpel:()=>Op,loadTree:()=>ou});var I={};y.r(I),y.d(I,{createListFromArray:()=>Vp,defaultConjunction:()=>Dn,defaultGroupConjunction:()=>Oo,defaultGroupProperties:()=>Sa,defaultItemProperties:()=>nl,defaultOperatorOptions:()=>Wi,defaultRoot:()=>Mp,defaultRule:()=>al,defaultRuleProperties:()=>_n,emptyProperies:()=>jp,getDefaultField:()=>rl,getDefaultFieldSrc:()=>gu,getDefaultOperator:()=>mu,getDefaultSubField:()=>tl});var C={};y.r(C),y.d(C,{completeFuncValue:()=>ol,getCompatibleArgsOnFuncChange:()=>sl,setArgValue:()=>Xp,setArgValueSrc:()=>qp,setFunc:()=>zp});var x={};y.r(x),y.d(x,{completeValue:()=>Ga,filterValueSourcesForField:()=>Ua,formatFieldName:()=>qn,getFieldPartsConfigs:()=>fl,getFieldPathLabels:()=>$i,getFirstField:()=>ll,getFirstOperator:()=>Eu,getFuncPathLabels:()=>Jp,getNewValueForFieldOp:()=>xa,getOperatorsForField:()=>Co,getOperatorsForType:()=>cl,getValueLabel:()=>Qp,getValueSourcesForFieldOp:()=>dl,getWidgetForFieldOp:()=>Yr,getWidgetsForFieldOp:()=>Zp,isCompletedValue:()=>Hi,isEmptyGroupChildren:()=>Tu,isEmptyItem:()=>Ou,isEmptyRuleGroupExtPropertiesAndChildren:()=>pl,isEmptyRuleProperties:()=>Au,selectTypes:()=>Ro});var _={};y.r(_),y.d(_,{_widgetDefKeysToOmit:()=>Rv,applyJsonLogic:()=>iv,cleanJSX:()=>ci,compileConfig:()=>Ll,compressConfig:()=>Rl,configKeys:()=>Lo,decompressConfig:()=>Cl,extendConfig:()=>Jn,getFieldConfig:()=>ze,getFieldParts:()=>it,getFieldPath:()=>wu,getFieldPathParts:()=>Av,getFieldRawConfig:()=>hn,getFieldSrc:()=>Ml,getFieldWidgetConfig:()=>kt,getFuncArgConfig:()=>Nu,getFuncConfig:()=>Ct,getFuncSignature:()=>Fu,getOperatorConfig:()=>Gr,isDirtyJSX:()=>ga,isFieldDescendantOfField:()=>Dl,isJSX:()=>Zr,iterateFields:()=>_l,iterateFuncs:()=>mi,normalizeField:()=>bo});var T={};y.r(T),y.d(T,{ES_6_SYNTAX:()=>hc,ES_7_SYNTAX:()=>mc,_mongodbFormat:()=>Jl,_spelFormat:()=>js,_sqlFormat:()=>tc,compareToSign:()=>lu,elasticSearchFormat:()=>yc,jsonLogicFormat:()=>Fv,mongodbFormat:()=>Mv,queryBuilderFormat:()=>Cv,queryString:()=>Yv,spelFormat:()=>pp,sqlFormat:()=>Gv});var V={};y.r(V),y.d(V,{fixListValuesGroupOrder:()=>gg,getListValue:()=>cr,listValueToOption:()=>vg,mergeListValues:()=>fg,optionToListValue:()=>dg,optionsToListValues:()=>pg,simulateAsyncFetch:()=>cg});var z={};y.r(z),y.d(z,{Autocomplete:()=>V,ConfigUtils:()=>_,DefaultUtils:()=>I,ExportUtils:()=>B,FuncUtils:()=>C,ListUtils:()=>L,OtherUtils:()=>j,RuleUtils:()=>x,TreeUtils:()=>D,clone:()=>an(),compressConfig:()=>Rl,decompressConfig:()=>Cl,getSwitchValues:()=>hs,moment:()=>ya(),uuid:()=>_r,validateAndFixTree:()=>Up,validateTree:()=>hu});var M={};y.r(M),y.d(M,{LINEAR_REGRESSION:()=>Sg,LOWER:()=>yg,NOW:()=>mg,RELATIVE_DATETIME:()=>hg,UPPER:()=>Eg});var U={};y.r(U),y.d(U,{addCaseGroup:()=>sm,addDefaultCaseGroup:()=>um,addGroup:()=>lm,addRule:()=>im,moveItem:()=>fm,removeGroup:()=>cm,removeRule:()=>om,setTree:()=>am});var K={};y.r(K),y.d(K,{setConjunction:()=>dm,setLock:()=>vm,setNot:()=>pm});var Y={};y.r(Y),y.d(Y,{setField:()=>gm,setFieldSrc:()=>mm,setOperator:()=>hm,setOperatorOption:()=>Sm,setValue:()=>ym,setValueSrc:()=>Em});var Te={};y.r(Te),y.d(Te,{bindActionCreators:()=>pf,isUsingLegacyReactDomRender:()=>df,liteShouldComponentUpdate:()=>zu,pureShouldComponentUpdate:()=>Ei,useOnPropsChanged:()=>_t});var me={};y.r(me),y.d(me,{FuncWidget:()=>ns,ValueFieldWidget:()=>Ad,VanillaBooleanWidget:()=>eS,VanillaButton:()=>gS,VanillaButtonGroup:()=>hS,VanillaConjs:()=>pS,VanillaDateTimeWidget:()=>iS,VanillaDateWidget:()=>nS,VanillaFieldSelect:()=>dS,VanillaIcon:()=>mS,VanillaMultiSelectWidget:()=>uS,VanillaNumberWidget:()=>cS,VanillaProvider:()=>OS,VanillaSelectWidget:()=>lS,VanillaSliderWidget:()=>fS,VanillaSwitch:()=>ES,VanillaTextAreaWidget:()=>tS,VanillaTextWidget:()=>rS,VanillaTimeWidget:()=>aS,VanillaValueSources:()=>yS,vanillaConfirm:()=>SS});var Xe={};y.r(Xe),y.d(Xe,{ProximityOperator:()=>ss});var Be=y(50877),Ue=(a=>(a.Timeseries="time_series",a.Table="table",a))(Ue||{});const Re=[{label:"Time series",value:"time_series"},{label:"Table",value:"table"}],ar=a=>({label:a,value:a}),Ke=Be.z??ar;var dr=y(13288),pr=y(75505),rr=y(81160),tr=y(41987),yr=y(92053),Pe=y(43127),Xr=y(78368),N=y(98765),Wr=y(26657),kr=y(72574),Ee=y(14110),ye=y(17172),Ae=y(47773),Ie=y(2543);class _e{transformMetricFindResponse(e){const r=[],n=e.fields.find(i=>i.name==="__text"),t=e.fields.find(i=>i.name==="__value");if(n&&t)for(let i=0;i<n.values.length;i++)r.push({text:""+n.values[i],value:""+t.values[i]});else for(const i of e.fields)for(const u of i.values)r.push({text:u});return(0,Ie.uniqBy)(r,"text")}}var h=y(96540),He=y(16817),We=y(68402),or=(a=>(a.String="string",a))(or||{}),nt=(a=>(a.Property="property",a.Operator="operator",a.Or="or",a.And="and",a.GroupBy="groupBy",a.Function="function",a.FunctionParameter="functionParameter",a))(nt||{});function lt(a){return`SELECT ${a.map(r=>{let n="";return r.name&&r.alias?n+=`${r.name}(${r.parameters?.map(t=>`${t.name}`)}) AS ${r.alias}`:r.name?n+=`${r.name}(${r.parameters?.map(t=>`${t.name}`)})`:r.alias?n+=`${r.parameters?.map(t=>`${t.name}`)} AS ${r.alias}`:n+=`${r.parameters?.map(t=>`${t.name}`)}`,n}).join(", ")} `}const sr=a=>{if(!a)return!1;const e=a.some(n=>n.parameters?.length||n.parameters?.some(t=>t.name)),r=a.some(n=>n.name);return e||r};function ct(a){return{type:nt.GroupBy,property:{type:or.String,name:a}}}function Ir(a){return{type:nt.Property,property:{type:or.String,name:a}}}function xt(a){return{type:nt.Function,name:a,parameters:[]}}function Rn(a){let e=a?.editorMode||N.lX.Builder;return a?.editorMode===void 0&&a?.rawSql!==void 0&&(e=N.lX.Code),{...a,refId:a?.refId||"A",format:a?.format!==void 0?a.format:Ue.Table,rawSql:a?.rawSql||"",editorMode:e,sql:a?.sql??{columns:[xt()],groupBy:[ct()],limit:50}}}var ht=y(73287),yt=y(62938),ln=y(6191),Ut=y(22354),La=y(31347),cn=y(9e4),wr=y(81580),fn=y(15292),Gt=y(55852),Kt=y(56034),ta=y(94354),Un=y(37390),Mt=y(14578);function Cn({isOpen:a,onCancel:e,onDiscard:r,onCopy:n}){const t=(0,h.useRef)(null);return(0,h.useEffect)(()=>{a&&t.current?.focus()},[a]),h.createElement(Un.a,{title:h.createElement("div",{className:"modal-header-title"},h.createElement(Mt.I,{name:"exclamation-triangle",size:"lg"}),h.createElement("span",{className:"p-l-1"},"Warning")),onDismiss:e,isOpen:a},h.createElement("p",null,"Builder mode does not display changes made in code. The query builder will display the last changes you made in builder mode."),h.createElement("p",null,"Do you want to copy your code to the clipboard?"),h.createElement(Un.a.ButtonRow,null,h.createElement(Gt.$n,{type:"button",variant:"secondary",onClick:e,fill:"outline"},"Cancel"),h.createElement(Gt.$n,{variant:"destructive",type:"button",onClick:r,ref:t},"Discard code and switch"),h.createElement(Gt.$n,{variant:"primary",onClick:n},"Copy code and switch")))}var Ft=y(88323),Ln=y(32264);const Gn=()=>!!Ln.$.featureToggles.sqlDatasourceDatabaseSelection,qr=({dataset:a,db:e,dialect:r,onChange:n,preconfiguredDataset:t})=>{const i=!!t||r==="postgres",u=(0,He.A)(async()=>Gn()&&i?(n(Ke(t)),[Ke(t)]):(a&&n(Ke(a)),(await e.datasets()).map(Ke)),[]);return(0,h.useEffect)(()=>{Gn()||(a?u.value&&u.value.find(o=>o.value===a)===void 0&&u.value.length>0&&n(u.value[0]):u.value&&u.value[0]&&n(u.value[0]))},[u.value,n,a]),h.createElement(Ft.l6,{"aria-label":"Dataset selector",value:a,options:u.value,onChange:n,disabled:u.loading,isLoading:u.loading,menuShouldPortal:!0})},na=({db:a,dataset:e,table:r,className:n,onChange:t})=>{const i=(0,He.A)(async()=>e?(await a.tables(e)).map(Be.z):[],[e]);return h.createElement(Ft.l6,{className:n,disabled:i.loading,"aria-label":"Table selector",value:r,options:i.value,onChange:t,isLoading:i.loading,menuShouldPortal:!0,placeholder:i.loading?"Loading tables":"Select table"})},ot=[{label:"Builder",value:N.lX.Builder},{label:"Code",value:N.lX.Code}];function Ia({db:a,dialect:e,isQueryRunnable:r,onChange:n,onQueryRowChange:t,onRunQuery:i,preconfiguredDataset:u,query:o,queryRowFilter:s}){const{editorMode:c}=o,[f,d]=(0,ht.A)(),[v,g]=(0,h.useState)(!1),m=a.toRawSql,E=(0,h.useCallback)(F=>{if(F===N.lX.Code&&(0,Ee.rR)("grafana_sql_editor_mode_changed",{datasource:o.datasource?.type,selectedEditorMode:N.lX.Code}),c===N.lX.Code){g(!0);return}n({...o,editorMode:F})},[c,n,o]),O=F=>{const k={...o,format:F.value!==void 0?F.value:Ue.Table};(0,Ee.rR)("grafana_sql_format_changed",{datasource:o.datasource?.type,selectedFormat:k.format}),n(k)},R=F=>{if(F.value===o.dataset)return;const k={...o,dataset:F.value,table:void 0,sql:void 0,rawSql:""};n(k)},w=F=>{if(F.value===o.table)return;const k={...o,table:F.value,sql:void 0,rawSql:""};n(k)},P=()=>!(e==="influx"||!Gn()&&e==="postgres");return h.createElement(h.Fragment,null,h.createElement(ln.X,null,h.createElement(Ut.W,{label:"Format",value:o.format,placeholder:"Select format",menuShouldPortal:!0,onChange:O,options:Re}),c===N.lX.Builder&&h.createElement(h.Fragment,null,h.createElement(fn.K,{id:`sql-filter-${(0,yt.A)()}}`,label:"Filter",transparent:!0,showLabel:!0,value:s.filter,onChange:F=>{F.target instanceof HTMLInputElement&&((0,Ee.rR)("grafana_sql_filter_toggled",{datasource:o.datasource?.type,displayed:F.target.checked}),t({...s,filter:F.target.checked}))}}),h.createElement(fn.K,{id:`sql-group-${(0,yt.A)()}}`,label:"Group",transparent:!0,showLabel:!0,value:s.group,onChange:F=>{F.target instanceof HTMLInputElement&&((0,Ee.rR)("grafana_sql_group_toggled",{datasource:o.datasource?.type,displayed:F.target.checked}),t({...s,group:F.target.checked}))}}),h.createElement(fn.K,{id:`sql-order-${(0,yt.A)()}}`,label:"Order",transparent:!0,showLabel:!0,value:s.order,onChange:F=>{F.target instanceof HTMLInputElement&&((0,Ee.rR)("grafana_sql_order_toggled",{datasource:o.datasource?.type,displayed:F.target.checked}),t({...s,order:F.target.checked}))}}),h.createElement(fn.K,{id:`sql-preview-${(0,yt.A)()}}`,label:"Preview",transparent:!0,showLabel:!0,value:s.preview,onChange:F=>{F.target instanceof HTMLInputElement&&((0,Ee.rR)("grafana_sql_preview_toggled",{datasource:o.datasource?.type,displayed:F.target.checked}),t({...s,preview:F.target.checked}))}})),h.createElement(La.Z,{grow:1}),r?h.createElement(Gt.$n,{icon:"play",variant:"primary",size:"sm",onClick:()=>i()},"Run query"):h.createElement(Kt.m,{theme:"error",content:h.createElement(h.Fragment,null,"Your query is invalid. Check below for details. ",h.createElement("br",null),"However, you can still run this query."),placement:"top"},h.createElement(Gt.$n,{icon:"exclamation-triangle",variant:"secondary",size:"sm",onClick:()=>i()},"Run query")),h.createElement(ta.z,{options:ot,size:"sm",value:c,onChange:E}),h.createElement(Cn,{isOpen:v,onCopy:()=>{(0,Ee.rR)("grafana_sql_editor_mode_changed",{datasource:o.datasource?.type,selectedEditorMode:N.lX.Builder,type:"copy"}),g(!1),d(o.rawSql),n({...o,rawSql:m(o),editorMode:N.lX.Builder})},onDiscard:()=>{(0,Ee.rR)("grafana_sql_editor_mode_changed",{datasource:o.datasource?.type,selectedEditorMode:N.lX.Builder,type:"discard"}),g(!1),n({...o,rawSql:m(o),editorMode:N.lX.Builder})},onCancel:()=>{(0,Ee.rR)("grafana_sql_editor_mode_changed",{datasource:o.datasource?.type,selectedEditorMode:N.lX.Builder,type:"cancel"}),g(!1)}})),c===N.lX.Builder&&h.createElement(h.Fragment,null,h.createElement(We.$,{v:.5}),h.createElement(cn.U,null,P()&&h.createElement(wr.c,{label:"Dataset",width:25},h.createElement(qr,{db:a,dataset:o.dataset,dialect:e,preconfiguredDataset:u,onChange:R})),h.createElement(wr.c,{label:"Table",width:25},h.createElement(na,{db:a,dataset:o.dataset||u,table:o.table,onChange:w})))))}var Jr=y(32196),ut=y(49185),ba=y(70713),St=y(40845),In=y(32372);function bn(a,e){var r;const n=a?.getPreviousNonWhiteSpaceToken(),t=a?.getPreviousKeyword(),i=(r=a?.getPreviousNonWhiteSpaceToken())==null?void 0:r.is(N.ks.Operator,"/"),u=e.list(),o=[];for(const s of u)s.resolve(a,t??null,n??null,!!i)&&o.push(s.id);return o.length===0?[N.X7.Unknown]:o}var Bn=Object.defineProperty,dn=Object.getOwnPropertySymbols,aa=Object.prototype.hasOwnProperty,Ot=Object.prototype.propertyIsEnumerable,Fa=(a,e,r)=>e in a?Bn(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r,Na=(a,e)=>{for(var r in e||(e={}))aa.call(e,r)&&Fa(a,r,e[r]);if(dn)for(var r of dn(e))Ot.call(e,r)&&Fa(a,r,e[r]);return a};const Ja=(a,e,r={})=>Na({label:a,insertText:a,kind:N.Io.Field,sortText:N.mY.Medium,range:e},r);var Qa=Object.defineProperty,Dr=Object.defineProperties,Yt=Object.getOwnPropertyDescriptors,ia=Object.getOwnPropertySymbols,wa=Object.prototype.hasOwnProperty,Pa=Object.prototype.propertyIsEnumerable,Mr=(a,e,r)=>e in a?Qa(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r,Qr=(a,e)=>{for(var r in e||(e={}))wa.call(e,r)&&Mr(a,r,e[r]);if(ia)for(var r of ia(e))Pa.call(e,r)&&Mr(a,r,e[r]);return a},Vt=(a,e)=>Dr(a,Yt(e));const tn=async(a,e,r,n,t)=>{let i=[];const o=e?.isWhiteSpace()||e?.isParenthesis()||e?.isIdentifier()&&e.value.endsWith(".")||!e?.range?a.Range.fromPositions(n.position):e?.range;for(const s of[...new Set(r)]){const c=t.getIfExists(s);if(c){const f=await c.suggestions(Vt(Qr({},n),{range:o}),a);i=[...i,...f.map(d=>Ja(d.label,o,Qr({kind:d.kind},d)))]}}return Promise.resolve(i)},pn=()=>[{id:N.X7.SelectKeyword,name:N.X7.SelectKeyword,kind:[N.ng.SelectKeyword]},{id:N.X7.WithKeyword,name:N.X7.WithKeyword,kind:[N.ng.WithKeyword]},{id:N.X7.AfterSelectKeyword,name:N.X7.AfterSelectKeyword,kind:[N.ng.StarWildCard,N.ng.FunctionsWithArguments,N.ng.Columns,N.ng.SelectMacro]},{id:N.X7.AfterSelectFuncFirstArgument,name:N.X7.AfterSelectFuncFirstArgument,kind:[N.ng.Columns]},{id:N.X7.AfterGroupByFunctionArgument,name:N.X7.AfterGroupByFunctionArgument,kind:[N.ng.Columns]},{id:N.X7.AfterWhereFunctionArgument,name:N.X7.AfterWhereFunctionArgument,kind:[N.ng.Columns]},{id:N.X7.AfterSelectArguments,name:N.X7.AfterSelectArguments,kind:[N.ng.Columns]},{id:N.X7.AfterFromKeyword,name:N.X7.AfterFromKeyword,kind:[N.ng.Schemas,N.ng.Tables,N.ng.TableMacro]},{id:N.X7.AfterSchema,name:N.X7.AfterSchema,kind:[N.ng.Tables,N.ng.TableMacro]},{id:N.X7.SelectAlias,name:N.X7.SelectAlias,kind:[N.ng.Columns,N.ng.FunctionsWithArguments]},{id:N.X7.FromKeyword,name:N.X7.FromKeyword,kind:[N.ng.FromKeyword]},{id:N.X7.AfterFrom,name:N.X7.AfterFrom,kind:[N.ng.WhereKeyword,N.ng.GroupByKeywords,N.ng.OrderByKeywords,N.ng.LimitKeyword]},{id:N.X7.AfterTable,name:N.X7.AfterTable,kind:[N.ng.WhereKeyword,N.ng.GroupByKeywords,N.ng.OrderByKeywords,N.ng.LimitKeyword]},{id:N.X7.WhereKeyword,name:N.X7.WhereKeyword,kind:[N.ng.Columns,N.ng.FilterMacro,N.ng.TemplateVariables]},{id:N.X7.WhereComparisonOperator,name:N.X7.WhereComparisonOperator,kind:[N.ng.ComparisonOperators]},{id:N.X7.WhereValue,name:N.X7.WhereValue,kind:[N.ng.FilterMacro,N.ng.TemplateVariables]},{id:N.X7.AfterWhereValue,name:N.X7.AfterWhereValue,kind:[N.ng.LogicalOperators,N.ng.GroupByKeywords,N.ng.OrderByKeywords,N.ng.LimitKeyword,N.ng.Columns,N.ng.TemplateVariables]},{id:N.X7.AfterGroupByKeywords,name:N.X7.AfterGroupByKeywords,kind:[N.ng.GroupMacro,N.ng.Columns]},{id:N.X7.AfterGroupBy,name:N.X7.AfterGroupBy,kind:[N.ng.OrderByKeywords,N.ng.LimitKeyword]},{id:N.X7.AfterOrderByKeywords,name:N.X7.AfterOrderByKeywords,kind:[N.ng.Columns]},{id:N.X7.AfterOrderByFunction,name:N.X7.AfterOrderByFunction,kind:[N.ng.SortOrderDirectionKeyword,N.ng.LimitKeyword]},{id:N.X7.AfterOrderByDirection,name:N.X7.AfterOrderByDirection,kind:[N.ng.LimitKeyword]},{id:N.X7.AfterIsOperator,name:N.X7.AfterOrderByDirection,kind:[N.ng.NotKeyword,N.ng.NullValue,N.ng.BoolValues]},{id:N.X7.AfterIsNotOperator,name:N.X7.AfterOrderByDirection,kind:[N.ng.NullValue,N.ng.BoolValues]}];function Nt(a,e){let r=[];for(let n=0;n<a.length;n++){const t=e.getIfExists(a[n]);t&&(r=r.concat(t.kind))}return r}class lr{constructor(e,r,n,t,i){this.type=e,this.value=r,this.range=n,this.previous=t,this.next=i}isKeyword(){return this.type===N.ks.Keyword}isWhiteSpace(){return this.type===N.ks.Whitespace}isParenthesis(){return this.type===N.ks.Parenthesis}isIdentifier(){return this.type===N.ks.Identifier}isString(){return this.type===N.ks.String}isNumber(){return this.type===N.ks.Number}isDoubleQuotedString(){return this.type===N.ks.Type}isVariable(){return this.type===N.ks.Variable}isFunction(){return this.type===N.ks.Function}isOperator(){return this.type===N.ks.Operator}isTemplateVariable(){return this.type===N.ks.Variable}is(e,r){const n=this.type===e;return r!==void 0?n&&Er(e,this,r):n}getPreviousNonWhiteSpaceToken(){let e=this.previous;for(;e!=null;){if(!e.isWhiteSpace())return e;e=e.previous}return null}getPreviousOfType(e,r){let n=this.previous;for(;n!=null;){const t=n.type===e;if(r!==void 0?t&&Er(e,n,r):t)return n;n=n.previous}return null}getPreviousUntil(e,r,n){let t=[],i=this.previous;for(;i!=null;){if(r.some(o=>o===i?.type)){i=i.previous;continue}const u=i.type===e;if(n!==void 0?u&&Er(e,i,n):u)return t;i.isWhiteSpace()||t.push(i),i=i.previous}return t}getNextUntil(e,r,n){let t=[],i=this.next;for(;i!=null;){if(r.some(o=>o===i?.type)){i=i.next;continue}const u=i.type===e;if(n!==void 0?u&&Er(e,i,n):u)return t;i.isWhiteSpace()||t.push(i),i=i.next}return t}getPreviousKeyword(){let e=this.previous;for(;e!=null;){if(e.isKeyword())return e;e=e.previous}return null}getNextNonWhiteSpaceToken(){let e=this.next;for(;e!=null;){if(!e.isWhiteSpace())return e;e=e.next}return null}getNextOfType(e,r){let n=this.next;for(;n!=null;){const t=n.type===e;if(r!==void 0?t&&Er(e,n,r):t)return n;n=n.next}return null}}function Er(a,e,r){return a===N.ks.Keyword||a===N.ks.Operator?e.value.toLowerCase()===r.toString().toLowerCase():e.value===r}function Ur(a,e,r,n="sql"){var t;let i=null,u=null;const o=a.editor.tokenize((t=e.getValue())!=null?t:"",n);for(let s=0;s<o.length;s++){const c=o[s];if(!c.length&&u){const f={offset:0,type:N.ks.Whitespace,language:n,_tokenBrand:void 0};c.push(f)}for(let f=0;f<c.length;f++){const d=c[f];let v=c.length>f+1?c[f+1].offset+1:e.getLineLength(s+1)+1;const g={startLineNumber:s+1,startColumn:d.offset===0?0:d.offset+1,endLineNumber:s+1,endColumn:v},m=e.getValueInRange(g),E=new lr(d.type,m,g,u,null);a.Range.containsPosition(g,r)&&(i=E),u&&(u.next=E),u=E}}return i}var Le=y(10828);const Wn=a=>{var e;return(e=a?.getPreviousOfType(N.ks.Keyword,Le.SELECT))!=null?e:null},Jt=a=>{const e=Wn(a);return e?.getNextOfType(N.ks.Keyword,Le.FROM)},Fn=a=>{var e;const r=Jt(a),n=r?.getNextNonWhiteSpaceToken();return n?.isVariable()||n?.isKeyword()&&((e=n.next)!=null&&e.is(N.ks.Parenthesis,"("))?null:n},Qt=a=>{const e=a?.value.split(".");return e?.length===1?{table:e[0]}:e?.length===2?{schema:e[0],table:e[1]}:null},Ne={id:"editor.action.triggerSuggest",title:""};var Tt=y(44600),Q=y(83077);const ue=(a,e,r)=>()=>[{id:N.ng.SelectKeyword,name:N.ng.SelectKeyword,suggestions:(n,t)=>Promise.resolve([{label:"SELECT <column>",insertText:"SELECT $0",insertTextRules:N._E.InsertAsSnippet,kind:N.Io.Snippet,command:Ne,sortText:N.mY.Medium},{label:"SELECT <column> FROM <table>",insertText:"SELECT $2 FROM $1",insertTextRules:N._E.InsertAsSnippet,kind:N.Io.Snippet,command:Ne,sortText:N.mY.Medium}])},{id:N.ng.TemplateVariables,name:N.ng.TemplateVariables,suggestions:(n,t)=>{const i=(0,kr.w)();return i?Promise.resolve(i.getVariables().map(u=>{const o=`$${u.name}`,s=i.replace(o);return{label:o,detail:`(Template Variable) ${s}`,kind:N.Io.Snippet,documentation:`(Template Variable) ${s}`,insertText:`\\$${u.name} `,insertTextRules:N._E.InsertAsSnippet,command:Ne,sortText:N.mY.Low}})):Promise.resolve([])}},{id:N.ng.SelectMacro,name:N.ng.SelectMacro,suggestions:(n,t)=>Promise.resolve([...r.list().filter(i=>i.type===N.hh.Value||i.type===N.hh.Column).map(be)])},{id:N.ng.TableMacro,name:N.ng.TableMacro,suggestions:(n,t)=>Promise.resolve([...r.list().filter(i=>i.type===N.hh.Table).map(be)])},{id:N.ng.GroupMacro,name:N.ng.GroupMacro,suggestions:(n,t)=>Promise.resolve([...r.list().filter(i=>i.type===N.hh.Group).map(be)])},{id:N.ng.FilterMacro,name:N.ng.FilterMacro,suggestions:(n,t)=>Promise.resolve([...r.list().filter(i=>i.type===N.hh.Filter).map(be)])},{id:N.ng.WithKeyword,name:N.ng.WithKeyword,suggestions:(n,t)=>Promise.resolve([{label:"WITH <alias> AS ( ... )",insertText:"WITH $1  AS ( $2 )",insertTextRules:N._E.InsertAsSnippet,kind:N.Io.Snippet,command:Ne,sortText:N.mY.Medium}])},{id:N.ng.StarWildCard,name:N.ng.StarWildCard,suggestions:(n,t)=>Promise.resolve([{label:"*",insertText:"* $0",insertTextRules:N._E.InsertAsSnippet,kind:N.Io.Field,command:Ne,sortText:N.mY.High}])},{id:N.ng.FunctionsWithArguments,name:N.ng.FunctionsWithArguments,suggestions:(n,t)=>Promise.resolve([...a.list().map(i=>({label:i.name,insertText:`${i.name}($0)`,documentation:i.description,insertTextRules:N._E.InsertAsSnippet,kind:N.Io.Function,command:Ne,sortText:N.mY.MediumLow}))])},{id:N.ng.FunctionsWithoutArguments,name:N.ng.FunctionsWithoutArguments,suggestions:(n,t)=>Promise.resolve([...a.list().map(i=>({label:i.name,insertText:`${i.name}()`,documentation:i.description,insertTextRules:N._E.InsertAsSnippet,kind:N.Io.Function,command:Ne,sortText:N.mY.MediumHigh}))])},{id:N.ng.FromKeyword,name:N.ng.FromKeyword,suggestions:(n,t)=>Promise.resolve([{label:"FROM",insertText:"FROM $0",command:Ne,insertTextRules:N._E.InsertAsSnippet,kind:N.Io.Keyword}])},{id:N.ng.Schemas,name:N.ng.Schemas,suggestions:(n,t)=>Promise.resolve([])},{id:N.ng.Tables,name:N.ng.Tables,suggestions:(n,t)=>Promise.resolve([])},{id:N.ng.Columns,name:N.ng.Columns,suggestions:(n,t)=>Promise.resolve([])},{id:N.ng.LogicalOperators,name:N.ng.LogicalOperators,suggestions:(n,t)=>Promise.resolve(e.list().filter(i=>i.type===N.hu.Logical).map(i=>({label:i.operator,insertText:`${i.operator} `,documentation:i.description,command:Ne,sortText:N.mY.MediumHigh,kind:N.Io.Operator})))},{id:N.ng.WhereKeyword,name:N.ng.WhereKeyword,suggestions:(n,t)=>Promise.resolve([{label:"WHERE",insertText:"WHERE ",command:Ne,sortText:N.mY.MediumHigh,kind:N.Io.Keyword}])},{id:N.ng.ComparisonOperators,name:N.ng.ComparisonOperators,suggestions:(n,t)=>Promise.resolve([...e.list().filter(i=>i.type===N.hu.Comparison).map(i=>({label:i.operator,insertText:`${i.operator} `,documentation:i.description,command:Ne,sortText:N.mY.MediumHigh,kind:N.Io.Operator})),{label:"IN (...)",insertText:"IN ( $0 )",command:Ne,sortText:N.mY.Medium,kind:N.Io.Operator,insertTextRules:N._E.InsertAsSnippet},{label:"NOT IN (...)",insertText:"NOT IN ( $0 )",command:Ne,sortText:N.mY.Medium,kind:N.Io.Operator,insertTextRules:N._E.InsertAsSnippet},{label:"IS",insertText:"IS",command:Ne,sortText:N.mY.Medium,kind:N.Io.Operator},{label:"IS NOT",insertText:"IS NOT",command:Ne,sortText:N.mY.Medium,kind:N.Io.Operator}])},{id:N.ng.GroupByKeywords,name:N.ng.GroupByKeywords,suggestions:(n,t)=>Promise.resolve([{label:"GROUP BY",insertText:"GROUP BY ",command:Ne,sortText:N.mY.MediumHigh,kind:N.Io.Keyword}])},{id:N.ng.OrderByKeywords,name:N.ng.OrderByKeywords,suggestions:(n,t)=>Promise.resolve([{label:"ORDER BY",insertText:"ORDER BY ",command:Ne,sortText:N.mY.Medium,kind:N.Io.Keyword},{label:"ORDER BY(ascending)",insertText:"ORDER BY $1 ASC ",command:Ne,sortText:N.mY.MediumLow,kind:N.Io.Snippet,insertTextRules:N._E.InsertAsSnippet},{label:"ORDER BY(descending)",insertText:"ORDER BY $1 DESC",command:Ne,sortText:N.mY.MediumLow,kind:N.Io.Snippet,insertTextRules:N._E.InsertAsSnippet}])},{id:N.ng.LimitKeyword,name:N.ng.LimitKeyword,suggestions:(n,t)=>Promise.resolve([{label:"LIMIT",insertText:"LIMIT ",command:Ne,sortText:N.mY.MediumLow,kind:N.Io.Keyword}])},{id:N.ng.SortOrderDirectionKeyword,name:N.ng.SortOrderDirectionKeyword,suggestions:(n,t)=>Promise.resolve([Le.ASC,Le.DESC].map(i=>({label:i,insertText:`${i} `,command:Ne,kind:N.Io.Keyword})))},{id:N.ng.NotKeyword,name:N.ng.NotKeyword,suggestions:()=>Promise.resolve([{label:"NOT",insertText:"NOT",command:Ne,kind:N.Io.Keyword,sortText:N.mY.High}])},{id:N.ng.BoolValues,name:N.ng.BoolValues,suggestions:()=>Promise.resolve(["TRUE","FALSE"].map(n=>({label:n,insertText:`${n}`,command:Ne,kind:N.Io.Keyword,sortText:N.mY.Medium})))},{id:N.ng.NullValue,name:N.ng.NullValue,suggestions:()=>Promise.resolve(["NULL"].map(n=>({label:n,insertText:`${n}`,command:Ne,kind:N.Io.Keyword,sortText:N.mY.Low})))}];function be(a){return{label:a.name,insertText:`${"\\"+a.text}${nr(a.args)} `,insertTextRules:N._E.InsertAsSnippet,kind:N.Io.Snippet,documentation:a.description,command:Ne}}function nr(a){return a?"(".concat(a.map((e,r)=>`\${${r}:${e}}`).join(", ")).concat(")"):"()"}function $r(){return[{id:N.X7.SelectKeyword,name:N.X7.SelectKeyword,resolve:(a,e,r,n)=>!!(a===null||a.isWhiteSpace()&&a.previous===null||a.is(N.ks.Keyword,Le.SELECT)||a.is(N.ks.Keyword,Le.SELECT)&&a.previous===null||n||a.isIdentifier()&&(n||a?.previous===null)||a.isIdentifier()&&Le.SELECT.startsWith(a.value.toLowerCase()))},{id:N.X7.WithKeyword,name:N.X7.WithKeyword,resolve:(a,e,r,n)=>!!(a===null||a.isWhiteSpace()&&a.previous===null||a.is(N.ks.Keyword,Le.WITH)&&a.previous===null||a.isIdentifier()&&Le.WITH.toLowerCase().startsWith(a.value.toLowerCase()))},{id:N.X7.AfterSelectKeyword,name:N.X7.AfterSelectKeyword,resolve:(a,e,r,n)=>r?.value.toLowerCase()===Le.SELECT},{id:N.X7.AfterSelectArguments,name:N.X7.AfterSelectArguments,resolve:(a,e,r,n)=>e?.value.toLowerCase()===Le.SELECT&&r?.value===","},{id:N.X7.AfterSelectFuncFirstArgument,name:N.X7.AfterSelectFuncFirstArgument,resolve:(a,e,r,n)=>!!((e?.value.toLowerCase()===Le.SELECT||e?.value.toLowerCase()===Le.AS)&&(r?.is(N.ks.Parenthesis,"(")||a?.is(N.ks.Parenthesis,"()")))},{id:N.X7.AfterWhereFunctionArgument,name:N.X7.AfterWhereFunctionArgument,resolve:(a,e,r,n)=>!!(e?.is(N.ks.Keyword,Le.WHERE)&&(r?.is(N.ks.Parenthesis,"(")||a?.is(N.ks.Parenthesis,"()")))},{id:N.X7.AfterGroupBy,name:N.X7.AfterGroupBy,resolve:(a,e,r,n)=>{var t;return!!(e?.is(N.ks.Keyword,Le.BY)&&((t=e?.getPreviousKeyword())!=null&&t.is(N.ks.Keyword,Le.GROUP))&&(r?.isIdentifier()||r?.isDoubleQuotedString()||r?.is(N.ks.Parenthesis,")")||r?.is(N.ks.Parenthesis,"()")))}},{id:N.X7.SelectAlias,name:N.X7.SelectAlias,resolve:(a,e,r,n)=>r?.value===","&&e?.value.toLowerCase()===Le.AS},{id:N.X7.FromKeyword,name:N.X7.FromKeyword,resolve:(a,e,r,n)=>!!(e?.value.toLowerCase()===Le.SELECT&&r?.value!==","||(a?.isKeyword()||a?.isIdentifier())&&Le.FROM.toLowerCase().startsWith(a.value.toLowerCase()))},{id:N.X7.AfterFromKeyword,name:N.X7.AfterFromKeyword,resolve:(a,e,r,n)=>!a?.value.includes(".")&&r?.value.toLowerCase()===Le.FROM},{id:N.X7.AfterSchema,name:N.X7.AfterSchema,resolve:(a,e,r,n)=>(a?.isWhiteSpace()&&a?.next&&(a=a?.previous,r=a.getPreviousNonWhiteSpaceToken()),!!(a?.isIdentifier()&&a?.value.endsWith(".")&&r?.value.toLowerCase()===Le.FROM))},{id:N.X7.AfterFrom,name:N.X7.AfterFrom,resolve:(a,e,r,n)=>!!(e?.value.toLowerCase()===Le.FROM&&r?.isDoubleQuotedString()||e?.value.toLowerCase()===Le.FROM&&r?.isIdentifier()||e?.value.toLowerCase()===Le.FROM&&r?.isVariable())},{id:N.X7.AfterTable,name:N.X7.AfterTable,resolve:(a,e,r,n)=>!!(e?.value.toLowerCase()===Le.FROM&&(r?.isVariable()||r?.value!==""&&r?.value.toLowerCase()!==Le.FROM))},{id:N.X7.WhereKeyword,name:N.X7.WhereKeyword,resolve:(a,e,r,n)=>!!(e?.value.toLowerCase()===Le.WHERE&&(r?.isKeyword()||r?.is(N.ks.Parenthesis,"(")||r?.is(N.ks.Operator,Le.AND)))},{id:N.X7.WhereComparisonOperator,name:N.X7.WhereComparisonOperator,resolve:(a,e,r,n)=>{var t;return!!(e?.value.toLowerCase()===Le.WHERE&&!((t=r?.getPreviousNonWhiteSpaceToken())!=null&&t.isOperator())&&!a?.is(N.ks.Delimiter,".")&&!a?.isParenthesis()&&(r?.isIdentifier()||r?.isDoubleQuotedString()))}},{id:N.X7.WhereValue,name:N.X7.WhereValue,resolve:(a,e,r,n)=>!!(e?.value.toLowerCase()===Le.WHERE&&r?.isOperator())},{id:N.X7.AfterWhereValue,name:N.X7.AfterWhereValue,resolve:(a,e,r,n)=>{var t,i,u;return!!(e?.value.toLowerCase()===Le.WHERE&&(r?.is(N.ks.Operator,"and")||r?.is(N.ks.Operator,"or")||r?.isString()||r?.isNumber()||r?.is(N.ks.Parenthesis,")")||r?.is(N.ks.Parenthesis,"()")||r?.isTemplateVariable()||r?.is(N.ks.IdentifierQuote)&&((t=r.getPreviousNonWhiteSpaceToken())!=null&&t.is(N.ks.Identifier))&&((u=(i=r?.getPreviousNonWhiteSpaceToken())==null?void 0:i.getPreviousNonWhiteSpaceToken())!=null&&u.is(N.ks.IdentifierQuote))))}},{id:N.X7.AfterGroupByKeywords,name:N.X7.AfterGroupByKeywords,resolve:(a,e,r,n)=>{var t;return!!(e?.is(N.ks.Keyword,Le.BY)&&((t=e?.getPreviousKeyword())!=null&&t.is(N.ks.Keyword,Le.GROUP))&&(r?.is(N.ks.Keyword,Le.BY)||r?.is(N.ks.Delimiter,",")))}},{id:N.X7.AfterGroupByFunctionArgument,name:N.X7.AfterGroupByFunctionArgument,resolve:(a,e,r,n)=>{var t;return!!(e?.is(N.ks.Keyword,Le.BY)&&((t=e?.getPreviousKeyword())!=null&&t.is(N.ks.Keyword,Le.GROUP))&&(r?.is(N.ks.Parenthesis,"(")||a?.is(N.ks.Parenthesis,"()")))}},{id:N.X7.AfterOrderByKeywords,name:N.X7.AfterOrderByKeywords,resolve:(a,e,r,n)=>{var t;return!!(r?.is(N.ks.Keyword,Le.BY)&&((t=r?.getPreviousKeyword())!=null&&t.is(N.ks.Keyword,Le.ORDER)))}},{id:N.X7.AfterOrderByFunction,name:N.X7.AfterOrderByFunction,resolve:(a,e,r,n)=>{var t,i;return!!(e?.is(N.ks.Keyword,Le.BY)&&((t=e?.getPreviousKeyword())!=null&&t.is(N.ks.Keyword,Le.ORDER))&&r?.is(N.ks.Parenthesis)&&((i=r?.getPreviousNonWhiteSpaceToken())!=null&&i.is(N.ks.Function)))}},{id:N.X7.AfterOrderByDirection,name:N.X7.AfterOrderByDirection,resolve:(a,e,r,n)=>!!(e?.is(N.ks.Keyword,Le.DESC)||e?.is(N.ks.Keyword,Le.ASC))},{id:N.X7.AfterIsOperator,name:N.X7.AfterIsOperator,resolve:(a,e,r,n)=>!!r?.is(N.ks.Operator,"IS")},{id:N.X7.AfterIsNotOperator,name:N.X7.AfterIsNotOperator,resolve:(a,e,r,n)=>{var t;return!!(r?.is(N.ks.Operator,"NOT")&&((t=r.getPreviousNonWhiteSpaceToken())!=null&&t.is(N.ks.Operator,"IS")))}}]}var ft=y(40621),Za=y(91040);let ei={logger:()=>{}},$n=()=>{};ft.h&&Za.h&&(ei=(0,Za.h)("SQLEditor"),$n=ei.logger,(0,ft.h)("sqleditor",void 0,ei));var Zi=y(33125);const Ho={id:"standardSql",extensions:[".sql"],aliases:["sql"],mimetypes:[],loader:()=>Promise.resolve().then(y.bind(y,10828)),completionProvider:Zi.N};var Ko=Object.defineProperty,ri=Object.defineProperties,eo=Object.getOwnPropertyDescriptors,Ni=Object.getOwnPropertySymbols,ro=Object.prototype.hasOwnProperty,to=Object.prototype.propertyIsEnumerable,wi=(a,e,r)=>e in a?Ko(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r,Zt=(a,e)=>{for(var r in e||(e={}))ro.call(e,r)&&wi(a,r,e[r]);if(Ni)for(var r of Ni(e))to.call(e,r)&&wi(a,r,e[r]);return a},ti=(a,e)=>ri(a,eo(e));const no="sql",oa=new Map,ua=new Map,Yo=({children:a,onBlur:e,onChange:r,query:n,language:t={id:no},width:i,height:u})=>{const o=(0,h.useRef)(null),s=(0,h.useRef)(),c=(0,h.useMemo)(()=>{const v=(0,Tt.A)(),g=`${t.id}-${v}`;return s.current=g,g},[t.id]);(0,h.useEffect)(()=>()=>{s.current&&ua.delete(s.current),$n(`Removing instance cache ${s.current}`,!1,ua)},[]);const f=(0,h.useCallback)(()=>{o.current&&o.current.getAction("editor.action.formatDocument").run()},[]),d=v=>{r&&r(v,!1),e&&e(v)};return h.createElement("div",{style:{width:i}},h.createElement(In.B,{height:u||"240px",width:i?`${i-2}px`:void 0,language:c,value:n,onBlur:d,showMiniMap:!1,showLineNumbers:!0,onEditorDidMount:(v,g)=>{o.current=v,v.onDidChangeModelContent(m=>{const E=v.getValue();r&&r(E,!1)}),v.addCommand(g.KeyMod.CtrlCmd|g.KeyCode.Enter,()=>{const m=v.getValue();r&&r(m,!0)}),v.onKeyUp(m=>{m.keyCode===84&&v.trigger(Ne.id,Ne.id,{})}),ao(g,t,c)}}),a&&a({formatQuery:f}))},Hr=(a,e)=>{if(e?.id!==no&&!e.loader){$n(`Loading language '${e?.id}' from Monaco registry`,!1);const n=a.languages.getLanguages().find(({id:t})=>t===e?.id);if(!n)throw Error(`Unknown Monaco language ${e?.id}`);return Zt(Zt({completionProvider:Zi.N},n),e)}return Zt(Zt({},Ho),e)},ao=async(a,e,r)=>{const n=Hr(a,e);if(!n.loader)return;const{language:t,conf:i}=await n.loader(a);if(a.languages.register({id:r}),a.languages.setMonarchTokensProvider(r,Zt({},t)),a.languages.setLanguageConfiguration(r,Zt({},i)),n.formatter&&a.languages.registerDocumentFormattingEditProvider(r,{provideDocumentFormattingEdits:u=>{var o;const s=(o=e.formatter)==null?void 0:o.call(e,u.getValue());return[{range:u.getFullModelRange(),text:s||""}]}}),n.completionProvider){const u=n.completionProvider(a,t);io(e.id,r,u);const o=oa.get(e.id),s=ua.get(r),c=async(f,d,v,g)=>{const m=Ur(a,f,d,r),E=bn(m,o.positionResolvers),O=Nt(E,o.suggestionKinds);$n("Statement position",!1,E),$n("Suggestion kinds",!1,O);const R={position:d,currentToken:m,statementPosition:E,kind:O,range:a.Range.fromPositions(d)};return{suggestions:await tn(a,m,O,R,s)}};a.languages.registerCompletionItemProvider(r,ti(Zt({},u),{provideCompletionItems:c}))}};function io(a,e,r){var n;oa.has(a)||wt(a);const t=oa.get(a);ua.has(e)||ua.set(e,new Q.O(ue(t.functions,t.operators,t.macros)));const i=ua.get(e);if(r.supportedFunctions)for(const u of r.supportedFunctions())t.functions.getIfExists(u.id)||t.functions.register(u);if(r.supportedOperators)for(const u of r.supportedOperators())t.operators.getIfExists(u.id)||t.operators.register(ti(Zt({},u),{name:u.id}));if(r.supportedMacros)for(const u of r.supportedMacros())t.macros.getIfExists(u.id)||t.macros.register(ti(Zt({},u),{name:u.id}));if(r.customStatementPlacement)for(const u of r.customStatementPlacement()){const o=t.positionResolvers.getIfExists(u.id);if(!o)t.positionResolvers.register(ti(Zt({},u),{id:u.id,name:u.id})),t.suggestionKinds.register({id:u.id,name:u.id,kind:[]});else{const s=o.resolve;o.resolve=(...c)=>{const f=u.resolve(...c);return u.overrideDefault?f:s(...c)||f}}}if(r.customSuggestionKinds)for(const u of r.customSuggestionKinds()){if((n=u.applyTo)==null||n.forEach(o=>{const s=t.suggestionKinds.getIfExists(o);s&&s.kind.indexOf(u.id)===-1&&s.kind.push(u.id)}),u.overrideDefault){const o=i.get(u.id);if(o!==void 0){o.suggestions=u.suggestionsResolver;continue}}i.register({id:u.id,name:u.id,suggestions:u.suggestionsResolver})}if(r.schemas){const u=i.get(N.ng.Schemas),o=u.suggestions;u.suggestions=async(s,c)=>{const f=await o(s,c);if(!r.schemas)return[...f];const v=(await r.schemas.resolve()).map(g=>{var m;return{label:g.name,insertText:`${(m=g.completion)!=null?m:g.name}.`,command:Ne,kind:N.Io.Module,sortText:N.mY.High}});return[...f,...v]}}if(r.tables){const u=i.get(N.ng.Tables),o=u.suggestions;u.suggestions=async(s,c)=>{var f,d,v,g,m;const E=await o(s,c),O=Fn(s.currentToken),w=((d=(f=r.tables)==null?void 0:f.parseName)!=null?d:Qt)(O),P=((m=await((g=(v=r.tables)==null?void 0:v.resolve)==null?void 0:g.call(v,w)))!=null?m:[]).map(F=>{var k;return{label:F.name,insertText:`${(k=F.completion)!=null?k:F.name}${F.completion===F.name?" $0":""}`,insertTextRules:N._E.InsertAsSnippet,command:Ne,kind:N.Io.Field,sortText:N.mY.MediumHigh}});return[...E,...P]}}if(r.columns){const u=i.get(N.ng.Columns),o=u.suggestions;u.suggestions=async(s,c)=>{var f,d,v;const g=await o(s,c),m=Fn(s.currentToken);let E;const O=(d=(f=r.tables)==null?void 0:f.parseName)!=null?d:Qt;m&&m.value&&(E=O(m));let R=[];if(E){const w=await((v=r.columns)==null?void 0:v.resolve(E));R=w?w.map(P=>{var F;return{label:P.name,insertText:(F=P.completion)!=null?F:P.name,kind:N.Io.Field,sortText:N.mY.High,detail:P.type,documentation:P.description}}):[]}return[...g,...R]}}}function wt(a){return oa.has(a)||oa.set(a,{functions:new Q.O,operators:new Q.O,suggestionKinds:new Q.O(pn),positionResolvers:new Q.O($r),macros:new Q.O}),oa.get(a)}function Nn({children:a,onChange:e,query:r,width:n,height:t,editorLanguageDefinition:i}){const u=(0,h.useRef)(r);(0,h.useEffect)(()=>{u.current=r},[r]);const o=(0,h.useCallback)((s,c)=>{const f={...u.current,rawQuery:!0,rawSql:s};e(f,c)},[e]);return h.createElement(Yo,{width:n,height:t,query:r.rawSql,onChange:o,language:i},a)}var _a=y(66864),ni=y(29158),Da=y(41053),oo=y(75198),ai=y(83195),zo=y(62930);function Pi({db:a,query:e,onValidate:r,range:n}){const[t,i]=(0,h.useState)(),u=(0,St.$j)(),o=(0,h.useMemo)(()=>(0,ai.j_)("bytes"),[]),s=(0,h.useMemo)(()=>({error:(0,Jr.css)`
        color: ${u.colors.error.text};
        font-size: ${u.typography.bodySmall.fontSize};
        font-family: ${u.typography.fontFamilyMonospace};
      `,valid:(0,Jr.css)`
        color: ${u.colors.success.text};
      `,info:(0,Jr.css)`
        color: ${u.colors.text.secondary};
      `}),[u]),[c,f]=(0,Da.A)(async v=>v.rawSql?.trim()===""?null:await a.validateQuery(v,n),[a]),[,]=(0,oo.A)(async()=>{const v=await f(e);return v&&i(v),null},1e3,[e,f]);if((0,h.useEffect)(()=>{t?.isError&&r(!1),t?.isValid&&r(!0)},[t,r]),!c.value&&!c.loading)return null;const d=c.value?.error?sa(c.value.error):"";return h.createElement(h.Fragment,null,c.loading&&h.createElement("div",{className:s.info},h.createElement(zo.y,{inline:!0,size:"xs"})," Validating query..."),!c.loading&&c.value&&h.createElement(h.Fragment,null,h.createElement(h.Fragment,null,c.value.isValid&&c.value.statistics&&h.createElement("div",{className:s.valid},h.createElement(Mt.I,{name:"check"})," This query will process"," ",h.createElement("strong",null,(0,ai.cN)(o(c.value.statistics.TotalBytesProcessed)))," ","when run.")),h.createElement(h.Fragment,null,c.value.isError&&h.createElement("div",{className:s.error},d))))}function sa(a){const e=a.split(":");return e.length>2?e.slice(2).join(":"):a}function _i({showTools:a,onFormatCode:e,onExpand:r,isExpanded:n,...t}){const i=(0,St.$j)(),[u,o]=(0,h.useState)(),s=(0,h.useMemo)(()=>({container:(0,Jr.css)`
        border: 1px solid ${i.colors.border.medium};
        border-top: none;
        padding: ${i.spacing(.5,.5,.5,.5)};
        display: flex;
        flex-grow: 1;
        justify-content: space-between;
        font-size: ${i.typography.bodySmall.fontSize};
      `,error:(0,Jr.css)`
        color: ${i.colors.error.text};
        font-size: ${i.typography.bodySmall.fontSize};
        font-family: ${i.typography.fontFamilyMonospace};
      `,valid:(0,Jr.css)`
        color: ${i.colors.success.text};
      `,info:(0,Jr.css)`
        color: ${i.colors.text.secondary};
      `,hint:(0,Jr.css)`
        color: ${i.colors.text.disabled};
        white-space: nowrap;
        cursor: help;
      `}),[i]);let c={};return!a&&u===void 0&&(c={height:0,padding:0,visibility:"hidden"}),h.createElement("div",{className:s.container,style:c},h.createElement("div",null,t.onValidate&&h.createElement(Pi,{...t,onValidate:f=>{o(f),t.onValidate(f)}})),a&&h.createElement("div",null,h.createElement(_a.Gy,{spacing:"sm"},e&&h.createElement(ni.K,{onClick:()=>{(0,Ee.rR)("grafana_sql_query_formatted",{datasource:t.query.datasource?.type}),e()},name:"brackets-curly",size:"xs",tooltip:"Format query"}),r&&h.createElement(ni.K,{onClick:()=>{(0,Ee.rR)("grafana_sql_editor_expand",{datasource:t.query.datasource?.type,expanded:!n}),r(!n)},name:n?"angle-up":"angle-down",size:"xs",tooltip:n?"Collapse editor":"Expand editor"}),h.createElement(Kt.m,{content:"Hit CTRL/CMD+Return to run query"},h.createElement(Mt.I,{className:s.hint,name:"keyboard"})))))}function wn({db:a,query:e,onChange:r,onRunQuery:n,onValidate:t,queryToValidate:i,range:u}){const o=(0,St.$j)(),s=(0,St.of)(ii),[c,f]=(0,h.useState)(!1),[d,v]=(0,ut.A)(),[g,m]=(0,ut.A)(),E=(0,h.useMemo)(()=>a.getEditorLanguageDefinition(),[a]),O=(P,F)=>h.createElement(Nn,{editorLanguageDefinition:E,query:e,width:P,height:F?F-v.height:void 0,onChange:r},({formatQuery:k})=>h.createElement("div",{ref:d},h.createElement(_i,{db:a,query:i,onValidate:t,onFormatCode:k,showTools:!0,range:u,onExpand:f,isExpanded:c}))),R=(P=!1)=>P?h.createElement(ba.Ay,null,({width:F,height:k})=>O(F,k)):h.createElement("div",{ref:g},O()),w=()=>h.createElement("div",{style:{width:m.width,height:m.height,background:o.colors.background.primary,display:"flex",alignItems:"center",justifyContent:"center"}},"Editing in expanded code editor");return h.createElement(h.Fragment,null,c?w():R(),c&&h.createElement(Un.a,{title:`Query ${e.refId}`,closeOnBackdropClick:!1,closeOnEscape:!1,className:s.modal,contentClassName:s.modalContent,isOpen:c,onDismiss:()=>{(0,Ee.rR)("grafana_sql_editor_expand",{datasource:e.datasource?.type,expanded:!1}),f(!1)}},R(!0)))}function ii(a){return{modal:(0,Jr.css)`
      width: 95vw;
      height: 95vh;
    `,modalContent:(0,Jr.css)`
      height: 100%;
      padding-top: 0;
    `}}var Ma=y(71087),Vr=y(88575),uo=y(27633);function oi(a){return uo.Ay.format(a).replace(/(\$ \{ .* \})|(\$ __)|(\$ \w+)/g,e=>e.replace(/\s/g,""))}function so({rawSql:a,datasourceType:e}){const[r,n]=(0,ht.A)(),t=(0,St.of)(ui),i=o=>{n(o),(0,Ee.rR)("grafana_sql_preview_copied",{datasource:e})},u=h.createElement("div",{className:t.labelWrapper},h.createElement("span",{className:t.label},"Preview"),h.createElement(ni.K,{tooltip:"Copy to clipboard",onClick:()=>i(a),name:"copy"}));return h.createElement(Vr.D,{label:u,className:t.grow},h.createElement(In.B,{language:"sql",height:80,value:oi(a),monacoOptions:{scrollbar:{vertical:"hidden"},scrollBeyondLastLine:!1},readOnly:!0,showMiniMap:!1}))}function ui(a){return{grow:(0,Jr.css)({flexGrow:1}),label:(0,Jr.css)({fontSize:12,fontWeight:a.typography.fontWeightMedium}),labelWrapper:(0,Jr.css)({display:"flex",justifyContent:"space-between",paddingBottom:a.spacing(.5)})}}function Va({query:a,onQueryChange:e,db:r}){return{onSqlChange:(0,h.useCallback)(t=>{const i=r.toRawSql,u=i({sql:t,dataset:a.dataset,table:a.table,refId:a.refId}),o={...a,sql:t,rawSql:u};e(o)},[r,e,a])}}var zt=y(7650),Hn=y(81392),la=y(3721);function ca({sql:a,columns:e,onSqlChange:r}){const n=(0,h.useCallback)(t=>{const i=t.map(o=>ct(o.property?.name)),u={...a,groupBy:i};r(u)},[r,a]);return h.createElement(zt.o,{items:a.groupBy,onChange:n,renderItem:lo({options:e})})}function lo({options:a}){return function(r,n,t){return h.createElement(Hn.M,null,h.createElement(Ft.l6,{value:r.property?.name?(0,Be.z)(r.property.name):null,"aria-label":"Group by",options:a,menuShouldPortal:!0,onChange:({value:i})=>i&&n(ct(i))}),h.createElement(la.Z,{"aria-label":"Remove group by column",icon:"times",variant:"secondary",onClick:t}))}}function co({fields:a,query:e,onQueryChange:r,db:n}){const{onSqlChange:t}=Va({query:e,onQueryChange:r,db:n});return h.createElement(ca,{columns:a,sql:e.sql,onSqlChange:t})}var vn=y(10354);const fo=[{description:"Sort by ascending",value:"ASC",icon:"sort-amount-up"},{description:"Sort by descending",value:"DESC",icon:"sort-amount-down"}];function Xo({sql:a,onSqlChange:e,columns:r,showOffset:n}){const t=(0,h.useCallback)(s=>{const c={...a,orderByDirection:s};e(c)},[e,a]),i=(0,h.useCallback)(s=>{const c={...a,limit:Number.parseInt(s.currentTarget.value,10)};e(c)},[e,a]),u=(0,h.useCallback)(s=>{const c={...a,offset:Number.parseInt(s.currentTarget.value,10)};e(c)},[e,a]),o=(0,h.useCallback)(s=>{const c={...a,orderBy:Ir(s?.value)};s===null&&(c.orderByDirection=void 0),e(c)},[e,a]);return h.createElement(h.Fragment,null,h.createElement(wr.c,{label:"Order by",width:25},h.createElement(Hn.M,null,h.createElement(Ft.l6,{"aria-label":"Order by",options:r,value:a.orderBy?.property.name?(0,Be.z)(a.orderBy.property.name):null,isClearable:!0,menuShouldPortal:!0,onChange:o}),h.createElement(We.$,{h:1.5}),h.createElement(ta.z,{options:fo,disabled:!a?.orderBy?.property.name,value:a.orderByDirection,onChange:t}))),h.createElement(wr.c,{label:"Limit",optional:!0,width:25},h.createElement(vn.p,{type:"number",min:0,id:(0,Ie.uniqueId)("limit-"),value:a.limit||"",onChange:i})),n&&h.createElement(wr.c,{label:"Offset",optional:!0,width:25},h.createElement(vn.p,{type:"number",id:(0,Ie.uniqueId)("offset-"),value:a.offset||"",onChange:u})))}function qo({fields:a,query:e,onQueryChange:r,db:n}){const{onSqlChange:t}=Va({query:e,onQueryChange:r,db:n});let i=[];return a&&(i=[{value:"",label:"Selected columns",options:e.sql?.columns?.map((o,s)=>{const c=o.name?`${o.name}(${o.parameters?.map(f=>f.name)})`:o.parameters?.map(f=>f.name);return{value:c,label:`${s+1} - ${c}`}}),expanded:!0},...a]),h.createElement(Xo,{sql:e.sql,onSqlChange:t,columns:i})}const Di=["AVG","COUNT","MAX","MIN","SUM"],Jo=["$__time","$__timeEpoch","$__timeFilter","$__timeFrom","$__timeTo","$__timeGroup","$__timeGroupAlias","$__unixEpochFilter","$__unixEpochNanoFilter","$__unixEpochNanoFrom","$__unixEpochNanoTo","$__unixEpochGroup","$__unixEpochGroupAlias"];var Kn=y(46819);const Qo={label:"*",value:"*"};function po({sql:a,format:e,columns:r,onSqlChange:n,functions:t}){const i=(0,St.of)(Zo),u=[Qo,...r||[]],o=[];e===Ue.Timeseries&&(o.push({label:"time",value:"time"}),o.push({label:"value",value:"value"}));const s=(0,h.useCallback)((g,m)=>E=>{let O={...g};g.parameters?.length?O.parameters=g.parameters.map(w=>w.type===nt.FunctionParameter?{...w,name:E.value}:w):O.parameters=[{type:nt.FunctionParameter,name:E.value}];const R={...a,columns:a.columns?.map((w,P)=>P===m?O:w)};n(R)},[n,a]),c=(0,h.useCallback)((g,m)=>E=>{const O={...g,name:E?.value},R={...a,columns:a.columns?.map((w,P)=>P===m?O:w)};n(R)},[n,a]),f=(0,h.useCallback)((g,m)=>E=>{let O={...g};E!==null?O={...g,alias:`"${E?.value?.trim()}"`}:delete O.alias;const R={...a,columns:a.columns?.map((w,P)=>P===m?O:w)};n(R)},[n,a]),d=(0,h.useCallback)(g=>()=>{const m=[...a.columns];m.splice(g,1);const E={...a,columns:m};n(E)},[n,a]),v=(0,h.useCallback)(()=>{const g={...a,columns:[...a.columns,xt()]};n(g)},[n,a]);return h.createElement(Kn.B,{gap:2,wrap:!0,direction:"column"},a.columns?.map((g,m)=>h.createElement("div",{key:m},h.createElement(Kn.B,{gap:2,alignItems:"end"},h.createElement(wr.c,{label:"Column",width:25},h.createElement(Ft.l6,{value:eu(g),options:u,inputId:`select-column-${m}-${(0,Ie.uniqueId)()}`,menuShouldPortal:!0,allowCustomValue:!0,onChange:s(g,m)})),h.createElement(wr.c,{label:"Aggregation",optional:!0,width:25},h.createElement(Ft.l6,{value:g.name?(0,Be.z)(g.name):null,inputId:`select-aggregation-${m}-${(0,Ie.uniqueId)()}`,isClearable:!0,menuShouldPortal:!0,allowCustomValue:!0,options:t,onChange:c(g,m)})),h.createElement(wr.c,{label:"Alias",optional:!0,width:15},h.createElement(Ft.l6,{value:g.alias?(0,Be.z)(g.alias):null,inputId:`select-alias-${m}-${(0,Ie.uniqueId)()}`,options:o,onChange:f(g,m),isClearable:!0,menuShouldPortal:!0,allowCustomValue:!0})),h.createElement(Gt.$n,{"aria-label":"Remove",type:"button",icon:"trash-alt",variant:"secondary",size:"md",onClick:d(m)})))),h.createElement(Gt.$n,{type:"button",onClick:v,variant:"secondary",size:"md",icon:"plus","aria-label":"Add",className:i.addButton}))}const Zo=()=>({addButton:(0,Jr.css)({alignSelf:"flex-start"})});function eu({parameters:a}){const e=a?.find(r=>r.type===nt.FunctionParameter);return e?.name?(0,Be.z)(e.name):null}function fa({fields:a,query:e,onQueryChange:r,db:n}){const{onSqlChange:t}=Va({query:e,onQueryChange:r,db:n}),i=[...Di,...n.functions?.()||[]].map(Be.z);return h.createElement(po,{columns:a,sql:e.sql,format:e.format,functions:i,onSqlChange:t})}var si=y(24705),br=y(23029),Tr=y(92901),Qe=y(9417),Fr=y(85501),Pr=y(56822),$e=y(53954),Se=y(64467),we=y(60436),qe=y(5544),Ar=y(82284),vr=y(49790),Me=y.n(vr),li=y(90179),jr=y.n(li),ru=0;const _r=function(){var a=(new Date().getTime().toString(16)+"FF").substr(0,11),e="ssssssss-xxxx-4xxx-yxxx-x".replace(/[xys]/g,function(r){var n=r==="s"?Math.floor(Math.random()*16):ru++&15,t=r==="x"?n:n&3|8;return t.toString(16)});return e+a};var Kr=function(e){return(0,Ar.A)(e)=="object"&&e!==null&&!Array.isArray(e)},gn=["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue","spelImportFuncs","spelImportValue"],Yn=["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"],Rr=function(e,r){return typeof e>"u"?r:e},da=function(e,r){return e===r?!0:vr.Map.isMap(e)?e.equals(r):JSON.stringify(e)==JSON.stringify(r)},pa=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e===r?!0:Array.isArray(e)?vo(e,r,n):vr.Map.isMap(e)?e.equals(r):(0,Ar.A)(e)=="object"?Mi(e,r,n):e===r};function vo(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(a===e)return!0;if(!a||!e)return!1;var n=a.length;if(e.length!==n)return!1;for(var t=0;t<n;t++){var i=r?pa(a[t],e[t],r):a[t]===e[t];if(!i)return!1}return!0}function Mi(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(a===e)return!0;if(!a||!e)return!1;var n=Object.keys(a),t=Object.keys(e),i=n.length;if(t.length!==i)return!1;for(var u=0;u<i;u++){var o=n[u],s=r?pa(a[o],e[o],r):a[o]===e[o];if(!s)return!1}return!0}var Pt=function(e){return(0,Ar.A)(e)==="object"&&e!==null&&typeof e.toJS=="function"};function at(a){return Pt(a)?a:new(Me()).List(a)}function va(a){return Pt(a)?a.toJS():a}var Vi=function(e){return e.replace(/[.*+?^${}()|[\]\\/]/g,"\\$&")},ci=function a(e){var r=["$$typeof","_owner","_store","ref","key"],n=function(o){return typeof o=="string"?o:typeof o=="function"?o.name:o};if(e instanceof Array)return e.map(function(u,o){return a(u)});if((0,Ar.A)(e)==="object"&&e!==null&&ga(e)){var t,i=jr()(e,r);return i.type&&(i.type=n(i.type)),i!=null&&(t=i.props)!==null&&t!==void 0&&t.children&&(i.props.children=a(i.props.children)),i}return e},ga=function(e){return(0,Ar.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).includes("type")&&Object.keys(e).includes("props")&&Object.keys(e).includes("key")&&Object.keys(e).includes("ref")&&Object.keys(e).includes("$$typeof")},Zr=function(e){return(0,Ar.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&typeof e.type=="string"&&Object.keys(e).includes("props")},At=function(e){var r=(0,Ar.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).length===1;return r};function ji(a){return new Promise(function(e){setTimeout(e,a)})}function zn(a,e){return a||(a=[]),e||(e=[]),e.map(function(r){return[r,a.indexOf(r)]}).map(function(r,n,t){var i=(0,qe.A)(r,2),u=i[0],o=i[1];if(o==-1){var s=t.slice(n+1),c=t.slice(0,n),f=c.reverse().find(function(v){var g=(0,qe.A)(v,2),m=g[0],E=g[1];return E!=-1}),d=s.find(function(v){var g=(0,qe.A)(v,2),m=g[0],E=g[1];return E!=-1});return d?[u,"before",d[0]]:f?[u,"after",f[0]]:[u,"append",null]}else return null}).filter(function(r){return r!==null}).reduce(function(r,n){var t=(0,qe.A)(n,3),i=t[0],u=t[1],o=t[2],s=r.indexOf(o);return r.indexOf(i)==-1&&(s>-1?r.splice(s+(u=="after"?1:0),0,i):r.splice(u=="append"?1/0:0,0,i)),r},a.slice())}var ma=function a(e){(0,Ar.A)(e)==="object"&&e!==null&&(Object.keys(e).forEach(function(r){a(e[r])}),Object.freeze(e))},ki=function a(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(Kr(e)){if(e.var)return n[e.var]=r,!0;if(!Kr(r))return!1;for(var i in e){var u=e[i],o=r[i];if(!a(u,o,n,[].concat((0,we.A)(t),[i])))return!1}return!0}else if(Array.isArray(e)){if(!Array.isArray(r))return!1;for(var s=0;s<e.length;s++){var c=e[s],f=r[s];if(!a(c,f,n,[].concat((0,we.A)(t),[s])))return!1}return!0}else return e===r},xi=function(){return typeof process<"u"&&process.env&&!1},en=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=e??xi();return r?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},Rt=function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r,n=0;n<e.length;n++){var t=e[n];if(t!==void 0){r=t;break}}return r},Xt=en(),tu=y(54756),mn=y.n(tu),fi=y(55364),ha=y.n(fi),go=y(44383),nn=y.n(go),mo=y(6924),Ui=y.n(mo),ho={formatField:function(e,r,n,t,i,u){return u?n:e},fieldSources:["field"],keepInputOnChangeFieldSrc:!0,fieldItemKeysForSearch:["label","path","altLabel","grouplabel"],listKeysForSearch:["title","value"],valueSourcesInfo:{value:{}},fieldSeparator:".",fieldSeparatorDisplay:".",canReorder:!0,canRegroup:!0,canDeleteLocked:!1,canLeaveEmptyGroup:!0,shouldCreateEmptyGroup:!1,canShortMongoQuery:!0,removeEmptyGroupsOnLoad:!0,removeIncompleteRulesOnLoad:!0,removeInvalidMultiSelectValuesOnLoad:!0,setOpOnChangeField:["keep","default"],groupOperators:["some","all","none"],defaultGroupConjunction:"AND",locale:{moment:"en"},valueLabel:"Value",valuePlaceholder:"Value",fieldLabel:"Field",operatorLabel:"Operator",funcLabel:"Function",fieldPlaceholder:"Select field",funcPlaceholder:"Select function",operatorPlaceholder:"Select operator",lockLabel:"Lock",lockedLabel:"Locked",deleteLabel:"Delete",addGroupLabel:"Add group",addCaseLabel:"Add condition",addDefaultCaseLabel:"Add default condition",defaultCaseLabel:"Default:",addRuleLabel:"Add rule",addSubRuleLabel:"Add sub rule",delGroupLabel:"Delete",notLabel:"Not",fieldSourcesPopupTitle:"Select source",valueSourcesPopupTitle:"Select value source",removeRuleConfirmOptions:null,removeGroupConfirmOptions:null},yo=y(95093),ya=y.n(yo);function l(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=p(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function p(a,e){if(a){if(typeof a=="string")return S(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(a,e)}}function S(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}function A(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function b(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?A(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var G=function(e){return(0,Ar.A)(e)=="object"&&e!==null&&!Array.isArray(e)},X=function(e,r){if(!(e==null||e==""))return G(e)?b(b({},e),{},{title:e.title||e.value}):{value:e,title:r!==void 0?r:""+e}},ne=function(e){var r=X(e);return G(r)?b(b({},X(e)),{},{isCustom:!0}):r},ce=function(e){if(Array.isArray(e))return e.map(function(i){return X(i)});if(!G(e))return e;var r=[];for(var n in e){var t=e[n];r.push(X(n,t))}return r},fe=function(e,r){if(Array.isArray(e)){var n=e.map(function(t){return X(t)});return n.find(function(t){return""+t.value==""+r})}else return e[r]!==void 0?X(r,e[r]):void 0},ve=function(e,r){if(e==null)return r;var n=fe(e,r);return n!==void 0?n.title:r},Ve=function(e,r){if(e==null)return r;var n=fe(e,r);return n!==void 0?n.value:r},Ge=function(e,r){var n=[];if(Array.isArray(e)){var t=l(e),i;try{for(t.s();!(i=t.n()).done;){var u=i.value,o=r(X(u));o!=null&&n.push(o)}}catch(f){t.e(f)}finally{t.f()}}else for(var s in e){var c=r(X(s,e[s]));c!=null&&n.push(c)}return n},ur=function(e,r){return Ge(r,function(n){return"".concat(n.value).indexOf(e)!=-1||n.title.indexOf(e)!=-1?n:null}).filter(function(n){return n!==null}).shift()},cr=function(e,r){return Ge(r,function(n){return""+n.value==""+e?n:null}).filter(function(n){return n!==null}).shift()},Ce=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),t=1;t<r;t++)n[t-1]=arguments[t];return e.interpose("children1").withMutations(function(i){return i.skip(1),i.push.apply(i,n),i})},Bt=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),t=1;t<r;t++)n[t-1]=arguments[t];return e.interpose("children1").withMutations(function(i){return i.push.apply(i,n),i})},jt=function(e,r){var n=new(Me()).OrderedMap((0,Se.A)({},e.get("id"),e)),t=e;return r.forEach(function(i){t=n.get(i),n=t.get("children1")}),t},ja=function(e){var r=e;function n(t,i){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=i.push(t.get("id")),s=t.getIn(["properties","isLocked"]);u&&s&&(r=r.deleteIn(Ce(o,"properties","isLocked")));var c=t.get("children1");c&&c.map(function(f,d){n(f,o,s||u)})}return n(e,new(Me()).List),r},Xn=function(e){var r=e;function n(t,i,u,o){if(t){var s=t.get("path"),c=t.get("id"),f=c||o,d=i.push(f);(!s||!s.equals(d))&&(r=r.setIn(Ce(d,"path"),d)),c||(r=r.setIn(Ce(d,"id"),f));var v=t.get("children1");v&&(v.constructor.name=="Map"&&(r=r.setIn(Ce(d,"children1"),new(Me()).OrderedMap(v))),v.map(function(g,m){n(g,d,u+1,m)}))}}return n(e,new(Me()).List,0),r},Eo=function(e){var r=e;function n(t,i,u,o){if(!t)return!1;var s=t.get("id")||o,c=i.push(s),f=t.get("children1");if(f){var d=f.map(function(v,g){return n(v,c,u+1,g)}).reduce(function(v,g){return v&&g},!0);if((f.size==0||d)&&u>0)return r=r.deleteIn(Ce(c)),!0}return!1}return n(e,new(Me()).List,0),r},Bd=function(e){var r=[],n={},t=0;function i(f,d,v,g,m,E,O,R,w){var P=f.get("type"),F=f.get("collapsed"),k=f.get("id"),W=f.get("children1"),q=f.getIn(["properties","isLocked"]),re=W?W.map(function(ge,Fe){return Fe}).toArray():null,Z=P=="rule_group",J=!m&&(!W||Z),te=re?.length>0,le=r.length,ee=t;r.push(k),v||(t+=1),O.height=(O.height||0)+1,n[k]={type:P,parent:d.length?d[d.length-1]:null,parentType:R,caseId:P=="case_group"?k:w,isDefaultCase:P=="case_group"&&!W,path:d.concat(k),lev:E,leaf:!W,index:le,id:k,children:re,leafsCount:0,_top:le,top:v?null:ee,collapsed:F,node:f,isLocked:q||g};var ie;if(W){var oe={};W.map(function(ge,Fe){i(ge,d.concat(k),v||F,g||q,m||Z,E+1,oe,P,P=="case_group"?k:w)}),F||(O.height=(O.height||0)+(oe.height||0),te&&!Z&&(ie=(oe.depth||0)+1))}w&&J&&n[w].leafsCount++;var pe=r.length,se=t,de=O.height;Object.assign(n[k],{_height:pe-le,height:de,bottom:(v?null:ee)+de}),ie!=null&&(Object.assign(n[k],{depth:ie}),O.depth=Math.max(O.depth||0,ie))}i(e,[],!1,!1,!1,0,{},null,null);for(var u=0;u<r.length;u++){var o=u>0?r[u-1]:null,s=u<r.length-1?r[u+1]:null,c=n[r[u]];c.prev=o,c.next=s}return{flat:r,items:n}},Wd=function(e){if(!e)return-1;var r=0;function n(t,i,u){var o,s,c;typeof t.get=="function"?(o=t.get("id"),s=t.get("children1"),c=t.get("type")):(o=t.id,s=t.children1,c=t.type);var f=c=="rule_group";r++,s&&!f&&s.map(function(d,v){n(d,i.concat(o),u+1)})}return n(e,[],0),r-1},nu=function(e){if(!e)return-1;var r=0;function n(t,i,u){var o,s,c;typeof t.get=="function"?(o=t.get("id"),s=t.get("children1"),c=t.get("type")):(o=t.id,s=t.children1,c=t.type),c=="rule"||c=="rule_group"?r++:s&&s.map(function(f,d){n(f,i.concat(o),u+1)})}return n(e,[],0),r},gs=function(e){var r=[];function n(t,i,u){var o=t.get("id"),s=t.get("children1"),c=t.getIn(["properties","valueError"]),f=t.getIn(["properties","field"]);c&&c.size>0&&c.filter(function(d){return d!=null}).size>0&&r.push(f),s&&s.map(function(d,v){n(d,i.concat(o),u+1)})}return e&&n(e,[],0),Array.from(new Set(r))},ms=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=e;function t(i,u){i.path&&delete i.path,!r&&u&&delete i.id;var o=i.properties;o&&o.operatorOptions==null&&delete o.operatorOptions;var s=i.children1;if(s){for(var c in s)t(s[c],c);r&&(i.children1=Object.values(s))}}return t(e,null),n},hs=function(e){var r=[],n=e.get("children1");return n&&n.map(function(t){var i=t.getIn(["properties","value"]),u;i&&i.size==1?(u=i.get(0),Array.isArray(u)&&u.length==0&&(u=null)):u=null,r=[].concat((0,we.A)(r),[u])}),r},au=function(e){return!e.get("children1")||e.get("children1").size==0},iu=function(e,r){return e.getIn(Ce(r,"children1")).size>0},$d=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e){var t=e;return t=t.toJS(),r&&(t=ms(t,n)),t}},ou=function(e){if(ys(e))return e;if(Es(e))return Gi(e);if(typeof e=="string"&&e.startsWith('["~#iM"'))throw"You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17";if(typeof e=="string")return Gi(JSON.parse(e));throw"Can't load tree!"},Hd=function(e,r){if(e){var n=Jn(r,void 0,!0);return hu(e,null,n,n)}},Kd=function(e){return gs(e).length==0},ys=function(e){return vr.Map.isMap(e)},Es=function(e){return(0,Ar.A)(e)=="object"&&(e.type=="group"||e.type=="switch_group")};function Gi(a){var e=(0,vr.fromJS)(a,function(r,n){var t;if(r=="properties"){t=n.toOrderedMap();for(var i=0;i<2;i++){var u;((u=t.get("value"))===null||u===void 0?void 0:u.get(i))===null&&(t=t.setIn(["value",i],void 0))}}else r=="value"&&Me().Iterable.isIndexed(n)?t=n.map(function(o){var s,c=o==null||(s=o.toJS)===null||s===void 0?void 0:s.call(o);return c!=null&&c.func?o.toOrderedMap():o!=null&&o.toJS?c:o}).toList():r=="asyncListValues"?t=n.toJS():r=="children1"&&Me().Iterable.isIndexed(n)?t=new(Me()).OrderedMap(n.map(function(o){return[o.get("id"),o]})):t=Me().Iterable.isIndexed(n)?n.toList():n.toOrderedMap();return t});return e}var Ss=y(87695);function Os(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=Yd(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function Yd(a,e){if(a){if(typeof a=="string")return Ts(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ts(a,e)}}function Ts(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}function As(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function ka(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?As(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):As(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var zd=function(e){return Array.from(new Set(e))},lO=function(e){return e.reduce(function(r,n){var t=_slicedToArray(n,2),i=t[0],u=t[1];return ka(ka({},r),{},_defineProperty({},i,u))},{})},uu=function(){return{errors:[]}},Xd=function(e,r){return Rs(e,r,!1)},Rs=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,t=uu(),i=Jn(r,void 0,!1),u=qd(i),o=e?So(e,u,i,"rule",t):void 0;o&&o.type!="group"&&(o=su(o,i));var s=o?ou(o):void 0;return n?[s,t.errors]:(t.errors.length&&console.warn("Errors while importing from JsonLogic:",t.errors),s)},qd=function(e){var r={};for(var n in e.operators){var t=e.operators[n];if(typeof t.jsonLogic=="string"){var i=(t._jsonLogicIsRevArgs?"#":"")+t.jsonLogic+"/"+Rr(t.cardinality,1);r[i]||(r[i]=[]),r[i].push(n)}else if(typeof t.jsonLogic2=="string"){var u=t.jsonLogic2+"/"+Rr(t.cardinality,1);r[u]||(r[u]=[]),r[u].push(n)}}var o={};for(var s in e.conjunctions){var c=e.conjunctions[s],f=c.jsonLogicConj||s.toLowerCase();o[f]=s}var d={},v=Os(mi(e)),g;try{for(v.s();!(g=v.n()).done;){var m=(0,qe.A)(g.value,2),E=m[0],O=m[1],R=void 0;O.jsonLogicIsMethod?R="#"+O.jsonLogic:typeof O.jsonLogic=="string"&&(R=O.jsonLogic),R&&(d[R]||(d[R]=[]),d[R].push(E))}}catch(k){v.e(k)}finally{v.f()}var w=e.settings.jsonLogic,P=w.groupVarKey,F=w.altVarKey;return{operators:r,conjunctions:o,funcs:d,varKeys:["var",P,F]}},So=function a(e,r,n,t,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,f=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d,v;At(e)&&(d=Object.keys(e)[0],v=e[d],Array.isArray(v)||(v=[v]));var g,m=i.errors.length,E=n.settings.jsonLogic.lockedOp,O=d=="!"&&v.length==1&&v[0]&&At(v[0])&&r.varKeys.includes(Object.keys(v[0])[0]),R=d=="!"&&!O,w=E&&d==E;w?g=a(v[0],r,n,t,i,u,o,s,c,!0):R?g=a(v[0],r,n,t,i,!u,o,s,c):t=="val"?g=Cs(d,v,r,n,u,i,c)||Ls(d,v,r,n,u,o,i,c)||Jd(e,o,s,n,i):t=="rule"&&(g=Is(d,v,r,n,u,i,c,!1)||np(d,v,r,n,u,i,c));var P=i.errors.length;return d!="!"&&g===void 0&&P==m&&i.errors.push("Can't parse logic ".concat(JSON.stringify(e))),w&&(g.properties.isLocked=!0),g},Jd=function(e,r,n,t,i){var u;if(e===void 0&&(e=r?.defaultValue),e!==void 0){var o=t.widgets[n||r?.mainWidget],s=r?.type;if(!o){i.errors.push("No widget for type ".concat(s));return}if(At(e)){i.errors.push("Unexpected logic in value: ".concat(JSON.stringify(e)));return}if(s=="time"&&typeof e=="number"){var c=Math.floor(e/60/60)%24,f=Math.floor(e/60)%60,d=e%60,v=o.valueFormat;if(v){var g=new Date(e);g.setMilliseconds(0),g.setHours(c),g.setMinutes(f),g.setSeconds(d),e=ya()(g).format(v)}else e="".concat(c,":").concat(f,":").concat(d)}if(["date","datetime"].includes(s)&&e&&!(e instanceof Date))try{var m=new Date(e);m instanceof Date&&m.toISOString()===e&&(e=m)}catch{i.errors.push("Can't convert value ".concat(e," as Date")),e=void 0}if(e instanceof Date&&r){var E=o.valueFormat;E&&(e=ya()(e).format(E))}var O;if(e&&r!==null&&r!==void 0&&(u=r.fieldSettings)!==null&&u!==void 0&&u.asyncFetch){var R=Array.isArray(e)?e:[e];O=R}return{valueSrc:"value",value:e,valueType:o.type,asyncListValues:O}}},Cs=function(e,r,n,t,i,u){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(n.varKeys.includes(e)&&typeof r[0]=="string"){var s=bo(t,r[0],o),c=ze(t,s);if(!c){u.errors.push("No config for field ".concat(s));return}return{valueSrc:"field",value:s,valueType:c.type}}},Qd=function(e,r,n,t,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,s=arguments.length>7?arguments[7]:void 0,c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,f=Object.keys(r)[0],d=Object.values(r)[0],v=function(pe,se){return Zd(pe,se,t,i,u,s,c)||ep(pe,se,t,i,u,o,s,c)},g=s.errors.length,m,E,O,R,w=v(f,d);if(w&&(m=w.field,E=w.fieldSrc),e&&(R=!0,O=n[0],n=[]),f=="reduce"&&Array.isArray(d)&&d.length==3){var P=d,F=(0,qe.A)(P,3),k=F[0],W=F[1],q=F[2];if(At(k)&&q==0&&At(W)&&Array.isArray(W["+"])&&W["+"][0]==1&&At(W["+"][1])&&W["+"][1].var=="accumulator")if(f=Object.keys(k)[0],d=Object.values(k)[0],f=="filter"){var re=d,Z=(0,qe.A)(re,2),J=Z[0],te=Z[1];if(At(J)){f=Object.keys(J)[0],d=Object.values(J)[0];var le=v(f,d);le&&(m=le.field,E=le.fieldSrc,O=te,R=!0)}}else{var ee=v(f,d);ee&&(m=ee.field,E=ee.fieldSrc,R=!0)}}var ie=s.errors.length;if(!m&&ie==g&&s.errors.push("Unknown LHS ".concat(JSON.stringify(r))),!!m)return{field:m,fieldSrc:E,having:O,isGroup:R,args:n}},Zd=function(e,r,n,t,i,u){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Array.isArray(r)||(r=[r]);var s=Cs(e,r,n,t,i,u,o);if(s)return{fieldSrc:"field",field:s.value}},ep=function(e,r,n,t,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,c=Ls(e,r,n,t,i,u,o,s);if(c)return{fieldSrc:"func",field:c.value}},Ls=function(e,r,n,t,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null;if(e){var c,f,d,v=e=="method";if(v){var g,m,E=(0,Ss.A)(r);g=E[0],c=E[1],m=E.slice(2),f=[g].concat((0,we.A)(m))}else c=e,f=r;var O=(v?"#":"")+c,R=u?.type||u?.returnType,w=(n.funcs[O]||[]).filter(function(se){return u?Ct(t,se).returnType==R:!0});if(w.length)d=w[0];else{var P=(0,Se.A)({},e,r),F=Os(mi(t)),k;try{for(F.s();!(k=F.n()).done;){var W=(0,qe.A)(k.value,2),q=W[0],re=W[1];if(re.jsonLogicImport&&(!R||re.returnType==R)){var Z=void 0;try{Z=re.jsonLogicImport(P)}catch{}Z&&(d=q,f=Z)}}}catch(se){F.e(se)}finally{F.f()}}if(d&&d){var J=Ct(t,d),te=Object.keys(J.args||{}),le=f.reduce(function(se,de,ge){var Fe=te[ge],De=J.args[Fe],ke;return De&&(ke=So(de,n,t,"val",o,!1,De,null,s)),ke!==void 0?ka(ka({},se),{},(0,Se.A)({},Fe,ke)):se},{});for(var ee in J.args){var ie=J.args[ee],oe=le[ee];if(oe===void 0){if(oe=ie?.defaultValue,oe!==void 0){var pe;oe={value:oe,valueSrc:(pe=oe)!==null&&pe!==void 0&&pe.func?"func":"value",valueType:ie.type}}if(oe===void 0){if(!(ie!=null&&ie.isOptional)){o.errors.push("No value for arg ".concat(ee," of func ").concat(d));return}}else le[ee]=oe}}return{valueSrc:"func",value:{func:d,args:le},valueType:J.returnType}}}},Is=function(e,r,n,t,i,u){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,c=n.conjunctions[e],f=t.settings.fieldSeparator;if(c){var d="group",v=r.map(function(P){return So(P,n,t,"rule",u,!1,null,null,o)}).filter(function(P){return P!==void 0}).reduce(function(P,F){return ka(ka({},P),{},(0,Se.A)({},F.id,F))},{}),g=Object.values(v).map(function(P){var F,k;return(P==null||(F=P.properties)===null||F===void 0?void 0:F.fieldSrc)=="field"&&(P==null||(k=P.properties)===null||k===void 0?void 0:k.field)}).filter(function(P){var F;return P==null||(F=P.includes)===null||F===void 0?void 0:F.call(P,f)}),m=Object.fromEntries(zd(g).map(function(P){var F=P.split(f),k=Object.fromEntries(F.slice(0,-1).map(function(W,q,re){return[].concat((0,we.A)(re.slice(0,q)),[W])}).map(function(W){return[W.join(f),ze(t,W)]}).filter(function(W){var q=(0,qe.A)(W,2),re=q[0],Z=q[1];return Z?.type=="!group"}));return[P,Object.keys(k)]})),E={conjunction:c,not:i},O=_r(),R={},w={};return Object.entries(v).map(function(P){var F=(0,qe.A)(P,2),k=F[0],W=F[1];if(W?.type=="group"||W?.type=="rule_group")R[k]=W;else{var q,re=W==null||(q=W.properties)===null||q===void 0?void 0:q.field,Z=m[re]||[],J=Z[Z.length-1];if(!J)W&&(R[k]=W);else{var te=R,le=it(o,t),ee=it(J,t),ie=pa(le,ee.slice(0,le.length));ie||(le=[]);var oe=J.split(f).slice(le.length).map(function(pe,se,de){return[].concat((0,we.A)(le),(0,we.A)(de.slice(0,se)),[pe]).join(f)}).map(function(pe){return{f:pe,fc:ze(t,pe)||{}}}).filter(function(pe){var se=pe.fc;return se.type!="!struct"});oe.map(function(pe,se){var de=pe.f,ge=pe.fc,Fe=w[de];Fe||(Fe=_r(),w[de]=Fe,te[Fe]={type:"rule_group",id:Fe,children1:{},properties:{conjunction:c,not:!1,field:de,fieldSrc:"field",mode:ge.mode}}),te=te[Fe].children1}),te[k]=W}}}),{type:d,id:O,children1:R,properties:E}}},rp=function(e,r,n,t,i){if(e)return{type:"rule_group",id:_r(),children1:(0,Se.A)({},e.id,e),properties:{conjunction:i||Oo(t,n),not:!1,field:r}}},su=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{type:"group",id:_r(),children1:(0,Se.A)({},e.id,e),properties:{conjunction:Dn(r),not:n}}},tp=function(e,r,n,t,i,u,o){var s=uu(),c=bs(e,r,n,t,i,u,!1,s);if(c||(c=bs(e,r,n,t,i,u,!0,uu())),!c){o.errors.push(s.errors.join("; ")||"Unknown op ".concat(e,"/").concat(r));return}return c},bs=function(e,r,n,t,i,u,o,s){var c=(e=="all"||e=="some")&&At(n[1])&&Object.keys(n[1])[0]=="in",f=!c&&u.settings.groupOperators.includes(e),d=["==","!="],v=f?0:r-1;f?v=0:d.includes(e)&&v==1&&n[1]===null&&(r=1,v=0,n=[n[0]]);var g=e+"/"+v,m=i.operators[(o?"#":"")+g];if(m){var E,O=[],R=["<","<=",">",">="];if(R.includes(e)&&r==3)E=n[1],O=[n[0],n[2]];else if(o)E=n[1],O=[n[0]];else{var w=n,P=(0,Ss.A)(w);E=P[0],O=P.slice(1)}if(!At(E)){s.errors.push("Incorrect operands for ".concat(e,": ").concat(JSON.stringify(n)));return}var F=Qd(f,E,O,i,u,null,null,s,t);if(F){var k=F.field,W=F.fieldSrc,q=F.having,re=F.isGroup,Z=F.args,J=ze(u,k);if(!J){s.errors.push("No config for LHS ".concat(k));return}var te=m[0];if(m.length>1&&J&&J.operators){if(m=m.filter(function(le){return J.operators.includes(le)}),m.length==0){s.errors.push("No corresponding ops for LHS ".concat(k));return}te=m[0]}return{field:k,fieldSrc:W,fieldConfig:J,opKey:te,args:Z,having:q}}}},np=function a(e,r,n,t,i,u){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(e){var s=r.length;if((e=="all"||e=="some")&&At(r[1])){var c=Object.keys(r[1])[0];c=="in"&&(r=[r[0],r[1][c][1]],e=e+"-"+c)}var f=tp(e,s,r,o,n,t,u);if(f){var d=f.field,v=f.fieldSrc,g=f.fieldConfig,m=f.opKey,E=f.args,O=f.having,R=t.operators[m],w=g.showNot!==void 0?g.showNot:t.settings.showNot,P=!0,F,k,W=!1;if(g.type=="!group"&&O){F=Object.keys(O)[0],k=O[F],Array.isArray(k)||(k=[k]);var q=F=="!"&&k.length==1&&k[0]&&At(k[0])&&n.varKeys.includes(Object.keys(k[0])[0]);F=="!"&&!q&&(W=!0,O=O["!"],F=Object.keys(O)[0],k=O[F],Array.isArray(k)||(k=[k]))}i&&P&&R.reversedOp&&(i=!1,m=R.reversedOp,R=t.operators[m]);var re=Yr(t,d,m,null),Z=E.map(function(oe){return So(oe,n,t,"val",u,!1,g,re,o)});if(!Z.filter(function(oe){return oe===void 0}).length){var J,te=g.type;if((te==="!group"||te==="!struct")&&(te=null),g.type=="!group"&&O){if(n.conjunctions[F]!==void 0)J=Is(F,k,n,t,W,u,d,!0),W=!1;else{var le=a(F,k,n,t,W,u,d);W=!1,J=rp(le,d,g,t,n.conjunctions.and)}if(!J)return;J.type="rule_group",Object.assign(J.properties,{field:d,mode:g.mode,operator:m}),g.mode=="array"&&Object.assign(J.properties,{value:Z.map(function(oe){return oe.value}),valueSrc:Z.map(function(oe){return oe.valueSrc}),valueType:Z.map(function(oe){return oe.valueType})}),i&&(J=su(J,t,i))}else if(g.type=="!group"&&!O)J={type:"rule_group",id:_r(),children1:{},properties:{conjunction:Oo(t,g),not:i,mode:g.mode,field:d,operator:m}},g.mode=="array"&&Object.assign(J.properties,{value:Z.map(function(oe){return oe.value}),valueSrc:Z.map(function(oe){return oe.valueSrc}),valueType:Z.map(function(oe){return oe.valueType})});else{var ee=Z.map(function(oe){return oe.asyncListValues}).filter(function(oe){return oe!=null}),ie=ee.length?ee[0]:void 0;J={type:"rule",id:_r(),properties:ka({field:d,fieldSrc:v,operator:m,value:Z.map(function(oe){return oe.value}),valueSrc:Z.map(function(oe){return oe.valueSrc}),valueType:Z.map(function(oe){return oe.valueType})},ie?{asyncListValues:ie}:{})},i&&(J=su(J,t,i))}return J}}}},ap=y(21450),ip=y(61526),op=y.n(ip),Ea=op();Ea.trim=function(a){return a.charAt(0)=="'"?a.substring(1,a.length-1):a},Ea.escapeLike=function(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=Ea.escape(a);return n=Ea.trim(n),n=n.replace(/[%_]/g,"\\$&"),n=(e?"%":"")+n+(r?"%":""),n="'"+n+"'",n};var Fs=function(e){var r="''",n=e?.type;return n=="date"?r="'0000-00-00'":n=="datetime"?r="'0000-00-00 00:00'":n=="time"?r="'00:00'":n=="number"&&(r="0"),r},Ns=function(e){var r="",n=e?.type;return n=="number"&&(r=0),r},up=function(e){return"'"+e.replace(/'/g,"''")+"'"},sp=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n,t,i=["int","float"];e.map(function(s){if(s!=null){if(typeof s=="string")t="String";else if(typeof s=="number")t=Number.isInteger(s)?"int":"float";else throw new Error("spelEscape: Can't use value ".concat(s," in array"));if(!n)n=t;else if(n!=t)if(i.includes(n)&&i.includes(t))n="float";else throw new Error("spelEscape: Can't use different types in array: found ".concat(n," and ").concat(t))}}),n||(n="String");var u;n=="float"?u=e.map(function(s){return di(s,!0)}):u=e.map(function(s){return di(s)});var o;return r?o="new ".concat(n,"[]{").concat(u.join(", "),"}"):o="{".concat(u.join(", "),"}"),o},ws=function(e){return"".concat(e,".?[true]")},di=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e==null)return"null";switch((0,Ar.A)(e)){case"boolean":return e?"true":"false";case"number":return!Number.isFinite(e)||isNaN(e)?void 0:e+(!Number.isInteger(e)||r?"f":"");case"object":if(Array.isArray(e))return sp(e,n);throw new Error("spelEscape: Object is not supported");default:return up(e)}},lp=function(e){return e&&Array.isArray(e)&&e.length?e.map(function(r){if(r.type=="const")return di(r.value);if(r.type=="property")return""+r.value;if(r.type=="variable")return"#"+r.value}).filter(function(r){return r!=null}).join(" + "):"null"},cp=function(e){if(e==null)return[void 0,[]];var r=[],n=e.valueType=="case_value"?e.value:[e],t=n.map(function(i){if(i.valueSrc=="value")return i.value===null?void 0:{type:"const",value:i.value};if(i.valueSrc=="field")return{type:i.isVariable?"variable":"property",value:i.value};r.push("Unsupported valueSrc ".concat(i.valueSrc," in concatenation"))}).filter(function(i){return i!=null});return[t,r]},Ps=function(e){return e==null?"NULL":e.toString()};function _s(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=fp(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function fp(a,e){if(a){if(typeof a=="string")return Ds(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ds(a,e)}}function Ds(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}function Ms(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Vs(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ms(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Ms(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var lu="${0}.compareTo(${1})",dp={datetime:!0,time:!0,date:!0},pp=function(e,r){return js(e,r,!1)},js=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,t={errors:[]},i=Jn(r,void 0,!1),u=ks(e,i,t,null);return n?[u,t.errors]:(t.errors.length&&console.warn("Errors while exporting to SpEL:",t.errors),u)},ks=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(e){var i=e.get("type");if(i==="group"||i==="rule_group")return Us(e,r,n,t);if(i==="rule")return mp(e,r,n,t);if(i=="switch_group")return vp(e,r,n,t);if(i=="case_group")return xs(e,r,n,t)}},xs=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=e.get("type");if(i!="case_group"){n.errors.push("Unexpected child of type ".concat(i," inside switch"));return}var u=e.get("properties")||new vr.Map,o=cu(r,u,n,null,t,"!case_value"),s=(0,qe.A)(o,3),c=s[0],f=s[1],d=s[2],v=Us(e,r,n,t);return[v,c]},vp=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=e.get("properties")||new vr.Map,u=e.get("children1");if(u){var o=u.map(function(O){return xs(O,r,n,null)}).filter(function(O){return typeof O<"u"}).toArray();if(o.length){if(o.length==1&&!o[0][0])return o[0][1];for(var s=[],c=0;c<o.length;c++)c!=o.length-1&&!o[c][0]?n.errors.push("No condition for case ".concat(c)):(s.push(o[c]),c==o.length-1&&o[c][0]&&s.push([void 0,null]));for(var f="",d="",v=0;v<s.length;v++){var g=(0,qe.A)(s[v],2),m=g[0],E=g[1];E==null&&(E="null"),m==null&&(m="true"),v!=s.length-1?(f+="(".concat(m," ? ").concat(E," : "),d+=")"):f+="".concat(E)}return f+d}}},Us=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=e.get("type"),u=e.get("properties")||new vr.Map,o=u.get("mode"),s=e.get("children1")||new vr.List,c=u.get("field"),f=u.get("conjunction");f||(f=Dn(r));var d=r.conjunctions[f],v=u.get("not"),g=i==="rule_group",m=g&&o!="struct",E=m?c:t,O=ze(r,E)||{},R=O.isSpelArray,w=r.settings.fieldSeparator,P=u.get("operator");!P&&(!o||o=="some")&&(P="some");var F=Bs(r,P,c),k=F!=P,W=P&&Gr(r,F,c)||null,q=g&&(!F||W.cardinality==0),re=cu(r,u,n,F,t,null),Z=(0,qe.A)(re,3),J=Z[0],te=Z[1],le=Z[2],ee=s.map(function(Oe){return ks(Oe,r,n,E)}).filter(function(Oe){return typeof Oe<"u"});if(m&&!q){if(J==null)return}else if(!ee.size)return;var ie=g,oe=ee.size?d.spelFormatConj(ee,f,v,ie):null,pe;if(m){var se=du(n,r,c,t),de=w||".",ge=de+(R?"length":"size()"),Fe="".concat(se).concat(ge),De=oe?"".concat(se,".?[").concat(oe,"]").concat(ge):Fe,ke=q?Fe:J;pe=Gs(n,r,u,De,ke,F,te,le,k)}else pe=oe;return pe},gp=function(e,r,n){var t=r.spelOp;if(t){var i=t.includes("${0}"),u=dp[n],o=t,s,c=Rr(r.cardinality,1);return u?s=function(d,v,g,m,E,O,R,w){var P=lu.replace(/\${(\w+)}/g,function(F,k){return k==0?d:c>1?g[k-1]:g});return"".concat(P," ").concat(o," 0")}:i?s=function(d,v,g,m,E,O,R,w){return t.replace(/\${(\w+)}/g,function(P,F){return F==0?d:c>1?g[F-1]:g})}:c==0?s=function(d,v,g,m,E,O,R,w){return"".concat(d," ").concat(o)}:c==1&&(s=function(d,v,g,m,E,O,R,w){return"".concat(d," ").concat(o," ").concat(g)}),s}},Gs=function(e,r,n,t,i,u,o,s){var c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,f=n.get("field"),d=Gr(r,u,f)||{},v=ze(r,f)||{},g=n.get("operatorOptions"),m=d.spelFormatOp||gp(u,d,s);if(!m){e.errors.push("Operator ".concat(u," is not supported"));return}var E=[t,u,i,o,s,jr()(d,Yn),g,v],O;return O=m.call.apply(m,[r.ctx].concat(E)),c&&(O=r.settings.spelFormatReverse(O)),O===void 0&&e.errors.push("Operator ".concat(u," is not supported for value source ").concat(o)),O},Bs=function(e,r,n){if(r){var t=Gr(e,r,n)||{},i=t.reversedOp,u=Gr(e,i,n)||{},o=!1,s=t.spelOp||t.spelFormatOp,c=u.spelOp||u.spelFormatOp;if(!(!s&&!c)){if(!s&&c){o=!0;var f=[i,r];r=f[0],i=f[1];var d=[u,t];t=d[0],u=d[1]}return r}}},mp=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=e.get("properties")||new vr.Map,u=i.get("field"),o=i.get("fieldSrc"),s=i.get("operator");if(!(u==null||s==null)){var c=Bs(r,s,u);if(!c){n.errors.push("Operator ".concat(s," is not supported"));return}var f=c!=s,d=cu(r,i,n,c,t,null),v=(0,qe.A)(d,3),g=v[0],m=v[1],E=v[2];if(g!==void 0){var O=hp(n,r,u,o,t);if(O!==void 0){var R=Gs(n,r,i,O,g,c,m,E,f);return R}}}},hp=function(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;return t==="func"?Ws(e,r,n,i):du(e,r,n,i)},cu=function(e,r,n,t,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=r.get("field"),s=r.get("valueSrc"),c=r.get("valueType");(u=="!case_value"||c&&c.get(0)=="case_value")&&(o="!case_value");var f=ze(e,o)||{},d=Gr(e,t,o)||{},v=Rr(d.cardinality,1),g=r.get("value"),m=r.get("asyncListValues"),E=[],O=[],R;if(g!=null){var w=g.map(function(F,k){var W=s?s.get(k):null,q=c?c.get(k):null,re=Ga(F,W,e),Z=Yr(e,o,t,W),J=jr()(kt(e,o,t,Z,W),["factory"]),te=fu(n,e,re,W,q,J,f,t,d,i,m);return te!==void 0&&(E.push(W),O.push(q)),te}),P=w.filter(function(F){return F===void 0}).size>0;w.size<v||P||(R=v>1?w.toArray():v==1?w.first():null)}return[R,E.length>1?E:E[0],O.length>1?O:O[0]]},fu=function(e,r,n,t,i,u,o,s,c){var f=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0;if(n!==void 0){var v;if(t=="field")v=du(e,r,n,f);else if(t=="func")v=Ws(e,r,n,f);else if(typeof u.spelFormatValue=="function"){var g=u.spelFormatValue,m=[n,Vs(Vs({},nn()(o,["fieldSettings","listValues"])),{},{asyncListValues:d}),jr()(u,gn)];if(s&&(m.push(s),m.push(c)),t=="field"){var E=ze(r,n)||{};m.push(E)}v=g.call.apply(g,[r.ctx].concat(m))}else v=di(n);return v}},du=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(n){var i=r.settings.fieldSeparator,u=ze(r,n)||{},o=it(n,r),s=fl(n,r,t),c=r.settings.formatSpelField,f=qn(n,r,e,t),d=s.map(function(g){var m=(0,qe.A)(g,3),E=m[0],O=m[1],R=m[2],w;R&&(R.type=="!struct"||R.type=="!group"&&R.mode=="struct"?w=O.isSpelMap?"map":"class":R.type=="!group"?w=O.isSpelItemMap?"[map]":"[class]":w="class");var P=O?.isSpelVariable;return{key:E,parent:w,isSpelVariable:P,fieldSeparator:i}}),v=c.call(r.ctx,f,t,o,d,u,r);return v}},Ws=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=n.get("func"),u=n.get("args"),o=Ct(r,i);if(!o){e.errors.push("Func ".concat(i," is not defined in config"));return}var s={},c=[],f=[];for(var d in o.args){var v,g=o.args[d],m=ze(r,g),E=g.defaultValue,O=g.isOptional,R=E!=null&&E.func?"func":"value",w=u?u.get(d):void 0,P=w?w.get("value"):void 0,F=w?w.get("valueSrc"):void 0,k=w?w.get("asyncListValues"):void 0,W=(v=g.spelEscapeForFormat)!==null&&v!==void 0?v:!0,q=null,re=Yr(r,g,q,F),Z=jr()(kt(r,g,q,re,F),["factory"]),J=fu(e,r,P,F,g.type,Z,m,null,null,t,k);if(P!=null&&J===void 0){F!="func"&&e.errors.push("Can't format value of arg ".concat(d," for func ").concat(i));return}var te=void 0;if(J===void 0&&!O&&E!=null){var le=Yr(r,g,q,R),ee=jr()(kt(r,g,q,le,R),["factory"]);if(te=fu(e,r,E,R,g.type,ee,m,null,null,t,k),te===void 0){R!="func"&&e.errors.push("Can't format default value of arg ".concat(d," for func ").concat(i));return}}var ie=J??te;if(ie!==void 0){if(c.length){var oe=_s(c),pe;try{for(oe.s();!(pe=oe.n()).done;){var se=pe.value;s[se]=void 0}}catch(Je){oe.e(Je)}finally{oe.f()}c=[]}s[d]=W?ie:P??E}else O||f.push(d),c.push(d)}if(!f.length){var de;if(typeof o.spelFormatFunc=="function"){var ge=o.spelFormatFunc,Fe=[s];de=ge.call.apply(ge,[r.ctx].concat(Fe))}else if(o.spelFunc){de=o.spelFunc.replace(/\${(\w+)}/g,function(Je,xe){var Ze;return(Ze=s[xe])!==null&&Ze!==void 0?Ze:Je});var De=Object.keys(o.args||{}).reverse().filter(function(Je){return!!o.args[Je].isOptional}),ke=_s(De),Oe;try{for(ke.s();!(Oe=ke.n()).done;){var je=Oe.value;if(s[je]!=null)break;de=de.replace(new RegExp("(, )?\\${"+je+"}","g"),"")}}catch(Je){ke.e(Je)}finally{ke.f()}de=de.replace(/\${(\w+)}/g,"null")}else e.errors.push("Func ".concat(i," is not supported"));return de}};function Pn(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=yp(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function yp(a,e){if(a){if(typeof a=="string")return $s(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $s(a,e)}}function $s(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}function Hs(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Sr(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Hs(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Hs(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Ks={number:"number",string:"text",boolean:"boolean",null:"null"},Ys={String:"text"},Ep="multiselect",Sp=function(e){return["length"].includes(e)},zs=function(e){return(0,Ar.A)(e)=="object"&&e!==null&&!Array.isArray(e)},Op=function(e,r){return Xs(e,r,!0)},Xs=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,t={errors:[]},i=Jn(r,void 0,!1),u=Rp(i),o,s,c=void 0;try{var f=ap.SpelExpressionEvaluator.compile(e);o=f._compiledExpression}catch(v){t.errors.push(v)}o&&(s=Tp(o,t),Xt.debug("convertedObj:",s,t),c=pu(s,u,i,t),c&&c.type!="group"&&c.type!="switch_group"&&(c=Bi(c,i,s.not)),Xt.debug("jsTree:",c));var d=c?ou(c):void 0;return n?[d,t.errors]:(t.errors.length&&console.warn("Errors while importing from SpEL:",t.errors),d)},Tp=function a(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,t=e.getType(),i=e.getChildren().map(function(ee){return a(ee,r,e)});if((t=="op-or"||t=="op-and")&&(i=i.reduce(function(ee,ie){var oe=ie.type==t&&!ie.not,pe=oe?ie.children:[ie];return[].concat((0,we.A)(ee),(0,we.A)(pe))},[])),t=="op-not")return i.length!=1&&r.errors.push("Operator NOT should have 1 child, but got ".concat(i.length,"}")),Sr(Sr({},i[0]),{},{not:!i[0].not});if(t=="compound"){i=i.filter(function(ee){var ie=ee.type=="selection"&&ee.children.length==1&&ee.children[0].type=="boolean"&&ee.children[0].val==!0;return!ie});var u=i.find(function(ee){return ee.type=="selection"});u&&u.children.length!=1&&r.errors.push("Selection should have 1 child, but got ".concat(u.children.length));var o=u?u.children[0]:null,s=i[i.length-1],c=s.type=="method"&&s.val.methodName=="size"||s.type=="!func"&&s.methodName=="size",f=s.type=="property"&&s.val=="length",d=i.filter(function(ee){return ee!==u&&ee!==s}),v={type:"compound",children:d},g=(c||f)&&qs(d)!=null;if(g)return{type:"!aggr",filter:o,source:v};if(i=i.filter(function(ee){var ie=ee.type=="variable"&&ee.val=="this",oe=ee.type=="variable"&&ee.val=="root";return!(ie||oe)}),i=i.map(function(ee){return ee.type=="indexer"&&ee.children.length==1?{type:"indexer",val:ee.children[0].val,itype:ee.children[0].type}:ee}),s.type=="!func"){var m={},E=m;do{var O,R;Object.assign(E,s),i=i.filter(function(ee){return ee!==s}),s=i[i.length-1],((R=s)===null||R===void 0?void 0:R.type)=="!func"?(E.obj={},E=E.obj):i.length>1?E.obj={type:"compound",children:i}:E.obj=s}while(((O=s)===null||O===void 0?void 0:O.type)=="!func");return m}}var w;try{e.getRaw?w=e.getRaw():e.getValue.length==0&&(w=e.getValue())}catch(ee){Xt.error("[spel2js] Error in getValue()",ee)}if(t=="ternary"&&(w=Ap(i)),(0,Ar.A)(w)==="object"&&w!==null&&(w.methodName||w.functionName)&&(w.args=w.args.map(function(ee){return a(ee,r,e)})),t=="list"&&(w=w.map(function(ee){return a(ee,r,e)}),!n&&w.length==1))return w[0];if(t=="constructorref"){var P=i.find(function(ee){return ee.type=="qualifiedidentifier"}),F=P?.val;if(!F){r.errors.push("Can't find qualifiedidentifier in constructorref children: ".concat(JSON.stringify(i)));return}var k=i.filter(function(ee){return ee.type!="qualifiedidentifier"});return{type:"!new",cls:F,args:k}}if(t=="typeref"){var W=i.find(function(ee){return ee.type=="qualifiedidentifier"}),q=W?.val;if(!q){r.errors.push("Can't find qualifiedidentifier in typeref children: ".concat(JSON.stringify(i)));return}var re=i.filter(function(ee){return ee.type!="qualifiedidentifier"});return{type:"!type",cls:q}}if(t=="function"||t=="method"){var Z=w,J=Z.functionName,te=Z.methodName,le=Z.args;return{type:"!func",methodName:J||te,isVar:t=="function",args:le}}return{type:t,children:i,val:w}},Ap=function(e){var r=[];function n(t){var i=(0,qe.A)(t,3),u=i[0],o=i[1],s=i[2];r.push([u,o]),s?.type=="ternary"?n(s.children):r.push([void 0,s])}return n(e),r},Rp=function(e){var r={},n=function(oe){var pe=e.operators[oe];if(pe.spelOps)pe.spelOps.forEach(function(de){var ge=de;r[ge]||(r[ge]=[]),r[ge].push(oe)});else if(pe.spelOp){var se=pe.spelOp;r[se]||(r[se]=[]),r[se].push(oe)}else Xt.log("[spel] No spelOp for operator ".concat(oe))};for(var t in e.operators)n(t);var i={};for(var u in e.conjunctions){var o=e.conjunctions[u],s=o.spelConj||u.toLowerCase();i[s]=u}var c={},f=Pn(mi(e)),d;try{var v=function(){var oe=(0,qe.A)(d.value,2),pe=oe[0],se=oe[1],de=[],ge=se.spelFunc;if(typeof ge=="string"){var Fe=Object.keys(se.args||{}).reverse().filter(function(xe){return!!se.args[xe].isOptional||se.args[xe].defaultValue!=null}),De=ge.replace(/\${(\w+)}/g,function(xe,Ze){return"?"}),ke=Fe.reduce(function(xe,Ze){return[].concat((0,we.A)(xe),[[Ze].concat((0,we.A)(xe[xe.length-1]||[]))])},[]).map(function(xe){return ge.replace(/(?:, )?\${(\w+)}/g,function(Ze,Ye){return xe.includes(Ye)?"":Ze}).replace(/\${(\w+)}/g,function(Ze,Ye){return"?"})});de=[De].concat((0,we.A)(ke))}var Oe=Pn(de),je;try{for(Oe.s();!(je=Oe.n()).done;){var Je=je.value;c[Je]||(c[Je]=[]),c[Je].push(pe)}}catch(xe){Oe.e(xe)}finally{Oe.f()}};for(f.s();!(d=f.n()).done;)v()}catch(ie){f.e(ie)}finally{f.f()}var g={};for(var m in e.widgets){var E=e.widgets[m],O=E.spelImportFuncs,R=E.type;if(O){var w=Pn(O),P;try{for(w.s();!(P=w.n()).done;){var F=P.value;if(typeof F=="string"){var k=F.replace(/\${(\w+)}/g,function(ie,oe){return"?"}),W=(0,we.A)(F.matchAll(/\${(\w+)}/g)).map(function(ie){var oe=(0,qe.A)(ie,2),pe=oe[0],se=oe[1];return se});g[k]||(g[k]=[]),g[k].push({w:m,argsOrder:W})}}}catch(ie){w.e(ie)}finally{w.f()}}}var q={};for(var re in e.operators){var Z=e.operators[re],J=Z.spelOp;if(J!=null&&J.includes("${0}")){var te=J.replace(/\${(\w+)}/g,function(ie,oe){return"?"}),le=(0,we.A)(J.matchAll(/\${(\w+)}/g)).map(function(ie){var oe=(0,qe.A)(ie,2),pe=oe[0],se=oe[1];return se});q[te]||(q[te]=[]),q[te].push({op:re,argsOrder:le})}}var ee=lu.replace(/\${(\w+)}/g,function(ie,oe){return"?"});return q[ee]=[{op:"!compare",argsOrder:["0","1"]}],{operators:r,conjunctions:i,funcs:c,valueFuncs:g,opFuncs:q}},pu=function a(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e){var u,o=!0;if(e.type.indexOf("op-")===0||e.type==="matches")u=Cp(e,r,n,t,i);else if(e.type=="!aggr"){var s,c=a(e.source,r,n,t,Sr(Sr({},e),{},{_groupField:i?._groupField})),f=a(e.filter,r,n,t,Sr(Sr({},e),{},{_groupField:c?.value}));((s=f)===null||s===void 0?void 0:s.type)=="rule"&&(f=Bi(f,n,e.filter.not)),u={groupFilter:f,groupFieldValue:c},i||(u=void 0,t.errors.push("Unexpected !aggr in root"),o=!1)}else if(e.type=="ternary"){var d={};e.val.forEach(function(g){var m=(0,qe.A)(g,2),E=m[0],O=m[1],R=Qs(E,O,r,n,t,e);R&&(d[R.id]=R)}),u={type:"switch_group",id:_r(),children1:d,properties:{}}}if(!u&&o&&(u=pi(e,r,n,t,i)),u&&!u.type&&!i){var v=Js(e,r,n,t);v?u=v:(u=void 0,t.errors.push("Can't convert rule of type ".concat(e.type,", it looks like var/literal")))}return u}},Cp=function a(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u,o=e.type.startsWith("op-")?e.type.slice(3):e.type,s=(o=="minus"||o=="plus")&&e.children.length==1;if(s)return e.isUnary=!0,a(e.children[0],r,n,t,e);var c=o=="and"&&e.children.length==2&&e.children[0].type=="op-ge"&&e.children[1].type=="op-le",f=o=="or"&&e.children.length==2&&e.children[0].type=="op-lt"&&e.children[1].type=="op-gt",d=c||f;if(d){var v=(0,qe.A)(e.children[0].children,2),g=v[0],m=v[1],E=(0,qe.A)(e.children[1].children,2),O=E[0],R=E[1],w=Pp(g,O,e,r,n,t,i);if(w){var P=m.val,F=R.val,k={type:"op-between",children:[g,m,R]};return a(k,r,n,t,i)}}var W=r.operators[o];o=="eq"&&e.children[1].type=="null"?W=["is_null"]:o=="ne"&&e.children[1].type=="null"?W=["is_not_null"]:o=="le"&&e.children[1].type=="string"&&e.children[1].val==""?W=["is_empty"]:o=="gt"&&e.children[1].type=="string"&&e.children[1].val==""?W=["is_not_empty"]:o=="between"&&(W=["between"]);var q=function(){var mr,Or=e.children.map(function(tt){return pu(tt,r,n,t,Sr(Sr({},e),{},{_groupField:i?._groupField}))});return Or.length>=2&&((mr=Or)===null||mr===void 0||(mr=mr[0])===null||mr===void 0?void 0:mr.type)=="!compare"&&(Or=Or[0].children),Or};if(o=="and"||o=="or"){var re={},Z=q();Z.forEach(function(Ye){if(Ye){var mr=_r();Ye.id=mr,Ye.type!=null?re[mr]=Ye:t.errors.push("Bad item in AND/OR: ".concat(JSON.stringify(Ye)))}}),u={type:"group",id:_r(),children1:re,properties:{conjunction:r.conjunctions[o],not:e.not}}}else if(W){var J,te,le=q(),ee=le[0],ie=le.slice(1),oe=ee==null||(J=ee.groupFieldValue)===null||J===void 0?void 0:J.value,pe=(te=ie)===null||te===void 0?void 0:te[0],se=W[0];if(W.length>1){var de,ge,Fe=((de=le[0])===null||de===void 0?void 0:de.valueType)||((ge=le[1])===null||ge===void 0?void 0:ge.valueType),De=ee?.value,ke=W.map(function(Ye){return{op:Ye,widget:Yr(n,De,Ye)}});if(Xt.warn("[spel] Spel operator ".concat(o," can be mapped to ").concat(W,"."),"widgets:",ke,"vals:",le,"valueType=",Fe),o=="eq"||o=="ne"){var Oe=ke.find(function(Ye){var mr=Ye.op,Or=Ye.widget;return Or&&Or!="field"});Oe&&(se=Oe.op)}}ee!=null&&ee.groupFieldValue&&(pe&&pe.groupFieldValue&&pe.groupFieldValue.valueSrc=="field"&&pe.groupFieldValue.value==oe?(se="all",ie=[]):se=="equal"&&pe.valueSrc=="value"&&pe.valueType=="number"&&pe.value==0?(se="none",ie=[]):se=="greater"&&pe.valueSrc=="value"&&pe.valueType=="number"&&pe.value==0&&(se="some",ie=[]));var je=!0,Je=!1;if(e.not&&je){var xe=n.operators[se];xe.reversedOp?(se=xe.reversedOp,e.not=!1):Je=!0}if(ee)if(ee.groupFieldValue)ee.groupFieldValue.valueSrc!="field"&&t.errors.push("Expected group field ".concat(JSON.stringify(ee))),u=wp(ee,se,ie,n,t);else{ee.valueSrc!="field"&&ee.valueSrc!="func"&&t.errors.push("Expected field/func at LHS, but got ".concat(JSON.stringify(ee)));var Ze=ee.value;u=vu(n,t,Ze,se,ie)}Je&&(u.type!=="group"?u=Bi(u,n,e.not):u.properties.not=!u.properties.not)}else i||(u=Js(e,r,n,t));return u},qs=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,t=!1,i=e.map(function(u){if(u.type=="variable"||u.type=="property"||u.type=="indexer"&&u.itype=="string")return u.val;var o,s;t=!0,n&&(r==null||(o=r.errors)===null||o===void 0||(s=o.push)===null||s===void 0||s.call(o,"Unexpected item in field path compound: ".concat(JSON.stringify(u))))});return t?void 0:i},pi=function a(e,r,n,t,i){if(e!=null){var u=n.settings.fieldSeparator;if(e.type=="variable"||e.type=="property"){var o=bo(n,e.val,i?._groupField),s=ze(n,o),c=e.type=="variable";return{valueSrc:"field",valueType:s?.type,isVariable:c,value:o}}else if(e.type=="compound"){var f=qs(e.children,t);if(f){var d,v=bo(n,f.join(u),i?._groupField),g=ze(n,v),m=((d=e.children)===null||d===void 0||(d=d[0])===null||d===void 0?void 0:d.type)=="variable";return{valueSrc:"field",valueType:g?.type,isVariable:m,value:v}}}else if(Ks[e.type]){var E=e.val,O=Ks[e.type];return i!=null&&i.isUnary&&(E=-E),{valueSrc:"value",valueType:O,value:E}}else if(e.type=="!new"&&Ys[e.cls.at(-1)]){var R=e.args.map(function(J){return a(J,r,n,t,e)}),w=R?.[0],P=Ys[e.cls.at(-1)];return Sr(Sr({},w),{},{valueType:P})}else if(e.type=="list"){var F,k=e.val.map(function(J){return a(J,r,n,t,e)}),W=k.length?(F=k[0])===null||F===void 0?void 0:F.valueType:null,q=k.map(function(J){return J?.value}),re=Ep;return{valueSrc:"value",valueType:re,value:q}}else if(e.type=="op-plus"&&i?.type=="ternary")return Zs(e,r,n,t);var Z=bp(e,r,n,t,i);if(Z!==void 0)return Z;t.errors.push("Can't convert arg of type ".concat(e.type))}},Lp=function(e){var r=[{s:"",params:[],objs:[]}];return Ip(e,r),r.map(function(n){var t=n.s,i=n.params;return{s:t,params:i}}).reverse().filter(function(n){var t=n.s;return t!==""&&t!=="?"})},Ip=function a(e,r){var n=[],t="",i=e.type,u=e.methodName,o=e.val,s=e.obj,c=e.args,f=e.isVar,d=e.cls,v=e.children,g=v?.[v.length-1],m=r[r.length-1];if(i==="!func"){for(var E=s;E;){var O,R=a(Sr(Sr({},E),{},{obj:null}),[{}]),w=(0,qe.A)(R,2),P=w[0],F=w[1];if(P!=="?"){var k={s:m.s,params:(0,we.A)(m.params),objs:(0,we.A)(m.objs)};m.objs.unshift("?"),m.params.unshift(E),r.push(k),m=r[r.length-1]}m.objs.unshift(P),(O=m.params).unshift.apply(O,(0,we.A)(F)),E=E.type==="!func"?E.obj:null}var W=Pn(r),q;try{for(W.s();!(q=W.n()).done;){var re,Z=q.value;n=[].concat((0,we.A)(Z?.params||[]),(0,we.A)(c||[])),t="",Z!=null&&(re=Z.objs)!==null&&re!==void 0&&re.length&&(t+=Z.objs.join(".")+"."),t+=(f?"#":"")+u,t+="("+(c||[]).map(function(J){return"?"}).join(", ")+")",Z.s=t,Z.params=n}}catch(J){W.e(J)}finally{W.f()}}else i==="!new"?(n=c||[],t="new ".concat(d.join("."),"(").concat(n.map(function(J){return"?"}).join(", "),")")):i==="!type"?t="T(".concat(d.join("."),")"):i==="compound"&&g.type==="property"&&Sp(g.val)?t=v.map(function(J){var te;if(J===g)return J.val;var le=a(Sr(Sr({},J),{},{obj:null}),[{}]),ee=(0,qe.A)(le,2),ie=ee[0],oe=ee[1];return(te=n).push.apply(te,(0,we.A)(oe)),ie}).join("."):(n=[e],t="?");return m&&(m.s=t,m.params=n),[t,n]},bp=function(e,r,n,t,i){var u,o=function(se){return pi(se,r,n,t,Sr(Sr({},e),{},{_groupField:i?._groupField}))},s=Lp(e),c=s==null||(u=s[0])===null||u===void 0?void 0:u.s;s.length&&Xt.debug("Signatures for ",e,":",c,s);var f=Fp(e,r,n,t,i,s,o);if(f!==void 0)return f;var d=Np(e,r,n,t,i,s,o);if(d!==void 0)return d;var v,g,m,E=Pn(s),O;try{var R=function(){var se=O.value,de=se.s,ge=se.params,Fe=r.funcs[de];if(Fe){v=Fe[0],g=Ct(n,v);var De=g,ke=De.spelFunc,Oe=ge.map(o),je=(0,we.A)(ke.matchAll(/\${(\w+)}/g)).map(function(Je){var xe=(0,qe.A)(Je,2),Ze=xe[0],Ye=xe[1];return Ye});return m=Object.fromEntries(je.map(function(Je,xe){return[Je,Oe[xe]]})),"break"}};for(E.s();!(O=E.n()).done;){var w=R();if(w==="break")break}}catch(pe){E.e(pe)}finally{E.f()}if(!v){var P=Pn(mi(n)),F;try{for(P.s();!(F=P.n()).done;){var k=(0,qe.A)(F.value,2),W=k[0],q=k[1];if(q.spelImport){var re=void 0;try{re=q.spelImport(e)}catch{}if(re){v=W,g=Ct(n,v),m={};for(var Z in re)m[Z]=o(re[Z])}}}}catch(pe){P.e(pe)}finally{P.f()}}if(v){var J={};for(var te in g.args){var le=g.args[te],ee=m[te];if(ee===void 0)if(ee=le?.defaultValue,ee===void 0){if(!(le!=null&&le.isOptional)){t.errors.push("No value for arg ".concat(te," of func ").concat(v));return}}else{var ie;ee={value:ee,valueSrc:(ie=ee)!==null&&ie!==void 0&&ie.func?"func":"value",valueType:le.type}}ee&&(J[te]=ee)}return{valueSrc:"func",value:{func:v,args:J},valueType:g.returnType}}var oe=e.methodName;oe&&t.errors.push("Signature ".concat(c," - failed to convert"))},Fp=function(e,r,n,t,i,u,o){var s,c,f,d=[];for(var v in n.widgets){var g=n.widgets[v],m=g.spelImportFuncs;if(m)for(var E=0;E<m.length;E++){var O=m[E];if(zs(O)){var R={};if(ki(O,e,R)){for(var w in R)R[w]=o(R[w]);d.push({s:"widgets.".concat(v,".spelImportFuncs[").concat(E,"]"),w:v,argsObj:R})}}}}var P=Pn(u),F;try{for(P.s();!(F=P.n()).done;){var k=F.value,W=k.s,q=k.params,re=r.valueFuncs[W]||[],Z=Pn(re),J;try{var te=function(){var xe=J.value,Ze=xe.w,Ye=xe.argsOrder,mr=q.map(o),Or=Object.fromEntries(Ye.map(function(tt,Lt){return[tt,mr[Lt]]}));d.push({s:W,w:Ze,argsObj:Or})};for(Z.s();!(J=Z.n()).done;)te()}catch(Je){Z.e(Je)}finally{Z.f()}}}catch(Je){P.e(Je)}finally{P.f()}for(var le=0,ee=d;le<ee.length;le++){var ie=ee[le],oe=ie.s,pe=ie.w,se=ie.argsObj,de=n.widgets[pe],ge=de.spelImportValue,Fe=de.type;f=pe,c=oe,s=[];for(var De in se)["value"].includes(se[De].valueSrc)||s.push("".concat(De," has unsupported value src ").concat(se[De].valueSrc));var ke=se.v.value;if(ge&&!s.length){var Oe=ge.call(n.ctx,se.v,de,se),je=(0,qe.A)(Oe,2);ke=je[0],s=je[1],s&&!Array.isArray(s)&&(s=[s])}if(!s.length)return{valueSrc:"value",valueType:Fe,value:ke}}f&&s.length&&t.errors.push("Signature ".concat(c," - looks like convertable to ").concat(f,", but: ").concat(s.join("; ")))},Np=function(e,r,n,t,i,u,o){var s,c,f,d=Pn(u),v;try{for(d.s();!(v=d.n()).done;){var g=v.value,m=g.s,E=g.params,O=r.opFuncs[m]||[],R=Pn(O),w;try{var P=function(){var W,q=w.value,re=q.op,Z=q.argsOrder,J=E.map(o);if(c=re,re==="!compare"){if(i.type.startsWith("op-")&&i.children.length==2&&i.children[1].type=="number"&&i.children[1].val===0)return{v:{type:"!compare",children:J}};s.push("Result of compareTo() should be compared to 0")}f=m,s=[];var te=n.operators[c],le=te.spelOp,ee=te.valueTypes,ie=Object.fromEntries(Z.map(function(de,ge){return[de,J[ge]]})),oe=ie[0],pe=Object.keys(ie).filter(function(de){return parseInt(de)>0}).map(function(de){return ie[de]}),se=(W=J.filter(function(de){return!!de}).find(function(de){var ge=de.valueSrc;return ge==="value"}))===null||W===void 0?void 0:W.valueType;if(ee&&se&&!ee.includes(se)&&s.push("Op supports types ".concat(ee,", but got ").concat(se)),!s.length)return{v:vu(n,t,oe,c,pe,e)}};for(R.s();!(w=R.n()).done;){var F=P();if((0,Ar.A)(F)==="object")return F.v}}catch(k){R.e(k)}finally{R.f()}}}catch(k){d.e(k)}finally{d.f()}c&&s.length&&t.errors.push("Signature ".concat(f," - looks like convertable to ").concat(c,", but: ").concat(s.join("; ")))},vu=function(e,r,n,t,i,u){var o;if(!i.filter(function(w){return w===void 0}).length){var s=(o=n)!==null&&o!==void 0&&o.func?"func":"field";zs(n)&&n.valueSrc&&(s=n.valueSrc,n=n.value);var c=ze(e,n);if(!c){r.errors.push("No config for field ".concat(n));return}var f=!0,d=!1;if(u!=null&&u.not&&f){var v=e.operators[t];v.reversedOp?(t=v.reversedOp,u.not=!1):d=!0}var g=Yr(e,n,t),m=e.widgets[g||c.mainWidget],E=i.map(function(w){return w.asyncListValues}).filter(function(w){return w!=null}),O=E.length?E[0]:void 0,R={type:"rule",id:_r(),properties:Sr({field:n,fieldSrc:s,operator:t,value:i.map(function(w){return w.value}),valueSrc:i.map(function(w){return w.valueSrc}),valueType:i.map(function(w){return w.valueSrc=="value"&&(m?.type||c?.type)||w.valueType})},O?{asyncListValues:O}:{})};return d&&(R=Bi(R,e,u?.not),u!=null&&u.not&&(u.not=!1)),R}},wp=function(e,r,n,t,i){var u=e.groupFilter,o=e.groupFieldValue;if(o.valueSrc!="field")throw"Bad groupFieldValue: ".concat(JSON.stringify(o));var s=o.value,c=vu(t,i,s,r,n);if(c){var f=ze(t,s),d=f?.mode,v;return u?.type==="group"?v=Sr(Sr({},u||{}),{},{type:"rule_group",properties:Sr(Sr(Sr({},c.properties),u?.properties||{}),{},{mode:d})}):u?v=Sr(Sr({},c||{}),{},{type:"rule_group",children1:[u],properties:Sr(Sr({},c.properties),{},{mode:d})}):v=Sr(Sr({},c||{}),{},{type:"rule_group",properties:Sr(Sr({},c.properties),{},{mode:d})}),v.id||(v.id=_r()),v}},Pp=function(e,r,n,t,i,u){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(e.type==r.type)if(e.type=="!aggr"){var s=[e.source,r.source].map(function(O){return pi(O,t,i,u,Sr(Sr({},n),{},{_groupField:o?._groupField}))}),c=(0,qe.A)(s,2),f=c[0],d=c[1];return f.value==d.value}else{var v=[e,r].map(function(O){return pi(O,t,i,u,Sr(Sr({},n),{},{_groupField:o?._groupField}))}),g=(0,qe.A)(v,2),m=g[0],E=g[1];return m.value==E.value}return!1},Js=function(e,r,n,t){var i={},u=null,o=Qs(u,e,r,n,t);o&&(i[o.id]=o);var s={type:"switch_group",id:_r(),children1:i,properties:{}};return s},Qs=function(e,r,n,t,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=_p(t,i,n,r,u),s;return e?(s=pu(e,n,t,i,u),s&&s.type?(s.type!="group"&&(s=Bi(s,t)),s.type="case_group"):(i.errors.push("Unexpected case: ".concat(JSON.stringify(s))),s=void 0)):s={id:_r(),type:"case_group",properties:{}},s&&(s.properties=Sr(Sr({},s.properties),o)),s},Zs=function(e,r,n,t){var i=[];function u(o){o.map(function(s){if(s.type=="op-plus")u(s.children);else{var c=pi(s,r,n,t,e);c?i.push(c):t.errors.push("Can't convert ".concat(s.type," in concatenation"))}})}return u(e.children),{valueSrc:"value",valueType:"case_value",value:i}},_p=function(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u={},o;t?.type=="op-plus"?o=Zs(t,n,e,r):o=pi(t,n,e,r,i);var s=e.widgets.case_value,c=s?.spelImportValue;if(c){var f=c(o),d=(0,qe.A)(f,2),v=d[0],g=d[1];g.map(function(m){return r.errors.push(m)}),v&&(u={value:[v],valueSrc:["value"],valueType:["case_value"]})}else r.errors.push("No fucntion to import case value");return u},cO=function(e,r,n,t,i){if(e)return{type:"rule_group",id:uuid(),children1:_defineProperty({},e.id,e),properties:{conjunction:i||defaultGroupConjunction(t,n),not:!1,field:r}}},Bi=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{type:"group",id:_r(),children1:(0,Se.A)({},e.id,e),properties:{conjunction:Dn(r),not:n||!1}}};function el(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Dp(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?el(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):el(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var rl=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,t=e.settings.defaultField,i=(n?tl(e,n):t)||r&&ll(e,n)||null;return i!=null&&typeof i!="string"&&!Pt(i)&&(i=Gi(i)),i},tl=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!n)return null;var t=(e==null||(r=e.settings)===null||r===void 0?void 0:r.fieldSeparator)||".",i=ze(e,n),u=i?.defaultField;return u&&(u=[].concat((0,we.A)(it(n)),[u]).join(t)),u},gu=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n&&((r=e.settings.fieldSources)===null||r===void 0?void 0:r[0])||"field"},mu=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,t=e.settings.defaultOperator,i=ze(e,r),u=i?.operators||[];t&&!u.includes(t)&&(t=null);var o=i?.defaultOperator;o&&!u.includes(o)&&(o=null),!o&&n&&(o=Eu(e,r));var s=i?._origDefaultOperator,c=s&&o||t||o;return c},Wi=function(e,r,n){var t=r?Gr(e,r,n):null;return t&&t.options?new(Me()).Map(t.options&&t.options.defaults||{}):null},_n=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=null,o=null,s=null,c=e.settings.showErrorMessage;if(n){var f,d,v;s=n==null||(f=n.properties)===null||f===void 0?void 0:f.fieldSrc,u=n==null||(d=n.properties)===null||d===void 0?void 0:d.field,o=n==null||(v=n.properties)===null||v===void 0?void 0:v.operator}else t?(u=rl(e,i,r),u?s=Pt(u)?"func":"field":s=gu(e),o=mu(e,u,!0)):s=gu(e);var g=new(Me()).Map({fieldSrc:s,field:u,operator:o,value:new(Me()).List,valueSrc:new(Me()).List,operatorOptions:Wi(e,o,u)});if(c&&(g=g.set("valueError",new(Me()).List)),u&&o){var m=xa(e,e,g,u,o,"operator",!1),E=m.newValue,O=m.newValueSrc,R=m.newValueType,w=m.newValueError;g=g.set("value",E).set("valueSrc",O).set("valueType",R),c&&(g=g.set("valueError",w))}return g},Oo=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;r=ze(e,r);var n=r&&r.conjunctions||Object.keys(e.conjunctions);return n.length==1?n[0]:e.settings.defaultGroupConjunction||e.settings.defaultConjunction||n[0]},Dn=function(e){return e.settings.defaultConjunction||Object.keys(e.conjunctions)[0]},Sa=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new(Me()).Map({conjunction:Oo(e,r),not:!1})},nl=function(e,r){var n;return r&&r.type=="group"?Sa(e,r==null||(n=r.properties)===null||n===void 0?void 0:n.field):_n(e,null,r)},al=function(e,r){return(0,Se.A)({},e,new(Me()).Map({type:"rule",id:e,properties:_n(r)}))},Mp=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new(Me()).Map({type:"group",id:_r(),children1:new(Me()).OrderedMap(r?Dp({},al(_r(),e)):{}),properties:Sa(e)})},Vp=function(e){return new(Me()).List(e)},jp=function(){return new(Me()).Map},kp=function(e){return(0,Ar.A)(e)=="object"&&e!==null&&Array.isArray(e)?"array":(0,Ar.A)(e)},xp=function(e,r){return kp(e)==r||r=="number"&&!isNaN(e)},Up=function(e,r,n,t,i,u){var o=hu(e,r,n,t,i,u);return o=Xn(o),o},hu=function(e,r,n,t,i,u){i===void 0&&(i=n.settings.removeEmptyGroupsOnLoad),u===void 0&&(u=n.settings.removeIncompleteRulesOnLoad);var o={config:n,oldConfig:t,removeEmptyGroups:i,removeIncompleteRules:u};return il(e,[],null,{},o)};function il(a,e,r,n,t){var i=a.get("type"),u=a.get("children1");return(i==="group"||i==="rule_group"||i=="case_group"||i=="switch_group")&&u&&u.size?Gp(a,e,r,n,t):i==="rule"?Bp(a,e,r,n,t):a}function Gp(a,e,r,n,t){var i=t.removeEmptyGroups,u=a.get("id"),o=a.get("children1"),s=o;!u&&r&&(u=r,a=a.set("id",u),n.sanitized=!0);var c={};o=o.map(function(d,v){return il(d,e.concat(u),v,c,t)}),i&&(o=o.filter(function(d){return d!=null}));var f=c.sanitized||s.size!=o.size;return!o.size&&i&&e.length&&(f=!0,a=void 0),f&&(n.sanitized=!0),f&&a&&(a=a.set("children1",o)),a}function Bp(a,e,r,n,t){var i,u,o,s,c=t.removeIncompleteRules,f=t.config,d=t.oldConfig,v=f.settings.showErrorMessage,g=a.get("id"),m=a.get("properties"),E=m.get("field")||null,O=m.get("fieldSrc")||null,R=m.get("operator")||null,w=m.get("operatorOptions"),P=m.get("valueSrc"),F=m.get("value"),k=m.get("valueError"),W={field:((i=E)===null||i===void 0||(u=i.toJS)===null||u===void 0?void 0:u.call(i))||E,fieldSrc:O,operator:R,operatorOptions:w?w.toJS():{},valueSrc:P?P.toJS():null,value:F?F.toJS():null,valueError:k?k.toJS():null},q=E&&R&&F&&!F.includes(void 0);!g&&r&&(g=r,a=a.set("id",g),n.sanitized=!0);var re=E?ze(f,E):null;E&&!re&&(Xt.warn("No config for field ".concat(E)),E=null),E==null&&(m=["operator","operatorOptions","valueSrc","value","valueError"].reduce(function(Ze,Ye){return Ze.delete(Ye)},m),R=null),O||(O=Ml(E),m=m.set("fieldSrc",O)),(R=="range_between"||R=="range_not_between")&&(R=R=="range_between"?"between":"not_between",console.info("Fixed operator ".concat(m.get("operator")," to ").concat(R)),m=m.set("operator",R));var Z=R?Gr(f,R,E):null;R&&!Z&&(console.warn("No config for operator ".concat(R)),R=null);var J=E?Co(f,E):[];E&&(J!=null&&J.length?R&&J.indexOf(R)==-1&&(R=="is_empty"||R=="is_not_empty"?(R=R=="is_empty"?"is_null":"is_not_null",console.info("Fixed operator ".concat(m.get("operator")," to ").concat(R," for ").concat(E)),m=m.set("operator",R)):(console.warn("Operator ".concat(R," is not supported for field ").concat(E)),R=null)):(console.warn("Type of field ".concat(E," is not supported")),R=null)),R==null&&(m=m.delete("operatorOptions"),m=m.delete("valueSrc"),m=m.delete("value"),m=m.delete("valueError")),w=m.get("operatorOptions");var te=R?Rr(Z.cardinality,1):null;!R||w&&!Z.options?(w=null,m=m.delete("operatorOptions")):R&&!w&&Z.options&&(w=Wi(f,R,E),m=m.set("operatorOptions",w)),P=m.get("valueSrc"),F=m.get("value");var le=!v,ee=!0,ie=xa(f,d,m,E,R,null,le,ee),oe=ie.newValue,pe=ie.newValueSrc,se=ie.newValueError;F=oe,P=pe,k=se,m=m.set("value",F),m=m.set("valueSrc",P),v?m=m.set("valueError",k):m=m.delete("valueError");var de={field:((o=E)===null||o===void 0||(s=o.toJS)===null||s===void 0?void 0:s.call(o))||E,fieldSrc:O,operator:R,operatorOptions:w?w.toJS():{},valueSrc:P?P.toJS():null,value:F?F.toJS():null,valueError:k?k.toJS():null},ge=!da(W,de),Fe=F&&F.filter(function(Ze,Ye){return!Hi(Ze,P.get(Ye),f)}).size==0,De=Hi(E,O,f),ke=De&&R&&Fe;if(ge&&(n.sanitized=!0),!ke&&c){var Oe="Uncomplete rule";if(!De)Oe="Uncomplete LHS";else{var je,Je,xe;Oe="Uncomplete RHS",(je=de.valueSrc)!==null&&je!==void 0&&je[0]&&((Je=de.valueSrc)===null||Je===void 0?void 0:Je[0])!=((xe=W.valueSrc)===null||xe===void 0?void 0:xe[0])&&(Oe="Bad value src ".concat(de.valueSrc))}console.warn("[RAQB validate]","Removing rule: ",W,"Reason: ".concat(Oe)),a=void 0}else ge&&(a=a.set("properties",m));return a}var To=function(e,r,n,t,i,u,o,s){var c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,f=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d=arguments.length>10&&arguments[10]!==void 0?arguments[10]:!0,v=null,g=i;if(i!=null){if(o=="field"){var m=Hp(r,n,i,o,u,s,e,t,f,c),E=(0,qe.A)(m,2);v=E[0],g=E[1]}else if(o=="func"){var O=Kp(r,n,i,o,u,s,e,t,f,c),R=(0,qe.A)(O,2);v=R[0],g=R[1]}else if(o=="value"||!o){var w=$p(r,n,i,o,u,s,e,t,f,c),P=(0,qe.A)(w,2);v=P[0],g=P[1]}if(!v){var F=ze(e,n),k=Yr(e,n,t,o),W=t?Gr(e,t,n):null,q=jr()(kt(e,n,t,k,o),["factory"]),re=o=="field"?ze(e,i):null,Z=q,J=q.validateValue;if(typeof J=="function"){var te=[g,Z,t,W];o=="field"&&te.push(re);var le=J.call.apply(J,[e.ctx].concat(te));typeof le=="boolean"?le==!1&&(v="Invalid value"):v=le}}}return d&&v&&console.warn("[RAQB validate]","Field ".concat(n,": ").concat(v)),[v,g]},Wp=function(e,r,n,t,i){var u=vr.List.isList(e)?e.toJS():e instanceof Array?(0,we.A)(e):void 0;if(u){var o=u.reduce(function(m,E){var O=(0,qe.A)(m,2),R=O[0],w=O[1],P=fe(r,E);return P==null?[R,[].concat((0,we.A)(w),[E])]:[[].concat((0,we.A)(R),[P.value]),w]},[[],[]]),s=(0,qe.A)(o,2),c=s[0],f=s[1],d=f.length>1,v=f.length?"".concat(d?"Values":"Value"," ").concat(f.join(", ")," ").concat(d?"are":"is"," not in list of values"):null;return i!==void 0?n=i:n=n||t,[v,n?c:e]}else{var g=fe(r,e);return g==null?["Value ".concat(e," is not in list of values"),e]:(e=g.value,[null,e])}},$p=function(e,r,n,t,i,u,o){var s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,f=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1;if(r){var d=ze(o,r),v=Yr(o,r,s,t),g=o.widgets[v],m=g?.type,E=g?.jsType,O=d.fieldSettings,R=O?.treeValues||O?.listValues,w=!!(O!=null&&O.asyncFetch),P=R||w;if(i&&m&&i!=m)return["Value should have type ".concat(m,", but got value of type ").concat(i),n];if(E&&!xp(n,E)&&!P)return["Value should have JS type ".concat(E,", but got value of type ").concat((0,Ar.A)(n)),n];if(O){var F=u||R;if(F&&!O.allowCustomValues)return Wp(n,F,f,c,o.settings.removeInvalidMultiSelectValuesOnLoad);if(O.min!=null&&n<O.min)return["Value ".concat(n," < min ").concat(O.min),f?O.min:n];if(O.max!=null&&n>O.max)return["Value ".concat(n," > max ").concat(O.max),f?O.max:n]}}return[null,n]},Hp=function(e,r,n,t,i,u,o){var s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,f=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d=o.settings.fieldSeparator,v=(0,Ar.A)(r)=="object"&&r?._isFuncArg,g=Array.isArray(e)?e.join(d):e,m=Array.isArray(n)?n.join(d):n,E=ze(o,n);return E?m==g&&!v?["Can't compare field ".concat(e," with itself"),n]:i&&i!=E.type?["Field ".concat(n," is of type ").concat(E.type,", but expected ").concat(i),n]:[null,n]:["Unknown field ".concat(n),n]},Kp=function(e,r,n,t,i,u,o){var s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,f=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d=n;if(n){var v=n.get("func");if(v){var g=Ct(o,v);if(g){if(i&&g.returnType!=i)return["Function ".concat(v," should return value of type ").concat(g.returnType,", but got ").concat(i),n];for(var m in g.args){var E=g.args[m],O=d.get("args"),R=O?O.get(m):void 0,w=ze(o,E),P=R?R.get("value"):void 0,F=R?R.get("valueSrc"):void 0;if(P!==void 0){var k=To(o,e,w,s,P,E.type,F,u,f,c,!1),W=(0,qe.A)(k,2),q=W[0],re=W[1];if(q!==null)if(f)d=d.deleteIn(["args",m]),E.defaultValue!==void 0&&(d=d.setIn(["args",m,"value"],E.defaultValue),d=d.setIn(["args",m,"valueSrc"],"value"));else return["Invalid value of arg ".concat(m," for func ").concat(v,": ").concat(q),n];else re!==P&&(d=d.setIn(["args",m,"value"],re))}else if(c&&E.defaultValue===void 0&&!f&&!E.isOptional)return["Value of arg ".concat(m," for func ").concat(v," is required"),n]}}else return["Unknown function ".concat(v),n]}}return[null,d]},Yp=y(68090),Ao=y.n(Yp),yu=function(e){return(0,Ar.A)(e)=="object"&&e!==null&&!Array.isArray(e)},ol=function(e,r){if(e){var n=e.get("func"),t=n&&Ct(r,n);if(t){var i=e,u=!1;for(var o in t.args){var s=t.args[o],c=s.valueSources,f=s.isOptional,d=s.defaultValue,v=Ua(r,c,s),g=i.get("args"),m=v.length==1?v[0]:void 0,E=g?g.get(o):void 0,O=E?E.get("value"):void 0,R=(E?E.get("valueSrc"):void 0)||m;if(O!==void 0){var w=Ga(O,R,r);if(w===void 0||(w!==O&&(i=i.setIn(["args",o,"value"],w)),u))return}else if(d!==void 0&&!yu(d))i=i.setIn(["args",o,"value"],ul(s)),i=i.setIn(["args",o,"valueSrc"],"value");else if(f)u=!0;else return}return i}}},zp=function(e,r,n){var t=n.settings.fieldSeparator;e=e||new(Me()).Map,Array.isArray(r)&&(r=r.join(t));var i=e.get("func"),u=e.get("args");e=e.set("func",r);var o=r&&Ct(n,r),s=r&&Fu(n,r),c=i&&Fu(n,i),f=sl(c,s,u,n);if(f.length){var d=Object.keys(s.args),v=d.filter(function(W){return!f.includes(W)});e=v.reduce(function(W,q){return W.deleteIn(["args",q])},e)}else e=e.set("args",new(Me()).Map);if(o)for(var g in o.args){var m=o.args[g],E=m.valueSources,O=m.defaultValue,R=Ua(n,E,m),w=R.length?R[0]:void 0,P=O?yu(O)&&O.func?"func":"value":void 0,F=P||w,k=e.getIn(["args",g]);k||(O!==void 0&&(e=e.setIn(["args",g,"value"],ul(m))),F&&(e=e.setIn(["args",g,"valueSrc"],F)))}return e},ul=function(e){var r=e.defaultValue;return yu(r)&&!Me().Map.isMap(r)&&r.func?Me().fromJS(r,function(n,t){return Me().Iterable.isIndexed(t)?t.toList():t.toOrderedMap()}):r},Xp=function(e,r,n,t,i){if(e&&e.get("func")){e=e.setIn(["args",r,"value"],n);var u=e.getIn(["args",r,"valueSrc"]),o=t.valueSources,s=Ua(i,o,t),c=s.length==1?s[0]:void 0;!c&&s.includes("value")&&(c="value"),!u&&c&&(e=e.setIn(["args",r,"valueSrc"],c))}return e},qp=function(e,r,n,t,i){return e&&e.get("func")&&(e=e.setIn(["args",r],new(Me()).Map({valueSrc:n}))),e},sl=function(e,r,n,t){if(e?.returnType!=r?.returnType)return[];var i=!1,u=Object.keys(r.args),o=u.filter(function(s,c){var f=r.args[s],d=e.args[s],v=Object.keys(e.args).indexOf(s);if(!d&&(f.defaultValue!==void 0||f.isOptional))return!0;if(i&&c!==v||d?.type!=f.type||Ro.includes(f.type)&&(!d.listValuesType||d.listValuesType!==f.listValuesType))return!1;if(n){var g=n.get(s),m=g?.get("value"),E=g?.get("valueSrc");if(f.valueSources&&!f.valueSources.includes(E))return!1;var O=null,R=null,w=f,P=null,F=!1,k=!0,W=To(t,O,w,R,m,w.type,E,P,F,k,!1),q=(0,qe.A)(W,2),re=q[0],Z=q[1];if(re)return!1}return!0});return o},Ro=["select","multiselect","treeselect","treemultiselect"],xa=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,t=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!0,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;r||(r=e);var c=e.settings.keepInputOnChangeFieldSrc,f=n.get("field"),d=n.get("fieldType"),v=n.get("operator"),g=n.get("value"),m=n.get("valueSrc",new(Me()).List),E=n.get("valueType",new(Me()).List),O=n.get("asyncListValues"),R=e.settings,w=R.convertableWidgets,P=R.clearValueOnChangeField,F=R.clearValueOnChangeOp,k=R.showErrorMessage,W=Gr(e,i,t),q=i?Rr(W.cardinality,1):null,re=ze(r,f),Z=ze(e,t),J=!f&&d&&c,te=re?.type||d,le=Z?.type||!t&&J&&te,ee=(f||J)&&v&&i&&g!=null;if(ee=ee&&(!u||u=="field"&&!P||u=="operator"&&!F),ee=ee&&te&&le&&te==le,ee&&Ro.includes(le)&&u=="field"){var ie=Z?.listValuesType,oe=re?.listValuesType;ie&&ie===oe||(ee=!1)}for(var pe=0;pe<q;pe++){var se=m.get(pe)||null,de=Yr(r,f,v,se),ge=Yr(e,t,i,se),Fe=se=="value"?de:Yr(r,f,v,"value"),De=se=="value"?ge:Yr(e,t,i,"value"),ke=De==Fe||(w[Fe]||[]).includes(De)||!Fe&&J;ke||(ee=!1)}v!=i&&[v,i].includes("proximity")&&(ee=!1);var Oe=kt(e,t,i,null,m.first()),je=dl(e,t,i,null);!t&&J&&(je=Object.keys(e.settings.valueSourcesInfo));var Je={},xe=Array.from({length:q},function(){return null});if(ee)for(var Ze=function(){var zr=g.get(Ye),Lr=E.get(Ye)||null,et=m.get(Ye)||null,rn=je.find(function(Qi){return Qi==et})!=null;!rn&&Ye>0&&et==null&&(rn=!0);var En=O,kn=To(e,t,t,i,zr,Lr,et,En,o,s,!0),Wt=(0,qe.A)(kn,2),$t=Wt[0],Aa=Wt[1],za=!$t,Sn=Aa!==zr,On=!rn||!za&&(u=="field"||!k&&!Sn),Ji=!!$t&&k&&!On&&!Sn;if(Ji&&(xe[Ye]=$t),Sn&&(Je[Ye]=Aa),On)return ee=!1,"break"},Ye=0;Ye<q;Ye++){var mr=Ze();if(mr==="break")break}var Or=null,tt=null,Lt=null,st=null;if(Or=new(Me()).List(Array.from({length:q},function(It,zr){var Lr=void 0;if(ee)zr<g.size&&(Lr=g.get(zr),Je[zr]!==void 0&&(Lr=Je[zr]));else if(q==1){var et;Lr=Rt([Z?.defaultValue,Z==null||(et=Z.fieldSettings)===null||et===void 0?void 0:et.defaultValue,Oe?.defaultValue])}return Lr})),tt=new(Me()).List(Array.from({length:q},function(It,zr){var Lr=null;return ee?zr<m.size&&(Lr=m.get(zr)):(je.length==1||je.length>1)&&(Lr=je[0]),Lr})),k){if(W&&W.validateValues&&tt.toJS().filter(function(It){return It=="value"||It==null}).length==q){var vt=Oe&&Oe.toJS?Or.toJS().map(function(It){return Oe.toJS.call(e.ctx,It,Oe)}):Or.toJS(),qt=W.validateValues(vt);k&&xe.push(qt)}st=new(Me()).List(xe)}return Lt=new(Me()).List(Array.from({length:q},function(It,zr){var Lr=null;return ee?zr<E.size&&(Lr=E.get(zr)):q==1&&Oe&&Oe.type!==void 0?Lr=Oe.type:q==1&&Z&&Z.type!==void 0&&(Lr=Z.type=="!group"?"number":Z.type),Lr})),{canReuseValue:ee,newValue:Or,newValueSrc:tt,newValueType:Lt,newValueError:st,operatorCardinality:q}},ll=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=e.settings.fieldSeparator,t=it(r,e),i=r?hn(e,r):e,u=i,o=null,s=[];do{var c,f=u===e?e.fields:(c=u)===null||c===void 0?void 0:c.subfields;if(!f||!Object.keys(f).length){u=o=null;break}o=Object.keys(f)[0],s.push(o),u=f[o]}while(u.type=="!struct"||u.type=="!group");return(t||[]).concat(s).join(n)},cl=function(e,r){var n;return((n=e.types[r])===null||n===void 0?void 0:n.operators)||null},Co=function(e,r){var n=ze(e,r),t=n?n.operators:[];return t},Eu=function(e,r){var n,t=Co(e,r);return(n=t?.[0])!==null&&n!==void 0?n:null},Jp=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return $i(e,r,n,"funcs","subfields")},$i=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"fields",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"subfields";if(!e)return null;var u=r.settings.fieldSeparator,o=it(e,r),s=it(n,r),c=o.slice(s.length).map(function(f,d,v){return v.slice(0,d+1)}).map(function(f){return[].concat((0,we.A)(s),(0,we.A)(f)).join(u)}).map(function(f){var d=hn(r,f,t,i);return d&&d.label||Ao()(f.split(u))}).filter(function(f){return f!=null});return c},fl=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!e)return null;var t=n&&hn(r,n)||null,i=r.settings.fieldSeparator,u=it(e,r),o=Dl(e,n,r),s=o?it(n,r):[];return u.slice(s.length).map(function(c,f,d){return d.slice(0,f+1)}).map(function(c){return{part:[].concat((0,we.A)(s),(0,we.A)(c)).join(i),key:c[c.length-1]}}).map(function(c){var f=c.part,d=c.key,v=hn(r,f);return{key:d,cnf:v}}).map(function(c,f,d){var v=c.key,g=c.cnf,m=f>0?d[f-1].cnf:t;return[v,g,m]})},Qp=function(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,o=r&&(0,Ar.A)(r)=="object"&&!!r.func&&!!r.arg,s=e.settings.showLabels,c=ze(e,r),f=kt(e,r,n,null,i)||{},d=Gr(e,n,r)||{},v=u?1:d.cardinality,g=null;if(v>1){var m=f.valueLabels||d.valueLabels;m&&(g=m[t]),g&&(0,Ar.A)(g)!="object"&&(g={label:g,placeholder:g}),g||(g={label:e.settings.valueLabel+" "+(t+1),placeholder:e.settings.valuePlaceholder+" "+(t+1)})}else{var E=f.valueLabel,O=f.valuePlaceholder;o&&(E||(E=c.label||r.arg),!O&&!s&&(O=c.label||r.arg)),g={label:E||e.settings.valueLabel,placeholder:O||e.settings.valuePlaceholder}}return g};function Su(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,t=[],i=[];if(!e)return{widgets:t,valueSrcs:i};var u=(0,Ar.A)(e)=="object"&&(!!e.func&&!!e.arg||e._isFuncArg),o=ze(a,e),s=r?a.operators[r]:null;if(o!=null&&o.widgets){var c=function(){var m=o.widgets[f];if(!a.widgets[f])return"continue";var E=a.widgets[f].valueSrc||"value",O=!0;if(f=="field"&&(O=O&&Ua(a,["field"],o).length>0),f=="func"&&(O=O&&Ua(a,["func"],o).length>0),n=="value"&&!m.operators&&!u&&e!="!case_value"&&(O=!1),m.operators&&r&&(O=O&&m.operators.indexOf(r)!=-1),n&&n!=E&&n!="const"&&(O=!1),s&&s.cardinality==0&&E!="value"&&(O=!1),O){var R,w;t.push(f);var P=((R=o.valueSources)===null||R===void 0?void 0:R.indexOf(E))!=-1;(s==null||(w=s.valueSources)===null||w===void 0?void 0:w.indexOf(E))==-1&&(P=!1),P&&!i.find(function(F){return F==E})&&i.push(E)}};for(var f in o.widgets)var d=c()}var v=function(m){var E=0;return o.preferWidgets?o.preferWidgets.includes(m)&&(E+=10-o.preferWidgets.indexOf(m)):m==o.mainWidget&&(E+=100),m=="field"&&(E-=1),m=="func"&&(E-=2),E};return t.sort(function(g,m){return v(m)-v(g)}),{widgets:t,valueSrcs:i}}var Zp=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=Su(e,r,n,t),u=i.widgets;return u},Ua=function(e,r,n){var t;if(!n)return r;var i=(t=n.type)!==null&&t!==void 0?t:n.returnType;return r||(r=Object.keys(e.settings.valueSourcesInfo)),r.filter(function(u){var o=!0;if(u=="field"&&e.__fieldsCntByType){var s=n._isFuncArg?0:1;o=o&&e.__fieldsCntByType[i]>s}return u=="func"&&(e.__funcsCntByType&&(o=o&&!!e.__funcsCntByType[i]),n.funcs&&(o=o&&n.funcs.length>0)),o})},dl=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=Su(e,r,n,null),u=i.valueSrcs,o=Ua(e,u,t);return o},Yr=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=Su(e,r,n,t),u=i.widgets,o=null;return u.length&&(o=u[0]),o},qn=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};if(e){var u=ze(r,e)||{},o=r.settings.fieldSeparator,s=it(e,r),c=Array.isArray(e)?e.join(o):e;if(i!=null&&i.useTableName&&u.tableName){var f=(0,we.A)(s);f[0]=u.tableName,c=f.join(o)}if(u.fieldName&&(c=u.fieldName),t){var d=ze(r,t)||{},v=t;c.indexOf(v+o)==0?c=c.slice((v+o).length):u.fieldName||n.errors.push("Can't cut group ".concat(v," from field ").concat(c))}return c}},Ou=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,t=e.get("type"),i=e.getIn(["properties","mode"]);return t=="rule_group"&&i=="array"?ev(e,r,n):t=="group"||t=="rule_group"?rv(e,r,n):tv(e,r,n)},ev=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,t=e.get("children1"),i=e.get("properties");return pl(i.toObject(),t,r,n)},pl=function(e,r,n){var t,i,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=e.operator,s=(t=(i=n.operators[o])===null||i===void 0?void 0:i.cardinality)!==null&&t!==void 0?t:1,c=[!Au(e,n,!1),s>0?!0:!Tu(r,n,u)],f=c.filter(function(v){return!!v}).length,d=f==2;return!d},rv=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,t=e.get("children1");return Tu(t,r,n)},Tu=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!e||e.size==0||e.size>0&&e.filter(function(t){return!Ou(t,r,n)}).size==0},Au=function(e,r){var n,t,i=e.field,u=e.fieldSrc,o=e.fieldType,s=e.operator,c=e.value,f=e.valueSrc,d=e.valueType,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,g=(n=(t=r.operators[s])===null||t===void 0?void 0:t.cardinality)!==null&&n!==void 0?n:1,m=[v?i!==null||o!=null:Hi(i,u,r,v),!!s,c.filter(function(R,w){var P;return Hi(R,(f==null||(P=f.get)===null||P===void 0?void 0:P.call(f,w))||f?.[w],r,v)}).size>=g],E=m.filter(function(R){return!!R}).length,O=E==3;return!O},tv=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,t=e.get("properties");return Au(t.toObject(),r,n)},Hi=function a(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!t&&r=="func"&&e){var i=e.get("func"),u=Ct(n,i);if(u){var o=e.get("args");for(var s in u.args){var c=u.args[s],f=o?o.get(s):void 0,d=f?f.get("value"):void 0,v=f?f.get("valueSrc"):void 0;if(d==null&&c?.defaultValue===void 0&&!(c!=null&&c.isOptional)||d!=null&&!a(d,v,n,t))return!1}return!0}}return e!=null},Ga=function(e,r,n){return r=="func"?ol(e,n):e},nv=y(1779),an=y.n(nv),av=y(18678),Ru=y.n(av);function vl(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function gl(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vl(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):vl(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function iv(a,e){return Ru().apply(a,e)}function ov(a,e){return Ru().add_operation(a,e)}var ml={CALL:function(e,r){for(var n=arguments.length,t=new Array(n>2?n-2:0),i=2;i<n;i++)t[i-2]=arguments[i];return e.call.apply(e,[r].concat(t))},JSX:function(e,r){return{type:e,props:r}},mergeObjects:function(e,r){return gl(gl({},e),r)},fromEntries:function(e){return Object.fromEntries(e)},strlen:function(e){return e?.length||0},regexTest:function(e,r,n){return e?.match(new RegExp(r,n))!=null},now:function(){return new Date},date_add:function(e,r,n){return ya()(e).add(r,n).toDate()},toLowerCase:function(e){return e.toLowerCase()},toUpperCase:function(e){return e.toUpperCase()}};function uv(){for(var a in ml)ov(a,ml[a])}function sv(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=lv(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function lv(a,e){if(a){if(typeof a=="string")return hl(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hl(a,e)}}function hl(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}function yl(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Oa(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yl(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):yl(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}uv();function El(a,e,r){var n;try{n=Ru().apply(a,e)}catch(t){throw t.message="".concat(r.join(".")," :: ").concat(t.message),t}return n}function Sl(a,e,r,n){var t;try{t=e.call.apply(e,[a].concat((0,we.A)(r)))}catch(i){throw i.message="".concat(n.join(".")," :: ").concat(i.message),i}return t}var Lo=["conjunctions","fields","types","operators","widgets","settings","funcs","ctx"],Ol={asyncFetch:{type:"f",args:["search","offset"]},labelYes:{type:"r"},labelNo:{type:"r"},marks:{type:"r",isArr:!0},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]}},Cu=Oa(Oa({},Ol),{},{factory:{type:"rf"},formatValue:{type:"f",args:["val","fieldDef","wgtDef","isForDisplay","op","opDef","rightFieldDef"]},sqlFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelImportValue:{type:"f",args:["val","wgtDef","args"]},mongoFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},elasticSearchFormatValue:{type:"f",args:["queryType","val","op","field","config"]},jsonLogic:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]},toJS:{type:"f",args:["val"]}}),Tl={options:{factory:{type:"rf"}},formatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","isForDisplay","fieldDef"]},mongoFormatOp:{type:"f",args:["field","op","vals","useExpr","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},sqlFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},spelFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},jsonLogic:{type:"f",ignore:"string",args:["field","op","vals","opDef","operatorOptions","fieldDef"]},elasticSearchQueryType:{type:"f",ignore:"string",args:["valueType"]},textSeparators:{type:"r",isArr:!0}},cv={formatConj:{type:"f",args:["children","conj","not","isForDisplay"]},sqlFormatConj:{type:"f",args:["children","conj","not"]},spelFormatConj:{type:"f",args:["children","conj","not","omitBrackets"]}},Al={widgetProps:Cu,opProps:Tl},fv={renderBrackets:{type:"r",isArr:!0},renderSeps:{type:"r",isArr:!0},jsonLogic:{type:"f",ignore:"string",args:["formattedArgs"]},jsonLogicImport:{type:"f",args:["val"]},spelImport:{type:"f",args:["spel"]},formatFunc:{type:"f",args:["formattedArgs","isForDisplay"]},sqlFormatFunc:{type:"f",args:["formattedArgs"]},mongoFormatFunc:{type:"f",args:["formattedArgs"]},spelFormatFunc:{type:"f",args:["formattedArgs"]}},dv={locale:{mui:{type:"f",args:[],invokeWith:[],ignore:"jl"}},canCompareFieldWithField:{type:"f",args:["leftField","leftFieldConfig","rightField","rightFieldConfig","op"]},formatReverse:{type:"f",args:["q","op","reversedOp","operatorDefinition","revOperatorDefinition","isForDisplay"]},sqlFormatReverse:{type:"f",args:["q"]},spelFormatReverse:{type:"f",args:["q"]},formatField:{type:"f",args:["field","parts","label2","fieldDefinition","config","isForDisplay"]},formatSpelField:{type:"f",args:["field","parentField","parts","partsExt","fieldDefinition","config"]},formatAggr:{type:"f",args:["whereStr","aggrField","operator","value","valueSrc","valueType","opDef","operatorOptions","isForDisplay","aggrFieldDef"]},normalizeListValues:{type:"f",args:["listValues","type","fieldSettings"]},renderConfirm:{type:"f",args:["props"]},useConfirm:{type:"f",args:[]},renderField:{type:"rf"},renderOperator:{type:"rf"},renderFunc:{type:"rf"},renderConjs:{type:"rf"},renderButton:{type:"rf"},renderIcon:{type:"rf"},renderButtonGroup:{type:"rf"},renderValueSources:{type:"rf"},renderFieldSources:{type:"rf"},renderProvider:{type:"rf"},renderSwitch:{type:"rf"},renderSwitchPrefix:{type:"r"},renderItem:{type:"rf"},renderBeforeWidget:{type:"rf"},renderAfterWidget:{type:"rf"},renderBeforeActions:{type:"rf"},renderAfterActions:{type:"rf"},renderRuleError:{type:"rf"}},pv={fields:{x:{fieldSettings:Ol,widgets:{x:Al},mainWidgetProps:Cu}},widgets:{x:Cu},conjunctions:{x:cv},operators:{x:Tl},types:{x:{widgets:{x:Al}}},funcs:{x:fv},settings:dv},vi=function(e){return(0,Ar.A)(e)=="object"&&e!==null&&!Array.isArray(e)},Rl=function(e,r){if(e.__fieldNames)throw new Error("Don't apply `compressConfig()` to extended config");var n=nn()(e,Lo);delete n.ctx;for(var t=function c(f,d,v,g){if(vi(f)){if(ga(f)&&(f=ci(f)),v[0]==="funcs"&&!d){var m=v[v.length-1];d=hn({funcs:g.BasicFuncs},m,"funcs","subfields")||void 0,d&&(f.$$key=m)}if(d!==void 0&&vi(d))for(var E in d)Object.prototype.hasOwnProperty.call(d,E)&&(!Object.keys(f).includes(E)||f[E]===void 0&&d[E]!==void 0?f[E]="$$deleted":(f[E]=c(f[E],d[E],[].concat((0,we.A)(v),[E]),g),f[E]===void 0&&delete f[E]));for(var O in f)if(Object.prototype.hasOwnProperty.call(f,O)){if(!d||!Object.keys(d).includes(O)){var R;f[O]=c(f[O],(R=d)===null||R===void 0?void 0:R[O],[].concat((0,we.A)(v),[O]),g)}f[O]===void 0&&delete f[O]}Object.keys(f).length===0&&(f=void 0)}else Array.isArray(f)&&f.forEach(function(w,P){f[P]=c(f[P],void 0,[].concat((0,we.A)(v),[P]),g)});if(!(d!==void 0&&pa(f,d,!0))){if(typeof f=="function")throw new Error("compressConfig: function at ".concat(v.join(".")," should be converted to JsonLogic"));return f}},i=0,u=Lo;i<u.length;i++){var o=u[i];if(o!=="ctx")if(o==="fields")n[o]=an()(n[o]),t(n[o],{},[o]);else if(o==="funcs"){n[o]=an()(n[o]||{});for(var s in n[o])t(n[o][s],null,[o,s],{BasicFuncs:M})}else n[o]=an()(n[o]),t(n[o],r[o],[o])}return n},Cl=function(e,r,n){if(!e.settings.useConfigCompress)throw new Error("Please enable `useConfigCompress` in config settings to use decompressConfig()");for(var t={},i=function f(d,v,g){if(vi(v)){vi(d)||(d={});for(var m in v)Object.prototype.hasOwnProperty.call(v,m)&&(v[m]==="$$deleted"?delete d[m]:d[m]=f(d[m],v[m],[].concat((0,we.A)(g),[m])))}else Array.isArray(v)?d=an()(v):d=v;return d},u=function f(d,v,g){var m=!1;if(vi(d)&&Object.prototype.hasOwnProperty.call(d,"$$key")&&d.$$key){var E=hn({funcs:g.BasicFuncs},d.$$key,"funcs","subfields");if(E)delete d.$$key,d=i(an()(E),d,v),m=!0;else throw new Error("decompressConfig: basic function not found by key ".concat(d.$$key," at ").concat(v.join(".")))}if(!m){if(vi(d))for(var O in d)Object.prototype.hasOwnProperty.call(d,O)&&(d[O]=f(d[O],[].concat((0,we.A)(v),[O]),g));else if(Array.isArray(d)){var R=sv(d),w;try{for(R.s();!(w=R.n()).done;){var P=w.value;d[P]=f(d[P],[].concat((0,we.A)(v),[P]),g)}}catch(F){R.e(F)}finally{R.f()}}}return d},o=0,s=Lo;o<s.length;o++){var c=s[o];c==="ctx"?t[c]=ha()({},r.ctx||{},n||{}):c==="funcs"?(t[c]=an()(e[c]||{}),u(t[c],[c],{BasicFuncs:M})):c==="fields"?t[c]=an()(e[c]||{}):(t[c]=an()(r[c]||{}),i(t[c],e[c]||{},[c]))}return t},Ll=function(e){if(e.__compliled)return e;e=an()(e);var r={ctx:e.ctx},n=[];return Io(e,e,r,pv,n),Object.defineProperty(e,"__compliled",{enumerable:!1,writable:!1,value:!0}),e};function Io(a,e,r,n,t){var i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];if(e){var u=!i.length;for(var o in n){var s=n[o],c=o==="x"?i:[].concat((0,we.A)(i),[o]);if(s.type==="r"){var f=e,d=f[o];if(s.isArr)for(var v in d){var g=gi(d[v],r,[].concat((0,we.A)(c),[v]));g!==d[v]&&(t.push("Compiled ".concat(c.join("."),"[").concat(v,"]")),d[v]=g)}else{var m=gi(d,r,c,void 0);m!==d&&(t.push("Compiled R ".concat(c.join("."))),f[o]=m)}}else if(s.type==="rf"){var E=e,O=E[o],R=vv(O,r,c,s.ignore);R!==O&&(t.push("Compiled JL-RF ".concat(c.join("."))),E[o]=R)}else if(s.type==="f"){var w=e,P=w[o],F=gv(P,r,c,s.args,s.ignore);if(s.invokeWith&&F&&typeof F=="function"){var k;F=(k=F).call.apply(k,[null].concat((0,we.A)(s.invokeWith)))}F!==P&&(t.push("Compiled JL-F ".concat(c.join("."))),w[o]=F)}else if(o==="x")for(var W in e){c=[].concat((0,we.A)(i),[W]);var q=e[W];Io(a,q,r,s,t,c),q.subfields&&Io(a,q.subfields,r,n,t,c)}else{var re=e[o];Io(a,re,r,s,t,c)}}}}function vv(a,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;return At(a)?function(t,i){i=i||e?.ctx;var u={props:t,ctx:i},o=El(a,u,r);typeof o=="string"&&(o={type:o,props:t});var s=gi(o,{ctx:i},r);return s}:typeof a=="string"?function(t,i){i=i||e?.ctx;var u=a.split(".").reduce(function(c,f){return c?.[f]},i);if(u)return Sl(this,u,[t,i],r);var o={type:a,props:t},s=gi(o,{ctx:i},r);return s}:a}function gv(a,e,r,n){var t=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;return At(a)&&t!=="jl"?function(){for(var i=arguments.length,u=new Array(i),o=0;o<i;o++)u[o]=arguments[o];var s=this||e?.ctx,c=(n||[]).reduce(function(d,v,g){return Oa(Oa({},d),{},(0,Se.A)({},v,u[g]))},{args:u,ctx:s}),f=El(a,c,r);return f}.bind(e?.ctx):typeof a=="string"&&t!=="string"?function(){var i=this||e?.ctx,u=a.split(".").reduce(function(f,d){return f?.[d]},i);if(u){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return Sl(this,u,s,r)}else throw new Error("".concat(r.join(".")," :: Function ").concat(a," is not found in ctx"))}.bind(e?.ctx):a}function mv(a,e){var r;return(e==null||(r=e.components)===null||r===void 0?void 0:r[a])||e.W[a]||e.O[a]}function gi(a,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;if(Zr(a)){var t,i=a.type,u=a.props;if(typeof i!="string")throw new Error("renderReactElement for ".concat(r.join("."),": type should be string"));var o=mv(i,e.ctx)||i.toLowerCase(),s;n!==void 0&&(u=Oa(Oa({},u),{},{key:n})),(t=u)!==null&&t!==void 0&&t.children&&(s=gi(u.children,e,r),u=Oa(Oa({},u),{},{children:s}));var c=e.ctx.RCE(o,u);return c}else if(a instanceof Array)return a.map(function(f,d){return gi(f,e,r,""+d)});return a}function Il(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Lu(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Il(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Il(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var hv=mn().mark(mi),yv=mn().mark(_l);function bl(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=Ev(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function Ev(a,e){if(a){if(typeof a=="string")return Fl(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fl(a,e)}}function Fl(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}var Jn=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e.__configId)return e;n&&e.settings.useConfigCompress?e.__compliled?e=an()(e):e=Ll(e):e=an()(e),e.settings=Ui()({},ho,e.settings,Iu),e.__fieldsCntByType={},e.__funcsCntByType={},e.__fieldNames={},Sv(e.types,e),Nl(e.fields,e),wl(e.funcs,e);var t=e.settings.locale.moment;return t&&ya().locale(t),Object.defineProperty(e,"__configId",{enumerable:!1,writable:!1,value:r||_r()}),ma(e),e};function Sv(a,e){for(var r in a){var n=a[r];Ov(r,n,e)}}function Ov(a,e,r){var n=null,t=null;e.mainWidget=e.mainWidget||Object.keys(e.widgets).filter(function(d){return d!="field"&&d!="func"})[0];for(var i in e.widgets){var u=e.widgets[i];if(u.operators){var o=u.operators;e.excludeOperators&&(o=o.filter(function(d){return!e.excludeOperators.includes(d)})),n=zn(n,o)}u.defaultOperator&&(t=u.defaultOperator),i==e.mainWidget&&(u=ha()({},{widgetProps:e.mainWidgetProps||{}},u)),e.widgets[i]=u}e.valueSources||(e.valueSources=Object.keys(r.settings.valueSourcesInfo));var s=bl(e.valueSources),c;try{for(s.s();!(c=s.n()).done;){var f=c.value;f!="value"&&!e.widgets[f]&&(e.widgets[f]={})}}catch(d){s.e(d)}finally{s.f()}!e.operators&&n&&(e.operators=Array.from(new Set(n))),!e.defaultOperator&&t&&(e.defaultOperator=t)}function Nl(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];for(var n in a)Pl(a[n],e,[].concat((0,we.A)(r),[n])),a[n].subfields&&Nl(a[n].subfields,e,[].concat((0,we.A)(r),[n]))}function wl(a,e){var r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(a){var t=(e==null||(r=e.settings)===null||r===void 0?void 0:r.fieldSeparator)||".";for(var i in a){var u=[].concat((0,we.A)(n),[i]).join(t),o=a[i];o.returnType&&(e.__funcsCntByType[o.returnType]||(e.__funcsCntByType[o.returnType]=0),e.__funcsCntByType[o.returnType]++);for(var s in o.args)Pl(o.args[s],e,null,!0);if(o.args){var c=Object.keys(o.args),f=!0,d=bl(c.reverse()),v;try{for(d.s();!(v=d.n()).done;){var g=v.value,m=o.args[g];!f&&m.isOptional&&(Xt.info("Arg ".concat(g," for func ").concat(u," can't be optional")),delete m.isOptional),m.isOptional||(f=!1)}}catch(E){d.e(E)}finally{d.f()}}o.subfields&&wl(o.subfields,e,[].concat((0,we.A)(n),[i]))}}}function Pl(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,t=null,i=null,u=e.types[a.type],o=a.excludeOperators||[];if(a.type!="!struct"&&a.type!="!group"){var s=["listValues","treeValues","allowCustomValues","validateValue"];a.fieldSettings||(a.fieldSettings={});for(var c=0,f=s;c<f.length;c++){var d=f[c];a[d]&&(a.fieldSettings[d]=a[d],delete a[d])}if(a.fieldSettings.listValues&&e.settings.normalizeListValues&&(a.fieldSettings.listValues=e.settings.normalizeListValues.call(e.ctx,a.fieldSettings.listValues,a.type,a.fieldSettings)),a.fieldSettings.treeValues&&e.settings.normalizeListValues&&(a.fieldSettings.treeValues=e.settings.normalizeListValues.call(e.ctx,a.fieldSettings.treeValues,a.type,a.fieldSettings)),!u){a.disabled=!0;return}n||(e.__fieldsCntByType[a.type]||(e.__fieldsCntByType[a.type]=0),e.__fieldsCntByType[a.type]++),a.widgets||(a.widgets={}),n&&(a._isFuncArg=!0),a.mainWidget=a.mainWidget||u.mainWidget,a.valueSources=a.valueSources||u.valueSources;var v=u.excludeOperators||[],g=function(){var P=a.widgets[m]||{},F=u.widgets[m]||{};if(!n){var k=[].concat((0,we.A)(o),(0,we.A)(v)),W=a.preferWidgets&&(m=="field"||a.preferWidgets.includes(m))||k.length>0;if(P.operators){var q=P.operators.filter(function(Z){return!k.includes(Z)});t=[].concat((0,we.A)(t||[]),(0,we.A)(q))}else if(W&&F.operators){var re=F.operators.filter(function(Z){return!k.includes(Z)});t=[].concat((0,we.A)(t||[]),(0,we.A)(re))}P.defaultOperator&&(i=P.defaultOperator)}m==a.mainWidget&&(P=ha()({},{widgetProps:a.mainWidgetProps||{}},P)),a.widgets[m]=P};for(var m in u.widgets)g();n||(!a.operators&&t&&(a.operators=Array.from(new Set(t))),a._origDefaultOperator=a.defaultOperator,!a.defaultOperator&&i&&(a.defaultOperator=i))}var E=Tv(e,r),O=E.fieldName,R=E.inGroup;O&&(a.fieldName=O,e.__fieldNames[O]||(e.__fieldNames[O]=[]),e.__fieldNames[O].push({fullPath:r,inGroup:R}))}var Iu=function(e,r,n,t,i,u){if(Array.isArray(e))return r};function mi(a){return mn().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.delegateYield(bu(a,a.funcs||{},[]),"t0",1);case 1:case"end":return r.stop()}},hv)}function _l(a){return mn().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.delegateYield(bu(a,a.fields||{},[]),"t0",1);case 1:case"end":return r.stop()}},yv)}function bu(a,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"subfields";return mn().mark(function t(i){var u,o,s;return mn().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:u=(a==null||(i=a.settings)===null||i===void 0?void 0:i.fieldSeparator)||".",f.t0=mn().keys(e);case 2:if((f.t1=f.t0()).done){f.next=13;break}if(o=f.t1.value,s=e[o],!s[n]){f.next=9;break}return f.delegateYield(bu(a,s[n],[].concat((0,we.A)(r),[o]),n),"t2",7);case 7:f.next=11;break;case 9:return f.next=11,[[].concat((0,we.A)(r),[o]).join(u),s];case 11:f.next=2;break;case 13:case"end":return f.stop()}},t)})()}var hn=function(e,r){var n,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"fields",i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"subfields";if(!r)return null;if(r=="!case_value")return{type:"case_value",mainWidget:"case_value",widgets:{case_value:e.widgets.case_value}};var u=(e==null||(n=e.settings)===null||n===void 0?void 0:n.fieldSeparator)||".",o=it(r,e),s=e[t];if(!s)return null;for(var c=s,f=null,d=[],v=0;v<o.length;v++){var g=o[v];d.push(g);var m=d.join(u);f=c[m],v<o.length-1&&(f&&f[i]?(c=f[i],d=[]):f=null)}return f},Tv=function(e,r){if(!r)return{};var n=e.settings.fieldSeparator,t=(0,we.A)(r).reduce(function(s,c,f,d){var v=s.computedPath,g=s.computed,m=s.inGroup,E=[].concat((0,we.A)(d.slice(0,f)),[c]),O=hn(e,E);return O?.type==="!group"&&f<d.length-1?(m=E.join(n),v=[]):O!=null&&O.fieldName?(g=!0,v=[O.fieldName]):v=[].concat((0,we.A)(v),[c]),{computedPath:v,computed:g,inGroup:m}},{computedPath:[],computed:!1,inGroup:void 0}),i=t.computedPath,u=t.computed,o=t.inGroup;return u?{fieldName:i.join(n),inGroup:o}:{}},bo=function(e,r){var n,t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,u=e.settings.fieldSeparator,o=[i].concat((0,we.A)(r.split(u))).filter(function(f){return f!=null}),s=r,c=(n=e.__fieldNames[s])===null||n===void 0||(t=n.find)===null||t===void 0||(t=t.call(n,function(f){var d=f.inGroup;return d?i?.startsWith(d):!0}))===null||t===void 0?void 0:t.fullPath;return(c||o).join(u)},Fu=function(e,r){if(!r)return null;var n=hn(e,r,"funcs","subfields");if(!n)return null;var t=n.returnType,i=n.args,u=Object.fromEntries(Object.entries(i||{}).map(function(s){var c=(0,qe.A)(s,2),f=c[0],d=c[1],v=nn()(d,["type","valueSources","defaultValue","fieldSettings","isOptional"]);return[f,v]})),o={returnType:t,args:u};return o},Ct=function(e,r){if(!r)return null;var n=hn(e,r,"funcs","subfields");if(!n)return null;var t=e.types[n.returnType]||{};return Lu(Lu(Lu({},t),n),{},{type:n.returnType||n.type})},Nu=function(e,r,n){var t=Ct(e,r);if(!t)return null;var i=t.args&&t.args[n]||null;if(!i)return null;var u=e.types[i.type]||{},o=Ui()({},u,i||{},Iu);return o},Dl=function(e,r){var n,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!r)return!1;var i=(t==null||(n=t.settings)===null||n===void 0?void 0:n.fieldSeparator)||".",u=wu(e,t),o=wu(r,t);return u.startsWith(o+i)},wu=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string")return e;var t=(n==null||(r=n.settings)===null||r===void 0?void 0:r.fieldSeparator)||".";return it(e,n).join(t)},it=function(e){var r,n,t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!e)return[];if(Array.isArray(e))return e;var u=(i==null||(r=i.settings)===null||r===void 0?void 0:r.fieldSeparator)||".";if(e!=null&&e.func)return Array.isArray(e.func)?e.func:e.func.split(u);if(e!=null&&(n=e.get)!==null&&n!==void 0&&n.call(e,"func")){var o;return e==null||(o=e.get)===null||o===void 0?void 0:o.call(e,"func").split(u)}return(e==null||(t=e.split)===null||t===void 0?void 0:t.call(e,u))||[]},Av=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!e)return null;var t=r.settings.fieldSeparator,i=it(e,r);return n?i:i.map(function(u,o,s){return s.slice(0,o+1)}).map(function(u){return u.join(t)})},Ml=function(e){var r;if(!e)return null;if((0,Ar.A)(e)=="object"){if(!e.func&&e.type)return"field";if(e.func)return e.func&&e.arg?null:"func"}return e!=null&&(r=e.get)!==null&&r!==void 0&&r.call(e,"func")?e!=null&&e.get("arg")?null:"func":"field"},ze=function(e,r){var n;if(!r)return null;if((0,Ar.A)(r)=="object"){if(!r.func&&r.type)return r;if(r.func)return r.func&&r.arg?Nu(e,r.func,r.arg):Ct(e,r.func)}if(r!=null&&(n=r.get)!==null&&n!==void 0&&n.call(r,"func"))return r!=null&&r.get("arg")?Nu(e,r.get("func"),r.get("arg")):Ct(e,r.get("func"));var t=hn(e,r);if(!t)return null;var i=e.types[t.type]||{},u=Ui()({},i,t||{},Iu);return u},Gr=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!r)return null;var t=e.operators[r];if(n){var i=ze(e,n),u=Yr(e,n,r,null),o=e.widgets[u]||{},s=(i&&i.widgets?i.widgets[u]:{})||{},c=(o.opProps||{})[r],f=(s.opProps||{})[r],d=ha()({},t,c,f);return d}else return t},kt=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!r||!(n||t)&&i!="const"&&r!="!case_value")return null;var u=ze(e,r);t||(t=Yr(e,r,n,i));var o=e.widgets[t]||{},s=(u&&u.widgets?u.widgets[t]:{})||{},c=s.widgetProps||{},f=(i=="value"||!i)&&u&&u.fieldSettings||{},d=ha()({},o,c,f);return d},Rv=gn;function Vl(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function jl(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vl(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Vl(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Cv=function(e,r){var n={usedFields:[]},t=kl(e,r,n);if(t)return jl(jl({},t),n)},kl=function(e,r,n){if(e){var t=e.get("type"),i=e.get("children1");if((t==="group"||t==="rule_group")&&i&&i.size)return Lv(e,r,n);if(t==="rule")return Iv(e,r,n)}},Lv=function(e,r,n){var t=e.get("properties")||new vr.Map,i=e.get("children1"),u=e.get("id"),o=i.map(function(d){return kl(d,r,n)}).filter(function(d){return typeof d<"u"});if(o.size){var s=t.get("conjunction");s||(s=Dn(r));var c=t.get("not"),f={id:u,rules:o.toList(),condition:s.toUpperCase(),not:c};return f}},Iv=function(e,r,n){var t,i=e.get("properties")||new vr.Map,u=e.get("id"),o=i.get("operator"),s=i.get("operatorOptions"),c=i.get("field"),f=i.get("value"),d=i.get("valueSrc"),v=i.get("valueType"),g=f.filter(function(J){return J===void 0}).size>0;if(!(c==null||o==null||g)){var m=ze(r,c)||{},E=Gr(r,o,c)||{},O=m.type||"undefined",R=Rr(E.cardinality,1),w=r.types[m.type]||{},P=qn(c,r,n);if(!(f.size<R)){n.usedFields.indexOf(c)==-1&&n.usedFields.push(c),f=f.toArray(),d=d.toArray(),v=((t=v)===null||t===void 0?void 0:t.toArray())||[];for(var F=[],k=0;k<f.length;k++){var W={type:v[k],value:f[k]};if(F.push(W),d[k]=="field"){var q=f[k];n.usedFields.indexOf(q)==-1&&n.usedFields.push(q)}}var re=s?s.toJS():null;re&&!Object.keys(re).length&&(re=null);var Z={id:u,fieldName:P,type:O,input:w.mainWidget,operator:o};return re&&(Z.operatorOptions=re),Z.values=F,Z}}};function xl(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Ul(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xl(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):xl(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function Gl(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=bv(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function bv(a,e){if(a){if(typeof a=="string")return Bl(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Bl(a,e)}}function Bl(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}var Fv=function(e,r){var n={usedFields:[],errors:[]},t=Jn(r,void 0,!1),i=Wl(e,t,n,!0),u=n.errors,o=n.usedFields,s=t.settings.fieldSeparator,c={},f=Gl(o),d;try{for(f.s();!(d=f.n()).done;)for(var v=d.value,g=it(v,r),m=ze(t,v)||{},E=c,O=0;O<g.length;O++){var R=g[O],w=ze(t,g.slice(0,O+1))||{};O!=g.length-1?w.type=="!group"&&w.mode!="struct"?(E[R]||(E[R]=[{}]),E=E[R][0]):(E[R]||(E[R]={}),E=E[R]):E[R]||(E[R]=null)}}catch(P){f.e(P)}finally{f.f()}return{errors:u,logic:i,data:c}},Wl=function(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e){var u=e.get("type"),o=e.get("properties")||new vr.Map,s=o.get("isLocked"),c=r.settings.jsonLogic.lockedOp,f;return u==="group"||u==="rule_group"?f=Nv(e,r,n,t,i):u==="rule"&&(f=wv(e,r,n,i)),s&&f&&c&&(f=(0,Se.A)({},c,f)),f}},Nv=function(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=e.get("type"),o=e.get("properties")||new vr.Map,s=o.get("mode"),c=e.get("children1")||new vr.List,f=o.get("field"),d=o.get("conjunction");d||(d=Dn(r));var v=r.conjunctions[d],g=v.jsonLogicConj||d.toLowerCase(),m=o.get("not"),E=u==="rule_group"&&!t,O=E&&s!="struct"?f:i,R=o.get("operator"),w=R&&Gr(r,R,f)||null,P=$l(r,o,n,R,i),F=E&&(!R||w.cardinality==0),k=c.map(function(te){return Wl(te,r,n,!1,O)}).filter(function(te){return typeof te<"u"});if(E&&s!="struct"&&!F){if(P==null)return}else if(!k.size)return;var W={};if(k.size==1&&!t?W=k.first():W[g]=k.toList().toJS(),m&&(W={"!":W}),E&&s!="struct"){var q=_u(n,r,f,i);if(F){var re=R||"some";W=(0,Se.A)({},re,[q,W])}else{var Z=k.size?{filter:[q,W]}:q,J={reduce:[Z,{"+":[1,{var:"accumulator"}]},0]};W=Kl(r,o,J,P,R)}}return W},wv=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=e.get("properties")||new vr.Map,u=i.get("field"),o=i.get("fieldSrc"),s=i.get("operator"),c=i.get("operatorOptions");if(c=c?c.toJS():null,c&&!Object.keys(c).length&&(c=null),!(u==null||s==null)){var f=ze(r,u)||{},d=Gr(r,s,u)||{},v=d.reversedOp,g=Gr(r,v,u)||{},m=!1;if(!d.jsonLogic&&!g.jsonLogic){n.errors.push("Operator ".concat(s," is not supported"));return}if(!d.jsonLogic&&g.jsonLogic){m=!0;var E=[v,s];s=E[0],v=E[1];var O=[g,d];d=O[0],g=O[1]}var R=$l(r,i,n,s,t);if(R!==void 0){var w=o==="func"?Hl(n,r,u,t):_u(n,r,u,t);if(w!==void 0)return Kl(r,i,w,R,s,c,f,m)}}},$l=function(e,r,n,t,i){var u=r.get("field"),o=r.get("valueSrc"),s=r.get("valueType"),c=ze(e,u)||{},f=Gr(e,t,u)||{},d=Rr(f.cardinality,1),v=r.get("value"),g=r.get("asyncListValues");if(v!=null){var m=[],E=[],O=n.usedFields,R=v.map(function(P,F){var k=o?o.get(F):null,W=s?s.get(F):null,q=Ga(P,k,e),re=Yr(e,u,t,k),Z=jr()(kt(e,u,t,re,k),["factory"]),J=Pu(n,e,q,k,W,Z,c,t,f,i,g);return J!==void 0&&(m.push(k),E.push(W)),J}),w=R.filter(function(P){return P===void 0}).size>0;if(R.size<d||w){n.usedFields=O;return}return d>1?R.toArray():d==1?R.first():null}},Pu=function(e,r,n,t,i,u,o,s,c){var f=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0;if(n!==void 0){var v;if(t=="field")v=_u(e,r,n,f);else if(t=="func")v=Hl(e,r,n,f);else if(typeof u.jsonLogic=="function"){var g=u.jsonLogic,m=[n,Ul(Ul({},nn()(o,["fieldSettings","listValues"])),{},{asyncListValues:d}),jr()(u,gn)];s&&(m.push(s),m.push(c)),v=g.call.apply(g,[r.ctx].concat(m))}else v=n;return v}},Hl=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=n.get("func"),u=n.get("args"),o=Ct(r,i),s=it(i,r),c=s[s.length-1];if(!o){e.errors.push("Func ".concat(i," is not defined in config"));return}if(!(o!=null&&o.jsonLogic)){e.errors.push("Func ".concat(i," is not supported"));return}var f={},d=[],v=[];for(var g in o.args){var m=o.args[g],E=ze(r,m),O=m.defaultValue,R=m.isOptional,w=O!=null&&O.func?"func":"value",P=u?u.get(g):void 0,F=P?P.get("value"):void 0,k=P?P.get("valueSrc"):void 0,W=null,q=Yr(r,m,W,k),re=jr()(kt(r,m,W,q,k),["factory"]),Z=Pu(e,r,F,k,m.type,re,E,null,null,t);if(F!=null&&Z===void 0){k!="func"&&e.errors.push("Can't format value of arg ".concat(g," for func ").concat(i));return}var J=void 0;if(Z===void 0&&!R&&O!=null){var te=Yr(r,m,W,w),le=jr()(kt(r,m,W,te,w),["factory"]);if(J=Pu(e,r,O,w,m.type,le,E,null,null,t),J===void 0){w!="func"&&e.errors.push("Can't format default value of arg ".concat(g," for func ").concat(i));return}}var ee=Z??J;if(ee!==void 0){if(d.length){var ie=Gl(d),oe;try{for(ie.s();!(oe=ie.n()).done;){var pe=oe.value;f[pe]=void 0}}catch(Je){ie.e(Je)}finally{ie.f()}d=[]}f[g]=ee}else R||v.push(g),d.push(g)}if(!v.length){var se=Object.values(f),de;if(typeof o.jsonLogic=="function"){var ge=o.jsonLogic,Fe=[f];de=ge.call.apply(ge,[r.ctx].concat(Fe))}else{var De=o.jsonLogic||c,ke=!!o.jsonLogicIsMethod;if(ke){var Oe=se[0],je=se.slice(1);je.length?de={method:[Oe,De,je]}:de={method:[Oe,De]}}else de=(0,Se.A)({},De,se)}return de}},_u=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=r.settings,u=i.fieldSeparator,o=i.jsonLogic,s;if(n){Array.isArray(n)&&(n=n.join(u));var c=ze(r,n)||{},f=qn(n,r,e,t),d=c.jsonLogicVar||(c.type=="!group"?o.groupVarKey:"var");s=(0,Se.A)({},d,f),e.usedFields.indexOf(n)==-1&&e.usedFields.push(n)}return s},Pv=function(e,r,n,t){var i=e,u=Rr(r.cardinality,1),o=Rr(r._jsonLogicIsRevArgs,!1);typeof r.jsonLogic=="string"&&(i=r.jsonLogic);var s=["<","<=",">",">="],c=["==","!="],f=function(v,g,m,E,O){return u==0&&c.includes(i)?(0,Se.A)({},i,[n,null]):u==0?(0,Se.A)({},i,n):u==1&&o?(0,Se.A)({},i,[t,n]):u==1?(0,Se.A)({},i,[n,t]):u==2&&s.includes(i)?(0,Se.A)({},i,[t[0],n,t[1]]):(0,Se.A)({},i,[n].concat((0,we.A)(t)))};return f},Kl=function(e,r,n,t,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,c=r.get("field"),f=Gr(e,i,c)||{},d=typeof f.jsonLogic=="function"?f.jsonLogic:Pv(i,f,n,t),v=[n,i,t,jr()(f,Yn),u,o],g=d.call.apply(d,[e.ctx].concat(v));return s&&(g={"!":g}),g};function _v(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=Dv(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function Dv(a,e){if(a){if(typeof a=="string")return Yl(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yl(a,e)}}function Yl(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}function zl(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Xl(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zl(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):zl(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var ql=function(e){return(0,Ar.A)(e)=="object"&&e!==null&&!Array.isArray(e)},Mv=function(e,r){return Jl(e,r,!1)},Jl=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,t={errors:[]},i=Jn(r,void 0,!1),u=Du([],e,i,t);return n?[u,t.errors]:(t.errors.length&&console.warn("Errors while exporting to MongoDb:",t.errors),u)},Du=function(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0;if(r){var c=r.get("type");if(c==="group"||c==="rule_group")return Vv(e,r,n,t,i,u,o,s);if(c==="rule")return jv(e,r,n,t,i,u,o,s)}},Vv=function(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,c=r.get("type"),f=r.get("properties")||new vr.Map,d=r.get("children1")||new vr.List,v=n.settings,g=v.canShortMongoQuery,m=v.fieldSeparator,E=m,O=e.filter(function(ge){return ge.get("type")=="rule_group"}).length>0,R=e.filter(function(ge){return ge.get("type")=="rule_group"}).map(function(ge){return ge.get("properties").get("field")}).slice(-1).pop(),w=O&&R,P=c==="rule_group"?f.get("field"):null,F=qn(P,n,t,w),k=ze(n,P)||{},W=k.mode,q=P&&W=="array",re=i?!f.get("not"):f.get("not"),Z=d.map(function(ge){return Du([].concat((0,we.A)(e),[r]),ge,n,t,re,W!="array",W=="array"?function(Fe){return"$$el".concat(E).concat(Fe)}:void 0)}).filter(function(ge){return typeof ge<"u"});if(!(!q&&!Z.size)){var J=f.get("conjunction");J||(J=Dn(n));var te=n.conjunctions[J],le=te.reversedConj;if(re&&le&&(J=le,te=n.conjunctions[J]),!!te){var ee=te.mongoConj,ie;if(Z.size==1)ie=Z.first();else if(Z.size>1){var oe=Z.toList().toJS(),pe=g&&ee=="$and";pe&&(ie=oe.reduce(function(ge,Fe){if(ge){for(var De in Fe){if(De[0]=="$"){ge=void 0;break}if(ge[De]==null)ge[De]=Fe[De];else{var ke=ge[De],Oe=Fe[De];ql(ke)||(ke={$eq:ke}),ql(Oe)||(Oe={$eq:Oe});var je=Object.keys(ke)[0],Je=Object.keys(Oe)[0];if(je==Je){ge=void 0;break}ge[De]=Object.assign({},ke,Oe)}}return ge}},{})),ie||(ie=(0,Se.A)({},ee,oe))}if(P)if(W=="array"){var se={$size:{$ifNull:["$"+F,[]]}},de=ie?{$size:{$ifNull:[{$filter:{input:"$"+F,as:"el",cond:ie}},[]]}}:se;ie=Du(e,r.set("type","rule"),n,t,!1,!1,function(ge){return de},se),ie={$expr:ie}}else ie=(0,Se.A)({},F,{$elemMatch:ie});return ie}}},jv=function(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,c=r.get("properties")||new vr.Map,f=e.filter(function(xe){return xe.get("type")=="rule_group"}).length>0,d=e.filter(function(xe){return xe.get("type")=="rule_group"}).map(function(xe){return xe.get("properties").get("field")}).slice(-1).pop(),v=f&&d,g=c.get("operator"),m=c.get("operatorOptions"),E=c.get("field"),O=c.get("fieldSrc"),R=c.get("value"),w=c.get("valueSrc"),P=c.get("valueType"),F=c.get("asyncListValues");if(!(E==null||g==null||R===void 0)){var k=ze(n,E)||{},W=Gr(n,g,E)||{},q=W.reversedOp,re=Gr(n,q,E)||{},Z=Rr(W.cardinality,1),J=i;if(J&&q){var te=[q,g];g=te[0],q=te[1];var le=[re,W];W=le[0],re=le[1],J=!1}var ee,ie=!1;if(O=="func"){var oe=Ql(t,n,E,v),pe=(0,qe.A)(oe,2);ee=pe[0],ie=pe[1]}else ee=qn(E,n,t,v),o&&(ie=!0,ee=o(ee));if(ee!=null){var se=[],de=[],ge=R.map(function(xe,Ze){var Ye=w?w.get(Ze):null,mr=P?P.get(Ze):null,Or=Ga(xe,Ye,n),tt=Yr(n,E,g,Ye),Lt=jr()(kt(n,E,g,tt,Ye),["factory"]),st=Mu(t,n,Or,Ye,mr,Lt,k,v,g,W,F),vt=(0,qe.A)(st,2),qt=vt[0],It=vt[1];return qt!==void 0&&(ie=ie||It,se.push(Ye),de.push(mr)),qt}),Fe=ie&&u,De=ge.filter(function(xe){return xe===void 0}).size>0;if(!(ge.size<Z||De)){var ke=Z>1?ge.toArray():Z==1?ge.first():null,Oe=W.mongoFormatOp;if(!Oe){t.errors.push("Operator ".concat(g," is not supported"));return}var je=[ee,g,s!==void 0&&ke==null?s:ke,ie,se.length>1?se:se[0],de.length>1?de:de[0],jr()(W,Yn),m,k],Je=Oe.call.apply(Oe,[n.ctx].concat(je));return Fe&&(Je={$expr:Je}),J&&(Je={$not:Je}),Je}}}},Mu=function(e,r,n,t,i,u,o,s,c,f,d){if(n===void 0)return[void 0,!1];var v,g=!1;if(t=="field"){var m=kv(e,r,n,s),E=(0,qe.A)(m,2);v=E[0],g=E[1]}else if(t=="func"){var O=Ql(e,r,n,s),R=(0,qe.A)(O,2);v=R[0],g=R[1]}else if(typeof u.mongoFormatValue=="function"){var w=u.mongoFormatValue,P=[n,Xl(Xl({},nn()(o,["fieldSettings","listValues"])),{},{asyncListValues:d}),jr()(u,gn)];c&&(P.push(c),P.push(f)),v=w.call.apply(w,[r.ctx].concat(P))}else v=n;return[v,g]},kv=function(e,r,n,t){var i=r.settings.fieldSeparator,u,o=!0;if(n){var s=ze(r,n)||{},c=it(n,r),f=$i(n,r),d=f?f.join(i):null,v=r.settings.formatField,g=qn(n,r,e,t),m=v(g,c,d,s,r,!1);u="$"+m}return[u,o]},Ql=function(e,r,n,t){var i=!0,u,o=n.get("func"),s=n.get("args"),c=Ct(r,o);if(!c)return e.errors.push("Func ".concat(o," is not defined in config")),[void 0,!1];var f=it(o,r),d=f[f.length-1],v=c.mongoFunc||d,g=c.mongoArgsAsObject,m={},E=0,O=void 0,R=[],w=[];for(var P in c.args){E++;var F=c.args[P],k=ze(r,F),W=F.defaultValue,q=F.isOptional,re=W!=null&&W.func?"func":"value",Z=s?s.get(P):void 0,J=Z?Z.get("value"):void 0,te=Z?Z.get("valueSrc"):void 0,le=Z?Z.get("asyncListValues"):void 0,ee=null,ie=Yr(r,F,ee,te),oe=jr()(kt(r,F,ee,ie,te),["factory"]),pe=Mu(e,r,J,te,F.type,oe,k,t,null,null,le),se=(0,qe.A)(pe,2),de=se[0],ge=se[1];if(J!=null&&de===void 0)return te!="func"&&e.errors.push("Can't format value of arg ".concat(P," for func ").concat(o)),[void 0,!1];var Fe=void 0;if(de===void 0&&!q&&W!=null){var De=Yr(r,F,ee,re),ke=jr()(kt(r,F,ee,De,re),["factory"]),Oe=void 0,je=Mu(e,r,W,re,F.type,ke,k,t,null,null,le),Je=(0,qe.A)(je,2);if(Fe=Je[0],Oe=Je[1],Fe===void 0)return re!="func"&&e.errors.push("Can't format default value of arg ".concat(P," for func ").concat(o)),[void 0,!1]}var xe=de??Fe;if(xe!==void 0){if(R.length){var Ze=_v(R),Ye;try{for(Ze.s();!(Ye=Ze.n()).done;){var mr=Ye.value;m[mr]=void 0}}catch(Lt){Ze.e(Lt)}finally{Ze.f()}R=[]}m[P]=xe,O=xe}else q||w.push(P),R.push(P)}if(w.length)return[void 0,!1];if(typeof c.mongoFormatFunc=="function"){var Or=c.mongoFormatFunc,tt=[m];u=Or.call.apply(Or,[r.ctx].concat(tt))}else{if(c.mongoFormatFunc===null)return e.errors.push("Functon ".concat(v," is not supported")),[void 0,!1];g?u=(0,Se.A)({},v,m):E==1&&O!==void 0?u=(0,Se.A)({},v,O):u=(0,Se.A)({},v,Object.values(m))}return[u,i]};function xv(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=Uv(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function Uv(a,e){if(a){if(typeof a=="string")return Zl(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zl(a,e)}}function Zl(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}function ec(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function rc(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ec(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):ec(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Gv=function(e,r){return tc(e,r,!1)},tc=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,t={errors:[]},i=Jn(r,void 0,!1),u=nc(e,i,t);return n?[u,t.errors]:(t.errors.length&&console.warn("Errors while exporting to SQL:",t.errors),u)},nc=function(e,r,n){if(e){var t=e.get("type"),i=e.get("children1");if(t==="group"||t==="rule_group")return Bv(e,r,n);if(t==="rule")return $v(e,r,n)}},Bv=function(e,r,n){var t=e.get("type"),i=e.get("properties")||new vr.Map,u=e.get("children1")||new vr.List,o=t==="rule_group",s=o?i.get("field"):null,c=ze(r,s)||{},f=c.mode;f=="array"&&n.errors.push("Aggregation is not supported for ".concat(s));var d=i.get("not"),v=!1,g=u.map(function(O){return nc(O,r,n)}).filter(function(O){return typeof O<"u"});if(!(!v&&!g.size)){var m=i.get("conjunction");m||(m=Dn(r));var E=r.conjunctions[m];return E.sqlFormatConj(g,m,d)}},Wv=function(e,r){var n=r.sqlOp||e,t=Rr(r.cardinality,1),i;return t==0?i=function(o,s,c,f,d,v,g,m){return"".concat(o," ").concat(n)}:t==1?i=function(o,s,c,f,d,v,g,m){return"".concat(o," ").concat(n," ").concat(c)}:t==2&&(i=function(o,s,c,f,d,v,g,m){var E=c.first(),O=c.get(1);return"".concat(o," ").concat(n," ").concat(E," AND ").concat(O)}),i},$v=function(e,r,n){var t=e.get("properties")||new vr.Map,i=t.get("field"),u=t.get("fieldSrc"),o=t.get("operator"),s=t.get("operatorOptions"),c=t.get("valueSrc"),f=t.get("valueType"),d=t.get("value"),v=t.get("asyncListValues");if(!(i==null||o==null)){var g=ze(r,i)||{},m=Gr(r,o,i)||{},E=m.reversedOp,O=Gr(r,E,i)||{},R=Rr(m.cardinality,1),w=!1,P=m.sqlOp||m.sqlFormatOp,F=O.sqlOp||O.sqlFormatOp;if(!P&&!F){n.errors.push("Operator ".concat(o," is not supported"));return}if(!P&&F){w=!0;var k=[E,o];o=k[0],E=k[1];var W=[O,m];m=W[0],O=W[1]}var q=[],re=[],Z=d.map(function(pe,se){var de=c?c.get(se):null,ge=f?f.get(se):null,Fe=Ga(pe,de,r),De=Yr(r,i,o,de),ke=jr()(kt(r,i,o,De,de),["factory"]),Oe=Vu(n,r,Fe,de,ge,ke,g,o,m,v);return Oe!==void 0&&(q.push(de),re.push(ge)),Oe}),J=Z.filter(function(pe){return pe===void 0}).size>0;if(!(J||Z.size<R)){var te=R==1?Z.first():Z,le=m.sqlFormatOp||Wv(o,m);if(!le){n.errors.push("Operator ".concat(o," is not supported"));return}var ee=u=="func"?ic(n,r,i):ac(n,r,i);if(ee!=null){var ie=[ee,o,te,q.length>1?q:q[0],re.length>1?re:re[0],jr()(m,Yn),s,g],oe;if(oe=le.call.apply(le,[r.ctx].concat(ie)),w&&(oe=r.settings.sqlFormatReverse(oe)),oe===void 0){n.errors.push("Operator ".concat(o," is not supported for value source ").concat(q.join(", ")));return}return oe}}}},Vu=function(e,r,n,t,i,u,o,s,c,f){if(n!==void 0){var d;if(t=="field")d=ac(e,r,n);else if(t=="func")d=ic(e,r,n);else if(typeof u.sqlFormatValue=="function"){var v=u.sqlFormatValue,g=[n,rc(rc({},nn()(o,["fieldSettings","listValues"])),{},{asyncListValues:f}),jr()(u,gn)];if(s&&(g.push(s),g.push(c)),t=="field"){var m=ze(r,n)||{};g.push(m)}d=v.call.apply(v,[r.ctx].concat(g))}else Array.isArray(n)?d=n.map(function(E){return Ea.escape(E)}):d=Ea.escape(n);return d}},ac=function(e,r,n){if(n){var t=r.settings.fieldSeparator,i=ze(r,n)||{},u=it(n,r),o=$i(n,r),s=o?o.join(t):null,c=r.settings.formatField,f=qn(n,r,e,null,{useTableName:!0}),d=c(f,u,s,i,r);return d}},ic=function(e,r,n){var t=n.get("func"),i=n.get("args"),u=Ct(r,t);if(!u){e.errors.push("Func ".concat(t," is not defined in config"));return}var o=it(t,r),s=o[o.length-1],c=u.sqlFunc||s,f={},d=[],v=[];for(var g in u.args){var m=u.args[g],E=ze(r,m),O=m.defaultValue,R=m.isOptional,w=O!=null&&O.func?"func":"value",P=i?i.get(g):void 0,F=P?P.get("value"):void 0,k=P?P.get("valueSrc"):void 0,W=P?P.get("asyncListValues"):void 0,q=Vu(e,r,F,k,m.type,E,m,null,null,W);if(F!=null&&q===void 0){k!="func"&&e.errors.push("Can't format value of arg ".concat(g," for func ").concat(t));return}var re=void 0;if(q===void 0&&!R&&O!=null&&(re=Vu(e,r,O,w,m.type,E,m,null,null,W),re===void 0)){w!="func"&&e.errors.push("Can't format default value of arg ".concat(g," for func ").concat(t));return}var Z=q??re;if(Z!==void 0){if(d.length){var J=xv(g),te;try{for(J.s();!(te=J.n()).done;){var le=te.value;f[le]=void 0}}catch(se){J.e(se)}finally{J.f()}d=[]}f[g]=Z}else R||v.push(g),d.push(g)}if(!v.length){var ee;if(typeof u.sqlFormatFunc=="function"){var ie=u.sqlFormatFunc,oe=[f];ee=ie.call.apply(ie,[r.ctx].concat(oe))}else{var pe=Object.entries(f).map(function(se){var de=(0,qe.A)(se,2),ge=de[0],Fe=de[1];return Fe}).join(", ");ee="".concat(c,"(").concat(pe,")")}return ee}};function Hv(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=Kv(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function Kv(a,e){if(a){if(typeof a=="string")return oc(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oc(a,e)}}function oc(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}function uc(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function sc(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uc(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):uc(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Yv=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,t={errors:[]},i=Jn(r,void 0,!1),u=lc(e,i,t,n,null);return t.errors.length&&console.warn("Errors while exporting to string:",t.errors),u},lc=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e){var u=e.get("type"),o=e.get("children1");if(u==="group"||u==="rule_group")return zv(e,r,n,t,i);if(u==="rule")return cc(e,r,n,t,i)}},zv=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=e.get("type"),o=e.get("properties")||new vr.Map,s=o.get("mode"),c=e.get("children1")||new vr.List,f=u==="rule_group",d=f&&s=="array"?o.get("field"):null,v=f&&s=="array",g=o.get("not"),m=c.map(function(q){return lc(q,r,n,t,d)}).filter(function(q){return typeof q<"u"});if(!(!v&&!m.size)){var E=o.get("conjunction");E||(E=Dn(r));var O=r.conjunctions[E],R=m.size?O.formatConj(m,E,g,t):null,w;if(d){var P=cc(e,r,n,t,i,!0);if(P){var F,k=P.pop(),W=[R].concat((0,we.A)(P));w=(F=r.settings).formatAggr.apply(F,(0,we.A)(W)),k&&(w=r.settings.formatReverse(w,null,null,null,null,t))}}else w=R;return w}},Xv=function(e,r,n,t,i,u){var o=r.get("field"),s=r.get("valueSrc"),c=r.get("valueType"),f=ze(e,o)||{},d=t||r.get("operator"),v=Gr(e,d,o)||{},g=Rr(v.cardinality,1),m=r.get("value"),E=r.get("asyncListValues"),O=[],R=[],w;if(m!=null){var P=m.map(function(k,W){var q=s?s.get(W):null,re=c?c.get(W):null,Z=Ga(k,q,e),J=Yr(e,o,d,q),te=jr()(kt(e,o,d,J,q),["factory"]),le=ju(e,n,Z,q,re,te,f,d,v,i,u,E);return le!==void 0&&(O.push(q),R.push(re)),le}),F=P.filter(function(k){return k===void 0}).size>0;F||P.size<g||(w=g==1?P.first():P)}return[w,O.length>1?O:O[0],R.length>1?R:R[0]]},qv=function(e,r){var n=r.labelForFormat||e,t=Rr(r.cardinality,1),i;return t==0?i=function(o,s,c,f,d,v,g,m){return"".concat(o," ").concat(n)}:t==1?i=function(o,s,c,f,d,v,g,m){return"".concat(o," ").concat(n," ").concat(c)}:t==2&&(i=function(o,s,c,f,d,v,g,m){var E=c.first(),O=c.get(1);return"".concat(o," ").concat(n," ").concat(E," AND ").concat(O)}),i},cc=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,o=e.get("properties")||new vr.Map,s=o.get("field"),c=o.get("fieldSrc"),f=o.get("operator"),d=o.get("operatorOptions");if(!(s==null||f==null)){var v=ze(r,s)||{},g=Gr(r,f,s)||{},m=g.reversedOp,E=Gr(r,m,s)||{},O=!1,R=g.formatOp;if(!R&&m&&(R=E.formatOp,R)){O=!0;var w=[m,f];f=w[0],m=w[1];var P=[E,g];g=P[0],E=P[1]}if(R||(R=qv(f,g)),!!R){var F=c==="func"?dc(r,n,s,t,i):fc(r,n,s,t,i);if(F!=null){var k=Xv(r,o,n,f,t,i),W=(0,qe.A)(k,3),q=W[0],re=W[1],Z=W[2];if(q!==void 0){var J=[F,f,q,re,Z,jr()(g,Yn),d,t,v,O];if(u)return J;var te,le=(te=R).call.apply(te,[r.ctx].concat(J));return O&&(le=r.settings.formatReverse(le,f,m,g,E,t)),le}}}}},ju=function(e,r,n,t,i,u,o,s,c,f){var d=arguments.length>10&&arguments[10]!==void 0?arguments[10]:null,v=arguments.length>11?arguments[11]:void 0;if(n!==void 0){var g;if(t=="field")g=fc(e,r,n,f,d);else if(t=="func")g=dc(e,r,n,f,d);else if(typeof u.formatValue=="function"){var m=u.formatValue,E=[n,sc(sc({},nn()(o,["fieldSettings","listValues"])),{},{asyncListValues:v}),jr()(u,gn),f];if(s&&(E.push(s),E.push(c)),t=="field"){var O=ze(e,n)||{};E.push(O)}g=m.call.apply(m,[e.ctx].concat(E))}else g=n;return g}},fc=function(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=e.settings,s=o.fieldSeparator,c=o.fieldSeparatorDisplay,f=null;if(n){var d=ze(e,n)||{},v=it(n,e),g=$i(n,e,u?i:null),m=g?g.join(c):null,E=d.label2||m,O=e.settings.formatField,R=qn(n,e,r,u?i:null,{useTableName:!0});f=O(R,v,E,d,e,t)}return f},dc=function(e,r,n,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=n.get("func"),o=n.get("args"),s=Ct(e,u);if(!s){r.errors.push("Func ".concat(u," is not defined in config"));return}var c=it(u,e),f=c[c.length-1],d=t&&s.label||f,v={},g=[],m=[],E={};for(var O in s.args){var R=s.args[O],w=ze(e,R),P=R.defaultValue,F=R.isOptional,k=P!=null&&P.func?"func":"value",W=t&&R.label||O,q=o?o.get(O):void 0,re=q?q.get("value"):void 0,Z=q?q.get("valueSrc"):void 0,J=q?q.get("asyncListValues"):void 0,te=ju(e,r,re,Z,R.type,w,R,null,null,t,i,J);if(re!=null&&te===void 0){Z!="func"&&r.errors.push("Can't format value of arg ".concat(O," for func ").concat(u));return}var le=void 0;if(te===void 0&&!F&&P!=null&&(le=ju(e,r,P,k,R.type,w,R,null,null,t,i,J),le===void 0)){k!="func"&&r.errors.push("Can't format default value of arg ".concat(O," for func ").concat(u));return}var ee=te??le;if(ee!==void 0){if(g.length){var ie=Hv(O),oe;try{for(ie.s();!(oe=ie.n()).done;){var pe=(0,qe.A)(oe.value,2),se=pe[0],de=pe[1];v[se]=void 0}}catch(Oe){ie.e(Oe)}finally{ie.f()}g=[]}v[O]=ee,E[W]=ee}else F||m.push(O),g.push([O,W])}if(!m.length){var ge=null;if(typeof s.formatFunc=="function"){var Fe=s.formatFunc,De=[v,t];ge=Fe.call.apply(Fe,[e.ctx].concat(De))}else{var ke=Object.entries(t?E:v).map(function(Oe){var je=(0,qe.A)(Oe,2),Je=je[0],xe=je[1];return t?"".concat(Je,": ").concat(xe):"".concat(xe)}).join(", ");ge="".concat(d,"(").concat(ke,")")}return ge}};function pc(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function vc(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pc(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):pc(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function Jv(a){if(a==null)return null;var e=a.split(",").map(Number);return{top_left:{lat:e[0],lon:e[1]},bottom_right:{lat:e[2],lon:e[3]}}}function Qv(a,e){if(a.length>1)return{gte:"".concat(a[0]),lte:"".concat(a[1])};var r=a[0];switch(e){case"on_date":case"not_on_date":case"equal":case"select_equals":case"not_equal":return{gte:"".concat(r,"||/d"),lte:"".concat(r,"||+1d")};case"less_or_equal":return{lte:"".concat(r)};case"greater_or_equal":return{gte:"".concat(r)};case"less":return{lt:"".concat(r)};case"greater":return{gt:"".concat(r)};default:return}}function Zv(a){return{value:"*"+a+"*"}}function eg(a,e){switch(a){case"AND":return e?"must_not":"must";case"OR":return e?"should_not":"should";case"NOT":return e?"must":"must_not";default:return}}function rg(a){return{value:a}}function tg(a,e){return a}function ng(a,e,r,n,t,i){var u=tg(n,t);switch(a){case"filter":return{script:t.operators[r].elasticSearchScript(n,e)};case"exists":return{field:n};case"match":return(0,Se.A)({},u,e[0]);case"term":return i===mc?(0,Se.A)({},n,{value:e[0]}):(0,Se.A)({},n,e[0]);case"geo_bounding_box":return(0,Se.A)({},n,Jv(e[0]));case"range":return(0,Se.A)({},n,Qv(e,r));case"wildcard":return(0,Se.A)({},n,Zv(e[0]));case"regexp":return(0,Se.A)({},n,rg(e[0]));default:return}}function gc(a,e,r,n,t,i){if(!(!a||!r||e==null)){var u=r,o=n.operators[u];if(o){var s=o,c=s.elasticSearchQueryType,f=!1;if(!c&&o.reversedOp){f=!0,u=o.reversedOp,o=n.operators[u];var d=o;c=d.elasticSearchQueryType}var v=Yr(n,a,u,t),g=n.widgets[v];if(g){var m=g.elasticSearchFormatValue,E;if(typeof c=="function"?E=c(v):E=c,!!E){var O;return typeof m=="function"?O=m(E,e,u,a,n):O=ng(E,e,u,a,n,i),f?{bool:{must_not:(0,Se.A)({},E,vc({},O))}}:(0,Se.A)({},E,vc({},O))}}}}}function ag(a,e,r,n,t,i){if(!(!a||!a.size)){var u=a.valueSeq().toArray(),o=eg(e,r),s=u.map(function(f){return n(f,t,i)}).filter(function(f){return f!==void 0});if(s.length){var c=s.flat(1/0);return{bool:(0,Se.A)({},o,c)}}}}var mc="ES_7_SYNTAX",hc="ES_6_SYNTAX";function yc(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hc;if(a){var n=a.get("type"),t=a.get("properties")||new Map;if(n==="rule"&&t.get("field")){var i,u,o=t.get("operator"),s=t.get("field"),c=t.get("fieldSrc"),f=t.get("value").toJS(),d=(i=t.get("valueType"))===null||i===void 0?void 0:i.get(0),v=(u=t.get("valueSrc"))===null||u===void 0?void 0:u.get(0);return v==="func"||c=="func"?void 0:f&&Array.isArray(f[0])?f[0].map(function(O){return gc(s,[O],o,e,v,r)}):gc(s,f,o,e,v,r)}if(n==="group"||n==="rule_group"){var g=t.get("not"),m=t.get("conjunction");m||(m=Dn(e));var E=a.get("children1");return ag(E,m,g,yc,e,r)}}}var hi=y(80045);function Ec(a,e,r,n,t,i,u){try{var o=a[i](u),s=o.value}catch(c){r(c);return}o.done?e(s):Promise.resolve(s).then(n,t)}function ig(a){return function(){var e=this,r=arguments;return new Promise(function(n,t){var i=a.apply(e,r);function u(s){Ec(i,n,t,u,o,"next",s)}function o(s){Ec(i,n,t,u,o,"throw",s)}u(void 0)})}}var og=["title","value","disabled","groupTitle","grouplabel","renderTitle","children","label","isCustom","isHidden"];function ug(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=sg(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function sg(a,e){if(a){if(typeof a=="string")return Sc(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sc(a,e)}}function Sc(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}function Oc(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Ta(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Oc(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Oc(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var lg=function(e,r){if(e.findLastIndex)return e.findLastIndex(r);var n=(0,we.A)(e).reverse().findIndex(r);return n==-1?-1:e.length-1-n},cg=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;return function(){var t=ig(mn().mark(function i(u,o,s){var c,f,d,v,g,m,E,O;return mn().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(c=s?.pageSize!=null?s.pageSize:r,f=ce(e).filter(function(P){var F=P.title,k=P.value;return u==null?!0:F.toUpperCase().indexOf(u.toUpperCase())!=-1||"".concat(k).toUpperCase().indexOf(u.toUpperCase())!=-1}),d=c?Math.ceil(f.length/c):0,v=o||0,g=c?Math.ceil(v/c):null,m=c?f.slice(v,v+c):f,E=c?v+m.length:null,O=c?E<f.length:!1,!n){w.next=11;break}return w.next=11,ji(n);case 11:return w.abrupt("return",{values:m,hasMore:O});case 12:case"end":return w.stop()}},i)}));return function(i,u,o){return t.apply(this,arguments)}}()},fg=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!r)return e;var i=e||[],u=r.filter(function(s){return i.find(function(c){return""+c.value==""+s.value})==null}).map(function(s){return t?Ta(Ta({},s),{},{isHidden:!0}):s}),o=n?[].concat((0,we.A)(u),(0,we.A)(i)):[].concat((0,we.A)(i),(0,we.A)(u));return o},dg=function(e,r,n){var t,i=e==null||e==""?void 0:(t=e?.value)!==null&&t!==void 0?t:e,u=cr(i,r),o=n&&!u?ne(i):void 0,s=u||o,c=s?[s]:void 0;return[i,c]},pg=function(e,r,n){var t=e.map(function(u,o){var s,c=u==null||u==""?void 0:(s=u?.value)!==null&&s!==void 0?s:u,f=cr(c,r),d=n&&!f?ne(c):void 0,v=f||d;return v}).filter(function(u){return u!=null}),i=t.map(function(u){var o;return(o=u?.value)!==null&&o!==void 0?o:u});return i.length||(i=void 0),[i,t]},vg=function(e){if(e==null)return null;var r=e.title,n=e.value,t=e.disabled,i=e.groupTitle,u=e.grouplabel,o=e.renderTitle,s=e.children,c=e.label,f=e.isCustom,d=e.isHidden,v=(0,hi.A)(e,og),g={value:n,title:r||c||s};return t&&(g.disabled=t),f&&(g.isCustom=f),d&&(g.isHidden=d),(i||u)&&(g.groupTitle=i||u),o&&(g.renderTitle=o),g=Ta(Ta({},g),v),g},gg=function(e){var r=[],n=[],t=ug(e),i;try{var u=function(){var s=i.value,c=lg(r,function(f){var d,v;return((d=f.groupTitle)!==null&&d!==void 0?d:"")==((v=s.groupTitle)!==null&&v!==void 0?v:"")});s.groupTitle!=null&&!n.includes(s.groupTitle)&&(n.push(s.groupTitle),n.length===1&&(r=r.map(function(f){return Ta(Ta({},f),{},{groupTitle:""})}))),s.groupTitle==null&&n.length&&(s=Ta(Ta({},s),{},{groupTitle:""})),c!=-1?r.splice(c+1,0,s):r.push(s)};for(t.s();!(i=t.n()).done;)u()}catch(o){t.e(o)}finally{t.f()}return r},mg={label:"Now",returnType:"datetime",jsonLogic:"now",jsonLogicCustomOps:{now:{}},spelFunc:"T(java.time.LocalDateTime).now()",sqlFormatFunc:function(){return"NOW()"},mongoFormatFunc:function(){return new Date},formatFunc:function(){return"NOW"}},hg={label:"Relative",returnType:"datetime",renderBrackets:["",""],renderSeps:["","",""],spelFormatFunc:function(e){var r=e.date,n=e.op,t=e.val,i=e.dim,u=i.charAt(0).toUpperCase()+i.slice(1)+"s",o=n+u;return"".concat(r,".").concat(o,"(").concat(t,")")},spelImport:function(e){var r,n,t,i,u,o=(r=e.methodName)===null||r===void 0?void 0:r.match(/^(minus|plus)(\w+)s$/);if(o&&(u=o[2].toLowerCase(),t=o[1],["minus","plus"].includes(t)&&["day","week","month","year"].includes(u)))return t={type:"string",val:t},u={type:"string",val:u},i=e.args[0],n=e.obj,{date:n,op:t,val:i,dim:u}},jsonLogic:function(e){var r=e.date,n=e.op,t=e.val,i=e.dim;return{date_add:[r,t*(n=="minus"?-1:1),i]}},jsonLogicImport:function(e){var r=e.date_add[0],n=Math.abs(e.date_add[1]),t=e.date_add[1]>=0?"plus":"minus",i=e.date_add[2];return[r,t,n,i]},jsonLogicCustomOps:{date_add:{}},sqlFormatFunc:function(e){var r=e.date,n=e.op,t=e.val,i=e.dim;return"DATE_ADD(".concat(r,", INTERVAL ").concat(parseInt(t)*(n=="minus"?-1:1)," ").concat(i.replace(/^'|'$/g,""),")")},mongoFormatFunc:null,formatFunc:function(e){var r=e.date,n=e.op,t=e.val,i=e.dim;return t?"".concat(r," ").concat(n=="minus"?"-":"+"," ").concat(t," ").concat(i):r},args:{date:{label:"Date",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["func","field","value"],spelEscapeForFormat:!0},op:{label:"Op",type:"select",defaultValue:"plus",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{plus:"+",minus:"-"}},spelEscapeForFormat:!1},val:{label:"Value",type:"number",fieldSettings:{min:0},defaultValue:0,valueSources:["value"],spelEscapeForFormat:!1},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{day:"day",week:"week",month:"month",year:"year"}},spelEscapeForFormat:!1}}},yg={label:"Lowercase",mongoFunc:"$toLower",jsonLogic:"toLowerCase",spelFunc:"${str}.toLowerCase()",jsonLogicCustomOps:{toLowerCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Eg={label:"Uppercase",mongoFunc:"$toUpper",jsonLogic:"toUpperCase",spelFunc:"${str}.toUpperCase()",jsonLogicCustomOps:{toUpperCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Sg={label:"Linear regression",returnType:"number",formatFunc:function(e,r){var n=e.coef,t=e.bias,i=e.val;return"(".concat(n," * ").concat(i," + ").concat(t,")")},sqlFormatFunc:function(e){var r=e.coef,n=e.bias,t=e.val;return"(".concat(r," * ").concat(t," + ").concat(n,")")},spelFormatFunc:function(e){var r=e.coef,n=e.bias,t=e.val;return"(".concat(r," * ").concat(t," + ").concat(n,")")},spelImport:function(e){var r,n,t,i;if(e.type==="op-plus"){var u=(0,qe.A)(e.children,2);if(i=u[0],t=u[1],i.type==="op-multiply"){var o=(0,qe.A)(i.children,2);return r=o[0],n=o[1],{coef:r,val:n,bias:t}}}},mongoFormatFunc:function(e){var r=e.coef,n=e.bias,t=e.val;return{$sum:[{$multiply:[r,t]},n]}},jsonLogic:function(e){var r=e.coef,n=e.bias,t=e.val;return{"+":[{"*":[r,t]},n]}},jsonLogicImport:function(e){var r=e["+"][0]["*"][0],n=e["+"][0]["*"][1],t=e["+"][1];return[r,n,t]},renderBrackets:["",""],renderSeps:[" * "," + "],args:{coef:{label:"Coef",type:"number",defaultValue:1,valueSources:["value"]},val:{label:"Value",type:"number",valueSources:["value","field"]},bias:{label:"Bias",type:"number",defaultValue:0,valueSources:["value"]}}},Og=function(e,r,n,t,i,u,o,s,c,f,d,v){var g=typeof t=="string"&&!t.startsWith("$")?"$"+t:t,m=r(u,v);if(m!==void 0)return n?!o&&(!e||e=="$eq")?(0,Se.A)({},t,{$ne:m}):o?{$not:(0,Se.A)({},e,[g,m])}:(0,Se.A)({},t,{$not:(0,Se.A)({},e,m)}):!o&&(!e||e=="$eq")?(0,Se.A)({},t,m):o?(0,Se.A)({},e,[g,m]):(0,Se.A)({},t,(0,Se.A)({},e,m))},Tg=function(e,r,n,t,i,u,o,s,c,f,d){var v=typeof n=="string"&&!n.startsWith("$")?"$"+n:n;if(r){var g;return u?{$not:{$and:[(0,Se.A)({},e[0],[v,i[0]]),(0,Se.A)({},e[1],[v,i[1]])]}}:(0,Se.A)({},n,{$not:(g={},(0,Se.A)(g,e[0],i[0]),(0,Se.A)(g,e[1],i[1]),g)})}else{var m;return u?{$and:[(0,Se.A)({},e[0],[v,i[0]]),(0,Se.A)({},e[1],[v,i[1]])]}:(0,Se.A)({},n,(m={},(0,Se.A)(m,e[0],i[0]),(0,Se.A)(m,e[1],i[1]),m))}},Ag={utils:{SqlString:Ea,moment:ya(),mongoFormatOp1:Og,mongoFormatOp2:Tg,mongoEmptyValue:Ns,escapeRegExp:Vi,sqlEmptyValue:Fs,stringifyForDisplay:Ps,getTitleInListValues:ve,spelEscape:di,spelFixList:ws}};const Rg=Ag;function Cg(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=Lg(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function Lg(a,e){if(a){if(typeof a=="string")return Tc(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tc(a,e)}}function Tc(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}function Ac(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Nr(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ac(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Ac(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var Ig={AND:{label:"And",mongoConj:"$and",jsonLogicConj:"and",sqlConj:"AND",spelConj:"and",spelConjs:["and","&&"],reversedConj:"OR",formatConj:function(e,r,n,t){return e.size>1?(n?"NOT ":"")+"("+e.join(" "+(t?"AND":"&&")+" ")+")":(n?"NOT (":"")+e.first()+(n?")":"")},sqlFormatConj:function(e,r,n){return e.size>1?(n?"NOT ":"")+"("+e.join(" AND ")+")":(n?"NOT (":"")+e.first()+(n?")":"")},spelFormatConj:function(e,r,n,t){return n&&(t=!1),e.size>1?(n?"!":"")+(t?"":"(")+e.join(" && ")+(t?"":")"):(n?"!(":"")+e.first()+(n?")":"")}},OR:{label:"Or",mongoConj:"$or",jsonLogicConj:"or",sqlConj:"OR",spelConj:"or",spelConjs:["or","||"],reversedConj:"AND",formatConj:function(e,r,n,t){return e.size>1?(n?"NOT ":"")+"("+e.join(" "+(t?"OR":"||")+" ")+")":(n?"NOT (":"")+e.first()+(n?")":"")},sqlFormatConj:function(e,r,n){return e.size>1?(n?"NOT ":"")+"("+e.join(" OR ")+")":(n?"NOT (":"")+e.first()+(n?")":"")},spelFormatConj:function(e,r,n,t){return n&&(t=!1),e.size>1?(n?"!":"")+(t?"":"(")+e.join(" || ")+(t?"":")"):(n?"!(":"")+e.first()+(n?")":"")}}},bg={equal:{label:"==",labelForFormat:"==",sqlOp:"=",spelOp:"==",spelOps:["==","eq"],reversedOp:"not_equal",formatOp:function(e,r,n,t,i,u,o,s,c){var f=s?"=":u.label;return i=="boolean"&&s?n=="No"?"NOT ".concat(e):"".concat(e):"".concat(e," ").concat(f," ").concat(n)},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(i){return i},!1].concat(n))},jsonLogic:"==",elasticSearchQueryType:"term"},not_equal:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",spelOp:"!=",spelOps:["!=","ne"],reversedOp:"equal",formatOp:function(e,r,n,t,i,u,o,s,c){return i=="boolean"&&s?n=="No"?"".concat(e):"NOT ".concat(e):"".concat(e," ").concat(u.label," ").concat(n)},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(i){return i},!1].concat(n))},jsonLogic:"!="},less:{label:"<",labelForFormat:"<",sqlOp:"<",spelOp:"<",spelOps:["<","lt"],reversedOp:"greater_or_equal",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$lt",function(i){return i},!1].concat(n))},jsonLogic:"<",elasticSearchQueryType:"range"},less_or_equal:{label:"<=",labelForFormat:"<=",sqlOp:"<=",spelOp:"<=",spelOps:["<=","le"],reversedOp:"greater",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$lte",function(i){return i},!1].concat(n))},jsonLogic:"<=",elasticSearchQueryType:"range"},greater:{label:">",labelForFormat:">",sqlOp:">",spelOp:">",spelOps:[">","gt"],reversedOp:"less_or_equal",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(i){return i},!1].concat(n))},jsonLogic:">",elasticSearchQueryType:"range"},greater_or_equal:{label:">=",labelForFormat:">=",sqlOp:">=",spelOp:">=",spelOps:[">=","ge"],reversedOp:"less",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$gte",function(i){return i},!1].concat(n))},jsonLogic:">=",elasticSearchQueryType:"range"},like:{label:"Contains",labelForFormat:"Contains",reversedOp:"not_like",sqlOp:"LIKE",spelOp:"${0}.contains(${1})",valueTypes:["text"],mongoFormatOp:function(){for(var e,r=this,n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?r.utils.escapeRegExp(u):void 0},!1].concat(t))},jsonLogic:"in",_jsonLogicIsRevArgs:!0,valueSources:["value"],elasticSearchQueryType:"regexp"},not_like:{isNotOp:!0,label:"Not contains",reversedOp:"like",labelForFormat:"Not Contains",sqlOp:"NOT LIKE",mongoFormatOp:function(){for(var e,r=this,n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?r.utils.escapeRegExp(u):void 0},!0].concat(t))},valueSources:["value"]},starts_with:{label:"Starts with",labelForFormat:"Starts with",sqlOp:"LIKE",spelOp:"${0}.startsWith(${1})",mongoFormatOp:function(){for(var e,r=this,n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?"^"+r.utils.escapeRegExp(u):void 0},!1].concat(t))},jsonLogic:void 0,valueSources:["value"]},ends_with:{label:"Ends with",labelForFormat:"Ends with",sqlOp:"LIKE",spelOp:"${0}.endsWith(${1})",mongoFormatOp:function(){for(var e,r=this,n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?r.utils.escapeRegExp(u)+"$":void 0},!1].concat(t))},jsonLogic:void 0,valueSources:["value"]},between:{label:"Between",labelForFormat:"BETWEEN",sqlOp:"BETWEEN",cardinality:2,formatOp:function(e,r,n,t,i,u,o,s){var c=n.first(),f=n.get(1);return s?"".concat(e," BETWEEN ").concat(c," AND ").concat(f):"".concat(e," >= ").concat(c," && ").concat(e," <= ").concat(f)},spelFormatOp:function(e,r,n,t,i,u,o,s){var c=n[0],f=n[1];return"".concat(e," >= ").concat(c," && ").concat(e," <= ").concat(f)},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!1].concat(n))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"not_between",jsonLogic:"<=",validateValues:function(e){return e[0]!=null&&e[1]!=null?e[0]<=e[1]?null:"Invalid range":null},elasticSearchQueryType:function(e){return e==="time"?"filter":"range"}},not_between:{isNotOp:!0,label:"Not between",labelForFormat:"NOT BETWEEN",sqlOp:"NOT BETWEEN",cardinality:2,formatOp:function(e,r,n,t,i,u,o,s){var c=n.first(),f=n.get(1);return s?"".concat(e," NOT BETWEEN ").concat(c," AND ").concat(f):"(".concat(e," < ").concat(c," || ").concat(e," > ").concat(f,")")},spelFormatOp:function(e,r,n,t,i,u,o,s){var c=n[0],f=n[1];return"(".concat(e," < ").concat(c," || ").concat(e," > ").concat(f,")")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!0].concat(n))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"between",validateValues:function(e){return e[0]!=null&&e[1]!=null?e[0]<=e[1]?null:"Invalid range":null}},is_empty:{label:"Is empty",labelForFormat:"IS EMPTY",cardinality:0,reversedOp:"is_not_empty",formatOp:function(e,r,n,t,i,u,o,s){return s?"".concat(e," IS EMPTY"):"!".concat(e)},sqlFormatOp:function(e,r,n,t,i,u,o,s){var c=this.utils.sqlEmptyValue(s);return"COALESCE(".concat(e,", ").concat(c,") = ").concat(c)},spelFormatOp:function(e,r,n,t,i,u,o,s){return"".concat(e," <= ''")},mongoFormatOp:function(){for(var e,r=this,n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(u,o){return[r.utils.mongoEmptyValue(o),null]},!1].concat(t))},jsonLogic:"!"},is_not_empty:{isNotOp:!0,label:"Is not empty",labelForFormat:"IS NOT EMPTY",cardinality:0,reversedOp:"is_empty",formatOp:function(e,r,n,t,i,u,o,s){return s?"".concat(e," IS NOT EMPTY"):"!!".concat(e)},sqlFormatOp:function(e,r,n,t,i,u,o,s){var c=this.utils.sqlEmptyValue(s);return"COALESCE(".concat(e,", ").concat(c,") <> ").concat(c)},spelFormatOp:function(e,r,n,t,i,u,o,s){return"".concat(e," > ''")},mongoFormatOp:function(){for(var e,r=this,n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(u,o){return[r.utils.mongoEmptyValue(o),null]},!1].concat(t))},jsonLogic:"!!",elasticSearchQueryType:"exists"},is_null:{label:"Is null",labelForFormat:"IS NULL",sqlOp:"IS NULL",cardinality:0,reversedOp:"is_not_null",formatOp:function(e,r,n,t,i,u,o,s){return s?"".concat(e," IS NULL"):"!".concat(e)},spelFormatOp:function(e,r,n,t,i,u,o,s){return"".concat(e," == null")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(i){return null},!1].concat(n))},jsonLogic:"=="},is_not_null:{label:"Is not null",labelForFormat:"IS NOT NULL",sqlOp:"IS NOT NULL",cardinality:0,reversedOp:"is_null",formatOp:function(e,r,n,t,i,u,o,s){return s?"".concat(e," IS NOT NULL"):"!!".concat(e)},spelFormatOp:function(e,r,n,t,i,u,o,s){return"".concat(e," != null")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(i){return null},!1].concat(n))},jsonLogic:"!=",elasticSearchQueryType:"exists"},select_equals:{label:"==",labelForFormat:"==",sqlOp:"=",formatOp:function(e,r,n,t,i,u,o,s){var c=s?"=":"==";return"".concat(e," ").concat(c," ").concat(n)},spelOp:"==",spelOps:["==","eq"],mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(i){return i},!1].concat(n))},reversedOp:"select_not_equals",jsonLogic:"==",elasticSearchQueryType:"term"},select_not_equals:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,r,n,t,i,u,o,s){return"".concat(e," != ").concat(n)},spelOp:"!=",spelOps:["!=","ne"],mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(i){return i},!1].concat(n))},reversedOp:"select_equals",jsonLogic:"!="},select_any_in:{label:"Any in",labelForFormat:"IN",sqlOp:"IN",formatOp:function(e,r,n,t,i,u,o,s){return t=="value"?"".concat(e," IN (").concat(n.join(", "),")"):"".concat(e," IN (").concat(n,")")},sqlFormatOp:function(e,r,n,t,i,u,o,s){if(t=="value")return"".concat(e," IN (").concat(n.join(", "),")")},valueTypes:["multiselect"],spelOp:"${1}.contains(${0})",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(i){return i},!1].concat(n))},reversedOp:"select_not_any_in",jsonLogic:"in",elasticSearchQueryType:"term"},select_not_any_in:{isNotOp:!0,label:"Not in",labelForFormat:"NOT IN",sqlOp:"NOT IN",formatOp:function(e,r,n,t,i,u,o,s){return t=="value"?"".concat(e," NOT IN (").concat(n.join(", "),")"):"".concat(e," NOT IN (").concat(n,")")},sqlFormatOp:function(e,r,n,t,i,u,o,s){if(t=="value")return"".concat(e," NOT IN (").concat(n.join(", "),")")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(i){return i},!1].concat(n))},reversedOp:"select_any_in"},multiselect_contains:{label:"Contains",labelForFormat:"CONTAINS",formatOp:function(e,r,n,t,i,u,o,s){return t=="value"?"".concat(e," CONTAINS [").concat(n.join(", "),"]"):"".concat(e," CONTAINS ").concat(n)},reversedOp:"multiselect_not_contains",jsonLogic2:"some-in",jsonLogic:function(e,r,n){return{some:[e,{in:[{var:""},n]}]}},spelOp:"T(CollectionUtils).containsAny(${0}, ${1})",elasticSearchQueryType:"term",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(i){return i},!1].concat(n))}},multiselect_not_contains:{isNotOp:!0,label:"Not contains",labelForFormat:"NOT CONTAINS",formatOp:function(e,r,n,t,i,u,o,s){return t=="value"?"".concat(e," NOT CONTAINS [").concat(n.join(", "),"]"):"".concat(e," NOT CONTAINS ").concat(n)},reversedOp:"multiselect_contains"},multiselect_equals:{label:"Equals",labelForFormat:"==",sqlOp:"=",formatOp:function(e,r,n,t,i,u,o,s){var c=s?"=":"==";return t=="value"?"".concat(e," ").concat(c," [").concat(n.join(", "),"]"):"".concat(e," ").concat(c," ").concat(n)},sqlFormatOp:function(e,r,n,t,i,u,o,s){var c=this;if(t=="value")return"".concat(e," = '").concat(n.map(function(f){return c.utils.SqlString.trim(f)}).join(","),"'")},spelOp:"${0}.equals(${1})",mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(i){return i},!1].concat(n))},reversedOp:"multiselect_not_equals",jsonLogic2:"all-in",jsonLogic:function(e,r,n){return{all:[e,{in:[{var:""},n]}]}},elasticSearchQueryType:"term"},multiselect_not_equals:{isNotOp:!0,label:"Not equals",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,r,n,t,i,u,o,s){return t=="value"?"".concat(e," != [").concat(n.join(", "),"]"):"".concat(e," != ").concat(n)},sqlFormatOp:function(e,r,n,t,i,u,o,s){var c=this;if(t=="value")return"".concat(e," != '").concat(n.map(function(f){return c.utils.SqlString.trim(f)}).join(","),"'")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(i){return i},!1].concat(n))},reversedOp:"multiselect_equals"},proximity:{label:"Proximity search",cardinality:2,valueLabels:[{label:"Word 1",placeholder:"Enter first word"},{label:"Word 2",placeholder:"Enter second word"}],textSeparators:[],formatOp:function(e,r,n,t,i,u,o,s){var c=n.first(),f=n.get(1),d=o.get("proximity");return"".concat(e," ").concat(c," NEAR/").concat(d," ").concat(f)},sqlFormatOp:function(e,r,n,t,i,u,o,s){var c=n.first(),f=n.get(1),d=this.utils.SqlString.trim(c),v=this.utils.SqlString.trim(f),g=o.get("proximity");return"CONTAINS(".concat(e,", 'NEAR((").concat(d,", ").concat(v,"), ").concat(g,")')")},mongoFormatOp:void 0,jsonLogic:void 0,options:{optionLabel:"Near",optionTextBefore:"Near",optionPlaceholder:"Select words between",minProximity:2,maxProximity:10,defaults:{proximity:2}}},some:{label:"Some",labelForFormat:"SOME",cardinality:0,jsonLogic:"some",spelFormatOp:function(e){return"".concat(e," > 0")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(i){return 0},!1].concat(n))}},all:{label:"All",labelForFormat:"ALL",cardinality:0,jsonLogic:"all",spelFormatOp:function(e,r,n){return"".concat(e," == ").concat(n)},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(i){return i},!1].concat(n))}},none:{label:"None",labelForFormat:"NONE",cardinality:0,jsonLogic:"none",spelFormatOp:function(e){return"".concat(e," == 0")},mongoFormatOp:function(){for(var e,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(i){return 0},!1].concat(n))}}},Fg={text:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"String",valuePlaceholder:"Enter string",formatValue:function(e,r,n,t){return t?this.utils.stringifyForDisplay(e):JSON.stringify(e)},spelFormatValue:function(e,r,n,t,i){return this.utils.spelEscape(e)},sqlFormatValue:function(e,r,n,t,i){return i.sqlOp=="LIKE"||i.sqlOp=="NOT LIKE"?this.utils.SqlString.escapeLike(e,t!="starts_with",t!="ends_with"):this.utils.SqlString.escape(e)},toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e}},textarea:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"Text",valuePlaceholder:"Enter text",formatValue:function(e,r,n,t){return t?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,r,n,t,i){return i.sqlOp=="LIKE"||i.sqlOp=="NOT LIKE"?this.utils.SqlString.escapeLike(e,t!="starts_with",t!="ends_with"):this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e},fullWidth:!0},number:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,r,n,t){return t?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,r,n,t,i){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,r,n){var t=n.step&&!Number.isInteger(n.step);return this.utils.spelEscape(e,t)},toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e}},slider:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number or move slider",formatValue:function(e,r,n,t){return t?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,r,n,t,i){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e}},select:{type:"select",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,r,n,t){var i=this.utils.getTitleInListValues(r.fieldSettings.listValues||r.asyncListValues,e);return t?this.utils.stringifyForDisplay(i):JSON.stringify(e)},sqlFormatValue:function(e,r,n,t,i){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e}},multiselect:{type:"multiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,r,n,t){var i=this,u=e.map(function(o){return i.utils.getTitleInListValues(r.fieldSettings.listValues||r.asyncListValues,o)});return t?u.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,r,n,t,i){var u=this;return e.map(function(o){return u.utils.SqlString.escape(o)})},spelFormatValue:function(e,r,n,t,i){var u=i.spelOp&&i.spelOp.startsWith("${1}"),o=this.utils.spelEscape(e);return u&&(o=this.utils.spelFixList(o)),o},toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e}},date:{type:"date",jsType:"string",valueSrc:"value",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD",valueLabel:"Date",valuePlaceholder:"Enter date",valueLabels:[{label:"Date from",placeholder:"Enter date from"},{label:"Date to",placeholder:"Enter date to"}],formatValue:function(e,r,n,t){var i=this.utils.moment(e,n.valueFormat);return t?i.format(n.dateFormat):JSON.stringify(e)},sqlFormatValue:function(e,r,n,t,i){var u=this.utils.moment(e,n.valueFormat);return this.utils.SqlString.escape(u.format("YYYY-MM-DD"))},spelFormatValue:function(e,r,n,t,i){var u=this.utils.moment(e,n.valueFormat),o=u.format("YYYY-MM-DD"),s="yyyy-MM-dd";return"T(java.time.LocalDate).parse('".concat(o,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat(s,"'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDate"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,r,n){var t,i,u,o;if(!r)return[void 0,"No widget def to get value format"];if(n!=null&&(t=n.fmt)!==null&&t!==void 0&&(t=t.value)!==null&&t!==void 0&&(i=t.includes)!==null&&i!==void 0&&i.call(t," ")||(u=n.fmt)!==null&&u!==void 0&&(u=u.value)!==null&&u!==void 0&&(o=u.toLowerCase)!==null&&o!==void 0&&o.call(u).includes("hh:mm"))return[void 0,"Invalid date format ".concat(JSON.stringify(n.fmt))];var s=this.utils.moment(e.value,this.utils.moment.ISO_8601);return s.isValid()?[s.format(r?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,r,n){return this.utils.moment(e,n.valueFormat).toDate()},toJS:function(e,r){var n=this.utils.moment(e,r.valueFormat);return n.isValid()?n.toDate():void 0},mongoFormatValue:function(e,r,n){var t=this.utils.moment(e,n.valueFormat);return t.isValid()?t.toDate():void 0}},time:{type:"time",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",valueFormat:"HH:mm:ss",use12Hours:!1,valueLabel:"Time",valuePlaceholder:"Enter time",valueLabels:[{label:"Time from",placeholder:"Enter time from"},{label:"Time to",placeholder:"Enter time to"}],formatValue:function(e,r,n,t){var i=this.utils.moment(e,n.valueFormat);return t?i.format(n.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,r,n,t,i){var u=this.utils.moment(e,n.valueFormat);return this.utils.SqlString.escape(u.format("HH:mm:ss"))},spelFormatValue:function(e,r,n,t,i){var u=this.utils.moment(e,n.valueFormat),o="HH:mm:ss",s=u.format("HH:mm:ss");return"T(java.time.LocalTime).parse('".concat(s,"')")},spelImportFuncs:["T(java.time.LocalTime).parse(${v})"],spelImportValue:function(e,r,n){var t,i,u;if(!r)return[void 0,"No widget def to get value format"];if(n!=null&&n.fmt&&(!((t=n.fmt)!==null&&t!==void 0&&(t=t.value)!==null&&t!==void 0&&(i=t.toLowerCase)!==null&&i!==void 0&&i.call(t).includes("hh:mm"))||(u=n.fmt)!==null&&u!==void 0&&(u=u.value)!==null&&u!==void 0&&u.includes(" ")))return[void 0,"Invalid time format ".concat(JSON.stringify(n.fmt))];var o=this.utils.moment(e.value,"HH:mm:ss");return o.isValid()?[o.format(r?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,r,n){var t=this.utils.moment(e,n.valueFormat);return t.get("hour")*60*60+t.get("minute")*60+t.get("second")},toJS:function(e,r){var n=this.utils.moment(e,r.valueFormat);return n.isValid()?n.get("hour")*60*60+n.get("minute")*60+n.get("second"):void 0},mongoFormatValue:function(e,r,n){var t=this.utils.moment(e,n.valueFormat);return t.get("hour")*60*60+t.get("minute")*60+t.get("second")},elasticSearchFormatValue:function(e,r,n,t){return{script:{script:{source:"doc[".concat(t,"][0].getHour() >== params.min && doc[").concat(t,"][0].getHour() <== params.max"),params:{min:r[0],max:r[1]}}}}}},datetime:{type:"datetime",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD HH:mm:ss",use12Hours:!1,valueLabel:"Datetime",valuePlaceholder:"Enter datetime",valueLabels:[{label:"Datetime from",placeholder:"Enter datetime from"},{label:"Datetime to",placeholder:"Enter datetime to"}],formatValue:function(e,r,n,t){var i=this.utils.moment(e,n.valueFormat);return t?i.format(n.dateFormat+" "+n.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,r,n,t,i){var u=this.utils.moment(e,n.valueFormat);return this.utils.SqlString.escape(u.toDate())},spelFormatValue:function(e,r,n,t,i){var u=this.utils.moment(e,n.valueFormat),o=u.format("YYYY-MM-DD HH:mm:ss"),s="yyyy-MM-dd HH:mm:ss";return"T(java.time.LocalDateTime).parse('".concat(o,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat(s,"'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDateTime"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,r,n){var t,i;if(!r)return[void 0,"No widget def to get value format"];if(!(n!=null&&(t=n.fmt)!==null&&t!==void 0&&(t=t.value)!==null&&t!==void 0&&(i=t.includes)!==null&&i!==void 0&&i.call(t," ")))return[void 0,"Invalid datetime format ".concat(JSON.stringify(n.fmt))];var u=this.utils.moment(e.value,this.utils.moment.ISO_8601);return u.isValid()?[u.format(r?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,r,n){return this.utils.moment(e,n.valueFormat).toDate()},toJS:function(e,r){var n=this.utils.moment(e,r.valueFormat);return n.isValid()?n.toDate():void 0},mongoFormatValue:function(e,r,n){var t=this.utils.moment(e,n.valueFormat);return t.isValid()?t.toDate():void 0}},boolean:{type:"boolean",jsType:"boolean",valueSrc:"value",labelYes:"Yes",labelNo:"No",formatValue:function(e,r,n,t){return t?e?"Yes":"No":JSON.stringify(!!e)},sqlFormatValue:function(e,r,n,t,i){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,r,n,t,i){return this.utils.spelEscape(e)},defaultValue:!1,toJS:function(e,r){return e},mongoFormatValue:function(e,r,n){return e}},field:{valueSrc:"field",formatValue:function(e,r,n,t,i,u,o){return t&&o.label||e},sqlFormatValue:function(e,r,n,t,i,u){return e},spelFormatValue:function(e,r,n,t,i){return e},valueLabel:"Field to compare",valuePlaceholder:"Select field to compare"},func:{valueSrc:"func",valueLabel:"Function",valuePlaceholder:"Select function"},case_value:{valueSrc:"value",type:"case_value",spelFormatValue:function(e){return this.utils.spelEscape(e===""?null:e)},spelImportValue:function(e){return[e.value,[]]}}},Ng={text:{defaultOperator:"equal",mainWidget:"text",widgets:{text:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","proximity","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},textarea:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},field:{operators:["equal","not_equal","proximity"]}}},number:{defaultOperator:"equal",mainWidget:"number",widgets:{number:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},slider:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"]}}},date:{defaultOperator:"equal",widgets:{date:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},time:{defaultOperator:"equal",widgets:{time:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},datetime:{defaultOperator:"equal",widgets:{datetime:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},select:{mainWidget:"select",defaultOperator:"select_equals",widgets:{select:{operators:["select_equals","select_not_equals","is_null","is_not_null"]},multiselect:{operators:["select_any_in","select_not_any_in","is_null","is_not_null"]}}},multiselect:{defaultOperator:"multiselect_equals",widgets:{multiselect:{operators:["multiselect_contains","multiselect_not_contains","multiselect_equals","multiselect_not_equals","is_null","is_not_null"]}}},boolean:{defaultOperator:"equal",widgets:{boolean:{operators:["equal","not_equal","is_null","is_not_null"],widgetProps:{}},field:{operators:["equal","not_equal"]}}},"!group":{defaultOperator:"some",mainWidget:"number",widgets:{number:{widgetProps:{min:0},operators:["some","all","none","equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between"],opProps:{equal:{label:"Count =="},not_equal:{label:"Count !="},less:{label:"Count <"},less_or_equal:{label:"Count <="},greater:{label:"Count >"},greater_or_equal:{label:"Count >="},between:{label:"Count between"},not_between:{label:"Count not between"}}}}},case_value:{mainWidget:"case_value",widgets:{case_value:{}}}},wg=Nr(Nr({},ho),{},{convertableWidgets:{number:["slider","rangeslider"],slider:["number","rangeslider"],rangeslider:["number","slider"],text:["textarea"],textarea:["text"]},formatSpelField:function(e,r,n,t,i,u){var o=this,s=t.map(function(c,f){var d=c.key,v=c.parent,g=c.fieldSeparator;return f==0?v=="[map]"?"#this[".concat(o.utils.spelEscape(d),"]"):(v=="[class]",d):v=="map"||v=="[map]"?"[".concat(o.utils.spelEscape(d),"]"):(v=="class"||v=="[class]","".concat(g).concat(d))}).join("");return i.fieldName&&(s=e),i.isSpelVariable&&(s="#"+s),s},sqlFormatReverse:function(e){if(e!=null)return"NOT("+e+")"},spelFormatReverse:function(e){if(e!=null)return"!("+e+")"},formatReverse:function(e,r,n,t,i,u){if(e!=null)return u?"NOT ("+e+")":"!("+e+")"},formatAggr:function(e,r,n,t,i,u,o,s,c,f){var d=o.labelForFormat,v=o.cardinality;if(v==0){var g=e?" HAVE ".concat(e):"";return"".concat(d," OF ").concat(r).concat(g)}else if(v==null||v==1){var m=e?" WHERE ".concat(e):"";return"COUNT OF ".concat(r).concat(m," ").concat(d," ").concat(t)}else if(v==2){var E=e?" WHERE ".concat(e):"",O=t.first(),R=t.get(1);return"COUNT OF ".concat(r).concat(E," ").concat(d," ").concat(O," AND ").concat(R)}},jsonLogic:{groupVarKey:"var",altVarKey:"var",lockedOp:"locked"},canCompareFieldWithField:function(e,r,n,t){return!0},valueSourcesInfo:{value:{label:"Value"},field:{label:"Field",widget:"field"},func:{label:"Function",widget:"func"}}}),Rc=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,t={rangeslider:Dg,treeselect:Mg,treemultiselect:Vg,rangeable__date:_g("date","date")},i=Cg(r),u;try{for(i.s();!(u=i.n()).done;){var o=u.value,s=t[o];if(s)e=s(e,n);else throw new Error("Can't ".concat(n?"add":"remove"," mixin ").concat(o))}}catch(c){i.e(c)}finally{i.f()}return e},Cc=function(e,r){return Rc(e,r,!0)},Pg=function(e,r){return Rc(e,r,!1)},_g=function(e,r){return function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.types;return i=Nr(Nr({},i),{},(0,Se.A)({},e,Nr(Nr({},i[e]),{},{widgets:Nr({},i[e].widgets)}))),t?i[e].widgets[r]=Nr({opProps:{between:{isSpecialRange:!0,textSeparators:[null,null]},not_between:{isSpecialRange:!0,textSeparators:[null,null]}}},i[e].widgets[r]):delete i[e].widgets[r],Nr(Nr({},n),{},{types:i})}},Dg=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=e.widgets,t=e.types;return n=Nr({},n),r?n.rangeslider=Nr({type:"number",jsType:"number",valueSrc:"value",valueLabel:"Range",valuePlaceholder:"Select range",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(u,o,s,c){return c?this.utils.stringifyForDisplay(u):JSON.stringify(u)},sqlFormatValue:function(u,o,s,c,f){return this.utils.SqlString.escape(u)},spelFormatValue:function(u){return this.utils.spelEscape(u)},singleWidget:"slider",toJS:function(u,o){return u}},n.rangeslider):delete n.rangeslider,t=Nr(Nr({},t),{},{number:Nr(Nr({},t.number),{},{widgets:Nr({},t.number.widgets)})}),r?t.number.widgets.rangeslider=Nr({opProps:{between:{isSpecialRange:!0},not_between:{isSpecialRange:!0}},operators:["between","not_between","is_null","is_not_null"]},t.number.widgets.rangeslider):delete t.number.widgets.rangeslider,Nr(Nr({},e),{},{widgets:n,types:t})},Mg=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=e.widgets,t=e.types;return n=Nr({},n),r?n.treeselect=Nr({type:"treeselect",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(u,o,s,c){var f=o.fieldSettings.treeValues||o.fieldSettings.listValues||o.asyncListValues,d=this.utils.getTitleInListValues(f,u);return c?this.utils.stringifyForDisplay(d):JSON.stringify(u)},sqlFormatValue:function(u,o,s,c,f){return this.utils.SqlString.escape(u)},spelFormatValue:function(u){return this.utils.spelEscape(u)},toJS:function(u,o){return u}},n.treeselect):delete n.treeselect,t=Nr({},t),r?t.treeselect=Nr({mainWidget:"treeselect",defaultOperator:"select_equals",widgets:{treeselect:{operators:["select_equals","select_not_equals"]},treemultiselect:{operators:["select_any_in","select_not_any_in"]}}},t.treeselect):delete t.treeselect,Nr(Nr({},e),{},{widgets:n,types:t})},Vg=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=e.widgets,t=e.types;return n=Nr({},n),r?n.treemultiselect=Nr({type:"treemultiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(u,o,s,c){var f=this,d=o.fieldSettings.treeValues||o.fieldSettings.listValues||o.asyncListValues,v=u.map(function(g){return f.utils.getTitleInListValues(d,g)});return c?v.map(this.utils.stringifyForDisplay):u.map(JSON.stringify)},sqlFormatValue:function(u,o,s,c,f){var d=this;return u.map(function(v){return d.utils.SqlString.escape(v)})},spelFormatValue:function(u){return this.utils.spelEscape(u)},toJS:function(u,o){return u}},n.treemultiselect):delete n.treemultiselect,t=Nr({},t),r?t.treemultiselect=Nr({defaultOperator:"multiselect_equals",widgets:{treemultiselect:{operators:["multiselect_equals","multiselect_not_equals"]}}},t.treemultiselect):delete t.treemultiselect,Nr(Nr({},e),{},{widgets:n,types:t})},jg={addMixins:Cc,removeMixins:Pg},ku={conjunctions:Ig,operators:bg,widgets:Fg,types:Ng,settings:wg,ctx:Rg};ku=Cc(ku,["rangeslider","treeselect","treemultiselect"]);const rt=ku;var Lc="ADD_GROUP",xu="ADD_CASE_GROUP",Ic="REMOVE_GROUP",bc="SET_CONJUNCTION",Fc="SET_NOT",Nc="ADD_RULE",wc="REMOVE_RULE",Pc="SET_FIELD",_c="SET_FIELD_SRC",Dc="SET_OPERATOR",Mc="SET_VALUE",Vc="SET_VALUE_SRC",jc="SET_OPERATOR_OPTION",kc="SET_LOCK",Uu="SET_TREE",xc="MOVE_ITEM",Uc="after",Gc="before",Gu="append",Bu="prepend",Bc="SET_DRAG_PROGRESS",Wc="SET_DRAG_START",$c="SET_DRAG_END",kg=y(73916),Fo=y.n(kg);function Hc(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=xg(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function xg(a,e){if(a){if(typeof a=="string")return Kc(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kc(a,e)}}function Kc(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}function Yc(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Mn(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yc(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Yc(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var zc=function(e,r,n,t,i,u){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},c=u.settings.shouldCreateEmptyGroup,f=r.push(t),d=!c,v=!!(s!=null&&s.isDefaultCase),g=e;return e=Ba(e,r,n,t,Sa(u).merge(i||{}),u,o),e!==g&&(!o&&!v&&(e=e.setIn(Ce(f,"children1"),new(Me()).OrderedMap),d&&(e=Ba(e,f,"rule",_r(),_n(u),u))),e=Xn(e)),e},Ug=function(e,r,n){e=Wu(e,r);var t=n.settings.canLeaveEmptyGroup,i=r.slice(0,-1),u=!iu(e,i);if(u&&!t&&(e=Eo(e),au(e)&&!t)){var o=!1,s=!1;e=Ba(e,new(Me()).List,"rule",_r(),_n(n,void 0,void 0,o,s),n)}return e=Xn(e),e},Gg=function(e,r,n){e=Wu(e,r);var t=n.settings.canLeaveEmptyGroup,i=r.pop(),u=e.getIn(Ce(i)),o=u.getIn(["properties","field"]),s=u.getIn(["properties","operator"]),c=u.getIn(["properties","value",0]),f=o?ze(n,o):null,d=s?Gr(n,s,o):null,v=o&&s&&d.cardinality!=0,g=u.get("type")=="rule_group",m=!iu(e,i),E=g?v&&f.initialEmptyWhere:t;if(m&&!E&&(g&&(e=e.deleteIn(Ce(i))),e=Eo(e),au(e)&&!t)){var O=!1,R=!1;e=Ba(e,new(Me()).List,"rule",_r(),_n(n,void 0,void 0,O,R),n)}return e=Xn(e),e},Bg=function(e,r,n){return e.setIn(Ce(r,"properties","not"),n)},Wg=function(e,r,n){return ja(e.setIn(Ce(r,"properties","isLocked"),n))},$g=function(e,r,n){return e.setIn(Ce(r,"properties","conjunction"),n)},Hg=function a(e,r,n){n&&Array.isArray(n)&&(r.children1=new(Me()).OrderedMap(n.reduce(function(t,i){var u=_r(),o=Mn(Mn({},i),{},{properties:nl(e,i).merge(i.properties||{}),id:u});return a(e,o,o.children1),Mn(Mn({},t),{},(0,Se.A)({},u,new(Me()).Map(o)))},{})))},Ba=function(e,r,n,t,i,u){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(n=="switch_group")throw new Error("Can't add switch_group programmatically");var s=u.settings,c=s.maxNumberOfCases,f=s.maxNumberOfRules,d=s.maxNesting,v=e.get("type"),g=v=="switch_group",m=e.getIn(Ce(r)),E=g?e.getIn(Ce(r.take(2))):null,O=Ce(r,"children1"),R=e.getIn(O),w=!!R&&R.size,P=w?R.size:null,F,k;n=="case_group"?(F=P,k=c):n=="group"?(F=r.size,k=d):m?.get("type")=="rule_group"||(F=nu(g?E:e),k=f);var W=k&&F?F<k:!0,q={type:n,id:t,properties:i};Hg(u,q,o);var re=n=="case_group"&&w&&R.last().get("children1")==null;if(W){var Z=new(Me()).OrderedMap((0,Se.A)({},t,new(Me()).Map(q)));if(!w)e=e.setIn(O,Z);else if(re){var J,te=R.last(),le=new(Me()).OrderedMap((J={},(0,Se.A)(J,t,new(Me()).Map(q)),(0,Se.A)(J,te.get("id"),te),J));e=e.deleteIn(Ce(O,"children1",te.get("id"))),e=e.mergeIn(O,le)}else e=e.mergeIn(O,Z);e=Xn(e)}return e},Wu=function(e,r){return e=e.deleteIn(Ce(r)),e=Xn(e),e},Kg=function(e,r,n,t,i){var u=jt(e,r),o=r.pop(),s=r.size>1?jt(e,o):null,c=s?s.get("children1"):null,f=jt(e,n),d=t==Gu||t==Bu?n:n.pop(),v=t==Gu||t==Bu?f:n.size>1?jt(e,d):null,g=v?v.get("children1"):null;if(!s||!v||!u)return e;var m=s.get("id")==v.get("id"),E=d.size<o.size&&da(d.toArray(),o.toArray().slice(0,d.size)),O=d.size>o.size&&da(o.toArray(),d.toArray().slice(0,o.size)),R=null,w=null;E?R=Me().List(o.toArray().slice(d.size)):O&&(w=Me().List(d.toArray().slice(o.size)));var P=g,F=c;return O||(F=F.delete(u.get("id"))),m?P=F:E&&(P=P.updateIn(Bt(R,"children1"),function(k){return F})),t==Gc||t==Uc?P=Me().OrderedMap().withMutations(function(k){var W=Hc(P.entries()),q;try{for(W.s();!(q=W.n()).done;){var re=(0,qe.A)(q.value,2),Z=re[0],J=re[1];Z==f.get("id")&&t==Gc&&k.set(u.get("id"),u),k.set(Z,J),Z==f.get("id")&&t==Uc&&k.set(u.get("id"),u)}}catch(te){W.e(te)}finally{W.f()}}):t==Gu?P=P.merge((0,Se.A)({},u.get("id"),u)):t==Bu&&(P=Me().OrderedMap((0,Se.A)({},u.get("id"),u)).merge(P)),O&&(F=F.updateIn(Bt(w,"children1"),function(k){return P}),F=F.delete(u.get("id"))),!m&&!E&&(e=e.updateIn(Ce(o,"children1"),function(k){return F})),O||(e=e.updateIn(Ce(d,"children1"),function(k){return P})),e=Xn(e),e},Yg=function(e,r,n,t){var i=t.settings.keepInputOnChangeFieldSrc,u=e.getIn(Ce(r)),o=u.get("type"),s=u.get("properties"),c=s.get("field"),f=s.get("fieldType"),d=ze(t,c),v=d?.type||f;(!v||v==="!group"||v==="!struct")&&(v=null);var g=!Ro.includes(v),m=i&&!Ou(u,t,!0)&&g;return m?(e=e.setIn(Ce(r,"properties","field"),null),e=e.setIn(Ce(r,"properties","fieldType"),v)):e=e.setIn(Ce(r,"properties"),_n(t,null,null,!1)),e=e.setIn(Ce(r,"properties","fieldSrc"),n),e},zg=function(e,r,n,t,i,u){var o,s;if(!n)return{tree:Wu(e,r),isInternalValueChange:s};var c=t.settings,f=c.fieldSeparator,d=c.setOpOnChangeField,v=c.showErrorMessage,g=c.keepInputOnChangeFieldSrc;Array.isArray(n)&&(n=n.join(f));var m=e.getIn(Ce(r,"type")),E=e.getIn(Ce(r,"properties")),O=m=="rule_group",R=E.get("fieldSrc"),w=ze(t,n);if(!w)return console.warn("No config for LHS ".concat(n)),{tree:e,isInternalValueChange:s};var P=w.type;(P==="!group"||P==="!struct")&&(P=null);var F=E.get("operator"),k=E.get("operatorOptions"),W=E.get("field"),q=E.get("value"),re=E.get("valueSrc",new(Me()).List),Z=E.get("valueType",new(Me()).List),J=w.type=="!group",te=J&&w.mode=="array",le=O!=J,ee=!W&&R&&F,ie=w&&((o=w.operators)===null||o===void 0?void 0:o.indexOf(F))!==-1?F:null,oe=null,pe=R==="func"?cl(t,P):Co(t,n);if(pe&&pe.length==1)oe=pe[0];else if(pe&&pe.length>1){var se=Hc(d||[]),de;try{for(se.s();!(de=se.n()).done;){var ge=de.value;if(ge=="keep"&&!le?oe=ie:ge=="default"?oe=mu(t,n,!1):ge=="first"&&(oe=Eu(t,n)),oe)break}}catch(Ze){se.e(Ze)}finally{se.f()}}if(!J&&!w.operators)return console.warn("Type ".concat(w.type," is not supported")),{tree:e,isInternalValueChange:s};if(O&&!J&&(e=e.setIn(Ce(r,"type"),"rule"),e=e.deleteIn(Ce(r,"children1")),e=e.setIn(Ce(r,"properties"),new(Me()).OrderedMap)),J){e=e.setIn(Ce(r,"type"),"rule_group");var Fe=xa(t,t,E,n,oe,"field",!0),De=Fe.canReuseValue,ke=Fe.newValue,Oe=Fe.newValueSrc,je=Fe.newValueType,Je=Fe.operatorCardinality,xe=Sa(t,w).merge({field:n,fieldSrc:"field",mode:w.mode});te&&(xe=xe.merge({operator:oe,value:ke,valueSrc:Oe,valueType:je})),e=e.setIn(Ce(r,"children1"),new(Me()).OrderedMap),e=e.setIn(Ce(r,"properties"),xe),w.initialEmptyWhere&&Je==1||(e=Ba(e,r,"rule",_r(),_n(t,n),t)),e=Xn(e)}else e=e.updateIn(Ce(r,"properties"),function(Ze){return Ze.withMutations(function(Ye){var mr=xa(t,t,Ye,n,oe,"field",!0),Or=mr.canReuseValue,tt=mr.newValue,Lt=mr.newValueSrc,st=mr.newValueType,vt=mr.newValueError;v&&(Ye=Ye.set("valueError",vt));var qt=Or?k:Wi(t,oe,n);return s=u,Ye.set("field",n).delete("fieldType").set("fieldSrc",R).set("operator",oe).set("operatorOptions",qt).set("value",tt).set("valueSrc",Lt).set("valueType",st).delete("asyncListValues")})});return{tree:e,isInternalValueChange:s}},Xg=function(e,r,n,t){var i=t.settings.showErrorMessage,u=e.getIn(Ce(r,"properties")),o=e.getIn(Ce(r,"children1")),s=u.get("field"),c=u.get("fieldSrc"),f=ze(t,s),d=f?.type=="!group",v=Gr(t,n,s),g=v?Rr(v.cardinality,1):null;return e=e.updateIn(Ce(r,"properties"),function(m){return m.withMutations(function(E){var O=E.get("field"),R=E.get("operatorOptions"),w=E.get("value",new(Me()).List),P=E.get("valueSrc",new(Me()).List),F=E.get("operator"),k=xa(t,t,E,O,n,"operator",!0),W=k.canReuseValue,q=k.newValue,re=k.newValueSrc,Z=k.newValueType,J=k.newValueError;i&&(E=E.set("valueError",J));var te=W?R:Wi(t,n,O);return W||(E=E.delete("asyncListValues")),E.set("operator",n).set("operatorOptions",te).set("value",q).set("valueSrc",re).set("valueType",Z)})}),d&&g==0&&o.size==0&&(e=Ba(e,r,"rule",_r(),_n(t,s),t)),e},qg=function(e,r,n,t,i,u,o,s){var c=u.settings,f=c.fieldSeparator,d=c.showErrorMessage,v,g=e.getIn(Ce(r,"properties","valueSrc",n+""))||null;g==="field"&&Array.isArray(t)&&(t=t.join(f));var m=e.getIn(Ce(r,"properties","field"))||null,E=e.getIn(Ce(r,"properties","operator"))||null,O=Gr(u,E,m),R=E?Rr(O.cardinality,1):null,w=!1,P=i||em(t,g,u),F=!1,k=To(u,m,m,E,t,P,g,o,F,w,!0),W=(0,qe.A)(k,2),q=W[0],re=W[1],Z=!q;if(re!==t&&(t=re),d){var J=Yr(u,m,E,g),te=kt(u,m,E,J,g),le=Array.from({length:R},function(De,ke){return e.getIn(Ce(r,"properties","valueSrc",ke+""))||null});if(O&&O.validateValues&&le.filter(function(De){return De=="value"||De==null}).length==R){var ee=Array.from({length:R},function(De,ke){return ke==n?t:e.getIn(Ce(r,"properties","value",ke+""))||null}),ie=te&&te.toJS?ee.map(function(De){return te.toJS.call(u.ctx,De,te)}):ee,oe=O.validateValues(ie);e=e.setIn(Ce(r,"properties","valueError",R),oe)}}var pe=e.getIn(Ce(r,"properties","value"));pe||(e=e.setIn(Ce(r,"properties","value"),new(Me()).List(new Array(R))).setIn(Ce(r,"properties","valueType"),new(Me()).List(new Array(R))).setIn(Ce(r,"properties","valueError"),new(Me()).List(new Array(R))));var se=e.getIn(Ce(r,"properties","value",n+"")),de=e.getIn(Ce(r,"properties","valueError",n)),ge=se==null,Fe=!!de;return(Z||d)&&(e=e.deleteIn(Ce(r,"properties","asyncListValues")),typeof t>"u"?(e=e.setIn(Ce(r,"properties","value",n+""),void 0),e=e.setIn(Ce(r,"properties","valueType",n+""),null)):(o&&(e=e.setIn(Ce(r,"properties","asyncListValues"),o)),e=e.setIn(Ce(r,"properties","value",n+""),t),e=e.setIn(Ce(r,"properties","valueType",n+""),P),v=s&&!ge&&!Fe)),d&&(e=e.setIn(Ce(r,"properties","valueError",n),q)),s&&(Z&&Fe||!Z&&!Fe)&&(e=e.setIn(Ce(r,"properties","valueError",n),q),v=!1),{tree:e,isInternalValueChange:v}},Jg=function(e,r,n,t,i){var u=i.settings.showErrorMessage,o=e.getIn(Ce(r,"properties","field"))||null,s=e.getIn(Ce(r,"properties","fieldSrc"))||null,c=e.getIn(Ce(r,"properties","operator"))||null;if(e=e.setIn(Ce(r,"properties","value",n+""),void 0),e=e.setIn(Ce(r,"properties","valueType",n+""),null),e=e.deleteIn(Ce(r,"properties","asyncListValues")),u){e=e.setIn(Ce(r,"properties","valueError",n),null);var f=Gr(i,c,o),d=c?Rr(f.cardinality,1):null;f.validateValues&&(e=e.setIn(Ce(r,"properties","valueError",d),null))}if(typeof t>"u"?e=e.setIn(Ce(r,"properties","valueSrc",n+""),null):e=e.setIn(Ce(r,"properties","valueSrc",n+""),t),t){var v=e.getIn(Ce(r,"properties")),g=xa(i,i,v,o,c,"valueSrc",!0),m=g.canReuseValue,E=g.newValue,O=g.newValueSrc,R=g.newValueType,w=g.newValueError;!m&&O.get(n)==t&&(e=e.setIn(Ce(r,"properties","value",n+""),E.get(n)),e=e.setIn(Ce(r,"properties","valueType",n+""),R.get(n)))}return e},Qg=function(e,r,n,t){return e.setIn(Ce(r,"properties","operatorOptions",n),t)},Zg=function(e,r){var n=r.settings.canLeaveEmptyGroup;return n||(e=Eo(e)),e},em=function(e,r,n){var t=null;if(e){if(r==="field"){var i=ze(n,e);i&&(t=i.type)}else if(r==="func"){var u=e.get("func");if(u){var o=Ct(n,u);o&&(t=o.returnType)}}}return t},rm=function(e,r){var n=e.getIn(Ce(r,"properties","field"))||null;return n},Xc={dragging:{id:null,x:null,y:null,w:null,h:null},mousePos:{},dragStart:{id:null}},tm=function(e,r){if(!e||!e.type)return null;var n=["config","asyncListValues","__isInternal"],t=[Uu,Wc,Bc,$c],i=Fo()(jr()(e,n),va),u=e.path&&rm(r.tree,e.path)||e.field;if(u){var o;(o=u)!==null&&o!==void 0&&o.toJS&&(u=u.toJS()),i.affectedField=u}return(t.includes(e.type)||e.type.indexOf("@@redux")==0)&&(i=null),i};const nm=function(a,e,r,n){var t=e,i=Mn({tree:t},Xc);return function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:i,o=arguments.length>1?arguments[1]:void 0,s={__isInternalValueChange:void 0,__lastAction:void 0},c={},f=tm(o,u);switch(o?.type){case Uu:{var d=r(o.config,o.tree);c.tree=d;break}case xu:{c.tree=zc(u.tree,o.path,"case_group",o.id,o.properties,o.config,o.children,o.meta);break}case Lc:{c.tree=zc(u.tree,o.path,"group",o.id,o.properties,o.config,o.children,o.meta);break}case Ic:{c.tree=Ug(u.tree,o.path,o.config);break}case Nc:{c.tree=Ba(u.tree,o.path,o.ruleType,o.id,o.properties,o.config,o.children);break}case wc:{c.tree=Gg(u.tree,o.path,o.config);break}case bc:{c.tree=$g(u.tree,o.path,o.conjunction);break}case Fc:{c.tree=Bg(u.tree,o.path,o.not);break}case Pc:{var v=zg(u.tree,o.path,o.field,o.config,o.asyncListValues,o.__isInternal),g=v.tree,m=v.isInternalValueChange;c.__isInternalValueChange=m,c.tree=g;break}case _c:{c.tree=Yg(u.tree,o.path,o.srcKey,o.config);break}case kc:{c.tree=Wg(u.tree,o.path,o.lock);break}case Dc:{c.tree=Xg(u.tree,o.path,o.operator,o.config);break}case Mc:{var E=qg(u.tree,o.path,o.delta,o.value,o.valueType,o.config,o.asyncListValues,o.__isInternal),O=E.tree,R=E.isInternalValueChange;c.__isInternalValueChange=R,c.tree=O;break}case Vc:{c.tree=Jg(u.tree,o.path,o.delta,o.srcKey,o.config);break}case jc:{c.tree=Qg(u.tree,o.path,o.name,o.value);break}case xc:{c.tree=Kg(u.tree,o.fromPath,o.toPath,o.placement,o.config);break}case Wc:{c.dragStart=o.dragStart,c.dragging=o.dragging,c.mousePos=o.mousePos;break}case Bc:{c.mousePos=o.mousePos,c.dragging=o.dragging;break}case $c:{c.tree=Zg(u.tree,a),c=Mn(Mn({},c),Xc);break}default:break}return f&&(c.__lastAction=f),n&&c.tree&&u.tree&&n(u.tree),Mn(Mn(Mn({},u),s),c)}};var am=function(e,r){return{type:Uu,tree:r,config:e}},im=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"rule",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;return{type:Nc,ruleType:t,children:i,path:at(r),id:_r(),properties:_n(e,u).merge(n||{}),config:e}},om=function(e,r){return{type:wc,path:at(r),config:e}},um=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:xu,path:at(r),children:t,id:_r(),properties:Sa(e).merge(n||{}),config:e,meta:{isDefaultCase:!0}}},sm=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:xu,path:at(r),children:t,id:_r(),properties:Sa(e).merge(n||{}),config:e}},lm=function(e,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:Lc,path:at(r),children:t,id:_r(),properties:Sa(e).merge(n||{}),config:e}},cm=function(e,r){return{type:Ic,path:at(r),config:e}},fm=function(e,r,n,t){return{type:xc,fromPath:at(r),toPath:at(n),placement:t,config:e}},dm=function(e,r,n){return{type:bc,path:at(r),conjunction:n}},pm=function(e,r,n){return{type:Fc,path:at(r),not:n}},vm=function(e,r,n){return{type:kc,path:at(r),lock:n}},gm=function(e,r,n,t,i){return{type:Pc,path:at(r),field:n,config:e,asyncListValues:t,__isInternal:i}},mm=function(e,r,n){return{type:_c,path:at(r),srcKey:n,config:e}},hm=function(e,r,n){return{type:Dc,path:at(r),operator:n,config:e}},ym=function(e,r,n,t,i,u,o){return{type:Mc,path:at(r),delta:n,value:t,valueType:i,asyncListValues:u,config:e,__isInternal:o}},Em=function(e,r,n,t){return{type:Vc,path:at(r),delta:n,srcKey:t,config:e}},Sm=function(e,r,n,t){return{type:jc,path:at(r),name:n,value:t,config:e}};function qc(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function No(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qc(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):qc(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var gr=No(No(No(No({},z),T),H),{},{ConfigMixins:jg}),Om=y(5556),$=y.n(Om);const Tm=nm,Ki=h.createContext();var Am=y(82960),Jc=h.createContext(null);const fO=null;function Rm(a){a()}var Qc=Rm,Cm=function(e){return Qc=e},Lm=function(){return Qc};function Im(){var a=Lm(),e=null,r=null;return{clear:function(){e=null,r=null},notify:function(){a(function(){for(var t=e;t;)t.callback(),t=t.next})},get:function(){for(var t=[],i=e;i;)t.push(i),i=i.next;return t},subscribe:function(t){var i=!0,u=r={callback:t,next:null,prev:r};return u.prev?u.prev.next=u:e=u,function(){!i||e===null||(i=!1,u.next?u.next.prev=u.prev:r=u.prev,u.prev?u.prev.next=u.next:e=u.next)}}}}var Zc={notify:function(){},get:function(){return[]}};function ef(a,e){var r,n=Zc;function t(d){return s(),n.subscribe(d)}function i(){n.notify()}function u(){f.onStateChange&&f.onStateChange()}function o(){return!!r}function s(){r||(r=e?e.addNestedSub(u):a.subscribe(u),n=Im())}function c(){r&&(r(),r=void 0,n.clear(),n=Zc)}var f={addNestedSub:t,notifyNestedSubs:i,handleChangeWrapper:u,isSubscribed:o,trySubscribe:s,tryUnsubscribe:c,getListeners:function(){return n}};return f}var rf=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?h.useLayoutEffect:h.useEffect;function bm(a){var e=a.store,r=a.context,n=a.children,t=(0,h.useMemo)(function(){var o=ef(e);return{store:e,subscription:o}},[e]),i=(0,h.useMemo)(function(){return e.getState()},[e]);rf(function(){var o=t.subscription;return o.onStateChange=o.notifyNestedSubs,o.trySubscribe(),i!==e.getState()&&o.notifyNestedSubs(),function(){o.tryUnsubscribe(),o.onStateChange=null}},[t,i]);var u=r||Jc;return h.createElement(u.Provider,{value:t},n)}const Fm=bm;var Cr=y(58168),wo=y(98587),Nm=y(4146),tf=y.n(Nm),wm=y(10636),Pm=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],_m=["reactReduxForwardedRef"],Dm=[],Mm=[null,null],dO=function(e){try{return JSON.stringify(e)}catch{return String(e)}};function Vm(a,e){var r=a[1];return[e.payload,r+1]}function nf(a,e,r){rf(function(){return a.apply(void 0,e)},r)}function jm(a,e,r,n,t,i,u){a.current=n,e.current=t,r.current=!1,i.current&&(i.current=null,u())}function km(a,e,r,n,t,i,u,o,s,c){if(a){var f=!1,d=null,v=function(){if(!f){var E=e.getState(),O,R;try{O=n(E,t.current)}catch(w){R=w,d=w}R||(d=null),O===i.current?u.current||s():(i.current=O,o.current=O,u.current=!0,c({type:"STORE_UPDATED",payload:{error:R}}))}};r.onStateChange=v,r.trySubscribe(),v();var g=function(){if(f=!0,r.tryUnsubscribe(),r.onStateChange=null,d)throw d};return g}}var xm=function(){return[null,0]};function Um(a,e){e===void 0&&(e={});var r=e,n=r.getDisplayName,t=n===void 0?function(W){return"ConnectAdvanced("+W+")"}:n,i=r.methodName,u=i===void 0?"connectAdvanced":i,o=r.renderCountProp,s=o===void 0?void 0:o,c=r.shouldHandleStateChanges,f=c===void 0?!0:c,d=r.storeKey,v=d===void 0?"store":d,g=r.withRef,m=g===void 0?!1:g,E=r.forwardRef,O=E===void 0?!1:E,R=r.context,w=R===void 0?Jc:R,P=(0,wo.A)(r,Pm);if(!1)var F;var k=w;return function(q){var re=q.displayName||q.name||"Component",Z=t(re),J=(0,Cr.A)({},P,{getDisplayName:t,methodName:u,renderCountProp:s,shouldHandleStateChanges:f,storeKey:v,displayName:Z,wrappedComponentName:re,WrappedComponent:q}),te=P.pure;function le(se){return a(se.dispatch,J)}var ee=te?h.useMemo:function(se){return se()};function ie(se){var de=(0,h.useMemo)(function(){var Wt=se.reactReduxForwardedRef,$t=(0,wo.A)(se,_m);return[se.context,Wt,$t]},[se]),ge=de[0],Fe=de[1],De=de[2],ke=(0,h.useMemo)(function(){return ge&&ge.Consumer&&(0,wm.isContextConsumer)(h.createElement(ge.Consumer,null))?ge:k},[ge,k]),Oe=(0,h.useContext)(ke),je=!!se.store&&!!se.store.getState&&!!se.store.dispatch,Je=!!Oe&&!!Oe.store,xe=je?se.store:Oe.store,Ze=(0,h.useMemo)(function(){return le(xe)},[xe]),Ye=(0,h.useMemo)(function(){if(!f)return Mm;var Wt=ef(xe,je?null:Oe.subscription),$t=Wt.notifyNestedSubs.bind(Wt);return[Wt,$t]},[xe,je,Oe]),mr=Ye[0],Or=Ye[1],tt=(0,h.useMemo)(function(){return je?Oe:(0,Cr.A)({},Oe,{subscription:mr})},[je,Oe,mr]),Lt=(0,h.useReducer)(Vm,Dm,xm),st=Lt[0],vt=st[0],qt=Lt[1];if(vt&&vt.error)throw vt.error;var It=(0,h.useRef)(),zr=(0,h.useRef)(De),Lr=(0,h.useRef)(),et=(0,h.useRef)(!1),rn=ee(function(){return Lr.current&&De===zr.current?Lr.current:Ze(xe.getState(),De)},[xe,vt,De]);nf(jm,[zr,It,et,De,rn,Lr,Or]),nf(km,[f,xe,mr,Ze,zr,It,et,Lr,Or,qt],[xe,mr,Ze]);var En=(0,h.useMemo)(function(){return h.createElement(q,(0,Cr.A)({},rn,{ref:Fe}))},[Fe,q,rn]),kn=(0,h.useMemo)(function(){return f?h.createElement(ke.Provider,{value:tt},En):En},[ke,En,tt]);return kn}var oe=te?h.memo(ie):ie;if(oe.WrappedComponent=q,oe.displayName=ie.displayName=Z,O){var pe=h.forwardRef(function(de,ge){return h.createElement(oe,(0,Cr.A)({},de,{reactReduxForwardedRef:ge}))});return pe.displayName=Z,pe.WrappedComponent=q,tf()(pe,q)}return tf()(oe,q)}}function af(a,e){return a===e?a!==0||e!==0||1/a===1/e:a!==a&&e!==e}function $u(a,e){if(af(a,e))return!0;if(typeof a!="object"||a===null||typeof e!="object"||e===null)return!1;var r=Object.keys(a),n=Object.keys(e);if(r.length!==n.length)return!1;for(var t=0;t<r.length;t++)if(!Object.prototype.hasOwnProperty.call(e,r[t])||!af(a[r[t]],e[r[t]]))return!1;return!0}function Gm(a,e){var r={},n=function(u){var o=a[u];typeof o=="function"&&(r[u]=function(){return e(o.apply(void 0,arguments))})};for(var t in a)n(t);return r}function Hu(a){return function(r,n){var t=a(r,n);function i(){return t}return i.dependsOnOwnProps=!1,i}}function of(a){return a.dependsOnOwnProps!==null&&a.dependsOnOwnProps!==void 0?!!a.dependsOnOwnProps:a.length!==1}function uf(a,e){return function(n,t){var i=t.displayName,u=function(s,c){return u.dependsOnOwnProps?u.mapToProps(s,c):u.mapToProps(s)};return u.dependsOnOwnProps=!0,u.mapToProps=function(s,c){u.mapToProps=a,u.dependsOnOwnProps=of(a);var f=u(s,c);return typeof f=="function"&&(u.mapToProps=f,u.dependsOnOwnProps=of(f),f=u(s,c)),f},u}}function Bm(a){return typeof a=="function"?uf(a,"mapDispatchToProps"):void 0}function Wm(a){return a?void 0:Hu(function(e){return{dispatch:e}})}function $m(a){return a&&typeof a=="object"?Hu(function(e){return Gm(a,e)}):void 0}const Hm=[Bm,Wm,$m];function Km(a){return typeof a=="function"?uf(a,"mapStateToProps"):void 0}function Ym(a){return a?void 0:Hu(function(){return{}})}const zm=[Km,Ym];function Xm(a,e,r){return(0,Cr.A)({},r,a,e)}function qm(a){return function(r,n){var t=n.displayName,i=n.pure,u=n.areMergedPropsEqual,o=!1,s;return function(f,d,v){var g=a(f,d,v);return o?(!i||!u(g,s))&&(s=g):(o=!0,s=g),s}}}function Jm(a){return typeof a=="function"?qm(a):void 0}function Qm(a){return a?void 0:function(){return Xm}}const Zm=[Jm,Qm];var eh=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function rh(a,e,r,n){return function(i,u){return r(a(i,u),e(n,u),u)}}function th(a,e,r,n,t){var i=t.areStatesEqual,u=t.areOwnPropsEqual,o=t.areStatePropsEqual,s=!1,c,f,d,v,g;function m(P,F){return c=P,f=F,d=a(c,f),v=e(n,f),g=r(d,v,f),s=!0,g}function E(){return d=a(c,f),e.dependsOnOwnProps&&(v=e(n,f)),g=r(d,v,f),g}function O(){return a.dependsOnOwnProps&&(d=a(c,f)),e.dependsOnOwnProps&&(v=e(n,f)),g=r(d,v,f),g}function R(){var P=a(c,f),F=!o(P,d);return d=P,F&&(g=r(d,v,f)),g}function w(P,F){var k=!u(F,f),W=!i(P,c);return c=P,f=F,k&&W?E():k?O():W?R():g}return function(F,k){return s?w(F,k):m(F,k)}}function nh(a,e){var r=e.initMapStateToProps,n=e.initMapDispatchToProps,t=e.initMergeProps,i=(0,wo.A)(e,eh),u=r(a,i),o=n(a,i),s=t(a,i),c=i.pure?th:rh;return c(u,o,s,a,i)}var ah=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function Ku(a,e,r){for(var n=e.length-1;n>=0;n--){var t=e[n](a);if(t)return t}return function(i,u){throw new Error("Invalid value of type "+typeof a+" for "+r+" argument when connecting component "+u.wrappedComponentName+".")}}function ih(a,e){return a===e}function oh(a){var e=a===void 0?{}:a,r=e.connectHOC,n=r===void 0?Um:r,t=e.mapStateToPropsFactories,i=t===void 0?zm:t,u=e.mapDispatchToPropsFactories,o=u===void 0?Hm:u,s=e.mergePropsFactories,c=s===void 0?Zm:s,f=e.selectorFactory,d=f===void 0?nh:f;return function(g,m,E,O){O===void 0&&(O={});var R=O,w=R.pure,P=w===void 0?!0:w,F=R.areStatesEqual,k=F===void 0?ih:F,W=R.areOwnPropsEqual,q=W===void 0?$u:W,re=R.areStatePropsEqual,Z=re===void 0?$u:re,J=R.areMergedPropsEqual,te=J===void 0?$u:J,le=(0,wo.A)(R,ah),ee=Ku(g,i,"mapStateToProps"),ie=Ku(m,o,"mapDispatchToProps"),oe=Ku(E,c,"mergeProps");return n(d,(0,Cr.A)({methodName:"connect",getDisplayName:function(se){return"Connect("+se+")"},shouldHandleStateChanges:!!g,initMapStateToProps:ee,initMapDispatchToProps:ie,initMergeProps:oe,pure:P,areStatesEqual:k,areOwnPropsEqual:q,areStatePropsEqual:Z,areMergedPropsEqual:te},le))}}const Po=oh();function pO(){var a=useContext(ReactReduxContext);return a}function vO(a){a===void 0&&(a=ReactReduxContext);var e=a===ReactReduxContext?useDefaultReduxContext:function(){return useContext(a)};return function(){var n=e(),t=n.store;return t}}var gO=null;function mO(a){a===void 0&&(a=ReactReduxContext);var e=a===ReactReduxContext?useDefaultStore:createStoreHook(a);return function(){var n=e();return n.dispatch}}var hO=null,uh=function(e,r){return e===r};function sh(a,e,r,n){var t=useReducer(function(m){return m+1},0),i=t[1],u=useMemo(function(){return createSubscription(r,n)},[r,n]),o=useRef(),s=useRef(),c=useRef(),f=useRef(),d=r.getState(),v;try{if(a!==s.current||d!==c.current||o.current){var g=a(d);f.current===void 0||!e(g,f.current)?v=g:v=f.current}else v=f.current}catch(m){throw o.current&&(m.message+=`
The error may be correlated with this previous error:
`+o.current.stack+`

`),m}return useIsomorphicLayoutEffect(function(){s.current=a,c.current=d,f.current=v,o.current=void 0}),useIsomorphicLayoutEffect(function(){function m(){try{var E=r.getState();if(E===c.current)return;var O=s.current(E);if(e(O,f.current))return;f.current=O,c.current=E}catch(R){o.current=R}i()}return u.onStateChange=m,u.trySubscribe(),m(),function(){return u.tryUnsubscribe()}},[r,u]),v}function yO(a){a===void 0&&(a=ReactReduxContext);var e=a===ReactReduxContext?useDefaultReduxContext:function(){return useContext(a)};return function(n,t){t===void 0&&(t=uh);var i=e(),u=i.store,o=i.subscription,s=sh(n,t,u,o);return useDebugValue(s),s}}var EO=null,lh=y(40961);Cm(lh.unstable_batchedUpdates);var SO="ADD_GROUP",OO="ADD_CASE_GROUP",TO="REMOVE_GROUP",AO="SET_CONJUNCTION",RO="SET_NOT",CO="ADD_RULE",LO="REMOVE_RULE",IO="SET_FIELD",bO="SET_FIELD_SRC",FO="SET_OPERATOR",NO="SET_VALUE",wO="SET_VALUE_SRC",PO="SET_OPERATOR_OPTION",_O="SET_LOCK",DO="SET_TREE",MO="MOVE_ITEM",_o="after",Do="before",Wa="append",yi="prepend",ch="SET_DRAG_PROGRESS",fh="SET_DRAG_START",dh="SET_DRAG_END",ph=function(e,r){return{type:ch,mousePos:e,dragging:r}},vh=function(e,r,n){return{type:fh,dragStart:e,dragging:r,mousePos:n}},gh=function(){return{type:dh}},sf=U,mh=K,hh=Y;function Yu(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=yh(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function yh(a,e){if(a){if(typeof a=="string")return lf(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lf(a,e)}}function lf(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}var cf=gr.ConfigUtils,Eh=cf.extendConfig,Mo=cf.configKeys,Sh=function(e){return nn()(e,Mo)},Oh=function(){var e=new Map,r=2,n=0,t=function(c){var f=Eh(c,++n);return e.size+1>r&&e.delete(e.keys()[0]),e.set(c,f),f},i=function(c){var f=Yu(e.keys()),d;try{var v=function(){var E=d.value,O=e.get(E),R=Mo.map(function(w){return O[w]===c[w]}).filter(function(w){return!w}).length===0;if(R)return{v:E}};for(f.s();!(d=f.n()).done;){var g=v();if((0,Ar.A)(g)==="object")return g.v}}catch(m){f.e(m)}finally{f.f()}return c},u=function(c){var f=Yu(e.keys()),d;try{var v=function(){var P=d.value,F=Mo.map(function(k){return P[k]===c[k]}).filter(function(k){return!k}).length===0;if(F)return{v:e.get(P)}};for(f.s();!(d=f.n()).done;){var g=v();if((0,Ar.A)(g)==="object")return g.v}}catch(w){f.e(w)}finally{f.f()}var m=Yu(e.values()),E;try{var O=function(){var P=E.value,F=Mo.map(function(k){return P[k]===c[k]}).filter(function(k){return!k}).length===0;if(F)return{v:P}};for(m.s();!(E=m.n()).done;){var R=O();if((0,Ar.A)(R)==="object")return R.v}}catch(w){m.e(w)}finally{m.f()}return null},o=function(c){return u(c)||t(c)};return{getExtended:function(c){return o(Sh(c))},getBasic:i}},Th=function(e,r){return typeof e>"u"?r:e},Vo=function(e,r,n){if(!r||e.length<=r)return e;var t=e.substr(0,r-1);return(n?t.substr(0,t.lastIndexOf(" ")):t)+"..."},$a=function(e,r){return e===r?!0:e.equals(r)},Ha=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e===r?!0:Array.isArray(e)?Ah(e,r,n):e&&typeof e.equals=="function"?e.equals(r):(0,Ar.A)(e)==="object"?Rh(e,r,n):e===r};function Ah(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(a===e)return!0;if(!a||!e)return!1;var n=a.length;if(e.length!==n)return!1;for(var t=0;t<n;t++){var i=r?Ha(a[t],e[t],r):a[t]===e[t];if(!i)return!1}return!0}function Rh(a,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(a===e)return!0;if(!a||!e)return!1;var n=Object.keys(a),t=Object.keys(e),i=n.length;if(t.length!==i)return!1;for(var u=0;u<i;u++){var o=n[u],s=r?Ha(a[o],e[o],r):a[o]===e[o];if(!s)return!1}return!0}var Ch=function(){return typeof process<"u"&&process.env&&!1},Lh=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=e??Ch();return r?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},Ih=Lh(),ff=gr.validateAndFixTree,bh=function(){var e,r,n;return function(t,i){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return i?(t.__configId===n&&($a(i,e)||$a(i,r))||(n=t.__configId,e=i,o===!1?r=ff(i,null,t,u||t,!1,!1):r=ff(i,null,t,u||t)),r):null}},Fh=function(e){if(e._reactRootContainer)return"root";if(Object.getOwnPropertyNames(e).filter(function(r){return r.startsWith("__reactContainer")}).length>0)return"container"},Nh=function a(e){if(e){var r=Fh(e);return r!==void 0?r:a(e.parentNode)}},df=function(e){return Nh(e)==="root"},zu=function(e,r){return function(n,t){var i=e.props,u=e.state,o=n!=i||t!=u;if(o&&u==t&&i!=n){var s=[];for(var c in n){var f=n[c]!=i[c];f&&(r[c]=="ignore"?f=!1:r[c]=="shallow_deep"?f=!Ha(n[c],i[c],!0):r[c]=="shallow"?f=!Ha(n[c],i[c]):typeof r[c]=="function"&&(f=r[c](n[c],i[c],t))),f&&s.push(c)}s.length||(o=!1)}return o}},Ei=function(e){return function(r,n){return!Ha(e.props,r)||!Ha(e.state,n)}},wh=function(){var e=h.version.split(".").map(parseInt.bind(null,10));return e[0]==16&&e[1]<3||e[0]<16},_t=function(e){if(e.shouldComponentUpdate||(e.shouldComponentUpdate=Ei(e)),wh())e.componentWillReceiveProps=function(t){e.onPropsChanged(t)};else{var r=e.shouldComponentUpdate,n=function(i,u){var o=!Ha(e.props,i);o&&e.onPropsChanged(i);var s=r.call(e,i,u);return s};e.shouldComponentUpdate=n.bind(e)}},pf=function(e,r,n){return Fo()(e,function(t){return function(){for(var i=arguments.length,u=new Array(i),o=0;o<i;o++)u[o]=arguments[o];return n(t.apply(void 0,[r].concat(u)))}})};function vf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Xu(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vf(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):vf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function Ph(a){var e=_h();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function _h(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var gf=function(a){(0,Fr.A)(r,a);var e=Ph(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),t.shouldComponentUpdate=zu((0,Qe.A)(t),{tree:function(u){return!(u===t.oldValidatedTree&&t.oldValidatedTree===t.validatedTree)}}),_t((0,Qe.A)(t)),t._updateActions(n),t.validatedTree=n.getMemoizedTree(n.config,n.tree,void 0,n.sanitizeTree),t.oldValidatedTree=t.validatedTree,t}return(0,Tr.A)(r,[{key:"_updateActions",value:function(t){var i=t.config,u=t.dispatch;this.actions=pf(Xu(Xu(Xu({},sf),mh),hh),i,u)}},{key:"onPropsChanged",value:function(t){var i=t.onChange,u=this.props.config,o=t.tree,s=this.props.tree,c=t.config;this.oldValidatedTree=this.validatedTree,this.validatedTree=o,u!==c&&(this._updateActions(t),this.validatedTree=t.getMemoizedTree(c,o,u));var f=!$a(this.validatedTree,this.oldValidatedTree);if(f){var d=t.getBasicConfig(c);i&&i(this.validatedTree,d,t.__lastAction)}}},{key:"render",value:function(){var t=this.props,i=t.config,u=t.renderBuilder,o=t.dispatch,s=t.__isInternalValueChange,c={tree:this.validatedTree,actions:this.actions,config:i,dispatch:o,__isInternalValueChange:s};return u(c)}}]),r}(h.Component);gf.propTypes={config:$().object.isRequired,onChange:$().func,renderBuilder:$().func,tree:$().any};var mf=Po(function(a){return{tree:a.tree,__isInternalValueChange:a.__isInternalValueChange,__lastAction:a.__lastAction}},null,null,{context:Ki})(gf);mf.displayName="ConnectedQuery";const Dh=mf;function Mh(a){var e=Vh();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function Vh(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var hf=gr.DefaultUtils.defaultRoot,yf=function(a){(0,Fr.A)(r,a);var e=Mh(r);function r(n,t){var i;(0,br.A)(this,r),i=e.call(this,n,t),i.setLastTree=function(w){i.prevTree&&(i.prevprevTree=i.prevTree),i.prevTree=w},i.shouldComponentUpdate=zu((0,Qe.A)(i),{value:function(P,F,k){return!1}}),_t((0,Qe.A)(i));var u=Oh(),o=u.getExtended,s=u.getBasic;i.getMemoizedConfig=o,i.getBasicConfig=s,i.getMemoizedTree=bh();var c=i.getMemoizedConfig(n),f=c.settings.shouldCreateEmptyGroup,d=!f,v=hf(c,d),g=!!n.value,m=n.value||v,E=i.getMemoizedTree(c,m,void 0,g),O=Tm(c,E,i.getMemoizedTree,i.setLastTree),R=(0,Am.createStore)(O);return i.config=c,i.state={store:R},i.QueryWrapper=function(w){return c.settings.renderProvider(w,c.ctx)},i}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){var i=this.props,u=this.config,o=this.getMemoizedConfig(t),s=u!==o,c=this.state.store.getState().tree,f=!$a(t.value,this.props.value)&&!$a(t.value,c),d=f?t.value||hf(t):c,v=f&&!$a(t.value,this.prevTree)&&!$a(t.value,this.prevprevTree);if(this.sanitizeTree=v||s,s&&(i.settings.renderProvider!==t.settings.renderProvider&&(this.QueryWrapper=function(m){return o.settings.renderProvider(m,o.ctx)}),this.config=o),f||s){var g=this.getMemoizedTree(o,d,u,this.sanitizeTree);this.state.store.dispatch(sf.setTree(o,g))}}},{key:"render",value:function(){var t=this.props,i=t.renderBuilder,u=t.get_children,o=t.onChange,s=this.state.store,c=this.config,f=this.QueryWrapper;return h.createElement(f,{config:c},h.createElement(Fm,{store:s,context:Ki},h.createElement(Dh,{config:c,getMemoizedTree:this.getMemoizedTree,getBasicConfig:this.getBasicConfig,sanitizeTree:this.sanitizeTree,onChange:o,renderBuilder:i||u})))}}]),r}(h.Component);yf.propTypes={conjunctions:$().object.isRequired,fields:$().object.isRequired,types:$().object.isRequired,operators:$().object.isRequired,widgets:$().object.isRequired,settings:$().object.isRequired,ctx:$().object.isRequired,onChange:$().func,renderBuilder:$().func,value:$().any};var jh=y(46942),yn=y.n(jh);function kh(a){var e=xh();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function xh(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Uh=gr.ConfigUtils.getFieldConfig,Gh=function(e){var r;return r=function(n){(0,Fr.A)(i,n);var t=kh(i);function i(u){var o;return(0,br.A)(this,i),o=t.call(this,u),o.dummyFn=function(){},o.removeSelf=function(){o.props.actions.removeRule(o.props.path)},o.setLock=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;o.props.actions.setLock(o.props.path,s)},o.setField=function(s,c,f){o.props.actions.setField(o.props.path,s,c,f)},o.setFieldSrc=function(s){o.props.actions.setFieldSrc(o.props.path,s)},o.setOperator=function(s){o.props.actions.setOperator(o.props.path,s)},o.setOperatorOption=function(s,c){o.props.actions.setOperatorOption(o.props.path,s,c)},o.setValue=function(s,c,f,d,v){o.props.actions.setValue(o.props.path,s,c,f,d,v)},o.setValueSrc=function(s,c){o.props.actions.setValueSrc(o.props.path,s,c)},o.pureShouldComponentUpdate=Ei((0,Qe.A)(o)),o.dummyFn.isDummyFn=!0,o}return(0,Tr.A)(i,[{key:"shouldComponentUpdate",value:function(o,s){var c=this.props,f=this.state,d=this.pureShouldComponentUpdate(o,s);if(d&&f==s&&c!=o){var v=o.dragging.id||c.dragging.id,g=v==o.id,m=[];for(var E in o){var O=o[E]!=c[E];E=="dragging"&&!g&&(O=!1),O&&m.push(E)}m.length||(d=!1)}return d}},{key:"render",value:function(){var o=this.props.dragging.id==this.props.id,s=Uh(this.props.config,this.props.field),c=this.props.fieldType||s?.type||null,f=this.props.config.settings.showErrorMessage,d=s&&s.type=="!struct",v=!o&&this.props.isDraggingTempo,g=this.props.valueError,m=g&&g.toArray().filter(function(O){return!!O}).shift()||null,E=m!=null&&f;return h.createElement("div",{className:yn()("group-or-rule-container","rule-container",E?"rule-with-error":null),"data-id":this.props.id},[o?h.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,setField:this.dummyFn,setFieldSrc:this.dummyFn,setOperator:this.dummyFn,setOperatorOption:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:c,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,h.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:o,isDraggingTempo:v,onDragStart:this.props.onDragStart,setLock:v?this.dummyFn:this.setLock,removeSelf:v?this.dummyFn:this.removeSelf,setField:v?this.dummyFn:this.setField,setFieldSrc:v?this.dummyFn:this.setFieldSrc,setOperator:v?this.dummyFn:this.setOperator,setOperatorOption:v?this.dummyFn:this.setOperatorOption,setValue:v?this.dummyFn:this.setValue,setValueSrc:v?this.dummyFn:this.setValueSrc,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:c,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}]),i}(h.Component),r.propTypes={id:$().string.isRequired,groupId:$().string,config:$().object.isRequired,path:$().any.isRequired,operator:$().string,field:$().any,fieldSrc:$().string,fieldType:$().string,actions:$().object.isRequired,onDragStart:$().func,value:$().any,valueSrc:$().any,asyncListValues:$().array,valueError:$().any,operatorOptions:$().object,reordableNodesCnt:$().number,parentField:$().string,isLocked:$().bool,isTrueLocked:$().bool,dragging:$().object,isDraggingTempo:$().bool},r};const Bh=function(a){var e=Po(function(r){return{dragging:r.dragging}},null,null,{context:Ki})(Gh(a));return e.displayName="ConnectedRuleContainer",e};function Wh(a){var e=$h();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function $h(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ef=gr.clone,Hh=gr.TreeUtils.getFlatTree,qu=!1,Kh=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return r=function(t){(0,Fr.A)(u,t);var i=Wh(u);function u(o){var s;return(0,br.A)(this,u),s=i.call(this,o),s._getEventTarget=function(c,f){return c&&c.__mocked_window||document.body||window},s.onDragStart=function(c,f,d){var v=f.closest(".query-builder");s._isUsingLegacyReactDomRender===void 0&&(s._isUsingLegacyReactDomRender=df(v)),document.body.classList.add("qb-dragging"),v.classList.add("qb-dragging");var g=v.closest(".query-builder-container")||v;g=s._getScrollParent(g)||document.body;var m=g.scrollTop,E=s._getDraggableNodeEl(v),O=s._getPlaceholderNodeEl(v),R=v.querySelectorAll(".group--children"),w=R.length?R[0]:null,P;w&&(P=window.getComputedStyle(w,null).getPropertyValue("padding-left"),P=parseInt(P));var F={id:c,x:f.offsetLeft,y:f.offsetTop,w:f.offsetWidth,h:f.offsetHeight,itemInfo:s.tree.items[c],paddingLeft:P},k={id:c,x:f.offsetLeft,y:f.offsetTop,scrollTop:m,clientX:d.clientX,clientY:d.clientY,itemInfo:Ef(s.tree.items[c]),treeEl:v,treeElContainer:g},W={clientX:d.clientX,clientY:d.clientY},q=s._getEventTarget(d,k);s.eventTarget=q,q.addEventListener("mousemove",s.onDrag),q.addEventListener("mouseup",s.onDragEnd),s.props.setDragStart(k,F,W)},s.onDrag=function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,d=Object.assign({},s.props.dragging),v=s.props.dragStart,g=d.paddingLeft,m=v.treeElContainer,E=m.scrollTop;if(d.itemInfo=s.tree.items[d.id],!!d.itemInfo){var O={clientX:c.clientX,clientY:c.clientY},R={clientX:v.clientX,clientY:v.clientY};if(c.__mock_dom){var w=v.treeEl,P=s._getDraggableNodeEl(w),F=s._getPlaceholderNodeEl(w);c.__mock_dom({treeEl:w,dragEl:P,plhEl:F})}if(!v.plX){var k=v.treeEl,W=s._getPlaceholderNodeEl(k);W&&(v.plX=W.getBoundingClientRect().left+window.scrollX,v.plY=W.getBoundingClientRect().top+window.scrollY)}var q=v.x,re=v.y,Z=v.clientX,J=v.clientY,te=v.scrollTop,le={x:q+(c.clientX-Z),y:re+(c.clientY-J)+(E-te)};d.x=le.x,d.y=le.y,d.paddingLeft=g,d.mousePos=O,d.startMousePos=R,s.props.setDragProgress(O,d);var ee=f?s.handleDrag(d,c,n):!1;ee||c.preventDefault&&c.preventDefault()}},s.onDragEnd=function(){var c=s.props.dragStart.treeEl;s.props.setDragEnd(),c.classList.remove("qb-dragging"),document.body.classList.remove("qb-dragging"),s._cacheEls={};var f=s.eventTarget||s._getEventTarget();f.removeEventListener("mousemove",s.onDrag),f.removeEventListener("mouseup",s.onDragEnd)},s.pureShouldComponentUpdate=Ei((0,Qe.A)(s)),_t((0,Qe.A)(s)),s.onPropsChanged(o),s}return(0,Tr.A)(u,[{key:"onPropsChanged",value:function(s){this.tree=Hh(s.tree)}},{key:"shouldComponentUpdate",value:function(s,c){var f=this.props,d=this.state,v=this.pureShouldComponentUpdate(s,c);if(v&&d==c&&f!=s){var g=[];for(var m in s){var E=s[m]!=f[m];E&&m!="dragging"&&m!="mousePos"&&g.push(m)}g.length||(v=!1)}return v}},{key:"componentDidUpdate",value:function(s,c){var f=this.props.dragging,d=this.props.dragStart;if(qu=!1,d&&d.id&&(f.itemInfo=this.tree.items[f.id],f.itemInfo&&(f.itemInfo.index!=d.itemInfo.index||f.itemInfo.parent!=d.itemInfo.parent))){var v=d.treeEl,g=d.treeElContainer,m=this._getPlaceholderNodeEl(v,!0);if(m){var E=m.getBoundingClientRect().left+window.scrollX,O=m.getBoundingClientRect().top+window.scrollY,R=d.plX,w=d.plY,P=g.scrollTop;d.plX=E,d.plY=O,d.itemInfo=Ef(f.itemInfo),d.y=m.offsetTop,d.x=m.offsetLeft,d.clientY+=O-w,d.clientX+=E-R,g!=document.body&&(d.scrollTop=P),this.onDrag(this.props.mousePos,!1)}}}},{key:"_getNodeElById",value:function(s,c){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(c==null)return null;this._cacheEls||(this._cacheEls={});var d=this._cacheEls[c];return d&&document.contains(d)&&!f||(d=s.querySelector('.group-or-rule-container[data-id="'+c+'"]'),this._cacheEls[c]=d),d}},{key:"_getDraggableNodeEl",value:function(s){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._cacheEls||(this._cacheEls={});var f=this._cacheEls.draggable;if(f&&document.contains(f)&&!c)return f;var d=s.getElementsByClassName("qb-draggable");return f=d.length?d[0]:null,this._cacheEls.draggable=f,f}},{key:"_getPlaceholderNodeEl",value:function(s){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._cacheEls||(this._cacheEls={});var f=this._cacheEls.placeholder;if(f&&document.contains(f)&&!c)return f;var d=s.getElementsByClassName("qb-placeholder");return f=d.length?d[0]:null,this._cacheEls.placeholder=f,f}},{key:"_isScrollable",value:function(s){var c=window.getComputedStyle(s)["overflow-y"];return(c==="scroll"||c==="auto")&&s.scrollHeight>s.offsetHeight}},{key:"_getScrollParent",value:function(s){return s==null?null:s===document.body||this._isScrollable(s)?s:this._getScrollParent(s.parentNode)}},{key:"handleDrag",value:function(s,c,f){var d=this,v=!0,g=s.itemInfo,m=s.paddingLeft,E=null,O=this.props.dragStart.treeEl,R=s.id,w=this._getDraggableNodeEl(O),P=this._getPlaceholderNodeEl(O),F,k,W,q;if(w&&P){if(F=w.getBoundingClientRect(),k=P.getBoundingClientRect(),!k.width)return;var re={hrz:0,vrt:0};F.top<k.top?re.vrt=-1:F.bottom>k.bottom&&(re.vrt=1),F.left>k.left?re.hrz=1:F.left<k.left&&(re.hrz=-1),q=O.getBoundingClientRect();var Z={x:q.left+(q.right-q.left)/2,y:re.vrt>=0?F.bottom:F.top},J;if(c.__mocked_hov_container)J=c.__mocked_hov_container;else{var te=document.elementFromPoint(Z.x,Z.y-1);if(J=te?te.closest(".group-or-rule-container"):null,!J&&te&&te.classList.contains("query-builder-container")){var le,ee=te==null||(le=te.firstChild)===null||le===void 0?void 0:le.firstChild;ee&&ee.classList.contains("group-or-rule-container")&&(J=ee)}}if(!J)Ih.log("out of tree bounds!");else{var ie=J.classList.contains("group-container"),oe=J.getAttribute("data-id"),pe=J,se=!1,de=!1;if(pe){W=pe.getBoundingClientRect();var ge=W.bottom-W.top,Fe=this.tree.items[oe];if(!Fe)throw new Error("There is an issue with rendering. If you use Next.js, please check getServerSideProps() method.");var De=null,ke=null,Oe=null,je=null;if(re.vrt==0)Oe=g,ke=P,ke&&(De=ke.getBoundingClientRect());else if(ie){if(re.vrt>0){var Je=J.getElementsByClassName("group--header"),xe=Je.length?Je[0]:null;if(xe){var Ze=xe.getBoundingClientRect(),Ye=Ze.bottom-Ze.top,mr=F.bottom-Ze.top>Ye*3/4;mr&&Fe.top>s.itemInfo.top&&(Oe=Fe,De=Ze,ke=xe,de=!0)}}else if(re.vrt<0&&Fe.lev>=g.lev){var Or=W.bottom-F.top>=2;Or&&Fe.top<s.itemInfo.top&&(Oe=Fe,De=W,ke=pe,se=!0)}if(!de&&!se||v){var tt=re.vrt<0?W.bottom-F.top>ge-5:F.bottom-W.top>ge-5;tt&&(!de&&!se&&(Oe=Fe,De=W,ke=pe),v&&(je=Fe))}}else{var Lt=re.vrt<0?W.bottom-F.top>ge/2:F.bottom-W.top>ge/2;Lt&&(Oe=Fe,De=W,ke=pe)}var st=Oe&&Oe.id==R;if(De){var vt=F.left-q.left,qt=De.left-q.left,It=qt/m,zr=Math.max(0,Math.round(vt/m)),Lr=[],et=[];if(!st){if(ie&&(se?Lr.push([Wa,Oe,Oe.lev+1]):de&&Lr.push([yi,Oe,Oe.lev+1]),v&&je)){var rn=je.lev==0,En=je.type=="case_group"&&g.type!="case_group",kn=je.prev&&this.tree.items[je.prev].caseId,Wt=je.next&&this.tree.items[je.next].caseId;g.caseId==kn&&(kn=null),g.caseId==Wt&&(Wt=null);var $t=kn&&this.tree.items[kn],Aa=Wt&&this.tree.items[Wt];re.vrt>0?rn?et.push([Wa,je,je.lev+1]):En&&Aa?et.push([yi,Aa,Aa.lev+1]):et.push([_o,je,je.lev]):re.vrt<0&&(rn?et.push([yi,je,je.lev+1]):En&&$t?et.push([Wa,$t,$t.lev+1]):et.push([Do,je,je.lev]))}!se&&!de&&(re.vrt<0?Lr.push([Do,Oe,Oe.lev]):re.vrt>0&&Lr.push([_o,Oe,Oe.lev]))}var za=function(un){var sn=un[1],Ra=g.caseId?d.tree.items[g.caseId]:null,Zn=sn.caseId?d.tree.items[sn.caseId]:null;return[].concat((0,we.A)(un),[Ra,Zn])};Lr=Lr.map(za),et=et.map(za),Lr=Lr.filter(function(xr){var un=xr[0],sn=xr[1];if((un==Do||un==_o)&&sn.parent==null||sn.collapsed&&(un==Wa||un==yi))return!1;var Ra=sn.id==g.id;if(!Ra){for(var Zn=sn;Zn.parent;)if(Zn=d.tree.items[Zn.parent],Zn.id==g.id){Ra=!0;break}}return!Ra}).map(function(xr){var un=xr[0],sn=xr[1],Ra=xr[2],Zn=xr[3],gt=xr[4],er=null;return un==Wa||un==yi?er=sn:er=d.tree.items[sn.parent],er&&er.parent==null&&(er=null),xr[5]=er,xr});var Sn=null,On=Lr.filter(function(xr){return d.canMove(g,xr[1],xr[0],xr[3],xr[4],xr[5],f)});v&&On.length==0&&et.length>0&&(On=et.filter(function(xr){return d.canMove(g,xr[1],xr[0],xr[3],xr[4],xr[5],f)}));var Ji=On.map(function(xr){return xr[2]}),Qi=g.lev,Qn=Ji.concat(Qi),Li=null;Qn.indexOf(zr)!=-1?Li=zr:zr>Math.max.apply(Math,(0,we.A)(Qn))?Li=Math.max.apply(Math,(0,we.A)(Qn)):zr<Math.min.apply(Math,(0,we.A)(Qn))&&(Li=Math.min.apply(Math,(0,we.A)(Qn))),Sn=On.find(function(xr){return xr[2]==Li}),!st&&!Sn&&On.length&&(Sn=On[0]),E=Sn}}}}return E?(this.move(g,E[1],E[0],E[3]),!0):!1}},{key:"canMove",value:function(s,c,f,d,v,g,m){if(!s||!c||s.id===c.id)return!1;var E=this.props.config.settings,O=E.canRegroup,R=E.canRegroupCases,w=E.maxNesting,P=E.maxNumberOfRules,F=E.canLeaveEmptyCase,k=g?g.lev+1:c.lev,W=k+(s.depth||0),q=f==Do||f==_o,re=f==yi||f==Wa,Z=q&&c.lev==1||re&&c.lev==0,J=s.parent!=c.parent,te=re||J,le=s.type=="case_group"&&!Z||s.parentType=="rule_group"||c.type=="rule_group"||c.parentType=="rule_group"||s.type!="case_group"&&c.type=="case_group"&&q||s.type!="case_group"&&c.type=="switch_group"||!R&&s.caseId!=c.caseId,ee=c.isLocked||s.isLocked||g&&g.isLocked;if(w&&W>w||te&&(!O||le||ee))return!1;if(s.type!="case_group"&&s.caseId!=c.caseId){var ie=d?d._height==2:!1,oe=v?v.leafsCount+1:0;if(P&&oe>P||ie&&!F)return!1}if(s.type=="case_group"&&(s.isDefaultCase||c.isDefaultCase||c.type=="switch_group"&&f==Wa))return!1;var pe=!0;return m&&(pe=m(s.node.toJS(),c.node.toJS(),f,g?g.node.toJS():null)),pe}},{key:"move",value:function(s,c,f,d){this._isUsingLegacyReactDomRender||(qu=!0),this.props.actions.moveItem(s.path,c.path,f)}},{key:"render",value:function(){return h.createElement(e,(0,Cr.A)({},this.props,{onDragStart:this.onDragStart}))}}]),u}(h.Component),r.propTypes={tree:$().any.isRequired,actions:$().object.isRequired},r};const Yh=function(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=Po(function(n){return{dragging:n.dragging,dragStart:n.dragStart,mousePos:n.mousePos}},{setDragStart:vh,setDragProgress:ph,setDragEnd:gh},null,{context:Ki})(Kh(a,e));return r.displayName="ConnectedSortableContainer",r};var zh=["isDraggingTempo","isDraggingMe","dragging"];function Xh(a){var e=qh();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function qh(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}const Si=function(a){return function(e){var r;return r=function(n){(0,Fr.A)(i,n);var t=Xh(i);function i(u){var o;return(0,br.A)(this,i),o=t.call(this,u),o.handleDraggerMouseDown=function(s){var c=o.props.id,f=o.wrapper.current;o.props.onDragStart&&o.props.onDragStart(c,f,s)},o.wrapper=h.createRef(),o}return(0,Tr.A)(i,[{key:"render",value:function(){var o=this.props,s=o.isDraggingTempo,c=o.isDraggingMe,f=o.dragging,d=(0,hi.A)(o,zh),v=d.isTrueLocked,g={};c&&s&&(qu||(g={top:f.y,left:f.x,width:f.w}));var m=yn()(a,"group-or-rule",c&&s?"qb-draggable":null,c&&!s?"qb-placeholder":null,v?"locked":null);return h.createElement("div",{className:m,style:g,ref:this.wrapper,"data-id":this.props.id},h.createElement(e,(0,Cr.A)({handleDraggerMouseDown:this.handleDraggerMouseDown,isDraggingMe:c,isDraggingTempo:s},d)))}}]),i}(h.PureComponent),r.propTypes={isDraggingTempo:$().bool,isDraggingMe:$().bool,onDragStart:$().func,dragging:$().object,isLocked:$().bool,isTrueLocked:$().bool},r}};var Jh=y(73569),Oi=y.n(Jh),Qh=y(71086),Zh=y.n(Qh);function Sf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function ey(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Sf(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Sf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function ry(a){var e=ty();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function ty(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Of=gr.ConfigUtils,ny=Of.getFieldConfig,ay=Of.getOperatorConfig,Tf=function(a){(0,Fr.A)(r,a);var e=ry(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),_t((0,Qe.A)(t)),t.onPropsChanged(n),t}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){var i=this.props,u=["config","selectedField","selectedFieldSrc","selectedFieldType","selectedOperator"],o=!this.meta||u.map(function(s){return t[s]!==i[s]}).filter(function(s){return s}).length>0;o&&(this.meta=this.getMeta(t))}},{key:"getMeta",value:function(t){var i,u=t.config,o=t.selectedField,s=t.selectedFieldType,c=t.selectedOperator,f=ny(u,o),d=(0,we.A)(f?.operators||((i=u.types[s])===null||i===void 0?void 0:i.operators)||[]);!o&&!d.includes(c)&&d.push(c);var v=Fo()(Zh()(u.operators,function(F,k){return d?.indexOf(k)!==-1}),function(F,k){return ay(u,k,o)}),g=this.buildOptions(u,v,d),m=v[c]||{},E=this.props.config.settings.operatorPlaceholder,O=c,R=O?[O]:null,w=R,P=m.label;return{placeholder:E,items:g,selectedKey:O,selectedKeys:R,selectedPath:w,selectedLabel:P,selectedOpts:m,fieldConfig:f}}},{key:"buildOptions",value:function(t,i,u){return!i||!u?null:Oi()(i).sort(function(o,s){return u.indexOf(o)-u.indexOf(s)}).map(function(o){var s=i[o],c=s.label;return{key:o,path:o,label:c}})}},{key:"render",value:function(){var t=this.props,i=t.config,u=t.customProps,o=t.setOperator,s=t.readonly,c=t.id,f=t.groupId,d=i.settings.renderOperator,v=ey({id:c,groupId:f,config:i,customProps:u,readonly:s,setField:o},this.meta);return v.items?d(v,i.ctx):null}}]),r}(h.Component);Tf.propTypes={id:$().string,groupId:$().string,config:$().object.isRequired,selectedField:$().any,selectedFieldType:$().string,selectedFieldSrc:$().string,selectedOperator:$().string,readonly:$().bool,setOperator:$().func.isRequired};var iy=["children"],dt=function(e){var r=e.children,n=(0,hi.A)(e,iy);return h.createElement("div",n,r)},on=function(){},Af=function(){return h.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"gray",width:"18px",height:"18px"},h.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),h.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))},Ti=function(e){return function(r){var n=r.config.settings.useConfirm,t=n?n.call(r.config.ctx,r.config.ctx):null;return h.createElement(e,(0,Cr.A)({},r,{confirmFn:t}))}};function oy(a){var e=uy();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function uy(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Rf=function(a){(0,Fr.A)(r,a);var e=oy(r);function r(){return(0,br.A)(this,r),e.apply(this,arguments)}return(0,Tr.A)(r,[{key:"render",value:function(){var t=this.props,i=t.config,u=t.selectedField,o=t.selectedFieldSrc,s=t.selectedFieldType,c=t.selectedOperator,f=t.setOperator,d=t.selectedFieldParts,v=t.showOperator,g=t.showOperatorLabel,m=t.selectedFieldWidgetConfig,E=t.readonly,O=t.id,R=t.groupId,w=v&&h.createElement(dt,{key:"operators-for-"+(d||[]).join("_"),className:"rule--operator"},i.settings.showLabels&&h.createElement("label",{className:"rule--label"},i.settings.operatorLabel),h.createElement(Tf,{key:"operator",config:i,selectedField:u,selectedFieldSrc:o,selectedFieldType:s,selectedOperator:c,setOperator:f,readonly:E,id:O,groupId:R})),P=g&&h.createElement(dt,{key:"operators-for-"+(d||[]).join("_"),className:"rule--operator"},h.createElement("div",{className:"rule--operator-wrapper"},i.settings.showLabels?h.createElement("label",{className:"rule--label"},"\xA0"):null,h.createElement("div",{className:"rule--operator-text-wrapper"},h.createElement("span",{className:"rule--operator-text"},m.operatorInlineLabel))));return[w,P]}}]),r}(h.PureComponent);function Cf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function sy(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cf(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Cf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function ly(a){var e=cy();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function cy(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Lf=gr.RuleUtils.getFieldPathLabels,Ju=gr.ConfigUtils,If=Ju.getFieldConfig,bf=Ju.getFieldParts,Ff=Ju.getFieldPathParts,Nf=function(a){(0,Fr.A)(r,a);var e=ly(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),_t((0,Qe.A)(t)),t.onPropsChanged(n),t}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){var i=this.props,u=["selectedField","selectedFieldSrc","selectedFieldType","config","parentField"],o=!this.meta||u.map(function(s){return t[s]!==i[s]}).filter(function(s){return s}).length>0;o&&(this.meta=this.getMeta(t))}},{key:"getMeta",value:function(t){var i=t.selectedField,u=t.selectedFieldType,o=t.config,s=t.parentField,c=i,f=o.settings,d=f.maxLabelsLength,v=f.fieldSeparatorDisplay,g=f.fieldPlaceholder,m=f.fieldSeparator,E=!!i,O=E?null:Vo(g,d),R=E?If(o,c):null,w=R||{},P=Ff(c,o),F=Ff(c,o,!0),k=this.getFieldLabel(R,c,o),W=Lf(c,o),q=W?W.join(v):null;(q==k||s)&&(q=null);var re=w.label2,Z=bf(s,o),J=s?If(o,s):null,te=s?J&&J.subfields:o.fields,le=!E&&u,ee=this.buildOptions(Z,o,te,le,Z),ie=le?"Please select field":null;return{placeholder:O,items:ee,parentField:s,selectedKey:c,selectedKeys:P,selectedPath:F,selectedLabel:k,selectedOpts:w,selectedAltLabel:re,selectedFullLabel:q,errorText:ie}}},{key:"getFieldLabel",value:function(t,i,u){if(!i)return null;var o=u.settings.maxLabelsLength,s=bf(i,u),c=t?.label||Ao()(s);return c=Vo(c,o),c}},{key:"buildOptions",value:function(t,i,u){var o=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0,c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,f=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;if(!u)return null;var d=i.settings,v=d.fieldSeparator,g=d.fieldSeparatorDisplay,m=c!=null&&c.length?c.join(v)+v:"",E=function O(R){return Object.keys(R||{}).reduce(function(w,P){var F=R[P];return F.type==="!struct"?w+O(F.subfields):w+(F.type===s?1:0)},0)};return Oi()(u).map(function(O){var R=[].concat((0,we.A)(c??[]),[O]),w=u[O],P=o.getFieldLabel(w,R,i),F=Lf(R,i),k=F.join(g);(k==P||t!=null&&t.length)&&(k=null);var W=w.label2,q=w.tooltip,re=w.disabled;if(!w.hideForSelect)if(w.type=="!struct"){var Z=o.buildOptions(t,i,w.subfields,s,R,{label:P,tooltip:q}),J=E(w.subfields)>0;return{disabled:re,key:O,path:m+O,label:P,fullLabel:k,altLabel:W,tooltip:q,items:Z,matchesType:J}}else{var te=s!==void 0?w.type===s:void 0;return{disabled:re,key:O,path:m+O,label:P,fullLabel:k,altLabel:W,tooltip:q,grouplabel:f?.label,group:f,matchesType:te}}}).filter(function(O){return!!O})}},{key:"render",value:function(){var t=this.props,i=t.config,u=t.customProps,o=t.setField,s=t.setFieldSrc,c=t.readonly,f=t.id,d=t.groupId,v=i.settings.renderField,g=sy({id:f,groupId:d,config:i,customProps:u,readonly:c,setField:o,setFieldSrc:s},this.meta);return v(g,i.ctx)}}]),r}(h.Component);Nf.propTypes={id:$().string,groupId:$().string,config:$().object.isRequired,selectedField:$().any,selectedFieldSrc:$().string,selectedFieldType:$().string,parentField:$().string,customProps:$().object,readonly:$().bool,setField:$().func.isRequired,setFieldSrc:$().func};function wf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function fy(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wf(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):wf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function dy(a){var e=py();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function py(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vy=gr.clone,jo=gr.ConfigUtils,Pf=jo.getFieldConfig,_f=jo.getFuncConfig,gy=jo.getFieldParts,Df=jo.getFieldPathParts,Mf=gr.RuleUtils,Vf=Mf.getFuncPathLabels,my=Mf.getWidgetForFieldOp,jf=function(a){(0,Fr.A)(r,a);var e=dy(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),_t((0,Qe.A)(t)),t.onPropsChanged(n),t}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){var i=this.props,u=["config","field","fieldType","fieldSrc","operator","isFuncArg","isLHS"],o=["config","field","fieldType","fieldSrc","value","isLHS"],s=!this.items||u.map(function(f){return t[f]!==i[f]}).filter(function(f){return f}).length>0,c=!this.meta||o.map(function(f){return t[f]!==i[f]}).filter(function(f){return f}).length>0;c&&(this.meta=this.getMeta(t)),s&&(this.items=this.getItems(t,this.meta))}},{key:"getItems",value:function(t,i){var u=t.config,o=t.field,s=t.fieldType,c=t.isLHS,f=t.operator,d=t.parentFuncs,v=t.fieldDefinition,g=t.isFuncArg,m=i.lookingForFieldType,E=u.settings.canUseFuncForField,O=this.filterFuncs(u,u.funcs,o,s,c,f,E,d,g,v),R=this.buildOptions(u,O,m);return R}},{key:"getMeta",value:function(t){var i,u=t.config,o=t.field,s=t.fieldType,c=t.value,f=t.isLHS,d=t.isFuncArg,v=u.settings,g=v.funcPlaceholder,m=v.fieldSeparatorDisplay,E=c,O=!!c,R=Pf(u,o),w=R==null||(i=R.widgets)===null||i===void 0?void 0:i.field,P=w&&w.widgetProps||{},F=O?null:g,k=O?_f(u,E):null,W=k||{},q=Df(E,u),re=Df(E,u,!0),Z=this.getFuncLabel(k,E,u),J=Vf(E,u),te=J?J.join(m):null;te==Z&&(te=null);var le=f&&!d,ee=le&&!O&&s,ie=ee?"Please select function":null;return{placeholder:F,selectedKey:E,selectedKeys:q,selectedPath:re,selectedLabel:Z,selectedOpts:W,selectedFullLabel:te,errorText:ie,lookingForFieldType:ee}}},{key:"filterFuncs",value:function(t,i,u,o,s,c,f,d,v,g){i=vy(i);var m=t.settings.fieldSeparator,E=Pf(t,u),O=!1,R,w=E,P=my(t,u,c,"value"),F=P&&t.widgets[P];v?(w=g,R=g?.type):O&&F?R=F.type:E?R=E.type:s||(R=o);function k(W,q){for(var re in W){var Z=W[re].subfields,J=(q||[]).concat(re),te=J.join(m),le=_f(t,te);if(le.type=="!struct")k(Z,J)==0&&delete W[re];else{var ee,ie=!R||le.returnType==R;(ee=w)!==null&&ee!==void 0&&ee.funcs&&(ie=ie&&w.funcs.includes(te)),f&&(ie=ie&&f(u,E,te,le,c)),!le.allowSelfNesting&&d&&d.map(function(oe){var pe=(0,qe.A)(oe,2),se=pe[0],de=pe[1];return se}).includes(te)&&(ie=!1),ie||delete W[re]}}return Oi()(W).length}return k(i,[]),i}},{key:"buildOptions",value:function(t,i){var u=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!i)return null;var f=t.settings,d=f.fieldSeparator,v=f.fieldSeparatorDisplay,g=s!=null&&s.length?s.join(d)+d:"",m=function E(O){return Object.keys(O||{}).reduce(function(R,w){var P=O[w];return P.type==="!struct"?R+E(P.subfields):R+(P.type===o?1:0)},0)};return Oi()(i).map(function(E){var O=[].concat((0,we.A)(s??[]),[E]),R=i[E],w=u.getFuncLabel(R,O,t),P=Vf(O,t),F=P.join(v);F==w&&(F=null);var k=R.tooltip;if(R.type=="!struct"){var W=u.buildOptions(t,R.subfields,o,O,{label:w,tooltip:k}),q=m(R.subfields)>0;return{key:E,path:g+E,label:w,fullLabel:F,tooltip:k,items:W,matchesType:q}}else{var re=o!==void 0?R.returnType===o:void 0;return{key:E,path:g+E,label:w,fullLabel:F,tooltip:k,grouplabel:c?.label,group:c,matchesType:re}}})}},{key:"getFuncLabel",value:function(t,i,u){if(!i)return null;var o=u.settings.fieldSeparator,s=u.settings.maxLabelsLength,c=gy(i,u),f=t?.label||Ao()(c);return f=Vo(f,s),f}},{key:"render",value:function(){var t=this.props,i=t.config,u=t.customProps,o=t.setValue,s=t.readonly,c=t.id,f=t.groupId,d=i.settings.renderFunc,v=fy({config:i,customProps:u,readonly:s,setField:o,items:this.items,id:c,groupId:f},this.meta);return d(v,i.ctx)}}]),r}(h.Component);jf.propTypes={id:$().string,groupId:$().string,config:$().object.isRequired,field:$().any,fieldType:$().string,fieldSrc:$().string,operator:$().string,customProps:$().object,value:$().string,setValue:$().func.isRequired,readonly:$().bool,parentFuncs:$().array,fieldDefinition:$().object,isFuncArg:$().bool,isLHS:$().bool};var hy=y(23181),Qu=y.n(hy),yy=["factory"];function kf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Zu(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kf(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):kf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var xf=gr.ListUtils.getTitleInListValues,Ey=gr.ConfigUtils._widgetDefKeysToOmit;const Sy=function(a){var e=a.delta,r=a.isFuncArg,n=a.valueSrc,t=a.value,i=a.valueError,u=a.asyncListValues,o=a.isSpecialRange,s=a.fieldDefinition,c=a.widget,f=a.widgetDefinition,d=a.widgetValueLabel,v=a.valueLabels,g=a.textSeparators,m=a.setValueHandler,E=a.config,O=a.field,R=a.fieldSrc,w=a.fieldType,P=a.isLHS,F=a.operator,k=a.readonly,W=a.parentField,q=a.parentFuncs,re=a.id,Z=a.groupId,J=f.factory,te=(0,hi.A)(f,yy),le=r&&s.valueSources&&s.valueSources.length==1&&s.valueSources[0]=="const",ee=s.defaultValue;if(!J)return"?";var ie=o?[t.get(0),t.get(1)]:t?t.get(e):void 0,oe=i&&(o?[i.get(0),i.get(1)]:i.get(e))||null;o&&ie[0]===void 0&&ie[1]===void 0&&(ie=void 0);var pe=s||{},se=pe.fieldSettings,de=jr()(Zu(Zu(Zu({},te),se),{},{config:E,field:O,fieldSrc:R,fieldType:w,isLHS:P,parentField:W,parentFuncs:q,fieldDefinition:s,operator:F,delta:e,isSpecialRange:o,isFuncArg:r,value:ie,valueError:oe,label:d.label,placeholder:d.placeholder,placeholders:v?v.placeholder:null,textSeparators:g,setValue:m,readonly:k,asyncListValues:u,id:re,groupId:Z}),[].concat((0,we.A)(Ey),["toJS"]));if(c=="field",le&&ee){var ge=se?.treeValues||se?.listValues;return typeof ee=="boolean"?ee?de.labelYes||"YES":de.labelNo||"NO":ge?Array.isArray(ee)?ee.map(function(Fe){return xf(ge,Fe)||Fe}).join(", "):xf(ge,ee)||ee:""+ee}return J(de,E.ctx)};function Oy(a){var e=Ty();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function Ty(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var es=gr.ConfigUtils,Ay=es.getFieldConfig,Ry=es.getOperatorConfig,Uf=es.getFieldWidgetConfig,rs=gr.RuleUtils,Cy=rs.getValueSourcesForFieldOp,Gf=rs.getWidgetForFieldOp,ko=rs.getValueLabel,Bf=gr.DefaultUtils.createListFromArray,Ly={cardinality:1},Yi=function(a){(0,Fr.A)(r,a);var e=Oy(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),t._setValue=function(i,u,o,s,c,f){if(i&&Array.isArray(s)){var d=[t.props.value.get(0),t.props.value.get(1)];d[0]!=s[0]&&t.props.setValue(0,s[0],o,c,f),d[1]!=s[1]&&t.props.setValue(1,s[1],o,c,f)}else t.props.setValue(u,s,o,c,f)},t._onChangeValueSrc=function(i,u){t.props.setValueSrc(i,u)},t.renderWidget=function(i,u,o){var s=o.config,c=o.isFuncArg,f=o.leftField,d=o.operator,v=o.value,g=o.valueError,m=o.readonly,E=o.parentField,O=o.parentFuncs,R=o.id,w=o.groupId,P=o.fieldSrc,F=o.fieldType,k=o.isLHS,W=s.settings,q=u.widgets,re=u.iValues,Z=u.aField,J=u.valueSources,te=c?re:v,le=c?f:Z,ee=q[i],ie=ee.valueSrc,oe=ee.valueLabel,pe=J.length>1&&!m,se=W.showLabels?h.createElement("label",{className:"rule--label"},oe.label):null;return h.createElement("div",{key:"widget-"+le+"-"+i,className:yn()(ie=="func"?"widget--func":"widget--widget",pe?"widget--has-valuerscs":"widget--has-no-valuerscs")},ie=="func"?null:se,h.createElement(Sy,(0,Cr.A)({id:R,groupId:w,valueSrc:ie,delta:i,value:te,valueError:g,isFuncArg:c,isLHS:k},nn()(u,["isSpecialRange","fieldDefinition","asyncListValues"]),nn()(q[i],["widget","widgetDefinition","widgetValueLabel","valueLabels","textSeparators","setValueHandler"]),{config:s,field:le,fieldSrc:P,fieldType:F,parentField:E,parentFuncs:O,operator:d,readonly:m})))},t.renderValueSources=function(i,u,o){var s=o.config,c=o.isFuncArg,f=o.leftField,d=o.operator,v=o.readonly,g=s.settings,m=u.valueSources,E=u.widgets,O=u.aField,R=c?f:O,w=E[i],P=w.valueSrc,F=w.setValueSrcHandler,k=g.valueSourcesInfo,W=g.renderValueSources,q=m.map(function(J){return[J,{label:k[J].label}]}),re=function(te){return W(te,s.ctx)},Z=g.showLabels?h.createElement("label",{className:"rule--label"},"\xA0"):null;return m.length>1&&!v&&h.createElement("div",{key:"valuesrc-"+R+"-"+i,className:"widget--valuesrc"},Z,h.createElement(re,{key:"valuesrc-"+i,delta:i,valueSources:q,valueSrc:P,config:s,field:R,operator:d,setValueSrc:F,readonly:v,title:g.valueSourcesPopupTitle}))},t.renderSep=function(i,u,o){var s=o.config,c=u.widgets,f=s.settings,d=c[i].sepText,v=f.showLabels?h.createElement("label",{className:"rule--label"},"\xA0"):null;return d&&h.createElement("div",{key:"widget-separators-"+i,className:yn()("widget--sep",i==0&&"widget--sep-first")},v,h.createElement("span",null,d))},t.renderWidgetDelta=function(i){var u=t.renderSep(i,t.meta,t.props),o=t.renderValueSources(i,t.meta,t.props),s=t.renderWidget(i,t.meta,t.props);return[u,o,s]},_t((0,Qe.A)(t)),t.onPropsChanged(n),t}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){var i=this.props,u=["config","field","fieldSrc","fieldType","fieldFunc","fieldArg","leftField","operator","valueSrc","isFuncArg","asyncListValues","isLHS"],o=!this.meta||u.map(function(s){return t[s]!==i[s]||s=="isFuncArg"&&t.isFuncArg&&t.value!==i.value}).filter(function(s){return s}).length>0;o&&(this.meta=this.getMeta(t))}},{key:"getMeta",value:function(t){var i=this,u=t.config,o=t.field,s=t.fieldSrc,c=t.fieldType,f=t.fieldFunc,d=t.fieldArg,v=t.operator,g=t.valueSrc,m=t.value,E=t.isForRuleGroup,O=t.isCaseValue,R=t.isFuncArg,w=t.leftField,P=t.asyncListValues,F=R?{func:f,arg:d}:o,k=!o&&c,W=g,q=m;(R||E||O)&&(W=Bf([g]),q=Bf([m]));var re=Ay(u,F);!re&&k&&(re=u.types[c]);var Z=Gf(u,F,v);if(!Z&&k){var J;Z=(J=u.types[c])===null||J===void 0?void 0:J.mainWidget}var te=R?Ly:Ry(u,v,F);if((re==null||te==null)&&!O)return null;var le=te?.isSpecialRange,ee=le&&(W.get(0)=="field"||W.get(1)=="field"),ie=le&&!ee,oe=ie?1:Th(te?.cardinality,1);if(oe===0)return null;var pe=Cy(u,F,v,re);F||(pe=Object.keys(u.settings.valueSourcesInfo));var se=Qu()(0,oe).map(function(de){var ge,Fe=W.get(de)||null,De=Gf(u,F,v,Fe),ke=Uf(u,F,v,De,Fe);ee&&(De=ke.singleWidget,ke=Uf(u,F,v,De,Fe)),!ke&&k&&(De=["func","field"].includes(Fe)?Fe:Z,ke=u.widgets[De]);var Oe=(ge=ke)===null||ge===void 0?void 0:ge.type,je=ko(u,F,v,de,Fe,ie),Je=ko(u,F,v,de,null,ie),xe=te!=null&&te.textSeparators?te?.textSeparators[de]:null,Ze=i._onChangeValueSrc.bind(i,de),Ye=null,mr=null;le&&(Ye=[ko(u,F,v,0),ko(u,F,v,1)],Ye={placeholder:[Ye[0].placeholder,Ye[1].placeholder],label:[Ye[0].label,Ye[1].label]},mr=te?.textSeparators);var Or=i._setValue.bind(i,le,de,Oe);return{valueSrc:Fe,valueLabel:je,widget:De,sepText:xe,setValueSrcHandler:Ze,widgetDefinition:ke,widgetValueLabel:Je,valueLabels:Ye,textSeparators:mr,setValueHandler:Or}});return{defaultWidget:Z,fieldDefinition:re,operatorDefinition:te,isSpecialRange:ie,cardinality:oe,valueSources:pe,widgets:se,iValues:q,aField:F,asyncListValues:P}}},{key:"render",value:function(){if(!this.meta)return null;var t=this.meta,i=t.defaultWidget,u=t.cardinality;if(!i)return null;var o=i;return h.createElement(dt,{className:"rule--widget rule--widget--".concat(o.toUpperCase()),key:"widget-col-"+o},Qu()(0,u).map(this.renderWidgetDelta))}}]),r}(h.Component);Yi.propTypes={config:$().object.isRequired,value:$().any,valueSrc:$().any,valueError:$().any,field:$().any,fieldSrc:$().string,fieldType:$().string,operator:$().string,readonly:$().bool,asyncListValues:$().array,id:$().string,groupId:$().string,setValue:$().func,setValueSrc:$().func,isFuncArg:$().bool,fieldFunc:$().string,fieldArg:$().string,leftField:$().any,isForRuleGroup:$().bool,parentField:$().string,parentFuncs:$().array,isLHS:$().bool,isCaseValue:$().bool};function Wf(a){var e=Iy();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function Iy(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var by=gr.ConfigUtils.getFuncConfig,ts=gr.FuncUtils,Fy=ts.setFunc,Ny=ts.setArgValue,wy=ts.setArgValueSrc,ns=function(a){(0,Fr.A)(r,a);var e=Wf(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),t.setFunc=function(i){t.props.setValue(Fy(t.props.value,i,t.props.config))},t.setArgValue=function(i,u,o,s){var c=t.props.config,f=t.meta.funcDefinition,d=f.args,v=d[i];t.props.setValue(Ny(t.props.value,i,u,v,c),o,s)},t.setArgValueSrc=function(i,u){var o=t.props.config,s=t.meta.funcDefinition,c=s.args,f=c[i];t.props.setValue(wy(t.props.value,i,u,f,o))},t.renderFuncSelect=function(){var i=t.props,u=i.config,o=i.field,s=i.fieldType,c=i.fieldSrc,f=i.isLHS,d=i.operator,v=i.customProps,g=i.value,m=i.readonly,E=i.parentFuncs,O=i.id,R=i.groupId,w=i.isFuncArg,P=i.fieldDefinition,F=g?g.get("func"):null,k={value:F,setValue:t.setFunc,config:u,field:o,fieldType:s,fieldSrc:c,isLHS:f,operator:d,customProps:v,readonly:m,parentFuncs:E,isFuncArg:w,fieldDefinition:P,id:O,groupId:R},W=u.settings,q=W.showLabels,re=W.funcLabel,Z=q?h.createElement("label",{className:"rule--label"},re):null;return h.createElement(dt,{key:"func",className:"rule--func"},Z,h.createElement(jf,k))},t.renderArgLabel=function(i,u){var o=u.valueSources,s=u.type,c=u.showPrefix,f=u.label,d=t.props.config,v=o&&o.length==1&&o[0]=="const",g=!d.settings.showLabels&&(s=="boolean"||v)&&c;return g?h.createElement(dt,{className:"rule--func--arg-label"},f||i):null},t.renderArgLabelSep=function(i,u){var o=u.valueSources,s=u.type,c=u.showPrefix,f=t.props.config,d=o&&o.length==1&&o[0]=="const",v=!f.settings.showLabels&&(s=="boolean"||d)&&c;return v?h.createElement(dt,{className:"rule--func--arg-label-sep"},":"):null},t.renderArgVal=function(i,u,o){var s=t.props,c=s.config,f=s.field,d=s.fieldType,v=s.fieldSrc,g=s.isLHS,m=s.operator,E=s.value,O=s.readonly,R=s.parentFuncs,w=s.id,P=s.groupId,F=E?E.getIn(["args",u]):null,k=F?F.get("value"):void 0,W=o.valueSources.length==1?o.valueSources[0]:void 0,q=F?F.get("valueSrc")||W||"value":W,re={config:c,fieldFunc:i,fieldArg:u,leftField:f,fieldType:d,fieldSrc:v,isLHS:g,operator:null,value:k,valueSrc:q,setValue:t.setArgValue,setValueSrc:t.setArgValueSrc,funcKey:i,argKey:u,argDefinition:o,readonly:O,parentFuncs:R,id:w,groupId:P};return h.createElement(dt,{className:"rule--func--arg-value"},h.createElement($f,re))},t.renderArgSep=function(i,u,o,s){var c=s.renderSeps;return o?h.createElement(dt,{className:"rule--func--arg-sep"},c?c[o-1]:", "):null},t.renderBracketBefore=function(i){var u=i.renderBrackets;return h.createElement(dt,{key:"before_args",className:"rule--func--bracket-before"},u?u[0]:"(")},t.renderBracketAfter=function(i){var u=i.renderBrackets;return h.createElement(dt,{key:"after_args",className:"rule--func--bracket-after"},u?u[1]:")")},t.renderFuncArgs=function(){var i=t.meta,u=i.funcDefinition,o=i.funcKey;if(!o)return null;var s=u||{},c=s.args;return c?h.createElement(h.Fragment,null,t.renderBracketBefore(u),h.createElement(dt,{key:"args",className:"rule--func--args"},Object.keys(c).map(function(f,d){return h.createElement(dt,{key:"arg-".concat(f,"-").concat(d),className:"rule--func--arg"},t.renderArgSep(f,c[f],d,u),t.renderArgLabel(f,c[f]),t.renderArgLabelSep(f,c[f]),t.renderArgVal(o,f,c[f]))})),t.renderBracketAfter(u)):null},_t((0,Qe.A)(t)),t.onPropsChanged(n),t}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){var i=this.props,u=["config","field","operator","value","fieldSrc","fieldType","isLHS"],o=!this.meta||u.map(function(s){return t[s]!==i[s]}).filter(function(s){return s}).length>0;o&&(this.meta=this.getMeta(t))}},{key:"getMeta",value:function(t){var i=t.config,u=t.field,o=t.operator,s=t.value,c=s?s.get("func"):null,f=c?by(i,c):null;return{funcDefinition:f,funcKey:c}}},{key:"render",value:function(){return h.createElement(dt,{className:"rule--func--wrapper"},this.renderFuncSelect(),this.renderFuncArgs())}}]),r}(h.Component);ns.propTypes={id:$().string,groupId:$().string,config:$().object.isRequired,field:$().any,fieldSrc:$().string,fieldType:$().string,operator:$().string,customProps:$().object,value:$().object,setValue:$().func.isRequired,readonly:$().bool,parentFuncs:$().array,fieldDefinition:$().object,isFuncArg:$().bool,isLHS:$().bool};var $f=function(a){(0,Fr.A)(r,a);var e=Wf(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),t.setValue=function(i,u,o,s,c){var f=t.props,d=f.setValue,v=f.argKey;d(v,u,s,c)},t.setValueSrc=function(i,u,o){var s=t.props,c=s.setValueSrc,f=s.argKey;c(f,u)},_t((0,Qe.A)(t)),t.onPropsChanged(n),t}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){var i=this.props,u=["parentFuncs","funcKey","argKey"],o=!this.meta||u.map(function(s){return t[s]!==i[s]}).filter(function(s){return s}).length>0;o&&(this.meta=this.getMeta(t))}},{key:"getMeta",value:function(t){var i=t.parentFuncs,u=t.funcKey,o=t.argKey,s=[].concat((0,we.A)(i||[]),[[u,o]]);return{parentFuncs:s}}},{key:"render",value:function(){var t=this.meta.parentFuncs;return h.createElement(Yi,(0,Cr.A)({},this.props,{setValue:this.setValue,setValueSrc:this.setValueSrc,isFuncArg:!0,parentFuncs:t}))}}]),r}(h.Component);$f.propTypes={funcKey:$().string.isRequired,argKey:$().string.isRequired,setValue:$().func.isRequired,setValueSrc:$().func.isRequired,readonly:$().bool,isLHS:$().bool,parentFuncs:$().array,id:$().string,groupId:$().string};function Py(a){var e=_y();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function _y(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var as=function(a){(0,Fr.A)(r,a);var e=Py(r);function r(){var n;(0,br.A)(this,r);for(var t=arguments.length,i=new Array(t),u=0;u<t;u++)i[u]=arguments[u];return n=e.call.apply(e,[this].concat(i)),n.renderField=function(){var o=n.props,s=o.config,c=o.classname,f=o.selectedField,d=o.selectedFieldSrc,v=o.selectedFieldType,g=o.setField,m=o.parentField,E=o.readonly,O=o.id,R=o.groupId,w=["func","field"];if(!w.includes(d))return"?";var P=d==="func"?h.createElement(ns,{isLHS:!0,config:s,value:f,fieldSrc:d,fieldType:v,parentField:m,setValue:g,readonly:E,id:O,groupId:R,key:"field-func-"+O}):h.createElement(Nf,{config:s,selectedField:f,selectedFieldSrc:d,selectedFieldType:v,parentField:m,setField:g,customProps:s.settings.customFieldSelectProps,readonly:E,id:O,groupId:R,key:"field-"+O}),F=d==="func"?s.settings.funcLabel:s.settings.fieldLabel,k=s.settings.showLabels&&d!=="func"&&h.createElement("label",{className:"rule--label"},F);return h.createElement("div",{key:d,className:c},k,P)},n.renderFieldSources=function(){var o=n.props,s=o.config,c=o.readonly,f=o.selectedFieldSrc,d=o.setFieldSrc,v=o.id,g=s.settings,m=g.fieldSources,E=g.valueSourcesInfo,O=g.renderValueSources,R=m.map(function(F){return[F,{label:E[F].label}]}),w=function(k){return O(k,s.ctx)},P=g.showLabels?h.createElement("label",{className:"rule--label"},"\xA0"):null;return m.length>1&&!c&&h.createElement("div",{key:"fieldsrc",className:"rule--fieldsrc"},P,h.createElement(w,{key:"fieldsrc-"+v,valueSources:R,valueSrc:f,config:s,setValueSrc:d,readonly:c,title:g.fieldSourcesPopupTitle}))},n}return(0,Tr.A)(r,[{key:"render",value:function(){var t=this.props,i=t.classname,u=t.canSelectFieldSource,o=u&&this.renderFieldSources(),s=this.renderField();return u?h.createElement(dt,{className:"rule--field-wrapper"},o,s):s}}]),r}(h.PureComponent),Dy=["factory"];function My(a){var e=Vy();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function Vy(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jy=gr.ConfigUtils.getOperatorConfig,Hf=function(a){(0,Fr.A)(r,a);var e=My(r);function r(){return(0,br.A)(this,r),e.apply(this,arguments)}return(0,Tr.A)(r,[{key:"render",value:function(){if(!this.props.selectedOperator)return null;var t=jy(this.props.config,this.props.selectedOperator,this.props.selectedField);if(typeof t.options>"u")return null;var i=t.options,u=i.factory,o=(0,hi.A)(i,Dy),s=Object.assign({},o,{config:this.props.config,field:this.props.selectedField,fieldSrc:this.props.selectedFieldSrc,operator:this.props.selectedOperator,options:this.props.operatorOptions,setOption:this.props.setOperatorOption,readonly:this.props.readonly}),c=u(s,this.props.config.ctx),f=this.props.selectedOperator;return h.createElement("div",{className:"rule--operator rule--operator--".concat(f.toUpperCase())},c)}}]),r}(h.PureComponent);Hf.propTypes={config:$().object.isRequired,operatorOptions:$().any.isRequired,selectedField:$().any,selectedFieldSrc:$().string,selectedOperator:$().string.isRequired,readonly:$().bool,setOperatorOption:$().func.isRequired};function Kf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Yf(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Kf(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Kf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function ky(a){var e=xy();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function xy(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var xo=gr.ConfigUtils,Uy=xo.getFieldConfig,Gy=xo.getOperatorConfig,By=xo.getFieldWidgetConfig,Wy=xo.getFieldParts,$y=gr.RuleUtils.isEmptyRuleProperties,zf=function(a){(0,Fr.A)(r,a);var e=ky(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),_t((0,Qe.A)(t)),t.removeSelf=t.removeSelf.bind((0,Qe.A)(t)),t.setLock=t.setLock.bind((0,Qe.A)(t)),t.onPropsChanged(n),t}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){var i=this.props,u=["selectedField","selectedFieldSrc","selectedFieldType","selectedOperator","config","reordableNodesCnt","isLocked"],o=!this.meta||u.map(function(s){return t[s]!==i[s]}).filter(function(s){return s}).length>0;o&&(this.meta=this.getMeta(t))}},{key:"getMeta",value:function(t){var i=t.selectedField,u=t.selectedFieldType,o=t.selectedOperator,s=t.config,c=t.reordableNodesCnt,f=t.isLocked,d=s.settings.keepInputOnChangeFieldSrc,v=Wy(i,s),g=Uy(s,i),m=g&&g.type=="!struct",E=d&&u,O=!!i||E,R=O&&o,w=Gy(s,o,i),P=w&&w.options!=null,F=By(s,i,o,null,null)||{},k=F.hideOperator,W=s.settings.canReorder&&c>1&&!f,q=O&&!k,re=O&&k&&F.operatorInlineLabel,Z=R&&!m,J=R&&P;return{selectedFieldParts:v,selectedFieldWidgetConfig:F,showDragIcon:W,showOperator:q,showOperatorLabel:re,showWidget:Z,showOperatorOptions:J}}},{key:"setLock",value:function(t){this.props.setLock(t)}},{key:"removeSelf",value:function(){var t=this,i=this.props,u=i.confirmFn,o=i.config,s=o.settings,c=s.renderConfirm,f=s.removeRuleConfirmOptions,d=function(){t.props.removeSelf()};f&&!this.isEmptyCurrentRule()?c.call(o.ctx,Yf(Yf({},f),{},{onOk:d,onCancel:null,confirmFn:u}),o.ctx):d()}},{key:"_buildWidgetProps",value:function(t){var i=t.selectedField,u=t.selectedFieldSrc,o=t.selectedFieldType,s=t.selectedOperator,c=t.operatorOptions,f=t.value,d=t.valueType,v=t.valueSrc,g=t.asyncListValues,m=t.valueError,E=t.parentField;return{field:i,fieldSrc:u,fieldType:o,operator:s,operatorOptions:c,value:f,valueType:d,valueSrc:v,asyncListValues:g,valueError:m,parentField:E}}},{key:"isEmptyCurrentRule",value:function(){var t=this.props.config,i=this._buildWidgetProps(this.props);return $y(i,t)}},{key:"renderField",value:function(){var t=this.props,i=t.config,u=t.isLocked,o=t.parentField,s=t.groupId,c=t.id,f=t.selectedFieldSrc,d=t.selectedField,v=t.selectedFieldType,g=t.setField,m=t.setFieldSrc,E=i.settings.immutableFieldsMode;return h.createElement(as,{key:"field",classname:yn()(f=="func"?"rule--field--func":"rule--field"),config:i,canSelectFieldSource:!o,selectedField:d,selectedFieldSrc:f,selectedFieldType:v,setField:E?on:g,setFieldSrc:E?on:m,parentField:o,readonly:E||u,id:c,groupId:s})}},{key:"renderOperator",value:function(){var t=this.props,i=t.config,u=t.isLocked,o=this.meta,s=o.selectedFieldParts,c=o.selectedFieldWidgetConfig,f=o.showOperator,d=o.showOperatorLabel,v=i.settings.immutableOpsMode;return h.createElement(Rf,{key:"operator",config:i,selectedField:this.props.selectedField,selectedFieldSrc:this.props.selectedFieldSrc,selectedFieldType:this.props.selectedFieldType,selectedOperator:this.props.selectedOperator,setOperator:v?on:this.props.setOperator,selectedFieldParts:s,showOperator:f,showOperatorLabel:d,selectedFieldWidgetConfig:c,readonly:v||u,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var t=this.props,i=t.config,u=t.isLocked,o=this.meta.showWidget,s=i.settings.immutableValuesMode;if(!o)return null;var c=h.createElement(Yi,(0,Cr.A)({key:"values"},this._buildWidgetProps(this.props),{config:i,setValue:s?on:this.props.setValue,setValueSrc:s?on:this.props.setValueSrc,readonly:s||u,id:this.props.id,groupId:this.props.groupId}));return h.createElement(dt,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},c)}},{key:"renderOperatorOptions",value:function(){var t=this.props.config,i=this.meta.showOperatorOptions,u=t.settings,o=u.immutableOpsMode,s=u.immutableValuesMode;if(!i)return null;var c=h.createElement(Hf,{key:"operatorOptions",selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,operatorOptions:this.props.operatorOptions,setOperatorOption:o?on:this.props.setOperatorOption,config:t,readonly:s});return h.createElement(dt,{key:"op-options-for-"+this.props.selectedOperator,className:"rule--operator-options"},c)}},{key:"renderBeforeWidget",value:function(){var t=this.props.config,i=t.settings.renderBeforeWidget;return i&&h.createElement(dt,{key:"before-widget-for-"+this.props.selectedOperator,className:"rule--before-widget"},typeof i=="function"?i(this.props,t.ctx):i)}},{key:"renderAfterWidget",value:function(){var t=this.props.config,i=t.settings.renderAfterWidget;return i&&h.createElement(dt,{key:"after-widget-for-"+this.props.selectedOperator,className:"rule--after-widget"},typeof i=="function"?i(this.props,t.ctx):i)}},{key:"renderError",value:function(){var t=this.props,i=t.config,u=t.valueError,o=i.settings,s=o.renderRuleError,c=o.showErrorMessage,f=u&&u.toArray().filter(function(d){return!!d}).shift()||null;return c&&f&&h.createElement("div",{className:"rule--error"},s?s({error:f},i.ctx):f)}},{key:"renderDrag",value:function(){var t=this.props.handleDraggerMouseDown,i=this.props.config,u=this.meta.showDragIcon,o=i.settings.renderIcon,s=function(d){return o?.(d,i.ctx)},c=h.createElement(s,{type:"drag"});return u&&h.createElement("div",{key:"rule-drag-icon",onMouseDown:t,className:"qb-drag-handler rule--drag-handler"},c)}},{key:"renderDel",value:function(){var t=this.props,i=t.config,u=t.isLocked,o=i.settings,s=o.deleteLabel,c=o.immutableGroupsMode,f=o.renderButton,d=o.renderIcon,v=o.canDeleteLocked,g=function(O){return d(O,i.ctx)},m=function(O){return f(O,i.ctx)};return!c&&(!u||u&&v)&&h.createElement(m,{type:"delRule",onClick:this.removeSelf,label:s,config:i,renderIcon:g})}},{key:"renderLock",value:function(){var t=this.props,i=t.config,u=t.isLocked,o=t.isTrueLocked,s=t.id,c=i.settings,f=c.lockLabel,d=c.lockedLabel,v=c.showLock,g=c.renderSwitch,m=function(O){return g(O,i.ctx)};return v&&!(u&&!o)&&h.createElement(m,{type:"lock",id:s,value:u,setValue:this.setLock,label:f,checkedLabel:d,hideLabel:!0,config:i})}},{key:"render",value:function(){var t=this.meta,i=t.showOperatorOptions,u=t.selectedFieldWidgetConfig,o=this.props,s=o.valueSrc,c=o.value,f=o.config,d=s.first()=="value"&&!i&&c.size==1&&u.fullWidth,v=f.settings.renderButtonGroup,g=function(k){return v(k,f.ctx)},m=[this.renderField(),this.renderOperator(),this.renderBeforeWidget(),this.renderWidget(),this.renderAfterWidget(),this.renderOperatorOptions()],E=h.createElement("div",{key:"rule-body",className:yn()("rule--body",d&&"can--shrink--value")},m),O=this.renderError(),R=this.renderDrag(),w=this.renderLock(),P=this.renderDel();return h.createElement(h.Fragment,null,R,h.createElement("div",{className:"rule--body--wrapper"},E,O),h.createElement("div",{className:"rule--header"},h.createElement(g,{config:f},w,P)))}}]),r}(h.Component);zf.propTypes={id:$().string.isRequired,groupId:$().string,selectedField:$().any,selectedFieldSrc:$().string,selectedFieldType:$().string,selectedOperator:$().string,operatorOptions:$().object,config:$().object.isRequired,value:$().any,valueSrc:$().any,valueType:$().any,asyncListValues:$().array,isDraggingMe:$().bool,isDraggingTempo:$().bool,parentField:$().string,valueError:$().any,isLocked:$().bool,isTrueLocked:$().bool,handleDraggerMouseDown:$().func,setField:$().func,setFieldSrc:$().func,setOperator:$().func,setOperatorOption:$().func,setLock:$().func,removeSelf:$().func,setValue:$().func,setValueSrc:$().func,reordableNodesCnt:$().number,totalRulesCnt:$().number,parentReordableNodesCnt:$().number};const Hy=Bh(Si("rule")(Ti(zf)));var Ky=y(22331),Yy=y.n(Ky);function zy(a){var e=Xy();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function Xy(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qy=gr.DefaultUtils.defaultGroupConjunction,Jy=function(e,r){var n;return n=function(t){(0,Fr.A)(u,t);var i=zy(u);function u(o){var s;return(0,br.A)(this,u),s=i.call(this,o),s._selectedConjunction=function(c){return c=c||s.props,c.conjunction||qy(c.config,c.field)},s.setConjunction=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;s.props.actions.setConjunction(s.props.path,c)},s.setNot=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;s.props.actions.setNot(s.props.path,c)},s.setLock=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;s.props.actions.setLock(s.props.path,c)},s.dummyFn=function(){},s.removeSelf=function(){s.props.actions.removeGroup(s.props.path)},s.addGroup=function(){s.props.actions.addGroup(s.props.path)},s.addCaseGroup=function(){s.props.actions.addCaseGroup(s.props.path)},s.addDefaultCaseGroup=function(){s.props.actions.addDefaultCaseGroup(s.props.path)},s.addRule=function(){var c=r=="rule_group"?s.props.field:null;s.props.actions.addRule(s.props.path,void 0,void 0,void 0,c)},s.setField=function(c,f,d){s.props.actions.setField(s.props.path,c,f,d)},s.setOperator=function(c){s.props.actions.setOperator(s.props.path,c)},s.setValue=function(c,f,d){s.props.actions.setValue(s.props.path,c,f,d)},s.pureShouldComponentUpdate=Ei((0,Qe.A)(s)),_t((0,Qe.A)(s)),s.selectedConjunction=s._selectedConjunction(o),s.conjunctionOptions=s._getConjunctionOptions(o),s.dummyFn.isDummyFn=!0,s}return(0,Tr.A)(u,[{key:"shouldComponentUpdate",value:function(s,c){var f=this.props,d=this.state,v=this.pureShouldComponentUpdate(s,c);if(v&&d==c&&f!=s){var g=s.dragging.id||f.dragging.id,m=g==s.id,E=[];for(var O in s){var R=s[O]!=f[O];O=="dragging"&&!m&&(R=!1),R&&E.push(O)}E.length||(v=!1)}return v}},{key:"onPropsChanged",value:function(s){var c=s.config,f=s.id,d=s.conjunction,v=this.props.config,g=this.props.conjunction;(v!=c||g!=d)&&(this.selectedConjunction=this._selectedConjunction(s),this.conjunctionOptions=this._getConjunctionOptions(s))}},{key:"_getConjunctionOptions",value:function(s){var c=this;return Fo()(s.config.conjunctions,function(f,d){return{id:"conjunction-".concat(s.id,"-").concat(d),name:"conjunction[".concat(s.id,"]"),key:d,label:f.label,checked:d===c._selectedConjunction(s)}})}},{key:"render",value:function(){var s=this.props.dragging.id==this.props.id,c=this.props.path.size,f=this.props.config.settings.maxNesting,d=!s&&this.props.isDraggingTempo,v=this.props.fieldType||null,g=typeof f>"u"||c<f,m=c==1;return h.createElement("div",{className:"group-or-rule-container group-container","data-id":this.props.id},[s?h.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,isRoot:m,allowFurtherNesting:g,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:this.dummyFn,setNot:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,addGroup:this.dummyFn,addCaseGroup:this.dummyFn,addDefaultCaseGroup:this.dummyFn,addRule:this.dummyFn,setField:this.dummyFn,setOperator:this.dummyFn,setValue:this.dummyFn,value:this.props.value||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:v,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,h.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:s,isDraggingTempo:d,onDragStart:this.props.onDragStart,isRoot:m,allowFurtherNesting:g,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:d?this.dummyFn:this.setConjunction,setNot:d?this.dummyFn:this.setNot,setLock:d?this.dummyFn:this.setLock,removeSelf:d?this.dummyFn:this.removeSelf,addGroup:d?this.dummyFn:this.addGroup,addCaseGroup:d?this.dummyFn:this.addCaseGroup,addDefaultCaseGroup:d?this.dummyFn:this.addDefaultCaseGroup,addRule:d?this.dummyFn:this.addRule,setField:d?this.dummyFn:this.setField,setOperator:d?this.dummyFn:this.setOperator,setValue:d?this.dummyFn:this.setValue,value:this.props.value||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:v,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}]),u}(h.Component),n.propTypes={config:$().object.isRequired,actions:$().object.isRequired,path:$().any.isRequired,id:$().string.isRequired,groupId:$().string,not:$().bool,conjunction:$().string,children1:$().any,onDragStart:$().func,reordableNodesCnt:$().number,field:$().any,fieldSrc:$().string,fieldType:$().string,parentField:$().string,isLocked:$().bool,isTrueLocked:$().bool,dragging:$().object,isDraggingTempo:$().bool},n};const zi=function(a,e){var r=Po(function(n){return{dragging:n.dragging}},null,null,{context:Ki})(Jy(a,e));return r.displayName="ConnectedGroupContainer",r};function Qy(a){var e=Zy();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function Zy(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var eE={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},rE="topRight",Xf=function(a){(0,Fr.A)(r,a);var e=Qy(r);function r(){return(0,br.A)(this,r),e.apply(this,arguments)}return(0,Tr.A)(r,[{key:"render",value:function(){var t=this.props,i=t.config,u=t.addRule,o=t.addGroup,s=t.removeSelf,c=t.setLock,f=t.isLocked,d=t.isTrueLocked,v=t.id,g=t.canAddGroup,m=t.canAddRule,E=t.canDeleteGroup,O=i.settings,R=O.immutableGroupsMode,w=O.addRuleLabel,P=O.addGroupLabel,F=O.delGroupLabel,k=O.groupActionsPosition,W=O.renderButton,q=O.renderIcon,re=O.renderSwitch,Z=O.renderButtonGroup,J=O.lockLabel,te=O.lockedLabel,le=O.showLock,ee=O.canDeleteLocked,ie=function(je){return q(je,i.ctx)},oe=function(je){return W(je,i.ctx)},pe=function(je){return re(je,i.ctx)},se=function(je){return Z(je,i.ctx)},de=eE[k||rE],ge=le&&!(f&&!d)&&h.createElement(pe,{type:"lock",id:v,value:f,setValue:c,label:J,checkedLabel:te,config:i}),Fe=!R&&m&&!f&&h.createElement(oe,{type:"addRule",onClick:u,label:w,readonly:f,config:i,renderIcon:ie}),De=!R&&g&&!f&&h.createElement(oe,{type:"addGroup",onClick:o,label:P,readonly:f,config:i,renderIcon:ie}),ke=!R&&E&&(!f||f&&ee)&&h.createElement(oe,{type:"delGroup",onClick:s,label:F,config:i,renderIcon:ie});return h.createElement("div",{className:"group--actions ".concat(de)},h.createElement(se,{config:i},ge,Fe,De,ke))}}]),r}(h.PureComponent);function qf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Jf(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qf(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):qf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function tE(a){var e=nE();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function nE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var aE=gr.RuleUtils.isEmptyGroupChildren,iE="topRight",Vn=function(a){(0,Fr.A)(r,a);var e=tE(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),t.childrenClassName=function(){return""},t.renderBeforeActions=function(){var i=t.props.config.settings.renderBeforeActions;return i==null?null:typeof i=="function"?i(t.props,t.props.config.ctx):i},t.renderAfterActions=function(){var i=t.props.config.settings.renderAfterActions;return i==null?null:typeof i=="function"?i(t.props,t.props.config.ctx):i},t.removeSelf=t.removeSelf.bind((0,Qe.A)(t)),t.setLock=t.setLock.bind((0,Qe.A)(t)),t.renderItem=t.renderItem.bind((0,Qe.A)(t)),t}return(0,Tr.A)(r,[{key:"isGroupTopPosition",value:function(){return Yy()(this.props.config.settings.groupActionsPosition||iE,"top")}},{key:"setLock",value:function(t){this.props.setLock(t)}},{key:"removeSelf",value:function(){var t=this,i=this.props,u=i.confirmFn,o=i.config,s=o.settings,c=s.renderConfirm,f=s.removeGroupConfirmOptions,d=function(){t.props.removeSelf()};f&&!this.isEmptyCurrentGroup()?c.call(o.ctx,Jf(Jf({},f),{},{onOk:d,onCancel:null,confirmFn:u}),o.ctx):d()}},{key:"isEmptyCurrentGroup",value:function(){var t=this.props,i=t.children1,u=t.config;return aE(i,u)}},{key:"render",value:function(){return h.createElement(h.Fragment,null,this.renderHeaderWrapper(),this.renderChildrenWrapper(),this.renderFooterWrapper())}},{key:"showNot",value:function(){var t=this.props.config;return t.settings.showNot}},{key:"showConjs",value:function(){var t=this.props,i=t.conjunctionOptions,u=t.children1,o=t.config,s=Object.keys(i).length;return s>1||this.showNot()}},{key:"isNoChildren",value:function(){var t=this.props.children1;return t?t.size==0:!0}},{key:"isOneChild",value:function(){var t=this.props.children1;return t?t.size<2:!0}},{key:"renderChildrenWrapper",value:function(){var t=this.props.children1;return t&&h.createElement("div",{key:"group-children",className:yn()("group--children",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isOneChild()?"one--child":"",this.childrenClassName())},this.renderChildren())}},{key:"renderHeaderWrapper",value:function(){var t=this.isGroupTopPosition();return h.createElement("div",{key:"group-header",className:yn()("group--header",this.isOneChild()?"one--child":"",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"")},this.renderHeader(),t&&this.renderBeforeActions(),t&&this.renderActions(),t&&this.renderAfterActions())}},{key:"renderFooterWrapper",value:function(){var t=this.isGroupTopPosition();return!t&&h.createElement("div",{key:"group-footer",className:"group--footer"},this.renderBeforeActions(),this.renderActions(),this.renderAfterActions())}},{key:"renderActions",value:function(){var t=this.props,i=t.config,u=t.addRule,o=t.addGroup,s=t.isLocked,c=t.isTrueLocked,f=t.id;return h.createElement(Xf,{config:i,addRule:u,addGroup:o,canAddGroup:this.canAddGroup(),canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:s,isTrueLocked:c,id:f})}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var t=this.props.config.settings.maxNumberOfRules,i=this.props.totalRulesCnt;return t?i<t:!0}},{key:"canDeleteGroup",value:function(){return!this.props.isRoot}},{key:"renderChildren",value:function(){var t=this.props.children1;return t?t.map(this.renderItem).toList():null}},{key:"renderItem",value:function(t){var i=this.props,u=i.config,o=i.actions,s=i.onDragStart,c=i.isLocked,f=t.get("type")=="group"&&t.getIn(["properties","field"])!=null,d=f?"rule_group":t.get("type");return h.createElement(os,(0,Cr.A)({},this.extraPropsForItem(t),{key:t.get("id"),id:t.get("id"),groupId:i.id,path:t.get("path"),type:d,properties:t.get("properties"),config:u,actions:o,children1:t.get("children1"),reordableNodesCnt:this.reordableNodesCntForItem(t),totalRulesCnt:this.totalRulesCntForItem(t),parentReordableNodesCnt:this.reordableNodesCnt(),onDragStart:s,isDraggingTempo:this.props.isDraggingTempo,isParentLocked:c}))}},{key:"extraPropsForItem",value:function(t){return{}}},{key:"reordableNodesCnt",value:function(){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(t){return this.props.totalRulesCnt}},{key:"reordableNodesCntForItem",value:function(t){return this.props.isLocked?0:this.reordableNodesCnt()}},{key:"showDragIcon",value:function(){var t=this.props,i=t.config,u=t.isRoot,o=t.isLocked,s=this.reordableNodesCnt();return i.settings.canReorder&&!u&&s>1&&!o}},{key:"renderDrag",value:function(){var t=this.props.handleDraggerMouseDown,i=this.props.config,u=i.settings.renderIcon,o=function(f){return u?.(f,i.ctx)},s=h.createElement(o,{type:"drag"});return this.showDragIcon()&&h.createElement("div",{key:"group-drag-icon",onMouseDown:t,className:"qb-drag-handler group--drag-handler"},s)}},{key:"conjunctionOptions",value:function(){var t=this.props.conjunctionOptions;return t}},{key:"renderConjs",value:function(){var t=this.props,i=t.config,u=t.children1,o=t.id,s=t.selectedConjunction,c=t.setConjunction,f=t.not,d=t.setNot,v=t.isLocked,g=i.settings,m=g.immutableGroupsMode,E=g.renderConjs,O=g.showNot,R=g.notLabel,w=this.conjunctionOptions();if(!this.showConjs()||!u||!u.size)return null;var P={disabled:this.isOneChild(),readonly:m||v,selectedConjunction:s,setConjunction:m?on:c,conjunctionOptions:w,config:i,not:f||!1,id:o,setNot:m?on:d,notLabel:R,showNot:this.showNot(),isLocked:v};return E(P,i.ctx)}},{key:"renderHeader",value:function(){return h.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}}]),r}(h.Component);Vn.propTypes={reordableNodesCnt:$().number,conjunctionOptions:$().object.isRequired,allowFurtherNesting:$().bool.isRequired,isRoot:$().bool.isRequired,not:$().bool,selectedConjunction:$().string,config:$().object.isRequired,id:$().string.isRequired,groupId:$().string,path:$().any,children1:$().any,isDraggingMe:$().bool,isDraggingTempo:$().bool,isLocked:$().bool,isTrueLocked:$().bool,handleDraggerMouseDown:$().func,onDragStart:$().func,addRule:$().func.isRequired,addGroup:$().func.isRequired,removeSelf:$().func.isRequired,setConjunction:$().func.isRequired,setNot:$().func.isRequired,setLock:$().func.isRequired,actions:$().object.isRequired};const oE=zi(Si("group")(Ti(Vn)),"group");function uE(a,e){for(;!Object.prototype.hasOwnProperty.call(a,e)&&(a=(0,$e.A)(a),a!==null););return a}function jn(){return typeof Reflect<"u"&&Reflect.get?jn=Reflect.get.bind():jn=function(e,r,n){var t=uE(e,r);if(t){var i=Object.getOwnPropertyDescriptor(t,r);return i.get?i.get.call(arguments.length<3?e:n):i.value}},jn.apply(this,arguments)}function sE(a){var e=lE();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function lE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var cE=function(a){(0,Fr.A)(r,a);var e=sE(r);function r(){return(0,br.A)(this,r),e.apply(this,arguments)}return(0,Tr.A)(r,[{key:"render",value:function(){var t=this.props,i=t.config,u=t.addRule,o=t.canAddRule,s=t.canDeleteGroup,c=t.removeSelf,f=t.setLock,d=t.isLocked,v=t.isTrueLocked,g=t.id,m=i.settings,E=m.immutableGroupsMode,O=m.addRuleLabel,R=m.delGroupLabel,w=m.renderButton,P=m.renderIcon,F=m.renderSwitch,k=m.renderButtonGroup,W=m.lockLabel,q=m.lockedLabel,re=m.showLock,Z=m.canDeleteLocked,J=function(de){return P(de,i.ctx)},te=function(de){return w(de,i.ctx)},le=function(de){return F(de,i.ctx)},ee=function(de){return k(de,i.ctx)},ie=re&&!(d&&!v)&&h.createElement(le,{type:"lock",id:g,value:d,setValue:f,label:W,checkedLabel:q,hideLabel:!0,config:i}),oe=!E&&o&&!d&&h.createElement(te,{type:"addRuleGroup",onClick:u,label:O,readonly:d,config:i,renderIcon:J}),pe=!E&&s&&(!d||d&&Z)&&h.createElement(te,{type:"delRuleGroup",onClick:c,label:R,config:i,renderIcon:J});return h.createElement("div",{className:"group--actions"},h.createElement(ee,{config:i},ie,oe,pe))}}]),r}(h.PureComponent);function Qf(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Zf(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qf(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Qf(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function fE(a){var e=dE();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function dE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ed=function(a){(0,Fr.A)(r,a);var e=fE(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),t.childrenClassName=function(){return"rule_group--children"},t.renderHeaderWrapper=function(){return null},t.renderFooterWrapper=function(){return null},t.renderConjs=function(){return null},t.canAddGroup=function(){return!1},t.canAddRule=function(){return!0},t.canDeleteGroup=function(){return!1},_t((0,Qe.A)(t)),t.onPropsChanged(n),t}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){}},{key:"reordableNodesCntForItem",value:function(t){if(this.props.isLocked)return 0;var i=this.props.children1;return i?.size||0}},{key:"renderChildrenWrapper",value:function(){return h.createElement(h.Fragment,null,this.renderDrag(),this.renderField(),this.renderActions(),jn((0,$e.A)(r.prototype),"renderChildrenWrapper",this).call(this))}},{key:"renderField",value:function(){var t=this.props,i=t.config,u=t.selectedField,o=t.selectedFieldSrc,s=t.selectedFieldType,c=t.setField,f=t.setFieldSrc,d=t.parentField,v=t.id,g=t.groupId,m=t.isLocked,E=i.settings.immutableFieldsMode;return h.createElement(as,{key:"field",classname:"group--field",config:i,canSelectFieldSource:!1,selectedField:u,selectedFieldSrc:o,selectedFieldType:s,setField:c,setFieldSrc:f,parentField:d,readonly:E||m,id:v,groupId:g})}},{key:"renderActions",value:function(){var t=this.props,i=t.config,u=t.addRule,o=t.isLocked,s=t.isTrueLocked,c=t.id;return h.createElement(cE,{config:i,addRule:u,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:s,id:c})}},{key:"extraPropsForItem",value:function(t){return{parentField:this.props.selectedField}}}]),r}(Vn);ed.propTypes=Zf(Zf({},Vn.propTypes),{},{selectedField:$().any,selectedFieldSrc:$().string,parentField:$().string,setField:$().func,setFieldSrc:$().func});const pE=zi(Si("group rule_group")(Ti(ed)),"rule_group");function vE(a){var e=gE();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function gE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mE=function(a){(0,Fr.A)(r,a);var e=vE(r);function r(){return(0,br.A)(this,r),e.apply(this,arguments)}return(0,Tr.A)(r,[{key:"render",value:function(){var t=this.props,i=t.config,u=t.addRule,o=t.canAddRule,s=t.canDeleteGroup,c=t.removeSelf,f=t.setLock,d=t.isLocked,v=t.isTrueLocked,g=t.id,m=i.settings,E=m.immutableGroupsMode,O=m.addSubRuleLabel,R=m.delGroupLabel,w=m.renderButton,P=m.renderIcon,F=m.renderSwitch,k=m.renderButtonGroup,W=m.lockLabel,q=m.lockedLabel,re=m.showLock,Z=m.canDeleteLocked,J=function(de){return P(de,i.ctx)},te=function(de){return w(de,i.ctx)},le=function(de){return F(de,i.ctx)},ee=function(de){return k(de,i.ctx)},ie=re&&!(d&&!v)&&h.createElement(le,{type:"lock",id:g,value:d,setValue:f,label:W,checkedLabel:q,config:i}),oe=!E&&o&&!d&&h.createElement(te,{type:"addRuleGroupExt",onClick:u,label:O,readonly:d,config:i,renderIcon:J}),pe=!E&&s&&(!d||d&&Z)&&h.createElement(te,{type:"delRuleGroup",onClick:c,label:R,config:i,renderIcon:J});return h.createElement("div",{className:"group--actions group--actions--tr"},h.createElement(ee,{config:i},ie,oe,pe))}}]),r}(h.PureComponent);function rd(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function td(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rd(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):rd(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function hE(a,e){var r=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!r){if(Array.isArray(a)||(r=yE(a))||e&&a&&typeof a.length=="number"){r&&(a=r);var n=0,t=function(){};return{s:t,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(a)},n:function(){var c=r.next();return i=c.done,c},e:function(c){u=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function yE(a,e){if(a){if(typeof a=="string")return nd(a,e);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nd(a,e)}}function nd(a,e){(e==null||e>a.length)&&(e=a.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=a[r];return n}function EE(a){var e=SE();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function SE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ad=gr.ConfigUtils,id=ad.getFieldConfig,OE=ad.getFieldWidgetConfig,TE=gr.RuleUtils.isEmptyRuleGroupExtPropertiesAndChildren,od=function(a){(0,Fr.A)(r,a);var e=EE(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),t.childrenClassName=function(){return"rule_group_ext--children"},t.renderFooterWrapper=function(){return null},t.canAddGroup=function(){return!1},t.canAddRule=function(){return!0},t.canDeleteGroup=function(){return!0},_t((0,Qe.A)(t)),t.onPropsChanged(n),t}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){}},{key:"renderHeaderWrapper",value:function(){return h.createElement("div",{key:"group-header",className:yn()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()&&(!this.isOneChild()||this.showNot())?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderGroupField(),this.renderActions())}},{key:"renderHeader",value:function(){return h.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderGroupField",value:function(){return h.createElement("div",{className:"group--field--count--rule"},this.renderField(),this.renderOperator(),this.renderWidget())}},{key:"showNot",value:function(){var t=this.props,i=t.config,u=t.selectedField,o=t.selectedOperator,s=id(i,u)||{};return s.showNot!=null?s.showNot:i.settings.showNot}},{key:"conjunctionOptions",value:function(){var t=this.props,i=t.config,u=t.selectedField,o=t.selectedOperator,s=id(i,u)||{},c=jn((0,$e.A)(r.prototype),"conjunctionOptions",this).call(this);if(s.conjunctions){var f={},d=hE(s.conjunctions),v;try{for(d.s();!(v=d.n()).done;){var g=v.value,m=c[g];m&&(f[g]=m)}}catch(E){d.e(E)}finally{d.f()}c=f}return c}},{key:"renderField",value:function(){var t=this.props,i=t.config,u=t.selectedField,o=t.selectedFieldSrc,s=t.selectedFieldType,c=t.setField,f=t.setFieldSrc,d=t.parentField,v=t.id,g=t.groupId,m=t.isLocked,E=i.settings.immutableFieldsMode;return h.createElement(as,{key:"field",classname:"rule--field",config:i,canSelectFieldSource:!1,selectedField:u,selectedFieldSrc:o,selectedFieldType:s,setField:c,setFieldSrc:f,parentField:d,readonly:E||m,id:v,groupId:g})}},{key:"renderOperator",value:function(){var t=this.props,i=t.config,u=t.selectedField,o=t.selectedFieldSrc,s=t.selectedOperator,c=t.setField,f=t.setOperator,d=t.isLocked,v=i.settings.immutableFieldsMode,g=OE(i,u,s)||{},m=g.hideOperator,E=u&&m&&g.operatorInlineLabel,O=u&&!m;return h.createElement(Rf,{key:"operator",classname:"group--operator",config:i,selectedField:u,selectedFieldSrc:o,selectedOperator:s,setOperator:f,selectedFieldPartsLabels:["group"],showOperator:O,showOperatorLabel:E,selectedFieldWidgetConfig:g,readonly:v||d,id:this.props.id,groupId:this.props.groupId})}},{key:"isEmptyCurrentGroup",value:function(){var t=this.props,i=t.children1,u=t.config,o=this._buildWidgetProps(this.props);return TE(o,i,u)}},{key:"_buildWidgetProps",value:function(t){var i=t.selectedField,u=t.selectedFieldSrc,o=t.selectedFieldType,s=t.selectedOperator,c=t.operatorOptions,f=t.value,d=t.valueType,v=t.valueSrc,g=t.asyncListValues,m=t.valueError,E=t.parentField;return{field:i,fieldSrc:u,fieldType:o,operator:s,operatorOptions:c,value:f,valueType:d,valueSrc:["value"],valueError:null,parentField:E}}},{key:"renderWidget",value:function(){var t=this.props,i=t.config,u=t.selectedField,o=t.selectedOperator,s=t.isLocked,c=i.settings.immutableValuesMode,f=u&&o,d=f;if(!d)return null;var v=h.createElement(Yi,(0,Cr.A)({key:"values",isForRuleGroup:!0},this._buildWidgetProps(this.props),{config:i,setValue:c?on:this.props.setValue,setValueSrc:on,readonly:c||s,id:this.props.id,groupId:this.props.groupId}));return h.createElement(dt,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},v)}},{key:"renderActions",value:function(){var t=this.props,i=t.config,u=t.addRule,o=t.isLocked,s=t.isTrueLocked,c=t.id;return h.createElement(mE,{config:i,addRule:u,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:s,id:c})}},{key:"reordableNodesCntForItem",value:function(t){if(this.props.isLocked)return 0;var i=this.props.children1;return i?.size||0}},{key:"extraPropsForItem",value:function(t){return{parentField:this.props.selectedField}}}]),r}(Vn);od.propTypes=td(td({},Vn.propTypes),{},{selectedField:$().any,selectedFieldSrc:$().string,selectedOperator:$().string,value:$().any,parentField:$().string,setField:$().func,setFieldSrc:$().func,setOperator:$().func,setValue:$().func});const AE=zi(Si("group rule_group_ext")(Ti(od)),"rule_group");function RE(a){var e=CE();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function CE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var LE={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},IE="topRight",bE=function(a){(0,Fr.A)(r,a);var e=RE(r);function r(){return(0,br.A)(this,r),e.apply(this,arguments)}return(0,Tr.A)(r,[{key:"render",value:function(){var t=this.props,i=t.config,u=t.addCaseGroup,o=t.addDefaultCaseGroup,s=t.setLock,c=t.isLocked,f=t.isTrueLocked,d=t.id,v=t.canAddGroup,g=t.canAddDefault,m=i.settings,E=m.immutableGroupsMode,O=m.addCaseLabel,R=m.addDefaultCaseLabel,w=m.groupActionsPosition,P=m.renderButton,F=m.renderIcon,k=m.renderSwitch,W=m.renderButtonGroup,q=m.lockLabel,re=m.lockedLabel,Z=m.showLock,J=function(ge){return F(ge,i.ctx)},te=function(ge){return P(ge,i.ctx)},le=function(ge){return k(ge,i.ctx)},ee=function(ge){return W(ge,i.ctx)},ie=LE[w||IE],oe=Z&&!(c&&!f)&&h.createElement(le,{type:"lock",id:d,value:c,setValue:s,label:q,checkedLabel:re,config:i}),pe=!E&&v&&!c&&h.createElement(te,{type:"addCaseGroup",onClick:u,label:O,readonly:c,config:i,renderIcon:J}),se=!E&&g&&!c&&h.createElement(te,{type:"addDefaultCaseGroup",onClick:o,label:R,readonly:c,config:i,renderIcon:J});return h.createElement("div",{className:"group--actions ".concat(ie)},h.createElement(ee,{config:i},oe,pe,se))}}]),r}(h.PureComponent);function ud(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function FE(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ud(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):ud(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function NE(a){var e=wE();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function wE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var sd=gr.TreeUtils,PE=sd.getTotalReordableNodesCountInTree,_E=sd.getTotalRulesCountInTree,ld=function(a){(0,Fr.A)(r,a);var e=NE(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),t.childrenClassName=function(){return"switch_group--children"},t.renderFooterWrapper=function(){return null},t.hasDefaultCase=function(){var i;return((i=t.props.children1)===null||i===void 0?void 0:i.size)&&t.props.children1.filter(function(u){return u.get("children1")==null}).size>0},_t((0,Qe.A)(t)),t.onPropsChanged(n),t}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){}},{key:"canAddGroup",value:function(){var t,i=this.props.config.settings.maxNumberOfCases,u=((t=this.props.children1)===null||t===void 0?void 0:t.size)||0;return i?u<i:!0}},{key:"canAddRule",value:function(){return!1}},{key:"reordableNodesCnt",value:function(){var t,i=((t=this.props.children1)===null||t===void 0?void 0:t.size)||0,u=i;return this.hasDefaultCase()&&u--,u}},{key:"totalRulesCntForItem",value:function(t){return _E(t)}},{key:"reordableNodesCntForItem",value:function(t){var i;if(this.props.isLocked)return 0;var u=this.props.config.settings,o=u.canLeaveEmptyCase,s=u.canRegroupCases,c=((i=this.props.children1)===null||i===void 0?void 0:i.size)||0,f=c;this.hasDefaultCase()&&f--;var d=PE(t),v=d;return v==1&&s&&o&&f>1&&(v=111),v}},{key:"renderHeaderWrapper",value:function(){return h.createElement("div",{key:"group-header",className:yn()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag")},this.renderHeader(),this.renderActions())}},{key:"renderHeader",value:function(){return h.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderConjs",value:function(){var t=this.props.config,i=t.settings.renderSwitchPrefix;return i||null}},{key:"showNot",value:function(){return!1}},{key:"renderActions",value:function(){var t=this.props,i=t.config,u=t.addCaseGroup,o=t.addDefaultCaseGroup,s=t.isLocked,c=t.isTrueLocked,f=t.id;return h.createElement(bE,{config:i,addCaseGroup:u,addDefaultCaseGroup:o,canAddDefault:!this.hasDefaultCase(),canAddGroup:this.canAddGroup(),setLock:this.setLock,isLocked:s,isTrueLocked:c,id:f})}}]),r}(Vn);ld.propTypes=FE({},Vn.propTypes);const DE=zi(Si("group switch_group")(Ti(ld)),"switch_group");function cd(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function fd(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cd(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):cd(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function ME(a){var e=VE();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function VE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dd=function(a){(0,Fr.A)(r,a);var e=ME(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),t.childrenClassName=function(){return"case_group--children"},t.renderFooterWrapper=function(){return null},_t((0,Qe.A)(t)),t.onPropsChanged(n),t}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){}},{key:"isDefaultCase",value:function(){return this.props.children1==null}},{key:"reordableNodesCnt",value:function(){return this.props.parentReordableNodesCnt}},{key:"reordableNodesCntForItem",value:function(t){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(t){return this.props.totalRulesCnt}},{key:"showDragIcon",value:function(){return this.isDefaultCase()?!1:jn((0,$e.A)(r.prototype),"showDragIcon",this).call(this)}},{key:"renderHeaderWrapper",value:function(){return h.createElement("div",{key:"group-header",className:yn()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()&&(!this.isOneChild()||this.showNot())?"with--conjs":"hide--conjs")},this.renderHeaderLeft(),this.renderHeaderCenter(),this.renderActions())}},{key:"renderChildrenWrapper",value:function(){return this.isDefaultCase()?null:h.createElement("div",{className:"case_group--body"},this.renderCondition(),this.renderValue())}},{key:"renderHeaderLeft",value:function(){if(this.isDefaultCase()){var t=this.props.config.settings.defaultCaseLabel;return t||""}return h.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderCondition",value:function(){return this.isDefaultCase()?null:jn((0,$e.A)(r.prototype),"renderChildrenWrapper",this).call(this)}},{key:"renderHeaderCenter",value:function(){return this.isDefaultCase()?this.renderValue():null}},{key:"canAddGroup",value:function(){return this.isDefaultCase()?!1:jn((0,$e.A)(r.prototype),"canAddGroup",this).call(this)}},{key:"canAddRule",value:function(){return this.isDefaultCase()?!1:jn((0,$e.A)(r.prototype),"canAddRule",this).call(this)}},{key:"renderValue",value:function(){var t=this.props,i=t.config,u=t.isLocked,o=t.value,s=t.setValue,c=t.id,f=i.settings.immutableValuesMode,d=h.createElement(Yi,{key:"values",isCaseValue:!0,field:"!case_value",operator:null,value:o,valueSrc:"value",valueError:null,config:i,setValue:f?on:s,setValueSrc:on,readonly:f||u,id:c,groupId:null});return h.createElement(dt,{className:"case_group--value"},d)}},{key:"renderActions",value:function(){var t=this.props,i=t.config,u=t.addGroup,o=t.addRule,s=t.isLocked,c=t.isTrueLocked,f=t.id;return h.createElement(Xf,{config:i,addGroup:u,addRule:o,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:s,isTrueLocked:c,id:f})}},{key:"isEmptyCurrentGroup",value:function(){var t=this.props.value,i=t&&t.size?t.get(0):null,u=i!=null&&(Array.isArray(i)?i.length>0:!0);return jn((0,$e.A)(r.prototype),"isEmptyCurrentGroup",this).call(this)&&!u}}]),r}(Vn);dd.propTypes=fd(fd({},Vn.propTypes),{},{parentReordableNodesCnt:$().number,value:$().any,setValue:$().func});const jE=zi(Si("group case_group")(Ti(dd)),"case_group");var kE=["type"];function xE(a){var e=UE();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function UE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pd(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function is(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pd(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):pd(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var GE=["rule","group","rule_group","switch_group","case_group"],Ai=function(e){var r,n=((r=e.properties)===null||r===void 0?void 0:r.toObject())||{},t=is({},n);return e.isParentLocked&&(t.isLocked=!0),n.isLocked&&(t.isTrueLocked=!0),t},BE={rule:function(e){return h.createElement(Hy,(0,Cr.A)({},Ai(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,config:e.config,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},group:function(e){return h.createElement(oE,(0,Cr.A)({},Ai(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group:function(e){return h.createElement(pE,(0,Cr.A)({},Ai(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group_ext:function(e){return h.createElement(AE,(0,Cr.A)({},Ai(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},switch_group:function(e){return h.createElement(DE,(0,Cr.A)({},Ai(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},case_group:function(e){return h.createElement(jE,(0,Cr.A)({},Ai(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))}},os=function(a){(0,Fr.A)(r,a);var e=xE(r);function r(){return(0,br.A)(this,r),e.apply(this,arguments)}return(0,Tr.A)(r,[{key:"render",value:function(){var t,i=this.props,u=i.type,o=(0,hi.A)(i,kE),s=(t=o.properties)===null||t===void 0?void 0:t.get("mode"),c=s=="array"?"_ext":"",f=o.config.settings.renderItem,d=BE[u+c];return f?f(is(is({},o),{},{type:u,itemComponent:d}),o.config.ctx):d?d(o):null}}]),r}(h.PureComponent);os.propTypes={config:$().object.isRequired,id:$().string.isRequired,groupId:$().string,type:$().oneOf(GE).isRequired,path:$().any.isRequired,properties:$().any.isRequired,children1:$().any,actions:$().object.isRequired,reordableNodesCnt:$().number,onDragStart:$().func,parentField:$().string,isDraggingTempo:$().bool,isParentLocked:$().bool};function WE(a){var e=$E();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function $E(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vd=gr.TreeUtils,HE=vd.getTotalReordableNodesCountInTree,KE=vd.getTotalRulesCountInTree,gd=gr.DefaultUtils,YE=gd.createListFromArray,md=gd.emptyProperies,hd=function(a){(0,Fr.A)(r,a);var e=WE(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),t.pureShouldComponentUpdate=Ei((0,Qe.A)(t)),t._updPath(n),t}return(0,Tr.A)(r,[{key:"shouldComponentUpdate",value:function(t,i){var u=this.props,o=this.pureShouldComponentUpdate(t,i);if(o){var s=[];for(var c in t){var f=t[c]!==u[c];f&&c!="__isInternalValueChange"&&s.push(c)}s.length||(o=!1),s.length==1&&s[0]=="tree"&&t.__isInternalValueChange&&(o=!1)}return o}},{key:"_updPath",value:function(t){var i=t.tree.get("id");this.path=YE([i])}},{key:"render",value:function(){var t=this.props.tree,i=t.get("type"),u=i=="switch_group",o=u?null:HE(t),s=u?null:KE(t),c=t.get("id");return h.createElement(os,{key:c,id:c,path:this.path,type:i,properties:t.get("properties")||md(),config:this.props.config,actions:this.props.actions,children1:t.get("children1")||md(),reordableNodesCnt:o,totalRulesCnt:s,parentReordableNodesCnt:0,onDragStart:this.props.onDragStart})}}]),r}(h.Component);hd.propTypes={tree:$().any.isRequired,config:$().object.isRequired,actions:$().object.isRequired,onDragStart:$().func};const zE=Yh(hd);function yd(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function XE(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yd(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):yd(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}function qE(a){var e=JE();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function JE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var QE=gr.clone,us=gr.ConfigUtils,Xi=us.getFieldConfig,Ed=us.getFieldParts,Sd=us.getFieldPathParts,Od=gr.RuleUtils,Td=Od.getFieldPathLabels,ZE=Od.getWidgetForFieldOp,Ad=function(a){(0,Fr.A)(r,a);var e=qE(r);function r(n){var t;return(0,br.A)(this,r),t=e.call(this,n),_t((0,Qe.A)(t)),t.onPropsChanged(n),t}return(0,Tr.A)(r,[{key:"onPropsChanged",value:function(t){var i=this.props,u=["config","field","fieldSrc","fieldType","operator","isFuncArg","parentField"],o=["config","field","fieldSrc","fieldType","operator","value","placeholder","isFuncArg","parentField"],s=!this.items||u.map(function(f){return t[f]!==i[f]}).filter(function(f){return f}).length>0,c=!this.meta||o.map(function(f){return t[f]!==i[f]}).filter(function(f){return f}).length>0;s&&(this.items=this.getItems(t)),c&&(this.meta=this.getMeta(t))}},{key:"getItems",value:function(t){var i=t.config,u=t.field,o=t.fieldType,s=t.operator,c=t.parentField,f=t.isFuncArg,d=t.fieldDefinition,v=i.settings.canCompareFieldWithField,g=i.settings.fieldSeparator,m=Ed(c,i),E=c?Xi(i,c):null,O=c?E?.subfields:i.fields,R=this.filterFields(i,O,u,c,m,s,v,f,d,o),w=this.buildOptions(m,i,R,m);return w}},{key:"getMeta",value:function(t){var i,u=t.config,o=t.field,s=t.fieldType,c=t.operator,f=t.value,d=t.placeholder,v=t.isFuncArg,g=t.parentField,m=u.settings,E=m.fieldPlaceholder,O=m.fieldSeparatorDisplay,R=f,w=!!f,P=o?Xi(u,o):{},F=P==null||(i=P.widgets)===null||i===void 0?void 0:i.field,k=F?.widgetProps||{},W=w?null:v&&d||k.valuePlaceholder||E,q=w?Xi(u,R):null,re=q||{},Z=Sd(R,u),J=Sd(R,u,!0),te=this.getFieldLabel(q,R,u),le=Td(R,u),ee=le?le.join(O):null;(ee==te||g)&&(ee=null);var ie=re.label2;return{placeholder:W,selectedKey:R,selectedKeys:Z,selectedPath:J,selectedLabel:te,selectedOpts:re,selectedAltLabel:ie,selectedFullLabel:ee}}},{key:"filterFields",value:function(t,i,u,o,s,c,f,d,v,g){i=QE(i);var m=t.settings.fieldSeparator,E=Xi(t,u),O=!1,R=ZE(t,u,c,"value"),w=t.widgets[R],P;d?P=v?.type:O&&w?P=w.type:E?P=E.type:P=g;function F(k,W){for(var q in k){var re=k[q].subfields,Z=(W||[]).concat(q),J=Z.join(m),te=Xi(t,J);if(!te)delete k[q];else if(te.type=="!struct"||te.type=="!group")F(re,Z)==0&&delete k[q];else{var le=(!P||te.type==P)&&(d?!0:J!=u),ee=f||t.settings.canCompareFieldWithField;ee&&(le=le&&ee(u,E,J,te,c)),le||delete k[q]}}return Oi()(k).length}return F(i,s||[]),i}},{key:"buildOptions",value:function(t,i,u){var o=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!u)return null;var f=i.settings,d=f.fieldSeparator,v=f.fieldSeparatorDisplay,g=s!=null&&s.length?s.join(d)+d:"";return Oi()(u).map(function(m){var E=[].concat((0,we.A)(s??[]),[m]),O=u[m],R=o.getFieldLabel(O,E,i),w=Td(E,i),P=w.join(v);(P==R||t)&&(P=null);var F=O.label2,k=O.tooltip;if(!O.hideForCompare)return O.type=="!struct"||O.type=="!group"?{key:m,path:g+m,label:R,fullLabel:P,altLabel:F,tooltip:k,items:o.buildOptions(t,i,O.subfields,E,{label:R,tooltip:k})}:{key:m,path:g+m,label:R,fullLabel:P,altLabel:F,tooltip:k,grouplabel:c?.label,group:c}}).filter(function(m){return!!m})}},{key:"getFieldLabel",value:function(t,i,u){if(!i)return null;var o=u.settings.maxLabelsLength,s=Ed(i,u),c=t?.label||Ao()(s);return c=Vo(c,o),c}},{key:"render",value:function(){var t=this.props,i=t.config,u=t.customProps,o=t.setValue,s=t.readonly,c=t.id,f=t.groupId,d=i.settings.renderField,v=XE({isValueField:!0,config:i,customProps:u,setField:o,readonly:s,items:this.items,id:c,groupId:f},this.meta);return d(v,i.ctx)}}]),r}(h.Component);Ad.propTypes={id:$().string,groupId:$().string,setValue:$().func.isRequired,config:$().object.isRequired,field:$().any,fieldSrc:$().string,fieldType:$().string,value:$().string,operator:$().string,customProps:$().object,readonly:$().bool,parentField:$().string,fieldDefinition:$().object,isFuncArg:$().bool};const eS=function(a){var e=a.value,r=a.setValue,n=a.config,t=a.labelYes,i=a.labelNo,u=a.readonly,o=a.customProps,s=o===void 0?{}:o,c=s.radioYes||{},f=s.radioNo||{},d=function(m){return r(m.target.checked)},v=function(m){return r(m.target.value=="true")};return h.createElement(h.Fragment,null,h.createElement("input",(0,Cr.A)({type:"radio",value:!0,checked:!!e,disabled:u,onChange:v},c))," ",t,h.createElement("input",(0,Cr.A)({type:"radio",value:!1,checked:!e,disabled:u,onChange:v},f))," ",i)},rS=function(a){var e=a.value,r=a.setValue,n=a.config,t=a.readonly,i=a.placeholder,u=a.maxLength,o=a.customProps,s=function(d){var v=d.target.value;v===""&&(v=void 0),r(v)},c=e||"";return h.createElement("input",(0,Cr.A)({type:"text",value:c,placeholder:i,disabled:t,onChange:s,maxLength:u},o))},tS=function(a){var e=a.value,r=a.setValue,n=a.config,t=a.readonly,i=a.placeholder,u=a.maxLength,o=a.maxRows,s=a.fullWidth,c=a.customProps,f=function(g){var m=g.target.value;m===""&&(m=void 0),r(m)},d=e||"";return h.createElement("textarea",(0,Cr.A)({value:d,placeholder:i,disabled:t,onChange:f,maxLength:u,style:{width:s?"100%":void 0}},c))};var VO=gr.moment;const nS=function(a){var e=a.value,r=a.setValue,n=a.config,t=a.valueFormat,i=a.readonly,u=a.customProps,o=function(c){var f=c.target.value;f==""&&(f=void 0),r(f)};return h.createElement("input",(0,Cr.A)({type:"date",value:e||"",disabled:i,onChange:o},u))},aS=function(a){var e=a.value,r=a.setValue,n=a.config,t=a.valueFormat,i=a.use12Hours,u=a.readonly,o=a.customProps,s=function(f){var d=f.target.value;d==""&&(d=void 0),r(d)};return h.createElement("input",(0,Cr.A)({type:"time",value:e||"",disabled:u,onChange:s},o))};var Rd=gr.moment;const iS=function(a){var e=a.value,r=a.setValue,n=a.config,t=a.valueFormat,i=a.use12Hours,u=a.readonly,o=a.customProps,s=function(d){var v=d.target.value;v==""?v=void 0:v=Rd(new Date(v)).format(t),r(v)},c=e;return e?c=Rd(e).format("YYYY-MM-DDTHH:mm"):c="",h.createElement("input",(0,Cr.A)({type:"datetime-local",value:c,disabled:u,onChange:s},o))};var oS=gr.ListUtils.mapListValues;const uS=function(a){var e=a.listValues,r=a.value,n=a.setValue,t=a.allowCustomValues,i=a.readonly,u=a.customProps,o=function(){return oS(e,function(d){var v=d.title,g=d.value;return h.createElement("option",{key:g,value:g},v)})},s=function(d){for(var v=[],g=d.options,m=0;m<g.length;m++){var E=g[m];E.selected&&v.push(E.value)}return v.length||(v=void 0),v},c=function(d){return n(s(d.target))};return h.createElement("select",(0,Cr.A)({multiple:!0,onChange:c,value:r,disabled:i},jr()(u,["showSearch","input","showCheckboxes"])),o())};var sS=gr.ListUtils.mapListValues;const lS=function(a){var e=a.listValues,r=a.value,n=a.setValue,t=a.allowCustomValues,i=a.readonly,u=a.customProps,o=function(){return sS(e,function(d){var v=d.title,g=d.value;return h.createElement("option",{key:g,value:g},v)})},s=function(d){return n(d.target.value)},c=r!=null;return h.createElement("select",(0,Cr.A)({onChange:s,value:c?r:"",disabled:i},jr()(u,["showSearch","input"])),!c&&h.createElement("option",{disabled:!0,value:""}),o())},cS=function(a){var e=a.value,r=a.setValue,n=a.config,t=a.readonly,i=a.min,u=a.max,o=a.step,s=a.placeholder,c=a.customProps,f=function(g){var m=g.target.value;m===""||m===null?m=void 0:m=Number(m),r(m)},d=e??"";return h.createElement("input",(0,Cr.A)({type:"number",value:d,placeholder:s,disabled:t,min:i,max:u,step:o,onChange:f},c))},fS=function(a){var e=a.value,r=a.setValue,n=a.config,t=a.readonly,i=a.min,u=a.max,o=a.step,s=a.placeholder,c=a.customProps,f=c===void 0?{}:c,d=f.input||{},v=f.slider||f,g=function(O){var R=O.target.value;R===""||R===null?R=void 0:R=Number(R),r(R)},m=e??"";return h.createElement("div",{style:{display:"inline-flex"}},h.createElement("input",(0,Cr.A)({key:"number",type:"number",value:m,placeholder:s,disabled:t,min:i,max:u,step:o,onChange:g},d)),h.createElement("input",(0,Cr.A)({key:"range",type:"range",value:m,disabled:t,min:i,max:u,step:o,onChange:g},v)))},dS=function(a){var e=a.items,r=a.setField,n=a.selectedKey,t=a.readonly,i=a.errorText,u=function c(f){return f.map(function(d){var v=d.items,g=d.path,m=d.label,E=d.disabled,O=d.matchesType;if(v)return h.createElement("optgroup",{disabled:E,key:g,label:m},c(v));var R=O?{fontWeight:"bold"}:{};return h.createElement("option",{disabled:E,key:g,value:g,style:R},m)})},o=function(f){return r(f.target.value)},s=n!=null;return h.createElement("select",{onChange:o,value:s?n:"",disabled:t,style:{color:i?"red":null}},!s&&h.createElement("option",{disabled:!0,value:""}),u(e))},pS=function(a){var e=a.id,r=a.not,n=a.setNot,t=a.conjunctionOptions,i=a.setConjunction,u=a.disabled,o=a.readonly,s=a.config,c=a.showNot,f=a.notLabel,d=Object.keys(t).length,v=u,g=s.settings.forceShowConj,m=g||d>1&&!v,E=function(){return Object.keys(t).map(function(F){var k=t[F],W=k.id,q=k.name,re=k.label,Z=k.checked,J=i.isDummyFn?"__dummy":"";return(o||u)&&!Z?null:[h.createElement("input",{key:W+J,type:"radio",id:W+J,name:q+J,checked:Z,disabled:o||u,value:F,onChange:R}),h.createElement("label",{key:W+J+"label",htmlFor:W+J},re)]})},O=function(){var F="not";return[h.createElement("input",{key:e+F,type:"checkbox",id:e+F,checked:r,disabled:o,onChange:w}),h.createElement("label",{key:e+F+"label",htmlFor:e+F},f||"NOT")]},R=function(F){return i(F.target.value)},w=function(F){return n(F.target.checked)};return[c&&O(),m&&E()]};var vS={addRuleGroup:"+",addRuleGroupExt:"+",delGroup:"x",delRuleGroup:"x",delRule:"x"};const gS=function(a){var e=a.type,r=a.label,n=a.onClick,t=a.readonly,i=r||vS[e];return h.createElement("button",{onClick:n,type:"button",disabled:t},i)},mS=function(a){var e=a.type,r={},n=r[e]||null;return!n&&e==="drag"&&(n=h.createElement(Af,null)),n},hS=function(a){var e=a.children,r=a.config;return h.createElement(h.Fragment,null,e)},yS=function(a){var e=a.config,r=a.valueSources,n=a.valueSrc,t=a.title,i=a.setValueSrc,u=a.readonly,o=function(f){return f.map(function(d){var v=(0,qe.A)(d,2),g=v[0],m=v[1];return h.createElement("option",{key:g,value:g},m.label)})},s=function(f){return i(f.target.value)};return h.createElement("select",{onChange:s,value:n||"",disabled:u},o(r))},ES=function(a){var e=a.value,r=a.setValue,n=a.label,t=a.id,i=a.config,u=a.type,o=function(f){return r(f.target.checked)},s=u;return[h.createElement("input",{key:t+s,type:"checkbox",id:t+s,checked:!!e,onChange:o}),h.createElement("label",{key:t+s+"label",htmlFor:t+s},n)]},SS=function(a){var e=a.onOk,r=a.okText,n=a.cancelText,t=a.title;confirm(t)&&e()};var OS=function(e){var r=e.config,n=e.children;return n};function TS(a){var e=AS();return function(){var n=(0,$e.A)(a),t;if(e){var i=(0,$e.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,Pr.A)(this,t)}}function AS(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ss=function(a){(0,Fr.A)(r,a);var e=TS(r);function r(){var n;(0,br.A)(this,r);for(var t=arguments.length,i=new Array(t),u=0;u<t;u++)i[u]=arguments[u];return n=e.call.apply(e,[this].concat(i)),n.handleChange=function(o){n.props.setOption("proximity",parseInt(o))},n}return(0,Tr.A)(r,[{key:"render",value:function(){var t=this.props,i=t.defaults,u=t.options,o=t.config,s=t.optionLabel,c=t.optionPlaceholder,f=t.customProps,d=t.minProximity,v=t.maxProximity,g=t.optionTextBefore,m=t.readonly,E=o.settings,O=o.widgets,R=o.ctx,w=i?i.proximity:void 0,P=E.showLabels,F=u.get("proximity",w),k=Qu()(d,v+1).map(function(re){return{title:re,value:re}}),W=O.select.factory,q=function(Z){return W(Z,R)};return h.createElement("div",{className:"operator--PROXIMITY"},h.createElement("div",{className:"operator--options"},P&&h.createElement("label",{className:"rule--label"},s),!P&&g&&h.createElement("div",{className:"operator--options--sep"},h.createElement("span",null,g)),h.createElement(q,(0,Cr.A)({config:o,value:F,listValues:k,setValue:this.handleChange,readonly:m,placeholder:c},f))),h.createElement("div",{className:"operator--widgets"},this.props.children))}}]),r}(h.PureComponent);ss.propTypes={config:$().object.isRequired,setOption:$().func.isRequired,options:$().any.isRequired,minProximity:$().number,maxProximity:$().number,optionPlaceholder:$().string,optionTextBefore:$().string,optionLabel:$().string,customProps:$().object,readonly:$().bool},ss.defaultProps={customProps:{},minProximity:2,maxProximity:10,optionPlaceholder:"Select words between",optionLabel:"Words between",optionTextBefore:null};function Cd(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function ir(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cd(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Cd(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var RS=ir({},rt.conjunctions),CS=ir(ir({},rt.operators),{},{proximity:ir(ir({},rt.operators.proximity),{},{options:ir(ir({},rt.operators.proximity.options),{},{factory:function(e,r){var n=r.RCE,t=r.O.ProximityOperator;return n(t,e)}})})}),LS={text:ir(ir({},rt.widgets.text),{},{factory:function(e,r){var n=r.RCE,t=r.W.VanillaTextWidget;return n(t,e)}}),textarea:ir(ir({},rt.widgets.textarea),{},{factory:function(e,r){var n=r.RCE,t=r.W.VanillaTextAreaWidget;return n(t,e)}}),number:ir(ir({},rt.widgets.number),{},{factory:function(e,r){var n=r.RCE,t=r.W.VanillaNumberWidget;return n(t,e)}}),slider:ir(ir({},rt.widgets.slider),{},{factory:function(e,r){var n=r.RCE,t=r.W.VanillaSliderWidget;return n(t,e)}}),select:ir(ir({},rt.widgets.select),{},{factory:function(e,r){var n=r.RCE,t=r.W.VanillaSelectWidget;return n(t,e)}}),multiselect:ir(ir({},rt.widgets.multiselect),{},{factory:function(e,r){var n=r.RCE,t=r.W.VanillaMultiSelectWidget;return n(t,e)}}),date:ir(ir({},rt.widgets.date),{},{factory:function(e,r){var n=r.RCE,t=r.W.VanillaDateWidget;return n(t,e)}}),time:ir(ir({},rt.widgets.time),{},{factory:function(e,r){var n=r.RCE,t=r.W.VanillaTimeWidget;return n(t,e)}}),datetime:ir(ir({},rt.widgets.datetime),{},{factory:function(e,r){var n=r.RCE,t=r.W.VanillaDateTimeWidget;return n(t,e)}}),boolean:ir(ir({},rt.widgets.boolean),{},{factory:function(e,r){var n=r.RCE,t=r.W.VanillaBooleanWidget;return n(t,e)}}),field:ir(ir({},rt.widgets.field),{},{factory:function(e,r){var n=r.RCE,t=r.W.ValueFieldWidget;return n(t,e)},customProps:{showSearch:!0}}),func:ir(ir({},rt.widgets.func),{},{factory:function(e,r){var n=r.RCE,t=r.W.FuncWidget;return n(t,e)},customProps:{}}),case_value:ir(ir({},rt.widgets.case_value),{},{factory:function(e,r){var n=r.RCE,t=r.W.VanillaTextWidget;return n(t,e)}})},IS=ir(ir({},rt.types),{},{select:ir(ir({},rt.types.select),{},{widgets:ir(ir({},rt.types.select.widgets),{},{select:ir(ir({},rt.types.select.widgets.select),{},{widgetProps:{customProps:{showSearch:!0}}})})})}),bS=ir(ir({},rt.settings),{},{renderField:function(e,r){var n=r.RCE,t=r.W.VanillaFieldSelect;return n(t,e)},renderOperator:function(e,r){var n=r.RCE,t=r.W.VanillaFieldSelect;return n(t,e)},renderFunc:function(e,r){var n=r.RCE,t=r.W.VanillaFieldSelect;return n(t,e)},renderConjs:function(e,r){var n=r.RCE,t=r.W.VanillaConjs;return n(t,e)},renderSwitch:function(e,r){var n=r.RCE,t=r.W.VanillaSwitch;return n(t,e)},renderButton:function(e,r){var n=r.RCE,t=r.W.VanillaButton;return n(t,e)},renderIcon:function(e,r){var n=r.RCE,t=r.W.VanillaIcon;return n(t,e)},renderButtonGroup:function(e,r){var n=r.RCE,t=r.W.VanillaButtonGroup;return n(t,e)},renderProvider:function(e,r){var n=r.RCE,t=r.W.VanillaProvider;return n(t,e)},renderValueSources:function(e,r){var n=r.RCE,t=r.W.VanillaValueSources;return n(t,e)},renderFieldSources:function(e,r){var n=r.RCE,t=r.W.VanillaValueSources;return n(t,e)},renderConfirm:function(e,r){var n=r.W.vanillaConfirm;return n(e)},renderSwitchPrefix:"Conditions",customFieldSelectProps:{showSearch:!0},defaultSliderWidth:"200px",defaultSelectWidth:"200px",defaultSearchWidth:"100px",defaultMaxRows:5,renderSize:"small",maxLabelsLength:100,showLock:!1,showNot:!0,forceShowConj:!1,groupActionsPosition:"topRight"}),FS=ir(ir({},rt.ctx),{},{W:ir({},me),O:ir({},Xe),RCE:function(e,r){return h.createElement(e,r)}}),ls={conjunctions:RS,operators:CS,widgets:LS,types:IS,settings:bS,ctx:FS};ls=gr.ConfigMixins.removeMixins(ls,["rangeslider","treeselect","treemultiselect"]);const pt=ls;var jO=y(38221);function Ld(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Uo(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ld(Object(r),!0).forEach(function(n){_defineProperty(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Ld(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}var qi=gr.Autocomplete,Go=qi.mergeListValues,Id=qi.listValueToOption,NS=qi.optionToListValue,wS=qi.optionsToListValues,PS=qi.fixListValuesGroupOrder,Ri=gr.ListUtils,_S=Ri.mapListValues,bd=Ri.listValuesToArray,Bo=Ri.getListValue,DS=Ri.makeCustomListValue,MS=Ri.searchListValue,kO=Ri.getItemInListValues;function VS(a){return new Promise(function(e){setTimeout(e,a)})}var xO=function(e,r){var n=e.asyncFetch,t=e.useLoadMore,i=e.useAsyncSearch,u=e.forceAsyncSearch,o=e.asyncListValues,s=e.listValues,c=e.allowCustomValues,f=e.value,d=e.setValue,v=e.placeholder,g=e.config,m=r.debounceTimeout,E=r.multiple,O=r.uif,R=["LOAD_MORE","LOADING_MORE"],w="Load more...",P="Loading more...",F=u?"Type to search":v,k=React.useState(!1),W=_slicedToArray(k,2),q=W[0],re=W[1],Z=React.useState(void 0),J=_slicedToArray(Z,2),te=J[0],le=J[1],ee=React.useState(0),ie=_slicedToArray(ee,2),oe=ie[0],pe=ie[1],se=React.useState(!1),de=_slicedToArray(se,2),ge=de[0],Fe=de[1],De=React.useState(""),ke=_slicedToArray(De,2),Oe=ke[0],je=ke[1],Je=React.useState(void 0),xe=_slicedToArray(Je,2),Ze=xe[0],Ye=xe[1],mr=React.useRef(0),Or=React.useRef(0),tt=React.useRef(!1),Lt=bd(o),st=n?o?Go(Ze,Lt,!0):Ze:s,vt=n?Ze:s;c&&Oe&&!MS(Oe,Ze)&&(vt=Go(vt,[DS(Oe)],!0)),n&&!Ze&&o&&!Oe&&!q&&O==="antd"&&(vt=st),n&&!c&&o&&O==="mui"&&(vt=Go(vt,Lt,!0,!0));var qt=oe>0,It=q&&n&&Ze===void 0&&(u?Oe:!0),zr=It&&qt,Lr=!zr&&st&&st.length>0&&te&&te.hasMore&&(te.filter||"")===Oe,et=!qt&&Lr,rn=_S(vt,Id),En=f!=null,kn=!E&&En?Bo(f,st):null,Wt=function(){var gt=_asyncToGenerator(_regeneratorRuntime.mark(function er(){var fr,hr,Br,Dt,Et,mt,Tn,bt,Ii,Xa,qa,bi,ea,Ca,Fi,ra=arguments;return _regeneratorRuntime.wrap(function(An){for(;;)switch(An.prev=An.next){case 0:return fr=ra.length>0&&ra[0]!==void 0?ra[0]:null,hr=ra.length>1&&ra[1]!==void 0?ra[1]:!1,!hr&&te&&le(void 0),Br=hr&&Ze?Ze.length:0,Dt=hr&&te||!t&&{pageSize:0},Et=++mr.current,An.next=8,n.call(g?.ctx,fr,Br,Dt);case 8:if(mt=An.sent,Tn=mr.current!=Et,!(Tn||!Or.current)){An.next=12;break}return An.abrupt("return",null);case 12:return bt=mt!=null&&mt.values?mt:{values:mt},Ii=bt.values,Xa=bt.hasMore,qa=bt.meta,bi=bd(Ii),hr?(Ca=Go(Ze,bi,!1),ea=Ca.length>Ze.length):(Ca=bi,t&&(ea=Ca.length>0)),Fi=Xa!=null||qa!=null||ea!=null?Uo(Uo(Uo(Uo({},ea!=null?{hasMore:ea}:{}),Xa!=null?{hasMore:Xa}:{}),qa??{}),{},{filter:fr}):void 0,Fi&&le(Fi),An.abrupt("return",Ca);case 18:case"end":return An.stop()}},er)}));return function(){return gt.apply(this,arguments)}}(),$t=function(){var gt=_asyncToGenerator(_regeneratorRuntime.mark(function er(){var fr,hr,Br,Dt=arguments;return _regeneratorRuntime.wrap(function(mt){for(;;)switch(mt.prev=mt.next){case 0:return fr=Dt.length>0&&Dt[0]!==void 0?Dt[0]:null,hr=Dt.length>1&&Dt[1]!==void 0?Dt[1]:!1,pe(function(Tn){return Tn+1}),Fe(hr),mt.next=6,Wt(fr,hr);case 6:if(Br=mt.sent,Or.current){mt.next=9;break}return mt.abrupt("return");case 9:Br!=null&&Ye(Br),pe(function(Tn){return Tn-1}),Fe(!1);case 12:case"end":return mt.stop()}},er)}));return function(){return gt.apply(this,arguments)}}(),Aa=React.useCallback(debounce($t,m),[]);React.useEffect(function(){return Or.current++,It&&oe==0&&mr.current==0&&_asyncToGenerator(_regeneratorRuntime.mark(function gt(){return _regeneratorRuntime.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return fr.next=2,$t();case 2:case"end":return fr.stop()}},gt)}))(),function(){Or.current--}},[It]);var za=function(){re(!0)},Sn=function(){var gt=_asyncToGenerator(_regeneratorRuntime.mark(function er(fr){var hr,Br;return _regeneratorRuntime.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:if(hr=tt.current,hr?(tt.current=!1,E&&re(!1)):re(!1),!(O==="mui"&&!hr)){Et.next=6;break}return Br="",Et.next=6,Qn(null,Br,"my-reset");case 6:case"end":return Et.stop()}},er)}));return function(fr){return gt.apply(this,arguments)}}(),On=function(er){er?za():Sn()},Ji=function(er){var fr=er?.specialValue||er?.value;return R.includes(fr)},Qi=function(){var gt=_asyncToGenerator(_regeneratorRuntime.mark(function er(fr,hr,Br){var Dt,Et,mt,Tn,bt,Ii,Xa,qa,bi,ea,Ca,Fi,ra,$o,An,Gd;return _regeneratorRuntime.wrap(function(Ht){for(;;)switch(Ht.prev=Ht.next){case 0:if(Et=E&&O==="mui"&&Br==="clear",mt=!E&&O==="mui"&&Br==="clear"&&fr?.type==="change",O==="mui"&&(Br=hr,E?hr=Br.map(function(xn){var vs;return(vs=xn?.value)!==null&&vs!==void 0?vs:xn}):hr=(Tn=(bt=Br)===null||bt===void 0?void 0:bt.value)!==null&&Tn!==void 0?Tn:Br),Ii=E&&Array.isArray(Br)&&Br.map(function(xn){return xn?.specialValue}).find(function(xn){return!!xn})||((Dt=Br)===null||Dt===void 0?void 0:Dt.specialValue),E&&hr&&!Array.isArray(hr)&&(hr=[].concat(_toConsumableArray(f||[]),[hr]),Br=null),Xa=Et&&hr.length===0&&Oe&&q||mt,!Xa){Ht.next=8;break}return Ht.abrupt("return");case 8:if(qa=E&&hr.length&&hr.length>(f||[]).length&&hr[hr.length-1]==Oe&&!Bo(Oe,Ze),Ii!="LOAD_MORE"){Ht.next=16;break}return je(Oe),tt.current=!0,Ht.next=14,$t(Oe,!0);case 14:Ht.next=32;break;case 16:if(Ii!="LOADING_MORE"){Ht.next=20;break}tt.current=!0,Ht.next=32;break;case 20:if(!E){Ht.next=30;break}if(bi=wS(hr,st,c),ea=_slicedToArray(bi,2),Ca=ea[0],Fi=ea[1],d(Ca,n?Fi:void 0),!qa){Ht.next=28;break}return Ht.next=26,VS(0);case 26:return Ht.next=28,Qn(null,"","my-reset");case 28:Ht.next=32;break;case 30:ra=NS(hr,st,c),$o=_slicedToArray(ra,2),An=$o[0],Gd=$o[1],d(An,n?Gd:void 0);case 32:case"end":return Ht.stop()}},er)}));return function(fr,hr,Br){return gt.apply(this,arguments)}}(),Qn=function(){var gt=_asyncToGenerator(_regeneratorRuntime.mark(function er(fr,hr,Br){var Dt,Et,mt;return _regeneratorRuntime.wrap(function(bt){for(;;)switch(bt.prev=bt.next){case 0:if(Dt=O==="mui"&&Br==="reset",Et=hr,!(Et===w||Et===P||Dt)){bt.next=4;break}return bt.abrupt("return");case 4:if(hr==Oe){bt.next=13;break}if(je(Et),mt=i&&(u?!!Et:!0),!mt){bt.next=12;break}return bt.next=10,Aa(Et);case 10:bt.next=13;break;case 12:i&&u&&Ye([]);case 13:case"end":return bt.stop()}},er)}));return function(fr,hr,Br){return gt.apply(this,arguments)}}(),Li=function(er){var fr=_toConsumableArray(er);return t&&(et?fr.push({specialValue:"LOAD_MORE",title:w}):ge&&fr.push({specialValue:"LOADING_MORE",title:P,disabled:!0})),fr},xr=function(er,fr){if(fr==null)return null;var hr=fr.value!=null?fr.value:fr;return er.value===hr},un=function(er){return er&&er.disabled},sn=function(er){var fr;if(er!=null&&er.isCustom)return!0;var hr=(fr=er?.value)!==null&&fr!==void 0?fr:er,Br=Bo(hr,st);return Br?.isCustom||!1},Ra=function(er){if(er==null)return null;var fr=er.value!=null?er:Id(Bo(er,st));return!fr&&er.specialValue?er.title:!fr&&c||!fr?er:fr.title||fr.label||fr.value},Zn=O==="mui"?PS(rn):rn;return{options:Zn,listValues:st,hasValue:En,selectedListValue:kn,open:q,onOpen:za,onClose:Sn,onDropdownVisibleChange:On,onChange:Qi,inputValue:Oe,onInputChange:Qn,canShowLoadMore:et,isInitialLoading:zr,isLoading:qt,isLoadingMore:ge,isSpecialValue:Ji,extendOptions:Li,getOptionSelected:xr,getOptionDisabled:un,getOptionIsCustom:sn,getOptionLabel:Ra,aPlaceholder:F}};const UO=null;function Fd(a,e){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),r.push.apply(r,n)}return r}function Nd(a){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Fd(Object(r),!0).forEach(function(n){(0,Se.A)(a,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Fd(Object(r)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(r,n))})}return a}const Ka=Nd(Nd({},gr),{},{ReactUtils:Te,DragIcon:Af});var wd=y(47232),jS=y(63383);const cs={add:"Add",remove:"Remove"},Pd={id:Ka.uuid(),type:"group"},_d="timeFilter",Dd=[_d],kS={...pt.widgets,text:{...pt.widgets.text,factory:function(e){return h.createElement(vn.p,{value:e?.value||"",placeholder:e?.placeholder,onChange:r=>e?.setValue(r.currentTarget.value)})}},number:{...pt.widgets.number,factory:function(e){return h.createElement(vn.p,{value:e?.value,placeholder:e?.placeholder,type:"number",onChange:r=>e?.setValue(Number.parseInt(r.currentTarget.value,10))})}},datetime:{...pt.widgets.datetime,factory:function(e){if(e?.operator==="macros")return h.createElement(Ft.l6,{id:e.id,"aria-label":"Macros value selector",menuShouldPortal:!0,options:Dd.map(Be.z),value:e?.value,onChange:n=>e.setValue(n.value)});const r=(0,wd.KQ)(e?.value).isValid()?(0,wd.KQ)(e?.value).utc():void 0;return h.createElement(jS.K,{onChange:n=>{e?.setValue(n.format(pt.widgets.datetime.valueFormat))},date:r})},sqlFormatValue:(a,e,r,n,t,i)=>n==="macros"?Dd.includes(a)?a:void 0:typeof pt.widgets.datetime.sqlFormatValue=="string"||typeof pt.widgets.datetime.sqlFormatValue=="object"?void 0:pt.widgets.datetime.sqlFormatValue?.call(pt.ctx,a,e,r,n,t,i)||""}},xS={...pt.settings,canRegroup:!1,maxNesting:1,canReorder:!1,showNot:!1,addRuleLabel:cs.add,deleteLabel:cs.remove,renderConjs:function(e){return h.createElement(Ft.l6,{id:e?.id,"aria-label":"Conjunction",menuShouldPortal:!0,options:e?.conjunctionOptions?Object.keys(e?.conjunctionOptions).map(Be.z):void 0,value:e?.selectedConjunction,onChange:r=>e?.setConjunction(r.value)})},renderField:function(e){const r=e?.config?.fields||{};return h.createElement(Ft.l6,{id:e?.id,width:25,"aria-label":"Field",menuShouldPortal:!0,options:e?.items.map(n=>{const t=r[n.key].mainWidgetProps?.customProps?.icon;return{label:n.label,value:n.key,icon:t}}),value:e?.selectedKey,onChange:n=>{e?.setField(n.label)}})},renderButton:function(e){return h.createElement(Gt.$n,{type:"button",title:`${e?.label} filter`,onClick:e?.onClick,variant:"secondary",size:"md",icon:e?.label===cs.add?"plus":"times"})},renderOperator:function(e){return h.createElement(Ft.l6,{options:e?.items.map(r=>({label:r.label,value:r.key})),"aria-label":"Operator",menuShouldPortal:!0,value:e?.selectedKey,onChange:r=>{e?.setField(r.value||"")}})}};var US=(a=>(a.IN="select_any_in",a.NOT_IN="select_not_any_in",a.MACROS="macros",a))(US||{});const GS=KS(pt),Md=pt.types.text.widgets.text,BS=[...Md.operators||[],"select_any_in","select_not_any_in"],WS={...Md,operators:BS},$S={...pt.types,text:{...pt.types.text,widgets:{...pt.types.text.widgets,text:WS}},datetime:{...pt.types.datetime,widgets:{...pt.types.datetime.widgets,datetime:{...pt.types.datetime.widgets.datetime,operators:["macros",...pt.types.datetime.widgets.datetime.operators||[]]}}}},HS={...pt,widgets:kS,settings:xS,operators:GS,types:$S},Vd=()=>"",jd=a=>typeof a=="function";function KS(a){const{...e}=a.operators,r=()=>{const o=e.select_any_in.sqlFormatOp;return jd(o)?o:Vd},n=(o,s,c,f,d,v,g,m)=>r()(o,s,kd(c),f,d,v,g,m),t=()=>{const o=e.select_not_any_in.sqlFormatOp;return jd(o)?o:Vd},i=(o,s,c,f,d,v,g,m)=>t()(o,s,kd(c),f,d,v,g,m);return{...e,select_any_in:{...e.select_any_in,sqlFormatOp:n},select_not_any_in:{...e.select_not_any_in,sqlFormatOp:i},macros:{label:"Macros",sqlFormatOp:(o,s,c)=>c===_d?`$__timeFilter(${o})`:c}}}function kd(a){return(0,Ie.isString)(a)?a.split(","):a}function YS({sql:a,config:e,onSqlChange:r}){const[n,t]=(0,h.useState)(),i=(0,h.useMemo)(()=>({...HS,...e}),[e]);(0,h.useEffect)(()=>{if(!n){const o=Ka.checkTree(Ka.loadTree(a.whereJsonTree??Pd),i);t(o)}},[i,a.whereJsonTree,n]),(0,h.useEffect)(()=>{a.whereJsonTree||t(Ka.checkTree(Ka.loadTree(Pd),i))},[i,a.whereJsonTree]);const u=(0,h.useCallback)((o,s)=>{t(o);const c={...a,whereJsonTree:Ka.getTree(o),whereString:Ka.sqlFormat(o,s)};r(c)},[r,a]);return n?h.createElement(yf,{...i,value:n,onChange:u,renderBuilder:o=>h.createElement(zE,{...o})}):null}function Wo(a){return`
    display: flex;
    gap: 8px;
    flex-direction: ${a};`}(0,Jr.injectGlobal)`
  .group--header {
    ${Wo("row")}
  }

  .group-or-rule {
    ${Wo("column")}
    .rule {
      flex-direction: row;
    }
  }

  .rule--body {
    ${Wo("row")}
  }

  .group--children {
    ${Wo("column")}
  }

  .group--conjunctions:empty {
    display: none;
  }
`;function zS({query:a,fields:e,onQueryChange:r,db:n}){const t=(0,si.A)(async()=>XS(e),[e]),{onSqlChange:i}=Va({query:a,onQueryChange:r,db:n});return h.createElement(YS,{key:JSON.stringify(t.value),config:{fields:t.value||{}},sql:a.sql,onSqlChange:u=>{const o=(0,kr.w)().getVariables();qS(u,o),i(u)}})}function XS(a){const e={};for(const r of a)e[r.value]={type:r.raqbFieldType||"text",valueSources:["value"],mainWidgetProps:{customProps:{icon:r.icon}}};return e}function qS(a,e){const r=n=>n.multi&&(a.whereString?.includes(`\${${n.name}}`)||a.whereString?.includes(`$${n.name}`));e.some(n=>r(n))&&(a.whereString=a.whereString?.replaceAll("')",")"),a.whereString=a.whereString?.replaceAll("('","("))}const JS=({query:a,db:e,queryRowFilter:r,onChange:n,onValidate:t,range:i})=>{const u=(0,He.A)(async()=>await e.fields(a),[e,a.dataset,a.table]);return h.createElement(h.Fragment,null,h.createElement(Ma.D,null,h.createElement(cn.U,null,h.createElement(fa,{fields:u.value||[],query:a,onQueryChange:n,db:e})),r.filter&&h.createElement(cn.U,null,h.createElement(wr.c,{label:"Filter by column value",optional:!0},h.createElement(zS,{fields:u.value||[],query:a,onQueryChange:n,db:e}))),r.group&&h.createElement(cn.U,null,h.createElement(wr.c,{label:"Group by column"},h.createElement(co,{fields:u.value||[],query:a,onQueryChange:n,db:e}))),r.order&&h.createElement(cn.U,null,h.createElement(qo,{fields:u.value||[],query:a,onQueryChange:n,db:e})),r.preview&&a.rawSql&&h.createElement(cn.U,null,h.createElement(so,{rawSql:a.rawSql,datasourceType:a.datasource?.type}))),h.createElement(_i,{db:e,query:a,onValidate:t,range:i}))};function xd({datasource:a,query:e,onChange:r,onRunQuery:n,range:t,queryHeaderProps:i}){const[u,o]=(0,h.useState)(!0),s=a.getDB(),{preconfiguredDatabase:c}=a,f=i?.dialect??"other",{loading:d,error:v}=(0,He.A)(async()=>()=>{a.getDB(a.id).init!==void 0&&a.getDB(a.id).init()},[a]),g=Rn(e),[m,E]=(0,h.useState)({filter:!!g.sql?.whereString,group:!!g.sql?.groupBy?.[0]?.property.name,order:!!g.sql?.orderBy?.property.name,preview:!0}),[O,R]=(0,h.useState)(g);(0,h.useEffect)(()=>()=>{a.getDB(a.id).dispose!==void 0&&a.getDB(a.id).dispose()},[a]);const w=(0,h.useCallback)(k=>{QS(k)&&n&&n()},[n]),P=(k,W=!0)=>{R(k),r(k),sr(k.sql?.columns)&&k.sql?.columns.some(q=>q.name)&&!m.group&&E({...m,group:!0}),W&&w(k)},F=k=>{R(k),r(k)};return d||v?null:h.createElement(h.Fragment,null,h.createElement(Ia,{db:s,preconfiguredDataset:c,onChange:F,onRunQuery:n,onQueryRowChange:E,queryRowFilter:m,query:g,isQueryRunnable:u,dialect:f}),h.createElement(We.$,{v:.5}),g.editorMode!==N.lX.Code&&h.createElement(JS,{db:s,query:g,onChange:k=>P(k,!1),queryRowFilter:m,onValidate:o,range:t}),g.editorMode===N.lX.Code&&h.createElement(wn,{db:s,query:g,queryToValidate:O,onChange:P,onRunQuery:n,onValidate:o,range:t}))}const QS=a=>!!a.rawSql;function ZS(a){const e=typeof a.rawQuery=="string"?a.rawQuery:null;if(!e)return a;const r=Rn({refId:"Annotation",...a.target??{},rawSql:e});return{...a,rawQuery:void 0,workspace:void 0,subscription:void 0,queryType:void 0,target:r}}class eO extends Wr.iy{constructor(e,r=(0,kr.w)()){super(e),this.templateSrv=r,this.interpolateVariable=(t,i)=>typeof t=="string"?i.multi||i.includeAll?this.getQueryModel().quoteLiteral(t):String(t).replace(/'/g,"''"):typeof t=="number"?t:Array.isArray(t)?t.map(o=>this.getQueryModel().quoteLiteral(o)).join(","):t,this.name=e.name,this.responseParser=new _e,this.id=e.id;const n=e.jsonData||{};this.interval=n.timeInterval||"1m",this.db=this.getDB(),this.preconfiguredDatabase=n.database??"",this.annotations={prepareAnnotation:ZS,QueryEditor:xd}}getResponseParser(){return this.responseParser}interpolateVariablesInQueries(e,r){let n=e;return e&&e.length>0&&(n=e.map(t=>({...t,datasource:this.getRef(),rawSql:this.templateSrv.replace(t.rawSql,r,this.interpolateVariable),rawQuery:!0}))),n}filterQuery(e){return!e.hide}applyTemplateVariables(e,r){return{refId:e.refId,datasource:this.getRef(),rawSql:this.templateSrv.replace(e.rawSql,r,this.interpolateVariable),format:e.format}}query(e){if(Gn()){const r=this.checkForDatabaseIssue(e);if(r){const n=new Error(r);return(0,dr.$)(()=>n)}}return e.targets.forEach(r=>{e.app===tr.Jk.Dashboard||e.app===tr.Jk.PanelViewer||(0,Ee.rR)("grafana_sql_query_executed",{datasource:r.datasource?.type,editorMode:r.editorMode,format:r.format,app:e.app})}),super.query(e)}checkForDatabaseIssue(e){if(this.type==="postgres"&&!this.preconfiguredDatabase)return`You do not currently have a default database configured for this data source. Postgres requires a default
             database with which to connect. Please configure one through the Data Sources Configuration page, or if you
             are using a provisioning file, update that configuration file with a default database.`;if(e.app!==tr.Jk.Explore&&this.preconfiguredDatabase){for(const r of e.targets)if(r.editorMode===N.lX.Builder&&r.dataset!==this.preconfiguredDatabase)return`The configuration for this panel's data source has been modified. The previous database used in this panel's
                   saved query is no longer available. Please update the query to use the new database option.
                   Previous query parameters will be preserved until the query is updated.`}}async metricFindQuery(e,r){const n=r?.range;if(n==null)return[];let t="tempvar";r&&r.variable&&r.variable.name&&(t=r.variable.name);const i={...r?.scopedVars,...(0,yr.c)({query:e,wildcardChar:"%",options:r})},u=this.templateSrv.replace(e,i,this.interpolateVariable),o={refId:t,datasource:this.getRef(),rawSql:u,format:Ue.Table};let s;try{s=await this.runMetaQuery(o,n)}catch(c){throw console.error(c),new Error("error when executing the sql query")}return this.getResponseParser().transformMetricFindResponse(s)}async runSql(e,r){const n=(0,Pe.E2)(),t=await this.runMetaQuery({rawSql:e,format:Ue.Table,refId:r?.refId},n);return new Xr.R(t)}runMetaQuery(e,r){const n=e.refId||"meta",t=[{...e,datasource:e.datasource||this.getRef(),refId:n}];return(0,pr.s)((0,ye.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:r.from.valueOf().toString(),to:r.to.valueOf().toString(),queries:t},requestId:n}).pipe((0,rr.T)(i=>(0,Ae.bE)(i,t).data[0]??{fields:[]})))}targetContainsTemplate(e){let r=e.rawSql;return Jo.forEach(n=>{r=r?.replace(n,"")||""}),this.templateSrv.containsTemplate(r)}}var rO=y(29020),Ya=y(60029),tO=y(76892);function fs(a){return a.trim()===""?NaN:Number(a)}const nO=a=>{const{onOptionsChange:e,options:r}=a,n=r.jsonData,t=n.maxIdleConnsAuto!==void 0?n.maxIdleConnsAuto:!1,i=f=>{const d={...r,jsonData:{...n,...f}};return e(d)},u=f=>d=>{i({[f]:d})},o=f=>{i(t&&f?{maxOpenConns:f,maxIdleConns:f}:{maxOpenConns:f})},s=()=>{let f,d;t?(d=n.maxOpenConns,f=n.maxIdleConns):n.maxOpenConns!==void 0&&(d=n.maxOpenConns,f=n.maxOpenConns),i({maxIdleConnsAuto:!t,maxIdleConns:f,maxOpenConns:d})},c=40;return h.createElement(rO.I,{title:"Connection limits"},h.createElement(Vr.D,{label:h.createElement(Ya.J,null,h.createElement(Kn.B,{gap:.5},h.createElement("span",null,"Max open"),h.createElement(Kt.m,{content:h.createElement("span",null,"The maximum number of open connections to the database. If ",h.createElement("i",null,"Max idle connections")," is greater than 0 and the ",h.createElement("i",null,"Max open connections")," is less than ",h.createElement("i",null,"Max idle connections"),", then",h.createElement("i",null,"Max idle connections")," will be reduced to match the ",h.createElement("i",null,"Max open connections")," limit. If set to 0, there is no limit on the number of open connections.")},h.createElement(Mt.I,{name:"info-circle",size:"sm"}))))},h.createElement(vn.p,{type:"number",placeholder:"unlimited",defaultValue:n.maxOpenConns,onChange:f=>{const d=fs(f.currentTarget.value);Number.isNaN(d)||o(d)},width:c})),h.createElement(Vr.D,{label:h.createElement(Ya.J,null,h.createElement(Kn.B,{gap:.5},h.createElement("span",null,"Auto Max Idle"),h.createElement(Kt.m,{content:h.createElement("span",null,"If enabled, automatically set the number of ",h.createElement("i",null,"Maximum idle connections")," to the same value as",h.createElement("i",null," Max open connections"),". If the number of maximum open connections is not set it will be set to the default (",Ln.$.sqlConnectionLimits.maxIdleConns,").")},h.createElement(Mt.I,{name:"info-circle",size:"sm"}))))},h.createElement(fn.d,{value:t,onChange:s})),h.createElement(Vr.D,{label:h.createElement(Ya.J,null,h.createElement(Kn.B,{gap:.5},h.createElement("span",null,"Max idle"),h.createElement(Kt.m,{content:h.createElement("span",null,"The maximum number of connections in the idle connection pool.If ",h.createElement("i",null,"Max open connections")," is greater than 0 but less than the ",h.createElement("i",null,"Max idle connections"),", then the ",h.createElement("i",null,"Max idle connections")," ","will be reduced to match the ",h.createElement("i",null,"Max open connections")," limit. If set to 0, no idle connections are retained.")},h.createElement(Mt.I,{name:"info-circle",size:"sm"}))))},t?h.createElement(tO.c,{width:c},r.jsonData.maxIdleConns):h.createElement(vn.p,{type:"number",placeholder:"2",defaultValue:n.maxIdleConns,onChange:f=>{const d=fs(f.currentTarget.value);Number.isNaN(d)||u("maxIdleConns")(d)},width:c,disabled:t})),h.createElement(Vr.D,{label:h.createElement(Ya.J,null,h.createElement(Kn.B,{gap:.5},h.createElement("span",null,"Max lifetime"),h.createElement(Kt.m,{content:h.createElement("span",null,"The maximum amount of time in seconds a connection may be reused. If set to 0, connections are reused forever.")},h.createElement(Mt.I,{name:"info-circle",size:"sm"}))))},h.createElement(vn.p,{type:"number",placeholder:"14400",defaultValue:n.connMaxLifetime,onChange:f=>{const d=fs(f.currentTarget.value);Number.isNaN(d)||u("connMaxLifetime")(d)},width:c})))},aO=()=>{const a=(0,St.of)(iO);return h.createElement("hr",{className:a.horizontalDivider})},iO=a=>({horizontalDivider:(0,Jr.css)({borderTop:`1px solid ${a.colors.border.weak}`,margin:a.spacing(2,0),width:"100%"})});var Ci=y(22391),ds=y(67061),ps=y(58724);const oO=a=>{const{editorProps:e,showCACert:r,showKeyPair:n=!0}=a,{secureJsonFields:t}=e.options;return h.createElement(h.Fragment,null,n?h.createElement(Vr.D,{label:h.createElement(Ya.J,null,h.createElement(ds.B,{gap:.5},h.createElement("span",null,"TLS/SSL Client Certificate"),h.createElement(Kt.m,{content:h.createElement("span",null,"To authenticate with an TLS/SSL client certificate, provide the client certificate here.")},h.createElement(Mt.I,{name:"info-circle",size:"sm"}))))},h.createElement(ps.lp,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:t&&t.tlsClientCert,onChange:(0,Ci.mn)(e,"tlsClientCert"),onReset:()=>{(0,Ci.QP)(e,"tlsClientCert")}})):null,r?h.createElement(Vr.D,{label:h.createElement(Ya.J,null,h.createElement(ds.B,{gap:.5},h.createElement("span",null,"TLS/SSL Root Certificate"),h.createElement(Kt.m,{content:h.createElement("span",null,"If the selected TLS/SSL mode requires a server root certificate, provide it here.")},h.createElement(Mt.I,{name:"info-circle",size:"sm"}))))},h.createElement(ps.lp,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:t&&t.tlsCACert,onChange:(0,Ci.mn)(e,"tlsCACert"),onReset:()=>{(0,Ci.QP)(e,"tlsCACert")}})):null,n?h.createElement(Vr.D,{label:h.createElement(Ya.J,null,h.createElement(ds.B,{gap:.5},h.createElement("span",null,"TLS/SSL Client Key"),h.createElement(Kt.m,{content:h.createElement("span",null,"To authenticate with a client TLS/SSL certificate, provide the key here.")},h.createElement(Mt.I,{name:"info-circle",size:"sm"}))))},h.createElement(ps.lp,{placeholder:"-----BEGIN RSA PRIVATE KEY-----",cols:45,rows:7,isConfigured:t&&t.tlsClientKey,onChange:(0,Ci.mn)(e,"tlsClientKey"),onReset:()=>{(0,Ci.QP)(e,"tlsClientKey")}})):null)};var uO=y(34867);const Ud=(0,uO.DW)("features.plugins.sql");function sO({onOptionsChange:a,options:e}){(0,h.useEffect)(()=>{const r=e.jsonData;let n={...e},t=!1;if(e.database&&(Ud.logDebug(`Migrating from options.database with value ${e.database} for ${e.name}`),n.database="",n.jsonData={...r,database:e.database},t=!0),r.maxOpenConns===void 0&&r.maxIdleConns===void 0&&r.maxIdleConnsAuto===void 0){const{maxOpenConns:i,maxIdleConns:u}=Ln.$.sqlConnectionLimits;Ud.logDebug(`Setting default max open connections to ${i} and setting max idle connection to ${u}`),n.jsonData={...n.jsonData,maxOpenConns:i,maxIdleConns:u,maxIdleConnsAuto:!0},t=!0}if(r.connMaxLifetime===void 0){const{connMaxLifetime:i}=Ln.$.sqlConnectionLimits;n.jsonData={...n.jsonData,connMaxLifetime:i},t=!0}t&&a(n)},[a,e])}},18678:function(he,ae,y){var j,L;(function(D,B){j=B,L=typeof j=="function"?j.call(ae,y,ae,he):j,L!==void 0&&(he.exports=L)})(this,function(){"use strict";Array.isArray||(Array.isArray=function(I){return Object.prototype.toString.call(I)==="[object Array]"});function D(I){for(var C=[],x=0,_=I.length;x<_;x++)C.indexOf(I[x])===-1&&C.push(I[x]);return C}var B={},H={"==":function(I,C){return I==C},"===":function(I,C){return I===C},"!=":function(I,C){return I!=C},"!==":function(I,C){return I!==C},">":function(I,C){return I>C},">=":function(I,C){return I>=C},"<":function(I,C,x){return x===void 0?I<C:I<C&&C<x},"<=":function(I,C,x){return x===void 0?I<=C:I<=C&&C<=x},"!!":function(I){return B.truthy(I)},"!":function(I){return!B.truthy(I)},"%":function(I,C){return I%C},log:function(I){return console.log(I),I},in:function(I,C){return!C||typeof C.indexOf>"u"?!1:C.indexOf(I)!==-1},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(I,C,x){if(x<0){var _=String(I).substr(C);return _.substr(0,_.length+x)}return String(I).substr(C,x)},"+":function(){return Array.prototype.reduce.call(arguments,function(I,C){return parseFloat(I,10)+parseFloat(C,10)},0)},"*":function(){return Array.prototype.reduce.call(arguments,function(I,C){return parseFloat(I,10)*parseFloat(C,10)})},"-":function(I,C){return C===void 0?-I:I-C},"/":function(I,C){return I/C},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,function(I,C){return I.concat(C)},[])},var:function(I,C){var x=C===void 0?null:C,_=this;if(typeof I>"u"||I===""||I===null)return _;for(var T=String(I).split("."),V=0;V<T.length;V++)if(_==null||(_=_[T[V]],_===void 0))return x;return _},missing:function(){for(var I=[],C=Array.isArray(arguments[0])?arguments[0]:arguments,x=0;x<C.length;x++){var _=C[x],T=B.apply({var:_},this);(T===null||T==="")&&I.push(_)}return I},missing_some:function(I,C){var x=B.apply({missing:C},this);return C.length-x.length>=I?[]:x}};return B.is_logic=function(I){return typeof I=="object"&&I!==null&&!Array.isArray(I)&&Object.keys(I).length===1},B.truthy=function(I){return Array.isArray(I)&&I.length===0?!1:!!I},B.get_operator=function(I){return Object.keys(I)[0]},B.get_values=function(I){return I[B.get_operator(I)]},B.apply=function(I,C){if(Array.isArray(I))return I.map(function(Te){return B.apply(Te,C)});if(!B.is_logic(I))return I;var x=B.get_operator(I),_=I[x],T,V,z,M,U;if(Array.isArray(_)||(_=[_]),x==="if"||x=="?:"){for(T=0;T<_.length-1;T+=2)if(B.truthy(B.apply(_[T],C)))return B.apply(_[T+1],C);return _.length===T+1?B.apply(_[T],C):null}else if(x==="and"){for(T=0;T<_.length;T+=1)if(V=B.apply(_[T],C),!B.truthy(V))return V;return V}else if(x==="or"){for(T=0;T<_.length;T+=1)if(V=B.apply(_[T],C),B.truthy(V))return V;return V}else{if(x==="filter")return M=B.apply(_[0],C),z=_[1],Array.isArray(M)?M.filter(function(Te){return B.truthy(B.apply(z,Te))}):[];if(x==="map")return M=B.apply(_[0],C),z=_[1],Array.isArray(M)?M.map(function(Te){return B.apply(z,Te)}):[];if(x==="reduce")return M=B.apply(_[0],C),z=_[1],U=typeof _[2]<"u"?_[2]:null,Array.isArray(M)?M.reduce(function(Te,me){return B.apply(z,{current:me,accumulator:Te})},U):U;if(x==="all"){if(M=B.apply(_[0],C),z=_[1],!Array.isArray(M)||!M.length)return!1;for(T=0;T<M.length;T+=1)if(!B.truthy(B.apply(z,M[T])))return!1;return!0}else if(x==="none"){if(M=B.apply(_[0],C),z=_[1],!Array.isArray(M)||!M.length)return!0;for(T=0;T<M.length;T+=1)if(B.truthy(B.apply(z,M[T])))return!1;return!0}else if(x==="some"){if(M=B.apply(_[0],C),z=_[1],!Array.isArray(M)||!M.length)return!1;for(T=0;T<M.length;T+=1)if(B.truthy(B.apply(z,M[T])))return!0;return!1}}if(_=_.map(function(Te){return B.apply(Te,C)}),H.hasOwnProperty(x)&&typeof H[x]=="function")return H[x].apply(C,_);if(x.indexOf(".")>0){var K=String(x).split("."),Y=H;for(T=0;T<K.length;T++){if(!Y.hasOwnProperty(K[T]))throw new Error("Unrecognized operation "+x+" (failed at "+K.slice(0,T+1).join(".")+")");Y=Y[K[T]]}return Y.apply(C,_)}throw new Error("Unrecognized operation "+x)},B.uses_data=function(I){var C=[];if(B.is_logic(I)){var x=B.get_operator(I),_=I[x];Array.isArray(_)||(_=[_]),x==="var"?C.push(_[0]):_.forEach(function(T){C.push.apply(C,B.uses_data(T))})}return D(C)},B.add_operation=function(I,C){H[I]=C},B.rm_operation=function(I){delete H[I]},B.rule_like=function(I,C){if(C===I||C==="@")return!0;if(C==="number")return typeof I=="number";if(C==="string")return typeof I=="string";if(C==="array")return Array.isArray(I)&&!B.is_logic(I);if(B.is_logic(C)){if(B.is_logic(I)){var x=B.get_operator(C),_=B.get_operator(I);if(x==="@"||x===_)return B.rule_like(B.get_values(I,!1),B.get_values(C,!1))}return!1}if(Array.isArray(C))if(Array.isArray(I)){if(C.length!==I.length)return!1;for(var T=0;T<C.length;T+=1)if(!B.rule_like(I[T],C[T]))return!1;return!0}else return!1;return!1},B})},87805:(he,ae,y)=>{var j=y(43360),L=y(75288);function D(B,H,I){(I!==void 0&&!L(B[H],I)||I===void 0&&!(H in B))&&j(B,H,I)}he.exports=D},85250:(he,ae,y)=>{var j=y(37217),L=y(87805),D=y(86649),B=y(42824),H=y(23805),I=y(37241),C=y(14974);function x(_,T,V,z,M){_!==T&&D(T,function(U,K){if(M||(M=new j),H(U))B(_,T,K,V,x,z,M);else{var Y=z?z(C(_,K),U,K+"",_,T,M):void 0;Y===void 0&&(Y=U),L(_,K,Y)}},I)}he.exports=x},42824:(he,ae,y)=>{var j=y(87805),L=y(93290),D=y(71961),B=y(23007),H=y(35529),I=y(72428),C=y(56449),x=y(83693),_=y(3656),T=y(1882),V=y(23805),z=y(11331),M=y(37167),U=y(14974),K=y(69884);function Y(Te,me,Xe,Be,Ue,Re,ar){var Ke=U(Te,Xe),dr=U(me,Xe),pr=ar.get(dr);if(pr){j(Te,Xe,pr);return}var rr=Re?Re(Ke,dr,Xe+"",Te,me,ar):void 0,tr=rr===void 0;if(tr){var yr=C(dr),Pe=!yr&&_(dr),Xr=!yr&&!Pe&&M(dr);rr=dr,yr||Pe||Xr?C(Ke)?rr=Ke:x(Ke)?rr=B(Ke):Pe?(tr=!1,rr=L(dr,!0)):Xr?(tr=!1,rr=D(dr,!0)):rr=[]:z(dr)||I(dr)?(rr=Ke,I(Ke)?rr=K(Ke):(!V(Ke)||T(Ke))&&(rr=H(dr))):tr=!1}tr&&(ar.set(dr,rr),Ue(rr,dr,Be,Re,ar),ar.delete(dr)),j(Te,Xe,rr)}he.exports=Y},84051:he=>{var ae=9007199254740991,y=Math.floor;function j(L,D){var B="";if(!L||D<1||D>ae)return B;do D%2&&(B+=L),D=y(D/2),D&&(L+=L);while(D);return B}he.exports=j},69302:(he,ae,y)=>{var j=y(83488),L=y(56757),D=y(32865);function B(H,I){return D(L(H,I,j),H+"")}he.exports=B},30514:(he,ae,y)=>{var j=y(34932);function L(D,B){return j(B,function(H){return D[H]})}he.exports=L},20999:(he,ae,y)=>{var j=y(69302),L=y(36800);function D(B){return j(function(H,I){var C=-1,x=I.length,_=x>1?I[x-1]:void 0,T=x>2?I[2]:void 0;for(_=B.length>3&&typeof _=="function"?(x--,_):void 0,T&&L(I[0],I[1],T)&&(_=x<3?void 0:_,x=1),H=Object(H);++C<x;){var V=I[C];V&&B(H,V,C,_)}return H})}he.exports=D},14974:he=>{function ae(y,j){if(!(j==="constructor"&&typeof y[j]=="function")&&j!="__proto__")return y[j]}he.exports=ae},60680:(he,ae,y)=>{var j=y(13222),L=/[\\^$.*+?()[\]{}|]/g,D=RegExp(L.source);function B(H){return H=j(H),H&&D.test(H)?H.replace(L,"\\$&"):H}he.exports=B},79859:(he,ae,y)=>{var j=y(96131),L=y(64894),D=y(85015),B=y(61489),H=y(35880),I=Math.max;function C(x,_,T,V){x=L(x)?x:H(x),T=T&&!V?B(T):0;var z=x.length;return T<0&&(T=I(z+T,0)),D(x)?T<=z&&x.indexOf(_,T)>-1:!!z&&j(x,_,T)>-1}he.exports=C},83693:(he,ae,y)=>{var j=y(64894),L=y(40346);function D(B){return L(B)&&j(B)}he.exports=D},62193:(he,ae,y)=>{var j=y(88984),L=y(5861),D=y(72428),B=y(56449),H=y(64894),I=y(3656),C=y(55527),x=y(37167),_="[object Map]",T="[object Set]",V=Object.prototype,z=V.hasOwnProperty;function M(U){if(U==null)return!0;if(H(U)&&(B(U)||typeof U=="string"||typeof U.splice=="function"||I(U)||x(U)||D(U)))return!U.length;var K=L(U);if(K==_||K==T)return!U.size;if(C(U))return!j(U).length;for(var Y in U)if(z.call(U,Y))return!1;return!0}he.exports=M},85015:(he,ae,y)=>{var j=y(72552),L=y(56449),D=y(40346),B="[object String]";function H(I){return typeof I=="string"||!L(I)&&D(I)&&j(I)==B}he.exports=H},73916:(he,ae,y)=>{var j=y(43360),L=y(30641),D=y(15389);function B(H,I){var C={};return I=D(I,3),L(H,function(x,_,T){j(C,_,I(x,_,T))}),C}he.exports=B},55364:(he,ae,y)=>{var j=y(85250),L=y(20999),D=L(function(B,H,I){j(B,H,I)});he.exports=D},6924:(he,ae,y)=>{var j=y(85250),L=y(20999),D=L(function(B,H,I,C){j(B,H,I,C)});he.exports=D},71086:(he,ae,y)=>{var j=y(34932),L=y(15389),D=y(97420),B=y(83349);function H(I,C){if(I==null)return{};var x=j(B(I),function(_){return[_]});return C=L(C),D(I,x,function(_,T){return C(_,T[0])})}he.exports=H},12493:(he,ae,y)=>{var j=y(84051),L=y(36800),D=y(61489),B=y(13222);function H(I,C,x){return(x?L(I,C,x):C===void 0)?C=1:C=D(C),j(B(I),C)}he.exports=H},22331:(he,ae,y)=>{var j=y(87133),L=y(77556),D=y(61489),B=y(13222);function H(I,C,x){return I=B(I),x=x==null?0:j(D(x),0,I.length),C=L(C),I.slice(x,x+C.length)==C}he.exports=H},61489:(he,ae,y)=>{var j=y(17400);function L(D){var B=j(D),H=B%1;return B===B?H?B-H:B:0}he.exports=L},69884:(he,ae,y)=>{var j=y(21791),L=y(37241);function D(B){return j(B,L(B))}he.exports=D},35880:(he,ae,y)=>{var j=y(30514),L=y(73569);function D(B){return B==null?[]:j(B,L(B))}he.exports=D},21450:function(he){(function(y,j){he.exports=j()})(this,function(){return function(ae){var y={};function j(L){if(y[L])return y[L].exports;var D=y[L]={i:L,l:!1,exports:{}};return ae[L].call(D.exports,D,D.exports,j),D.l=!0,D.exports}return j.m=ae,j.c=y,j.d=function(L,D,B){j.o(L,D)||Object.defineProperty(L,D,{configurable:!1,enumerable:!0,get:B})},j.n=function(L){var D=L&&L.__esModule?function(){return L.default}:function(){return L};return j.d(D,"a",D),D},j.o=function(L,D){return Object.prototype.hasOwnProperty.call(L,D)},j.p="",j(j.s=3)}([function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0});function L(B,H){var I={},C=B||"Abstract",x=[],_=null,T;if(I._type=C,I.getType=function(){return C},I.setType=function(U){C=U},I.getChildren=function(){return x},I.addChild=function(U){if(U){if(!U.setParent)throw{name:"Error",message:"Trying to add a child which is not a node: "+JSON.stringify(U)};U.setParent(I),x.push(U)}},I.getParent=function(){return _},I.setParent=function(U){_=U},I.getContext=function(U){return T||U.activeContext.peek()},I.setContext=function(U){T=U},I.getStartPosition=function(){return H>>16},I.getEndPosition=function(){return H&65535},I.getValue=function(){throw{name:"MethodNotImplementedException",message:"SpelNode#getValue() must be overridden."}},I.toString=function(){var U="Kind: "+I.getType();U+=", Children: [";for(var K=0,Y=I.getChildren().length;K<Y;K+=1)U+="{"+I.getChildren()[K]+"}, ";return U+="]",U},H===0)throw{name:"Error",message:"Position cannot be 0"};for(var V=arguments.length,z=Array(V>2?V-2:0),M=2;M<V;M++)z[M-2]=arguments[M];return z&&z.forEach(function(U){I.addChild(U)}),I}var D=y.SpelNode={create:L}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Stack=L;function L(D){this.elements=D||[]}L.prototype.push=function(D){return this.elements.push(D),D},L.prototype.pop=function(){return this.elements.pop()},L.prototype.peek=function(){return this.elements[this.elements.length-1]},L.prototype.empty=function(){return this.elements.length>0},L.prototype.search=function(D){return this.elements.length-this.elements.indexOf(D)}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var L={LITERAL_INT:1,LITERAL_LONG:2,LITERAL_HEXINT:3,LITERAL_HEXLONG:4,LITERAL_STRING:5,LITERAL_REAL:6,LITERAL_REAL_FLOAT:7,LPAREN:"(",RPAREN:")",COMMA:",",IDENTIFIER:0,COLON:":",HASH:"#",RSQUARE:"]",LSQUARE:"[",LCURLY:"{",RCURLY:"}",DOT:".",PLUS:"+",STAR:"*",MINUS:"-",SELECT_FIRST:"^[",SELECT_LAST:"$[",QMARK:"?",PROJECT:"![",DIV:"/",GE:">=",GT:">",LE:"<=",LT:"<",EQ:"==",NE:"!=",MOD:"%",NOT:"!",ASSIGN:"=",INSTANCEOF:"instanceof",MATCHES:"matches",BETWEEN:"between",SELECT:"?[",POWER:"^",ELVIS:"?:",SAFE_NAVI:"?.",BEAN_REF:"@",SYMBOLIC_OR:"||",SYMBOLIC_AND:"&&",INC:"++",DEC:"--"};function D(H){this.type=H,this.tokenChars=L[H],this._hasPayload=typeof L[H]!="string",typeof L[H]=="number"&&(this._ordinal=L[H])}for(var B in L)L.hasOwnProperty(B)&&(D[B]=new D(B));D.prototype.toString=function(){return this.type+(this.tokenChars.length!==0?"("+this.tokenChars+")":"")},D.prototype.getLength=function(){return this.tokenChars.length},D.prototype.hasPayload=function(){return this._hasPayload},D.prototype.valueOf=function(H){for(var I in L)if(L.hasOwnProperty(I)&&L[I]===H)return D[I]},D.prototype.ordinal=function(){return this._ordinal},y.TokenKind=D},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.StandardContext=y.SpelExpressionEvaluator=void 0;var L=j(4),D=j(50);y.SpelExpressionEvaluator=L.SpelExpressionEvaluator,y.StandardContext=D.StandardContext},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.SpelExpressionEvaluator=void 0;var L=j(5),D=j(1),B={};function H(I,C,x){var _=new D.Stack,T;return C||(C={}),_.push(C),T={rootContext:C,activeContext:_,locals:x},I.getValue(T)}B.compile=function(I){var C=(0,L.SpelExpressionParser)().parse(I);return{eval:function(_,T){return H(C,_,T)},_compiledExpression:C}},B.eval=function(I,C,x){return B.compile(I).eval(C,x)},y.SpelExpressionEvaluator=B},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.SpelExpressionParser=void 0;var L=j(2),D=j(6),B=j(8),H=j(9),I=j(10),C=j(11),x=j(12),_=j(13),T=j(14),V=j(15),z=j(16),M=j(17),U=j(18),K=j(19),Y=j(20),Te=j(21),me=j(22),Xe=j(23),Be=j(24),Ue=j(25),Re=j(26),ar=j(27),Ke=j(28),dr=j(29),pr=j(30),rr=j(31),tr=j(32),yr=j(33),Pe=j(34),Xr=j(35),N=j(36),Wr=j(37),kr=j(38),Ee=j(39),ye=j(40),Ae=j(41),Ie=j(42),_e=j(43),h=j(44),He=j(45),We=j(46),or=j(47),nt=j(48),lt=j(49),sr=y.SpelExpressionParser=function(){var Ir=new RegExp("[\\p{L}\\p{N}_$]+"),xt,Rn=[],ht,yt,ln,Ut;function La(Q){xt=Q}function cn(Q,ue){try{ht=Q,yt=D.Tokenizer.tokenize(Q),ln=yt.length,Ut=0,Rn=[];var be=wr();return lr()&&Le(Ur().startPos,"MORE_INPUT",Er().toString()),be}catch(nr){throw nr.message}}function wr(){var Q=fn();if(lr()){var ue=Ur();if(ue.getKind()===L.TokenKind.ASSIGN){Q===null&&(Q=C.NullLiteral.create(Tt(ue.startPos-1,ue.endPos-1))),Er();var be=fn();return U.Assign.create(Ne(ue),Q,be)}if(ue.getKind()===L.TokenKind.ELVIS){Q===null&&(Q=C.NullLiteral.create(Tt(ue.startPos-1,ue.endPos-2))),Er();var nr=wr();return nr===null&&(nr=C.NullLiteral.create(Tt(ue.startPos+1,ue.endPos+1))),kr.Elvis.create(Ne(ue),Q,nr)}if(ue.getKind()===L.TokenKind.QMARK){Q===null&&(Q=C.NullLiteral.create(Tt(ue.startPos-1,ue.endPos-1))),Er();var $r=wr();Mr(L.TokenKind.COLON);var ft=wr();return Wr.Ternary.create(Ne(ue),Q,$r,ft)}}return Q}function fn(){for(var Q=Gt();pn("or")||Qr(L.TokenKind.SYMBOLIC_OR);){var ue=Er(),be=Gt();Jt(ue,Q,be),Q=Xr.OpOr.create(Ne(ue),Q,be)}return Q}function Gt(){for(var Q=Kt();pn("and")||Qr(L.TokenKind.SYMBOLIC_AND);){var ue=Er(),be=Kt();Jt(ue,Q,be),Q=Pe.OpAnd.create(Ne(ue),Q,be)}return Q}function Kt(){var Q=ta(),ue=Pa();if(ue!==null){var be=Er(),nr=ta();Jt(be,Q,nr);var $r=ue.kind;if(ue.isNumericRelationalOperator()){var ft=Ne(be);return $r===L.TokenKind.GT?me.OpGT.create(ft,Q,nr):$r===L.TokenKind.LT?Be.OpLT.create(ft,Q,nr):$r===L.TokenKind.LE?Xe.OpLE.create(ft,Q,nr):$r===L.TokenKind.GE?Te.OpGE.create(ft,Q,nr):$r===L.TokenKind.EQ?K.OpEQ.create(ft,Q,nr):Y.OpNE.create(ft,Q,nr)}return $r===L.TokenKind.INSTANCEOF?_e.OpInstanceof.create(Ne(be),Q,nr):$r===L.TokenKind.MATCHES?N.OpMatches.create(Ne(be),Q,nr):h.OpBetween.create(Ne(be),Q,nr)}return Q}function ta(){for(var Q=Un();tn(L.TokenKind.PLUS,L.TokenKind.MINUS,L.TokenKind.INC);){var ue=Er(),be=Un();Qt(ue,be),ue.getKind()===L.TokenKind.PLUS?Q=Ue.OpPlus.create(Ne(ue),Q,be):ue.getKind()===L.TokenKind.MINUS&&(Q=Re.OpMinus.create(Ne(ue),Q,be))}return Q}function Un(){for(var Q=Mt();tn(L.TokenKind.STAR,L.TokenKind.DIV,L.TokenKind.MOD);){var ue=Er(),be=Mt();Jt(ue,Q,be),ue.getKind()===L.TokenKind.STAR?Q=ar.OpMultiply.create(Ne(ue),Q,be):ue.getKind()===L.TokenKind.DIV?Q=Ke.OpDivide.create(Ne(ue),Q,be):Q=dr.OpModulus.create(Ne(ue),Q,be)}return Q}function Mt(){var Q=Cn(),ue;if(Qr(L.TokenKind.POWER)){ue=Er();var be=Cn();return Qt(ue,be),pr.OpPower.create(Ne(ue),Q,be)}return Q!==null&&tn(L.TokenKind.INC,L.TokenKind.DEC)?(ue=Er(),ue.getKind()===L.TokenKind.INC?rr.OpInc.create(Ne(ue),!0,Q):tr.OpDec.create(Ne(ue),!0,Q)):Q}function Cn(){var Q,ue;return tn(L.TokenKind.PLUS,L.TokenKind.MINUS,L.TokenKind.NOT)?(Q=Er(),ue=Cn(),Q.getKind()===L.TokenKind.NOT?yr.OpNot.create(Ne(Q),ue):Q.getKind()===L.TokenKind.PLUS?Ue.OpPlus.create(Ne(Q),ue):Re.OpMinus.create(Ne(Q),ue)):tn(L.TokenKind.INC,L.TokenKind.DEC)?(Q=Er(),ue=Cn(),Q.getKind()===L.TokenKind.INC?rr.OpInc.create(Ne(Q),!1,ue):tr.OpDec.create(Ne(Q),!1,ue)):Ft()}function Ft(){var Q=[],ue=ba();for(Q.push(ue);Ln();)Q.push(Yt());return Q.length===1?Q[0]:z.CompoundExpression.create(Tt(ue.getStartPosition(),Q[Q.length-1].getEndPosition()),Q)}function Ln(){var Q=null;return tn(L.TokenKind.DOT,L.TokenKind.SAFE_NAVI)?Q=qr():Q=Gn(),Q===null?!1:(Dr(Q),!0)}function Gn(){return Qr(L.TokenKind.LSQUARE)&&aa()?Yt():null}function qr(){var Q=Er(),ue=Q.getKind()===L.TokenKind.SAFE_NAVI;return Ja(ue)||na()||Bn(ue)||Ot(ue)?Yt():(Ur()===null?Le(Q.startPos,"OOD"):Le(Q.startPos,"UNEXPECTED_DATA_AFTER_DOT",Wn(Ur())),null)}function na(){if(!Qr(L.TokenKind.HASH))return!1;var Q=Er(),ue=Mr(L.TokenKind.IDENTIFIER),be=ot();return be===null?(Dr(V.VariableReference.create(ue.data,Tt(Q.startPos,ue.endPos))),!0):(Dr(x.FunctionReference.create(ue.data,Tt(Q.startPos,ue.endPos),be)),!0)}function ot(){if(!Qr(L.TokenKind.LPAREN))return null;var Q=[];return Jr(Q),Mr(L.TokenKind.RPAREN),Q}function Ia(Q){Qr(L.TokenKind.LPAREN)||Le(Ne(Ur()),"MISSING_CONSTRUCTOR_ARGS"),Jr(Q),Mr(L.TokenKind.RPAREN)}function Jr(Q){var ue=Ur().startPos,be;do{Er();var nr=Ur();nr===null&&Le(ue,"RUN_OUT_OF_ARGUMENTS"),nr.getKind()!==L.TokenKind.RPAREN&&Q.push(wr()),be=Ur()}while(be!==null&&be.kind===L.TokenKind.COMMA);be===null&&Le(ue,"RUN_OUT_OF_ARGUMENTS")}function ut(Q){return Q===null?ht.length:Q.startPos}function ba(){return ia()||wa()||In()||bn()||Qa()||Ja(!1)||na()||St()||Bn(!1)||Ot(!1)||aa()||dn()?Yt():null}function St(){if(Qr(L.TokenKind.BEAN_REF)){var Q=Er(),ue=null,be=null;Qr(L.TokenKind.IDENTIFIER)?(ue=Mr(L.TokenKind.IDENTIFIER),be=ue.data):Qr(L.TokenKind.LITERAL_STRING)?(ue=Mr(L.TokenKind.LITERAL_STRING),be=ue.stringValue(),be=be.substring(1,be.length()-1)):Le(Q.startPos,"INVALID_BEAN_REFERENCE");var nr=We.BeanReference.create(Ne(ue),be);return Dr(nr),!0}return!1}function In(){if(Qr(L.TokenKind.IDENTIFIER)){var Q=Ur();if(Q.stringValue()!=="T")return!1;var ue=Er();if(Qr(L.TokenKind.RSQUARE))return Dr(T.PropertyReference.create(ue.stringValue(),Ne(ue))),!0;Mr(L.TokenKind.LPAREN);for(var be=Fa(),nr=0;Vt(L.TokenKind.LSQUARE,!0);)Mr(L.TokenKind.RSQUARE),nr++;return Mr(L.TokenKind.RPAREN),Dr(He.TypeReference.create(Ne(Q),be,nr)),!0}return!1}function bn(){if(Qr(L.TokenKind.IDENTIFIER)){var Q=Ur();return Q.stringValue().toLowerCase()!=="null"?!1:(Er(),Dr(C.NullLiteral.create(Ne(Q))),!0)}return!1}function Bn(Q){var ue=Ur();if(!Vt(L.TokenKind.PROJECT,!0))return!1;var be=wr();return Mr(L.TokenKind.RSQUARE),Dr(Ie.Projection.create(Q,Ne(ue),be)),!0}function dn(){var Q=Ur(),ue=[];if(!Vt(L.TokenKind.LCURLY,!0))return!1;var be=null,nr=Ur();if(Vt(L.TokenKind.RCURLY,!0))be=Ee.InlineList.create(Tt(Q.startPos,nr.endPos));else if(Vt(L.TokenKind.COLON,!0))nr=Mr(L.TokenKind.RCURLY),be=ye.InlineMap.create(Tt(Q.startPos,nr.endPos));else{var $r=wr();if(Qr(L.TokenKind.RCURLY))ue.push($r),nr=Mr(L.TokenKind.RCURLY),be=Ee.InlineList.create(Tt(Q.startPos,nr.endPos),ue);else if(Vt(L.TokenKind.COMMA,!0)){ue.push($r);do ue.push(wr());while(Vt(L.TokenKind.COMMA,!0));nr=Mr(L.TokenKind.RCURLY),be=Ee.InlineList.create(Ne(Q.startPos,nr.endPos),ue)}else if(Vt(L.TokenKind.COLON,!0)){var ft=[];for(ft.push($r),ft.push(wr());Vt(L.TokenKind.COMMA,!0);)ft.push(wr()),Mr(L.TokenKind.COLON),ft.push(wr());nr=Mr(L.TokenKind.RCURLY),be=ye.InlineMap.create(Tt(Q.startPos,nr.endPos),ft)}else Le(Q.startPos,"OOD")}return Dr(be),!0}function aa(){var Q=Ur();if(!Vt(L.TokenKind.LSQUARE,!0))return!1;var ue=wr();return Mr(L.TokenKind.RSQUARE),Dr(M.Indexer.create(Ne(Q),ue)),!0}function Ot(Q){var ue=Ur();if(!Nt())return!1;Er();var be=wr();return be===null&&Le(Ne(ue),"MISSING_SELECTION_EXPRESSION"),Mr(L.TokenKind.RSQUARE),ue.getKind()===L.TokenKind.SELECT_FIRST?Dr(Ae.Selection.create(Q,Ae.Selection.FIRST,Ne(ue),be)):ue.getKind()===L.TokenKind.SELECT_LAST?Dr(Ae.Selection.create(Q,Ae.Selection.LAST,Ne(ue),be)):Dr(Ae.Selection.create(Q,Ae.Selection.ALL,Ne(ue),be)),!0}function Fa(){for(var Q=[],ue=Ur();Na(ue);)Er(),ue.kind!==L.TokenKind.DOT&&Q.push(or.Identifier.create(ue.stringValue(),Ne(ue))),ue=Ur();Q.length||(ue===null&&Le(ht.length(),"OOD"),Le(ue.startPos,"NOT_EXPECTED_TOKEN","qualified ID",ue.getKind().toString().toLowerCase()));var be=Tt(Q[0].getStartPosition(),Q[Q.length-1].getEndPosition());return nt.QualifiedIdentifier.create(be,Q)}function Na(Q){if(Q===null||Q.kind===L.TokenKind.LITERAL_STRING)return!1;if(Q.kind===L.TokenKind.DOT||Q.kind===L.TokenKind.IDENTIFIER)return!0;var ue=Q.stringValue();return ue&&ue.length&&Ir.test(ue)}function Ja(Q){if(Qr(L.TokenKind.IDENTIFIER)){var ue=Er(),be=ot();return be===null?(Dr(T.PropertyReference.create(Q,ue.stringValue(),Ne(ue))),!0):(Dr(_.MethodReference.create(Q,ue.stringValue(),Ne(ue),be)),!0)}return!1}function Qa(){if(pn("new")){var Q=Er();if(Qr(L.TokenKind.RSQUARE))return Dr(T.PropertyReference.create(Q.stringValue(),Ne(Q))),!0;var ue=Fa(),be=[];if(be.push(ue),Qr(L.TokenKind.LSQUARE)){for(var nr=[];Vt(L.TokenKind.LSQUARE,!0);)Qr(L.TokenKind.RSQUARE)?nr.push(null):nr.push(wr()),Mr(L.TokenKind.RSQUARE);dn()&&be.push(Yt()),Dr(lt.ConstructorReference.create(Ne(Q),nr,be))}else Ia(be),Dr(lt.ConstructorReference.create(Ne(Q),be));return!0}return!1}function Dr(Q){Rn.push(Q)}function Yt(){return Rn.pop()}function ia(){var Q=Ur();if(Q===null)return!1;if(Q.getKind()===L.TokenKind.LITERAL_INT||Q.getKind()===L.TokenKind.LITERAL_LONG)Dr(H.NumberLiteral.create(parseInt(Q.stringValue(),10),Ne(Q)));else if(Q.getKind()===L.TokenKind.LITERAL_REAL||Q.getKind()===L.TokenKind.LITERAL_REAL_FLOAT)Dr(H.NumberLiteral.create(parseFloat(Q.stringValue()),Ne(Q)));else if(Q.getKind()===L.TokenKind.LITERAL_HEXINT||Q.getKind()===L.TokenKind.LITERAL_HEXLONG)Dr(H.NumberLiteral.create(parseInt(Q.stringValue(),16),Ne(Q)));else if(pn("true"))Dr(B.BooleanLiteral.create(!0,Ne(Q)));else if(pn("false"))Dr(B.BooleanLiteral.create(!1,Ne(Q)));else if(Q.getKind()===L.TokenKind.LITERAL_STRING)Dr(I.StringLiteral.create(Q.stringValue(),Ne(Q)));else return!1;return Er(),!0}function wa(){if(Qr(L.TokenKind.LPAREN)){Er();var Q=wr();return Mr(L.TokenKind.RPAREN),Dr(Q),!0}else return!1}function Pa(){var Q=Ur();if(Q===null)return null;if(Q.isNumericRelationalOperator())return Q;if(Q.isIdentifier()){var ue=Q.stringValue();if(ue.toLowerCase()==="instanceof")return Q.asInstanceOfToken();if(ue.toLowerCase()==="matches")return Q.asMatchesToken();if(ue.toLowerCase()==="between")return Q.asBetweenToken()}return null}function Mr(Q){var ue=Er();return ue===null&&Le(ht.length,"OOD"),ue.getKind()!==Q&&Le(ue.startPos,"NOT_EXPECTED_TOKEN",Q.toString().toLowerCase(),ue.getKind().toString().toLowerCase()),ue}function Qr(Q){return Vt(Q,!1)}function Vt(Q,ue){if(!lr())return!1;var be=Ur();return be.getKind()===Q?(ue&&Ut++,!0):Q===L.TokenKind.IDENTIFIER&&be.getKind().ordinal()>=L.TokenKind.DIV.ordinal()&&be.getKind().ordinal()<=L.TokenKind.NOT.ordinal()&&be.data!==null}function tn(){if(!lr())return!1;for(var Q=Ur(),ue=Array.prototype.slice.call(arguments),be=0,nr=ue.length;be<nr;be+=1)if(Q.getKind()===ue[be])return!0;return!1}function pn(Q){if(!lr())return!1;var ue=Ur();return ue.getKind()===L.TokenKind.IDENTIFIER&&ue.stringValue().toLowerCase()===Q.toLowerCase()}function Nt(){if(!lr())return!1;var Q=Ur();return Q.getKind()===L.TokenKind.SELECT||Q.getKind()===L.TokenKind.SELECT_FIRST||Q.getKind()===L.TokenKind.SELECT_LAST}function lr(){return Ut<yt.length}function Er(){return Ut>=ln?null:yt[Ut++]}function Ur(){return Ut>=ln?null:yt[Ut]}function Le(Q,ue,be,nr){throw be&&(ue+=`
Expected: `+be),nr&&(ue+=`
Actual: `+nr),{name:"InternalParseException",message:"Error occurred while attempting to parse expression '"+ht+"' at position "+Q+". Message: "+ue}}function Wn(Q){return Q.getKind().hasPayload()?Q.stringValue():Q.getKind().toString().toLowerCase()}function Jt(Q,ue,be){Fn(Q,ue),Qt(Q,be)}function Fn(Q,ue){ue===null&&Le(Q.startPos,"LEFT_OPERAND_PROBLEM")}function Qt(Q,ue){ue===null&&Le(Q.startPos,"RIGHT_OPERAND_PROBLEM")}function Ne(Q){return(Q.startPos<<16)+Q.endPos}function Tt(Q,ue){return(Q<<16)+ue}return{setConfiguration:La,parse:cn}}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Tokenizer=void 0;var L=j(7),D=j(2),B=["DIV","EQ","GE","GT","LE","LT","MOD","NE","NOT"],H=[],I=1,C=2,x=4;function _(){var z;for(z="0".charCodeAt(0);z<="9".charCodeAt(0);z+=1)H[z]|=I|C;for(z="A".charCodeAt(0);z<="F".charCodeAt(0);z+=1)H[z]|=C;for(z="a".charCodeAt(0);z<="f".charCodeAt(0);z+=1)H[z]|=C;for(z="A".charCodeAt(0);z<="Z".charCodeAt(0);z+=1)H[z]|=x;for(z="a".charCodeAt(0);z<="z".charCodeAt(0);z+=1)H[z]|=x}_();function T(z){var M=z,U=z+"\0",K=U.length,Y=0,Te=[];function me(){for(var h;Y<K;)if(h=U[Y],Ie(h))Re();else switch(h){case"+":rr(D.TokenKind.INC)?yr(D.TokenKind.INC):tr(D.TokenKind.PLUS);break;case"_":Re();break;case"-":rr(D.TokenKind.DEC)?yr(D.TokenKind.DEC):tr(D.TokenKind.MINUS);break;case":":tr(D.TokenKind.COLON);break;case".":tr(D.TokenKind.DOT);break;case",":tr(D.TokenKind.COMMA);break;case"*":tr(D.TokenKind.STAR);break;case"/":tr(D.TokenKind.DIV);break;case"%":tr(D.TokenKind.MOD);break;case"(":tr(D.TokenKind.LPAREN);break;case")":tr(D.TokenKind.RPAREN);break;case"[":tr(D.TokenKind.LSQUARE);break;case"#":tr(D.TokenKind.HASH);break;case"]":tr(D.TokenKind.RSQUARE);break;case"{":tr(D.TokenKind.LCURLY);break;case"}":tr(D.TokenKind.RCURLY);break;case"@":tr(D.TokenKind.BEAN_REF);break;case"^":rr(D.TokenKind.SELECT_FIRST)?yr(D.TokenKind.SELECT_FIRST):tr(D.TokenKind.POWER);break;case"!":rr(D.TokenKind.NE)?yr(D.TokenKind.NE):rr(D.TokenKind.PROJECT)?yr(D.TokenKind.PROJECT):tr(D.TokenKind.NOT);break;case"=":rr(D.TokenKind.EQ)?yr(D.TokenKind.EQ):tr(D.TokenKind.ASSIGN);break;case"&":if(!rr(D.TokenKind.SYMBOLIC_AND))throw{name:"SpelParseException",message:"Missing character '&' in expression ("+M+") at position "+Y};yr(D.TokenKind.SYMBOLIC_AND);break;case"|":if(!rr(D.TokenKind.SYMBOLIC_OR))throw{name:"SpelParseException",message:"Missing character '|' in expression ("+M+") at position "+Y};yr(D.TokenKind.SYMBOLIC_OR);break;case"?":rr(D.TokenKind.SELECT)?yr(D.TokenKind.SELECT):rr(D.TokenKind.ELVIS)?yr(D.TokenKind.ELVIS):rr(D.TokenKind.SAFE_NAVI)?yr(D.TokenKind.SAFE_NAVI):tr(D.TokenKind.QMARK);break;case"$":rr(D.TokenKind.SELECT_LAST)?yr(D.TokenKind.SELECT_LAST):Re();break;case">":rr(D.TokenKind.GE)?yr(D.TokenKind.GE):tr(D.TokenKind.GT);break;case"<":rr(D.TokenKind.LE)?yr(D.TokenKind.LE):tr(D.TokenKind.LT);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":Ue(h==="0");break;case" ":case"	":case"\r":case`
`:Y+=1;break;case"'":Xe();break;case'"':Be();break;case"\0":Y+=1;break;case"\\":throw{name:"SpelParseException",message:"Unexpected escape character in expression ("+M+") at position "+Y};default:throw{name:"SpelParseException",message:"Cannot handle character '"+h+"' in expression ("+M+") at position "+Y}}}function Xe(){for(var h=Y,He=!1,We;!He;)if(Y+=1,We=U[Y],We==="'"&&(U[Y+1]==="'"?Y+=1:He=!0),We.charCodeAt(0)===0)throw{name:"SpelParseException",message:"Non-terminating quoted string in expression ("+M+") at position "+Y};Y+=1,Te.push(new L.Token(D.TokenKind.LITERAL_STRING,pr(h,Y),h,Y))}function Be(){for(var h=Y,He=!1,We;!He;)if(Y+=1,We=U[Y],We==='"'&&(U[Y+1]==='"'?Y+=1:He=!0),We.charCodeAt(0)===0)throw{name:"SpelParseException",message:"Non-terminating double-quoted string in expression ("+M+") at position "+Y};Y+=1,Te.push(new L.Token(D.TokenKind.LITERAL_STRING,pr(h,Y),h,Y))}function Ue(h){var He=!1,We=Y,or=U[Y+1],nt=or==="x"||or==="X",lt,sr,ct,Ir;if(h&&nt){Y=Y+1;do Y+=1;while(_e(U[Y]));N("L","l")?(Ke(pr(We+2,Y),!0,We,Y),Y+=1):Ke(pr(We+2,Y),!1,We,Y);return}do Y+=1;while(Ae(U[Y]));if(or=U[Y],or==="."){He=!0,lt=Y;do Y+=1;while(Ae(U[Y]));if(Y===lt+1){Y=lt,ar(pr(We,Y),!1,We,Y);return}}if(sr=Y,N("L","l")){if(He)throw{name:"SpelParseException",message:"Real cannot be long in expression ("+M+") at position "+Y};ar(pr(We,sr),!0,We,sr),Y+=1}else if(Wr(U[Y])){He=!0,Y+=1,ct=U[Y],ye(ct)&&(Y+=1);do Y+=1;while(Ae(U[Y]));Ir=!1,kr(U[Y])?(Ir=!0,Y+=1,sr=Y):Ee(U[Y])&&(Y+=1,sr=Y),dr(pr(We,Y),Ir,We,Y)}else or=U[Y],Ir=!1,kr(or)?(He=!0,Ir=!0,Y+=1,sr=Y):Ee(or)&&(He=!0,Y+=1,sr=Y),He?dr(pr(We,sr),Ir,We,sr):ar(pr(We,sr),!1,We,sr)}function Re(){var h=Y,He,We,or;do Y+=1;while(Xr(U[Y]));if(He=pr(h,Y),(Y-h===2||Y-h===3)&&(We=He.toUpperCase(),or=B.indexOf(We),or>=0)){Pe(D.TokenKind.valueOf(We),h,He);return}Te.push(new L.Token(D.TokenKind.IDENTIFIER,He.replace("\0",""),h,Y))}function ar(h,He,We,or){He?Te.push(new L.Token(D.TokenKind.LITERAL_LONG,h,We,or)):Te.push(new L.Token(D.TokenKind.LITERAL_INT,h,We,or))}function Ke(h,He,We,or){if(h.length===0)throw He?{name:"SpelParseException",message:"Not a long in expression ("+M+") at position "+Y}:{name:"SpelParseException",message:"Not an int in expression ("+M+") at position "+Y};He?Te.push(new L.Token(D.TokenKind.LITERAL_HEXLONG,h,We,or)):Te.push(new L.Token(D.TokenKind.LITERAL_HEXINT,h,We,or))}function dr(h,He,We,or){He?Te.push(new L.Token(D.TokenKind.LITERAL_REAL_FLOAT,h,We,or)):Te.push(new L.Token(D.TokenKind.LITERAL_REAL,h,We,or))}function pr(h,He){return U.substring(h,He)}function rr(h){return h.tokenChars.length===2&&U[Y]===h.tokenChars[0]?U[Y+1]===h.tokenChars[1]:!1}function tr(h){Te.push(new L.Token(h,null,Y,Y+1)),Y+=1}function yr(h){Te.push(new L.Token(h,null,Y,Y+2)),Y+=2}function Pe(h,He,We){Te.push(new L.Token(h,We,He,He+h.getLength()))}function Xr(h){return Ie(h)||Ae(h)||h==="_"||h==="$"}function N(h,He){var We=U[Y];return We===h||We===He}function Wr(h){return h==="e"||h==="E"}function kr(h){return h==="f"||h==="F"}function Ee(h){return h==="d"||h==="D"}function ye(h){return h==="+"||h==="-"}function Ae(h){return h.charCodeAt(0)>255?!1:(H[h.charCodeAt(0)]&I)!==0}function Ie(h){return h.charCodeAt(0)>255?!1:(H[h.charCodeAt(0)]&x)!==0}function _e(h){return h.charCodeAt(0)>255?!1:(H[h.charCodeAt(0)]&C)!==0}return me(),Te}var V=y.Tokenizer={tokenize:T}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Token=void 0;var L=j(2);function D(B,H,I,C){this.kind=B,this.startPos=I,this.endPos=C,H&&(this.data=H)}D.prototype.getKind=function(){return this.kind},D.prototype.toString=function(){var B="[";return B+=this.kind.toString(),this.kind.hasPayload()&&(B+=":"+this.data),B+="]",B+="("+this.startPos+","+this.endPos+")",B},D.prototype.isIdentifier=function(){return this.kind===L.TokenKind.IDENTIFIER},D.prototype.isNumericRelationalOperator=function(){return this.kind===L.TokenKind.GT||this.kind===L.TokenKind.GE||this.kind===L.TokenKind.LT||this.kind===L.TokenKind.LE||this.kind===L.TokenKind.EQ||this.kind===L.TokenKind.NE},D.prototype.stringValue=function(){return this.data},D.prototype.asInstanceOfToken=function(){return new D(L.TokenKind.INSTANCEOF,this.startPos,this.endPos)},D.prototype.asMatchesToken=function(){return new D(L.TokenKind.MATCHES,this.startPos,this.endPos)},D.prototype.asBetweenToken=function(){return new D(L.TokenKind.BETWEEN,this.startPos,this.endPos)},D.prototype.getStartPosition=function(){return this.startPos},D.prototype.getEndPosition=function(){return this.endPos},y.Token=D},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BooleanLiteral=void 0;var L=j(0);function D(H,I){var C=L.SpelNode.create("boolean",I);return C.getValue=function(){return H},C.setValue=function(x){return H=x},C}var B=y.BooleanLiteral={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.NumberLiteral=void 0;var L=j(0);function D(H,I){var C=L.SpelNode.create("number",I);return C.getValue=function(){return H},C.setValue=function(x){return H=x},C}var B=y.NumberLiteral={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.StringLiteral=void 0;var L=j(0);function D(H,I){var C=L.SpelNode.create("string",I);function x(_){return(_[0]==="'"&&_[_.length-1]==="'"||_[0]==='"'&&_[_.length-1]==='"')&&(_=_.substring(1,_.length-1)),_.replace(/''/g,"'").replace(/""/g,'"')}return H=x(H),C.getValue=function(){return H},C.setValue=function(_){return H=_},C}var B=y.StringLiteral={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.NullLiteral=void 0;var L=j(0);function D(H,I){var C=L.SpelNode.create("null",I);return C.getValue=function(){return null},C}var B=y.NullLiteral={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.FunctionReference=void 0;var L=j(0),D=j(1);function B(I,C,x){var _=L.SpelNode.create("function",C);return _.getRaw=function(){return{functionName:I,args:x}},_.getValue=function(T){var V=T.locals||{},z=T.rootContext,M=[];if(x.forEach(function(U){var K=T.activeContext;T.activeContext=new D.Stack,T.activeContext.push(T.rootContext),M.push(U.getValue(T)),T.activeContext=K}),V[I])return V[I].apply(z,M);throw{name:"FunctionDoesNotExistException",message:"Function '"+I+"' does not exist."}},_}var H=y.FunctionReference={create:B}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.MethodReference=void 0;var L=j(0),D=j(1);function B(I,C,x,_){var T=L.SpelNode.create("method",x);return T.getRaw=function(){return{methodName:C,args:_}},T.getValue=function(V){var z=V.activeContext.peek(),M=[],U;if(!z)throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+C+"' for an undefined context."};function K(Y){if(Y==null){if(I)return null;throw{name:"NullPointerException",message:"Method "+C+" does not exist."}}return Y}if(_.forEach(function(Y){var Te=V.activeContext;V.activeContext=new D.Stack,V.activeContext.push(V.rootContext),M.push(Y.getValue(V)),V.activeContext=Te}),C.substr(0,3)==="get"&&!z[C])return K(z[C.charAt(3).toLowerCase()+C.substring(4)]);if(C.substr(0,3)==="set"&&!z[C])return z[C.charAt(3).toLowerCase()+C.substring(4)]=M[0];if(Array.isArray(z)){if(C==="size")return z.length;if(C==="contains")return z.includes(M[0])}return U=K(z[C]),U?U.apply(z,M):null},T}var H=y.MethodReference={create:B}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.PropertyReference=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("property",C);return x.getRaw=function(){return I},x.getValue=function(_){var T=_.activeContext.peek();if(!T){if(H)return null;throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+I+"' for an undefined context."}}if(T[I]===void 0||T[I]===null){if(H)return null;if(I==="size"&&Array.isArray(T))return T.length;throw{name:"NullPointerException",message:"Property '"+I+"' does not exist."}}return T[I]},x.setValue=function(_,T){var V=T.activeContext.peek();if(!V)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+I+"' for an undefined context."};return V[I]=_},x.getName=function(){return I},x}var B=y.PropertyReference={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.VariableReference=void 0;var L=j(0);function D(H,I){var C=L.SpelNode.create("variable",I);return C.getRaw=function(){return H},C.getValue=function(x){var _=x.activeContext.peek(),T=x.locals;if(!_)throw{name:"ContextDoesNotExistException",message:"Attempting to look up variable '"+H+"' for an undefined context."};return H==="this"?_:H==="root"?x.rootContext:T[H]},C.setValue=function(x,_){var T=_.locals;return T[H]=x},C}var B=y.VariableReference={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.CompoundExpression=void 0;var L=j(0);function D(H,I){var C=L.SpelNode.create.apply(null,["compound",H].concat(I));function x(_){var T=C.getChildren().length,V;for(V=0;V<T;V+=1)C.getChildren()[V].getType()==="indexer"?_.activeContext.push(_.activeContext.peek()[C.getChildren()[V].getValue(_)]):_.activeContext.push(C.getChildren()[V].getValue(_));return function(){for(V=0;V<T;V+=1)_.activeContext.pop()}}return C.getValue=function(_){var T=_.activeContext.peek(),V;if(!T)throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};var z=x(_);return V=_.activeContext.peek(),z(),V},C.setValue=function(_,T){var V=x(T),z=C.getChildren().length;return T.activeContext.pop(),_=C.getChildren()[z-1].setValue(_,T),T.activeContext.push(null),V(),_},C}var B=y.CompoundExpression={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Indexer=void 0;var L=j(0),D=j(1);function B(I,C){var x=L.SpelNode.create.apply(null,["indexer",I].concat(C));return x.getValue=function(_){var T=_.activeContext,V,z=x.getChildren().length,M,U;if(_.activeContext=new D.Stack,_.activeContext.push(_.rootContext),V=_.activeContext.peek(),!V)throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};for(M=0;M<z;M+=1)_.activeContext.push(x.getChildren()[M].getValue(_));for(U=_.activeContext.peek(),M=0;M<z;M+=1)_.activeContext.pop();return _.activeContext=T,U},x}var H=y.Indexer={create:B}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Assign=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("assign",H,I,C);return x.getValue=function(_){var T=_.activeContext.peek();if(!T)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+I.getValue(_)+"' for an undefined context."};return I.setValue(C.getValue(_),_)},x}var B=y.Assign={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpEQ=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-eq",H,I,C);return x.getValue=function(_){return I.getValue(_)===C.getValue(_)},x}var B=y.OpEQ={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpNE=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-ne",H,I,C);return x.getValue=function(_){return I.getValue(_)!==C.getValue(_)},x}var B=y.OpNE={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpGE=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-ge",H,I,C);return x.getValue=function(_){return I.getValue(_)>=C.getValue(_)},x}var B=y.OpGE={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpGT=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-gt",H,I,C);return x.getValue=function(_){return I.getValue(_)>C.getValue(_)},x}var B=y.OpGT={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpLE=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-le",H,I,C);return x.getValue=function(_){return I.getValue(_)<=C.getValue(_)},x}var B=y.OpLE={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpLT=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-lt",H,I,C);return x.getValue=function(_){return I.getValue(_)<C.getValue(_)},x}var B=y.OpLT={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpPlus=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-plus",H,I,C);return x.getValue=function(_){return C?I.getValue(_)+C.getValue(_):+I.getValue(_)},x}var B=y.OpPlus={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpMinus=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-minus",H,I,C);return x.getValue=function(_){return C?I.getValue(_)-C.getValue(_):-I.getValue(_)},x}var B=y.OpMinus={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpMultiply=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-multiply",H,I,C);return x.getValue=function(_){var T=I.getValue(_),V=C.getValue(_);if(typeof T=="number"&&typeof V=="number")return T*V;if(typeof T=="string"&&typeof V=="number"){for(var z="",M=0;M<V;M+=1)z+=T;return z}return null},x}var B=y.OpMultiply={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpDivide=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-divide",H,I,C);return x.getValue=function(_){return I.getValue(_)/C.getValue(_)},x}var B=y.OpDivide={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpModulus=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-modulus",H,I,C);return x.getValue=function(_){return I.getValue(_)%C.getValue(_)},x}var B=y.OpModulus={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpPower=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-power",H,I,C);return x.getValue=function(_){return Math.pow(I.getValue(_),C.getValue(_))},x}var B=y.OpPower={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpInc=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-inc",H,C);return x.getValue=function(_){var T=C.getValue(_);return C.setValue(T+1,_),I?T:T+1},x}var B=y.OpInc={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpDec=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-dec",H,C);return x.getValue=function(_){var T=C.getValue(_);return C.setValue(T-1,_),I?T:T-1},x}var B=y.OpDec={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpNot=void 0;var L=j(0);function D(H,I){var C=L.SpelNode.create("op-not",H,I);return C.getValue=function(x){return!I.getValue(x)},C}var B=y.OpNot={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpAnd=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-and",H,I,C);return x.getValue=function(_){return!!I.getValue(_)&&!!C.getValue(_)},x}var B=y.OpAnd={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpOr=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("op-or",H,I,C);return x.getValue=function(_){return!!I.getValue(_)||!!C.getValue(_)},x}var B=y.OpOr={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpMatches=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("matches",H,I,C);return x.getValue=function(_){var T=I.getValue(_),V=C.getValue(_);try{var z=new RegExp(V);return!!z.exec(T)}catch(M){throw{name:"EvaluationException",message:M.toString()}}},x}var B=y.OpMatches={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Ternary=void 0;var L=j(0);function D(H,I,C,x){var _=L.SpelNode.create("ternary",H,I,C,x);return _.getValue=function(T){return I.getValue(T)?C.getValue(T):x.getValue(T)},_}var B=y.Ternary={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Elvis=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("elvis",H,I,C);return x.getValue=function(_){return I.getValue(_)!==null?I.getValue(_):C.getValue(_)},x}var B=y.Elvis={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.InlineList=void 0;var L=j(0);function D(H,I){var C=L.SpelNode.create("list",H),x=[].concat(I||[]);return C.getRaw=function(){return x},C.getValue=function(_){return x.map(function(T){return T.getValue(_)})},C}var B=y.InlineList={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.InlineMap=void 0;var L=j(0);function D(H,I){var C=L.SpelNode.create("map",H),x=[].concat(I||[]);return C.getValue=function(_){var T=!0,V=null,z={};return x.forEach(function(M){T?M.getType()==="property"?V=M.getName():V=M.getValue(_):z[V]=M.getValue(_),T=!T}),z},C}var B=y.InlineMap={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Selection=void 0;var L=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},D=j(0);function B(_,T,V){var z=!1;return V.activeContext.push(_),z=T.getValue(V),V.activeContext.pop(),z}function H(_,T,V,z){var M=_.filter(function(U){return B(U,V,z)});switch(T){case"ALL":return M;case"FIRST":return M[0]||null;case"LAST":return M.length?M[M.length-1]:null}}function I(_,T,V,z){var M={},U,K,Y=[],Te={};for(K in _)_.hasOwnProperty(K)&&(U={key:K,value:_[K]},B(U,V,z)&&Y.push(U));switch(T){case"ALL":return Y.forEach(function(me){M[me.key]=me.value}),M;case"FIRST":return Y.length?(Te[Y[0].key]=Y[0].value,Te):null;case"LAST":return Y.length?(Te[Y[Y.length-1].key]=Y[Y.length-1].value,Te):null}Y.forEach(function(me){M[me.key]=me.value})}function C(_,T,V,z){var M=D.SpelNode.create("selection",V,z);return M.getValue=function(U){var K=U.activeContext.peek();if(K){if(Array.isArray(K))return H(K,T,z,U);if((typeof K>"u"?"undefined":L(K))==="object")return I(K,T,z,U)}return null},M}var x=y.Selection={create:C,FIRST:"FIRST",LAST:"LAST",ALL:"ALL"}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Projection=void 0;var L=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},D=j(0);function B(C,x,_){return C.map(function(T){var V;return _.activeContext.push(T),V=x.getValue(_),_.activeContext.pop(),V})}function H(C,x,_){var T=D.SpelNode.create("projection",x,_);return T.getValue=function(V){var z=V.activeContext.peek(),M=[],U;if(Array.isArray(z))return B(z,_,V);if((typeof z>"u"?"undefined":L(z))==="object"){for(U in z)z.hasOwnProperty(U)&&M.push(z[U]);return B(M,_,V)}return null},T}var I=y.Projection={create:H}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpInstanceof=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("instanceof",H,I,C);return x.getValue=function(_){throw{name:"MethodNotImplementedException",message:"OpInstanceOf: Not implemented"}},x}var B=y.OpInstanceof={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpBetween=void 0;var L=j(0);function D(H,I,C){var x=L.SpelNode.create("between",H,I,C);return x.getValue=function(_){throw{name:"MethodNotImplementedException",message:"OpBetween: Not implemented"}},x}var B=y.OpBetween={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.TypeReference=void 0;var L=j(0);function D(H,x,C){var x=L.SpelNode.create("typeref",H,x);return x.getValue=function(_){throw{name:"MethodNotImplementedException",message:"TypeReference: Not implemented"}},x}var B=y.TypeReference={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BeanReference=void 0;var L=j(0);function D(H,I){var C=L.SpelNode.create("beanref",H);return C.getValue=function(x){throw{name:"MethodNotImplementedException",message:"BeanReference: Not implemented"}},C}var B=y.BeanReference={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Identifier=void 0;var L=j(0);function D(H,I){var C=L.SpelNode.create("identifier",I);return C.getRaw=function(){return H},C.getValue=function(x){throw{name:"MethodNotImplementedException",message:"Identifier: Not implemented"}},C}var B=y.Identifier={create:D}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.QualifiedIdentifier=void 0;var L=j(0);function D(I){if(Array.isArray(I)){for(var C=0,x=Array(I.length);C<I.length;C++)x[C]=I[C];return x}else return Array.from(I)}function B(I,C){var x=L.SpelNode.create.apply(L.SpelNode,["qualifiedidentifier",I].concat(D(C)));return x.getRaw=function(){return C.map(function(_){return _.getRaw()})},x.getValue=function(_){throw{name:"MethodNotImplementedException",message:"QualifiedIdentifier: Not implemented"}},x}var H=y.QualifiedIdentifier={create:B}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.ConstructorReference=void 0;var L=j(0),D=j(1);function B(x){if(Array.isArray(x)){for(var _=0,T=Array(x.length);_<x.length;_++)T[_]=x[_];return T}else return Array.from(x)}function H(x){return Array.isArray(x)?x:Array.from(x)}function I(x,_,T){var V=T!==void 0,z;V?z=_.length&&_[0]&&_[0].getType()==="number"?_[0].getValue():null:(T=_,_=void 0);var M=T,U=H(M),K=U[0],Y=U.slice(1),Te=L.SpelNode.create.apply(L.SpelNode,["constructorref",x].concat(B(T)));return Te.getRaw=function(){return z},Te.getValue=function(me){if(V&&Y.length<=1){var Xe=[];return Y.forEach(function(Be){var Ue=me.activeContext;me.activeContext=new D.Stack,me.activeContext.push(me.rootContext),Xe.push(Be.getValue(me)),me.activeContext=Ue}),Y.length===1?Xe[0]:z?new Array(z):[]}throw{name:"MethodNotImplementedException",message:"ConstructorReference: Not implemented"}},Te}var C=y.ConstructorReference={create:I}},function(ae,y,j){"use strict";Object.defineProperty(y,"__esModule",{value:!0});function L(B,H){var I={};return I.authentication=B||{},I.principal=H||{},I.hasRole=function(C){var x=!1;return!C||!I.authentication&&!Array.isArray(I.authentication.authorities)?!1:(I.authentication.authorities.forEach(function(_){_.authority.toLowerCase()===C.toLowerCase()&&(x=!0)}),x)},I.hasPermission=function(){var C=Array.prototype.slice.call(arguments);if(C.length===1)return I.hasRole(C[0])},I}var D=y.StandardContext={create:L}}])})},3429:(he,ae,y)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=void 0;var j=I(y(79859)),L=I(y(87825)),D=I(y(6008)),B=I(y(76625)),H=I(y(26021));function I(z){return z&&z.__esModule?z:{default:z}}function C(z,M){if(!(z instanceof M))throw new TypeError("Cannot call a class as a function")}function x(z,M){for(var U=0;U<M.length;U++){var K=M[U];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(z,K.key,K)}}function _(z,M,U){return M&&x(z.prototype,M),U&&x(z,U),z}var T=function(M){return M.replace(/[\t ]+$/,"")},V=function(){function z(M,U,K){C(this,z),this.cfg=M||{},this.indentation=new D.default(this.cfg.indent),this.inlineBlock=new B.default,this.params=new H.default(this.cfg.params),this.tokenizer=U,this.tokenOverride=K,this.previousReservedWord={},this.tokens=[],this.index=0}return _(z,[{key:"format",value:function(U){this.tokens=this.tokenizer.tokenize(U);var K=this.getFormattedQueryFromTokens();return K.trim()}},{key:"getFormattedQueryFromTokens",value:function(){var U=this,K="";return this.tokens.forEach(function(Y,Te){U.index=Te,U.tokenOverride&&(Y=U.tokenOverride(Y,U.previousReservedWord)||Y),Y.type===L.default.WHITESPACE||(Y.type===L.default.LINE_COMMENT?K=U.formatLineComment(Y,K):Y.type===L.default.BLOCK_COMMENT?K=U.formatBlockComment(Y,K):Y.type===L.default.RESERVED_TOP_LEVEL?(K=U.formatTopLevelReservedWord(Y,K),U.previousReservedWord=Y):Y.type===L.default.RESERVED_TOP_LEVEL_NO_INDENT?(K=U.formatTopLevelReservedWordNoIndent(Y,K),U.previousReservedWord=Y):Y.type===L.default.RESERVED_NEWLINE?(K=U.formatNewlineReservedWord(Y,K),U.previousReservedWord=Y):Y.type===L.default.RESERVED?(K=U.formatWithSpaces(Y,K),U.previousReservedWord=Y):Y.type===L.default.OPEN_PAREN?K=U.formatOpeningParentheses(Y,K):Y.type===L.default.CLOSE_PAREN?K=U.formatClosingParentheses(Y,K):Y.type===L.default.PLACEHOLDER?K=U.formatPlaceholder(Y,K):Y.value===","?K=U.formatComma(Y,K):Y.value===":"?K=U.formatWithSpaceAfter(Y,K):Y.value==="."?K=U.formatWithoutSpaces(Y,K):Y.value===";"?K=U.formatQuerySeparator(Y,K):K=U.formatWithSpaces(Y,K))}),K}},{key:"formatLineComment",value:function(U,K){return this.addNewline(K+U.value)}},{key:"formatBlockComment",value:function(U,K){return this.addNewline(this.addNewline(K)+this.indentComment(U.value))}},{key:"indentComment",value:function(U){return U.replace(/\n[\t ]*/g,`
`+this.indentation.getIndent()+" ")}},{key:"formatTopLevelReservedWordNoIndent",value:function(U,K){return this.indentation.decreaseTopLevel(),K=this.addNewline(K)+this.equalizeWhitespace(this.formatReservedWord(U.value)),this.addNewline(K)}},{key:"formatTopLevelReservedWord",value:function(U,K){return this.indentation.decreaseTopLevel(),K=this.addNewline(K),this.indentation.increaseTopLevel(),K+=this.equalizeWhitespace(this.formatReservedWord(U.value)),this.addNewline(K)}},{key:"formatNewlineReservedWord",value:function(U,K){return this.addNewline(K)+this.equalizeWhitespace(this.formatReservedWord(U.value))+" "}},{key:"equalizeWhitespace",value:function(U){return U.replace(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/g," ")}},{key:"formatOpeningParentheses",value:function(U,K){var Y=[L.default.WHITESPACE,L.default.OPEN_PAREN,L.default.LINE_COMMENT];return(0,j.default)(Y,this.previousToken().type)||(K=T(K)),K+=this.cfg.uppercase?U.value.toUpperCase():U.value,this.inlineBlock.beginIfPossible(this.tokens,this.index),this.inlineBlock.isActive()||(this.indentation.increaseBlockLevel(),K=this.addNewline(K)),K}},{key:"formatClosingParentheses",value:function(U,K){return U.value=this.cfg.uppercase?U.value.toUpperCase():U.value,this.inlineBlock.isActive()?(this.inlineBlock.end(),this.formatWithSpaceAfter(U,K)):(this.indentation.decreaseBlockLevel(),this.formatWithSpaces(U,this.addNewline(K)))}},{key:"formatPlaceholder",value:function(U,K){return K+this.params.get(U)+" "}},{key:"formatComma",value:function(U,K){return K=T(K)+U.value+" ",this.inlineBlock.isActive()||/^LIMIT$/i.test(this.previousReservedWord.value)?K:this.addNewline(K)}},{key:"formatWithSpaceAfter",value:function(U,K){return T(K)+U.value+" "}},{key:"formatWithoutSpaces",value:function(U,K){return T(K)+U.value}},{key:"formatWithSpaces",value:function(U,K){var Y=U.type==="reserved"?this.formatReservedWord(U.value):U.value;return K+Y+" "}},{key:"formatReservedWord",value:function(U){return this.cfg.uppercase?U.toUpperCase():U}},{key:"formatQuerySeparator",value:function(U,K){return this.indentation.resetIndentation(),T(K)+U.value+`
`.repeat(this.cfg.linesBetweenQueries||1)}},{key:"addNewline",value:function(U){return U=T(U),U.endsWith(`
`)||(U+=`
`),U+this.indentation.getIndent()}},{key:"previousToken",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return this.tokens[this.index-U]||{}}}]),z}();ae.default=V,he.exports=ae.default},6008:(he,ae,y)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=void 0;var j=D(y(12493)),L=D(y(68090));function D(T){return T&&T.__esModule?T:{default:T}}function B(T,V){if(!(T instanceof V))throw new TypeError("Cannot call a class as a function")}function H(T,V){for(var z=0;z<V.length;z++){var M=V[z];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(T,M.key,M)}}function I(T,V,z){return V&&H(T.prototype,V),z&&H(T,z),T}var C="top-level",x="block-level",_=function(){function T(V){B(this,T),this.indent=V||"  ",this.indentTypes=[]}return I(T,[{key:"getIndent",value:function(){return(0,j.default)(this.indent,this.indentTypes.length)}},{key:"increaseTopLevel",value:function(){this.indentTypes.push(C)}},{key:"increaseBlockLevel",value:function(){this.indentTypes.push(x)}},{key:"decreaseTopLevel",value:function(){(0,L.default)(this.indentTypes)===C&&this.indentTypes.pop()}},{key:"decreaseBlockLevel",value:function(){for(;this.indentTypes.length>0;){var z=this.indentTypes.pop();if(z!==C)break}}},{key:"resetIndentation",value:function(){this.indentTypes=[]}}]),T}();ae.default=_,he.exports=ae.default},76625:(he,ae,y)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=void 0;var j=L(y(87825));function L(x){return x&&x.__esModule?x:{default:x}}function D(x,_){if(!(x instanceof _))throw new TypeError("Cannot call a class as a function")}function B(x,_){for(var T=0;T<_.length;T++){var V=_[T];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(x,V.key,V)}}function H(x,_,T){return _&&B(x.prototype,_),T&&B(x,T),x}var I=50,C=function(){function x(){D(this,x),this.level=0}return H(x,[{key:"beginIfPossible",value:function(T,V){this.level===0&&this.isInlineBlock(T,V)?this.level=1:this.level>0?this.level++:this.level=0}},{key:"end",value:function(){this.level--}},{key:"isActive",value:function(){return this.level>0}},{key:"isInlineBlock",value:function(T,V){for(var z=0,M=0,U=V;U<T.length;U++){var K=T[U];if(z+=K.value.length,z>I)return!1;if(K.type===j.default.OPEN_PAREN)M++;else if(K.type===j.default.CLOSE_PAREN&&(M--,M===0))return!0;if(this.isForbiddenToken(K))return!1}return!1}},{key:"isForbiddenToken",value:function(T){var V=T.type,z=T.value;return V===j.default.RESERVED_TOP_LEVEL||V===j.default.RESERVED_NEWLINE||V===j.default.COMMENT||V===j.default.BLOCK_COMMENT||z===";"}}]),x}();ae.default=C,he.exports=ae.default},26021:(he,ae)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=void 0;function y(B,H){if(!(B instanceof H))throw new TypeError("Cannot call a class as a function")}function j(B,H){for(var I=0;I<H.length;I++){var C=H[I];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(B,C.key,C)}}function L(B,H,I){return H&&j(B.prototype,H),I&&j(B,I),B}var D=function(){function B(H){y(this,B),this.params=H,this.index=0}return L(B,[{key:"get",value:function(I){var C=I.key,x=I.value;return this.params?C?this.params[C]:this.params[this.index++]:x}}]),B}();ae.default=D,he.exports=ae.default},81474:(he,ae,y)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=void 0;var j=B(y(62193)),L=B(y(60680)),D=B(y(87825));function B(_){return _&&_.__esModule?_:{default:_}}function H(_,T){if(!(_ instanceof T))throw new TypeError("Cannot call a class as a function")}function I(_,T){for(var V=0;V<T.length;V++){var z=T[V];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(_,z.key,z)}}function C(_,T,V){return T&&I(_.prototype,T),V&&I(_,V),_}var x=function(){function _(T){H(this,_),this.WHITESPACE_REGEX=/^([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)/,this.NUMBER_REGEX=/^((\x2D[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?[0-9]+(\.[0-9]+)?|0x[0-9A-Fa-f]+|0b[01]+)\b/,this.OPERATOR_REGEX=/^(!=|<>|==|<=|>=|!<|!>|\|\||::|\x2D>>|\x2D>|~~\*|~~|!~~\*|!~~|~\*|!~\*|!~|:=|(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/,this.BLOCK_COMMENT_REGEX=/^(\/\*(?:[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?(?:\*\/|$))/,this.LINE_COMMENT_REGEX=this.createLineCommentRegex(T.lineCommentTypes),this.RESERVED_TOP_LEVEL_REGEX=this.createReservedWordRegex(T.reservedTopLevelWords),this.RESERVED_TOP_LEVEL_NO_INDENT_REGEX=this.createReservedWordRegex(T.reservedTopLevelWordsNoIndent),this.RESERVED_NEWLINE_REGEX=this.createReservedWordRegex(T.reservedNewlineWords),this.RESERVED_PLAIN_REGEX=this.createReservedWordRegex(T.reservedWords),this.WORD_REGEX=this.createWordRegex(T.specialWordChars),this.STRING_REGEX=this.createStringRegex(T.stringTypes),this.OPEN_PAREN_REGEX=this.createParenRegex(T.openParens),this.CLOSE_PAREN_REGEX=this.createParenRegex(T.closeParens),this.INDEXED_PLACEHOLDER_REGEX=this.createPlaceholderRegex(T.indexedPlaceholderTypes,"[0-9]*"),this.IDENT_NAMED_PLACEHOLDER_REGEX=this.createPlaceholderRegex(T.namedPlaceholderTypes,"[a-zA-Z0-9._$]+"),this.STRING_NAMED_PLACEHOLDER_REGEX=this.createPlaceholderRegex(T.namedPlaceholderTypes,this.createStringPattern(T.stringTypes))}return C(_,[{key:"createLineCommentRegex",value:function(V){return new RegExp("^((?:".concat(V.map(function(z){return(0,L.default)(z)}).join("|"),`).*?(?:\r
|\r|
|$))`),"u")}},{key:"createReservedWordRegex",value:function(V){var z=V.join("|").replace(/ /g,"\\s+");return new RegExp("^(".concat(z,")\\b"),"iu")}},{key:"createWordRegex",value:function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return new RegExp("^([\\p{Alphabetic}\\p{Mark}\\p{Decimal_Number}\\p{Connector_Punctuation}\\p{Join_Control}".concat(V.join(""),"]+)"),"u")}},{key:"createStringRegex",value:function(V){return new RegExp("^("+this.createStringPattern(V)+")","u")}},{key:"createStringPattern",value:function(V){var z={"``":"((`[^`]*($|`))+)","[]":"((\\[[^\\]]*($|\\]))(\\][^\\]]*($|\\]))*)",'""':'(("[^"\\\\]*(?:\\\\.[^"\\\\]*)*("|$))+)',"''":"(('[^'\\\\]*(?:\\\\.[^'\\\\]*)*('|$))+)","N''":"((N'[^N'\\\\]*(?:\\\\.[^N'\\\\]*)*('|$))+)"};return V.map(function(M){return z[M]}).join("|")}},{key:"createParenRegex",value:function(V){var z=this;return new RegExp("^("+V.map(function(M){return z.escapeParen(M)}).join("|")+")","iu")}},{key:"escapeParen",value:function(V){return V.length===1?(0,L.default)(V):"\\b"+V+"\\b"}},{key:"createPlaceholderRegex",value:function(V,z){if((0,j.default)(V))return!1;var M=V.map(L.default).join("|");return new RegExp("^((?:".concat(M,")(?:").concat(z,"))"),"u")}},{key:"tokenize",value:function(V){if(!V)return[];for(var z=[],M;V.length;)M=this.getNextToken(V,M),V=V.substring(M.value.length),z.push(M);return z}},{key:"getNextToken",value:function(V,z){return this.getWhitespaceToken(V)||this.getCommentToken(V)||this.getStringToken(V)||this.getOpenParenToken(V)||this.getCloseParenToken(V)||this.getPlaceholderToken(V)||this.getNumberToken(V)||this.getReservedWordToken(V,z)||this.getWordToken(V)||this.getOperatorToken(V)}},{key:"getWhitespaceToken",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.WHITESPACE,regex:this.WHITESPACE_REGEX})}},{key:"getCommentToken",value:function(V){return this.getLineCommentToken(V)||this.getBlockCommentToken(V)}},{key:"getLineCommentToken",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.LINE_COMMENT,regex:this.LINE_COMMENT_REGEX})}},{key:"getBlockCommentToken",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.BLOCK_COMMENT,regex:this.BLOCK_COMMENT_REGEX})}},{key:"getStringToken",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.STRING,regex:this.STRING_REGEX})}},{key:"getOpenParenToken",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.OPEN_PAREN,regex:this.OPEN_PAREN_REGEX})}},{key:"getCloseParenToken",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.CLOSE_PAREN,regex:this.CLOSE_PAREN_REGEX})}},{key:"getPlaceholderToken",value:function(V){return this.getIdentNamedPlaceholderToken(V)||this.getStringNamedPlaceholderToken(V)||this.getIndexedPlaceholderToken(V)}},{key:"getIdentNamedPlaceholderToken",value:function(V){return this.getPlaceholderTokenWithKey({input:V,regex:this.IDENT_NAMED_PLACEHOLDER_REGEX,parseKey:function(M){return M.slice(1)}})}},{key:"getStringNamedPlaceholderToken",value:function(V){var z=this;return this.getPlaceholderTokenWithKey({input:V,regex:this.STRING_NAMED_PLACEHOLDER_REGEX,parseKey:function(U){return z.getEscapedPlaceholderKey({key:U.slice(2,-1),quoteChar:U.slice(-1)})}})}},{key:"getIndexedPlaceholderToken",value:function(V){return this.getPlaceholderTokenWithKey({input:V,regex:this.INDEXED_PLACEHOLDER_REGEX,parseKey:function(M){return M.slice(1)}})}},{key:"getPlaceholderTokenWithKey",value:function(V){var z=V.input,M=V.regex,U=V.parseKey,K=this.getTokenOnFirstMatch({input:z,regex:M,type:D.default.PLACEHOLDER});return K&&(K.key=U(K.value)),K}},{key:"getEscapedPlaceholderKey",value:function(V){var z=V.key,M=V.quoteChar;return z.replace(new RegExp((0,L.default)("\\"+M),"gu"),M)}},{key:"getNumberToken",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.NUMBER,regex:this.NUMBER_REGEX})}},{key:"getOperatorToken",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.OPERATOR,regex:this.OPERATOR_REGEX})}},{key:"getReservedWordToken",value:function(V,z){if(!(z&&z.value&&z.value==="."))return this.getTopLevelReservedToken(V)||this.getNewlineReservedToken(V)||this.getTopLevelReservedTokenNoIndent(V)||this.getPlainReservedToken(V)}},{key:"getTopLevelReservedToken",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.RESERVED_TOP_LEVEL,regex:this.RESERVED_TOP_LEVEL_REGEX})}},{key:"getNewlineReservedToken",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.RESERVED_NEWLINE,regex:this.RESERVED_NEWLINE_REGEX})}},{key:"getTopLevelReservedTokenNoIndent",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.RESERVED_TOP_LEVEL_NO_INDENT,regex:this.RESERVED_TOP_LEVEL_NO_INDENT_REGEX})}},{key:"getPlainReservedToken",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.RESERVED,regex:this.RESERVED_PLAIN_REGEX})}},{key:"getWordToken",value:function(V){return this.getTokenOnFirstMatch({input:V,type:D.default.WORD,regex:this.WORD_REGEX})}},{key:"getTokenOnFirstMatch",value:function(V){var z=V.input,M=V.type,U=V.regex,K=z.match(U);if(K)return{type:M,value:K[1]}}}]),_}();ae.default=x,he.exports=ae.default},87825:(he,ae)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=void 0;var y={WHITESPACE:"whitespace",WORD:"word",STRING:"string",RESERVED:"reserved",RESERVED_TOP_LEVEL:"reserved-top-level",RESERVED_TOP_LEVEL_NO_INDENT:"reserved-top-level-no-indent",RESERVED_NEWLINE:"reserved-newline",OPERATOR:"operator",OPEN_PAREN:"open-paren",CLOSE_PAREN:"close-paren",LINE_COMMENT:"line-comment",BLOCK_COMMENT:"block-comment",NUMBER:"number",PLACEHOLDER:"placeholder"};ae.default=y,he.exports=ae.default},58521:(he,ae,y)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=void 0;var j=D(y(3429)),L=D(y(81474));function D(M){return M&&M.__esModule?M:{default:M}}function B(M,U){if(!(M instanceof U))throw new TypeError("Cannot call a class as a function")}function H(M,U){for(var K=0;K<U.length;K++){var Y=U[K];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(M,Y.key,Y)}}function I(M,U,K){return U&&H(M.prototype,U),K&&H(M,K),M}var C=["ABS","ACTIVATE","ALIAS","ALL","ALLOCATE","ALLOW","ALTER","ANY","ARE","ARRAY","AS","ASC","ASENSITIVE","ASSOCIATE","ASUTIME","ASYMMETRIC","AT","ATOMIC","ATTRIBUTES","AUDIT","AUTHORIZATION","AUX","AUXILIARY","AVG","BEFORE","BEGIN","BETWEEN","BIGINT","BINARY","BLOB","BOOLEAN","BOTH","BUFFERPOOL","BY","CACHE","CALL","CALLED","CAPTURE","CARDINALITY","CASCADED","CASE","CAST","CCSID","CEIL","CEILING","CHAR","CHARACTER","CHARACTER_LENGTH","CHAR_LENGTH","CHECK","CLOB","CLONE","CLOSE","CLUSTER","COALESCE","COLLATE","COLLECT","COLLECTION","COLLID","COLUMN","COMMENT","COMMIT","CONCAT","CONDITION","CONNECT","CONNECTION","CONSTRAINT","CONTAINS","CONTINUE","CONVERT","CORR","CORRESPONDING","COUNT","COUNT_BIG","COVAR_POP","COVAR_SAMP","CREATE","CROSS","CUBE","CUME_DIST","CURRENT","CURRENT_DATE","CURRENT_DEFAULT_TRANSFORM_GROUP","CURRENT_LC_CTYPE","CURRENT_PATH","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_SERVER","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_TIMEZONE","CURRENT_TRANSFORM_GROUP_FOR_TYPE","CURRENT_USER","CURSOR","CYCLE","DATA","DATABASE","DATAPARTITIONNAME","DATAPARTITIONNUM","DATE","DAY","DAYS","DB2GENERAL","DB2GENRL","DB2SQL","DBINFO","DBPARTITIONNAME","DBPARTITIONNUM","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFAULTS","DEFINITION","DELETE","DENSERANK","DENSE_RANK","DEREF","DESCRIBE","DESCRIPTOR","DETERMINISTIC","DIAGNOSTICS","DISABLE","DISALLOW","DISCONNECT","DISTINCT","DO","DOCUMENT","DOUBLE","DROP","DSSIZE","DYNAMIC","EACH","EDITPROC","ELEMENT","ELSE","ELSEIF","ENABLE","ENCODING","ENCRYPTION","END","END-EXEC","ENDING","ERASE","ESCAPE","EVERY","EXCEPTION","EXCLUDING","EXCLUSIVE","EXEC","EXECUTE","EXISTS","EXIT","EXP","EXPLAIN","EXTENDED","EXTERNAL","EXTRACT","FALSE","FENCED","FETCH","FIELDPROC","FILE","FILTER","FINAL","FIRST","FLOAT","FLOOR","FOR","FOREIGN","FREE","FULL","FUNCTION","FUSION","GENERAL","GENERATED","GET","GLOBAL","GOTO","GRANT","GRAPHIC","GROUP","GROUPING","HANDLER","HASH","HASHED_VALUE","HINT","HOLD","HOUR","HOURS","IDENTITY","IF","IMMEDIATE","IN","INCLUDING","INCLUSIVE","INCREMENT","INDEX","INDICATOR","INDICATORS","INF","INFINITY","INHERIT","INNER","INOUT","INSENSITIVE","INSERT","INT","INTEGER","INTEGRITY","INTERSECTION","INTERVAL","INTO","IS","ISOBID","ISOLATION","ITERATE","JAR","JAVA","KEEP","KEY","LABEL","LANGUAGE","LARGE","LATERAL","LC_CTYPE","LEADING","LEAVE","LEFT","LIKE","LINKTYPE","LN","LOCAL","LOCALDATE","LOCALE","LOCALTIME","LOCALTIMESTAMP","LOCATOR","LOCATORS","LOCK","LOCKMAX","LOCKSIZE","LONG","LOOP","LOWER","MAINTAINED","MATCH","MATERIALIZED","MAX","MAXVALUE","MEMBER","MERGE","METHOD","MICROSECOND","MICROSECONDS","MIN","MINUTE","MINUTES","MINVALUE","MOD","MODE","MODIFIES","MODULE","MONTH","MONTHS","MULTISET","NAN","NATIONAL","NATURAL","NCHAR","NCLOB","NEW","NEW_TABLE","NEXTVAL","NO","NOCACHE","NOCYCLE","NODENAME","NODENUMBER","NOMAXVALUE","NOMINVALUE","NONE","NOORDER","NORMALIZE","NORMALIZED","NOT","NULL","NULLIF","NULLS","NUMERIC","NUMPARTS","OBID","OCTET_LENGTH","OF","OFFSET","OLD","OLD_TABLE","ON","ONLY","OPEN","OPTIMIZATION","OPTIMIZE","OPTION","ORDER","OUT","OUTER","OVER","OVERLAPS","OVERLAY","OVERRIDING","PACKAGE","PADDED","PAGESIZE","PARAMETER","PART","PARTITION","PARTITIONED","PARTITIONING","PARTITIONS","PASSWORD","PATH","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","PIECESIZE","PLAN","POSITION","POWER","PRECISION","PREPARE","PREVVAL","PRIMARY","PRIQTY","PRIVILEGES","PROCEDURE","PROGRAM","PSID","PUBLIC","QUERY","QUERYNO","RANGE","RANK","READ","READS","REAL","RECOVERY","RECURSIVE","REF","REFERENCES","REFERENCING","REFRESH","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","RELEASE","RENAME","REPEAT","RESET","RESIGNAL","RESTART","RESTRICT","RESULT","RESULT_SET_LOCATOR","RETURN","RETURNS","REVOKE","RIGHT","ROLE","ROLLBACK","ROLLUP","ROUND_CEILING","ROUND_DOWN","ROUND_FLOOR","ROUND_HALF_DOWN","ROUND_HALF_EVEN","ROUND_HALF_UP","ROUND_UP","ROUTINE","ROW","ROWNUMBER","ROWS","ROWSET","ROW_NUMBER","RRN","RUN","SAVEPOINT","SCHEMA","SCOPE","SCRATCHPAD","SCROLL","SEARCH","SECOND","SECONDS","SECQTY","SECURITY","SENSITIVE","SEQUENCE","SESSION","SESSION_USER","SIGNAL","SIMILAR","SIMPLE","SMALLINT","SNAN","SOME","SOURCE","SPECIFIC","SPECIFICTYPE","SQL","SQLEXCEPTION","SQLID","SQLSTATE","SQLWARNING","SQRT","STACKED","STANDARD","START","STARTING","STATEMENT","STATIC","STATMENT","STAY","STDDEV_POP","STDDEV_SAMP","STOGROUP","STORES","STYLE","SUBMULTISET","SUBSTRING","SUM","SUMMARY","SYMMETRIC","SYNONYM","SYSFUN","SYSIBM","SYSPROC","SYSTEM","SYSTEM_USER","TABLE","TABLESAMPLE","TABLESPACE","THEN","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TRAILING","TRANSACTION","TRANSLATE","TRANSLATION","TREAT","TRIGGER","TRIM","TRUE","TRUNCATE","TYPE","UESCAPE","UNDO","UNIQUE","UNKNOWN","UNNEST","UNTIL","UPPER","USAGE","USER","USING","VALIDPROC","VALUE","VARCHAR","VARIABLE","VARIANT","VARYING","VAR_POP","VAR_SAMP","VCAT","VERSION","VIEW","VOLATILE","VOLUMES","WHEN","WHENEVER","WHILE","WIDTH_BUCKET","WINDOW","WITH","WITHIN","WITHOUT","WLM","WRITE","XMLELEMENT","XMLEXISTS","XMLNAMESPACES","YEAR","YEARS"],x=["ADD","AFTER","ALTER COLUMN","ALTER TABLE","DELETE FROM","EXCEPT","FETCH FIRST","FROM","GROUP BY","GO","HAVING","INSERT INTO","INTERSECT","LIMIT","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UPDATE","VALUES","WHERE"],_=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],T=["AND","CROSS JOIN","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN"],V,z=function(){function M(U){B(this,M),this.cfg=U}return I(M,[{key:"format",value:function(K){return V||(V=new L.default({reservedWords:C,reservedTopLevelWords:x,reservedNewlineWords:T,reservedTopLevelWordsNoIndent:_,stringTypes:['""',"''","``","[]"],openParens:["("],closeParens:[")"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[":"],lineCommentTypes:["--"],specialWordChars:["#","@"]})),new j.default(this.cfg,V).format(K)}}]),M}();ae.default=z,he.exports=ae.default},95349:(he,ae,y)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=void 0;var j=D(y(3429)),L=D(y(81474));function D(M){return M&&M.__esModule?M:{default:M}}function B(M,U){if(!(M instanceof U))throw new TypeError("Cannot call a class as a function")}function H(M,U){for(var K=0;K<U.length;K++){var Y=U[K];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(M,Y.key,Y)}}function I(M,U,K){return U&&H(M.prototype,U),K&&H(M,K),M}var C=["ALL","ALTER","ANALYZE","AND","ANY","ARRAY","AS","ASC","BEGIN","BETWEEN","BINARY","BOOLEAN","BREAK","BUCKET","BUILD","BY","CALL","CASE","CAST","CLUSTER","COLLATE","COLLECTION","COMMIT","CONNECT","CONTINUE","CORRELATE","COVER","CREATE","DATABASE","DATASET","DATASTORE","DECLARE","DECREMENT","DELETE","DERIVED","DESC","DESCRIBE","DISTINCT","DO","DROP","EACH","ELEMENT","ELSE","END","EVERY","EXCEPT","EXCLUDE","EXECUTE","EXISTS","EXPLAIN","FALSE","FETCH","FIRST","FLATTEN","FOR","FORCE","FROM","FUNCTION","GRANT","GROUP","GSI","HAVING","IF","IGNORE","ILIKE","IN","INCLUDE","INCREMENT","INDEX","INFER","INLINE","INNER","INSERT","INTERSECT","INTO","IS","JOIN","KEY","KEYS","KEYSPACE","KNOWN","LAST","LEFT","LET","LETTING","LIKE","LIMIT","LSM","MAP","MAPPING","MATCHED","MATERIALIZED","MERGE","MISSING","NAMESPACE","NEST","NOT","NULL","NUMBER","OBJECT","OFFSET","ON","OPTION","OR","ORDER","OUTER","OVER","PARSE","PARTITION","PASSWORD","PATH","POOL","PREPARE","PRIMARY","PRIVATE","PRIVILEGE","PROCEDURE","PUBLIC","RAW","REALM","REDUCE","RENAME","RETURN","RETURNING","REVOKE","RIGHT","ROLE","ROLLBACK","SATISFIES","SCHEMA","SELECT","SELF","SEMI","SET","SHOW","SOME","START","STATISTICS","STRING","SYSTEM","THEN","TO","TRANSACTION","TRIGGER","TRUE","TRUNCATE","UNDER","UNION","UNIQUE","UNKNOWN","UNNEST","UNSET","UPDATE","UPSERT","USE","USER","USING","VALIDATE","VALUE","VALUED","VALUES","VIA","VIEW","WHEN","WHERE","WHILE","WITH","WITHIN","WORK","XOR"],x=["DELETE FROM","EXCEPT ALL","EXCEPT","EXPLAIN DELETE FROM","EXPLAIN UPDATE","EXPLAIN UPSERT","FROM","GROUP BY","HAVING","INFER","INSERT INTO","LET","LIMIT","MERGE","NEST","ORDER BY","PREPARE","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UNNEST","UPDATE","UPSERT","USE KEYS","VALUES","WHERE"],_=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],T=["AND","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","XOR"],V,z=function(){function M(U){B(this,M),this.cfg=U}return I(M,[{key:"format",value:function(K){return V||(V=new L.default({reservedWords:C,reservedTopLevelWords:x,reservedNewlineWords:T,reservedTopLevelWordsNoIndent:_,stringTypes:['""',"''","``"],openParens:["(","[","{"],closeParens:[")","]","}"],namedPlaceholderTypes:["$"],lineCommentTypes:["#","--"]})),new j.default(this.cfg,V).format(K)}}]),M}();ae.default=z,he.exports=ae.default},3161:(he,ae,y)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=void 0;var j=B(y(3429)),L=B(y(81474)),D=B(y(87825));function B(K){return K&&K.__esModule?K:{default:K}}function H(K,Y){if(!(K instanceof Y))throw new TypeError("Cannot call a class as a function")}function I(K,Y){for(var Te=0;Te<Y.length;Te++){var me=Y[Te];me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(K,me.key,me)}}function C(K,Y,Te){return Y&&I(K.prototype,Y),Te&&I(K,Te),K}var x=["A","ACCESSIBLE","AGENT","AGGREGATE","ALL","ALTER","ANY","ARRAY","AS","ASC","AT","ATTRIBUTE","AUTHID","AVG","BETWEEN","BFILE_BASE","BINARY_INTEGER","BINARY","BLOB_BASE","BLOCK","BODY","BOOLEAN","BOTH","BOUND","BREADTH","BULK","BY","BYTE","C","CALL","CALLING","CASCADE","CASE","CHAR_BASE","CHAR","CHARACTER","CHARSET","CHARSETFORM","CHARSETID","CHECK","CLOB_BASE","CLONE","CLOSE","CLUSTER","CLUSTERS","COALESCE","COLAUTH","COLLECT","COLUMNS","COMMENT","COMMIT","COMMITTED","COMPILED","COMPRESS","CONNECT","CONSTANT","CONSTRUCTOR","CONTEXT","CONTINUE","CONVERT","COUNT","CRASH","CREATE","CREDENTIAL","CURRENT","CURRVAL","CURSOR","CUSTOMDATUM","DANGLING","DATA","DATE_BASE","DATE","DAY","DECIMAL","DEFAULT","DEFINE","DELETE","DEPTH","DESC","DETERMINISTIC","DIRECTORY","DISTINCT","DO","DOUBLE","DROP","DURATION","ELEMENT","ELSIF","EMPTY","END","ESCAPE","EXCEPTIONS","EXCLUSIVE","EXECUTE","EXISTS","EXIT","EXTENDS","EXTERNAL","EXTRACT","FALSE","FETCH","FINAL","FIRST","FIXED","FLOAT","FOR","FORALL","FORCE","FROM","FUNCTION","GENERAL","GOTO","GRANT","GROUP","HASH","HEAP","HIDDEN","HOUR","IDENTIFIED","IF","IMMEDIATE","IN","INCLUDING","INDEX","INDEXES","INDICATOR","INDICES","INFINITE","INSTANTIABLE","INT","INTEGER","INTERFACE","INTERVAL","INTO","INVALIDATE","IS","ISOLATION","JAVA","LANGUAGE","LARGE","LEADING","LENGTH","LEVEL","LIBRARY","LIKE","LIKE2","LIKE4","LIKEC","LIMITED","LOCAL","LOCK","LONG","MAP","MAX","MAXLEN","MEMBER","MERGE","MIN","MINUTE","MLSLABEL","MOD","MODE","MONTH","MULTISET","NAME","NAN","NATIONAL","NATIVE","NATURAL","NATURALN","NCHAR","NEW","NEXTVAL","NOCOMPRESS","NOCOPY","NOT","NOWAIT","NULL","NULLIF","NUMBER_BASE","NUMBER","OBJECT","OCICOLL","OCIDATE","OCIDATETIME","OCIDURATION","OCIINTERVAL","OCILOBLOCATOR","OCINUMBER","OCIRAW","OCIREF","OCIREFCURSOR","OCIROWID","OCISTRING","OCITYPE","OF","OLD","ON","ONLY","OPAQUE","OPEN","OPERATOR","OPTION","ORACLE","ORADATA","ORDER","ORGANIZATION","ORLANY","ORLVARY","OTHERS","OUT","OVERLAPS","OVERRIDING","PACKAGE","PARALLEL_ENABLE","PARAMETER","PARAMETERS","PARENT","PARTITION","PASCAL","PCTFREE","PIPE","PIPELINED","PLS_INTEGER","PLUGGABLE","POSITIVE","POSITIVEN","PRAGMA","PRECISION","PRIOR","PRIVATE","PROCEDURE","PUBLIC","RAISE","RANGE","RAW","READ","REAL","RECORD","REF","REFERENCE","RELEASE","RELIES_ON","REM","REMAINDER","RENAME","RESOURCE","RESULT_CACHE","RESULT","RETURN","RETURNING","REVERSE","REVOKE","ROLLBACK","ROW","ROWID","ROWNUM","ROWTYPE","SAMPLE","SAVE","SAVEPOINT","SB1","SB2","SB4","SEARCH","SECOND","SEGMENT","SELF","SEPARATE","SEQUENCE","SERIALIZABLE","SHARE","SHORT","SIZE_T","SIZE","SMALLINT","SOME","SPACE","SPARSE","SQL","SQLCODE","SQLDATA","SQLERRM","SQLNAME","SQLSTATE","STANDARD","START","STATIC","STDDEV","STORED","STRING","STRUCT","STYLE","SUBMULTISET","SUBPARTITION","SUBSTITUTABLE","SUBTYPE","SUCCESSFUL","SUM","SYNONYM","SYSDATE","TABAUTH","TABLE","TDO","THE","THEN","TIME","TIMESTAMP","TIMEZONE_ABBR","TIMEZONE_HOUR","TIMEZONE_MINUTE","TIMEZONE_REGION","TO","TRAILING","TRANSACTION","TRANSACTIONAL","TRIGGER","TRUE","TRUSTED","TYPE","UB1","UB2","UB4","UID","UNDER","UNIQUE","UNPLUG","UNSIGNED","UNTRUSTED","USE","USER","USING","VALIDATE","VALIST","VALUE","VARCHAR","VARCHAR2","VARIABLE","VARIANCE","VARRAY","VARYING","VIEW","VIEWS","VOID","WHENEVER","WHILE","WITH","WORK","WRAPPED","WRITE","YEAR","ZONE"],_=["ADD","ALTER COLUMN","ALTER TABLE","BEGIN","CONNECT BY","DECLARE","DELETE FROM","DELETE","END","EXCEPT","EXCEPTION","FETCH FIRST","FROM","GROUP BY","HAVING","INSERT INTO","INSERT","LIMIT","LOOP","MODIFY","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","START WITH","UPDATE","VALUES","WHERE"],T=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],V=["AND","CROSS APPLY","CROSS JOIN","ELSE","END","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER APPLY","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","WHEN","XOR"],z=function(Y,Te){if(Y.type===D.default.RESERVED_TOP_LEVEL&&Y.value==="SET"&&Te.value==="BY")return Y.type=D.default.RESERVED,Y},M,U=function(){function K(Y){H(this,K),this.cfg=Y}return C(K,[{key:"format",value:function(Te){return M||(M=new L.default({reservedWords:x,reservedTopLevelWords:_,reservedNewlineWords:V,reservedTopLevelWordsNoIndent:T,stringTypes:['""',"N''","''","``"],openParens:["(","CASE","BEGIN"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[":"],lineCommentTypes:["--"],specialWordChars:["_","$","#",".","@"]})),new j.default(this.cfg,M,z).format(Te)}}]),K}();ae.default=U,he.exports=ae.default},48808:(he,ae,y)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=void 0;var j=D(y(3429)),L=D(y(81474));function D(M){return M&&M.__esModule?M:{default:M}}function B(M,U){if(!(M instanceof U))throw new TypeError("Cannot call a class as a function")}function H(M,U){for(var K=0;K<U.length;K++){var Y=U[K];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(M,Y.key,Y)}}function I(M,U,K){return U&&H(M.prototype,U),K&&H(M,K),M}var C=["ACCESSIBLE","ACTION","AGAINST","AGGREGATE","ALGORITHM","ALL","ALTER","ANALYSE","ANALYZE","AS","ASC","AUTOCOMMIT","AUTO_INCREMENT","BACKUP","BEGIN","BETWEEN","BINLOG","BOTH","CASCADE","CASE","CHANGE","CHANGED","CHARACTER SET","CHARSET","CHECK","CHECKSUM","COLLATE","COLLATION","COLUMN","COLUMNS","COMMENT","COMMIT","COMMITTED","COMPRESSED","CONCURRENT","CONSTRAINT","CONTAINS","CONVERT","CREATE","CROSS","CURRENT_TIMESTAMP","DATABASE","DATABASES","DAY","DAY_HOUR","DAY_MINUTE","DAY_SECOND","DEFAULT","DEFINER","DELAYED","DELETE","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DO","DROP","DUMPFILE","DUPLICATE","DYNAMIC","ELSE","ENCLOSED","END","ENGINE","ENGINES","ENGINE_TYPE","ESCAPE","ESCAPED","EVENTS","EXEC","EXECUTE","EXISTS","EXPLAIN","EXTENDED","FAST","FETCH","FIELDS","FILE","FIRST","FIXED","FLUSH","FOR","FORCE","FOREIGN","FULL","FULLTEXT","FUNCTION","GLOBAL","GRANT","GRANTS","GROUP_CONCAT","HEAP","HIGH_PRIORITY","HOSTS","HOUR","HOUR_MINUTE","HOUR_SECOND","IDENTIFIED","IF","IFNULL","IGNORE","IN","INDEX","INDEXES","INFILE","INSERT","INSERT_ID","INSERT_METHOD","INTERVAL","INTO","INVOKER","IS","ISOLATION","KEY","KEYS","KILL","LAST_INSERT_ID","LEADING","LEVEL","LIKE","LINEAR","LINES","LOAD","LOCAL","LOCK","LOCKS","LOGS","LOW_PRIORITY","MARIA","MASTER","MASTER_CONNECT_RETRY","MASTER_HOST","MASTER_LOG_FILE","MATCH","MAX_CONNECTIONS_PER_HOUR","MAX_QUERIES_PER_HOUR","MAX_ROWS","MAX_UPDATES_PER_HOUR","MAX_USER_CONNECTIONS","MEDIUM","MERGE","MINUTE","MINUTE_SECOND","MIN_ROWS","MODE","MODIFY","MONTH","MRG_MYISAM","MYISAM","NAMES","NATURAL","NOT","NOW()","NULL","OFFSET","ON DELETE","ON UPDATE","ON","ONLY","OPEN","OPTIMIZE","OPTION","OPTIONALLY","OUTFILE","PACK_KEYS","PAGE","PARTIAL","PARTITION","PARTITIONS","PASSWORD","PRIMARY","PRIVILEGES","PROCEDURE","PROCESS","PROCESSLIST","PURGE","QUICK","RAID0","RAID_CHUNKS","RAID_CHUNKSIZE","RAID_TYPE","RANGE","READ","READ_ONLY","READ_WRITE","REFERENCES","REGEXP","RELOAD","RENAME","REPAIR","REPEATABLE","REPLACE","REPLICATION","RESET","RESTORE","RESTRICT","RETURN","RETURNS","REVOKE","RLIKE","ROLLBACK","ROW","ROWS","ROW_FORMAT","SECOND","SECURITY","SEPARATOR","SERIALIZABLE","SESSION","SHARE","SHOW","SHUTDOWN","SLAVE","SONAME","SOUNDS","SQL","SQL_AUTO_IS_NULL","SQL_BIG_RESULT","SQL_BIG_SELECTS","SQL_BIG_TABLES","SQL_BUFFER_RESULT","SQL_CACHE","SQL_CALC_FOUND_ROWS","SQL_LOG_BIN","SQL_LOG_OFF","SQL_LOG_UPDATE","SQL_LOW_PRIORITY_UPDATES","SQL_MAX_JOIN_SIZE","SQL_NO_CACHE","SQL_QUOTE_SHOW_CREATE","SQL_SAFE_UPDATES","SQL_SELECT_LIMIT","SQL_SLAVE_SKIP_COUNTER","SQL_SMALL_RESULT","SQL_WARNINGS","START","STARTING","STATUS","STOP","STORAGE","STRAIGHT_JOIN","STRING","STRIPED","SUPER","TABLE","TABLES","TEMPORARY","TERMINATED","THEN","TO","TRAILING","TRANSACTIONAL","TRUE","TRUNCATE","TYPE","TYPES","UNCOMMITTED","UNIQUE","UNLOCK","UNSIGNED","USAGE","USE","USING","VARIABLES","VIEW","WHEN","WITH","WORK","WRITE","YEAR_MONTH"],x=["ADD","AFTER","ALTER COLUMN","ALTER TABLE","DELETE FROM","EXCEPT","FETCH FIRST","FROM","GROUP BY","GO","HAVING","INSERT INTO","INSERT","LIMIT","MODIFY","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UPDATE","VALUES","WHERE"],_=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],T=["AND","CROSS APPLY","CROSS JOIN","ELSE","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER APPLY","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","WHEN","XOR"],V,z=function(){function M(U){B(this,M),this.cfg=U}return I(M,[{key:"format",value:function(K){return V||(V=new L.default({reservedWords:C,reservedTopLevelWords:x,reservedNewlineWords:T,reservedTopLevelWordsNoIndent:_,stringTypes:['""',"N''","''","``","[]"],openParens:["(","CASE"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:["@",":"],lineCommentTypes:["#","--"]})),new j.default(this.cfg,V).format(K)}}]),M}();ae.default=z,he.exports=ae.default},27633:(he,ae,y)=>{"use strict";var j;j={value:!0},ae.Ay=j=void 0;var L=I(y(58521)),D=I(y(95349)),B=I(y(3161)),H=I(y(48808));function I(_){return _&&_.__esModule?_:{default:_}}var C=function(T){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(V.language){case"db2":return new L.default(V).format(T);case"n1ql":return new D.default(V).format(T);case"pl/sql":return new B.default(V).format(T);case"sql":case void 0:return new H.default(V).format(T);default:throw Error("Unsupported SQL dialect: ".concat(V.language))}};j=C;var x={format:C};ae.Ay=x},61526:(he,ae,y)=>{he.exports=y(88319)},88319:(he,ae,y)=>{var j=y(48287).Buffer,L=ae,D=/`/g,B=/\./g,H=/[\0\b\t\n\r\x1a\"\'\\]/g,I={"\0":"\\0","\b":"\\b","	":"\\t","\n":"\\n","\r":"\\r","":"\\Z",'"':'\\"',"'":"\\'","\\":"\\\\"};L.escapeId=function(V,z){if(Array.isArray(V)){for(var M="",U=0;U<V.length;U++)M+=(U===0?"":", ")+L.escapeId(V[U],z);return M}else return z?"`"+String(V).replace(D,"``")+"`":"`"+String(V).replace(D,"``").replace(B,"`.`")+"`"},L.escape=function(V,z,M){if(V==null)return"NULL";switch(typeof V){case"boolean":return V?"true":"false";case"number":return V+"";case"object":return Object.prototype.toString.call(V)==="[object Date]"?L.dateToString(V,M||"local"):Array.isArray(V)?L.arrayToList(V,M):j.isBuffer(V)?L.bufferToString(V):typeof V.toSqlString=="function"?String(V.toSqlString()):z?C(V.toString()):L.objectToValues(V,M);default:return C(V)}},L.arrayToList=function(V,z){for(var M="",U=0;U<V.length;U++){var K=V[U];Array.isArray(K)?M+=(U===0?"":", ")+"("+L.arrayToList(K,z)+")":M+=(U===0?"":", ")+L.escape(K,!0,z)}return M},L.format=function(V,z,M,U){if(z==null)return V;Array.isArray(z)||(z=[z]);for(var K=0,Y=/\?+/g,Te="",me=0,Xe;me<z.length&&(Xe=Y.exec(V));){var Be=Xe[0].length;if(!(Be>2)){var Ue=Be===2?L.escapeId(z[me]):L.escape(z[me],M,U);Te+=V.slice(K,Xe.index)+Ue,K=Y.lastIndex,me++}}return K===0?V:K<V.length?Te+V.slice(K):Te},L.dateToString=function(V,z){var M=new Date(V);if(isNaN(M.getTime()))return"NULL";var U,K,Y,Te,me,Xe,Be;if(z==="local")U=M.getFullYear(),K=M.getMonth()+1,Y=M.getDate(),Te=M.getHours(),me=M.getMinutes(),Xe=M.getSeconds(),Be=M.getMilliseconds();else{var Ue=_(z);Ue!==!1&&Ue!==0&&M.setTime(M.getTime()+Ue*6e4),U=M.getUTCFullYear(),K=M.getUTCMonth()+1,Y=M.getUTCDate(),Te=M.getUTCHours(),me=M.getUTCMinutes(),Xe=M.getUTCSeconds(),Be=M.getUTCMilliseconds()}var Re=x(U,4)+"-"+x(K,2)+"-"+x(Y,2)+" "+x(Te,2)+":"+x(me,2)+":"+x(Xe,2)+"."+x(Be,3);return C(Re)},L.bufferToString=function(V){return"X"+C(V.toString("hex"))},L.objectToValues=function(V,z){var M="";for(var U in V){var K=V[U];typeof K!="function"&&(M+=(M.length===0?"":", ")+L.escapeId(U)+" = "+L.escape(K,!0,z))}return M},L.raw=function(V){if(typeof V!="string")throw new TypeError("argument sql must be a string");return{toSqlString:function(){return V}}};function C(T){for(var V=H.lastIndex=0,z="",M;M=H.exec(T);)z+=T.slice(V,M.index)+I[M[0]],V=H.lastIndex;return V===0?"'"+T+"'":V<T.length?"'"+z+T.slice(V)+"'":"'"+z+"'"}function x(T,V){for(T=T.toString();T.length<V;)T="0"+T;return T}function _(T){if(T==="Z")return 0;var V=T.match(/([\+\-\s])(\d\d):?(\d\d)?/);return V?(V[1]==="-"?-1:1)*(parseInt(V[2],10)+(V[3]?parseInt(V[3],10):0)/60)*60:!1}},4633:(he,ae,y)=>{var j=y(73738).default;function L(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */he.exports=L=function(){return B},he.exports.__esModule=!0,he.exports.default=he.exports;var D,B={},H=Object.prototype,I=H.hasOwnProperty,C=Object.defineProperty||function(Ee,ye,Ae){Ee[ye]=Ae.value},x=typeof Symbol=="function"?Symbol:{},_=x.iterator||"@@iterator",T=x.asyncIterator||"@@asyncIterator",V=x.toStringTag||"@@toStringTag";function z(Ee,ye,Ae){return Object.defineProperty(Ee,ye,{value:Ae,enumerable:!0,configurable:!0,writable:!0}),Ee[ye]}try{z({},"")}catch{z=function(Ae,Ie,_e){return Ae[Ie]=_e}}function M(Ee,ye,Ae,Ie){var _e=ye&&ye.prototype instanceof Be?ye:Be,h=Object.create(_e.prototype),He=new Wr(Ie||[]);return C(h,"_invoke",{value:yr(Ee,Ae,He)}),h}function U(Ee,ye,Ae){try{return{type:"normal",arg:Ee.call(ye,Ae)}}catch(Ie){return{type:"throw",arg:Ie}}}B.wrap=M;var K="suspendedStart",Y="suspendedYield",Te="executing",me="completed",Xe={};function Be(){}function Ue(){}function Re(){}var ar={};z(ar,_,function(){return this});var Ke=Object.getPrototypeOf,dr=Ke&&Ke(Ke(kr([])));dr&&dr!==H&&I.call(dr,_)&&(ar=dr);var pr=Re.prototype=Be.prototype=Object.create(ar);function rr(Ee){["next","throw","return"].forEach(function(ye){z(Ee,ye,function(Ae){return this._invoke(ye,Ae)})})}function tr(Ee,ye){function Ae(_e,h,He,We){var or=U(Ee[_e],Ee,h);if(or.type!=="throw"){var nt=or.arg,lt=nt.value;return lt&&j(lt)=="object"&&I.call(lt,"__await")?ye.resolve(lt.__await).then(function(sr){Ae("next",sr,He,We)},function(sr){Ae("throw",sr,He,We)}):ye.resolve(lt).then(function(sr){nt.value=sr,He(nt)},function(sr){return Ae("throw",sr,He,We)})}We(or.arg)}var Ie;C(this,"_invoke",{value:function(h,He){function We(){return new ye(function(or,nt){Ae(h,He,or,nt)})}return Ie=Ie?Ie.then(We,We):We()}})}function yr(Ee,ye,Ae){var Ie=K;return function(_e,h){if(Ie===Te)throw new Error("Generator is already running");if(Ie===me){if(_e==="throw")throw h;return{value:D,done:!0}}for(Ae.method=_e,Ae.arg=h;;){var He=Ae.delegate;if(He){var We=Pe(He,Ae);if(We){if(We===Xe)continue;return We}}if(Ae.method==="next")Ae.sent=Ae._sent=Ae.arg;else if(Ae.method==="throw"){if(Ie===K)throw Ie=me,Ae.arg;Ae.dispatchException(Ae.arg)}else Ae.method==="return"&&Ae.abrupt("return",Ae.arg);Ie=Te;var or=U(Ee,ye,Ae);if(or.type==="normal"){if(Ie=Ae.done?me:Y,or.arg===Xe)continue;return{value:or.arg,done:Ae.done}}or.type==="throw"&&(Ie=me,Ae.method="throw",Ae.arg=or.arg)}}}function Pe(Ee,ye){var Ae=ye.method,Ie=Ee.iterator[Ae];if(Ie===D)return ye.delegate=null,Ae==="throw"&&Ee.iterator.return&&(ye.method="return",ye.arg=D,Pe(Ee,ye),ye.method==="throw")||Ae!=="return"&&(ye.method="throw",ye.arg=new TypeError("The iterator does not provide a '"+Ae+"' method")),Xe;var _e=U(Ie,Ee.iterator,ye.arg);if(_e.type==="throw")return ye.method="throw",ye.arg=_e.arg,ye.delegate=null,Xe;var h=_e.arg;return h?h.done?(ye[Ee.resultName]=h.value,ye.next=Ee.nextLoc,ye.method!=="return"&&(ye.method="next",ye.arg=D),ye.delegate=null,Xe):h:(ye.method="throw",ye.arg=new TypeError("iterator result is not an object"),ye.delegate=null,Xe)}function Xr(Ee){var ye={tryLoc:Ee[0]};1 in Ee&&(ye.catchLoc=Ee[1]),2 in Ee&&(ye.finallyLoc=Ee[2],ye.afterLoc=Ee[3]),this.tryEntries.push(ye)}function N(Ee){var ye=Ee.completion||{};ye.type="normal",delete ye.arg,Ee.completion=ye}function Wr(Ee){this.tryEntries=[{tryLoc:"root"}],Ee.forEach(Xr,this),this.reset(!0)}function kr(Ee){if(Ee||Ee===""){var ye=Ee[_];if(ye)return ye.call(Ee);if(typeof Ee.next=="function")return Ee;if(!isNaN(Ee.length)){var Ae=-1,Ie=function _e(){for(;++Ae<Ee.length;)if(I.call(Ee,Ae))return _e.value=Ee[Ae],_e.done=!1,_e;return _e.value=D,_e.done=!0,_e};return Ie.next=Ie}}throw new TypeError(j(Ee)+" is not iterable")}return Ue.prototype=Re,C(pr,"constructor",{value:Re,configurable:!0}),C(Re,"constructor",{value:Ue,configurable:!0}),Ue.displayName=z(Re,V,"GeneratorFunction"),B.isGeneratorFunction=function(Ee){var ye=typeof Ee=="function"&&Ee.constructor;return!!ye&&(ye===Ue||(ye.displayName||ye.name)==="GeneratorFunction")},B.mark=function(Ee){return Object.setPrototypeOf?Object.setPrototypeOf(Ee,Re):(Ee.__proto__=Re,z(Ee,V,"GeneratorFunction")),Ee.prototype=Object.create(pr),Ee},B.awrap=function(Ee){return{__await:Ee}},rr(tr.prototype),z(tr.prototype,T,function(){return this}),B.AsyncIterator=tr,B.async=function(Ee,ye,Ae,Ie,_e){_e===void 0&&(_e=Promise);var h=new tr(M(Ee,ye,Ae,Ie),_e);return B.isGeneratorFunction(ye)?h:h.next().then(function(He){return He.done?He.value:h.next()})},rr(pr),z(pr,V,"Generator"),z(pr,_,function(){return this}),z(pr,"toString",function(){return"[object Generator]"}),B.keys=function(Ee){var ye=Object(Ee),Ae=[];for(var Ie in ye)Ae.push(Ie);return Ae.reverse(),function _e(){for(;Ae.length;){var h=Ae.pop();if(h in ye)return _e.value=h,_e.done=!1,_e}return _e.done=!0,_e}},B.values=kr,Wr.prototype={constructor:Wr,reset:function(ye){if(this.prev=0,this.next=0,this.sent=this._sent=D,this.done=!1,this.delegate=null,this.method="next",this.arg=D,this.tryEntries.forEach(N),!ye)for(var Ae in this)Ae.charAt(0)==="t"&&I.call(this,Ae)&&!isNaN(+Ae.slice(1))&&(this[Ae]=D)},stop:function(){this.done=!0;var ye=this.tryEntries[0].completion;if(ye.type==="throw")throw ye.arg;return this.rval},dispatchException:function(ye){if(this.done)throw ye;var Ae=this;function Ie(nt,lt){return He.type="throw",He.arg=ye,Ae.next=nt,lt&&(Ae.method="next",Ae.arg=D),!!lt}for(var _e=this.tryEntries.length-1;_e>=0;--_e){var h=this.tryEntries[_e],He=h.completion;if(h.tryLoc==="root")return Ie("end");if(h.tryLoc<=this.prev){var We=I.call(h,"catchLoc"),or=I.call(h,"finallyLoc");if(We&&or){if(this.prev<h.catchLoc)return Ie(h.catchLoc,!0);if(this.prev<h.finallyLoc)return Ie(h.finallyLoc)}else if(We){if(this.prev<h.catchLoc)return Ie(h.catchLoc,!0)}else{if(!or)throw new Error("try statement without catch or finally");if(this.prev<h.finallyLoc)return Ie(h.finallyLoc)}}}},abrupt:function(ye,Ae){for(var Ie=this.tryEntries.length-1;Ie>=0;--Ie){var _e=this.tryEntries[Ie];if(_e.tryLoc<=this.prev&&I.call(_e,"finallyLoc")&&this.prev<_e.finallyLoc){var h=_e;break}}h&&(ye==="break"||ye==="continue")&&h.tryLoc<=Ae&&Ae<=h.finallyLoc&&(h=null);var He=h?h.completion:{};return He.type=ye,He.arg=Ae,h?(this.method="next",this.next=h.finallyLoc,Xe):this.complete(He)},complete:function(ye,Ae){if(ye.type==="throw")throw ye.arg;return ye.type==="break"||ye.type==="continue"?this.next=ye.arg:ye.type==="return"?(this.rval=this.arg=ye.arg,this.method="return",this.next="end"):ye.type==="normal"&&Ae&&(this.next=Ae),Xe},finish:function(ye){for(var Ae=this.tryEntries.length-1;Ae>=0;--Ae){var Ie=this.tryEntries[Ae];if(Ie.finallyLoc===ye)return this.complete(Ie.completion,Ie.afterLoc),N(Ie),Xe}},catch:function(ye){for(var Ae=this.tryEntries.length-1;Ae>=0;--Ae){var Ie=this.tryEntries[Ae];if(Ie.tryLoc===ye){var _e=Ie.completion;if(_e.type==="throw"){var h=_e.arg;N(Ie)}return h}}throw new Error("illegal catch attempt")},delegateYield:function(ye,Ae,Ie){return this.delegate={iterator:kr(ye),resultName:Ae,nextLoc:Ie},this.method==="next"&&(this.arg=D),Xe}},B}he.exports=L,he.exports.__esModule=!0,he.exports.default=he.exports},73738:he=>{function ae(y){"@babel/helpers - typeof";return he.exports=ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},he.exports.__esModule=!0,he.exports.default=he.exports,ae(y)}he.exports=ae,he.exports.__esModule=!0,he.exports.default=he.exports},54756:(he,ae,y)=>{var j=y(4633)();he.exports=j;try{regeneratorRuntime=j}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=j:Function("r","regeneratorRuntime = r")(j)}}}]);

//# sourceMappingURL=7166.480da6892ee84ee8bb53.js.map