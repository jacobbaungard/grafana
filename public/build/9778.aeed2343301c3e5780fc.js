(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9778],{76287:(G,I,e)=>{"use strict";e.d(I,{p:()=>s});var t=e(96540),n=e(94841);function s(r){const{children:o,instanceSettings:m}=r,l=(0,t.useMemo)(()=>({instanceSettings:m,meta:m.meta}),[m]);return t.createElement(n.o.Provider,{value:l},o)}},94841:(G,I,e)=>{"use strict";e.d(I,{o:()=>n});var t=e(96540);const n=(0,t.createContext)(void 0)},13834:(G,I,e)=>{"use strict";e.d(I,{a:()=>s});var t=e(96540),n=e(94841);function s(r){const{children:o,...m}=r;return t.createElement(n.o.Provider,{value:m},o)}},95187:(G,I,e)=>{"use strict";e.d(I,{S:()=>t});function t(n){return"instanceSettings"in n&&"meta"in n}},92470:(G,I,e)=>{"use strict";e.d(I,{Q:()=>s});var t=e(96540),n=e(94841);function s(){const r=(0,t.useContext)(n.o);if(!r)throw new Error("usePluginContext must be used within a PluginContextProvider");return r}},33948:(G,I,e)=>{"use strict";e.d(I,{I:()=>r,f:()=>s});var t=e(11261),n=e(14236);class s{constructor(i,u){return this.fields=[],this.length=0,r(i,u)}}function r(l,i){const u={fields:[],length:l.length};if(!l?.length)return u;if(i){if(!m(l))throw new Error("source is not an array of objects");for(const p of i)u.fields.push(o(p,l.map(c=>c&&c[p])));return u}if(l.find(p=>p)===null)return u;if(m(l)){const p=l.find(c=>c);u.fields=Object.keys(p||{}).map(c=>o(c,l.map(y=>y&&y[c])))}else u.fields.push(o(t.Bc,l));return u}function o(l,i){const u={name:l,config:{},values:i,type:t.PU.other};return u.type=(0,n.dF)(u)??t.PU.other,u}function m(l){const i=l.find(u=>u);return l.length>0&&typeof i=="object"}},33526:(G,I,e)=>{"use strict";e.d(I,{x:()=>s});var t=e(36120),n=e(37471);class s extends n.k{constructor(o){super(void 0,m=>new t.$({...o,buffer:m}))}}},89667:(G,I,e)=>{"use strict";e.d(I,{EL:()=>o,Nw:()=>i,or:()=>l,t:()=>r});var t=e(11261),n=e(14236);const s={Inf:1/0,NegInf:-1/0,Undef:void 0,NaN:NaN};function r(u,d){let p;for(p in u){const c=s[p];for(const y of u[p])y<d.length&&(d[y]=c)}}function o(u,d){for(let p=0;p<d.length;p++)d[p]=u[Number(d[p])]}function m(u,d){for(const p of d)if(p!=null)return(0,n.by)(u,p);return t.PU.other}function l(u){const{schema:d,data:p}=u;if(!d||!d.fields)throw new Error("JSON needs a fields definition");const c=p?p.values.reduce((f,P)=>Math.max(f,P.length),0):0,y=d.fields.map((f,P)=>{let a=p?p.values[P]:[],E=a.length,g=f.type;E!==c&&(a.length=c,a.fill(void 0,E));let h=p?.entities?.[P];h&&r(h,a);let D=p?.enums?.[P];D&&(o(D,a),g=t.PU.string);const v=p?.nanos?.[P],C={...f,type:g??m(f.name,a),config:f.config??{},values:a,entities:h??{}};return v!=null&&(C.nanos=v),C});return{...d,fields:y,length:c}}function i(u){const d={values:[]},p=[];let c=!1;const y={refId:u.refId,meta:u.meta,name:u.name,fields:u.fields.map(f=>{const{values:P,nanos:a,state:E,display:g,...h}=f;return"entities"in h&&delete h.entities,d.values.push(P),a!=null?(p.push(a),c=!0):p.push(null),h})};return c&&(d.nanos=p),{schema:y,data:d}}},78368:(G,I,e)=>{"use strict";e.d(I,{R:()=>n});var t=e(18008);class n extends t.F{constructor(r){super(),this.data=r,this.index=0;const o={},m={};for(let l=0;l<r.fields.length;l++){const i=r.fields[l];if(!i.name)continue;m[i.name]=i;const u=()=>i.values.get(this.index);o.hasOwnProperty(i.name)||Object.defineProperty(o,i.name,{enumerable:!0,get:u}),o.hasOwnProperty(l.toString())||Object.defineProperty(o,l,{enumerable:!1,get:u})}this.obj=o,this.fields=m}get dataFrame(){return this.data}get length(){return this.data.length}getFieldDisplayProcessor(r){if(!this.dataFrame||!this.dataFrame.fields)return;const o=this.dataFrame.fields[r];if(!(!o||!o.display))return o.display}get(r){return this.index=r,this.obj}toArray(){return new Array(this.data.length).fill(0).map((r,o)=>({...this.get(o)}))}}},85404:(G,I,e)=>{"use strict";e.d(I,{L:()=>s});var t=e(11261),n=e(14236);class s{constructor(o){this.fields=[],this.fieldByName={},this.fieldByType={},this.fields=o.fields.map((m,l)=>({...m,index:l}));for(let m=0;m<o.fields.length;m++){const l=o.fields[m];if(l.type===t.PU.other){const i=(0,n.dF)(l);i&&(l.type=i)}this.fieldByType[l.type]||(this.fieldByType[l.type]=[]),this.fieldByType[l.type].push({...l,index:m}),this.fieldByName[l.name]?console.warn("Duplicate field names in DataFrame: ",l.name):this.fieldByName[l.name]={...l,index:m}}}getFields(o){if(!o)return[...this.fields];const m=this.fieldByType[o];return m?[...m]:[]}hasFieldOfType(o){const m=this.fieldByType[o];return m&&m.length>0}getFirstFieldOfType(o,m=!1){return this.fieldByType[o]?.find(u=>m||!u.config.custom?.hidden)}hasFieldNamed(o){return!!this.fieldByName[o]}hasFieldWithNameAndType(o,m){return!!this.fieldByName[o]&&this.fieldByType[m].filter(l=>l.name===o).length>0}getFieldByName(o){return this.fieldByName[o]}getFieldsByLabel(o,m){return Object.values(this.fieldByName).filter(l=>l.labels&&l.labels[o]===m)}}},37471:(G,I,e)=>{"use strict";e.d(I,{p:()=>m,k:()=>l});var t=e(2543),n=e(11261),s=e(14236);function r(i,u){return u.type||(u.name==="time"||u.name==="Time"?u.type=n.PU.time:u.type=(0,s.HW)(i)),u.type===n.PU.number?d=>parseFloat(d):u.type===n.PU.boolean?d=>!(d[0]==="F"||d[0]==="f"||d[0]==="0"):d=>d}var o=e(18008);const m=void 0;class l extends o.F{constructor(u,d){if(super(),this.fields=[],this.first=[],this.parsers=void 0,this.creator=d||(p=>p??[]),u){const{name:p,refId:c,meta:y,fields:f}=u;if(p&&(this.name=p),c&&(this.refId=c),y&&(this.meta=y),f)for(const P of f)this.addField(P)}Object.defineProperty(this,"length",{enumerable:!0,get:()=>this.first.length})}get length(){return this.first.length}addFieldFor(u,d){return this.addField({name:d||"",type:(0,s.HW)(u)})}addField(u,d){let p;u.values&&(p=u.values);let c=u.type;!c&&(u.name==="time"||u.name==="Time")?c=n.PU.time:(!c&&p&&p.length&&(c=(0,s.HW)(p[0])),c||(c=n.PU.other));let y=u.name;y||(y=`Field ${this.fields.length+1}`);const f={...u,name:y,type:c,config:u.config||{},values:this.creator(p)};if(c===n.PU.other&&(c=(0,s.dF)(f),c&&(f.type=c)),this.fields.push(f),this.first=this.fields[0].values,d)for(;f.values.length<d;)f.values.push(m);else this.validate();return f}validate(){const u=this.fields.reduce((d,p)=>Math.max(d,p.values.length),0);for(const d of this.fields)for(;d.values.length!==u;)d.values.push(m)}setParser(u,d){return this.parsers||(this.parsers=new Map),this.parsers.set(u,d),d}parseValue(u,d){let p=this.parsers?.get(u);return p||(p=this.setParser(u,r(d,u))),p(d)}appendRow(u){for(let d=this.fields.length;d<u.length;d++)this.addField({name:`Field ${d+1}`,type:(0,s.HW)(u[d])});if(this.length<1)for(let d=0;d<this.fields.length;d++){const p=this.fields[d];(!p.type||p.type===n.PU.other)&&(p.type=(0,s.HW)(u[d]))}for(let d=0;d<this.fields.length;d++){const p=this.fields[d];let c=u[d];p.type!==n.PU.string&&(0,t.isString)(c)&&(c=this.parseValue(p,c)),p.values.push(c)}}push(...u){for(const d of u)this.add(d);return this.length}reverse(){for(const u of this.fields)u.values.reverse();return this}add(u){const d=u;for(const p of this.fields){let c=d[p.name];p.type!==n.PU.string&&(0,t.isString)(c)&&(c=this.parseValue(p,c)),c===void 0&&(c=m),p.values.push(c)}}set(u,d){if(u>this.length)throw new Error("Unable to set value beyond current length");const p=d||{};for(const c of this.fields)c.values[u]=p[c.name]}get(u){const d={};for(const p of this.fields)d[p.name]=p.values[u];return d}toJSON(){return(0,s.Kl)(this)}}},9631:(G,I,e)=>{"use strict";e.d(I,{Kh:()=>l,Ls:()=>y,k9:()=>d,m8:()=>p,wC:()=>P});var t=e(11261),n=e(8249),s=e(73060),r=e(43659),o=e(14236),m=e(89667),l=(D=>(D.Append="append",D.Replace="replace",D))(l||{});const i="__name__";var u=(D=>(D[D.wide=0]="wide",D[D.labels=1]="labels",D))(u||{});class d{constructor(v){this.options=v,this.meta={},this.fields=[],this.length=0,this.schemaFields=[],this.timeFieldIndex=-1,this.pushMode=0,this.labels=new Set,this.packetInfo={schemaChanged:!0,number:0,action:"replace",length:0},this.serialize=(C,T,S)=>{const O=T?Object.assign({},{...this.options,...T}):this.options,x=(0,o.By)(this,C),b=g(x.fields.map(A=>A.values??[]),typeof S?.maxLength=="number"?Math.min(S.maxLength,O.maxLength):O.maxLength,this.timeFieldIndex,O.maxDelta);x.fields=x.fields.map(A=>({...A,values:A.values?.slice(b)}));const M=x.fields[0]?.values?.length??0;return{...x,labels:this.labels,schemaFields:this.schemaFields,name:this.name,refId:this.refId,meta:this.meta,length:M,timeFieldIndex:this.timeFieldIndex,pushMode:this.pushMode,packetInfo:this.packetInfo,options:O}},this.initFromSerialized=C=>{this.name=C.name,this.refId=C.refId,this.meta=C.meta,this.length=C.length,this.labels=C.labels,this.schemaFields=C.schemaFields,this.timeFieldIndex=C.timeFieldIndex,this.pushMode=C.pushMode,this.packetInfo.length=C.packetInfo.length,this.packetInfo.number=C.packetInfo.number,this.packetInfo.action="replace",this.packetInfo.schemaChanged=!0,this.fields=C.fields.map(T=>({...T,type:T.type??t.PU.other,config:T.config??{},values:T.values??[]})),E(this.fields.map(T=>T.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)},this.needsResizing=({maxLength:C,maxDelta:T})=>{const S=C&&this.options.maxLength<C,O=T&&this.options.maxDelta<T,x=T&&this.options.maxDelta===1/0;return!!(S||O||x)},this.resize=({maxLength:C,maxDelta:T})=>{T&&(this.options.maxDelta===1/0?this.options.maxDelta=T:this.options.maxDelta=Math.max(T,this.options.maxDelta)),this.options.maxLength=Math.max(this.options.maxLength,C??0)},this.pushNewValues=C=>{if(!C?.length)return;this.packetInfo.action=this.options.action,this.packetInfo.number++,this.packetInfo.length=C[0].length,this.packetInfo.schemaChanged=!1,this.options.action==="append"?a(this.fields.map(S=>S.values),C,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta):(C.forEach((S,O)=>{this.fields[O]&&(this.fields[O].values=S)}),E(this.fields.map(S=>S.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta));const T=this.fields?.[0]?.values.length;T!==void 0&&(this.length=T)},this.resetStateCalculations=()=>{this.fields.forEach(C=>{C.state={...C.state??{},calcs:void 0,range:void 0}})},this.getMatchingFieldIndexes=C=>this.fields.map((T,S)=>C(T)?S:void 0).filter(T=>T!==void 0),this.getValuesFromLastPacket=()=>this.fields.map(C=>{const T=C.values;return T.slice(Math.max(T.length-this.packetInfo.length))}),this.hasAtLeastOnePacket=()=>!!this.packetInfo.length,this.getOptions=()=>this.options,Object.defineProperty(this,"length",{enumerable:!0}),Object.defineProperty(this,"fields",{enumerable:!0})}static{this.deserialize=v=>{const C=new d(v.options);return C.initFromSerialized(v),C}}static{this.empty=v=>new d(p(v))}static{this.fromDataFrameJSON=(v,C)=>{const T=new d(p(C));return T.push(v),T}}get alwaysReplace(){return this.options.action==="replace"}push(v){const{schema:C,data:T}=v;if(this.packetInfo.number++,this.packetInfo.length=0,this.packetInfo.schemaChanged=!1,C){this.pushMode=0,this.timeFieldIndex=C.fields.findIndex(b=>b.type===t.PU.time);const S=C.fields[0];this.timeFieldIndex===1&&S.type===t.PU.string&&(S.name==="labels"||S.name==="Labels")&&(this.pushMode=1,this.timeFieldIndex=0);const O=this.pushMode===1?C.fields.slice(1):C.fields;this.refId=C.refId,C.meta&&(this.meta={...C.meta});const{displayNameFormat:x}=this.options;if(h(this.schemaFields,O)){const b=O.length;this.fields.forEach((M,A)=>{const R=O[A%b];M.config=R.config??{},M.labels=R.labels}),x&&this.fields.forEach(M=>{const A={[i]:M.name,...M.labels};M.config.displayNameFromDS=(0,r.j)(x,A)})}else{this.packetInfo.schemaChanged=!0;const b=this.pushMode===0;this.fields=O.map(M=>{const A=M.config??{};if(x){const R={[i]:M.name,...M.labels};A.displayNameFromDS=(0,r.j)(x,R)}return{config:A,name:M.name,labels:M.labels,type:M.type??t.PU.other,values:b?this.fields.find(R=>R.name===M.name&&M.type===R.type)?.values??Array(this.length).fill(void 0):[]}})}this.schemaFields=O}if(T&&T.values.length&&T.values[0].length){let{values:S,entities:O}=T;if(O&&O.forEach((b,M)=>{b&&(0,m.t)(b,S[M])}),this.pushMode===1){const b=c(S);for(const R of b.keys())this.labels.has(R)||(this.packetInfo.schemaChanged=!0,this.addLabel(R));let M=Array(this.schemaFields.length).fill([]),A=[];this.labels.forEach(R=>{A.push(b.get(R)??M)}),S=(0,s.fj)(A)}if(S.length!==this.fields.length){if(this.fields.length)throw new Error(`push message mismatch.  Expected: ${this.fields.length}, received: ${S.length} (labels=${this.pushMode===1})`);this.fields=S.map((b,M)=>{let A=`Field ${M}`,R=(0,o.HW)(b[0]);return M===0&&R===t.PU.number&&b[0]>1600016688632&&(R=t.PU.time,A="Time"),{name:A,type:R,config:{},values:[]}})}let x=S;this.packetInfo.length=S[0].length,this.alwaysReplace||!this.length?this.packetInfo.action="replace":(this.packetInfo.action="append",x=this.fields.map(b=>b.values),a(x,S,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)),x.forEach((b,M)=>{const A=this.fields[M],{state:R}=A;A.values=b,R&&(R.calcs=void 0)}),this.length=x[0].length}return{...this.packetInfo}}addLabel(v){const{displayNameFormat:C}=this.options,T=this.labels.size,S=f(v);if(T===0)this.fields.forEach((O,x)=>{if(x>0&&(O.labels=S,C)){const b={[i]:O.name,...S};O.config.displayNameFromDS=(0,r.j)(C,b)}});else for(let O=1;O<this.schemaFields.length;O++){let x=this.schemaFields[O];const b=x.config??{};if(C){const M={[i]:x.name,...S};b.displayNameFromDS=(0,r.j)(C,M)}this.fields.push({...x,config:b,labels:S,values:Array(this.length).fill(void 0)})}this.labels.add(v)}}function p(D){return{maxLength:D?.maxLength??1e3,maxDelta:D?.maxDelta??1/0,action:D?.action??"append",displayNameFormat:D?.displayNameFormat}}function c(D){let v=new Set(D[0]),C=new Map;v.forEach(T=>{let S=Array(D.length-1).fill(null).map(()=>[]);C.set(T,S)});for(let T=0;T<D[0].length;T++){let S=C.get(D[0][T]);for(let O=1;O<D.length;O++)S[O-1].push(D[O][T])}return C}function y(D,v,C,T){let S;C=C||0,T=T||v.length-1;let O=T<=2147483647;for(;T-C>1;)S=O?C+T>>1:Math.floor((C+T)/2),v[S]<D?C=S:T=S;return D-v[C]<=v[T]-D?C:T}function f(D){if(!D.length)return{};if(D.charAt(0)==="{")return(0,n.Xy)(D);const v={};return D.split(",").forEach(C=>{const[T,S]=C.trim().split("=");v[T]=S}),v}function P(D){const v=D.packetInfo;return v?.action?v:void 0}function a(D,v,C=1/0,T=0,S=1/0){for(let O=0;O<D.length;O++)for(let x=0;x<v[O].length;x++)D[O].push(v[O][x]);return E(D,C,T,S)}function E(D,v=1/0,C=0,T=1/0){const S=g(D,v,C,T);if(S)for(let O=0;O<D.length;O++)D[O].splice(0,S);return S}function g(D,v=1/0,C=0,T=1/0){if(!D[0]?.length)return 0;const S=D[0].length;let O=0;if(S>v&&(O=S-v),T!==1/0&&C>=0){const x=D[C],b=x[O],M=x[S-1];M-b>T&&(O=y(M-T,x,O))}return O}function h(D,v){if(D?.length!==v.length)return!1;for(let C=0;C<D.length;C++){const T=D[C],S=v[C];if(T.name!==S.name||T.type!==S.type)return!1}return!0}},61443:(G,I,e)=>{"use strict";e.d(I,{Km:()=>o,P4:()=>s,WK:()=>r,g6:()=>n,r4:()=>t,xB:()=>m});const t=(l,i)=>({name:l,columns:i}),n=l=>l.columns,s=(l,i)=>l.columns[i],r=(l,i,u)=>l.columns[i].values[u],o=(l,i,u)=>l.columns.map(d=>d.values[u]),m=(l,i)=>l[i]},21423:(G,I,e)=>{"use strict";e.d(I,{J3:()=>r,ab:()=>m,bW:()=>s});var t=e(2543),n=e.n(t);function s(l,i,u){if(l===i)return!0;if(l?.fields?.length!==i?.fields?.length||l.name!==i.name)return!1;for(let d=0;d<l.fields.length;d++){const p=l.fields[d],c=i.fields[d];if(p.type!==c.type||p.name!==c.name)return!1;if(u)continue;if(p.labels&&c.labels&&!m(p.labels,c.labels))return!1;const y=p.config,f=c.config;if(Object.keys(y).length!==Object.keys(f).length)return!1;let P;for(P in y){if(!(P in f))return!1;if(P!=="interval"&&!(0,t.isEqual)(y[P],f[P]))return!1}}return!0}function r(l,i,u){if(l===i)return!0;if(l?.length!==i?.length)return!1;for(let d=0;d<l.length;d++)if(!u(l[d],i[d]))return!1;return!0}const o=(l,i)=>l===i;function m(l,i,u=o){if(l===i)return!0;if(Object.keys(l).length!==Object.keys(i).length)return!1;let d;for(d in l)if(!u(l[d],i[d]))return!1;return!0}},48120:(G,I,e)=>{"use strict";e.d(I,{Bt:()=>r.Bt,By:()=>r.By,EI:()=>r.EI,EL:()=>l.EL,ES:()=>r.ES,HW:()=>r.HW,Ij:()=>m.I,J3:()=>i.J3,KR:()=>r.KR,Kh:()=>d.Kh,Kl:()=>r.Kl,Km:()=>o.Km,LI:()=>r.LI,Lc:()=>n.L,Ls:()=>d.Ls,N$:()=>r.N$,Nw:()=>l.Nw,P4:()=>o.P4,Rh:()=>t.R,S1:()=>u.S1,Vc:()=>r.Vc,WK:()=>o.WK,XQ:()=>r.XQ,Yn:()=>r.Yn,aH:()=>u.aH,ab:()=>i.ab,bW:()=>i.bW,by:()=>r.by,ci:()=>r.ci,dF:()=>r.dF,fG:()=>m.f,g6:()=>o.g6,hF:()=>u.hF,jq:()=>u.jq,k2:()=>s.k,k9:()=>d.k9,oE:()=>r.oE,or:()=>l.or,pH:()=>r.pH,pk:()=>s.p,q7:()=>r.q7,r4:()=>o.r4,t:()=>l.t,t9:()=>u.t9,tP:()=>u.tP,uY:()=>u.uY,w3:()=>r.w3,xB:()=>o.xB});var t=e(78368),n=e(85404),s=e(37471),r=e(14236),o=e(61443),m=e(33948),l=e(89667),i=e(21423),u=e(19845),d=e(9631)},14236:(G,I,e)=>{"use strict";e.d(I,{Bt:()=>U,By:()=>A,EI:()=>N,ES:()=>O,HW:()=>E,KR:()=>R,Kl:()=>M,LI:()=>C,N$:()=>W,Vc:()=>T,XQ:()=>h,Yn:()=>b,by:()=>P,ci:()=>v,dF:()=>g,oE:()=>a,pH:()=>D,q7:()=>x,w3:()=>S});var t=e(2543),n=e.n(t),s=e(47232),r=e(48241),o=e(28240),m=e(11261),l=e(39070),i=e(33948),u=e(89667);function d(w){const L=w.columns.map(V=>{const{text:K,type:k,...j}=V,H=[];return{name:K?.length?K:V,config:j||{},values:H,type:k&&Object.values(m.PU).includes(k)?k:m.PU.other}});if(!(0,t.isArray)(w.rows))throw new Error(`Expected table rows to be array, got ${typeof w.rows}.`);for(const V of w.rows)for(let K=0;K<L.length;K++)L[K].values.push(V[K]);for(const V of L)if(V.type===m.PU.other){const K=g(V);K&&(V.type=K)}return{fields:L,refId:w.refId,meta:w.meta,name:w.name,length:w.rows.length}}function p(w){const L=[],V=[],K=w.datapoints||w.points;for(const j of K)V.push(j[0]),L.push(j[1]);const k=[{name:m.LE,type:m.PU.time,config:{},values:L},{name:m.Bc,type:m.PU.number,config:{unit:w.unit},values:V,labels:w.tags}];return w.title&&(k[1].config.displayNameFromDS=w.title),{name:w.target||w.name,refId:w.refId,meta:w.meta,fields:k,length:V.length}}function c(w){const L=[],V=[];for(let K=0;K<w.data.length;K++){const k=w.data[K];L.push(k[1]),V.push(k[0])}return{name:w.label,fields:[{name:w.label||m.Bc,type:m.PU.number,config:{},values:L},{name:m.LE,type:m.PU.time,config:{unit:"dateTimeAsIso"},values:V}],length:L.length}}function y(w){const L=[{name:w.target,type:m.PU.other,labels:w.tags,config:{unit:w.unit,filterable:w.filterable},values:[]}];for(const V of w.datapoints)L[0].values.push(V);return{name:w.target,refId:w.target,meta:{json:!0},fields:L,length:w.datapoints.length}}const f=/^\s*(-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?|NAN)\s*$/i;function P(w,L){return w&&(w=w.toLowerCase(),w==="date"||w==="time")?m.PU.time:E(L)}function a(w){return w instanceof Date||(0,s.Ar)(w)?m.PU.time:(0,t.isNumber)(w)?m.PU.number:(0,t.isString)(w)?m.PU.string:(0,t.isBoolean)(w)?m.PU.boolean:m.PU.other}function E(w){return w instanceof Date||(0,s.Ar)(w)?m.PU.time:(0,t.isNumber)(w)?m.PU.number:(0,t.isString)(w)?f.test(w)?m.PU.number:w==="true"||w==="TRUE"||w==="True"||w==="false"||w==="FALSE"||w==="False"?m.PU.boolean:m.PU.string:(0,t.isBoolean)(w)?m.PU.boolean:m.PU.other}function g(w){if(w.name){const L=w.name.toLowerCase();if(L==="date"||L==="time")return m.PU.time}for(let L=0;L<w.values.length;L++){const V=w.values[L];if(V!=null)return E(V)}}const h=(w,L=!1)=>{for(const V of w.fields)if(!V.type||V.type===m.PU.other||L)return{...w,fields:w.fields.map(K=>K.type&&K.type!==m.PU.other&&!L?K:{...K,type:g(K)||m.PU.other})};return w},D=w=>!!(w&&w.hasOwnProperty("columns")),v=w=>!!(w&&w.hasOwnProperty("fields")),C=w=>!!(v(w)&&w.hasOwnProperty("value"));function T(w){if("fields"in w)return"length"in w&&w.fields[0]?.values?.get?w:N(w);if(w.hasOwnProperty("type")&&w.type==="docs")return y(w);if(w.hasOwnProperty("datapoints")||w.hasOwnProperty("points"))return p(w);if(w.hasOwnProperty("data"))return w.hasOwnProperty("schema")?(0,u.or)(w):c(w);if(w.hasOwnProperty("columns"))return d(w);if(Array.isArray(w))return(0,i.I)(w);throw console.warn("Can not convert",w),new Error("Unsupported data format")}const S=w=>{const{fields:L}=w,V=w.length,K=[];if(L.length===2){const{timeField:k,timeIndex:j}=R(w);if(k){const J=L[j===0?1:0],X=L[j];for(let se=0;se<V;se++)K.push([J.values[se],X.values[se]]);return{alias:w.name,target:(0,o.Ct)(J,w),datapoints:K,unit:L[0].config?L[0].config.unit:void 0,refId:w.refId,meta:w.meta}}}for(let k=0;k<V;k++){const j=[];for(let H=0;H<L.length;H++)j.push(L[H].values[k]);K.push(j)}return w.meta&&w.meta.json?{alias:L[0].name||w.name,target:L[0].name||w.name,datapoints:L[0].values,filterable:L[0].config?L[0].config.filterable:void 0,type:"docs"}:{columns:L.map(k=>{const{name:j,config:H}=k;if(H){const{...J}=H;return J.text=j,J}return{text:j}}),type:"table",refId:w.refId,meta:w.meta,rows:K}};function O(w,L,V=!1){const K=w.fields[L];if(!K)return w;const k=[];for(let H=0;H<w.length;H++)k.push(H);const j=(0,r.i)(K,V);return k.sort(j),{...w,fields:w.fields.map(H=>{const J={...H,values:H.values.map((se,ae)=>H.values[k[ae]])},{nanos:X}=H;return X!==void 0&&(J.nanos=X.map((se,ae)=>X[k[ae]])),J})}}function x(w){return{...w,fields:w.fields.map(L=>{const V=[...L.values];V.reverse();const K={...L,values:V},{nanos:k}=L;if(k!==void 0){const j=[...k];j.reverse(),K.nanos=j}return K})}}function b(w,L){const V=[];for(const K of w.fields)V.push(K.values[L]);return V}function M(w){return A(w)}function A(w,L){return{fields:(L?w.fields.filter(L):w.fields).map(k=>{let j=k.values;return{name:k.name,type:k.type,config:k.config,values:j,labels:k.labels}}),refId:w.refId,meta:w.meta,name:w.name}}const R=w=>{for(let L=0;L<w.fields.length;L++)if(w.fields[L].type===m.PU.time)return{timeField:w.fields[L],timeIndex:L};return{}};function B(w){const L=h(T(w));if(L.fields&&L.fields.length)for(const V of L.fields)V.state=null;return L}function U(w){return!w||!(0,t.isArray)(w)?[]:w.map(L=>B(L))}function W(w,L){const{series:V,annotations:K}=w;if(w.state===l.Gu.Loading&&V.length===0)return L||(L=w),{...L,state:l.Gu.Loading,request:w.request};const k=performance.now(),j=V.map(X=>B(X)),H=U(K),J=performance.now();return{...w,series:j,annotations:H,timings:{dataProcessingTime:J-k}}}function N(w){let L=0;const V=w.fields.map((K,k)=>{const{state:j,...H}=K;return H.name||(H.name=`Field ${k+1}`),H.config||(H.config={}),H.values?H.values.length>L&&(L=H.values.length):H.values=new Array(L),H.type||(H.type=g(H)??m.PU.other),H});return{...w,fields:V,length:L}}},19845:(G,I,e)=>{"use strict";e.d(I,{S1:()=>i,aH:()=>r,hF:()=>m,jq:()=>o,t9:()=>u,tP:()=>l,uY:()=>d});var t=e(11261),n=e(14236);const s=100;function r(p){if(p.fields.length<2)return!1;const c=p.fields.find(f=>f.type===t.PU.number);let y=!1;for(const f of p.fields)if(m(f)){y=!0;break}return y&&c!==void 0}function o(p){return!p.find(c=>!r(c))}function m(p){if(p.type!==t.PU.time)return!1;let c=null,y=p.values.length>s?s:p.values.length;for(let f=0;f<y;f++){const P=p.values[f];if(c===null||P!==null&&P>c)c=P;else return!1}return!0}function l(p){for(let c=0;c<p.length;c++){const y=(0,n.KR)(p[c]);if(y.timeField!==void 0&&y.timeIndex!==void 0)return!0}return!1}function i(p){return p.fields.some(c=>c.type===t.PU.time)}function u(p,c){if(p.meta?.uniqueRowIdFields!==void 0)return p.meta.uniqueRowIdFields.map(y=>p.fields[y].values[c]).join("-")}function d(p,c){if(c instanceof Array)for(let y=0;y<c.length;y++)p.fields[y].values.push(c[y]);else for(const y of p.fields)y.values.push(c[y.name]);try{p.length++}catch{}}},1933:(G,I,e)=>{"use strict";e.d(I,{G:()=>o,O:()=>m});var t=e(2543),n=e.n(t),s=e(43127);let r=()=>s.lE;const o=l=>{r=l??r},m=l=>l?.timeZone&&!(0,t.isEmpty)(l.timeZone)?l.timeZone:r()??s.lE},85858:(G,I,e)=>{"use strict";e.r(I),e.d(I,{isMathString:()=>o,isValid:()=>l,parse:()=>m,parseDateMath:()=>i,roundToFiscal:()=>u});var t=e(2543),n=e.n(t),s=e(47232);const r=["y","M","w","d","h","m","s","Q"];function o(d){return d?!!(typeof d=="string"&&(d.substring(0,3)==="now"||d.includes("||"))):!1}function m(d,p,c,y){if(d){if(typeof d!="string")return(0,s.Ar)(d)?d:(0,t.isDate)(d)?(0,s.KQ)(d):void 0;{let f,P="",a,E;return d.substring(0,3)==="now"?(f=(0,s.oZ)(c),P=d.substring(3)):(a=d.indexOf("||"),a===-1?(E=d,P=""):(E=d.substring(0,a),P=d.substring(a+2)),f=(0,s.KQ)(E,s.mt)),P.length?i(P,f,p,y):f}}}function l(d){const p=m(d);return p&&(0,s.Ar)(p)?p.isValid():!1}function i(d,p,c,y=0){const f=d.replace(/\s/g,""),P=(0,s.KQ)(p);let a=0;const E=f.length;for(;a<E;){const g=f.charAt(a++);let h,D,v,C=!1;if(g==="/")h=0;else if(g==="+")h=1;else if(g==="-")h=2;else return;if(isNaN(parseInt(f.charAt(a),10)))D=1;else if(f.length===2)D=parseInt(f.charAt(a),10);else{const S=a;for(;!isNaN(parseInt(f.charAt(a),10));)if(a++,a>10)return;D=parseInt(f.substring(S,a),10)}if(h===0&&D!==1)return;v=f.charAt(a++),v==="f"&&(v=f.charAt(a++),C=!0);const T=v;if((0,t.includes)(r,T))h===0?C?u(y,P,T,c):c?P.endOf(T):P.startOf(T):h===1?P.add(D,T):h===2&&P.subtract(D,T);else return}return P}function u(d,p,c,y){switch(c){case"y":return y?u(d,p,c,!1).add(11,"M").endOf("M"):p.subtract((p.month()-d+12)%12,"M").startOf("M"),p;case"Q":return y?u(d,p,c,!1).add(2,"M").endOf("M"):p.subtract((p.month()-d+12)%3,"M").startOf("M"),p;default:return}}},70416:(G,I,e)=>{"use strict";e.d(I,{E9:()=>m,Ri:()=>l,V3:()=>c,WT:()=>i,dU:()=>o,di:()=>d,pp:()=>p,vd:()=>u});var t=e(89369),n=e(68284),s=e(25579);const r={years:["y","Y","years"],months:["M","months"],weeks:["w","W","weeks"],days:["d","D","days"],hours:["h","H","hours"],minutes:["m","minutes"],seconds:["s","S","seconds"]};function o(f,P=!0){if((0,t.d)(f.start,f.end))return"";const a=(0,n.F)(f);return Object.entries(a).reduce((E,[g,h])=>h&&h!==0&&!(g==="seconds"&&!P&&E)?E+`${E!==""?" ":""}${h}${r[g][0]}`:E,"")}function m(f){return f.split(" ").reduce((P,a)=>{const E=a.match(/(\d+)(.+)/),g=E?.[1],h=E?.[2];if(!(g&&h))return P;const D=Object.entries(r).find(([C,T])=>T?.includes(E[2])),v=parseInt(g,10);return D?{...P,[D[0]]:v}:P},{})}function l(f,P){return(0,s.W)(f,P)}function i(f){const P=new Date;return l(P,f).getTime()-P.getTime()}function u(f){return!isNaN(Date.parse(f))}function d(f){for(const P of f.trim().split(" ")){const a=P.match(/(\d+)(.+)/);if(a===null||a.length!==3||!Object.entries(r).find(([g,h])=>h?.includes(a[2]))?.[0])return!1}return!0}function p(f){return y(f,["h","m","s","ms","us","\xB5s","ns"])}function c(f){return y(f,["y","M","w","d","h","m","s","ms","us","\xB5s","ns"])}function y(f,P){for(const a of f.trim().split(" ")){const E=a.match(/([0-9]*[.]?[0-9]+)(.+)/);if(E===null||E.length!==3||!P.includes(E[2]))return!1}return!0}},42994:(G,I,e)=>{"use strict";e.d(I,{JE:()=>s,Od:()=>r,WC:()=>o});const t="YYYY-MM-DD HH:mm:ss",n="YYYY-MM-DD HH:mm:ss.SSS";class s{constructor(){this.fullDate=t,this.fullDateMS=n,this.interval={millisecond:"HH:mm:ss.SSS",second:"HH:mm:ss",minute:"HH:mm",hour:"MM/DD HH:mm",day:"MM/DD",month:"YYYY-MM",year:"YYYY"}}update(i){this.fullDate=i.fullDate,this.interval=i.interval,i.useBrowserLocale&&this.useBrowserLocale()}useBrowserLocale(){this.fullDate=r({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),this.fullDateMS=this.fullDate.replace("ss","ss.SSS"),this.interval.millisecond=r({hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},null,this.interval.second).replace("ss","ss.SSS"),this.interval.second=r({hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},null,this.interval.second),this.interval.minute=r({hour:"2-digit",minute:"2-digit",hour12:!1},null,this.interval.minute),this.interval.hour=r({month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1},null,this.interval.hour),this.interval.day=r({month:"2-digit",day:"2-digit",hour12:!1},null,this.interval.day),this.interval.month=r({year:"numeric",month:"2-digit",hour12:!1},null,this.interval.month)}getTimeFieldUnit(i){return`time:${i?this.fullDateMS:this.fullDate}`}}function r(l,i,u){if(m())return u??t;!i&&navigator&&(i=[...navigator.languages]);const d=new Intl.DateTimeFormat(i||void 0,l),p=d.formatToParts(new Date),y={year:"YYYY",month:"MM",day:"DD",hour:d.resolvedOptions().hour12?"hh":"HH",minute:"mm",second:"ss",weekday:"ddd",era:"N",dayPeriod:"A",timeZoneName:"Z"};return p.map(f=>y[f.type]||f.value).join("")}const o=new s,m=()=>!("DateTimeFormat"in Intl)||!("formatToParts"in Intl.DateTimeFormat.prototype)},72724:(G,I,e)=>{"use strict";e.d(I,{LE:()=>m,M7:()=>l,_Q:()=>u,fq:()=>i,jw:()=>d});var t=e(84743),n=e.n(t),s=e(1933),r=e(42994),o=e(47232);const m=(y,f)=>c(y,(0,s.O)(f)).format(p(f)),l=(y,f)=>c(y,(0,s.O)(f)).format(),i=(y,f)=>c(y,(0,s.O)(f)).fromNow(),u=(y,f)=>c(y,(0,s.O)(f)).format(`${r.WC.fullDate} z`),d=(y,f)=>c(y,(0,s.O)(f)).format("z"),p=y=>y?.defaultWithMS?y?.format??r.WC.fullDateMS:y?.format??r.WC.fullDate,c=(y,f)=>{const P=y,a=n().tz.zone(f);if(a&&a.name)return(0,o.AN)((0,o.yT)(P)).tz(a.name);switch(f){case"utc":return(0,o.AN)((0,o.yT)(P));default:return(0,o.AN)((0,o.yT)(P)).local()}}},38698:(G,I,e)=>{"use strict";e.d(I,{$D:()=>s.$D,AN:()=>s.AN,Ah:()=>s.Ah,Ar:()=>s.Ar,E9:()=>i.E9,GZ:()=>u.G,HD:()=>r.HD,IM:()=>i.pp,Ii:()=>n,JE:()=>o.JE,JK:()=>s.JK,KQ:()=>s.KQ,LE:()=>m.LE,M7:()=>m.M7,O:()=>u.O,Od:()=>o.Od,P3:()=>r.P3,QZ:()=>r.QZ,Ri:()=>i.Ri,U3:()=>r.U3,V3:()=>i.V3,WC:()=>o.WC,WT:()=>i.WT,XN:()=>s.XN,_Q:()=>m._Q,bQ:()=>l.b,dU:()=>i.dU,di:()=>i.di,fq:()=>m.fq,g$:()=>r.g$,jw:()=>m.jw,le:()=>r.le,mt:()=>s.mt,ns:()=>t,oZ:()=>s.oZ,pp:()=>s.pp,u8:()=>s.u8,vd:()=>i.vd,xQ:()=>s.xQ,xS:()=>s.xS,yT:()=>s.yT});var t=e(85858),n=e(65879),s=e(47232),r=e(91410),o=e(42994),m=e(72724),l=e(53531),i=e(70416),u=e(1933)},47232:(G,I,e)=>{"use strict";e.d(I,{$D:()=>a,AN:()=>c,Ah:()=>d,Ar:()=>i,JK:()=>o,KQ:()=>p,XN:()=>m,mt:()=>s,oZ:()=>y,pp:()=>P,u8:()=>l,xQ:()=>f,xS:()=>r,yT:()=>u});var t=e(95093),n=e.n(t);const s=n().ISO_8601,r=E=>{n().locale(E)},o=()=>n().locale(),m=()=>n().localeData(),l=E=>E===null||typeof E=="string"||typeof E=="number"||E instanceof Date||Array.isArray(E)&&E.every(g=>typeof g=="string"||typeof g=="number")||i(E),i=E=>n().isMoment(E),u=(E,g)=>n().utc(E,g),d=(E,g)=>n().duration(E,g),p=(E,g)=>n()(E,g),c=E=>p(E),y=(E,g,h)=>{if(E&&E!=="browser"){let D;if(typeof g=="string"&&h?D=n().tz(g,h,E):D=n().tz(g,E),i(D))return D}return p(g,h)},f=E=>n().weekdays().findIndex(g=>g.toLowerCase()===E.toLowerCase()),P=E=>["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].findIndex(g=>g.toLowerCase()===E.toLowerCase()),a=E=>{const g="-weekStart",h=o().replace(g,""),D=E?P(E):-1;D!==-1?n().locale(h+g,{parentLocale:h,week:{dow:D}}):r(h)}},53531:(G,I,e)=>{"use strict";e.d(I,{b:()=>u});var t=e(2543),n=e.n(t),s=e(84743),r=e.n(s),o=e(1933),m=e(85858),l=e(42994),i=e(47232);const u=(c,y)=>(0,i.Ar)(c)?c:typeof c=="string"?d(c,y):p(c,y),d=(c,y)=>{if(c.indexOf("now")!==-1)return(0,m.isValid)(c)&&(0,m.parse)(c,y?.roundUp,y?.timeZone,y?.fiscalYearStartMonth)||(0,i.KQ)();const f=(0,o.O)(y),P=r().tz.zone(f),a=y?.format??l.WC.fullDate;if(P&&P.name)return(0,i.oZ)(P.name,c,a);switch((0,t.lowerCase)(f)){case"utc":return(0,i.yT)(c,a);default:return(0,i.KQ)(c,a)}},p=(c,y)=>{const f=c,P=(0,o.O)(y),a=r().tz.zone(P);if(a&&a.name)return(0,i.oZ)(a.name,f);switch((0,t.lowerCase)(P)){case"utc":return(0,i.yT)(f);default:return(0,i.KQ)(f)}}},65879:(G,I,e)=>{"use strict";e.r(I),e.d(I,{calculateInterval:()=>v,convertRawToRange:()=>P,describeInterval:()=>S,describeTextRange:()=>p,describeTimeRange:()=>c,describeTimeRangeAbbreviation:()=>f,intervalToMs:()=>x,intervalToSeconds:()=>O,isFiscal:()=>E,isRelativeTime:()=>a,isRelativeTimeRange:()=>g,isValidTimeSpan:()=>y,msRangeToTimeString:()=>D,relativeToTimeRange:()=>A,roundInterval:()=>b,secondsToHms:()=>h,timeRangeToRelative:()=>M});var t=e(2543),n=e.n(t),s=e(85858),r=e(72724),o=e(47232),m=e(53531);const l={s:{display:"second"},m:{display:"minute"},h:{display:"hour"},d:{display:"day"},w:{display:"week"},M:{display:"month"},y:{display:"year"}},i=[{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],u=[{from:"now",to:"now+1m",display:"Next minute"},{from:"now",to:"now+5m",display:"Next 5 minutes"},{from:"now",to:"now+15m",display:"Next 15 minutes"},{from:"now",to:"now+30m",display:"Next 30 minutes"},{from:"now",to:"now+1h",display:"Next hour"},{from:"now",to:"now+3h",display:"Next 3 hours"},{from:"now",to:"now+6h",display:"Next 6 hours"},{from:"now",to:"now+12h",display:"Next 12 hours"},{from:"now",to:"now+24h",display:"Next 24 hours"},{from:"now",to:"now+2d",display:"Next 2 days"},{from:"now",to:"now+7d",display:"Next 7 days"},{from:"now",to:"now+30d",display:"Next 30 days"},{from:"now",to:"now+90d",display:"Next 90 days"},{from:"now",to:"now+6M",display:"Next 6 months"},{from:"now",to:"now+1y",display:"Next year"},{from:"now",to:"now+2y",display:"Next 2 years"},{from:"now",to:"now+5y",display:"Next 5 years"}],d={};(0,t.each)(i,R=>{d[R.from+" to "+R.to]=R}),(0,t.each)(u,R=>{d[R.from+" to "+R.to]=R});function p(R){const B=R.indexOf("+")!==0;R.indexOf("now")===-1&&(R=(B?"now-":"now")+R);let U=d[R+" to now"];if(U)return U;B?U={from:R,to:"now",display:""}:U={from:"now",to:R,display:""};const W=/^now([-+])(\d+)(\w)/.exec(R);if(W){const N=W[3],w=parseInt(W[2],10),L=l[N];L&&(U.display=B?"Last ":"Next ",U.display+=w+" "+L.display,U.section=L.section,w>1&&(U.display+="s"))}else U.display=U.from+" to "+U.to,U.invalid=!0;return U}function c(R,B){const U=d[R.from.toString()+" to "+R.to.toString()];if(U)return U.display;const W={timeZone:B};if((0,o.Ar)(R.from)&&(0,o.Ar)(R.to))return(0,r.LE)(R.from,W)+" to "+(0,r.LE)(R.to,W);if((0,o.Ar)(R.from)){const N=s.parse(R.to,!0,"utc");return N?(0,r.LE)(R.from,W)+" to "+(0,r.fq)(N,W):""}if((0,o.Ar)(R.to)){const N=s.parse(R.from,!1,"utc");return N?(0,r.fq)(N,W)+" to "+(0,r.LE)(R.to,W):""}return R.to.toString()==="now"?p(R.from).display:R.from.toString()+" to "+R.to.toString()}const y=R=>R.indexOf("$")===0||R.indexOf("+$")===0?!0:p(R).invalid!==!0,f=(R,B)=>{if((0,o.Ar)(R.from))return(0,r.jw)(R.from,{timeZone:B});const U=s.parse(R.from,!0);return U?(0,r.jw)(U,{timeZone:B}):""},P=(R,B,U,W)=>{const N=(0,m.b)(R.from,{roundUp:!1,timeZone:B,fiscalYearStartMonth:U,format:W}),w=(0,m.b)(R.to,{roundUp:!0,timeZone:B,fiscalYearStartMonth:U,format:W});return s.isMathString(R.from)||s.isMathString(R.to)?{from:N,to:w,raw:R}:{from:N,to:w,raw:{from:N,to:w}}};function a(R){return typeof R=="string"?R.indexOf("now")>=0:!1}function E(R){return typeof R.raw.from=="string"&&R.raw.from.indexOf("f")>0?!0:typeof R.raw.to=="string"&&R.raw.to.indexOf("f")>0}function g(R){return a(R.from)||a(R.to)}function h(R){const B=Math.floor(R/31536e3);if(B)return B+"y";const U=Math.floor(R%31536e3/86400);if(U)return U+"d";const W=Math.floor(R%31536e3%86400/3600);if(W)return W+"h";const N=Math.floor(R%31536e3%86400%3600/60);if(N)return N+"m";const w=Math.floor(R%31536e3%86400%3600%60);if(w)return w+"s";const L=Math.floor(R*1e3);return L?L+"ms":"less than a millisecond"}function D(R){const B=Number((R/1e3).toFixed()),U=Math.floor(B/60/60),W=Math.floor(B/60)-U*60,N=Number((B%60).toFixed());let w=U?U+"h":"",L=W?W+"min":"",V=N?N+"sec":"";return w&&L?w=w+" ":w=w,(L||w)&&V?L=L+" ":L=L,w+L+V||"less than 1sec"}function v(R,B,U){let W=1;U&&(W=x(U));let N=b((R.to.valueOf()-R.from.valueOf())/B);return W>N&&(N=W),{intervalMs:N,interval:h(N/1e3)}}const C=/(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,T={y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001};function S(R){if(Number(R))return{sec:T.s,type:"s",count:parseInt(R,10)};const B=R.match(C);if(!B)throw new Error(`Invalid interval string, has to be either unit-less or end with one of the following units: "${Object.keys(T).join(", ")}"`);const U=T[B[2]];if(U===void 0)throw new Error("describeInterval failed: invalid interval string");return{sec:U,type:B[2],count:parseInt(B[1],10)}}function O(R){const B=S(R);return B.sec*B.count}function x(R){const B=S(R);return B.sec*1e3*B.count}function b(R){switch(!0){case R<10:return 1;case R<15:return 10;case R<35:return 20;case R<75:return 50;case R<150:return 100;case R<350:return 200;case R<750:return 500;case R<1500:return 1e3;case R<3500:return 2e3;case R<7500:return 5e3;case R<12500:return 1e4;case R<17500:return 15e3;case R<25e3:return 2e4;case R<45e3:return 3e4;case R<9e4:return 6e4;case R<21e4:return 12e4;case R<45e4:return 3e5;case R<75e4:return 6e5;case R<105e4:return 9e5;case R<15e5:return 12e5;case R<27e5:return 18e5;case R<54e5:return 36e5;case R<9e6:return 72e5;case R<162e5:return 108e5;case R<324e5:return 216e5;case R<864e5:return 432e5;case R<6048e5:return 864e5;case R<18144e5:return 6048e5;case R<36288e5:return 2592e6;default:return 31536e6}}function M(R,B=(0,o.KQ)()){const U=B.unix()-R.from.unix(),W=B.unix()-R.to.unix();return{from:U,to:W}}function A(R,B=(0,o.KQ)()){const U=(0,o.KQ)(B).subtract(R.from,"s"),W=R.to===0?(0,o.KQ)(B):(0,o.KQ)(B).subtract(R.to,"s");return{from:U,to:W,raw:{from:U,to:W}}}},91410:(G,I,e)=>{"use strict";e.d(I,{HD:()=>i,P3:()=>d,QZ:()=>u,U3:()=>p,g$:()=>m,le:()=>l});var t=e(2543),n=e.n(t),s=e(84743),r=e.n(s),o=e(1933),m=(E=>(E.default="",E.localBrowserTime="browser",E.utc="utc",E))(m||{});const l=E=>{switch((0,o.O)({timeZone:E})){case"browser":return"Local browser time";case"utc":return"UTC";default:return E}},i=E=>r().tz.zone(E),u=(E,g)=>{const h=c(E,g);return h||f(E,g)},d=(0,t.memoize)((E=!1)=>{const g=[];return E===!0?g.push("","browser","utc"):E&&g.push(...E),r().tz.names().reduce((h,D)=>{const v=a[D];return!Array.isArray(v)||v.length===0||h.push(D),h},g)}),p=(0,t.memoize)((E=!1)=>{const h=d(E).reduce((D,v)=>{const C=v.indexOf("/");if(C===-1){const S="";return D[S]=D[S]??[],D[S].push(v),D}const T=v.slice(0,C);return D[T]=D[T]??[],D[T].push(v),D},{});return Object.keys(h).map(D=>({name:D,zones:h[D]}))}),c=(E,g)=>{switch(E){case"utc":return{name:"Coordinated Universal Time",ianaName:"UTC",zone:E,countries:[],abbreviation:"UTC, GMT",offsetInMins:0};case"":{const h=(0,o.O)(),v=h==="browser"||h==="utc"?c(h,g):f(h,g);return{countries:a[h]??[],abbreviation:"",offsetInMins:0,...v,ianaName:v?.ianaName??"",name:"Default",zone:E}}case"browser":{const h=r().tz.guess(!0),D=f(h,g);return{countries:a[h]??[],abbreviation:"Your local time",offsetInMins:new Date().getTimezoneOffset(),...D,name:"Browser Time",ianaName:D?.ianaName??"",zone:E}}default:return}},y=E=>/^(\+|\-).+/.test(E)?"":E,f=(E,g)=>{const h=r().tz.zone(E);if(h)return{name:E,ianaName:h.name,zone:E,countries:a[E]??[],abbreviation:y(h.abbr(g)),offsetInMins:h.utcOffset(g)}},P={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran (Islamic Republic Of)",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia (Federated States Of)",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},a=r().tz.countries().reduce((E,g)=>r().tz.zonesForCountry(g).reduce((D,v)=>{D[v]||(D[v]=[]);const C=P[g];return C&&D[v].push({code:g,name:C}),D},E),{})},18226:(G,I,e)=>{"use strict";e.d(I,{o:()=>r});var t=e(74486),n=e(88483),s=e(16126);class r{constructor(){this.subscribers=new Map,this.emitter=new t.A}publish(l){this.emitter.emit(l.type,l)}subscribe(l,i){return this.getStream(l).subscribe({next:i})}getStream(l){return new n.c(i=>{const u=d=>{i.next(d)};return this.emitter.on(l.type,u),this.subscribers.set(u,i),()=>{this.emitter.off(l.type,u),this.subscribers.delete(u)}})}newScopedBus(l,i){return new o([l],this,i)}emit(l,i){typeof l=="string"?this.emitter.emit(l,{type:l,payload:i}):this.emitter.emit(l.name,{type:l.name,payload:i})}on(l,i,u){if(i.wrapper=d=>{i(d.payload)},typeof l=="string"?this.emitter.on(l,i.wrapper):this.emitter.on(l.name,i.wrapper),u){const d=u.$on("$destroy",()=>{this.off(l,i),d()})}}off(l,i){if(typeof l=="string"){this.emitter.off(l,i.wrapper);return}this.emitter.off(l.name,i.wrapper)}removeAllListeners(){this.emitter.removeAllListeners();for(const[l,i]of this.subscribers)i.complete(),this.subscribers.delete(l)}}class o{constructor(l,i,u){this.path=l,this.eventBus=i,this.filterConfig=u??{onlyLocal:!1}}publish(l){l.origin||(l.origin=this),this.eventBus.publish(l)}filter(l){return this.filterConfig.onlyLocal?l.origin===this:!0}getStream(l){return this.eventBus.getStream(l).pipe((0,s.p)(this.filter.bind(this)))}subscribe(l,i){return this.getStream(l).subscribe({next:i})}removeAllListeners(){this.eventBus.removeAllListeners()}newScopedBus(l,i){return new o([...this.path,l],this,i)}}},69129:(G,I,e)=>{"use strict";e.d(I,{LL:()=>u,LO:()=>r,NI:()=>i,Tp:()=>d,We:()=>o,b_:()=>n,gc:()=>m,ql:()=>s,wE:()=>l});var t=e(65463);class n extends t.x{static{this.type="data-hover"}}class s extends t.a{static{this.type="data-hover-clear"}}class r extends t.x{static{this.type="data-select"}}class o extends t.x{static{this.type="annotation-event"}}class m extends t.x{static{this.type="dashboard-loaded"}}class l extends t.a{static{this.type="datasource-updated-successfully"}}class i extends t.a{static{this.type="datasource-test-succeeded"}}class u extends t.a{static{this.type="datasource-test-failed"}}class d extends t.x{static{this.type="set-panel-attention"}}},89550:(G,I,e)=>{"use strict";e.d(I,{R:()=>n});const t=new Set;function n(s){if(t.has(s))throw new Error(`There is already an event defined with type '${s}'`);return t.add(s),{name:s}}},56302:(G,I,e)=>{"use strict";e.d(I,{LL:()=>r.LL,LO:()=>r.LO,NI:()=>r.NI,Rb:()=>t.R,Tp:()=>r.Tp,We:()=>r.We,aV:()=>n.a,b_:()=>r.b_,gc:()=>r.gc,or:()=>s.o,ql:()=>r.ql,wE:()=>r.wE,x$:()=>n.x});var t=e(89550),n=e(65463),s=e(18226),r=e(69129)},65463:(G,I,e)=>{"use strict";e.d(I,{a:()=>t,x:()=>n});class t{constructor(){this.type=this.__proto__.constructor.type}setTags(r){return this.tags=new Set(r),this}}class n extends t{constructor(r){super(),this.payload=r}}},66670:(G,I,e)=>{"use strict";e.d(I,{K:()=>n});var t=e(83077);class n extends t.O{}},57875:(G,I,e)=>{"use strict";e.d(I,{H:()=>f,J:()=>c});var t=e(2543),n=e.n(t),s=e(14236),r=e(53531),o=e(47232),m=e(11261),l=e(28802),i=e(62398),u=e(83195),d=e(58563);const p={dateTimeAsIso:!0,dateTimeAsIsoNoDateIfToday:!0,dateTimeAsUS:!0,dateTimeAsUSNoDateIfToday:!0,dateTimeAsLocal:!0,dateTimeAsLocalNoDateIfToday:!0,dateTimeFromNow:!0};function c(a){if(!a||(0,t.isEmpty)(a)||!a.field)return y;const E=a.field,g=E.config??{},{palette:h}=a.theme.visualization;let D=g.unit,v=D&&(p[D]||D.startsWith("time:")),C=!1;if(E.type===m.PU.time&&!v){if(D="dateTimeAsSystem",v=!0,E.values&&E.values.length>1){let R=E.values[0],B=E.values[E.values.length-1];typeof R=="string"?(R=(0,r.b)(R).unix(),B=(0,r.b)(B).unix()):(R/=1e3,B/=1e3),C=Math.abs(B-R)<60}}else E.type===m.PU.boolean?(0,u.j9)(D)||(D="bool"):!D&&E.type===m.PU.string&&(D="string");const T=D?.startsWith("currency"),S=(0,u.j9)(D),O=E.type===m.PU.number,b=!v&&!T&&!S&&!(D==="locale")&&O&&g.decimals==null,M=(0,u.j_)(D||"none"),A=(0,d.jc)(E,a.theme);return(R,B)=>{const{mappings:U}=g,W=D==="string";v&&typeof R=="string"&&(R=(0,o.yT)(R).valueOf());let N=W?NaN:(0,l.t)(R),w,L,V,K,k,j;if(U&&U.length>0){const J=(0,i.Zz)(U,R);J&&(J.text!=null&&(w=J.text),J.color!=null&&(K=a.theme.visualization.getColorByName(J.color)),J.icon!=null&&(k=J.icon))}else if(E.type===m.PU.enum){if(R==null)return{text:"",numeric:NaN};const J=+R;if(g&&g.type&&g.type.enum){const{text:X,color:se}=g.type.enum;if(w=X?X[J]:`${R}`,K=se?se[J]:void 0,K==null){const ae=h[J%h.length];K=a.theme.visualization.getColorByName(ae)}}}if(!Number.isNaN(N)){if(w==null&&!(0,t.isBoolean)(R)){let J;b&&B!=null?(J=M(N,B,null,a.timeZone,C),J.text=+J.text+""):J=M(N,g.decimals,null,a.timeZone,C),w=J.text,V=J.suffix,L=J.prefix}if(K==null){const J=A(N);K=J.color,j=J.percent}}if(w==null&&(0,t.isArray)(R)&&(w=(0,t.join)(R,", ")),w==null&&(w=(0,t.toString)(R),w||(g.noValue?w=g.noValue:w="")),!K){const J=A(-1/0);K=J.color,j=J.percent}const H={text:w,numeric:N,prefix:L,suffix:V,color:K};return k!=null&&(H.icon=k),j!=null&&(H.percent=j),H}}function y(a){return{text:(0,t.toString)(a),numeric:(0,l.t)(a)}}function f(){return a=>({text:(0,s.oE)(a)==="other"?`${JSON.stringify(a,P())}`:`${a}`,numeric:null})}const P=()=>{const a=new WeakSet;return(E,g)=>{if(typeof g=="object"&&g!==null){if(a.has(g))return;a.add(g)}return g}}},8066:(G,I,e)=>{"use strict";e.d(I,{Hs:()=>f,Qi:()=>y,lz:()=>P,uf:()=>p});var t=e(21197),n=e(55459),s=e.n(n),r=e(84140),o=e(23596),m=e(75059),l=e(24293),i=e(83077),u=e(58563),d=e(47737);const p=new i.O(()=>[{id:l.Y.Fixed,name:"Single color",description:"Set a specific color",getCalculator:a},{id:l.Y.Shades,name:"Shades of a color",description:"Select shades of a specific color",getCalculator:E},{id:l.Y.Thresholds,name:"From thresholds",isByValue:!0,description:"Derive colors from thresholds",getCalculator:(g,h)=>(D,v,C)=>{const T=C??d.QS;return h.visualization.getColorByName(T.color)}},new c({id:l.Y.PaletteClassic,name:"Classic palette",isContinuous:!1,isByValue:!1,getColors:g=>g.visualization.palette}),new c({id:l.Y.PaletteClassicByName,name:"Classic palette (by series name)",isContinuous:!1,isByValue:!1,useSeriesName:!0,getColors:g=>g.visualization.palette.filter(h=>o.getContrastRatio(g.visualization.getColorByName(h),g.colors.background.primary)>=g.colors.contrastThreshold)}),new c({id:l.Y.ContinuousGrYlRd,name:"Green-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:g=>["green","yellow","red"]}),new c({id:l.Y.ContinuousRdYlGr,name:"Red-Yellow-Green",isContinuous:!0,isByValue:!0,getColors:g=>["red","yellow","green"]}),new c({id:l.Y.ContinuousBlYlRd,name:"Blue-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:g=>["dark-blue","super-light-yellow","dark-red"]}),new c({id:l.Y.ContinuousYlRd,name:"Yellow-Red",isContinuous:!0,isByValue:!0,getColors:g=>["super-light-yellow","dark-red"]}),new c({id:l.Y.ContinuousBlPu,name:"Blue-Purple",isContinuous:!0,isByValue:!0,getColors:g=>["blue","purple"]}),new c({id:l.Y.ContinuousYlBl,name:"Yellow-Blue",isContinuous:!0,isByValue:!0,getColors:g=>["super-light-yellow","dark-blue"]}),new c({id:l.Y.ContinuousBlues,name:"Blues",isContinuous:!0,isByValue:!0,getColors:g=>["panel-bg","dark-blue"]}),new c({id:l.Y.ContinuousReds,name:"Reds",isContinuous:!0,isByValue:!0,getColors:g=>["panel-bg","dark-red"]}),new c({id:l.Y.ContinuousGreens,name:"Greens",isContinuous:!0,isByValue:!0,getColors:g=>["panel-bg","dark-green"]}),new c({id:l.Y.ContinuousPurples,name:"Purples",isContinuous:!0,isByValue:!0,getColors:g=>["panel-bg","dark-purple"]})]);class c{constructor(h){this.id=h.id,this.name=h.name,this.description=h.description,this.getNamedColors=h.getColors,this.isContinuous=h.isContinuous,this.isByValue=h.isByValue,this.useSeriesName=h.useSeriesName}getColors(h){return this.getNamedColors?this.colorCache&&this.colorCacheTheme===h?this.colorCache:(this.colorCache=this.getNamedColors(h).map(h.visualization.getColorByName),this.colorCacheTheme=h,this.colorCache):[]}getInterpolator(){return this.interpolator||(this.interpolator=(0,t.Ik)(this.colorCache)),this.interpolator}getCalculator(h,D){const v=this.getColors(D);return this.isByValue?this.isContinuous?(C,T,S)=>this.getInterpolator()(T):(C,T,S)=>v[T*(v.length-1)]:this.useSeriesName?(C,T,S)=>v[Math.abs(s()(h.name))%v.length]:(C,T,S)=>{const O=h.state?.seriesIndex??0;return v[O%v.length]}}}function y(g){return p.get(g.config.color?.mode??l.Y.Thresholds)}function f(g){return p.get(g??l.Y.Thresholds)}function P(g,h){const D=y(g);if(!D.isByValue)return{color:D.getCalculator(g,h)(0,0),threshold:d.QS,percent:1};const v=(0,u.jc)(g,h),C=g.config.color?.seriesBy??"last",S=(0,m.Nw)({field:g,reducers:[C]})[C]??0;return v(S)}function a(g,h){return()=>h.visualization.getColorByName(g.config.color?.fixedColor??l.F)}function E(g,h){return()=>{const D=h.visualization.getColorByName(g.config.color?.fixedColor??l.F),v=[D],C=6,T=10,S=35,O=35;for(let b=1;b<C;b++)v.push((0,r.A)(D).spin(b/C*T).brighten(b/C*S).toHexString()),v.push((0,r.A)(D).spin(-(b/C)*T).darken(b/C*O).toHexString());const x=g.state?.seriesIndex??0;return v[x%v.length]}}},56323:(G,I,e)=>{"use strict";e.d(I,{PI:()=>E,Pm:()=>a,XS:()=>C,Zo:()=>O,a_:()=>P,eG:()=>v,k3:()=>p,k_:()=>f,nF:()=>y,py:()=>c});var t=e(2543),n=e.n(t),s=e(78368),r=e(14236),o=e(85200),m=e(75059),l=e(1173),i=e(11261),u=e(57875),d=e(28240);const p="__series.name",c="__field.displayName",y="__field.labels",f="__calc",P="__cell_",a=25,E=b=>{const{replaceVariables:M,reduceOptions:A,timeZone:R,theme:B}=b,U=A.calcs.length?A.calcs:[m.gy.last],W=[],N=(0,o.NS)(A.fields?{id:l.Ct.byRegexp,options:A.fields}:{id:l.Ct.numeric}),w=b.data??[],L=A.limit?A.limit:a;let V=!1;for(let K=0;K<w.length&&!V;K++){const k=w[K],{timeField:j}=(0,r.KR)(k),H=new s.R(k);for(let J=0;J<k.fields.length&&!V;J++){const X=k.fields[J],se=X.getLinks;if(!N(X,k,w))continue;let ae=X.config;X.state?.range&&(ae={...ae,...X.state?.range});let ne=X.config.displayName??"";const q=X.display??(0,u.J)({field:X,theme:b.theme,timeZone:R});if(A.values)for(let ee=0;ee<X.values.length;ee++){X.state=h(X,W.length);const z=x(X,ee),te=q(X.values[ee]),ie=g(k,X,ee,M,z),ce=D(ie,b.fieldConfig,B);if(W.push({name:"",field:ae,display:{...te,title:ie,color:ce??te.color},view:H,colIndex:J,rowIndex:ee,getLinks:se?()=>se({valueRowIndex:ee}):()=>[],hasLinks:v(X)}),W.length>=L){V=!0;break}}else{const ee=(0,m.Nw)({field:X,reducers:U});for(const z of U){const te=X.state?.scopedVars??{};te[f]={value:z,text:z};const ie=q(ee[z]);ne!==""?ie.title=M(ne,te):ie.title=(0,d.Ct)(X,k,w),ie.percentChange=b.percentChange?(0,m.Nw)({field:X,reducers:[m.gy.diffperc]}).diffperc:void 0;let ce;b.sparkline&&(ce={y:k.fields[J],x:j},z===m.gy.last?ce.highlightIndex=ce.y.values.length-1:z===m.gy.first&&(ce.highlightIndex=0));const ue=k.length===1?0:void 0;W.push({name:z,field:ae,display:ie,sparkline:ce,view:H,colIndex:J,getLinks:se?()=>se({calculatedValue:ie,valueRowIndex:ue}):()=>[],hasLinks:v(X)})}}}}return W.length===0&&W.push(T(b)),W};function g(b,M,A,R,B){const U=M.config.displayName;if(U)return U.indexOf(P)?R(O(U),B):R(U,B);let W=[],N=0;for(const w of b.fields)if(w!==M)if(w.type===i.PU.string){const L=w.values[A]??"",V=w.display?w.display(L).text:L;V.length>0&&W.push(V)}else w.type===i.PU.number&&N++;return(N||W.length===0)&&W.push((0,d.Ct)(M,b)),W.join(" ")}function h(b,M){return{...b.state,seriesIndex:M}}function D(b,M,A){for(const R of M.overrides)if(R.matcher.id==="byName"&&R.matcher.options===b){for(const B of R.properties)if(B.id==="color"&&B.value)return A.visualization.getColorByName(B.value.fixedColor)}return null}function v(b){return b.config?.links?.length?b.config.links.length>0:!1}function C(b){let M="",A="",R="",B="";for(let U=0;U<b.length;U++){const W=b[U].display;W.text&&W.text.length>A.length&&(A=W.text),W.title&&W.title.length>M.length&&(M=W.title),W.prefix&&W.prefix.length>R.length&&(R=W.prefix),W.suffix&&W.suffix.length>B.length&&(B=W.suffix)}return{text:A,title:M,suffix:B,prefix:R}}function T(b){const M="No data",{fieldConfig:A,timeZone:R}=b,{defaults:B}=A,W=(0,u.J)({field:{type:i.PU.other,config:B},theme:b.theme,timeZone:R})(null),N=S(W,M);return{name:M,field:{...B,max:B.max??0,min:B.min??0},display:{text:N,numeric:0,color:W.color},hasLinks:!1}}function S(b,M){return!b||(0,t.isEmpty)(b.text)?M:b.text}function O(b){return b.replace(/\${__cell_(\d+)(.*?)}|\[\[__cell_(\d+)(.*?)\]\]|\$__cell_(\d+)(\S*)/g,(M,A,R,B,U,W,N)=>`\${__data.fields[${A??B??W}]${R??U??N}}`)}function x(b,M){return b.state?.scopedVars?.__dataContext?{...b.state?.scopedVars,__dataContext:{value:{...b.state?.scopedVars?.__dataContext.value,rowIndex:M}}}:b.state?.scopedVars}},90708:(G,I,e)=>{"use strict";e.d(I,{BF:()=>O,K3:()=>M,_M:()=>b,nJ:()=>g,rJ:()=>A,we:()=>h});var t=e(2543),n=e.n(t),s=e(96540),r=e(80292),o=e(52622),m=e(14236),l=e(21423),i=e(23596),u=e(75059),d=e(85200),p=e(11261),c=e(24293),y=e(71733),f=e(6709),P=e(57875),a=e(58563),E=e(69550);function g(B){let U=null,W=null;const N=[u.gy.min,u.gy.max];for(const w of B)for(const L of w.fields)if(L.type===p.PU.number){const V=(0,u.Nw)({field:L,reducers:N}),K=V[u.gy.min],k=V[u.gy.max];(U===null||K<U)&&(U=K),(W===null||k>W)&&(W=k)}return{min:U,max:W,delta:(W??0)-(U??0)}}function h(B){if(!B.data)return[];const U=B.fieldConfig;if(!U)return B.data;const W=B.fieldConfigRegistry??E.G;let N=0,w;const L=[];if(U.overrides)for(const V of U.overrides){const K=d.sJ.get(V.matcher.id);K&&L.push({match:K.get(V.matcher.options),properties:V.properties})}return B.data.map((V,K)=>{const k={...V};k.fields=k.fields.map(j=>({...j,config:(0,t.cloneDeep)(j.config),state:{...j.state}}));for(const j of k.fields){const H=j.config;j.state.scopedVars={__dataContext:{value:{data:B.data,frame:k,frameIndex:K,field:j}}};const J={field:j,data:B.data,dataFrameIndex:K,replaceVariables:B.replaceVariables,fieldConfigRegistry:W};T(H,U.defaults,J);for(const ne of L)if(ne.match(j,k,B.data))for(const q of ne.properties)C(H,q,J);let X=j.type;if(!X||X===p.PU.other){const ne=(0,m.dF)(j);ne&&(X=ne)}const{range:se,newGlobalRange:ae}=D(H,j,w,B.data);if(w=ae,j.state.seriesIndex=N,j.state.range=se,j.type=X,j.type!==p.PU.time&&N++,j.display=(0,P.J)({field:j,theme:B.theme,timeZone:B.timeZone}),j.config.unit!=="dateTimeFromNow"&&(j.display=v(j.display,2500)),j.getLinks=b(k,j,j.state.scopedVars,J.replaceVariables,B.timeZone,B.dataLinkPostProcessor),j.type===p.PU.nestedFrames)for(const ne of j.values)for(let q=0;q<ne.length;q++)for(const ee of ne[q].fields)ee.display=(0,P.J)({field:ee,theme:B.theme,timeZone:B.timeZone}),ee.state={scopedVars:{__dataContext:{value:{data:ne,frame:ne[q],frameIndex:q,field:ee}}}},ee.getLinks=b(ne[q],ee,ee.state.scopedVars,J.replaceVariables,B.timeZone,B.dataLinkPostProcessor)}return k})}function D(B,U,W,N){if(U.type!==p.PU.number||(0,t.isNumber)(B.min)&&(0,t.isNumber)(B.max))return{newGlobalRange:W};if(B.fieldMinMax){const K=(0,a.AP)(U),k=B.min??K.min,j=B.max??K.max;return{range:{min:k,max:j,delta:j-k},newGlobalRange:W}}const w=W??g(N),L=B.min??w.min,V=B.max??w.max;return{range:{min:L,max:V,delta:V-L},newGlobalRange:w}}function v(B,U=2500){const W=new Map;for(let N=-1;N<=15;N++)W.set(N,new Map);return(N,w)=>{let L=W.get(w??-1),V=L.get(N);return V||(L.size===U&&L.clear(),V=B(N,w),V.color&&(V.color=(0,i.asHexString)(V.color)),L.set(N,V)),V}}function C(B,U,W){const w=W.fieldConfigRegistry.getIfExists(U.id);if(!w)return;const L=w.process(U.value,W,w.settings);L==null?w.isCustom&&B.custom?(0,t.unset)(B.custom,w.path):(0,t.unset)(B,w.path):w.isCustom?(B.custom||(B.custom={}),(0,t.set)(B.custom,w.path,L)):(0,t.set)(B,w.path,L)}function T(B,U,W){B.links&&U.links&&(B.links=[...B.links,...U.links]);for(const N of W.fieldConfigRegistry.list())N.isCustom&&!B.custom&&(B.custom={}),S(N.isCustom?B.custom:B,N.isCustom?U.custom:U,N,W);O(B)}function S(B,U,W,N){const w=(0,t.get)(B,W.path);if(w==null){const L=N.fieldConfigRegistry.getIfExists(W.id);if(!L)return;if(L&&L.shouldApply(N.field)){const V=L.process((0,t.get)(U,L.path),N,L.settings);V!=null&&(0,t.set)(B,L.path,V)}}}function O(B){const{thresholds:U}=B;if(B.color?B.color.mode||delete B.color:U&&(B.color={mode:c.Y.Thresholds}),B.hasOwnProperty("min")&&B.hasOwnProperty("max")&&B.min>B.max){const W=B.max;B.max=B.min,B.min=W}}const x=B=>{const{link:U,linkModel:W,dataLinkScopedVars:N,field:w,replaceVariables:L}=B;return U.internal?(0,f.u)({link:U,internalLink:U.internal,scopedVars:N,field:w,range:U.internal.range,replaceVariables:L}):W},b=(B,U,W,N,w,L)=>V=>!U.config.links||U.config.links.length===0?[]:U.config.links.map(k=>{const j=R(B,U,W),H={...W,__dataContext:j},J=(ae,ne,q)=>N(ae,{...H,...ne},q);V.valueRowIndex!==void 0&&!isNaN(V.valueRowIndex)?j.value.rowIndex=V.valueRowIndex:j.value.calculatedValue=V.calculatedValue;let X,se=k.onClick||!k.onBuildUrl?k.url:k.onBuildUrl({origin:U,replaceVariables:J});return se&&(se=y.I.assureBaseUrl(se.replace(/\n/g,"")),se=N(se,H,o.$m.UriEncode),se=y.I.processUrl(se)),k.onClick?X={href:se,title:N(k.title||"",H),target:k.targetBlank?"_blank":void 0,onClick:(ae,ne)=>{k.onClick({origin:ne??U,e:ae,replaceVariables:J})},origin:U}:X={href:se,title:N(k.title||"",H),target:k.targetBlank?"_blank":void 0,origin:U},(L||x)({frame:B,field:U,dataLinkScopedVars:H,replaceVariables:N,config:V,link:k,linkModel:X})}).filter(k=>!!k);function M(B){if(!B||B.length===0)return[];const U=[...B],W=(0,P.H)();for(let N=0;N<U.length;N++){const w={...U[N]},L=[...w.fields];for(let V=0;V<L.length;V++)L[V]={...L[V],display:W};U[N]={...w,fields:L}}return U}function A(B,U,W,N,w,L,V){const K=B?.fieldConfigRegistry,k=(0,s.useRef)(0),j=(0,r.A)(W?.series);return(0,s.useMemo)(()=>{if(!K||!U||!W)return;const H=W?.series;W.structureRev==null&&H&&j&&!(0,l.J3)(H,j,l.bW)&&k.current++;const J={structureRev:k.current,...W,series:h({data:H,fieldConfig:U,fieldConfigRegistry:K,replaceVariables:L,theme:w,timeZone:N,dataLinkPostProcessor:V})};return W.annotations&&W.annotations.length>0&&(J.annotations=h({data:W.annotations,fieldConfig:{defaults:{},overrides:[]},replaceVariables:L,theme:w,timeZone:N,dataLinkPostProcessor:V})),J},[K,U,W,j,N,w,L,V])}function R(B,U,W){return W?.__dataContext?{value:{...W.__dataContext.value}}:{value:{frame:B,field:U,data:[B]}}}},28240:(G,I,e)=>{"use strict";e.d(I,{Ct:()=>l,Fm:()=>o,Ri:()=>r,fk:()=>u,j2:()=>m});var t=e(85200),n=e(11261),s=e(8249);function r(p,c){if(p.name)return p.name;const y=[];for(const f of p.fields)if(f.type!==n.PU.time){if(y.length>1)break;y.push(l(f,p))}return y.length===1?y[0]:c===void 0&&p.fields.length>0?p.fields.filter(f=>f.type!==n.PU.time).map(f=>l(f,p)).join(", "):p.refId?`Series (${p.refId})`:`Series (${c})`}function o(p){p.forEach(c=>{c.fields.forEach(y=>{l(y,c,p)})})}function m(p,c){p.forEach(y=>{y.fields.forEach(f=>{const P={legend:!1,tooltip:!1,viz:!1,...c.defaults.custom?.hideFrom},a=f.config.custom?.hideFrom;c.overrides.forEach(E=>{if("__systemRef"in E)return;if((0,t.NS)(E.matcher)(f,y,p))for(const h of E.properties)h.id==="custom.hideFrom"&&Object.assign(P,h.value)}),f.state={...f.state,hideFrom:{...a}},f.config.custom.hideFrom=P})})}function l(p,c,y){const f=p.state?.displayName,P=!!(y&&y.length>1);if(f&&P===p.state?.multipleFrames)return f;const a=i(p,c,y);return p.state=p.state||{},p.state.displayName=a,p.state.multipleFrames=P,a}function i(p,c,y){const f=p.config?.displayName&&p.config?.displayName.length,P=!!c?.meta?.timeCompare?.isTimeShiftQuery;let a=f?p.config.displayName:p.name;if(f)return P?`${a} (comparison)`:a;if(c&&p.config?.displayNameFromDS)return P?`${p.config.displayNameFromDS} (comparison)`:p.config.displayNameFromDS;if(p.type===n.PU.time&&!p.labels)return a??n.LE;let E=[],g=!1;if(y&&y.length>1){for(let v=1;v<y.length;v++)if(y[v].name!==y[v-1].name){g=!0;break}}let h=!1,D=!1;if(g&&c?.name&&(E.push(c.name),h=!0),p.name&&p.name!==n.Bc&&E.push(p.name),p.labels&&c){let v=d(y??[c]);if(v)p.labels[v]&&(E.push(p.labels[v]),D=!0);else{let C=(0,s.h6)(p.labels);C&&(E.push(C),D=!0)}}return c&&!h&&!D&&p.name===n.Bc&&c.name&&c.name.length>0&&(E.push(c.name),h=!0),E.length?a=E.join(" "):p.name?a=p.name:a=n.Bc,a===p.name&&(a=u(p,c)),P&&(a=`${a} (comparison)`),a}function u(p,c){let y=0,f=!1;if(c)for(let P=0;P<c.fields.length;P++){const a=c.fields[P];if(p===a){if(f=!0,y>0){y++;break}}else if(p.name===a.name&&(y++,f))break}return y?`${p.name} ${y}`:p.name}function d(p){let c=null;for(let y=0;y<p.length;y++){const f=p[y];for(const P of f.fields)if(P.labels){for(const a in P.labels)if(c===null)c=a;else if(a!==c)return null}}return c}},92461:(G,I,e)=>{"use strict";e.d(I,{F:()=>o});var t=e(2543),n=e.n(t),s=e(83195),r=e(57875);function o(m){return new Proxy({},{get:(l,i)=>{let u=m.frame.fields.find(y=>i===y.name);if(!u){const y=(0,t.toNumber)(i);u=m.frame.fields[y]}if(u||(u=m.frame.fields.find(y=>i===y.config.displayName)),u||(u=m.frame.fields.find(y=>y.labels?i===y.labels.name:!1)),!u)return;const d=u.display??(0,r.J)(),p=u.values[m.rowIndex],c=d(p);return c.toString=()=>(0,s.cN)(c),c}})}},63877:(G,I,e)=>{"use strict";e.d(I,{AM:()=>r.AM,AP:()=>p.AP,BF:()=>i.BF,Ch:()=>r.Ch,Ct:()=>d.Ct,DJ:()=>s.D,FM:()=>r.FM,FU:()=>u.F,Fm:()=>d.Fm,Gs:()=>s.G,HB:()=>n.H,Hs:()=>o.Hs,JO:()=>n.J,K3:()=>i.K3,Kr:()=>m.K,N7:()=>r.N7,OU:()=>r.OU,PI:()=>t.PI,Pm:()=>t.Pm,Qi:()=>o.Qi,RU:()=>l.RU,Ri:()=>d.Ri,X4:()=>r.X4,XS:()=>t.XS,Zo:()=>t.Zo,a_:()=>t.a_,eG:()=>t.eG,fk:()=>d.fk,hL:()=>r.hL,hS:()=>r.hS,jc:()=>p.jc,k3:()=>t.k3,k_:()=>t.k_,lG:()=>r.lG,lz:()=>o.lz,m0:()=>r.m0,nF:()=>t.nF,py:()=>t.py,rJ:()=>i.rJ,uf:()=>o.uf,we:()=>i.we,xT:()=>r.xT,xg:()=>p.xg,yQ:()=>l.yQ});var t=e(56323),n=e(57875),s=e(69550),r=e(27310),o=e(8066),m=e(66670),l=e(47737),i=e(90708),u=e(92461),d=e(28240),p=e(58563)},27310:(G,I,e)=>{"use strict";e.d(I,{AM:()=>s,Ch:()=>r,FM:()=>d,N7:()=>i,OU:()=>l,X4:()=>p,hL:()=>m,hS:()=>t,lG:()=>u,m0:()=>n,xT:()=>o});const t=c=>c,n=(c,y,f)=>{if(c!=null)return parseFloat(c)},s=(c,y,f)=>(delete y.field?.state?.displayName,l(c,y,f)),r=(c,y,f)=>c,o=(c,y,f)=>c,m=(c,y,f)=>c,l=(c,y,f)=>c==null?c:f&&f.expandTemplateVars&&y.replaceVariables&&typeof c=="string"?y.replaceVariables(c,y.field.state.scopedVars):`${c}`,i=(c,y,f)=>c,u=(c,y,f)=>c,d=(c,y,f)=>c;var p=(c=>(c.IncludeAll="all",c.ExcludeBaseNames="exclude",c.OnlyBaseNames="only",c))(p||{})},58563:(G,I,e)=>{"use strict";e.d(I,{AP:()=>u,jc:()=>l,xg:()=>d});var t=e(2543),n=e.n(t),s=e(75059),r=e(11261),o=e(8066),m=e(47737);function l(p,c){if(p.type===r.PU.boolean)return i(p,c);const f=(0,o.Qi)(p).getCalculator(p,c),P=p.state?.range??u(p);return a=>{let E=0;a!==-1/0&&(E=(a-P.min)/P.delta,Number.isNaN(E)&&(E=0));const g=(0,m.k5)(p,a,E);return{percent:E,threshold:g,color:f(a,E,g)}}}function i(p,c){const y={color:c.visualization.getColorByName("green"),percent:1,threshold:void 0},f={color:c.visualization.getColorByName("red"),percent:0,threshold:void 0},P=(0,o.Qi)(p);if(P.isContinuous&&P.getColors){const a=P.getColors(c);y.color=a[a.length-1],f.color=a[0]}return a=>a?y:f}function u(p){if(p.type!==r.PU.number)return{min:0,max:100,delta:100};let c=p.config.min,y=p.config.max;if(!(0,t.isNumber)(c)||!(0,t.isNumber)(y))if(p.values&&p.values.length){const f=(0,s.Nw)({field:p,reducers:[s.gy.min,s.gy.max]});(0,t.isNumber)(c)||(c=f[s.gy.min]),(0,t.isNumber)(y)||(y=f[s.gy.max])}else c=0,y=100;return{min:c,max:y,delta:y-c}}function d(p,c){const{config:y}=p;let{min:f,max:P}=y;return(0,t.isNumber)(f)&&(0,t.isNumber)(P)?y:c||!p.state?.range?{...y,...u(p)}:{...y,...p.state.range}}},69550:(G,I,e)=>{"use strict";e.d(I,{D:()=>r,G:()=>s});var t=e(83077),n=e(66670);const s=new n.K,r=new t.O},47737:(G,I,e)=>{"use strict";e.d(I,{QS:()=>s,RU:()=>m,k5:()=>o,yQ:()=>r});var t=e(24293),n=e(50082);const s={value:0,color:t.F};function r(l,i){if(!i||i.length===0)return s;let u=i[0];for(const d of i)if(l>=d.value)u=d;else break;return u}function o(l,i,u){const{thresholds:d}=l.config;return d?.mode===n.O.Percentage?r(u*100,d?.steps):r(i,d?.steps)}function m(l){return l.sort((i,u)=>i.value-u.value)}},10361:(G,I,e)=>{"use strict";e.d(I,{a:()=>t.aG});var t=e(52622)},39954:(G,I,e)=>{"use strict";e.r(I),e.d(I,{AnnotationChangeEvent:()=>d.We,ArrayDataFrame:()=>r.fG,ArrayVector:()=>x.L,BinaryOperationID:()=>t.kP,BusEventBase:()=>d.aV,BusEventWithPayload:()=>d.x$,ByNamesMatcherMode:()=>o.PP,CSVHeaderStyle:()=>t.F7,CSVReader:()=>t.i8,CircularDataFrame:()=>b.x,CircularVector:()=>S.$,DEFAULT_FIELD_DISPLAY_VALUES_LIMIT:()=>u.Pm,DashboardLoadedEvent:()=>d.gc,DataFrameView:()=>r.Rh,DataHoverClearEvent:()=>d.ql,DataHoverEvent:()=>d.b_,DataLinkBuiltInVars:()=>t.cI,DataSelectEvent:()=>d.LO,DataSourcePluginContextProvider:()=>D.p,DataSourceTestFailed:()=>d.LL,DataSourceTestSucceeded:()=>d.NI,DataSourceUpdatedSuccessfully:()=>d.wE,DataTransformerID:()=>o.Fy,DocsId:()=>t.fu,EventBusSrv:()=>d.or,FieldCache:()=>r.Lc,FieldConfigEditorBuilder:()=>t.bk,FieldConfigOptionsRegistry:()=>u.Kr,FieldMatcherID:()=>o.Ct,FieldNamePickerBaseNameMode:()=>u.X4,FrameGeometrySourceMode:()=>y.a,FrameMatcherID:()=>o.jR,ISO_8601:()=>m.mt,InternalTimeZones:()=>m.g$,LayoutModes:()=>P.R,LegacyMappingType:()=>t.An,MISSING_VALUE:()=>r.pk,MatcherID:()=>o.cV,MutableDataFrame:()=>r.k2,NodeGraphDataFrameFieldNames:()=>t.uc,PanelOptionsEditorBuilder:()=>t.pv,PanelPlugin:()=>a.m,PluginContextProvider:()=>h.a,ReducerID:()=>o.gy,Registry:()=>t.OR,SetPanelAttentionEvent:()=>d.Tp,StreamingDataFrame:()=>r.k9,StreamingFrameAction:()=>r.Kh,SystemDateFormatsState:()=>m.JE,ThemeContext:()=>p.Dx,TransformerCategory:()=>o.m_,UnaryOperationID:()=>t._G,VAR_CALC:()=>u.k_,VAR_CELL_PREFIX:()=>u.a_,VAR_FIELD_LABELS:()=>u.nF,VAR_FIELD_NAME:()=>u.py,VAR_SERIES_NAME:()=>u.k3,ValueMatcherID:()=>o.Js,addDurationToDate:()=>m.Ri,addRow:()=>r.uY,anySeriesWithTimeField:()=>r.tP,anyToNumber:()=>t.to,applyFieldOverrides:()=>u.we,applyNullInsertThreshold:()=>o.MS,applyRawFieldOverrides:()=>u.K3,arrayToDataFrame:()=>r.Ij,arrayUtils:()=>t.XC,binaryOperators:()=>t.bP,booleanOverrideProcessor:()=>u.FM,booleanValueFormatter:()=>i.Qc,buildHistogram:()=>o.p3,cacheFieldDisplayNames:()=>u.Fm,classicColors:()=>t.tj,closestIdx:()=>r.Ls,colorManipulator:()=>p.MV,compareArrayValues:()=>r.J3,compareDataFrameStructures:()=>r.bW,containsSearchFilter:()=>t.Eg,convertOldAngularValueMappings:()=>t.bh,createDataFrame:()=>r.EI,createDimension:()=>r.r4,createFieldConfigRegistry:()=>g.O,createTheme:()=>p.an,dataFrameFromJSON:()=>r.or,dataFrameToJSON:()=>r.Nw,dataLinksOverrideProcessor:()=>u.Ch,dateMath:()=>m.ns,dateTime:()=>m.KQ,dateTimeAsMoment:()=>m.AN,dateTimeForTimeZone:()=>m.oZ,dateTimeFormat:()=>m.LE,dateTimeFormatISO:()=>m.M7,dateTimeFormatTimeAgo:()=>m.fq,dateTimeFormatWithAbbrevation:()=>m._Q,dateTimeParse:()=>m.bQ,decodeFieldValueEntities:()=>r.t,decodeFieldValueEnums:()=>r.EL,defaultCalcs:()=>o.C6,deprecationWarning:()=>t.lt,displayNameOverrideProcessor:()=>u.AM,doStandardCalcs:()=>o.H3,durationToMilliseconds:()=>m.WT,ensureTimeField:()=>o.ks,escapeRegex:()=>l.$f,escapeStringForRegex:()=>l.jD,eventFactory:()=>d.Rb,fieldColorModeRegistry:()=>u.uf,fieldMatchers:()=>o.sJ,fieldReducers:()=>o.AS,filterFieldConfigOverrides:()=>E.aW,findCommonLabels:()=>t.yO,findHighlightChunksInText:()=>l.Oq,findMatchesInText:()=>l.bs,findUniqueLabels:()=>t.s6,fixCellTemplateExpressions:()=>u.Zo,formatLabels:()=>t.h6,formattedValueToString:()=>i.cN,frameMatchers:()=>o.RE,getActiveThreshold:()=>u.yQ,getAllValuesFromDimension:()=>r.Km,getBuiltInThemes:()=>p.k7,getColumnFromDimension:()=>r.P4,getColumnsFromDimension:()=>r.g6,getDataFrameRow:()=>r.Yn,getDataSourceRef:()=>t.p$,getDataSourceUID:()=>t.Iz,getDimensionByName:()=>r.xB,getDisplayProcessor:()=>u.JO,getDisplayValueAlignmentFactors:()=>u.XS,getFieldColorMode:()=>u.Hs,getFieldColorModeForField:()=>u.Qi,getFieldConfigWithMinMax:()=>u.xg,getFieldDisplayName:()=>u.Ct,getFieldDisplayValues:()=>u.PI,getFieldDisplayValuesProxy:()=>u.FU,getFieldMatcher:()=>o.NS,getFieldSeriesColor:()=>u.lz,getFieldTypeFromValue:()=>r.oE,getFlotPairs:()=>t.RZ,getFlotPairsConstant:()=>t.rG,getFrameDisplayName:()=>u.Ri,getFrameMatchers:()=>o.Dq,getHistogramFields:()=>o.ix,getLinksSupplier:()=>T._M,getLocale:()=>m.JK,getLocaleData:()=>m.XN,getMinMaxAndDelta:()=>u.AP,getNextRefId:()=>f.M,getPanelOptionsWithDefaults:()=>E.F,getProcessedDataFrames:()=>r.Bt,getRawDisplayProcessor:()=>u.HB,getRowUniqueId:()=>r.t9,getScaleCalculator:()=>u.jc,getSearchFilterScopedVar:()=>t.cs,getSeriesTimeStep:()=>t.tY,getThemeById:()=>p.gh,getTimeField:()=>r.KR,getTimeZone:()=>m.O,getTimeZoneGroups:()=>m.U3,getTimeZoneInfo:()=>m.QZ,getTimeZones:()=>m.P3,getUniqueFieldName:()=>u.fk,getValueFormat:()=>i.j_,getValueFormats:()=>i.Ke,getValueFormatterIndex:()=>i.uH,getValueFromDimension:()=>r.WK,getValueMatcher:()=>o.kK,getWeekdayIndex:()=>m.xQ,getWeekdayIndexByEnglishName:()=>m.pp,getZone:()=>m.HD,guessDecimals:()=>t.E6,guessFieldTypeForField:()=>r.dF,guessFieldTypeFromNameAndValue:()=>r.by,guessFieldTypeFromValue:()=>r.HW,guessFieldTypes:()=>r.XQ,hasLinks:()=>u.eG,hasMsResolution:()=>t.dO,hasTimeField:()=>r.S1,histogramBucketSizes:()=>o.rW,histogramFieldInfo:()=>o.Rt,histogramFieldsToFrame:()=>o.cg,histogramFrameBucketMaxFieldName:()=>o.dA,histogramFrameBucketMinFieldName:()=>o.d$,histogramTransformer:()=>o.OA,identityOverrideProcessor:()=>u.hS,incrRound:()=>o.ZU,incrRoundDn:()=>o.rs,incrRoundUp:()=>o.Uh,intervalToAbbreviatedDurationString:()=>m.dU,isBooleanUnit:()=>i.j9,isCustomFieldProp:()=>E.TQ,isDataFrame:()=>r.ci,isDataFrameWithValue:()=>r.LI,isDataSourcePluginContext:()=>C.S,isDataSourceRef:()=>t.fN,isDateTime:()=>m.Ar,isDateTimeInput:()=>m.u8,isEmptyObject:()=>t.RI,isHistogramFrameBucketMaxFieldName:()=>o.H1,isHistogramFrameBucketMinFieldName:()=>o.NX,isLikelyAscendingVector:()=>o.g2,isReducerID:()=>o.Em,isStandardFieldProp:()=>E.nx,isTableData:()=>r.pH,isTimeSeriesField:()=>r.hF,isTimeSeriesFrame:()=>r.aH,isTimeSeriesFrames:()=>r.jq,isValidDate:()=>m.vd,isValidDuration:()=>m.di,isValidGoDuration:()=>m.IM,isValidGrafanaDuration:()=>m.V3,localTimeFormat:()=>m.Od,locale:()=>i.Hg,locationUtil:()=>t.Ig,makeClassES5Compatible:()=>t.Yi,mapInternalLinkToExplore:()=>t.uS,matchAllLabels:()=>t._p,matchPluginId:()=>t._8,monacoLanguageRegistry:()=>c.l,nullToValue:()=>o.CF,numberOverrideProcessor:()=>u.m0,objRemoveUndefined:()=>t.wm,onUpdateDatasourceJsonDataOption:()=>t.PG,onUpdateDatasourceJsonDataOptionChecked:()=>t.EX,onUpdateDatasourceJsonDataOptionSelect:()=>t.BD,onUpdateDatasourceOption:()=>t.zX,onUpdateDatasourceResetOption:()=>t.yV,onUpdateDatasourceSecureJsonDataOption:()=>t.mn,onUpdateDatasourceSecureJsonDataOptionSelect:()=>t.wY,outerJoinDataFrames:()=>o.KP,parseDuration:()=>m.E9,parseFlags:()=>l.bQ,parseLabels:()=>t.Xy,preProcessPanelData:()=>r.N$,rangeUtil:()=>m.Ii,readCSV:()=>t.Jh,reduceField:()=>o.Nw,renderLegendFormat:()=>t.j_,renderMarkdown:()=>l.Gc,renderTextPanelMarkdown:()=>l.Pn,restoreCustomOverrideRules:()=>E.H9,reverseDataFrame:()=>r.q7,roundDecimals:()=>t.hB,scaledUnits:()=>i.yP,selectOverrideProcessor:()=>u.hL,serializeStateToUrlParam:()=>t.Pp,setLocale:()=>m.xS,setTimeZoneResolver:()=>m.GZ,setWeekStart:()=>m.$D,shallowCompare:()=>r.ab,simpleCountUnit:()=>i.UR,sortDataFrame:()=>r.ES,sortThresholds:()=>u.RU,standardEditorsRegistry:()=>u.DJ,standardFieldConfigEditorRegistry:()=>u.Gs,standardTransformers:()=>o.c9,standardTransformersRegistry:()=>o.h9,stringFormater:()=>i.cH,stringOverrideProcessor:()=>u.OU,stringStartsAsRegEx:()=>l.AP,stringToJsRegex:()=>l.dO,stringToMs:()=>l.dc,systemDateFormats:()=>m.WC,textUtil:()=>l.sQ,thresholdsOverrideProcessor:()=>u.N7,timeZoneAbbrevation:()=>m.jw,timeZoneFormatUserFriendly:()=>m.le,toCSV:()=>t._O,toDataFrame:()=>r.Vc,toDataFrameDTO:()=>r.Kl,toDuration:()=>m.Ah,toFilteredDataFrameDTO:()=>r.By,toFixed:()=>i.Mg,toFixedScaled:()=>i.gZ,toFixedUnit:()=>i.G8,toFloatOrUndefined:()=>l.$D,toIntegerOrUndefined:()=>l.vb,toLegacyResponseData:()=>r.w3,toNumberString:()=>l.kT,toOption:()=>t.zL,toPascalCase:()=>l.MX,toURLRange:()=>t.sQ,toUtc:()=>m.yT,transformDataFrame:()=>o.m6,unEscapeStringFromRegex:()=>l.xb,unaryOperators:()=>t.j7,unitOverrideProcessor:()=>u.lG,updateDatasourcePluginJsonDataOption:()=>t.lO,updateDatasourcePluginOption:()=>t.pN,updateDatasourcePluginResetOption:()=>t.QP,updateDatasourcePluginSecureJsonDataOption:()=>t.wp,urlUtil:()=>t.kM,useFieldOverrides:()=>u.rJ,usePluginContext:()=>v.Q,validateFieldConfig:()=>u.BF,valueMappingsOverrideProcessor:()=>u.xT,valueMatchers:()=>o.hI,vectorator:()=>O.E,withLoadingIndicator:()=>t.kz});var t=e(94032),n=e(64572),s={};for(const M in n)["default","LayoutModes","PanelPlugin","getPanelOptionsWithDefaults","filterFieldConfigOverrides","restoreCustomOverrideRules","isCustomFieldProp","isStandardFieldProp","createFieldConfigRegistry","PluginContextProvider","DataSourcePluginContextProvider","usePluginContext","isDataSourcePluginContext","getLinksSupplier","CircularVector","vectorator","ArrayVector","BinaryOperationID","CSVHeaderStyle","CSVReader","DataLinkBuiltInVars","DocsId","FieldConfigEditorBuilder","LegacyMappingType","NodeGraphDataFrameFieldNames","PanelOptionsEditorBuilder","Registry","UnaryOperationID","anyToNumber","arrayUtils","binaryOperators","classicColors","containsSearchFilter","convertOldAngularValueMappings","deprecationWarning","findCommonLabels","findUniqueLabels","formatLabels","getDataSourceRef","getDataSourceUID","getFlotPairs","getFlotPairsConstant","getSearchFilterScopedVar","getSeriesTimeStep","guessDecimals","hasMsResolution","isDataSourceRef","isEmptyObject","locationUtil","makeClassES5Compatible","mapInternalLinkToExplore","matchAllLabels","matchPluginId","objRemoveUndefined","onUpdateDatasourceJsonDataOption","onUpdateDatasourceJsonDataOptionChecked","onUpdateDatasourceJsonDataOptionSelect","onUpdateDatasourceOption","onUpdateDatasourceResetOption","onUpdateDatasourceSecureJsonDataOption","onUpdateDatasourceSecureJsonDataOptionSelect","parseLabels","readCSV","renderLegendFormat","roundDecimals","serializeStateToUrlParam","toCSV","toOption","toURLRange","unaryOperators","updateDatasourcePluginJsonDataOption","updateDatasourcePluginOption","updateDatasourcePluginResetOption","updateDatasourcePluginSecureJsonDataOption","urlUtil","withLoadingIndicator"].indexOf(M)<0&&(s[M]=()=>n[M]);e.d(I,s);var r=e(48120),o=e(34687),m=e(38698),l=e(40672),i=e(56496),u=e(63877),d=e(56302),p=e(74529),c=e(58612),y=e(10361),f=e(21809),P=e(19484),a=e(65158),E=e(581),g=e(28528),h=e(13834),D=e(76287),v=e(92470),C=e(95187),T=e(90708),S=e(36120),O=e(18008),x=e(79178),b=e(33526)},58612:(G,I,e)=>{"use strict";e.d(I,{l:()=>t.l});var t=e(96915)},96915:(G,I,e)=>{"use strict";e.d(I,{l:()=>n});var t=e(83077);const n=new t.O},65158:(G,I,e)=>{"use strict";e.d(I,{m:()=>i});var t=e(2543),n=e.n(t),s=e(66670),r=e(43429),o=e(95344),m=e(60264),l=e(28528);class i extends r.Ud{constructor(d){super(),this._fieldConfigDefaults={defaults:{},overrides:[]},this._initConfigRegistry=()=>new s.K,this.dataSupport={annotations:!1,alertStates:!1},this.panel=d}get defaults(){let d=this._defaults||{};if(!this._defaults&&this.optionsSupplier){const p=new m.pv;this.optionsSupplier(p,{data:[]});for(const c of p.getItems())c.defaultValue!=null&&(0,t.set)(d,c.path,c.defaultValue)}return d}get fieldConfigDefaults(){const d=this._fieldConfigDefaults.defaults;d.custom={};for(const p of this.fieldConfigRegistry.list())p.defaultValue!==void 0&&(0,t.set)(d,p.id,p.defaultValue);return{defaults:{...d},overrides:this._fieldConfigDefaults.overrides}}setDefaults(d){return(0,o.l)("PanelPlugin","setDefaults","setPanelOptions"),this._defaults=d,this}get fieldConfigRegistry(){return this._fieldConfigRegistry||(this._fieldConfigRegistry=this._initConfigRegistry()),this._fieldConfigRegistry}setEditor(d){return(0,o.l)("PanelPlugin","setEditor","setPanelOptions"),this.editor=d,this}setNoPadding(){return this.noPadding=!0,this}setMigrationHandler(d){return this.onPanelMigration=d,this}setPanelChangeHandler(d){return this.onPanelTypeChanged=d,this}setPanelOptions(d){return this.optionsSupplier=d,this}getPanelOptionsSupplier(){return this.optionsSupplier??(()=>{})}setDataSupport(d){return this.dataSupport={...this.dataSupport,...d},this}useFieldConfig(d={}){return this._initConfigRegistry=()=>(0,l.O)(d,this.meta.name),this}setSuggestionsSupplier(d){return this.suggestionsSupplier=d,this}getSuggestionsSupplier(){return this.suggestionsSupplier}hasPluginId(d){return this.meta.id===d}}},581:(G,I,e)=>{"use strict";e.d(I,{F:()=>l,H9:()=>y,TQ:()=>f,aW:()=>u,nx:()=>P});var t=e(2543),n=e.n(t),s=e(8066),r=e(24293),o=e(37055),m=e(50082);function l({plugin:a,currentOptions:E,currentFieldConfig:g,isAfterPluginChange:h}){const D=(0,t.mergeWith)({},a.defaults,E||{},(T,S)=>{if((0,t.isArray)(S))return S}),v=i(g,a),C=p(a,v,h);return{options:D,fieldConfig:C}}function i(a,E){const g=E.fieldConfigDefaults,h={defaults:(0,t.mergeWith)({},g.defaults,a?a.defaults:{},(D,v)=>{if((0,t.isArray)(v))return v}),overrides:a?.overrides??[]};d(h.defaults,"",E.fieldConfigRegistry),h.defaults.thresholds&&c(h.defaults.thresholds),h.overrides=u(h.overrides,D=>E.fieldConfigRegistry.getIfExists(D.id)!==void 0);for(const D of h.overrides)for(const v of D.properties)v.id==="thresholds"&&c(v.value);return h}function u(a,E){return a.map(g=>{const h=g.properties.filter(E);return{...g,properties:h}})}function d(a,E,g){let h=!1;for(const[D,v]of Object.entries(a)){const C=`${E}${D}`,T=!!g.getIfExists(C);if(T){h=!0;continue}(0,t.isArray)(v)||!(0,t.isObject)(v)?T||(0,t.unset)(a,D):d(v,`${C}.`,g)||(0,t.unset)(a,D)}return h}function p(a,E,g){if(!g)return E;const h=a.fieldConfigRegistry.getIfExists(o.uo.Color);if(h&&h.settings){const D=h.settings,v=s.uf.getIfExists(E.defaults.color?.mode);if(!D.byValueSupport&&(!v||v.isByValue))return E.defaults.color={mode:r.Y.PaletteClassic},E;if(D.byValueSupport&&D.preferThresholdsMode&&v?.id!==r.Y.Fixed&&(!v||!v.isByValue))return E.defaults.color={mode:r.Y.Thresholds},E;if(D.bySeriesSupport&&v?.isByValue)return E.defaults.color={mode:r.Y.PaletteClassic},E}return E}function c(a){a.mode||(a.mode=m.O.Absolute),a.steps?a.steps.length&&(a.steps[0].value=-1/0):a.steps=[]}function y(a,E){const g={defaults:{...a.defaults,custom:E.defaults.custom},overrides:[...a.overrides]};for(const h of E.overrides)for(const D of h.properties)if(f(D)){const v=g.overrides.find(C=>(0,t.isEqual)(C.matcher,h.matcher));v?v!==h&&v.properties.push(D):g.overrides.push(h)}return g}function f(a){return a.id.startsWith("custom.")}function P(a){return!f(a)}},28528:(G,I,e)=>{"use strict";e.d(I,{O:()=>r});var t=e(66670),n=e(69550),s=e(60264);function r(m={},l){const i=new t.K,u=n.G.list(),d={};if(m.useCustomConfig){const p=new s.bk;m.useCustomConfig(p);for(const c of p.getRegistry().list())if(c.isCustom=!0,c.id="custom."+c.id,o(c,u)){const y=d[c.category[0]]??[];y.push(c),d[c.category[0]]=y}else i.register(c)}for(let p of u){const c=p.id;if(!(m.disableStandardOptions&&m.disableStandardOptions.indexOf(c)>-1)){if(m.standardOptions){const y=m.standardOptions[c]?.hideFromDefaults,f=m.standardOptions[c]?.defaultValue,P=m.standardOptions[c]?.settings;y&&(p={...p,hideFromDefaults:y}),f&&(p={...p,defaultValue:f}),P&&(p={...p,settings:p.settings?{...p.settings,...P}:P})}if(i.register(p),p.category&&d[p.category[0]])for(let y of d[p.category[0]])i.register(y)}}for(const p of i.list())if(p.path.indexOf("[")>0)throw new Error(`[${l}] Field config paths do not support arrays: ${p.id}`);return i}function o(m,l){return!!l.find(i=>m.category&&i.category&&m.category[0]===i.category[0])}},21809:(G,I,e)=>{"use strict";e.d(I,{M:()=>t.M});var t=e(77789)},77789:(G,I,e)=>{"use strict";e.d(I,{M:()=>t});const t=s=>{for(let r=0;;r++){const o=n(r);if(!s.some(m=>m.refId===o))return o}};function n(s){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return s<r.length?r[s]:n(Math.floor(s/r.length)-1)+r[s%r.length]}},40672:(G,I,e)=>{"use strict";e.d(I,{$D:()=>t.$D,$f:()=>t.$f,AP:()=>t.AP,Gc:()=>n.G,MX:()=>t.MX,Oq:()=>s.Oq,Pn:()=>n.P,bQ:()=>s.bQ,bs:()=>s.bs,dO:()=>t.dO,dc:()=>t.dc,jD:()=>t.jD,kT:()=>t.kT,sQ:()=>o,vb:()=>t.vb,xb:()=>t.xb});var t=e(54479),n=e(36663),s=e(21),r=e(80997);const o={escapeHtml:r.ZD,hasAnsiCodes:r.kE,sanitize:r.aj,sanitizeTextPanelContent:r.G$,sanitizeUrl:r.Jf,sanitizeSVGContent:r.rX,sanitizeTrustedTypes:r.oI,sanitizeTrustedTypesRSS:r.kc}},36663:(G,I,e)=>{"use strict";e.d(I,{G:()=>m,P:()=>l});var t=e(60023),n=e(33836),s=e(80997);let r=!1;const o={pedantic:!1,gfm:!0,breaks:!1};function m(i,u){r||(t.xI.use((0,n.z)()),t.xI.setOptions({...o}),r=!0);let d;u?.breaks&&(d={...o,breaks:!0});const p=(0,t.xI)(i||"",d);if(typeof p!="string")throw new Error("Failed to process markdown synchronously.");return u?.noSanitize?p:(0,s.G$)(p)}function l(i,u){r||(t.xI.use((0,n.z)()),t.xI.setOptions({...o}),r=!0);const d=(0,t.xI)(i||"");if(typeof d!="string")throw new Error("Failed to process markdown synchronously.");return u?.noSanitize?d:(0,s.G$)(d)}},80997:(G,I,e)=>{"use strict";e.d(I,{G$:()=>p,Jf:()=>y,ZD:()=>P,aj:()=>i,kE:()=>f,kc:()=>u,oI:()=>d,rX:()=>c});var t=e(16750),n=e(42838),s=e.n(n),r=e(34005),o=e.n(r);const m=Object.keys(r.whiteList).reduce((a,E)=>(a[E]=r.whiteList[E]?.concat(["class","style"]),a),{}),l=new r.FilterXSS({whiteList:m,css:{whiteList:{...r.getDefaultCSSWhiteList(),"flex-direction":!0,"flex-wrap":!0,"flex-basis":!0,"flex-grow":!0,"flex-shrink":!0,"flex-flow":!0,gap:!0,order:!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"align-items":!0,"align-content":!0,"align-self":!0}}});function i(a){try{return s().sanitize(a,{USE_PROFILES:{html:!0},FORBID_TAGS:["form","input"]})}catch{return console.error("String could not be sanitized",a),P(a)}}function u(a){return s().sanitize(a,{RETURN_TRUSTED_TYPE:!0,ADD_ATTR:["xmlns:atom","version","property","content"],ADD_TAGS:["rss","meta","channel","title","link","description","atom:link","item","pubDate","guid"],PARSER_MEDIA_TYPE:"application/xhtml+xml"})}function d(a){return s().sanitize(a,{RETURN_TRUSTED_TYPE:!0})}function p(a){try{return l.process(a)}catch{return console.error("String could not be sanitized",a),"Text string could not be sanitized"}}function c(a){return s().sanitize(a,{USE_PROFILES:{svg:!0,svgFilters:!0}})}function y(a){return(0,t.J)(a)}function f(a){return/\u001b\[\d{1,2}m/.test(a)}function P(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")}},54479:(G,I,e)=>{"use strict";e.d(I,{$D:()=>f,$f:()=>a,AP:()=>u,MX:()=>P,dO:()=>d,dc:()=>p,jD:()=>l,kT:()=>c,vb:()=>y,xb:()=>i});var t=e(2543),n=e.n(t);const r="([\\"+["(","[","{","}","]",")","\\","|","*","+","-",".","?","<",">","#","&","^","$"].join("\\")+"])",o=new RegExp(r,"g"),m=new RegExp("(\\\\)"+r,"g");function l(E){return E&&E.replace(o,"\\$1")}function i(E){return E&&E.replace(m,"$2")}function u(E){return E?E[0]==="/":!1}function d(E){if(!u(E))return new RegExp(`^${E}$`);const g=E.match(new RegExp("^/(.*?)/(g?i?m?y?s?)$"));if(!g)throw new Error(`'${E}' is not a valid regular expression.`);return new RegExp(g[1],g[2])}function p(E){if(!E)return 0;const g=parseInt(E,10),h=E.slice(String(g).length),D=1e3,v=D*60,C=v*60,T=C*24;switch(h){case"s":return g*D;case"m":return g*v;case"h":return g*C;case"d":return g*T;default:if(!h)return isNaN(g)?0:g;throw new Error("Not supported unit: "+h)}}function c(E){return E!=null&&Number.isFinite(E)?E.toString():""}function y(E){if(!E)return;const g=parseInt(E,10);return isNaN(g)?void 0:g}function f(E){if(!E)return;const g=parseFloat(E);return isNaN(g)?void 0:g}function P(E){const g=(0,t.camelCase)(E);return g.charAt(0).toUpperCase()+g.substring(1)}function a(E){return E.replace(/[\\^$*+?.()|[\]{}\/]/g,"\\$&")}},21:(G,I,e)=>{"use strict";e.d(I,{Oq:()=>t,bQ:()=>m,bs:()=>s});function t({searchWords:l,textToHighlight:i}){const u=[];for(const d of l)typeof d=="string"&&u.push(...s(i,d));return u}const n=l=>l.replace(/[[{(][\w,.\/:;<=>?:*+]+$/,"");function s(l,i){if(!l||!i)return[];const u=[],{cleaned:d,flags:p}=m(n(i));let c;try{c=new RegExp(`(?:${d})`,p)}catch{return u}return l.replace(c,(y,...f)=>{if(y){const P=f[f.length-2];u.push({text:y,start:P,length:y.length,end:P+y.length})}return""}),u}const r="-",o=/\(\?([ims-]+)\)/g;function m(l){const i=new Set(["g"]);return{cleaned:l.replace(o,(d,p)=>{const c=p.startsWith(r);for(let y=0;y<p.length;++y){const f=p.charAt(y);c||p.charAt(y-1)===r?i.delete(f):f!==r&&i.add(f)}return""}),flags:Array.from(i).join("")}}},23596:(G,I,e)=>{"use strict";e.r(I),e.d(I,{alpha:()=>f,asHexString:()=>m,asRgbString:()=>l,darken:()=>P,decomposeColor:()=>u,emphasize:()=>y,getContrastRatio:()=>p,getLuminance:()=>c,hexToRgb:()=>s,hslToRgb:()=>i,lighten:()=>a,recomposeColor:()=>d,rgbToHex:()=>o});var t=e(84140);function n(E,g=0,h=1){return Math.min(Math.max(g,E),h)}function s(E){E=E.slice(1);const g=new RegExp(`.{1,${E.length>=6?2:1}}`,"g");let h=E.match(g);if(!h)return"";let D=Array.from(h);return D[0].length===1&&(D=D.map(v=>v+v)),D?`rgb${D.length===4?"a":""}(${D.map((v,C)=>C<3?parseInt(v,16):Math.round(parseInt(v,16)/255*1e3)/1e3).join(", ")})`:""}function r(E){const g=E.toString(16);return g.length===1?`0${g}`:g}function o(E){if(E.indexOf("#")===0)return E;const{values:g}=u(E);return`#${g.map(h=>r(h)).join("")}`}function m(E){if(E[0]==="#")return E;const g=(0,t.A)(E);return g.getAlpha()===1?g.toHexString():g.toHex8String()}function l(E){return E.startsWith("rgb")?E:(0,t.A)(E).toRgbString()}function i(E){const g=u(E),{values:h}=g,D=h[0],v=h[1]/100,C=h[2]/100,T=v*Math.min(C,1-C),S=(b,M=(b+D/30)%12)=>C-T*Math.max(Math.min(M-3,9-M,1),-1);let O="rgb";const x=[Math.round(S(0)*255),Math.round(S(8)*255),Math.round(S(4)*255)];return g.type==="hsla"&&(O+="a",x.push(h[3])),d({type:O,values:x})}function u(E){if(typeof E!="string")return E;if(E.charAt(0)==="#")return u(s(E));const g=E.indexOf("("),h=E.substring(0,g);if(["rgb","rgba","hsl","hsla","color"].indexOf(h)===-1)throw new Error(`Unsupported '${E}' color. The following formats are supported: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()`);let D=E.substring(g+1,E.length-1),v;if(h==="color"){if(D=D.split(" "),v=D.shift(),D.length===4&&D[3].charAt(0)==="/"&&(D[3]=D[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(v)===-1)throw new Error(`Unsupported ${v} color space. The following color spaces are supported: srgb, display-p3, a98-rgb, prophoto-rgb, rec-2020.`)}else D=D.split(",");return D=D.map(C=>parseFloat(C)),{type:h,values:D,colorSpace:v}}function d(E){const{type:g,colorSpace:h}=E;let D=E.values;return g.indexOf("rgb")!==-1?D=D.map((v,C)=>C<3?parseInt(v,10):v):g.indexOf("hsl")!==-1&&(D[1]=`${D[1]}%`,D[2]=`${D[2]}%`),g.indexOf("color")!==-1?D=`${h} ${D.join(" ")}`:D=`${D.join(", ")}`,`${g}(${D})`}function p(E,g,h){const D=c(E),v=c(g,h);return(Math.max(D,v)+.05)/(Math.min(D,v)+.05)}function c(E,g){const h=u(E);let D=h.type==="hsl"?u(i(E)).values:h.values;if(g&&h.type==="rgba"){const C=u(g),T=D[3];D[0]=D[0]*T+C.values[0]*(1-T),D[1]=D[1]*T+C.values[1]*(1-T),D[2]=D[2]*T+C.values[2]*(1-T)}const v=D.map(C=>(h.type!=="color"&&(C/=255),C<=.03928?C/12.92:((C+.055)/1.055)**2.4));return Number((.2126*v[0]+.7152*v[1]+.0722*v[2]).toFixed(3))}function y(E,g=.15){return c(E)>.5?P(E,g):a(E,g)}function f(E,g){if(E==="")return"#000000";if(g=n(g),E[0]==="#"){if(E.length===9)E=E.substring(0,7);else if(E.length<=5){let D="#";for(let v=1;v<4;v++)D+=E[v]+E[v];E=D}return E+Math.round(g*255).toString(16).padStart(2,"0")}else{if(E[3]==="(")return E.replace(")",`, ${g})`);if(E[4]==="(")return E.substring(0,E.lastIndexOf(","))+`, ${g})`}const h=u(E);return h.type==="color"?h.values[3]=`/${g}`:h.values[3]=g,d(h)}function P(E,g){const h=u(E);if(g=n(g),h.type.indexOf("hsl")!==-1)h.values[2]*=1-g;else if(h.type.indexOf("rgb")!==-1||h.type.indexOf("color")!==-1)for(let D=0;D<3;D+=1)h.values[D]*=1-g;return d(h)}function a(E,g){const h=u(E);if(g=n(g),h.type.indexOf("hsl")!==-1)h.values[2]+=(100-h.values[2])*g;else if(h.type.indexOf("rgb")!==-1)for(let D=0;D<3;D+=1)h.values[D]+=(255-h.values[D])*g;else if(h.type.indexOf("color")!==-1)for(let D=0;D<3;D+=1)h.values[D]+=(1-h.values[D])*g;return d(h)}},60578:(G,I,e)=>{"use strict";e.d(I,{D:()=>s});var t=e(96540),n=e(75972);const s=t.createContext((0,n.a)());s.displayName="ThemeContext"},75972:(G,I,e)=>{"use strict";e.d(I,{a:()=>W});function t(){const w=["xs","sm","md","lg","xl","xxl"],L="px",V={xs:0,sm:544,md:769,lg:992,xl:1200,xxl:1440};function K(j){return`@media (min-width:${typeof j=="number"?j:V[j]}${L})`}function k(j){return`@media (max-width:${(typeof j=="number"?j:V[j])-5/100}${L})`}return{values:V,up:K,down:k,keys:w,unit:L}}var n=e(2543),s=e(23596);const r={white:"#FFFFFF",black:"#000000",gray25:"#2c3235",gray15:"#22252b",gray10:"#181b1f",gray05:"#111217",darkLayer0:"#18181A",darkLayer1:"#212124",darkLayer2:"#2a2a2f",darkBorder1:"#34343B",darkBorder2:"#64646B",gray90:"#F4F5F5",gray100:"#F4F5F5",gray80:"#D0D1D3",lightBorder1:"#E4E7E7",blueDarkMain:"#3D71D9",blueDarkText:"#6E9FFF",redDarkMain:"#D10E5C",redDarkText:"#FF5286",greenDarkMain:"#1A7F4B",greenDarkText:"#6CCF8E",orangeDarkMain:"#FF9900",orangeDarkText:"#fbad37",blueLightMain:"#3871DC",blueLightText:"#1F62E0",redLightMain:"#E0226E",redLightText:"#CF0E5B",greenLightMain:"#1B855E",greenLightText:"#0A764E",orangeLightMain:"#FF9900",orangeLightText:"#B5510D"};class o{constructor(){this.mode="dark",this.whiteBase="204, 204, 220",this.border={weak:`rgba(${this.whiteBase}, 0.12)`,medium:`rgba(${this.whiteBase}, 0.20)`,strong:`rgba(${this.whiteBase}, 0.30)`},this.text={primary:`rgb(${this.whiteBase})`,secondary:`rgba(${this.whiteBase}, 0.65)`,disabled:`rgba(${this.whiteBase}, 0.6)`,link:r.blueDarkText,maxContrast:r.white},this.primary={main:r.blueDarkMain,text:r.blueDarkText,border:r.blueDarkText},this.secondary={main:`rgba(${this.whiteBase}, 0.10)`,shade:`rgba(${this.whiteBase}, 0.14)`,transparent:`rgba(${this.whiteBase}, 0.08)`,text:this.text.primary,contrastText:`rgb(${this.whiteBase})`,border:`rgba(${this.whiteBase}, 0.08)`},this.info=this.primary,this.error={main:r.redDarkMain,text:r.redDarkText},this.success={main:r.greenDarkMain,text:r.greenDarkText},this.warning={main:r.orangeDarkMain,text:r.orangeDarkText},this.background={canvas:r.gray05,primary:r.gray10,secondary:r.gray15},this.action={hover:`rgba(${this.whiteBase}, 0.16)`,selected:`rgba(${this.whiteBase}, 0.12)`,selectedBorder:r.orangeDarkMain,focus:`rgba(${this.whiteBase}, 0.16)`,hoverOpacity:.08,disabledText:this.text.disabled,disabledBackground:`rgba(${this.whiteBase}, 0.04)`,disabledOpacity:.38},this.gradients={brandHorizontal:"linear-gradient(270deg, #F55F3E 0%, #FF8833 100%)",brandVertical:"linear-gradient(0.01deg, #F55F3E 0.01%, #FF8833 99.99%)"},this.contrastThreshold=3,this.hoverFactor=.03,this.tonalOffset=.15}}class m{constructor(){this.mode="light",this.blackBase="36, 41, 46",this.primary={main:r.blueLightMain,border:r.blueLightText,text:r.blueLightText},this.text={primary:`rgba(${this.blackBase}, 1)`,secondary:`rgba(${this.blackBase}, 0.75)`,disabled:`rgba(${this.blackBase}, 0.64)`,link:this.primary.text,maxContrast:r.black},this.border={weak:`rgba(${this.blackBase}, 0.12)`,medium:`rgba(${this.blackBase}, 0.30)`,strong:`rgba(${this.blackBase}, 0.40)`},this.secondary={main:`rgba(${this.blackBase}, 0.08)`,shade:`rgba(${this.blackBase}, 0.15)`,transparent:`rgba(${this.blackBase}, 0.08)`,contrastText:`rgba(${this.blackBase},  1)`,text:this.text.primary,border:this.border.weak},this.info={main:r.blueLightMain,text:r.blueLightText},this.error={main:r.redLightMain,text:r.redLightText,border:r.redLightText},this.success={main:r.greenLightMain,text:r.greenLightText},this.warning={main:r.orangeLightMain,text:r.orangeLightText},this.background={canvas:r.gray90,primary:r.white,secondary:r.gray100},this.action={hover:`rgba(${this.blackBase}, 0.12)`,selected:`rgba(${this.blackBase}, 0.08)`,selectedBorder:r.orangeLightMain,hoverOpacity:.08,focus:`rgba(${this.blackBase}, 0.12)`,disabledBackground:`rgba(${this.blackBase}, 0.04)`,disabledText:this.text.disabled,disabledOpacity:.38},this.gradients={brandHorizontal:"linear-gradient(90deg, #FF8833 0%, #F53E4C 100%)",brandVertical:"linear-gradient(0.01deg, #F53E4C -31.2%, #FF8833 113.07%)"},this.contrastThreshold=3,this.hoverFactor=.03,this.tonalOffset=.2}}function l(N){const w=new o,L=new m,V=(N.mode??"dark")==="dark"?w:L,{primary:K=V.primary,secondary:k=V.secondary,info:j=V.info,warning:H=V.warning,success:J=V.success,error:X=V.error,tonalOffset:se=V.tonalOffset,hoverFactor:ae=V.hoverFactor,contrastThreshold:ne=V.contrastThreshold,...q}=N;function ee(te,ie=ne){return(0,s.getContrastRatio)(w.text.maxContrast,te,V.background.primary)>=ie?w.text.maxContrast:L.text.maxContrast}const z=({color:te,name:ie})=>{if(te={...te,name:ie},!te.main)throw new Error(`Missing main color for ${ie}`);return te.text||(te.text=te.main),te.border||(te.border=te.text),te.shade||(te.shade=V.mode==="light"?(0,s.darken)(te.main,se):(0,s.lighten)(te.main,se)),te.transparent||(te.transparent=(0,s.alpha)(te.main,.15)),te.contrastText||(te.contrastText=ee(te.main)),te.borderTransparent||(te.borderTransparent=(0,s.alpha)(te.border,.25)),te};return(0,n.merge)({...V,primary:z({color:K,name:"primary"}),secondary:z({color:k,name:"secondary"}),info:z({color:j,name:"info"}),error:z({color:X,name:"error"}),success:z({color:J,name:"success"}),warning:z({color:H,name:"warning"}),getContrastText:ee,emphasize:(te,ie)=>(0,s.emphasize)(te,ie??ae)},q)}function i(N,w){const L={padding:1,headerHeight:4,background:N.background.primary,borderColor:N.border.weak,boxShadow:"none"},V={borderColor:N.border.medium,borderHover:N.border.strong,text:N.text.primary,background:N.mode==="dark"?N.background.canvas:N.background.primary};return{height:{sm:3,md:4,lg:6},input:V,panel:L,dropdown:{background:V.background},tooltip:{background:N.background.secondary,text:N.text.primary},dashboard:{background:N.background.canvas,padding:1},overlay:{background:N.mode==="dark"?"rgba(63, 62, 62, 0.45)":"rgba(208, 209, 211, 0.24)"},sidemenu:{width:57},menuTabs:{height:42},textHighlight:{text:N.warning.contrastText,background:N.warning.main},horizontalDrawer:{defaultHeight:400},table:{rowHoverBackground:N.emphasize(N.background.primary,.03)}}}function u(N){return N.mode==="dark"?{z1:"0px 1px 2px rgba(1, 4, 9, 0.75)",z2:"0px 4px 8px rgba(1, 4, 9, 0.75)",z3:"0px 8px 24px rgb(1, 4, 9)"}:{z1:"0px 1px 2px rgba(24, 26, 27, 0.2)",z2:"0px 4px 8px rgba(24, 26, 27, 0.2)",z3:"0px 13px 20px 1px rgba(24, 26, 27, 0.18)"}}function d(N){const w=N.borderRadius??2;return{radius:{default:"2px",pill:"9999px",circle:"100%"},borderRadius:K=>`${(K??1)*w}px`}}function p(N={}){const{gridSize:w=8}=N,L=K=>typeof K=="string"?K:K*w,V=(...K)=>(K.length===0&&(K[0]=1),K.map(k=>{const j=L(k);return typeof j=="number"?`${j}px`:j}).join(" "));return V.gridSize=w,V.x0="0px",V.x0_25="2px",V.x0_5="4px",V.x1="8px",V.x1_5="12px",V.x2="16px",V.x2_5="20px",V.x3="24px",V.x4="32px",V.x5="40px",V.x6="48px",V.x8="64px",V.x10="80px",V}const c={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},y={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function f(N=["all"],w={}){const{duration:L=y.standard,easing:V=c.easeInOut,delay:K=0}=w;return(Array.isArray(N)?N:[N]).map(k=>`${k} ${typeof L=="string"?L:E(L)} ${V} ${typeof K=="string"?K:E(K)}`).join(",")}function P(...N){return N.map(w=>`@media (prefers-reduced-motion: ${w})`).join(",")}function a(N){if(!N)return 0;const w=N/36;return Math.round((4+15*w**.25+w/5)*10)}function E(N){return`${Math.round(N)}ms`}function g(){return{create:f,duration:y,easing:c,getAutoHeightDuration:a,handleMotion:P}}const h='"Inter", "Helvetica", "Arial", sans-serif',D="'Roboto Mono', monospace";function v(N,w={}){const{fontFamily:L=h,fontFamilyMonospace:V=D,fontSize:K=14,fontWeightLight:k=300,fontWeightRegular:j=400,fontWeightMedium:H=500,fontWeightBold:J=500,htmlFontSize:X=14}=w,se=K/14,ae=z=>`${z/X*se}rem`,ne=(z,te,ie,ce,ue)=>{if(ie%2!==0||te%2!==0)throw new Error("Font size and line height should be integer multiples of 2 to prevent issues with alignment");return{fontFamily:L,fontWeight:z,fontSize:ae(te),lineHeight:ie/te,...L===h?{letterSpacing:`${C(ce/te)}em`}:{},...ue}},q={h1:ne(j,28,32,-.25),h2:ne(j,24,28,0),h3:ne(j,22,24,0),h4:ne(j,18,22,.25),h5:ne(j,16,22,0),h6:ne(H,14,22,.15),body:ne(j,K,22,.15),bodySmall:ne(j,12,18,.15),code:{...ne(j,14,16,.15),fontFamily:V}};return{htmlFontSize:X,pxToRem:ae,fontFamily:L,fontFamilyMonospace:V,fontSize:K,fontWeightLight:k,fontWeightRegular:j,fontWeightMedium:H,fontWeightBold:J,size:{base:"14px",xs:"10px",sm:"12px",md:"14px",lg:"18px"},...q}}function C(N){return Math.round(N*1e5)/1e5}var T=e(25137);function S(N){const w={name:"Grafana Default",typography:{fontFamily:{sansSerif:N.typography.fontFamily,monospace:N.typography.fontFamilyMonospace},size:{base:`${N.typography.fontSize}px`,xs:N.typography.size.xs,sm:N.typography.size.sm,md:N.typography.size.md,lg:N.typography.size.lg},heading:{h1:N.typography.h1.fontSize,h2:N.typography.h2.fontSize,h3:N.typography.h3.fontSize,h4:N.typography.h4.fontSize,h5:N.typography.h5.fontSize,h6:N.typography.h6.fontSize},weight:{light:N.typography.fontWeightLight,regular:N.typography.fontWeightRegular,semibold:N.typography.fontWeightMedium,bold:N.typography.fontWeightBold},lineHeight:{xs:N.typography.bodySmall.lineHeight,sm:N.typography.bodySmall.lineHeight,md:N.typography.body.lineHeight,lg:N.typography.h2.lineHeight},link:{decoration:"none",hoverDecoration:"none"}},breakpoints:{xs:`${N.breakpoints.values.xs}px`,sm:`${N.breakpoints.values.sm}px`,md:`${N.breakpoints.values.md}px`,lg:`${N.breakpoints.values.lg}px`,xl:`${N.breakpoints.values.xl}px`,xxl:`${N.breakpoints.values.xxl}px`},spacing:{base:N.spacing.gridSize,insetSquishMd:N.spacing(.5,1),d:N.spacing(2),xxs:N.spacing(.25),xs:N.spacing(.5),sm:N.spacing(1),md:N.spacing(2),lg:N.spacing(3),xl:N.spacing(4),gutter:N.spacing(4),formSpacingBase:N.spacing.gridSize,formMargin:`${N.spacing.gridSize*4}px`,formFieldsetMargin:`${N.spacing.gridSize*2}px`,formInputHeight:N.spacing.gridSize*4,formButtonHeight:N.spacing.gridSize*4,formInputPaddingHorizontal:`${N.spacing.gridSize}px`,formInputAffixPaddingHorizontal:`${N.spacing.gridSize/2}px`,formInputMargin:`${N.spacing.gridSize*2}px`,formLabelPadding:"0 0 0 2px",formLabelMargin:`0 0 ${N.spacing.gridSize/2+"px"} 0`,formValidationMessagePadding:"4px 8px",formValidationMessageMargin:"4px 0 0 0",inlineFormMargin:"4px"},border:{radius:{sm:N.shape.borderRadius(1),md:N.shape.borderRadius(2),lg:N.shape.borderRadius(3)},width:{sm:"1px"}},height:{sm:N.spacing.gridSize*N.components.height.sm,md:N.spacing.gridSize*N.components.height.md,lg:N.spacing.gridSize*N.components.height.lg},panelPadding:N.components.panel.padding*N.spacing.gridSize,panelHeaderHeight:N.spacing.gridSize*N.components.panel.headerHeight,zIndex:N.zIndex},L={...O,black:"#000000",white:"#ffffff",dark1:"#141414",dark2:"#161719",dark3:"#1f1f20",dark4:"#212124",dark5:"#222426",dark6:"#262628",dark7:"#292a2d",dark8:"#2f2f32",dark9:"#343436",dark10:"#424345",gray1:"#555555",gray2:"#8e8e8e",gray3:"#b3b3b3",gray4:"#d8d9da",gray5:"#ececec",gray6:"#f4f5f8",gray7:"#fbfbfb",redBase:"#e02f44",redShade:"#c4162a",greenBase:"#299c46",greenShade:"#23843b",red:"#d44a3a",yellow:"#ecbb13",purple:"#9933cc",variable:"#32d1df",orange:"#eb7b18",orangeDark:"#ff780a"},V={bg1:N.colors.background.primary,bg2:N.colors.background.secondary,bg3:N.colors.action.hover,dashboardBg:N.colors.background.canvas,bgBlue1:N.colors.primary.main,bgBlue2:N.colors.primary.shade},K={border1:N.colors.border.weak,border2:N.colors.border.medium,border3:N.colors.border.strong},k={textStrong:N.colors.text.maxContrast,textHeading:N.colors.text.primary,text:N.colors.text.primary,textSemiWeak:N.colors.text.secondary,textWeak:N.colors.text.secondary,textFaint:N.colors.text.disabled,textBlue:N.colors.primary.text},j={formLabel:N.colors.text.primary,formDescription:N.colors.text.secondary,formInputBg:N.components.input.background,formInputBgDisabled:N.colors.action.disabledBackground,formInputBorder:N.components.input.borderColor,formInputBorderHover:N.components.input.borderHover,formInputBorderActive:N.colors.primary.border,formInputBorderInvalid:N.colors.error.border,formInputPlaceholderText:N.colors.text.disabled,formInputText:N.components.input.text,formInputDisabledText:N.colors.action.disabledText,formFocusOutline:N.colors.primary.main,formValidationMessageText:N.colors.error.contrastText,formValidationMessageBg:N.colors.error.main};return{...w,type:N.colors.mode==="dark"?T.I.Dark:T.I.Light,isDark:N.isDark,isLight:N.isLight,name:N.name,palette:{...L,brandPrimary:L.orange,brandSuccess:N.colors.success.main,brandWarning:N.colors.warning.main,brandDanger:N.colors.error.main,queryRed:N.colors.error.text,queryGreen:N.colors.success.text,queryPurple:"#fe85fc",queryOrange:L.orange,online:N.colors.success.main,warn:N.colors.success.main,critical:N.colors.success.main},colors:{...V,...K,...j,...k,bodyBg:N.colors.background.canvas,panelBg:N.components.panel.background,panelBorder:N.components.panel.borderColor,pageHeaderBg:N.colors.background.canvas,pageHeaderBorder:N.colors.background.canvas,dropdownBg:j.formInputBg,dropdownShadow:L.black,dropdownOptionHoverBg:V.bg2,link:N.colors.text.primary,linkDisabled:N.colors.text.disabled,linkHover:N.colors.text.maxContrast,linkExternal:N.colors.text.link},shadows:{listItem:"none"},visualization:N.visualization}}const O={gray98:"#f7f8fa",gray97:"#f1f5f9",gray95:"#e9edf2",gray90:"#dce1e6",gray85:"#c7d0d9",gray70:"#9fa7b3",gray60:"#7b8087",gray33:"#464c54",gray25:"#2c3235",gray15:"#202226",gray10:"#141619",gray05:"#0b0c0e",blue95:"#5794f2",blue85:"#33a2e5",blue80:"#3274d9",blue77:"#1f60c4",red88:"#e02f44"};var x=e(24293);function b(N){const w=N.mode==="light"?A():M(),L={};for(const k of w)for(const j of k.shades)if(L[j.name]=j.color,j.aliases)for(const H of j.aliases)L[H]=j.color;L.transparent=N.mode==="light"?"rgba(255, 255, 255, 0)":"rgba(0,0,0,0)",L["panel-bg"]=N.background.primary,L.text=N.text.primary;const V=k=>{if(!k)return x.F;const j=L[k];if(j)return j;if(k[0]==="#"||k.indexOf("rgb")>-1)return k;const H=B[k.toLowerCase()];return H?(L[k]=H,H):k},K=R();return{hues:w,palette:K,getColorByName:V}}function M(){return[{name:"red",shades:[{color:"#FFA6B0",name:"super-light-red"},{color:"#FF7383",name:"light-red"},{color:"#F2495C",name:"red",primary:!0},{color:"#E02F44",name:"semi-dark-red"},{color:"#C4162A",name:"dark-red"}]},{name:"orange",shades:[{color:"#FFCB7D",name:"super-light-orange",aliases:[]},{color:"#FFB357",name:"light-orange",aliases:[]},{color:"#FF9830",name:"orange",aliases:[],primary:!0},{color:"#FF780A",name:"semi-dark-orange",aliases:[]},{color:"#FA6400",name:"dark-orange",aliases:[]}]},{name:"yellow",shades:[{color:"#FFF899",name:"super-light-yellow",aliases:[]},{color:"#FFEE52",name:"light-yellow",aliases:[]},{color:"#FADE2A",name:"yellow",aliases:[],primary:!0},{color:"#F2CC0C",name:"semi-dark-yellow",aliases:[]},{color:"#E0B400",name:"dark-yellow",aliases:[]}]},{name:"green",shades:[{color:"#C8F2C2",name:"super-light-green",aliases:[]},{color:"#96D98D",name:"light-green",aliases:[]},{color:"#73BF69",name:"green",aliases:[],primary:!0},{color:"#56A64B",name:"semi-dark-green",aliases:[]},{color:"#37872D",name:"dark-green",aliases:[]}]},{name:"blue",shades:[{color:"#C0D8FF",name:"super-light-blue",aliases:[]},{color:"#8AB8FF",name:"light-blue",aliases:[]},{color:"#5794F2",name:"blue",aliases:[],primary:!0},{color:"#3274D9",name:"semi-dark-blue",aliases:[]},{color:"#1F60C4",name:"dark-blue",aliases:[]}]},{name:"purple",shades:[{color:"#DEB6F2",name:"super-light-purple",aliases:[]},{color:"#CA95E5",name:"light-purple",aliases:[]},{color:"#B877D9",name:"purple",aliases:[],primary:!0},{color:"#A352CC",name:"semi-dark-purple",aliases:[]},{color:"#8F3BB8",name:"dark-purple",aliases:[]}]}]}function A(){return[{name:"red",shades:[{color:"#FF7383",name:"super-light-red"},{color:"#F2495C",name:"light-red"},{color:"#E02F44",name:"red",primary:!0},{color:"#C4162A",name:"semi-dark-red"},{color:"#AD0317",name:"dark-red"}]},{name:"orange",shades:[{color:"#FFB357",name:"super-light-orange",aliases:[]},{color:"#FF9830",name:"light-orange",aliases:[]},{color:"#FF780A",name:"orange",aliases:[],primary:!0},{color:"#FA6400",name:"semi-dark-orange",aliases:[]},{color:"#E55400",name:"dark-orange",aliases:[]}]},{name:"yellow",shades:[{color:"#FFEE52",name:"super-light-yellow",aliases:[]},{color:"#FADE2A",name:"light-yellow",aliases:[]},{color:"#F2CC0C",name:"yellow",aliases:[],primary:!0},{color:"#E0B400",name:"semi-dark-yellow",aliases:[]},{color:"#CC9D00",name:"dark-yellow",aliases:[]}]},{name:"green",shades:[{color:"#96D98D",name:"super-light-green",aliases:[]},{color:"#73BF69",name:"light-green",aliases:[]},{color:"#56A64B",name:"green",aliases:[],primary:!0},{color:"#37872D",name:"semi-dark-green",aliases:[]},{color:"#19730E",name:"dark-green",aliases:[]}]},{name:"blue",shades:[{color:"#8AB8FF",name:"super-light-blue",aliases:[]},{color:"#5794F2",name:"light-blue",aliases:[]},{color:"#3274D9",name:"blue",aliases:[],primary:!0},{color:"#1F60C4",name:"semi-dark-blue",aliases:[]},{color:"#1250B0",name:"dark-blue",aliases:[]}]},{name:"purple",shades:[{color:"#CA95E5",name:"super-light-purple",aliases:[]},{color:"#B877D9",name:"light-purple",aliases:[]},{color:"#A352CC",name:"purple",aliases:[],primary:!0},{color:"#8F3BB8",name:"semi-dark-purple",aliases:[]},{color:"#7C2EA3",name:"dark-purple",aliases:[]}]}]}function R(){return["green","semi-dark-yellow","light-blue","semi-dark-orange","red","blue","purple","#705DA0","dark-green","yellow","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"]}const B={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},U={activePanel:999,navbarFixed:1e3,sidemenu:1020,dropdown:1030,typeahead:1030,tooltip:1040,modalBackdrop:1050,modal:1060,portal:1061};function W(N={}){const{colors:w={},spacing:L={},shape:V={},typography:K={}}=N,k=l(w),j=t(),H=p(L),J=d(V),X=v(k,K),se=u(k),ae=g(),ne=i(k,se),q=b(k),ee={name:k.mode==="dark"?"Dark":"Light",isDark:k.mode==="dark",isLight:k.mode==="light",colors:k,breakpoints:j,spacing:H,shape:J,components:ne,typography:X,shadows:se,transitions:ae,visualization:q,zIndex:{...U},flags:{}};return{...ee,v1:S(ee)}}},74529:(G,I,e)=>{"use strict";e.d(I,{Dx:()=>r.D,MV:()=>s,an:()=>t.a,gh:()=>n.g,k7:()=>n.k});var t=e(75972),n=e(97594),s=e(23596),r=e(60578)},97594:(G,I,e)=>{"use strict";e.d(I,{g:()=>s,k:()=>r});var t=e(83077),n=e(75972);function s(u){return(o.getIfExists(u)??o.get("dark")).build()}function r(u){return o.list().filter(d=>u?!0:!d.isExtra)}const o=new t.O(()=>[{id:"system",name:"System preference",build:m},{id:"dark",name:"Dark",build:()=>(0,n.a)({colors:{mode:"dark"}})},{id:"light",name:"Light",build:()=>(0,n.a)({colors:{mode:"light"}})},{id:"blue-night",name:"Blue night",build:i,isExtra:!0},{id:"midnight",name:"Midnight",build:l,isExtra:!0}]);function m(){const d=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";return s(d)}function l(){const u="204, 204, 220";return(0,n.a)({name:"Midnight",colors:{mode:"dark",background:{canvas:"#000000",primary:"#000000",secondary:"#181818"},border:{weak:`rgba(${u}, 0.17)`,medium:`rgba(${u}, 0.25)`,strong:`rgba(${u}, 0.35)`}}})}function i(){return(0,n.a)({name:"Blue night",colors:{mode:"dark",background:{canvas:"#15161d",primary:"#15161d",secondary:"#1d1f2e"},border:{weak:"#2e304f",medium:"#2e304f",strong:"#2e304f"}}})}},75059:(G,I,e)=>{"use strict";e.d(I,{AS:()=>u,C6:()=>p,Em:()=>l,H3:()=>c,Nw:()=>i,gy:()=>m});var t=e(2543),n=e.n(t),s=e(39070),r=e(11261),o=e(83077),m=(v=>(v.sum="sum",v.max="max",v.min="min",v.logmin="logmin",v.mean="mean",v.variance="variance",v.stdDev="stdDev",v.last="last",v.first="first",v.count="count",v.range="range",v.diff="diff",v.diffperc="diffperc",v.delta="delta",v.step="step",v.firstNotNull="firstNotNull",v.lastNotNull="lastNotNull",v.changeCount="changeCount",v.distinctCount="distinctCount",v.allIsZero="allIsZero",v.allIsNull="allIsNull",v.allValues="allValues",v.uniqueValues="uniqueValues",v.p1="p1",v.p2="p2",v.p3="p3",v.p4="p4",v.p5="p5",v.p6="p6",v.p7="p7",v.p8="p8",v.p9="p9",v.p10="p10",v.p11="p11",v.p12="p12",v.p13="p13",v.p14="p14",v.p15="p15",v.p16="p16",v.p17="p17",v.p18="p18",v.p19="p19",v.p20="p20",v.p21="p21",v.p22="p22",v.p23="p23",v.p24="p24",v.p25="p25",v.p26="p26",v.p27="p27",v.p28="p28",v.p29="p29",v.p30="p30",v.p31="p31",v.p32="p32",v.p33="p33",v.p34="p34",v.p35="p35",v.p36="p36",v.p37="p37",v.p38="p38",v.p39="p39",v.p40="p40",v.p41="p41",v.p42="p42",v.p43="p43",v.p44="p44",v.p45="p45",v.p46="p46",v.p47="p47",v.p48="p48",v.p49="p49",v.p50="p50",v.p51="p51",v.p52="p52",v.p53="p53",v.p54="p54",v.p55="p55",v.p56="p56",v.p57="p57",v.p58="p58",v.p59="p59",v.p60="p60",v.p61="p61",v.p62="p62",v.p63="p63",v.p64="p64",v.p65="p65",v.p66="p66",v.p67="p67",v.p68="p68",v.p69="p69",v.p70="p70",v.p71="p71",v.p72="p72",v.p73="p73",v.p74="p74",v.p75="p75",v.p76="p76",v.p77="p77",v.p78="p78",v.p79="p79",v.p80="p80",v.p81="p81",v.p82="p82",v.p83="p83",v.p84="p84",v.p85="p85",v.p86="p86",v.p87="p87",v.p88="p88",v.p89="p89",v.p90="p90",v.p91="p91",v.p92="p92",v.p93="p93",v.p94="p94",v.p95="p95",v.p96="p96",v.p97="p97",v.p98="p98",v.p99="p99",v))(m||{});function l(v){return Object.keys(m).includes(v)}function i(v){const{field:C,reducers:T}=v;if(!C||!T||T.length<1)return{};if(C.state?.calcs){const R=[];for(const B of T)C.state.calcs.hasOwnProperty(B)||R.push(B);if(R.length<1)return{...C.state.calcs}}C.state||(C.state={});const S=u.list(T),O=C.values;if(O&&O.length<1){const R={...C.state.calcs};for(const B of S)R[B.id]=B.emptyInputResult!==null?B.emptyInputResult:null;return C.state.calcs=R}const{nullValueMode:x=s.UW.Ignore}=C.config,b=x===s.UW.Ignore,M=x===s.UW.AsZero;if(S.length===1&&S[0].reduce){const R=S[0].reduce(C,b,M);return C.state.calcs={...C.state.calcs,...R},R}let A=c(C,b,M);for(const R of S)!A.hasOwnProperty(R.id)&&R.reduce&&(A={...A,...R.reduce(C,b,M)});return C.state.calcs={...C.state.calcs,...A},A}const u=new o.O(()=>[{id:"lastNotNull",name:"Last *",description:"Last non-null value (also excludes NaNs)",standard:!0,aliasIds:["current"],reduce:a,preservesUnits:!0},{id:"last",name:"Last",description:"Last value",standard:!0,reduce:P,preservesUnits:!0},{id:"firstNotNull",name:"First *",description:"First non-null value (also excludes NaNs)",standard:!0,reduce:f,preservesUnits:!0},{id:"first",name:"First",description:"First Value",standard:!0,reduce:y,preservesUnits:!0},{id:"min",name:"Min",description:"Minimum Value",standard:!0,preservesUnits:!0},{id:"max",name:"Max",description:"Maximum Value",standard:!0,preservesUnits:!0},{id:"mean",name:"Mean",description:"Average Value",standard:!0,aliasIds:["avg"],preservesUnits:!0},{id:"variance",name:"Variance",description:"Variance of all values in a field",standard:!1,reduce:E,preservesUnits:!0},{id:"stdDev",name:"StdDev",description:"Standard deviation of all values in a field",standard:!1,reduce:E,preservesUnits:!0},{id:"sum",name:"Total",description:"The sum of all values",emptyInputResult:0,standard:!0,aliasIds:["total"],preservesUnits:!0},{id:"count",name:"Count",description:"Number of values in response",emptyInputResult:0,standard:!0,preservesUnits:!1},{id:"range",name:"Range",description:"Difference between minimum and maximum values",standard:!0,preservesUnits:!0},{id:"delta",name:"Delta",description:"Cumulative change in value",standard:!0,preservesUnits:!0},{id:"step",name:"Step",description:"Minimum interval between values",standard:!0,preservesUnits:!0},{id:"diff",name:"Difference",description:"Difference between first and last values",standard:!0,preservesUnits:!0},{id:"logmin",name:"Min (above zero)",description:"Used for log min scale",standard:!0,preservesUnits:!0},{id:"allIsZero",name:"All Zeros",description:"All values are zero",emptyInputResult:!1,standard:!0,preservesUnits:!0},{id:"allIsNull",name:"All Nulls",description:"All values are null",emptyInputResult:!0,standard:!0,preservesUnits:!1},{id:"changeCount",name:"Change Count",description:"Number of times the value changes",standard:!1,reduce:g,preservesUnits:!1},{id:"distinctCount",name:"Distinct Count",description:"Number of distinct values",standard:!1,reduce:h,preservesUnits:!1},{id:"diffperc",name:"Difference percent",description:"Percentage difference between first and last values",standard:!0,preservesUnits:!1},{id:"allValues",name:"All values",description:"Returns an array with all values",standard:!1,reduce:v=>({allValues:[...v.values]}),preservesUnits:!1},{id:"uniqueValues",name:"All unique values",description:"Returns an array with all unique values",standard:!1,reduce:v=>({uniqueValues:[...new Set(v.values)]}),preservesUnits:!1},...d()]),d=(v=[...Array.from({length:99},(C,T)=>T+1)])=>{const C=[],T=S=>S>3&&S<21?"th":S%10===1?"st":S%10===2?"nd":S%10===3?"rd":"th";return v.forEach(S=>{const O=S/100,x=`p${S}`,b=`${S}${T(S)} %`,M=`${S}${T(S)} percentile value`;C.push({id:x,name:b,description:M,standard:!1,reduce:(A,R,B)=>({[x]:D(A,O,R,B)}),preservesUnits:!0})}),C},p={sum:0,max:-Number.MAX_VALUE,min:Number.MAX_VALUE,logmin:Number.MAX_VALUE,mean:null,last:null,first:null,lastNotNull:null,firstNotNull:null,count:0,nonNullCount:0,allIsNull:!0,allIsZero:!0,range:null,diff:null,delta:0,step:Number.MAX_VALUE,diffperc:0,previousDeltaUp:!0};function c(v,C,T){const S={...p},O=v.values;if(!O)return S;const x=v.type===r.PU.number||v.type===r.PU.time;for(let b=0;b<O.length;b++){let M=O[b];if(b===0&&(S.first=M),S.last=M,M==null){if(C)continue;T&&(M=0)}if(S.count++,M!=null&&!Number.isNaN(M)){const A=S.firstNotNull===null;if(A&&(S.firstNotNull=M),x){if(S.sum+=M,S.allIsNull=!1,S.nonNullCount++,!A){const R=M-S.lastNotNull;S.step>R&&(S.step=R),S.lastNotNull>M?(S.previousDeltaUp=!1,b===O.length-1&&(S.delta+=M)):(S.previousDeltaUp?S.delta+=R:S.delta+=M,S.previousDeltaUp=!0)}M>S.max&&(S.max=M),M<S.min&&(S.min=M),M<S.logmin&&M>0&&(S.logmin=M)}M!==0&&(S.allIsZero=!1),S.lastNotNull=M}}return S.max===-Number.MAX_VALUE&&(S.max=null),S.min===Number.MAX_VALUE&&(S.min=null),S.step===Number.MAX_VALUE&&(S.step=null),S.nonNullCount>0&&(S.mean=S.sum/S.nonNullCount),S.allIsNull&&(S.allIsZero=!1),S.max!==null&&S.min!==null&&(S.range=S.max-S.min),(0,t.isNumber)(S.firstNotNull)&&(0,t.isNumber)(S.lastNotNull)&&(S.diff=S.lastNotNull-S.firstNotNull),(0,t.isNumber)(S.firstNotNull)&&(0,t.isNumber)(S.diff)&&(S.diffperc=S.diff/S.firstNotNull),S}function y(v,C,T){return{first:v.values[0]}}function f(v,C,T){const S=v.values;for(let O=0;O<S.length;O++){const x=S[O];if(x!=null&&!Number.isNaN(x))return{firstNotNull:x}}return{firstNotNull:null}}function P(v,C,T){const S=v.values;return{last:S[S.length-1]}}function a(v,C,T){const S=v.values;let O=S.length-1;for(;O>=0;){const x=S[O--];if(x!=null&&!Number.isNaN(x))return{lastNotNull:x}}return{lastNotNull:null}}function E(v,C,T){if(!(v.type===r.PU.number||v.type===r.PU.time))return{variance:0,stdDev:0};let S=0,O=0,x=0;const b=v.values;for(let M=0;M<b.length;M++){const A=b[M];if(A!=null){x++;let R=O;O+=(A-R)/x,S+=(A-R)*(A-O)}}if(x>0){const M=S/x;return{variance:M,stdDev:Math.sqrt(M)}}return{variance:0,stdDev:0}}function g(v,C,T){const S=v.values;let O=0,x=!0,b=null;for(let M=0;M<S.length;M++){let A=S[M];if(A===null){if(C)continue;T&&(A=0)}!x&&b!==A&&O++,x=!1,b=A}return{changeCount:O}}function h(v,C,T){const S=v.values,O=new Set;for(let x=0;x<S.length;x++){let b=S[x];if(b===null){if(C)continue;T&&(b=0)}O.add(b)}return{distinctCount:O.size}}function D(v,C,T,S){let O=v.values;T&&(O=O.filter(M=>M!==null)),S&&(O=O.map(M=>M===null?0:M));const x=O.slice().sort((M,A)=>M-A),b=Math.round((x.length-1)*C);return x[b]}},34687:(G,I,e)=>{"use strict";e.d(I,{AS:()=>o.AS,C6:()=>o.C6,CF:()=>y.C,Ct:()=>t.Ct,Dq:()=>s.Dq,Em:()=>o.Em,Fy:()=>n.F,H1:()=>d.H1,H3:()=>o.H3,Js:()=>t.Js,KP:()=>u.Fd,MS:()=>c.M,NS:()=>s.NS,NX:()=>d.NX,Nw:()=>o.Nw,OA:()=>d.OA,PP:()=>i.PP,RE:()=>s.RE,Rt:()=>d.Rt,Uh:()=>d.Uh,ZU:()=>d.ZU,c9:()=>r.c,cV:()=>t.cV,cg:()=>d.cg,d$:()=>d.d$,dA:()=>d.dA,g2:()=>u.g2,gy:()=>o.gy,h9:()=>l.h,hI:()=>s.hI,ix:()=>d.ix,jR:()=>t.jR,kK:()=>s.kK,ks:()=>p.ks,m6:()=>m.m,m_:()=>l.m,p3:()=>d.p3,rW:()=>d.rW,rs:()=>d.rs,sJ:()=>s.sJ});var t=e(1173),n=e(18282),s=e(85200),r=e(57934),o=e(75059),m=e(2514),l=e(97497),i=e(58972),u=e(73060),d=e(77678),p=e(50311),c=e(46294),y=e(39624)},85200:(G,I,e)=>{"use strict";e.d(I,{Dq:()=>g,NS:()=>E,RE:()=>P,hI:()=>a,kK:()=>h,sJ:()=>f});var t=e(83077),n=e(7029),s=e(24814),r=e(58972),o=e(72693),m=e(8549),l=e(83855),i=e(60005),u=e(21262),d=e(70218),p=e(55008),c=e(16378),y=e(75754);const f=new t.O(()=>[...(0,o.nz)(),...(0,n._)(),...(0,r.P7)(),...(0,l.W)(),s.u]),P=new t.O(()=>[...(0,o.UM)(),...(0,r.Y7)(),...(0,m.i)()]),a=new t.O(()=>[...(0,u._)(),...(0,d.E)(),...(0,i.d)(),...(0,y.m)(),...(0,p.G)(),...(0,c.z)()]);function E(D){const v=f.get(D.id);if(!v)throw new Error("Unknown field matcher: "+D.id);return v.get(D.options)}function g(D){const v=P.get(D.id);if(!v)throw new Error("Unknown frame matcher: "+D.id);return v.get(D.options)}function h(D){const v=a.get(D.id);if(!v)throw new Error("Unknown value matcher: "+D.id);return v.get(D.options)}},58972:(G,I,e)=>{"use strict";e.d(I,{P7:()=>f,PP:()=>o,Y7:()=>P});var t=e(28240),n=e(54479),s=e(11261),r=e(1173),o=(a=>(a.exclude="exclude",a.include="include",a))(o||{});const m={id:r.Ct.byName,name:"Field Name",description:"match the field name",defaultOptions:"",get:a=>{const g=i(new Set([a]));return(h,D,v)=>a===h.name||a===(0,t.Ct)(h,D,v)||!!(g&&g(h,D,v))},getOptionsDisplayText:a=>`Field name: ${a}`},l={id:r.Ct.byNames,name:"Field Names",description:"match any of the given the field names",defaultOptions:{mode:"include",names:[]},get:a=>{const{names:E,mode:g="include"}=a,h=new Set(E??[]),D=i(h),v=(C,T,S)=>h.has(C.name)||h.has((0,t.Ct)(C,T,S))||!!(D&&D(C,T,S));return g==="exclude"?(C,T,S)=>!v(C,T,S):v},getOptionsDisplayText:a=>{const{names:E,mode:g}=a,h=(E??[]).join(", ");return g==="exclude"?`All except: ${h}`:`All of: ${h}`}};function i(a){let E;return window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback&&(a.has(s.Bc)?E=(h,D)=>!!h.labels&&h.labels?.__name__===h.name:(a.has("Time")||a.has("time"))&&(E=(h,D)=>D.meta?.typeVersion==null&&h.type===s.PU.time)),E}const u={id:r.Ct.byRegexp,name:"Field Name by Regexp",description:"match the field name by a given regexp pattern",defaultOptions:"/.*/",get:a=>{const E=c(a);return(g,h,D)=>{const v=(0,t.Ct)(g,h,D);return!!E&&E.test(v)}},getOptionsDisplayText:a=>`Field name by pattern: ${a}`},d={id:r.Ct.byFrameRefID,name:"Fields by frame refId",description:"match all fields returned in data frame with refId.",defaultOptions:"",get:a=>(E,g,h)=>g.refId===a,getOptionsDisplayText:a=>`Math all fields returned by query with reference ID: ${a}`},p={id:r.Ct.byRegexpOrNames,name:"Field Name by Regexp or Names",description:"match the field name by a given regexp pattern or given names",defaultOptions:{pattern:"/.*/",names:[]},get:a=>{const E=u.get(a?.pattern||""),g=l.get({mode:"include",names:a?.names??[]});return(h,D,v)=>g(h,D,v)||E(h,D,v)},getOptionsDisplayText:a=>{const E=a?.pattern??"",g=a?.names?.join(",")??"";return`Field name by pattern: ${E} or names: ${g}`}},c=a=>{if(a)try{return(0,n.dO)(a)}catch(E){console.error(E);return}},y={id:r.jR.byName,name:"Frame Name",description:"match the frame name",defaultOptions:"/.*/",get:a=>{const E=(0,n.dO)(a);return g=>E.test(g.name||"")},getOptionsDisplayText:a=>`Frame name: ${a}`};function f(){return[m,u,l,p,d]}function P(){return[y]}},72693:(G,I,e)=>{"use strict";e.d(I,{UM:()=>D,Yg:()=>d,nz:()=>h,zx:()=>y});var t=e(11261),n=e(85200),s=e(1173);const r={id:s.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:v=>{const C=v.map(T=>(0,n.NS)(T));return(T,S,O)=>{for(const x of C)if(x(T,S,O))return!0;return!1}},getOptionsDisplayText:v=>{let C="";for(const T of v){C.length>0&&(C+=" OR ");const S=n.sJ.get(T.id);C+=S.getOptionsDisplayText?S.getOptionsDisplayText(T):S.name}return C}},o={id:s.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:v=>{const C=v.map(T=>(0,n.Dq)(T));return T=>{for(const S of C)if(S(T))return!0;return!1}},getOptionsDisplayText:v=>{let C="";for(const T of v){C.length>0&&(C+=" OR ");const S=n.RE.get(T.id);C+=S.getOptionsDisplayText?S.getOptionsDisplayText(T):S.name}return C}},m={id:s.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:v=>{const C=v.map(T=>(0,n.NS)(T));return(T,S,O)=>{for(const x of C)if(!x(T,S,O))return!1;return!0}},getOptionsDisplayText:v=>{let C="";for(const T of v){C.length>0&&(C+=" AND ");const S=n.sJ.get(T.id);C+=S.getOptionsDisplayText?S.getOptionsDisplayText(T):S.name}return C}},l={id:s.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:v=>{const C=v.map(T=>(0,n.Dq)(T));return T=>{for(const S of C)if(!S(T))return!1;return!0}},getOptionsDisplayText:v=>{let C="";for(const T of v){C.length>0&&(C+=" AND ");const S=n.RE.get(T.id);C+=S.getOptionsDisplayText?S.getOptionsDisplayText(T):S.name}return C}},i={id:s.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:v=>{const C=(0,n.NS)(v);return(T,S,O)=>!C(T,S,O)},getOptionsDisplayText:v=>{const C=n.sJ.get(v.id);return"NOT "+(C.getOptionsDisplayText?C.getOptionsDisplayText(v.options):C.name)}},u={id:s.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:v=>{const C=(0,n.Dq)(v);return T=>!C(T)},getOptionsDisplayText:v=>{const C=n.RE.get(v.id);return"NOT "+(C.getOptionsDisplayText?C.getOptionsDisplayText(v.options):C.name)}},d=v=>!0,p=v=>!0,c=v=>!1,y=v=>v.type!==t.PU.time,f=v=>!1,P={id:s.cV.alwaysMatch,name:"All Fields",description:"Always Match",get:v=>d,getOptionsDisplayText:v=>"Always"},a={id:s.cV.alwaysMatch,name:"All Frames",description:"Always Match",get:v=>p,getOptionsDisplayText:v=>"Always"},E={id:s.cV.neverMatch,name:"No Fields",description:"Never Match",excludeFromPicker:!0,get:v=>c,getOptionsDisplayText:v=>"Never"},g={id:s.cV.neverMatch,name:"No Frames",description:"Never Match",get:v=>f,getOptionsDisplayText:v=>"Never"};function h(){return[r,m,i,P,E]}function D(){return[o,l,u,a,g]}},97497:(G,I,e)=>{"use strict";e.d(I,{h:()=>s,m:()=>n});var t=e(83077),n=(r=>(r.Combine="combine",r.CalculateNewFields="calculateNewFields",r.CreateNewVisualization="createNewVisualization",r.Filter="filter",r.PerformSpatialOperations="performSpatialOperations",r.Reformat="reformat",r.ReorderAndRename="reorderAndRename",r))(n||{});const s=new t.O},2514:(G,I,e)=>{"use strict";e.d(I,{m:()=>u});var t=e(62467),n=e(69862),s=e(81160),r=e(85200),o=e(97497);const m=(p,c)=>y=>{const f=o.h.get(p.id);if(!f)return y;const a={...f.transformation.defaultOptions??{},...p.options},E=p.filter?.options?(0,r.Dq)(p.filter):void 0;return y.pipe((0,n.Z)(g=>(0,t.of)(l(g,E)).pipe(f.transformation.operator(a,c),i(g,f,E))))};function l(p,c){return c?p.filter(y=>c(y)):p}const i=(p,c,y)=>f=>f.pipe((0,s.T)(P=>{if(P===p)return P;if(y){let a=0;const E=p.filter((g,h)=>{const D=!y(g);return D&&!a&&(a=h),D});E.length&&P.splice(a,0,...E)}return P}));function u(p,c,y){const f=(0,t.of)(c);if(!p.length)return f;const P=[],a=y??{interpolate:E=>E};for(let E=0;E<p.length;E++){const g=p[E];if(d(g))P.push(g(a));else{if(g.disabled)continue;P.push(m(g,a))}}return f.pipe.apply(f,P)}function d(p){return typeof p=="function"}},57934:(G,I,e)=>{"use strict";e.d(I,{c:()=>he});var t=e(66350),n=e(82150),s=e(50311),r=e(34125),o=e(64224),m=e(35602),l=e(1173),i=e(18282);const u={id:i.F.filterByRefId,name:"Filter data by query refId",description:"select a subset of results",defaultOptions:{},operator:(de,le)=>pe=>{const ve={};return de.include&&(ve.include={id:l.jR.byRefId,options:de.include}),de.exclude&&(ve.exclude={id:l.jR.byRefId,options:de.exclude}),pe.pipe(o.I.operator(ve,le))}};var d=e(73376),p=e(15400),c=e(81160),y=e(28240),f=e(81010);const P={id:i.F.formatTime,name:"Format time",description:"Set the output format of a time field",defaultOptions:{timeField:"",outputFormat:"",useTimezone:!0},isApplicable:de=>{for(const le of de)for(const pe of le.fields)if(pe.type==="time")return f.M.Applicable;return f.M.NotApplicable},isApplicableDescription:"The Format time transformation requires a time field to work. No time field could be found.",operator:(de,le)=>pe=>pe.pipe((0,c.T)(ve=>a(de,ve,le)))},a=({timeField:de,outputFormat:le,timezone:pe},ve,be)=>!Array.isArray(ve)||ve.length===0?ve:((0,y.Fm)(ve),le=be?.interpolate(le)??le,ve.map(Oe=>({...Oe,fields:Oe.fields.map(Me=>(Me.state?.displayName===de&&(Me=(0,s.Xv)(Me,le,{timeZone:pe})),Me))})));var E=e(25094),g=e(68133),h=e(11261),D=e(85200);const v="Time",C="Time",T="Value",S=f.N.Empty,O=window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback,x={id:i.F.groupingToMatrix,name:"Grouping to Matrix",description:"Groups series by field and return a matrix visualisation",defaultOptions:{columnField:v,rowField:C,valueField:T},isApplicable:de=>{let le=0;for(const pe of de)le+=pe.fields.length;return le>=3?f.M.Applicable:f.M.NotApplicable},isApplicableDescription:de=>{let le=0;for(const pe of de)le+=pe.fields.length;return`Grouping to matrix requiers at least 3 fields to work. Currently there are ${le} fields.`},operator:de=>le=>le.pipe((0,c.T)(pe=>{const ve=de.columnField||v,be=de.rowField||C,Oe=de.valueField||T,Me=de.emptyValue||S;if(pe.length!==1)return pe;const Ue=pe[0],we=M(Ue,ve),Re=M(Ue,be),Fe=M(Ue,Oe),xe=`${be}\\${ve}`;if(!we||!Re||!Fe)return pe;const Ve=b(we.values),$e=b(Re.values),Xe={};for(let Dt=0;Dt<Fe.values.length;Dt++){const nt=we.values[Dt],at=Re.values[Dt],Ae=Fe.values[Dt];Xe[nt]||(Xe[nt]={}),Xe[nt][at]=Ae}const gt=[{name:xe,values:$e,type:h.PU.string,config:{}}];for(const Dt of Ve){let nt=[];for(const at of $e){const Ae=Xe[Dt][at]??A(Me);nt.push(Ae)}O&&typeof Dt=="number"&&(Fe.config={...Fe.config,displayNameFromDS:void 0}),gt.push({name:Dt.toString(),values:nt,config:Fe.config,type:Fe.type})}return[{fields:gt,length:$e.length}]}))};function b(de){const le=new Set;for(let pe=0;pe<de.length;pe++)le.add(de[pe]);return Array.from(le)}function M(de,le){for(let pe=0;pe<de.fields.length;pe++){const ve=de.fields[pe];let be;if(O?be=D.sJ.get(l.Ct.byName).get(le)(ve,de,[de]):be=le===(0,y.Ct)(ve),be)return ve}return null}function A(de){switch(de){case f.N.False:return!1;case f.N.True:return!0;case f.N.Null:return null;case f.N.Empty:default:return""}}var R=e(77678),B=e(41511),U=e(6829),W=e(67641);const N=10,w={id:i.F.limit,name:"Limit",description:"Limit the number of items to the top N",defaultOptions:{limitField:N},operator:(de,le)=>pe=>pe.pipe((0,c.T)(ve=>{let be=N;return de.limitField!==void 0&&(typeof de.limitField=="string"?(0,W.w)()?be=parseInt(le.interpolate(de.limitField),10):be=parseInt(de.limitField,10):be=de.limitField),ve.map(Oe=>Oe.length>be?{...Oe,fields:Oe.fields.map(Me=>({...Me,values:Me.values.slice(0,be)})),length:be}:Oe)}))};var L=e(58140),V=e(64586),K=e(82280);const k={id:i.F.rename,name:"Rename fields by name",description:"Rename fields based on configuration given by user",defaultOptions:{renameByName:{}},operator:de=>le=>le.pipe((0,c.T)(pe=>{const ve=j(de.renameByName);return!Array.isArray(pe)||pe.length===0?pe:pe.map(be=>({...be,fields:ve(be)}))}))},j=de=>le=>!de||Object.keys(de).length===0?le.fields:le.fields.map(pe=>{const ve=(0,y.Ct)(pe,le),be=de[ve];return typeof be!="string"||be.length===0?pe:{...pe,config:{...pe.config,displayName:be},state:{...pe.state,displayName:be}}}),H={id:i.F.organize,name:"Organize fields by name",description:"Order, filter and rename fields based on configuration given by user",defaultOptions:{excludeByName:{},indexByName:{},renameByName:{},includeByName:{}},isApplicable:de=>de.length>1?f.M.NotPossible:f.M.Applicable,operator:(de,le)=>pe=>pe.pipe(m.D.operator({include:de.includeByName?{names:J(de.includeByName)}:void 0,exclude:{names:J(de.excludeByName)}},le),K.x.operator(de,le),k.operator(de,le))},J=de=>de?Object.keys(de).filter(le=>de[le]):[];var X=e(21128),se=e(54479);const ae={id:i.F.renameByRegex,name:"Rename fields by regex",description:"Rename fields based on regular expression by users.",defaultOptions:{regex:"(.*)",renamePattern:"$1"},operator:de=>le=>le.pipe((0,c.T)(pe=>!Array.isArray(pe)||pe.length===0?pe:pe.map(ne(de))))},ne=de=>le=>{const pe=(0,se.dO)(de.regex),ve=le.fields.map(be=>{const Oe=(0,y.Ct)(be,le);if(!pe.test(Oe))return be;const Me=Oe.replace(pe,de.renamePattern);return{...be,config:{...be.config,displayName:Me},state:{...be.state,displayName:Me}}});return{...le,fields:ve}};var q=e(2543),ee=e(37471),z=e(14236),te=e(19845);const ie={id:i.F.seriesToRows,name:"Series to rows",description:"Combines multiple series into a single serie and appends a column with metric name per value.",defaultOptions:{},operator:de=>le=>le.pipe((0,c.T)(pe=>{if(!Array.isArray(pe)||pe.length===0||(pe=pe.filter(Ue=>Ue.length>0),!(0,te.jq)(pe)))return pe;const ve={},be=new Set,Oe=new ee.k,Me={name:h.aI,values:[],config:{},type:h.PU.string};for(let Ue=0;Ue<pe.length;Ue++){const we=pe[Ue];for(let Re=0;Re<we.fields.length;Re++){const Fe=we.fields[Re];if(Fe.type===h.PU.time){ve[Ue]=Re,be.has(h.LE)||(Oe.addField(ce(Fe,h.LE)),Oe.addField(Me),be.add(h.LE));continue}be.has(h.Bc)||(Oe.addField(ce(Fe,h.Bc)),be.add(h.Bc))}}for(let Ue=0;Ue<pe.length;Ue++){const we=pe[Ue];for(let Re=0;Re<we.length;Re++){const Fe=ve[Ue],xe=Fe===0?1:0;Oe.add({[h.LE]:we.fields[Fe].values[Re],[h.aI]:(0,y.Ri)(we),[h.Bc]:we.fields[xe].values[Re]})}}return[(0,z.ES)(Oe,0,!0)]}))},ce=(de,le)=>({...(0,q.omit)(de,["values","state","labels","config","name"]),name:le,values:[],config:{...(0,q.omit)(de.config,["displayName","displayNameFromDS"])}}),ue={id:i.F.sortBy,name:"Sort by",description:"Sort fields in a frame.",defaultOptions:{fields:{}},operator:(de,le)=>pe=>pe.pipe((0,c.T)(ve=>!Array.isArray(ve)||ve.length===0||!de?.sort?.length?ve:fe(ve,de.sort,le)))};function fe(de,le,pe){return de.map(ve=>{const be=Te(ve,le,pe);return be.length&&be[0].index!=null?(0,z.ES)(ve,be[0].index,be[0].desc):ve})}function Te(de,le,pe){return le.map(ve=>ve.index!=null?ve:(0,W.w)()?{...ve,index:de.fields.findIndex(be=>pe.interpolate(ve.field)===(0,y.Ct)(be,de))}:{...ve,index:de.fields.findIndex(be=>ve.field===(0,y.Ct)(be,de))})}const he={noopTransformer:V.W,filterFieldsTransformer:o.z,filterFieldsByNameTransformer:m.D,filterFramesTransformer:o.I,filterFramesByRefIdTransformer:u,filterByValueTransformer:d.Sv,formatStringTransformer:p.yt,formatTimeTransformer:P,orderFieldsTransformer:K.x,organizeFieldsTransformer:H,reduceTransformer:X.Wj,concatenateTransformer:n.vz,calculateFieldTransformer:t.SC,joinByFieldTransformer:B.L,seriesToColumnsTransformer:B.L,seriesToRowsTransformer:ie,renameFieldsTransformer:k,labelsToFieldsTransformer:U.V,ensureColumnsTransformer:r.b,groupByTransformer:E.of,sortByTransformer:ue,mergeTransformer:L.o,renameByRegexTransformer:ae,histogramTransformer:R.OA,convertFieldTypeTransformer:s.zM,groupingToMatrixTransformer:x,limitTransformer:w,groupToNestedTable:g._}},66350:(G,I,e)=>{"use strict";e.d(I,{Bp:()=>E,SC:()=>T,UY:()=>a,Uj:()=>D,ip:()=>g,sw:()=>N});var t=e(2543),n=e.n(t),s=e(81160),r=e(14236),o=e(28240),m=e(11261),l=e(39070),i=e(11710),u=e(27618),d=e(75059),p=e(85200),c=e(1173),y=e(34125),f=e(18282),P=e(64586),a=(w=>(w.ReduceRow="reduceRow",w.CumulativeFunctions="cumulativeFunctions",w.WindowFunctions="windowFunctions",w.BinaryOperation="binary",w.UnaryOperation="unary",w.Index="index",w))(a||{}),E=(w=>(w.Percentage="percentage",w.Fixed="fixed",w))(E||{}),g=(w=>(w.Trailing="trailing",w.Centered="centered",w))(g||{});const h={reducer:d.gy.sum},D={reducer:d.gy.mean,windowAlignment:"trailing",windowSizeMode:"percentage",windowSize:.1},v={left:"",operator:i.k.Add,right:""},C={operator:u._.Abs,fieldName:""},T={id:f.F.calculateField,name:"Add field from calculation",description:"Use the row values to calculate a new field",defaultOptions:{mode:"reduceRow",reduce:{reducer:d.gy.sum}},operator:(w,L)=>V=>{const K=w&&w.timeSeries!==!1?y.b.operator(null,L):P.W.operator({},L);return w.alias!=null&&(w.alias=L.interpolate(w.alias)),V.pipe(K,(0,s.T)(k=>{const j=w.mode??"reduceRow";let H;switch(j){case"reduceRow":H=R((0,t.defaults)(w.reduce,h),k);break;case"cumulativeFunctions":H=A((0,t.defaults)(w.cumulative,h),k);break;case"windowFunctions":H=S((0,t.defaults)(w.window,D),k);break;case"unary":H=W((0,t.defaults)(w.unary,C),k);break;case"binary":const J={...w.binary,left:L.interpolate(w.binary?.left),right:L.interpolate(w.binary?.right)};H=U((0,t.defaults)(J,v),k);break;case"index":return k.map(X=>{const se=[...Array(X.length).keys()];if(w.index?.asPercentile)for(let ne=0;ne<se.length;ne++)se[ne]=se[ne]/se.length;const ae={name:w.alias??"Row",type:m.PU.number,values:se,config:w.index?.asPercentile?{unit:"percentunit"}:{}};return{...X,fields:w.replaceFields?[ae]:[...X.fields,ae]}})}return H?k.map(J=>{const X=H(J);if(!X)return J;const se={name:N(w),type:m.PU.number,config:{},values:X};let ae=[];if(w.replaceFields){const{timeField:ne}=(0,r.KR)(J);ne&&w.timeSeries!==!1?ae=[ne,se]:ae=[se]}else ae=[...J.fields,se];return{...J,fields:ae}}):k}))}};function S(w,L){if(w.windowSize<=0)throw new Error("Add field from calculation transformation - Window size must be larger than 0");let V=(0,p.NS)({id:c.Ct.numeric});return w.field&&(V=(0,p.NS)({id:c.Ct.byNames,options:{names:[w.field]}})),K=>{const k=Math.ceil(w.windowSize*(w.windowSizeMode==="percentage"?K.length:1));let j=null;for(const H of K.fields)if(V(H,K,L)){j=H;break}if(j){if(![d.gy.mean,d.gy.stdDev,d.gy.variance].includes(w.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${w.reducer}`);return w.windowAlignment==="centered"?x(K,w.reducer,j,k):O(K,w.reducer,j,k)}}}function O(w,L,V,K){const k=[];let j=0,H=0;for(let J=0;J<w.length;J++)if(L===d.gy.mean){const X=V.values[J];X!=null&&(H++,j+=X,J>K-1&&(j-=V.values[J-K],H--)),k.push(H===0?0:j/H)}else if(L===d.gy.variance){const X=Math.max(0,J-K+1),se=J+1;k.push(b(V.values.slice(X,se)))}else if(L===d.gy.stdDev){const X=Math.max(0,J-K+1),se=J+1;k.push(M(V.values.slice(X,se)))}return k}function x(w,L,V,K){const k=[];let j=0,H=0;const J=Math.ceil(K/2)-1,X=Math.floor(K/2);for(let se=0;se<w.length;se++){const ae=se-X,ne=se+J;if(L===d.gy.mean){if(se===0)for(let q=0;q<J+1&&q<V.values.length;q++)V.values[q]!=null&&(j+=V.values[q],H++);else ne<V.values.length&&V.values[ne]!=null&&(j+=V.values[ne],H++),ae>0&&V.values[ae-1]!=null&&(j-=V.values[ae-1],H--);k.push(H===0?0:j/H)}else if(L===d.gy.variance){const q=V.values.slice(Math.max(0,ae),Math.min(ne+1,V.values.length));k.push(b(q))}else if(L===d.gy.stdDev){const q=V.values.slice(Math.max(0,ae),Math.min(ne+1,V.values.length));k.push(M(q))}}return k}function b(w){if(w.length<1)return 0;let L=0,V=0,K=0;for(let j=0;j<w.length;j++){const H=w[j];if(H!=null){K++;let J=V;V+=(H-J)/K,L+=(H-J)*(H-V)}}return K===0?0:L/K}function M(w){return Math.sqrt(b(w))}function A(w,L){let V=(0,p.NS)({id:c.Ct.numeric});if(w.field&&(V=(0,p.NS)({id:c.Ct.byNames,options:{names:[w.field]}})),![d.gy.mean,d.gy.sum].includes(w.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${w.reducer}`);return K=>{let k=null;for(const J of K.fields)if(V(J,K,L)){k=J;break}if(!k)return;const j=[];let H=0;for(let J=0;J<K.length;J++)H+=k.values[J]??0,w.reducer===d.gy.sum?j.push(H):w.reducer===d.gy.mean&&j.push(H/(J+1));return j}}function R(w,L){let V=(0,p.NS)({id:c.Ct.numeric});w.include&&w.include.length&&(V=(0,p.NS)({id:c.Ct.byNames,options:{names:w.include}}));const K=d.AS.get(w.reducer);if(!K)throw new Error(`Unknown reducer: ${w.reducer}`);const k=K.reduce??d.H3,j=w.nullValueMode===l.UW.Ignore,H=w.nullValueMode===l.UW.AsZero;return J=>{const X=[];for(const q of J.fields)V(q,J,L)&&X.push(q.values);const se=X.length,ae={name:"temp",values:new Array(se),type:m.PU.number,config:{}},ne=[];for(let q=0;q<J.length;q++){for(let ee=0;ee<se;ee++)ae.values[ee]=X[ee][q];ne.push(k(ae,j,H)[w.reducer])}return ne}}function B(w,L,V){if(!L)return;for(const k of w.fields)if(L===(0,o.Ct)(k,w,V))return k.type===m.PU.boolean?k.values.map(j=>j?1:0):k.values;const K=parseFloat(L);if(!isNaN(K))return new Array(w.length).fill(K)}function U(w,L){const V=i.b.getIfExists(w.operator);return K=>{const k=B(K,w.left,L),j=B(K,w.right,L);if(!k||!j||!V)return;const H=new Array(k.length);for(let J=0;J<H.length;J++)H[J]=V.operation(k[J],j[J]);return H}}function W(w,L){const V=u.j.getIfExists(w.operator);return K=>{let k=[];for(const H of K.fields)w.fieldName===(0,o.Ct)(H,K,L)&&H.type===m.PU.number&&(k=H.values);if(!k.length||!V)return;const j=new Array(k.length);for(let H=0;H<j.length;H++)j[H]=V.operation(k[H]);return j}}function N(w){if(w.alias?.length)return w.alias;switch(w.mode){case"cumulativeFunctions":{const{cumulative:L}=w;return`cumulative ${L?.reducer??""}${L?.field?`(${L.field})`:""}`}case"windowFunctions":{const{window:L}=w;return`${L?.windowAlignment??""} moving ${L?.reducer??""}${L?.field?`(${L.field})`:""}`}case"unary":{const{unary:L}=w;return`${L?.operator??""}${L?.fieldName?`(${L.fieldName})`:""}`}case"binary":{const{binary:L}=w;return`${L?.left??""} ${L?.operator??""} ${L?.right??""}`.replace(/\$/g,"")}case"reduceRow":{const L=d.AS.getIfExists(w.reduce?.reducer);if(L)return L.name}break;case"index":return"Row"}return"math"}},82150:(G,I,e)=>{"use strict";e.d(I,{vz:()=>o,x1:()=>r});var t=e(81160),n=e(11261),s=e(18282),r=(l=>(l.Drop="drop",l.FieldName="field",l.Label="label",l))(r||{});const o={id:s.F.concatenate,name:"Concatenate fields",description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",defaultOptions:{frameNameMode:"field",frameNameLabel:"frame"},operator:l=>i=>i.pipe((0,t.T)(u=>!Array.isArray(u)||u.length<2?u:[m(u,l)]))};function m(l,i){let u=!0,d=l[0].length;const p=i.frameNameLabel??"frame";let c=[];for(const y of l){d!==y.length&&(u=!1,d=Math.max(d,y.length));for(const f of y.fields){const P={...f};P.state=void 0,y.name&&(i.frameNameMode==="drop"||(i.frameNameMode==="label"?(P.labels={...f.labels},P.labels[p]=y.name):!P.name||P.name===n.Bc?P.name=y.name:P.name=`${y.name} \xB7 ${f.name}`)),c.push(P)}}return u||(c=c.map(y=>{if(y.values.length===d)return y;const f=y.values.slice();return f.length=d,{...y,values:f}})),{fields:c,length:d}}},50311:(G,I,e)=>{"use strict";e.d(I,{Xv:()=>f,ks:()=>a,s7:()=>u,zM:()=>l});var t=e(81160),n=e(53531),s=e(11261),r=e(85200),o=e(1173),m=e(18282);const l={id:m.F.convertFieldType,name:"Convert field type",description:"Convert a field to a specified field type.",defaultOptions:{fields:{},conversions:[{targetField:void 0,destinationType:void 0,dateFormat:void 0,timezone:void 0}]},operator:(g,h)=>D=>D.pipe((0,t.T)(v=>l.transformer(g,h)(v))),transformer:g=>h=>!Array.isArray(h)||h.length===0?h:i(g,h)??[]};function i(g,h){if(!g.conversions.length)return h;const D=h.map(v=>({...v}));for(const v of g.conversions){if(!v.targetField)continue;const C=r.sJ.get(o.Ct.byName).get(v.targetField);for(const T of D)T.fields=T.fields.map(S=>C(S,T,D)?u(S,v):S)}return D}function u(g,h){switch(h.destinationType){case s.PU.time:return a(g,h.dateFormat);case s.PU.number:return c(g);case s.PU.string:return f(g,h.dateFormat,{timeZone:h.timezone},h.joinWith);case s.PU.boolean:return y(g);case s.PU.enum:return E(g,h.enumConfig);case s.PU.other:return P(g);default:return g}}const d=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/;function p(g,h){let D=h?{format:h}:void 0;const v=g.values.slice();let C=v.find(S=>S!=null),T=typeof C=="string"&&d.test(C);for(let S=0;S<v.length;S++)if(v[S]){let O=T?Date.parse(v[S]):(0,n.b)(v[S],D).valueOf();v[S]=Number.isFinite(O)?O:null}else v[S]=null;return{...g,type:s.PU.time,values:v}}function c(g){const h=g.values.slice(),D=h.some(v=>typeof v=="string");for(let v=0;v<h.length;v++){let C=h[v];D&&C!=null&&typeof C=="string"&&(C=C.replace(/,/g,""));const T=+C;h[v]=Number.isFinite(T)?T:null}return{...g,type:s.PU.number,values:h}}function y(g){const h=g.values.slice();for(let D=0;D<h.length;D++)h[D]=!!h[D];return{...g,type:s.PU.boolean,values:h}}function f(g,h,D,v){let C=g.values;switch(g.type){case s.PU.time:C=C.map(T=>(0,n.b)(T,D).format(h));break;case s.PU.other:C=C.map(T=>v?.length&&Array.isArray(T)?T.join(v):JSON.stringify(T));break;default:C=C.map(T=>`${T}`)}return{...g,type:s.PU.string,values:C}}function P(g){const h=g.values.slice();for(let D=0;D<h.length;D++)try{h[D]=JSON.parse(h[D])}catch{h[D]=null}return{...g,type:s.PU.other,values:h}}function a(g,h){const D=typeof g.values[0]=="number";return g.type===s.PU.time&&D?g:D?{...g,type:s.PU.time}:p(g,h)}function E(g,h){const D={...h},v=g.values.slice(),C=new Map;if(D.text&&D.text.length>0)for(let T=0;T<D.text.length;T++)C.set(D.text[T],T);else return g;for(let T=0;T<v.length;T++){const S=v[T];v[T]=C.get(S)}return{...g,config:{...g.config,type:{enum:D}},type:s.PU.enum,values:v}}},34125:(G,I,e)=>{"use strict";e.d(I,{b:()=>o});var t=e(81160),n=e(14236),s=e(18282),r=e(41511);const o={id:s.F.ensureColumns,name:"Ensure Columns Transformer",description:"Will check if current data frames is series or columns. If in series it will convert to columns.",operator:(l,i)=>u=>u.pipe((0,t.T)(d=>o.transformer(l,i)(d))),transformer:(l,i)=>u=>{const d=m(u);return u.length>1&&d?r.L.transformer({byField:d},i)(u):u}};function m(l){let i;for(const u of l){const{timeField:d}=(0,n.KR)(u);if(!d)return;if(!i)i=d.name;else if(i!==d.name)return}return i}},64224:(G,I,e)=>{"use strict";e.d(I,{I:()=>m,z:()=>o});var t=e(81160),n=e(85200),s=e(18282),r=e(64586);const o={id:s.F.filterFields,name:"Filter Fields",description:"select a subset of fields",defaultOptions:{},operator:(l,i)=>u=>!l.include&&!l.exclude?u.pipe(r.W.operator({},i)):(typeof l.include?.options=="string"?l.include.options=i.interpolate(l.include?.options):typeof l.include?.options?.pattern=="string"&&(l.include.options.pattern=i.interpolate(l.include?.options.pattern)),typeof l.exclude?.options=="string"?l.exclude.options=i.interpolate(l.exclude?.options):typeof l.exclude?.options?.pattern=="string"&&(l.exclude.options.pattern=i.interpolate(l.exclude?.options.pattern)),u.pipe((0,t.T)(d=>{const p=l.include?(0,n.NS)(l.include):null,c=l.exclude?(0,n.NS)(l.exclude):null,y=[];for(const f of d){const P=[];for(let E=0;E<f.fields.length;E++){const g=f.fields[E];if(c){if(c(g,f,d))continue;p||P.push(g)}p&&p(g,f,d)&&P.push(g)}if(!P.length)continue;const a={...f,fields:P};y.push(a)}return y})))},m={id:s.F.filterFrames,name:"Filter Frames",description:"select a subset of frames",defaultOptions:{},operator:(l,i)=>u=>!l.include&&!l.exclude?u.pipe(r.W.operator({},i)):u.pipe((0,t.T)(d=>{const p=l.include?(0,n.Dq)(l.include):null,c=l.exclude?(0,n.Dq)(l.exclude):null,y=[];for(const f of d){if(c){if(c(f))continue;p||y.push(f)}p&&p(f)&&y.push(f)}return y}))}},35602:(G,I,e)=>{"use strict";e.d(I,{D:()=>r,R:()=>o});var t=e(1173),n=e(64224),s=e(18282);const r={id:s.F.filterFieldsByName,name:"Filter fields by name",description:"select a subset of fields",defaultOptions:{},operator:(m,l)=>i=>i.pipe(n.z.operator({include:o(l,m.include,m.byVariable),exclude:o(l,m.exclude,m.byVariable)},l))},o=(m,l,i)=>{if(!l)return;const{names:u,pattern:d,variable:p}=l;if(i&&p){const c=m.interpolate(p);if(/\{.*\}/.test(c)){const y=c.slice(1).slice(0,-1).split(",");return{id:t.Ct.byNames,options:{names:y}}}return{id:t.Ct.byNames,options:{names:c.split(",")}}}if(!((!Array.isArray(u)||u.length===0)&&!d))return d?!Array.isArray(u)||u.length===0?{id:t.Ct.byRegexp,options:d}:{id:t.Ct.byRegexpOrNames,options:l}:{id:t.Ct.byNames,options:{names:u}}}},73376:(G,I,e)=>{"use strict";e.d(I,{Sm:()=>u,Sv:()=>d,j4:()=>i});var t=e(81160),n=e(28240),s=e(85200),r=e(1173),o=e(18282),m=e(64586),l=e(67641),i=(y=>(y.exclude="exclude",y.include="include",y))(i||{}),u=(y=>(y.all="all",y.any="any",y))(u||{});const d={id:o.F.filterByValue,name:"Filter data by values",description:"select a subset of results based on values",defaultOptions:{filters:[],type:"include",match:"any"},operator:(y,f)=>P=>{const a=y.filters,E=y.match==="all",g=y.type==="include";if(!Array.isArray(a)||a.length===0)return P.pipe(m.W.operator({},f));const h=[];return(0,l.w)()&&h.push(...a.map(D=>{if(D.config.id===r.Js.between){const v=f.interpolate(D.config.options.from),C=f.interpolate(D.config.options.to);return{...D,config:{...D.config,options:{...D.config.options,to:C,from:v}}}}else{if(D.config.id===r.Js.regex)return D;if(D.config.options.value){const v=f.interpolate(D.config.options.value),C={...D,config:{...D.config,options:{...D.config.options,value:v}}};return C.config.options.value=v,C}}return D})),P.pipe((0,t.T)(D=>{if(D.length===0)return D;const v=[],C=c(D);for(const T of D){const S=new Set;let O;(0,l.w)()?O=p(h,C):O=p(a,C);for(let M=0;M<T.length;M++){if(S.has(M))continue;let A=!0;for(const R of O){const B=R(M,T,D);if(!E&&B){A=!0;break}if(E&&!B){A=!1;break}A=B}A&&S.add(M)}const x=[],b=g?S.size:D[0].length-S.size;for(const M of T.fields){const A=[];for(let R=0;R<T.length;R++){if(g&&S.has(R)){A.push(M.values[R]);continue}if(!g&&!S.has(R)){A.push(M.values[R]);continue}}x.push({...M,values:A,state:{}})}v.push({...T,fields:x,length:b})}return v}))}},p=(y,f)=>{const P=()=>!1;return y.map(a=>{const E=f[a.fieldName]??-1;if(E<0)return console.warn(`[FilterByValue] Could not find index for field name: ${a.fieldName}`),P;const g=(0,s.kK)(a.config);return(h,D,v)=>g(h,D.fields[E],D,v)})},c=y=>{const f={};for(const P of y)P.fields.forEach((a,E)=>{const g=(0,n.Ct)(a,P,y);f[g]=E});return f}},15400:(G,I,e)=>{"use strict";e.d(I,{gs:()=>l,yt:()=>d});var t=e(81160),n=e(11261),s=e(81010),r=e(85200),o=e(1173),m=e(18282),l=(c=>(c.UpperCase="Upper Case",c.LowerCase="Lower Case",c.SentenceCase="Sentence Case",c.TitleCase="Title Case",c.PascalCase="Pascal Case",c.CamelCase="Camel Case",c.SnakeCase="Snake Case",c.KebabCase="Kebab Case",c.Trim="Trim",c.Substring="Substring",c))(l||{});const i=c=>{const y=c.split(" ");for(let f=0;f<y.length;f++)y[f]=y[f].charAt(0).toUpperCase()+y[f].slice(1).toLowerCase();return y},u=c=>y=>y.values.map(f=>{switch(c.outputFormat){case"Upper Case":return f.toUpperCase();case"Lower Case":return f.toLowerCase();case"Sentence Case":return f.charAt(0).toUpperCase()+f.slice(1);case"Title Case":return i(f).join(" ");case"Pascal Case":return i(f).join("");case"Camel Case":return f=i(f).join(""),f.charAt(0).toLowerCase()+f.slice(1);case"Snake Case":return f.toLowerCase().split(" ").join("_");case"Kebab Case":return f.toLowerCase().split(" ").join("-");case"Trim":return f.trim();case"Substring":return f.substring(c.substringStart,c.substringEnd)}}),d={id:m.F.formatString,name:"Format string",description:"Manipulate string fields formatting",defaultOptions:{stringField:"",outputFormat:"Upper Case"},isApplicable:c=>{for(const y of c)for(const f of y.fields)if(f.type==="string")return s.M.Applicable;return s.M.NotApplicable},operator:c=>y=>y.pipe((0,t.T)(f=>{if(f.length===0)return f;const P=r.sJ.get(o.Ct.byName).get(c.stringField),a=u(c),E=p(P,a);return f.map(g=>({...g,fields:E(g,f)}))}))},p=(c,y)=>(f,P)=>f.fields.map(a=>{if(c(a,f,P)){const E=y(a);return{...a,type:n.PU.string,values:E}}return a})},25094:(G,I,e)=>{"use strict";e.d(I,{Ce:()=>a,R3:()=>d,Y2:()=>P,of:()=>p});var t=e(81160),n=e(14236),s=e(28240),r=e(81010),o=e(11261),m=e(75059),l=e(18282),i=e(67641);const u=2;var d=(E=>(E.aggregate="aggregate",E.groupBy="groupby",E))(d||{});const p={id:l.F.groupBy,name:"Group by",description:"Group the data by a field values then process calculations for each group.",defaultOptions:{fields:{}},isApplicable:E=>(0,i.f)(E)>=u?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:E=>{const g=(0,i.f)(E);return`The Group by transformation requires a series with at least ${u} fields to work. The maximum number of fields found on a series is ${g}`},operator:E=>g=>g.pipe((0,t.T)(h=>{if(!Object.keys(E.fields).find(C=>E.fields[C].operation==="groupby"))return h;const v=[];for(const C of h){const T=C.fields.filter(x=>c(x,E));if(T.length===0)continue;const S=P(C,T),O=a(T,S);for(const x of C.fields){if(!y(x,E))continue;const b=(0,s.Ct)(x),M=E.fields[b].aggregations,A={};S.forEach(R=>{const B=R[b],U=(0,m.Nw)({field:B,reducers:M});for(const W of M)Array.isArray(A[W])||(A[W]=[]),A[W].push(U[W])});for(const R of M){const B={name:`${b} (${R})`,values:A[R]??[],type:o.PU.other,config:{}};B.type=f(R,x,B),O.push(B)}}v.push({fields:O,length:S.size})}return v}))},c=(E,g)=>{const h=(0,s.Ct)(E);return g?.fields[h]?.operation==="groupby"},y=(E,g)=>{const h=(0,s.Ct)(E);return g?.fields[h]?.operation==="aggregate"&&Array.isArray(g?.fields[h].aggregations)&&g?.fields[h].aggregations.length>0};function f(E,g,h){switch(E){case m.gy.allIsNull:return o.PU.boolean;case m.gy.last:case m.gy.lastNotNull:case m.gy.first:case m.gy.firstNotNull:return g.type;default:return(0,n.dF)(h)??o.PU.string}}function P(E,g){const h=new Map;for(let D=0;D<E.length;D++){const v=String(g.map(T=>T.values[D])),C=h.get(v)??{};h.has(v)||h.set(v,C);for(let T of E.fields){const S=(0,s.Ct)(T);C[S]||(C[S]={name:S,type:T.type,config:{...T.config},values:[]}),C[S].values.push(T.values[D])}}return h}function a(E,g){const h=[];for(const D of E){const v=[],C=(0,s.Ct)(D);g.forEach(T=>{v.push(T[C].values[0])}),h.push({name:D.name,type:D.type,config:{...D.config},values:v})}return h}},68133:(G,I,e)=>{"use strict";e.d(I,{_:()=>y,l:()=>d});var t=e(81160),n=e(14236),s=e(28240),r=e(11261),o=e(81010),m=e(75059),l=e(25094),i=e(18282),u=e(67641);const d=!0,p=2;var c=(h=>(h.aggregate="aggregate",h.groupBy="groupby",h))(c||{});const y={id:i.F.groupToNestedTable,name:"Group to nested tables",description:"Group data by a field value and create nested tables with the grouped data",defaultOptions:{showSubframeHeaders:d,fields:{}},isApplicable:h=>(0,u.f)(h)>=p?o.M.Applicable:o.M.NotApplicable,isApplicableDescription:h=>{const D=(0,u.f)(h);return`The Group to nested table transformation requires a series with at least ${p} fields to work. The maximum number of fields found on a series is ${D}`},operator:h=>D=>D.pipe((0,t.T)(v=>{if(!Object.keys(h.fields).find(S=>h.fields[S].operation==="groupby"))return v;const T=[];for(const S of v){const O=S.fields.filter(A=>P(A,h));if(O.length===0)continue;const x=(0,l.Y2)(S,O),b=(0,l.Ce)(O,x),M=g(x,h);for(let A=0;A<S.fields.length;A++){const R=S.fields[A];if(!a(R,h))continue;const B=(0,s.Ct)(R),U=h.fields[B].aggregations,W={};x.forEach(N=>{const w=N[B],L=(0,m.Nw)({field:w,reducers:U});for(const V of U)Array.isArray(W[V])||(W[V]=[]),W[V].push(L[V])});for(const N of U){const w={name:`${B} (${N})`,values:W[N],type:r.PU.other,config:{}};w.type=E(N,R,w),b.push(w)}}b.push({config:{},name:"Nested frames",type:r.PU.nestedFrames,values:M}),T.push({fields:b,length:x.size})}return T}))};function f(h,D,v){return{meta:{custom:{noHeader:!(v.showSubframeHeaders===void 0?d:v.showSubframeHeaders)}},length:D,fields:h}}const P=(h,D)=>{const v=(0,s.Ct)(h);return D?.fields[v]?.operation==="groupby"},a=(h,D)=>{const v=(0,s.Ct)(h);return D?.fields[v]?.operation==="aggregate"&&Array.isArray(D?.fields[v].aggregations)&&D?.fields[v].aggregations.length>0},E=(h,D,v)=>{switch(h){case m.gy.allIsNull:return r.PU.boolean;case m.gy.last:case m.gy.lastNotNull:case m.gy.first:case m.gy.firstNotNull:return D.type;default:return(0,n.dF)(v)??r.PU.string}};function g(h,D){const v=[];for(const[,C]of h){const T=[];for(const[S,O]of Object.entries(C)){const x=D.fields[S];(x===void 0||x.aggregations===void 0||x.operation==="aggregate"&&x.aggregations.length===0||x.operation===null||x.operation===void 0)&&T.push(O)}T.length>0?v.push([f(T,T[0].values.length,D)]):v.push([f([],0,D)])}return v}},77678:(G,I,e)=>{"use strict";e.d(I,{H1:()=>D,NX:()=>g,OA:()=>a,Rt:()=>P,Uh:()=>S,ZU:()=>T,cg:()=>b,d$:()=>E,dA:()=>h,ix:()=>v,p3:()=>C,rW:()=>p,rs:()=>O});var t=e(81160),n=e(57875),s=e(75972),r=e(41260),o=e(11261),m=e(97706),l=e(18282),i=e(73060),u=e(39624),d=e(67641);const p=[1e-9,2e-9,25e-10,4e-9,5e-9,1e-8,2e-8,25e-9,4e-8,5e-8,1e-7,2e-7,25e-8,4e-7,5e-7,1e-6,2e-6,25e-7,4e-6,5e-6,1e-5,2e-5,25e-6,4e-5,5e-5,1e-4,2e-4,25e-5,4e-4,5e-4,.001,.002,.0025,.004,.005,.01,.02,.025,.04,.05,.1,.2,.25,.4,.5,1,2,4,5,10,20,25,40,50,100,200,250,400,500,1e3,2e3,2500,4e3,5e3,1e4,2e4,25e3,4e4,5e4,1e5,2e5,25e4,4e5,5e5,1e6,2e6,25e5,4e6,5e6,1e7,2e7,25e6,4e7,5e7,1e8,2e8,25e7,4e8,5e8,1e9,2e9,25e8,4e9,5e9],c=30,y=[],f=(M,A)=>M-A,P={bucketCount:{name:"Bucket count",description:"approx bucket count"},bucketSize:{name:"Bucket size",description:void 0},bucketOffset:{name:"Bucket offset",description:"for non-zero-based buckets"},combine:{name:"Combine series",description:"combine all series into a single histogram"}},a={id:l.F.histogram,name:"Histogram",description:"Calculate a histogram from input data.",defaultOptions:{fields:{}},operator:(M,A)=>R=>R.pipe((0,t.T)(B=>a.transformer(M,A)(B))),transformer:(M,A)=>R=>{if(!Array.isArray(R)||R.length===0)return R;let B,U;M.bucketSize&&((0,d.w)()&&(M.bucketSize=A.interpolate(M.bucketSize.toString())),typeof M.bucketSize=="string"?B=parseFloat(M.bucketSize):B=M.bucketSize,isNaN(B)&&(B=void 0)),M.bucketOffset&&((0,d.w)()&&(M.bucketOffset=A.interpolate(M.bucketOffset.toString())),typeof M.bucketOffset=="string"?U=parseFloat(M.bucketOffset):U=M.bucketOffset,isNaN(U)&&(U=void 0));const W={bucketSize:B,bucketOffset:U,combine:M.combine},N=C(R,W);return N==null?[]:[b(N)]}},E="xMin";function g(M){return M===E||M==="BucketMin"}const h="xMax";function D(M){return M===h||M==="BucketMax"}function v(M){if(M.meta?.type===r.m.HeatmapCells){let U=M.fields.find(k=>k.name==="yMin"),W=M.fields.find(k=>k.name==="yMax"),N=M.fields.find(k=>k.name==="count"),w=[...new Set(W.values)].sort((k,j)=>k-j),L=[...new Set(U.values)].sort((k,j)=>k-j),V=new Map;w.forEach(k=>V.set(k,0));for(let k=0;k<W.values.length;k++){let j=W.values[k];V.set(j,V.get(j)+N.values[k])}return{xMin:{...U,name:"xMin",values:L},xMax:{...W,name:"xMax",values:w},counts:[{...N,values:[...V.values()]}]}}else if(M.meta?.type===r.m.HeatmapRows){let U=[],W=[],N=[],w="0";return M.fields.forEach(V=>{if(V.type===o.PU.number){let K=V.values.reduce((k,j)=>k+j,0);N.push(K),U.push(w),W.push(w=V.name)}}),N.push(0),U.push(w),W.push(w),{xMin:{...M.fields[1],name:"xMin",type:o.PU.string,values:U},xMax:{...M.fields[1],name:"xMax",type:o.PU.string,values:W},counts:[{...M.fields[1],name:"count",type:o.PU.number,values:N}]}}let A,R;const B=[];for(const U of M.fields)g(U.name)?A=U:D(U.name)?R=U:U.type===o.PU.number&&B.push(U);if(!R&&A&&A.values.length>1){let U=A.values,W=(0,m.h)(U[1]-U[0],6);R={...A,name:h,values:U.map(N=>N+W)}}if(!A&&R&&R?.values.length>1){let U=R.values,W=(0,m.h)(U[1]-U[0],6);A={...R,name:E,values:U.map(N=>N-W)}}if(A&&R&&B.length)return{xMin:A,xMax:R,counts:B}}function C(M,A){let R=A?.bucketSize,B=A?.bucketCount??c,U=A?.bucketOffset??0;if(M=M.map(H=>({...H,fields:H.fields.map(J=>{if(J.type===o.PU.number){const X=Number(J.config.noValue);Number.isNaN(X)?J={...J,values:J.values.filter(se=>se!=null)}:J=(0,u.A)(J,X)}return J})})),!R||R<0){let H=[];for(const q of M)for(const ee of q.fields)ee.type===o.PU.number&&(H=H.concat(ee.values));H.sort((q,ee)=>q-ee);let J=1/0;if(H.length===1)J=1;else for(let q=1;q<H.length;q++){let ee=H[q]-H[q-1];ee!==0&&(J=Math.min(J,ee))}let X=H[0];const ne=(H[H.length-1]-X)/B;for(let q=0;q<p.length;q++){let ee=p[q];if(ne<ee&&ee>=J){R=ee;break}}}const W=H=>(0,m.h)(O(H-U,R)+U,9);let N=((""+R).match(/\.\d+$/)??["."])[0].length-1,w=[],L=[],V;for(const H of M)for(const J of H.fields)if(J.type===o.PU.number){let X=x(J.values,W,y,f);w.push(X),L.push({...J,config:{...J.config,unit:J.config.unit==="short"?"short":void 0}}),!V&&J.config.unit&&(V=J.config)}if(!L.length)return null;let K=(0,i.fj)(w);for(let H=1;H<K.length;H++){let J=K[H];for(let X=0;X<J.length;X++)J[X]==null&&(J[X]=0)}const k={name:E,values:K[0],type:o.PU.number,state:void 0,config:N===0?V??{}:{...V,decimals:N}},j={...k,name:h,values:K[0].map(H=>H+R)};if(A?.combine){const H=new Array(K[0].length).fill(0);for(let J=1;J<K.length;J++)for(let X=0;X<H.length;X++)H[X]+=K[J][X];L=[{...L[0],name:"count",values:H,type:o.PU.number,state:{...L[0].state,displayName:"Count",multipleFrames:!1,origin:{frameIndex:0,fieldIndex:2}}}]}else L.forEach((H,J)=>{H.values=K[J+1]});return{xMin:k,xMax:j,counts:L}}function T(M,A){return Math.round(M/A)*A}function S(M,A){return Math.ceil(M/A)*A}function O(M,A){return Math.floor(M/A)*A}function x(M,A,R,B){let U=new Map;for(let L=0;L<M.length;L++){let V=M[L];V!=null&&(V=A(V));let K=U.get(V);K?K.count++:U.set(V,{value:V,count:1})}R&&R.forEach(L=>U.delete(L));let W=[...U.values()];B&&W.sort((L,V)=>B(L.value,V.value));let N=Array(W.length),w=Array(W.length);for(let L=0;L<W.length;L++)N[L]=W[L].value,w[L]=W[L].count;return[N,w]}function b(M,A){if(!M.xMin.display){const R=(0,n.J)({field:M.xMin,theme:A??(0,s.a)()});M.xMin.display=R,M.xMax.display=R}return M.counts[0].display=(0,n.J)({field:M.counts[0],theme:A??(0,s.a)()}),{length:M.xMin.values.length,meta:{type:r.m.Histogram},fields:[M.xMin,M.xMax,...M.counts]}}},41511:(G,I,e)=>{"use strict";e.d(I,{L:()=>l,W:()=>m});var t=e(81160),n=e(85200),s=e(1173),r=e(18282),o=e(73060),m=(i=>(i.outer="outer",i.inner="inner",i.outerTabular="outerTabular",i))(m||{});const l={id:r.F.joinByField,aliasIds:[r.F.seriesToColumns],name:"Join by field",description:"Combine rows from two or more tables, based on a related field between them.  This can be used to outer join multiple time series on the _time_ field to show many time series in one table.",defaultOptions:{byField:void 0,mode:"outer"},operator:(i,u)=>d=>d.pipe((0,t.T)(p=>l.transformer(i,u)(p))),transformer:(i,u)=>{let d;return p=>{if(p.length>1){i.byField&&!d&&(d=n.sJ.get(s.Ct.byName).get(u.interpolate(i.byField)));const c=(0,o.Fd)({frames:p,joinBy:d,mode:i.mode});if(c)return[c]}return p}}}},73060:(G,I,e)=>{"use strict";e.d(I,{Fd:()=>u,JI:()=>f,RC:()=>c,WO:()=>y,Yj:()=>i,fj:()=>a,g2:()=>E});var t=e(14236),n=e(11261),s=e(85200),r=e(1173),o=e(41511);function m(g){const{timeField:h}=(0,t.KR)(g[0]);if(h)return s.sJ.get(r.Ct.firstTimeField).get({});let D=[];for(const v of g[0].fields)v.type===n.PU.number&&D.push(v.name);for(let v=1;v<g.length;v++){const C=[];for(const T of g[0].fields)T.type===n.PU.number&&C.push(T.name);D=D.filter(T=>!C.includes(T))}return s.sJ.get(r.Ct.byName).get(D[0])}function l(g){return g.joinBy??m(g.frames)}function i(g,h){if(h>=0){let D=g.fields[h];D.type!==n.PU.string&&!E(D.values)&&(g=(0,t.ES)(g,h))}return g}function u(g){if(!g.frames?.length)return;const h=g.nullMode??(b=>{let M=b.config.custom?.spanNulls;return M===!0?c:M===-1?y:f});if(g.frames.length===1){let b=g.frames[0],M=b;const A=l(g);let R=M.fields.findIndex(B=>A(B,M,g.frames));if(g.keepOriginIndices&&(M={...b,fields:b.fields.map((B,U)=>{const W={...B},N={frameIndex:0,fieldIndex:U};return W.state?W.state.origin=N:W.state={origin:N},W})},R>0)){const B=M.fields[R],U=M.fields.filter((W,N)=>N!==R);U.unshift(B),M.fields=U,R=0}if(R>=0&&(M=i(M,R)),g.keep){let B=M.fields.filter((U,W)=>W===R||g.keep(U,M,g.frames));b!==M?M.fields=B:M={...b,fields:B}}return M}const D=[],v=[],C=[],T=[];let S=1;const O=l(g);for(let b=0;b<g.frames.length;b++){const M=g.frames[b];if(!M||!M.fields?.length)continue;const A=[c];let R,B=[],U=[];for(let N=0;N<M.fields.length;N++){const w=M.fields[N];if(w.state=w.state||{},!R&&O(w,M,g.frames))R=w;else{if(g.keep&&!g.keep(w,M,g.frames))continue;A.push(h(w));let L=w.labels??{},V=w.name;M.name&&(w.name===n.Bc?V=M.name:L={...L,name:M.name}),B.push({...w,name:V,labels:L})}g.keepOriginIndices&&(w.state.origin={frameIndex:b,fieldIndex:N})}if(!R)continue;C.length===0&&C.push(R),D.push(A);const W=[R.values];for(const N of B)W.push(N.values),C.push(N),g.keepDisplayNames||delete N.state?.displayName,U.push(S),S++;T.push(U),v.push(W)}let x=[];return g.mode===o.W.outerTabular?x=d(v,T,C.length,D):g.mode===o.W.inner?x=p(v):x=a(v,D,g.mode),{length:x[0]?x[0].length:0,fields:C.map((b,M)=>({...b,values:x[M]}))}}function d(g,h,D,v){let C={};for(let S=0;S<g.length;S++){let O=g[S],x=O[0];for(let b=0;b<g.length;b++){if(b===S)continue;let M=g[b],A=M[0];for(let R=0;R<x.length;R++){const B=x[R],U=D-1;let W=[B].concat(new Array(U)),N=0;for(let w=1;w<O.length;w++){const L=h[S][N];W[L]=O[w][R],N++}for(let w=0;w<A.length;w++)if(x[R]===A[w]){let L=0;for(let V=1;V<M.length;V++){const K=h[b][L];W[K]=M[V][w],L++}break}C[JSON.stringify(W)]=W}}}let T=[];for(let S=0;S<D;S++)T.push(new Array(0));for(let S in C){const O=C[S];for(let x=0;x<O.length;x++)T[x].push(O[x])}return T}function p(g){const h=[],D=(v,C,T)=>{if(C===v.length){h.push(T);return}const S=v[C],[O,...x]=S;for(let b=0;b<O.length;b++){const M=O[b];if(C===0||T.includes(M)){const A=[...T];C===0&&A.push(M);for(let R=0;R<x.length;R++)A.push(x[R][b]);D(v,C+1,A)}}};return D(g,0,[]),h.length===0?[]:h[0].map((v,C)=>h.map(T=>T[C]))}const c=0,y=1,f=2;function P(g,h,D){for(let v=0,C,T=-1;v<h.length;v++){let S=h[v];if(S>T){for(C=S-1;C>=0&&g[C]==null;)g[C--]=null;for(C=S+1;C<D&&g[C]==null;)g[T=C++]=null}}}function a(g,h,D=o.W.outer){let v=new Set;for(let O=0;O<g.length;O++){let b=g[O][0],M=b.length;for(let A=0;A<M;A++)v.add(b[A])}let C=[Array.from(v).sort((O,x)=>O-x)],T=C[0].length,S=new Map;for(let O=0;O<T;O++)S.set(C[0][O],O);for(let O=0;O<g.length;O++){let x=g[O],b=x[0];for(let M=1;M<x.length;M++){let A=x[M],R=Array(T).fill(void 0),B=h?h[O][M]:y,U=[];for(let W=0;W<A.length;W++){let N=A[W],w=S.get(b[W]);N===null?B!==c&&(R[w]=N,B===f&&U.push(w)):R[w]=N}P(R,U,T),C.push(R)}}return C}function E(g,h=50){const D=g.length;if(D<=1)return!0;let v=0,C=D-1;for(;v<=C&&g[v]==null;)v++;for(;C>=v&&g[C]==null;)C--;if(C<=v)return!0;const T=Math.max(1,Math.floor((C-v+1)/h));for(let S=g[v],O=v+T;O<=C;O+=T){const x=g[O];if(x!=null){if(x<=S)return!1;S=x}}return!0}},6829:(G,I,e)=>{"use strict";e.d(I,{V:()=>m,n:()=>o});var t=e(81160),n=e(28240),s=e(11261),r=e(18282),o=(i=>(i.Columns="columns",i.Rows="rows",i))(o||{});const m={id:r.F.labelsToFields,name:"Labels to fields",description:"Extract time series labels to fields (columns or rows)",defaultOptions:{},operator:(i,u)=>d=>d.pipe((0,t.T)(p=>m.transformer(i,u)(p))),transformer:i=>u=>{if(i.mode==="rows")return l(u,i.keepLabels);const d=[],p=i.keepLabels?.length?new Set(i.keepLabels):void 0;for(const c of u){const y=[],f={};for(const P of c.fields){if(!P.labels){y.push(P);continue}const a={...P,config:{...P.config,displayName:void 0,displayNameFromDS:void 0},labels:void 0};y.push(a);for(const E of Object.keys(P.labels)){if(p&&!p.has(E))continue;if(i.valueLabel===E){a.name=P.labels[E];continue}(f[E]??(f[E]=new Set)).add(P.labels[E])}}for(const P in f)for(const a of f[P]){const E=new Array(c.length).fill(a);y.push({name:P,type:s.PU.string,values:E,config:{}})}d.push({...c,fields:y,length:c.length})}return d}};function l(i,u){const d=[];for(const p of i)for(const c of p.fields)if(c.labels){const y=[],f=[];if(u)for(const P of u)y.push(P),f.push(c.labels[P]);else for(const[P,a]of Object.entries(c.labels))y.push(P),f.push(a);f.length&&d.push({...p,name:(0,n.Ct)(c,p,i),fields:[{name:"label",type:s.PU.string,config:{},values:y},{name:"value",type:s.PU.string,config:{},values:f}],length:f.length})}return d}},58140:(G,I,e)=>{"use strict";e.d(I,{o:()=>l});var t=e(2543),n=e.n(t),s=e(81160),r=e(37471),o=e(81010),m=e(18282);const l={id:m.F.merge,name:"Merge series/tables",description:"Merges multiple series/tables into a single serie/table",defaultOptions:{},isApplicable:f=>f.length>1?o.M.Applicable:o.M.NotApplicable,isApplicableDescription:f=>`The merge transformation requires at least 2 data series to work. There is currently ${f.length} data series.`,operator:f=>P=>P.pipe((0,s.T)(a=>{if(!Array.isArray(a)||a.length<=1)return a;const E=a.filter(x=>x.fields.length>0);if(E.length===0)return[a[0]];const g=new Set,h={},D=[],v=new r.k;for(let x=0;x<E.length;x++){const b=E[x];for(let M=0;M<b.fields.length;M++){const A=b.fields[M];g.has(A.name)||(v.addField(i(A)),g.add(A.name)),h[A.name]=h[A.name]||{},h[A.name][x]=M,E.length-1===x&&c(h,A,E)&&D.push(A.name)}}if(D.length===0)return a;const C={},T=[],S=u(E,h,D),O=d(E,g,h);for(let x=0;x<E.length;x++){const b=E[x];for(let M=0;M<b.length;M++){const A=S(x,M),R=O(x,M);if(!Array.isArray(C[A])){C[A]=[R],T.push(y(A,C));continue}let B=!1;C[A]=C[A].map(U=>p(U,R)?(B=!0,{...U,...R}):U),B||(C[A].push(R),T.push(y(A,C)))}}for(const x of T){const b=C[x.key][x.index];b&&v.add(b)}return[v]}))},i=f=>({...(0,t.omit)(f,["values","state","labels","config"]),values:[],config:{...(0,t.omit)(f.config,"displayName")}}),u=(f,P,a)=>{const E=a.reduce((g,h)=>Object.keys(P[h]).reduce((D,v)=>(D[v]=D[v]||[],D[v].push(P[h][v]),D),g),{});return(g,h)=>E[g].reduce((D,v)=>D+f[g].fields[v].values[h],"")},d=(f,P,a)=>(E,g)=>{const h={},D=Array.from(P);for(const v of D){const C=a[v];if(!C)continue;const T=C[E];if(typeof T!="number")continue;const S=f[E];if(!S||!S.fields)continue;const O=S.fields[T];!O||!O.values||(h[v]=O.values[g])}return h},p=(f,P)=>{let a=!0;for(const E in P)if(!(typeof f[E]>"u")&&f[E]!==null&&f[E]!==P[E]){a=!1;break}return a},c=(f,P,a)=>Object.keys(f[P.name]).length===a.length,y=(f,P)=>({key:f,index:P[f].length-1})},64586:(G,I,e)=>{"use strict";e.d(I,{W:()=>n});var t=e(18282);const n={id:t.F.noop,name:"noop",description:"No-operation transformer",defaultOptions:{},operator:s=>r=>r,transformer:s=>r=>r}},46294:(G,I,e)=>{"use strict";e.d(I,{M:()=>r});var t=e(11261);const n={threshold:(m,l,i)=>m+i,midpoint:(m,l,i)=>(m+l)/2,plusone:(m,l,i)=>m+1};function s(m,l){return m.fields.find(i=>l!=null?i.name===l:i.type===t.PU.time)}function r(m){if(m.frame.length===0)return m.frame;let l=!0,{frame:i,refFieldName:u,refFieldPseudoMax:d,refFieldPseudoMin:p,insertMode:c}=m;c||(c=n.threshold);const y=s(i,u);if(y==null)return i;y.state={...y.state,nullThresholdApplied:!0};const f=i.fields.map(a=>a.config.custom?.insertNulls||y.config.interval||null),P=new Set(f);if(P.delete(null),P.size===0)return i;if(P.size===1){const a=P.values().next().value;if(a<=0)return i;const E=y.values,g=i.fields.map(D=>D.values),h=o(E,g,a,p,d,c,l);return h===g?i:{...i,length:h[0].length,fields:i.fields.map((D,v)=>({...D,values:h[v]}))}}return i}function o(m,l,i,u=null,d=null,p,c){const y=m.length,f=[];if(u!=null&&u<m[0]){let g=Math.ceil((m[0]-u)/i),h=m[0]-g*i;for(;h<m[0];)f.push(p(h-i,h,i)),h+=i}f.push(m[0]);let P=m[0];for(let g=1;g<y;g++){const h=m[g];for(;h-P>i&&(f.push(p(P,h,i)),P+=i,!!c););f.push(h),P=h}if(d!=null&&d>P)for(;P+i<d;)f.push(p(P,d,i)),P+=i;const a=f.length;if(a===y)return l;const E=[];for(let g of l){let h;if(g!==m){h=Array(a);for(let D=0,v=0;D<a;D++)h[D]=m[v]===f[D]?g[v++]:null}else h=f;E.push(h)}return E}},39624:(G,I,e)=>{"use strict";e.d(I,{A:()=>n,C:()=>t});function t(s){return{...s,fields:s.fields.map(r=>{const o=Number(r.config.noValue);return Number.isNaN(o)?r:n(r,o)})}}function n(s,r){const o=s.values.slice();for(let m=0;m<o.length;m++)o[m]===null&&(o[m]=r);return{...s,values:o}}},82280:(G,I,e)=>{"use strict";e.d(I,{X:()=>l,x:()=>m});var t=e(2543),n=e.n(t),s=e(81160),r=e(28240),o=e(18282);const m={id:o.F.order,name:"Order fields by name",description:"Order fields based on configuration given by user",defaultOptions:{indexByName:{}},operator:d=>p=>p.pipe((0,s.T)(c=>{const y=i(d.indexByName);return!Array.isArray(c)||c.length===0?c:c.map(f=>({...f,fields:y(f.fields,c,f)}))}))},l=d=>(p,c)=>u(p,d)-u(c,d),i=d=>(p,c,y)=>{if(!Array.isArray(p)||p.length===0||!d||Object.keys(d).length===0)return p;const f=l(d);return(0,t.clone)(p).sort((P,a)=>f((0,r.Ct)(P,y,c),(0,r.Ct)(a,y,c)))},u=(d,p)=>Number.isInteger(p[d])?p[d]:Number.MAX_SAFE_INTEGER},21128:(G,I,e)=>{"use strict";e.d(I,{Wj:()=>d,rV:()=>u});var t=e(81160),n=e(14236),s=e(28240),r=e(11261),o=e(75059),m=e(85200),l=e(72693),i=e(18282),u=(a=>(a.SeriesToRows="seriesToRows",a.ReduceFields="reduceFields",a))(u||{});const d={id:i.F.reduce,name:"Reduce",description:"Reduce all rows or data points to a single value using a function like max, min, mean or last.",defaultOptions:{reducers:[o.gy.max]},operator:a=>E=>E.pipe((0,t.T)(g=>{if(!a?.reducers?.length)return g;const h=a.fields?(0,m.NS)(a.fields):a.includeTimeField&&a.mode==="reduceFields"?l.Yg:l.zx;if(a.mode==="reduceFields")return f(g,h,a.reducers);const D=p(g,h,a.reducers,a.labelsToFields);return D?[D]:[]}))};function p(a,E,g,h){const D=o.AS.list(g),v=D.map(S=>S.id),C=[],T=h?c(a):[];for(const S of a){const O=S.fields.filter(B=>E(B,S,a)),x=O.length,b=[],M=new Array(x);b.push({name:"Field",type:r.PU.string,values:M,config:{}});const A={};if(h)for(const B of T)A[B]=new Array(x),b.push({name:B,type:r.PU.string,values:A[B],config:{}});const R={};for(const B of D)R[B.id]=new Array(x),b.push({name:B.name,type:r.PU.other,values:R[B.id],config:{}});for(let B=0;B<O.length;B++){const U=O[B],W=(0,o.Nw)({field:U,reducers:v});if(h){if(M[B]=U.name,U.labels)for(const N in U.labels)A[N][B]=U.labels[N]}else M[B]=(0,s.Ct)(U,S,a);for(const N of D){const w=W[N.id];R[N.id][B]=w}}for(const B of b)if(B.type===r.PU.other){const U=(0,n.dF)(B);U&&(B.type=U)}C.push({...S,fields:b,length:x})}return y(C)}function c(a){const E=new Set;for(const g of a)for(const h of g.fields)if(h.labels)for(const D of Object.keys(h.labels))E.add(D);return[...E]}function y(a){if(!a?.length)return;const E=a[0];for(let g=1;g<a.length;g++){const h=a[g];for(let D=0;D<E.fields.length;D++){const v=E.fields[D];for(let C=0;C<h.fields.length;C++){const T=h.fields[C],S=D===0&&C===0,O=v.type===T.type&&v.name===T.name;if(S||O){const x=v.values,b=T.values;v.values=x.concat(b)}}}}return E.name=void 0,E.length=E.fields[0].values.length,E}function f(a,E,g){const D=o.AS.list(g).map(C=>C.id),v=[];for(const C of a){const T=[];for(const S of C.fields)if(E(S,C,a)){const O=(0,o.Nw)({field:S,reducers:D});for(const x of D){const b=O[x],M={...S,type:P(x,S),values:[b]};M.state=void 0,D.length>1&&(M.labels||(M.labels={}),M.labels.reducer=o.AS.get(x).name),T.push(M)}}T.length&&v.push({...C,fields:T,length:1})}return v}function P(a,E){switch(a){case o.gy.allValues:case o.gy.uniqueValues:return r.PU.other;case o.gy.first:case o.gy.firstNotNull:case o.gy.last:case o.gy.lastNotNull:return E.type;default:return r.PU.number}}},67641:(G,I,e)=>{"use strict";e.d(I,{f:()=>n,w:()=>t});const t=()=>window?.grafanaBootData?.settings?.featureToggles?.transformationsVariableSupport;function n(s){let r=0;for(const o of s)o.fields.length>r&&(r=o.fields.length);return r}},22544:()=>{"use strict"},12463:()=>{"use strict"},43585:(G,I,e)=>{"use strict";e.d(I,{O:()=>t});var t=(n=>(n.NoData="no_data",n.Paused="paused",n.Alerting="alerting",n.OK="ok",n.Pending="pending",n.Unknown="unknown",n))(t||{})},8790:(G,I,e)=>{"use strict";e.d(I,{V:()=>t});var t=(n=>(n.Field="field",n.Text="text",n.Skip="skip",n))(t||{})},41987:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>o,Jk:()=>s,hX:()=>r});var t=e(43429),n=e(74135),s=(m=>(m.CloudAlerting="cloud-alerting",m.UnifiedAlerting="unified-alerting",m.Dashboard="dashboard",m.Explore="explore",m.Correlations="correlations",m.Unknown="unknown",m.PanelEditor="panel-editor",m.PanelViewer="panel-viewer",m))(s||{});class r extends t.Ud{constructor(){super(...arguments),this._extensionConfigs=[]}init(l){}setRootPage(l){return this.root=l,this}setComponentsFromLegacyExports(l){if(l.ConfigCtrl&&(this.angularConfigCtrl=l.ConfigCtrl),this.meta&&this.meta.includes){for(const i of this.meta.includes)if(i.type===t.ib.page&&i.component&&!l[i.component]){console.warn("App Page uses unknown component: ",i.component,this.meta);continue}}}get extensionConfigs(){return this._extensionConfigs}addLink(l){const{targets:i,...u}=l;return(Array.isArray(i)?i:[i]).forEach(p=>{this._extensionConfigs.push({...u,extensionPointId:p,type:n.u.link})}),this}addComponent(l){const{targets:i,...u}=l;return(Array.isArray(i)?i:[i]).forEach(p=>{this._extensionConfigs.push({...u,extensionPointId:p,type:n.u.component})}),this}exposeComponent(l){const{id:i,...u}=l;return this._extensionConfigs.push({...u,extensionPointId:`capabilities/${i}`,type:n.u.component}),this}configureExtensionLink(l){return this.addLink({targets:[l.extensionPointId],...l}),this}configureExtensionComponent(l){return this.addComponent({targets:[l.extensionPointId],...l}),this}}var o=(m=>(m.alpha="alpha",m.beta="beta",m.experimental="experimental",m.privatePreview="private preview",m.preview="preview",m))(o||{})},61268:(G,I,e)=>{"use strict";e.d(I,{r:()=>t});var t=(n=>(n.OpenSource="Open Source",n.Pro="Pro",n.Enterprise="Enterprise",n))(t||{})},58649:(G,I,e)=>{"use strict";e.d(I,{En:()=>s,d1:()=>n,tw:()=>t});const t=0,n=100,s="SAML"},94624:(G,I,e)=>{"use strict";e.d(I,{y:()=>t});var t=(n=>(n[n.Off=0]="Off",n[n.Crosshair=1]="Crosshair",n[n.Tooltip=2]="Tooltip",n))(t||{})},39070:(G,I,e)=>{"use strict";e.d(I,{Gu:()=>t,Gv:()=>m,Nx:()=>n,UW:()=>s,zz:()=>r});var t=(l=>(l.NotStarted="NotStarted",l.Loading="Loading",l.Streaming="Streaming",l.Done="Done",l.Error="Error",l))(t||{});const n=["graph","table","logs","trace","nodeGraph","flamegraph","rawPrometheus"];var s=(l=>(l.Null="null",l.Ignore="connected",l.AsZero="null as zero",l))(s||{});const r=l=>!!l;function o(l){return l}function m(l){return typeof l=="object"&&l!==null?!0:!1}},11261:(G,I,e)=>{"use strict";e.d(I,{Bc:()=>n,LE:()=>s,PU:()=>t,aI:()=>r});var t=(o=>(o.time="time",o.number="number",o.string="string",o.boolean="boolean",o.trace="trace",o.geo="geo",o.enum="enum",o.other="other",o.frame="frame",o.nestedFrames="nestedFrames",o))(t||{});const n="Value",s="Time",r="Metric"},41260:(G,I,e)=>{"use strict";e.d(I,{m:()=>t});var t=(n=>(n.TimeSeriesWide="timeseries-wide",n.TimeSeriesLong="timeseries-long",n.TimeSeriesMany="timeseries-many",n.TimeSeriesMulti="timeseries-multi",n.NumericWide="numeric-wide",n.NumericMulti="numeric-multi",n.NumericLong="numeric-long",n.LogLines="log-lines",n.DirectoryListing="directory-listing",n.HeatmapRows="heatmap-rows",n.HeatmapCells="heatmap-cells",n.Histogram="histogram",n))(t||{})},91890:(G,I,e)=>{"use strict";e.d(I,{$0:()=>s,CC:()=>n,uP:()=>r,x0:()=>t});var t=(o=>(o.Datasource="Datasource",o.Correlations="Correlations",o.ExploreCorrelationsEditor="CorrelationsEditor",o))(t||{}),n=(o=>(o.Regex="regex",o.Logfmt="logfmt",o))(n||{}),s=(o=>(o.Series="series",o.Field="field",o.Fields="fields",o.Value="value",o.BuiltIn="built-in",o.Template="template",o))(s||{}),r=(o=>(o.Values="values",o))(r||{})},40187:(G,I,e)=>{"use strict";e.d(I,{Is:()=>l,ZF:()=>o,mA:()=>r,tD:()=>s,v2:()=>m});var t=e(92341),n=e(43429);class s extends n.Ud{constructor(u){super(),this.DataSourceClass=u,this.components={}}setConfigEditor(u){return this.components.ConfigEditor=u,this}setConfigCtrl(u){return this.angularConfigCtrl=u,this}setQueryCtrl(u){return this.components.QueryCtrl=u,this}setAnnotationQueryCtrl(u){return this.components.AnnotationsQueryCtrl=u,this}setQueryEditor(u){return this.components.QueryEditor=u,this}setExploreQueryField(u){return this.components.ExploreQueryField=u,this}setExploreMetricsQueryField(u){return this.components.ExploreMetricsQueryField=u,this}setExploreLogsQueryField(u){return this.components.ExploreLogsQueryField=u,this}setQueryEditorHelp(u){return this.components.QueryEditorHelp=u,this}setExploreStartPage(u){return this.setQueryEditorHelp(u)}setVariableQueryEditor(u){return this.components.VariableQueryEditor=u,this}setMetadataInspector(u){return this.components.MetadataInspector=u,this}setComponentsFromLegacyExports(u){this.angularConfigCtrl=u.ConfigCtrl,this.components.QueryCtrl=u.QueryCtrl,this.components.AnnotationsQueryCtrl=u.AnnotationsQueryCtrl,this.components.ExploreQueryField=u.ExploreQueryField,this.components.QueryEditor=u.QueryEditor,this.components.QueryEditorHelp=u.QueryEditorHelp,this.components.VariableQueryEditor=u.VariableQueryEditor}}class r{constructor(u){this.name=u.name,this.id=u.id,this.type=u.type,this.meta=u.meta,this.cachingConfig=u.cachingConfig,this.uid=u.uid}filterQuery(u){return!0}getRef(){return{type:this.type,uid:this.uid}}}var o=(i=>(i.Logs="Logs",i.Metrics="Metrics",i.Tracing="Tracing",i))(o||{}),m=(i=>(i.Cancelled="cancelled",i.Timeout="timeout",i.Unknown="unknown",i))(m||{});class l{}l=(0,t.Y)(l),r=(0,t.Y)(r)},50349:()=>{"use strict"},50219:()=>{"use strict"},24293:(G,I,e)=>{"use strict";e.d(I,{F:()=>n,Y:()=>t});var t=(s=>(s.Thresholds="thresholds",s.PaletteClassic="palette-classic",s.PaletteClassicByName="palette-classic-by-name",s.PaletteSaturated="palette-saturated",s.ContinuousGrYlRd="continuous-GrYlRd",s.ContinuousRdYlGr="continuous-RdYlGr",s.ContinuousBlYlRd="continuous-BlYlRd",s.ContinuousYlRd="continuous-YlRd",s.ContinuousBlPu="continuous-BlPu",s.ContinuousYlBl="continuous-YlBl",s.ContinuousBlues="continuous-blues",s.ContinuousReds="continuous-reds",s.ContinuousGreens="continuous-greens",s.ContinuousPurples="continuous-purples",s.Fixed="fixed",s.Shades="shades",s))(t||{});const n="#808080"},37055:(G,I,e)=>{"use strict";e.d(I,{Ow:()=>n,ZW:()=>t,uo:()=>s});function t(r){return o=>"__systemRef"in o&&o.__systemRef===r}const n=r=>"__systemRef"in r&&typeof r.__systemRef=="string";var s=(r=>(r.Unit="unit",r.Min="min",r.Max="max",r.Decimals="decimals",r.DisplayName="displayName",r.NoValue="noValue",r.Thresholds="thresholds",r.Mappings="mappings",r.Links="links",r.Color="color",r.Filterable="filterable",r))(s||{})},93015:()=>{"use strict"},58318:()=>{"use strict"},49812:()=>{"use strict"},8887:(G,I,e)=>{"use strict";e.d(I,{Uo:()=>s,az:()=>t,n6:()=>n});const t={google:!0,microsoft:!0,github:!0,gitlab:!0,okta:!0,discord:!0,hipchat:!0,amazon:!0,"google-hangouts-alt":!0,pagerduty:!0,line:!0,anchor:!0,"adjust-circle":!0,"angle-double-down":!0,"angle-double-right":!0,"angle-double-left":!0,"angle-double-up":!0,"angle-down":!0,"angle-left":!0,"angle-right":!0,"angle-up":!0,"align-left":!0,"align-right":!0,"application-observability":!0,apps:!0,"archive-alt":!0,arrow:!0,"arrow-down":!0,"arrow-from-right":!0,"arrow-left":!0,"arrow-random":!0,"arrow-right":!0,"arrow-to-right":!0,"arrow-up":!0,"arrows-h":!0,"arrows-v":!0,asserts:!0,"expand-arrows":!0,"expand-arrows-alt":!0,at:!0,ai:!0,backward:!0,bars:!0,bell:!0,"bell-slash":!0,bolt:!0,book:!0,bookmark:!0,"book-open":!0,"brackets-curly":!0,bug:!0,building:!0,"calculator-alt":!0,"calendar-alt":!0,"calendar-slash":!0,camera:!0,capture:!0,"channel-add":!0,"chart-line":!0,check:!0,"check-circle":!0,"check-square":!0,circle:!0,"circle-mono":!0,"clipboard-alt":!0,"clock-nine":!0,cloud:!0,"cloud-download":!0,"cloud-upload":!0,"code-branch":!0,cog:!0,columns:!0,"comment-alt":!0,"comment-alt-message":!0,"comment-alt-share":!0,"comments-alt":!0,compass:!0,"compress-arrows":!0,copy:!0,"corner-down-right-alt":!0,"create-dashboard":!0,"credit-card":!0,crosshair:!0,cube:!0,dashboard:!0,database:!0,"dice-three":!0,docker:!0,"document-info":!0,"document-layout-left":!0,"download-alt":!0,draggabledots:!0,edit:!0,"ellipsis-v":!0,enter:!0,envelope:!0,"exchange-alt":!0,"exclamation-triangle":!0,"exclamation-circle":!0,exclamation:!0,"external-link-alt":!0,eye:!0,"eye-slash":!0,"ellipsis-h":!0,"fa fa-spinner":!0,favorite:!0,"file-alt":!0,"file-blank":!0,"file-copy-alt":!0,"file-download":!0,"file-edit-alt":!0,"file-landscape-alt":!0,filter:!0,flip:!0,folder:!0,font:!0,fire:!0,"folder-open":!0,"folder-plus":!0,"folder-upload":!0,forward:!0,"frontend-observability":!0,"gf-bar-alignment-after":!0,"gf-bar-alignment-before":!0,"gf-bar-alignment-center":!0,"gf-glue":!0,"gf-grid":!0,"gf-interpolation-linear":!0,"gf-interpolation-smooth":!0,"gf-interpolation-step-after":!0,"gf-interpolation-step-before":!0,"gf-landscape":!0,"gf-layout-simple":!0,"gf-logs":!0,"gf-ml":!0,"gf-movepane-left":!0,"gf-movepane-right":!0,"gf-portrait":!0,"gf-service-account":!0,"gf-show-context":!0,"gf-pin":!0,"gf-prometheus":!0,"gf-traces":!0,globe:!0,grafana:!0,"graph-bar":!0,heart:!0,"heart-rate":!0,"heart-break":!0,history:!0,"history-alt":!0,home:!0,"home-alt":!0,"horizontal-align-center":!0,"horizontal-align-left":!0,"horizontal-align-right":!0,hourglass:!0,import:!0,info:!0,"info-circle":!0,k6:!0,"key-skeleton-alt":!0,keyboard:!0,kubernetes:!0,"layer-group":!0,"layers-alt":!0,"library-panel":!0,"line-alt":!0,link:!0,"list-ui-alt":!0,"list-ul":!0,"list-ol":!0,lock:!0,"map-marker":!0,"map-marker-plus":!0,"map-marker-minus":!0,message:!0,minus:!0,"minus-circle":!0,"mobile-android":!0,monitor:!0,palette:!0,"panel-add":!0,paragraph:!0,"pathfinder-unite":!0,pause:!0,"pause-circle":!0,pen:!0,percentage:!0,play:!0,plug:!0,plus:!0,"plus-circle":!0,"plus-square":!0,power:!0,"presentation-play":!0,process:!0,"question-circle":!0,"record-audio":!0,repeat:!0,rocket:!0,"ruler-combined":!0,save:!0,search:!0,"search-minus":!0,"search-plus":!0,"share-alt":!0,shield:!0,"shield-exclamation":!0,signal:!0,signin:!0,signout:!0,sitemap:!0,slack:!0,"sliders-v-alt":!0,spinner:!0,"sort-amount-down":!0,"sort-amount-up":!0,"square-shape":!0,star:!0,"step-backward":!0,stopwatch:!0,"stopwatch-slash":!0,sync:!0,"sync-slash":!0,table:!0,"table-collapse-all":!0,"table-expand-all":!0,"tag-alt":!0,"telegram-alt":!0,"text-fields":!0,"thumbs-up":!0,times:!0,"times-circle":!0,"toggle-on":!0,"toggle-off":!0,"trash-alt":!0,unarchive:!0,unlock:!0,upload:!0,user:!0,"users-alt":!0,"user-arrows":!0,"vertical-align-bottom":!0,"vertical-align-center":!0,"vertical-align-top":!0,"web-section-alt":!0,"wrap-text":!0,rss:!0,x:!0,"add-user":!0,attach:!0};function n(r){return!r||typeof r!="string"?!1:r in t}function s(r){if(n(r))return r}},64572:(G,I,e)=>{"use strict";e.r(I),e.d(I,{AbstractLabelOperator:()=>l.D_,AlertState:()=>ae.O,AnnotationEventFieldSource:()=>i.V,AppEvents:()=>k.r1,AppPlugin:()=>O.hX,CoreApp:()=>O.Jk,CustomVariableSupport:()=>H.f5,DEFAULT_SAML_NAME:()=>t.En,DashboardCursorSync:()=>m.y,DataFrameType:()=>r.m,DataLinkConfigOrigin:()=>o.x0,DataQueryErrorType:()=>x.v2,DataSourceApi:()=>x.mA,DataSourcePlugin:()=>x.tD,DataSourceVariableSupport:()=>H.ZV,DataTopic:()=>l.QR,DefaultTimeZone:()=>y.lE,ExploreMode:()=>x.ZF,FALLBACK_COLOR:()=>R.F,FeatureState:()=>O.Ay,FieldColorModeId:()=>R.Y,FieldConfigProperty:()=>T.uo,FieldType:()=>s.PU,GAUGE_DEFAULT_MAXIMUM:()=>t.d1,GAUGE_DEFAULT_MINIMUM:()=>t.tw,GrafanaPlugin:()=>M.Ud,GrafanaThemeType:()=>B.I,LanguageProvider:()=>x.Is,LegacyGraphHoverClearEvent:()=>k.Tq,LegacyGraphHoverEvent:()=>k.kb,LiveChannelConnectionState:()=>j.ZF,LiveChannelEventType:()=>j.o4,LiveChannelScope:()=>j.qD,LiveChannelType:()=>j.os,LoadingState:()=>n.Gu,LogLevel:()=>u.$b,LogRowContextQueryDirection:()=>u.ZF,LogsDedupDescription:()=>u._C,LogsDedupStrategy:()=>u.fY,LogsMetaKind:()=>u.tG,LogsSortOrder:()=>u.uH,LogsVolumeType:()=>u.Aj,MappingType:()=>P.d,NullValueMode:()=>n.UW,NumericLogLevel:()=>u.s5,OrgRole:()=>U.X,PageLayoutType:()=>d.k,PanelEvents:()=>k.ee,PluginErrorCode:()=>M.ZK,PluginExtensionPoints:()=>ce.S,PluginExtensionTypes:()=>ce.u,PluginIncludeType:()=>M.ib,PluginSignatureStatus:()=>M.Ac,PluginSignatureType:()=>M.kv,PluginState:()=>M.pn,PluginType:()=>M.QE,SpecialValue:()=>C.N,SpecialValueMatch:()=>P.W,StandardVariableSupport:()=>H.J$,SupplementaryQueryType:()=>u.cF,SupportedTransformationType:()=>o.CC,TIME_FORMAT:()=>y.G$,TIME_SERIES_METRIC_FIELD_NAME:()=>s.aI,TIME_SERIES_TIME_FIELD_NAME:()=>s.LE,TIME_SERIES_VALUE_FIELD_NAME:()=>s.Bc,ThresholdsMode:()=>f.O,TransformationApplicabilityLevels:()=>C.M,VariableHide:()=>A.zL,VariableOrigin:()=>o.$0,VariableRefresh:()=>A.CO,VariableSort:()=>A.ZG,VariableSuggestionsScope:()=>o.uP,VariableSupportBase:()=>H.xi,VariableSupportType:()=>H.Qz,VisualizationSuggestionScore:()=>b.nQ,VisualizationSuggestionsBuilder:()=>b.v2,VisualizationSuggestionsListAppender:()=>b.NV,VizOrientation:()=>b.wV,availableIconsIndex:()=>ie.az,getDefaultRelativeTimeRange:()=>y.Cn,getDefaultTimeRange:()=>y.E2,hasLogsContextSupport:()=>u.Ol,hasLogsContextUiSupport:()=>u.wj,hasQueryExportSupport:()=>l.Ee,hasQueryImportSupport:()=>l.FL,hasQueryModificationSupport:()=>u._0,hasSupplementaryQuerySupport:()=>u.Nc,hasToggleableQueryFiltersSupport:()=>u.FP,isIconName:()=>ie.n6,isLiveChannelJoinEvent:()=>j.Cz,isLiveChannelLeaveEvent:()=>j.jQ,isLiveChannelMessageEvent:()=>j.Z7,isLiveChannelStatusEvent:()=>j.ew,isObject:()=>n.Gv,isSystemOverride:()=>T.Ow,isSystemOverrideWithRef:()=>T.ZW,isTruthy:()=>n.zz,isUnsignedPluginSignature:()=>se.x,isValidLiveChannelAddress:()=>j.aj,makeTimeRange:()=>y.HW,parseLiveChannelAddress:()=>j.DG,patchArrayVectorProrotypeMethods:()=>S.V,preferredVisualizationTypes:()=>n.Nx,scopeFilterOperatorMap:()=>ue.n,toIconName:()=>ie.Uo,toLiveChannelId:()=>j.Qp});var t=e(58649),n=e(39070),s=e(11261),r=e(41260),o=e(91890),m=e(94624),l=e(73372),i=e(8790),u=e(9557),d=e(64388),p=e(98102),c=e.n(p),te={};for(const fe in p)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType"].indexOf(fe)<0&&(te[fe]=()=>p[fe]);e.d(I,te);var y=e(43127),f=e(50082),P=e(25019),a=e(50349),E=e.n(a),te={};for(const fe in a)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch"].indexOf(fe)<0&&(te[fe]=()=>a[fe]);e.d(I,te);var g=e(49812),h=e.n(g),te={};for(const fe in g)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch"].indexOf(fe)<0&&(te[fe]=()=>g[fe]);e.d(I,te);var D=e(22544),v=e.n(D),te={};for(const fe in D)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch"].indexOf(fe)<0&&(te[fe]=()=>D[fe]);e.d(I,te);var C=e(81010),T=e(37055),S=e(35853),O=e(41987),x=e(40187),b=e(47070),M=e(43429),A=e(12470),R=e(24293),B=e(25137),U=e(62625),W=e(93015),N=e.n(W),te={};for(const fe in W)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch","SpecialValue","TransformationApplicabilityLevels","FieldConfigProperty","isSystemOverride","isSystemOverrideWithRef","patchArrayVectorProrotypeMethods","AppPlugin","CoreApp","FeatureState","DataQueryErrorType","DataSourceApi","DataSourcePlugin","ExploreMode","LanguageProvider","VisualizationSuggestionScore","VisualizationSuggestionsBuilder","VisualizationSuggestionsListAppender","VizOrientation","GrafanaPlugin","PluginErrorCode","PluginIncludeType","PluginSignatureStatus","PluginSignatureType","PluginState","PluginType","VariableHide","VariableRefresh","VariableSort","FALLBACK_COLOR","FieldColorModeId","GrafanaThemeType","OrgRole"].indexOf(fe)<0&&(te[fe]=()=>W[fe]);e.d(I,te);var w=e(38893),L=e.n(w),te={};for(const fe in w)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch","SpecialValue","TransformationApplicabilityLevels","FieldConfigProperty","isSystemOverride","isSystemOverrideWithRef","patchArrayVectorProrotypeMethods","AppPlugin","CoreApp","FeatureState","DataQueryErrorType","DataSourceApi","DataSourcePlugin","ExploreMode","LanguageProvider","VisualizationSuggestionScore","VisualizationSuggestionsBuilder","VisualizationSuggestionsListAppender","VizOrientation","GrafanaPlugin","PluginErrorCode","PluginIncludeType","PluginSignatureStatus","PluginSignatureType","PluginState","PluginType","VariableHide","VariableRefresh","VariableSort","FALLBACK_COLOR","FieldColorModeId","GrafanaThemeType","OrgRole"].indexOf(fe)<0&&(te[fe]=()=>w[fe]);e.d(I,te);var V=e(50219),K=e.n(V),te={};for(const fe in V)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch","SpecialValue","TransformationApplicabilityLevels","FieldConfigProperty","isSystemOverride","isSystemOverrideWithRef","patchArrayVectorProrotypeMethods","AppPlugin","CoreApp","FeatureState","DataQueryErrorType","DataSourceApi","DataSourcePlugin","ExploreMode","LanguageProvider","VisualizationSuggestionScore","VisualizationSuggestionsBuilder","VisualizationSuggestionsListAppender","VizOrientation","GrafanaPlugin","PluginErrorCode","PluginIncludeType","PluginSignatureStatus","PluginSignatureType","PluginState","PluginType","VariableHide","VariableRefresh","VariableSort","FALLBACK_COLOR","FieldColorModeId","GrafanaThemeType","OrgRole"].indexOf(fe)<0&&(te[fe]=()=>V[fe]);e.d(I,te);var k=e(26272),j=e(55004),H=e(29505),J=e(58318),X=e.n(J),te={};for(const fe in J)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch","SpecialValue","TransformationApplicabilityLevels","FieldConfigProperty","isSystemOverride","isSystemOverrideWithRef","patchArrayVectorProrotypeMethods","AppPlugin","CoreApp","FeatureState","DataQueryErrorType","DataSourceApi","DataSourcePlugin","ExploreMode","LanguageProvider","VisualizationSuggestionScore","VisualizationSuggestionsBuilder","VisualizationSuggestionsListAppender","VizOrientation","GrafanaPlugin","PluginErrorCode","PluginIncludeType","PluginSignatureStatus","PluginSignatureType","PluginState","PluginType","VariableHide","VariableRefresh","VariableSort","FALLBACK_COLOR","FieldColorModeId","GrafanaThemeType","OrgRole","AppEvents","LegacyGraphHoverClearEvent","LegacyGraphHoverEvent","PanelEvents","LiveChannelConnectionState","LiveChannelEventType","LiveChannelScope","LiveChannelType","isLiveChannelJoinEvent","isLiveChannelLeaveEvent","isLiveChannelMessageEvent","isLiveChannelStatusEvent","isValidLiveChannelAddress","parseLiveChannelAddress","toLiveChannelId","CustomVariableSupport","DataSourceVariableSupport","StandardVariableSupport","VariableSupportBase","VariableSupportType"].indexOf(fe)<0&&(te[fe]=()=>J[fe]);e.d(I,te);var se=e(51527),ae=e(43585),ne=e(64367),q=e.n(ne),te={};for(const fe in ne)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch","SpecialValue","TransformationApplicabilityLevels","FieldConfigProperty","isSystemOverride","isSystemOverrideWithRef","patchArrayVectorProrotypeMethods","AppPlugin","CoreApp","FeatureState","DataQueryErrorType","DataSourceApi","DataSourcePlugin","ExploreMode","LanguageProvider","VisualizationSuggestionScore","VisualizationSuggestionsBuilder","VisualizationSuggestionsListAppender","VizOrientation","GrafanaPlugin","PluginErrorCode","PluginIncludeType","PluginSignatureStatus","PluginSignatureType","PluginState","PluginType","VariableHide","VariableRefresh","VariableSort","FALLBACK_COLOR","FieldColorModeId","GrafanaThemeType","OrgRole","AppEvents","LegacyGraphHoverClearEvent","LegacyGraphHoverEvent","PanelEvents","LiveChannelConnectionState","LiveChannelEventType","LiveChannelScope","LiveChannelType","isLiveChannelJoinEvent","isLiveChannelLeaveEvent","isLiveChannelMessageEvent","isLiveChannelStatusEvent","isValidLiveChannelAddress","parseLiveChannelAddress","toLiveChannelId","CustomVariableSupport","DataSourceVariableSupport","StandardVariableSupport","VariableSupportBase","VariableSupportType","AlertState"].indexOf(fe)<0&&(te[fe]=()=>ne[fe]);e.d(I,te);var ee=e(12463),z=e.n(ee),te={};for(const fe in ee)["default","isUnsignedPluginSignature","PluginExtensionTypes","PluginExtensionPoints","DEFAULT_SAML_NAME","GAUGE_DEFAULT_MAXIMUM","GAUGE_DEFAULT_MINIMUM","LoadingState","NullValueMode","isObject","isTruthy","preferredVisualizationTypes","FieldType","TIME_SERIES_METRIC_FIELD_NAME","TIME_SERIES_TIME_FIELD_NAME","TIME_SERIES_VALUE_FIELD_NAME","DataFrameType","DataLinkConfigOrigin","SupportedTransformationType","VariableOrigin","VariableSuggestionsScope","DashboardCursorSync","AbstractLabelOperator","DataTopic","hasQueryExportSupport","hasQueryImportSupport","AnnotationEventFieldSource","LogLevel","LogRowContextQueryDirection","LogsDedupDescription","LogsDedupStrategy","LogsMetaKind","LogsSortOrder","LogsVolumeType","NumericLogLevel","SupplementaryQueryType","hasLogsContextSupport","hasLogsContextUiSupport","hasQueryModificationSupport","hasSupplementaryQuerySupport","hasToggleableQueryFiltersSupport","PageLayoutType","DefaultTimeZone","TIME_FORMAT","getDefaultRelativeTimeRange","getDefaultTimeRange","makeTimeRange","ThresholdsMode","MappingType","SpecialValueMatch","SpecialValue","TransformationApplicabilityLevels","FieldConfigProperty","isSystemOverride","isSystemOverrideWithRef","patchArrayVectorProrotypeMethods","AppPlugin","CoreApp","FeatureState","DataQueryErrorType","DataSourceApi","DataSourcePlugin","ExploreMode","LanguageProvider","VisualizationSuggestionScore","VisualizationSuggestionsBuilder","VisualizationSuggestionsListAppender","VizOrientation","GrafanaPlugin","PluginErrorCode","PluginIncludeType","PluginSignatureStatus","PluginSignatureType","PluginState","PluginType","VariableHide","VariableRefresh","VariableSort","FALLBACK_COLOR","FieldColorModeId","GrafanaThemeType","OrgRole","AppEvents","LegacyGraphHoverClearEvent","LegacyGraphHoverEvent","PanelEvents","LiveChannelConnectionState","LiveChannelEventType","LiveChannelScope","LiveChannelType","isLiveChannelJoinEvent","isLiveChannelLeaveEvent","isLiveChannelMessageEvent","isLiveChannelStatusEvent","isValidLiveChannelAddress","parseLiveChannelAddress","toLiveChannelId","CustomVariableSupport","DataSourceVariableSupport","StandardVariableSupport","VariableSupportBase","VariableSupportType","AlertState"].indexOf(fe)<0&&(te[fe]=()=>ee[fe]);e.d(I,te);var ie=e(8887),ce=e(74135),ue=e(37891)},19484:(G,I,e)=>{"use strict";e.d(I,{R:()=>t});var t=(n=>(n.Grid="grid",n.List="list",n))(t||{})},26272:(G,I,e)=>{"use strict";e.d(I,{Tq:()=>m,ee:()=>r,kb:()=>o,r1:()=>s});var t=e(89550),n=e(65463);const s={alertSuccess:(0,t.R)("alert-success"),alertWarning:(0,t.R)("alert-warning"),alertError:(0,t.R)("alert-error")},r={refresh:(0,t.R)("refresh"),componentDidMount:(0,t.R)("component-did-mount"),dataReceived:(0,t.R)("data-received"),dataError:(0,t.R)("data-error"),dataFramesReceived:(0,t.R)("data-frames-received"),dataSnapshotLoad:(0,t.R)("data-snapshot-load"),editModeInitialized:(0,t.R)("init-edit-mode"),initPanelActions:(0,t.R)("init-panel-actions"),initialized:(0,t.R)("panel-initialized"),panelTeardown:(0,t.R)("panel-teardown"),render:(0,t.R)("render")};class o extends n.x{static{this.type="graph-hover"}}class m extends n.a{constructor(){super(...arguments),this.payload={point:{}}}static{this.type="graph-hover-clear"}}},55004:(G,I,e)=>{"use strict";e.d(I,{Cz:()=>m,DG:()=>u,Qp:()=>p,Z7:()=>i,ZF:()=>s,aj:()=>d,ew:()=>o,jQ:()=>l,o4:()=>r,os:()=>n,qD:()=>t});var t=(c=>(c.DataSource="ds",c.Plugin="plugin",c.Grafana="grafana",c.Stream="stream",c))(t||{}),n=(c=>(c.DataStream="stream",c.DataFrame="frame",c.JSON="json",c))(n||{}),s=(c=>(c.Pending="pending",c.Connected="connected",c.Connecting="connecting",c.Disconnected="disconnected",c.Shutdown="shutdown",c.Invalid="invalid",c))(s||{}),r=(c=>(c.Status="status",c.Join="join",c.Leave="leave",c.Message="message",c))(r||{});function o(c){return c.type==="status"}function m(c){return c.type==="join"}function l(c){return c.type==="leave"}function i(c){return c.type==="message"}function u(c){if(c?.length){let y=c.trim().split("/");if(y.length>=3)return{scope:y[0],namespace:y[1],path:y.slice(2).join("/")}}}function d(c){return!!(c?.path&&c.namespace&&c.scope)}function p(c){if(!c.scope)return"";let y=c.scope;return!c.namespace||(y+="/"+c.namespace,!c.path)?y:y+"/"+c.path}},9557:(G,I,e)=>{"use strict";e.d(I,{$b:()=>n,Aj:()=>u,FP:()=>c,Nc:()=>d,Ol:()=>l,ZF:()=>m,_0:()=>y,_C:()=>o,cF:()=>i,fY:()=>t.fY,s5:()=>s,tG:()=>r,uH:()=>t.uH,wj:()=>p});var t=e(52622),n=(f=>(f.emerg="critical",f.fatal="critical",f.alert="critical",f.crit="critical",f.critical="critical",f.warn="warning",f.warning="warning",f.err="error",f.eror="error",f.error="error",f.info="info",f.information="info",f.informational="info",f.notice="info",f.dbug="debug",f.debug="debug",f.trace="trace",f.unknown="unknown",f))(n||{});const s={0:"critical",1:"critical",2:"critical",3:"error",4:"warning",5:"info",6:"info",7:"debug"};var r=(f=>(f[f.Number=0]="Number",f[f.String=1]="String",f[f.LabelsMap=2]="LabelsMap",f[f.Error=3]="Error",f))(r||{}),o=(f=>(f.none="No de-duplication",f.exact="De-duplication of successive lines that are identical, ignoring ISO datetimes.",f.numbers="De-duplication of successive lines that are identical when ignoring numbers, e.g., IP addresses, latencies.",f.signature="De-duplication of successive lines that have identical punctuation and whitespace.",f))(o||{}),m=(f=>(f.Backward="BACKWARD",f.Forward="FORWARD",f))(m||{});const l=f=>!f||typeof f!="object"?!1:"getLogRowContext"in f;var i=(f=>(f.LogsVolume="LogsVolume",f.LogsSample="LogsSample",f))(i||{}),u=(f=>(f.FullRange="FullRange",f.Limited="Limited",f))(u||{});const d=(f,P)=>f?("getDataProvider"in f||"getSupplementaryRequest"in f)&&"getSupplementaryQuery"in f&&"getSupportedSupplementaryQueryTypes"in f&&f.getSupportedSupplementaryQueryTypes().includes(P):!1,p=f=>!f||typeof f!="object"?!1:"getLogRowContextUi"in f,c=f=>f!=null&&typeof f=="object"&&"toggleQueryFilter"in f&&"queryHasFilter"in f,y=f=>f!=null&&typeof f=="object"&&"modifyQuery"in f&&"getSupportedQueryModifications"in f},64388:(G,I,e)=>{"use strict";e.d(I,{k:()=>t});var t=(n=>(n[n.Standard=0]="Standard",n[n.Canvas=1]="Canvas",n[n.Custom=2]="Custom",n))(t||{})},62625:(G,I,e)=>{"use strict";e.d(I,{X:()=>t});var t=(n=>(n.None="None",n.Viewer="Viewer",n.Editor="Editor",n.Admin="Admin",n))(t||{})},47070:(G,I,e)=>{"use strict";e.d(I,{NV:()=>l,nQ:()=>o,v2:()=>m,wV:()=>r});var t=e(2543),n=e.n(t),s=e(11261),r=(i=>(i.Auto="auto",i.Vertical="vertical",i.Horizontal="horizontal",i))(r||{}),o=(i=>(i[i.Best=100]="Best",i[i.Good=70]="Good",i[i.OK=50]="OK",i))(o||{});class m{constructor(u,d){this.list=[],this.data=u,this.panel=d,this.dataSummary=this.computeDataSummary()}getListAppender(u){return new l(this.list,u)}computeDataSummary(){const u=this.data?.series||[];let d=0,p=0,c=0,y=0,f=0,P=0,a;for(const E of u){y+=E.length,E.meta?.preferredVisualisationType&&(a=E.meta.preferredVisualisationType);for(const g of E.fields)switch(P++,g.type){case s.PU.number:d+=1;break;case s.PU.time:p+=1;break;case s.PU.string:c+=1;break}E.length>f&&(f=E.length)}return{numberFieldCount:d,timeFieldCount:p,stringFieldCount:c,rowCountTotal:y,rowCountMax:f,fieldCount:P,preferredVisualisationType:a,frameCount:u.length,hasData:y>0,hasTimeField:p>0,hasNumberField:d>0,hasStringField:c>0}}getList(){return this.list}}class l{constructor(u,d){this.list=u,this.defaults=d}append(u){this.list.push((0,t.defaultsDeep)(u,this.defaults))}}},43429:(G,I,e)=>{"use strict";e.d(I,{Ac:()=>s,QE:()=>n,Ud:()=>l,ZK:()=>o,ib:()=>m,kv:()=>r,pn:()=>t});var t=(i=>(i.alpha="alpha",i.beta="beta",i.stable="stable",i.deprecated="deprecated",i))(t||{}),n=(i=>(i.panel="panel",i.datasource="datasource",i.app="app",i.renderer="renderer",i.secretsmanager="secretsmanager",i))(n||{}),s=(i=>(i.internal="internal",i.valid="valid",i.invalid="invalid",i.modified="modified",i.missing="missing",i))(s||{}),r=(i=>(i.grafana="grafana",i.commercial="commercial",i.community="community",i.private="private",i.core="core",i))(r||{}),o=(i=>(i.missingSignature="signatureMissing",i.invalidSignature="signatureInvalid",i.modifiedSignature="signatureModified",i.failedBackendStart="failedBackendStart",i.angular="angular",i))(o||{}),m=(i=>(i.dashboard="dashboard",i.page="page",i.panel="panel",i.datasource="datasource",i))(m||{});class l{addConfigPage(u){return this.configPages||(this.configPages=[]),this.configPages.push(u),this}setChannelSupport(){return console.warn("[deprecation] plugin is using ignored option: setChannelSupport",this.meta),this}constructor(){this.meta={}}}},74135:(G,I,e)=>{"use strict";e.d(I,{S:()=>n,u:()=>t});var t=(s=>(s.link="link",s.component="component",s))(t||{}),n=(s=>(s.AlertInstanceAction="grafana/alerting/instance/action",s.AlertingHomePage="grafana/alerting/home",s.AlertingAlertingRuleAction="grafana/alerting/alertingrule/action",s.AlertingRecordingRuleAction="grafana/alerting/recordingrule/action",s.CommandPalette="grafana/commandpalette/action",s.DashboardPanelMenu="grafana/dashboard/panel/menu",s.DataSourceConfig="grafana/datasources/config",s.ExploreToolbarAction="grafana/explore/toolbar/action",s.UserProfileTab="grafana/user/profile/tab",s))(n||{})},51527:(G,I,e)=>{"use strict";e.d(I,{x:()=>n});var t=e(43429);function n(s){return s&&s!==t.Ac.valid&&s!==t.Ac.internal}},73372:(G,I,e)=>{"use strict";e.d(I,{D_:()=>n,Ee:()=>r,FL:()=>s,QR:()=>t.QR});var t=e(52622),n=(o=>(o.Equal="Equal",o.NotEqual="NotEqual",o.EqualRegEx="EqualRegEx",o.NotEqualRegEx="NotEqualRegEx",o))(n||{});const s=o=>!o||typeof o!="object"?!1:"importFromAbstractQueries"in o,r=o=>!o||typeof o!="object"?!1:"exportToAbstractQueries"in o},37891:(G,I,e)=>{"use strict";e.d(I,{n:()=>t});const t={"=":"equals","!=":"not-equals","=~":"regex-match","!~":"regex-not-match"}},98102:()=>{"use strict"},64367:()=>{"use strict"},12470:(G,I,e)=>{"use strict";e.d(I,{CO:()=>t,ZG:()=>n,zL:()=>s});var t=(r=>(r[r.never=0]="never",r[r.onDashboardLoad=1]="onDashboardLoad",r[r.onTimeRangeChanged=2]="onTimeRangeChanged",r))(t||{}),n=(r=>(r[r.disabled=0]="disabled",r[r.alphabeticalAsc=1]="alphabeticalAsc",r[r.alphabeticalDesc=2]="alphabeticalDesc",r[r.numericalAsc=3]="numericalAsc",r[r.numericalDesc=4]="numericalDesc",r[r.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",r[r.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",r[r.naturalAsc=7]="naturalAsc",r[r.naturalDesc=8]="naturalDesc",r))(n||{}),s=(r=>(r[r.dontHide=0]="dontHide",r[r.hideLabel=1]="hideLabel",r[r.hideVariable=2]="hideVariable",r))(s||{})},25137:(G,I,e)=>{"use strict";e.d(I,{I:()=>t});var t=(n=>(n.Light="light",n.Dark="dark",n))(t||{})},50082:(G,I,e)=>{"use strict";e.d(I,{O:()=>t});var t=(n=>(n.Absolute="absolute",n.Percentage="percentage",n))(t||{})},43127:(G,I,e)=>{"use strict";e.d(I,{Cn:()=>m,E2:()=>o,G$:()=>r,HW:()=>l,lE:()=>s});var t=e(52622),n=e(47232);const s=t.vp,r="YYYY-MM-DD HH:mm:ss";function o(){const i=(0,n.KQ)();return{from:(0,n.KQ)(i).subtract(6,"hour"),to:i,raw:{from:"now-6h",to:"now"}}}function m(){return{from:600,to:0}}function l(i,u){const d=typeof i=="string"?(0,n.KQ)(i):i,p=typeof u=="string"?(0,n.KQ)(u):u;return{from:d,to:p,raw:{from:d,to:p}}}},38893:()=>{"use strict"},81010:(G,I,e)=>{"use strict";e.d(I,{M:()=>t,N:()=>n});var t=(s=>(s[s.NotPossible=-1]="NotPossible",s[s.NotApplicable=0]="NotApplicable",s[s.Applicable=1]="Applicable",s[s.HighlyApplicable=2]="HighlyApplicable",s))(t||{}),n=(s=>(s.True="true",s.False="false",s.Null="null",s.Empty="empty",s))(n||{})},25019:(G,I,e)=>{"use strict";e.d(I,{W:()=>n,d:()=>t});var t=(s=>(s.ValueToText="value",s.RangeToText="range",s.RegexToText="regex",s.SpecialValue="special",s))(t||{}),n=(s=>(s.True="true",s.False="false",s.Null="null",s.NaN="nan",s.NullAndNaN="null+nan",s.Empty="empty",s))(n||{})},29505:(G,I,e)=>{"use strict";e.d(I,{J$:()=>s,Qz:()=>t,ZV:()=>o,f5:()=>r,xi:()=>n});var t=(m=>(m.Legacy="legacy",m.Standard="standard",m.Custom="custom",m.Datasource="datasource",m))(t||{});class n{}class s extends n{getType(){return"standard"}}class r extends n{getType(){return"custom"}}class o extends n{getType(){return"datasource"}}},35853:(G,I,e)=>{"use strict";e.d(I,{V:()=>t});function t(){Object.getOwnPropertyDescriptor(Array.prototype,"toArray")||Object.defineProperties(Array.prototype,{get:{value:function(n){return this[n]},writable:!0,enumerable:!1,configurable:!0},set:{value:function(n,s){this[n]=s},writable:!0,enumerable:!1,configurable:!0},add:{value:function(n){this.push(n)},writable:!0,enumerable:!1,configurable:!0},toArray:{value:function(){return this},writable:!0,enumerable:!1,configurable:!0}})}t()},60264:(G,I,e)=>{"use strict";e.d(I,{bk:()=>l,pv:()=>d,iF:()=>u});var t=e(2543),n=e(69550),s=e(27310),r=e(39070),o=e(83077);class m{constructor(){this.properties=[]}addCustomEditor(c){return this.properties.push(c),this}getRegistry(){return new o.O(()=>this.properties)}getItems(){return this.properties}}class l extends m{addNumberInput(c){return this.addCustomEditor({...c,id:c.path,override:n.D.get("number").editor,editor:n.D.get("number").editor,process:s.m0,shouldApply:c.shouldApply??(()=>!0),settings:c.settings||{}})}addSliderInput(c){return this.addCustomEditor({...c,id:c.path,override:n.D.get("slider").editor,editor:n.D.get("slider").editor,process:s.m0,shouldApply:c.shouldApply??(()=>!0),settings:c.settings||{}})}addTextInput(c){return this.addCustomEditor({...c,id:c.path,override:n.D.get("text").editor,editor:n.D.get("text").editor,process:s.OU,shouldApply:c.shouldApply??(()=>!0),settings:c.settings||{}})}addSelect(c){return this.addCustomEditor({...c,id:c.path,override:n.D.get("select").editor,editor:n.D.get("select").editor,process:s.hL,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{options:[]}})}addRadio(c){return this.addCustomEditor({...c,id:c.path,override:n.D.get("radio").editor,editor:n.D.get("radio").editor,process:s.hL,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{options:[]}})}addBooleanSwitch(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:s.FM,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}addColorPicker(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("color").editor,override:n.D.get("color").editor,process:s.hS,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}addUnitPicker(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("unit").editor,override:n.D.get("unit").editor,process:s.lG,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}addFieldNamePicker(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("field-name").editor,override:n.D.get("field-name").editor,process:s.hS,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}addGenericEditor(c,y){return this.addCustomEditor({...c,id:c.path,editor:y,override:y,process:s.hS,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}}class i{constructor(c){this.cfg=c,this.path="",this.id="nested-panel-options",this.name="nested",this.editor=()=>null,this.getBuilder=()=>this.cfg.build,this.getNestedValueAccess=y=>{const f=this.cfg.values;return f?f(y):{getValue:P=>y.getValue(`${this.path}.${P}`),onChange:(P,a)=>y.onChange(`${this.path}.${P}`,a)}},this.path=c.path,this.category=c.category,this.defaultValue=this.getDefaultValue(c)}getDefaultValue(c){let y=(0,r.Gv)(c.defaultValue)?(0,t.cloneDeep)(c.defaultValue):{};const f=new d;c.build(f,{data:[]});for(const P of f.getItems())P.defaultValue!=null&&(0,t.set)(y,P.path,P.defaultValue);return y}}function u(p){return(0,r.Gv)(p)&&"id"in p&&p.id==="nested-panel-options"}class d extends m{addNestedOptions(c){const y=new i(c);return this.addCustomEditor(y)}addNumberInput(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("number").editor})}addSliderInput(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("slider").editor})}addTextInput(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("text").editor})}addStringArray(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("strings").editor})}addSelect(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("select").editor})}addMultiSelect(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("multi-select").editor})}addRadio(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("radio").editor})}addBooleanSwitch(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("boolean").editor})}addColorPicker(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("color").editor,settings:c.settings||{}})}addTimeZonePicker(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("timezone").editor,settings:c.settings||{}})}addUnitPicker(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("unit").editor})}addFieldNamePicker(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("field-name").editor})}addDashboardPicker(c){return this.addCustomEditor({...c,id:c.path,editor:n.D.get("dashboard-uid").editor})}}},28802:(G,I,e)=>{"use strict";e.d(I,{t:()=>s});var t=e(2543),n=e.n(t);function s(r){return typeof r=="number"?r:r===""||r===null||r===void 0||Array.isArray(r)?NaN:typeof r=="boolean"?r?1:0:(0,t.toNumber)(r)}},14588:(G,I,e)=>{"use strict";e.r(I),e.d(I,{insertAfterImmutably:()=>r,insertBeforeImmutably:()=>s,moveItemImmutably:()=>n,sortValues:()=>l});var t=e(52622);function n(i,u,d){const p=[...i];return Array.prototype.splice.call(p,d,0,Array.prototype.splice.call(p,u,1)[0]),p}function s(i,u,d){if(d<0||d>i.length)throw new Error("Index out of bounds");const p=[...i];return p.splice(d,0,u),p}function r(i,u,d){if(d<0||d>i.length)throw new Error("Index out of bounds");const p=[...i];return p.splice(d+1,0,u),p}const o=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),m=(i,u)=>i-u;function l(i){return(u,d)=>{if(u===d)return 0;if(d==null||typeof d=="string"&&d.trim()==="")return-1;if(u==null||typeof u=="string"&&u?.trim()==="")return 1;let p=o.compare;return typeof u=="number"&&typeof d=="number"&&(p=m),i===t.xB.Descending?p(d,u):p(u,d)}}},11710:(G,I,e)=>{"use strict";e.d(I,{b:()=>s,k:()=>n});var t=e(83077),n=(r=>(r.Add="+",r.Subtract="-",r.Divide="/",r.Multiply="*",r))(n||{});const s=new t.O(()=>[{id:"+",name:"Add",operation:(r,o)=>r+o,binaryOperationID:"+"},{id:"-",name:"Subtract",operation:(r,o)=>r-o,binaryOperationID:"-"},{id:"*",name:"Multiply",operation:(r,o)=>r*o,binaryOperationID:"*"},{id:"/",name:"Divide",operation:(r,o)=>r/o,binaryOperationID:"/"}])},72436:(G,I,e)=>{"use strict";e.d(I,{F7:()=>d,Jh:()=>p,_O:()=>g,i8:()=>y});var t=e(2543),n=e.n(t),s=e(44809),r=e.n(s),o=e(37471),m=e(14236),l=e(28240),i=e(11261),u=e(83195),d=(h=>(h[h.full=0]="full",h[h.name=1]="name",h[h.none=2]="none",h))(d||{});function p(h,D){return new y(D).readCSV(h)}var c=(h=>(h[h.Starting=0]="Starting",h[h.InHeader=1]="InHeader",h[h.ReadingRows=2]="ReadingRows",h))(c||{});class y{constructor(D){this.chunk=(v,C)=>{for(let T=0;T<v.data.length;T++){const S=v.data[T];if(S.length<1)continue;const O=S[0];if(O){if(O.startsWith("#")){const x=O.indexOf("#",2);if(x>0){const b=O.slice(1,x),M=b==="name";if(M||{unit:"#"}.hasOwnProperty(b)){this.state===2&&(this.current=new o.k({fields:[]}),this.data.push(this.current));const R=O.slice(x+1);if(M){this.current.addFieldFor(void 0,R);for(let B=1;B<S.length;B++)this.current.addFieldFor(void 0,S[B])}else{const{fields:B}=this.current;for(let U=0;U<B.length;U++){B[U].config||(B[U].config={});const W=B[U].config;W[b]=U===0?R:S[U]}}this.state=1;continue}}else if(this.state===0){this.state=1;continue}continue}if(this.state===0){if((0,m.HW)(O)===i.PU.string){for(const b of S)this.current.addFieldFor(void 0,b);this.state=1;continue}this.state=1}}if(this.state,this.state=2,S.length>this.current.fields.length){const{fields:x}=this.current;for(let b=x.length;b<S.length;b++)this.current.addFieldFor(S[b]);this.callback&&this.callback.onHeader(this.current.fields)}this.current.appendRow(S),this.callback&&this.callback.onRow(S)}},D||(D={}),this.config=D.config||{},this.callback=D.callback,this.current=new o.k({fields:[]}),this.state=0,this.data=[]}readCSV(D){this.current=new o.k({fields:[]}),this.data=[this.current];const v={...this.config,dynamicTyping:!1,skipEmptyLines:!0,comments:!1,chunk:this.chunk};return r().parse(D,v),this.data}}function f(h,D){if(h==null)return"";const v=h.toString();return v.includes('"')?D.quoteChar+v.replace(/"/gi,'""')+D.quoteChar:v.includes(`
`)||D.delimiter&&v.includes(D.delimiter)?D.quoteChar+v+D.quoteChar:v}function P(h,D){return h.display?v=>{const C=h.display(v);return f((0,u.cN)(C),D)}:v=>f(v,D)}function a(h,D,v){const C=h==="name",T=h==="type";for(const S of D){const O=S.config;if(C||T||O&&O.hasOwnProperty(h)){let x="#"+h+"#";for(let b=0;b<D.length;b++){b>0&&(x=x+v.delimiter);let M=D[b].name;T?M=D[b].type:C||(M=D[b].config[h]),M&&(x=x+f(M,v))}return x+v.newline}}return""}function E(){const h=["x","y"];return h.toLocaleString?h.toLocaleString().charAt(1):","}function g(h,D){if(!h)return"";D=(0,t.defaults)(D,{delimiter:E(),newline:`\r
`,quoteChar:'"',encoding:"",headerStyle:1,useExcelHeader:!1});let v=D.useExcelHeader?`sep=${D.delimiter}${D.newline}`:"";for(let C=0;C<h.length;C++){const T=h[C],{fields:S}=T;if(S.length===0)continue;if(D.headerStyle===0)v=v+a("name",S,D)+a("type",S,D)+a("unit",S,D)+a("dateFormat",S,D);else if(D.headerStyle===1){for(let x=0;x<S.length;x++)x>0&&(v+=D.delimiter),v+=`"${(0,l.Ct)(S[x],T).replace(/"/g,'""')}"`;v+=D.newline}const O=S[0].values.length;if(O>0){const x=S.map(b=>P(b,D));for(let b=0;b<O;b++){for(let M=0;M<S.length;M++){M>0&&(v=v+D.delimiter);const A=S[M].values[b];A!==null&&(v=v+x[M](A))}b!==O-1&&(v=v+D.newline)}}C!==h.length-1&&(v=v+D.newline)}return v}},6709:(G,I,e)=>{"use strict";e.d(I,{c:()=>s,u:()=>r});var t=e(71733),n=e(76885);const s={keepTime:"__url_time_range",timeRangeFrom:"__from",timeRangeTo:"__to",includeVars:"__all_variables",seriesName:"__series.name",fieldName:"__field.name",valueTime:"__value.time",valueNumeric:"__value.numeric",valueText:"__value.text",valueRaw:"__value.raw",valueCalc:"__value.calc"};function r(i){const{onClickFn:u,replaceVariables:d,link:p,scopedVars:c,range:y,field:f,internalLink:P}=i,a=m(p.internal?.query,c,d),E=m(p.internal?.panelsState,c,d),g=m(p.internal?.meta?.correlationData,c,d),h=p.title?p.title:P.datasourceName;return{title:d(h,c),href:o(P.datasourceUid,a,y,E),onClick:u?D=>{D.preventDefault&&D.preventDefault(),u({datasourceUid:P.datasourceUid,queries:[a],panelsState:E,correlationHelperData:g,range:y})}:void 0,target:p?.targetBlank?"_blank":"_self",origin:f}}function o(i,u,d,p){return t.I.assureBaseUrl(`/explore?left=${encodeURIComponent((0,n.Pp)({...d?.raw?{range:(0,n.sQ)(d.raw)}:{},datasource:i,queries:[u],panelsState:p}))}`)}function m(i,u,d){if(!i)return i;if(typeof i=="string")return d(i,u);const p=JSON.parse(JSON.stringify(i));return l(p,u,d)}function l(i,u,d){for(const p of Object.keys(i))typeof i[p]=="string"?i[p]=d(i[p],u):typeof i[p]=="object"&&i[p]!==null&&(i[p]=l(i[p],u,d));return i}},22391:(G,I,e)=>{"use strict";e.d(I,{BD:()=>u,EX:()=>d,Iz:()=>o,PG:()=>l,QP:()=>a,fN:()=>r,lO:()=>f,mn:()=>i,p$:()=>s,pN:()=>y,wY:()=>p,wp:()=>P,yV:()=>c,zX:()=>m});var t=e(2543),n=e.n(t);function s(E){return{uid:E.uid,type:E.type}}function r(E){return typeof E=="object"&&typeof E?.uid=="string"}function o(E){if(r(E))return E.uid;if((0,t.isString)(E))return E}const m=(E,g)=>h=>{y(E,g,h.currentTarget.value)},l=(E,g)=>h=>{f(E,g,h.currentTarget.value)},i=(E,g)=>h=>{P(E,g,h.currentTarget.value)},u=(E,g)=>h=>{f(E,g,h.value)},d=(E,g)=>h=>{f(E,g,h.currentTarget.checked)},p=(E,g)=>h=>{P(E,g,h.value)},c=(E,g)=>h=>{a(E,g)};function y(E,g,h){const D=E.options;E.onOptionsChange({...D,[g]:h})}const f=(E,g,h)=>{const D=E.options;E.onOptionsChange({...D,jsonData:{...D.jsonData,[g]:h}})},P=(E,g,h)=>{const D=E.options;E.onOptionsChange({...D,secureJsonData:{...D.secureJsonData?D.secureJsonData:{},[g]:h}})},a=(E,g)=>{const h=E.options;E.onOptionsChange({...h,secureJsonData:{...h.secureJsonData?h.secureJsonData:{},[g]:""},secureJsonFields:{...h.secureJsonFields,[g]:!1}})}},95344:(G,I,e)=>{"use strict";e.d(I,{l:()=>n});const t={},n=(s,r,o)=>{let m=`[Deprecation warning] ${s}: ${r} is deprecated`;o&&(m+=`. Use ${o} instead`);const l=Date.now(),i=t[m];(!i||l-i>1e4)&&(console.warn(m),t[m]=l)}},87885:(G,I,e)=>{"use strict";e.d(I,{f:()=>t});var t=(n=>(n[n.Transformations=0]="Transformations",n[n.FieldConfig=1]="FieldConfig",n[n.FieldConfigOverrides=2]="FieldConfigOverrides",n))(t||{})},39306:(G,I,e)=>{"use strict";e.d(I,{R:()=>n,r:()=>s});var t=e(39070);function n({xField:r,yField:o,nullValueMode:m}){const l=r.values,i=o.values,u=l.length;if(i.length!==u)throw new Error("Unexpected field length");const d=m===t.UW.Ignore,p=m===t.UW.AsZero,c=[];for(let y=0;y<u;y++){const f=l[y];let P=i[y];if(P===null){if(d)continue;p&&(P=0)}f!==null&&c.push([f,P])}return c}function s(r,o){if(!o.from||!o.to||!r||r.length===0)return[];const m=o.from.valueOf(),l=o.to.valueOf(),i=r[0][1];return[[m,i],[l,i]]}},94032:(G,I,e)=>{"use strict";e.d(I,{kP:()=>c.k,F7:()=>o.F7,i8:()=>o.i8,cI:()=>D.c,fu:()=>v.f,bk:()=>a.bk,An:()=>O.An,uc:()=>f.u,pv:()=>a.pv,OR:()=>n.O,_G:()=>y._,to:()=>T.t,XC:()=>t,bP:()=>c.b,tj:()=>u,Eg:()=>x.E,bh:()=>O.bh,lt:()=>r.l,yO:()=>m.yO,s6:()=>m.s6,h6:()=>m.h6,p$:()=>s.p$,Iz:()=>s.Iz,RZ:()=>E.R,rG:()=>E.r,cs:()=>x.c,tY:()=>d,E6:()=>l.E,dO:()=>p,fN:()=>s.fN,RI:()=>i.R,Ig:()=>g.I,Yi:()=>C.Y,uS:()=>D.u,_p:()=>m._p,_8:()=>M._,wm:()=>i.w,PG:()=>s.PG,EX:()=>s.EX,BD:()=>s.BD,zX:()=>s.zX,yV:()=>s.yV,mn:()=>s.mn,wY:()=>s.wY,Xy:()=>m.Xy,Jh:()=>o.Jh,j_:()=>b.j,hB:()=>l.h,Pp:()=>h.Pp,_O:()=>o._O,zL:()=>P.z,sQ:()=>h.sQ,j7:()=>y.j,lO:()=>s.lO,pN:()=>s.pN,QP:()=>s.QP,wp:()=>s.wp,kM:()=>h.kM,kz:()=>S.k});var t=e(14588),n=e(83077),s=e(22391),r=e(95344),o=e(72436),m=e(8249),l=e(97706),i=e(92041);const u=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"],d=A=>{let R,B,U=Number.MAX_VALUE;for(let W=0;W<A.values.length;W++){const N=A.values[W];if(R!==void 0){const w=N-R;B===void 0&&(U=w),w<U&&(U=w)}R=N}return U},p=A=>{for(let R=0;R<A.values.length;R++){const B=A.values[R];if(B!=null){const U=B.toString();if(U.length===13&&U%1e3!==0)return!0}}return!1};var c=e(11710),y=e(27618),f=e(25352),P=e(50877),a=e(60264),E=e(39306),g=e(71733),h=e(76885),D=e(6709),v=e(87885),C=e(92341),T=e(28802),S=e(72495),O=e(62398),x=e(92053),b=e(43659),M=e(80147)},8249:(G,I,e)=>{"use strict";e.d(I,{Xy:()=>n,_p:()=>o,h6:()=>m,s6:()=>r,yO:()=>s});const t=/\b(\w+)(!?=~?)"([^"\n]*?)"/g;function n(l){const i={};return l.replace(t,(u,d,p,c)=>(i[d]=c,"")),i}function s(l){return l.reduce((i,u)=>{if(!u)throw new Error("Need parsed labels to find common labels.");return Object.keys(u).forEach(d=>{(i[d]===void 0||i[d]!==u[d])&&delete i[d]}),Object.keys(i).forEach(d=>{u[d]===void 0&&delete i[d]}),i},{...l[0]})}function r(l,i){const u={...l};return Object.keys(i).forEach(d=>{delete u[d]}),u}function o(l,i){if(!l)return!0;for(const[u,d]of Object.entries(l))if(!i||i[u]!==d)return!1;return!0}function m(l,i="",u){if(!l||Object.keys(l).length===0)return i;const p=Object.keys(l).sort().map(c=>`${c}="${l[c]}"`).join(", ");return u?p:["{",p,"}"].join("")}},71733:(G,I,e)=>{"use strict";e.d(I,{I:()=>p});var t=e(40672),n=e(76885);let s={appSubUrl:""},r,o;const m=c=>{try{return new URL(c)}catch{return}},l=c=>{const y=m(c);if(y&&y.origin!==window.location.origin)return c;const f=s.appSubUrl??"",P=f.endsWith("/")?1:0,a=c.startsWith("http");let E=f;return(!c.startsWith("/")||a)&&(E=`${window.location.origin}${f}`),c.length>0&&(c.indexOf(E+"/")===0||c===E)?c.slice(E.length-P):c},i=c=>c.startsWith("/")?`${s.appSubUrl}${l(c)}`:c,p={initialize:c=>{s=c.config,r=c.getTimeRangeForUrl,o=c.getVariablesUrlParams},stripBaseFromUrl:l,assureBaseUrl:i,updateSearchParams:(c,y)=>{const f=new URLSearchParams(y);try{const P=new URL(c);return f.forEach((a,E)=>P.searchParams.set(E,a)),P.href}catch{const P=new URLSearchParams(c);return f.forEach((a,E)=>{P.set(E,a)}),"?"+P.toString()}},getTimeRangeUrlParams:()=>r?n.kM.toUrlParams(r()):null,getVariablesUrlParams:c=>{if(!o)return null;const y=o(c);return n.kM.toUrlParams(y)},getUrlForPartial:(c,y)=>{const f=n.kM.parseKeyValue(c.search.startsWith("?")?c.search.substring(1):c.search);for(const P in y)y[P]===null||y[P]===void 0?delete f[P]:f[P]=y[P];return i(n.kM.renderUrl(c.pathname,f))},processUrl:c=>s.disableSanitizeHtml?c:t.sQ.sanitizeUrl(c)}},92341:(G,I,e)=>{"use strict";e.d(I,{Y:()=>t});function t(n){return new Proxy(n,{apply(s,r,o){return(typeof Reflect>"u"||!Reflect.construct)&&alert("Browser is too old"),Reflect.construct(s,o,r.constructor)}})}},80147:(G,I,e)=>{"use strict";e.d(I,{_:()=>t});function t(n,s){return s.id===n?!0:s.aliasIDs?s.aliasIDs.includes(n):!1}},25352:(G,I,e)=>{"use strict";e.d(I,{u:()=>t});var t=(n=>(n.id="id",n.title="title",n.subTitle="subtitle",n.mainStat="mainstat",n.secondaryStat="secondarystat",n.arc="arc__",n.icon="icon",n.color="color",n.source="source",n.target="target",n.detail="detail__",n.nodeRadius="noderadius",n.thickness="thickness",n.highlighted="highlighted",n.strokeDasharray="strokedasharray",n.fixedX="fixedx",n.fixedY="fixedy",n))(t||{})},97706:(G,I,e)=>{"use strict";e.d(I,{E:()=>n,h:()=>t});function t(s,r=0){if(Number.isInteger(s))return s;let o=10**r,m=s*o*(1+Number.EPSILON);return Math.round(m)/o}function n(s){return((""+s).split(".")[1]||"").length}},92041:(G,I,e)=>{"use strict";e.d(I,{R:()=>n,w:()=>t});const t=s=>Object.keys(s).reduce((r,o)=>(s[o]!==void 0&&(r[o]=s[o]),r),{}),n=s=>typeof s=="object"&&s!==null&&Object.keys(s).length===0},50877:(G,I,e)=>{"use strict";e.d(I,{z:()=>t});const t=n=>({label:n,value:n})},27618:(G,I,e)=>{"use strict";e.d(I,{_:()=>n,j:()=>s});var t=e(83077),n=(r=>(r.Abs="abs",r.Exp="exp",r.Ln="ln",r.Floor="floor",r.Ceil="ceil",r))(n||{});const s=new t.O(()=>[{id:"abs",name:"Absolute value",operation:r=>Math.abs(r),unaryOperationID:"abs"},{id:"exp",name:"Natural exponent",operation:r=>Math.exp(r),unaryOperationID:"exp"},{id:"ln",name:"Natural logarithm",operation:r=>Math.log(r),unaryOperationID:"ln"},{id:"floor",name:"Floor",operation:r=>Math.floor(r),unaryOperationID:"floor"},{id:"ceil",name:"Ceiling",operation:r=>Math.ceil(r),unaryOperationID:"ceil"}])},76885:(G,I,e)=>{"use strict";e.d(I,{Pp:()=>p,kM:()=>d,sQ:()=>c});var t=e(47232);/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */function n(y,f){return f&&Object.keys(f).length>0&&(y+="?"+r(f)),y}function s(y,f){return encodeURIComponent(y).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,f?"%20":"+").replace(/[!'()*]/g,function(P){return"%"+P.charCodeAt(0).toString(16).toUpperCase()})}function r(y,f=!0){const P=[],a=/\[\]$/,E=f?(v,C)=>s(v,C):(v,C)=>encodeURIComponent(v),g=v=>Object.prototype.toString.call(v)==="[object Array]",h=(v,C)=>{if(C=typeof C=="function"?C():C===null||C===void 0?"":C,typeof C!="boolean")P[P.length]=E(v,!0)+"="+E(C,!0);else{const T=C?"":"="+E("false",!0);P[P.length]=E(v,!0)+T}},D=(v,C)=>{let T,S,O;if(v)if(g(C))for(T=0,S=C.length;T<S;T++)a.test(v)?h(v,C[T]):D(v,C[T]);else if(C&&String(C)==="[object Object]")for(O in C)D(v+"["+O+"]",C[O]);else h(v,C);else if(g(C))for(T=0,S=C.length;T<S;T++)h(C[T].name,C[T].value);else for(O in C)D(O,C[O]);return P};return D("",y).join("&")}function o(y){return r(y,!1)}function m(y,f){if(f!=null&&f!==""){const P=y.indexOf("?");P!==-1?y.length-P>1&&(y+="&"):y+="?",y+=f}return y}function l(){const f=window.location.search.substring(1).split("&"),P={};for(const a of f){const E=a.split("=");if(E.length>1){const g=decodeURIComponent(E[0]),h=decodeURIComponent(E[1]);g in P?P[g]=[...P[g],h]:P[g]=[h]}else if(E.length===1){const g=decodeURIComponent(E[0]);P[g]=!0}}return P}function i(y){const f={},P=(y||"").split("&");for(let a of P){let E,g,h;if(a&&(g=a=a.replace(/\+/g,"%20"),E=a.indexOf("="),E!==-1&&(g=a.substring(0,E),h=a.substring(E+1)),g=u(g),g!==void 0)){h=h!==void 0?u(h):!0;let D;typeof h=="string"&&h!==""?D=h==="true"||h==="false"?h==="true":h:D=h,f.hasOwnProperty(g)?Array.isArray(f[g])?f[g].push(h):f[g]=[f[g],isNaN(D)?h:D]:f[g]=isNaN(D)?h:D}}return f}function u(y){try{return decodeURIComponent(y)}catch{return}}const d={renderUrl:n,toUrlParams:r,appendQueryToUrl:m,getUrlSearchParams:l,parseKeyValue:i,serializeParams:o};function p(y,f){return f!==void 0&&console.warn("`compact` parameter is deprecated and will be removed in a future release"),JSON.stringify(y)}const c=y=>{let f=y.from;(0,t.Ar)(f)&&(f=f.valueOf().toString());let P=y.to;return(0,t.Ar)(P)&&(P=P.valueOf().toString()),{from:f,to:P}}},62398:(G,I,e)=>{"use strict";e.d(I,{An:()=>m,Zz:()=>r,bh:()=>l});var t=e(47737),n=e(54479),s=e(25019);function r(u,d){for(const p of u)switch(p.type){case s.d.ValueToText:if(d==null)continue;const c=p.options[d];if(c)return c;break;case s.d.RangeToText:if(d==null)continue;const y=parseFloat(d);if(isNaN(y)||!isNaN(p.options.from)&&y<p.options.from||!isNaN(p.options.to)&&y>p.options.to)continue;return p.options.result;case s.d.RegexToText:if(d==null||typeof d!="string")continue;const a=(0,n.dO)(p.options.pattern);if(d.match(a)){const E={...p.options.result};return E.text!=null&&(E.text=d.replace(a,p.options.result.text||"")),E}case s.d.SpecialValue:switch(p.options.match){case s.W.Null:{if(d==null)return p.options.result;break}case s.W.NaN:{if(typeof d=="number"&&isNaN(d))return p.options.result;break}case s.W.NullAndNaN:{if(typeof d=="number"&&isNaN(d)||d==null)return p.options.result;break}case s.W.True:{if(d===!0||d==="true")return p.options.result;break}case s.W.False:{if(d===!1||d==="false")return p.options.result;break}case s.W.Empty:{if(d==="")return p.options.result;break}}}return null}function o(u){return(typeof u=="number"||typeof u=="string"&&u.trim()!=="")&&!isNaN(u)}var m=(u=>(u[u.ValueToText=1]="ValueToText",u[u.RangeToText=2]="RangeToText",u))(m||{});function l(u,d){const p=[];let c=u.mappingType;if(u.mappingType||(u.valueMaps&&u.valueMaps.length?c=1:u.rangeMaps&&u.rangeMaps.length&&(c=2)),c===1)for(let y=0;y<u.valueMaps.length;y++){const f=u.valueMaps[y];p.push(i({...f,id:y,type:s.d.ValueToText},u.fieldConfig?.defaults?.thresholds||d))}else if(c===2)for(let y=0;y<u.rangeMaps.length;y++){const f=u.rangeMaps[y];p.push(i({...f,id:y,type:s.d.RangeToText},u.fieldConfig?.defaults?.thresholds||d))}return p}function i(u,d){const p={type:s.d.ValueToText,options:{}},c=[];let y;const f=parseFloat(u.text);if(d&&!isNaN(f)){const P=(0,t.yQ)(f,d.steps);P&&P.color&&(y=P.color)}switch(u.type){case 1:case s.d.ValueToText:u.value!=null&&(u.value==="null"?c.push({type:s.d.SpecialValue,options:{match:s.W.Null,result:{text:u.text,color:y}}}):p.options[String(u.value)]={text:u.text,color:y});break;case 2:case s.d.RangeToText:u.from==="null"||u.to==="null"?c.push({type:s.d.SpecialValue,options:{match:s.W.Null,result:{text:u.text,color:y}}}):c.push({type:s.d.RangeToText,options:{from:+u.from,to:+u.to,result:{text:u.text,color:y}}});break}return Object.keys(p.options).length>0&&c.unshift(p),c[0]}},92053:(G,I,e)=>{"use strict";e.d(I,{E:()=>n,c:()=>s});const t="__searchFilter",n=r=>r&&typeof r=="string"?r.indexOf(t)!==-1:!1,s=r=>{const{query:o,wildcardChar:m}=r;if(!n(o))return{};let{options:l}=r;return l=l||{searchFilter:""},{__searchFilter:{value:l.searchFilter?`${l.searchFilter}${m}`:`${m}`,text:""}}}},72495:(G,I,e)=>{"use strict";e.d(I,{k:()=>o});var t=e(44240),n=e(39697),s=e(65961),r=e(67791);function o({whileLoading:m,source:l}){return(0,t.h)((0,n.O)(200).pipe((0,s.u)(m),(0,r.Q)(l)),l)}},56496:(G,I,e)=>{"use strict";e.d(I,{G8:()=>t.G8,Hg:()=>t.Hg,Ke:()=>t.Ke,Mg:()=>t.Mg,Qc:()=>t.Qc,UR:()=>t.UR,cH:()=>t.cH,cN:()=>t.cN,gZ:()=>t.gZ,j9:()=>t.j9,j_:()=>t.j_,uH:()=>t.uH,yP:()=>t.yP});var t=e(83195)},26517:(G,I,e)=>{"use strict";e.d(I,{Gl:()=>n,cL:()=>o,rT:()=>i,yW:()=>l});var t=e(83195);function n(u,d){const p=["","K","M","B","T"],c=(0,t.yP)(1e3,p);return(y,f,P)=>{if(y==null)return{text:""};const a=y<0;a&&(y=Math.abs(y));const E=c(y,f,P);return d?E.suffix=E.suffix!==void 0?`${E.suffix}${u}`:void 0:E.prefix=u,a&&(E.prefix=`-${E.prefix?.length?E.prefix:""}`),E}}const s=["f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],r=s.indexOf("");function o(u){const d=s.findIndex(p=>p.normalize("NFKD")===u.normalize("NFKD"));return d<0?0:d-r}const m=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];function l(u,d=0){const p=m.map(c=>" "+c+u);return(0,t.yP)(1024,p,d)}function i(u,d=0){const p=s.map(c=>" "+c+u);return(0,t.yP)(1e3,p,r+d)}},83195:(G,I,e)=>{"use strict";e.d(I,{Qc:()=>te,cN:()=>j,j_:()=>de,Ke:()=>pe,uH:()=>le,j9:()=>z,Hg:()=>ue,yP:()=>ce,UR:()=>fe,cH:()=>Te,Mg:()=>se,gZ:()=>ne,G8:()=>ee});var t=e(2543);function n(ve,be){return ve===null?{text:""}:{text:se(ve,be),suffix:"%"}}function s(ve,be){return ve===null?{text:""}:{text:se(100*ve,be),suffix:"%"}}function r(ve,be){if(ve==null)return{text:""};const Oe=o(ve,be);return Oe.text.substring(0,1)==="-"?Oe.text="-0x"+Oe.text.substring(1):Oe.text="0x"+Oe.text,Oe}function o(ve,be){return ve==null?{text:""}:{text:parseFloat(se(ve,be)).toString(16).toUpperCase()}}function m(ve,be){return ve==null?{text:""}:{text:ve.toExponential(be??void 0)}}var l=e(72724),i=e(42994),u=e(47232),d=(ve=>(ve.Year="year",ve.Month="month",ve.Week="week",ve.Day="day",ve.Hour="hour",ve.Minute="minute",ve.Second="second",ve.Millisecond="millisecond",ve))(d||{});const p=["year","month","week","day","hour","minute","second","millisecond"],c={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1,millisecond:.001};function y(ve,be){return ve===null?{text:""}:Math.abs(ve)<1e3?{text:se(ve,be),suffix:" ns"}:Math.abs(ve)<1e6?ne(ve/1e3,be," \xB5s"):Math.abs(ve)<1e9?ne(ve/1e6,be," ms"):Math.abs(ve)<6e10?ne(ve/1e9,be," s"):Math.abs(ve)<36e11?ne(ve/6e10,be," min"):Math.abs(ve)<864e11?ne(ve/36e11,be," hour"):ne(ve/864e11,be," day")}function f(ve,be){return ve===null?{text:""}:Math.abs(ve)<1e3?{text:se(ve,be),suffix:" \xB5s"}:Math.abs(ve)<1e6?ne(ve/1e3,be," ms"):ne(ve/1e6,be," s")}function P(ve,be,Oe){return ve===null?{text:""}:Math.abs(ve)<1e3?{text:se(ve,be),suffix:" ms"}:Math.abs(ve)<6e4?ne(ve/1e3,be," s"):Math.abs(ve)<36e5?ne(ve/6e4,be," min"):Math.abs(ve)<864e5?ne(ve/36e5,be," hour"):Math.abs(ve)<31536e6?ne(ve/864e5,be," day"):ne(ve/31536e6,be," year")}function a(ve,be){return ve===null?{text:""}:ve===0?{text:"0",suffix:" s"}:Math.abs(ve)<1e-6?ne(ve*1e9,be," ns"):Math.abs(ve)<.001?ne(ve*1e6,be," \xB5s"):Math.abs(ve)<1?ne(ve*1e3,be," ms"):Math.abs(ve)<60?{text:se(ve,be),suffix:" s"}:Math.abs(ve)<3600?ne(ve/60,be," min"):Math.abs(ve)<86400?ne(ve/3600,be," hour"):Math.abs(ve)<604800?ne(ve/86400,be," day"):Math.abs(ve)<31536e3?ne(ve/604800,be," week"):ne(ve/31556900,be," year")}function E(ve,be){return ve===null?{text:""}:Math.abs(ve)<60?{text:se(ve,be),suffix:" min"}:Math.abs(ve)<1440?ne(ve/60,be," hour"):Math.abs(ve)<10080?ne(ve/1440,be," day"):Math.abs(ve)<604800?ne(ve/10080,be," week"):ne(ve/525948,be," year")}function g(ve,be){return ve===null?{text:""}:Math.abs(ve)<24?{text:se(ve,be),suffix:" hour"}:Math.abs(ve)<168?ne(ve/24,be," day"):Math.abs(ve)<8760?ne(ve/168,be," week"):ne(ve/8760,be," year")}function h(ve,be){return ve===null?{text:""}:Math.abs(ve)<7?{text:se(ve,be),suffix:" day"}:Math.abs(ve)<365?ne(ve/7,be," week"):ne(ve/365,be," year")}function D(ve,be,Oe){if(ve===null)return{text:""};if(ve===0)return{text:"0",suffix:" "+Oe+"s"};if(ve<0){const Re=D(-ve,be,Oe);return Re.suffix||(Re.suffix=""),Re.suffix+=" ago",Re}ve*=c[Oe]*1e3;const Me=[];let Ue=!1,we=0;be!=null&&(we=be);for(let Re=0;Re<p.length&&we>=0;Re++){const Fe=c[p[Re]]*1e3,xe=ve/Fe;if(xe>=1||Ue){Ue=!0;const Ve=Math.floor(xe),$e=p[Re]+(Ve!==1?"s":"");Me.push(Ve+" "+$e),ve=ve%Fe,we--}}return{text:Me.join(", ")}}function v(ve,be){if(ve===null)return{text:""};if(ve<1e3)return{text:(0,u.yT)(ve).format("SSS\\m\\s")};if(ve<6e4){let we="ss\\s:SSS\\m\\s";return be===0&&(we="ss\\s"),{text:(0,u.yT)(ve).format(we)}}if(ve<36e5){let we="mm\\m:ss\\s:SSS\\m\\s";return be===0?we="mm\\m":be===1&&(we="mm\\m:ss\\s"),{text:(0,u.yT)(ve).format(we)}}let Oe="mm\\m:ss\\s:SSS\\m\\s";const Me=`${("0"+Math.floor((0,u.Ah)(ve,"milliseconds").asHours())).slice(-2)}h`;return be===0?Oe="":be===1?Oe="mm\\m":be===2&&(Oe="mm\\m:ss\\s"),{text:Oe?`${Me}:${(0,u.yT)(ve).format(Oe)}`:Me}}function C(ve,be){return D(ve,be,"millisecond")}function T(ve,be){return D(ve,be,"second")}function S(ve){if(ve<0){const we=S(-ve);return we.suffix||(we.suffix=""),we.suffix+=" ago",we}const be=[],Oe=Math.floor(ve/3600),Me=Math.floor(ve%3600/60),Ue=Math.floor(ve%3600%60);return Oe>9?be.push(""+Oe):be.push("0"+Oe),Me>9?be.push(""+Me):be.push("0"+Me),Ue>9?be.push(""+Ue):be.push("0"+Ue),{text:be.join(":")}}function O(ve){if(ve<0){const Ue=O(-ve);return Ue.suffix||(Ue.suffix=""),Ue.suffix+=" ago",Ue}let be="";const Oe=Math.floor(ve/(24*3600));Oe>0&&(be=Oe+" d ");const Me=S(ve-Oe*24*3600);return{text:be+Me.text}}function x(ve,be){return a(ve/100,be)}function b(ve,be){return v(ve,be)}function M(ve,be){return v(ve*1e3,be)}function A(ve,be){return(Oe,Me,Ue,we)=>be&&(0,u.KQ)().isSame(Oe,"day")?{text:(0,l.LE)(Oe,{format:be,timeZone:we})}:{text:(0,l.LE)(Oe,{format:ve,timeZone:we})}}const R=A("YYYY-MM-DD HH:mm:ss"),B=A("YYYY-MM-DD HH:mm:ss","HH:mm:ss"),U=A("MM/DD/YYYY h:mm:ss a"),W=A("MM/DD/YYYY h:mm:ss a","h:mm:ss a");function N(){return A((0,i.Od)({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))}function w(){return A((0,i.Od)({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),(0,i.Od)({hour:"2-digit",minute:"2-digit",second:"2-digit"}))}function L(ve,be,Oe,Me,Ue){return{text:(0,l.LE)(ve,{format:Ue?i.WC.fullDateMS:i.WC.fullDate,timeZone:Me})}}function V(ve,be,Oe,Me){return{text:(0,l.fq)(ve,{timeZone:Me})}}var K=e(26517);const k=()=>[{name:"Misc",formats:[{name:"Number",id:"none",fn:ee("")},{name:"String",id:"string",fn:Te},{name:"short",id:"short",fn:ce(1e3,[""," K"," Mil"," Bil"," Tri"," Quadr"," Quint"," Sext"," Sept"])},{name:"SI short",id:"sishort",fn:(0,K.rT)("")},{name:"Percent (0-100)",id:"percent",fn:n},{name:"Percent (0.0-1.0)",id:"percentunit",fn:s},{name:"Humidity (%H)",id:"humidity",fn:ee("%H")},{name:"Decibel",id:"dB",fn:ee("dB")},{name:"Candela (cd)",id:"candela",fn:(0,K.rT)("cd")},{name:"Hexadecimal (0x)",id:"hex0x",fn:r},{name:"Hexadecimal",id:"hex",fn:o},{name:"Scientific notation",id:"sci",fn:m},{name:"Locale format",id:"locale",fn:ue},{name:"Pixels",id:"pixel",fn:ee("px")}]},{name:"Acceleration",formats:[{name:"Meters/sec\xB2",id:"accMS2",fn:ee("m/sec\xB2")},{name:"Feet/sec\xB2",id:"accFS2",fn:ee("f/sec\xB2")},{name:"G unit",id:"accG",fn:ee("g")}]},{name:"Angle",formats:[{name:"Degrees (\xB0)",id:"degree",fn:ee("\xB0")},{name:"Radians",id:"radian",fn:ee("rad")},{name:"Gradian",id:"grad",fn:ee("grad")},{name:"Arc Minutes",id:"arcmin",fn:ee("arcmin")},{name:"Arc Seconds",id:"arcsec",fn:ee("arcsec")}]},{name:"Area",formats:[{name:"Square Meters (m\xB2)",id:"areaM2",fn:ee("m\xB2")},{name:"Square Feet (ft\xB2)",id:"areaF2",fn:ee("ft\xB2")},{name:"Square Miles (mi\xB2)",id:"areaMI2",fn:ee("mi\xB2")},{name:"Acres (ac)",id:"acres",fn:ee("ac")},{name:"Hectares (ha)",id:"hectares",fn:ee("ha")}]},{name:"Computation",formats:[{name:"FLOP/s",id:"flops",fn:(0,K.rT)("FLOPS")},{name:"MFLOP/s",id:"mflops",fn:(0,K.rT)("FLOPS",2)},{name:"GFLOP/s",id:"gflops",fn:(0,K.rT)("FLOPS",3)},{name:"TFLOP/s",id:"tflops",fn:(0,K.rT)("FLOPS",4)},{name:"PFLOP/s",id:"pflops",fn:(0,K.rT)("FLOPS",5)},{name:"EFLOP/s",id:"eflops",fn:(0,K.rT)("FLOPS",6)},{name:"ZFLOP/s",id:"zflops",fn:(0,K.rT)("FLOPS",7)},{name:"YFLOP/s",id:"yflops",fn:(0,K.rT)("FLOPS",8)}]},{name:"Concentration",formats:[{name:"parts-per-million (ppm)",id:"ppm",fn:ee("ppm")},{name:"parts-per-billion (ppb)",id:"conppb",fn:ee("ppb")},{name:"nanogram per cubic meter (ng/m\xB3)",id:"conngm3",fn:ee("ng/m\xB3")},{name:"nanogram per normal cubic meter (ng/Nm\xB3)",id:"conngNm3",fn:ee("ng/Nm\xB3")},{name:"microgram per cubic meter (\u03BCg/m\xB3)",id:"con\u03BCgm3",fn:ee("\u03BCg/m\xB3")},{name:"microgram per normal cubic meter (\u03BCg/Nm\xB3)",id:"con\u03BCgNm3",fn:ee("\u03BCg/Nm\xB3")},{name:"milligram per cubic meter (mg/m\xB3)",id:"conmgm3",fn:ee("mg/m\xB3")},{name:"milligram per normal cubic meter (mg/Nm\xB3)",id:"conmgNm3",fn:ee("mg/Nm\xB3")},{name:"gram per cubic meter (g/m\xB3)",id:"congm3",fn:ee("g/m\xB3")},{name:"gram per normal cubic meter (g/Nm\xB3)",id:"congNm3",fn:ee("g/Nm\xB3")},{name:"milligrams per decilitre (mg/dL)",id:"conmgdL",fn:ee("mg/dL")},{name:"millimoles per litre (mmol/L)",id:"conmmolL",fn:ee("mmol/L")}]},{name:"Currency",formats:[{name:"Dollars ($)",id:"currencyUSD",fn:(0,K.Gl)("$")},{name:"Pounds (\xA3)",id:"currencyGBP",fn:(0,K.Gl)("\xA3")},{name:"Euro (\u20AC)",id:"currencyEUR",fn:(0,K.Gl)("\u20AC")},{name:"Yen (\xA5)",id:"currencyJPY",fn:(0,K.Gl)("\xA5")},{name:"Rubles (\u20BD)",id:"currencyRUB",fn:(0,K.Gl)("\u20BD")},{name:"Hryvnias (\u20B4)",id:"currencyUAH",fn:(0,K.Gl)("\u20B4")},{name:"Real (R$)",id:"currencyBRL",fn:(0,K.Gl)("R$")},{name:"Danish Krone (kr)",id:"currencyDKK",fn:(0,K.Gl)("kr",!0)},{name:"Icelandic Kr\xF3na (kr)",id:"currencyISK",fn:(0,K.Gl)("kr",!0)},{name:"Norwegian Krone (kr)",id:"currencyNOK",fn:(0,K.Gl)("kr",!0)},{name:"Swedish Krona (kr)",id:"currencySEK",fn:(0,K.Gl)("kr",!0)},{name:"Czech koruna (czk)",id:"currencyCZK",fn:(0,K.Gl)("czk")},{name:"Swiss franc (CHF)",id:"currencyCHF",fn:(0,K.Gl)("CHF")},{name:"Polish Z\u0142oty (PLN)",id:"currencyPLN",fn:(0,K.Gl)("PLN")},{name:"Bitcoin (\u0E3F)",id:"currencyBTC",fn:(0,K.Gl)("\u0E3F")},{name:"Milli Bitcoin (\u0E3F)",id:"currencymBTC",fn:(0,K.Gl)("mBTC")},{name:"Micro Bitcoin (\u0E3F)",id:"currency\u03BCBTC",fn:(0,K.Gl)("\u03BCBTC")},{name:"South African Rand (R)",id:"currencyZAR",fn:(0,K.Gl)("R")},{name:"Indian Rupee (\u20B9)",id:"currencyINR",fn:(0,K.Gl)("\u20B9")},{name:"South Korean Won (\u20A9)",id:"currencyKRW",fn:(0,K.Gl)("\u20A9")},{name:"Indonesian Rupiah (Rp)",id:"currencyIDR",fn:(0,K.Gl)("Rp")},{name:"Philippine Peso (PHP)",id:"currencyPHP",fn:(0,K.Gl)("PHP")},{name:"Vietnamese Dong (VND)",id:"currencyVND",fn:(0,K.Gl)("\u0111",!0)},{name:"Turkish Lira (\u20BA)",id:"currencyTRY",fn:(0,K.Gl)("\u20BA",!0)},{name:"Malaysian Ringgit (RM)",id:"currencyMYR",fn:(0,K.Gl)("RM")},{name:"CFP franc (XPF)",id:"currencyXPF",fn:(0,K.Gl)("XPF")},{name:"Bulgarian Lev (BGN)",id:"currencyBGN",fn:(0,K.Gl)("BGN")},{name:"Guaran\xED (\u20B2)",id:"currencyPYG",fn:(0,K.Gl)("\u20B2")},{name:"Uruguay Peso (UYU)",id:"currencyUYU",fn:(0,K.Gl)("UYU")}]},{name:"Data",formats:[{name:"bytes(IEC)",id:"bytes",fn:(0,K.yW)("B")},{name:"bytes(SI)",id:"decbytes",fn:(0,K.rT)("B")},{name:"bits(IEC)",id:"bits",fn:(0,K.yW)("b")},{name:"bits(SI)",id:"decbits",fn:(0,K.rT)("b")},{name:"kibibytes",id:"kbytes",fn:(0,K.yW)("B",1)},{name:"kilobytes",id:"deckbytes",fn:(0,K.rT)("B",1)},{name:"mebibytes",id:"mbytes",fn:(0,K.yW)("B",2)},{name:"megabytes",id:"decmbytes",fn:(0,K.rT)("B",2)},{name:"gibibytes",id:"gbytes",fn:(0,K.yW)("B",3)},{name:"gigabytes",id:"decgbytes",fn:(0,K.rT)("B",3)},{name:"tebibytes",id:"tbytes",fn:(0,K.yW)("B",4)},{name:"terabytes",id:"dectbytes",fn:(0,K.rT)("B",4)},{name:"pebibytes",id:"pbytes",fn:(0,K.yW)("B",5)},{name:"petabytes",id:"decpbytes",fn:(0,K.rT)("B",5)}]},{name:"Data rate",formats:[{name:"packets/sec",id:"pps",fn:(0,K.rT)("p/s")},{name:"bytes/sec(IEC)",id:"binBps",fn:(0,K.yW)("B/s")},{name:"bytes/sec(SI)",id:"Bps",fn:(0,K.rT)("B/s")},{name:"bits/sec(IEC)",id:"binbps",fn:(0,K.yW)("b/s")},{name:"bits/sec(SI)",id:"bps",fn:(0,K.rT)("b/s")},{name:"kibibytes/sec",id:"KiBs",fn:(0,K.yW)("B/s",1)},{name:"kibibits/sec",id:"Kibits",fn:(0,K.yW)("b/s",1)},{name:"kilobytes/sec",id:"KBs",fn:(0,K.rT)("B/s",1)},{name:"kilobits/sec",id:"Kbits",fn:(0,K.rT)("b/s",1)},{name:"mebibytes/sec",id:"MiBs",fn:(0,K.yW)("B/s",2)},{name:"mebibits/sec",id:"Mibits",fn:(0,K.yW)("b/s",2)},{name:"megabytes/sec",id:"MBs",fn:(0,K.rT)("B/s",2)},{name:"megabits/sec",id:"Mbits",fn:(0,K.rT)("b/s",2)},{name:"gibibytes/sec",id:"GiBs",fn:(0,K.yW)("B/s",3)},{name:"gibibits/sec",id:"Gibits",fn:(0,K.yW)("b/s",3)},{name:"gigabytes/sec",id:"GBs",fn:(0,K.rT)("B/s",3)},{name:"gigabits/sec",id:"Gbits",fn:(0,K.rT)("b/s",3)},{name:"tebibytes/sec",id:"TiBs",fn:(0,K.yW)("B/s",4)},{name:"tebibits/sec",id:"Tibits",fn:(0,K.yW)("b/s",4)},{name:"terabytes/sec",id:"TBs",fn:(0,K.rT)("B/s",4)},{name:"terabits/sec",id:"Tbits",fn:(0,K.rT)("b/s",4)},{name:"pebibytes/sec",id:"PiBs",fn:(0,K.yW)("B/s",5)},{name:"pebibits/sec",id:"Pibits",fn:(0,K.yW)("b/s",5)},{name:"petabytes/sec",id:"PBs",fn:(0,K.rT)("B/s",5)},{name:"petabits/sec",id:"Pbits",fn:(0,K.rT)("b/s",5)}]},{name:"Date & time",formats:[{name:"Datetime ISO",id:"dateTimeAsIso",fn:R},{name:"Datetime ISO (No date if today)",id:"dateTimeAsIsoNoDateIfToday",fn:B},{name:"Datetime US",id:"dateTimeAsUS",fn:U},{name:"Datetime US (No date if today)",id:"dateTimeAsUSNoDateIfToday",fn:W},{name:"Datetime local",id:"dateTimeAsLocal",fn:N()},{name:"Datetime local (No date if today)",id:"dateTimeAsLocalNoDateIfToday",fn:w()},{name:"Datetime default",id:"dateTimeAsSystem",fn:L},{name:"From Now",id:"dateTimeFromNow",fn:V}]},{name:"Energy",formats:[{name:"Watt (W)",id:"watt",fn:(0,K.rT)("W")},{name:"Kilowatt (kW)",id:"kwatt",fn:(0,K.rT)("W",1)},{name:"Megawatt (MW)",id:"megwatt",fn:(0,K.rT)("W",2)},{name:"Gigawatt (GW)",id:"gwatt",fn:(0,K.rT)("W",3)},{name:"Milliwatt (mW)",id:"mwatt",fn:(0,K.rT)("W",-1)},{name:"Watt per square meter (W/m\xB2)",id:"Wm2",fn:ee("W/m\xB2")},{name:"Volt-Ampere (VA)",id:"voltamp",fn:(0,K.rT)("VA")},{name:"Kilovolt-Ampere (kVA)",id:"kvoltamp",fn:(0,K.rT)("VA",1)},{name:"Volt-Ampere reactive (VAr)",id:"voltampreact",fn:(0,K.rT)("VAr")},{name:"Kilovolt-Ampere reactive (kVAr)",id:"kvoltampreact",fn:(0,K.rT)("VAr",1)},{name:"Watt-hour (Wh)",id:"watth",fn:(0,K.rT)("Wh")},{name:"Watt-hour per Kilogram (Wh/kg)",id:"watthperkg",fn:(0,K.rT)("Wh/kg")},{name:"Kilowatt-hour (kWh)",id:"kwatth",fn:(0,K.rT)("Wh",1)},{name:"Kilowatt-min (kWm)",id:"kwattm",fn:(0,K.rT)("W-Min",1)},{name:"Megawatt-hour (MWh)",id:"mwatth",fn:(0,K.rT)("Wh",2)},{name:"Ampere-hour (Ah)",id:"amph",fn:(0,K.rT)("Ah")},{name:"Kiloampere-hour (kAh)",id:"kamph",fn:(0,K.rT)("Ah",1)},{name:"Milliampere-hour (mAh)",id:"mamph",fn:(0,K.rT)("Ah",-1)},{name:"Joule (J)",id:"joule",fn:(0,K.rT)("J")},{name:"Electron volt (eV)",id:"ev",fn:(0,K.rT)("eV")},{name:"Ampere (A)",id:"amp",fn:(0,K.rT)("A")},{name:"Kiloampere (kA)",id:"kamp",fn:(0,K.rT)("A",1)},{name:"Milliampere (mA)",id:"mamp",fn:(0,K.rT)("A",-1)},{name:"Volt (V)",id:"volt",fn:(0,K.rT)("V")},{name:"Kilovolt (kV)",id:"kvolt",fn:(0,K.rT)("V",1)},{name:"Millivolt (mV)",id:"mvolt",fn:(0,K.rT)("V",-1)},{name:"Decibel-milliwatt (dBm)",id:"dBm",fn:(0,K.rT)("dBm")},{name:"Milliohm (m\u03A9)",id:"mohm",fn:(0,K.rT)("\u03A9",-1)},{name:"Ohm (\u03A9)",id:"ohm",fn:(0,K.rT)("\u03A9")},{name:"Kiloohm (k\u03A9)",id:"kohm",fn:(0,K.rT)("\u03A9",1)},{name:"Megaohm (M\u03A9)",id:"Mohm",fn:(0,K.rT)("\u03A9",2)},{name:"Farad (F)",id:"farad",fn:(0,K.rT)("F")},{name:"Microfarad (\xB5F)",id:"\xB5farad",fn:(0,K.rT)("F",-2)},{name:"Nanofarad (nF)",id:"nfarad",fn:(0,K.rT)("F",-3)},{name:"Picofarad (pF)",id:"pfarad",fn:(0,K.rT)("F",-4)},{name:"Femtofarad (fF)",id:"ffarad",fn:(0,K.rT)("F",-5)},{name:"Henry (H)",id:"henry",fn:(0,K.rT)("H")},{name:"Millihenry (mH)",id:"mhenry",fn:(0,K.rT)("H",-1)},{name:"Microhenry (\xB5H)",id:"\xB5henry",fn:(0,K.rT)("H",-2)},{name:"Lumens (Lm)",id:"lumens",fn:(0,K.rT)("Lm")}]},{name:"Flow",formats:[{name:"Gallons/min (gpm)",id:"flowgpm",fn:ee("gpm")},{name:"Cubic meters/sec (cms)",id:"flowcms",fn:ee("cms")},{name:"Cubic feet/sec (cfs)",id:"flowcfs",fn:ee("cfs")},{name:"Cubic feet/min (cfm)",id:"flowcfm",fn:ee("cfm")},{name:"Litre/hour",id:"litreh",fn:ee("L/h")},{name:"Litre/min (L/min)",id:"flowlpm",fn:ee("L/min")},{name:"milliLitre/min (mL/min)",id:"flowmlpm",fn:ee("mL/min")},{name:"Lux (lx)",id:"lux",fn:ee("lux")}]},{name:"Force",formats:[{name:"Newton-meters (Nm)",id:"forceNm",fn:(0,K.rT)("Nm")},{name:"Kilonewton-meters (kNm)",id:"forcekNm",fn:(0,K.rT)("Nm",1)},{name:"Newtons (N)",id:"forceN",fn:(0,K.rT)("N")},{name:"Kilonewtons (kN)",id:"forcekN",fn:(0,K.rT)("N",1)}]},{name:"Hash rate",formats:[{name:"hashes/sec",id:"Hs",fn:(0,K.rT)("H/s")},{name:"kilohashes/sec",id:"KHs",fn:(0,K.rT)("H/s",1)},{name:"megahashes/sec",id:"MHs",fn:(0,K.rT)("H/s",2)},{name:"gigahashes/sec",id:"GHs",fn:(0,K.rT)("H/s",3)},{name:"terahashes/sec",id:"THs",fn:(0,K.rT)("H/s",4)},{name:"petahashes/sec",id:"PHs",fn:(0,K.rT)("H/s",5)},{name:"exahashes/sec",id:"EHs",fn:(0,K.rT)("H/s",6)}]},{name:"Mass",formats:[{name:"milligram (mg)",id:"massmg",fn:(0,K.rT)("g",-1)},{name:"gram (g)",id:"massg",fn:(0,K.rT)("g")},{name:"pound (lb)",id:"masslb",fn:ee("lb")},{name:"kilogram (kg)",id:"masskg",fn:(0,K.rT)("g",1)},{name:"metric ton (t)",id:"masst",fn:ee("t")}]},{name:"Length",formats:[{name:"millimeter (mm)",id:"lengthmm",fn:(0,K.rT)("m",-1)},{name:"inch (in)",id:"lengthin",fn:ee("in")},{name:"feet (ft)",id:"lengthft",fn:ee("ft")},{name:"meter (m)",id:"lengthm",fn:(0,K.rT)("m")},{name:"kilometer (km)",id:"lengthkm",fn:(0,K.rT)("m",1)},{name:"mile (mi)",id:"lengthmi",fn:ee("mi")}]},{name:"Pressure",formats:[{name:"Millibars",id:"pressurembar",fn:(0,K.rT)("bar",-1)},{name:"Bars",id:"pressurebar",fn:(0,K.rT)("bar")},{name:"Kilobars",id:"pressurekbar",fn:(0,K.rT)("bar",1)},{name:"Pascals",id:"pressurepa",fn:(0,K.rT)("Pa")},{name:"Hectopascals",id:"pressurehpa",fn:ee("hPa")},{name:"Kilopascals",id:"pressurekpa",fn:ee("kPa")},{name:"Inches of mercury",id:"pressurehg",fn:ee('"Hg')},{name:"PSI",id:"pressurepsi",fn:ce(1e3,["psi","ksi","Mpsi"])}]},{name:"Radiation",formats:[{name:"Becquerel (Bq)",id:"radbq",fn:(0,K.rT)("Bq")},{name:"curie (Ci)",id:"radci",fn:(0,K.rT)("Ci")},{name:"Gray (Gy)",id:"radgy",fn:(0,K.rT)("Gy")},{name:"rad",id:"radrad",fn:(0,K.rT)("rad")},{name:"Sievert (Sv)",id:"radsv",fn:(0,K.rT)("Sv")},{name:"milliSievert (mSv)",id:"radmsv",fn:(0,K.rT)("Sv",-1)},{name:"microSievert (\xB5Sv)",id:"radusv",fn:(0,K.rT)("Sv",-2)},{name:"rem",id:"radrem",fn:(0,K.rT)("rem")},{name:"Exposure (C/kg)",id:"radexpckg",fn:(0,K.rT)("C/kg")},{name:"roentgen (R)",id:"radr",fn:(0,K.rT)("R")},{name:"Sievert/hour (Sv/h)",id:"radsvh",fn:(0,K.rT)("Sv/h")},{name:"milliSievert/hour (mSv/h)",id:"radmsvh",fn:(0,K.rT)("Sv/h",-1)},{name:"microSievert/hour (\xB5Sv/h)",id:"radusvh",fn:(0,K.rT)("Sv/h",-2)}]},{name:"Rotational Speed",formats:[{name:"Revolutions per minute (rpm)",id:"rotrpm",fn:ee("rpm")},{name:"Hertz (Hz)",id:"rothz",fn:(0,K.rT)("Hz")},{name:"Kilohertz (kHz)",id:"rotkhz",fn:(0,K.rT)("Hz",1)},{name:"Megahertz (MHz)",id:"rotmhz",fn:(0,K.rT)("Hz",2)},{name:"Gigahertz (GHz)",id:"rotghz",fn:(0,K.rT)("Hz",3)},{name:"Radians per second (rad/s)",id:"rotrads",fn:ee("rad/s")},{name:"Degrees per second (\xB0/s)",id:"rotdegs",fn:ee("\xB0/s")}]},{name:"Temperature",formats:[{name:"Celsius (\xB0C)",id:"celsius",fn:ee("\xB0C")},{name:"Fahrenheit (\xB0F)",id:"fahrenheit",fn:ee("\xB0F")},{name:"Kelvin (K)",id:"kelvin",fn:ee("K")}]},{name:"Time",formats:[{name:"Hertz (1/s)",id:"hertz",fn:(0,K.rT)("Hz")},{name:"nanoseconds (ns)",id:"ns",fn:y},{name:"microseconds (\xB5s)",id:"\xB5s",fn:f},{name:"milliseconds (ms)",id:"ms",fn:P},{name:"seconds (s)",id:"s",fn:a},{name:"minutes (m)",id:"m",fn:E},{name:"hours (h)",id:"h",fn:g},{name:"days (d)",id:"d",fn:h},{name:"duration (ms)",id:"dtdurationms",fn:C},{name:"duration (s)",id:"dtdurations",fn:T},{name:"duration (hh:mm:ss)",id:"dthms",fn:S},{name:"duration (d hh:mm:ss)",id:"dtdhms",fn:O},{name:"Timeticks (s/100)",id:"timeticks",fn:x},{name:"clock (ms)",id:"clockms",fn:b},{name:"clock (s)",id:"clocks",fn:M}]},{name:"Throughput",formats:[{name:"counts/sec (cps)",id:"cps",fn:fe("c/s")},{name:"ops/sec (ops)",id:"ops",fn:fe("ops/s")},{name:"requests/sec (rps)",id:"reqps",fn:fe("req/s")},{name:"reads/sec (rps)",id:"rps",fn:fe("rd/s")},{name:"writes/sec (wps)",id:"wps",fn:fe("wr/s")},{name:"I/O ops/sec (iops)",id:"iops",fn:fe("io/s")},{name:"events/sec (eps)",id:"eps",fn:fe("evt/s")},{name:"messages/sec (mps)",id:"mps",fn:fe("msg/s")},{name:"records/sec (rps)",id:"recps",fn:fe("rec/s")},{name:"rows/sec (rps)",id:"rowsps",fn:fe("rows/s")},{name:"counts/min (cpm)",id:"cpm",fn:fe("c/m")},{name:"ops/min (opm)",id:"opm",fn:fe("ops/m")},{name:"requests/min (rpm)",id:"reqpm",fn:fe("req/m")},{name:"reads/min (rpm)",id:"rpm",fn:fe("rd/m")},{name:"writes/min (wpm)",id:"wpm",fn:fe("wr/m")},{name:"events/min (epm)",id:"epm",fn:fe("evts/m")},{name:"messages/min (mpm)",id:"mpm",fn:fe("msgs/m")},{name:"records/min (rpm)",id:"recpm",fn:fe("rec/m")},{name:"rows/min (rpm)",id:"rowspm",fn:fe("rows/m")}]},{name:"Velocity",formats:[{name:"meters/second (m/s)",id:"velocityms",fn:ee("m/s")},{name:"kilometers/hour (km/h)",id:"velocitykmh",fn:ee("km/h")},{name:"miles/hour (mph)",id:"velocitymph",fn:ee("mph")},{name:"knot (kn)",id:"velocityknot",fn:ee("kn")}]},{name:"Volume",formats:[{name:"millilitre (mL)",id:"mlitre",fn:(0,K.rT)("L",-1)},{name:"litre (L)",id:"litre",fn:(0,K.rT)("L")},{name:"cubic meter",id:"m3",fn:ee("m\xB3")},{name:"Normal cubic meter",id:"Nm3",fn:ee("Nm\xB3")},{name:"cubic decimeter",id:"dm3",fn:ee("dm\xB3")},{name:"gallons",id:"gallons",fn:ee("gal")}]},{name:"Boolean",formats:[{name:"True / False",id:"bool",fn:te("True","False")},{name:"Yes / No",id:"bool_yes_no",fn:te("Yes","No")},{name:"On / Off",id:"bool_on_off",fn:te("On","Off")}]}];function j(ve){return`${ve.prefix??""}${ve.text}${ve.suffix??""}`}let H=[];const J={};let X=!1;function se(ve,be){if(ve===null)return"";if(ve===Number.NEGATIVE_INFINITY||ve===Number.POSITIVE_INFINITY)return ve.toLocaleString();if(be==null&&(be=ae(ve)),ve===0)return ve.toFixed(be);const Oe=be?Math.pow(10,Math.max(0,be)):1,Me=String(Math.round(ve*Oe)/Oe);if(Me.indexOf("e")!==-1||ve===0)return Me;const Ue=Me.indexOf("."),we=Ue===-1?0:Me.length-Ue-1;return we<be?(we?Me:Me+".")+String(Oe).slice(1,be-we+1):Me}function ae(ve){const be=Math.abs(ve);let Me=-Math.floor(Math.log(be)/Math.LN10)+1;const Ue=Math.pow(10,-Me);return be/Ue>2.25&&++Me,ve%1===0&&(Me=0),Math.max(0,Me)}function ne(ve,be,Oe){return{text:se(ve,be),suffix:q(Oe,Math.abs(ve)>1)}}function q(ve,be){if(!be)return ve;switch(ve){case" min":case" hour":case" day":case" week":case" year":return`${ve}s`;default:return ve}}function ee(ve,be){return(Oe,Me)=>{if(Oe===null)return{text:""};const Ue=se(Oe,Me);return ve?be?{text:Ue,prefix:ve}:{text:Ue,suffix:" "+ve}:{text:Ue}}}function z(ve){return ve&&ve.startsWith("bool")}function te(ve,be){return Oe=>({text:Oe?ve:be})}const ie=(ve,be)=>Math.log10(be)/Math.log10(ve);function ce(ve,be,Oe=0){return(Me,Ue)=>{if(Me==null)return{text:""};if(Me===Number.NEGATIVE_INFINITY||Me===Number.POSITIVE_INFINITY||isNaN(Me))return{text:Me.toLocaleString()};const we=Me===0?0:Math.floor(ie(ve,Math.abs(Me))),Re=be[(0,t.clamp)(Oe+we,0,be.length-1)];return{text:se(Me/ve**(0,t.clamp)(we,-Oe,be.length-Oe-1),Ue),suffix:Re}}}function ue(ve,be){return ve==null?{text:""}:{text:ve.toLocaleString(void 0,{maximumFractionDigits:be??void 0})}}function fe(ve){const Oe=ce(1e3,["","K","M","B","T"]);return(Me,Ue,we)=>{if(Me===null)return{text:""};const Re=Oe(Me,Ue,we);return Re.suffix+=" "+ve,Re}}function Te(ve){return{text:`${ve}`}}function he(){H=k();for(const ve of H)for(const be of ve.formats)J[be.id]=be.fn;[{from:"farenheit",to:"fahrenheit"}].forEach(ve=>{const be=J[ve.to];be&&(J[ve.from]=be)}),X=!0}function de(ve){if(!ve)return ee("");X||he();const be=J[ve];if(!be&&ve){let Oe=ve.indexOf(":");if(Oe>0){const Me=ve.substring(0,Oe),Ue=ve.substring(Oe+1);if(Me==="prefix")return ee(Ue,!0);if(Me==="suffix")return ee(Ue,!1);if(Me==="time")return A(Ue);if(Me==="si"){const we=(0,K.cL)(Ue.charAt(0)),Re=we===0?Ue:Ue.substring(1);return(0,K.rT)(Re,we)}if(Me==="count")return fe(Ue);if(Me==="currency")return(0,K.Gl)(Ue);if(Me==="bool"){if(Oe=Ue.indexOf("/"),Oe>=0){const we=Ue.substring(0,Oe),Re=Ue.substring(Oe+1);return te(we,Re)}return te(Ue,"-")}}return ee(ve)}return be}function le(){return X||he(),J}function pe(){return X||he(),H.map(ve=>({text:ve.name,submenu:ve.formats.map(be=>({text:be.name,value:be.id}))}))}},79178:(G,I,e)=>{"use strict";e.d(I,{L:()=>s});const t="ArrayVector is deprecated and will be removed in Grafana 11. Please use plain arrays for field.values.";let n=!1;class s extends Array{get buffer(){return this}set buffer(o){this.length=0;const m=o?.length;if(m){let l=65e3,i=Math.ceil(m/l);for(let u=0;u<i;u++)this.push.apply(this,o.slice(u*l,(u+1)*l))}}constructor(o){super(),this.buffer=o??[],n||(console.warn(t),n=!0)}toJSON(){return[...this]}}},36120:(G,I,e)=>{"use strict";e.d(I,{$:()=>n});var t=e(18008);class n extends t.F{constructor(r){return super(),this.buffer=r.buffer||[],this.capacity=this.buffer.length,this.tail=r.append!=="head",this.index=0,this.add=this.getAddFunction(),r.capacity&&this.setCapacity(r.capacity),new Proxy(this,{get(o,m,l){if(typeof m!="symbol"){const i=+m;if(String(i)===m)return o.get(i)}return Reflect.get(o,m,l)},set(o,m,l,i){if(typeof m!="symbol"){const u=+m;if(String(u)===m)return o.set(u,l),!0}return Reflect.set(o,m,l,i)}})}getAddFunction(){return this.capacity>this.buffer.length?this.tail?r=>{this.buffer.push(r),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:r=>{this.buffer.unshift(r),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:this.tail?r=>{this.buffer[this.index]=r,this.index=(this.index+1)%this.buffer.length}:r=>{let o=this.index-1;o<0&&(o=this.buffer.length-1),this.buffer[o]=r,this.index=o}}setCapacity(r){if(this.capacity===r)return;const o=this.toArray();if(r>this.length)this.buffer=o;else if(r<this.capacity){const m=this.length-r;this.tail?this.buffer=o.slice(m,o.length):this.buffer=o.slice(0,o.length-m)}this.capacity=r,this.index=0,this.add=this.getAddFunction()}setAppendMode(r){const o=r!=="head";o!==this.tail&&(this.buffer=this.toArray().reverse(),this.index=0,this.tail=o,this.add=this.getAddFunction())}reverse(){return this.buffer.reverse()}get(r){return this.buffer[(r+this.index)%this.buffer.length]}set(r,o){this.buffer[(r+this.index)%this.buffer.length]=o}get length(){return this.buffer.length}}},18008:(G,I,e)=>{"use strict";e.d(I,{E:()=>r,F:()=>n});var t;class n{constructor(){this[t]={}}static{t=Symbol.unscopables}*iterator(){for(let m=0;m<this.length;m++)yield this.get(m)}set(m,l){throw"unsupported operation"}add(m){throw"unsupported operation"}push(...m){for(const l of m)this.add(l);return this.length}[Symbol.iterator](){return this.iterator()}forEach(m){return r(this).forEach(m)}map(m){return r(this).map(m)}filter(m){return r(this).filter(m)}at(m){return this.get(m)}toArray(){const m=new Array(this.length);for(let l=0;l<this.length;l++)m[l]=this.get(l);return m}join(m){return this.toArray().join(m)}toJSON(){return this.toArray()}pop(){throw new Error("Method not implemented.")}concat(...m){throw new Error("Method not implemented.")}reverse(){throw new Error("Method not implemented.")}shift(){throw new Error("Method not implemented.")}sort(m){throw new Error("Method not implemented.")}splice(m,l,...i){throw new Error("Method not implemented.")}unshift(...m){throw new Error("Method not implemented.")}fill(m,l,i){throw new Error("Method not implemented.")}copyWithin(m,l,i){throw new Error("Method not implemented.")}slice(m,l){return this.toArray().slice(m,l)}indexOf(m,l){return this.toArray().indexOf(m,l)}lastIndexOf(m,l){return this.toArray().lastIndexOf(m,l)}every(m,l){return this.toArray().every(m,l)}some(m,l){return this.toArray().some(m,l)}reduce(m,l){throw new Error("Method not implemented.")}reduceRight(m,l){throw new Error("Method not implemented.")}find(m,l){return this.toArray().find(m,l)}findIndex(m,l){return this.toArray().findIndex(m,l)}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.toArray().values()}includes(m,l){return this.toArray().includes(m,l)}flatMap(m,l){return this.toArray().flatMap(m,l)}flat(m){throw new Error("Method not implemented.")}}const s=[];function r(o){return{*[Symbol.iterator](){for(let m=0;m<o.length;m++)yield o.get(m)},forEach(m){for(let l=0;l<o.length;l++)m(o.get(l),l,s)},map(m){const l=[];for(let i=0;i<o.length;i++)l.push(m(o.get(i),i,s));return l},filter(m){const l=[];let i=0;for(const u of this)m(u,i++,s)&&l.push(u);return l}}}},13390:(G,I,e)=>{"use strict";e.d(I,{X:()=>t});const t={RadioButton:{container:"data-testid radio-button"},Breadcrumbs:{breadcrumb:n=>`data-testid ${n} breadcrumb`},TimePicker:{openButton:"data-testid TimePicker Open Button",overlayContent:"data-testid TimePicker Overlay Content",fromField:"data-testid Time Range from field",toField:"data-testid Time Range to field",applyTimeRange:"data-testid TimePicker submit button",copyTimeRange:"data-testid TimePicker copy button",pasteTimeRange:"data-testid TimePicker paste button",calendar:{label:"data-testid Time Range calendar",openButton:"data-testid Open time range calendar",closeButton:"data-testid Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSourcePermissions:{form:()=>'form[name="addPermission"]',roleType:"Role to add new permission to",rolePicker:"Built-in role picker",permissionLevel:"Permission Level"},DateTimePicker:{input:"data-testid date-time-input"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"data-testid Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{connectionSettings:"Data source connection URL",manageAlerts:"prometheus-alerts-manager",scrapeInterval:"data-testid scrape interval",queryTimeout:"data-testid query timeout",defaultEditor:"data-testid default editor",disableMetricLookup:"disable-metric-lookup",prometheusType:"data-testid prometheus type",prometheusVersion:"data-testid prometheus version",cacheLevel:"data-testid cache level",incrementalQuerying:"prometheus-incremental-querying",queryOverlapWindow:"data-testid query overlap window",disableRecordingRules:"disable-recording-rules",customQueryParameters:"data-testid custom query parameters",httpMethod:"data-testid http method",exemplarsAddButton:"data-testid Add exemplar config button",internalLinkSwitch:"data-testid Internal link switch",codeModeMetricNamesSuggestionLimit:"data-testid code mode metric names suggestion limit"},queryEditor:{explain:"data-testid prometheus explain switch wrapper",editorToggle:"data-testid QueryEditorModeToggle",options:"data-testid prometheus options",legend:"data-testid prometheus legend wrapper",format:"data-testid prometheus format",step:"prometheus-step",type:"data-testid prometheus type",exemplars:"prometheus-exemplars",builder:{metricSelect:"data-testid metric select",hints:"data-testid prometheus hints",metricsExplorer:"data-testid metrics explorer",queryAdvisor:"data-testid query advisor"},code:{queryField:"data-testid prometheus query field",metricsCountInfo:"data-testid metrics count disclaimer",metricsBrowser:{openButton:"data-testid open metrics browser",selectMetric:"data-testid select a metric",metricList:"data-testid metric list",labelNamesFilter:"data-testid label names filter",labelValuesFilter:"data-testid label values filter",useQuery:"data-testid use query",useAsRateQuery:"data-testid use as rate query",validateSelector:"data-testid validate selector",clear:"data-testid clear"}}},exemplarMarker:"data-testid Exemplar marker",variableQueryEditor:{queryType:"data-testid query type",labelnames:{metricRegex:"data-testid label names metric regex"},labelValues:{labelSelect:"data-testid label values label select"},metricNames:{metricRegex:"data-testid metric names metric regex"},varQueryResult:"data-testid variable query result",seriesQuery:"data-testid prometheus series query",classicQuery:"data-testid prometheus classic query"},annotations:{minStep:"prometheus-annotation-min-step",title:"data-testid prometheus annotation title",tags:"data-testid prometheus annotation tags",text:"data-testid prometheus annotation text",seriesValueAsTimestamp:"data-testid prometheus annotation series value as timestamp"}}},Menu:{MenuComponent:n=>`${n} menu`,MenuGroup:n=>`${n} menu group`,MenuItem:n=>`${n} menu item`,SubMenu:{container:"data-testid SubMenu container",icon:"data-testid SubMenu icon"}},Panels:{Panel:{title:n=>`data-testid Panel header ${n}`,content:"data-testid panel content",headerItems:n=>`data-testid Panel header item ${n}`,menuItems:n=>`data-testid Panel menu item ${n}`,menu:n=>`data-testid Panel menu ${n}`,containerByTitle:n=>`${n} panel`,headerCornerInfo:n=>`Panel header ${n}`,status:n=>`data-testid Panel status ${n}`,loadingBar:()=>"Panel loading bar",HoverWidget:{container:"data-testid hover-header-container",dragIcon:"data-testid drag-icon"},PanelDataErrorMessage:"data-testid Panel data error message"},Visualization:{Graph:{container:"Graph container",VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:n=>`gpl alias ${n}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"data testid Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer",body:"data-testid table body"}}},VizLegend:{seriesName:n=>`data-testid VizLegend series ${n}`},Drawer:{General:{title:n=>`Drawer title ${n}`,expand:"Drawer expand",contract:"Drawer contract",close:"data-testid Drawer close",rcContentWrapper:()=>".rc-drawer-content-wrapper",subtitle:"data-testid drawer subtitle"},DashboardSaveDrawer:{saveButton:"data-testid Save dashboard drawer button",saveAsButton:"data-testid Save as dashboard drawer button",saveAsTitleInput:"Save dashboard title field"}},PanelEditor:{General:{content:"data-testid Panel editor content"},OptionsPane:{content:"data-testid Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:n=>`${n} field property editor`,fieldInput:n=>`data-testid Panel editor option pane field input ${n}`},DataPane:{content:"data-testid Panel editor data pane content"},applyButton:"data-testid Apply changes and go back to dashboard",toggleVizPicker:"data-testid toggle-viz-picker",toggleVizOptions:"data-testid toggle-viz-options",toggleTableView:"data-testid toggle-table-view",showZoomField:"Map controls Show zoom control field property editor",showAttributionField:"Map controls Show attribution field property editor",showScaleField:"Map controls Show scale field property editor",showMeasureField:"Map controls Show measure tools field property editor",showDebugField:"Map controls Show debug field property editor",measureButton:"show measure tools"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"data-testid Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:n=>`Tab ${n}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"data-testid query-history-button",addQuery:"data-testid query-tab-add-query",queryGroupTopSection:"data-testid query group top section",addExpression:"data-testid query-tab-add-expression"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:n=>`data-testid ${n}`,title:n=>`Query editor row title ${n}`,container:n=>`Query editor row ${n}`},AlertTab:{content:"data-testid Alert editor tab content"},AlertRules:{groupToggle:"data-testid group-collapse-toggle",toggle:"data-testid collapse-toggle",expandedContent:"data-testid expanded-content",previewButton:"data-testid alert-rule preview-button",ruleNameField:"data-testid alert-rule name-field",newFolderButton:"data-testid alert-rule new-folder-button",newFolderNameField:"data-testid alert-rule name-folder-name-field",newFolderNameCreateButton:"data-testid alert-rule name-folder-name-create-button",newEvaluationGroupButton:"data-testid alert-rule new-evaluation-group-button",newEvaluationGroupName:"data-testid alert-rule new-evaluation-group-name",newEvaluationGroupInterval:"data-testid alert-rule new-evaluation-group-interval",newEvaluationGroupCreate:"data-testid alert-rule new-evaluation-group-create-button"},Alert:{alert:n=>`Alert ${n}`,alertV2:n=>`data-testid Alert ${n}`},TransformTab:{content:"data-testid Transform editor tab content",newTransform:n=>`data-testid New transform ${n}`,transformationEditor:n=>`data-testid Transformation editor ${n}`,transformationEditorDebugger:n=>`data-testid Transformation editor debugger ${n}`},Transforms:{card:n=>`data-testid New transform ${n}`,disableTransformationButton:"data-testid Disable transformation button",Reduce:{modeLabel:"data-testid Transform mode label",calculationsLabel:"data-testid Transform calculations label"},SpatialOperations:{actionLabel:"root Action field property editor",locationLabel:"root Location Mode field property editor",location:{autoOption:"Auto location option",coords:{option:"Coords location option",latitudeFieldLabel:"root Latitude field field property editor",longitudeFieldLabel:"root Longitude field field property editor"},geohash:{option:"Geohash location option",geohashFieldLabel:"root Geohash field field property editor"},lookup:{option:"Lookup location option",lookupFieldLabel:"root Lookup field field property editor",gazetteerFieldLabel:"root Gazetteer field property editor"}}},searchInput:"data-testid search transformations",noTransformationsMessage:"data-testid no transformations message",addTransformationButton:"data-testid add transformation button",removeAllTransformationsButton:"data-testid remove all transformations button"},NavBar:{Configuration:{button:"Configuration"},Toggle:{button:"data-testid Toggle menu"},Reporting:{button:"Reporting"}},NavMenu:{Menu:"data-testid navigation mega-menu",item:"data-testid Nav menu item"},NavToolbar:{container:"data-testid Nav toolbar",shareDashboard:"data-testid Share dashboard",markAsFavorite:"data-testid Mark as favorite",editDashboard:{editButton:"data-testid Edit dashboard button",saveButton:"data-testid Save dashboard button",exitButton:"data-testid Exit edit mode button",settingsButton:"data-testid Dashboard settings",addRowButton:"data-testid Add row button",addLibraryPanelButton:"data-testid Add a panel from the panel library button",addVisualizationButton:"data-testid Add new visualization menu item",pastePanelButton:"data-testid Paste panel button",discardChangesButton:"data-testid Discard changes button",discardLibraryPanelButton:"data-testid Discard library panel button",unlinkLibraryPanelButton:"data-testid Unlink library panel button",saveLibraryPanelButton:"data-testid Save library panel button",backToDashboardButton:"data-testid Back to dashboard button"}},PageToolbar:{container:()=>".page-toolbar",item:n=>`${n}`,itemButton:n=>`data-testid ${n}`},QueryEditorToolbarItem:{button:n=>`QueryEditor toolbar item button ${n}`},BackButton:{backArrow:"data-testid Go Back"},OptionsGroup:{group:n=>n?`data-testid Options group ${n}`:"data-testid Options group",toggle:n=>n?`data-testid Options group ${n} toggle`:"data-testid Options group toggle"},PluginVisualization:{item:n=>`Plugin visualization item ${n}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"data-testid Select option",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"data-testid folder-picker-input"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"data-testid Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"data-testid Select a data source",dataSourceList:"data-testid Data source list dropdown",advancedModal:{dataSourceList:"data-testid Data source list",builtInDataSourceList:"data-testid Built in data source list"}},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container",changeTimeSettingsButton:"data-testid Time zone picker Change time settings button"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"data-testid Query field"},QueryBuilder:{queryPatterns:"data-testid Query patterns",labelSelect:"data-testid Select label",inputSelect:"data-testid Select label-input",valueSelect:"data-testid Select value",matchOperatorSelect:"data-testid Select match operator"},ValuePicker:{button:n=>`data-testid Value picker button ${n}`,select:n=>`data-testid Value picker select ${n}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:n=>`data-testid Collapse folder ${n}`,expandFolder:n=>`data-testid Expand folder ${n}`,dashboardItem:n=>`${t.Search.dashboardItems} ${n}`,dashboardCard:n=>`data-testid Search card ${n}`,folderHeader:n=>`data-testid Folder header ${n}`,folderContent:n=>`data-testid Folder content ${n}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"data-testid Loading indicator"},CallToActionCard:{button:n=>`Call to action button ${n}`,buttonV2:n=>`data-testid Call to action button ${n}`},DataLinksContextMenu:{singleLink:"data-testid Data link"},CodeEditor:{container:"data-testid Code editor container"},ReactMonacoEditor:{editorLazy:"data-testid ReactMonacoEditor editorLazy"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"data-testid Unified alert editor tab content"},VisualizationPreview:{card:n=>`data-testid suggestion-${n}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:n=>`data-testid dashboard-row-title-${n}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table",extensionPointTabs:"data-testid-extension-point-tabs",extensionPointTab:n=>`data-testid-extension-point-tab-${n}`},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"},DebugOverlay:{wrapper:"debug-overlay"},OrgRolePicker:{input:"Role"},AnalyticsToolbarButton:{button:"Dashboard insights"},Variables:{variableOption:"data-testid variable-option"},Annotations:{annotationsTypeInput:"data-testid annotations-type-input",annotationsChoosePanelInput:"data-testid choose-panels-input",editor:{testButton:"data-testid annotations-test-button",resultContainer:"data-testid annotations-query-result-container"}},Tooltip:{container:"data-testid tooltip"},ReturnToPrevious:{buttonGroup:"data-testid dismissable button group",backButton:"data-testid back",dismissButton:"data-testid dismiss"},SQLQueryEditor:{selectColumn:"data-testid select-column",selectAggregation:"data-testid select-aggregation",selectAlias:"data-testid select-alias",filterConjunction:"data-testid filter-conjunction",filterField:"data-testid filter-field",filterOperator:"data-testid filter-operator",headerTableSelector:"data-testid header-table-selector",headerFilterSwitch:"data-testid header-filter-switch",headerGroupSwitch:"data-testid header-group-switch",headerOrderSwitch:"data-testid header-order-switch",headerPreviewSwitch:"data-testid header-preview-switch"}}},13544:(G,I,e)=>{"use strict";e.d(I,{Tp:()=>s});var t=e(13390);const s={pages:{Login:{url:"/login",username:"data-testid Username input field",password:"data-testid Password input field",submit:"data-testid Login button",skip:"data-testid Skip change password button"},Home:{url:"/"},DataSource:{name:"data-testid Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"data-testid Data source settings page read only message",saveAndTest:"data-testid Data source settings page Save and Test button",alert:"data-testid Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:r=>`Data source list item ${r}`},EditDataSource:{url:r=>`/datasources/edit/${r}`,settings:"Datasource settings page basic settings"},AddDataSource:{url:"/datasources/new",dataSourcePlugins:r=>`Data source plugin item ${r}`,dataSourcePluginsV2:r=>`Add new data source ${r}`},ConfirmModal:{delete:"data-testid Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",itemButton:r=>`data-testid ${r}`,addNewPanel:"data-testid Add new panel",addNewRow:"data-testid Add new row",addNewPanelLibrary:"data-testid Add new panel from panel library"},Dashboard:{url:r=>`/d/${r}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag",shareButton:"data-testid share-button",scrollContainer:"data-testid Dashboard canvas scroll container",newShareButton:{container:"data-testid new share button",shareLink:"data-testid new share link-button",arrowMenu:"data-testid new share button arrow menu",menu:{container:"data-testid new share button menu",shareInternally:"data-testid new share button share internally"}},playlistControls:{prev:"data-testid playlist previous dashboard button",stop:"data-testid playlist stop dashboard button",next:"data-testid playlist next dashboard button"}},Controls:"data-testid dashboard controls",SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:r=>`data-testid Dashboard template variables submenu Label ${r}`,submenuItemValueDropDownValueLinkTexts:r=>`data-testid Dashboard template variables Variable Value DropDown value link text ${r}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:r=>`data-testid Dashboard template variables Variable Value DropDown option text ${r}`,Annotations:{annotationsWrapper:"data-testid annotation-wrapper",annotationLabel:r=>`data-testid Dashboard annotations submenu Label ${r}`,annotationToggle:r=>`data-testid Dashboard annotations submenu Toggle ${r}`}},Settings:{Actions:{close:"data-testid dashboard-settings-close"},General:{deleteDashBoard:"data-testid Dashboard settings page delete dashboard button",sectionItems:r=>`Dashboard settings section item ${r}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"Tab General"},Annotations:{List:{addAnnotationCTA:t.X.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:t.X.CallToActionCard.buttonV2("Add annotation query"),annotations:"data-testid list-annotations"},Settings:{name:"data-testid Annotations settings name input"},NewAnnotation:{panelFilterSelect:"data-testid annotations-panel-filter",showInLabel:"data-testid show-in-label",previewInDashboard:"data-testid annotations-preview",delete:"data-testid annotations-delete",apply:"data-testid annotations-apply",enable:"data-testid annotation-enable",hide:"data-testid annotation-hide"}},Variables:{List:{addVariableCTA:t.X.CallToActionCard.button("Add variable"),addVariableCTAV2:t.X.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:r=>`Variable editor Table Name field ${r}`,tableRowDefinitionFields:r=>`Variable editor Table Definition field ${r}`,tableRowArrowUpButtons:r=>`Variable editor Table ArrowUp button ${r}`,tableRowArrowDownButtons:r=>`Variable editor Table ArrowDown button ${r}`,tableRowDuplicateButtons:r=>`Variable editor Table Duplicate button ${r}`,tableRowRemoveButtons:r=>`Variable editor Table Remove button ${r}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"data-testid Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"data-testid Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"data-testid Variable editor Preview of Values option",submitButton:"data-testid Variable editor Run Query button",applyButton:"data-testid Variable editor Apply button"},QueryVariable:{queryOptionsDataSourceSelect:t.X.DataSourcePicker.inputV2,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"data-testid Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input",autoEnabledCheckbox:"data-testid interval variable auto value checkbox",stepCountIntervalSelect:"data-testid interval variable step count input",minIntervalInput:"data-testid interval variable mininum interval input"},GroupByVariable:{dataSourceSelect:t.X.DataSourcePicker.inputV2,infoText:"data-testid group by variable info text",modeToggle:"data-testid group by variable mode toggle"},AdHocFiltersVariable:{datasourceSelect:t.X.DataSourcePicker.inputV2,infoText:"data-testid ad-hoc filters variable info text",modeToggle:"data-testid ad-hoc filters variable mode toggle"}}}},Annotations:{marker:"data-testid annotation-marker"},Rows:{Repeated:{ConfigSection:{warningMessage:"data-testid Repeated rows warning message"}}}},Dashboards:{url:"/dashboards",dashboards:r=>`Dashboard search item ${r}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox",saveRefresh:"Dashboard settings Save Dashboard Modal Save refresh checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{PublicDashboard:{Tab:"Tab Public dashboard",WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",PauseSwitch:"data-testid public dashboard pause switch",EnableAnnotationsSwitch:"data-testid public dashboard on off switch for annotations",CreateButton:"data-testid public dashboard create button",DeleteButton:"data-testid public dashboard delete button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",SettingsDropdown:"data-testid public dashboard settings dropdown",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert",UnsupportedDataSourcesWarningAlert:"data-testid public dashboard unsupported data sources alert",NoUpsertPermissionsWarningAlert:"data-testid public dashboard no upsert permissions alert",EnableTimeRangeSwitch:"data-testid public dashboard on off switch for time range",EmailSharingConfiguration:{Container:"data-testid email sharing config container",ShareType:"data-testid public dashboard share type",EmailSharingInput:"data-testid public dashboard email sharing input",EmailSharingInviteButton:"data-testid public dashboard email sharing invite button",EmailSharingList:"data-testid public dashboard email sharing list",DeleteEmail:"data-testid public dashboard delete email button",ReshareLink:"data-testid public dashboard reshare link button"}},PublicDashboardScene:{Tab:"Tab Public Dashboard"},SnapshotScene:{url:r=>`/dashboard/snapshot/${r}`,Tab:"Tab Snapshot",PublishSnapshot:"data-testid publish snapshot button",CopyUrlButton:"data-testid snapshot copy url button",CopyUrlInput:"data-testid snapshot copy url input"}},PublicDashboard:{page:"public-dashboard-page",NotAvailable:{container:"public-dashboard-not-available",title:"public-dashboard-title",pausedDescription:"public-dashboard-paused-description"},footer:"public-dashboard-footer"},PublicDashboardScene:{loadingPage:"public-dashboard-scene-loading-page",page:"public-dashboard-scene-page",controls:"public-dashboard-controls"},RequestViewAccess:{form:"request-view-access-form",recipientInput:"request-view-access-recipient-input",submitButton:"request-view-access-submit-button"},PublicDashboardConfirmAccess:{submitButton:"data-testid confirm-access-submit-button"},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"},QueryHistory:{container:"data-testid QueryHistory"}},SoloPanel:{url:r=>`/d-solo/${r}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"data-testid Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"data-testid Plugin signature info",disabledInfo:"data-testid Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemDelete:"data-testid playlist-form-delete-item"},BrowseDashboards:{table:{body:"data-testid browse-dashboards-table",row:r=>`data-testid browse dashboards row ${r}`,checkbox:r=>`data-testid ${r} checkbox`},NewFolderForm:{form:"data-testid new folder form",nameInput:"data-testid new-folder-name-input",createButton:"data-testid new-folder-create-button"}},Search:{url:"/?search=openn",FolderView:{url:"/?search=open&layout=folders"}},PublicDashboards:{ListItem:{linkButton:"public-dashboard-link-button",configButton:"public-dashboard-configuration-button",trashcanButton:"public-dashboard-remove-button",pauseSwitch:"data-testid public dashboard pause switch"}},UserListPage:{tabs:{allUsers:"data-testid all-users-tab",orgUsers:"data-testid org-users-tab",anonUserDevices:"data-testid anon-user-devices-tab",publicDashboardsUsers:"data-testid public-dashboards-users-tab",users:"data-testid users-tab"},org:{url:"/org/users"},admin:{url:"/admin/users"},publicDashboards:{container:"data-testid public-dashboards-users-list"},UserListAdminPage:{container:"data-testid user-list-admin-page"},UsersListPage:{container:"data-testid users-list-page"},UserAnonListPage:{container:"data-testid user-anon-list-page"},UsersListPublicDashboardsPage:{container:"data-testid users-list-public-dashboards-page",DashboardsListModal:{listItem:r=>`data-testid dashboards-list-item-${r}`}}},ProfilePage:{url:"/profile"}},components:t.X}},76365:(G,I,e)=>{"use strict";e.d(I,{S6:()=>d,Jz:()=>f,oA:()=>y,Ik:()=>c});var t=e(11261),n=e(75972),s=e(57875),r=e(5546),o=e(2543);function m(a,E){const g=l(a);return i(g,E,"parents")}function l(a){return a.map(E=>{if(!E.parents?.length)return E;const g={...E,children:[]},h=[{child:g,parent:E.parents[0]}];for(;h.length;){const D=h.shift(),v={...D.parent,children:D.child?[D.child]:[],parents:[]};D.child&&(v.value=D.child.value,D.child.parents=[v]),D.parent.parents?.length&&h.push({child:v,parent:D.parent.parents[0]})}return g})}function i(a,E,g="children"){const h=g==="parents"?"children":"parents",D=[],v=[{previous:void 0,items:a,level:0}];for(;v.length;){const C=v.shift(),T=C.items.flatMap(b=>b.itemIndexes),S={value:C.items.reduce((b,M)=>b+M.value,0),itemIndexes:T,children:[],parents:[],start:0,level:C.level};if(D[C.level]=D[C.level]||[],D[C.level].push(S),C.previous){S[h]=[C.previous];const b=C.previous[g]?.reduce((M,A)=>M+A.value,0)||0;S.start=C.previous.start+b,C.previous[g].push(S)}const O=C.items.flatMap(b=>b[g]||[]),x=(0,o.groupBy)(O,b=>E.getLabel(b.itemIndexes[0]));for(const b of Object.values(x))v.push({previous:S,items:b,level:C.level+1})}return g==="parents"&&(D.reverse(),D.forEach((C,T)=>{C.forEach(S=>{S.level=T})})),D}function u(a,E){const g=[];let h=0,D;const v={};for(let T=0;T<a.data.length;T++){const S=a.getLevel(T),O=T>0?a.getLevel(T-1):void 0;if(g[S]=g[S]||[],O&&O>=S){const b=g[S][g[S].length-1];h=b.start+a.getValue(b.itemIndexes[0])+a.getValueRight(b.itemIndexes[0]),D=b.parents[0]}const x={itemIndexes:[T],value:a.getValue(T)+a.getValueRight(T),valueRight:a.isDiffFlamegraph()?a.getValueRight(T):void 0,start:h,parents:D&&[D],children:[],level:S};v[a.getLabel(T)]?v[a.getLabel(T)].push(x):v[a.getLabel(T)]=[x],D&&D.children.push(x),D=x,g[S].push(x)}const C=new p(E?.collapsingThreshold);return E?.collapsing&&C.addTree(g[0][0]),[g,v,C.getCollapsedMap()]}class d{constructor(E){this.map=new Map,this.map=E||new Map}get(E){return this.map.get(E)}keys(){return this.map.keys()}values(){return this.map.values()}size(){return this.map.size}setCollapsedStatus(E,g){const h=new Map(this.map),D=this.map.get(E),v={...D,collapsed:g};for(const C of D.items)h.set(C,v);return new d(h)}setAllCollapsedStatus(E){const g=new Map(this.map);for(const h of this.map.keys()){const v={...this.map.get(h),collapsed:E};g.set(h,v)}return new d(g)}}class p{constructor(E){this.map=new Map,this.threshold=.99,E!==void 0&&(this.threshold=E)}addTree(E){const g=[E];for(;g.length;){const h=g.shift();h.parents?.length&&this.addItem(h,h.parents[0]),h.children.length&&g.unshift(...h.children)}}addItem(E,g){if(g&&E.value>g.value*this.threshold&&g.children.length===1)if(this.map.has(g)){const h=this.map.get(g);this.map.set(E,h),h.items.push(E)}else{const h={items:[g,E],collapsed:!0};this.map.set(g,h),this.map.set(E,h)}}getCollapsedMap(){return new d(this.map)}}function c(a){return a.missingFields.length?`Data is missing fields: ${a.missingFields.join(", ")}`:a.wrongTypeFields.length?`Data has fields of wrong type: ${a.wrongTypeFields.map(E=>`${E.name} has type ${E.type} but should be ${E.expectedTypes.join(" or ")}`).join(", ")}`:""}function y(a){const E=[["label",[t.PU.string,t.PU.enum]],["level",[t.PU.number]],["value",[t.PU.number]],["self",[t.PU.number]]],g=[],h=[];for(const D of E){const[v,C]=D,T=a.fields.find(S=>S.name===v);if(!T){g.push(v);continue}C.includes(T.type)||h.push({name:v,expectedTypes:C,type:T.type})}if(g.length>0||h.length>0)return{wrongTypeFields:h,missingFields:g}}class f{constructor(E,g,h=(0,n.a)()){this.data=E,this.options=g;const D=y(E);if(D)throw new Error(c(D));if(this.labelField=E.fields.find(C=>C.name==="label"),this.levelField=E.fields.find(C=>C.name==="level"),this.valueField=E.fields.find(C=>C.name==="value"),this.selfField=E.fields.find(C=>C.name==="self"),this.valueRightField=E.fields.find(C=>C.name==="valueRight"),this.selfRightField=E.fields.find(C=>C.name==="selfRight"),(this.valueField||this.selfField)&&!(this.valueField&&this.selfField))throw new Error("Malformed dataFrame: both valueRight and selfRight has to be present if one of them is present.");const v=this.labelField?.config?.type?.enum;v?(this.labelDisplayProcessor=(0,s.J)({field:this.labelField,theme:h}),this.uniqueLabels=v.text||[]):(this.labelDisplayProcessor=C=>({text:C+"",numeric:0}),this.uniqueLabels=[...new Set(this.labelField.values)]),this.valueDisplayProcessor=(0,s.J)({field:this.valueField,theme:h})}isDiffFlamegraph(){return!!(this.valueRightField&&this.selfRightField)}getLabel(E){return this.labelDisplayProcessor(this.labelField.values[E]).text}getLevel(E){return this.levelField.values[E]}getValue(E){return P(this.valueField,E)}getValueRight(E){return P(this.valueRightField,E)}getSelf(E){return P(this.selfField,E)}getSelfRight(E){return P(this.selfRightField,E)}getSelfDisplay(E){return this.valueDisplayProcessor(this.getSelf(E))}getUniqueLabels(){return this.uniqueLabels}getUnitTitle(){switch(this.valueField.config.unit){case r.Zk.Bytes:return"RAM";case r.Zk.Nanoseconds:return"Time"}return"Count"}getLevels(){return this.initLevels(),this.levels}getSandwichLevels(E){const g=this.getNodesWithLabel(E);if(!g?.length)return[[],[]];const h=m(g,this),D=i(g,this);return[h,D]}getNodesWithLabel(E){return this.initLevels(),this.uniqueLabelsMap[E]}getCollapsedMap(){return this.initLevels(),this.collapsedMap}initLevels(){if(!this.levels){const[E,g,h]=u(this,this.options);this.levels=E,this.uniqueLabelsMap=g,this.collapsedMap=h}}}function P(a,E){return a?(typeof E=="number"?[E]:E).reduce((h,D)=>h+a.values[D],0):0}},85194:(G,I,e)=>{"use strict";e.d(I,{A:()=>Mn});var t=e(32196),n=e(53076),s=e(96540),r=e(49185),o=e(60578),m=e(14578);const l=22*window.devicePixelRatio,i=10*window.devicePixelRatio,u=.5*window.devicePixelRatio,d=20*window.devicePixelRatio,p=.5*window.devicePixelRatio,c=4*window.devicePixelRatio,y=3*window.devicePixelRatio,f=3*window.devicePixelRatio,P=4*window.devicePixelRatio,a=2*window.devicePixelRatio,E=800,g=120;var h=e(64539),D=e(59093),v=e(28122);const T=({data:vt,itemData:nn,onMenuItemClick:cn,onItemFocus:mt,onSandwich:lt,collapseConfig:Tt,onExpandGroup:Vt,onCollapseGroup:zt,onExpandAllGroups:rn,onCollapseAllGroups:mn,getExtraContextMenuButtons:dt,collapsing:wt,allGroupsExpanded:en,allGroupsCollapsed:En,selectedView:yt,search:At})=>{function Kt(){const Jt=dt?.(nn,vt.data,{selectedView:yt,isDiff:vt.isDiffFlamegraph(),search:At,collapseConfig:Tt})||[];return s.createElement(s.Fragment,null,s.createElement(h.D,{label:"Focus block",icon:"eye",onClick:()=>{mt(),cn()}}),s.createElement(h.D,{label:"Copy function name",icon:"copy",onClick:()=>{navigator.clipboard.writeText(nn.label).then(()=>{cn()})}}),s.createElement(h.D,{label:"Sandwich view",icon:"gf-show-context",onClick:()=>{lt(),cn()}}),Jt.map(({label:Mt,icon:Je,onClick:Nn})=>s.createElement(h.D,{label:Mt,icon:Je,onClick:()=>Nn(),key:Mt})),wt&&s.createElement(D.r,{label:"Grouping"},Tt?Tt.collapsed?s.createElement(h.D,{label:"Expand group",icon:"angle-double-down",onClick:()=>{Vt(),cn()}}):s.createElement(h.D,{label:"Collapse group",icon:"angle-double-up",onClick:()=>{zt(),cn()}}):null,!en&&s.createElement(h.D,{label:"Expand all groups",icon:"angle-double-down",onClick:()=>{rn(),cn()}}),!En&&s.createElement(h.D,{label:"Collapse all groups",icon:"angle-double-up",onClick:()=>{mn(),cn()}})))}return s.createElement("div",{"data-testid":"contextMenu"},s.createElement(v.t,{renderMenuItems:Kt,x:nn.posX+10,y:nn.posY,focusOnOpen:!1}))};var S=e(83195),O=e(40845),x=e(48840),b=e(17464),M=e(69503);const A=({data:vt,item:nn,totalTicks:cn,position:mt,collapseConfig:lt})=>{const Tt=(0,O.of)(W);if(!(nn&&mt))return null;let Vt;if(vt.isDiffFlamegraph()){const zt=B(vt,nn,cn);Vt=s.createElement(x.j,{className:Tt.tooltipTable,columns:[{id:"label",header:""},{id:"baseline",header:"Baseline"},{id:"comparison",header:"Comparison"},{id:"diff",header:"Diff"}],data:zt,getRowId:rn=>rn.rowId})}else{const zt=R(vt,nn,cn);Vt=s.createElement("p",{className:Tt.lastParagraph},zt.unitTitle,s.createElement("br",null),"Total: ",s.createElement("b",null,zt.unitValue)," (",zt.percentValue,"%)",s.createElement("br",null),"Self: ",s.createElement("b",null,zt.unitSelf)," (",zt.percentSelf,"%)",s.createElement("br",null),"Samples: ",s.createElement("b",null,zt.samples))}return s.createElement(b.ZL,null,s.createElement(M.o,{className:Tt.tooltipContainer,position:mt,offset:{x:15,y:0}},s.createElement("div",{className:Tt.tooltipContent},s.createElement("p",{className:Tt.tooltipName},vt.getLabel(nn.itemIndexes[0]),lt&&lt.collapsed?s.createElement("span",null,s.createElement("br",null),"and ",lt.items.length," similar items"):""),Vt)))},R=(vt,nn,cn)=>{const mt=vt.valueDisplayProcessor(nn.value),lt=vt.getSelfDisplay(nn.itemIndexes),Tt=Math.round(1e4*(mt.numeric/cn))/100,Vt=Math.round(1e4*(lt.numeric/cn))/100;let zt=mt.text+mt.suffix,rn=lt.text+lt.suffix;const mn=vt.getUnitTitle();return mn==="Count"&&(mt.suffix||(zt=mt.text),lt.suffix||(rn=lt.text)),{percentValue:Tt,percentSelf:Vt,unitTitle:mn,unitValue:zt,unitSelf:rn,samples:mt.numeric.toLocaleString()}},B=(vt,nn,cn)=>{const lt=vt.getLevels()[0][0].valueRight,Tt=cn-lt,Vt=nn.value-nn.valueRight,zt=Math.round(1e4*Vt/Tt)/100,rn=Math.round(1e4*nn.valueRight/lt)/100,mn=(rn-zt)/zt*100,dt=U(vt,vt.valueDisplayProcessor(Vt)),wt=U(vt,vt.valueDisplayProcessor(nn.valueRight)),en=(0,S.j_)("short");return[{rowId:"1",label:"% of total",baseline:zt+"%",comparison:rn+"%",diff:en(mn).text+"%"},{rowId:"2",label:"Value",baseline:dt,comparison:wt,diff:U(vt,vt.valueDisplayProcessor(nn.valueRight-Vt))},{rowId:"3",label:"Samples",baseline:en(Vt).text,comparison:en(nn.valueRight).text,diff:en(nn.valueRight-Vt).text}]};function U(vt,nn){let cn=nn.text+nn.suffix;return vt.getUnitTitle()==="Count"&&(nn.suffix||(cn=nn.text)),cn}const W=vt=>({tooltipContainer:(0,t.css)({title:"tooltipContainer",overflow:"hidden"}),tooltipContent:(0,t.css)({title:"tooltipContent",fontSize:vt.typography.bodySmall.fontSize,width:"100%"}),tooltipName:(0,t.css)({title:"tooltipName",marginTop:0,wordBreak:"break-all"}),lastParagraph:(0,t.css)({title:"lastParagraph",marginBottom:0}),name:(0,t.css)({title:"name",marginBottom:"10px"}),tooltipTable:(0,t.css)({title:"tooltipTable",maxWidth:"400px"})}),N=A;var w=e(84140),L=e(5546),V=e(21313);function K(vt,nn=0){let cn,mt,lt,Tt,Vt,zt,rn,mn;for(cn=vt.length&3,mt=vt.length-cn,lt=nn,Vt=3432918353,zt=461845907,mn=0;mn<mt;)rn=vt.charCodeAt(mn)&255|(vt.charCodeAt(++mn)&255)<<8|(vt.charCodeAt(++mn)&255)<<16|(vt.charCodeAt(++mn)&255)<<24,++mn,rn=(rn&65535)*Vt+(((rn>>>16)*Vt&65535)<<16)&4294967295,rn=rn<<15|rn>>>17,rn=(rn&65535)*zt+(((rn>>>16)*zt&65535)<<16)&4294967295,lt^=rn,lt=lt<<13|lt>>>19,Tt=(lt&65535)*5+(((lt>>>16)*5&65535)<<16)&4294967295,lt=(Tt&65535)+27492+(((Tt>>>16)+58964&65535)<<16);switch(rn=0,cn){case 3:rn^=(vt.charCodeAt(mn+2)&255)<<16;case 2:rn^=(vt.charCodeAt(mn+1)&255)<<8;case 1:rn^=vt.charCodeAt(mn)&255;default:rn=(rn&65535)*Vt+(((rn>>>16)*Vt&65535)<<16)&4294967295,rn=rn<<15|rn>>>17,rn=(rn&65535)*zt+(((rn>>>16)*zt&65535)<<16)&4294967295,lt^=rn}return lt^=vt.length,lt^=lt>>>16,lt=(lt&65535)*2246822507+(((lt>>>16)*2246822507&65535)<<16)&4294967295,lt^=lt>>>13,lt=(lt&65535)*3266489909+(((lt>>>16)*3266489909&65535)<<16)&4294967295,lt^=lt>>>16,lt>>>0}const k=[(0,w.A)({h:24,s:69,l:60}),(0,w.A)({h:34,s:65,l:65}),(0,w.A)({h:194,s:52,l:61}),(0,w.A)({h:163,s:45,l:55}),(0,w.A)({h:211,s:48,l:60}),(0,w.A)({h:246,s:40,l:65}),(0,w.A)({h:305,s:63,l:79}),(0,w.A)({h:47,s:100,l:73}),(0,w.A)({r:183,g:219,b:171}),(0,w.A)({r:244,g:213,b:152}),(0,w.A)({r:78,g:146,b:249}),(0,w.A)({r:249,g:186,b:143}),(0,w.A)({r:242,g:145,b:145}),(0,w.A)({r:130,g:181,b:216}),(0,w.A)({r:229,g:168,b:226}),(0,w.A)({r:174,g:162,b:224}),(0,w.A)({r:154,g:196,b:138}),(0,w.A)({r:242,g:201,b:109}),(0,w.A)({r:101,g:197,b:219}),(0,w.A)({r:249,g:147,b:78}),(0,w.A)({r:234,g:100,b:96}),(0,w.A)({r:81,g:149,b:206}),(0,w.A)({r:214,g:131,b:206}),(0,w.A)({r:128,g:110,b:183})],j=se(1,100,0,1),H=se(100,100,0,1),J=`linear-gradient(90deg, ${j} 0%, ${H} 100%)`,X=`linear-gradient(90deg, ${k[0]} 0%, ${k[2]} 30%, ${k[6]} 50%, ${k[7]} 70%, ${k[8]} 100%)`;function se(vt,nn,cn,mt){const lt=Math.min(1,vt/nn/(mt-cn)),Tt=50-50*lt,Vt=65+7*lt;return(0,w.A)({h:Tt,s:100,l:Vt})}function ae(vt,nn){const cn=ce(vt),lt=K(cn||"",0)%k.length;let Tt=k[lt].clone();return nn.isLight&&(Tt=Tt.brighten(15)),Tt}const ne=["rgb(0, 170, 0)","rgb(148, 142, 142)","rgb(200, 0, 0)"],q=`linear-gradient(90deg, ${ne[0]} 0%, ${ne[1]} 50%, ${ne[2]} 100%)`,ee=["rgb(26, 133, 255)","rgb(148, 142, 142)","rgb(220, 50, 32)"],z=`linear-gradient(90deg, ${ee[0]} 0%, ${ee[1]} 50%, ${ee[2]} 100%)`;function te(vt,nn,cn,mt,lt){const Tt=lt===L.yU.Default?ne:ee,Vt=(0,V.scaleLinear)().domain([-100,0,100]).range(Tt),zt=vt-nn,rn=cn-mt;if(mt===0||rn===0){const En=Vt(0);return(0,w.A)(En)}const mn=Math.round(1e4*zt/rn)/100,wt=(Math.round(1e4*nn/mt)/100-mn)/mn*100,en=Vt(wt);return(0,w.A)(en)}const ie=[["phpspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.php+)(?<line_info>.*)$/],["pyspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.py+)(?<line_info>.*)$/],["rbspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.rb+)(?<line_info>.*)$/],["nodespy",/^(\.\/node_modules\/)?(?<packageName>[^/]*)(?<filename>.*\.?(jsx?|tsx?)?):(?<functionName>.*):(?<line_info>.*)$/],["gospy",/^(?<packageName>.*?\/.*?\.|.*?\.|.+)(?<functionName>.*)$/],["javaspy",/^(?<packageName>.+\/)(?<filename>.+\.)(?<functionName>.+)$/],["dotnetspy",/^(?<packageName>.+)\.(.+)\.(.+)\(.*\)$/],["tracing",/^(?<packageName>.+?):.*$/],["pyroscope-rs",/^(?<packageName>[^::]+)/],["ebpfspy",/^(?<packageName>.+)$/],["unknown",/^(?<packageName>.+)$/]];function ce(vt){for(const[nn,cn]of ie){const mt=vt.match(cn);if(mt)return mt.groups?.packageName||""}}function ue(vt){const{canvasRef:nn,data:cn,root:mt,depth:lt,direction:Tt,wrapperWidth:Vt,rangeMin:zt,rangeMax:rn,matchedLabels:mn,textAlign:dt,totalViewTicks:wt,totalColorTicks:en,totalTicksRight:En,colorScheme:yt,focusedItemData:At,collapsedMap:Kt}=vt,Jt=le(nn,Vt,lt),Mt=(0,O.$j)(),Je=(0,s.useMemo)(()=>{const Fn=(0,w.A)(Mt.colors.background.secondary);return Mt.isLight?Fn.darken(10).toHexString():Fn.lighten(10).toHexString()},[Mt]),Nn=de(en,En,yt,Mt,Je,zt,rn,mn,At?At.item.level:0),xn=fe(Jt,cn,Nn,dt,Kt);(0,s.useEffect)(()=>{if(!Jt)return;Jt.clearRect(0,0,Jt.canvas.width,Jt.canvas.height);const Fn=new Path2D;he(mt,Tt,cn,wt,zt,rn,Vt,Kt,(wn,Wn,da,oa,_n,Wa,za)=>{za?Fn.rect(Wn,da,oa,_n):xn(wn,Wn,da,oa,_n,Wa)}),Jt.fillStyle=Je,Jt.fill(Fn)},[Jt,cn,mt,Vt,zt,rn,wt,Tt,xn,Kt,Je])}function fe(vt,nn,cn,mt,lt){return(0,s.useMemo)(()=>vt?(Vt,zt,rn,mn,dt,wt)=>{vt.beginPath(),vt.rect(zt+p,rn,mn,dt),vt.fillStyle=cn(Vt,wt,!1),vt.stroke(),vt.fill();const en=lt.get(Vt);let En=wt;en&&en.collapsed&&(En=`(${en.items.length}) `+wt),mn>=d&&(en?(pe(vt,nn,En,Vt,mn,mt==="left"?zt+P+a:zt,rn,mt),Te(vt,zt,rn,dt,Vt,en)):pe(vt,nn,En,Vt,mn,zt,rn,mt))}:()=>{},[vt,cn,mt,nn,lt])}function Te(vt,nn,cn,mt,lt,Tt){const Vt=nn+P;vt.beginPath(),vt.rect(nn,cn,Vt-nn+y+f,mt),vt.fill(),vt.beginPath(),Tt.collapsed?vt.rect(Vt,cn+mt/4,y,mt/2):Tt.items[0]===lt?vt.rect(Vt,cn+mt/2,y,mt/2):Tt.items[Tt.items.length-1]===lt?vt.rect(Vt,cn,y,mt/2):vt.rect(Vt,cn,y,mt),vt.fillStyle="#666",vt.fill()}function he(vt,nn,cn,mt,lt,Tt,Vt,zt,rn){const mn=[];mn.push({item:vt,levelOffset:0});const dt=Vt*window.devicePixelRatio/mt/(Tt-lt);let wt;for(;mn.length>0;){const{item:en,levelOffset:En}=mn.shift();let yt=en.value;const At=yt*dt<=i,Kt=yt*dt-(At?0:p*2),Jt=l;if(Kt<u)continue;let Mt=0,Je=!1;const Nn=zt.get(en),xn=Nn&&Nn.collapsed;if(xn&&wt===Nn.items[0]?(Mt=nn==="children"?-1:1,Je=!0):wt=void 0,!Je){const wn=ve(en.start,mt,lt,dt),Wn=(en.level+En)*l;let da=cn.getLabel(en.itemIndexes[0]);xn&&(wt=en),rn(en,wn,Wn,Kt,Jt,da,At)}const Fn=nn==="children"?en.children:en.parents;Fn&&mn.unshift(...Fn.map(wn=>({item:wn,levelOffset:En+Mt})))}}function de(vt,nn,cn,mt,lt,Tt,Vt,zt,rn){return(0,s.useCallback)(function(dt,wt,en){if(en&&!zt)return lt;const En=dt.valueRight!==void 0&&(cn===L.yU.Default||cn===L.yU.DiffColorBlind)?te(dt.value,dt.valueRight,vt,nn,cn):cn===L.zM.ValueBased?se(dt.value,vt,Tt,Vt):ae(wt,mt);return zt?zt.has(wt)?En.toHslString():lt:dt.level>rn-1?En.toHslString():En.lighten(15).toHslString()},[vt,nn,cn,mt,Tt,Vt,zt,rn,lt])}function le(vt,nn,cn){const[mt,lt]=(0,s.useState)();return(0,s.useEffect)(()=>{if(!(cn&&vt.current))return;const Tt=vt.current.getContext("2d"),Vt=l*cn;vt.current.width=Math.round(nn*window.devicePixelRatio),vt.current.height=Math.round(Vt),vt.current.style.width=`${nn}px`,vt.current.style.height=`${Vt/window.devicePixelRatio}px`,Tt.textBaseline="middle",Tt.font=12*window.devicePixelRatio+"px monospace",Tt.strokeStyle="white",lt(Tt)},[vt,lt,nn,cn]),mt}function pe(vt,nn,cn,mt,lt,Tt,Vt,zt){vt.save(),vt.clip(),vt.fillStyle="#222";const rn=nn.valueDisplayProcessor(mt.value),mn=rn.suffix?rn.text+rn.suffix:rn.text,dt=vt.measureText(cn),wt=lt-c;let en=`${cn} (${mn})`,En=Math.max(Tt,0)+c;dt.width>wt&&(vt.textAlign=zt,zt==="right"&&(en=cn,En=Tt+lt-c)),vt.fillText(en,En,Vt+l/2+2),vt.restore()}function ve(vt,nn,cn,mt){return(vt-nn*cn)*mt}const be=({data:vt,rangeMin:nn,rangeMax:cn,matchedLabels:mt,setRangeMin:lt,setRangeMax:Tt,onItemFocused:Vt,focusedItemData:zt,textAlign:rn,onSandwich:mn,colorScheme:dt,totalProfileTicks:wt,totalProfileTicksRight:en,totalViewTicks:En,root:yt,direction:At,depth:Kt,showFlameGraphOnly:Jt,collapsedMap:Mt,setCollapsedMap:Je,collapsing:Nn,getExtraContextMenuButtons:xn,selectedView:Fn,search:wn})=>{const Wn=Oe(),[da,{width:oa}]=(0,r.A)(),_n=(0,s.useRef)(null),[Wa,za]=(0,s.useState)(),[_a,Xa]=(0,s.useState)();ue({canvasRef:_n,colorScheme:dt,data:vt,focusedItemData:zt,root:yt,direction:At,depth:Kt,rangeMax:cn,rangeMin:nn,matchedLabels:mt,textAlign:rn,totalViewTicks:En,totalColorTicks:vt.isDiffFlamegraph()?wt:En,totalTicksRight:en,wrapperWidth:oa,collapsedMap:Mt});const Va=(0,s.useCallback)(ss=>{za(void 0);const Fs=_n.current.clientWidth/En/(cn-nn),Ts=Me({x:ss.nativeEvent.offsetX,y:ss.nativeEvent.offsetY},yt,At,Kt,Fs,En,nn,Mt);Xa(Ts?{posY:ss.clientY,posX:ss.clientX,item:Ts,label:vt.getLabel(Ts.itemIndexes[0])}:void 0)},[vt,nn,cn,En,yt,At,Kt,Mt]),[Cs,ns]=(0,s.useState)(),Is=(0,s.useCallback)(ss=>{if(_a===void 0){za(void 0),ns(void 0);const Fs=_n.current.clientWidth/En/(cn-nn),Ts=Me({x:ss.nativeEvent.offsetX,y:ss.nativeEvent.offsetY},yt,At,Kt,Fs,En,nn,Mt);Ts&&(ns({x:ss.clientX,y:ss.clientY}),za(Ts))}},[nn,cn,En,_a,ns,yt,At,Kt,Mt]),ls=(0,s.useCallback)(()=>{za(void 0)},[]);return(0,s.useEffect)(()=>{const ss=Fs=>{Fs.target instanceof HTMLElement&&Fs.target.parentElement?.id!=="flameGraphCanvasContainer_clickOutsideCheck"&&Xa(void 0)};return window.addEventListener("click",ss),()=>window.removeEventListener("click",ss)},[Xa]),s.createElement("div",{className:Wn.graph},s.createElement("div",{className:Wn.canvasWrapper,id:"flameGraphCanvasContainer_clickOutsideCheck",ref:da},s.createElement("canvas",{ref:_n,"data-testid":"flameGraph",onClick:Va,onMouseMove:Is,onMouseLeave:ls})),s.createElement(N,{position:Cs,item:Wa,data:vt,totalTicks:En,collapseConfig:Wa?Mt.get(Wa):void 0}),!Jt&&_a&&s.createElement(T,{data:vt,itemData:_a,collapsing:Nn,collapseConfig:Mt.get(_a.item),onMenuItemClick:()=>{Xa(void 0)},onItemFocus:()=>{lt(_a.item.start/En),Tt((_a.item.start+_a.item.value)/En),Vt(_a)},onSandwich:()=>{mn(vt.getLabel(_a.item.itemIndexes[0]))},onExpandGroup:()=>{Je(Mt.setCollapsedStatus(_a.item,!1))},onCollapseGroup:()=>{Je(Mt.setCollapsedStatus(_a.item,!0))},onExpandAllGroups:()=>{Je(Mt.setAllCollapsedStatus(!1))},onCollapseAllGroups:()=>{Je(Mt.setAllCollapsedStatus(!0))},allGroupsCollapsed:Array.from(Mt.values()).every(ss=>ss.collapsed),allGroupsExpanded:Array.from(Mt.values()).every(ss=>!ss.collapsed),getExtraContextMenuButtons:xn,selectedView:Fn,search:wn}))},Oe=()=>({graph:(0,t.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),canvasContainer:(0,t.css)({label:"canvasContainer",display:"flex"}),canvasWrapper:(0,t.css)({label:"canvasWrapper",cursor:"pointer",flex:1,overflow:"hidden"}),sandwichMarker:(0,t.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerIcon:(0,t.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),Me=(vt,nn,cn,mt,lt,Tt,Vt,zt)=>{let rn=nn,mn=cn==="children"?0:mt-1;const dt=Math.floor(vt.y/(l/window.devicePixelRatio));let wt;for(;rn;){const en=rn;if(rn=void 0,mn===dt){wt=en;break}const En=cn==="children"?en.children:en.parents||[];for(const yt of En){const At=ve(yt.start,Tt,Vt,lt),Kt=ve(yt.start+yt.value,Tt,Vt,lt);if(At<=vt.x&&vt.x<Kt){rn=yt;const Jt=zt.get(yt);(!Jt||!Jt.collapsed||Jt.items[0]===yt)&&(mn=mn+(cn==="children"?1:-1));break}}}return wt},Ue=be;var we=e(29158);const Re=s.memo(({data:vt,focusedItem:nn,totalTicks:cn,sandwichedLabel:mt,onFocusPillClick:lt,onSandwichPillClick:Tt})=>{const Vt=(0,O.of)(Fe),zt=[],rn=(0,S.j_)("short")(cn),mn=vt.valueDisplayProcessor(cn);let dt=mn.text+mn.suffix;const wt=vt.getUnitTitle();if(wt==="Count"&&(mn.suffix||(dt=mn.text)),zt.push(s.createElement("div",{className:Vt.metadataPill,key:"default"},dt," | ",rn.text,rn.suffix," samples (",wt,")")),mt&&zt.push(s.createElement("span",{key:"sandwich"},s.createElement(m.I,{size:"sm",name:"angle-right"}),s.createElement("div",{className:Vt.metadataPill},s.createElement(m.I,{size:"sm",name:"gf-show-context"})," ",s.createElement("span",{className:Vt.metadataPillName},mt.substring(mt.lastIndexOf("/")+1)),s.createElement(we.K,{className:Vt.pillCloseButton,name:"times",size:"sm",onClick:Tt,tooltip:"Remove sandwich view","aria-label":"Remove sandwich view"})))),nn){const en=Math.round(1e4*(nn.item.value/cn))/100;zt.push(s.createElement("span",{key:"focus"},s.createElement(m.I,{size:"sm",name:"angle-right"}),s.createElement("div",{className:Vt.metadataPill},s.createElement(m.I,{size:"sm",name:"eye"})," ",en,"% of total",s.createElement(we.K,{className:Vt.pillCloseButton,name:"times",size:"sm",onClick:lt,tooltip:"Remove focus","aria-label":"Remove focus"}))))}return s.createElement("div",{className:Vt.metadata},zt)});Re.displayName="FlameGraphMetadata";const Fe=vt=>({metadataPill:(0,t.css)({label:"metadataPill",display:"inline-flex",alignItems:"center",background:vt.colors.background.secondary,borderRadius:vt.shape.borderRadius(8),padding:vt.spacing(.5,1),fontSize:vt.typography.bodySmall.fontSize,fontWeight:vt.typography.fontWeightMedium,lineHeight:vt.typography.bodySmall.lineHeight,color:vt.colors.text.secondary}),pillCloseButton:(0,t.css)({label:"pillCloseButton",verticalAlign:"text-bottom",margin:vt.spacing(0,.5)}),metadata:(0,t.css)({margin:"8px 0",textAlign:"center"}),metadataPillName:(0,t.css)({label:"metadataPillName",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginLeft:vt.spacing(.5)})}),xe=Re,Ve=({data:vt,rangeMin:nn,rangeMax:cn,matchedLabels:mt,setRangeMin:lt,setRangeMax:Tt,onItemFocused:Vt,focusedItemData:zt,textAlign:rn,onSandwich:mn,sandwichItem:dt,onFocusPillClick:wt,onSandwichPillClick:en,colorScheme:En,showFlameGraphOnly:yt,getExtraContextMenuButtons:At,collapsing:Kt,selectedView:Jt,search:Mt,collapsedMap:Je,setCollapsedMap:Nn})=>{const xn=$e(),[Fn,wn]=(0,s.useState)(),[Wn,da]=(0,s.useState)(),[oa,_n]=(0,s.useState)(0),[Wa,za]=(0,s.useState)(),[_a,Xa]=(0,s.useState)(0);if((0,s.useEffect)(()=>{if(vt){let ns=vt.getLevels(),Is=ns.length?ns[0][0].value:0,ls=ns.length?ns[0][0].valueRight:void 0,ss=Is,Fs;if(dt){const[Ts,Es]=vt.getSandwichLevels(dt);ns=Es,Fs=Ts,ss=Es[0]?.[0]?.value??0}wn(ns),da(Fs),_n(Is),za(ls),Xa(ss)}},[vt,dt]),!Fn)return null;const Va={data:vt,rangeMin:nn,rangeMax:cn,matchedLabels:mt,setRangeMin:lt,setRangeMax:Tt,onItemFocused:Vt,focusedItemData:zt,textAlign:rn,onSandwich:mn,colorScheme:En,totalProfileTicks:oa,totalProfileTicksRight:Wa,totalViewTicks:_a,showFlameGraphOnly:yt,collapsedMap:Je,setCollapsedMap:Nn,getExtraContextMenuButtons:At,collapsing:Kt,search:Mt,selectedView:Jt},Cs=Wn?s.createElement(s.Fragment,null,s.createElement("div",{className:xn.sandwichCanvasWrapper},s.createElement("div",{className:xn.sandwichMarker},"Callers",s.createElement(m.I,{className:xn.sandwichMarkerIcon,name:"arrow-down"})),s.createElement(Ue,{...Va,root:Wn[Wn.length-1][0],depth:Wn.length,direction:"parents",collapsing:!1})),s.createElement("div",{className:xn.sandwichCanvasWrapper},s.createElement("div",{className:(0,t.cx)(xn.sandwichMarker,xn.sandwichMarkerCalees)},s.createElement(m.I,{className:xn.sandwichMarkerIcon,name:"arrow-up"}),"Callees"),s.createElement(Ue,{...Va,root:Fn[0][0],depth:Fn.length,direction:"children",collapsing:!1}))):s.createElement(Ue,{...Va,root:Fn[0][0],depth:Fn.length,direction:"children"});return s.createElement("div",{className:xn.graph},s.createElement(xe,{data:vt,focusedItem:zt,sandwichedLabel:dt,totalTicks:_a,onFocusPillClick:wt,onSandwichPillClick:en}),Cs)},$e=()=>({graph:(0,t.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),sandwichCanvasWrapper:(0,t.css)({label:"sandwichCanvasWrapper",display:"flex",marginBottom:`${l/window.devicePixelRatio}px`}),sandwichMarker:(0,t.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerCalees:(0,t.css)({label:"sandwichMarkerCalees",textAlign:"right"}),sandwichMarkerIcon:(0,t.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),Xe=Ve;var gt=e(76365),Dt=e(75198),nt=e(80292),at=e(55852),Ae=e(10354),re=e(19727),Z=e(94354),oe=e(38138),Ee=e(83122);const ye=({search:vt,setSearch:nn,selectedView:cn,setSelectedView:mt,containerWidth:lt,onReset:Tt,textAlign:Vt,onTextAlignChange:zt,showResetButton:rn,colorScheme:mn,onColorSchemeChange:dt,stickyHeader:wt,extraHeaderElements:en,vertical:En,isDiffMode:yt,setCollapsedMap:At,collapsedMap:Kt})=>{const Jt=(0,O.of)(it),[Mt,Je]=Ke(vt,nn),Nn=Mt!==""?s.createElement(at.$n,{icon:"times",fill:"text",size:"sm",onClick:()=>{nn(""),Je("")}},"Clear"):null;return s.createElement("div",{className:(0,t.cx)(Jt.header,{[Jt.stickyHeader]:wt})},s.createElement("div",{className:Jt.inputContainer},s.createElement(Ae.p,{value:Mt||"",onChange:xn=>{Je(xn.currentTarget.value)},placeholder:"Search...",suffix:Nn})),s.createElement("div",{className:Jt.rightContainer},rn&&s.createElement(at.$n,{variant:"secondary",fill:"outline",size:"sm",icon:"history-alt",tooltip:"Reset focus and sandwich state",onClick:()=>{Tt()},className:Jt.buttonSpacing,"aria-label":"Reset focus and sandwich state"}),s.createElement(Se,{value:mn,onChange:dt,isDiffMode:yt}),s.createElement(re.e,{className:Jt.buttonSpacing},s.createElement(at.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Expand all groups",onClick:()=>{At(Kt.setAllCollapsedStatus(!1))},"aria-label":"Expand all groups",icon:"angle-double-down",disabled:cn===L.F8.TopTable}),s.createElement(at.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Collapse all groups",onClick:()=>{At(Kt.setAllCollapsedStatus(!0))},"aria-label":"Collapse all groups",icon:"angle-double-up",disabled:cn===L.F8.TopTable})),s.createElement(Z.z,{size:"sm",disabled:cn===L.F8.TopTable,options:Be,value:Vt,onChange:zt,className:Jt.buttonSpacing}),s.createElement(Z.z,{size:"sm",options:We(lt,En),value:cn,onChange:mt}),en&&s.createElement("div",{className:Jt.extraElements},en)))};function Se(vt){const nn=(0,O.of)(it);let cn=s.createElement(oe.W,null,s.createElement(oe.W.Item,{label:"By package name",onClick:()=>vt.onChange(L.zM.PackageBased)}),s.createElement(oe.W.Item,{label:"By value",onClick:()=>vt.onChange(L.zM.ValueBased)}));const mt={[L.zM.ValueBased]:nn.colorDotByValue,[L.zM.PackageBased]:nn.colorDotByPackage,[L.yU.DiffColorBlind]:nn.colorDotDiffColorBlind,[L.yU.Default]:nn.colorDotDiffDefault}[vt.value]||nn.colorDotByValue;let lt=s.createElement("span",{className:(0,t.cx)(nn.colorDot,mt)});return vt.isDiffMode&&(cn=s.createElement(oe.W,null,s.createElement(oe.W.Item,{label:"Default (green to red)",onClick:()=>vt.onChange(L.yU.Default)}),s.createElement(oe.W.Item,{label:"Color blind (blue to red)",onClick:()=>vt.onChange(L.yU.DiffColorBlind)})),lt=s.createElement("div",{className:(0,t.cx)(nn.colorDotDiff,mt)},s.createElement("div",null,"-100% (removed)"),s.createElement("div",null,"0%"),s.createElement("div",null,"+100% (added)"))),s.createElement(Ee.m,{overlay:cn},s.createElement(at.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Change color scheme",onClick:()=>{},className:nn.buttonSpacing,"aria-label":"Change color scheme"},lt))}const Be=[{value:"left",description:"Align text left",icon:"align-left"},{value:"right",description:"Align text right",icon:"align-right"}];function We(vt,nn){let cn=[{value:L.F8.TopTable,label:"Top Table",description:"Only show top table"},{value:L.F8.FlameGraph,label:"Flame Graph",description:"Only show flame graph"}];return(vt>=E||nn)&&cn.push({value:L.F8.Both,label:"Both",description:"Show both the top table and flame graph"}),cn}function Ke(vt,nn){const[cn,mt]=(0,s.useState)(vt),lt=(0,nt.A)(vt);return(0,Dt.A)(()=>{nn(cn)},250,[cn]),(0,s.useEffect)(()=>{lt!==vt&&vt!==cn&&mt(vt)},[vt,lt,cn]),[cn,mt]}const it=vt=>({header:(0,t.css)({label:"header",display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",top:0,gap:vt.spacing(1),marginTop:vt.spacing(1)}),stickyHeader:(0,t.css)({zIndex:vt.zIndex.navbarFixed,position:"sticky",background:vt.colors.background.primary}),inputContainer:(0,t.css)({label:"inputContainer",flexGrow:1,minWidth:"150px",maxWidth:"350px"}),rightContainer:(0,t.css)({label:"rightContainer",display:"flex",alignItems:"flex-start",flexWrap:"wrap"}),buttonSpacing:(0,t.css)({label:"buttonSpacing",marginRight:vt.spacing(1)}),resetButton:(0,t.css)({label:"resetButton",display:"flex",marginRight:vt.spacing(2)}),resetButtonIconWrapper:(0,t.css)({label:"resetButtonIcon",padding:"0 5px",color:vt.colors.text.disabled}),colorDot:(0,t.css)({label:"colorDot",display:"inline-block",width:"10px",height:"10px",borderRadius:"50%"}),colorDotDiff:(0,t.css)({label:"colorDotDiff",display:"flex",width:"200px",height:"12px",color:"white",fontSize:9,lineHeight:1.3,fontWeight:300,justifyContent:"space-between",padding:"0 2px",borderRadius:"2px"}),colorDotByValue:(0,t.css)({label:"colorDotByValue",background:J}),colorDotByPackage:(0,t.css)({label:"colorDotByPackage",background:X}),colorDotDiffDefault:(0,t.css)({label:"colorDotDiffDefault",background:q}),colorDotDiffColorBlind:(0,t.css)({label:"colorDotDiffColorBlind",background:z}),extraElements:(0,t.css)({label:"extraElements",marginLeft:vt.spacing(1)})}),rt=ye;var ft=e(70713),pt=e(11261),Ge=e(25019),qe=e(90708),bt=e(77093),Ft=e(52622);const Xt=s.memo(({data:vt,onSymbolClick:nn,search:cn,matchedLabels:mt,onSearch:lt,sandwichItem:Tt,onSandwich:Vt,onTableSort:zt,colorScheme:rn})=>{const mn=(0,s.useMemo)(()=>{let yt={};for(let At=0;At<vt.data.length;At++){const Kt=vt.getValue(At),Jt=vt.getValueRight(At),Mt=vt.getSelf(At),Je=vt.getLabel(At);(!mt||mt.has(Je))&&(yt[Je]=yt[Je]||{},yt[Je].self=yt[Je].self?yt[Je].self+Mt:Mt,yt[Je].total=yt[Je].total?yt[Je].total+Kt:Kt,yt[Je].totalRight=yt[Je].totalRight?yt[Je].totalRight+Jt:Jt)}return yt},[vt,mt]),dt=(0,O.of)(Nt),wt=(0,O.$j)(),[en,En]=(0,s.useState)([{displayName:"Self",desc:!0}]);return s.createElement("div",{className:dt.topTableContainer,"data-testid":"topTable"},s.createElement(ft.Ay,{style:{width:"100%"}},({width:yt,height:At})=>{if(yt<3||At<3)return null;const Kt=Lt(vt,mn,yt,nn,lt,Vt,wt,rn,cn,Tt);return s.createElement(bt.X,{initialSortBy:en,onSortByChange:Jt=>{Jt&&Jt.length&&zt?.(Jt[0].displayName+"_"+(Jt[0].desc?"desc":"asc")),En(Jt)},data:Kt,width:yt,height:At})}))});Xt.displayName="FlameGraphTopTableContainer";function Lt(vt,nn,cn,mt,lt,Tt,Vt,zt,rn,mn){const dt=gn(Tt,lt,rn,mn),wt={type:pt.PU.string,name:"Symbol",values:[],config:{custom:{width:cn-an-g*2},links:[{title:"Highlight symbol",url:"",onClick:yt=>{const Kt=yt.origin.field.values[yt.origin.rowIndex];mt(Kt)}}]}};let en;if(vt.isDiffFlamegraph()){wt.config.custom.width=cn-an-g*3;const yt=Qt("Baseline","percent"),At=Qt("Comparison","percent"),Kt=Qt("Diff","percent");Kt.config.custom.cellOptions.type=Ft.ob.ColorText;const[Jt,Mt]=zt===L.yU.DiffColorBlind?[ee[0],ee[2]]:[ne[0],ne[2]];Kt.config.mappings=[{type:Ge.d.ValueToText,options:{[1/0]:{text:"new",color:Mt}}},{type:Ge.d.ValueToText,options:{[-100]:{text:"removed",color:Jt}}},{type:Ge.d.RangeToText,options:{from:0,to:1/0,result:{color:Mt}}},{type:Ge.d.RangeToText,options:{from:-1/0,to:0,result:{color:Jt}}}];const Je=vt.getLevels(),Nn=Je.length?Je[0][0].value:0,xn=Je.length?Je[0][0].valueRight:void 0;for(let Fn in nn){dt.values.push(null),wt.values.push(Fn);const wn=nn[Fn].total,Wn=nn[Fn].totalRight,da=Nn-xn,oa=Math.round(1e4*wn/da)/100,_n=Math.round(1e4*Wn/xn)/100,Wa=(_n-oa)/oa*100;Kt.values.push(Wa),yt.values.push(oa),At.values.push(_n)}en={fields:[dt,wt,yt,At,Kt],length:wt.values.length}}else{const yt=Qt("Self",vt.selfField.config.unit),At=Qt("Total",vt.valueField.config.unit);for(let Kt in nn)dt.values.push(null),wt.values.push(Kt),yt.values.push(nn[Kt].self),At.values.push(nn[Kt].total);en={fields:[dt,wt,yt,At],length:wt.values.length}}return(0,qe.we)({data:[en],fieldConfig:{defaults:{},overrides:[]},replaceVariables:yt=>yt,theme:Vt})[0]}function Qt(vt,nn){const cn={width:g,align:"auto",inspect:!1,cellOptions:{type:Ft.ob.Auto}};return{type:pt.PU.number,name:vt,values:[],config:{unit:nn,custom:cn}}}const an=61;function gn(vt,nn,cn,mt){const lt={type:Ft.ob.Custom,cellComponent:Vt=>s.createElement(ut,{frame:Vt.frame,onSandwich:vt,onSearch:nn,search:cn,sandwichItem:mt,rowIndex:Vt.rowIndex})},Tt={filterable:!1,width:an,hideHeader:!0,inspect:!1,align:"auto",cellOptions:lt};return{type:pt.PU.number,name:"actions",values:[],config:{custom:Tt}}}function ut(vt){const nn=ht(),cn=vt.frame.fields.find(Tt=>Tt.name==="Symbol")?.values[vt.rowIndex],mt=vt.search===cn,lt=vt.sandwichItem===cn;return s.createElement("div",{className:nn.actionCellWrapper},s.createElement(we.K,{className:nn.actionCellButton,name:"search",variant:mt?"primary":"secondary",tooltip:mt?"Clear from search":"Search for symbol","aria-label":mt?"Clear from search":"Search for symbol",onClick:()=>{vt.onSearch(mt?"":cn)}}),s.createElement(we.K,{className:nn.actionCellButton,name:"gf-show-context",tooltip:lt?"Remove from sandwich view":"Show in sandwich view",variant:lt?"primary":"secondary","aria-label":lt?"Remove from sandwich view":"Show in sandwich view",onClick:()=>{vt.onSandwich(lt?void 0:cn)}}))}const Nt=vt=>({topTableContainer:(0,t.css)({label:"topTableContainer",padding:vt.spacing(1),backgroundColor:vt.colors.background.secondary,height:"100%"})}),ht=()=>({actionCellWrapper:(0,t.css)({label:"actionCellWrapper",display:"flex",height:"24px"}),actionCellButton:(0,t.css)({label:"actionCellButton",marginRight:0,width:"24px"})}),Rt=Xt,_t=new n.A,on=({data:vt,onTableSymbolClick:nn,onViewSelected:cn,onTextAlignSelected:mt,onTableSort:lt,getTheme:Tt,stickyHeader:Vt,extraHeaderElements:zt,vertical:rn,showFlameGraphOnly:mn,disableCollapsing:dt,getExtraContextMenuButtons:wt})=>{const[en,En]=(0,s.useState)(),[yt,At]=(0,s.useState)(0),[Kt,Jt]=(0,s.useState)(1),[Mt,Je]=(0,s.useState)(""),[Nn,xn]=(0,s.useState)(L.F8.Both),[Fn,{width:wn}]=(0,r.A)(),[Wn,da]=(0,s.useState)("left"),[oa,_n]=(0,s.useState)(),[Wa,za]=(0,s.useState)(new gt.S6),_a=(0,s.useMemo)(()=>Tt(),[Tt]),Xa=(0,s.useMemo)(()=>{if(!vt)return;const ps=new gt.Jz(vt,{collapsing:!dt},_a);return za(ps.getCollapsedMap()),ps},[vt,_a,dt]),[Va,Cs]=ln(Xa),ns=In(_a),Is=bn(Mt,Xa);(0,s.useEffect)(()=>{wn>0&&wn<E&&Nn===L.F8.Both&&!rn&&xn(L.F8.FlameGraph)},[Nn,xn,wn,rn]);const ls=(0,s.useCallback)(()=>{En(void 0),At(0),Jt(1)},[En,Jt,At]);function ss(){_n(void 0)}(0,s.useEffect)(()=>{ls(),ss()},[vt,ls]);const Fs=(0,s.useCallback)(ps=>{Mt===ps?Je(""):(nn?.(ps),Je(ps),ls())},[Je,ls,nn,Mt]);if(!Xa)return null;const Ts=s.createElement(Xe,{data:Xa,rangeMin:yt,rangeMax:Kt,matchedLabels:Is,setRangeMin:At,setRangeMax:Jt,onItemFocused:ps=>En(ps),focusedItemData:en,textAlign:Wn,sandwichItem:oa,onSandwich:ps=>{ls(),_n(ps)},onFocusPillClick:ls,onSandwichPillClick:ss,colorScheme:Va,showFlameGraphOnly:mn,collapsing:!dt,getExtraContextMenuButtons:wt,selectedView:Nn,search:Mt,collapsedMap:Wa,setCollapsedMap:za}),Es=s.createElement(Rt,{data:Xa,onSymbolClick:Fs,search:Mt,matchedLabels:Is,sandwichItem:oa,onSandwich:_n,onSearch:Je,onTableSort:lt,colorScheme:Va});let gs;return mn||Nn===L.F8.FlameGraph?gs=Ts:Nn===L.F8.TopTable?gs=s.createElement("div",{className:ns.tableContainer},Es):Nn===L.F8.Both&&(rn?gs=s.createElement("div",null,s.createElement("div",{className:ns.verticalGraphContainer},Ts),s.createElement("div",{className:ns.verticalTableContainer},Es)):gs=s.createElement("div",{className:ns.horizontalContainer},s.createElement("div",{className:ns.horizontalTableContainer},Es),s.createElement("div",{className:ns.horizontalGraphContainer},Ts))),s.createElement(o.D.Provider,{value:_a},s.createElement("div",{ref:Fn,className:ns.container},!mn&&s.createElement(rt,{search:Mt,setSearch:Je,selectedView:Nn,setSelectedView:ps=>{xn(ps),cn?.(ps)},containerWidth:wn,onReset:()=>{ls(),ss()},textAlign:Wn,onTextAlignChange:ps=>{da(ps),mt?.(ps)},showResetButton:!!(en||oa),colorScheme:Va,onColorSchemeChange:Cs,stickyHeader:!!Vt,extraHeaderElements:zt,vertical:rn,isDiffMode:Xa.isDiffFlamegraph(),setCollapsedMap:za,collapsedMap:Wa}),s.createElement("div",{className:ns.body},gs)))};function ln(vt){const nn=vt?.isDiffFlamegraph()?L.yU.Default:L.zM.PackageBased,[cn,mt]=(0,s.useState)(nn);return(0,s.useEffect)(()=>{mt(nn)},[nn]),[cn,mt]}function bn(vt,nn){return(0,s.useMemo)(()=>{if(vt&&nn){const cn=new Set;let mt=_t.filter(nn.getUniqueLabels(),vt);if(mt)for(let lt of mt)cn.add(nn.getUniqueLabels()[lt]);return cn}},[vt,nn])}function In(vt){return{container:(0,t.css)({label:"container",overflow:"auto",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0,gap:vt.spacing(1)}),body:(0,t.css)({label:"body",flexGrow:1}),tableContainer:(0,t.css)({height:800}),horizontalContainer:(0,t.css)({label:"horizontalContainer",display:"flex",minHeight:0,flexDirection:"row",columnGap:vt.spacing(1),width:"100%"}),horizontalGraphContainer:(0,t.css)({flexBasis:"50%"}),horizontalTableContainer:(0,t.css)({flexBasis:"50%",maxHeight:800}),verticalGraphContainer:(0,t.css)({marginBottom:vt.spacing(1)}),verticalTableContainer:(0,t.css)({height:800})}}const Mn=on},5546:(G,I,e)=>{"use strict";e.d(I,{F8:()=>n,Zk:()=>t,yU:()=>r,zM:()=>s});var t=(o=>(o.Bytes="bytes",o.Short="short",o.Nanoseconds="ns",o))(t||{}),n=(o=>(o.TopTable="topTable",o.FlameGraph="flameGraph",o.Both="both",o))(n||{}),s=(o=>(o.ValueBased="valueBased",o.PackageBased="packageBased",o))(s||{}),r=(o=>(o.Default="default",o.DiffColorBlind="diffColorBlind",o))(r||{})},80822:(G,I,e)=>{"use strict";e.d(I,{Wn:()=>o,_k:()=>r});var t=e(41260),n=e(11261),s=e(21423);function r(c,y){const f=o({data:c.series},{data:y.series}).data;return{...c,series:f}}function o(c,y){if(!c)return u(y);y.data.forEach(E=>{const g=c.data.find(h=>p(h,E));if(!g){c.data.push(d(E));return}m(g,E)});const f=[...c.errors??[],...y.errors??[]];f.length>0&&(c.errors=f);const P=c.error??y.error;P!=null&&(c.error=P);const a=[...c.traceIds??[],...y.traceIds??[]];return a.length>0&&(c.traceIds=a),c}function m(c,y){const f=Math.max(c.fields.length,y.fields.length);for(let P=0;P<f;P++){if(!c.fields[P])continue;const a=c.fields[P].name?y.fields.find(E=>E.name===c.fields[P].name):y.fields[P];if(a&&(c.fields[P].values=[].concat.apply(a.values,c.fields[P].values),a.nanos)){const E=c.fields[P].nanos?.slice()||[];c.fields[P].nanos=y.fields[P].nanos?.concat(E)}}c.length+=y.length,c.meta={...c.meta,stats:i(c.meta?.stats??[],y.meta?.stats??[])}}const l="Summary: total bytes processed";function i(c,y){const f=c.find(E=>E.displayName===l),P=y.find(E=>E.displayName===l);if(P!=null&&f!=null)return[{value:P.value+f.value,displayName:l,unit:f.unit}];const a=P??f;return a!=null?[a]:[]}function u(c){return{...c,data:c.data.map(d)}}function d(c){return{...c,fields:c.fields.map(y=>({...y,values:y.values}))}}function p(c,y){if(c.refId!==y.refId)return!1;const f=c.meta?.type,P=y.meta?.type;if(f!==P)return!1;if(f===t.m.TimeSeriesMulti){const g=c.fields.find(D=>D.type===n.PU.number),h=y.fields.find(D=>D.type===n.PU.number);return g===void 0||h===void 0?!1:(0,s.ab)(g.labels??{},h.labels??{})}const a=c.meta?.custom?.frameType,E=y.meta?.custom?.frameType;return a==="LabeledTimeValues"&&E==="LabeledTimeValues"?!0:a===E}},80937:(G,I,e)=>{"use strict";e.d(I,{t:()=>r});var t=e(84555),n=e(32370),s=e(76040);function r(u,d,p,c="="){if(!d||!p)throw new Error("Need label to add to query.");const y=o(u);if(!y.length)return u;const f=m(d,p,c);return l(u,y,f)}function o(u){const d=t.K3.parse(u),p=[];return d.iterate({enter:({to:c,from:y,type:f})=>{if(f.id===t.Fb){const P=(0,s.u)(u.substring(y,c));return p.push({query:P.query,from:y,to:c}),!1}}}),p}function m(u,d,p){const c=d===1/0?"+Inf":d.toString();return{label:u,op:p,value:c}}function l(u,d,p){const c=new n.l;let y="",f=0;for(let P=0;P<d.length;P++){const a=d[P],E=P===d.length-1,g=u.substring(f,a.from),h=E?u.substring(a.to):"";i(a.query.labels,p)||a.query.labels.push(p);const D=c.renderQuery(a.query);y+=g+D+h,f=a.to}return y}function i(u,d){return u.find(p=>p.label===d.label&&p.value===d.value)}},57225:(G,I,e)=>{"use strict";e.d(I,{L:()=>cn});var t=e(32196),n=e(96540),s=e(14236),r=e(13544),o=e(14110),m=e(14578),l=e(55852),i=e(40845),u=e(52363);const d=mt=>{const{children:lt,storageKey:Tt,defaultValue:Vt}=mt,[zt,rn]=(0,n.useState)({value:u.A.getObject(mt.storageKey,mt.defaultValue)});(0,n.useEffect)(()=>{const wt=en=>{en.key===Tt&&rn({value:u.A.getObject(mt.storageKey,mt.defaultValue)})};return window.addEventListener("storage",wt),()=>{window.removeEventListener("storage",wt)}});const mn=wt=>{try{u.A.setObject(Tt,wt)}catch(en){console.error(en)}rn({value:wt})},dt=()=>{try{u.A.delete(Tt)}catch(wt){console.log(wt)}rn({value:Vt})};return n.createElement(n.Fragment,null,lt(zt.value,mn,dt))};function p(mt){return typeof mt=="object"&&mt!==null&&"isCanceled"in mt}const c=mt=>{let lt=!1;return{promise:new Promise((Vt,zt)=>{const rn={isCanceled:!0};mt.then(mn=>lt?zt(rn):Vt(mn)),mt.catch(mn=>zt(lt?rn:mn))}),cancel(){lt=!0}}};var y=e(81996),f=e(91793),P=e(3911),a=e(39558),E=e(66864),g=e(60029),h=e(10354),D=e(54438);const v="{}",C="__name__",T=25;function S(mt){let lt="";const Tt=[];for(const Vt of mt)if((Vt.name===C||Vt.selected)&&Vt.values&&Vt.values.length>0){const zt=Vt.values.filter(rn=>rn.selected).map(rn=>rn.name);zt.length>1?Tt.push(`${Vt.name}=~"${zt.map(y.Cs).join("|")}"`):zt.length===1&&(Vt.name===C?lt=zt[0]:Tt.push(`${Vt.name}="${(0,y.Qn)(zt[0])}"`))}return[lt,"{",Tt.join(","),"}"].join("")}function O(mt,lt,Tt){return mt.map(Vt=>{const zt=lt[Vt.name];if(zt){let rn;if(Vt.name===Tt&&Vt.values)rn=Vt.values;else{const mn=new Set(Vt.values?.filter(dt=>dt.selected).map(dt=>dt.name)||[]);rn=zt.map(dt=>({name:dt,selected:mn.has(dt)}))}return{...Vt,loading:!1,values:rn,hidden:!zt,facets:rn.length}}return{...Vt,loading:!1,hidden:!zt,values:void 0,facets:0}})}const x=(0,P.N)(mt=>({wrapper:(0,t.css)({backgroundColor:mt.colors.background.secondary,padding:mt.spacing(1),width:"100%"}),list:(0,t.css)({marginTop:mt.spacing(1),display:"flex",flexWrap:"wrap",maxHeight:"200px",overflow:"auto",alignContent:"flex-start"}),section:(0,t.css)({"& + &":{margin:`${mt.spacing(2)} 0`},position:"relative"}),selector:(0,t.css)({fontFamily:mt.typography.fontFamilyMonospace,marginBottom:mt.spacing(1)}),status:(0,t.css)({padding:mt.spacing(.5),color:mt.colors.text.secondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",position:"absolute",width:"50%",right:0,textAlign:"right",opacity:0,[mt.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 100ms linear"}}),statusShowing:(0,t.css)({opacity:1}),error:(0,t.css)({color:mt.colors.error.main}),valueList:(0,t.css)({marginRight:mt.spacing(1),resize:"horizontal"}),valueListWrapper:(0,t.css)({borderLeft:`1px solid ${mt.colors.border.medium}`,margin:`${mt.spacing(1)} 0`,padding:`${mt.spacing(1)} 0 ${mt.spacing(1)} ${mt.spacing(1)}`}),valueListArea:(0,t.css)({display:"flex",flexWrap:"wrap",marginTop:mt.spacing(1)}),valueTitle:(0,t.css)({marginLeft:`-${mt.spacing(.5)}`,marginBottom:mt.spacing(1)}),validationStatus:(0,t.css)({padding:mt.spacing(.5),marginBottom:mt.spacing(1),color:mt.colors.text.maxContrast,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"})}));class b extends n.Component{constructor(){super(...arguments),this.valueListsRef=n.createRef(),this.state={labels:[],labelSearchTerm:"",metricSearchTerm:"",status:"Ready",error:"",validationStatus:"",valueSearchTerm:""},this.onChangeLabelSearch=lt=>{this.setState({labelSearchTerm:lt.target.value})},this.onChangeMetricSearch=lt=>{this.setState({metricSearchTerm:lt.target.value})},this.onChangeValueSearch=lt=>{this.setState({valueSearchTerm:lt.target.value})},this.onClickRunQuery=()=>{const lt=S(this.state.labels);this.props.onChange(lt)},this.onClickRunRateQuery=()=>{const Tt=`rate(${S(this.state.labels)}[$__rate_interval])`;this.props.onChange(Tt)},this.onClickClear=()=>{this.setState(lt=>({labels:lt.labels.map(Vt=>({...Vt,values:void 0,selected:!1,loading:!1,hidden:!1,facets:void 0})),labelSearchTerm:"",metricSearchTerm:"",status:"",error:"",validationStatus:"",valueSearchTerm:""})),this.props.deleteLastUsedLabels(),this.fetchValues(C,v)},this.onClickLabel=(lt,Tt,Vt)=>{const zt=this.state.labels.find(dt=>dt.name===lt);if(!zt)return;const rn=!zt.selected;let mn={selected:rn};if(zt.values&&!rn){const dt=zt.values.map(wt=>({...wt,selected:!1}));mn={...mn,facets:0,values:dt}}this.setState({labelSearchTerm:""}),this.updateLabelState(lt,mn,"",()=>this.doFacettingForLabel(lt))},this.onClickValue=(lt,Tt,Vt)=>{const zt=this.state.labels.find(mn=>mn.name===lt);if(!zt||!zt.values)return;this.setState({labelSearchTerm:""});const rn=zt.values.map(mn=>({...mn,selected:mn.name===Tt?!mn.selected:mn.selected}));this.updateLabelState(lt,{values:rn},"",()=>this.doFacetting(lt))},this.onClickMetric=(lt,Tt,Vt)=>{const zt=this.state.labels.find(dt=>dt.name===lt);if(!zt||!zt.values)return;this.setState({metricSearchTerm:""});const rn=zt.values.map(dt=>({...dt,selected:dt.name===Tt||dt.selected?!dt.selected:dt.selected})),mn=rn.some(dt=>dt.selected);this.updateLabelState(lt,{selected:mn,values:rn},"",()=>this.doFacetting(lt))},this.onClickValidate=()=>{const lt=S(this.state.labels);this.validateSelector(lt)},this.doFacetting=lt=>{const Tt=S(this.state.labels);if(Tt===v){const Vt=this.state.labels.map(zt=>({...zt,facets:0,values:void 0,hidden:!1}));this.setState({labels:Vt},()=>{this.state.labels.forEach(zt=>(zt.selected||zt.name===C)&&this.fetchValues(zt.name,Tt))})}else this.fetchSeries(Tt,lt)}}updateLabelState(lt,Tt,Vt="",zt){this.setState(rn=>{const mn=rn.labels.map(wt=>wt.name===lt?{...wt,...Tt}:wt),dt=Vt?"":rn.error;return{labels:mn,status:Vt,error:dt,validationStatus:""}},zt)}componentDidMount(){const{languageProvider:lt,lastUsedLabels:Tt}=this.props;if(lt){const Vt=Tt;lt.start(this.props.timeRange).then(()=>{let zt=lt.getLabelKeys();this.fetchValues(C,v);const rn=zt.map((mn,dt,wt)=>({name:mn,selected:Vt.includes(mn),loading:!1}));this.setState({labels:rn},()=>{this.state.labels.forEach(mn=>{mn.selected&&this.fetchValues(mn.name,v)})})})}}doFacettingForLabel(lt){const Tt=this.state.labels.find(zt=>zt.name===lt);if(!Tt)return;const Vt=this.state.labels.filter(zt=>zt.selected).map(zt=>zt.name);this.props.storeLastUsedLabels(Vt),Tt.selected?Tt.values||this.fetchValues(lt,S(this.state.labels)):this.doFacetting()}async fetchValues(lt,Tt){const{languageProvider:Vt}=this.props;this.updateLabelState(lt,{loading:!0},`Fetching values for ${lt}`);try{let zt=await Vt.getLabelValues(lt);if(Tt!==S(this.state.labels)){this.updateLabelState(lt,{loading:!1});return}const rn=[],{metricsMetadata:mn}=Vt;for(const dt of zt){const wt={name:dt};if(lt===C&&mn){const en=mn[dt];en&&(wt.details=`(${en.type}) ${en.help}`)}rn.push(wt)}this.updateLabelState(lt,{values:rn,loading:!1})}catch(zt){console.error(zt)}}async fetchSeries(lt,Tt){const{languageProvider:Vt}=this.props;Tt&&this.updateLabelState(Tt,{loading:!0},`Facetting labels for ${lt}`);try{const zt=await Vt.fetchSeriesLabels(lt,!0);if(lt!==S(this.state.labels)){Tt&&this.updateLabelState(Tt,{loading:!1});return}if(Object.keys(zt).length===0){this.setState({error:`Empty results, no matching label for ${lt}`});return}const rn=O(this.state.labels,zt,Tt);this.setState({labels:rn,error:""}),Tt&&this.updateLabelState(Tt,{loading:!1})}catch(zt){console.error(zt)}}async validateSelector(lt){const{languageProvider:Tt}=this.props;this.setState({validationStatus:`Validating selector ${lt}`,error:""});const Vt=await Tt.fetchSeries(lt);this.setState({validationStatus:`Selector is valid (${Vt.length} series found)`})}render(){const{theme:lt}=this.props,{labels:Tt,labelSearchTerm:Vt,metricSearchTerm:zt,status:rn,error:mn,validationStatus:dt,valueSearchTerm:wt}=this.state,en=x(lt);if(Tt.length===0)return n.createElement("div",{className:en.wrapper},n.createElement(a._,{text:"Loading labels..."}));let En=Tt.find(Je=>Je.name===C);En&&zt&&(En={...En,values:En.values?.filter(Je=>Je.selected||Je.name.includes(zt))});let yt=Tt.filter(Je=>!Je.hidden&&Je.name!==C);Vt&&(yt=yt.filter(Je=>Je.selected||Je.name.includes(Vt)));let At=yt.filter(Je=>Je.selected&&Je.values);wt&&(At=At.map(Je=>({...Je,values:Je.values?.filter(Nn=>Nn.selected||Nn.name.includes(wt))})));const Kt=S(this.state.labels),Jt=Kt===v,Mt=En?.values?.length||0;return n.createElement("div",{className:en.wrapper},n.createElement(E.Gy,{align:"flex-start",spacing:"lg"},n.createElement("div",null,n.createElement("div",{className:en.section},n.createElement(g.J,{description:"Once a metric is selected only possible labels are shown."},"1. Select a metric"),n.createElement("div",null,n.createElement(h.p,{onChange:this.onChangeMetricSearch,"aria-label":"Filter expression for metric",value:zt,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.selectMetric})),n.createElement("div",{role:"list",className:en.valueListWrapper,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.metricList},n.createElement(f.Y1,{height:Math.min(450,Mt*T),itemCount:Mt,itemSize:T,itemKey:Je=>En.values[Je].name,width:300,className:en.valueList},({index:Je,style:Nn})=>{const xn=En?.values?.[Je];return xn?n.createElement("div",{style:Nn},n.createElement(D.J,{name:En.name,value:xn?.name,title:xn.details,active:xn?.selected,onClick:this.onClickMetric,searchTerm:zt})):null})))),n.createElement("div",null,n.createElement("div",{className:en.section},n.createElement(g.J,{description:"Once label values are selected, only possible label combinations are shown."},"2. Select labels to search in"),n.createElement("div",null,n.createElement(h.p,{onChange:this.onChangeLabelSearch,"aria-label":"Filter expression for label",value:Vt,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelNamesFilter})),n.createElement("div",{className:en.list,style:{height:120}},yt.map(Je=>n.createElement(D.J,{key:Je.name,name:Je.name,loading:Je.loading,active:Je.selected,hidden:Je.hidden,facets:Je.facets,onClick:this.onClickLabel,searchTerm:Vt})))),n.createElement("div",{className:en.section},n.createElement(g.J,{description:"Use the search field to find values across selected labels."},"3. Select (multiple) values for your labels"),n.createElement("div",null,n.createElement(h.p,{onChange:this.onChangeValueSearch,"aria-label":"Filter expression for label values",value:wt,"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelValuesFilter})),n.createElement("div",{className:en.valueListArea,ref:this.valueListsRef},At.map(Je=>n.createElement("div",{role:"list",key:Je.name,"aria-label":`Values for ${Je.name}`,className:en.valueListWrapper},n.createElement("div",{className:en.valueTitle},n.createElement(D.J,{name:Je.name,loading:Je.loading,active:Je.selected,hidden:Je.hidden,facets:Je.facets||Je.values?.length,onClick:this.onClickLabel})),n.createElement(f.Y1,{height:Math.min(200,T*(Je.values?.length||0)),itemCount:Je.values?.length||0,itemSize:28,itemKey:Nn=>Je.values[Nn].name,width:200,className:en.valueList},({index:Nn,style:xn})=>{const Fn=Je.values?.[Nn];return Fn?n.createElement("div",{style:xn},n.createElement(D.J,{name:Je.name,value:Fn?.name,active:Fn?.selected,onClick:this.onClickValue,searchTerm:wt})):null}))))))),n.createElement("div",{className:en.section},n.createElement(g.J,null,"4. Resulting selector"),n.createElement("div",{"aria-label":"selector",className:en.selector},Kt),dt&&n.createElement("div",{className:en.validationStatus},dt),n.createElement(E.Gy,null,n.createElement(l.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useQuery,"aria-label":"Use selector for query button",disabled:Jt,onClick:this.onClickRunQuery},"Use query"),n.createElement(l.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useAsRateQuery,"aria-label":"Use selector as metrics button",variant:"secondary",disabled:Jt,onClick:this.onClickRunRateQuery},"Use as rate query"),n.createElement(l.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.validateSelector,"aria-label":"Validate submit button",variant:"secondary",disabled:Jt,onClick:this.onClickValidate},"Validate selector"),n.createElement(l.$n,{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.clear,"aria-label":"Selector clear button",variant:"secondary",onClick:this.onClickClear},"Clear"),n.createElement("div",{className:(0,t.cx)(en.status,(rn||mn)&&en.statusShowing)},n.createElement("span",{className:mn?en.error:""},mn||rn)))))}}const M=(0,i.cV)(b);var A=e(84555),R=e(2543),B=e(75357),U=e(39554),W=e(62938),N=e(85828);function w(){const mt=new Map;return mt.set("expandSuggestionDocs","true"),{onDidChangeValue:lt=>{},onDidChangeTarget:lt=>{},onWillSaveState:lt=>{},get:(lt,Tt,Vt)=>mt.get(lt)??Vt,getBoolean:(lt,Tt,Vt)=>{const zt=mt.get(lt);return zt!==void 0?zt==="true":Vt},getNumber:(lt,Tt,Vt)=>{const zt=mt.get(lt);return zt!==void 0?parseInt(zt,10):Vt},store:(lt,Tt,Vt,zt)=>{Tt==null?mt.delete(lt):mt.set(lt,Tt.toString())},remove:(lt,Tt)=>{mt.delete(lt)},keys:(lt,Tt)=>Array.from(mt.keys()),logStorage:()=>{console.log("logStorage: not implemented")},migrate:()=>Promise.resolve(void 0),isNew:lt=>!0,flush:lt=>Promise.resolve(void 0)}}let L=null;function V(){return L===null&&(L={storageService:w()}),L}var K=e(53076),k=e(32264),j=e(20719);class H extends Error{constructor(lt){super("should never happen")}}const J=new K.A({intraMode:1});function X(mt){let lt=mt.getAllMetricNames();if(k.$.featureToggles.prometheusCodeModeMetricNamesSearch&&lt.length>mt.metricNamesSuggestionLimit){const{monacoSettings:Tt}=mt;Tt.enableAutocompleteSuggestionsUpdate(),Tt.inputInRange?lt=J.filter(lt,Tt.inputInRange)?.slice(0,mt.metricNamesSuggestionLimit).map(Vt=>lt[Vt])??[]:lt=lt.slice(0,mt.metricNamesSuggestionLimit)}return mt.metricNamesToMetrics(lt).map(Tt=>({type:"METRIC_NAME",label:Tt.name,insertText:Tt.name,detail:`${Tt.name} : ${Tt.type}`,documentation:Tt.help}))}const se=j.AW.map(mt=>({type:"FUNCTION",label:mt.label,insertText:mt.insertText??"",detail:mt.detail,documentation:mt.documentation}));async function ae(mt){const lt=X(mt);return[...se,...lt]}const ne=["$__interval","$__range","$__rate_interval","1m","5m","10m","30m","1h","1d"].map(mt=>({type:"DURATION",label:mt,insertText:mt}));function q(mt){return mt.getHistory().slice(0,10).map(Tt=>({type:"HISTORY",label:Tt,insertText:Tt}))}function ee(mt,lt){const Tt=[...lt];return mt!==void 0&&Tt.push({name:"__name__",value:mt,op:"="}),`{${Tt.map(zt=>`${zt.name}${zt.op}"${(0,y.Qn)(zt.value)}"`).join(",")}}`}async function z(mt,lt,Tt){if(mt===void 0&&lt.length===0)return Promise.resolve(Tt.getAllLabelNames());{const Vt=ee(mt,lt);return await Tt.getSeriesLabels(Vt,lt)}}async function te(mt,lt,Tt,Vt,zt){return(await z(mt,Vt,zt)).map(mn=>({type:"LABEL_NAME",label:mn,insertText:`${mn}${lt}`,triggerOnInsert:Tt}))}async function ie(mt,lt,Tt){return te(mt,"=",!0,lt,Tt)}async function ce(mt,lt,Tt){return te(mt,"",!1,lt,Tt)}async function ue(mt,lt,Tt,Vt){if(mt===void 0&&Tt.length===0)return Vt.getLabelValues(lt);{const zt=ee(mt,Tt);return await Vt.getSeriesValues(lt,zt)}}async function fe(mt,lt,Tt,Vt,zt){return(await ue(mt,lt,Vt,zt)).map(mn=>({type:"LABEL_VALUE",label:mn,insertText:Tt?mn:`"${mn}"`}))}function Te(mt,lt){switch(mt.type){case"IN_DURATION":return Promise.resolve(ne);case"IN_FUNCTION":return ae(lt);case"AT_ROOT":return ae(lt);case"EMPTY":{const Tt=X(lt),Vt=q(lt);return Promise.resolve([...Vt,...se,...Tt])}case"IN_LABEL_SELECTOR_NO_LABEL_NAME":return ie(mt.metricName,mt.otherLabels,lt);case"IN_GROUPING":return ce(mt.metricName,mt.otherLabels,lt);case"IN_LABEL_SELECTOR_WITH_LABEL_NAME":return fe(mt.metricName,mt.labelName,mt.betweenQuotes,mt.otherLabels,lt);default:throw new H(mt)}}function he(mt,lt){switch(lt){case"parent":return mt.parent;case"firstChild":return mt.firstChild;case"lastChild":return mt.lastChild;case"nextSibling":return mt.nextSibling;default:throw new H(lt)}}function de(mt,lt){let Tt=mt;for(const[Vt,zt]of lt)if(Tt=he(Tt,Vt),Tt===null||Tt.type.id!==zt)return null;return Tt}function le(mt,lt){return lt.slice(mt.from,mt.to)}function pe(mt){const lt=mt.slice(1,mt.length-1);if(mt.startsWith('"')&&mt.endsWith('"'))return lt.replace(/\\"/,'"');if(mt.startsWith("'")&&mt.endsWith("'"))return lt.replace(/\\'/,"'");if(mt.startsWith("`")&&mt.endsWith("`"))return lt;throw new Error("FIXME: invalid string literal")}function ve(mt,lt){return mt.every((Tt,Vt)=>Tt===lt[Vt])}const be=0,Oe=[{path:[A.ww,A.Fb],fun:nt},{path:[A.ab],fun:Xe},{path:[A.Dh],fun:gt},{path:[A.LW,A.BG],fun:$e},{path:[be,A.df,A.ab],fun:Xe},{path:[be,A.BG],fun:$e},{path:[be,A.l4],fun:Dt},{path:[A.x$],fun:Ve}],Me=new Map([[A.Hl,"="],[A.Ed,"=~"],[A.l3,"!="],[A.$i,"!~"]]);function Ue(mt){const lt=mt.firstChild;return lt===null?null:Me.get(lt.type.id)??null}function we(mt,lt){if(mt.type.id!==A.BG)return null;const Tt=de(mt,[["firstChild",A.IC]]);if(Tt===null)return null;const Vt=de(Tt,[["nextSibling",A.Lf]]);if(Vt===null)return null;const zt=Ue(Vt);if(zt===null)return null;const rn=de(mt,[["lastChild",A.LW]]);if(rn===null)return null;const mn=le(Tt,lt),dt=pe(le(rn,lt));return{name:mn,value:dt,op:zt}}function Re(mt,lt){return mt.type.id!==A.ww?[]:mt.getChildren(A.BG).map(Vt=>we(Vt,lt)).filter(re)}function Fe(mt){let lt=mt.firstChild;const Tt=[];for(;lt!==null;)Tt.push(lt),lt=lt.nextSibling;return Tt}function xe(mt,lt){if(mt.type.id===lt)return mt;const Tt=Fe(mt);for(const Vt of Tt){const zt=xe(Vt,lt);if(zt!==null)return zt}return null}function Ve(mt,lt,Tt){const Vt=de(mt,[["parent",A.hI],["parent",A.Fn]]);if(Vt===null)return null;const zt=Vt.getChild(A.Dh);if(zt===null)return null;const rn=xe(zt,A.gw);return rn===null?null:{type:"IN_GROUPING",metricName:le(rn,lt),otherLabels:[]}}function $e(mt,lt,Tt){const Vt=!mt.type.isError,zt=de(mt,[["parent",A.BG]]);if(zt===null)return null;const rn=de(zt,[["firstChild",A.IC]]);if(rn===null)return null;const mn=le(rn,lt),dt=de(zt,[["parent",A.ww]]);if(dt===null)return null;const en=Re(dt,lt).filter(At=>At.name!==mn),En=de(dt,[["parent",A.Fb],["firstChild",A.gw]]);return En===null?{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",labelName:mn,betweenQuotes:Vt,otherLabels:en}:{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",metricName:le(En,lt),labelName:mn,betweenQuotes:Vt,otherLabels:en}}function Xe(mt,lt,Tt){return{type:"AT_ROOT"}}function gt(mt,lt,Tt){return{type:"IN_FUNCTION"}}function Dt(mt,lt,Tt){return{type:"IN_DURATION"}}function nt(mt,lt,Tt){const Vt=de(mt,[["firstChild",A.BG]]);if(Vt!==null&&!lt.slice(Vt.to,Tt).includes(","))return null;const zt=de(mt,[["parent",A.Fb],["firstChild",A.gw]]),rn=Re(mt,lt);return zt===null?{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",otherLabels:rn}:{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",metricName:le(zt,lt),otherLabels:rn}}function at(mt,lt){const Tt=mt.cursorAt(lt);for(;;){if(Tt.from===lt&&Tt.to===lt){const{node:Vt}=Tt;if(Vt.type.isError)return Vt}if(!Tt.next())break}return null}function Ae(mt,lt){if(mt==="")return{type:"EMPTY"};const Tt=A.K3.parse(mt),Vt=at(Tt,lt),zt=Vt!=null?Vt.cursor():Tt.cursorAt(lt),rn=zt.node,mn=[zt.type.id];for(;zt.parent();)mn.push(zt.type.id);for(let dt of Oe)if(ve(dt.path,mn))return dt.fun(rn,mt,lt);return null}function re(mt){return mt!=null}function Z(){return{showWords:!1}}function oe(mt,lt){switch(mt){case"DURATION":return lt.languages.CompletionItemKind.Unit;case"FUNCTION":return lt.languages.CompletionItemKind.Variable;case"HISTORY":return lt.languages.CompletionItemKind.Snippet;case"LABEL_NAME":return lt.languages.CompletionItemKind.Enum;case"LABEL_VALUE":return lt.languages.CompletionItemKind.EnumMember;case"METRIC_NAME":return lt.languages.CompletionItemKind.Constructor;default:throw new H(mt)}}function Ee(mt,lt){return{triggerCharacters:["{",",","[","(","=","~"," ",'"'],provideCompletionItems:(Vt,zt)=>{const rn=Vt.getWordAtPosition(zt),mn=rn!=null?mt.Range.lift({startLineNumber:zt.lineNumber,endLineNumber:zt.lineNumber,startColumn:rn.startColumn,endColumn:rn.endColumn}):mt.Range.fromPositions(zt),dt={column:zt.column,lineNumber:zt.lineNumber};if(lt.monacoSettings.setInputInRange(Vt.getValueInRange(mn)),window.getSelection){const yt=window.getSelection()?.toString();yt&&yt.length>0&&(dt.column=dt.column-yt.length)}const wt=Vt.getOffsetAt(dt),en=Ae(Vt.getValue(),wt);return(en!=null?Te(en,lt):Promise.resolve([])).then(yt=>{const At=yt.length.toString().length;return{suggestions:yt.map((Jt,Mt)=>({kind:oe(Jt.type,mt),label:Jt.label,insertText:Jt.insertText,detail:Jt.detail,documentation:Jt.documentation,sortText:Mt.toString().padStart(At,"0"),range:mn,command:Jt.triggerOnInsert?{id:"editor.action.triggerSuggest",title:""}:void 0})),incomplete:lt.monacoSettings.suggestionsIncomplete}})}}}var ye=e(91306);const Se=0;function Be(mt,lt,Tt,Vt){if(!mt)return!1;const zt=We(lt,Vt);if(!zt.length)return!1;let rn=zt;if(mt!==lt){const mn=We(mt,Vt);rn=zt.flatMap(dt=>mn.filter(wt=>dt.text===wt.text)||dt)}return rn.map(mn=>Ke(mt,Tt,mn)).filter(it)}function We(mt,lt){const Tt=[];return lt.parse(mt).iterate({enter:zt=>{if(zt.type.id===Se){const rn=zt.node;Tt.push({node:rn,text:mt.substring(rn.from,rn.to)})}}}),Tt}function Ke(mt,lt,Tt){if(lt.length===1){const rn=Tt.node.from===Tt.node.to,mn=rn&&Tt.node.parent?Tt.node.parent:Tt.node,dt=rn?mt.substring(mn.from,mn.to):Tt.text;return{startLineNumber:1,startColumn:mn.from+1,endLineNumber:1,endColumn:mn.to+1,error:dt}}let Vt=0,zt=0;for(let rn=0;rn<lt.length;rn++){if(zt=Vt+lt[rn].length,Tt.node.from>zt){Vt+=lt[rn].length+1;continue}return{startLineNumber:rn+1,startColumn:Tt.node.from-Vt+1,endLineNumber:rn+1,endColumn:Tt.node.to-Vt+1,error:Tt.text}}return null}function it(mt){return mt!==null}const rt={__interval:{text:"1s",value:"1s"},__rate_interval:{text:"1s",value:"1s"},__auto:{text:"1s",value:"1s"},__interval_ms:{text:"1000",value:1e3},__range_ms:{text:"1000",value:1e3},__range_s:{text:"1",value:1},__range:{text:"1s",value:"1s"}},ft={wordPattern:/(-?\d*\.\d\w*)|([^`~!#%^&*()\-=+\[{\]}\\|;:'",.<>\/?\s]+)/g,comments:{lineComment:"#"},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"<",close:">"}],folding:{}},pt=["sum","min","max","avg","group","stddev","stdvar","count","count_values","bottomk","topk","quantile"],Ge=["abs","absent","ceil","changes","clamp_max","clamp_min","day_of_month","day_of_week","days_in_month","delta","deriv","exp","floor","histogram_quantile","histogram_avg","histogram_count","histogram_sum","histogram_fraction","histogram_stddev","histogram_stdvar","holt_winters","hour","idelta","increase","irate","label_join","label_replace","ln","log2","log10","minute","month","predict_linear","rate","resets","round","scalar","sort","sort_desc","sqrt","time","timestamp","vector","year"],qe=[];for(let mt=0,lt=pt;mt<lt.length;mt++){let Tt=lt[mt];qe.push(Tt+"_over_time")}const bt=["on","ignoring","group_right","group_left","by","without"],Ft="("+bt.reduce(function(mt,lt){return mt+"|"+lt})+")",Xt=["+","-","*","/","%","^","==","!=",">","<",">=","<=","and","or","unless"],Lt=["offset"],an={ignoreCase:!1,defaultToken:"",tokenPostfix:".promql",keywords:pt.concat(Ge).concat(qe).concat(bt).concat(Lt),operators:Xt,vectorMatching:Ft,symbols:/[=><!~?:&|+\-*\/^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,digits:/\d+(_+\d+)*/,octaldigits:/[0-7]+(_+[0-7]+)*/,binarydigits:/[0-1]+(_+[0-1]+)*/,hexdigits:/[[0-9a-fA-F]+(_+[0-9a-fA-F]+)*/,integersuffix:/(ll|LL|u|U|l|L)?(ll|LL|u|U|l|L)?/,floatsuffix:/[fFlL]?/,tokenizer:{root:[[/@vectorMatching\s*(?=\()/,"type","@clauses"],[/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,"tag"],[/(^#.*$)/,"comment"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":"type","@default":"identifier"}}],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"/,"string","@string_double"],[/'/,"string","@string_single"],[/`/,"string","@string_backtick"],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"delimiter","@default":""}}],[/\d+[smhdwy]/,"number"],[/\d*\d+[eE]([\-+]?\d+)?(@floatsuffix)/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?(@floatsuffix)/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F](@integersuffix)/,"number.hex"],[/0[0-7']*[0-7](@integersuffix)/,"number.octal"],[/0[bB][0-1']*[0-1](@integersuffix)/,"number.binary"],[/\d[\d']*\d(@integersuffix)/,"number"],[/\d(@integersuffix)/,"number"]],string_double:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],string_single:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,"string","@pop"]],string_backtick:[[/[^\\`$]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/`/,"string","@pop"]],clauses:[[/[^(,)]/,"tag"],[/\)/,"identifier","@pop"]],whitespace:[[/[ \t\r\n]+/,"white"]]}},gn={codeLens:!1,contextmenu:!1,fixedOverflowWidgets:!0,folding:!1,fontSize:14,lineDecorationsWidth:8,lineNumbers:"off",minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:4,bottom:5},renderLineHighlight:"none",scrollbar:{vertical:"hidden",verticalScrollbarSize:8,horizontal:"hidden",horizontalScrollbarSize:0,alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,suggest:Z(),suggestFontSize:12,wordWrap:"on"},ut=2,Nt=B.promLanguageDefinition.id;let ht=!1;function Rt(mt){if(ht===!1){ht=!0;const{aliases:lt,extensions:Tt,mimetypes:Vt}=B.promLanguageDefinition;mt.languages.register({id:Nt,aliases:lt,extensions:Tt,mimetypes:Vt}),mt.languages.setMonarchTokensProvider(Nt,an),mt.languages.setLanguageConfiguration(Nt,ft)}}const _t=(mt,lt)=>({container:(0,t.css)({borderRadius:mt.shape.radius.default,border:`1px solid ${mt.components.input.borderColor}`,display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",height:"100%"}),placeholder:(0,t.css)({"::after":{content:`'${lt}'`,fontFamily:mt.typography.fontFamilyMonospace,opacity:.6}})}),ln=mt=>{const lt=(0,W.A)(),Tt=(0,n.useRef)(V()),Vt=(0,n.useRef)(null),{languageProvider:zt,history:rn,onBlur:mn,onRunQuery:dt,initialValue:wt,placeholder:en,onChange:En,datasource:yt}=mt,At=(0,U.A)(zt),Kt=(0,U.A)(rn),Jt=(0,U.A)(dt),Mt=(0,U.A)(mn),Je=(0,U.A)(En),Nn=(0,n.useRef)(null),xn=(0,i.$j)(),Fn=_t(xn,en);return(0,n.useEffect)(()=>()=>{Nn.current?.()},[]),n.createElement("div",{"data-testid":r.Tp.components.QueryField.container,className:Fn.container,ref:Vt},n.createElement(N.m,{overrideServices:Tt.current,options:gn,language:"promql",value:wt,beforeMount:wn=>{Rt(wn)},onMount:(wn,Wn)=>{const da=wn.createContextKey("isEditorFocused"+lt,!1);wn.onDidBlurEditorWidget(()=>{da.set(!1),Mt.current(wn.getValue())}),wn.onDidFocusEditorText(()=>{da.set(!0)});const oa=new ye.M9({historyProvider:Kt.current,languageProvider:At.current}),_n=Ee(Wn,oa),Wa={..._n,provideCompletionItems:(Va,Cs,ns,Is)=>wn.getModel()?.id!==Va.id?{suggestions:[]}:_n.provideCompletionItems(Va,Cs,ns,Is)},{dispose:za}=Wn.languages.registerCompletionItemProvider(Nt,Wa);Nn.current=za;const _a=()=>{const Va=Vt.current;if(Va!==null){const Cs=wn.getContentHeight();Va.style.height=`${Cs+ut}px`,Va.style.width="100%";const ns=Va.clientWidth;wn.layout({width:ns,height:Cs})}};wn.onDidContentSizeChange(_a),_a();const Xa=(0,R.debounce)(()=>{const Va=wn.getValue();Je.current(Va)},At.current.datasource.getDebounceTimeInMilliseconds());if(wn.getModel()?.onDidChangeContent(()=>{Xa()}),wn.addCommand(Wn.KeyMod.Shift|Wn.KeyCode.Enter,()=>{Jt.current(wn.getValue())},"isEditorFocused"+lt),Wn.editor.addKeybindingRule({keybinding:Wn.KeyMod.CtrlCmd|Wn.KeyCode.KeyF,command:null}),wn.addCommand(Wn.KeyMod.CtrlCmd|Wn.KeyCode.KeyK,function(){e.g.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))}),en){const Va=[{range:new Wn.Range(1,1,1,1),options:{className:Fn.placeholder,isWholeLine:!0}}];let Cs=[];const ns=()=>{const Is=wn.getModel();if(!Is)return;const ls=Is.getValueLength()===0?Va:[];Cs=Is.deltaDecorations(Cs,ls)};ns(),wn.onDidChangeModelContent(ns),wn.onDidChangeModelContent(Is=>{const ls=wn.getModel();if(!ls)return;const ss=ls.getValue(),Ts=(Be(ss,yt.interpolateString(ss,rt),ls.getLinesContent(),A.K3)||[]).map(({error:Es,...gs})=>({message:`${Es?`Error parsing "${Es}"`:"Parse error"}. The query appears to be incorrect and could fail to be executed.`,severity:Wn.MarkerSeverity.Error,...gs}));Wn.editor.setModelMarkers(ls,"owner",Ts)})}}}))},bn=mt=>n.createElement(n.Suspense,{fallback:null},n.createElement(ln,{...mt})),In=mt=>{const lt=(0,n.useRef)(null),{onRunQuery:Tt,onChange:Vt,...zt}=mt,rn=wt=>{lt.current=wt,Vt(wt),Tt()},mn=wt=>{Vt(wt)},dt=wt=>{Vt(wt)};return n.createElement(bn,{onChange:dt,onRunQuery:rn,onBlur:mn,...zt})},Mn="grafana.datasources.prometheus.browser.labels";function vt(mt,lt,Tt){return mt?"(Disabled)":lt?Tt?"Metrics browser":"(No metrics found)":"Loading metrics..."}class nn extends n.PureComponent{constructor(lt){super(lt),this.refreshHint=()=>{const{datasource:Tt,query:Vt,data:zt}=this.props,rn=Tt.getInitHints(),mn=rn.length>0?rn[0]:null;if(!zt||zt.series.length===0){this.setState({hint:mn});return}const dt=(0,s.ci)(zt.series[0])?zt.series.map(s.w3):zt.series,wt=Tt.getQueryHints(Vt,dt);let en=wt.length>0?wt[0]:null;this.setState({hint:en??mn})},this.refreshMetrics=async()=>{const{range:Tt,datasource:{languageProvider:Vt}}=this.props;this.languageProviderInitializationPromise=c(Vt.start(Tt));try{const zt=await this.languageProviderInitializationPromise.promise;await Promise.all(zt),this.onUpdateLanguage()}catch(zt){if(!(p(zt)&&zt.isCanceled))throw zt}},this.onChangeLabelBrowser=Tt=>{this.onChangeQuery(Tt,!0),this.setState({labelBrowserVisible:!1})},this.onChangeQuery=(Tt,Vt)=>{const{query:zt,onChange:rn,onRunQuery:mn}=this.props;if(rn){const dt={...zt,expr:Tt};rn(dt),Vt&&mn&&mn()}},this.onClickChooserButton=()=>{this.setState(Tt=>({labelBrowserVisible:!Tt.labelBrowserVisible})),(0,o.rR)("user_grafana_prometheus_metrics_browser_clicked",{editorMode:this.state.labelBrowserVisible?"metricViewClosed":"metricViewOpen",app:this.props?.app??""})},this.onClickHintFix=()=>{const{datasource:Tt,query:Vt,onChange:zt,onRunQuery:rn}=this.props,{hint:mn}=this.state;mn?.fix?.action&&zt(Tt.modifyQuery(Vt,mn.fix.action)),rn()},this.onUpdateLanguage=()=>{const{datasource:{languageProvider:Tt}}=this.props,{metrics:Vt}=Tt;Vt&&this.setState({syntaxLoaded:!0})},this.state={labelBrowserVisible:!1,syntaxLoaded:!1,hint:null}}componentDidMount(){this.props.datasource.languageProvider&&this.refreshMetrics(),this.refreshHint()}componentWillUnmount(){this.languageProviderInitializationPromise&&this.languageProviderInitializationPromise.cancel()}componentDidUpdate(lt){const{data:Tt,datasource:{languageProvider:Vt},range:zt}=this.props;Vt!==lt.datasource.languageProvider&&this.setState({syntaxLoaded:!1});const rn=this.rangeChangedToRefresh(zt,lt.range);(Vt!==lt.datasource.languageProvider||rn)&&this.refreshMetrics(),Tt&&lt.data&&lt.data.series!==Tt.series&&this.refreshHint()}rangeChangedToRefresh(lt,Tt){if(lt&&Tt){const Vt=(0,y.eN)(lt.from.valueOf())===(0,y.eN)(Tt.from.valueOf()),zt=(0,y.eN)(lt.to.valueOf())===(0,y.eN)(Tt.to.valueOf());return!(Vt&&zt)}return!1}render(){const{datasource:lt,datasource:{languageProvider:Tt},query:Vt,ExtraFieldElement:zt,history:rn=[],theme:mn}=this.props,{labelBrowserVisible:dt,syntaxLoaded:wt,hint:en}=this.state,En=Tt.metrics.length>0,yt=vt(lt.lookupsDisabled,wt,En),At=!(wt&&En);return n.createElement(d,{storageKey:Mn,defaultValue:[]},(Kt,Jt,Mt)=>n.createElement(n.Fragment,null,n.createElement("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1","data-testid":this.props["data-testid"]},n.createElement("button",{className:"gf-form-label query-keyword pointer",onClick:this.onClickChooserButton,disabled:At,type:"button","data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.openButton},yt,n.createElement(m.I,{name:dt?"angle-down":"angle-right"})),n.createElement("div",{className:"flex-grow-1 min-width-15"},n.createElement(In,{languageProvider:Tt,history:rn,onChange:this.onChangeQuery,onRunQuery:this.props.onRunQuery,initialValue:Vt.expr??"",placeholder:"Enter a PromQL query\u2026",datasource:lt}))),dt&&n.createElement("div",{className:"gf-form"},n.createElement(M,{languageProvider:Tt,onChange:this.onChangeLabelBrowser,lastUsedLabels:Kt||[],storeLastUsedLabels:Jt,deleteLastUsedLabels:Mt,timeRange:this.props.range})),zt,en?n.createElement("div",{className:"query-row-break"},n.createElement("div",{className:"prom-query-field-info text-warning"},en.label," ",en.fix?n.createElement("button",{type:"button",className:(0,t.cx)((0,l.my)(mn),"text-link","muted"),onClick:this.onClickHintFix},en.fix.label):null)):null))}}const cn=(0,i.cV)(nn)},91306:(G,I,e)=>{"use strict";e.d(I,{M9:()=>s,Ol:()=>n,w0:()=>t});const t="codeModeSuggestionsIncomplete";function n(r){return r.type===t&&"detail"in r&&typeof r.detail=="object"&&r.detail!==null&&"limit"in r.detail&&"datasourceUid"in r.detail}class s{constructor(o){this.languageProvider=o.languageProvider,this.historyProvider=o.historyProvider,this.inputInRange="",this.metricNamesSuggestionLimit=this.languageProvider.datasource.metricNamesAutocompleteSuggestionLimit,this.suggestionsIncomplete=!1,this.getSeriesLabels=this.languageProvider.getSeriesLabels.bind(this.languageProvider),this.getSeriesValues=this.languageProvider.getSeriesValues.bind(this.languageProvider),this.getAllLabelNames=this.languageProvider.getLabelKeys.bind(this.languageProvider),this.getLabelValues=this.languageProvider.getLabelValues.bind(this.languageProvider)}getHistory(){return this.historyProvider.map(o=>o.query.expr).filter(Boolean)}getAllMetricNames(){return this.languageProvider.metrics}metricNamesToMetrics(o){const{metricsMetadata:m}=this.languageProvider;return o.map(i=>{const u=m?.[i];return{name:i,help:u?.help??"",type:u?.type??""}})}enableAutocompleteSuggestionsUpdate(){this.suggestionsIncomplete=!0,dispatchEvent(new CustomEvent(t,{detail:{limit:this.metricNamesSuggestionLimit,datasourceUid:this.languageProvider.datasource.uid}}))}setInputInRange(o){this.inputInRange=o}get monacoSettings(){return{enableAutocompleteSuggestionsUpdate:this.enableAutocompleteSuggestionsUpdate.bind(this),inputInRange:this.inputInRange,setInputInRange:this.setInputInRange.bind(this),suggestionsIncomplete:this.suggestionsIncomplete}}}},4936:(G,I,e)=>{"use strict";e.d(I,{TT:()=>l,Zh:()=>i,jW:()=>m,k1:()=>r});var t=e(32196),n=e(96540),s=e(72093);const r=30,o=u=>{const{options:d,onOptionsChange:p}=u,c=useTheme2(),y=i(c);return React.createElement(React.Fragment,null,d.access==="direct"&&React.createElement(Alert,{title:"Error",severity:"error"},"Browser access mode in the Prometheus data source is no longer available. Switch to server access mode."),React.createElement(DataSourceDescription,{dataSourceName:"Prometheus",docsLink:"https://grafana.com/docs/grafana/latest/datasources/prometheus/configure-prometheus-data-source/"}),React.createElement("hr",{className:`${y.hrTopSpace} ${y.hrBottomSpace}`}),React.createElement(DataSourceHttpSettingsOverhaul,{options:d,onOptionsChange:p,secureSocksDSProxyEnabled:config.secureSocksDSProxyEnabled}),React.createElement("hr",null),React.createElement(ConfigSection,{className:y.advancedSettings,title:"Advanced settings",description:"Additional settings are optional settings that can be configured for more control over your data source."},React.createElement(AdvancedHttpSettings,{className:y.advancedHTTPSettingsMargin,config:d,onChange:p}),React.createElement(AlertingSettingsOverhaul,{options:d,onOptionsChange:p}),React.createElement(PromSettings,{options:d,onOptionsChange:p})))};function m(u){return n.createElement("a",{href:u||"https://grafana.com/docs/grafana/latest/datasources/prometheus/#configure-the-data-source",target:"_blank",rel:"noopener noreferrer"},"Visit docs for more details here.")}const l=(u,d,p)=>{const c="Value is not valid";return u&&!u.match(d)?n.createElement(s.P,null,p||c):!0};function i(u){return{additionalSettings:(0,t.css)({marginBottom:"25px"}),secondaryGrey:(0,t.css)({color:u.colors.secondary.text,opacity:"65%"}),inlineError:(0,t.css)({margin:"0px 0px 4px 245px"}),switchField:(0,t.css)({alignItems:"center"}),sectionHeaderPadding:(0,t.css)({paddingTop:"32px"}),sectionBottomPadding:(0,t.css)({paddingBottom:"28px"}),subsectionText:(0,t.css)({fontSize:"12px"}),hrBottomSpace:(0,t.css)({marginBottom:"56px"}),hrTopSpace:(0,t.css)({marginTop:"50px"}),textUnderline:(0,t.css)({textDecoration:"underline"}),versionMargin:(0,t.css)({marginBottom:"12px"}),advancedHTTPSettingsMargin:(0,t.css)({margin:"24px 0 8px 0"}),advancedSettings:(0,t.css)({paddingTop:"32px"}),alertingTop:(0,t.css)({marginTop:"40px !important"}),overhaulPageHeading:(0,t.css)({fontWeight:400}),container:(0,t.css)({maxwidth:578})}}},75212:(G,I,e)=>{"use strict";e.d(I,{gs:()=>Xe,UD:()=>gt});var t=e(2543),n=e(13288),s=e(75505),r=e(81160),o=e(59099),m=e(97716),l=e.n(m),i=e(65879),u=e(43659),d=e(43127),p=e(47232),c=e(37891),y=e(41987),f=e(26657),P=e(72574),a=e(47773),E=e(17172),g=e(32264),h=e(80937),D=e(96540),v=e(13544),C=e(71087),T=e(9e4),S=e(81580),O=e(79458),x=e(51440),b=e(68402),M=e(10354),A=e(80109);function R(re){const Z=re.annotation,oe=re.onAnnotationChange,Ee={expr:Z.expr,refId:Z.name,interval:Z.step};return D.createElement(D.Fragment,null,D.createElement(C.D,null,D.createElement(A.$,{...re,query:Ee,showExplain:!1,onChange:ye=>{oe({...Z,expr:ye.expr})}}),D.createElement(T.U,null,D.createElement(S.c,{label:"Min step",tooltip:D.createElement(D.Fragment,null,"An additional lower limit for the step parameter of the Prometheus query and for the"," ",D.createElement("code",null,"$__interval")," and ",D.createElement("code",null,"$__rate_interval")," variables.")},D.createElement(x.D,{type:"text","aria-label":"Set lower limit for the step parameter",placeholder:"auto",minWidth:10,onCommitChange:ye=>{oe({...Z,step:ye.currentTarget.value})},defaultValue:Ee.interval,id:v.Tp.components.DataSource.Prometheus.annotations.minStep})))),D.createElement(b.$,{v:.5}),D.createElement(T.U,null,D.createElement(S.c,{label:"Title",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance."},D.createElement(M.p,{type:"text",placeholder:"{{alertname}}",value:Z.titleFormat,onChange:ye=>{oe({...Z,titleFormat:ye.currentTarget.value})},"data-testid":v.Tp.components.DataSource.Prometheus.annotations.title})),D.createElement(S.c,{label:"Tags"},D.createElement(M.p,{type:"text",placeholder:"label1,label2",value:Z.tagKeys,onChange:ye=>{oe({...Z,tagKeys:ye.currentTarget.value})},"data-testid":v.Tp.components.DataSource.Prometheus.annotations.tags})),D.createElement(S.c,{label:"Text",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance."},D.createElement(M.p,{type:"text",placeholder:"{{instance}}",value:Z.textFormat,onChange:ye=>{oe({...Z,textFormat:ye.currentTarget.value})},"data-testid":v.Tp.components.DataSource.Prometheus.annotations.text})),D.createElement(S.c,{label:"Series value as timestamp",tooltip:"The unit of timestamp is milliseconds. If the unit of the series value is seconds, multiply its range vector by 1000."},D.createElement(O.C,{value:Z.useValueForTime,onChange:ye=>{oe({...Z,useValueForTime:ye.currentTarget.value})},"data-testid":v.Tp.components.DataSource.Prometheus.annotations.seriesValueAsTimestamp}))))}var B=e(50556),U=e(81996),W=e(32370),N=e(76040),w=e(62183);const L=/^label_names\(\)\s*$/,V=/^label_values\((?:(.+),\s*)?([a-zA-Z_$][a-zA-Z0-9_]*)\)\s*$/,K=/^metrics\((.+)\)\s*$/,k=/^query_result\((.+)\)\s*$/,j=/^label_names\((.+)\)\s*$/;function H(re){if(typeof re!="string")return re;const Z={refId:"PrometheusDatasource-VariableQuery",qryType:w.B4.LabelNames},oe=re.match(j);if(oe)return{...Z,qryType:w.B4.LabelNames,match:oe[1]};const Ee=re.match(L);if(Ee)return{...Z,qryType:w.B4.LabelNames};const ye=re.match(/^label_values\(/);if(ye){const We=re.match(V),Ke=We?We[2]:"",it=We?We[1]:"";if(it){const rt=(0,N.u)(it);return{...Z,qryType:w.B4.LabelValues,label:Ke,metric:rt.query.metric,labelFilters:rt.query.labels}}else return{...Z,qryType:w.B4.LabelValues,label:Ke}}const Se=re.match(/^metrics\(/);if(Se){const We=re.match(K),Ke=We?We[1]:"";return{...Z,qryType:w.B4.MetricNames,metric:Ke}}const Be=re.match(/^query_result\(/);if(Be){const We=re.match(k),Ke=We?We[1]:"";return{...Z,qryType:w.B4.VarQueryResult,varQuery:Ke}}return!Ee&&!ye&&!Se&&!Be?{...Z,qryType:w.B4.SeriesQuery,seriesQuery:re}:Z}function J(re){switch(re.qryType){case w.B4.LabelNames:return re.match?`label_names(${re.match})`:"label_names()";case w.B4.LabelValues:if(re.metric||re.labelFilters&&re.labelFilters.length!==0){const oe={metric:re.metric,labels:re.labelFilters??[],operations:[]};return`label_values(${W.z.renderQuery(oe)},${re.label})`}else return`label_values(${re.label})`;case w.B4.MetricNames:return`metrics(${re.metric})`;case w.B4.VarQueryResult:return`query_result(${X(re.varQuery)})`;case w.B4.SeriesQuery:return re.seriesQuery??"";case w.B4.ClassicQuery:return re.classicQuery??""}return""}function X(re){return re?re.replace(/[\r\n]+/gm,""):""}class se{constructor(Z,oe){this.datasource=Z,this.query=oe,this.datasource=Z,this.query=oe,this.range=(0,d.E2)()}process(Z){this.range=Z;const oe=L,Ee=j,ye=/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\)\s*$/,Se=K,Be=k,We=this.query.match(oe),Ke=this.query.match(Ee);if(Ke){const Ge=`{__name__=~".*${Ke[1]}.*"}`;return this.datasource.languageProvider.getSeriesLabels(Ge,[]).then(qe=>qe.map(bt=>({text:bt})))}if(We)return this.datasource.getTagKeys({filters:[],timeRange:Z});const it=this.query.match(ye);if(it){const Ge=it[1],qe=it[2];return ae(Ge)?this.labelValuesQuery(qe,Ge):this.labelValuesQuery(qe)}const rt=this.query.match(Se);if(rt)return this.metricNameQuery(rt[1]);const ft=this.query.match(Be);return ft?this.queryResultQuery(ft[1]):["label_values()","metrics()","query_result()"].includes(this.query)?Promise.resolve([]):this.metricNameAndLabelsQuery(this.query)}labelValuesQuery(Z,oe){const Ee=(0,U.mv)(this.range.from,!1),ye=(0,U.mv)(this.range.to,!0),Se={...oe&&{"match[]":oe},start:Ee.toString(),end:ye.toString()};if(!oe||this.datasource.hasLabelsMatchAPISupport()){const Be=`/api/v1/label/${Z}/values`;return this.datasource.metadataRequest(Be,Se).then(We=>(0,t.map)(We.data.data,Ke=>({text:Ke})))}else return this.datasource.metadataRequest("/api/v1/series",Se).then(We=>{const Ke=(0,t.map)(We.data.data,it=>it[Z]||"").filter(it=>it!=="");return(0,t.uniq)(Ke).map(it=>({text:it,expandable:!0}))})}metricNameQuery(Z){const oe=(0,U.mv)(this.range.from,!1),Ee=(0,U.mv)(this.range.to,!0),ye={start:oe.toString(),end:Ee.toString()};return this.datasource.metadataRequest("/api/v1/label/__name__/values",ye).then(Be=>(0,t.chain)(Be.data.data).filter(We=>new RegExp(Z).test(We)).map(We=>({text:We,expandable:!0})).value())}queryResultQuery(Z){const oe="/api/v1/query",Ee={query:Z,time:(0,U.mv)(this.range.to,!0).toString()};return this.datasource.metadataRequest(oe,Ee).then(ye=>{switch(ye.data.data.resultType){case"scalar":case"string":return[{text:ye.data.data.result[1]||"",expandable:!1}];case"vector":return(0,t.map)(ye.data.data.result,Se=>{let Be=Se.metric.__name__||"";return delete Se.metric.__name__,Be+="{"+(0,t.map)(Se.metric,(We,Ke)=>Ke+'="'+We+'"').join(",")+"}",Be+=" "+Se.value[1]+" "+Se.value[0]*1e3,{text:Be,expandable:!0}});default:throw Error(`Unknown/Unhandled result type: [${ye.data.data.resultType}]`)}})}metricNameAndLabelsQuery(Z){const oe=(0,U.mv)(this.range.from,!1),Ee=(0,U.mv)(this.range.to,!0),ye={"match[]":Z,start:oe.toString(),end:Ee.toString()},Se="/api/v1/series",Be=this;return this.datasource.metadataRequest(Se,ye).then(We=>(0,t.map)(We.data.data,Ke=>({text:Be.datasource.getOriginalMetricName(Ke),expandable:!0})))}}function ae(re){return re&&re.split(" ").join("")!=="{}"}const ne=20;function q(re,Z,oe){const Ee=[],ye=oe?.languageProvider?.metricsMetadata;if(re.trim().match(/^\w+_bucket$|^\w+_bucket{.*}$/))Ee.push({type:"HISTOGRAM_QUANTILE",label:"Selected metric has buckets.",fix:{label:"Consider calculating aggregated quantile by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:re}}});else if(ye&&ie(re)){const Be=z(re),{nameMetric:We}=te(Be,"histogram",ye,!1);if(We){const it="Selected metric is a native histogram.";Ee.push({type:"HISTOGRAM_AVG",label:it,fix:{label:"Consider calculating the arithmetic average of observed values by adding histogram_avg().",action:{type:"ADD_HISTOGRAM_AVG",query:re}}},{type:"HISTOGRAM_COUNT",label:it,fix:{label:"Consider calculating the count of observations by adding histogram_count().",action:{type:"ADD_HISTOGRAM_COUNT",query:re}}},{type:"HISTOGRAM_SUM",label:it,fix:{label:"Consider calculating the sum of observations by adding histogram_sum().",action:{type:"ADD_HISTOGRAM_SUM",query:re}}},{type:"HISTOGRAM_FRACTION",label:it,fix:{label:"Consider calculating the estimated fraction of observations between the provided lower and upper values by adding histogram_fraction().",action:{type:"ADD_HISTOGRAM_FRACTION",query:re}}},{type:"HISTOGRAM_STDDEV",label:it,fix:{label:"Consider calculating the estimated standard deviation of observations by adding histogram_stddev().",action:{type:"ADD_HISTOGRAM_STDDEV",query:re}}},{type:"HISTOGRAM_STDVAR",label:it,fix:{label:"Consider calculating the estimated standard variance of observations by adding histogram_stdvar().",action:{type:"ADD_HISTOGRAM_STDVAR",query:re}}})}}if(re.indexOf("rate(")===-1&&re.indexOf("increase(")===-1){const Be=re.match(/\b((?<!:)\w+_(total|sum|count)(?!:))\b/);let We=Be?Be[1]:"",Ke=!1;if(ye){const it=z(re),rt=te(it,"counter",ye,Ke);We=rt.nameMetric,Ke=rt.certain}if(We){const it=ie(re);let ft=`Selected metric ${Ke?"is":"looks like"} a counter.`,pt;it?pt={label:"Consider calculating rate of counter by adding rate().",action:{type:"ADD_RATE",query:re}}:ft=`${ft} Consider calculating rate of counter by adding rate().`,Ee.push({type:"APPLY_RATE",label:ft,fix:pt})}}if(oe&&oe.ruleMappings){const Be=oe.ruleMappings,We=Object.keys(Be).reduce((Ke,it)=>re.search(it)>-1?{...Ke,[it]:Be[it]}:Ke,{});(0,t.size)(We)>0&&Ee.push({type:"EXPAND_RULES",label:"Query contains recording rules.",fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:re,options:We}}})}return Z&&Z.length>=ne&&re.trim().match(/^\w+$/)&&Ee.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:re,preventSubmit:!0}}}),Ee}function ee(re){const Z=[];return re.lookupsDisabled&&Z.push({label:"Labels and metrics lookup was disabled in data source settings.",type:"INFO"}),Z}function z(re){return Array.from(re.matchAll(/\$?[a-zA-Z_:][a-zA-Z0-9_:]*/g)).map(([Z])=>Z).filter(Z=>!Z.startsWith("$")).flatMap(Z=>Z.split(":"))}function te(re,Z,oe,Ee){return{nameMetric:re.find(Se=>{const Be=oe[Se];return Be&&Be.type.toLowerCase()===Z?(Ee=!0,!0):!1})??"",certain:Ee}}function ie(re){return re.trim().match(/^\w+$|^\w+{.*}$/)}var ce=e(20716),ue=e(59809),fe=e(14110);function Te(re,Z,oe){const{app:Ee,targets:ye}=Z;if(Ee===y.Jk.Explore)for(const Se of ye)(0,fe.rR)("grafana_prometheus_query_executed",{app:Ee,grafana_version:g.$.buildInfo.version,has_data:re.data.some(Be=>Be.length>0),has_error:re.error!==void 0,expr:Se.expr,format:Se.format,instant:Se.instant,range:Se.range,exemplar:Se.exemplar,hinting:Se.hinting,interval:Se.interval,intervalFactor:Se.intervalFactor,utcOffsetSec:Se.utcOffsetSec,legend:Se.legendFormat,valueWithRefId:Se.valueWithRefId,requestId:Z.requestId,showingGraph:Se.showingGraph,showingTable:Se.showingTable,editor_mode:Se.editorMode,simultaneously_sent_query_count:ye.length,time_range_from:Z?.range?.from?.toISOString(),time_range_to:Z?.range?.to?.toISOString(),time_taken:Date.now()-oe.getTime()})}var he=e(62467),de=e(65474),le=e(29505),pe=e(39268),ve=e(14186),be=e(21594),Oe=e(21744),Me=e(29993);const Ue=[{label:"Label names",value:w.B4.LabelNames},{label:"Label values",value:w.B4.LabelValues},{label:"Metrics",value:w.B4.MetricNames},{label:"Query result",value:w.B4.VarQueryResult},{label:"Series query",value:w.B4.SeriesQuery},{label:"Classic query",value:w.B4.ClassicQuery}],we="PrometheusVariableQueryEditor-VariableQuery",Re=({onChange:re,query:Z,datasource:oe,range:Ee})=>{const[ye,Se]=(0,D.useState)(void 0),[Be,We]=(0,D.useState)(""),[Ke,it]=(0,D.useState)(""),[rt,ft]=(0,D.useState)(""),[pt,Ge]=(0,D.useState)(""),[qe,bt]=(0,D.useState)(""),[Ft,Xt]=(0,D.useState)(""),[Lt,Qt]=(0,D.useState)([]),[an,gn]=(0,D.useState)([]);(0,D.useEffect)(()=>{oe.languageProvider.start(Ee)},[]),(0,D.useEffect)(()=>{if(Z)if(Z.qryType===w.B4.ClassicQuery)Se(Z.qryType),Xt(Z.query??"");else{const vt=Fe(Z);it(vt.match??""),Se(vt.qryType),We(vt.label??""),ft(vt.metric??""),gn(vt.labelFilters??[]),Ge(vt.varQuery??""),bt(vt.seriesQuery??""),Xt(vt.classicQuery??"")}},[Z]),(0,D.useEffect)(()=>{if(ye!==w.B4.LabelValues)return;const vt=oe.getVariables().map(nn=>({label:nn,value:nn}));if(!rt)oe.getTagKeys({filters:[]}).then(nn=>{const cn=nn.map(({text:mt})=>({label:mt,value:mt}));Qt([...vt,...cn])});else{const nn=[{label:"__name__",op:"=",value:rt}],cn=W.z.renderLabels(nn);oe.languageProvider.fetchLabelsWithMatch(cn).then(mt=>{const Tt=Object.keys(mt).map(Vt=>({label:Vt,value:Vt}));Qt([...vt,...Tt])})}},[oe,ye,rt]);const ut=(vt,nn)=>{const lt={...{qryType:ye,label:Be,metric:rt,match:Ke,varQuery:pt,seriesQuery:qe,classicQuery:Ft,refId:"PrometheusVariableQueryEditor-VariableQuery"},...vt,...nn?{labelFilters:nn}:{labelFilters:an}},Tt=J(lt);re({query:Tt,qryType:lt.qryType,refId:we})},Nt=vt=>{Se(vt.value),vt.value!==w.B4.SeriesQuery&&ut({qryType:vt.value??0})},ht=vt=>{const nn=vt&&vt.value?vt.value:"";We(nn),ye===w.B4.LabelValues&&nn&&ut({label:nn})},Rt=vt=>{ft(vt.metric),gn(vt.labels);const nn=vt.metric,cn=vt.labels??[];ye===w.B4.LabelValues&&Be&&(nn||cn)&&ut({qryType:ye,metric:nn},cn)},_t=vt=>{ye===w.B4.LabelNames&&ut({qryType:ye,match:vt})},on=vt=>{ye===w.B4.MetricNames&&vt&&ut({metric:vt})},ln=vt=>{Ge(vt.currentTarget.value)},bn=vt=>{bt(vt.currentTarget.value)},In=vt=>{Xt(vt.currentTarget.value)},Mn=(0,D.useCallback)(()=>({metric:rt,labels:an,operations:[]}),[rt,an]);return D.createElement(D.Fragment,null,D.createElement(pe.C,null,D.createElement(ve.I,{label:"Query type",labelWidth:20,tooltip:D.createElement("div",null,"The Prometheus data source plugin provides the following query types for template variables.")},D.createElement(be.l6,{placeholder:"Select query type","aria-label":"Query type",onChange:Nt,value:ye,options:Ue,width:25,"data-testid":v.Tp.components.DataSource.Prometheus.variableQueryEditor.queryType}))),ye===w.B4.LabelValues&&D.createElement(D.Fragment,null,D.createElement(pe.C,null,D.createElement(ve.I,{label:"Label",labelWidth:20,required:!0,"aria-labelledby":"label-select",tooltip:D.createElement("div",null,"Returns a list of label values for the label name in all metrics unless the metric is specified.")},D.createElement(be.l6,{"aria-label":"label-select",onChange:ht,value:Be,options:Lt,width:25,allowCustomValue:!0,isClearable:!0,"data-testid":v.Tp.components.DataSource.Prometheus.variableQueryEditor.labelValues.labelSelect}))),D.createElement(Me.I,{query:Mn(),datasource:oe,onChange:Rt,variableEditor:!0})),ye===w.B4.LabelNames&&D.createElement(pe.C,null,D.createElement(ve.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric regex",tooltip:D.createElement("div",null,"Returns a list of label names, optionally filtering by specified metric regex.")},D.createElement(M.p,{type:"text","aria-label":"Metric regex",placeholder:"Metric regex",value:Ke,onBlur:vt=>{it(vt.currentTarget.value),_t(vt.currentTarget.value)},onChange:vt=>{it(vt.currentTarget.value)},width:25,"data-testid":v.Tp.components.DataSource.Prometheus.variableQueryEditor.labelnames.metricRegex}))),ye===w.B4.MetricNames&&D.createElement(pe.C,null,D.createElement(ve.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric selector",tooltip:D.createElement("div",null,"Returns a list of metrics matching the specified metric regex.")},D.createElement(M.p,{type:"text","aria-label":"Metric selector",placeholder:"Metric regex",value:rt,onChange:vt=>{ft(vt.currentTarget.value)},onBlur:vt=>{ft(vt.currentTarget.value),on(vt.currentTarget.value)},width:25,"data-testid":v.Tp.components.DataSource.Prometheus.variableQueryEditor.metricNames.metricRegex}))),ye===w.B4.VarQueryResult&&D.createElement(pe.C,null,D.createElement(ve.I,{label:"Query",labelWidth:20,tooltip:D.createElement("div",null,"Returns a list of Prometheus query results for the query. This can include Prometheus functions, i.e. sum(go_goroutines).")},D.createElement(Oe.f,{type:"text","aria-label":"Prometheus Query",placeholder:"Prometheus Query",value:pt,onChange:ln,onBlur:()=>{ye===w.B4.VarQueryResult&&pt&&ut({qryType:ye})},cols:100,"data-testid":v.Tp.components.DataSource.Prometheus.variableQueryEditor.varQueryResult}))),ye===w.B4.SeriesQuery&&D.createElement(pe.C,null,D.createElement(ve.I,{label:"Series Query",labelWidth:20,tooltip:D.createElement("div",null,'Enter a metric with labels, only a metric or only labels, i.e. go_goroutines{instance="localhost:9090"}, go_goroutines, or {instance="localhost:9090"}. Returns a list of time series associated with the entered data.')},D.createElement(M.p,{type:"text","aria-label":"Series Query",placeholder:"Series Query",value:qe,onChange:bn,onBlur:()=>{ye===w.B4.SeriesQuery&&qe&&ut({qryType:ye})},width:100,"data-testid":v.Tp.components.DataSource.Prometheus.variableQueryEditor.seriesQuery}))),ye===w.B4.ClassicQuery&&D.createElement(pe.C,null,D.createElement(ve.I,{label:"Classic Query",labelWidth:20,tooltip:D.createElement("div",null,"The original implemetation of the Prometheus variable query editor. Enter a string with the correct query type and parameters as described in these docs. For example, label_values(label, metric).")},D.createElement(M.p,{type:"text","aria-label":"Classic Query",placeholder:"Classic Query",value:Ft,onChange:In,onBlur:()=>{ye===w.B4.ClassicQuery&&Ft&&ut({qryType:ye})},width:100,"data-testid":v.Tp.components.DataSource.Prometheus.variableQueryEditor.classicQuery}))))};function Fe(re){return typeof re=="string"?H(re):re.query?H(re.query):re}class xe extends le.f5{constructor(Z,oe=(0,P.w)()){super(),this.datasource=Z,this.templateSrv=oe,this.editor=Re}query(Z){let oe;if(typeof Z.targets[0]=="string"?oe=Z.targets[0]:oe=Z.targets[0].query,!oe)return(0,he.of)({data:[]});const Ee={...Z.scopedVars,__interval:{text:this.datasource.interval,value:this.datasource.interval},__interval_ms:{text:i.intervalToMs(this.datasource.interval),value:i.intervalToMs(this.datasource.interval)},...this.datasource.getRangeScopedVars(Z.range)},ye=this.templateSrv.replace(oe,Ee,this.datasource.interpolateQueryExpr),Se=new se(this.datasource,ye);return(0,de.H)(Se.process(Z.range)).pipe((0,r.T)(We=>({data:We})))}}const Ve="60s",$e=["api/v1/query","api/v1/query_range","api/v1/series","api/v1/labels"],Xe="-Instant";class gt extends f.iy{constructor(Z,oe=(0,P.w)(),Ee){super(Z),this.templateSrv=oe,this.init=async()=>{this.disableRecordingRules||this.loadRules(),this.exemplarsAvailable=await this.areExemplarsAvailable()},this.processAnnotationResponse=(ye,Se)=>{const Be=(0,a.bE)({data:Se}).data;if(!Be||!Be.length)return[];const We=ye.annotation,{tagKeys:Ke="",titleFormat:it="",textFormat:rt=""}=We,ft=i.intervalToSeconds(We.step||Ve)*1e3,pt=Ke.split(","),Ge=[];for(const qe of Be){if(qe.fields.length===0)continue;const bt=qe.fields[0],Ft=qe.fields[1],Xt=Ft?.labels||{},Lt=Object.keys(Xt).filter(ht=>pt.includes(ht)).map(ht=>Xt[ht]),Qt=[];let an=0;Ft.values.forEach(ht=>{let Rt,_t;const on=bt.values[an];ye.annotation.useValueForTime?(Rt=Math.floor(parseFloat(ht)),_t=1):(Rt=Math.floor(parseFloat(on)),_t=parseFloat(ht)),an++,Qt.push([Rt,_t])});const ut=Qt.filter(ht=>ht[1]>0).map(ht=>ht[0]);let Nt=null;for(const ht of ut){if(Nt&&(Nt.timeEnd??0)+ft>=ht){Nt.timeEnd=ht;continue}Nt&&Ge.push(Nt),Nt={time:ht,timeEnd:ht,annotation:We,title:(0,u.j)(it,Xt),tags:Lt,text:(0,u.j)(rt,Xt)}}Nt&&(Nt.timeEnd=ut[ut.length-1],Ge.push(Nt))}return Ge},this.type="prometheus",this.id=Z.id,this.url=Z.url,this.access=Z.access,this.basicAuth=Z.basicAuth,this.withCredentials=!!Z.withCredentials,this.interval=Z.jsonData.timeInterval||"15s",this.queryTimeout=Z.jsonData.queryTimeout,this.httpMethod=Z.jsonData.httpMethod||"GET",this.exemplarTraceIdDestinations=Z.jsonData.exemplarTraceIdDestinations,this.hasIncrementalQuery=Z.jsonData.incrementalQuerying??!1,this.ruleMappings={},this.languageProvider=Ee??new B.Ay(this),this.lookupsDisabled=Z.jsonData.disableMetricsLookup??!1,this.customQueryParameters=new URLSearchParams(Z.jsonData.customQueryParameters),this.datasourceConfigurationPrometheusFlavor=Z.jsonData.prometheusType,this.datasourceConfigurationPrometheusVersion=Z.jsonData.prometheusVersion,this.defaultEditor=Z.jsonData.defaultEditor,this.disableRecordingRules=Z.jsonData.disableRecordingRules??!1,this.variables=new xe(this,this.templateSrv),this.exemplarsAvailable=!0,this.cacheLevel=Z.jsonData.cacheLevel??w.fD.Low,this.metricNamesAutocompleteSuggestionLimit=Z.jsonData.codeModeMetricNamesSuggestionLimit??B.OP,this.cache=new ce.$i({getTargetSignature:this.getPrometheusTargetSignature.bind(this),overlapString:Z.jsonData.incrementalQueryOverlapWindow??ce.Dr,profileFunction:this.getPrometheusProfileData.bind(this)}),this.annotations={QueryEditor:R}}getQueryDisplayText(Z){return Z.expr}getPrometheusProfileData(Z,oe){return{interval:oe.interval??Z.interval,expr:this.interpolateString(oe.expr),datasource:"Prometheus"}}getPrometheusTargetSignature(Z,oe){return`${this.interpolateString(oe.expr)}|${oe.interval??Z.interval}|${JSON.stringify(Z.rangeRaw??"")}|${oe.exemplar}`}hasLabelsMatchAPISupport(){return this._isDatasourceVersionGreaterOrEqualTo("2.24.0",w.N1.Prometheus)||this._isDatasourceVersionGreaterOrEqualTo("2.0.0",w.N1.Mimir)||this._isDatasourceVersionGreaterOrEqualTo("1.11.0",w.N1.Cortex)||this._isDatasourceVersionGreaterOrEqualTo("0.18.0",w.N1.Thanos)}_isDatasourceVersionGreaterOrEqualTo(Z,oe){return!this.datasourceConfigurationPrometheusVersion||!this.datasourceConfigurationPrometheusFlavor?!0:oe!==this.datasourceConfigurationPrometheusFlavor?!1:l().gte(this.datasourceConfigurationPrometheusVersion,Z)}_addTracingHeaders(Z,oe){Z.headers={},this.access==="proxy"&&(Z.headers["X-Dashboard-UID"]=oe.dashboardUID,Z.headers["X-Panel-Id"]=oe.panelId)}directAccessError(){return(0,n.$)(()=>new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode."))}_request(Z,oe,Ee={}){if(this.access==="direct")return this.directAccessError();oe=oe||{};for(const[Be,We]of this.customQueryParameters)oe[Be]==null&&(oe[Be]=We);let ye=this.url+Z;Z.startsWith(`/api/datasources/uid/${this.uid}`)&&(ye=Z);const Se=(0,t.defaults)(Ee,{url:ye,method:this.httpMethod,headers:{}});return Se.method==="GET"?oe&&Object.keys(oe).length&&(Se.url=Se.url+(Se.url.search(/\?/)>=0?"&":"?")+Object.entries(oe).map(([Be,We])=>`${encodeURIComponent(Be)}=${encodeURIComponent(We)}`).join("&")):(Se.headers["Content-Type"]="application/x-www-form-urlencoded",Se.data=oe),(this.basicAuth||this.withCredentials)&&(Se.withCredentials=!0),this.basicAuth&&(Se.headers.Authorization=this.basicAuth),(0,E.AI)().fetch(Se)}async importFromAbstractQueries(Z){return Z.map(oe=>this.languageProvider.importFromAbstractQuery(oe))}async exportToAbstractQueries(Z){return Z.map(oe=>this.languageProvider.exportToAbstractQuery(oe))}async metadataRequest(Z,oe={},Ee){if($e.some(ye=>Z.includes(ye)))try{return await(0,s.s)(this._request(`/api/datasources/uid/${this.uid}/resources${Z}`,oe,{method:this.httpMethod,hideFromInspector:!0,showErrorAlert:!1,...Ee}))}catch(ye){if(this.httpMethod==="POST"&&(0,E.NF)(ye)&&(ye.status===405||ye.status===400))console.warn("Couldn't use configured POST HTTP method for this request. Trying to use GET method instead.");else throw ye}return await(0,s.s)(this._request(`/api/datasources/uid/${this.uid}/resources${Z}`,oe,{method:"GET",hideFromInspector:!0,...Ee}))}interpolateQueryExpr(Z=[],oe){if(!oe.multi&&!oe.includeAll)return at(Z);if(typeof Z=="string")return Ae(Z);const Ee=Z.map(ye=>Ae(ye));return Ee.length===1?Ee[0]:"("+Ee.join("|")+")"}targetContainsTemplate(Z){return this.templateSrv.containsTemplate(Z.expr)}shouldRunExemplarQuery(Z,oe){if(Z.exemplar){const Ee=this.languageProvider.histogramMetrics.find(Be=>Z.expr.includes(Be)),ye=oe.targets.findIndex(Be=>Be.refId===Z.refId),Se=oe.targets.slice(0,ye).filter(Be=>!Be.hide);return!!(!Ee||Ee&&!Se.some(Be=>Be.expr.includes(Ee)))}return!1}processTargetV2(Z,oe){const Ee=[],ye={...Z,exemplar:this.shouldRunExemplarQuery(Z,oe),requestId:oe.panelId+Z.refId,utcOffsetSec:oe.range.to.utcOffset()*60};return g.$.featureToggles.promQLScope&&(ye.scopes=(oe.scopes??[]).map(Se=>({name:Se.metadata.name,...Se.spec}))),g.$.featureToggles.groupByVariable&&(ye.groupByKeys=oe.groupByKeys),Z.instant&&Z.range?Ee.push({...ye,refId:ye.refId,instant:!1},{...ye,refId:ye.refId+Xe,range:!1}):Ee.push(ye),Ee}query(Z){if(this.access==="direct")return this.directAccessError();let oe,Ee;const ye=Z.targets.some(We=>We.instant);this.hasIncrementalQuery&&!ye?(Ee=this.cache.requestInfo(Z),oe=Ee.requests[0]):oe=Z;const Se=oe.targets.map(We=>this.processTargetV2(We,oe)),Be=new Date;return super.query({...oe,targets:Se.flat()}).pipe((0,r.T)(We=>{const Ke={...We,data:this.cache.procFrames(Z,Ee,We.data)};return(0,ue.J3)(Ke,Z,{exemplarTraceIdDestinations:this.exemplarTraceIdDestinations})}),(0,o.M)(We=>{Te(We,Z,Be)}))}metricFindQuery(Z,oe){if(!Z)return Promise.resolve([]);const Ee={__interval:{text:this.interval,value:this.interval},__interval_ms:{text:i.intervalToMs(this.interval),value:i.intervalToMs(this.interval)},...this.getRangeScopedVars(oe?.range??(0,d.E2)())},ye=this.templateSrv.replace(Z,Ee,this.interpolateQueryExpr);return new se(this,ye).process(oe?.range??(0,d.E2)())}getRangeScopedVars(Z){const oe=Z.to.diff(Z.from),Ee=Math.round(oe/1e3);return{__range_ms:{text:oe,value:oe},__range_s:{text:Ee,value:Ee},__range:{text:Ee+"s",value:Ee+"s"}}}async annotationQuery(Z){if(this.access==="direct"){const Be=new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode.");return Promise.reject(Be)}const oe=Z.annotation,{expr:Ee=""}=oe;if(!Ee)return Promise.resolve([]);const ye=Z.annotation.step||Ve,Se={expr:Ee,range:!0,instant:!1,exemplar:!1,interval:ye,refId:"X",datasource:this.getRef()};return await(0,s.s)((0,E.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:((0,U.mv)(Z.range.from,!1)*1e3).toString(),to:((0,U.mv)(Z.range.to,!0)*1e3).toString(),queries:[this.applyTemplateVariables(Se,{})]},requestId:`prom-query-${oe.name}`}).pipe((0,r.T)(Be=>this.processAnnotationResponse(Z,Be.data))))}async getTagKeys(Z){if(!Z||Z.filters.length===0)return await this.languageProvider.fetchLabels(Z.timeRange,Z.queries),this.languageProvider.getLabelKeys().map(Se=>({value:Se,text:Se}));const oe=Z.filters.map(Se=>({label:Se.key,value:Se.value,op:Se.operator})),Ee=W.z.renderLabels(oe);let ye=await this.languageProvider.fetchLabelsWithMatch(Ee);return Object.keys(ye).filter(Se=>!Z.filters.find(Be=>Be.key===Se)).map(Se=>({value:Se,text:Se}))}async getTagValues(Z){const oe=Z.filters.map(Be=>({label:Be.key,value:Be.value,op:Be.operator})),Ee=W.z.renderLabels(oe);if(this.hasLabelsMatchAPISupport()){const Be=`[${this.uid}][${Z.key}]`;return(await this.languageProvider.fetchSeriesValuesWithMatch(Z.key,Ee,Be,Z.timeRange)).map(We=>({value:We,text:We}))}const ye=this.getTimeRangeParams(Z.timeRange??(0,d.E2)());return(await this.metadataRequest(`/api/v1/label/${Z.key}/values`,ye))?.data?.data?.map(Be=>({text:Be}))??[]}interpolateVariablesInQueries(Z,oe,Ee){let ye=Z;return Z&&Z.length&&(ye=Z.map(Se=>{const Be=this.templateSrv.replace(Se.expr,oe,this.interpolateQueryExpr);return{...Se,...g.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(Ee)}:{},datasource:this.getRef(),expr:g.$.featureToggles.promQLScope?Be:this.enhanceExprWithAdHocFilters(Ee,Be),interval:this.templateSrv.replace(Se.interval,oe)}})),ye}getQueryHints(Z,oe){return q(Z.expr??"",oe,this)}getInitHints(){return ee(this)}async loadRules(){try{const oe=(await this.metadataRequest("/api/v1/rules",{},{showErrorAlert:!1})).data?.data?.groups;oe&&(this.ruleMappings=nt(oe))}catch(Z){console.log("Rules API is experimental. Ignore next error."),console.error(Z)}}async areExemplarsAvailable(){try{return(await this.metadataRequest("/api/v1/query_exemplars",{query:"test",start:(0,p.KQ)().subtract(30,"minutes").valueOf().toString(),end:(0,p.KQ)().valueOf().toString()},{showErrorAlert:!1})).data.status==="success"}catch{return!1}}modifyQuery(Z,oe){let Ee=Z.expr??"";switch(oe.type){case"ADD_FILTER":{const{key:ye,value:Se}=oe.options??{};ye&&Se&&(Ee=(0,h.t)(Ee,ye,Se));break}case"ADD_FILTER_OUT":{const{key:ye,value:Se}=oe.options??{};ye&&Se&&(Ee=(0,h.t)(Ee,ye,Se,"!="));break}case"ADD_HISTOGRAM_QUANTILE":{Ee=`histogram_quantile(0.95, sum(rate(${Ee}[$__rate_interval])) by (le))`;break}case"ADD_HISTOGRAM_AVG":{Ee=`histogram_avg(rate(${Ee}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_FRACTION":{Ee=`histogram_fraction(0,0.2,rate(${Ee}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_COUNT":{Ee=`histogram_count(rate(${Ee}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_SUM":{Ee=`histogram_sum(rate(${Ee}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDDEV":{Ee=`histogram_stddev(rate(${Ee}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDVAR":{Ee=`histogram_stdvar(rate(${Ee}[$__rate_interval]))`;break}case"ADD_RATE":{Ee=`rate(${Ee}[$__rate_interval])`;break}case"ADD_SUM":{Ee=`sum(${Ee.trim()}) by ($1)`;break}case"EXPAND_RULES":{oe.options&&(Ee=(0,U.P_)(Ee,oe.options));break}default:break}return{...Z,expr:Ee}}getAdjustedInterval(Z){return(0,U.Xd)(this.cacheLevel,Z)}getTimeRangeParams(Z){return{start:(0,U.mv)(Z.from,!1).toString(),end:(0,U.mv)(Z.to,!0).toString()}}getOriginalMetricName(Z){return(0,ue.hF)(Z)}generateScopeFilters(Z){return Z?Z.map(oe=>({...oe,operator:c.n[oe.operator]})):[]}enhanceExprWithAdHocFilters(Z,oe){return!Z||Z.length===0?oe:Z.reduce((ye,Se)=>{const{key:Be,operator:We}=Se;let{value:Ke}=Se;return(We==="=~"||We==="!~")&&(Ke=at(Ke)),(0,h.t)(ye,Be,Ke,We)},oe)}filterQuery(Z){return!(Z.hide||!Z.expr)}applyTemplateVariables(Z,oe,Ee){const ye={...oe};ye.__interval={value:"$__interval"},ye.__interval_ms={value:"$__interval_ms"};const Se=this.templateSrv.replace(Z.expr,ye,this.interpolateQueryExpr);return{...Z,...g.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(Ee)}:{},expr:g.$.featureToggles.promQLScope?Se:this.enhanceExprWithAdHocFilters(Ee,Se),interval:this.templateSrv.replace(Z.interval,ye),legendFormat:this.templateSrv.replace(Z.legendFormat,ye)}}getVariables(){return this.templateSrv.getVariables().map(Z=>`$${Z.name}`)}interpolateString(Z,oe){return this.templateSrv.replace(Z,oe,this.interpolateQueryExpr)}getDebounceTimeInMilliseconds(){switch(this.cacheLevel){case w.fD.Medium:return 600;case w.fD.High:return 1200;default:return 350}}getDaysToCacheMetadata(){switch(this.cacheLevel){case w.fD.Medium:return 7;case w.fD.High:return 30;default:return 1}}getCacheDurationInMinutes(){return(0,U.u3)(this.cacheLevel)}getDefaultQuery(Z){const oe={refId:"A",expr:"",range:!0,instant:!1};return Z===y.Jk.UnifiedAlerting?{...oe,instant:!0,range:!1}:Z===y.Jk.Explore?{...oe,instant:!0,range:!0}:oe}}function Dt(re,Z,oe,Ee){const ye=Math.floor((Z+Ee)/oe)*oe-Ee,Se=Math.floor((re+Ee)/oe)*oe-Ee;return{end:ye,start:Se}}function nt(re){return re.reduce((Z,oe)=>oe.rules.filter(Ee=>Ee.type==="recording").reduce((Ee,ye)=>({...Ee,[ye.name]:ye.query}),Z),{})}function at(re){return typeof re=="string"?re.replace(/\\/g,"\\\\").replace(/'/g,"\\\\'"):re}function Ae(re){return typeof re=="string"?re.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]\'+?.()|]/g,"\\\\$&"):re}},52363:(G,I,e)=>{"use strict";e.d(I,{A:()=>s});class t{get(o){return window.localStorage[o]}set(o,m){window.localStorage[o]=m}getBool(o,m){return m!==void 0&&!this.exists(o)?m:window.localStorage[o]==="true"}getObject(o,m){let l=m;if(this.exists(o)){const i=window.localStorage[o];try{l=JSON.parse(i)}catch(u){console.error(`Error parsing store object: ${o}. Returning default: ${m}. [${u}]`)}}return l}setObject(o,m){let l;try{l=JSON.stringify(m)}catch(i){throw new Error(`Could not stringify object: ${o}. [${i}]`)}try{this.set(o,l)}catch(i){const u=new Error(`Could not save item in localStorage: ${o}. [${i}]`);throw i instanceof Error&&(u.name=i.name),u}return!0}exists(o){return window.localStorage[o]!==void 0}delete(o){window.localStorage.removeItem(o)}}const s=new t},50556:(G,I,e)=>{"use strict";e.d(I,{AU:()=>g,Ay:()=>v,OP:()=>f,pK:()=>E,xB:()=>a});var t=e(2543),n=e.n(t),s=e(28848),r=e.n(s),o=e(40187),m=e(43127),l=e(73372),i=e(81996),u=e(20719),d=e(76040),p=e(62183);const c=["job","instance"],y="{}",f=1e4,P=S=>({headers:{"X-Grafana-Cache":`private, max-age=${S}`}});function a(S,O){if(!O[S])return;const{type:x,help:b}=O[S];return`${x.toUpperCase()}: ${b}`}function E(S,O){if(O[S])return O[S].help}function g(S,O){if(O[S])return O[S].type}const h=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/,D=86400;class v extends o.Is{constructor(O,x){super(),this.labelKeys=[],this.request=async(b,M,A={},R)=>{try{return(await this.datasource.metadataRequest(b,A,R)).data.data}catch(B){T(B)||console.error(B)}return M},this.start=async b=>(this.timeRange=b??(0,m.E2)(),this.datasource.lookupsDisabled?[]:(this.metrics=await this.fetchLabelValues("__name__")||[],this.histogramMetrics=(0,i.Rg)(this.metrics).sort(),Promise.all([this.loadMetricsMetadata(),this.fetchLabels()]))),this.fetchLabelValues=async b=>{const M=this.datasource.getAdjustedInterval(this.timeRange),R=`/api/v1/label/${this.datasource.interpolateString(b)}/values`;return await this.request(R,[],M,this.getDefaultCacheHeaders())??[]},this.fetchLabels=async(b,M)=>{b&&(this.timeRange=b);let A="/api/v1/labels";const R=this.datasource.getAdjustedInterval(this.timeRange);this.labelFetchTs=Date.now().valueOf();const B=new URLSearchParams({...R});M?.forEach(W=>{const N=(0,d.u)(W.expr);B.append("match[]",N.query.metric),N.query.binaryQueries&&N.query.binaryQueries.forEach(w=>{B.append("match[]",w.query.metric)})}),this.datasource.httpMethod==="GET"&&(A+=`?${B.toString()}`);const U=await this.request(A,[],B,this.getDefaultCacheHeaders());return Array.isArray(U)&&(this.labelKeys=U.slice().sort()),[]},this.getSeriesValues=async(b,M)=>this.datasource.hasLabelsMatchAPISupport()?await this.fetchSeriesValuesWithMatch(b,M):(await this.getSeries(M))[b]??[],this.fetchSeriesValuesWithMatch=async(b,M,A,R=this.timeRange)=>{const B=b?this.datasource.interpolateString(b):null,U=M?this.datasource.interpolateString(M):null,N={...this.datasource.getAdjustedInterval(R),...U&&{"match[]":U}};let w={...this.getDefaultCacheHeaders(),...A&&{requestId:A}};return Object.keys(w).length||(w=void 0),await this.request(`/api/v1/label/${B}/values`,[],N,w)??[]},this.getSeriesLabels=async(b,M)=>{let A,R;this.datasource.hasLabelsMatchAPISupport()?(M.push({name:"__name__",value:"",op:"!="}),R=await this.fetchSeriesLabelsMatch(b),A=Object.keys(R)):(R=await this.getSeries(b),A=Object.keys(R));const B=new Set(M.map(U=>U.name));return A.filter(U=>!B.has(U))},this.fetchLabelsWithMatch=async(b,M)=>this.datasource.hasLabelsMatchAPISupport()?this.fetchSeriesLabelsMatch(b,M):this.fetchSeriesLabels(b,M),this.fetchSeriesLabels=async(b,M)=>{const A=this.datasource.interpolateString(b),B={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":A},W=await this.request("/api/v1/series",[],B,this.getDefaultCacheHeaders()),{values:N}=(0,i.P7)(W,M);return N},this.fetchSeriesLabelsMatch=async(b,M)=>{const A=this.datasource.interpolateString(b),B={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":A};return(await this.request("/api/v1/labels",[],B,this.getDefaultCacheHeaders())).reduce((N,w)=>({...N,[w]:""}),{})},this.fetchSeries=async b=>{const M="/api/v1/series",R={...this.datasource.getTimeRangeParams(this.timeRange),"match[]":b};return await this.request(M,{},R,this.getDefaultCacheHeaders())},this.fetchDefaultSeries=(0,t.once)(async()=>{const b=await Promise.all(c.map(M=>this.fetchLabelValues(M)));return c.reduce((M,A,R)=>({...M,[A]:b[R]}),{})}),this.datasource=O,this.histogramMetrics=[],this.timeRange=(0,m.E2)(),this.metrics=[],Object.assign(this,x)}getDefaultCacheHeaders(){if(this.datasource.cacheLevel!==p.fD.None)return P(this.datasource.getCacheDurationInMinutes()*60)}cleanText(O){return O.split(h).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}get syntax(){return u.Ay}async loadMetricsMetadata(){const O=P(this.datasource.getDaysToCacheMetadata()*D);this.metricsMetadata=(0,i.DX)(await this.request("/api/v1/metadata",{},{},{showErrorAlert:!1,...O}))}getLabelKeys(){return this.labelKeys}importFromAbstractQuery(O){return(0,i.pt)(O)}exportToAbstractQuery(O){const x=O.expr;if(!x||x.length===0)return{refId:O.refId,labelMatchers:[]};const b=r().tokenize(x,u.Ay),M=(0,i.VH)(b),A=C(x,b);return A&&A.length>0&&M.push({name:"__name__",operator:l.D_.Equal,value:A}),{refId:O.refId,labelMatchers:M}}async getSeries(O,x){if(this.datasource.lookupsDisabled)return{};try{return O===y?await this.fetchDefaultSeries():await this.fetchSeriesLabels(O,x)}catch(b){return console.error(b),{}}}async getLabelValues(O){return await this.fetchLabelValues(O)}}function C(S,O){let x="";for(const b of O)if(typeof b=="string"){x=b;break}return x}function T(S){return typeof S=="object"&&S!==null&&"cancelled"in S&&S.cancelled===!0}},81996:(G,I,e)=>{"use strict";e.d(I,{Cs:()=>M,DX:()=>h,P7:()=>y,P_:()=>E,Qn:()=>b,Rg:()=>c,VH:()=>N,Xd:()=>w,eN:()=>D,ky:()=>K,mv:()=>V,pt:()=>U,u3:()=>L});var t=e(2543),n=e.n(t),s=e(28848),r=e.n(s),o=e(73372),m=e(77678),l=e(85858),i=e(80937),u=e(50556),d=e(95899),p=e(62183);const c=k=>{const j=new Set,H=new RegExp("_bucket($|:)");for(let J=0;J<k.length;J++){const X=k[J];H.test(X)&&j.add(X)}return[...j]};function y(k,j=!1){const H={};k.forEach(X=>{const{__name__:se,...ae}=X;j&&(H.__name__=H.__name__||new Set,H.__name__.has(se)||H.__name__.add(se)),Object.keys(ae).forEach(ne=>{H[ne]||(H[ne]=new Set),H[ne].has(ae[ne])||H[ne].add(ae[ne])})});const J={};return T(Object.keys(H)).forEach(X=>{J[X]=T(Array.from(H[X]))}),{values:J,keys:Object.keys(J)}}const f=/\{[^}]*?(\}|$)/,P=/\b(\w+)(!?=~?)("[^"\n]*?")(,)?(\s*)?/g;function a(k,j=1){if(!k.match(f)){if(k.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${k}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+k)}const H=k.slice(0,j),J=H.lastIndexOf("{"),X=H.lastIndexOf("}");if(J===-1)throw new Error("Not inside selector, missing open brace: "+H);if(X>-1&&X>J)throw new Error("Not inside selector, previous selector already closed: "+H);const se=k.slice(j),ne=se.indexOf("}")+j,q=se.indexOf("{"),ee=q+j;if(ne===-1)throw new Error("Not inside selector, missing closing brace in suffix: "+se);if(q>-1&&ee<ne)throw new Error("Not inside selector, next selector opens before this one closed: "+se);const z=k.slice(J,ne),te={};z.replace(P,(he,de,le,pe)=>{const ve=k.indexOf(he),be=ve+de.length+le.length+1,Oe=ve+de.length+le.length+pe.length-1;return(j<be||j>Oe)&&(te[de]={value:pe,operator:le}),""});const ce=k.slice(0,J).match(/[A-Za-z:][\w:]*$/);ce&&(te.__name__={value:`"${ce[0]}"`,operator:"="});const ue=Object.keys(te).sort(),Te=["{",ue.map(he=>`${he}${te[he].operator}${te[he].value}`).join(","),"}"].join("");return{labelKeys:ue,selector:Te}}function E(k,j){const H=ae=>new RegExp(`(\\s|\\(|^)(${ae})(\\s|$|\\(|\\[|\\{)`,"ig"),J=Object.keys(j).reduce((ae,ne)=>{let q=[],ee=[],z=[];return ae.filter(Boolean).forEach((te,ie)=>{te.match(H(ne))&&(q=te.split(ne),q.length===2?(z.push(ie),ee.push(...[q[0],ne,q[1]].filter(Boolean))):q.length>2&&(z.push(ie),q=q.map(ue=>ue===""?ne:ue),ee.push(...q)))}),z.forEach(te=>ae[te]=""),ae=ae.filter(Boolean),ae.push(...ee),ae},[k]);let X=!1;return J.map((ae,ne)=>{if(X)return X=!1,"";if(j[ae]){const q=j[ae];if(ne+1!==J.length&&J[ne+1].match(P)){X=!0;const ee=J[ne+1],z=/(\)\{|\}\{|\]\{)/;return g(q+ee,z)}else return q}return ae}).filter(Boolean).join("")}function g(k,j){const H=k.match(j);if(!H)return k;const J=H.index??0,X=k.slice(0,J+1),se=k.slice(J+1),ae=[];se.replace(P,(z,te,ie,ce,ue,fe)=>(ae.push({key:te,operator:ie,value:ce,comma:ue,space:fe}),""));let ne=X;ae.filter(Boolean).forEach(z=>{const te=z.value.slice(1,-1);ne=(0,i.t)(ne,z.key,te,z.operator)});let q=ae.reduce((z,te)=>(z+=`${te.key}${te.operator}${te.value}${te.comma??""}${te.space??""}`,z),"");q="{"+q+"}";const ee=se.replace(q,"");return ne+ee}function h(k){if(!k)return k;const j={},H={};for(const X in k){const se=k[X][0];j[X]=se,se.type==="histogram"&&(H[`${X}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${se.help})`},H[`${X}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${se.help})`},H[`${X}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${se.help})`}),se.type==="summary"&&(H[`${X}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${se.help})`},H[`${X}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${se.help})`})}const J={};return J.ALERTS={type:"counter",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."},{...j,...H,...J}}function D(k){return v(k/1e3)}function v(k){return Math.floor(k/60)}function C(k,j=1){return Math.ceil(k/60)-Math.ceil(k/60)%j}function T(k){return k.slice(0,u.OP)}function S(k){return k&&k.length>=SUGGESTIONS_LIMIT?`, limited to the first ${SUGGESTIONS_LIMIT} received items`:""}const O=/[*+?()|\\.\[\]{}^$]/g;function x(k){return k.replace(O,"\\$&")}function b(k){return k.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function M(k){return b(x(k))}const A={"=":o.D_.Equal,"!=":o.D_.NotEqual,"=~":o.D_.EqualRegEx,"!~":o.D_.NotEqualRegEx},R=(0,t.invert)(A);function B(k){const j=k.labelMatchers.map(H=>{const J=R[H.operator];return J?`${H.name}${J}"${H.value}"`:""}).filter(H=>H!=="").join(", ");return j?`{${j}}`:""}function U(k){return{refId:k.refId,expr:B(k),range:!0}}function W(k){return typeof k.content=="string"?k.content:""}function N(k){const j=[];for(const H of k)if(H instanceof s.Token&&H.type==="context-labels"){let J="",X="",se="";const ae=Array.isArray(H.content)?H.content:[H.content];for(let ne of ae)if(typeof ne=="string"){let q;q=ne,(q==="="||q==="!="||q==="=~"||q==="!~")&&(se=q)}else if(ne instanceof s.Token)switch(ne.type){case"label-key":J=W(ne);break;case"label-value":X=W(ne),X=X.substring(1,X.length-1);const q=A[se];q&&j.push({name:J,operator:q,value:X});break}}return j}function w(k,j){if(k===p.fD.None)return{start:V(j.from,!1).toString(),end:V(j.to,!0).toString()};const H=V(j.from,!1),J=(0,m.rs)(H,L(k)*60),X=V(j.to,!0),se=C(X,L(k))*60;if(J===se){const q=se+L(k)*60;return{start:J.toString(),end:q.toString()}}const ae=J.toString(),ne=se.toString();return{start:ae,end:ne}}function L(k){switch(k){case p.fD.Medium:return 10;case p.fD.High:return 60;default:return 1}}function V(k,j){return typeof k=="string"&&(k=l.parse(k,j)),Math.ceil(k.valueOf()/1e3)}function K(k,j){return j===void 0&&(j=d.o6),k.length=Math.min(k.length,j),k}},20719:(G,I,e)=>{"use strict";e.d(I,{AW:()=>m,Ay:()=>u,n6:()=>i});const t=[{label:"$__interval",sortValue:"$__interval"},{label:"$__rate_interval",sortValue:"$__rate_interval"},{label:"$__range",sortValue:"$__range"},{label:"1m",sortValue:"00:01:00"},{label:"5m",sortValue:"00:05:00"},{label:"10m",sortValue:"00:10:00"},{label:"30m",sortValue:"00:30:00"},{label:"1h",sortValue:"01:00:00"},{label:"1d",sortValue:"24:00:00"}],n=["by","group_left","group_right","ignoring","on","offset","without"],s=null,r=[{label:"acos",insertText:"acos",detail:"acos(v instant-vector)",documentation:"calculates the arccosine of all elements in v"},{label:"acosh",insertText:"acosh",detail:"acosh(v instant-vector)",documentation:"calculates the inverse hyperbolic cosine of all elements in v"},{label:"asin",insertText:"asin",detail:"asin(v instant-vector)",documentation:"calculates the arcsine of all elements in v"},{label:"asinh",insertText:"asinh",detail:"asinh(v instant-vector)",documentation:"calculates the inverse hyperbolic sine of all elements in v"},{label:"atan",insertText:"atan",detail:"atan(v instant-vector)",documentation:"calculates the arctangent of all elements in v"},{label:"atanh",insertText:"atanh",detail:"atanh(v instant-vector)",documentation:"calculates the inverse hyperbolic tangent of all elements in v"},{label:"cos",insertText:"cos",detail:"cos(v instant-vector)",documentation:"calculates the cosine of all elements in v"},{label:"cosh",insertText:"cosh",detail:"cosh(v instant-vector)",documentation:"calculates the hyperbolic cosine of all elements in v"},{label:"sin",insertText:"sin",detail:"sin(v instant-vector)",documentation:"calculates the sine of all elements in v"},{label:"sinh",insertText:"sinh",detail:"sinh(v instant-vector)",documentation:"calculates the hyperbolic sine of all elements in v"},{label:"tan",insertText:"tan",detail:"tan(v instant-vector)",documentation:"calculates the tangent of all elements in v"},{label:"tanh",insertText:"tanh",detail:"tanh(v instant-vector)",documentation:"calculates the hyperbolic tangent of all elements in v"}],m=[...[{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"group",insertText:"group",documentation:"All values in the resulting vector are 1"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"count_values",insertText:"count_values",documentation:"Count number of elements with the same value"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"},{label:"quantile",insertText:"quantile",documentation:"Calculate \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) over dimensions"}],...r,{insertText:"abs",label:"abs",detail:"abs(v instant-vector)",documentation:"Returns the input vector with all sample values converted to their absolute value."},{insertText:"absent",label:"absent",detail:"absent(v instant-vector)",documentation:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{insertText:"absent_over_time",label:"absent_over_time",detail:"absent(v range-vector)",documentation:"Returns an empty vector if the range vector passed to it has any elements and a 1-element vector with the value 1 if the range vector passed to it has no elements."},{insertText:"ceil",label:"ceil",detail:"ceil(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` up to the nearest integer."},{insertText:"changes",label:"changes",detail:"changes(v range-vector)",documentation:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{insertText:"clamp",label:"clamp",detail:"clamp(v instant-vector, min scalar, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min` and an upper limit of `max`."},{insertText:"clamp_max",label:"clamp_max",detail:"clamp_max(v instant-vector, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{insertText:"clamp_min",label:"clamp_min",detail:"clamp_min(v instant-vector, min scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{insertText:"deg",label:"deg",detail:"deg(v instant-vector)",documentation:"Converts radians to degrees for all elements in v"},{insertText:"day_of_month",label:"day_of_month",detail:"day_of_month(v=vector(time()) instant-vector)",documentation:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{insertText:"day_of_week",label:"day_of_week",detail:"day_of_week(v=vector(time()) instant-vector)",documentation:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{insertText:"day_of_year",label:"day_of_year",detail:"day_of_year(v=vector(time()) instant-vector)",documentation:"Returns the day of the year for each of the given times in UTC. Returned values are from 1 to 365 for non-leap years, and 1 to 366 in leap years."},{insertText:"days_in_month",label:"days_in_month",detail:"days_in_month(v=vector(time()) instant-vector)",documentation:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{insertText:"delta",label:"delta",detail:"delta(v range-vector)",documentation:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{insertText:"deriv",label:"deriv",detail:"deriv(v range-vector)",documentation:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{insertText:"drop_common_labels",label:"drop_common_labels",detail:"drop_common_labels(instant-vector)",documentation:"Drops all labels that have the same name and value across all series in the input vector."},{insertText:"exp",label:"exp",detail:"exp(v instant-vector)",documentation:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{insertText:"floor",label:"floor",detail:"floor(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` down to the nearest integer."},{insertText:"histogram_quantile",label:"histogram_quantile",detail:"histogram_quantile(\u03C6 float, b instant-vector)",documentation:"Calculates the \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{insertText:"holt_winters",label:"holt_winters",detail:"holt_winters(v range-vector, sf scalar, tf scalar)",documentation:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"hour",label:"hour",detail:"hour(v=vector(time()) instant-vector)",documentation:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{insertText:"idelta",label:"idelta",detail:"idelta(v range-vector)",documentation:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{insertText:"increase",label:"increase",detail:"increase(v range-vector)",documentation:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{insertText:"irate",label:"irate",detail:"irate(v range-vector)",documentation:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{insertText:"label_join",label:"label_join",detail:"label_join(v instant-vector, dst_label string, separator string, src_label_1 string, src_label_2 string, ...)",documentation:"For each timeseries in `v`, joins all the values of all the `src_labels` using `separator` and returns the timeseries with the label `dst_label` containing the joined value. There can be any number of `src_labels` in this function."},{insertText:"label_replace",label:"label_replace",detail:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",documentation:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{insertText:"ln",label:"ln",detail:"ln(v instant-vector)",documentation:"Calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{insertText:"log2",label:"log2",detail:"log2(v instant-vector)",documentation:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"log10",label:"log10",detail:"log10(v instant-vector)",documentation:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"minute",label:"minute",detail:"minute(v=vector(time()) instant-vector)",documentation:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{insertText:"month",label:"month",detail:"month(v=vector(time()) instant-vector)",documentation:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{insertText:"pi",label:"pi",detail:"pi()",documentation:"Returns pi"},{insertText:"predict_linear",label:"predict_linear",detail:"predict_linear(v range-vector, t scalar)",documentation:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{insertText:"rad",label:"rad",detail:"rad(v instant-vector)",documentation:"Converts degrees to radians for all elements in v"},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{insertText:"resets",label:"resets",detail:"resets(v range-vector)",documentation:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{insertText:"round",label:"round",detail:"round(v instant-vector, to_nearest=1 scalar)",documentation:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{insertText:"scalar",label:"scalar",detail:"scalar(v instant-vector)",documentation:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{insertText:"sgn",label:"sgn",detail:"sgn(v instant-vector)",documentation:"Returns a vector with all sample values converted to their sign, defined as this: 1 if v is positive, -1 if v is negative and 0 if v is equal to zero."},{insertText:"sort",label:"sort",detail:"sort(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in ascending order."},{insertText:"sort_desc",label:"sort_desc",detail:"sort_desc(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in descending order."},{insertText:"sqrt",label:"sqrt",detail:"sqrt(v instant-vector)",documentation:"Calculates the square root of all elements in `v`."},{insertText:"time",label:"time",detail:"time()",documentation:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{insertText:"timestamp",label:"timestamp",detail:"timestamp(v instant-vector)",documentation:"Returns the timestamp of each of the samples of the given vector as the number of seconds since January 1, 1970 UTC."},{insertText:"vector",label:"vector",detail:"vector(s scalar)",documentation:"Returns the scalar `s` as a vector with no labels."},{insertText:"year",label:"year",detail:"year(v=vector(time()) instant-vector)",documentation:"Returns the year for each of the given times in UTC."},{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average value of all points in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum value of all points in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum value of all points in the specified interval."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The most recent point value in specified interval."},{insertText:"present_over_time",label:"present_over_time",detail:"present_over_time(range-vector)",documentation:"The value 1 for any series in the specified interval."},{insertText:"histogram_avg",label:"histogram_avg",detail:"histogram_avg(v instant-vector)",documentation:"Returns the arithmetic average of observed values stored in a native histogram. Samples that are not native histograms are ignored and do not show up in the returned vector."},{insertText:"histogram_count",label:"histogram_count",detail:"histogram_count(v instant-vector)",documentation:"Returns the count of observations stored in a native histogram."},{insertText:"histogram_sum",label:"histogram_sum",detail:"histogram_sum(v instant-vector)",documentation:"Returns the sum of observations stored in a native histogram."},{insertText:"histogram_fraction",label:"histogram_fraction",detail:"histogram_fraction(lower scalar, upper scalar, v instant-vector)",documentation:"Returns the estimated fraction of observations between the provided lower and upper values."},{insertText:"histogram_stddev",label:"histogram_stddev",detail:"histogram_stddev(v instant-vector)",documentation:"Returns the estimated standard deviation of observations in a native histogram, based on the geometric mean of the buckets where the observations lie."},{insertText:"histogram_stdvar",label:"histogram_stdvar",detail:"histogram_stdvar(v instant-vector)",documentation:"Returns the estimated standard variance of observations in a native histogram."}],l=m.map(d=>d.label),i={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp(`\\b(?:${m.map(d=>d.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],idList:{pattern:/\d+(\|\d+)+/,alias:"number"},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp(`/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:${n.join("|")})\\b`,"i"),punctuation:/[{};()`,.]/},u=i},32370:(G,I,e)=>{"use strict";e.d(I,{l:()=>v,z:()=>C});var t=e(20719),n=e(1220),s=e(75161),r=e(38961),o=e(15145);function m(){return[{id:o.jN.HistogramQuantile,name:"Histogram quantile",params:[{name:"Quantile",type:"number",options:[.99,.95,.9,.75,.5,.25]}],defaultParams:[.9],category:o.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},l({id:o.jN.HistogramAvg}),l({id:o.jN.HistogramCount}),l({id:o.jN.HistogramSum}),{id:o.jN.HistogramFraction,name:"Histogram fraction",params:[{name:"Lower scalar",type:"number"},{name:"Upper scalar",type:"number"}],defaultParams:[0,.2],category:o.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},l({id:o.jN.HistogramStddev}),l({id:o.jN.HistogramStdvar}),{id:o.jN.LabelReplace,name:"Label replace",params:[{name:"Destination label",type:"string"},{name:"Replacement",type:"string"},{name:"Source label",type:"string"},{name:"Regex",type:"string"}],category:o.Ag.Functions,defaultParams:["","$1","","(.*)"],renderer:n.kf,addOperationHandler:n.iZ},{id:o.jN.Ln,name:"Ln",params:[],defaultParams:[],category:o.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},i(o.jN.Changes),i(o.jN.Rate,!0),i(o.jN.Irate),i(o.jN.Increase,!0),i(o.jN.Idelta),i(o.jN.Delta),l({id:o.jN.HoltWinters,params:[(0,n.z2)(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:o.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:p,changeTypeHandler:u}),l({id:o.jN.PredictLinear,params:[(0,n.z2)(),{name:"Seconds from now",type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:o.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:p,changeTypeHandler:u}),l({id:o.jN.QuantileOverTime,params:[(0,n.z2)(),{name:"Quantile",type:"number"}],defaultParams:["$__interval",.5],alternativesKey:"overtime function",category:o.Ag.RangeFunctions,renderer:n.Kl,addOperationHandler:p,changeTypeHandler:u}),...s.Iu,{id:o.jN.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:o.Ag.BinaryOps,renderer:(S,O,x)=>x,addOperationHandler:c},l({id:o.jN.Abs}),l({id:o.jN.Absent}),l({id:o.jN.Acos,category:o.Ag.Trigonometric}),l({id:o.jN.Acosh,category:o.Ag.Trigonometric}),l({id:o.jN.Asin,category:o.Ag.Trigonometric}),l({id:o.jN.Asinh,category:o.Ag.Trigonometric}),l({id:o.jN.Atan,category:o.Ag.Trigonometric}),l({id:o.jN.Atanh,category:o.Ag.Trigonometric}),l({id:o.jN.Ceil}),l({id:o.jN.Clamp,name:"Clamp",params:[{name:"Minimum Scalar",type:"number"},{name:"Maximum Scalar",type:"number"}],defaultParams:[1,1]}),l({id:o.jN.ClampMax,params:[{name:"Maximum Scalar",type:"number"}],defaultParams:[1]}),l({id:o.jN.ClampMin,params:[{name:"Minimum Scalar",type:"number"}],defaultParams:[1]}),l({id:o.jN.Cos,category:o.Ag.Trigonometric}),l({id:o.jN.Cosh,category:o.Ag.Trigonometric}),l({id:o.jN.DayOfMonth,category:o.Ag.Time}),l({id:o.jN.DayOfWeek,category:o.Ag.Time}),l({id:o.jN.DayOfYear,category:o.Ag.Time}),l({id:o.jN.DaysInMonth,category:o.Ag.Time}),l({id:o.jN.Deg}),i(o.jN.Deriv),l({id:o.jN.Exp}),l({id:o.jN.Floor}),l({id:o.jN.Group}),l({id:o.jN.Hour}),l({id:o.jN.LabelJoin,params:[{name:"Destination Label",type:"string",editor:r.r},{name:"Separator",type:"string"},{name:"Source Label",type:"string",restParam:!0,optional:!0,editor:r.r}],defaultParams:["",",",""],renderer:y,explainHandler:f,addOperationHandler:P}),l({id:o.jN.Log10}),l({id:o.jN.Log2}),l({id:o.jN.Minute}),l({id:o.jN.Month}),l({id:o.jN.Pi,renderer:S=>`${S.id}()`}),l({id:o.jN.Quantile,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:n.jY}),l({id:o.jN.Rad}),i(o.jN.Resets),l({id:o.jN.Round,category:o.Ag.Functions,params:[{name:"To Nearest",type:"number"}],defaultParams:[1]}),l({id:o.jN.Scalar}),l({id:o.jN.Sgn}),l({id:o.jN.Sin,category:o.Ag.Trigonometric}),l({id:o.jN.Sinh,category:o.Ag.Trigonometric}),l({id:o.jN.Sort}),l({id:o.jN.SortDesc}),l({id:o.jN.Sqrt}),l({id:o.jN.Stddev}),l({id:o.jN.Tan,category:o.Ag.Trigonometric}),l({id:o.jN.Tanh,category:o.Ag.Trigonometric}),l({id:o.jN.Time,renderer:S=>`${S.id}()`}),l({id:o.jN.Timestamp}),l({id:o.jN.Vector,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:S=>`${S.id}(${S.params[0]})`}),l({id:o.jN.Year})]}function l(T){return{...T,id:T.id,name:T.name??(0,n.DQ)(T.id),params:T.params??[],defaultParams:T.defaultParams??[],category:T.category??o.Ag.Functions,renderer:T.renderer??(T.params?n.kf:n.jY),addOperationHandler:T.addOperationHandler??n.iZ}}function i(T,S=!1){return{id:T,name:(0,n.DQ)(T),params:[(0,n.z2)(S)],defaultParams:[S?"$__rate_interval":"$__interval"],alternativesKey:"range function",category:o.Ag.RangeFunctions,renderer:d,addOperationHandler:p,changeTypeHandler:u}}function u(T,S){return(T.params[0]==="$__rate_interval"&&S.defaultParams[0]!=="$__rate_interval"||T.params[0]==="$__interval"&&S.defaultParams[0]!=="$__interval")&&(T.params=S.defaultParams),T}function d(T,S,O){let x=(T.params??[])[0]??"5m";return`${S.id}(${O}[${x}])`}function p(T,S,O){const x={id:T.id,params:T.defaultParams};return S.operations.length>0&&O.getOperationDef(S.operations[0].id).addOperationHandler===p?{...S,operations:[x,...S.operations.slice(1)]}:{...S,operations:[x,...S.operations]}}function c(T,S){return{...S,binaryQueries:[...S.binaryQueries??[],{operator:"/",query:S}]}}function y(T,S,O){const x=T.params[0]??"",M=`"${T.params[1]??""}"`;return`${T.id}(${O}, "${x}", ${M}, "${T.params.slice(2).join(M)}")`}function f(T,S){let O=S?.documentation??"no docs";return typeof T.params[1]!="string"&&(O+=" \u{1F6A8}\u{1F6A8}\u{1F6A8} The `separator` must be a string."),O}function P(T,S){const O={id:T.id,params:T.defaultParams};return{...S,operations:[...S.operations,O]}}function a(){return[...(0,n.G3)(o.jN.Sum),...(0,n.G3)(o.jN.Avg),...(0,n.G3)(o.jN.Min),...(0,n.G3)(o.jN.Max),...(0,n.G3)(o.jN.Count),...(0,n.jC)(o.jN.TopK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,n.jC)(o.jN.BottomK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,n.jC)(o.jN.CountValues,{params:[{name:"Identifier",type:"string"}],defaultParams:["count"]}),E(o.jN.SumOverTime),E(o.jN.AvgOverTime),E(o.jN.MinOverTime),E(o.jN.MaxOverTime),E(o.jN.CountOverTime),E(o.jN.LastOverTime),E(o.jN.PresentOverTime),E(o.jN.AbsentOverTime),E(o.jN.StddevOverTime)]}function E(T){return{id:T,name:(0,n.DQ)(T),params:[(0,n.z2)()],defaultParams:["$__interval"],alternativesKey:"overtime function",category:o.Ag.RangeFunctions,renderer:g,addOperationHandler:p}}function g(T,S,O){let x=(T.params??[])[0]??"$__interval";return`${S.id}(${O}[${x}])`}var h=e(83077);class D{constructor(S){this.categories=[],this.operationsRegistry=new h.O(S)}setOperationCategories(S){this.categories=S}getOperationsForCategory(S){return this.operationsRegistry.list().filter(O=>O.category===S&&!O.hideFromList)}getAlternativeOperations(S){return this.operationsRegistry.list().filter(O=>O.alternativesKey&&O.alternativesKey===S)}getCategories(){return this.categories}getOperationDef(S){return this.operationsRegistry.getIfExists(S)}renderOperations(S,O){for(const x of O){const b=this.operationsRegistry.getIfExists(x.id);if(!b)throw new Error(`Could not find operation ${x.id} in the registry`);S=b.renderer(x,b,S)}return S}renderBinaryQueries(S,O){if(O)for(const x of O)S=`${this.renderBinaryQuery(S,x)}`;return S}renderBinaryQuery(S,O){let x=S+` ${O.operator} `;return O.vectorMatches&&(x+=`${O.vectorMatchesType}(${O.vectorMatches}) `),x+this.renderQuery(O.query,!0)}renderLabels(S){if(S.length===0)return"";let O="{";for(const x of S)O!=="{"&&(O+=", "),O+=`${x.label}${x.op}"${x.value}"`;return O+"}"}renderQuery(S,O){let x=`${S.metric??""}${this.renderLabels(S.labels)}`;return x=this.renderOperations(x,S.operations),!O&&this.hasBinaryOp(S)&&S.binaryQueries?.length&&(x=`(${x})`),x=this.renderBinaryQueries(x,S.binaryQueries),O&&(this.hasBinaryOp(S)||S.binaryQueries?.length)&&(x=`(${x})`),x}hasBinaryOp(S){return S.operations.find(O=>this.getOperationDef(O.id)?.category===o.Ag.BinaryOps)!==void 0}}class v extends D{constructor(){super(()=>{const S=[...m(),...a()];for(const O of S){const x=t.AW.find(b=>b.insertText===O.id);x&&(O.documentation=x.documentation)}return S}),this.setOperationCategories([o.Ag.Aggregations,o.Ag.RangeFunctions,o.Ag.Functions,o.Ag.BinaryOps,o.Ag.Trigonometric,o.Ag.Time])}getQueryPatterns(){return[{name:"Rate then sum",type:o.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]},{name:"Rate then sum by(label) then avg",type:o.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:[""]},{id:"avg",params:[]}]},{name:"Histogram quantile on rate",type:o.n5.Histogram,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Histogram quantile on increase",type:o.n5.Histogram,operations:[{id:"increase",params:["$__rate_interval"]},{id:"__max_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Binary Query",type:o.n5.Binary,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}],binaryQueries:[{operator:"/",query:{metric:"",labels:[],operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]}}]}]}}const C=new v},75161:(G,I,e)=>{"use strict";e.d(I,{AE:()=>r,C8:()=>s,Iu:()=>o});var t=e(1220),n=e(15145);const s=[{id:n.jN.Addition,name:"Add scalar",sign:"+"},{id:n.jN.Subtraction,name:"Subtract scalar",sign:"-"},{id:n.jN.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:n.jN.DivideBy,name:"Divide by scalar",sign:"/"},{id:n.jN.Modulo,name:"Modulo by scalar",sign:"%"},{id:n.jN.Exponent,name:"Exponent",sign:"^"},{id:n.jN.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:n.jN.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:n.jN.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:n.jN.LessThan,name:"Less than",sign:"<",comparison:!0},{id:n.jN.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:n.jN.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],r=s.reduce((l,i)=>(l[i.sign]={id:i.id,comparison:i.comparison},l),{}),o=s.map(l=>{const i=[{name:"Value",type:"number"}];let u=[2];return l.comparison&&(i.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),u=[2,!1]),{id:l.id,name:l.name,params:i,defaultParams:u,alternativesKey:"binary scalar operations",category:n.Ag.BinaryOps,renderer:m(l.sign),addOperationHandler:t.iZ}});function m(l){return function(u,d,p){let c=u.params[0],y="";return u.params.length===2&&(y=u.params[1]?" bool":""),`${p} ${l}${y} ${c}`}}},38961:(G,I,e)=>{"use strict";e.d(I,{r:()=>m});var t=e(96540),n=e(50877),s=e(21594),r=e(32370),o=e(1220);function m({onChange:i,index:u,operationId:d,value:p,query:c,datasource:y}){const[f,P]=(0,t.useState)({});return t.createElement(s.l6,{inputId:(0,o.OS)(d,u),autoFocus:p===""?!0:void 0,openMenuOnFocus:!0,onOpenMenu:async()=>{P({isLoading:!0});const a=await l(c,y);P({options:a,isLoading:void 0})},isLoading:f.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:f.options,value:(0,n.z)(p),onChange:a=>i(u,a.value)})}async function l(i,u){let d=i.labels;u.type==="prometheus"&&(d=[{label:"__name__",op:"=",value:i.metric},...i.labels]);const p=r.z.renderLabels(d),c=await u.languageProvider.fetchLabelsWithMatch(p);return Object.keys(c).map(y=>({label:y,value:y}))}},95899:(G,I,e)=>{"use strict";e.d(I,{dm:()=>it,o6:()=>Ke});var t=e(32196),n=e(76459),s=e.n(n),r=e(96540),o=e(23257),m=e.n(o),l=e(50877),i=e(13544),u=e(97801),d=e(81580),p=e(32264),c=e(40845),y=e(55852),f=e(14578),P=e(88824),a=e(40276),E=e(21594),g=e(39268),h=e(14186),D=e(2543),v=e(91793),C=e(8887);const T=({children:Ge,maxHeight:qe,innerRef:bt,innerProps:Ft})=>{const Xt=(0,c.$j)(),Lt=(0,P.J)(Xt);return r.createElement("div",{...Ft,className:Lt.menu,style:{maxHeight:qe},"aria-label":"Select options menu"},r.createElement(a.E,{scrollRefCallback:bt,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0},Ge))};T.displayName="SelectMenu";const S=37,O=7,x=({children:Ge,maxHeight:qe,options:bt,getValue:Ft})=>{const Xt=(0,c.$j)(),Lt=(0,P.J)(Xt),[Qt]=Ft(),gn=(Qt?bt.findIndex(Rt=>Rt.value===Qt.value):0)*S;if(!Array.isArray(Ge))return null;const Nt=((0,D.max)(bt.map(Rt=>Rt.label?.length))??0)*O,ht=Math.min(bt.length*S,qe);return r.createElement(v.Y1,{className:Lt.menu,height:ht,width:Nt,"aria-label":"Select options menu",itemCount:Ge.length,itemSize:S,initialScrollOffset:gn},({index:Rt,style:_t})=>r.createElement("div",{style:{..._t,overflow:"hidden"}},Ge[Rt]))};x.displayName="VirtualizedSelectMenu";const b=({children:Ge,data:qe,innerProps:bt,innerRef:Ft,isFocused:Xt,isSelected:Lt,renderOptionLabel:Qt})=>{const an=(0,c.$j)(),gn=(0,P.J)(an),ut=qe.icon?(0,C.Uo)(qe.icon):void 0,{onMouseMove:Nt,onMouseOver:ht,...Rt}=bt;return r.createElement("div",{ref:Ft,className:(0,t.cx)(gn.option,Xt&&gn.optionFocused,Lt&&gn.optionSelected,qe.isDisabled&&gn.optionDisabled),...Rt,"data-testid":i.Tp.components.Select.option,title:qe.title},ut&&r.createElement(f.I,{name:ut,className:gn.optionIcon}),qe.imgUrl&&r.createElement("img",{className:gn.optionImage,src:qe.imgUrl,alt:qe.label||String(qe.value)}),r.createElement("div",{className:gn.optionBody},r.createElement("span",null,Qt?Qt(qe):Ge),qe.description&&r.createElement("div",{className:gn.optionDescription},qe.description),qe.component&&r.createElement(qe.component,null)))};b.displayName="SelectMenuOptions";var M=e(81996),A=e(26115),R=e(65307),B=e(37390),U=e(10354),W=e(62930),N=e(60782),w=e(19727),L=e(19384),V=e(15292),K=e(56034),k=e(14110),j=e(50556);async function H(Ge,qe,bt){let Ft=!0;const Xt=Ge.languageProvider.metricsMetadata;Xt&&Object.keys(Xt).length===0&&(Ft=!1);let Lt={},Qt={},an;return an=bt?.map(gn=>{const ut=J(gn,Ge),Nt=`${gn}\xA6${ut.description}`;return Lt[gn]=ut,Qt[Nt]=ut,ut}),{isLoading:!1,hasMetadata:Ft,metrics:an??[],metaHaystackDictionary:Qt,nameHaystackDictionary:Lt,totalMetricCount:an?.length??0,filteredMetricCount:an?.length??0}}function J(Ge,qe){let bt=(0,j.AU)(Ge,qe.languageProvider.metricsMetadata);const Ft=(0,j.pK)(Ge,qe.languageProvider.metricsMetadata);["histogram","summary"].forEach(Qt=>{Ft?.toLowerCase().includes(Qt)&&bt!==Qt&&(bt+=` (${Qt})`)});const Xt=Ge.match(/^\w+_bucket$|^\w+_bucket{.*}$/);return bt==="histogram"&&!Xt&&(bt="native histogram"),{value:Ge,type:bt,description:Ft}}function X(Ge,qe){const bt=se(Ge);return!Ge.isLoading&&Ge.filteredMetricCount!==bt.length&&qe(Be(bt.length)),ne(bt,Ge.pageNum,Ge.resultsPerPage)}function se(Ge){let qe=Ge.metrics;return Ge.fuzzySearchQuery&&!Ge.useBackend&&(Ge.fullMetaSearch?qe=Ge.metaHaystackOrder.map(bt=>Ge.metaHaystackDictionary[bt]):qe=Ge.nameHaystackOrder.map(bt=>Ge.nameHaystackDictionary[bt])),Ge.selectedTypes.length>0&&(qe=qe.filter((bt,Ft)=>Ge.selectedTypes.some(Lt=>bt.type&&Lt.value?bt.type.includes(Lt.value):!bt.type&&Lt.value==="no type"))),Ge.includeNullMetadata||(qe=qe.filter(bt=>bt.type!==void 0&&bt.description!==void 0)),qe}function ae(Ge){if(!Ge.metrics.length)return[];const qe=Ge.resultsPerPage===0?1:Ge.resultsPerPage,bt=Math.floor(se(Ge).length/qe)+1;return[...Array(bt).keys()].map(Ft=>Ft+1)}function ne(Ge,qe,bt){const Ft=bt===0?1:bt,Xt=qe===1?0:(qe-1)*Ft,Lt=Xt+Ft;return Ge.slice(Xt,Lt)}const q=(Ge,qe,bt)=>Ge<1?1:Ge>bt?bt:Ge??qe;async function ee(Ge,qe,bt){const Ft=(0,A.b4)(Ge),Xt=qe.map(an=>`,${an.label}="${an.value}"`),Lt=`label_values({__name__=~".*${Ft}"${qe?Xt.join():""}},__name__)`;return await bt.metricFindQuery(Lt).then(an=>an.map(gn=>J(gn.text,bt)))}function z(Ge,qe,bt,Ft){switch(Ge){case"grafana_prom_metric_encycopedia_tracking":(0,k.rR)(Ge,{metric:bt,hasMetadata:qe?.hasMetadata,totalMetricCount:qe?.totalMetricCount,fuzzySearchQuery:qe?.fuzzySearchQuery,fullMetaSearch:qe?.fullMetaSearch,selectedTypes:qe?.selectedTypes,useRegexSearch:qe?.useBackend,includeResultsWithoutMetadata:qe?.includeNullMetadata});case"grafana_prom_metric_encycopedia_disable_text_wrap_interaction":(0,k.rR)(Ge,{disableTextWrap:qe?.disableTextWrap});case"grafana_prometheus_metric_encyclopedia_open":(0,k.rR)(Ge,{query:Ft})}}const te=[{value:"counter",description:"A cumulative metric that represents a single monotonically increasing counter whose value can only increase or be reset to zero on restart."},{value:"gauge",description:"A metric that represents a single numerical value that can arbitrarily go up and down."},{value:"histogram",description:"A histogram samples observations (usually things like request durations or response sizes) and counts them in configurable buckets."},{value:"native histogram",description:"Native histograms are different from classic Prometheus histograms in a number of ways: Native histogram bucket boundaries are calculated by a formula that depends on the scale (resolution) of the native histogram, and are not user defined."},{value:"summary",description:"A summary samples observations (usually things like request durations and response sizes) and can calculate configurable quantiles over a sliding time window."},{value:"unknown",description:"These metrics have been given the type unknown in the metadata."},{value:"no type",description:"These metrics have no defined type in the metadata."}],ie={browse:"Search metrics by name",metadataSearchSwitch:"Include description in search",type:"Filter by type",includeNullMetadata:"Include results with no metadata",setUseBackend:"Enable regex search"};function ce(Ge){const{state:qe,onChangeFullMetaSearch:bt,onChangeIncludeNullMetadata:Ft,onChangeDisableTextWrap:Xt,onChangeUseBackend:Lt}=Ge,Qt=(0,c.$j)(),an=ue(Qt);return r.createElement(r.Fragment,null,r.createElement("div",{className:an.selectItem},r.createElement(V.d,{"data-testid":Fe.searchWithMetadata,value:qe.fullMetaSearch,disabled:qe.useBackend||!qe.hasMetadata,onChange:()=>bt()}),r.createElement("div",{className:an.selectItemLabel},ie.metadataSearchSwitch)),r.createElement("div",{className:an.selectItem},r.createElement(V.d,{value:qe.includeNullMetadata,disabled:!qe.hasMetadata,onChange:()=>Ft()}),r.createElement("div",{className:an.selectItemLabel},ie.includeNullMetadata)),r.createElement("div",{className:an.selectItem},r.createElement(V.d,{value:qe.disableTextWrap,onChange:()=>Xt()}),r.createElement("div",{className:an.selectItemLabel},"Disable text wrap")),r.createElement("div",{className:an.selectItem},r.createElement(V.d,{"data-testid":Fe.setUseBackend,value:qe.useBackend,onChange:()=>Lt()}),r.createElement("div",{className:an.selectItemLabel},ie.setUseBackend,"\xA0"),r.createElement(K.m,{content:"Filter metric names by regex search, using an additional call on the Prometheus API.",placement:"bottom-end"},r.createElement(f.I,{name:"info-circle",size:"xs",className:an.settingsIcon}))))}function ue(Ge){return{settingsIcon:(0,t.css)({color:Ge.colors.text.secondary}),selectItem:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"center",padding:"4px 0"}),selectItemLabel:(0,t.css)({margin:`0 0 0 ${Ge.spacing(1)}`,alignSelf:"center",color:Ge.colors.text.secondary,fontSize:"12px"})}}var fe=e(67061);function Te({feedbackUrl:Ge}){const qe=(0,c.of)(he);return r.createElement(fe.B,null,r.createElement("a",{href:Ge,className:qe.link,title:"The metrics explorer is new, please let us know how we can improve it",target:"_blank",rel:"noreferrer noopener"},r.createElement(f.I,{name:"comment-alt-message"})," Give feedback"))}function he(Ge){return{link:(0,t.css)({color:Ge.colors.text.secondary,fontSize:Ge.typography.bodySmall.fontSize,":hover":{color:Ge.colors.text.link},margin:"-25px 0 30px 0"})}}var de=e(4936);function le(Ge){const{metrics:qe,onChange:bt,onClose:Ft,query:Xt,state:Lt,disableTextWrap:Qt}=Ge,an=(0,c.$j)(),gn=pe(an,Qt);function ut(ln){ln.value&&(bt({...Xt,metric:ln.value}),z("grafana_prom_metric_encycopedia_tracking",Lt,ln.value),Ft())}function Nt(ln){return Lt.fullMetaSearch&&ln?r.createElement(r.Fragment,null,r.createElement("td",null,Rt(ln.type??"")),r.createElement("td",null,r.createElement(m(),{textToHighlight:ln.description??"",searchWords:Lt.metaHaystackMatches,autoEscape:!0,highlightClassName:gn.matchHighLight}))):r.createElement(r.Fragment,null,r.createElement("td",null,Rt(ln.type??"")),r.createElement("td",null,ln.description??""))}function ht(ln,bn,In){return r.createElement(r.Fragment,null,ln,r.createElement("span",{className:gn.tooltipSpace},r.createElement(K.m,{content:r.createElement(r.Fragment,null,"When creating a ",bn,", Prometheus exposes multiple series with the type counter."," ",(0,de.jW)(In)),placement:"bottom-start",interactive:!0},r.createElement(f.I,{name:"info-circle",size:"xs"}))))}function Rt(ln){return ln?ln.includes("(summary)")?ht(ln,"summary","https://prometheus.io/docs/concepts/metric_types/#summary"):ln.includes("(histogram)")?ht(ln,"histogram","https://prometheus.io/docs/concepts/metric_types/#histogram"):ln:""}function _t(){let ln;return Lt.fuzzySearchQuery||(ln="There are no metrics found in the data source."),Xt.labels.length>0&&(ln="There are no metrics found. Try to expand your label filters."),(Lt.fuzzySearchQuery||Lt.selectedTypes.length>0)&&(ln="There are no metrics found. Try to expand your search and filters."),r.createElement("tr",{className:gn.noResults},r.createElement("td",{colSpan:3},ln))}function on(ln){return ln.useBackend?[ln.fuzzySearchQuery]:ln.fullMetaSearch?ln.metaHaystackMatches:ln.nameHaystackMatches}return r.createElement("table",{className:gn.table},r.createElement("thead",{className:gn.stickyHeader},r.createElement("tr",null,r.createElement("th",{className:`${gn.nameWidth} ${gn.tableHeaderPadding}`},"Name"),Lt.hasMetadata&&r.createElement(r.Fragment,null,r.createElement("th",{className:`${gn.typeWidth} ${gn.tableHeaderPadding}`},"Type"),r.createElement("th",{className:`${gn.descriptionWidth} ${gn.tableHeaderPadding}`},"Description")),r.createElement("th",{className:gn.selectButtonWidth}," "))),r.createElement("tbody",null,r.createElement(r.Fragment,null,qe.length>0&&qe.map((ln,bn)=>r.createElement("tr",{key:ln?.value??bn,className:gn.row},r.createElement("td",{className:gn.nameOverflow},r.createElement(m(),{textToHighlight:ln?.value??"",searchWords:on(Lt),autoEscape:!0,highlightClassName:gn.matchHighLight})),Lt.hasMetadata&&Nt(ln),r.createElement("td",null,r.createElement(y.$n,{size:"md",variant:"secondary",onClick:()=>ut(ln),className:gn.centerButton},"Select")))),qe.length===0&&!Lt.isLoading&&_t())))}const pe=(Ge,qe)=>({table:(0,t.css)({tableLayout:qe?void 0:"fixed",borderRadius:Ge.shape.radius.default,width:"100%",whiteSpace:qe?"nowrap":"normal",td:{padding:Ge.spacing(1)},"td,th":{minWidth:Ge.spacing(3),borderBottom:`1px solid ${Ge.colors.border.weak}`}}),row:(0,t.css)({label:"row",borderBottom:`1px solid ${Ge.colors.border.weak}`,"&:last-child":{borderBottom:0}}),tableHeaderPadding:(0,t.css)({padding:"8px"}),matchHighLight:(0,t.css)({background:"inherit",color:Ge.components.textHighlight.text,backgroundColor:Ge.components.textHighlight.background}),nameWidth:(0,t.css)({width:qe?void 0:"37.5%"}),nameOverflow:(0,t.css)({overflowWrap:qe?void 0:"anywhere"}),typeWidth:(0,t.css)({width:qe?void 0:"15%"}),descriptionWidth:(0,t.css)({width:qe?void 0:"35%"}),selectButtonWidth:(0,t.css)({width:qe?void 0:"12.5%"}),stickyHeader:(0,t.css)({position:"sticky",top:0,backgroundColor:Ge.colors.background.primary}),noResults:(0,t.css)({textAlign:"center",color:Ge.colors.text.secondary}),tooltipSpace:(0,t.css)({marginLeft:"4px"}),centerButton:(0,t.css)({display:"block",margin:"auto",border:"none"})});var ve=e(78036);const be=(Ge,qe)=>({modal:(0,t.css)({width:"85vw",[Ge.breakpoints.down("md")]:{width:"100%"},[Ge.breakpoints.up("xl")]:{width:"60%"}}),inputWrapper:(0,t.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),inputItemFirst:(0,t.css)({flexBasis:"40%",paddingRight:"16px",[Ge.breakpoints.down("md")]:{paddingRight:"0px",paddingBottom:"16px"}}),inputItem:(0,t.css)({flexGrow:1,flexBasis:"20%",[Ge.breakpoints.down("md")]:{minWidth:"100%"}}),selectWrapper:(0,t.css)({marginBottom:Ge.spacing(1)}),resultsAmount:(0,t.css)({color:Ge.colors.text.secondary,fontSize:"0.85rem",padding:"0 0 4px 0"}),resultsData:(0,t.css)({margin:`4px 0 ${Ge.spacing(2)} 0`}),resultsDataCount:(0,t.css)({margin:0}),resultsDataFiltered:(0,t.css)({color:Ge.colors.text.secondary,textAlign:"center",border:"solid 1px rgba(204, 204, 220, 0.25)",padding:"7px"}),resultsDataFilteredText:(0,t.css)({display:"inline",verticalAlign:"text-top"}),results:(0,t.css)({height:"calc(80vh - 310px)",overflowY:"scroll"}),resultsFooter:(0,t.css)({marginTop:"24px",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",position:"sticky"}),currentlySelected:(0,t.css)({color:"grey",opacity:"75%",fontSize:"0.75rem"}),loadingSpinner:(0,t.css)({visibility:"hidden"}),visible:(0,t.css)({visibility:"visible"}),settingsBtn:(0,t.css)({float:"right"}),noBorder:(0,t.css)({border:"none"}),resultsPerPageLabel:(0,t.css)({color:Ge.colors.text.secondary,opacity:"75%",paddingTop:"5px",fontSize:"0.85rem",marginRight:"8px"}),resultsPerPageWrapper:(0,t.css)({display:"flex"})});var Oe=e(53076);const Me=new Oe.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1});function Ue(Ge,qe,bt){const[Ft,Xt,Lt]=Me.search(Ge,qe,0,1e5);let Qt=[],an=new Set;if(Ft&&Lt){const gn=(ut,Nt)=>{Nt&&an.add(ut)};for(let ut=0;ut<Lt.length;ut++){let Nt=Lt[ut];Oe.A.highlight(Ge[Xt.idx[Nt]],Xt.ranges[Nt],gn),Qt.push(Ge[Xt.idx[Nt]])}bt([Qt,[...an]])}else qe||bt([[],[]])}const we=(0,D.debounce)(Ue,300),Re=Ge=>{const{datasource:qe,isOpen:bt,onClose:Ft,onChange:Xt,query:Lt,initialMetrics:Qt}=Ge,[an,gn]=(0,r.useReducer)(xe.reducer,(0,ve.ue)(Lt)),ut=(0,c.$j)(),Nt=be(ut,an.disableTextWrap),ht=(0,r.useCallback)(async()=>{gn(Ve(!0));const Mn=await H(qe,Lt,Qt);gn($e({isLoading:!1,hasMetadata:Mn.hasMetadata,metrics:Mn.metrics,metaHaystackDictionary:Mn.metaHaystackDictionary,nameHaystackDictionary:Mn.nameHaystackDictionary,totalMetricCount:Mn.metrics.length,filteredMetricCount:Mn.metrics.length}))},[Lt,qe,Qt]);(0,r.useEffect)(()=>{ht()},[ht]);const Rt=te.map(Mn=>({value:Mn.value,label:Mn.value,description:Mn.description})),_t=(0,r.useMemo)(()=>s()(async Mn=>{gn(Ve(!0));const vt=await ee(Mn,Lt.labels,qe);gn(Xe({metrics:vt,filteredMetricCount:vt.length,isLoading:!1}))},qe.getDebounceTimeInMilliseconds()),[qe,Lt]);function on(Mn){gn(at(Mn))}function ln(Mn){gn(Ae(Mn))}function bn(Mn,vt){an.useBackend&&Mn===""?ht():an.useBackend?_t(Mn):vt?we(Object.keys(an.metaHaystackDictionary),Mn,ln):we(Object.keys(an.nameHaystackDictionary),Mn,on)}const In=r.createElement(ce,{state:an,onChangeFullMetaSearch:()=>{const Mn=!an.fullMetaSearch;gn(re(Mn)),Xt({...Lt,fullMetaSearch:Mn}),bn(an.fuzzySearchQuery,Mn)},onChangeIncludeNullMetadata:()=>{gn(Z(!an.includeNullMetadata)),Xt({...Lt,includeNullMetadata:!an.includeNullMetadata})},onChangeDisableTextWrap:()=>{gn(ye()),Xt({...Lt,disableTextWrap:!an.disableTextWrap}),z("grafana_prom_metric_encycopedia_disable_text_wrap_interaction",an,"")},onChangeUseBackend:()=>{const Mn=!an.useBackend;gn(Ee(Mn)),Xt({...Lt,useBackend:Mn}),Mn===!1?ht():an.fuzzySearchQuery!==""&&_t(an.fuzzySearchQuery)}});return r.createElement(B.a,{"data-testid":Fe.metricModal,isOpen:bt,title:"Metrics explorer",onDismiss:Ft,"aria-label":"Browse metrics",className:Nt.modal},r.createElement(Te,{feedbackUrl:"https://forms.gle/DEMAJHoAMpe3e54CA"}),r.createElement("div",{className:Nt.inputWrapper,"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.builder.metricsExplorer},r.createElement("div",{className:(0,t.cx)(Nt.inputItem,Nt.inputItemFirst)},r.createElement(U.p,{autoFocus:!0,"data-testid":Fe.searchMetric,placeholder:ie.browse,value:an.fuzzySearchQuery,onInput:Mn=>{const vt=Mn.currentTarget.value??"";gn(nt(vt)),bn(vt,an.fullMetaSearch)}})),an.hasMetadata&&r.createElement("div",{className:Nt.inputItem},r.createElement(E.KF,{"data-testid":Fe.selectType,inputId:"my-select",options:Rt,value:an.selectedTypes,placeholder:ie.type,onChange:Mn=>gn(oe(Mn))})),r.createElement("div",null,r.createElement(W.y,{className:`${Nt.loadingSpinner} ${an.isLoading?Nt.visible:""}`})),r.createElement("div",{className:Nt.inputItem},r.createElement(N.G,{"aria-label":"Additional settings",content:In,placement:"bottom-end",closeButton:!1},r.createElement(w.e,{className:Nt.settingsBtn},r.createElement(y.$n,{variant:"secondary",size:"md",onClick:()=>gn(Se()),"data-testid":Fe.showAdditionalSettings,className:Nt.noBorder},"Additional Settings"),r.createElement(y.$n,{className:Nt.noBorder,variant:"secondary",icon:an.showAdditionalSettings?"angle-up":"angle-down"}))))),r.createElement("div",{className:Nt.resultsData},Lt.metric&&r.createElement("i",{className:Nt.currentlySelected},"Currently selected: ",Lt.metric),Lt.labels.length>0&&r.createElement("div",{className:Nt.resultsDataFiltered},r.createElement(f.I,{name:"info-circle",size:"sm"}),r.createElement("div",{className:Nt.resultsDataFilteredText},"\xA0These metrics have been pre-filtered by labels chosen in the label filters."))),r.createElement("div",{className:Nt.results},an.metrics&&r.createElement(le,{metrics:X(an,gn),onChange:Xt,onClose:Ft,query:Lt,state:an,disableTextWrap:an.disableTextWrap})),r.createElement("div",{className:Nt.resultsFooter},r.createElement("div",{className:Nt.resultsAmount},"Showing ",an.filteredMetricCount," of ",an.totalMetricCount," results"),r.createElement(L.d,{currentPage:an.pageNum??1,numberOfPages:ae(an).length,onNavigate:Mn=>{gn(Dt(Mn??1))}}),r.createElement("div",{className:Nt.resultsPerPageWrapper},r.createElement("p",{className:Nt.resultsPerPageLabel},"# Results per page\xA0"),r.createElement(U.p,{"data-testid":Fe.resultsPerPage,value:q(an.resultsPerPage,ve.J3,ve.yH),placeholder:"results per page",width:10,title:"The maximum results per page is "+ve.yH,type:"number",onInput:Mn=>{const vt=+Mn.currentTarget.value;isNaN(vt)||vt>=ve.yH||gn(gt(vt))}}))))},Fe={metricModal:"metric-modal",searchMetric:"search-metric",searchWithMetadata:"search-with-metadata",selectType:"select-type",metricCard:"metric-card",useMetric:"use-metric",searchPage:"search-page",resultsPerPage:"results-per-page",setUseBackend:"set-use-backend",showAdditionalSettings:"show-additional-settings"},xe=(0,R.Z0)({name:"metrics-modal-state",initialState:(0,ve.ue)(),reducers:{filterMetricsBackend:(Ge,qe)=>{Ge.metrics=qe.payload.metrics,Ge.filteredMetricCount=qe.payload.filteredMetricCount,Ge.isLoading=qe.payload.isLoading},buildMetrics:(Ge,qe)=>{Ge.isLoading=qe.payload.isLoading,Ge.metrics=qe.payload.metrics,Ge.hasMetadata=qe.payload.hasMetadata,Ge.metaHaystackDictionary=qe.payload.metaHaystackDictionary,Ge.nameHaystackDictionary=qe.payload.nameHaystackDictionary,Ge.totalMetricCount=qe.payload.totalMetricCount,Ge.filteredMetricCount=qe.payload.filteredMetricCount},setIsLoading:(Ge,qe)=>{Ge.isLoading=qe.payload},setFilteredMetricCount:(Ge,qe)=>{Ge.filteredMetricCount=qe.payload},setResultsPerPage:(Ge,qe)=>{Ge.resultsPerPage=qe.payload},setPageNum:(Ge,qe)=>{Ge.pageNum=qe.payload},setFuzzySearchQuery:(Ge,qe)=>{Ge.fuzzySearchQuery=qe.payload,Ge.pageNum=1},setNameHaystack:(Ge,qe)=>{Ge.nameHaystackOrder=qe.payload[0],Ge.nameHaystackMatches=qe.payload[1]},setMetaHaystack:(Ge,qe)=>{Ge.metaHaystackOrder=qe.payload[0],Ge.metaHaystackMatches=qe.payload[1]},setFullMetaSearch:(Ge,qe)=>{Ge.fullMetaSearch=qe.payload,Ge.pageNum=1},setIncludeNullMetadata:(Ge,qe)=>{Ge.includeNullMetadata=qe.payload,Ge.pageNum=1},setSelectedTypes:(Ge,qe)=>{Ge.selectedTypes=qe.payload,Ge.pageNum=1},setUseBackend:(Ge,qe)=>{Ge.useBackend=qe.payload,Ge.fullMetaSearch=!1,Ge.pageNum=1},setDisableTextWrap:Ge=>{Ge.disableTextWrap=!Ge.disableTextWrap},showAdditionalSettings:Ge=>{Ge.showAdditionalSettings=!Ge.showAdditionalSettings}}}),{setIsLoading:Ve,buildMetrics:$e,filterMetricsBackend:Xe,setResultsPerPage:gt,setPageNum:Dt,setFuzzySearchQuery:nt,setNameHaystack:at,setMetaHaystack:Ae,setFullMetaSearch:re,setIncludeNullMetadata:Z,setSelectedTypes:oe,setUseBackend:Ee,setDisableTextWrap:ye,showAdditionalSettings:Se,setFilteredMetricCount:Be}=xe.actions,We=" ",Ke=1e3;function it({datasource:Ge,query:qe,onChange:bt,onGetMetrics:Ft,labelsFilters:Xt,metricLookupDisabled:Lt,onBlur:Qt,variableEditor:an}){const gn=(0,c.of)(rt),[ut,Nt]=(0,r.useState)({}),ht=p.$.featureToggles.prometheusMetricEncyclopedia,Rt=[{value:"BrowseMetrics",label:"Metrics explorer",description:"Browse and filter all metrics and metadata with a fuzzy search"}],_t=(0,r.useCallback)((mt,lt)=>{const Tt=mt.label??mt.value;return Tt?Tt.toLowerCase?lt.split(We).reduce((zt,rn)=>{const mn=Tt.toLowerCase().includes(rn.toLowerCase());let dt=!1;return ht&&(dt=Tt==="Metrics explorer"),zt&&(mn||dt)},!0):!0:!1},[ht]),on=(0,r.useCallback)((mt,lt)=>mt.__isNew__?mt.label:r.createElement(m(),{searchWords:lt.inputValue.split(We),textToHighlight:mt.label??"",highlightClassName:gn.highlight}),[gn.highlight]),ln=(mt,lt)=>{const Tt=(0,A.b4)(mt);return ft(Tt,lt)},bn=mt=>Ge.metricFindQuery(ln(mt,Xt)).then(Tt=>{const Vt=Tt.length;(0,M.ky)(Tt),Vt>Tt.length?Nt({...ut,resultsTruncated:!0}):Nt({...ut,resultsTruncated:!1});const zt=Tt.map(rn=>({label:rn.text,value:rn.text}));return ht?[...Rt,...zt]:zt}),In=()=>Promise.resolve([]),Mn=s()(mt=>bn(mt),Ge.getDebounceTimeInMilliseconds()),vt=mt=>{const lt=mt.data;if(lt.value==="BrowseMetrics"){const Tt=mt.isFocused?gn.focus:"";return r.createElement("div",{...mt.innerProps,ref:mt.innerRef,className:`${gn.customOptionWidth} metric-encyclopedia-open`,"data-testid":i.Tp.components.Select.option,onKeyDown:Vt=>{Vt.code==="Enter"&&Nt({...ut,metricsModalOpen:!0})}},r.createElement("div",{className:`${gn.customOption} ${Tt} metric-encyclopedia-open`},r.createElement("div",null,r.createElement("div",{className:"metric-encyclopedia-open"},lt.label),r.createElement("div",{className:`${gn.customOptionDesc} metric-encyclopedia-open`},lt.description)),r.createElement(y.$n,{fill:"text",size:"sm",variant:"secondary",onClick:()=>Nt({...ut,metricsModalOpen:!0}),className:"metric-encyclopedia-open"},"Open",r.createElement(f.I,{name:"arrow-right"}))))}return b(mt)},nn=({children:mt,maxHeight:lt,innerRef:Tt,innerProps:Vt})=>{const zt=(0,c.$j)(),rn=(0,P.J)(zt),mn=!r.isValidElement(mt)&&ut.resultsTruncated;return r.createElement("div",{...Vt,className:`${rn.menu} ${gn.customMenuContainer}`,style:{maxHeight:Math.round(lt*.9)},"aria-label":"Select options menu"},r.createElement(a.E,{scrollRefCallback:Tt,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0,showScrollIndicators:!0},mt),mn&&r.createElement("div",{className:gn.customMenuFooter},r.createElement("div",null,"Only the top 1000 metrics are displayed in the metric select. Use the metrics explorer to view all metrics.")))},cn=()=>r.createElement(E.DW,{"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.builder.metricSelect,isClearable:!!an,inputId:"prometheus-metric-select",className:gn.select,value:qe.metric?(0,l.z)(qe.metric):void 0,placeholder:"Select metric",allowCustomValue:!0,formatOptionLabel:on,filterOption:_t,minMenuHeight:250,onOpenMenu:async()=>{if(Lt)return;Nt({isLoading:!0});const mt=await Ft(),lt=mt.map(Vt=>Vt.value),Tt=mt.length;mt.length>Ke&&(0,M.ky)(mt),Nt(ht?{metrics:[...Rt,...mt],isLoading:void 0,initialMetrics:lt,resultsTruncated:Tt>mt.length}:{metrics:mt,isLoading:void 0,resultsTruncated:Tt>mt.length})},loadOptions:Lt?In:Mn,isLoading:ut.isLoading,defaultOptions:ut.metrics??Array.from(new Array(25),()=>({value:""})),onChange:mt=>{const lt=mt?.value;lt?ht&&lt==="BrowseMetrics"?(z("grafana_prometheus_metric_encyclopedia_open",null,"",qe),Nt({...ut,metricsModalOpen:!0})):bt({...qe,metric:lt}):bt({...qe,metric:""})},components:ht?{Option:vt,MenuList:nn}:{MenuList:nn},onBlur:Qt});return r.createElement(r.Fragment,null,ht&&!Ge.lookupsDisabled&&ut.metricsModalOpen&&r.createElement(Re,{datasource:Ge,isOpen:ut.metricsModalOpen,onClose:()=>Nt({...ut,metricsModalOpen:!1}),query:qe,onChange:bt,initialMetrics:ut.initialMetrics??[]}),an?r.createElement(g.C,null,r.createElement(h.I,{label:"Metric",labelWidth:20,tooltip:r.createElement("div",null,"Optional: returns a list of label values for the label name in the specified metric.")},cn())):r.createElement(u.B,null,r.createElement(d.c,{label:"Metric"},cn())))}const rt=Ge=>({select:(0,t.css)({minWidth:"125px"}),highlight:(0,t.css)({label:"select__match-highlight",background:"inherit",padding:"inherit",color:Ge.colors.warning.contrastText,backgroundColor:Ge.colors.warning.main}),customOption:(0,t.css)({padding:"8px",display:"flex",justifyContent:"space-between",cursor:"pointer",":hover":{backgroundColor:Ge.colors.emphasize(Ge.colors.background.primary,.1)}}),customOptionlabel:(0,t.css)({color:Ge.colors.text.primary}),customOptionDesc:(0,t.css)({color:Ge.colors.text.secondary,fontSize:Ge.typography.size.xs,opacity:"50%"}),focus:(0,t.css)({backgroundColor:Ge.colors.emphasize(Ge.colors.background.primary,.1)}),customOptionWidth:(0,t.css)({minWidth:"400px"}),customMenuFooter:(0,t.css)({flex:0,display:"flex",justifyContent:"space-between",padding:Ge.spacing(1.5),borderTop:`1px solid ${Ge.colors.border.weak}`,color:Ge.colors.text.secondary}),customMenuContainer:(0,t.css)({display:"flex",flexDirection:"column",background:Ge.colors.background.primary,boxShadow:Ge.shadows.z3})}),ft=(Ge,qe)=>{const bt=qe?pt(qe):[];return`label_values({__name__=~".*${Ge}"${bt?bt.join(""):""}},__name__)`},pt=Ge=>Ge.map(qe=>`,${qe.label}="${qe.value}"`)},29993:(G,I,e)=>{"use strict";e.d(I,{I:()=>O});var t=e(96540),n=e(50556),s=e(81996),r=e(32370),o=e(26115),m=e(32196),l=e(2543),i=e(85269),u=e(97801),d=e(81580),p=e(39268),c=e(76892),y=e(76459),f=e.n(y),P=e(50877),a=e(13544),E=e(81392),g=e(3721),h=e(21594);function D({item:b,defaultOp:M,onChange:A,onDelete:R,onGetLabelNames:B,onGetLabelValues:U,invalidLabel:W,invalidValue:N,getLabelValuesAutofillSuggestions:w,debounceDuration:L}){const[V,K]=(0,t.useState)({}),[k,j]=(0,t.useState)(!1),[H,J]=(0,t.useState)(!1),X=(q=b.op)=>v.find(ee=>ee.label===q)?.isMultiValue,se=q=>{if(q){const ee=/\(([^)]+)\)/,z=q?.match(ee);return z&&z[0].indexOf("|")>0?[q]:q.indexOf("|")>0?q.split("|"):[q]}return[]},ae=f()(q=>w(q,b.label),L),ne=b?.value??"";return t.createElement("div",{key:ne,"data-testid":"prometheus-dimensions-filter-item"},t.createElement(E.M,null,t.createElement(h.l6,{placeholder:"Select label","data-testid":a.Tp.components.QueryBuilder.labelSelect,inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:b.label?(0,P.z)(b.label):null,allowCustomValue:!0,onOpenMenu:async()=>{K({isLoadingLabelNames:!0});const q=await B(b);j(!0),K({labelNames:q,isLoadingLabelNames:void 0})},onCloseMenu:()=>{j(!1)},isOpen:k,isLoading:V.isLoadingLabelNames??!1,options:V.labelNames,onChange:q=>{q.label&&A({...b,op:b.op??M,label:q.label})},invalid:W}),t.createElement(h.l6,{"data-testid":a.Tp.components.QueryBuilder.matchOperatorSelect,className:"query-segment-operator",value:(0,P.z)(b.op??M),options:v,width:"auto",onChange:q=>{q.value!=null&&A({...b,op:q.value,value:X(q.value)?b.value:se(b?.value)[0]})}}),t.createElement(h.DW,{placeholder:"Select value","data-testid":a.Tp.components.QueryBuilder.valueSelect,inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:X()?se(ne).map(P.z):se(ne).map(P.z)[0],allowCustomValue:!0,formatCreateLabel:q=>q,createOptionPosition:b.op?.includes("~")?"first":"last",onOpenMenu:async()=>{K({isLoadingLabelValues:!0});const q=await U(b);(0,s.ky)(q),J(!0),K({...V,labelValues:q,isLoadingLabelValues:void 0})},onCloseMenu:()=>{J(!1)},isOpen:H,defaultOptions:V.labelValues,isMulti:X(),isLoading:V.isLoadingLabelValues,loadOptions:ae,onChange:q=>{if(q.value)A({...b,value:q.value,op:b.op??M});else{const ee=q.map(z=>z.label).join("|");A({...b,value:ee,op:b.op??M})}},invalid:N}),t.createElement(g.Z,{"aria-label":`remove-${b.label}`,icon:"times",variant:"secondary",onClick:R})))}const v=[{label:"=",value:"=",isMultiValue:!1},{label:"!=",value:"!=",isMultiValue:!1},{label:"=~",value:"=~",isMultiValue:!0},{label:"!~",value:"!~",isMultiValue:!0}],C="Select at least 1 label filter (label and value)";function T({labelsFilters:b,onChange:M,onGetLabelNames:A,onGetLabelValues:R,labelFilterRequired:B,getLabelValuesAutofillSuggestions:U,debounceDuration:W,variableEditor:N}){const w="=",[L,V]=(0,t.useState)([{op:w}]);(0,t.useEffect)(()=>{b.length>0?V(b):V([{op:w}])},[b]);const K=H=>{V(H);const J=H.filter(X=>X.label!=null&&X.value!=null);(0,l.isEqual)(J,b)||M(J)},k=L.some(H=>H.label&&H.value),j=()=>t.createElement(i.o,{items:L,onChange:K,renderItem:(H,J,X)=>t.createElement(D,{debounceDuration:W,item:H,defaultOp:w,onChange:J,onDelete:X,onGetLabelNames:A,onGetLabelValues:R,invalidLabel:B&&!H.label,invalidValue:B&&!H.value,getLabelValuesAutofillSuggestions:U})});return t.createElement(t.Fragment,null,N?t.createElement(p.C,null,t.createElement("div",{className:(0,m.cx)((0,m.css)({display:"flex"}))},t.createElement(c.c,{width:20,tooltip:t.createElement("div",null,"Optional: used to filter the metric select for this query type.")},"Label filters"),j())):t.createElement(u.B,null,t.createElement(d.c,{label:"Label filters",error:C,invalid:B&&!k},j())))}var S=e(95899);function O({datasource:b,query:M,onChange:A,onBlur:R,variableEditor:B}){const U=j=>{A({...M,labels:j})},W=(0,t.useCallback)(async j=>{const H=b.getVariables(),J=await j;return[...H.map(X=>({label:X,value:X})),...J.map(X=>({label:X.value,value:X.value,title:X.description}))]},[b]),N=async j=>{if(!M.metric)return await b.languageProvider.fetchLabels(),b.languageProvider.getLabelKeys().map(se=>({value:se}));const H=M.labels.filter(se=>se!==j);H.push({label:"__name__",op:"=",value:M.metric});const J=r.z.renderLabels(H);let X=await b.languageProvider.fetchLabelsWithMatch(J);return Object.keys(X).filter(se=>!H.find(ae=>ae.label===se)).map(se=>({value:se}))},w=(j,H)=>{const J={label:H??"__name__",op:"=~",value:(0,o.b4)(`.*${j}`)},X=M.labels.filter(q=>q.label!==J.label);X.push(J),M.metric&&X.push({label:"__name__",op:"=",value:M.metric});const se=X.map(q=>({...q,label:b.interpolateString(q.label),value:b.interpolateString(q.value)})),ae=r.z.renderLabels(se);let ne;return b.hasLabelsMatchAPISupport()?ne=V(J,ae):ne=L(J,ae),ne.then(q=>((0,s.ky)(q),q))},L=(j,H)=>{if(!j.label)return Promise.resolve([]);const J=b.languageProvider.fetchSeries(H),X=b.interpolateString(j.label);return J.then(se=>{const ae=new Set;return se.forEach(ne=>{const q=ne[X];ae.add(q)}),Array.from(ae).map(ne=>({label:ne,value:ne}))})},V=(j,H)=>{if(!j.label)return Promise.resolve([]);const J=`[${b.uid}][${M.metric}][${j.label}][${j.op}]`;return b.languageProvider.fetchSeriesValuesWithMatch(j.label,H,J).then(X=>X.map(se=>({value:se,label:se})))},K=async j=>{if(!j.label)return[];if(!M.metric)return(await b.languageProvider.getLabelValues(j.label)).map(se=>({value:se}));const H=M.labels.filter(se=>se!==j);H.push({label:"__name__",op:"=",value:M.metric});const J=H.map(se=>({...se,label:b.interpolateString(se.label),value:b.interpolateString(se.value)})),X=r.z.renderLabels(J);return b.hasLabelsMatchAPISupport()?V(j,X):L(j,X)},k=(0,t.useCallback)(()=>W(x(b,M)),[b,M,W]);return t.createElement(t.Fragment,null,t.createElement(S.dm,{query:M,onChange:A,onGetMetrics:k,datasource:b,labelsFilters:M.labels,metricLookupDisabled:b.lookupsDisabled,onBlur:R||(()=>{}),variableEditor:B}),t.createElement(T,{debounceDuration:b.getDebounceTimeInMilliseconds(),getLabelValuesAutofillSuggestions:w,labelsFilters:M.labels,onChange:U,onGetLabelNames:j=>W(N(j)),onGetLabelValues:j=>W(K(j)),variableEditor:B}))}async function x(b,M){b.languageProvider.metricsMetadata||await b.languageProvider.loadMetricsMetadata(),b.languageProvider.metricsMetadata||(b.languageProvider.metricsMetadata={});let A;if(M.labels.length>0){const R=r.z.renderLabels(M.labels);A=(await b.languageProvider.getSeries(R,!0)).__name__??[]}else A=await b.languageProvider.getLabelValues("__name__")??[];return A.map(R=>({value:R,description:(0,n.xB)(R,b.languageProvider.metricsMetadata)}))}},26432:(G,I,e)=>{"use strict";e.d(I,{W:()=>u,i:()=>d});var t=e(96540),n=e(67061),s=e(20719),r=e(32370),o=e(76040),m=e(27994),l=e(96625),i=e(3884);const u="Fetch all series matching metric name and label filters.",d=t.memo(({query:p})=>{const c=(0,o.u)(p||"").query,y={grammar:s.Ay,name:"promql"};return t.createElement(n.B,{gap:.5,direction:"column"},t.createElement(m.r,{stepNumber:1,title:t.createElement(i.Z,{query:`${c.metric} ${r.z.renderLabels(c.labels)}`,lang:y})},u),t.createElement(l.k,{stepNumber:2,queryModeller:r.z,query:c,lang:y}))});d.displayName="PromQueryBuilderExplained"},80109:(G,I,e)=>{"use strict";e.d(I,{$:()=>l});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(57225),m=e(26432);function l(u){const{query:d,datasource:p,range:c,onRunQuery:y,onChange:f,data:P,app:a,showExplain:E}=u,g=(0,r.of)(i);return n.createElement("div",{"data-testid":s.Tp.components.DataSource.Prometheus.queryEditor.code.queryField,className:g.wrapper},n.createElement(o.L,{datasource:p,query:d,range:c,onRunQuery:y,onChange:f,history:[],data:P,app:a}),E&&n.createElement(m.i,{query:d.expr}))}const i=u=>({wrapper:(0,t.css)({".gf-form":{marginBottom:0}})})},78036:(G,I,e)=>{"use strict";e.d(I,{J3:()=>t,mt:()=>r,ue:()=>s,yH:()=>n});const t=100,n=1e3;function s(o){return{isLoading:!0,metrics:[],hasMetadata:!0,metaHaystackDictionary:{},metaHaystackMatches:[],metaHaystackOrder:[],nameHaystackDictionary:{},nameHaystackOrder:[],nameHaystackMatches:[],totalMetricCount:0,filteredMetricCount:null,resultsPerPage:t,pageNum:1,fuzzySearchQuery:"",fullMetaSearch:o?.fullMetaSearch??!1,includeNullMetadata:o?.includeNullMetadata??!0,selectedTypes:[],useBackend:o?.useBackend??!1,disableTextWrap:o?.disableTextWrap??!1,showAdditionalSettings:!1}}function r(o){return{useBackend:o?.useBackend??!1,disableTextWrap:o?.disableTextWrap??!1,fullMetaSearch:o?.fullMetaSearch??!1,includeNullMetadata:o.includeNullMetadata??!1}}},1220:(G,I,e)=>{"use strict";e.d(I,{DQ:()=>f,G3:()=>E,Kl:()=>p,OS:()=>P,iZ:()=>y,jC:()=>g,jY:()=>l,kf:()=>i,nU:()=>d,z2:()=>a});var t=e(2543),n=e.n(t),s=e(55127),r=e.n(s),o=e(38961),m=e(15145);function l(x,b,M){const A=c(x,b,M),R=x.id+"(";return M&&A.push(M),R+A.join(", ")+")"}function i(x,b,M){const A=c(x,b,M),R=x.id+"(";return M&&A.unshift(M),R+A.join(", ")+")"}function u(x,b,M,A){if(b.params.length<2)throw`Cannot render a function with params of length [${b.params.length}]`;let R=(x.params??[])[0]??"5m";const B=c({...x,params:x.params.slice(1)},{...b,params:b.params.slice(1),defaultParams:b.defaultParams.slice(1)},M),U=x.id+"(";return M&&(A?B.push(`${M}[${R}]`):B.unshift(`${M}[${R}]`)),U+B.join(", ")+")"}function d(x,b,M){return u(x,b,M,!1)}function p(x,b,M){return u(x,b,M,!0)}function c(x,b,M){return(x.params??[]).map((A,R)=>b.params[R].type==="string"?'"'+A+'"':A)}function y(x,b){const M={id:x.id,params:x.defaultParams};return{...b,operations:[...b.operations,M]}}function f(x){return(0,t.capitalize)(x.replace(/_/g," "))}function P(x,b){return`operations.${x}.param.${b}`}function a(x=!1){const b=[{label:"$__interval",value:"$__interval"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"1h",value:"1h"},{label:"24h",value:"24h"}];return x&&b.unshift({label:"$__rate_interval",value:"$__rate_interval"}),{name:"Range",type:"string",options:b}}function E(x,b={}){return[{id:x,name:f(x),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:m.Ag.Aggregations,renderer:l,paramChangedHandler:S(`__${x}_by`),explainHandler:v(x,""),addOperationHandler:y,...b},{id:`__${x}_by`,name:`${f(x)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:o.r}],defaultParams:[""],alternativesKey:"aggregations by",category:m.Ag.Aggregations,renderer:h(x),paramChangedHandler:T(x),explainHandler:v(x,"by"),addOperationHandler:y,hideFromList:!0,...b},{id:`__${x}_without`,name:`${f(x)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:o.r}],defaultParams:[""],alternativesKey:"aggregations by",category:m.Ag.Aggregations,renderer:D(x),paramChangedHandler:T(x),explainHandler:v(x,"without"),addOperationHandler:y,hideFromList:!0,...b}]}function g(x,b,M={}){const A=E(x,M);return A[0].params.unshift(...b.params),A[1].params.unshift(...b.params),A[2].params.unshift(...b.params),A[0].defaultParams=b.defaultParams,A[1].defaultParams=[...b.defaultParams,""],A[2].defaultParams=[...b.defaultParams,""],A[1].renderer=C(x),A[2].renderer=C(x),A}function h(x){return function(M,A,R){return`${x} by(${M.params.join(", ")}) (${R})`}}function D(x){return function(M,A,R){return`${x} without(${M.params.join(", ")}) (${R})`}}function v(x,b){return function(A){const R=A.params.map(U=>`\`${U}\``).join(" and "),B=r()("label",A.params.length);switch(b){case"by":return`Calculates ${x} over dimensions while preserving ${B} ${R}.`;case"without":return`Calculates ${x} over the dimensions ${R}. All other labels are preserved.`;default:return`Calculates ${x} over the dimensions.`}}}function C(x){return function(M,A,R){const B=A.params.findIndex(N=>N.restParam),U=M.params.slice(0,B),W=M.params.slice(B);return`${x} by(${W.join(", ")}) (${U.map((N,w)=>A.params[w].type==="string"?`"${N}"`:N).join(", ")}, ${R})`}}function T(x){return function(M,A,R){return A.params.length<R.params.length?{...A,id:x}:A}}function S(x){return function(M,A,R){return A.params.length===R.params.length?{...A,id:x}:A}}function O(x,b){if(!x.label||!x.op||!x.value||b.length<2)return!1;const M=x.op.toString().startsWith("!");return b.filter(B=>B.label===x.label&&B.value===x.value&&B.op!==x.op).some(B=>!!(M&&B?.op?.toString().startsWith("!")===!1||M===!1&&B?.op?.toString().startsWith("!")))}},76040:(G,I,e)=>{"use strict";e.d(I,{u:()=>r});var t=e(84555),n=e(75161),s=e(26115);function r(a){const E=(0,s.qk)(a),h=t.K3.parse(E).topNode,v={query:{metric:"",labels:[],operations:[]},errors:[]};try{m(E,h,v)}catch(C){console.error(C),C instanceof Error&&v.errors.push({text:C.message})}return P(v.query)&&(v.errors=[]),o(a)&&(v.errors=[]),v}function o(a){const E={query:{metric:"",labels:[],operations:[]},errors:[]};a=a.replace(/\$__interval/g,"1s"),a=a.replace(/\$__interval_ms/g,"1000"),a=a.replace(/\$__rate_interval/g,"1s"),a=a.replace(/\$__range_ms/g,"1000"),a=a.replace(/\$__range_s/g,"1"),a=a.replace(/\$__range/g,"1s");const h=t.K3.parse(a).topNode;try{m(a,h,E)}catch{return!1}return E.errors.length===0}function m(a,E,g){const h=g.query;switch(E.type.id){case t.gw:{h.metric=(0,s.AA)(a,E);break}case t.BG:{h.labels.push(i(a,E));const D=E.getChild(s.Ql);D&&g.errors.push((0,s.xz)(a,D));break}case t.R6:{d(a,E,g);break}case t.Fn:{p(a,E,g);break}case t.df:{y(a,E,g);break}case s.Ql:{if(l(E))break;g.errors.push((0,s.xz)(a,E));break}default:{E.type.id===t.ek&&g.errors.push((0,s.xz)(a,E));let D=E.firstChild;for(;D;)m(a,D,g),D=D.nextSibling}}}function l(a){return a.prevSibling?.firstChild?.type.id===t.Fb}function i(a,E){const g=(0,s.AA)(a,E.getChild(t.IC)),h=(0,s.AA)(a,E.getChild(t.Lf)),D=(0,s.AA)(a,E.getChild(t.LW)).replace(/"/g,"");return{label:g,op:h,value:D}}const u=["changes","rate","irate","increase","delta"];function d(a,E,g){const h=g.query,D=E.getChild(t.m3),v=(0,s.AA)(a,D),C=E.getChild(t.Dh),T=[];let S="";if(u.includes(v)||v.endsWith("_over_time")){let x=(0,s.AA)(a,E).match(/\[(.+)\]/);x?.[1]&&(S=x[1],T.push(x[1]))}const O={id:v,params:T};if(h.operations.unshift(O),C){if((0,s.AA)(a,C)==="(["+S+"])")return;c(a,C,g,O)}}function p(a,E,g){const h=g.query,D=E.getChild(t.xb);let v=(0,s.AA)(a,D);const C=E.getChild(t.hI),T=[];C&&(C.getChild("By")&&v&&(v=`__${v}_by`),C.getChild(t.xB)&&(v=`__${v}_without`),T.push(...(0,s.R1)(a,C,t.IC)));const S=E.getChild(t.Dh),O={id:v,params:[]};h.operations.unshift(O),c(a,S,g,O),O.params.push(...T)}function c(a,E,g,h){if(E)switch(E.type.id){case t.Dh:{let D=E.firstChild;for(;D;){let v;D.type.id===t.df?v=D:v=D.getChild(t.df),v&&g.errors.push({text:"Query parsing is ambiguous.",from:v.from,to:v.to}),c(a,D,g,h),D=D.nextSibling}break}case t.Po:{h.params.push(parseFloat((0,s.AA)(a,E)));break}case t.LW:{h.params.push((0,s.AA)(a,E).replace(/"/g,""));break}default:m(a,E,g)}}function y(a,E,g){const h=g.query,D=E.firstChild,v=(0,s.AA)(a,D.nextSibling),C=f(a,E.getChild(t.eM)??E.getChild(t.Ue)),T=E.lastChild,S=n.AE[v],O=D.type.id===t.Po,x=T.type.id===t.Po,b=T.type.id===t.df;if(O||m(a,D,g),x)h.operations.push((0,s.rq)(S,a,T,!!C?.isBool));else if(b){const M=(0,s.z9)(T);M?.type.id===t.Po&&h.operations.push((0,s.rq)(S,a,M,!!C?.isBool)),m(a,T,g)}else{h.binaryQueries=h.binaryQueries||[];const M={operator:v,query:{metric:"",labels:[],operations:[]}};C?.isMatcher&&(M.vectorMatchesType=C.matchType,M.vectorMatches=C.matches),h.binaryQueries.push(M),m(a,T,{query:M.query,errors:g.errors})}}function f(a,E){if(E){if(E.getChild("Bool"))return{isBool:!0,isMatcher:!1};{let g="";const h=E.getChild(t.x$);return h&&(g=(0,s.R1)(a,h,t.IC).join(", ")),{isMatcher:!0,isBool:!1,matches:g,matchType:E.getChild(t.On)?"on":"ignoring"}}}}function P(a){return a.labels.length===0&&a.operations.length===0&&!a.metric}},26115:(G,I,e)=>{"use strict";e.d(I,{AA:()=>i,Ql:()=>t,R1:()=>d,b4:()=>p,qk:()=>o,rq:()=>u,xz:()=>s,z9:()=>n});const t=0;function n(c){return c.firstChild?n(c.firstChild):c}function s(c,y){return{text:i(c,y),from:y.from,to:y.to,parentType:y.parent?.name}}const r=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function o(c){return c.replace(r,(y,f,P,a,E,g,h)=>{const D=a||h;let v=f,C="0";return P&&(v=P,C="1"),E&&(v=E,C="2"),`__V_${C}__`+v+"__V__"+(D?"__F__"+D+"__F__":"")})}const m=[(c,y)=>`$${c}`,(c,y)=>`[[${c}${y?`:${y}`:""}]]`,(c,y)=>`\${${c}${y?`:${y}`:""}}`];function l(c){return c.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,(y,f,P,a)=>m[parseInt(f,10)](P,a))}function i(c,y){return y?l(c.substring(y.from,y.to)):""}function u(c,y,f,P){const a=[parseFloat(i(y,f))];return c.comparison&&a.push(P),{id:c.id,params:a}}function d(c,y,f){if(y.type.id===f)return[i(c,y)];const P=[];let a=0,E=y.childAfter(a);for(;E;)P.push(...d(c,E,f)),a=E.to,E=y.childAfter(a);return P}const p=c=>c.split(" ").map(f=>`${f}.*`).join("")},27994:(G,I,e)=>{"use strict";e.d(I,{r:()=>o});var t=e(32196),n=e(96540),s=e(36663),r=e(40845);function o({title:l,stepNumber:i,markdown:u,children:d}){const p=(0,r.of)(m);return n.createElement("div",{className:p.box},i!==void 0&&n.createElement("div",{className:p.stepNumber},i),n.createElement("div",{className:p.boxInner},l&&n.createElement("div",{className:p.header},n.createElement("span",null,l)),n.createElement("div",{className:p.body},u&&n.createElement("div",{dangerouslySetInnerHTML:{__html:(0,s.G)(u)}}),d)))}const m=l=>({box:(0,t.css)({background:l.colors.background.secondary,padding:l.spacing(1),borderRadius:l.shape.radius.default,position:"relative"}),boxInner:(0,t.css)({marginLeft:l.spacing(4)}),stepNumber:(0,t.css)({fontWeight:l.typography.fontWeightMedium,background:l.colors.secondary.main,width:"20px",height:"20px",borderRadius:l.shape.radius.circle,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:l.typography.bodySmall.fontSize}),header:(0,t.css)({paddingBottom:l.spacing(.5),display:"flex",alignItems:"center",fontFamily:l.typography.fontFamilyMonospace}),body:(0,t.css)({color:l.colors.text.secondary,"p:last-child":{margin:0},a:{color:l.colors.text.link,textDecoration:"underline"}})})},96625:(G,I,e)=>{"use strict";e.d(I,{k:()=>r});var t=e(96540),n=e(27994),s=e(3884);function r({query:o,queryModeller:m,stepNumber:l,lang:i,onMouseEnter:u,onMouseLeave:d}){return t.createElement(t.Fragment,null,o.operations.map((p,c)=>{const y=m.getOperationDef(p.id);if(!y)return`Operation ${p.id} not found`;const f=y.renderer(p,y,"<expr>"),P=y.explainHandler?y.explainHandler(p,y):y.documentation??"no docs";return t.createElement("div",{key:c,onMouseEnter:()=>u?.(p,c),onMouseLeave:()=>d?.(p,c)},t.createElement(n.r,{stepNumber:c+l,title:t.createElement(s.Z,{query:f,lang:i}),markdown:P}))}))}},3884:(G,I,e)=>{"use strict";e.d(I,{Z:()=>m});var t=e(32196),n=e(28848),s=e.n(n),r=e(96540),o=e(40845);function m({query:i,lang:u,className:d}){const p=(0,o.$j)(),c=l(p),y=s().highlight(i,u.grammar,u.name);return r.createElement("div",{className:(0,t.cx)(c.editorField,"prism-syntax-highlight",d),"aria-label":"selector",dangerouslySetInnerHTML:{__html:y}})}const l=i=>({editorField:(0,t.css)({fontFamily:i.typography.fontFamilyMonospace,fontSize:i.typography.bodySmall.fontSize})})},15145:(G,I,e)=>{"use strict";e.d(I,{Ag:()=>t,jN:()=>n,n5:()=>s});var t=(r=>(r.Aggregations="Aggregations",r.RangeFunctions="Range functions",r.Functions="Functions",r.BinaryOps="Binary operations",r.Trigonometric="Trigonometric",r.Time="Time Functions",r))(t||{}),n=(r=>(r.Abs="abs",r.Absent="absent",r.AbsentOverTime="absent_over_time",r.Acos="acos",r.Acosh="acosh",r.Asin="asin",r.Asinh="asinh",r.Atan="atan",r.Atanh="atanh",r.Avg="avg",r.AvgOverTime="avg_over_time",r.BottomK="bottomk",r.Ceil="ceil",r.Changes="changes",r.Clamp="clamp",r.ClampMax="clamp_max",r.ClampMin="clamp_min",r.Cos="cos",r.Cosh="cosh",r.Count="count",r.CountOverTime="count_over_time",r.CountScalar="count_scalar",r.CountValues="count_values",r.DayOfMonth="day_of_month",r.DayOfWeek="day_of_week",r.DayOfYear="day_of_year",r.DaysInMonth="days_in_month",r.Deg="deg",r.Delta="delta",r.Deriv="deriv",r.DropCommonLabels="drop_common_labels",r.Exp="exp",r.Floor="floor",r.Group="group",r.HistogramQuantile="histogram_quantile",r.HistogramAvg="histogram_avg",r.HistogramCount="histogram_count",r.HistogramSum="histogram_sum",r.HistogramFraction="histogram_fraction",r.HistogramStddev="histogram_stddev",r.HistogramStdvar="histogram_stdvar",r.HoltWinters="holt_winters",r.Hour="hour",r.Idelta="idelta",r.Increase="increase",r.Irate="irate",r.LabelJoin="label_join",r.LabelReplace="label_replace",r.Last="last",r.LastOverTime="last_over_time",r.Ln="ln",r.Log10="log10",r.Log2="log2",r.Max="max",r.MaxOverTime="max_over_time",r.Min="min",r.MinOverTime="min_over_time",r.Minute="minute",r.Month="month",r.Pi="pi",r.PredictLinear="predict_linear",r.Present="present",r.PresentOverTime="present_over_time",r.Quantile="quantile",r.QuantileOverTime="quantile_over_time",r.Rad="rad",r.Rate="rate",r.Resets="resets",r.Round="round",r.Scalar="scalar",r.Sgn="sgn",r.Sin="sin",r.Sinh="sinh",r.Sort="sort",r.SortDesc="sort_desc",r.Sqrt="sqrt",r.Stddev="stddev",r.StddevOverTime="stddev_over_time",r.Sum="sum",r.SumOverTime="sum_over_time",r.Tan="tan",r.Tanh="tanh",r.Time="time",r.Timestamp="timestamp",r.TopK="topk",r.Vector="vector",r.Year="year",r.Addition="__addition",r.Subtraction="__subtraction",r.MultiplyBy="__multiply_by",r.DivideBy="__divide_by",r.Modulo="__modulo",r.Exponent="__exponent",r.NestedQuery="__nested_query",r.EqualTo="__equal_to",r.NotEqualTo="__not_equal_to",r.GreaterThan="__greater_than",r.LessThan="__less_than",r.GreaterOrEqual="__greater_or_equal",r.LessOrEqual="__less_or_equal",r))(n||{}),s=(r=>(r.Rate="rate",r.Histogram="histogram",r.Binary="binary",r))(s||{})},20716:(G,I,e)=>{"use strict";e.d(I,{$i:()=>c,Dr:()=>d});var t=e(70416),n=e(47232),s=e(77678),r=e(32631),o=e(32264),m=e(14110),l=e(9631);function i(y,f){let[P]=y,[a]=f,E=P.length,g=P[0],h=P[E-1],D=a.length,v=a[0],C=a[D-1],T;if(E)if(D){if(v>h)T=y.map((S,O)=>y[O].concat(f[O]));else if(C<g)T=f.map((S,O)=>f[O].concat(y[O]));else if(v<=g&&C>=h)T=f;else if(!(v>g&&C<h)){if(v>=g){let S=(0,l.Ls)(v,P);S=P[S]<v?S-1:S,T=y.map((O,x)=>y[x].slice(0,S).concat(f[x]))}else if(C>=g){let S=(0,l.Ls)(C,P);S=P[S]<C?S:S+1,T=f.map((O,x)=>f[x].concat(y[x].slice(S)))}}}else T=y;else D?T=f:T=[[]];return T}function u(y,f,P){let[a,...E]=y,g,h;return a[0]<f&&(g=(0,l.Ls)(f,a),a[g]<f&&g++),a[a.length-1]>P&&(h=(0,l.Ls)(P,a),a[h]>P&&h--),(g!=null||h!=null)&&(a=a.slice(g??0,h),E=E.map(D=>D.slice(g??0,h))),[a,...E]}const d="10m",p=y=>`${y.type}|${y.name}|${JSON.stringify(y.labels??"")}`;class c{constructor(f){this.sendEventsInterval=6e4*10,this.pendingRequestIdsToTargSigs=new Map,this.pendingAccumulatedEvents=new Map,this.cache=new Map,this.sendPendingTrackingEvents=()=>{const a=this.pendingAccumulatedEvents.entries();for(let[E,g]of a)if(!g.sent){const h={datasource:g.datasource.toString(),requestCount:g.requestCount.toString(),savedBytesTotal:g.savedBytesTotal.toString(),initialRequestSize:g.initialRequestSize.toString(),lastRequestSize:g.lastRequestSize.toString(),panelId:g.panelId.toString(),dashId:g.dashId.toString(),expr:g.expr.toString(),refreshIntervalMs:g.refreshIntervalMs.toString(),from:g.from.toString(),queryRangeSeconds:g.queryRangeSeconds.toString()};o.$.featureToggles.prometheusIncrementalQueryInstrumentation?(0,m.rR)("grafana_incremental_queries_profile",h):r.P.api.pushEvent&&r.P.api.pushEvent("incremental query response size",h,"no-interaction",{skipDedupe:!0}),this.pendingAccumulatedEvents.set(E,{...g,sent:!0,requestCount:0,savedBytesTotal:0,initialRequestSize:0,lastRequestSize:0})}};const P=f.overlapString;if((0,t.di)(P)){const a=(0,t.E9)(P);this.overlapWindowMs=(0,t.WT)(a)}else{const a=(0,t.E9)(d);this.overlapWindowMs=(0,t.WT)(a)}(o.$.grafanaJavascriptAgent.enabled||o.$.featureToggles?.prometheusIncrementalQueryInstrumentation)&&f.profileFunction!==void 0?(this.profile(),this.shouldProfile=!0):this.shouldProfile=!1,this.getProfileData=f.profileFunction,this.getTargetSignature=f.getTargetSignature}profile(){typeof PerformanceObserver=="function"&&(this.perfObeserver=new PerformanceObserver(f=>{f.getEntries().forEach(P=>{const a=P,E=typeof a?.transferSize=="number";if(a?.initiatorType==="fetch"&&E){let g=a.name;if(g.includes("/api/ds/query")){let h=g.match(/requestId=([a-z\d]+)/i);if(h){let D=h[1];const v=Math.round(a.transferSize),C=this.pendingRequestIdsToTargSigs.get(D);if(C){const T=this.pendingRequestIdsToTargSigs.entries();for(let[,S]of T)if(S.identity===C.identity&&S.bytes!==null){const O=this.pendingAccumulatedEvents.get(S.identity),x=S.bytes-v;this.pendingAccumulatedEvents.set(S.identity,{datasource:S.datasource??"N/A",requestCount:(O?.requestCount??0)+1,savedBytesTotal:(O?.savedBytesTotal??0)+x,initialRequestSize:S.bytes,lastRequestSize:v,panelId:C.panelId?.toString()??"",dashId:C.dashboardUID??"",expr:C.expr??"",refreshIntervalMs:C.refreshIntervalMs??0,sent:!1,from:C.from??"",queryRangeSeconds:C.queryRangeSeconds??0}),this.pendingRequestIdsToTargSigs.delete(D);return}this.pendingRequestIdsToTargSigs.set(D,{...C,bytes:v})}}}}})}),this.perfObeserver.observe({type:"resource",buffered:!1}),setInterval(this.sendPendingTrackingEvents,this.sendEventsInterval),window.addEventListener("beforeunload",this.sendPendingTrackingEvents))}requestInfo(f){const P=f.range.from.valueOf(),a=f.range.to.valueOf(),E=f.rangeRaw?.to?.toString()==="now";let g=E,h;const D=f.intervalMs,v=new Map;f.targets.forEach(C=>{let T=`${f.dashboardUID}|${f.panelId}|${C.refId}`,S=this.getTargetSignature(f,C);this.shouldProfile&&this.getProfileData&&this.pendingRequestIdsToTargSigs.set(f.requestId,{...this.getProfileData(f,C),identity:T+"|"+S,bytes:null,panelId:f.panelId,dashboardUID:f.dashboardUID??"",from:f.rangeRaw?.from.toString()??"",queryRangeSeconds:f.range.to.diff(f.range.from,"seconds")??"",refreshIntervalMs:D??0}),v.set(T,S)});for(const[C,T]of v){let S=this.cache.get(C);if(S?.sig!==T?g=!1:(h=S?.prevTo??1/0,g=a>h&&P<=h),!g)break}if(g&&h){let C=Math.max(h-this.overlapWindowMs,P);const T=(0,n.KQ)(a),S=(0,n.KQ)((0,s.rs)(C,f.intervalMs));f={...f,range:{...f.range,from:S,to:T}}}else v.forEach((C,T)=>{this.cache.delete(T)});return{requests:[f],targSigs:v,shouldCache:E}}procFrames(f,P,a){if(P?.shouldCache){const E=f.range.from.valueOf(),g=f.range.to.valueOf(),h=new Map;a.forEach(v=>{let C=`${f.dashboardUID}|${f.panelId}|${v.refId}`,T=h.get(C);T||(T=[],h.set(C,T)),T.push(v)});let D=[];h.forEach((v,C)=>{let T=(C?this.cache.get(C)?.frames:null)??[];v.forEach(O=>{if(O.length===0||O.fields.length===0)return;let x=p(O.fields[1]),b=T.find(M=>p(M.fields[1])===x);if(!b)T.push(O);else{let M=b.fields.map(B=>B.values),A=O.fields.map(B=>B.values),R=i(M,A);if(R){for(let B=0;B<R.length;B++)b.fields[B].values=R[B];b.length=b.fields[0].values.length}}});let S=[];T.forEach(O=>{let x=O.fields.map(M=>M.values),b=u(x,E,g);if(b[0].length>0){for(let M=0;M<b.length;M++)O.fields[M].values=b[M];S.push(O)}}),this.cache.set(C,{sig:P.targSigs.get(C),frames:S,prevTo:g}),D.push(...S)}),a=D.map(v=>({...v,fields:v.fields.map(C=>({...C,config:{...C.config},values:C.values.slice()}))}))}return a}}},59809:(G,I,e)=>{"use strict";e.d(I,{Bm:()=>O,J3:()=>f,L:()=>x,hF:()=>C});var t=e(2543),n=e.n(t),s=e(41987),r=e(41260),o=e(11261),m=e(28240),l=e(52622),i=e(57875),u=e(32264),d=e(19347);const p=/^[+-]?inf(?:inity)?$/i,c=(b,M)=>M.app===s.Jk.Explore&&(b.meta?.custom?.resultType==="vector"||b.meta?.custom?.resultType==="scalar")?!0:M.targets.find(R=>R.refId===b.refId)?.format==="table",y=(b,M)=>b.meta?.type===r.m.HeatmapCells?!1:M.targets.find(R=>R.refId===b.refId)?.format==="heatmap";function f(b,M,A){u.$.featureToggles.prometheusDataplane&&b.data.forEach(X=>{const se=M.targets.find(ae=>ae.refId===X.refId);se&&se.legendFormat==="__auto"&&X.fields.forEach(ae=>{if(ae.labels?.__name__&&ae.labels?.__name__===ae.name){const ne={...ae,name:o.Bc};ae.config.displayNameFromDS=(0,m.Ct)(ne,X,b.data)}})});const[R,B]=(0,t.partition)(b.data,X=>c(X,M)),U=a(R),[W,N]=(0,t.partition)(B,X=>X.meta?.custom?.resultType==="exemplar"),{exemplarTraceIdDestinations:w}=A,L=W.map(X=>{if(w?.length)for(const se of w){const ae=X.fields.find(ne=>ne.name===se.name);if(ae){const ne=g(se);ae.config.links=ae.config.links?.length?[...ae.config.links,...ne]:ne}}return{...X,meta:{...X.meta,dataTopic:l.QR.Annotations}}}),[V,K]=(0,t.partition)(N,X=>y(X,M));V.forEach(X=>{if(X.name==null){let se=X.fields.find(ae=>ae.type===o.PU.number);if(se){let ae=se.labels?.le;ae&&(X.name=ae,se.config.displayNameFromDS=ae)}}});const k=(0,t.groupBy)(V,X=>X.refId);let j=[];for(const X in k){const se=k[X],ae=(0,t.groupBy)(se,ne=>{const q=ne.fields.find(ee=>ee.type===o.PU.number);if(q?.labels&&P in q.labels){const{le:ee,...z}=q?.labels;return Object.values(z).join()}return Object.values(q?.labels??[]).join()});(0,t.forOwn)(ae,(ne,q)=>{const ee=ne.sort(O);j.push(T(S(ee)))})}const H=K.map(X=>({...X,meta:{...X.meta,preferredVisualisationType:"graph"}})),J=(0,t.flatten)(j);return{...b,data:[...H,...U,...J,...L]}}const P="le";function a(b){if(b.length===0||b.length===1&&b[0].length===0)return b;const M=(0,t.groupBy)(b,"refId"),A=Object.keys(M);return A.map(B=>{const U=E(A.length,B),W=v({data:[],valueName:U}),N=D([]),w=[];M[B].forEach(V=>{const k=V.fields[1]?.labels??{};Object.keys(k).sort().forEach(j=>{if(!w.some(H=>H.name===j)){const H=j===P;w.push({name:j,config:{filterable:!0},type:H?o.PU.number:o.PU.string,values:[]})}})}),M[B].forEach(V=>{const K=V.fields[0]?.values??[],k=V.fields[1]?.values??[];K.forEach(j=>N.values.push(j)),k.forEach(j=>{W.values.push(x(j));const H=V.fields[1].labels??{};w.forEach(J=>J.values.push(h(H,J.name)))})});const L=[N,...w,W];return{refId:B,fields:L,meta:{...M[B][0].meta,preferredVisualisationType:"rawPrometheus"},length:N.values.length}})}function E(b,M=""){return b>1?`Value #${M}`:"Value"}function g(b){const M=[];if(b.datasourceUid){const R=(0,d.l)().getInstanceSettings(b.datasourceUid);R&&M.push({title:b.urlDisplayLabel||`Query with ${R?.name}`,url:"",internal:{query:{query:"${__value.raw}",queryType:"traceql"},datasourceUid:b.datasourceUid,datasourceName:R?.name??"Data source not found"}})}return b.url&&M.push({title:b.urlDisplayLabel||`Go to ${b.url}`,url:b.url,targetBlank:!0}),M}function h(b,M){return b.hasOwnProperty(M)?M===P?x(b[M]):b[M]:""}function D(b,M=!1){return{name:o.LE,type:o.PU.time,config:{},values:b.map(A=>M?A[0]:A[0]*1e3)}}function v({data:b,valueName:M=o.Bc,parseValue:A=!0,labels:R,displayNameFromDS:B}){return{name:M,type:o.PU.number,display:(0,i.J)(),config:{displayNameFromDS:B},labels:R,values:b.map(U=>A?x(U[1]):U[1])}}function C(b){const M=b.__name__||"";delete b.__name__;const A=Object.entries(b).map(R=>`${R[0]}="${R[1]}"`).join(",");return`${M}{${A}}`}function T(b){if(b.length===0||b.length===1&&b[0].length===0)return[];const M=b[0].fields.find(R=>R.type===o.PU.time),A=b.map(R=>{let B=R.fields.find(U=>U.type===o.PU.number);return{...B,name:B.config.displayNameFromDS}});return[{...b[0],meta:{...b[0].meta,type:r.m.HeatmapRows},fields:[M,...A]}]}function S(b){for(let M=b.length-1;M>0;M--){const A=b[M].fields.find(B=>B.type===o.PU.number),R=b[M-1].fields.find(B=>B.type===o.PU.number);if(!A||!R)throw new Error("Prometheus heatmap transform error: data should be a time series");for(let B=0;B<A.values.length;B++){const U=R.values[B]||[0];A.values[B]-=U,A.values[B]<1e-9&&(A.values[B]=0)}}return b}function O(b,M){let A,R;try{A=x(b.fields[1].state?.displayName??b.name??b.fields[1].name),R=x(M.fields[1].state?.displayName??M.name??M.fields[1].name)}catch(B){return console.error(B),0}return A>R?1:A<R?-1:0}function x(b){return p.test(b)?b[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:parseFloat(b)}},62183:(G,I,e)=>{"use strict";e.d(I,{B4:()=>r,N1:()=>n,fD:()=>t,m_:()=>s});var t=(o=>(o.Low="Low",o.Medium="Medium",o.High="High",o.None="None",o))(t||{}),n=(o=>(o.Cortex="Cortex",o.Mimir="Mimir",o.Prometheus="Prometheus",o.Thanos="Thanos",o))(n||{}),s=(o=>(o.Auto="__auto",o.Verbose="__verbose",o.Custom="__custom",o))(s||{}),r=(o=>(o[o.LabelNames=0]="LabelNames",o[o.LabelValues=1]="LabelValues",o[o.MetricNames=2]="MetricNames",o[o.VarQueryResult=3]="VarQueryResult",o[o.SeriesQuery=4]="SeriesQuery",o[o.ClassicQuery=5]="ClassicQuery",o))(r||{})},27642:(G,I,e)=>{"use strict";e.d(I,{L:()=>n,y:()=>s});var t=e(32264);function n(r){return{grafana_version:t.$.buildInfo.version,plugin_type:String(r.type),plugin_version:r.info.version,plugin_id:r.id,plugin_name:r.name}}function s(r){return{...n(r.meta),datasource_uid:r.uid}}},44027:(G,I,e)=>{"use strict";e.d(I,{G:()=>l});var t=e(96540),n=e(92470),s=e(95187),r=e(14110),o=e(27642);const m="grafana_plugin_";function l(){const u=(0,n.Q)();return(0,t.useMemo)(()=>{const d=(0,s.S)(u)?(0,o.y)(u.instanceSettings):(0,o.L)(u.meta);return(p,c)=>{if(!i(p))throw new Error(`Interactions reported in plugins should start with: "${m}".`);return(0,r.rR)(p,{...c,...d})}},[u])}function i(u){return u.startsWith(m)&&u.length>m.length}},61298:(G,I,e)=>{"use strict";e.d(I,{fX:()=>s,nB:()=>n,n_:()=>t,p6:()=>r});var t=(o=>(o.DashboardView="dashboard-view",o.DataRequest="data-request",o))(t||{});const n=o=>!!o.payload.page,s=o=>!!o.payload.interactionName,r=o=>!!o.payload.experimentId},14110:(G,I,e)=>{"use strict";e.d(I,{G$:()=>r,Jy:()=>o,Xp:()=>l,rR:()=>m});var t=e(32264),n=e(12131),s=e(63415);const r=i=>{(0,s.x$)().addEvent({type:s.on.MetaAnalytics,payload:i})},o=()=>{const i=n.Ny.getLocation(),u=`${t.$.appSubUrl??""}${i.pathname}${i.search}${i.hash}`;(0,s.x$)().addEvent({type:s.on.Pageview,payload:{page:u}})},m=(i,u)=>{(0,s.x$)().addEvent({type:s.on.Interaction,payload:{interactionName:i,properties:u}})},l=(i,u,d)=>{(0,s.x$)().addEvent({type:s.on.ExperimentView,payload:{experimentId:i,experimentGroup:u,experimentVariant:d}})}},55882:(G,I,e)=>{"use strict";e.d(I,{s:()=>d});var t=e(96540),n=e(22391),s=e(51527),r=e(13544),o=e(21594),m=e(67061),l=e(98624),i=e(19347),u=e(26657);class d extends t.PureComponent{constructor(c){super(c),this.dataSourceSrv=(0,i.l)(),this.state={},this.onChange=(y,f)=>{if(f.action==="clear"&&this.props.onClear){this.props.onClear();return}const P=this.dataSourceSrv.getInstanceSettings(y.value);P&&(this.props.onChange(P),this.setState({error:void 0}))}}static{this.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select data source"}}componentDidMount(){const{current:c}=this.props;this.dataSourceSrv.getInstanceSettings(c)||this.setState({error:"Could not find data source "+c})}getCurrentValue(){const{current:c,hideTextValue:y,noDefault:f}=this.props;if(!c&&f)return;const P=this.dataSourceSrv.getInstanceSettings(c);if(P)return{label:P.name.slice(0,37),value:P.uid,imgUrl:P.meta.info.logos.small,hideText:y,meta:P.meta};const a=(0,n.Iz)(c);return a===u.dR.uid||a===u.dR.name?{label:a,value:a,hideText:y}:{label:(a??"no name")+" - not found",value:a??void 0,imgUrl:"",hideText:y}}getDataSourceOptions(){const{alerting:c,tracing:y,metrics:f,mixed:P,dashboard:a,variables:E,annotations:g,pluginId:h,type:D,filter:v,logs:C}=this.props;return this.dataSourceSrv.getList({alerting:c,tracing:y,metrics:f,logs:C,dashboard:a,mixed:P,variables:E,annotations:g,pluginId:h,filter:v,type:D}).map(S=>({value:S.name,label:`${S.name}${S.isDefault?" (default)":""}`,imgUrl:S.meta.info.logos.small,meta:S.meta}))}render(){const{autoFocus:c,onBlur:y,onClear:f,openMenuOnFocus:P,placeholder:a,width:E,inputId:g,disabled:h=!1,isLoading:D=!1}=this.props,{error:v}=this.state,C=this.getDataSourceOptions(),T=this.getCurrentValue(),S=typeof f=="function";return t.createElement("div",{"aria-label":"Data source picker select container","data-testid":r.Tp.components.DataSourcePicker.container},t.createElement(o.l6,{isLoading:D,disabled:h,"aria-label":"Select a data source","data-testid":r.Tp.components.DataSourcePicker.inputV2,inputId:g||"data-source-picker",className:"ds-picker select-container",isMulti:!1,isClearable:S,backspaceRemovesValue:!1,onChange:this.onChange,options:C,autoFocus:c,onBlur:y,width:E,openMenuOnFocus:P,maxMenuHeight:500,placeholder:a,noOptionsMessage:"No datasources found",value:T??null,invalid:!!v||!!this.props.invalid,getOptionLabel:O=>O.meta&&(0,s.x)(O.meta.signature)&&O!==T?t.createElement(m.B,{alignItems:"center",justifyContent:"space-between"},t.createElement("span",null,O.label)," ",t.createElement(l.B,{status:O.meta.signature})):O.label||""}))}}},96937:(G,I,e)=>{"use strict";e.d(I,{f:()=>t,p:()=>n});let t=()=>{throw new Error("EmbeddedDashboard requires runtime initialization")};function n(s){t=s}},97152:(G,I,e)=>{"use strict";e.d(I,{a:()=>n,e:()=>s});var t=e(96540);let n=({message:r})=>t.createElement("div",null,"Unable to render data: ",r,".");function s(r){n=r}},24308:(G,I,e)=>{"use strict";e.d(I,{Y:()=>s,m:()=>n});var t=e(96540);let n=()=>t.createElement("div",null,"PanelRenderer can only be used after Grafana instance has been started.");function s(r){n=r}},46235:(G,I,e)=>{"use strict";e.d(I,{V:()=>n,l:()=>s});var t=e(96540);let n=({children:r})=>t.createElement("div",null,r);function s(r){n=r}},32264:(G,I,e)=>{"use strict";e.d(I,{$:()=>d,p:()=>o});var t=e(2543),n=e.n(t),s=e(42994),r=e(97594);class o{constructor(c){this.publicDashboardsEnabled=!0,this.snapshotEnabled=!0,this.datasources={},this.panels={},this.apps={},this.auth={},this.minRefreshInterval="",this.appUrl="",this.appSubUrl="",this.namespace="default",this.windowTitlePrefix="",this.newPanelTitle="",this.externalUserMngLinkUrl="",this.externalUserMngLinkName="",this.externalUserMngInfo="",this.allowOrgCreate=!1,this.feedbackLinksEnabled=!0,this.disableLoginForm=!1,this.defaultDatasource="",this.angularSupportEnabled=!1,this.authProxyEnabled=!1,this.exploreEnabled=!1,this.queryHistoryEnabled=!1,this.helpEnabled=!1,this.profileEnabled=!1,this.newsFeedEnabled=!0,this.ldapEnabled=!1,this.jwtHeaderName="",this.jwtUrlLogin=!1,this.sigV4AuthEnabled=!1,this.azureAuthEnabled=!1,this.secureSocksDSProxyEnabled=!1,this.samlEnabled=!1,this.samlName="",this.autoAssignOrg=!0,this.verifyEmailEnabled=!1,this.oauth={},this.rbacEnabled=!0,this.disableUserSignUp=!1,this.loginHint="",this.passwordHint="",this.loginError=void 0,this.viewersCanEdit=!1,this.editorsCanAdmin=!1,this.disableSanitizeHtml=!1,this.trustedTypesDefaultPolicyEnabled=!1,this.cspReportOnlyEnabled=!1,this.liveEnabled=!0,this.featureToggles={},this.anonymousEnabled=!1,this.anonymousDeviceLimit=void 0,this.licenseInfo={},this.rendererAvailable=!1,this.rendererVersion="",this.rendererDefaultImageWidth=1e3,this.rendererDefaultImageHeight=500,this.rendererDefaultImageScale=1,this.secretsManagerPluginEnabled=!1,this.supportBundlesEnabled=!1,this.http2Enabled=!1,this.grafanaJavascriptAgent={enabled:!1,customEndpoint:"",apiKey:"",errorInstrumentalizationEnabled:!0,consoleInstrumentalizationEnabled:!1,webVitalsInstrumentalizationEnabled:!1},this.pluginCatalogURL="https://grafana.com/grafana/plugins/",this.pluginAdminEnabled=!0,this.pluginAdminExternalManageEnabled=!1,this.pluginCatalogHiddenPlugins=[],this.pluginsCDNBaseURL="",this.expressionsEnabled=!1,this.awsAllowedAuthProviders=[],this.awsAssumeRoleEnabled=!1,this.azure={managedIdentityEnabled:!1,workloadIdentityEnabled:!1,userIdentityEnabled:!1,userIdentityFallbackCredentialsEnabled:!1},this.caching={enabled:!1},this.unifiedAlertingEnabled=!1,this.unifiedAlerting={minInterval:"",alertStateHistoryBackend:void 0,alertStateHistoryPrimary:void 0},this.recordedQueries={enabled:!0},this.featureHighlights={enabled:!1},this.reporting={enabled:!0},this.analytics={enabled:!0},this.googleAnalytics4SendManualPageViews=!1,this.sqlConnectionLimits={maxOpenConns:100,maxIdleConns:100,connMaxLifetime:14400},this.disableFrontendSandboxForPlugins=[],this.bootData=c.bootData;const y={datasources:{},windowTitlePrefix:"Grafana - ",panels:{},newPanelTitle:"Panel Title",playlist_timespan:"1m",unsaved_changes_warning:!0,appUrl:"",appSubUrl:"",buildInfo:{version:"1.0",commit:"1",env:"production"},viewersCanEdit:!1,editorsCanAdmin:!1,disableSanitizeHtml:!1};(0,t.merge)(this,y,c),this.buildInfo=c.buildInfo||y.buildInfo,this.dateFormats&&s.WC.update(this.dateFormats),l(this),m(this),this.featureToggles.disableAngular&&(this.angularSupportEnabled=!1),this.theme2=(0,r.g)(this.bootData.user.theme),this.bootData.user.lightTheme=this.theme2.isLight,this.theme=this.theme2.v1}}function m(p){const c=p.featureToggles,f=window.localStorage.getItem("grafana.featureToggles");if(f){const P=f.split(",");for(const a of P){const[E,g]=a.split("="),h=g==="true"||g==="1";c[E]=h,console.log(`Setting feature toggle ${E} = ${h} via localstorage`)}}}function l(p){if(window.location.href.indexOf("__feature")===-1)return;const c=p.buildInfo.env==="development",y=new Set(["queryServiceFromUI"]);new URLSearchParams(window.location.search).forEach((P,a)=>{if(a.startsWith("__feature.")){const E=p.featureToggles,g=a.substring(10),h=P==="true"||P==="";h!==E[a]&&(c||y.has(g)?(E[g]=h,console.log(`Setting feature toggle ${g} = ${h} via url`)):console.log(`Unable to change feature toggle ${g} via url in production.`))}})}const i=window.grafanaBootData||{settings:{},user:{},navTree:[]},u=i.settings;u.bootData=i;const d=new o(u)},13303:(G,I,e)=>{"use strict";e.r(I),e.d(I,{CopyPanelEvent:()=>d.ah,DataSourcePicker:()=>M.s,DataSourceWithBackend:()=>v.iy,EchoEventType:()=>o.on,EmbeddedDashboard:()=>U.f,FakeEchoSrv:()=>o.c_,GrafanaBootConfig:()=>P.p,HealthCheckError:()=>v.b1,HealthStatus:()=>v.VQ,HistoryWrapper:()=>u.K9,MetaAnalyticsEventName:()=>a.n_,PanelDataErrorView:()=>S.a,PanelRenderer:()=>T.m,PluginPage:()=>b.V,RefreshEvent:()=>d._,StreamingFrameAction:()=>i.Kh,ThemeChangedEvent:()=>d.E8,TimeRangeUpdatedEvent:()=>d.sR,config:()=>P.$,createDataSourcePluginEventProperties:()=>A.y,createMonitoringLogger:()=>D.DW,createPluginEventProperties:()=>A.L,createQueryRunner:()=>x.d,featureEnabled:()=>h.a,frameToMetricFindValue:()=>C.$h,getAngularLoader:()=>n.E,getAppEvents:()=>d.J7,getBackendSrv:()=>t.AI,getDataSourceSrv:()=>s.l,getEchoSrv:()=>o.x$,getGrafanaLiveSrv:()=>i.oF,getLegacyAngularInjector:()=>l.C,getLocationSrv:()=>r.X,getPluginComponentExtensions:()=>p.Dp,getPluginExtensions:()=>p.O3,getPluginImportUtils:()=>E.o,getPluginLinkExtensions:()=>p.Kf,getRunRequest:()=>x.XJ,getTemplateSrv:()=>m.w,isExperimentViewEvent:()=>a.p6,isExpressionReference:()=>v.s9,isFetchError:()=>t.NF,isInteractionEvent:()=>a.fX,isPageviewEvent:()=>a.nB,isPluginExtensionComponent:()=>f.a,isPluginExtensionLink:()=>f.D,loadPluginCss:()=>E.PL,locationSearchToObject:()=>u.SE,locationService:()=>u.Ny,logDebug:()=>D.MD,logError:()=>D.vV,logInfo:()=>D.fH,logWarning:()=>D.FF,navigationLogger:()=>u.Lc,registerEchoBackend:()=>o.pl,reportExperimentView:()=>g.Xp,reportInteraction:()=>g.rR,reportMetaAnalytics:()=>g.G$,reportPageview:()=>g.Jy,setAngularLoader:()=>n.w,setAppEvents:()=>d.H8,setBackendSrv:()=>t.u5,setDataSourceSrv:()=>s.h,setEchoSrv:()=>o.H2,setEmbeddedDashboard:()=>U.p,setGrafanaLiveSrv:()=>i.S8,setLegacyAngularInjector:()=>l.j,setLocationService:()=>u.vG,setLocationSrv:()=>r.T,setPluginComponentHook:()=>y.A,setPluginExtensionGetter:()=>p.cE,setPluginExtensionsHook:()=>c.Vu,setPluginImportUtils:()=>E.se,setQueryRunnerFactory:()=>x.HC,setReturnToPreviousHook:()=>B._,setRunRequest:()=>x.pC,setTemplateSrv:()=>m.d,toDataQueryError:()=>O.u,toDataQueryResponse:()=>C.bE,usePluginComponent:()=>y.S,usePluginComponentExtensions:()=>c.kr,usePluginComponents:()=>c.f_,usePluginExtensions:()=>c.pc,usePluginInteractionReporter:()=>R.G,usePluginLinkExtensions:()=>c.vl,usePluginLinks:()=>c.Ux,useReturnToPrevious:()=>B.i});var t=e(17172),n=e(7376),s=e(19347),r=e(23509),o=e(63415),m=e(72574),l=e(81634),i=e(78731),u=e(12131),d=e(3591),p=e(4402),c=e(3197),y=e(79396),f=e(80882),P=e(32264),a=e(61298),E=e(89191),g=e(14110),h=e(33378),D=e(34867),v=e(26657),C=e(47773),T=e(24308),S=e(97152),O=e(12091),x=e(63639),b=e(46235),M=e(55882),A=e(27642),R=e(44027),B=e(14778),U=e(96937)},7376:(G,I,e)=>{"use strict";e.d(I,{E:()=>s,w:()=>n});let t;function n(r){t=r}function s(){return t}},63415:(G,I,e)=>{"use strict";e.d(I,{H2:()=>s,c_:()=>m,on:()=>t,pl:()=>o,x$:()=>r});var t=(l=>(l.Performance="performance",l.MetaAnalytics="meta-analytics",l.Pageview="pageview",l.Interaction="interaction",l.ExperimentView="experimentview",l.GrafanaJavascriptAgent="grafana-javascript-agent",l))(t||{});let n;function s(l){if(n instanceof m)for(const i of n.buffer)l.addEvent(i.event,i.meta);n=l}function r(){return n||(n=new m),n}const o=l=>{r().addBackend(l)};class m{constructor(){this.buffer=[]}flush(){this.buffer=[]}addBackend(i){}addEvent(i,u){this.buffer.push({event:i,meta:u})}}},12131:(G,I,e)=>{"use strict";e.d(I,{K9:()=>l,Lc:()=>c,Ny:()=>u,SE:()=>i,vG:()=>d});var t=e(17929),n=e(76885),s=e(95344),r=e(91040),o=e(40621),m=e(32264);class l{constructor(f){this.history=f||t.zR({basename:m.$.appSubUrl??"/"}),this.partial=this.partial.bind(this),this.push=this.push.bind(this),this.replace=this.replace.bind(this),this.getSearch=this.getSearch.bind(this),this.getHistory=this.getHistory.bind(this),this.getLocation=this.getLocation.bind(this)}getHistory(){return this.history}getSearch(){return new URLSearchParams(this.history.location.search)}partial(f,P){const a=this.history.location,E=this.getSearchObject();for(const h in f)f[h]===null||f[h]===void 0?delete E[h]:E[h]=f[h];const g=n.kM.renderUrl(a.pathname,E);P?this.history.replace(g,this.history.location.state):this.history.push(g,this.history.location.state)}push(f){this.history.push(f)}replace(f){this.history.replace(f)}reload(){const f=this.history.location.state?.routeReloadCounter;this.history.replace({...this.history.location,state:{routeReloadCounter:f?f+1:1}})}getLocation(){return this.history.location}getSearchObject(){return i(this.history.location.search)}update(f){if((0,s.l)("LocationSrv","update","partial, push or replace"),f.partial&&f.query)this.partial(f.query,f.partial);else{const P={pathname:f.path};f.query&&(P.search=n.kM.toUrlParams(f.query)),f.replace?this.replace(P):this.push(P)}}}function i(y){let f=typeof y=="number"?String(y):y;return f.length>0?f.startsWith("?")?n.kM.parseKeyValue(f.substring(1)):n.kM.parseKeyValue(f):{}}let u=new l;const d=y=>{throw new Error("locationService can be only overriden in test environment")},p=(0,r.h)("Router"),c=p.logger;(0,o.h)("location",u,p)},23509:(G,I,e)=>{"use strict";e.d(I,{T:()=>n,X:()=>s});let t;function n(r){t=r}function s(){return t}},63639:(G,I,e)=>{"use strict";e.d(I,{HC:()=>n,XJ:()=>m,d:()=>s,pC:()=>o});let t;const n=l=>{if(t)throw new Error("Runner should only be set when Grafana is starting.");t=l},s=()=>{if(!t)throw new Error("`createQueryRunner` can only be used after Grafana instance has started.");return t()};let r;function o(l){if(r)throw new Error("runRequest function should only be set once, when Grafana is starting.");r=l}function m(){if(!r)throw new Error("getRunRequest can only be used after Grafana instance has started.");return r}},3591:(G,I,e)=>{"use strict";e.d(I,{E8:()=>s,H8:()=>l,J7:()=>i,_:()=>n,ah:()=>o,sR:()=>r});var t=e(65463);class n extends t.a{static{this.type="refresh"}}class s extends t.x{static{this.type="theme-changed"}}class r extends t.x{static{this.type="time-range-updated"}}class o extends t.x{static{this.type="copy-panel"}}let m;function l(u){m=u}function i(){return m}},17172:(G,I,e)=>{"use strict";e.d(I,{AI:()=>r,NF:()=>t,u5:()=>s});function t(o){return typeof o=="object"&&o!==null&&"status"in o&&"data"in o}let n;const s=o=>{n=o},r=()=>n},19347:(G,I,e)=>{"use strict";e.d(I,{h:()=>n,l:()=>s});let t;function n(r){t=r}function s(){return t}},81634:(G,I,e)=>{"use strict";e.d(I,{C:()=>s,j:()=>n});let t;const n=r=>{t=r},s=()=>t},78731:(G,I,e)=>{"use strict";e.d(I,{Kh:()=>t.Kh,S8:()=>s,oF:()=>r});var t=e(9631);let n;const s=o=>{n=o},r=()=>n},4402:(G,I,e)=>{"use strict";e.d(I,{Dp:()=>l,Kf:()=>m,O3:()=>o,cE:()=>s});var t=e(80882);let n;function s(i){if(n)throw new Error("setPluginExtensionGetter() function should only be called once, when Grafana is starting.");n=i}function r(){if(!n)throw new Error("getPluginExtensionGetter() can only be used after the Grafana instance has started.");return n}const o=i=>r()(i),m=i=>{const{extensions:u}=o(i);return{extensions:u.filter(t.D)}},l=i=>{const{extensions:u}=o(i);return{extensions:u.filter(t.a)}}},79396:(G,I,e)=>{"use strict";e.d(I,{A:()=>n,S:()=>s});let t;function n(r){if(t)throw new Error("setPluginComponentHook() function should only be called once, when Grafana is starting.");t=r}function s(r){if(!t)throw new Error("setPluginComponentHook(options) can only be used after the Grafana instance has started.");return t(r)}},3197:(G,I,e)=>{"use strict";e.d(I,{Ux:()=>m,Vu:()=>r,f_:()=>l,kr:()=>u,pc:()=>o,vl:()=>i});var t=e(96540),n=e(80882);let s;function r(d){if(s)throw new Error("setPluginExtensionsHook() function should only be called once, when Grafana is starting.");s=d}function o(d){if(!s)throw new Error("usePluginExtensions(options) can only be used after the Grafana instance has started.");return s(d)}function m(d){const{extensions:p,isLoading:c}=o(d);return(0,t.useMemo)(()=>({links:p.filter(n.D),isLoading:c}),[p,c])}function l(d){const{extensions:p,isLoading:c}=o(d);return(0,t.useMemo)(()=>({components:p.filter(n.a),isLoading:c}),[p,c])}function i(d){const{extensions:p,isLoading:c}=o(d);return(0,t.useMemo)(()=>({extensions:p.filter(n.D),isLoading:c}),[p,c])}function u(d){const{extensions:p,isLoading:c}=o(d);return(0,t.useMemo)(()=>({extensions:p.filter(n.a),isLoading:c}),[p,c])}},80882:(G,I,e)=>{"use strict";e.d(I,{D:()=>n,a:()=>s});var t=e(74135);function n(r){return r?r.type===t.u.link&&("path"in r||"onClick"in r):!1}function s(r){return r?r.type===t.u.component&&"component"in r:!1}},72574:(G,I,e)=>{"use strict";e.d(I,{d:()=>n,w:()=>s});let t;const n=r=>{t=r},s=()=>t},26657:(G,I,e)=>{"use strict";e.d(I,{iy:()=>T,dR:()=>g,b1:()=>D,VQ:()=>v,s9:()=>h,ph:()=>O,x7:()=>S});var t=e(62467),n=e(75505),s=e(44240),r=e(63720),o=e(66847),m=e(40187),l=e(22391),i=e(55004),u=e(89667),d=e(92341),p=e(32264),c=e(19347),y=e(78731),f=e(17172),P=e(9631),a=e(47773);function E(x){const{intervalMs:b,maxDataPoints:M,requestId:A,panelId:R,queryCachingTTL:B,range:{from:U,to:W}}=x;if(!x.targets.length)return(0,t.of)({data:[]});const N={intervalMs:b,maxDataPoints:M,queryCachingTTL:B,timeRange:{from:U.valueOf().toString(),to:W.valueOf().toString(),timezone:x.timezone}};return(0,f.AI)().fetch({url:`/api/public/dashboards/${p.$.publicDashboardAccessToken}/panels/${R}/query`,method:"POST",data:N,requestId:A}).pipe((0,r.n)(w=>(0,t.of)((0,a.bE)(w,x.targets))),(0,o.W)(w=>(0,t.of)((0,a.bE)(w))))}const g=Object.freeze({type:"__expr__",uid:"__expr__",name:"Expression"});function h(x){if(!x)return!1;const b=typeof x=="string"?x:x.type;return b===g.type||b===g.name||b==="-100"}class D extends Error{constructor(b,M){super(b),this.details=M,this.name="HealthCheckError"}}var v=(x=>(x.Unknown="UNKNOWN",x.OK="OK",x.Error="ERROR",x))(v||{}),C=(x=>(x.PluginID="X-Plugin-Id",x.DatasourceUID="X-Datasource-Uid",x.DashboardUID="X-Dashboard-Uid",x.PanelID="X-Panel-Id",x.PanelPluginId="X-Panel-Plugin-Id",x.QueryGroupID="X-Query-Group-Id",x.FromExpression="X-Grafana-From-Expr",x.SkipQueryCache="X-Cache-Skip",x))(C||{});class T extends m.mA{constructor(b){super(b),this.streamOptionsProvider=O}query(b){if(p.$.publicDashboardAccessToken)return E(b);const{intervalMs:M,maxDataPoints:A,queryCachingTTL:R,range:B,requestId:U,hideFromInspector:W=!1}=b;let N=b.targets,w=!1;const L=new Set,V=new Set,K=N.map(J=>{let X=this.getRef(),se=this.id,ae=!0;if(h(J.datasource))return w=!0,{...J,datasource:g};if(J.datasource){const ne=(0,c.l)().getInstanceSettings(J.datasource,b.scopedVars);if(!ne)throw new Error(`Unknown Datasource: ${JSON.stringify(J.datasource)}`);const q=ne.rawRef??(0,l.p$)(ne),ee=ne.id;(q.uid!==X.uid||se!==ee)&&(X=q,se=ee,ae=!1)}return X.type?.length&&L.add(X.type),X.uid?.length&&V.add(X.uid),{...ae?this.applyTemplateVariables(J,b.scopedVars,b.filters):J,datasource:X,datasourceId:se,intervalMs:M,maxDataPoints:A,queryCachingTTL:R}});if(!K.length)return(0,t.of)({data:[]});const k={queries:K,from:B?.from.valueOf().toString(),to:B?.to.valueOf().toString()};if(p.$.featureToggles.queryOverLive)return(0,y.oF)().getQueryData({request:b,body:k});const j={};j["X-Plugin-Id"]=Array.from(L).join(", "),j["X-Datasource-Uid"]=Array.from(V).join(", ");let H="/api/ds/query?ds_type="+this.type;return p.$.featureToggles.queryServiceFromUI&&(p.$.featureToggles.queryService||p.$.featureToggles.grafanaAPIServerWithExperimentalAPIs?(!w&&V.size,H=`/apis/query.grafana.app/v0alpha1/namespaces/${p.$.namespace}/query?ds_type=' + this.type`):console.warn("feature toggle queryServiceFromUI also requires the queryService to be running")),w&&(j["X-Grafana-From-Expr"]="true",H+="&expression=true"),U&&(H+=`&requestId=${U}`),b.dashboardUID&&(j["X-Dashboard-Uid"]=b.dashboardUID),b.panelId&&(j["X-Panel-Id"]=`${b.panelId}`),b.panelPluginId&&(j["X-Panel-Plugin-Id"]=`${b.panelPluginId}`),b.queryGroupId&&(j["X-Query-Group-Id"]=`${b.queryGroupId}`),b.skipQueryCache&&(j["X-Cache-Skip"]="true"),(0,f.AI)().fetch({url:H,method:"POST",data:k,requestId:U,hideFromInspector:W,headers:j}).pipe((0,r.n)(J=>{const X=(0,a.bE)(J,K);return X.data?.length&&X.data.find(se=>se.meta?.channel)?S(X,b,this.streamOptionsProvider):(0,t.of)(X)}),(0,o.W)(J=>(0,t.of)((0,a.bE)(J))))}getRequestHeaders(){const b={};return b["X-Plugin-Id"]=this.type,b["X-Datasource-Uid"]=this.uid,b}interpolateVariablesInQueries(b,M,A){return b.map(R=>this.applyTemplateVariables(R,M,A))}applyTemplateVariables(b,M,A){return b}async getResource(b,M,A){const R=this.getRequestHeaders();return(await(0,n.s)((0,f.AI)().fetch({...A,method:"GET",headers:A?.headers?{...A.headers,...R}:R,params:M??A?.params,url:`/api/datasources/uid/${this.uid}/resources/${b}`}))).data}async postResource(b,M,A){const R=this.getRequestHeaders();return(await(0,n.s)((0,f.AI)().fetch({...A,method:"POST",headers:A?.headers?{...A.headers,...R}:R,data:M??{...M},url:`/api/datasources/uid/${this.uid}/resources/${b}`}))).data}async callHealthCheck(){return(0,n.s)((0,f.AI)().fetch({method:"GET",url:`/api/datasources/uid/${this.uid}/health`,showErrorAlert:!1,headers:this.getRequestHeaders()})).then(b=>b.data).catch(b=>b.data)}async testDatasource(){return this.callHealthCheck().then(b=>b.status==="OK"?{status:"success",message:b.message}:Promise.reject({status:"error",message:b.message,error:new D(b.message,b.details)}))}}function S(x,b,M){const A=(0,y.oF)();if(!A)return(0,t.of)(x);const R=[],B=[];for(const U of x.data){const W=(0,i.DG)(U.meta?.channel);if(W){const N=U;B.push(A.getDataStream({addr:W,buffer:M(b,N),frame:(0,u.Nw)(U)}))}else R.push(U)}return R.length&&B.push((0,t.of)({...x,data:R})),B.length===1?B[0]:(0,s.h)(...B)}const O=(x,b)=>{const M={maxLength:x.maxDataPoints??500,action:P.Kh.Append};return x.rangeRaw?.to==="now"&&(M.maxDelta=x.range.to.valueOf()-x.range.from.valueOf()),M};T=(0,d.Y)(T)},33378:(G,I,e)=>{"use strict";e.d(I,{a:()=>n});var t=e(32264);const n=s=>{const{enabledFeatures:r}=t.$.licenseInfo;return r&&r[s]}},34867:(G,I,e)=>{"use strict";e.d(I,{DW:()=>u,FF:()=>o,MD:()=>m,fH:()=>r,l$:()=>i,vV:()=>l});var t=e(32631),n=e(37930),s=e(32264);function r(d,p){s.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([d],{level:n.$b.INFO,context:p})}function o(d,p){s.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([d],{level:n.$b.WARN,context:p})}function m(d,p){s.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([d],{level:n.$b.DEBUG,context:p})}function l(d,p){s.$.grafanaJavascriptAgent.enabled&&t.P.api.pushError(d,{context:p})}function i(d,p,c){s.$.grafanaJavascriptAgent.enabled&&t.P.api.pushMeasurement({type:d,values:p,context:c})}function u(d,p){const c=y=>({source:d,...p,...y});return{logDebug:(y,f)=>m(y,c(f)),logInfo:(y,f)=>r(y,c(f)),logWarning:(y,f)=>o(y,c(f)),logError:(y,f)=>l(y,c(f)),logMeasurement:(y,f,P)=>i(y,f,c(P))}}},89191:(G,I,e)=>{"use strict";e.d(I,{PL:()=>n,o:()=>o,se:()=>r});var t=e(32264);async function n(m){try{const l=t.$.bootData.user.theme==="light"?m.light:m.dark;return window.System.import(l)}catch(l){console.error(l)}}let s;function r(m){if(s)throw new Error("pluginImportUtils should only be set once, when Grafana is starting.");s=m}function o(){if(!s)throw new Error("pluginImportUtils can only be used after Grafana instance has started.");return s}},47773:(G,I,e)=>{"use strict";e.d(I,{$h:()=>p,bE:()=>l});var t=e(39070),n=e(89667),s=e(14236),r=e(11261),o=e(12091);const m={severity:"info",text:"Cached response"};function l(c,y){const f={data:[],state:t.Gu.Done},P="traceId"in c?c.traceId:void 0;P!=null&&(f.traceIds=[P]);const a=c;if(a.data?.results){const E=a.data.results,g=y?.length?y.map(v=>v.refId):Object.keys(E),h=i(a),D=[];for(const v of g){const C=E[v];C&&(C.refId=v,D.push(C))}for(const v of D){if(v.error){const C={refId:v.refId,message:v.error,status:v.status};P!=null&&(C.traceId=P),f.error||(f.error={...C}),f.errors?f.errors.push({...C}):f.errors=[{...C}],f.state=t.Gu.Error}if(v.frames?.length){for(let C of v.frames){h&&(C=u(C));const T=(0,n.or)(C);T.refId||(T.refId=v.refId),f.data.push(T)}continue}if(v.series?.length)for(const C of v.series)C.refId||(C.refId=v.refId),f.data.push((0,s.Vc)(C));if(v.tables?.length)for(const C of v.tables)C.refId||(C.refId=v.refId),f.data.push((0,s.Vc)(C))}}return a.status&&a.status!==200&&(f.state!==t.Gu.Error&&(f.state=t.Gu.Error),f.error||(f.error=(0,o.u)(c))),f}function i(c){const y=c?.headers;return!y||!y.get?!1:y.get("X-Cache")==="HIT"}function u(c){return{...c,schema:{...c.schema,fields:[...c.schema?.fields??[]],meta:{...c.schema?.meta,notices:[...c.schema?.meta?.notices??[],m],isCachedResponse:!0}}}}function d(c){const y=l(c);if(y.error?.data?.message)return{status:"error",message:y.error.data.message,details:y.error?.data?.error?{message:y.error.data.error}:void 0};if(y.error?.refId&&y.error?.message)return{status:"error",message:y.error.message};throw c}function p(c){if(!c||!c.length)return[];const y=[];let f=c.fields.find(P=>P.type===r.PU.string);if(f||(f=c.fields.find(P=>P.type!==r.PU.time)),f)for(let P=0;P<f.values.length;P++)y.push({text:""+f.values[P]});return y}},14778:(G,I,e)=>{"use strict";e.d(I,{_:()=>n,i:()=>s});let t;const n=r=>{t=r},s=()=>t?t():()=>console.error("ReturnToPrevious hook not found")},52622:(G,I,e)=>{"use strict";e.d(I,{$N:()=>W,$l:()=>V,$m:()=>se,$p:()=>A,CD:()=>U,D7:()=>i,F8:()=>R,GR:()=>y,J1:()=>l,L4:()=>a,Lt:()=>D,Ly:()=>T,NU:()=>f,Nj:()=>h,ON:()=>v,QH:()=>n,QR:()=>t,RU:()=>r,SV:()=>B,T6:()=>k,TZ:()=>K,WQ:()=>s,Wq:()=>H,Y$:()=>p,aG:()=>m,dx:()=>P,eX:()=>L,fY:()=>ae,gs:()=>g,lm:()=>S,ob:()=>j,on:()=>E,qM:()=>X,q_:()=>o,uH:()=>u,vM:()=>d,vp:()=>ee,wV:()=>x,xB:()=>N,yL:()=>c,yp:()=>M,zT:()=>ne});var t=(z=>(z.AlertStates="alertStates",z.Annotations="annotations",z.Series="series",z))(t||{}),n=(z=>(z.Linear="linear",z.Quad="quad",z))(n||{}),s=(z=>(z.Clamped="clamped",z.Mod="mod",z))(s||{}),r=(z=>(z.Field="field",z.Fixed="fixed",z.Template="template",z))(r||{}),o=(z=>(z.Field="field",z.Fixed="fixed",z.Mapping="mapping",z))(o||{}),m=(z=>(z.Auto="auto",z.Coords="coords",z.Geohash="geohash",z.Lookup="lookup",z))(m||{}),l=(z=>(z.Count="count",z.Size="size",z))(l||{}),i=(z=>(z.auto="auto",z.ge="ge",z.le="le",z.unknown="unknown",z))(i||{}),u=(z=>(z.Ascending="Ascending",z.Descending="Descending",z))(u||{}),d=(z=>(z.Auto="auto",z.Bottom="bottom",z.Hidden="hidden",z.Left="left",z.Right="right",z.Top="top",z))(d||{}),p=(z=>(z.Series="series",z.Text="text",z))(p||{}),c=(z=>(z.Always="always",z.Auto="auto",z.Never="never",z))(c||{}),y=(z=>(z.Bars="bars",z.Line="line",z.Points="points",z))(y||{}),f=(z=>(z.Constant="constant",z.NegativeY="negative-Y",z))(f||{}),P=(z=>(z.Linear="linear",z.Smooth="smooth",z.StepAfter="stepAfter",z.StepBefore="stepBefore",z))(P||{}),a=(z=>(z.Linear="linear",z.Log="log",z.Ordinal="ordinal",z.Symlog="symlog",z))(a||{}),E=(z=>(z.Hue="hue",z.None="none",z.Opacity="opacity",z.Scheme="scheme",z))(E||{}),g=(z=>(z.None="none",z.Normal="normal",z.Percent="percent",z))(g||{}),h=(z=>(z[z.After=1]="After",z[z.Before=-1]="Before",z[z.Center=0]="Center",z))(h||{}),D=(z=>(z[z.Horizontal=0]="Horizontal",z[z.Vertical=1]="Vertical",z))(D||{}),v=(z=>(z[z.Down=-1]="Down",z[z.Left=-1]="Left",z[z.Right=1]="Right",z[z.Up=1]="Up",z))(v||{});const C={dash:[]};var T=(z=>(z.Area="area",z.Dashed="dashed",z.DashedAndArea="dashed+area",z.Line="line",z.LineAndArea="line+area",z.Off="off",z.Series="series",z))(T||{}),S=(z=>(z.Hidden="hidden",z.List="list",z.Table="table",z))(S||{});const O={calcs:[]};var x=(z=>(z.Auto="auto",z.Horizontal="horizontal",z.Vertical="vertical",z))(x||{});const b={timezone:[]};var M=(z=>(z.Background="background",z.BackgroundSolid="background_solid",z.None="none",z.Value="value",z))(M||{}),A=(z=>(z.Area="area",z.Line="line",z.None="none",z))(A||{}),R=(z=>(z.Auto="auto",z.Center="center",z))(R||{}),B=(z=>(z.Auto="auto",z.Name="name",z.None="none",z.Value="value",z.ValueAndName="value_and_name",z))(B||{}),U=(z=>(z.Inverted="inverted",z.SameAsValue="same_as_value",z.Standard="standard",z))(U||{}),W=(z=>(z.Multi="multi",z.None="none",z.Single="single",z))(W||{}),N=(z=>(z.Ascending="asc",z.Descending="desc",z.None="none",z))(N||{});const w={calcs:[]};var L=(z=>(z.Basic="basic",z.Gradient="gradient",z.Lcd="lcd",z))(L||{}),V=(z=>(z.Color="color",z.Hidden="hidden",z.Text="text",z))(V||{}),K=(z=>(z.Auto="auto",z.Left="left",z.Top="top",z))(K||{}),k=(z=>(z.Auto="auto",z.Manual="manual",z))(k||{}),j=(z=>(z.Auto="auto",z.BasicGauge="basic",z.ColorBackground="color-background",z.ColorBackgroundSolid="color-background-solid",z.ColorText="color-text",z.Custom="custom",z.DataLinks="data-links",z.Gauge="gauge",z.GradientGauge="gradient-gauge",z.Image="image",z.JSONView="json-view",z.LcdGauge="lcd-gauge",z.Sparkline="sparkline",z))(j||{}),H=(z=>(z.Basic="basic",z.Gradient="gradient",z))(H||{});const J={fields:[],reducer:[]};var X=(z=>(z.Auto="auto",z.Lg="lg",z.Md="md",z.Sm="sm",z))(X||{}),se=(z=>(z.CSV="csv",z.Date="date",z.Distributed="distributed",z.DoubleQuote="doublequote",z.Glob="glob",z.HTML="html",z.JSON="json",z.Lucene="lucene",z.PercentEncode="percentencode",z.Pipe="pipe",z.QueryParam="queryparam",z.Raw="raw",z.Regex="regex",z.SQLString="sqlstring",z.SingleQuote="singlequote",z.Text="text",z.UriEncode="uriencode",z))(se||{}),ae=(z=>(z.exact="exact",z.none="none",z.numbers="numbers",z.signature="signature",z))(ae||{}),ne=(z=>(z.EQ="eq",z.GT="gt",z.GTE="gte",z.LT="lt",z.LTE="lte",z.NEQ="neq",z))(ne||{});const q={align:"auto",inspect:!1},ee="browser"},33623:(G,I,e)=>{"use strict";e.d(I,{KQ:()=>s,QB:()=>r});var t=e(52622);const n="11.1.0",s={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:t.wV.Auto,showValue:t.yL.Auto,stacking:t.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},r={fillOpacity:80,gradientMode:t.on.None,lineWidth:1}},16371:(G,I,e)=>{"use strict";e.d(I,{K:()=>s});var t=e(52622);const n="11.1.0",s={displayMode:t.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:t.TZ.Auto,showUnfilled:!0,sizing:t.T6.Auto,valueMode:t.$l.Color}},37827:(G,I,e)=>{"use strict";e.d(I,{K:()=>n});const t="11.1.0",n={selectedSeries:0}},44955:(G,I,e)=>{"use strict";e.d(I,{K:()=>s});var t=e(52622);const n="11.1.0",s={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:t.T6.Auto}},87487:(G,I,e)=>{"use strict";e.d(I,{KQ:()=>n});const t="11.1.0",n={layers:[]},s={allLayers:!0,id:"zero",lat:0,lon:0,zoom:1};var r=(m=>(m.Details="details",m.None="none",m))(r||{}),o=(m=>(m.Coords="coords",m.Fit="fit",m.Zero="zero",m))(o||{})},96529:(G,I,e)=>{"use strict";e.d(I,{KQ:()=>m});var t=e(52622);const n="11.1.0";var s=(l=>(l.Opacity="opacity",l.Scheme="scheme",l))(s||{}),r=(l=>(l.Exponential="exponential",l.Linear="linear",l))(r||{}),o=(l=>(l.X="x",l.Xy="xy",l.Y="y",l))(o||{});const m={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:t.yL.Auto,tooltip:{mode:t.$N.Single,yHistogram:!1,showColorScale:!1}}},42226:(G,I,e)=>{"use strict";e.d(I,{KQ:()=>s,QB:()=>r});var t=e(52622);const n="11.1.0",s={bucketCount:30,bucketOffset:0},r={fillOpacity:80,gradientMode:t.on.None,lineWidth:1}},69383:(G,I,e)=>{"use strict";e.d(I,{K:()=>n});const t="11.1.0",n={showImage:!0}},65391:(G,I,e)=>{"use strict";e.d(I,{KQ:()=>m});const t="11.1.0";var n=(l=>(l.Donut="donut",l.Pie="pie",l))(n||{}),s=(l=>(l.Name="name",l.Percent="percent",l.Value="value",l))(s||{}),r=(l=>(l.Percent="percent",l.Value="value",l))(r||{});const o={values:[]},m={displayLabels:[]}},89607:(G,I,e)=>{"use strict";e.d(I,{K:()=>s});var t=e(52622);const n="11.1.0",s={colorMode:t.yp.Value,graphMode:t.$p.Area,justifyMode:t.F8.Auto,percentChangeColorMode:t.CD.Standard,showPercentChange:!1,textMode:t.SV.Auto,wideLayout:!0}},15821:(G,I,e)=>{"use strict";e.d(I,{KQ:()=>s,QB:()=>r});var t=e(52622);const n="11.1.0",s={alignValue:"left",mergeValues:!0,rowHeight:.9,showValue:t.yL.Auto},r={fillOpacity:70,lineWidth:0}},64337:(G,I,e)=>{"use strict";e.d(I,{KQ:()=>s,QB:()=>r});var t=e(52622);const n="11.1.0",s={colWidth:.9,rowHeight:.9,showValue:t.yL.Auto},r={fillOpacity:70,lineWidth:1}},52037:(G,I,e)=>{"use strict";e.d(I,{K:()=>s});var t=e(52622);const n="11.1.0",s={cellHeight:t.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]}},12183:(G,I,e)=>{"use strict";e.d(I,{KQ:()=>m});const t="11.1.0";var n=(l=>(l.Code="code",l.HTML="html",l.Markdown="markdown",l))(n||{}),s=(l=>(l.Go="go",l.Html="html",l.Json="json",l.Markdown="markdown",l.Plaintext="plaintext",l.Sql="sql",l.Typescript="typescript",l.Xml="xml",l.Yaml="yaml",l))(s||{});const r="plaintext",o={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},m={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"}},10055:(G,I,e)=>{"use strict";e.d(I,{KQ:()=>l,QB:()=>m});var t=e(52622);const n="11.1.0";var s=(i=>(i.Auto="auto",i.Manual="manual",i))(s||{}),r=(i=>(i.Lines="lines",i.Points="points",i.PointsAndLines="points+lines",i))(r||{});const o={exclude:[]},m={label:t.yL.Auto,show:"points"},l={series:[]}},73134:(G,I,e)=>{"use strict";e.d(I,{CO:()=>m,GW:()=>T,OA:()=>h,Ol:()=>c,QB:()=>C,Yb:()=>d,Ye:()=>S,ZG:()=>i,aD:()=>s,bf:()=>r,bt:()=>D,dM:()=>f,lt:()=>a,rw:()=>o,ss:()=>v,yV:()=>E});const t={tags:[]},n={exclude:!1,ids:[]},s={list:[]},r={builtIn:0,enable:!0,hide:!1},o={includeAll:!1,multi:!1,options:[],skipUrlSync:!1};var m=(O=>(O[O.never=0]="never",O[O.onDashboardLoad=1]="onDashboardLoad",O[O.onTimeRangeChanged=2]="onTimeRangeChanged",O))(m||{}),l=(O=>(O[O.dontHide=0]="dontHide",O[O.hideLabel=1]="hideLabel",O[O.hideVariable=2]="hideVariable",O))(l||{}),i=(O=>(O[O.alphabeticalAsc=1]="alphabeticalAsc",O[O.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",O[O.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",O[O.alphabeticalDesc=2]="alphabeticalDesc",O[O.disabled=0]="disabled",O[O.naturalAsc=7]="naturalAsc",O[O.naturalDesc=8]="naturalDesc",O[O.numericalAsc=3]="numericalAsc",O[O.numericalDesc=4]="numericalDesc",O))(i||{});const u={asDropdown:!1,includeVars:!1,keepTime:!1,tags:[],targetBlank:!1};var d=(O=>(O.ContinuousBlPu="continuous-BlPu",O.ContinuousBlYlRd="continuous-BlYlRd",O.ContinuousBlues="continuous-blues",O.ContinuousGrYlRd="continuous-GrYlRd",O.ContinuousGreens="continuous-greens",O.ContinuousPurples="continuous-purples",O.ContinuousRdYlGr="continuous-RdYlGr",O.ContinuousReds="continuous-reds",O.ContinuousYlBl="continuous-YlBl",O.ContinuousYlRd="continuous-YlRd",O.Fixed="fixed",O.PaletteClassic="palette-classic",O.PaletteClassicByName="palette-classic-by-name",O.Shades="shades",O.Thresholds="thresholds",O))(d||{});const p={h:9,w:12,x:0,y:0};var c=(O=>(O.Absolute="absolute",O.Percentage="percentage",O))(c||{});const y={steps:[]};var f=(O=>(O.RangeToText="range",O.RegexToText="regex",O.SpecialValue="special",O.ValueToText="value",O))(f||{}),P=(O=>(O.Empty="empty",O.False="false",O.NaN="nan",O.Null="null",O.NullAndNan="null+nan",O.True="true",O))(P||{});const a={hidden:!1,refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],time_options:["5m","15m","1h","6h","12h","24h","2d","7d","30d"]};var E=(O=>(O[O.Crosshair=1]="Crosshair",O[O.Off=0]="Off",O[O.Tooltip=2]="Tooltip",O))(E||{});const g=0,h={links:[],repeatDirection:"h",targets:[],transformations:[],transparent:!1},D={overrides:[]},v={id:""},C={links:[],mappings:[]},T={collapsed:!1,panels:[]},S={editable:!0,fiscalYearStartMonth:0,graphTooltip:0,links:[],panels:[],schemaVersion:39,tags:[],timezone:"browser"}},39651:(G,I,e)=>{"use strict";e.d(I,{Gu:()=>s,gB:()=>n});var t=e(52622);const n={align:"auto",inspect:!1,cellOptions:{type:t.ob.Auto}};var s=(r=>(r.NotStarted="NotStarted",r.Loading="Loading",r.Streaming="Streaming",r.Done="Done",r.Error="Error",r))(s||{})},79422:(G,I,e)=>{"use strict";e.d(I,{Ye:()=>s,lt:()=>o,rw:()=>r,zL:()=>n});var t=e(73134),n=(y=>(y[y.dontHide=0]="dontHide",y[y.hideLabel=1]="hideLabel",y[y.hideVariable=2]="hideVariable",y))(n||{});const s=t.Ye,r={...t.rw},o=t.lt,m=t.OA,l=t.GW,i=t.QB,u=t.bt,d=t.ss,p=t.bf,c=t.aD},11807:(G,I,e)=>{"use strict";e.d(I,{l:()=>d});var t=e(32196),n=e(96540),s=e(73287),r=e(14110),o=e(40845),m=e(29158),l=e(88575),i=e(32372),u=e(94471);function d({rawSql:c,datasourceType:y}){const[f,P]=(0,s.A)(),a=(0,o.of)(p),E=h=>{P(h),(0,r.rR)("grafana_sql_preview_copied",{datasource:y})},g=n.createElement("div",{className:a.labelWrapper},n.createElement("span",{className:a.label},"Preview"),n.createElement(m.K,{tooltip:"Copy to clipboard",onClick:()=>E(c),name:"copy"}));return n.createElement(l.D,{label:g,className:a.grow},n.createElement(i.B,{language:"sql",height:80,value:(0,u.s)(c),monacoOptions:{scrollbar:{vertical:"hidden"},scrollBeyondLastLine:!1},readOnly:!0,showMiniMap:!1}))}function p(c){return{grow:(0,t.css)({flexGrow:1}),label:(0,t.css)({fontSize:12,fontWeight:c.typography.fontWeightMedium}),labelWrapper:(0,t.css)({display:"flex",justifyContent:"space-between",paddingBottom:c.spacing(.5)})}}},94471:(G,I,e)=>{"use strict";e.d(I,{s:()=>n});var t=e(27633);function n(s){return t.Ay.format(s).replace(/(\$ \{ .* \})|(\$ __)|(\$ \w+)/g,r=>r.replace(/\s/g,""))}},42418:(G,I,e)=>{"use strict";e.d(I,{F:()=>u});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(55852),m=e(14578),l=e(90613),i=e(94753);const u=n.forwardRef(({title:c,onRemove:y,children:f,buttonContent:P,elevated:a,bottomSpacing:E,topSpacing:g,className:h,severity:D="error",...v},C)=>{const T=(0,r.$j)(),O=p(T,D,!!c,a,E,g),x={error:"alert",warning:"alert",info:"status",success:"status"},b=v.role||x[D],M=v["aria-label"]||c;return n.createElement("div",{ref:C,className:(0,t.cx)(O.wrapper,h),role:b,"aria-label":M,...v},n.createElement(l.a,{"data-testid":s.Tp.components.Alert.alertV2(D),display:"flex",backgroundColor:D,borderRadius:"default",paddingY:1,paddingX:2,borderStyle:"solid",borderColor:D,alignItems:"stretch",boxShadow:a?"z3":void 0},n.createElement(l.a,{paddingTop:1,paddingRight:2},n.createElement("div",{className:O.icon},n.createElement(m.I,{size:"xl",name:d(D)}))),n.createElement(l.a,{paddingY:1,grow:1},n.createElement(i.E,{color:"primary",weight:"medium"},c),f&&n.createElement("div",{className:O.content},f)),y&&!P&&n.createElement("div",{className:O.close},n.createElement(o.$n,{"aria-label":"Close alert",icon:"times",onClick:y,type:"button",fill:"text",variant:"secondary"})),y&&P&&n.createElement(l.a,{marginLeft:1,display:"flex",alignItems:"center"},n.createElement(o.$n,{"aria-label":"Close alert",variant:"secondary",onClick:y,type:"button"},P))))});u.displayName="Alert";const d=c=>{switch(c){case"error":return"exclamation-circle";case"warning":return"exclamation-triangle";case"info":return"info-circle";case"success":return"check"}},p=(c,y,f,P,a,E)=>{const g=c.colors[y];return{wrapper:(0,t.css)({flexGrow:1,marginBottom:c.spacing(a??2),marginTop:c.spacing(E??0),position:"relative","&:before":{content:'""',position:"absolute",top:0,left:0,bottom:0,right:0,background:c.colors.background.primary,zIndex:-1}}),icon:(0,t.css)({color:g.text}),content:(0,t.css)({color:c.colors.text.primary,paddingTop:f?c.spacing(.5):0,maxHeight:"50vh",overflowY:"auto"}),close:(0,t.css)({position:"relative",color:c.colors.text.secondary,background:"none",display:"flex",top:"-6px",right:"-14px"})}}},28270:(G,I,e)=>{"use strict";e.d(I,{p:()=>y});var t=e(32196),n=e(2543),s=e(96540),r=e(40845),o=e(88575),m=e(32982);const l=s.memo(()=>{const P=(0,r.of)(i);return s.createElement("div",{className:P.ellipsis},s.createElement("span",{className:P.firstDot},"."),s.createElement("span",{className:P.secondDot},"."),s.createElement("span",{className:P.thirdDot},"."))});l.displayName="EllipsisAnimated";const i=P=>({ellipsis:(0,t.css)({display:"inline"}),firstDot:(0,t.css)({[P.transitions.handleMotion("no-preference","reduce")]:{animation:`${u} 2s linear infinite`}}),secondDot:(0,t.css)({[P.transitions.handleMotion("no-preference","reduce")]:{animation:`${d} 2s linear infinite`}}),thirdDot:(0,t.css)({[P.transitions.handleMotion("no-preference","reduce")]:{animation:`${p} 2s linear infinite`}})}),u=(0,t.keyframes)`
  0% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,d=(0,t.keyframes)`
  0% {
    opacity: 0;
  }
  21% {
    opacity: 0.5;
  }
  22% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,p=(0,t.keyframes)`
  0% {
    opacity: 0;
  }
  43% {
    opacity: 0.5;
  }
  44% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,c=2*1e3;function y(P){const{invalid:a,loading:E,onFinishChange:g,saveErrorMessage:h="Error saving this value",error:D,children:v,disabled:C,...T}=P,[S,O]=s.useState({isLoading:!1,showSuccess:!1,showError:a}),x=(0,s.useRef)(null);s.useEffect(()=>{let B;if(S.showSuccess){const U=S.showError?0:c;B=setTimeout(()=>{O({...S,showSuccess:!1})},U)}return()=>{window.clearTimeout(B)}},[S]);const b=(0,s.useCallback)(B=>{a||(O({...S,isLoading:!0,showSuccess:!1}),g(B).then(()=>{O({isLoading:!1,showSuccess:!0,showError:!1})}).catch(()=>{O({...S,isLoading:!1,showError:!0})}))},[a,S,g]),M=(0,s.useMemo)(()=>(0,n.debounce)(b,600,{leading:!1}),[b]),A=a||S.showError||void 0,R=(0,r.of)(f);return s.createElement(s.Fragment,null,s.createElement(o.D,{...T,loading:E||void 0,invalid:A,disabled:C,error:D||S.showError&&h,ref:x,className:R.widthFitContent},s.cloneElement(v(B=>{M(B)}))),S.isLoading&&s.createElement(m.r,{referenceElement:x.current,placement:"right"},"Saving ",s.createElement(l,null)),S.showSuccess&&s.createElement(m.r,{suffixIcon:"check",referenceElement:x.current,placement:"right"},"Saved!"))}y.displayName="AutoSaveField";const f=()=>({widthFitContent:(0,t.css)({width:"fit-content"})})},39938:(G,I,e)=>{"use strict";e.d(I,{E:()=>p});var t=e(32196),n=e(96540),s=e(70255),r=e(84140),o=e(40845),m=e(72129),l=e(14578),i=e(56034);const u=n.memo(({icon:f,color:P,text:a,tooltip:E,className:g,...h})=>{const D=(0,o.of)(y,P),v=n.createElement("div",{className:(0,t.cx)(D.wrapper,g),...h},f&&n.createElement(l.I,{name:f,size:"sm"}),a);return E?n.createElement(i.m,{content:E,placement:"auto"},v):v});u.displayName="Badge";const d=({rootProps:f})=>{const P=(0,o.of)(c);return n.createElement(s.A,{width:60,height:22,containerClassName:P.container,...f})},p=(0,m.j)(u,d),c=()=>({container:(0,t.css)({lineHeight:1})}),y=(f,P)=>{let a=f.visualization.getColorByName(P),E="",g="",h="";return f.isDark?(g=(0,r.A)(a).setAlpha(.15).toString(),E=(0,r.A)(a).setAlpha(.25).toString(),h=(0,r.A)(a).lighten(15).toString()):(g=(0,r.A)(a).setAlpha(.15).toString(),E=(0,r.A)(a).setAlpha(.25).toString(),h=(0,r.A)(a).darken(20).toString()),{wrapper:(0,t.css)({display:"inline-flex",padding:"1px 4px",borderRadius:f.shape.radius.default,background:g,border:`1px solid ${E}`,color:h,fontWeight:f.typography.fontWeightRegular,gap:"2px",fontSize:f.typography.bodySmall.fontSize,lineHeight:f.typography.bodySmall.lineHeight,alignItems:"center"})}}},97696:(G,I,e)=>{"use strict";e.d(I,{xE:()=>v});var t=e(32196),n=e(96540),s=e(84140),r=e(47070),o=e(50082),m=e(58649),l=e(83195),i=e(24293),u=e(8066),d=e(13544),p=e(52622),c=e(29413),y=e(55852),f=e(9286);const P=18,a=50,E=150,g=1.5,h=1,D=10;class v extends n.PureComponent{static{this.defaultProps={lcdCellWidth:12,value:{text:"100",numeric:100},displayMode:p.eX.Gradient,orientation:r.wV.Horizontal,field:{min:0,max:100,thresholds:{mode:o.O.Absolute,steps:[]}},itemSpacing:8,showUnfilled:!0}}render(){const{onClick:W,className:N,theme:w}=this.props,{title:L}=this.props.value,V=S(this.props);return W?n.createElement("button",{type:"button",style:V.wrapper,onClick:W,className:(0,t.cx)((0,y.my)(w),N)},n.createElement("div",{style:V.title},L),this.renderBarAndValue()):n.createElement("div",{style:V.wrapper,className:N},L&&n.createElement("div",{style:V.title},L),this.renderBarAndValue())}renderBarAndValue(){switch(this.props.displayMode){case"lcd":return this.renderRetroBars();case"basic":case"gradient":default:return this.renderBasicAndGradientBars()}}renderBasicAndGradientBars(){const{value:W,showUnfilled:N,valueDisplayMode:w}=this.props,L=M(this.props);return n.createElement("div",{style:L.wrapper},w!==p.$l.Hidden&&n.createElement(f.i,{"data-testid":d.Tp.components.Panels.Visualization.BarGauge.valueV2,value:W,style:L.value}),N&&n.createElement("div",{style:L.emptyBar}),n.createElement("div",{style:L.bar}))}renderRetroBars(){const{display:W,field:N,value:w,itemSpacing:L,alignmentFactors:V,orientation:K,lcdCellWidth:k,text:j,valueDisplayMode:H,theme:J}=this.props,{valueHeight:X,valueWidth:se,maxBarHeight:ae,maxBarWidth:ne,wrapperWidth:q,wrapperHeight:ee}=O(this.props),z=N.min??m.tw,te=N.max??m.d1,ie=C(K),ce=te-z,ue=ie?ae:ne,fe=L,Te=Math.floor(ue/k),he=Math.floor((ue-fe*Te)/Te),de=R(this.props),pe=B(V||w,de,se,X,K,j),ve={width:`${q}px`,height:`${ee}px`,display:"flex"};ie?(ve.flexDirection="column-reverse",ve.alignItems="center"):(ve.flexDirection="row",ve.alignItems="center",pe.justifyContent="flex-end");const be=[];for(let Oe=0;Oe<Te;Oe++){const Me=z+ce/Te*Oe,Ue=x(Me,w,W),we={borderRadius:J.shape.radius.default};Ue.isLit?we.backgroundImage=`radial-gradient(${Ue.background} 10%, ${Ue.backgroundShade})`:we.backgroundColor=Ue.background,ie?(we.height=`${he}px`,we.width=`${ne}px`,we.marginTop=`${fe}px`):(we.width=`${he}px`,we.height=`${ae}px`,we.marginRight=`${fe}px`),be.push(n.createElement("div",{key:Oe.toString(),style:we}))}return n.createElement("div",{style:ve},be,H!==p.$l.Hidden&&n.createElement(f.i,{"data-testid":d.Tp.components.Panels.Visualization.BarGauge.valueV2,value:w,style:pe}))}}function C(U){return U===r.wV.Vertical}function T(U){const{height:W,width:N,alignmentFactors:w,orientation:L,text:V,namePlacement:K}=U,k=w?w.title:U.value.title;if(!k)return{fontSize:0,width:0,height:0,placement:"above"};if(C(L)){const ne=V?.titleSize??14;return{fontSize:ne,width:N,height:ne*g,placement:"below"}}if(W>40&&K===p.TZ.Auto||K===p.TZ.Top){if(V?.titleSize)return{fontSize:V?.titleSize,width:0,height:V.titleSize*g,placement:"above"};const q=Math.max(Math.min(W*.45,a),17);return{fontSize:q/g,width:0,height:q,placement:"above"}}const X=Math.max(W*.6,P)/g,se=(0,c.kD)(k,X),ae=Math.min(se.width+15,N*.4);return{fontSize:V?.titleSize??X,height:0,width:ae,placement:"left"}}function S(U){const W={display:"flex",overflow:"hidden",width:"100%"},N=T(U),w={fontSize:`${N.fontSize}px`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",alignItems:"center",alignSelf:"center"};return C(U.orientation)?(W.flexDirection="column-reverse",w.textAlign="center"):N.placement==="above"?W.flexDirection="column":(W.flexDirection="row",w.width=`${N.width}px`,w.textAlign="right",w.paddingRight="10px"),{wrapper:W,title:w}}function O(U){const{height:W,width:N,orientation:w,text:L,alignmentFactors:V,valueDisplayMode:K}=U,k=T(U),j=V??U.value,H=(0,l.cN)(j);let J=0,X=0,se=0,ae=0,ne=0,q=0;const ee=L?.valueSize??Math.max(k.fontSize,12),te=(0,c.kD)(H,ee).width+D*2;return C(w)?(L?.valueSize?se=L.valueSize*h:se=Math.min(Math.max(W*.1,P),a),ae=N,K===p.$l.Hidden&&(se=0,ae=0),J=W-(k.height+se),X=N,ne=N,q=W-k.height):(K===p.$l.Hidden?(se=0,ae=0):(se=W-k.height,ae=Math.max(Math.min(N*.2,E),te)),J=W-k.height,X=N-ae-k.width,k.placement==="above"?(ne=N,q=W-k.height):(ne=N-k.width,q=W)),{valueWidth:ae,valueHeight:se,maxBarWidth:X,maxBarHeight:J,wrapperHeight:q,wrapperWidth:ne}}function x(U,W,N){if(U===null)return{background:i.F,border:i.F};const w=N?N(U).color:null;return w?W===null||isNaN(W.numeric)||U!==null&&U>W.numeric?{background:(0,s.A)(w).setAlpha(.18).toRgbString(),border:"transparent",isLit:!1}:{background:(0,s.A)(w).setAlpha(.95).toRgbString(),backgroundShade:(0,s.A)(w).setAlpha(.55).toRgbString(),border:(0,s.A)(w).setAlpha(.9).toRgbString(),isLit:!0}:{background:i.F,border:i.F}}function b(U,W,N){const w=Math.min((U-W)/(N-W),1);return isNaN(w)?0:w}function M(U){const{displayMode:W,field:N,value:w,alignmentFactors:L,orientation:V,theme:K,text:k}=U,{valueWidth:j,valueHeight:H,maxBarHeight:J,maxBarWidth:X}=O(U),se=N.min??m.tw,ae=N.max??m.d1,ne=b(w.numeric,se,ae),q=R(U),ee=w.color??i.F,te=B(L||w,q,j,H,V,k),ie=W==="basic",ce={display:"flex",flexGrow:1},ue={borderRadius:K.shape.radius.default,position:"relative",zIndex:1},fe={background:K.colors.background.secondary,flexGrow:1,display:"flex",borderRadius:K.shape.radius.default,position:"relative"};if(C(V)){const Te=Math.max(ne*J,1);ce.flexDirection="column",ce.justifyContent="flex-end",ue.transition="height 1s",ue.height=`${Te}px`,ue.width=`${X}px`,fe.bottom="-3px",fe.width=`${j}px`,ie?(ue.background=`${(0,s.A)(ee).setAlpha(.35).toRgbString()}`,ue.borderTop=`2px solid ${ee}`):ue.background=A(U,J)}else{const Te=Math.max(ne*X,1);ce.flexDirection="row-reverse",ce.justifyContent="flex-end",ce.alignItems="stretch",ue.transition="width 1s",ue.height=`${J}px`,ue.width=`${Te}px`,fe.left="-3px",fe.height=`${H}px`,ie?(ue.background=`${(0,s.A)(ee).setAlpha(.35).toRgbString()}`,ue.borderRight=`2px solid ${ee}`):ue.background=A(U,X)}return{wrapper:ce,bar:ue,value:te,emptyBar:fe}}function A(U,W){const{field:N,value:w,orientation:L,theme:V}=U,K=C(L)?"0deg":"90deg",k=N.min,j=N.max;let H="",J=0,X=(0,u.Hs)(N.color?.mode);if(X.id===i.Y.Thresholds){const se=N.thresholds;for(let ae=0;ae<se.steps.length;ae++){const ne=se.steps[ae],q=U.theme.visualization.getColorByName(ne.color),ee=se.mode===o.O.Percentage?ne.value/100:b(ne.value,k,j),z=ee*W,te=Math.round(z-(z-J)/2),ie=se.mode===o.O.Percentage?k+(j-k)*ee:ne.value;if(H==="")H=`linear-gradient(${K}, ${q}, ${q}`;else{if(w.numeric<ie)break;J=z,H+=` ${te}px, ${q}`}}return H+")"}if(X.isContinuous&&X.getColors){const se=X.getColors(V);for(let ae=0;ae<se.length;ae++){const ne=se[ae];if(H==="")H=`linear-gradient(${K}, ${ne} 0px`;else{const ee=ae/(se.length-1)*W;H+=`, ${ne} ${ee}px`}}return H+")"}return w.color??i.F}function R(U){if(U.valueDisplayMode==="text")return U.theme.colors.text.primary;const{value:W}=U;return W.color?W.color:i.F}function B(U,W,N,w,L,V){const K={color:W,height:`${w}px`,width:`${N}px`,display:"flex",alignItems:"center",lineHeight:h};let k=N;const j=(0,l.cN)(U);return C(L)?(K.fontSize=V?.valueSize??(0,c.Vr)(j,k,w,h),K.justifyContent="center"):(K.fontSize=V?.valueSize??(0,c.Vr)(j,k-D*2,w,h),K.justifyContent="flex-end",K.paddingLeft=`${D}px`,K.paddingRight=`${D}px`,k-=D),K}},37494:(G,I,e)=>{"use strict";e.d(I,{yV:()=>B,yp:()=>b,$p:()=>M,F8:()=>A,SV:()=>R});var t=e(32196),n=e(96540),s=e(55852),r=e(9286),o=e(84140),m=e(11261),l=e(83195),i=e(52622),u=e(24284),d=e(29413),p=e(5926),c=e(14578);const y=({percentChange:U,styles:W})=>{const N=U&&(U>0?"arrow-up":U<0?"arrow-down":void 0);return n.createElement("div",{style:W.containerStyles},N&&n.createElement(c.I,{name:N,height:W.iconSize,width:W.iconSize,viewBox:"6 6 12 12"}),f(U))},f=U=>U?.toLocaleString(void 0,{style:"percent",maximumSignificantDigits:3})??"",P=1.2,a=30,E=500;class g{constructor(W){this.props=W;const{width:N,height:w,value:L,text:V}=W;this.valueColor=L.color??"gray",this.panelPadding=w>100?12:8,this.textValues=O(W),this.justifyCenter=S(W.justifyMode,this.textValues.title),this.valueToAlignTo=this.textValues.valueToAlignTo,this.titleToAlignTo=this.textValues.titleToAlignTo,this.titleFontSize=0,this.valueFontSize=0,this.chartHeight=0,this.chartWidth=0,this.maxTextWidth=N-this.panelPadding*2,this.maxTextHeight=w-this.panelPadding*2,V&&(V.titleSize&&(this.titleFontSize=V.titleSize,this.titleToAlignTo=void 0),V.valueSize&&(this.valueFontSize=V.valueSize,this.valueToAlignTo=""))}getTitleStyles(){const W={fontSize:`${this.titleFontSize}px`,lineHeight:P};return(this.props.colorMode===b.Background||this.props.colorMode===b.BackgroundSolid)&&(W.color=(0,u.mZ)(this.valueColor,this.props.theme.isDark)),W}getValueStyles(){const W={fontSize:this.valueFontSize,fontWeight:E,lineHeight:P,position:"relative",zIndex:1};switch(this.justifyCenter&&(W.textAlign="center"),this.props.colorMode){case b.Value:W.color=this.valueColor;break;case b.Background:case b.BackgroundSolid:W.color=(0,u.mZ)(this.valueColor,this.props.theme.isDark);break;case b.None:W.color=this.props.theme.colors.text.primary;break}return W}getPercentChangeStyles(W,N,w){const V=this.getValueAndTitleContainerStyles(),K=Math.max(this.valueFontSize/2.5,12);let k=Math.max(this.valueFontSize/3,10);const j=this.props.theme.visualization,H=x(W,N,w,j),J={fontSize:K,fontWeight:E,lineHeight:P,position:"relative",display:"flex",alignItems:"center",gap:Math.max(K/3,4),zIndex:1,color:H};switch(this.justifyCenter&&(J.textAlign="center"),V.flexDirection==="column"&&K>12&&(J.marginTop=-(K/4)),V.flexDirection==="row"&&(J.alignItems="baseline",J.lineHeight=P*2.5),this.props.colorMode){case b.Background:case b.BackgroundSolid:J.color=(0,u.mZ)(this.valueColor,this.props.theme.isDark);break}return this.props.textMode===R.None&&(J.fontSize=(0,d.Vr)(f(W),this.maxTextWidth*.8,this.maxTextHeight*.8,P,void 0,E),k=J.fontSize*.8),{containerStyles:J,iconSize:k}}getValueAndTitleContainerStyles(){const W={display:"flex",flexWrap:"wrap"};return this.justifyCenter&&(W.alignItems="center",W.justifyContent="center",W.flexGrow=1,W.gap="0.75ch"),W}getPanelStyles(){const{width:W,height:N,theme:w,colorMode:L,textMode:V}=this.props,K={width:`${W}px`,height:`${N}px`,padding:`${V===R.None?2:this.panelPadding}px`,borderRadius:w.shape.radius.default,position:"relative",display:"flex"},k=w.isDark?1:-.7;switch(L){case b.Background:const j=(0,o.A)(this.valueColor).darken(15*k).spin(8).toRgbString(),H=(0,o.A)(this.valueColor).darken(5*k).spin(-8).toRgbString();K.background=`linear-gradient(120deg, ${j}, ${H})`;break;case b.BackgroundSolid:K.background=(0,o.A)(this.valueColor).toString();break;case b.Value:K.background="transparent";break}return this.justifyCenter&&(K.alignItems="center",K.flexDirection="row"),K}renderChart(){const{sparkline:W,colorMode:N}=this.props;if(!W||W.y?.type!==m.PU.number)return null;let w,L;switch(N){case b.Background:case b.BackgroundSolid:w="rgba(255,255,255,0.4)",L=(0,o.A)(this.valueColor).brighten(40).toRgbString();break;case b.None:case b.Value:default:L=this.valueColor,w=(0,o.A)(this.valueColor).setAlpha(.2).toRgbString();break}const V={custom:{drawStyle:i.GR.Line,lineWidth:1,fillColor:w,lineColor:L}};return n.createElement("div",{style:this.getChartStyles()},n.createElement(p.O,{height:this.chartHeight,width:this.chartWidth,sparkline:W,config:V,theme:this.props.theme}))}getChartStyles(){return{position:"absolute",right:0,bottom:0}}}class h extends g{constructor(W){super(W);const N=this.titleToAlignTo?.length?.3:1;this.valueToAlignTo.length&&(this.valueFontSize=(0,d.Vr)(this.valueToAlignTo,this.maxTextWidth*N,this.maxTextHeight,P,void 0,E)),this.titleToAlignTo?.length&&(this.titleFontSize=(0,d.Vr)(this.titleToAlignTo,this.maxTextWidth*.6,this.maxTextHeight,P,a),this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const W=super.getValueAndTitleContainerStyles();return W.flexDirection="row",W.alignItems="center",W.flexGrow=1,this.justifyCenter||(W.justifyContent="space-between"),W}renderChart(){return null}getPanelStyles(){const W=super.getPanelStyles();return W.alignItems="center",W}}class D extends g{constructor(W){super(W);const{width:N,height:w}=W,L=.5,V=.6,K=1-V,k=.4;this.chartWidth=N,this.chartHeight=w*L,this.titleToAlignTo?.length&&(this.titleFontSize=(0,d.Vr)(this.titleToAlignTo,this.maxTextWidth*V,this.maxTextHeight*k,P,a)),this.valueToAlignTo.length&&(this.valueFontSize=(0,d.Vr)(this.valueToAlignTo,this.maxTextWidth*K,this.maxTextHeight*L,P,void 0,E))}getValueAndTitleContainerStyles(){const W=super.getValueAndTitleContainerStyles();return W.flexDirection="row",W.flexGrow=1,this.justifyCenter||(W.justifyContent="space-between"),W}getPanelStyles(){const W=super.getPanelStyles();return W.flexDirection="row",W.justifyContent="space-between",W}}class v extends g{constructor(W){super(W);const{width:N,height:w}=W,L=.15,V=.25;let K=0;this.chartHeight=w*V,this.chartWidth=N,this.titleToAlignTo?.length&&(this.titleFontSize=(0,d.Vr)(this.titleToAlignTo,this.maxTextWidth,w*L,P,a),K=this.titleFontSize*P),this.valueToAlignTo.length&&(this.valueFontSize=(0,d.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-this.chartHeight-K,P,void 0,E)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize)),this.chartHeight=w-this.titleFontSize*P-this.valueFontSize*P}getValueAndTitleContainerStyles(){const W=super.getValueAndTitleContainerStyles();return W.flexDirection="column",W.justifyContent="center",W}getPanelStyles(){const W=super.getPanelStyles();return W.flexDirection="column",W}}class C extends g{constructor(W){super(W);const{height:N}=W,w=.15;let L=0;this.titleToAlignTo?.length&&(this.titleFontSize=(0,d.Vr)(this.titleToAlignTo,this.maxTextWidth,N*w,P,a),L=this.titleFontSize*P),this.valueToAlignTo.length&&(this.valueFontSize=(0,d.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-L,P,void 0,E)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const W=super.getValueAndTitleContainerStyles();return W.flexDirection="column",W.flexGrow=1,W}renderChart(){return null}getPanelStyles(){const W=super.getPanelStyles();return W.alignItems="center",W}}function T(U){const{width:W,height:N,sparkline:w}=U;return W/N>2.5&&!U.disableWideLayout?N>50&&w&&w.y.values.length>1?new D(U):new h(U):N>100&&w&&w.y.values.length>1?new v(U):new C(U)}function S(U,W){return U===A.Center?!0:(W??"").length===0}function O(U){const{value:W,alignmentFactors:N,count:w}=U;let{textMode:L}=U;const V=N?N.title:W.title,K=(0,l.cN)(N||W);switch(L===R.Auto&&(w??1)===1&&(L=R.Value),L){case R.Name:return{...W,title:void 0,prefix:void 0,suffix:void 0,text:W.title||"",titleToAlignTo:void 0,valueToAlignTo:V??"",tooltip:(0,l.cN)(W)};case R.Value:return{...W,title:void 0,titleToAlignTo:void 0,valueToAlignTo:K,tooltip:W.title};case R.None:return{numeric:W.numeric,color:W.color,title:void 0,text:"",titleToAlignTo:void 0,valueToAlignTo:"1",tooltip:`Name: ${W.title}
Value: ${(0,l.cN)(W)}`};case R.ValueAndName:default:return{...W,titleToAlignTo:V,valueToAlignTo:K}}}function x(U,W,N,w){return W===i.CD.SameAsValue?N.color:U*(W===i.CD.Inverted?-1:1)>0?w.getColorByName("green"):w.getColorByName("red")}var b=(U=>(U.Background="background",U.BackgroundSolid="background_solid",U.None="none",U.Value="value",U))(b||{}),M=(U=>(U.None="none",U.Line="line",U.Area="area",U))(M||{}),A=(U=>(U.Auto="auto",U.Center="center",U))(A||{}),R=(U=>(U.Auto="auto",U.Value="value",U.ValueAndName="value_and_name",U.Name="name",U.None="none",U))(R||{});class B extends n.PureComponent{static{this.defaultProps={justifyMode:"auto"}}render(){const{onClick:W,className:N,hasLinks:w,theme:L}=this.props,V=T(this.props),K=V.getPanelStyles(),k=V.getValueAndTitleContainerStyles(),j=V.getValueStyles(),H=V.getTitleStyles(),J=V.textValues,X=this.props.value.percentChange,se=this.props.percentChangeColorMode,ae=X!=null&&!Number.isNaN(X),ne=w?void 0:J.tooltip;return W?n.createElement("button",{type:"button",className:(0,t.cx)((0,s.my)(L),N),style:K,onClick:W,title:ne},n.createElement("div",{style:k},J.title&&n.createElement("div",{style:H},J.title),n.createElement(r.i,{value:J,style:j})),V.renderChart()):n.createElement("div",{className:N,style:K,title:ne},n.createElement("div",{style:k},J.title&&n.createElement("div",{style:H},J.title),n.createElement(r.i,{value:J,style:j}),ae&&n.createElement(y,{percentChange:X,styles:V.getPercentChangeStyles(X,se,j)})),V.renderChart())}}},54438:(G,I,e)=>{"use strict";e.d(I,{J:()=>l});var t=e(32196),n=e(96540),s=e(23257),r=e.n(s),o=e(40845),m=e(5313);const l=(0,n.forwardRef)(({name:u,value:d,hidden:p,facets:c,onClick:y,className:f,loading:P,searchTerm:a,active:E,style:g,title:h,highlightParts:D,...v},C)=>{const T=(0,o.$j)(),S=i(T),O=a?[a]:[],x=(0,n.useCallback)(M=>{y&&!p&&y(u,d,M)},[y,u,p,d]);let b=d||u;return c&&(b=`${b} (${c})`),n.createElement("button",{key:b,ref:C,onClick:x,style:g,title:h||b,type:"button",role:"option","aria-selected":!!E,className:(0,t.cx)(S.base,E&&S.active,P&&S.loading,p&&S.hidden,f,y&&!p&&S.hover),...v},D!==void 0?n.createElement(m.z,{text:b,highlightClassName:S.matchHighLight,highlightParts:D}):n.createElement(r(),{textToHighlight:b,searchWords:O,autoEscape:!0,highlightClassName:S.matchHighLight}))});l.displayName="Label";const i=u=>({base:(0,t.css)({display:"inline-block",cursor:"pointer",fontSize:u.typography.size.sm,lineHeight:u.typography.bodySmall.lineHeight,backgroundColor:u.colors.background.secondary,color:u.colors.text.primary,whiteSpace:"nowrap",textShadow:"none",padding:u.spacing(.5),borderRadius:u.shape.radius.default,border:"none",marginRight:u.spacing(1),marginBottom:u.spacing(.5)}),loading:(0,t.css)({fontWeight:u.typography.fontWeightMedium,backgroundColor:u.colors.primary.shade,color:u.colors.text.primary,[u.transitions.handleMotion("no-preference","reduce")]:{animation:"pulse 3s ease-out 0s infinite normal forwards"},"@keyframes pulse":{"0%":{color:u.colors.text.primary},"50%":{color:u.colors.text.secondary},"100%":{color:u.colors.text.disabled}}}),active:(0,t.css)({fontWeight:u.typography.fontWeightMedium,backgroundColor:u.colors.primary.main,color:u.colors.primary.contrastText}),matchHighLight:(0,t.css)({background:"inherit",color:u.components.textHighlight.text,backgroundColor:u.components.textHighlight.background}),hidden:(0,t.css)({opacity:.6,cursor:"default",border:"1px solid transparent"}),hover:(0,t.css)({"&:hover":{opacity:.85,cursor:"pointer"}})})},55852:(G,I,e)=>{"use strict";e.d(I,{$n:()=>d,Ez:()=>g,Jt:()=>c,U_:()=>a,hs:()=>y,my:()=>E,z9:()=>p});var t=e(32196),n=e(96540),s=e(40845),r=e(16797),o=e(87266),m=e(14578),l=e(56034);const i=null,u=null,d=n.forwardRef(({variant:h="primary",size:D="md",fill:v="solid",icon:C,fullWidth:T,children:S,className:O,type:x="button",tooltip:b,disabled:M,tooltipPlacement:A,onClick:R,...B},U)=>{const W=(0,s.$j)(),N=y({theme:W,size:D,variant:h,fill:v,fullWidth:T,iconOnly:!S}),w=(0,t.cx)(N.button,{[N.disabled]:M},O),L=!!b,V=n.createElement("button",{className:w,type:x,onClick:M?void 0:R,...B,"aria-disabled":L&&M,disabled:!L&&M,ref:b?void 0:U},n.createElement(c,{icon:C,size:D,className:N.icon}),S&&n.createElement("span",{className:N.content},S));return b?n.createElement(l.m,{ref:U,content:b,placement:A},V):V});d.displayName="Button";const p=n.forwardRef(({variant:h="primary",size:D="md",fill:v="solid",icon:C,fullWidth:T,children:S,className:O,onBlur:x,onFocus:b,disabled:M,tooltip:A,tooltipPlacement:R,...B},U)=>{const W=(0,s.$j)(),N=y({theme:W,fullWidth:T,size:D,variant:h,fill:v,iconOnly:!S}),w=(0,t.cx)(N.button,{[(0,t.css)(N.disabled,{pointerEvents:"none"})]:M},O),L=n.createElement("a",{className:w,...B,tabIndex:M?-1:0,"aria-disabled":M,ref:A?void 0:U},n.createElement(c,{icon:C,size:D,className:N.icon}),S&&n.createElement("span",{className:N.content},S));return A?n.createElement(l.m,{ref:U,content:A,placement:R},L):L});p.displayName="LinkButton";const c=({icon:h,size:D,className:v,iconType:C})=>h?n.isValidElement(h)?n.cloneElement(h,{className:v,size:D}):n.createElement(m.I,{name:h,size:D,className:v,type:C}):null,y=h=>{const{theme:D,variant:v,fill:C="solid",size:T,iconOnly:S,fullWidth:O}=h,{height:x,padding:b,fontSize:M}=(0,o.SM)(T,D),A=a(D,v,C),R=P(D,v,C),B=(0,r.getFocusStyles)(D),U=D.spacing.gridSize*b-1;return{button:(0,t.css)({label:"button",display:"inline-flex",alignItems:"center",fontSize:M,fontWeight:D.typography.fontWeightMedium,fontFamily:D.typography.fontFamily,padding:`0 ${U}px`,height:D.spacing(x),lineHeight:`${D.spacing.gridSize*x-2}px`,verticalAlign:"middle",cursor:"pointer",borderRadius:D.shape.radius.default,"&:focus":B,"&:focus-visible":B,"&:focus:not(:focus-visible)":(0,r.getMouseFocusStyles)(D),...O&&{flexGrow:1,justifyContent:"center"},...A,":disabled":R,"&[disabled]":R}),disabled:(0,t.css)(R,{"&:hover":(0,t.css)(R)}),img:(0,t.css)({width:"16px",height:"16px",margin:D.spacing(0,1,0,.5)}),icon:S?(0,t.css)({marginRight:D.spacing(-b/2),marginLeft:D.spacing(-b/2)}):(0,t.css)({marginRight:D.spacing(b/2)}),content:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap",overflow:"hidden",height:"100%"})}};function f(h,D,v){let C=D.border,T="transparent",S="transparent";return D.name==="secondary"&&(T=D.border,S=h.colors.emphasize(D.border,.25),C=h.colors.border.strong),v==="outline"?{background:"transparent",color:D.text,border:`1px solid ${C}`,transition:h.transitions.create(["background-color","border-color","color"],{duration:h.transitions.duration.short}),"&:hover":{background:D.transparent,borderColor:h.colors.emphasize(C,.25),color:D.text}}:v==="text"?{background:"transparent",color:D.text,border:"1px solid transparent",transition:h.transitions.create(["background-color","color"],{duration:h.transitions.duration.short}),"&:focus":{outline:"none",textDecoration:"none"},"&:hover":{background:D.transparent,textDecoration:"none"}}:{background:D.main,color:D.contrastText,border:`1px solid ${T}`,transition:h.transitions.create(["background-color","box-shadow","border-color","color"],{duration:h.transitions.duration.short}),"&:hover":{background:D.shade,color:D.contrastText,boxShadow:h.shadows.z1,borderColor:S}}}function P(h,D,v){const C={cursor:"not-allowed",boxShadow:"none",color:h.colors.text.disabled,transition:"none"};return v==="text"?{...C,background:"transparent",border:"1px solid transparent"}:v==="outline"?{...C,background:"transparent",border:`1px solid ${h.colors.border.weak}`}:{...C,background:h.colors.action.disabledBackground,border:"1px solid transparent"}}function a(h,D,v){switch(D){case"secondary":return f(h,h.colors.secondary,v);case"destructive":return f(h,h.colors.error,v);case"success":return f(h,h.colors.success,v);case"primary":default:return f(h,h.colors.primary,v)}}const E=h=>(0,t.css)({background:"transparent",color:h.colors.text.primary,border:"none",padding:0}),g=h=>(0,t.css)({background:"transparent",border:"none",padding:0,fontFamily:"inherit",color:"inherit",height:"100%","&:hover":{background:"transparent",color:"inherit"}})},19727:(G,I,e)=>{"use strict";e.d(I,{e:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=(0,n.forwardRef)(({className:m,children:l,...i},u)=>{const d=(0,s.of)(o);return n.createElement("div",{ref:u,className:(0,t.cx)("button-group",d.wrapper,m),...i},l)});r.displayName="ButtonGroup";const o=m=>({wrapper:(0,t.css)({display:"flex","> .button-group:not(:first-child) > button, > button:not(:first-child)":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"> .button-group:not(:last-child) > button, > button:not(:last-child)":{borderTopRightRadius:0,borderBottomRightRadius:0,borderRightWidth:0}})})},61458:(G,I,e)=>{"use strict";e.d(I,{V:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({className:m,children:l})=>{const i=(0,s.of)(o);return n.createElement("div",{className:(0,t.cx)(i,m)},l)},o=()=>(0,t.css)({display:"flex",button:{flexGrow:1,justifyContent:"center"},"> *":{flexGrow:1},label:{flexGrow:1,textAlign:"center"}})},32012:(G,I,e)=>{"use strict";e.d(I,{H:()=>u});var t=e(32196),n=e(48470),s=e(96540),r=e(40845),o=e(55852),m=e(58898),l=e(30958),i=e(14578);const u=p=>{const{onChange:c,className:y,loadData:f,icon:P,buttonProps:a,hideDownIcon:E,variant:g,disabled:h,...D}=p,v=(0,r.of)(d),C=(0,r.of)(l.T);let T=p.children;return E||(T=[p.children,s.createElement(i.I,{key:"down-icon",name:"angle-down",className:v.icons.right})]),s.createElement(n.A,{onChange:(0,m.k)(c),loadData:(0,m.W)(f),dropdownClassName:(0,t.cx)(C.dropdown,v.popup),...D,expandIcon:null},s.createElement(o.$n,{icon:P,disabled:h,variant:g,...a??{}},T))};u.displayName="ButtonCascader";const d=p=>({popup:(0,t.css)({label:"popup",zIndex:p.zIndex.dropdown}),icons:{right:(0,t.css)({margin:"1px 0 0 4px"}),left:(0,t.css)({margin:"-1px 4px 0 0"})}})},76442:(G,I,e)=>{"use strict";e.d(I,{c:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({message:m,callToActionElement:l,footer:i,className:u})=>{const d=(0,s.of)(o);return n.createElement("div",{className:(0,t.cx)([d.wrapper,u])},m&&n.createElement("div",{className:d.message},m),l,i&&n.createElement("div",{className:d.footer},i))},o=m=>({wrapper:(0,t.css)({label:"call-to-action-card",background:m.colors.background.secondary,borderRadius:m.shape.radius.default,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,padding:m.spacing(3),[m.breakpoints.down("sm")]:{padding:m.spacing(3,1)}}),message:(0,t.css)({marginBottom:m.spacing(3),fontStyle:"italic"}),footer:(0,t.css)({marginTop:m.spacing(3)})})},10860:(G,I,e)=>{"use strict";e.d(I,{H:()=>C,Z:()=>l});var t=e(32196),n=e(96540),s=e(40845),r=e(16797),o=e(81507);const m=n.createContext(null),l=({disabled:T,href:S,onClick:O,children:x,isSelected:b,isCompact:M,className:A,...R})=>{const B=(0,n.useMemo)(()=>n.Children.toArray(x).some(w=>n.isValidElement(w)&&w.type===i),[x]),U=T||!O&&!S,W=O&&!T?O:void 0,N=(0,s.of)(o.i,T,U,b,M);return n.createElement(o.Q,{disableEvents:T,disableHover:U,isSelected:b,className:(0,t.cx)(N.container,A),...R},n.createElement(m.Provider,{value:{href:S,onClick:W,disabled:T,isSelected:b}},!B&&n.createElement(i,null),x))},i=({children:T,className:S,"aria-label":O})=>{const x=(0,n.useContext)(m),b=(0,s.of)(u),{href:M,onClick:A,isSelected:R}=x??{href:void 0,onClick:void 0,isSelected:void 0};return n.createElement("h2",{className:(0,t.cx)(b.heading,S)},M?n.createElement("a",{href:M,className:b.linkHack,"aria-label":O,onClick:A},T):A?n.createElement("button",{onClick:A,className:b.linkHack,"aria-label":O,type:"button"},T):n.createElement(n.Fragment,null,T),R!==void 0&&n.createElement("input",{"aria-label":"option",type:"radio",checked:R,readOnly:!0}))};i.displayName="Heading";const u=T=>({heading:(0,t.css)({gridArea:"Heading",justifySelf:"start",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:0,fontSize:T.typography.size.md,letterSpacing:"inherit",lineHeight:T.typography.body.lineHeight,color:T.colors.text.primary,fontWeight:T.typography.fontWeightMedium,"& input[readonly]":{cursor:"inherit"}}),linkHack:(0,t.css)({all:"unset","&::after":{position:"absolute",content:'""',top:0,bottom:0,left:0,right:0,borderRadius:T.shape.radius.default},"&:focus-visible":{outline:"none",outlineOffset:0,boxShadow:"none","&::after":{...(0,r.getFocusStyles)(T),zIndex:1}}})}),d=({children:T,className:S})=>{const O=(0,s.of)(p);return n.createElement("div",{className:(0,t.cx)(O.tagList,S)},T)};d.displayName="Tags";const p=T=>({tagList:(0,t.css)({position:"relative",gridArea:"Tags",alignSelf:"center"})}),c=({children:T,className:S})=>{const O=(0,s.of)(y);return n.createElement("p",{className:(0,t.cx)(O.description,S)},T)};c.displayName="Description";const y=T=>({description:(0,t.css)({width:"100%",gridArea:"Description",margin:T.spacing(1,0,0),color:T.colors.text.secondary,lineHeight:T.typography.body.lineHeight})}),f=({children:T,align:S="start",className:O})=>{const x=(0,s.of)(P);return n.createElement("div",{className:(0,t.cx)(x.media,O,(0,t.css)({alignSelf:S}))},T)};f.displayName="Figure";const P=T=>({media:(0,t.css)({position:"relative",gridArea:"Figure",marginRight:T.spacing(2),width:"40px","> img":{width:"100%"},"&:empty":{display:"none"}})}),a=(0,n.memo)(({children:T,className:S,separator:O="|"})=>{const x=(0,s.of)(E);let b=T;const M=n.Children.toArray(T).filter(Boolean);return M.length?(b=M.map((A,R)=>n.createElement("div",{key:`element_${R}`,className:x.metadataItem},A)),M.length>1&&O&&(b=M.reduce((A,R,B)=>[A,n.createElement("span",{key:`separator_${B}`,className:x.separator},O),R])),n.createElement("div",{className:(0,t.cx)(x.metadata,S)},b)):null});a.displayName="Meta";const E=T=>({metadata:(0,t.css)({gridArea:"Meta",display:"flex",alignItems:"center",width:"100%",fontSize:T.typography.size.sm,color:T.colors.text.secondary,margin:T.spacing(.5,0,0),lineHeight:T.typography.bodySmall.lineHeight,overflowWrap:"anywhere"}),metadataItem:(0,t.css)({zIndex:0}),separator:(0,t.css)({margin:`0 ${T.spacing(1)}`})}),g=({children:T,disabled:S,variant:O,className:x})=>{const b=(0,s.of)(h),A=(0,n.useContext)(m)?.disabled||S,R=O==="primary"?b.actions:b.secondaryActions;return n.createElement("div",{className:(0,t.cx)(R,x)},n.Children.map(T,B=>n.isValidElement(B)?(0,n.cloneElement)(B,{disabled:A,...B.props}):null))},h=T=>({actions:(0,t.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:T.spacing(1),gridArea:"Actions",marginTop:T.spacing(2)}),secondaryActions:(0,t.css)({alignSelf:"center",color:T.colors.text.secondary,display:"flex",flexDirection:"row",flexWrap:"wrap",gap:T.spacing(1),gridArea:"Secondary",marginTop:T.spacing(2)})}),D=({children:T,disabled:S,className:O})=>n.createElement(g,{variant:"primary",disabled:S,className:O},T);D.displayName="Actions";const v=({children:T,disabled:S,className:O})=>n.createElement(g,{variant:"secondary",disabled:S,className:O},T);v.displayName="SecondaryActions";const C=T=>({inner:(0,t.css)({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",flexWrap:"wrap"}),...u(T),...E(T),...y(T),...P(T),...h(T),...p(T)});l.Heading=i,l.Tags=d,l.Figure=f,l.Meta=a,l.Actions=D,l.SecondaryActions=v,l.Description=c},81507:(G,I,e)=>{"use strict";e.d(I,{Q:()=>l,i:()=>i});var t=e(32196),n=e(96540),s=e(40845),r=e(16797);const o=({children:u,href:d})=>{const{inner:p}=(0,s.of)(m);return d?n.createElement("a",{className:p,href:d},u):n.createElement(n.Fragment,null,u)},m=u=>({inner:(0,t.css)({display:"flex",width:"100%",padding:u.spacing(2)})}),l=({children:u,disableEvents:d,disableHover:p,isSelected:c,className:y,href:f,...P})=>{const{oldContainer:a}=(0,s.of)(i,d,p,c);return n.createElement("div",{...P,className:(0,t.cx)(a,y)},n.createElement(o,{href:f},u))},i=(u,d=!1,p=!1,c,y)=>{const f=c!==void 0;return{container:(0,t.css)({display:"grid",position:"relative",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto auto auto",gridAutoColumns:"1fr",gridAutoFlow:"row",gridTemplateAreas:`
        "Figure Heading Tags"
        "Figure Meta Tags"
        "Figure Description Tags"
        "Figure Actions Secondary"`,width:"100%",padding:u.spacing(y?1:2),background:u.colors.background.secondary,borderRadius:u.shape.radius.default,marginBottom:"8px",pointerEvents:d?"none":"auto",[u.transitions.handleMotion("no-preference","reduce")]:{transition:u.transitions.create(["background-color","box-shadow","border-color","color"],{duration:u.transitions.duration.short})},...!p&&{"&:hover":{background:u.colors.emphasize(u.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":r.getFocusStyles(u)},...f&&{cursor:"pointer"},...c&&{outline:`solid 2px ${u.colors.primary.border}`}}),oldContainer:(0,t.css)({display:"flex",width:"100%",background:u.colors.background.secondary,borderRadius:u.shape.radius.default,position:"relative",pointerEvents:d?"none":"auto",marginBottom:u.spacing(1),[u.transitions.handleMotion("no-preference","reduce")]:{transition:u.transitions.create(["background-color","box-shadow","border-color","color"],{duration:u.transitions.duration.short})},...!p&&{"&:hover":{background:u.colors.emphasize(u.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":r.getFocusStyles(u)}})}}},3988:(G,I,e)=>{"use strict";e.d(I,{v:()=>E});var t=e(32196),n=e(47078),s=e.n(n),r=e(48470),o=e(96540),m=e(40845),l=e(14578),i=e(29158),u=e(10354),d=e(67061),p=e(21594),c=e(58898),y=e(30958);const f=(0,t.css)({"&:focus":{outline:"none"}}),P=" / ";class a extends o.PureComponent{constructor(h){super(h),this.flattenOptions=(T,S=[])=>{let O=[];for(const x of T){const b=[...S];b.push(x),!x.items||x.items.length===0?O.push({singleLabel:b[b.length-1].label,label:b.map(M=>M.label).join(this.props.separator||P),value:b.map(M=>M.value)}):O=[...O,...this.flattenOptions(x.items,b)]}return O},this.getSearchableOptions=s()(T=>this.flattenOptions(T)),this.onChange=(T,S)=>{const O=this.props.hideActiveLevelLabel?"":this.props.displayAllSelectedLevels?S.map(b=>b.label).join(this.props.separator||P):S[S.length-1].label,x={rcValue:{value:T,label:O},focusCascade:!0,activeLabel:O,isSearching:!1,inputValue:O};this.setState(x),this.props.onSelect(S[S.length-1].value)},this.onSelect=T=>{const S=T.value||[],O=this.props.displayAllSelectedLevels?T.label:T.singleLabel||"",x={activeLabel:O,inputValue:O,rcValue:{value:S,label:O},isSearching:!1,focusCascade:!1};this.setState(x),this.props.onSelect(S[S.length-1])},this.onCreateOption=T=>{this.setState({activeLabel:T,inputValue:T,rcValue:[],isSearching:!1}),this.props.onSelect(T)},this.onBlur=()=>{this.setState({isSearching:!1,focusCascade:!1}),this.state.activeLabel===""&&this.setState({rcValue:[]}),this.props.onBlur?.()},this.onBlurCascade=()=>{this.setState({focusCascade:!1}),this.props.onBlur?.()},this.onInputKeyDown=T=>{if(["ArrowDown","ArrowUp","Enter","ArrowLeft","ArrowRight"].includes(T.key))return;const{activeLabel:S}=this.state;this.setState({focusCascade:!1,isSearching:!0,inputValue:S})},this.onSelectInputChange=T=>{this.setState({inputValue:T})};const D=this.getSearchableOptions(h.options),{rcValue:v,activeLabel:C}=this.setInitialValue(D,h.initialValue);this.state={isSearching:!1,focusCascade:!1,rcValue:v,activeLabel:C,inputValue:""}}static{this.defaultProps={changeOnSelect:!0}}setInitialValue(h,D){if(!D)return{rcValue:[],activeLabel:""};for(const v of h){const C=v.value||[];if(C[C.length-1]===D)return{rcValue:C,activeLabel:this.props.displayAllSelectedLevels?v.label:v.singleLabel||""}}return this.props.allowCustomValue?{rcValue:[],activeLabel:D}:{rcValue:[],activeLabel:""}}render(){const{allowCustomValue:h,formatCreateLabel:D,placeholder:v,width:C,changeOnSelect:T,options:S,disabled:O,id:x,isClearable:b,theme:M}=this.props,{focusCascade:A,isSearching:R,rcValue:B,activeLabel:U,inputValue:W}=this.state,N=this.getSearchableOptions(S),w=(0,y.T)(M);return o.createElement("div",null,R?o.createElement(p.l6,{allowCustomValue:h,placeholder:v,autoFocus:!A,onChange:this.onSelect,onBlur:this.onBlur,options:N,onCreateOption:this.onCreateOption,formatCreateLabel:D,width:C,onInputChange:this.onSelectInputChange,disabled:O,inputValue:W,inputId:x}):o.createElement(r.A,{onChange:(0,c.k)(this.onChange),options:S,changeOnSelect:T,value:B.value,fieldNames:{label:"label",value:"value",children:"items"},expandIcon:null,open:this.props.alwaysOpen,disabled:O,dropdownClassName:w.dropdown},o.createElement("div",{className:f},o.createElement(u.p,{autoFocus:this.props.autoFocus,width:C,placeholder:v,onBlur:this.onBlurCascade,value:U,onKeyDown:this.onInputKeyDown,onChange:()=>{},suffix:o.createElement(d.B,{gap:.5},b&&U!==""&&o.createElement(i.K,{name:"times","aria-label":"Clear selection",onClick:L=>{L.preventDefault(),L.stopPropagation(),this.setState({rcValue:[],activeLabel:"",inputValue:""}),this.props.onSelect("")}}),o.createElement(l.I,{name:A?"angle-up":"angle-down"})),disabled:O,id:x}))))}}const E=(0,m.cV)(a)},58898:(G,I,e)=>{"use strict";e.d(I,{W:()=>n,k:()=>t});const t=o=>(m,l)=>{o&&o(m.map(i=>String(i)),s(l))},n=o=>m=>{o&&o(s(m))},s=o=>o.map(r),r=o=>{const m=o.value?String(o.value):"";return{value:m,label:typeof o.label=="string"?o.label:m}}},30958:(G,I,e)=>{"use strict";e.d(I,{T:()=>m});var t=e(32196);const n=(0,t.keyframes)({"0%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"}}),s=(0,t.keyframes)({"0%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"}}),r=(0,t.keyframes)({"0%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"}}),o=(0,t.keyframes)({"0%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"}}),m=l=>({dropdown:(0,t.css)({"&.rc-cascader-dropdown":{position:"absolute",zIndex:9999,"&-hidden":{display:"none"}},".rc-cascader":{"&-menus":{overflow:"hidden",background:l.colors.background.canvas,border:`1px solid ${l.colors.border.weak}`,borderRadius:l.shape.radius.default,boxShadow:l.shadows.z3,whiteSpace:"nowrap","&.slide-up-enter, &.slide-up-appear":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:0,animationTimingFunction:"cubic-bezier(0.08, 0.82, 0.17, 1)",animationPlayState:"paused"},"&.slide-up-enter.slide-up-enter-active.rc-cascader-menus-placement, &.slide-up-appear.slide-up-appear-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:n,animationPlayState:"running"},"&-topLeft":{animationName:r,animationPlayState:"running"}},"&.slide-up-leave":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:1,animationTimingFunction:"cubic-bezier(0.6, 0.04, 0.98, 0.34)",animationPlayState:"paused","&.slide-up-leave-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:s,animationPlayState:"running"},"&-topLeft":{animationName:o,animationPlayState:"running"}}}},"&-menu":{display:"inline-block",maxWidth:"50vw",height:"192px",listStyle:"none",margin:0,padding:0,borderRight:`1px solid ${l.colors.border.weak}`,overflow:"auto","&:last-child":{borderRight:0},"&-item":{height:l.spacing(4),lineHeight:l.spacing(4),padding:l.spacing(0,4,0,2),cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",transition:"all 0.3s ease",position:"relative","&:hover":{background:l.colors.action.hover},"&-disabled":{cursor:"not-allowed",color:l.colors.text.disabled,"&:hover":{background:"transparent"},"&:after":{position:"absolute",right:"12px",content:"'loading'",color:l.colors.text.disabled,fontStyle:"italic"}},"&-active":{color:l.colors.text.maxContrast,background:l.colors.background.secondary,"&:hover":{background:l.colors.action.hover}},"&-expand":{position:"relative","&:after":{background:l.colors.background.secondary,content:"''",height:l.spacing(3),mask:"url(../img/icons/unicons/angle-right.svg)",maskType:"luminance",position:"absolute",right:0,top:l.spacing(.5),width:l.spacing(3)}}}}}})})},8866:(G,I,e)=>{"use strict";e.d(I,{N:()=>n});var t=e(96540);class n extends t.PureComponent{constructor(){super(...arguments),this.myRef=(0,t.createRef)(),this.state={hasEventListener:!1},this.onOutsideClick=r=>{const o=this.myRef.current;(!o||r.target instanceof Node&&!o.contains(r.target))&&this.props.onClick()}}static{this.defaultProps={includeButtonPress:!0,parent:typeof window<"u"?window:void 0,useCapture:!1}}componentDidMount(){this.props.parent.addEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.addEventListener("keyup",this.onOutsideClick,this.props.useCapture)}componentWillUnmount(){this.props.parent.removeEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.removeEventListener("keyup",this.onOutsideClick,this.props.useCapture)}render(){return t.createElement("div",{ref:this.myRef},this.props.children)}}},10534:(G,I,e)=>{"use strict";e.d(I,{b:()=>u});var t=e(32196),n=e(96540),s=e(76412),r=e(40845),o=e(55852),m=e(14578),l=e(32982);const i=2*1e3;function u({onClipboardCopy:c,onClipboardError:y,children:f,getText:P,icon:a,variant:E,...g}){const h=(0,r.of)(p),[D,v]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let S;return D&&(S=setTimeout(()=>{v(!1)},i)),()=>{window.clearTimeout(S)}},[D]);const C=(0,n.useRef)(null),T=(0,n.useCallback)(async()=>{const S=P();try{await d(S,C),v(!0),c?.(S)}catch(O){y?.(S,O)}},[P,c,y]);return n.createElement(n.Fragment,null,D&&n.createElement(l.r,{placement:"top",referenceElement:C.current},n.createElement(s.x,{i18nKey:"clipboard-button.inline-toast.success"},"Copied")),n.createElement(o.$n,{onClick:T,icon:a,variant:D?"success":E,"aria-label":D?"Copied":void 0,...g,className:(0,t.cx)(h.button,D&&h.successButton,g.className),ref:C},f,D&&n.createElement("div",{className:h.successOverlay},n.createElement(m.I,{name:"check"}))))}const d=async(c,y)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(c);{const f=document.createElement("textarea");y.current?.appendChild(f),f.value=c,f.focus(),f.select(),document.execCommand("copy"),f.remove()}},p=c=>({button:(0,t.css)({position:"relative"}),successButton:(0,t.css)({"> *":(0,t.css)({visibility:"hidden"})}),successOverlay:(0,t.css)({position:"absolute",top:0,bottom:0,right:0,left:0,visibility:"visible"})})},57418:(G,I,e)=>{"use strict";e.d(I,{M:()=>u});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(40845),m=e(16797),l=e(14578),i=e(62930);const u=({label:p,isOpen:c,onToggle:y,className:f,contentClassName:P,children:a,labelId:E,loading:g=!1,headerDataTestId:h,contentDataTestId:D})=>{const[v,C]=(0,r.useState)(c),T=(0,o.of)(d),S=b=>{b.target instanceof HTMLElement&&b.target.tagName==="A"||(b.preventDefault(),b.stopPropagation(),y?.(!v),C(!v))},{current:O}=(0,r.useRef)((0,n.uniqueId)()),x=E??`collapse-label-${O}`;return r.createElement(r.Fragment,null,r.createElement("div",{onClick:S,className:(0,t.cx)(T.header,f)},r.createElement("button",{type:"button",id:`collapse-button-${O}`,className:T.button,onClick:S,"aria-expanded":v&&!g,"aria-controls":`collapse-content-${O}`,"aria-labelledby":x},g?r.createElement(i.y,{className:T.spinner}):r.createElement(l.I,{name:v?"angle-up":"angle-down",className:T.icon})),r.createElement("div",{className:T.label,id:`collapse-label-${O}`,"data-testid":h},p)),v&&r.createElement("div",{id:`collapse-content-${O}`,className:(0,t.cx)(T.content,P),"data-testid":D},a))},d=p=>({header:(0,t.css)({display:"flex",cursor:"pointer",boxSizing:"border-box",flexDirection:"row-reverse",position:"relative",justifyContent:"space-between",fontSize:p.typography.size.lg,padding:`${p.spacing(.5)} 0`,"&:focus-within":(0,m.getFocusStyles)(p)}),button:(0,t.css)({all:"unset","&:focus-visible":{outline:"none",outlineOffset:"unset",transition:"none",boxShadow:"none"}}),icon:(0,t.css)({color:p.colors.text.secondary}),content:(0,t.css)({padding:`${p.spacing(2)} 0`}),spinner:(0,t.css)({display:"flex",alignItems:"center",width:p.spacing(2)}),label:(0,t.css)({display:"flex"})})},82762:(G,I,e)=>{"use strict";e.d(I,{S:()=>i,a:()=>l});var t=e(32196),n=e(96540),s=e(40845),r=e(55852),o=e(14578);const m=u=>({collapse:(0,t.css)({label:"collapse",marginBottom:u.spacing(1),backgroundColor:u.colors.background.primary,border:`1px solid ${u.colors.border.weak}`,position:"relative",borderRadius:u.shape.radius.default,width:"100%",display:"flex",flexDirection:"column",flex:"1 1 0"}),collapseBody:(0,t.css)({label:"collapse__body",padding:u.spacing(u.components.panel.padding),paddingTop:0,flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}),bodyContentWrapper:(0,t.css)({label:"bodyContentWrapper",flex:1,overflow:"hidden"}),loader:(0,t.css)({label:"collapse__loader",height:"2px",position:"relative",overflow:"hidden",background:"none",margin:u.spacing(.5)}),loaderActive:(0,t.css)({label:"collapse__loader_active","&:after":{content:"' '",display:"block",width:"25%",top:0,height:"250%",position:"absolute",animation:"loader 2s cubic-bezier(0.17, 0.67, 0.83, 0.67) 500ms",animationIterationCount:100,left:"-25%",background:u.colors.primary.main},"@keyframes loader":{from:{left:"-25%",opacity:.1},to:{left:"100%",opacity:1}}}),header:(0,t.css)({label:"collapse__header",padding:u.spacing(1,2,1,2),display:"flex"}),headerCollapsed:(0,t.css)({label:"collapse__header--collapsed",padding:u.spacing(1,2,1,2)}),headerLabel:(0,t.css)({label:"collapse__header-label",fontWeight:u.typography.fontWeightMedium,marginRight:u.spacing(1),fontSize:u.typography.size.md,display:"flex",flex:"0 0 100%"}),icon:(0,t.css)({label:"collapse__icon",margin:u.spacing(.25,1,0,-1)})}),l=({isOpen:u,onToggle:d,...p})=>{const[c,y]=(0,n.useState)(u);return n.createElement(i,{isOpen:c,collapsible:!0,...p,onToggle:()=>{y(!c),d&&d(!c)}})},i=({isOpen:u,label:d,loading:p,collapsible:c,onToggle:y,className:f,children:P})=>{const a=(0,s.of)(r.my),E=(0,s.of)(m),g=()=>{y&&y(!u)},h=(0,t.cx)([E.collapse,f]),D=p?(0,t.cx)([E.loader,E.loaderActive]):(0,t.cx)([E.loader]),v=c?(0,t.cx)([E.header]):(0,t.cx)([E.headerCollapsed]);return n.createElement("div",{className:h},n.createElement("button",{type:"button",className:(0,t.cx)(a,v),onClick:g},c&&n.createElement(o.I,{className:E.icon,name:u?"angle-down":"angle-right"}),n.createElement("div",{className:(0,t.cx)([E.headerLabel])},d)),u&&n.createElement("div",{className:(0,t.cx)([E.collapseBody])},n.createElement("div",{className:D}),n.createElement("div",{className:E.bodyContentWrapper},P)))};i.displayName="Collapse"},36314:(G,I,e)=>{"use strict";e.d(I,{A:()=>u});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(84140),m=e(40845),l=e(10354);const i=(0,r.forwardRef)(({color:c,onChange:y,isClearable:f=!1,onClick:P,onBlur:a,disabled:E,buttonAriaLabel:g,...h},D)=>{const[v,C]=(0,r.useState)(c),[T,S]=(0,r.useState)(c),O=(0,r.useMemo)(()=>(0,n.debounce)(y,100),[]);(0,r.useEffect)(()=>{const M=(0,o.A)(c);M.isValid()&&c!==T&&(C(M.toString()),S(c))},[c,T]);const x=M=>{const{value:A}=M.currentTarget;if(C(A),A===""&&f){O(A);return}const R=(0,o.A)(A);R.isValid()&&O(R.toString())},b=M=>{(0,o.A)(v).isValid()||C(c),a?.(M)};return r.createElement(l.p,{...h,value:v,onChange:x,disabled:E,onClick:P,onBlur:b,addonBefore:r.createElement(d,{onClick:P,ariaLabel:g,disabled:E,color:c}),ref:D})});i.displayName="ColorInput";const u=i,d=({color:c,onClick:y,disabled:f,ariaLabel:P})=>{const a=(0,m.of)(p);return r.createElement("button",{type:"button",onClick:y,"aria-label":P,disabled:f||!y,className:(0,t.cx)(a,(0,t.css)({backgroundColor:c}))})},p=c=>(0,t.css)({height:"100%",width:`${c.spacing.gridSize*4}px`,borderRadius:`${c.shape.radius.default} 0 0 ${c.shape.radius.default}`,border:`1px solid ${c.colors.border.medium}`})},83598:(G,I,e)=>{"use strict";e.d(I,{Dp:()=>y,sk:()=>c});var t=e(32196),n=e(96540),s=e(40845),r=e(3911),o=e(40321),m=e(13840),l=e(95868),i=e(70045),u=e(83876),d=e(70104);const p=(P,a="ColorPicker")=>class extends n.Component{constructor(){super(...arguments),this.pickerTriggerRef=(0,n.createRef)()}static{this.displayName=a}render(){const{theme:g,children:h,onChange:D,color:v}=this.props,C=f(g),T=n.createElement(P,{...this.props,children:null,onChange:D});return n.createElement(l.I,{content:T,hideAfter:300},(S,O,x)=>n.createElement(n.Fragment,null,this.pickerTriggerRef.current&&n.createElement(m.A,{...x,referenceElement:this.pickerTriggerRef.current,wrapperClassName:C.colorPicker,onMouseLeave:O,onMouseEnter:S,onKeyDown:b=>(0,o.Q)(b,O)}),h?h({ref:this.pickerTriggerRef,showColorPicker:S,hideColorPicker:O}):n.createElement(u.q,{ref:this.pickerTriggerRef,onClick:S,onMouseLeave:O,color:g.visualization.getColorByName(v||"#000000"),"aria-label":v})))}},c=(0,s.cV)(p(i.$,"ColorPicker")),y=(0,s.cV)(p(d.o,"SeriesColorPicker")),f=(0,r.N)(P=>({colorPicker:(0,t.css)({position:"absolute",zIndex:P.zIndex.tooltip,color:P.colors.text.primary,maxWidth:"400px",fontSize:P.typography.size.sm})}))},99128:(G,I,e)=>{"use strict";e.d(I,{i:()=>d});var t=e(32196),n=e(96540),s=e(7612),r=e(65229),o=e(23596),m=e(40845),l=e(8866),i=e(36314),u=e(95151);const d=(0,n.forwardRef)(({value:c="",onChange:y,returnColorAs:f="rgb",...P},a)=>{const[E,g]=(0,n.useState)(c),[h,D]=(0,n.useState)(!1),v=(0,m.$j)(),C=(0,m.of)(p),T=(0,m.of)(u.$);return(0,r.A)(S=>{if(S===c)return;if(!S){y("");return}const O=v.visualization.getColorByName(S);y(f==="rgb"?o.asRgbString(O):o.asHexString(O))},500,[E]),n.createElement(l.N,{onClick:()=>D(!1)},n.createElement("div",{className:C.wrapper},h&&!P.disabled&&n.createElement(s.p9,{"data-testid":"color-popover",color:E,onChange:g,className:(0,t.cx)(T.root,C.picker)}),n.createElement(i.A,{...P,theme:v,color:E,onChange:g,buttonAriaLabel:"Open color picker",onClick:()=>D(!0),onBlur:()=>D(!1),ref:a,isClearable:!0})))});d.displayName="ColorPickerInput";const p=c=>({wrapper:(0,t.css)({position:"relative"}),picker:(0,t.css)({"&.react-colorful":{position:"absolute",width:"100%",zIndex:11,bottom:"36px"}}),inner:(0,t.css)({position:"absolute"})})},70045:(G,I,e)=>{"use strict";e.d(I,{$:()=>E});var t=e(32196),n=e(85690),s=e(96540),r=e(23596),o=e(40845),m=e(3911),l=e(83876),i=e(2543);function u(h,D){const v=new Array(h.length);for(let C=0;C<h.length;C++){const T=h.length-1-C;v[C]=D(h[T],T,h)}return v}const p=({hue:h,selectedColor:D,onColorSelect:v,...C})=>{const T=(0,i.upperFirst)(h.name),S=(0,o.of)(c);return s.createElement("div",{className:S.colorRow},s.createElement("div",{className:S.colorLabel},T),s.createElement("div",{...C,className:S.swatchRow},u(h.shades,O=>s.createElement(l.q,{key:O.name,"aria-label":O.name,variant:O.primary?l.h.Large:l.h.Small,isSelected:O.name===D,color:O.color,onClick:()=>v(O.name)}))))},c=h=>({colorRow:(0,t.css)({display:"grid",gridTemplateColumns:"25% 1fr",gridColumnGap:h.spacing(2),padding:h.spacing(.5,0),"&:hover":{background:h.colors.background.secondary}}),colorLabel:(0,t.css)({paddingLeft:h.spacing(2),display:"flex",alignItems:"center"}),swatchRow:(0,t.css)({display:"flex",gap:h.spacing(1),alignItems:"center",justifyContent:"space-around",flexDirection:"row"})}),y=({color:h,onChange:D})=>{const v=(0,o.$j)(),C=(0,o.of)(f),T=[];for(const S of v.visualization.hues)T.push(s.createElement(p,{key:S.name,selectedColor:h,hue:S,onColorSelect:D}));return s.createElement(s.Fragment,null,s.createElement("div",{className:C.swatches},T),s.createElement("div",{className:C.extraColors},s.createElement(l.q,{isSelected:h==="transparent",color:"rgba(0,0,0,0)",label:"Transparent",onClick:()=>D("transparent")}),s.createElement(l.q,{isSelected:h==="text",color:v.colors.text.primary,label:"Text color",onClick:()=>D("text")})))},f=h=>({container:(0,t.css)({display:"flex",flexDirection:"column"}),extraColors:(0,t.css)({display:"flex",alignItems:"center",justifyContent:"space-around",gap:h.spacing(1),padding:h.spacing(1,0)}),swatches:(0,t.css)({display:"grid",flexGrow:1})});var P=e(95151);class a extends s.Component{constructor(D){super(D),this.getTabClassName=v=>{const{activePicker:C}=this.state;return`ColorPickerPopover__tab ${C===v&&"ColorPickerPopover__tab--active"}`},this.handleChange=v=>{const{onChange:C,enableNamedColors:T,theme:S}=this.props;if(T)return C(v);C(r.asHexString(S.visualization.getColorByName(v)))},this.onTabChange=v=>()=>this.setState({activePicker:v}),this.renderPicker=()=>{const{activePicker:v}=this.state,{color:C}=this.props;switch(v){case"spectrum":return s.createElement(P.A,{color:C,onChange:this.handleChange});case"palette":return s.createElement(y,{color:C,onChange:this.handleChange});default:return this.renderCustomPicker(v)}},this.renderCustomPicker=v=>{const{customPickers:C,color:T,theme:S}=this.props;return C?s.createElement(C[v].tabComponent,{color:T,theme:S,onChange:this.handleChange}):null},this.renderCustomPickerTabs=()=>{const{customPickers:v}=this.props;return v?s.createElement(s.Fragment,null,Object.keys(v).map(C=>s.createElement("button",{className:this.getTabClassName(C),onClick:this.onTabChange(C),key:C,type:"button"},v[C].name))):null},this.state={activePicker:"palette"}}render(){const{theme:D}=this.props,v=g(D);return s.createElement(n.n1,{contain:!0,restoreFocus:!0,autoFocus:!0},s.createElement("div",{tabIndex:-1,className:v.colorPickerPopover},s.createElement("div",{className:v.colorPickerPopoverTabs},s.createElement("button",{className:this.getTabClassName("palette"),onClick:this.onTabChange("palette"),type:"button"},"Colors"),s.createElement("button",{className:this.getTabClassName("spectrum"),onClick:this.onTabChange("spectrum"),type:"button"},"Custom"),this.renderCustomPickerTabs()),s.createElement("div",{className:v.colorPickerPopoverContent},this.renderPicker())))}}const E=(0,o.cV)(a);E.displayName="ColorPickerPopover";const g=(0,m.N)(h=>({colorPickerPopover:(0,t.css)({borderRadius:h.shape.radius.default,boxShadow:h.shadows.z3,background:h.colors.background.primary,border:`1px solid ${h.colors.border.weak}`,".ColorPickerPopover__tab":{width:"50%",textAlign:"center",padding:h.spacing(1,0),background:h.colors.background.secondary,color:h.colors.text.secondary,fontSize:h.typography.bodySmall.fontSize,cursor:"pointer",border:"none","&:focus:not(:focus-visible)":{outline:"none",boxShadow:"none"},":focus-visible":{position:"relative"}},".ColorPickerPopover__tab--active":{color:h.colors.text.primary,fontWeight:h.typography.fontWeightMedium,background:h.colors.background.primary}}),colorPickerPopoverContent:(0,t.css)({width:"246px",fontSize:h.typography.bodySmall.fontSize,minHeight:"184px",padding:h.spacing(1),display:"flex",flexDirection:"column"}),colorPickerPopoverTabs:(0,t.css)({display:"flex",width:"100%",borderRadius:`${h.shape.radius.default} ${h.shape.radius.default} 0 0`})}))},83876:(G,I,e)=>{"use strict";e.d(I,{h:()=>l,q:()=>i});var t=e(32196),n=e(95382),s=e(96540),r=e(84140),o=e(13544),m=e(40845),l=(d=>(d.Small="small",d.Large="large",d))(l||{});const i=s.forwardRef(({color:d,label:p,variant:c="small",isSelected:y,"aria-label":f,...P},a)=>{const E=(0,m.$j)(),{isFocusVisible:g,focusProps:h}=(0,n.o)(),D=u(E,c,d,g,y),v=!!p,C=f||p;return s.createElement("div",{ref:a,className:D.wrapper,"data-testid":o.Tp.components.ColorSwatch.name,...P},v&&s.createElement("span",{className:D.label},p),s.createElement("button",{className:D.swatch,...h,"aria-label":C?`${C} color`:"Pick a color",type:"button"}))}),u=(d,p,c,y,f)=>{const P=(0,r.A)(c),E=p==="small"?"16px":"32px";let g="none";return P.getAlpha()<.1&&(g=`2px solid ${d.colors.border.medium}`),{wrapper:(0,t.css)({display:"flex",alignItems:"center",cursor:"pointer"}),label:(0,t.css)({marginRight:d.spacing(1)}),swatch:(0,t.css)({width:E,height:E,background:`${c}`,border:g,borderRadius:d.shape.radius.circle,outlineOffset:"1px",outline:y?`2px solid  ${d.colors.primary.main}`:"none",boxShadow:f?`inset 0 0 0 2px ${c}, inset 0 0 0 4px ${d.colors.getContrastText(c)}`:"none",[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["transform"],{duration:d.transitions.duration.short})},"&:hover":{transform:"scale(1.1)"},"@media (forced-colors: active)":{forcedColorAdjust:"none"}})}};i.displayName="ColorSwatch"},70104:(G,I,e)=>{"use strict";e.d(I,{o:()=>m,t:()=>l});var t=e(96540),n=e(40845),s=e(14186),r=e(15292),o=e(70045);const m=i=>{const{yaxis:u,onToggleAxis:d,color:p,...c}=i,y=d?{yaxis:{name:"Y-Axis",tabComponent(){return t.createElement(s.I,{labelWidth:20,label:"Use right y-axis"},t.createElement(r.K,{value:u===2,label:"Use right y-axis",onChange:d}))}}}:void 0;return t.createElement(o.$,{...c,color:p||"#000000",customPickers:y})},l=(0,n.cV)(m)},95151:(G,I,e)=>{"use strict";e.d(I,{$:()=>d,A:()=>p});var t=e(32196),n=e(96540),s=e(7612),r=e(65229),o=e(84140),m=e(23596),l=e(40845),i=e(36314);const u=({color:c,onChange:y})=>{const[f,P]=(0,n.useState)(c);(0,r.A)(h=>{y(m.asHexString(a.visualization.getColorByName(h)))},500,[f]);const a=(0,l.$j)(),E=(0,l.of)(d),g=(0,n.useMemo)(()=>f.startsWith("rgba")?f:(0,o.A)(a.visualization.getColorByName(c)).toRgbString(),[f,a,c]);return n.createElement("div",{className:E.wrapper},n.createElement(s.p9,{className:E.root,color:g,onChange:P}),n.createElement(i.A,{theme:a,color:g,onChange:P,className:E.colorInput}))},d=c=>({wrapper:(0,t.css)({flexGrow:1}),root:(0,t.css)({"&.react-colorful":{width:"auto"},".react-colorful":{"&__saturation":{borderRadius:`${c.shape.radius.default} ${c.shape.radius.default} 0 0`},"&__alpha":{borderRadius:`0 0 ${c.shape.radius.default} ${c.shape.radius.default}`},"&__alpha, &__hue":{height:c.spacing(2),position:"relative"},"&__pointer":{height:c.spacing(2),width:c.spacing(2)}}}),colorInput:(0,t.css)({marginTop:c.spacing(2)})}),p=u},82702:(G,I,e)=>{"use strict";e.d(I,{Z:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(55852);const o=({children:l,className:i,closeOnConfirm:u,confirmText:d="Save",confirmVariant:p="primary",disabled:c=!1,onCancel:y,onClick:f,onConfirm:P,size:a="md"})=>{const E=(0,n.useRef)(null),g=(0,n.useRef)(null),[h,D]=(0,n.useState)(!1),[v,C]=(0,n.useState)(!1),T=(0,s.of)(m);(0,n.useEffect)(()=>{h?(g.current?.focus(),C(!0)):v&&(E.current?.focus(),C(!1))},[v,h]);const S=R=>{R&&R.preventDefault(),D(!0),f?.()},O=R=>{R&&R.preventDefault(),D(!1),E.current?.focus(),y?.()},x=R=>{R&&R.preventDefault(),P?.(),u&&D(!1)},b=(0,t.cx)(i,T.mainButton,{[T.mainButtonHide]:h}),M=(0,t.cx)(T.confirmButton,{[T.confirmButtonHide]:!h}),A=(0,t.cx)(T.confirmButtonContainer,{[T.confirmButtonContainerHide]:!h});return n.createElement("div",{className:T.container},n.createElement("span",{className:b},typeof l=="string"?n.createElement(r.$n,{disabled:c,size:a,fill:"text",onClick:S,ref:E},l):n.cloneElement(l,{disabled:c,onClick:S,ref:E})),n.createElement("div",{className:A},n.createElement("span",{className:M},n.createElement(r.$n,{size:a,variant:p,onClick:x,ref:g},d),n.createElement(r.$n,{size:a,fill:"text",onClick:O},"Cancel"))))};o.displayName="ConfirmButton";const m=l=>({container:(0,t.css)({alignItems:"center",display:"flex",justifyContent:"flex-end",position:"relative"}),mainButton:(0,t.css)({opacity:1,[l.transitions.handleMotion("no-preference")]:{transition:l.transitions.create(["opacity"],{duration:l.transitions.duration.shortest,easing:l.transitions.easing.easeOut})},zIndex:2}),mainButtonHide:(0,t.css)({opacity:0,[l.transitions.handleMotion("no-preference")]:{transition:l.transitions.create(["opacity","visibility"],{duration:l.transitions.duration.shortest,easing:l.transitions.easing.easeIn})},visibility:"hidden",zIndex:0}),confirmButtonContainer:(0,t.css)({overflow:"visible",position:"absolute",pointerEvents:"all",right:0}),confirmButtonContainerHide:(0,t.css)({overflow:"hidden",pointerEvents:"none"}),confirmButton:(0,t.css)({alignItems:"flex-start",background:l.colors.background.primary,display:"flex",opacity:1,transform:"translateX(0)",[l.transitions.handleMotion("no-preference")]:{transition:l.transitions.create(["opacity","transform"],{duration:l.transitions.duration.shortest,easing:l.transitions.easing.easeOut})},zIndex:1}),confirmButtonHide:(0,t.css)({opacity:0,transform:"translateX(100%)",[l.transitions.handleMotion("no-preference")]:{transition:l.transitions.create(["opacity","transform","visibility"],{duration:l.transitions.duration.shortest,easing:l.transitions.easing.easeIn})},visibility:"hidden"})})},91605:(G,I,e)=>{"use strict";e.d(I,{e:()=>r});var t=e(96540),n=e(55852),s=e(82702);const r=({size:o,disabled:m,onConfirm:l,"aria-label":i,closeOnConfirm:u})=>t.createElement(s.Z,{confirmText:"Delete",confirmVariant:"destructive",size:o||"md",disabled:m,onConfirm:l,closeOnConfirm:u},t.createElement(n.$n,{"aria-label":i,variant:"destructive",icon:"times",size:o||"sm"}))},96374:(G,I,e)=>{"use strict";e.d(I,{u:()=>p});var t=e(32196),n=e(96540),s=e(49785),r=e(13544),o=e(40845),m=e(55852),l=e(10354),i=e(90613),u=e(67061),d=e(37390);const p=({isOpen:y,title:f,body:P,description:a,confirmText:E,confirmVariant:g="destructive",confirmationText:h,dismissText:D="Cancel",dismissVariant:v="secondary",alternativeText:C,modalClass:T,icon:S="exclamation-triangle",onConfirm:O,onDismiss:x,onAlternative:b,confirmButtonVariant:M="destructive"})=>{const[A,R]=(0,n.useState)(!!h),B=(0,o.of)(c),U=(0,n.useRef)(null),W=L=>{R(h?.toLowerCase().localeCompare(L.currentTarget.value.toLowerCase())!==0)};(0,n.useEffect)(()=>{y&&U.current?.focus()},[y]),(0,n.useEffect)(()=>{y&&R(!!h)},[y,h]);const N=async()=>{R(!0);try{await O()}finally{R(!1)}},{handleSubmit:w}=(0,s.mN)();return n.createElement(d.a,{className:(0,t.cx)(B.modal,T),title:f,icon:S,isOpen:y,onDismiss:x},n.createElement("form",{onSubmit:w(N)},n.createElement("div",{className:B.modalText},P,a?n.createElement("div",{className:B.modalDescription},a):null,h?n.createElement("div",{className:B.modalConfirmationInput},n.createElement(u.B,{alignItems:"flex-start"},n.createElement(i.a,null,n.createElement(l.p,{placeholder:`Type "${h}" to confirm`,onChange:W})))):null),n.createElement(d.a.ButtonRow,null,n.createElement(m.$n,{variant:v,onClick:x,fill:"outline"},D),n.createElement(m.$n,{type:"submit",variant:M,disabled:A,ref:U,"data-testid":r.Tp.pages.ConfirmModal.delete},E),b?n.createElement(m.$n,{variant:"primary",onClick:b},C):null)))},c=y=>({modal:(0,t.css)({width:"500px"}),modalText:(0,t.css)({fontSize:y.typography.h5.fontSize,color:y.colors.text.primary}),modalDescription:(0,t.css)({fontSize:y.typography.body.fontSize}),modalConfirmationInput:(0,t.css)({paddingTop:y.spacing(1)})})},28122:(G,I,e)=>{"use strict";e.d(I,{t:()=>m});var t=e(96540),n=e(29647),s=e(13544),r=e(38138),o=e(17464);const m=t.memo(({x:l,y:i,onClose:u,focusOnOpen:d=!0,renderMenuItems:p,renderHeader:c})=>{const y=(0,t.useRef)(null),[f,P]=(0,t.useState)({});(0,t.useLayoutEffect)(()=>{const D=y.current;if(D){const v=D.getBoundingClientRect(),C=5,T={right:window.innerWidth<l+v.width,bottom:window.innerHeight<i+v.height+C};P({position:"fixed",left:T.right?l-v.width-C:l-C,top:Math.max(0,T.bottom?i-v.height-C:i+C)})}},[l,i]),(0,n.A)(y,()=>{u?.()});const a=c?.(),E=p?.(),g=D=>{d&&D(0)},h=D=>{D.key==="Escape"&&(D.preventDefault(),D.stopPropagation(),u?.())};return t.createElement(o.ZL,null,t.createElement(r.W,{header:a,ref:y,style:f,ariaLabel:s.Tp.components.Menu.MenuComponent("Context"),onOpen:g,onClick:u,onKeyDown:h},E))});m.displayName="ContextMenu"},51686:(G,I,e)=>{"use strict";e.d(I,{n:()=>s});var t=e(96540),n=e(28122);const s=({children:r,renderMenuItems:o,focusOnOpen:m=!0})=>{const[l,i]=(0,t.useState)(!1),[u,d]=(0,t.useState)({x:0,y:0});return t.createElement(t.Fragment,null,r({openMenu:p=>{i(!0),d({x:p.pageX,y:p.pageY})}}),l&&t.createElement(n.t,{onClose:()=>i(!1),x:u.x,y:u.y,renderMenuItems:o,focusOnOpen:m}))}},40276:(G,I,e)=>{"use strict";e.d(I,{E:()=>l,A:()=>i});var t=e(32196),n=e(96540),s=e(62295),r=e(40845);const o=({children:d})=>{const[p,c]=(0,n.useState)(!1),[y,f]=(0,n.useState)(!1),P=(0,n.useRef)(null),a=(0,n.useRef)(null),E=(0,r.of)(m);return(0,n.useEffect)(()=>{const g=new IntersectionObserver(h=>{h.forEach(D=>{D.target===P.current?c(!D.isIntersecting):D.target===a.current&&f(!D.isIntersecting)})});return[P,a].forEach(h=>{h.current&&g.observe(h.current)}),()=>g.disconnect()},[]),n.createElement(n.Fragment,null,n.createElement("div",{className:(0,t.cx)(E.scrollIndicator,E.scrollTopIndicator,{[E.scrollIndicatorVisible]:p})}),n.createElement("div",{className:E.scrollContent},n.createElement("div",{ref:P}),d,n.createElement("div",{ref:a})),n.createElement("div",{className:(0,t.cx)(E.scrollIndicator,E.scrollBottomIndicator,{[E.scrollIndicatorVisible]:y})}))},m=d=>({scrollContent:(0,t.css)({flex:1,position:"relative"}),scrollIndicator:(0,t.css)({height:d.spacing(6),left:0,opacity:0,pointerEvents:"none",position:"absolute",right:0,[d.transitions.handleMotion("no-preference","reduce")]:{transition:d.transitions.create("opacity")},zIndex:1}),scrollTopIndicator:(0,t.css)({background:`linear-gradient(0deg, transparent, ${d.colors.background.canvas})`,top:0}),scrollBottomIndicator:(0,t.css)({background:`linear-gradient(180deg, transparent, ${d.colors.background.canvas})`,bottom:0}),scrollIndicatorVisible:(0,t.css)({opacity:1})}),l=({autoHide:d=!1,autoHideTimeout:p=200,setScrollTop:c,className:y,testId:f,autoHeightMin:P="0",autoHeightMax:a="100%",hideTracksWhenNotNeeded:E=!1,hideHorizontalTrack:g,hideVerticalTrack:h,scrollRefCallback:D,showScrollIndicators:v=!1,updateAfterMountMs:C,scrollTop:T,onScroll:S,children:O,divId:x})=>{const b=(0,n.useRef)(null),M=(0,r.of)(u);(0,n.useEffect)(()=>{b.current&&D&&D(b.current.view)},[b,D]),(0,n.useEffect)(()=>{b.current&&T!=null&&b.current.scrollTop(T)},[T]),(0,n.useEffect)(()=>{C&&setTimeout(()=>{const L=b.current;L?.update&&L.update()},C)},[C]);function A(L,V,K){return K.style&&V&&(K.style.display="none"),n.createElement("div",{...K,className:L})}const R=(0,n.useCallback)(L=>A("track-horizontal",g,L),[g]),B=(0,n.useCallback)(L=>A("track-vertical",h,L),[h]),U=(0,n.useCallback)(L=>n.createElement("div",{...L,className:"thumb-horizontal"}),[]),W=(0,n.useCallback)(L=>n.createElement("div",{...L,className:"thumb-vertical"}),[]),N=(0,n.useCallback)(L=>(L.style&&L.style.WebkitOverflowScrolling==="touch"&&(L.style.WebkitOverflowScrolling="auto"),n.createElement("div",{...L,className:"scrollbar-view",id:x})),[x]),w=(0,n.useCallback)(()=>{b.current&&c&&c(b.current.getValues())},[c]);return n.createElement(s.Ay,{"data-testid":f,ref:b,className:(0,t.cx)(M.customScrollbar,y,{[M.scrollbarWithScrollIndicators]:v}),onScrollStop:w,autoHeight:!0,autoHide:d,autoHideTimeout:p,hideTracksWhenNotNeeded:E,autoHeightMax:a,autoHeightMin:P,renderTrackHorizontal:R,renderTrackVertical:B,renderThumbHorizontal:U,renderThumbVertical:W,renderView:N,onScroll:S},v?n.createElement(o,null,O):O)},i=l,u=d=>({customScrollbar:(0,t.css)({display:"flex",flexGrow:1,".scrollbar-view":{display:"flex",flexGrow:1,flexDirection:"column"},".track-vertical":{borderRadius:d.shape.borderRadius(2),width:`${d.spacing(1)} !important`,right:0,bottom:d.spacing(.25),top:d.spacing(.25)},".track-horizontal":{borderRadius:d.shape.borderRadius(2),height:`${d.spacing(1)} !important`,right:d.spacing(.25),bottom:d.spacing(.25),left:d.spacing(.25)},".thumb-vertical":{background:d.colors.action.focus,borderRadius:d.shape.borderRadius(2),opacity:0},".thumb-horizontal":{background:d.colors.action.focus,borderRadius:d.shape.borderRadius(2),opacity:0},"&:hover":{".thumb-vertical, .thumb-horizontal":{opacity:1,transition:"opacity 0.3s ease-in-out"}}}),scrollbarWithScrollIndicators:(0,t.css)({".scrollbar-view":{position:"static !important"}})})},14689:(G,I,e)=>{"use strict";e.d(I,{R:()=>s});var t=e(96540),n=e(55852);function s({link:r,buttonProps:o}){return t.createElement("a",{href:r.href,target:r.target,rel:"noreferrer",onClick:r.onClick?m=>{!(m.ctrlKey||m.metaKey||m.shiftKey)&&r.onClick&&(m.preventDefault(),r.onClick(m))}:void 0},t.createElement(n.$n,{icon:r.target==="_blank"?"external-link-alt":void 0,variant:"primary",size:"sm",...o},r.title))}},64078:(G,I,e)=>{"use strict";e.d(I,{l:()=>O});var t=e(32196),n=e(34743),s=e(36376),r=e(7315),o=e(28848),m=e.n(o),l=e(96540),i=e(80292),u=e(75226),d=e(29317),p=e(91890),c=e(6709),y=e(41781),f=e(40845),P=e(72307),a=e(40276),E=e(10354),g=e(17464),h=e(43538);class D{getBoundingClientRect(){const M=window.getSelection(),A=M&&M.anchorNode;return A&&A.parentElement?A.parentElement.getBoundingClientRect():{top:0,left:0,bottom:0,right:0,width:0,height:0,x:0,y:0,toJSON:()=>{}}}get clientWidth(){return this.getBoundingClientRect().width}get clientHeight(){return this.getBoundingClientRect().height}}const v=(b,M)=>b-M*Math.floor(b/M),C={builtInVariable:{pattern:/(\${\S+?})/}},T=[(0,y.D)({onlyIn:b=>"type"in b&&b.type==="code_block",getSyntax:()=>"links"},{...m().languages,links:C})],S=b=>({input:(0,E.n)({theme:b,invalid:!1}).input,editor:(0,t.css)({".token.builtInVariable":{color:b.colors.success.text},".token.variable":{color:b.colors.primary.text}}),suggestionsWrapper:(0,t.css)({boxShadow:b.shadows.z2}),wrapperOverrides:(0,t.css)({width:"100%","> .slate-query-field__wrapper":{padding:0,backgroundColor:"transparent",border:"none"}})}),O=(0,l.memo)(({value:b,onChange:M,suggestions:A,placeholder:R="http://your-grafana.com/d/000000010/annotations"})=>{const B=(0,l.useRef)(null),U=(0,f.of)(S),[W,N]=(0,l.useState)(!1),[w,L]=(0,l.useState)(0),[V,K]=(0,l.useState)((0,P.mO)(b)),k=(0,i.A)(V),[j,H]=(0,l.useState)(0),J=[(0,n.cY)(({rects:ie})=>({alignmentAxis:ie.reference.width})),(0,n.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,n.BN)()],{refs:X,floatingStyles:se}=(0,s.we)({open:W,placement:"bottom-start",onOpenChange:N,middleware:J,whileElementsMounted:r.ll,strategy:"fixed"}),ae=(0,l.useRef)({showingSuggestions:W,suggestions:A,suggestionsIndex:w,linkUrl:V,onChange:M});ae.current={showingSuggestions:W,suggestions:A,suggestionsIndex:w,linkUrl:V,onChange:M};const ne=(0,l.useRef)(null);(0,l.useEffect)(()=>{H(x(ne.current,w))},[w]);const q=l.useCallback((ie,ce)=>{if(!ae.current.showingSuggestions){if(ie.key==="="||ie.key==="$"||ie.keyCode===32&&ie.ctrlKey){const ue=new D;return X.setReference(ue),N(!0)}return ce()}switch(ie.key){case"Backspace":case"Escape":return N(!1),L(0);case"Enter":return ie.preventDefault(),z(ae.current.suggestions[ae.current.suggestionsIndex]);case"ArrowDown":case"ArrowUp":ie.preventDefault();const ue=ie.key==="ArrowDown"?1:-1;return L(fe=>v(fe+ue,ae.current.suggestions.length));default:return ce()}},[]);(0,l.useEffect)(()=>{k&&k.selection.isFocused&&!V.selection.isFocused&&ae.current.onChange(u.A.serialize(V))},[V,k]);const ee=l.useCallback(({value:ie})=>{K(ie)},[]),z=(ie,ce=B.current)=>{const fe=te()==="$";ie.origin!==p.$0.Template||ie.value===c.c.includeVars?ce.insertText(`${fe?"":"$"}{${ie.value}}`):ce.insertText(`${fe?"":"$"}{${ie.value}:queryparam}`),K(ce.value),N(!1),L(0),ae.current.onChange(u.A.serialize(ce.value))},te=()=>{const ie=document.getElementById("data-link-input");let ce="",ue,fe;return window.getSelection&&(ue=window.getSelection(),ue&&ue.rangeCount>0&&(fe=ue.getRangeAt(0).cloneRange(),fe.collapse(!0),fe.setStart(ie,0),ce=fe.toString().slice(-1))),ce};return l.createElement("div",{className:U.wrapperOverrides},l.createElement("div",{className:"slate-query-field__wrapper"},l.createElement("div",{id:"data-link-input",className:"slate-query-field"},W&&l.createElement(g.ZL,null,l.createElement("div",{ref:X.setFloating,style:se},l.createElement(a.A,{scrollTop:j,autoHeightMax:"300px",setScrollTop:({scrollTop:ie})=>H(ie)},l.createElement(h.k,{activeRef:ne,suggestions:ae.current.suggestions,onSuggestionSelect:z,onClose:()=>N(!1),activeIndex:w})))),l.createElement(d.KE,{schema:P.yx,ref:B,placeholder:R,value:ae.current.linkUrl,onChange:ee,onKeyDown:(ie,ce,ue)=>q(ie,ue),plugins:T,className:(0,t.cx)(U.editor,U.input,(0,t.css)({padding:"3px 8px"}))}))))});O.displayName="DataLinkInput";function x(b,M){return(b?.clientHeight??0)*M}},43538:(G,I,e)=>{"use strict";e.d(I,{k:()=>u});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(37151),m=e(40845),l=e(33552);const i=p=>({list:(0,t.css)({borderBottom:`1px solid ${p.colors.border.weak}`,"&:last-child":{border:"none"}}),wrapper:(0,t.css)({background:p.colors.background.primary,width:"250px"}),item:(0,t.css)({background:"none",padding:"2px 8px",userSelect:"none",color:p.colors.text.primary,cursor:"pointer","&:hover":{background:p.colors.action.hover}}),label:(0,t.css)({color:p.colors.text.secondary}),activeItem:(0,t.css)({background:p.colors.background.secondary,"&:hover":{background:p.colors.background.secondary}}),itemValue:(0,t.css)({fontFamily:p.typography.fontFamilyMonospace,fontSize:p.typography.size.sm})}),u=({suggestions:p,...c})=>{const y=(0,r.useRef)(null);(0,o.A)(y,()=>{c.onClose&&c.onClose()});const f=(0,r.useMemo)(()=>(0,n.groupBy)(p,a=>a.origin),[p]),P=(0,m.of)(i);return r.createElement("div",{role:"menu",ref:y,className:P.wrapper},Object.keys(f).map((a,E)=>{const g=E===0?0:Object.keys(f).reduce((h,D,v)=>v>=E?h:h+f[D].length,0);return r.createElement(d,{...c,suggestions:f[a],label:`${(0,n.capitalize)(a)}`,activeIndex:c.activeIndex,activeIndexOffset:g,key:a})}))};u.displayName="DataLinkSuggestions";const d=r.memo(({activeIndex:p,activeIndexOffset:c,label:y,onClose:f,onSuggestionSelect:P,suggestions:a,activeRef:E})=>{const g=(0,m.of)(i);return r.createElement(r.Fragment,null,r.createElement(l.B,{className:g.list,items:a,renderItem:(h,D)=>{const v=D+c===p;return r.createElement("div",{role:"menuitem",tabIndex:0,className:(0,t.cx)(g.item,v&&g.activeItem),ref:v?E:void 0,onClick:()=>{P(h)},title:h.documentation},r.createElement("span",{className:g.itemValue},r.createElement("span",{className:g.label},y)," ",h.label))}}))});d.displayName="DataLinkSuggestionsList"},59796:(G,I,e)=>{"use strict";e.d(I,{e:()=>i});var t=e(32196),n=e(96540),s=e(13544),r=e(14555),o=e(51686),m=e(59093),l=e(64539);const i=({children:u,links:d,style:p})=>{const c=[{items:(0,r.J)(d),label:"Data links"}],y=c[0].items.length,f=()=>c.map((a,E)=>n.createElement(m.r,{key:`${a.label}${E}`,label:a.label},(a.items||[]).map((g,h)=>n.createElement(l.D,{key:`${a.label}-${E}-${h}}`,url:g.url,label:g.label,target:g.target,icon:g.icon,active:g.active,onClick:g.onClick})))),P=(0,t.css)({cursor:"context-menu"});if(y>1)return n.createElement(o.n,{renderMenuItems:f},({openMenu:a})=>u({openMenu:a,targetClassName:P}));{const a=d()[0];return n.createElement("a",{href:a.href,onClick:a.onClick,target:a.target,title:a.title,style:{...p,overflow:"hidden",display:"flex"},"data-testid":s.Tp.components.DataLinksContextMenu.singleLink},u({}))}}},64919:(G,I,e)=>{"use strict";e.d(I,{e:()=>h});var t=e(32196),n=e(2543),s=e(96540),r=e(40845),o=e(55852),m=e(37390),l=e(14555),i=e(88575),u=e(10354),d=e(15292),p=e(64078);const c=v=>({listItem:(0,t.css)({marginBottom:v.spacing()}),infoText:(0,t.css)({paddingBottom:v.spacing(2),marginLeft:"66px",color:v.colors.text.secondary})}),y=s.memo(({index:v,value:C,onChange:T,suggestions:S,isLast:O})=>{const x=(0,r.of)(c),b=(R,B)=>{T(v,{...C,url:R},B)},M=R=>{T(v,{...C,title:R.target.value})},A=()=>{T(v,{...C,targetBlank:!C.targetBlank})};return s.createElement("div",{className:x.listItem},s.createElement(i.D,{label:"Title"},s.createElement(u.p,{value:C.title,onChange:M,placeholder:"Show details"})),s.createElement(i.D,{label:"URL",invalid:(0,l.F)(C.url),error:"Data link is an Explore URL in a deprecated format. Please visit the URL to be redirected, and edit this data link to use that URL."},s.createElement(p.l,{value:C.url,onChange:b,suggestions:S})),s.createElement(i.D,{label:"Open in new tab"},s.createElement(d.d,{value:C.targetBlank||!1,onChange:A})),O&&s.createElement("div",{className:x.infoText},"With data links you can reference data variables like series name, labels and values. Type CMD+Space, CTRL+Space, or $ to open variable suggestions."))});y.displayName="DataLinkEditor";const f=({link:v,index:C,getSuggestions:T,onSave:S,onCancel:O})=>{const[x,b]=(0,s.useState)(v);return s.createElement(s.Fragment,null,s.createElement(y,{value:x,index:C,isLast:!1,suggestions:T(),onChange:(M,A)=>{b(A)}}),s.createElement(m.a.ButtonRow,null,s.createElement(o.$n,{variant:"secondary",onClick:()=>O(C),fill:"outline"},"Cancel"),s.createElement(o.$n,{onClick:()=>{S(C,x)}},"Save")))};var P=e(72093),a=e(29158);const E=({link:v,onEdit:C,onRemove:T})=>{const S=(0,r.of)(g),{title:O="",url:x=""}=v,b=O.trim()!=="",M=x.trim()!=="",A=(0,l.F)(x);return s.createElement("div",{className:S.wrapper},s.createElement("div",{className:S.titleWrapper},s.createElement("div",{className:(0,t.cx)(S.url,!M&&S.notConfigured,A&&S.errored)},b?O:"Data link title not provided"),s.createElement("div",{className:S.actionButtons},s.createElement(a.K,{name:"pen",onClick:C,tooltip:"Edit data link title"}),s.createElement(a.K,{name:"times",onClick:T,tooltip:"Remove data link title"}))),s.createElement("div",{className:(0,t.cx)(S.url,!M&&S.notConfigured,A&&S.errored),title:x},M?x:"Data link url not provided"),A&&s.createElement(P.P,null,"Explore data link may not work in the future. Please edit."))},g=v=>({wrapper:(0,t.css)({marginBottom:v.spacing(2),width:"100%","&:last-child":{marginBottom:0},display:"flex",flexDirection:"column"}),titleWrapper:(0,t.css)({label:"data-links-list-item-title",justifyContent:"space-between",display:"flex",width:"100%",alignItems:"center"}),actionButtons:(0,t.css)({marginLeft:v.spacing(1),display:"flex"}),errored:(0,t.css)({color:v.colors.error.text,fontStyle:"italic"}),notConfigured:(0,t.css)({fontStyle:"italic"}),title:(0,t.css)({color:v.colors.text.primary,fontSize:v.typography.size.sm,fontWeight:v.typography.fontWeightMedium}),url:(0,t.css)({color:v.colors.text.secondary,fontSize:v.typography.size.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"90%"})}),h=({links:v,onChange:C,getSuggestions:T,data:S})=>{const[O,x]=(0,s.useState)(null),[b,M]=(0,s.useState)(!1),A=(0,r.of)(D),R=v??[],B=O!==null,U=(L,V)=>{if(b)if(V.title.trim()===""&&V.url.trim()===""){M(!1),x(null);return}else x(null),M(!1);const K=(0,n.cloneDeep)(R);K[L]=V,C(K),x(null)},W=()=>{let L=(0,n.cloneDeep)(R);x(L.length),M(!0)},N=L=>{b&&M(!1),x(null)},w=L=>{const V=(0,n.cloneDeep)(R);V.splice(L,1),C(V)};return s.createElement(s.Fragment,null,R.length>0&&s.createElement("div",{className:A.wrapper},R.map((L,V)=>s.createElement(E,{key:`${L.title}/${V}`,index:V,link:L,onChange:U,onEdit:()=>x(V),onRemove:()=>w(V),data:S}))),B&&O!==null&&s.createElement(m.a,{title:"Edit link",isOpen:!0,closeOnBackdropClick:!1,onDismiss:()=>{N(O)}},s.createElement(f,{index:O,link:b?{title:"",url:""}:R[O],data:S,onSave:U,onCancel:N,getSuggestions:T})),s.createElement(o.$n,{size:"sm",icon:"plus",onClick:W,variant:"secondary"},"Add link"))},D=v=>({wrapper:(0,t.css)({marginBottom:v.spacing(2)})})},79961:(G,I,e)=>{"use strict";e.d(I,{n:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(14578),o=e(14689);function m({links:i}){const u=(0,s.of)(l);if(i.length===1)return n.createElement(o.R,{link:i[0]});const d=i.filter(c=>c.target==="_blank"),p=i.filter(c=>c.target==="_self");return n.createElement(n.Fragment,null,p.map((c,y)=>n.createElement(o.R,{key:y,link:c})),n.createElement("div",{className:u.wrapper},n.createElement("p",{className:u.externalLinksHeading},"External links"),d.map((c,y)=>n.createElement("a",{key:y,href:c.href,target:c.target,className:u.externalLink},n.createElement(r.I,{name:"external-link-alt"}),c.title))))}const l=i=>({wrapper:(0,t.css)({flexBasis:"150px",width:"100px",marginTop:i.spacing(1)}),externalLinksHeading:(0,t.css)({color:i.colors.text.secondary,fontWeight:i.typography.fontWeightRegular,fontSize:i.typography.size.sm,margin:0}),externalLink:(0,t.css)({color:i.colors.text.link,fontWeight:i.typography.fontWeightRegular,display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:hover":{textDecoration:"underline"},div:{marginRight:i.spacing(1)}})})},19849:(G,I,e)=>{"use strict";e.d(I,{i:()=>r});var t=e(96540),n=e(15292),s=e(14186);function r({options:o,onOptionsChange:m}){return t.createElement(t.Fragment,null,t.createElement("h3",{className:"page-heading"},"Alerting"),t.createElement("div",{className:"gf-form-group"},t.createElement("div",{className:"gf-form-inline"},t.createElement("div",{className:"gf-form"},t.createElement(s.I,{labelWidth:29,label:"Manage alert rules in Alerting UI",disabled:o.readOnly,tooltip:"Manage alert rules for this data source. To manage other alerting resources, add an Alertmanager data source."},t.createElement(n.K,{value:o.jsonData.manageAlerts!==!1,onChange:l=>m({...o,jsonData:{...o.jsonData,manageAlerts:l.currentTarget.checked}})}))))))}},28623:(G,I,e)=>{"use strict";e.d(I,{K:()=>l});var t=e(96540),n=e(55852),s=e(14186),r=e(39268),o=e(10354),m=e(21744);const l=({hasCert:i,label:u,onChange:d,onClick:p,placeholder:c})=>t.createElement(r.C,null,t.createElement(s.I,{label:u,labelWidth:14,disabled:i},i?t.createElement(o.p,{type:"text",value:"configured",width:24}):t.createElement(m.f,{rows:7,onChange:d,placeholder:c,required:!0})),i&&t.createElement(n.$n,{variant:"secondary",onClick:p,style:{marginLeft:4}},"Reset"))},11184:(G,I,e)=>{"use strict";e.d(I,{P:()=>c});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(40845),m=e(55852),l=e(90090),i=e(14578),u=e(56286);const d=()=>({layout:(0,t.css)({display:"flex",alignItems:"center",marginBottom:"4px","> *":{marginLeft:"4px",marginBottom:0,height:"100%","&:first-child, &:last-child":{marginLeft:0}}})}),p=({header:f,onBlur:P,onChange:a,onRemove:E,onReset:g})=>{const h=(0,o.of)(d);return r.createElement("div",{className:h.layout},r.createElement(l.z,{label:"Header",name:"name",placeholder:"X-Custom-Header",labelWidth:5,value:f.name||"",onChange:D=>a({...f,name:D.target.value}),onBlur:P}),r.createElement(u.L,{label:"Value","aria-label":"Value",name:"value",isConfigured:f.configured,value:f.value,labelWidth:5,inputWidth:f.configured?11:12,placeholder:"Header Value",onReset:()=>g(f.id),onChange:D=>a({...f,value:D.target.value}),onBlur:P}),r.createElement(m.$n,{type:"button","aria-label":"Remove header",variant:"secondary",size:"xs",onClick:D=>E(f.id)},r.createElement(i.I,{name:"trash-alt"})))};p.displayName="CustomHeaderRow";class c extends r.PureComponent{constructor(P){super(P),this.state={headers:[]},this.updateSettings=()=>{const{headers:h}=this.state,D=Object.fromEntries(Object.entries(this.props.dataSourceConfig.jsonData).filter(([C,T])=>!C.startsWith("httpHeaderName"))),v=Object.fromEntries(Object.entries(this.props.dataSourceConfig.secureJsonData||{}).filter(([C,T])=>!C.startsWith("httpHeaderValue")));for(const[C,T]of h.entries())D[`httpHeaderName${C+1}`]=T.name,T.configured||(v[`httpHeaderValue${C+1}`]=T.value);this.props.onChange({...this.props.dataSourceConfig,jsonData:D,secureJsonData:v})},this.onHeaderAdd=()=>{this.setState(h=>({headers:[...h.headers,{id:(0,n.uniqueId)(),name:"",value:"",configured:!1}]}))},this.onHeaderChange=(h,D)=>{this.setState(({headers:v})=>({headers:v.map((C,T)=>h!==T?C:{...D})}))},this.onHeaderReset=h=>{this.setState(({headers:D})=>({headers:D.map((v,C)=>v.id!==h?v:{...v,value:"",configured:!1})}))},this.onHeaderRemove=h=>{this.setState(({headers:D})=>({headers:D.filter(v=>v.id!==h)}),this.updateSettings)};const{jsonData:a,secureJsonData:E,secureJsonFields:g}=this.props.dataSourceConfig;this.state={headers:Object.keys(a).sort().filter(h=>h.startsWith("httpHeaderName")).map((h,D)=>({id:(0,n.uniqueId)(),name:a[h],value:E!==void 0?E[h]:"",configured:g&&g[`httpHeaderValue${D+1}`]||!1}))}}render(){const{headers:P}=this.state,{dataSourceConfig:a}=this.props;return r.createElement("div",{className:"gf-form-group"},r.createElement("div",{className:"gf-form"},r.createElement("h6",null,"Custom HTTP Headers")),r.createElement("div",null,P.map((E,g)=>r.createElement(p,{key:E.id,header:E,onChange:h=>{this.onHeaderChange(g,h)},onBlur:this.updateSettings,onRemove:this.onHeaderRemove,onReset:this.onHeaderReset}))),!a.readOnly&&r.createElement("div",{className:"gf-form"},r.createElement(m.$n,{variant:"secondary",icon:"plus",type:"button",onClick:E=>{this.onHeaderAdd()}},"Add header")))}}var y=null},91409:(G,I,e)=>{"use strict";e.d(I,{t:()=>S});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(90090),m=e(38894),l=e(14186),i=e(91634),u=e(14578),d=e(21594),p=e(15292),c=e(79924),y=e(56286);const f=({dataSourceConfig:O,onChange:x})=>{const b=O.secureJsonData?O.secureJsonData.basicAuthPassword:"",M=()=>{x({...O,secureJsonData:{...O.secureJsonData,basicAuthPassword:""},secureJsonFields:{...O.secureJsonFields,basicAuthPassword:!1}})},A=R=>{x({...O,secureJsonData:{...O.secureJsonData,basicAuthPassword:R.currentTarget.value}})};return n.createElement(n.Fragment,null,n.createElement(l.I,{disabled:O.readOnly},n.createElement(o.z,{label:"User",labelWidth:10,inputWidth:18,placeholder:"user",value:O.basicAuthUser,onChange:R=>x({...O,basicAuthUser:R.currentTarget.value})})),n.createElement(l.I,{disabled:O.readOnly},n.createElement(y.L,{isConfigured:!!(O.secureJsonFields&&O.secureJsonFields.basicAuthPassword),value:b||"",inputWidth:18,labelWidth:10,onReset:M,onChange:A})))};var P=e(11184);const a=26,E=({dataSourceConfig:O,onChange:x,showForwardOAuthIdentityOption:b=!0})=>n.createElement(n.Fragment,null,n.createElement("div",{className:"gf-form-inline"},n.createElement(l.I,{label:"TLS Client Auth",labelWidth:a,disabled:O.readOnly},n.createElement(p.K,{id:"http-settings-tls-client-auth",value:O.jsonData.tlsAuth||!1,onChange:M=>x({...O.jsonData,tlsAuth:M.currentTarget.checked})})),n.createElement(l.I,{label:"With CA Cert",tooltip:"Needed for verifying self-signed TLS Certs",labelWidth:a,disabled:O.readOnly},n.createElement(p.K,{id:"http-settings-ca-cert",value:O.jsonData.tlsAuthWithCACert||!1,onChange:M=>x({...O.jsonData,tlsAuthWithCACert:M.currentTarget.checked})}))),n.createElement("div",{className:"gf-form-inline"},n.createElement(l.I,{label:"Skip TLS Verify",labelWidth:a,disabled:O.readOnly},n.createElement(p.K,{id:"http-settings-skip-tls-verify",value:O.jsonData.tlsSkipVerify||!1,onChange:M=>x({...O.jsonData,tlsSkipVerify:M.currentTarget.checked})}))),b&&n.createElement("div",{className:"gf-form-inline"},n.createElement(l.I,{label:"Forward OAuth Identity",tooltip:"Forward the user's upstream OAuth identity to the data source (Their access token gets passed along).",labelWidth:a,disabled:O.readOnly},n.createElement(p.K,{id:"http-settings-forward-oauth",value:O.jsonData.oauthPassThru||!1,onChange:M=>x({...O.jsonData,oauthPassThru:M.currentTarget.checked})}))));var g=e(17081),h=e(95180);const D=[{label:"Server (default)",value:"proxy"},{label:"Browser",value:"direct"}],v={label:"Server (default)",value:"proxy"},C=()=>n.createElement("div",{className:"grafana-info-box m-t-2"},n.createElement("p",null,"Access mode controls how requests to the data source will be handled.",n.createElement("strong",null,"\xA0",n.createElement("i",null,"Server"))," ","should be the preferred way if nothing else is stated."),n.createElement("div",{className:"alert-title"},"Server access mode (Default):"),n.createElement("p",null,"All requests will be made from the browser to Grafana backend/server which in turn will forward the requests to the data source and by that circumvent possible Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the grafana backend/server if you select this access mode."),n.createElement("div",{className:"alert-title"},"Browser access mode:"),n.createElement("p",null,"All requests will be made from the browser directly to the data source and may be subject to Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the browser if you select this access mode.")),T=26,S=O=>{const{defaultUrl:x,dataSourceConfig:b,onChange:M,showAccessOptions:A,sigV4AuthToggleEnabled:R,showForwardOAuthIdentityOption:B,azureAuthSettings:U,renderSigV4Editor:W,secureSocksDSProxyEnabled:N,urlLabel:w,urlDocs:L}=O,[V,K]=(0,n.useState)(!1),[k,j]=(0,n.useState)(!1),H=(0,r.$j)();let J;const X=(0,n.useCallback)(te=>{const ie=U?.azureAuthSupported&&U.getAzureAuthEnabled(b)||!1;if(j(ie),ie){const ce=b.jsonData.oauthPassThru!==void 0?b.jsonData.oauthPassThru:!1;te={...te,jsonData:{...b.jsonData,oauthPassThru:ie?!1:ce}}}M({...b,...te})},[U,b,M]);switch(b.access){case"direct":J=n.createElement(n.Fragment,null,"Your access method is ",n.createElement("em",null,"Browser"),", this means the URL needs to be accessible from the browser.",L);break;case"proxy":J=n.createElement(n.Fragment,null,"Your access method is ",n.createElement("em",null,"Server"),", this means the URL needs to be accessible from the grafana backend/server.",L);break;default:J=n.createElement(n.Fragment,null,"Specify a complete HTTP URL (for example http://your_server:8080) ",L)}const se=n.createElement(d.l6,{"aria-label":"Access",className:"width-20 gf-form-input",options:D,value:D.filter(te=>te.value===b.access)[0]||v,onChange:te=>X({access:te.value}),disabled:b.readOnly}),ae=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(b.url),ne=(0,t.css)({boxShadow:`inset 0 0px 5px ${H.v1.palette.red}`}),q=(0,t.cx)({"width-20":!0,[ne]:!ae}),ee=(0,n.useId)(),z=n.createElement(i.p,{id:ee,className:q,placeholder:x,value:b.url,"data-testid":s.Tp.components.DataSource.DataSourceHttpSettings.urlInput,onChange:te=>X({url:te.currentTarget.value}),disabled:b.readOnly});return n.createElement("div",{className:"gf-form-group"},n.createElement(n.Fragment,null,n.createElement("h3",{className:"page-heading"},"HTTP"),n.createElement("div",{className:"gf-form-group"},n.createElement("div",{className:"gf-form"},n.createElement(o.z,{interactive:!!L,label:w??"URL",labelWidth:13,tooltip:J,inputEl:z})),A&&n.createElement(n.Fragment,null,n.createElement("div",{className:"gf-form-inline"},n.createElement("div",{className:"gf-form"},n.createElement(o.z,{label:"Access",labelWidth:13,inputWidth:20,inputEl:se})),n.createElement("div",{className:"gf-form"},n.createElement("button",{type:"button",className:"gf-form-label query-keyword pointer",onClick:()=>K(te=>!te)},"Help\xA0",n.createElement(u.I,{name:V?"angle-down":"angle-right",style:{marginBottom:0}})))),V&&n.createElement(C,null)),b.access==="proxy"&&n.createElement("div",{className:"gf-form-group"},n.createElement("div",{className:"gf-form"},n.createElement(m.I,{width:13,tooltip:"Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source."},"Allowed cookies"),n.createElement(c.u,{tags:b.jsonData.keepCookies,width:40,onChange:te=>X({jsonData:{...b.jsonData,keepCookies:te}}),disabled:b.readOnly})),n.createElement("div",{className:"gf-form"},n.createElement(o.z,{label:"Timeout",type:"number",labelWidth:13,inputWidth:20,tooltip:"HTTP request timeout in seconds",placeholder:"Timeout in seconds","aria-label":"Timeout in seconds",value:b.jsonData.timeout,onChange:te=>{X({jsonData:{...b.jsonData,timeout:parseInt(te.currentTarget.value,10)}})},disabled:b.readOnly}))))),n.createElement(n.Fragment,null,n.createElement("h3",{className:"page-heading"},"Auth"),n.createElement("div",{className:"gf-form-group"},n.createElement("div",{className:"gf-form-inline"},n.createElement(l.I,{label:"Basic auth",labelWidth:T,disabled:b.readOnly},n.createElement(p.K,{id:"http-settings-basic-auth",value:b.basicAuth,onChange:te=>{X({basicAuth:te.currentTarget.checked})}})),n.createElement(l.I,{label:"With Credentials",tooltip:"Whether credentials such as cookies or auth headers should be sent with cross-site requests.",labelWidth:T,disabled:b.readOnly},n.createElement(p.K,{id:"http-settings-with-credentials",value:b.withCredentials,onChange:te=>{X({withCredentials:te.currentTarget.checked})}}))),U?.azureAuthSupported&&n.createElement("div",{className:"gf-form-inline"},n.createElement(l.I,{label:"Azure Authentication",tooltip:"Use Azure authentication for Azure endpoint.",labelWidth:T,disabled:b.readOnly},n.createElement(p.K,{id:"http-settings-azure-auth",value:k,onChange:te=>{X(U.setAzureAuthEnabled(b,te.currentTarget.checked))}}))),R&&n.createElement("div",{className:"gf-form-inline"},n.createElement(l.I,{label:"SigV4 auth",labelWidth:T,disabled:b.readOnly},n.createElement(p.K,{id:"http-settings-sigv4-auth",value:b.jsonData.sigV4Auth||!1,onChange:te=>{X({jsonData:{...b.jsonData,sigV4Auth:te.currentTarget.checked}})}}))),b.access==="proxy"&&n.createElement(E,{dataSourceConfig:b,onChange:te=>X({jsonData:te}),showForwardOAuthIdentityOption:k?!1:B})),b.basicAuth&&n.createElement(n.Fragment,null,n.createElement("h6",null,"Basic Auth Details"),n.createElement("div",{className:"gf-form-group"},n.createElement(f,{...O}))),U?.azureAuthSupported&&k&&U.azureSettingsUI&&n.createElement(U.azureSettingsUI,{dataSourceConfig:b,onChange:M}),b.jsonData.sigV4Auth&&R&&W,(b.jsonData.tlsAuth||b.jsonData.tlsAuthWithCACert)&&n.createElement(h.j,{dataSourceConfig:b,onChange:M}),b.access==="proxy"&&n.createElement(P.P,{dataSourceConfig:b,onChange:M})),N&&n.createElement(g.Y,{options:b,onOptionsChange:M}))}},17081:(G,I,e)=>{"use strict";e.d(I,{Y:()=>r});var t=e(96540),n=e(15292),s=e(14186);function r({options:o,onOptionsChange:m}){return t.createElement(t.Fragment,null,t.createElement("h3",{className:"page-heading"},"Secure Socks Proxy"),t.createElement("div",{className:"gf-form-group"},t.createElement("div",{className:"gf-form-inline"},t.createElement("div",{className:"gf-form"},t.createElement(s.I,{labelWidth:26,label:"Enabled",tooltip:"Connect to this datasource via the secure socks proxy."},t.createElement(n.K,{value:o.jsonData.enableSecureSocksProxy??!1,onChange:l=>m({...o,jsonData:{...o.jsonData,enableSecureSocksProxy:l.currentTarget.checked}})}))))))}},95180:(G,I,e)=>{"use strict";e.d(I,{j:()=>l});var t=e(32196),n=e(96540),s=e(90090),r=e(14578),o=e(56034),m=e(28623);const l=({dataSourceConfig:i,onChange:u})=>{const d=i.secureJsonFields&&i.secureJsonFields.tlsCACert,p=i.secureJsonFields&&i.secureJsonFields.tlsClientCert,c=i.secureJsonFields&&i.secureJsonFields.tlsClientKey,y=i.jsonData&&i.jsonData.serverName,f=E=>g=>{g.preventDefault();const h={...i.secureJsonFields};h[E]=!1,u({...i,secureJsonFields:h})},P=E=>g=>{const h={...i.secureJsonData};h[E]=g.currentTarget.value,u({...i,secureJsonData:h})},a=E=>{const g={...i.jsonData,serverName:E.currentTarget.value};u({...i,jsonData:g})};return n.createElement("div",{className:"gf-form-group"},n.createElement("div",{className:(0,t.cx)("gf-form",(0,t.css)({alignItems:"baseline"}))},n.createElement("h6",null,"TLS/SSL Auth Details"),n.createElement(o.m,{placement:"right-end",content:"TLS/SSL Certs are encrypted and stored in the Grafana database.",theme:"info"},n.createElement(r.I,{name:"info-circle",size:"xs",style:{marginLeft:"10px"}}))),n.createElement("div",null,i.jsonData.tlsAuthWithCACert&&n.createElement(m.K,{hasCert:!!d,onChange:P("tlsCACert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",label:"CA Cert",onClick:f("tlsCACert")}),i.jsonData.tlsAuth&&n.createElement(n.Fragment,null,n.createElement("div",{className:"gf-form"},n.createElement(s.z,{label:"ServerName",labelWidth:7,inputWidth:30,placeholder:"domain.example.com",value:y&&i.jsonData.serverName,onChange:a})),n.createElement(m.K,{hasCert:!!p,label:"Client Cert",onChange:P("tlsClientCert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",onClick:f("tlsClientCert")}),n.createElement(m.K,{hasCert:!!c,label:"Client Key",placeholder:"Begins with -----BEGIN RSA PRIVATE KEY-----",onChange:P("tlsClientKey"),onClick:f("tlsClientKey")}))))}},56181:(G,I,e)=>{"use strict";e.d(I,{l:()=>i});var t=e(32196),n=e(96540),s=e(29426),r=e(40845),o=e(8866),m=e(14578),l=e(72265);const i=(0,n.memo)(p=>{const c=(0,r.of)(d),{isOpen:y,onClose:f}=p;return y?n.createElement(o.N,{useCapture:!0,includeButtonPress:!1,onClick:f},n.createElement("div",{className:c.modal,"data-testid":"date-picker"},n.createElement(u,{...p}))):null});i.displayName="DatePicker";const u=(0,n.memo)(({value:p,minDate:c,maxDate:y,onChange:f})=>{const P=(0,r.of)(l.h2);return n.createElement(s.Ay,{className:P.body,tileClassName:P.title,value:p||new Date,minDate:c,maxDate:y,nextLabel:n.createElement(m.I,{name:"angle-right"}),prevLabel:n.createElement(m.I,{name:"angle-left"}),onChange:a=>{a&&!Array.isArray(a)&&f(a)},locale:"en"})});u.displayName="Body";const d=p=>({modal:(0,t.css)({zIndex:p.zIndex.modal,boxShadow:p.shadows.z3,backgroundColor:p.colors.background.primary,border:`1px solid ${p.colors.border.weak}`,borderTopLeftRadius:p.shape.radius.default,borderBottomLeftRadius:p.shape.radius.default,"button:disabled":{color:p.colors.text.disabled}})})},98239:(G,I,e)=>{"use strict";e.d(I,{l:()=>p});var t=e(32196),n=e(34743),s=e(36376),r=e(7315),o=e(96540),m=e(47232),l=e(40845),i=e(10354),u=e(56181);const d=y=>(0,m.KQ)(y).format("L"),p=({value:y,minDate:f,maxDate:P,onChange:a,closeOnSelect:E,placeholder:g="Date",...h})=>{const[D,v]=(0,o.useState)(!1),C=(0,l.of)(c),T=[(0,n.UU)({crossAxis:!1,boundary:document.body}),(0,n.BN)()],{context:S,refs:O,floatingStyles:x}=(0,s.we)({open:D,placement:"bottom-start",onOpenChange:v,middleware:T,whileElementsMounted:r.ll,strategy:"fixed"}),b=(0,s.kp)(S),M=(0,s.s9)(S),{getReferenceProps:A,getFloatingProps:R}=(0,s.bv)([M,b]);return o.createElement("div",{className:C.container},o.createElement(i.p,{ref:O.setReference,type:"text",autoComplete:"off",placeholder:g,value:y&&d(y),onChange:B=>{B.target.value===""&&a("")},className:C.input,...h,...A()}),o.createElement("div",{className:C.popover,ref:O.setFloating,style:x,...R()},o.createElement(u.l,{isOpen:D,value:y&&typeof y!="string"?y:(0,m.KQ)().toDate(),minDate:f,maxDate:P,onChange:B=>{a(B),E&&v(!1)},onClose:()=>v(!1)})))},c=y=>({container:(0,t.css)({position:"relative"}),input:(0,t.css)({"input[type='date']::-webkit-inner-spin-button, input[type='date']::-webkit-calendar-picker-indicator":{display:"none",WebkitAppearance:"none"}}),popover:(0,t.css)({zIndex:y.zIndex.tooltip})})},63383:(G,I,e)=>{"use strict";e.d(I,{K:()=>b});var t=e(32196),n=e(34743),s=e(36376),r=e(7315),o=e(18828),m=e(85690),l=e(93225),i=e(96540),u=e(29426),d=e(49045),p=e(72724),c=e(47232),y=e(1933),f=e(13390),P=e(40845),a=e(55852),E=e(14186),g=e(14578),h=e(10354),D=e(67061),v=e(88448),C=e(17464),T=e(66070),S=e(72265),O=e(47619),x=e(99225);const b=({date:B,maxDate:U,minDate:W,label:N,onChange:w,disabledHours:L,disabledMinutes:V,disabledSeconds:K,showSeconds:k=!0,clearable:j=!1})=>{const[H,J]=(0,i.useState)(!1),X=(0,i.useRef)(null),{overlayProps:se,underlayProps:ae}=(0,l.e)({onClose:()=>J(!1),isDismissable:!0,isOpen:H,shouldCloseOnInteractOutside:he=>{const de=document.getElementsByClassName(T.i)[0];return!(de&&de.contains(he))}},X),{dialogProps:ne}=(0,o.s)({},X),q=(0,P.$j)(),{modalBackdrop:ee}=(0,P.of)(v.o),z=(0,d.A)(`(min-width: ${q.breakpoints.values.lg}px)`),te=(0,P.of)(R),ie=[(0,n.UU)({crossAxis:!1,boundary:document.body}),(0,n.BN)()],{refs:ce,floatingStyles:ue}=(0,s.we)({open:H,placement:"bottom-start",onOpenChange:J,middleware:ie,whileElementsMounted:r.ll,strategy:"fixed"}),fe=(0,i.useCallback)(he=>{J(!1),w(he)},[w]),Te=(0,i.useCallback)(he=>{he.preventDefault(),J(!0)},[J]);return i.createElement("div",{"data-testid":"date-time-picker",style:{position:"relative"}},i.createElement(M,{date:B,onChange:w,isFullscreen:z,onOpen:Te,label:N,ref:ce.setReference,showSeconds:k,clearable:j}),H?z?i.createElement(C.ZL,null,i.createElement(m.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},i.createElement("div",{ref:X,...se,...ne},i.createElement(A,{date:B,onChange:fe,isFullscreen:!0,onClose:()=>J(!1),maxDate:U,minDate:W,ref:ce.setFloating,style:ue,showSeconds:k,disabledHours:L,disabledMinutes:V,disabledSeconds:K})))):i.createElement(C.ZL,null,i.createElement("div",{className:ee,...ae}),i.createElement(m.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},i.createElement("div",{ref:X,...se,...ne},i.createElement("div",{className:te.modal},i.createElement(A,{date:B,maxDate:U,minDate:W,onChange:fe,isFullscreen:!1,onClose:()=>J(!1),showSeconds:k,disabledHours:L,disabledMinutes:V,disabledSeconds:K}))))):null)},M=i.forwardRef(({date:B,label:U,onChange:W,onOpen:N,showSeconds:w=!0,clearable:L=!1},V)=>{const K=(0,P.of)(R),k=w?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm",[j,H]=(0,i.useState)(()=>({value:B?(0,p.LE)(B):L?"":(0,p.LE)((0,c.KQ)()),invalid:!1}));(0,i.useEffect)(()=>{B&&H({invalid:!(0,O.f)((0,p.LE)(B,{format:k})),value:(0,c.Ar)(B)?(0,p.LE)(B,{format:k}):B})},[B,k]);const J=(0,i.useCallback)(ne=>{const q=!(0,O.f)(ne.currentTarget.value);H({value:ne.currentTarget.value,invalid:q})},[]),X=(0,i.useCallback)(()=>{if(!j.invalid&&j.value){const ne=(0,c.oZ)((0,y.O)(),j.value);W(ne)}},[j,W]),se=(0,i.useCallback)(()=>{H({value:"",invalid:!1}),W()},[W]),ae=i.createElement(a.$n,{"aria-label":"Time picker",icon:"calendar-alt",variant:"secondary",onClick:N});return i.createElement(E.I,{label:U,invalid:!!(j.value&&j.invalid),className:K.field},i.createElement(h.p,{onChange:J,addonAfter:ae,value:j.value,onBlur:X,"data-testid":f.X.DateTimePicker.input,placeholder:"Select date/time",ref:V,suffix:L&&j.value&&i.createElement(g.I,{name:"times",className:K.clearIcon,onClick:se})}))});M.displayName="DateTimeInput";const A=i.forwardRef(({date:B,onClose:U,onChange:W,isFullscreen:N,maxDate:w,minDate:L,style:V,showSeconds:K=!0,disabledHours:k,disabledMinutes:j,disabledSeconds:H},J)=>{const X=(0,P.of)(S.h2),se=(0,P.of)(R),[ae,ne]=(0,i.useState)(()=>B&&B.isValid()?(0,c.oZ)((0,y.O)(),B):(0,c.oZ)((0,y.O)(),new Date)),[q,ee]=(0,i.useState)(()=>B&&B.isValid()?(0,x.Q)(B.toDate(),(0,y.O)()):new Date),z=(0,i.useCallback)(ce=>{ce&&!Array.isArray(ce)&&ee(ce)},[]),te=(0,i.useCallback)(ce=>{ne(ce)},[]),ie=()=>{const ce=(0,c.KQ)(ae);ce.set("date",q.getDate()),ce.set("month",q.getMonth()),ce.set("year",q.getFullYear()),W(ce)};return i.createElement("div",{className:(0,t.cx)(se.container,{[se.fullScreen]:N}),style:V,ref:J},i.createElement(u.Ay,{next2Label:null,prev2Label:null,value:q,nextLabel:i.createElement(g.I,{name:"angle-right"}),nextAriaLabel:"Next month",prevLabel:i.createElement(g.I,{name:"angle-left"}),prevAriaLabel:"Previous month",onChange:z,locale:"en",className:X.body,tileClassName:X.title,maxDate:w,minDate:L}),i.createElement("div",{className:se.time},i.createElement(T.R,{showSeconds:K,onChange:te,value:ae,disabledHours:k,disabledMinutes:j,disabledSeconds:H})),i.createElement(D.B,null,i.createElement(a.$n,{type:"button",onClick:ie},"Apply"),i.createElement(a.$n,{variant:"secondary",type:"button",onClick:U},"Cancel")))});A.displayName="DateTimeCalendar";const R=B=>({container:(0,t.css)({padding:B.spacing(1),border:`1px ${B.colors.border.weak} solid`,borderRadius:B.shape.radius.default,backgroundColor:B.colors.background.primary,zIndex:B.zIndex.modal}),fullScreen:(0,t.css)({position:"absolute"}),time:(0,t.css)({marginBottom:B.spacing(2)}),modal:(0,t.css)({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:B.zIndex.modal,maxWidth:"280px"}),clearIcon:(0,t.css)({cursor:"pointer"}),field:(0,t.css)({marginBottom:0,width:"100%"})})},5308:(G,I,e)=>{"use strict";e.d(I,{N:()=>A});var t=e(32196),n=e(34743),s=e(36376),r=e(7315),o=e(18828),m=e(85690),l=e(93225),i=e(96540),u=e(40845),d=e(76412),p=e(55852),c=e(40276),y=e(88575),f=e(14578),P=e(10354),a=e(56034),E=e(42617),g=e(11752),h=e(32432);const D=/^now$|^now\-(\d{1,10})([wdhms])$/,v=N=>({from:O(N.from),to:O(N.to)}),C=N=>{const w=b(N.from),L=b(N.to);return{from:w,to:L,display:`${w} to ${L}`}},T=(N,w=Date.now())=>S(N)?O(N)>Math.ceil(w/1e3)?{isValid:!1,errorMessage:"Can not enter value prior to January 1, 1970."}:{isValid:!0}:{isValid:!1,errorMessage:"Value not in relative time format."},S=N=>D.test(N),O=N=>{const w=D.exec(N);if(!w||w.length!==3)return 0;const[,L,V]=w,K=parseInt(L,10);return isNaN(K)?0:K*x[V]},x={w:604800,d:86400,h:3600,m:60,s:1},b=N=>N<=0?"now":N>=x.w&&N%x.w===0?`now-${N/x.w}w`:N>=x.d&&N%x.d===0?`now-${N/x.d}d`:N>=x.h&&N%x.h===0?`now-${N/x.h}h`:N>=x.m&&N%x.m===0?`now-${N/x.m}m`:`now-${N}s`,M=h.o.filter(N=>S(N.from));function A(N){const{timeRange:w,onChange:L}=N,[V,K]=(0,i.useState)(!1),k=(0,i.useCallback)(()=>K(!1),[]),j=C(w),[H,J]=(0,i.useState)({value:j.from,validation:T(j.from)}),[X,se]=(0,i.useState)({value:j.to,validation:T(j.to)}),ae=(0,i.useRef)(null),{overlayProps:ne,underlayProps:q}=(0,l.e)({onClose:()=>K(!1),isDismissable:!0,isOpen:V},ae),{dialogProps:ee}=(0,o.s)({},ae),z=[(0,n.UU)({crossAxis:!1,boundary:document.body}),(0,n.BN)()],{context:te,refs:ie,floatingStyles:ce}=(0,s.we)({open:V,placement:"bottom-start",onOpenChange:K,middleware:z,whileElementsMounted:r.ll,strategy:"fixed"}),ue=(0,s.kp)(te),fe=(0,s.s9)(te),{getReferenceProps:Te,getFloatingProps:he}=(0,s.bv)([fe,ue]),de=(0,u.of)(U(H.validation.errorMessage,X.validation.errorMessage)),le=be=>{const Oe=v(be);Oe&&(k(),J({...H,value:be.from}),se({...X,value:be.to}),L(Oe))},pe=(0,i.useCallback)(be=>{be.stopPropagation(),be.preventDefault(),K(!V)},[V]),ve=be=>{if(be.preventDefault(),!X.validation.isValid||!H.validation.isValid)return;const Oe=v({from:H.value,to:X.value,display:""});Oe&&(L(Oe),K(!1))};return i.createElement("div",{className:de.container},i.createElement("button",{ref:ie.setReference,className:de.pickerInput,type:"button",onClick:pe,...Te()},i.createElement("span",{className:de.clockIcon},i.createElement(f.I,{name:"clock-nine"})),i.createElement("span",null,j.from," to ",j.to),i.createElement("span",{className:de.caretIcon},i.createElement(f.I,{name:V?"angle-up":"angle-down",size:"lg"}))),V&&i.createElement("div",null,i.createElement("div",{role:"presentation",className:de.backdrop,...q}),i.createElement(m.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},i.createElement("div",{ref:ae,...ne,...ee},i.createElement("div",{className:de.content,ref:ie.setFloating,style:ce,...he()},i.createElement("div",{className:de.body},i.createElement(c.A,{className:de.leftSide,hideHorizontalTrack:!0},i.createElement(g.l,{title:(0,d.t)("time-picker.time-range.example-title","Example time ranges"),options:M,onChange:le,value:j})),i.createElement("div",{className:de.rightSide},i.createElement("div",{className:de.title},i.createElement(E.e,null,i.createElement(a.m,{content:i.createElement(R,null),placement:"bottom",theme:"info"},i.createElement("div",null,i.createElement(d.x,{i18nKey:"time-picker.time-range.specify"},"Specify time range ",i.createElement(f.I,{name:"info-circle"})))))),i.createElement(y.D,{label:"From",invalid:!H.validation.isValid,error:H.validation.errorMessage},i.createElement(P.p,{onClick:be=>be.stopPropagation(),onBlur:()=>J({...H,validation:T(H.value)}),onChange:be=>J({...H,value:be.currentTarget.value}),value:H.value})),i.createElement(y.D,{label:"To",invalid:!X.validation.isValid,error:X.validation.errorMessage},i.createElement(P.p,{onClick:be=>be.stopPropagation(),onBlur:()=>se({...X,validation:T(X.value)}),onChange:be=>se({...X,value:be.currentTarget.value}),value:X.value})),i.createElement(p.$n,{"aria-label":"TimePicker submit button",onClick:ve},"Apply time range"))))))))}const R=()=>{const N=(0,u.of)(B);return i.createElement(i.Fragment,null,i.createElement("div",{className:N.supported},"Supported formats: ",i.createElement("code",{className:N.tooltip},"now-[digit]s/m/h/d/w")),i.createElement("div",null,"Example: to select a time range from 10 minutes ago to now"),i.createElement("code",{className:N.tooltip},"From: now-10m To: now"),i.createElement("div",{className:N.link},"For more information see"," ",i.createElement("a",{href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls/"},"docs ",i.createElement(f.I,{name:"external-link-alt"})),"."))},B=N=>({supported:(0,t.css)({marginBottom:N.spacing(1)}),tooltip:(0,t.css)({margin:0}),link:(0,t.css)({marginTop:N.spacing(1)})}),U=(N,w)=>L=>{const V=(0,P.n)({theme:L,invalid:!1}),k=250+W(L,N)+W(L,w);return{backdrop:(0,t.css)({position:"fixed",zIndex:L.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0}),container:(0,t.css)({display:"flex",position:"relative"}),pickerInput:(0,t.cx)(V.input,V.wrapper,(0,t.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,paddingLeft:0,lineHeight:`${L.spacing.gridSize*L.components.height.md-2}px`})),caretIcon:(0,t.cx)(V.suffix,(0,t.css)({position:"relative",marginLeft:L.spacing(.5)})),clockIcon:(0,t.cx)(V.prefix,(0,t.css)({position:"relative",marginRight:L.spacing(.5)})),content:(0,t.css)({background:L.colors.background.primary,boxShadow:L.shadows.z3,position:"absolute",zIndex:L.zIndex.modal,width:"500px",top:"100%",borderRadius:L.shape.radius.default,border:`1px solid ${L.colors.border.weak}`,left:0,whiteSpace:"normal"}),body:(0,t.css)({display:"flex",height:`${k}px`}),description:(0,t.css)({color:L.colors.text.secondary,fontSize:L.typography.size.sm}),leftSide:(0,t.css)({width:"50% !important",borderRight:`1px solid ${L.colors.border.medium}`}),rightSide:(0,t.css)({width:"50%",padding:L.spacing(1)}),title:(0,t.css)({marginBottom:L.spacing(1)})}};function W(N,w){return w?w.length>34?N.spacing.gridSize*6.5:N.spacing.gridSize*4:0}},66070:(G,I,e)=>{"use strict";e.d(I,{R:()=>p,i:()=>d});var t=e(32196),n=e(57389),s=e(96540),r=e(47232),o=e(40845),m=e(16797),l=e(87266),i=e(14578),u=e(78537);const d="time-of-day-picker-panel",p=({minuteStep:f=1,showHour:P=!0,showSeconds:a=!1,onChange:E,value:g,size:h="auto",disabled:D,disabledHours:v,disabledMinutes:C,disabledSeconds:T})=>{const S=(0,o.of)(y);return s.createElement(n.A,{className:(0,t.cx)((0,l.lH)()[h],S.input),popupClassName:(0,t.cx)(S.picker,d),defaultValue:(0,r.AN)(),onChange:O=>{if((0,r.u8)(O))return E((0,r.KQ)(O))},allowEmpty:!1,showSecond:a,value:(0,r.AN)(g),showHour:P,minuteStep:f,inputIcon:s.createElement(c,{wrapperStyle:S.caretWrapper}),disabled:D,disabledHours:v,disabledMinutes:C,disabledSeconds:T})},c=({wrapperStyle:f=""})=>s.createElement("div",{className:f},s.createElement(i.I,{name:"angle-down"})),y=f=>{const P=f.components.input.background,a=f.v1.palette.black,E=f.colors.background.secondary,g=f.shape.radius.default,h=f.components.input.borderColor;return{caretWrapper:(0,t.css)({position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",display:"inline-block",textAlign:"right",color:f.colors.text.secondary}),picker:(0,t.css)({".rc-time-picker-panel-select":{fontSize:"14px",backgroundColor:P,color:f.colors.text.secondary,borderColor:h,li:{outlineWidth:"2px","&.rc-time-picker-panel-select-option-selected":{backgroundColor:"inherit",border:`1px solid ${f.v1.palette.orange}`,borderRadius:g,color:f.colors.text.primary},"&:hover":{background:E,color:f.colors.text.primary},"&.rc-time-picker-panel-select-option-disabled":{color:f.colors.action.disabledText}}},".rc-time-picker-panel-inner":{boxShadow:`0px 4px 4px ${a}`,backgroundColor:P,borderColor:h,borderRadius:g,marginTop:"3px",".rc-time-picker-panel-input-wrap":{marginRight:"2px","&, .rc-time-picker-panel-input":{backgroundColor:P,paddingTop:"2px"}},".rc-time-picker-panel-combobox":{display:"flex"}}}),input:(0,t.css)({".rc-time-picker-input":{backgroundColor:P,borderRadius:g,borderColor:h,color:f.colors.text.primary,height:f.spacing(4),"&:focus":(0,m.getFocusStyles)(f),"&:disabled":{backgroundColor:f.colors.action.disabledBackground,color:f.colors.action.disabledText,border:`1px solid ${f.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}}})}}},54230:(G,I,e)=>{"use strict";e.d(I,{b:()=>P});var t=e(32196),n=e(96540),s=e(47232),r=e(43127),o=e(13544),m=e(40845),l=e(8866),i=e(14578),u=e(10354),d=e(85068),p=e(3799),c=e(32432),y=e(47619);const f=()=>{},P=({value:E,onChange:g,onChangeTimeZone:h=f,clearable:D,hideTimeZone:v=!0,timeZone:C="browser",placeholder:T="Select time range",isReversed:S=!0,hideQuickRanges:O=!1,disabled:x=!1,showIcon:b=!1})=>{const[M,A]=(0,n.useState)(!1),R=(0,m.of)(a,x),B=w=>{w.stopPropagation(),w.preventDefault(),!x&&A(!M)},U=()=>{A(!1)},W=w=>{U(),g(w)},N=w=>{w.stopPropagation();const L=(0,s.KQ)(null),V=(0,s.KQ)(null);g({from:L,to:V,raw:{from:L,to:V}})};return n.createElement("div",{className:R.container},n.createElement("button",{type:"button",className:R.pickerInput,"data-testid":o.Tp.components.TimePicker.openButton,onClick:B},b&&n.createElement(i.I,{name:"clock-nine",size:"sm",className:R.icon}),n.createElement(p.f,{value:E,timeZone:C,placeholder:T}),!x&&n.createElement("span",{className:R.caretIcon},(0,y.X)(E)&&D&&n.createElement(i.I,{className:R.clearIcon,name:"times",size:"lg",onClick:N}),n.createElement(i.I,{name:M?"angle-up":"angle-down",size:"lg"}))),M&&n.createElement(l.N,{includeButtonPress:!1,onClick:U},n.createElement(d.r,{timeZone:C,value:(0,y.X)(E)?E:(0,r.E2)(),onChange:W,quickOptions:c.o,onChangeTimeZone:h,className:R.content,hideTimeZone:v,isReversed:S,hideQuickRanges:O})))},a=(E,g=!1)=>{const h=(0,u.n)({theme:E,invalid:!1});return{container:(0,t.css)({display:"flex",position:"relative"}),content:(0,t.css)({marginLeft:0,position:"absolute",top:"116%",zIndex:E.zIndex.dropdown}),pickerInput:(0,t.cx)(h.input,g&&h.inputDisabled,h.wrapper,(0,t.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,lineHeight:`${E.spacing.gridSize*4-2}px`})),caretIcon:(0,t.cx)(h.suffix,(0,t.css)({position:"relative",top:"-1px",marginLeft:E.spacing(.5)})),clearIcon:(0,t.css)({marginRight:E.spacing(.5),"&:hover":{color:E.colors.text.maxContrast}}),placeholder:(0,t.css)({color:E.colors.text.disabled,opacity:1}),icon:(0,t.css)({marginRight:E.spacing(.5)})}}},15666:(G,I,e)=>{"use strict";e.d(I,{$6:()=>h,_8:()=>C,xS:()=>v});var t=e(32196),n=e(18828),s=e(85690),r=e(93225),o=e(96540),m=e(65879),l=e(72724),i=e(91410),u=e(85858),d=e(13544),p=e(40845),c=e(76412),y=e(19727),f=e(88448),P=e(27746),a=e(56034),E=e(85068),g=e(32432);function h(x){const[b,M]=(0,o.useState)(!1),{value:A,onMoveBackward:R,onMoveForward:B,onZoom:U,onError:W,timeZone:N,fiscalYearStartMonth:w,timeSyncButton:L,isSynced:V,history:K,onChangeTimeZone:k,onChangeFiscalYearStartMonth:j,hideQuickRanges:H,widthOverride:J,isOnCanvas:X,onToolbarTimePickerClick:se}=x,ae=ve=>{x.onChange(ve),M(!1)};(0,o.useEffect)(()=>{b&&se&&se()},[b,se]);const ne=()=>{M(ve=>!ve)},q=()=>{M(!1)},ee=(0,o.createRef)(),z=(0,o.createRef)(),{overlayProps:te,underlayProps:ie}=(0,r.e)({onClose:q,isDismissable:!0,isOpen:b,shouldCloseOnInteractOutside:ve=>!z.current?.contains(ve)},ee),{dialogProps:ce}=(0,n.s)({},ee),ue=(0,p.of)(S),{modalBackdrop:fe}=(0,p.of)(f.o),Te=!m.isRelativeTime(A.raw.from)||!m.isRelativeTime(A.raw.to),he=V?"active":X?"canvas":"default",le=A?.to?.isBefore(A.from)?"exclamation-triangle":"clock-nine",pe=T(A,N);return o.createElement(y.e,{className:ue.container},Te&&o.createElement(P.I,{"aria-label":(0,c.t)("time-picker.range-picker.backwards-time-aria-label","Move time range backwards"),variant:he,onClick:R,icon:"angle-left",narrow:!0}),o.createElement(a.m,{ref:z,content:o.createElement(v,{timeRange:A,timeZone:N}),placement:"bottom",interactive:!0},o.createElement(P.I,{"data-testid":d.Tp.components.TimePicker.openButton,"aria-label":(0,c.t)("time-picker.range-picker.current-time-selected","Time range selected: {{currentTimeRange}}",{currentTimeRange:pe}),"aria-controls":"TimePickerContent",onClick:ne,icon:le,isOpen:b,variant:he},o.createElement(C,{...x}))),b&&o.createElement("div",{"data-testid":d.Tp.components.TimePicker.overlayContent},o.createElement("div",{role:"presentation",className:(0,t.cx)(fe,ue.backdrop),...ie}),o.createElement(s.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},o.createElement("section",{className:ue.content,ref:ee,...te,...ce},o.createElement(E.r,{timeZone:N,fiscalYearStartMonth:w,value:A,onChange:ae,quickOptions:g.o,history:K,showHistory:!0,widthOverride:J,onChangeTimeZone:k,onChangeFiscalYearStartMonth:j,hideQuickRanges:H,onError:W})))),L,Te&&o.createElement(P.I,{"aria-label":(0,c.t)("time-picker.range-picker.forwards-time-aria-label","Move time range forwards"),onClick:B,icon:"angle-right",narrow:!0,variant:he}),o.createElement(a.m,{content:D,placement:"bottom"},o.createElement(P.I,{"aria-label":(0,c.t)("time-picker.range-picker.zoom-out-button","Zoom out time range"),onClick:U,icon:"search-minus",variant:he})))}h.displayName="TimeRangePicker";const D=()=>o.createElement(o.Fragment,null,o.createElement(c.x,{i18nKey:"time-picker.range-picker.zoom-out-tooltip"},"Time range zoom out ",o.createElement("br",null)," CTRL+Z")),v=({timeRange:x,timeZone:b})=>{const M=(0,p.of)(O);return o.createElement(o.Fragment,null,(0,l.LE)(x.from,{timeZone:b}),o.createElement("div",{className:"text-center"},o.createElement(c.x,{i18nKey:"time-picker.range-picker.to"},"to")),(0,l.LE)(x.to,{timeZone:b}),o.createElement("div",{className:"text-center"},o.createElement("span",{className:M.utc},(0,i.le)(b))))},C=(0,o.memo)(({hideText:x,value:b,timeZone:M})=>{const A=(0,p.of)(O);return x?null:o.createElement("span",{className:A.container,"aria-live":"polite","aria-atomic":"true"},o.createElement("span",null,T(b,M)),o.createElement("span",{className:A.utc},m.describeTimeRangeAbbreviation(b,M)))});C.displayName="TimePickerButtonLabel";const T=(x,b)=>{const M={to:u.isMathString(x.raw.to)?x.raw.to:x.to,from:u.isMathString(x.raw.from)?x.raw.from:x.from};return m.describeTimeRange(M,b)},S=x=>({container:(0,t.css)({position:"relative",display:"flex",verticalAlign:"middle"}),backdrop:(0,t.css)({display:"none",[x.breakpoints.down("sm")]:{display:"block"}}),content:(0,t.css)({position:"absolute",right:0,top:"116%",zIndex:x.zIndex.dropdown,[x.breakpoints.down("sm")]:{position:"fixed",right:"50%",top:"50%",transform:"translate(50%, -50%)",zIndex:x.zIndex.modal}})}),O=x=>({container:(0,t.css)({display:"flex",alignItems:"center",whiteSpace:"nowrap"}),utc:(0,t.css)({color:x.v1.palette.orange,fontSize:x.typography.size.sm,paddingLeft:"6px",lineHeight:"28px",verticalAlign:"bottom",fontWeight:x.typography.fontWeightMedium})})},72265:(G,I,e)=>{"use strict";e.d(I,{h2:()=>c,nB:()=>i});var t=e(32196),n=e(96540),s=e(29426),r=e(53531),o=e(40845),m=e(14578),l=e(99225);function i({onChange:y,from:f,to:P,timeZone:a}){const E=u(f,P,new Date,a),g=d(y,a),h=(0,o.of)(c);return n.createElement(s.Ay,{selectRange:!0,next2Label:null,prev2Label:null,className:h.body,tileClassName:h.title,value:E,nextLabel:n.createElement(m.I,{name:"angle-right"}),prevLabel:n.createElement(m.I,{name:"angle-left"}),onChange:g,locale:"en"})}i.displayName="Body";function u(y,f,P=new Date,a){let E=y.isValid()?y.toDate():P,g=f.isValid()?f.toDate():P;return a&&(E=(0,l.Q)(E,a),g=(0,l.Q)(g,a)),E>g?[g,E]:[E,g]}function d(y,f){return(0,n.useCallback)(P=>{if(!Array.isArray(P))return console.error("onCalendarChange: should be run in selectRange={true}");if(P[0]&&P[1]){const a=(0,r.b)(p(P[0]),{timeZone:f}),E=(0,r.b)(p(P[1]),{timeZone:f});y(a,E)}},[y,f])}function p(y){return[y.getFullYear(),y.getMonth(),y.getDate(),y.getHours(),y.getMinutes(),y.getSeconds()]}const c=y=>{const f=".react-calendar__tile--hasActive:not(.react-calendar__tile--range)";return{title:(0,t.css)({color:y.colors.text.primary,backgroundColor:y.colors.background.primary,fontSize:y.typography.size.md,border:"1px solid transparent","&:hover":{position:"relative"},"&:disabled":{color:y.colors.action.disabledText}}),body:(0,t.css)({zIndex:y.zIndex.modal,backgroundColor:y.colors.background.primary,width:"268px",".react-calendar__navigation":{display:"flex"},".react-calendar__navigation__label, .react-calendar__navigation__arrow, .react-calendar__navigation":{paddingTop:"4px",backgroundColor:"inherit",color:y.colors.text.primary,border:0,fontWeight:y.typography.fontWeightMedium},".react-calendar__month-view__weekdays":{backgroundColor:"inherit",textAlign:"center",color:y.colors.primary.text,abbr:{border:0,textDecoration:"none",cursor:"default",display:"block",padding:"4px 0 4px 0"}},".react-calendar__month-view__days":{backgroundColor:"inherit"},".react-calendar__tile, .react-calendar__tile--now":{marginBottom:"4px",backgroundColor:"inherit",height:"26px"},".react-calendar__navigation__label, .react-calendar__navigation > button:focus, .time-picker-calendar-tile:focus":{outline:0},[`${f}, .react-calendar__tile--active, .react-calendar__tile--active:hover`]:{color:y.colors.primary.contrastText,fontWeight:y.typography.fontWeightMedium,background:y.colors.primary.main,boxShadow:"none",border:"0px"},".react-calendar__tile--rangeEnd, .react-calendar__tile--rangeStart":{padding:0,border:"0px",color:y.colors.primary.contrastText,fontWeight:y.typography.fontWeightMedium,background:y.colors.primary.main,abbr:{backgroundColor:y.colors.primary.main,borderRadius:"100px",display:"block",paddingTop:"2px",height:"26px"}},[`${f}, .react-calendar__tile--rangeStart`]:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px"},[`${f}, .react-calendar__tile--rangeEnd`]:{borderTopRightRadius:"20px",borderBottomRightRadius:"20px"}})}}},85068:(G,I,e)=>{"use strict";e.d(I,{r:()=>ue});var t=e(32196),n=e(96540),s=e(47232),r=e(65879),o=e(13544),m=e(40845),l=e(16797),i=e(76412),u=e(67647),d=e(14578),p=e(2543),c=e(91410),y=e(55852),f=e(88575),P=e(94354),a=e(21594),E=e(20333),g=e(79451),h=e(17624),D=e(67459),v=e(32432);const C=Me=>{const{timeZone:Ue,fiscalYearStartMonth:we,timestamp:Re=Date.now(),onChangeTimeZone:Fe,onChangeFiscalYearStartMonth:xe}=Me,[Ve,$e]=(0,n.useState)(!1),[Xe,gt]=(0,n.useState)("tz"),Dt=(0,n.useCallback)(Ae=>{Ae&&Ae.stopPropagation(),$e(!Ve)},[Ve,$e]),nt=(0,m.of)(T);if(!(0,p.isString)(Ue))return null;const at=(0,c.QZ)(Ue,Re);return at?n.createElement("div",null,n.createElement("section",{"aria-label":(0,i.t)("time-picker.footer.time-zone-selection","Time zone selection"),className:nt.container},n.createElement("div",{className:nt.timeZoneContainer},n.createElement("div",{className:nt.timeZone},n.createElement(D.U,{title:at.name}),n.createElement("div",{className:nt.spacer}),n.createElement(g.E,{info:at})),n.createElement(h.X,{timeZone:Ue,timestamp:Re})),n.createElement("div",{className:nt.spacer}),n.createElement(y.$n,{"data-testid":o.Tp.components.TimeZonePicker.changeTimeSettingsButton,variant:"secondary",onClick:Dt,size:"sm"},n.createElement(i.x,{i18nKey:"time-picker.footer.change-settings-button"},"Change time settings"))),Ve?n.createElement("div",{className:nt.editContainer},n.createElement("div",null,n.createElement(P.z,{value:Xe,options:[{label:(0,i.t)("time-picker.footer.time-zone-option","Time zone"),value:"tz"},{label:(0,i.t)("time-picker.footer.fiscal-year-option","Fiscal year"),value:"fy"}],onChange:gt})),Xe==="tz"?n.createElement("section",{"data-testid":o.Tp.components.TimeZonePicker.containerV2,className:(0,t.cx)(nt.timeZoneContainer,nt.timeSettingContainer)},n.createElement(E.U,{includeInternal:!0,onChange:Ae=>{Dt(),(0,p.isString)(Ae)&&Fe(Ae)},onBlur:Dt,menuShouldPortal:!1})):n.createElement("section",{"data-testid":o.Tp.components.TimeZonePicker.containerV2,className:(0,t.cx)(nt.timeZoneContainer,nt.timeSettingContainer)},n.createElement(f.D,{className:nt.fiscalYearField,label:(0,i.t)("time-picker.footer.fiscal-year-start","Fiscal year start month")},n.createElement(a.l6,{value:we,menuShouldPortal:!1,options:v.Z,onChange:Ae=>{xe&&xe(Ae.value??0)}})))):null):null},T=Me=>({container:(0,t.css)({borderTop:`1px solid ${Me.colors.border.weak}`,padding:"11px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),editContainer:(0,t.css)({borderTop:`1px solid ${Me.colors.border.weak}`,padding:"11px",justifyContent:"space-between",alignItems:"center"}),spacer:(0,t.css)({marginLeft:"7px"}),timeSettingContainer:(0,t.css)({paddingTop:Me.spacing(1)}),fiscalYearField:(0,t.css)({marginBottom:0}),timeZoneContainer:(0,t.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1}),timeZone:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"baseline",flexGrow:1})});var S=e(42617),O=e(53531),x=e(72724),b=e(10354),M=e(56034),A=e(47619),R=e(18828),B=e(85690),U=e(93225),W=e(59875),N=e(88448),w=e(72265),L=e(67061);function V({onClose:Me,onApply:Ue}){return n.createElement(L.B,{gap:2,justifyContent:"space-between"},n.createElement(y.$n,{variant:"secondary",onClick:Me},n.createElement(i.x,{i18nKey:"time-picker.calendar.cancel-button"},"Cancel")),n.createElement(y.$n,{onClick:Ue},n.createElement(i.x,{i18nKey:"time-picker.calendar.apply-button"},"Apply time range")))}V.displayName="Footer";var K=e(29158);function k({onClose:Me}){return n.createElement(L.B,{justifyContent:"space-between"},n.createElement(S.e,null,n.createElement(i.x,{i18nKey:"time-picker.calendar.select-time"},"Select a time range")),n.createElement(K.K,{"data-testid":o.Tp.components.TimePicker.calendar.closeButton,tooltip:(0,i.t)("time-picker.calendar.close","Close calendar"),name:"times",variant:"secondary",onClick:Me}))}k.displayName="Header";const j=(Me,Ue=!1)=>({container:(0,t.css)({top:0,position:"absolute",[`${Ue?"left":"right"}`]:"546px"}),modalContainer:(0,t.css)({label:"modalContainer",margin:"0 auto"}),calendar:(0,t.css)({display:"flex",flexDirection:"column",gap:Me.spacing(1),padding:Me.spacing(1),label:"calendar",boxShadow:Me.shadows.z3,backgroundColor:Me.colors.background.primary,border:`1px solid ${Me.colors.border.weak}`,borderRadius:Me.shape.radius.default}),modal:(0,t.css)({label:"modal",boxShadow:Me.shadows.z3,left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)",zIndex:Me.zIndex.modal})});function H(Me){const Ue=(0,m.$j)(),{modalBackdrop:we}=(0,m.of)(N.o),Re=j(Ue,Me.isReversed),{isOpen:Fe,isFullscreen:xe,onClose:Ve}=Me,$e=n.createRef(),{dialogProps:Xe}=(0,R.s)({"aria-label":o.Tp.components.TimePicker.calendar.label},$e),{overlayProps:gt}=(0,U.e)({isDismissable:!0,isOpen:Fe,onClose:Ve},$e),Dt=!xe;if(!Fe)return null;const nt=n.createElement("section",{className:Re.calendar,ref:$e,...gt,...Xe,"data-testid":o.Tp.components.TimePicker.calendar.label},n.createElement(k,{...Me}),n.createElement(w.nB,{...Me}),Dt&&n.createElement(V,{...Me}));return Dt?n.createElement(W.Sf,null,n.createElement("div",{className:we}),n.createElement(B.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},n.createElement("div",{className:Re.modal},n.createElement("div",{className:Re.modalContainer},nt)))):n.createElement(B.n1,{contain:!0,restoreFocus:!0,autoFocus:!0},n.createElement("div",{className:Re.container},nt))}const J=(0,n.memo)(H);H.displayName="TimePickerCalendar";const X={default:()=>(0,i.t)("time-picker.range-content.default-error",'Please enter a past date or "now"'),range:()=>(0,i.t)("time-picker.range-content.range-error",`"From" can't be after "To"`)},se=Me=>{const{value:Ue,isFullscreen:we=!1,timeZone:Re,onApply:Fe,isReversed:xe,fiscalYearStartMonth:Ve,onError:$e}=Me,[Xe,gt]=ne(Ue.raw.from,Ue.raw.to,Re),Dt=(0,m.of)(ee),[nt,at]=(0,n.useState)(Xe),[Ae,re]=(0,n.useState)(gt),[Z,oe]=(0,n.useState)(!1),Ee=(0,n.useId)(),ye=(0,n.useId)();(0,n.useEffect)(()=>{const[bt,Ft]=ne(Ue.raw.from,Ue.raw.to,Re);at(bt),re(Ft)},[Ue.raw.from,Ue.raw.to,Re]);const Se=(0,n.useCallback)(bt=>{bt.preventDefault(),oe(!0)},[oe]),Be=(0,n.useCallback)(()=>{if(Ae.invalid||nt.invalid)return;const bt={from:nt.value,to:Ae.value},Ft=r.convertRawToRange(bt,Re,Ve);Fe(Ft)},[nt.invalid,nt.value,Fe,Re,Ae.invalid,Ae.value,Ve]),We=(0,n.useCallback)((bt,Ft)=>{const[Xt,Lt]=ne(bt,Ft,Re);at(Xt),re(Lt)},[Re]),Ke=bt=>{bt.key==="Enter"&&Be()},it=()=>{const bt={from:nt.value,to:Ae.value};navigator.clipboard.writeText(JSON.stringify(bt))},rt=async()=>{const bt=await navigator.clipboard.readText();let Ft;try{Ft=JSON.parse(bt)}catch{$e&&$e(bt);return}const[Xt,Lt]=ne(Ft.from,Ft.to,Re);at(Xt),re(Lt)},ft=r.convertRawToRange({from:"now/fy",to:"now/fy"},Re,Ve),pt=(0,i.t)("time-picker.range-content.fiscal-year","Fiscal year"),Ge=n.createElement("div",{className:Dt.tooltip},r.isFiscal(Ue)?n.createElement(M.m,{content:`${pt}: ${ft.from.format("MMM-DD")} - ${ft.to.format("MMM-DD")}`},n.createElement(d.I,{name:"info-circle"})):null),qe=n.createElement(y.$n,{"aria-label":(0,i.t)("time-picker.range-content.open-input-calendar","Open calendar"),"data-testid":o.Tp.components.TimePicker.calendar.openButton,icon:"calendar-alt",variant:"secondary",type:"button",onClick:Se});return n.createElement("div",null,n.createElement("div",{className:Dt.fieldContainer},n.createElement(f.D,{label:(0,i.t)("time-picker.range-content.from-input","From"),invalid:nt.invalid,error:nt.errorMessage},n.createElement(b.p,{id:Ee,onClick:bt=>bt.stopPropagation(),onChange:bt=>We(bt.currentTarget.value,Ae.value),addonAfter:qe,onKeyDown:Ke,"data-testid":o.Tp.components.TimePicker.fromField,value:nt.value})),Ge),n.createElement("div",{className:Dt.fieldContainer},n.createElement(f.D,{label:(0,i.t)("time-picker.range-content.to-input","To"),invalid:Ae.invalid,error:Ae.errorMessage},n.createElement(b.p,{id:ye,onClick:bt=>bt.stopPropagation(),onChange:bt=>We(nt.value,bt.currentTarget.value),addonAfter:qe,onKeyDown:Ke,"data-testid":o.Tp.components.TimePicker.toField,value:Ae.value})),Ge),n.createElement("div",{className:Dt.buttonsContainer},n.createElement(y.$n,{"data-testid":o.Tp.components.TimePicker.copyTimeRange,icon:"copy",variant:"secondary",tooltip:(0,i.t)("time-picker.copy-paste.tooltip-copy","Copy time range to clipboard"),type:"button",onClick:it}),n.createElement(y.$n,{"data-testid":o.Tp.components.TimePicker.pasteTimeRange,icon:"clipboard-alt",variant:"secondary",tooltip:(0,i.t)("time-picker.copy-paste.tooltip-paste","Paste time range"),type:"button",onClick:rt}),n.createElement(y.$n,{"data-testid":o.Tp.components.TimePicker.applyTimeRange,type:"button",onClick:Be},n.createElement(i.x,{i18nKey:"time-picker.range-content.apply-button"},"Apply time range"))),n.createElement(J,{isFullscreen:we,isOpen:Z,from:(0,O.b)(nt.value,{timeZone:Re}),to:(0,O.b)(Ae.value,{timeZone:Re}),onApply:Be,onClose:()=>oe(!1),onChange:We,timeZone:Re,isReversed:xe}))};function ae(Me,Ue,we){const Re={from:Me,to:Ue},Fe=r.convertRawToRange(Re,we);return!(Fe.from.isSame(Fe.to)||Fe.from.isBefore(Fe.to))}function ne(Me,Ue,we){const Re=q(Me,we),Fe=q(Ue,we),xe=!(0,A.f)(Re,!1,we),Ve=!(0,A.f)(Fe,!0,we),$e=ae(Re,Fe,we)&&!Ve;return[{value:Re,invalid:xe||$e,errorMessage:$e&&!xe?X.range():X.default()},{value:Fe,invalid:Ve,errorMessage:X.default()}]}function q(Me,Ue){return(0,s.Ar)(Me)?(0,x.LE)(Me,{timeZone:Ue}):Me}function ee(Me){return{fieldContainer:(0,t.css)({display:"flex"}),buttonsContainer:(0,t.css)({display:"flex",gap:Me.spacing(.5),marginTop:Me.spacing(1)}),tooltip:(0,t.css)({paddingLeft:Me.spacing(1),paddingTop:Me.spacing(3)})}}var z=e(11752);const te=(Me,Ue)=>r.convertRawToRange({from:Me.from,to:Me.to},Ue),ie=(Me,Ue)=>{const we=(0,x.LE)(Me.from,{timeZone:Ue}),Re=(0,x.LE)(Me.to,{timeZone:Ue});return{from:we,to:Re,display:`${we} to ${Re}`}},ce=Me=>{const{quickOptions:Ue=[],isReversed:we,isFullscreen:Re,hideQuickRanges:Fe,timeZone:xe,fiscalYearStartMonth:Ve,value:$e,onChange:Xe,history:gt,showHistory:Dt,className:nt,hideTimeZone:at,onChangeTimeZone:Ae,onChangeFiscalYearStartMonth:re}=Me,Z=!gt?.length,oe=Re&&Dt||!Re&&(Dt&&!Z||!Fe),Ee=(0,m.of)(pe,we,Fe,oe,Re),ye=de(gt,xe),Se=le($e.raw,Ue),[Be,We]=(0,n.useState)(""),Ke=Ue.filter(rt=>rt.display.toLowerCase().includes(Be.toLowerCase())),it=rt=>Xe(te(rt));return n.createElement("div",{id:"TimePickerContent",className:(0,t.cx)(Ee.container,nt)},n.createElement("div",{className:Ee.body},(!Re||!Fe)&&n.createElement("div",{className:Ee.rightSide},n.createElement("div",{className:Ee.timeRangeFilter},n.createElement(u.Z,{width:0,value:Be,onChange:We,placeholder:(0,i.t)("time-picker.content.filter-placeholder","Search quick ranges")})),n.createElement("div",{className:Ee.scrollContent},!Re&&n.createElement(fe,{...Me,historyOptions:ye}),!Fe&&n.createElement(z.l,{options:Ke,onChange:it,value:Se}))),Re&&n.createElement("div",{className:Ee.leftSide},n.createElement(Te,{...Me,historyOptions:ye}))),!at&&Re&&n.createElement(C,{timeZone:xe,fiscalYearStartMonth:Ve,onChangeTimeZone:Ae,onChangeFiscalYearStartMonth:re}))},ue=Me=>{const{widthOverride:Ue}=Me,we=(0,m.$j)(),Re=(Ue||window.innerWidth)>=we.breakpoints.values.lg;return n.createElement(ce,{...Me,isFullscreen:Re})},fe=Me=>{const{value:Ue,hideQuickRanges:we,onChange:Re,timeZone:Fe,historyOptions:xe=[],showHistory:Ve,onError:$e}=Me,Xe=(0,m.of)(ve),gt=(0,s.Ar)(Ue.raw.from)||(0,s.Ar)(Ue.raw.to),[Dt,nt]=(0,n.useState)(!gt),at=we?!1:Dt,Ae=re=>Re(te(re,Fe));return n.createElement("fieldset",null,n.createElement("div",{className:Xe.header},n.createElement("button",{type:"button",className:Xe.expandButton,onClick:()=>{we||nt(!at)},"data-testid":o.Tp.components.TimePicker.absoluteTimeRangeTitle,"aria-expanded":!at,"aria-controls":"expanded-timerange"},n.createElement(S.e,null,n.createElement(i.x,{i18nKey:"time-picker.absolute.title"},"Absolute time range")),!we&&n.createElement(d.I,{name:at?"angle-down":"angle-up"}))),!at&&n.createElement("div",{className:Xe.body,id:"expanded-timerange"},n.createElement("div",{className:Xe.form},n.createElement(se,{value:Ue,onApply:Re,timeZone:Fe,isFullscreen:!1,onError:$e})),Ve&&n.createElement(z.l,{title:(0,i.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:xe,onChange:Ae,placeholderEmpty:null})))},Te=Me=>{const{onChange:Ue,value:we,timeZone:Re,fiscalYearStartMonth:Fe,isReversed:xe,historyOptions:Ve,onError:$e}=Me,Xe=(0,m.of)(be,Me.hideQuickRanges),gt=Dt=>Ue(te(Dt,Re));return n.createElement(n.Fragment,null,n.createElement("div",{className:Xe.container},n.createElement("div",{className:Xe.title,"data-testid":o.Tp.components.TimePicker.absoluteTimeRangeTitle},n.createElement(S.e,null,n.createElement(i.x,{i18nKey:"time-picker.absolute.title"},"Absolute time range"))),n.createElement(se,{value:we,timeZone:Re,fiscalYearStartMonth:Fe,onApply:Ue,isFullscreen:!0,isReversed:xe,onError:$e})),Me.showHistory&&n.createElement("div",{className:Xe.recent},n.createElement(z.l,{title:(0,i.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:Ve||[],onChange:gt,placeholderEmpty:n.createElement(he,null)})))},he=(0,n.memo)(()=>{const Me=(0,m.of)(Oe),Ue=(0,i.t)("time-picker.content.empty-recent-list-info","It looks like you haven't used this time picker before. As soon as you enter some time intervals, recently used intervals will appear here.");return n.createElement("div",{className:Me.container},n.createElement("div",null,n.createElement("span",null,Ue)),n.createElement(i.x,{i18nKey:"time-picker.content.empty-recent-list-docs"},n.createElement("div",null,n.createElement("a",{className:Me.link,href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls",target:"_new"},"Read the documentation"),n.createElement("span",null," to find out more about how to enter custom time ranges."))))});function de(Me,Ue){return!Array.isArray(Me)||Me.length===0?[]:Me.map(we=>ie(we,Ue))}he.displayName="EmptyRecentList";const le=(Me,Ue)=>(0,n.useMemo)(()=>{if(r.isRelativeTimeRange(Me))return Ue.find(we=>we.from===Me.from&&we.to===Me.to)},[Me,Ue]),pe=(Me,Ue,we,Re,Fe)=>({container:(0,t.css)({background:Me.colors.background.primary,boxShadow:Me.shadows.z3,width:`${Fe?"546px":"262px"}`,borderRadius:Me.shape.radius.default,border:`1px solid ${Me.colors.border.weak}`,[`${Ue?"left":"right"}`]:0,display:"flex",flexDirection:"column"}),body:(0,t.css)({display:"flex",flexDirection:"row-reverse",height:`${Re?"381px":"217px"}`,maxHeight:"100vh"}),leftSide:(0,t.css)({display:"flex",flexDirection:"column",borderRight:`${Ue?"none":`1px solid ${Me.colors.border.weak}`}`,width:`${we?"100%":"60%"}`,overflow:"auto",scrollbarWidth:"thin",order:Ue?1:0}),rightSide:(0,t.css)({width:`${Fe?"40%":"100%"}; !important`,borderRight:Ue?`1px solid ${Me.colors.border.weak}`:"none",display:"flex",flexDirection:"column"}),timeRangeFilter:(0,t.css)({padding:Me.spacing(1)}),spacing:(0,t.css)({marginTop:"16px"}),scrollContent:(0,t.css)({overflowY:"auto",scrollbarWidth:"thin"})}),ve=Me=>({header:(0,t.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${Me.colors.border.weak}`,padding:"7px 9px 7px 9px"}),expandButton:(0,t.css)({backgroundColor:"transparent",border:"none",display:"flex",width:"100%","&:focus-visible":(0,l.getFocusStyles)(Me)}),body:(0,t.css)({borderBottom:`1px solid ${Me.colors.border.weak}`}),form:(0,t.css)({padding:"7px 9px 7px 9px"})}),be=(Me,Ue)=>({container:(0,t.css)({paddingTop:"9px",paddingLeft:"11px",paddingRight:Ue?"11px":"20%"}),title:(0,t.css)({marginBottom:"11px"}),recent:(0,t.css)({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end",paddingTop:Me.spacing(1)})}),Oe=Me=>({container:(0,t.css)({padding:"12px",margin:"12px","a, span":{fontSize:"13px"}}),link:(0,t.css)({color:Me.colors.text.link})})},42617:(G,I,e)=>{"use strict";e.d(I,{e:()=>o});var t=e(32196),n=e(96540),s=e(40845);const r=m=>({text:(0,t.css)({fontSize:m.typography.size.md,fontWeight:m.typography.fontWeightMedium,color:m.colors.text.primary,margin:0,display:"flex"})}),o=(0,n.memo)(({children:m})=>{const l=(0,s.of)(r);return n.createElement("h3",{className:l.text},m)});o.displayName="TimePickerTitle"},3799:(G,I,e)=>{"use strict";e.d(I,{f:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(15666),o=e(47619);const m=(0,n.memo)(function({hideText:u,value:d,timeZone:p="browser",placeholder:c="No time range selected",className:y}){const f=(0,s.of)(l);return u?null:n.createElement("span",{className:y},(0,o.X)(d)?n.createElement(r._8,{value:d,timeZone:p}):n.createElement("span",{className:f.placeholder},c))}),l=i=>({placeholder:(0,t.css)({color:i.colors.text.disabled,opacity:1})})},11752:(G,I,e)=>{"use strict";e.d(I,{l:()=>y});var t=e(32196),n=e(96540),s=e(40845),r=e(76412),o=e(42617),m=e(62938),l=e(16797);const i=h=>({container:(0,t.css)({display:"flex",alignItems:"center",flexDirection:"row-reverse",justifyContent:"space-between"}),selected:(0,t.css)({background:h.colors.action.selected,fontWeight:h.typography.fontWeightMedium}),radio:(0,t.css)({opacity:0,width:"0 !important","&:focus-visible + label":(0,l.getFocusStyles)(h)}),label:(0,t.css)({cursor:"pointer",flex:1,padding:"7px 9px 7px 9px","&:hover":{background:h.colors.action.hover,cursor:"pointer"}})}),u=(0,n.memo)(({value:h,onSelect:D,selected:v=!1,name:C})=>{const T=(0,s.of)(i),S=(0,m.A)();return n.createElement("li",{className:(0,t.cx)(T.container,v&&T.selected)},n.createElement("input",{className:T.radio,checked:v,name:C,type:"checkbox","data-role":"item",tabIndex:-1,id:S,onChange:()=>D(h)}),n.createElement("label",{className:T.label,htmlFor:S},h.display))});u.displayName="TimeRangeOption";const d=(h,D)=>(h%D+D)%D,p=["ArrowUp","ArrowDown","Home","End","Enter","Tab"],c=({localRef:h,options:D})=>{const[v,C]=(0,n.useState)(0);return(0,n.useEffect)(()=>{const S=h.current?.querySelectorAll('[data-role="item"]')||[],O=Array.from(S).findIndex(b=>b.checked),x=O>=0?O:0;S.forEach((b,M)=>{b.tabIndex=M===x?0:-1}),C(x)},[h,D]),[S=>{const O=h?.current?.querySelectorAll('[data-role="item"]'),x=O?.length??0;p.indexOf(S.key)>-1&&(S.preventDefault(),S.key!=="Tab"&&S.stopPropagation());let b=null;switch(S.key){case"ArrowUp":b=d(v-1,x);break;case"ArrowDown":b=d(v+1,x);break;case"Home":b=0;break;case"End":b=x-1;break;case"Enter":O?.[v]?.click();break;default:break}b!==null&&(C(b),O?.[b]?.focus(),O?.forEach((M,A)=>{M.tabIndex=A===b?0:-1}))}]},y=h=>{const D=(0,s.of)(E),{title:v,options:C,placeholderEmpty:T}=h;return typeof T<"u"&&C.length<=0?n.createElement(n.Fragment,null,T):v?n.createElement("section",{"aria-label":v},n.createElement("fieldset",null,n.createElement("div",{className:D.title},n.createElement(o.e,null,v)),n.createElement(f,{...h}))):n.createElement(f,{...h})},f=({options:h,value:D,onChange:v,title:C})=>{const T=(0,s.of)(g),S=n.useRef(null),[O]=c({localRef:S,options:h});return n.createElement(n.Fragment,null,n.createElement("ul",{role:"presentation",onKeyDown:O,ref:S,"aria-roledescription":(0,r.t)("time-picker.time-range.aria-role","Time range selection")},h.map((x,b)=>n.createElement(u,{key:P(x,b),value:x,selected:a(x,D),onSelect:v,name:C??(0,r.t)("time-picker.time-range.default-title","Time ranges")}))),n.createElement("div",{className:T.grow}))};function P(h,D){return`${h.from}-${h.to}-${D}`}function a(h,D){return!D||!h?!1:D.from===h.from&&D.to===h.to}const E=()=>({title:(0,t.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px 5px 9px"})}),g=()=>({grow:(0,t.css)({flexGrow:1,alignItems:"flex-start"})})},20333:(G,I,e)=>{"use strict";e.d(I,{U:()=>h});var t=e(2543),n=e(96540),s=e(91410),r=e(76412),o=e(21594),m=e(32196),l=e(40845);const i=O=>{const{children:x,label:b}=O,M=(0,l.of)(u);return b?n.createElement("div",null,n.createElement("div",{className:M.header},n.createElement("span",{className:M.label},b)),x):n.createElement("div",null,x)},u=O=>({header:(0,m.css)({padding:"7px 10px",width:"100%",borderTop:`1px solid ${O.colors.border.weak}`,textTransform:"capitalize"}),label:(0,m.css)({fontSize:O.typography.size.sm,color:O.colors.text.secondary,fontWeight:O.typography.fontWeightMedium})});var d=e(17624),p=e(13544),c=e(14578),y=e(79451),f=e(67459);const P="tz-utc-offset",a=O=>{const{children:x,innerProps:b,innerRef:M,data:A,isSelected:R,isFocused:B}=O,U=(0,l.of)(g),W=Date.now(),N=(0,m.cx)(U.container,B&&U.containerFocused);if(!(0,t.isString)(A.value))return null;const w=(0,s.QZ)(A.value,W);return n.createElement("div",{className:N,...b,ref:M,"data-testid":p.Tp.components.Select.option},n.createElement("div",{className:(0,m.cx)(U.leftColumn,U.row)},n.createElement("div",{className:(0,m.cx)(U.leftColumn,U.wideRow)},n.createElement(f.U,{title:x}),n.createElement("div",{className:U.spacer}),n.createElement(y.E,{info:w})),n.createElement("div",{className:U.rightColumn},n.createElement(d.X,{timeZone:w?.ianaName||A.value,timestamp:W,className:P}),R&&n.createElement("span",null,n.createElement(c.I,{name:"check"})))))},E=O=>{const{children:x,innerProps:b,innerRef:M,data:A,isSelected:R,isFocused:B}=O,U=(0,l.of)(g),W=Date.now(),N=(0,m.cx)(U.container,B&&U.containerFocused);if(!(0,t.isString)(A.value))return null;const w=(0,s.QZ)(A.value,W);return n.createElement("div",{className:N,...b,ref:M,"data-testid":p.Tp.components.Select.option},n.createElement("div",{className:U.body},n.createElement("div",{className:U.row},n.createElement("div",{className:U.leftColumn},n.createElement(f.U,{title:x})),n.createElement("div",{className:U.rightColumn},R&&n.createElement("span",null,n.createElement(c.I,{name:"check"})))),n.createElement("div",{className:U.row},n.createElement("div",{className:U.leftColumn},n.createElement(y.E,{info:w})),n.createElement("div",{className:U.rightColumn},n.createElement(d.X,{timestamp:W,timeZone:w?.ianaName||A.value,className:P})))))},g=O=>({container:(0,m.css)({display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",padding:"6px 8px 4px","&:hover":{background:O.colors.action.hover}}),containerFocused:(0,m.css)({background:O.colors.action.hover}),body:(0,m.css)({display:"flex",fontWeight:O.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),row:(0,m.css)({display:"flex",flexDirection:"row"}),leftColumn:(0,m.css)({flexGrow:1,textOverflow:"ellipsis"}),rightColumn:(0,m.css)({justifyContent:"flex-end",alignItems:"center"}),wideRow:(0,m.css)({display:"flex",flexDirection:"row",alignItems:"baseline"}),spacer:(0,m.css)({marginLeft:"6px"})}),h=O=>{const{onChange:x,width:b,autoFocus:M=!1,onBlur:A,value:R,includeInternal:B=!1,disabled:U=!1,inputId:W,menuShouldPortal:N=!0,openMenuOnFocus:w=!0}=O,L=D(B),V=v(L,R),K=T(),k=b&&b<=45?E:a,j=(0,n.useCallback)(H=>{if(!H||!(0,t.isString)(H.value))return x(R);x(H.value)},[x,R]);return n.createElement(o.l6,{inputId:W,value:V,placeholder:(0,r.t)("time-picker.zone.select-search-input","Type to search (country, city, abbreviation)"),autoFocus:M,menuShouldPortal:N,openMenuOnFocus:w,width:b,filterOption:K,options:L,onChange:j,onBlur:A,components:{Option:k,Group:i},disabled:U,"aria-label":(0,r.t)("time-picker.zone.select-aria-label","Time zone picker")})},D=O=>{const x=Date.now();return(0,s.U3)(O).map(M=>{const A=M.zones.reduce((R,B)=>{const U=(0,s.QZ)(B,x);return U&&R.push({label:U.name,value:U.zone,searchIndex:S(U,x)}),R},[]);return{label:M.name,options:A}})},v=(O,x)=>(0,n.useMemo)(()=>{if(x===void 0)return;const b=(0,t.toLower)(x);return O.find(A=>A.label?b.startsWith((0,t.toLower)(A.label)):C(b))?.options.find(A=>(0,t.isEmpty)(b)?A.value===s.g$.default:(0,t.toLower)(A.value)===b)},[O,x]),C=O=>{switch(O){case s.g$.default:case s.g$.localBrowserTime:case s.g$.utc:return!0;default:return!1}},T=()=>(0,n.useCallback)((O,x)=>!x||!O.data||!O.data.searchIndex?!0:O.data.searchIndex.indexOf((0,t.toLower)(x))>-1,[]),S=(O,x)=>{const b=[(0,t.toLower)(O.name),(0,t.toLower)(O.abbreviation),(0,t.toLower)((0,d.t)(x,O.zone))];for(const M of O.countries)b.push((0,t.toLower)(M.name)),b.push((0,t.toLower)(M.code));return b.join("|")}},79451:(G,I,e)=>{"use strict";e.d(I,{E:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({info:l})=>{const i=(0,s.of)(m),u=o(l);return l?n.createElement("div",{className:i.description},u):null},o=l=>(0,n.useMemo)(()=>{const i=[];if(!l)return"";if(l.name==="Europe/Simferopol")return"Ukraine, EEST";if(l.countries.length>0){const u=l.countries[0];i.push(u.name)}return l.abbreviation&&i.push(l.abbreviation),i.join(", ")},[l]),m=l=>({description:(0,t.css)({fontWeight:"normal",fontSize:l.typography.size.sm,color:l.colors.text.secondary,whiteSpace:"normal",textOverflow:"ellipsis"})})},17624:(G,I,e)=>{"use strict";e.d(I,{X:()=>l,t:()=>i});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(72724),m=e(40845);const l=d=>{const{timestamp:p,timeZone:c,className:y}=d,f=(0,m.of)(u);return(0,n.isString)(c)?r.createElement(r.Fragment,null,r.createElement("span",{className:(0,t.cx)(f.offset,y)},i(p,c))):null},i=(d,p)=>`UTC${(0,o.LE)(d,{timeZone:p,format:"Z"})}`,u=d=>{const p=(0,t.css)({fontWeight:"normal",fontSize:d.typography.size.sm,color:d.colors.text.secondary,whiteSpace:"normal"});return{offset:(0,t.css)(p,{color:d.colors.text.primary,background:d.colors.background.secondary,padding:"2px 5px",borderRadius:d.shape.radius.default,marginLeft:"4px"})}}},67459:(G,I,e)=>{"use strict";e.d(I,{U:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({title:m})=>{const l=(0,s.of)(o);return m?n.createElement("span",{className:l.title},m):null},o=m=>({title:(0,t.css)({fontWeight:m.typography.fontWeightRegular,textOverflow:"ellipsis"})})},15648:(G,I,e)=>{"use strict";e.d(I,{l:()=>o});var t=e(96540),n=e(13544),s=e(21594);const r=[{value:"",label:"Default"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"},{value:"monday",label:"Monday"}],o=m=>{const{onChange:l,width:i,autoFocus:u=!1,onBlur:d,value:p,disabled:c=!1,inputId:y}=m,f=(0,t.useCallback)(P=>{P.value!==void 0&&l(P.value)},[l]);return t.createElement(s.l6,{inputId:y,value:r.find(P=>P.value===p)?.value,placeholder:n.Tp.components.WeekStartPicker.placeholder,autoFocus:u,openMenuOnFocus:!0,width:i,options:r,onChange:f,onBlur:d,disabled:c})}},32432:(G,I,e)=>{"use strict";e.d(I,{Z:()=>n,o:()=>t});const t=[{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],n=[{label:"January",value:0},{label:"February",value:1},{label:"March",value:2},{label:"April",value:3},{label:"May",value:4},{label:"June",value:5},{label:"July",value:6},{label:"August",value:7},{label:"September",value:8},{label:"October",value:9},{label:"November",value:10},{label:"December",value:11}]},47619:(G,I,e)=>{"use strict";e.d(I,{X:()=>o,f:()=>r});var t=e(47232),n=e(85858),s=e(53531);function r(m,l,i){return(0,t.Ar)(m)?m.isValid():n.isMathString(m)?n.isValid(m):(0,s.b)(m,{roundUp:l,timeZone:i}).isValid()}function o(m){return n.isValid(m.from)&&n.isValid(m.to)}},99225:(G,I,e)=>{"use strict";e.d(I,{Q:()=>n});var t=e(91410);function n(s,r){const o=(0,t.HD)(r);if(!o)return s;const m=o.utcOffset(s.getTime()),l=s.getTimezoneOffset(),i=m-l;return new Date(s.getTime()-i*1e3*60)}},25994:(G,I,e)=>{"use strict";e.d(I,{c:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({direction:m="horizontal",spacing:l=2})=>{const i=(0,s.of)(o,l);return m==="vertical"?n.createElement("div",{className:i.verticalDivider}):n.createElement("hr",{className:i.horizontalDivider})};r.displayName="Divider";const o=(m,l)=>({horizontalDivider:(0,t.css)({borderTop:`1px solid ${m.colors.border.weak}`,margin:m.spacing(l,0),width:"100%"}),verticalDivider:(0,t.css)({borderRight:`1px solid ${m.colors.border.weak}`,margin:m.spacing(0,l),height:"100%"})})},69144:(G,I,e)=>{"use strict";e.d(I,{l:()=>n});var t=e(32196);const n=(s,r)=>{const o=r||"middle",m=s.colors.emphasize(s.colors.background.secondary,.15),l=s.colors.primary.border,i=s.spacing(2),u=4,d=200;let p="50%",c="50%";switch(o){case"start":{p="0%",c="0%";break}case"end":{p="100%",c="100%";break}}const y=(0,t.css)({position:"relative","&:before":{content:'""',position:"absolute",transition:s.transitions.create("border-color"),zIndex:1},"&:after":{background:m,content:'""',position:"absolute",transition:s.transitions.create("background"),transform:"translate(-50%, -50%)",borderRadius:s.shape.radius.pill,zIndex:1},"&:hover":{"&:before":{borderColor:l},"&:after":{background:l}}});return{dragHandleVertical:(0,t.cx)(y,(0,t.css)({cursor:"col-resize",width:i,"&:before":{borderRight:"1px solid transparent",height:"100%",left:p,transform:"translateX(-50%)"},"&:after":{left:p,top:"50%",height:d,width:u}})),dragHandleHorizontal:(0,t.cx)(y,(0,t.css)({height:i,cursor:"row-resize","&:before":{borderTop:"1px solid transparent",top:c,transform:"translateY(-50%)",width:"100%"},"&:after":{left:"50%",top:c,height:u,width:d}}))}}},87978:(G,I,e)=>{"use strict";e.d(I,{_:()=>P});var t=e(32196),n=e(18828),s=e(85690),r=e(93225),o=e(50848),m=e(96540),l=e(13544),i=e(40845),u=e(76412),d=e(40276),p=e(69144),c=e(29158),y=e(94753),f=e(24932);function P({children:C,onClose:T,closeOnMaskClick:S=!0,scrollableContent:O=!0,title:x,subtitle:b,width:M,size:A="md",tabs:R}){const[B,U,W]=a(),N=(0,i.of)(h),w=(0,i.of)(v,A,B??M),L=(0,i.of)(p.l),V=m.useRef(null),{dialogProps:K,titleProps:k}=(0,n.s)({},V),{overlayProps:j}=(0,r.e)({isDismissable:!1,isOpen:!0,onClose:T},V);g();const H=(0,t.cx)(N.drawer,w),J=m.createElement("div",{className:N.content},C);return m.createElement(o.A,{open:!0,onClose:T,placement:"right",getContainer:".main-view",className:N.drawerContent,rootClassName:H,width:"",motion:{motionAppear:!0,motionName:N.drawerMotion},maskClassName:N.mask,maskClosable:S,maskMotion:{motionAppear:!0,motionName:N.maskMotion}},m.createElement(s.n1,{restoreFocus:!0,contain:!0,autoFocus:!0},m.createElement("div",{"aria-label":typeof x=="string"?l.Tp.components.Drawer.General.title(x):l.Tp.components.Drawer.General.title("no title"),className:N.container,...j,...K,ref:V},m.createElement("div",{className:(0,t.cx)(L.dragHandleVertical,N.resizer),onMouseDown:U,onTouchStart:W}),typeof x=="string"&&m.createElement("div",{className:(0,t.cx)(N.header,!!R&&N.headerWithTabs)},m.createElement("div",{className:N.actions},m.createElement(c.K,{name:"times",variant:"secondary",onClick:T,"data-testid":l.Tp.components.Drawer.General.close,tooltip:(0,u.t)("grafana-ui.drawer.close","Close")})),m.createElement("div",{className:N.titleWrapper},m.createElement(y.E,{element:"h3",...k},x),b&&m.createElement("div",{className:N.subtitle,"data-testid":l.Tp.components.Drawer.General.subtitle},b),R&&m.createElement("div",{className:N.tabsWrapper},R))),typeof x!="string"&&x,O?m.createElement(d.E,null,J):J)))}function a(){const[C,T]=(0,m.useState)(void 0),S=(0,m.useCallback)(R=>{T(E(R.clientX))},[]),O=(0,m.useCallback)(R=>{const B=R.touches[0];T(E(B.clientX))},[]),x=(0,m.useCallback)(R=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",x)},[S]),b=(0,m.useCallback)(R=>{document.removeEventListener("touchmove",O),document.removeEventListener("touchend",b)},[O]);function M(R){R.stopPropagation(),R.preventDefault(),document.addEventListener("mousemove",S),document.addEventListener("mouseup",x)}function A(R){R.stopPropagation(),R.preventDefault(),document.addEventListener("touchmove",O),document.addEventListener("touchend",b)}return[C,M,A]}function E(C){let T=document.body.offsetWidth-(C-document.body.offsetLeft);return`${Math.min(T/document.body.clientWidth*100,98).toFixed(2)}vw`}function g(){(0,m.useEffect)(()=>{if(document.body)return document.body.classList.add("body-drawer-open"),()=>{document.body.classList.remove("body-drawer-open")}},[])}const h=C=>({container:(0,t.css)({display:"flex",flexDirection:"column",height:"100%",flex:"1 1 0",minHeight:"100%",position:"relative"}),drawer:(0,t.css)({".main-view &":{top:80},".main-view--search-bar-hidden &":{top:40},".main-view--chrome-hidden &":{top:0},".rc-drawer-content-wrapper":{boxShadow:C.shadows.z3}}),drawerContent:(0,t.css)({backgroundColor:`${C.colors.background.primary} !important`,display:"flex",overflow:"unset !important",flexDirection:"column"}),drawerMotion:(0,t.css)({"&-appear":{transform:"translateX(100%)",transition:"none !important","&-active":{transition:`${C.transitions.create("transform")} !important`,transform:"translateX(0)"}}}),mask:(0,t.css)({backgroundColor:"transparent",position:"fixed","&:before":{backgroundColor:`${C.components.overlay.background} !important`,backdropFilter:"blur(1px)",bottom:0,content:'""',left:0,position:"fixed",right:0,".main-view &":{top:80},".main-view--search-bar-hidden &":{top:40},".main-view--chrome-hidden &":{top:0}}}),maskMotion:(0,t.css)({"&-appear":{opacity:0,"&-active":{opacity:1,transition:C.transitions.create("opacity")}}}),header:(0,t.css)({label:"drawer-header",flexGrow:0,padding:C.spacing(2,2,3),borderBottom:`1px solid ${C.colors.border.weak}`}),headerWithTabs:(0,t.css)({borderBottom:"none"}),actions:(0,t.css)({position:"absolute",right:C.spacing(1),top:C.spacing(1)}),titleWrapper:(0,t.css)({label:"drawer-title",overflowWrap:"break-word"}),subtitle:(0,t.css)({label:"drawer-subtitle",color:C.colors.text.secondary,paddingTop:C.spacing(1)}),content:(0,t.css)({padding:C.spacing(2),height:"100%",flexGrow:1}),tabsWrapper:(0,t.css)({label:"drawer-tabs",paddingLeft:C.spacing(2),margin:C.spacing(1,-1,-3,-3)}),resizer:(0,t.css)({top:0,left:C.spacing(-1),bottom:0,position:"absolute",zIndex:C.zIndex.modal})}),D={sm:{width:"25vw",minWidth:384},md:{width:"50vw",minWidth:568},lg:{width:"75vw",minWidth:744}};function v(C,T,S){let O=S??D[T].width,x=D[T].minWidth;return(0,t.css)({".rc-drawer-content-wrapper":{label:`drawer-content-wrapper-${T}`,width:O,minWidth:x,overflow:"unset",[C.breakpoints.down("md")]:{width:`calc(100% - ${C.spacing(2)}) !important`,minWidth:0}}})}},9261:(G,I,e)=>{"use strict";e.d(I,{f:()=>c});var t=e(32196),n=e(34743),s=e(36376),r=e(7315),o=e(85690),m=e(96540),l=e(40845),i=e(38138),u=e(64539),d=e(27746);const p=f=>{const{className:P,options:a,value:E,onChange:g,narrow:h,variant:D,...v}=f,C=(0,l.of)(y),[T,S]=(0,m.useState)(!1),O=[(0,n.cY)(0),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)()],{context:x,refs:b,floatingStyles:M}=(0,s.we)({open:T,placement:"bottom-end",onOpenChange:S,middleware:O,whileElementsMounted:r.ll}),A=(0,s.kp)(x),R=(0,s.s9)(x),{getReferenceProps:B,getFloatingProps:U}=(0,s.bv)([R,A]),W=N=>{g(N),S(!1)};return m.createElement("div",{className:C.wrapper},m.createElement(d.I,{className:P,isOpen:T,narrow:h,variant:D,ref:b.setReference,...B(),...v},E?.label||(E?.value!=null?String(E?.value):null)),T&&m.createElement("div",{className:C.menuWrapper,ref:b.setFloating,...U(),style:M},m.createElement(o.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},m.createElement(i.W,{tabIndex:-1,onClose:()=>S(!1)},a.map(N=>m.createElement(u.D,{key:`${N.value}`,label:N.label??String(N.value),onClick:()=>W(N),active:N.value===E?.value,ariaChecked:N.value===E?.value,ariaLabel:N.ariaLabel||N.label,disabled:N.isDisabled,component:N.component,role:"menuitemradio"}))))))};p.displayName="ButtonSelect";const c=m.memo(p),y=f=>({wrapper:(0,t.css)({position:"relative",display:"inline-flex"}),menuWrapper:(0,t.css)({zIndex:f.zIndex.dropdown})})},83122:(G,I,e)=>{"use strict";e.d(I,{m:()=>p});var t=e(32196),n=e(34743),s=e(36376),r=e(7315),o=e(96540),m=e(86634),l=e(40845),i=e(67892),u=e(18976),d=e(17464);const p=o.memo(({children:y,overlay:f,placement:P,offset:a,onVisibleChange:E})=>{const[g,h]=(0,o.useState)(!1),D=(0,o.useRef)(null),v=(0,o.useCallback)(N=>{h(N),E?.(N)},[E]),C=[(0,n.cY)({mainAxis:a?.[0]??8,crossAxis:a?.[1]??0}),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)()],{context:T,refs:S,floatingStyles:O}=(0,s.we)({open:g,placement:(0,u.O)(P),onOpenChange:v,middleware:C,whileElementsMounted:r.ll}),x=(0,s.kp)(T),b=(0,s.s9)(T),{getReferenceProps:M,getFloatingProps:A}=(0,s.bv)([b,x]),R=150,B=(0,l.of)(c,R),U=()=>{v(!1)},W=N=>{N.key==="Tab"&&v(!1)};return o.createElement(o.Fragment,null,o.cloneElement(y,{ref:S.setReference,...M()}),g&&o.createElement(d.ZL,null,o.createElement(s.s3,{context:T},o.createElement("div",{ref:S.setFloating,style:O,onClick:U,onKeyDown:W},o.createElement(m.A,{nodeRef:D,appear:!0,in:!0,timeout:{appear:R,exit:0,enter:0},classNames:B},o.createElement("div",{ref:D},i.renderOrCallToRender(f,{...A()})))))))});p.displayName="Dropdown";const c=(y,f)=>({appear:(0,t.css)({opacity:"0",position:"relative",transformOrigin:"top",[y.transitions.handleMotion("no-preference")]:{transform:"scaleY(0.5)"}}),appearActive:(0,t.css)({opacity:"1",[y.transitions.handleMotion("no-preference")]:{transform:"scaleY(1)",transition:`transform ${f}ms cubic-bezier(0.2, 0, 0.2, 1), opacity ${f}ms cubic-bezier(0.2, 0, 0.2, 1)`}})})},41670:(G,I,e)=>{"use strict";e.d(I,{Z:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({children:m})=>{const l=(0,s.of)(o);return n.createElement("div",{className:l.container},m)},o=m=>({container:(0,t.css)({borderLeft:`3px solid ${m.colors.info.main}`,backgroundColor:`${m.colors.background.secondary}`,padding:m.spacing(2),minWidth:"350px",borderRadius:m.shape.radius.default,marginBottom:m.spacing(4)})})},69529:(G,I,e)=>{"use strict";e.d(I,{p:()=>D});var t=e(32196),n=e(96540),s=e(8867),r=e(40845),o=e(90613),m=e(67061),l=e(94753),i=e(36348);const u=({width:T="auto",height:S})=>{const O=(0,r.of)(d);return n.createElement(s.default,{src:i,className:O.svg,height:S,width:T})};u.displayName="GrotCTA";const d=T=>({svg:(0,t.css)({"#grot-cta-cactus-1, #grot-cta-cactus-2":{fill:T.isDark?"#58558c":"#c9c5f4"}})});var p=e(22687);const c=-20,y=5,f=-5,P=5,a=({width:T="auto",height:S})=>{const O=(0,n.useRef)(null),x=(0,r.of)(E);return(0,n.useEffect)(()=>{const b=M=>{if(window.matchMedia("(prefers-reduced-motion: reduce").matches)return;const A=O.current?.querySelector("#grot-not-found-arm"),R=O.current?.querySelector("#grot-not-found-magnifier"),{clientX:B,clientY:U}=M,{innerWidth:W,innerHeight:N}=window,w=U/N,L=B/W,V=g(w,c,y),K=g(L,f,P);window.requestAnimationFrame(()=>{A?.setAttribute("style",`transform: rotate(${V}deg) translateX(${K}%)`),R?.setAttribute("style",`transform: rotate(${V}deg) translateX(${K}%)`)})};return window.addEventListener("mousemove",b),()=>{window.removeEventListener("mousemove",b)}},[]),n.createElement(s.default,{innerRef:O,src:p,className:x.svg,height:S,width:T})};a.displayName="GrotNotFound";const E=T=>({svg:(0,t.css)({"#grot-not-found-arm, #grot-not-found-magnifier":{transformOrigin:"center"}})}),g=(T,S,O)=>T*(O-S)+S;var h=e(9886);const D=({button:T,children:S,image:O,message:x,hideImage:b=!1,variant:M,role:A})=>{const R=(0,r.of)(C),B=O??v(M);return n.createElement(o.a,{paddingY:4,display:"flex",direction:"column",alignItems:"center",role:A},n.createElement("div",{className:R.container},!b&&B,n.createElement(m.B,{direction:"column",alignItems:"center"},n.createElement(l.E,{variant:"h4",textAlignment:"center"},x),S&&n.createElement(l.E,{color:"secondary",textAlignment:"center"},S)),T))};function v(T){switch(T){case"call-to-action":return n.createElement(u,{width:300});case"not-found":return n.createElement(a,{width:300});case"completed":return n.createElement(s.default,{src:h,width:300});default:throw new Error(`Unknown variant: ${T}`)}}const C=T=>({container:(0,t.css)({display:"flex",flexDirection:"column",alignItems:"center",gap:T.spacing(4),maxWidth:"600px"})})},66602:(G,I,e)=>{"use strict";e.d(I,{Xc:()=>l,Xw:()=>m,tH:()=>o});var t=e(96540),n=e(32631),s=e(42418),r=e(52446);class o extends t.PureComponent{constructor(){super(...arguments),this.state={error:null,errorInfo:null}}componentDidCatch(u,d){n.P?.api?.pushError(u),this.setState({error:u,errorInfo:d}),this.props.onError&&this.props.onError(u)}componentDidUpdate(u){const{dependencies:d,onRecover:p}=this.props;if(this.state.error&&d&&u.dependencies){for(let c=0;c<d.length;c++)if(d[c]!==u.dependencies[c]){this.setState({error:null,errorInfo:null}),p&&p();break}}}render(){const{children:u}=this.props,{error:d,errorInfo:p}=this.state;return u({error:d,errorInfo:p})}}class m extends t.PureComponent{static{this.defaultProps={title:"An unexpected error happened",style:"alertbox"}}render(){const{title:u,children:d,style:p,dependencies:c}=this.props;return t.createElement(o,{dependencies:c},({error:y,errorInfo:f})=>f?p==="alertbox"?t.createElement(s.F,{title:u||""},t.createElement("details",{style:{whiteSpace:"pre-wrap"}},y&&y.toString(),t.createElement("br",null),f.componentStack)):t.createElement(r.D,{title:u||"",error:y,errorInfo:f}):d)}}function l(i,u={}){const d=p=>t.createElement(m,{...u},t.createElement(i,{...p}));return d.displayName="WithErrorBoundary",d}},52446:(G,I,e)=>{"use strict";e.d(I,{D:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({error:m,errorInfo:l,title:i})=>{const u=(0,s.of)(o);return n.createElement("div",{className:u},n.createElement("h2",null,i),n.createElement("details",{style:{whiteSpace:"pre-wrap"}},m&&m.toString(),n.createElement("br",null),l&&l.componentStack))};r.displayName="ErrorWithStack";const o=()=>(0,t.css)({width:"500px",margin:"64px auto"})},29678:(G,I,e)=>{"use strict";e.d(I,{y:()=>r});var t=e(96540),n=e(41987),s=e(39938);const r=({featureState:m,tooltip:l})=>{const i=o(m);return t.createElement(s.E,{text:i.text,color:i.color,icon:i.icon,tooltip:l})};function o(m){switch(m){case n.Ay.alpha:return{text:"Alpha",icon:"exclamation-triangle",color:"orange"};case n.Ay.beta:return{text:"Beta",icon:"rocket",color:"blue"};case n.Ay.experimental:return{text:"Experimental",icon:"exclamation-triangle",color:"orange"};case n.Ay.preview:return{text:"Preview",icon:"rocket",color:"blue"};case n.Ay.privatePreview:return{text:"Private preview",icon:"rocket",color:"blue"}}}},37270:(G,I,e)=>{"use strict";e.d(I,{gH:()=>c,wI:()=>P});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(20978),m=e(47172),l=e(83195),i=e(40845),u=e(42418),d=e(14578),p=e(95950);function c({options:D,children:v,readAs:C,onLoad:T,fileListRenderer:S,onFileRemove:O}){const[x,b]=(0,r.useState)([]),[M,A]=(0,r.useState)([]),R=(0,l.j_)("decbytes")(D?.maxSize?D?.maxSize:0),B=(0,r.useCallback)((X,se)=>{b(ae=>ae.map(ne=>(ne.id===X.id&&se(ne),ne)))},[]),U=(0,r.useCallback)((X,se,ae)=>{let ne=X.map(g);if(D?.multiple===!1?b(ne):b(q=>[...q,...ne]),j(se),D?.onDrop)D.onDrop(X,se,ae);else for(const q of ne){const ee=new FileReader,z=()=>{C?ee[C](q.file):ee.readAsText(q.file)};B(q,te=>{te.abortUpload=()=>{ee.abort()},te.retryUpload=()=>{B(q,ie=>{ie.error=null,ie.progress=void 0}),z()}}),ee.onabort=()=>{B(q,te=>{te.error=new DOMException("Aborted")})},ee.onprogress=te=>{B(q,ie=>{ie.progress=te.loaded})},ee.onload=()=>{T?.(ee.result)},ee.onerror=()=>{B(q,te=>{te.error=ee.error})},z()}},[T,D,C,B]),W=X=>{const se=x.filter(ae=>X.id!==ae.id);b(se),O?.(X)},{getRootProps:N,getInputProps:w,isDragActive:L}=(0,o.VB)({...D,useFsAccessApi:!1,onDrop:U,accept:f(D?.accept)}),V=(0,i.$j)(),K=h(V,L),k=x.map(X=>S?S(X,W):r.createElement(p.I,{key:X.id,file:X,removeFile:W})),j=X=>{let se=[];X.map(ae=>{ae.errors.map(ne=>{se.findIndex(q=>q.code===ne.code&&q.message===ne.message)===-1&&se.push(ne)})}),A(se)},H=X=>r.createElement("div",{className:K.errorAlert},r.createElement(u.F,{title:"Upload failed",severity:"error",onRemove:J},X.map(se=>{switch(se.code){case m.O4.FileTooLarge:return r.createElement("div",{key:se.message+se.code},"File is larger than ",(0,l.cN)(R));default:return r.createElement("div",{key:se.message+se.code},se.message)}}))),J=()=>{A([])};return r.createElement("div",{className:K.container},r.createElement("div",{"data-testid":"dropzone",...N({className:K.dropzone})},r.createElement("input",{...w()}),v??r.createElement(P,{primaryText:a(x,D)})),M.length>0&&H(M),r.createElement("small",{className:(0,t.cx)(K.small,K.acceptContainer)},D?.maxSize&&`Max file size: ${(0,l.cN)(R)}`,D?.maxSize&&D?.accept&&r.createElement("span",{className:K.acceptSeparator},"|"),D?.accept&&E(D.accept)),k)}function y(D){return["txt","json","csv","xls","yml"].some(v=>D.match(v))?"text/plain":"application/octet-stream"}function f(D){return(0,n.isString)(D)?{[y(D)]:[D]}:Array.isArray(D)?D.reduce((v,C)=>{const T=y(C);return v[T]=v[T]?[...v[T],C]:[C],v},{}):D}function P({primaryText:D="Drop file here or click to upload",secondaryText:v=""}){const C=(0,i.$j)(),T=h(C);return r.createElement("div",{className:(0,t.cx)(T.defaultDropZone),"data-testid":"file-drop-zone-default-children"},r.createElement(d.I,{className:(0,t.cx)(T.icon),name:"upload",size:"xl"}),r.createElement("h6",{className:(0,t.cx)(T.primaryText)},D),r.createElement("small",{className:T.small},v))}function a(D,v){return v?.multiple===void 0||v?.multiple?"Upload file":D.length?"Replace file":"Upload file"}function E(D){return(0,n.isString)(D)?`Accepted file type: ${D}`:Array.isArray(D)?`Accepted file types: ${D.join(", ")}`:`Accepted file types: ${Object.values(D).flat().join(", ")}`}function g(D){return{id:(0,n.uniqueId)("file"),file:D,error:null}}function h(D,v){return{container:(0,t.css)({display:"flex",flexDirection:"column",width:"100%",padding:D.spacing(2),borderRadius:D.shape.radius.default,border:`1px dashed ${D.colors.border.strong}`,backgroundColor:v?D.colors.background.secondary:D.colors.background.primary,cursor:"pointer",alignItems:"center",justifyContent:"center"}),dropzone:(0,t.css)({height:"100%",width:"100%",display:"flex",flexDirection:"column"}),defaultDropZone:(0,t.css)({textAlign:"center"}),icon:(0,t.css)({marginBottom:D.spacing(1)}),primaryText:(0,t.css)({marginBottom:D.spacing(1)}),acceptContainer:(0,t.css)({textAlign:"center",margin:0}),acceptSeparator:(0,t.css)({margin:`0 ${D.spacing(1)}`}),small:(0,t.css)({color:D.colors.text.secondary}),errorAlert:(0,t.css)({paddingTop:"10px"})}}},95950:(G,I,e)=>{"use strict";e.d(I,{I:()=>d});var t=e(32196),n=e(96540),s=e(83195),r=e(40845),o=e(53550),m=e(55852),l=e(14578),i=e(29158);const u="Remove file";function d({file:c,removeFile:y}){const f=(0,r.of)(p),{file:P,progress:a,error:E,abortUpload:g,retryUpload:h}=c,D=()=>E?n.createElement(n.Fragment,null,n.createElement("span",{className:f.error},E.message),h&&n.createElement(i.K,{name:"sync",tooltip:"Retry",tooltipPlacement:"top",onClick:h}),y&&n.createElement(i.K,{className:h?f.marginLeft:"",name:"trash-alt",onClick:()=>y(c),tooltip:u})):a&&P.size>a?n.createElement(n.Fragment,null,n.createElement("progress",{className:f.progressBar,max:P.size,value:a}),n.createElement("span",{className:f.paddingLeft},Math.round(a/P.size*100),"%"),g&&n.createElement(m.$n,{variant:"secondary",type:"button",fill:"text",onClick:g},"Cancel upload")):y&&n.createElement(i.K,{name:"trash-alt",onClick:()=>y(c),tooltip:u,tooltipPlacement:"top"}),v=(0,s.j_)("decbytes")(P.size);return n.createElement("div",{className:f.fileListContainer},n.createElement("span",{className:f.fileNameWrapper},n.createElement(l.I,{name:"file-blank",size:"lg","aria-hidden":!0}),n.createElement("span",{className:f.padding},(0,o.i)(P.name)),n.createElement("span",null,(0,s.cN)(v))),n.createElement("div",{className:f.fileNameWrapper},D()))}function p(c){return{fileListContainer:(0,t.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:c.spacing(2),border:`1px dashed ${c.colors.border.medium}`,backgroundColor:`${c.colors.background.secondary}`,marginTop:c.spacing(1)}),fileNameWrapper:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"center"}),padding:(0,t.css)({padding:c.spacing(0,1)}),paddingLeft:(0,t.css)({paddingLeft:c.spacing(2)}),marginLeft:(0,t.css)({marginLeft:c.spacing(1)}),error:(0,t.css)({paddingRight:c.spacing(2),color:c.colors.error.text}),progressBar:(0,t.css)({borderRadius:c.shape.radius.default,height:"4px","::-webkit-progress-bar":{backgroundColor:c.colors.border.weak,borderRadius:c.shape.radius.default},"::-webkit-progress-value":{backgroundColor:c.colors.primary.main,borderRadius:c.shape.radius.default}})}}},92887:(G,I,e)=>{"use strict";e.d(I,{IB:()=>n.I,gH:()=>t.gH,wI:()=>t.wI});var t=e(37270),n=e(95950)},73546:(G,I,e)=>{"use strict";e.d(I,{e:()=>d});var t=e(32196),n=e(96540),s=e(62938),r=e(13544),o=e(40845),m=e(16797),l=e(53550),i=e(55852),u=e(14578);const d=({onFileUpload:c,className:y,children:f="Upload file",accept:P="*",size:a="md",showFileName:E})=>{const g=(0,o.of)(p(a)),[h,D]=(0,n.useState)(""),v=(0,s.A)(),C=(0,n.useCallback)(T=>{const S=T.currentTarget?.files?.[0];S&&D(S.name??""),c(T)},[c]);return n.createElement(n.Fragment,null,n.createElement("input",{type:"file",id:v,className:g.fileUpload,onChange:C,multiple:!1,accept:P,"data-testid":r.Tp.components.FileUpload.inputField}),n.createElement("label",{htmlFor:v,className:(0,t.cx)(g.labelWrapper,y)},n.createElement(u.I,{name:"upload",className:g.icon}),f),E&&h&&n.createElement("span",{"aria-label":"File name",className:g.fileName,"data-testid":r.Tp.components.FileUpload.fileNameSpan},(0,l.i)(h)))},p=c=>y=>{const f=(0,i.hs)({theme:y,variant:"primary",size:c,iconOnly:!1}),P=(0,m.getFocusStyles)(y);return{fileUpload:(0,t.css)({height:"0.1px",opacity:"0",overflow:"hidden",position:"absolute",width:"0.1px",zIndex:-1,"&:focus + label":P,"&:focus-visible + label":P}),labelWrapper:f.button,icon:f.icon,fileName:(0,t.css)({marginLeft:y.spacing(.5)})}}},67647:(G,I,e)=>{"use strict";e.d(I,{Z:()=>l});var t=e(96540),n=e(54479);function s(...i){const u=t.useRef(null);return t.useEffect(()=>{i.forEach(d=>{d&&(typeof d=="function"?d(u.current):d.current=u.current)})},[i]),u}var r=e(55852),o=e(14578),m=e(10354);const l=t.forwardRef(({value:i,width:u,onChange:d,escapeRegex:p=!0,...c},y)=>{const f=t.useRef(null),P=s(y,f),a=i!==""?t.createElement(r.$n,{icon:"times",fill:"text",size:"sm",onClick:E=>{f.current?.focus(),d(""),E.stopPropagation()}},"Clear"):null;return t.createElement(m.p,{prefix:t.createElement(o.I,{name:"search"}),suffix:a,width:u,type:"text",value:p?(0,n.xb)(i??""):i,onChange:E=>d(p?(0,n.jD)(E.currentTarget.value):E.currentTarget.value),...c,ref:P})});l.displayName="FilterInput"},92174:(G,I,e)=>{"use strict";e.d(I,{m:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(55852),o=e(14578);const m=({label:i,selected:u,onClick:d,icon:p="check"})=>{const c=(0,s.of)(l),y=(0,s.of)(r.my);return n.createElement("button",{type:"button",className:(0,t.cx)(y,c.wrapper,u&&c.selected),onClick:d},n.createElement("span",null,i),u&&n.createElement(o.I,{name:p,className:c.icon}))},l=i=>({wrapper:(0,t.css)({background:i.colors.background.secondary,borderRadius:i.shape.radius.pill,padding:i.spacing(0,2),fontSize:i.typography.bodySmall.fontSize,fontWeight:i.typography.fontWeightMedium,lineHeight:i.typography.bodySmall.lineHeight,color:i.colors.text.secondary,display:"flex",alignItems:"center",height:"32px",position:"relative",border:`1px solid ${i.colors.background.secondary}`,whiteSpace:"nowrap","&:hover":{background:i.colors.action.hover,color:i.colors.text.primary}}),selected:(0,t.css)({color:i.colors.text.primary,background:i.colors.action.selected,"&:hover":{background:i.colors.action.focus}}),icon:(0,t.css)({marginLeft:i.spacing(.5)})})},90090:(G,I,e)=>{"use strict";e.d(I,{z:()=>r});var t=e(32196),n=e(96540),s=e(38894);const r=({label:m,tooltip:l,labelWidth:i=6,inputWidth:u=12,inputEl:d,className:p,interactive:c,...y})=>{const f=o();return n.createElement("div",{className:(0,t.cx)(f.formField,p)},n.createElement(s.I,{width:i,tooltip:l,interactive:c},m),d||n.createElement("input",{type:"text",className:`gf-form-input ${u?`width-${u}`:""}`,...y,disabled:y.disabled}))};r.displayName="FormField";const o=()=>({formField:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative"})})},38894:(G,I,e)=>{"use strict";e.d(I,{I:()=>l});var t=e(46942),n=e.n(t),s=e(96540),r=e(14578),o=e(56034);const l=({children:i,isFocused:u,isInvalid:d,className:p,htmlFor:c,tooltip:y,width:f,interactive:P,...a})=>{const E=n()(p,`gf-form-label width-${f||"10"}`,{"gf-form-label--is-focused":u,"gf-form-label--is-invalid":d});return s.createElement("label",{className:E,...a,htmlFor:c},i,y&&s.createElement(o.m,{placement:"top",content:y,theme:"info",interactive:P},s.createElement(r.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})))}},9286:(G,I,e)=>{"use strict";e.d(I,{i:()=>s});var t=e(96540);function n(r){return r<20?.9:r<26?.8:.6}const s=({value:r,className:o,style:m,...l})=>{const i=(r.prefix??"").length>0,u=(r.suffix??"").length>0;let d;if(m&&m.fontSize&&typeof m.fontSize=="number"){const p=m.fontSize,c=n(p);d={fontSize:p*c}}return t.createElement("div",{className:o,style:m,...l},t.createElement("div",null,i&&t.createElement("span",null,r.prefix),t.createElement("span",null,r.text),u&&t.createElement("span",{style:d},r.suffix)))};s.displayName="FormattedDisplayValue"},10880:(G,I,e)=>{"use strict";e.d(I,{S:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(16797),o=e(60029);const m=n.forwardRef(({label:i,description:u,value:d,htmlValue:p,onChange:c,disabled:y,className:f,indeterminate:P,invalid:a,...E},g)=>{const h=(0,n.useCallback)(C=>{c&&c(C)},[c]),D=(0,s.of)(l,a),v=P?"mixed":void 0;return n.createElement("label",{className:(0,t.cx)(D.wrapper,f)},n.createElement("div",{className:D.checkboxWrapper},n.createElement("input",{type:"checkbox",className:(0,t.cx)(D.input,P&&D.inputIndeterminate),checked:d,disabled:y,onChange:h,value:p,"aria-checked":v,...E,ref:g}),n.createElement("span",{className:D.checkmark})),i&&n.createElement("span",{className:D.label},i),u&&n.createElement("span",{className:D.description},u))}),l=(i,u=!1)=>{const d=(0,o.f)(i),p=2,c=1,y=f=>u?i.colors.error.border:f;return{wrapper:(0,t.css)({display:"inline-grid",alignItems:"center",columnGap:i.spacing(c),gridAutoRows:"max-content",position:"relative",verticalAlign:"middle"}),input:(0,t.css)({position:"absolute",zIndex:1,top:0,left:0,width:"100% !important",height:"100%",opacity:0,"&:focus + span, &:focus-visible + span":(0,r.getFocusStyles)(i),"&:focus:not(:focus-visible) + span":(0,r.getMouseFocusStyles)(i),"&:checked + span":{background:i.colors.primary.main,border:`1px solid ${y(i.colors.primary.main)}`,"&:hover":{background:i.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"4px",top:0,width:"6px",height:"12px",border:`solid ${i.colors.primary.contrastText}`,borderWidth:"0 3px 3px 0",transform:"rotate(45deg)"}},"&:disabled + span":{backgroundColor:i.colors.action.disabledBackground,cursor:"not-allowed",border:`1px solid ${y(i.colors.action.disabledBackground)}`,"&:hover":{backgroundColor:i.colors.action.disabledBackground},"&:after":{borderColor:i.colors.action.disabledText}}}),inputIndeterminate:(0,t.css)({"&[aria-checked='mixed'] + span":{border:`1px solid ${y(i.colors.primary.main)}`,background:i.colors.primary.main,"&:hover":{background:i.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"2px",right:"2px",top:"calc(50% - 1.5px)",height:"3px",border:`1.5px solid ${i.colors.primary.contrastText}`,backgroundColor:i.colors.primary.contrastText,width:"auto",transform:"none"}},"&:disabled[aria-checked='mixed'] + span":{backgroundColor:i.colors.action.disabledBackground,border:`1px solid ${y(i.colors.error.transparent)}`,"&:after":{borderColor:i.colors.action.disabledText}}}),checkboxWrapper:(0,t.css)({display:"flex",alignItems:"center",gridColumnStart:1,gridRowStart:1}),checkmark:(0,t.css)({position:"relative",zIndex:2,display:"inline-block",width:i.spacing(p),height:i.spacing(p),borderRadius:i.shape.radius.default,background:i.components.input.background,border:`1px solid ${y(i.components.input.borderColor)}`,"&:hover":{cursor:"pointer",borderColor:y(i.components.input.borderHover)}}),label:(0,t.cx)(d.label,(0,t.css)({gridColumnStart:2,gridRowStart:1,position:"relative",zIndex:2,cursor:"pointer",maxWidth:"fit-content",lineHeight:i.typography.bodySmall.lineHeight,marginBottom:0})),description:(0,t.cx)(d.description,(0,t.css)({gridColumnStart:2,gridRowStart:2,lineHeight:i.typography.bodySmall.lineHeight,marginTop:0}))}};m.displayName="Checkbox"},88575:(G,I,e)=>{"use strict";e.d(I,{D:()=>l});var t=e(32196),n=e(96540),s=e(40845),r=e(67892),o=e(72093),m=e(60029);const l=n.forwardRef(({label:d,description:p,horizontal:c,invalid:y,loading:f,disabled:P,required:a,error:E,children:g,className:h,validationMessageHorizontalOverflow:D,htmlFor:v,...C},T)=>{const S=(0,s.of)(u),O=v??(0,r.getChildId)(g),x=typeof d=="string"?n.createElement(m.J,{htmlFor:O,description:p},`${d}${a?" *":""}`):d,b=i({invalid:y,disabled:P,loading:f});return n.createElement("div",{className:(0,t.cx)(S.field,c&&S.fieldHorizontal,h),...C},x,n.createElement("div",null,n.createElement("div",{ref:T},n.cloneElement(g,b)),y&&E&&!c&&n.createElement("div",{className:(0,t.cx)(S.fieldValidationWrapper,{[S.validationMessageHorizontalOverflow]:!!D})},n.createElement(o.P,null,E))),y&&E&&c&&n.createElement("div",{className:(0,t.cx)(S.fieldValidationWrapper,S.fieldValidationWrapperHorizontal,{[S.validationMessageHorizontalOverflow]:!!D})},n.createElement(o.P,null,E)))});l.displayName="Field";function i(d){for(const p in d)d[p]===void 0&&delete d[p];return d}const u=d=>({field:(0,t.css)({display:"flex",flexDirection:"column",marginBottom:d.spacing(2)}),fieldHorizontal:(0,t.css)({flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),fieldValidationWrapper:(0,t.css)({marginTop:d.spacing(.5)}),fieldValidationWrapperHorizontal:(0,t.css)({flex:"1 1 100%"}),validationMessageHorizontalOverflow:(0,t.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},95984:(G,I,e)=>{"use strict";e.d(I,{E:()=>n});var t=e(49785);const n=({name:s,control:r,children:o,...m})=>{const{fields:l,append:i,prepend:u,remove:d,swap:p,move:c,insert:y}=(0,t.jz)({control:r,name:s,...m});return o({fields:l,append:i,prepend:u,remove:d,swap:p,move:c,insert:y})}},84167:(G,I,e)=>{"use strict";e.d(I,{n:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(17408);const o=({label:l,children:i,className:u,...d})=>{const p=(0,s.of)(m);return n.createElement("fieldset",{className:(0,t.cx)(p.wrapper,u),...d},l&&n.createElement(r.s,null,l),i)},m=l=>({wrapper:(0,t.css)({marginBottom:l.spacing(4),"&:last-child":{marginBottom:0}})})},72093:(G,I,e)=>{"use strict";e.d(I,{P:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(14578);const o=({children:l,horizontal:i,className:u})=>{const d=(0,s.of)(m),p=(0,t.cx)(i?d.horizontal:d.vertical,u);return n.createElement("div",{role:"alert",className:p},n.createElement(r.I,{className:d.fieldValidationMessageIcon,name:"exclamation-triangle"}),l)},m=l=>{const i=`
      font-size: ${l.typography.size.sm};
      font-weight: ${l.typography.fontWeightMedium};
      padding: ${l.spacing(.5,1)};
      color: ${l.colors.error.contrastText};
      background: ${l.colors.error.main};
      border-radius: ${l.shape.radius.default};
      position: relative;
      display: inline-block;
      align-self: flex-start;

      a {
        color: ${l.colors.error.contrastText};
        text-decoration: underline;
      }

      a:hover {
        text-decoration: none;
      }
    `;return{vertical:(0,t.css)(i,{margin:l.spacing(.5,0,0,0),"&:before":{content:'""',position:"absolute",left:"9px",top:"-5px",width:0,height:0,borderWidth:"0 4px 5px 4px",borderColor:`transparent transparent ${l.colors.error.main} transparent`,borderStyle:"solid"}}),horizontal:(0,t.css)(i,{marginLeft:"10px","&:before":{content:'""',position:"absolute",left:"-5px",top:"9px",width:0,height:0,borderWidth:"4px 5px 4px 0",borderColor:"transparent #e02f44 transparent transparent",borderStyle:"solid"}}),fieldValidationMessageIcon:(0,t.css)({marginRight:l.spacing()})}}},51253:(G,I,e)=>{"use strict";e.d(I,{l:()=>r});var t=e(32196),n=e(96540),s=e(49785);function r({defaultValues:o,onSubmit:m,validateOnMount:l=!1,validateFieldsOnMount:i,children:u,validateOn:d="onSubmit",maxWidth:p=600,...c}){const{handleSubmit:y,trigger:f,formState:P,...a}=(0,s.mN)({mode:d,defaultValues:o});return(0,n.useEffect)(()=>{l&&f(i)},[f,i,l]),n.createElement("form",{className:(0,t.css)({maxWidth:p!=="none"?p+"px":p,width:"100%"}),onSubmit:y(m),...c},u({errors:P.errors,formState:P,trigger:f,...a}))}},14186:(G,I,e)=>{"use strict";e.d(I,{I:()=>l});var t=e(32196),n=e(96540),s=e(40845),r=e(67892),o=e(72093),m=e(76892);const l=({children:u,label:d,tooltip:p,labelWidth:c="auto",invalid:y,loading:f,disabled:P,required:a,className:E,htmlFor:g,grow:h,shrink:D,error:v,transparent:C,interactive:T,...S})=>{const O=(0,s.$j)(),x=i(O,h,D),b=g??(0,r.getChildId)(u),M=typeof d=="string"?n.createElement(m.c,{interactive:T,width:c,tooltip:p,htmlFor:b,transparent:C},`${d}${a?" *":""}`):d;return n.createElement("div",{className:(0,t.cx)(x.container,E),...S},M,n.createElement("div",{className:x.childContainer},n.cloneElement(u,{invalid:y,disabled:P,loading:f}),y&&v&&n.createElement("div",{className:(0,t.cx)(x.fieldValidationWrapper)},n.createElement(o.P,null,v))))};l.displayName="InlineField";const i=(u,d,p)=>({container:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${d?1:0} ${p?1:0} auto`,margin:`0 ${u.spacing(.5)} ${u.spacing(.5)} 0`}),childContainer:(0,t.css)({flex:`${d?1:0} ${p?1:0} auto`}),fieldValidationWrapper:(0,t.css)({marginTop:u.spacing(.5)})})},39268:(G,I,e)=>{"use strict";e.d(I,{C:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({children:m,className:l,...i})=>{const u=(0,s.of)(o);return n.createElement("div",{className:(0,t.cx)(u.container,l),...i},m)},o=m=>({container:(0,t.css)({label:"InlineFieldRow",display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start",rowGap:m.spacing(.5)})})},76892:(G,I,e)=>{"use strict";e.d(I,{c:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(14578),o=e(56034);const m=({children:i,className:u,tooltip:d,width:p,transparent:c,interactive:y,as:f="label",...P})=>{const a=(0,s.of)(l,c,p);return n.createElement(f,{className:(0,t.cx)(a.label,u),...P},i,d&&n.createElement(o.m,{interactive:y,placement:"top",content:d,theme:"info"},n.createElement(r.I,{tabIndex:0,name:"info-circle",size:"sm",className:a.icon})))},l=(i,u=!1,d)=>({label:(0,t.css)({display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,padding:i.spacing(0,1),fontWeight:i.typography.fontWeightMedium,fontSize:i.typography.size.sm,backgroundColor:u?"transparent":i.colors.background.secondary,height:i.spacing(i.components.height.md),lineHeight:i.spacing(i.components.height.md),marginRight:i.spacing(.5),borderRadius:i.shape.radius.default,border:"none",width:d?d!=="auto"?`${8*d}px`:d:"100%",color:i.colors.text.primary}),icon:(0,t.css)({color:i.colors.text.secondary,marginLeft:"10px",":hover":{color:i.colors.text.primary}})})},63056:(G,I,e)=>{"use strict";e.d(I,{e:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({children:m,className:l,grow:i,...u})=>{const d=(0,s.of)(o,i);return n.createElement("div",{className:(0,t.cx)(d.container,l),...u},m)};r.displayName="InlineSegmentGroup";const o=(m,l)=>({container:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${l?1:0} 0 auto`,marginBottom:m.spacing(.5)})})},60029:(G,I,e)=>{"use strict";e.d(I,{J:()=>o,f:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(14578);const o=({children:l,description:i,className:u,category:d,...p})=>{const c=(0,s.of)(m),y=d?.map((f,P)=>n.createElement("span",{className:c.categories,key:`${f}/${P}`},n.createElement("span",null,f),n.createElement(r.I,{name:"angle-right",className:c.chevron})));return n.createElement("div",{className:(0,t.cx)(c.label,u)},n.createElement("label",{...p},n.createElement("div",{className:c.labelContent},y,l),i&&n.createElement("span",{className:c.description},i)))},m=l=>({label:(0,t.css)({label:"Label",fontSize:l.typography.size.sm,fontWeight:l.typography.fontWeightMedium,lineHeight:1.25,marginBottom:l.spacing(.5),color:l.colors.text.primary,maxWidth:"480px"}),labelContent:(0,t.css)({display:"flex",alignItems:"center"}),description:(0,t.css)({label:"Label-description",color:l.colors.text.secondary,fontSize:l.typography.size.sm,fontWeight:l.typography.fontWeightRegular,marginTop:l.spacing(.25),display:"block"}),categories:(0,t.css)({label:"Label-categories",display:"inline-flex",alignItems:"center"}),chevron:(0,t.css)({margin:l.spacing(0,.25)})})},91634:(G,I,e)=>{"use strict";e.d(I,{O:()=>o,p:()=>m});var t=e(46942),n=e.n(t),s=e(96540),r=e(29734),o=(l=>(l.Invalid="invalid",l.Valid="valid",l))(o||{});class m extends s.PureComponent{constructor(){super(...arguments),this.state={error:null},this.validatorAsync=i=>u=>{const d=(0,r.tf)(u.target.value,i);this.setState(p=>({...p,error:d?d[0]:null}))},this.populateEventPropsWithStatus=(i,u)=>{const d={...i};return u&&Object.keys(r.Pw).forEach(p=>{((0,r.K)(p,u)||i[p])&&(d[p]=async c=>{c.persist(),(0,r.K)(p,u)&&await this.validatorAsync(u[p]).apply(this,[c]),i[p]&&i[p].apply(null,[c,this.status])})}),d}}static{this.defaultProps={className:""}}get status(){return this.state.error?"invalid":"valid"}get isInvalid(){return this.status==="invalid"}render(){const{validationEvents:i,className:u,hideErrorMessage:d,inputRef:p,...c}=this.props,{error:y}=this.state,f=n()("gf-form-input",{invalid:this.isInvalid},u),P=this.populateEventPropsWithStatus(c,i);return s.createElement("div",{style:{flexGrow:1}},s.createElement("input",{...P,ref:p,className:f}),y&&!d&&s.createElement("span",null,y))}}},24169:(G,I,e)=>{"use strict";e.d(I,{A:()=>o,s:()=>r});var t=e(96540),n=e(28581),s=e(14578);const r=m=>{const l=m.selectProps.menuIsOpen;return t.createElement(n.c.IndicatorsContainer,{...m},t.createElement(s.I,{name:l?"angle-up":"angle-down",style:{marginTop:"7px"}}))},o=r},11206:(G,I,e)=>{"use strict";e.d(I,{A:()=>r,l:()=>s});var t=e(96540),n=e(28581);const s=o=>{const{children:m}=o;return t.createElement(n.c.NoOptionsMessage,{...o},t.createElement("div",{className:"gf-form-select-box__desc-option"},t.createElement("div",{className:"gf-form-select-box__desc-option__body"},m)))},r=s},22209:(G,I,e)=>{"use strict";e.d(I,{DW:()=>x,l6:()=>O});var t=e(46942),n=e.n(t),s=e(96540),r=e(28581),o=e(46005),m=e(8539),l=e(66963),i=e(60578),u=e(40276),d=e(62235),p=e(23731),c=e(56034),y=e(24169),f=e(11206),P=e(14578);const a=A=>{const{children:R,isSelected:B,data:U}=A;return s.createElement(r.c.Option,{...A},s.createElement("div",{className:"gf-form-select-box__desc-option"},U.imgUrl&&s.createElement("img",{className:"gf-form-select-box__desc-option__img",src:U.imgUrl,alt:""}),s.createElement("div",{className:"gf-form-select-box__desc-option__body"},s.createElement("div",null,R),U.description&&s.createElement("div",{className:"gf-form-select-box__desc-option__desc"},U.description)),B&&s.createElement(P.I,{name:"check","aria-hidden":"true"})))},E=null;var g=e(32196),h=e(3911),D=e(40845);const v=(0,h.N)(A=>({header:(0,g.css)({display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${A.colors.background.secondary}`,"&:hover":{color:A.colors.text.maxContrast}}),label:(0,g.css)({flexGrow:1}),icon:(0,g.css)({paddingRight:"2px"})}));class C extends s.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.onToggleChildren=()=>{this.setState(R=>({expanded:!R.expanded}))}}componentDidMount(){if(this.props.data.expanded)this.setState({expanded:!0});else if(this.props.selectProps&&this.props.selectProps.value){const{value:R}=this.props.selectProps.value;R&&this.props.options.some(B=>B.value===R)&&this.setState({expanded:!0})}}componentDidUpdate(R){R.selectProps.inputValue!==""&&this.setState({expanded:!0})}render(){const{children:R,label:B,theme:U}=this.props,{expanded:W}=this.state,N=v(U);return s.createElement("div",null,s.createElement("div",{className:N.header,onClick:this.onToggleChildren,role:"presentation"},s.createElement("span",{className:N.label},B),s.createElement(P.I,{className:N.icon,name:W?"angle-up":"angle-down"})),W&&R)}}const T=(0,D.cV)(C),S=A=>s.createElement(r.c.MenuList,{...A},s.createElement(u.E,{autoHide:!1,autoHeightMax:"inherit"},A.children));class O extends s.PureComponent{static{this.contextType=i.D}static{this.defaultProps={className:"",isDisabled:!1,isSearchable:!0,isClearable:!1,isMulti:!1,openMenuOnFocus:!1,autoFocus:!1,isLoading:!1,backspaceRemovesValue:!0,maxMenuHeight:300,tabSelectsValue:!0,allowCustomValue:!1,components:{Option:a,SingleValue:d.K,IndicatorsContainer:y.A,MenuList:S,Group:T}}}render(){const{defaultValue:R,getOptionLabel:B,getOptionValue:U,onChange:W,options:N,placeholder:w,width:L,value:V,className:K,isDisabled:k,isLoading:j,isSearchable:H,isClearable:J,backspaceRemovesValue:X,isMulti:se,autoFocus:ae,openMenuOnFocus:ne,onBlur:q,maxMenuHeight:ee,noOptionsMessage:z,isOpen:te,components:ie,tooltipContent:ce,tabSelectsValue:ue,onCloseMenu:fe,onOpenMenu:Te,allowCustomValue:he,formatCreateLabel:de,"aria-label":le}=this.props;let pe="";L&&(pe="width-"+L);let ve=o.Ay;const be={};he&&(ve=l.A,be.formatCreateLabel=de??(Ue=>Ue));const Oe=n()("gf-form-input","gf-form-input--form-dropdown",pe,K),Me={...O.defaultProps.components,...ie};return s.createElement(b,{onCloseMenu:fe,onOpenMenu:Te,tooltipContent:ce,isOpen:te},(Ue,we)=>s.createElement(ve,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:Oe,components:Me,defaultValue:R,value:V,getOptionLabel:B,getOptionValue:U,menuShouldScrollIntoView:!1,isSearchable:H,onChange:W,options:N,placeholder:w||"Choose",styles:(0,p.A)(this.context),isDisabled:k,isLoading:j,isClearable:J,autoFocus:ae,onBlur:q,openMenuOnFocus:ne,maxMenuHeight:ee,noOptionsMessage:z,isMulti:se,backspaceRemovesValue:X,menuIsOpen:te,onMenuOpen:Ue,onMenuClose:we,tabSelectsValue:ue,"aria-label":le,...be}))}}class x extends s.PureComponent{static{this.contextType=i.D}static{this.defaultProps={className:"",components:{},loadingMessage:()=>"Loading...",isDisabled:!1,isClearable:!1,isMulti:!1,isSearchable:!0,backspaceRemovesValue:!0,autoFocus:!1,openMenuOnFocus:!1,maxMenuHeight:300}}render(){const{defaultValue:R,getOptionLabel:B,getOptionValue:U,onChange:W,placeholder:N,width:w,value:L,className:V,loadOptions:K,defaultOptions:k,isLoading:j,loadingMessage:H,noOptionsMessage:J,isDisabled:X,isSearchable:se,isClearable:ae,backspaceRemovesValue:ne,autoFocus:q,onBlur:ee,openMenuOnFocus:z,maxMenuHeight:te,isMulti:ie,tooltipContent:ce,onCloseMenu:ue,onOpenMenu:fe,isOpen:Te}=this.props;let he="";w&&(he="width-"+w);const de=n()("gf-form-input","gf-form-input--form-dropdown",he,V);return s.createElement(b,{onCloseMenu:ue,onOpenMenu:fe,tooltipContent:ce,isOpen:Te},(le,pe)=>s.createElement(m.A,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:de,components:{Option:a,SingleValue:d.K,IndicatorsContainer:y.A,NoOptionsMessage:f.A},defaultValue:R,value:L,getOptionLabel:B,getOptionValue:U,menuShouldScrollIntoView:!1,onChange:W,loadOptions:K,isLoading:j,defaultOptions:k,placeholder:N||"Choose",styles:(0,p.A)(this.context),loadingMessage:H,noOptionsMessage:J,isDisabled:X,isSearchable:se,isClearable:ae,autoFocus:q,onBlur:ee,openMenuOnFocus:z,maxMenuHeight:te,isMulti:ie,backspaceRemovesValue:ne}))}}class b extends s.PureComponent{constructor(){super(...arguments),this.state={isOpenInternal:!1},this.onOpenMenu=()=>{const{onOpenMenu:R}=this.props;R&&R(),this.setState({isOpenInternal:!0})},this.onCloseMenu=()=>{const{onCloseMenu:R}=this.props;R&&R(),this.setState({isOpenInternal:!1})}}render(){const{children:R,isOpen:B,tooltipContent:U}=this.props,{isOpenInternal:W}=this.state;let N;return(W||B)&&(N=!1),U?s.createElement(c.m,{show:N,content:U,placement:"bottom"},s.createElement("div",null,R(this.onOpenMenu,this.onCloseMenu))):s.createElement("div",null,R(this.onOpenMenu,this.onCloseMenu))}}const M=null},74716:(G,I,e)=>{"use strict";e.d(I,{d:()=>u});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(40845),m=e(14578),l=e(56034);class i extends r.PureComponent{constructor(){super(...arguments),this.state={id:(0,n.uniqueId)()},this.internalOnChange=c=>{c.stopPropagation(),this.props.onChange(c)}}render(){const{labelClass:c="",switchClass:y="",label:f,checked:P,disabled:a,transparent:E,className:g,theme:h,tooltip:D,tooltipPlacement:v}=this.props,C=d(h),T=this.state.id,S=`gf-form-label ${c} ${E?"gf-form-label--transparent":""} pointer`,O=(0,t.cx)(C.switch,y,{[C.switchTransparent]:E});return r.createElement("div",{className:C.container},r.createElement("label",{htmlFor:T,className:(0,t.cx)("gf-form",C.labelContainer,g)},f&&r.createElement("div",{className:S},f,D&&r.createElement(l.m,{placement:v||"auto",content:D,theme:"info"},r.createElement(m.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}}))),r.createElement("div",{className:O},r.createElement("input",{disabled:a,id:T,type:"checkbox",checked:P,onChange:this.internalOnChange}),r.createElement("span",{className:C.slider}))))}}const u=(0,o.cV)(i),d=p=>{const c=(0,t.css)({background:p.v1.palette.gray1,borderRadius:p.shape.radius.pill,height:"16px",width:"32px",display:"block",position:"relative","&::before":{position:"absolute",content:"''",height:"12px",width:"12px",left:"2px",top:"2px",background:p.components.input.background,transition:"0.4s",borderRadius:p.shape.radius.circle,boxShadow:p.shadows.z1}});return{container:(0,t.css)({display:"flex",flexShrink:0}),labelContainer:(0,t.css)({display:"flex",cursor:"pointer",marginRight:p.spacing(.5)}),switch:(0,t.css)({display:"flex",position:"relative",width:"56px",height:p.spacing(4),background:p.components.input.background,border:`1px solid ${p.components.input.borderColor}`,borderRadius:p.shape.radius.default,alignItems:"center",justifyContent:"center",input:{opacity:0,width:0,height:0},[`input:checked + .${c}`]:{background:p.colors.primary.main},[`input:checked + .${c}::before`]:{transform:"translateX(16px)"}}),switchTransparent:(0,t.css)({background:"transparent",border:0,width:"40px"}),slider:c}}},17408:(G,I,e)=>{"use strict";e.d(I,{s:()=>o});var t=e(32196),n=e(96540),s=e(40845);const r=m=>({legend:(0,t.css)({fontSize:m.typography.h3.fontSize,fontWeight:m.typography.fontWeightRegular,margin:m.spacing(0,0,2,0)})}),o=({children:m,className:l,...i})=>{const u=(0,s.of)(r);return n.createElement("legend",{className:(0,t.cx)(u.legend,l),...i},m)}},94354:(G,I,e)=>{"use strict";e.d(I,{z:()=>y});var t=e(32196),n=e(2543),s=e(96540),r=e(8887),o=e(40845),m=e(14578),l=e(13544),i=e(16797),u=e(56034),d=e(87266);const p=s.forwardRef(({children:P,active:a=!1,disabled:E=!1,size:g="md",onChange:h,onClick:D,id:v,name:C=void 0,description:T,fullWidth:S,"aria-label":O},x)=>{const b=(0,o.of)(c,g,S),M=s.createElement("input",{type:"radio",className:b.radio,onChange:h,onClick:D,disabled:E,id:v,checked:a,name:C,"aria-label":O,ref:x});return T?s.createElement("div",{className:b.radioOption,"data-testid":l.Tp.components.RadioButton.container},s.createElement(u.m,{content:T,placement:"bottom"},M),s.createElement("label",{className:b.radioLabel,htmlFor:v,title:T||O},P)):s.createElement("div",{className:b.radioOption,"data-testid":l.Tp.components.RadioButton.container},M,s.createElement("label",{className:b.radioLabel,htmlFor:v,title:T||O},P))});p.displayName="RadioButton";const c=(P,a,E)=>{const{fontSize:g,height:h,padding:D}=(0,d.SM)(a,P),v=P.colors.text.secondary,C=P.colors.text.primary,T=h*P.spacing.gridSize-4-2;return{radioOption:(0,t.css)({display:"flex",justifyContent:"space-between",position:"relative",flex:E?"1 0 0":"none",textAlign:"center"}),radio:(0,t.css)({position:"absolute",opacity:0,zIndex:2,width:"100% !important",height:"100%",cursor:"pointer","&:checked + label":{color:P.colors.text.primary,fontWeight:P.typography.fontWeightMedium,background:P.colors.action.selected,zIndex:1},"&:focus + label, &:focus-visible + label":(0,i.getFocusStyles)(P),"&:focus:not(:focus-visible) + label":(0,i.getMouseFocusStyles)(P),"&:disabled + label":{color:P.colors.text.disabled,cursor:"not-allowed"}}),radioLabel:(0,t.css)({display:"flex",alignItems:"center",justifyContent:"center",fontSize:g,height:`${T}px`,lineHeight:`${T}px`,color:v,padding:P.spacing(0,D),borderRadius:P.shape.radius.default,background:P.colors.background.primary,cursor:"pointer",userSelect:"none",whiteSpace:"nowrap",flexGrow:1,"&:hover":{color:C}})}};function y({options:P,value:a,onChange:E,onClick:g,disabled:h,disabledOptions:D,size:v="md",id:C,className:T,fullWidth:S=!1,autoFocus:O=!1,"aria-label":x,invalid:b=!1}){const M=(0,s.useCallback)(N=>()=>{E&&E(N.value)},[E]),A=(0,s.useCallback)(N=>()=>{g&&g(N.value)},[g]),R=C??(0,n.uniqueId)("radiogroup-"),B=(0,s.useRef)(R),U=(0,o.of)(f),W=(0,s.useRef)(null);return(0,s.useEffect)(()=>{O&&W.current&&W.current.focus()},[O]),s.createElement("div",{role:"radiogroup","aria-label":x,className:(0,t.cx)(U.radioGroup,S&&U.fullWidth,b&&U.invalid,T)},P.map((N,w)=>{const L=D&&N.value&&D.includes(N.value),V=N.icon?(0,r.Uo)(N.icon):void 0,K=!!(N.imgUrl||N.label||N.component);return s.createElement(p,{size:v,disabled:L||h,active:a===N.value,key:`o.label-${w}`,"aria-label":N.ariaLabel,onChange:M(N),onClick:A(N),id:`option-${N.value}-${R}`,name:B.current,description:N.description,fullWidth:S,ref:a===N.value?W:void 0},V&&s.createElement(m.I,{name:V,className:(0,t.cx)(K&&U.icon)}),N.imgUrl&&s.createElement("img",{src:N.imgUrl,alt:N.label,className:U.img}),N.label," ",N.component?s.createElement(N.component,null):null)}))}y.displayName="RadioButtonGroup";const f=P=>({radioGroup:(0,t.css)({display:"inline-flex",flexDirection:"row",flexWrap:"nowrap",border:`1px solid ${P.components.input.borderColor}`,borderRadius:P.shape.radius.default,padding:"2px"}),fullWidth:(0,t.css)({display:"flex"}),icon:(0,t.css)({marginRight:"6px"}),img:(0,t.css)({width:P.spacing(2),height:P.spacing(2),marginRight:P.spacing(1)}),invalid:(0,t.css)({border:`1px solid ${P.colors.error.border}`})})},5173:(G,I,e)=>{"use strict";e.d(I,{a:()=>l});var t=e(32196),n=e(2543),s=e(96540),r=e(40845);const o=({id:u,name:d,label:p,checked:c,value:y,disabled:f,description:P,onChange:a})=>{const E=(0,r.of)(m);return s.createElement("label",{title:P,className:E.label},s.createElement("input",{id:u,name:d,type:"radio",checked:c,value:y,disabled:f,className:E.input,onChange:()=>a&&a(u)}),s.createElement("div",null,p,P&&s.createElement("div",{className:E.description},P)))},m=u=>({input:(0,t.css)({position:"relative",appearance:"none",outline:"none",backgroundColor:u.colors.background.canvas,width:`${u.spacing(2)} !important`,height:u.spacing(2),border:`1px solid ${u.colors.border.medium}`,borderRadius:u.shape.radius.circle,margin:"3px 0",":checked":{backgroundColor:u.v1.palette.white,border:`5px solid ${u.colors.primary.main}`},":disabled":{backgroundColor:`${u.colors.action.disabledBackground} !important`,borderColor:u.colors.border.weak},":disabled:checked":{border:`1px solid ${u.colors.border.weak}`},":disabled:checked::after":{content:'""',width:"6px",height:"6px",backgroundColor:u.colors.text.disabled,borderRadius:u.shape.radius.circle,display:"inline-block",position:"absolute",top:"4px",left:"4px"},":focus":{outline:"none !important",boxShadow:`0 0 0 1px ${u.colors.background.canvas}, 0 0 0 3px ${u.colors.primary.main}`}}),label:(0,t.css)({fontSize:u.typography.fontSize,lineHeight:"22px",display:"grid",gridTemplateColumns:`${u.spacing(2)} auto`,gap:u.spacing(1)}),description:(0,t.css)({fontSize:u.typography.size.sm,color:u.colors.text.secondary})});function l({name:u,id:d,options:p,value:c,onChange:y,className:f,disabled:P,disabledOptions:a=[]}){const E=(0,r.of)(i),g=d??(0,n.uniqueId)("radiogroup-list-");return s.createElement("div",{id:d,className:(0,t.cx)(E.container,f),role:"radiogroup"},p.map((h,D)=>{const v=`${g}-${D}`,C=c&&c===h.value,T=P||a.some(O=>O===h.value),S=()=>y&&h.value&&y(h.value);return s.createElement(o,{key:D,id:v,name:u,label:h.label,description:h.description,checked:C,value:h.value,disabled:T,onChange:S})}))}const i=u=>({container:(0,t.css)({display:"grid",gap:u.spacing(1)})})},87266:(G,I,e)=>{"use strict";e.d(I,{SM:()=>i,Xb:()=>r,g$:()=>o,gm:()=>s,lH:()=>m});var t=e(32196),n=e(16797);const s=u=>(0,t.css)({"&:focus":(0,n.getFocusStyles)(u)}),r=(u,d=!1)=>{const p=d?u.colors.error.border:u.components.input.borderColor,c=d?u.colors.error.shade:u.components.input.borderHover,y=u.components.input.background,f=u.components.input.text,P=u.isDark?"#2e2f35":"#bab4ca";return(0,t.cx)(o(u),(0,t.css)({background:y,lineHeight:u.typography.body.lineHeight,fontSize:u.typography.size.md,color:f,border:`1px solid ${p}`,"&:-webkit-autofill, &:-webkit-autofill:hover":{boxShadow:`inset 0 0 0 1px rgba(255, 255, 255, 0), inset 0 0 0 100px ${y}!important`,WebkitTextFillColor:`${f} !important`,borderColor:P},"&:-webkit-autofill:focus":{boxShadow:`0 0 0 2px ${u.colors.background.primary}, 0 0 0px 4px ${u.colors.primary.main}, inset 0 0 0 1px rgba(255, 255, 255, 0), inset 0 0 0 100px ${y}!important`,WebkitTextFillColor:`${f} !important`},"&:hover":{borderColor:c},"&:focus":{outline:"none"},"&:disabled":{backgroundColor:u.colors.action.disabledBackground,color:u.colors.action.disabledText,border:`1px solid ${u.colors.action.disabledBackground}`,"&:hover":{borderColor:p}},"&::placeholder":{color:u.colors.text.disabled,opacity:1}}))},o=u=>(0,t.css)({padding:u.spacing(0,1,0,1)}),m=()=>({sm:(0,t.css)({width:l("sm")}),md:(0,t.css)({width:l("md")}),lg:(0,t.css)({width:l("lg")}),auto:(0,t.css)({width:l("auto")})}),l=u=>{switch(u){case"sm":return"200px";case"md":return"320px";case"lg":return"580px";case"auto":default:return"auto"}};function i(u,d){switch(u){case"sm":return{padding:1,fontSize:d.typography.size.sm,height:d.components.height.sm};case"lg":return{padding:3,fontSize:d.typography.size.lg,height:d.components.height.lg};case"md":default:return{padding:2,fontSize:d.typography.size.md,height:d.components.height.md}}}},95164:(G,I,e)=>{"use strict";e.d(I,{_:()=>P});var t=e(34796),n=e.n(t),s=e(96540),r=e(83195),o=e(58649),m=e(50082),l=e(52622),i=e(29413),u=e(55852),d=e(24293),p=e(47737);const c={mode:m.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]};function y(a,E,g,h){const D=g!=null,v=h===l.wV.Vertical?E:a,C=Math.min(v*.15/1.5,20),T=C*1.5,S=D?E-T:E,O=Math.min(S,a);return{showLabel:D,gaugeHeight:O,titleFontSize:C}}function f(a,E,g,h){if(E.color?.mode!==d.Y.Thresholds)return[{value:E.min??o.tw,color:g.color??d.F}];const D=E.thresholds??c,v=D.mode===m.O.Percentage,C=D.steps;let T=E.min??o.tw,S=E.max??o.d1;v&&(T=0,S=100);const O=(0,p.yQ)(T,C),x=(0,p.yQ)(S,C),b=[{value:+T.toFixed(a),color:h.visualization.getColorByName(O.color)}];let M=!0;for(let A=0;A<C.length;A++){const R=C[A];if(M){O===R&&(M=!1);continue}const B=C[A-1];if(b.push({value:R.value,color:h.visualization.getColorByName(B.color)}),R===x)break}return b.push({value:+S.toFixed(a),color:h.visualization.getColorByName(x.color)}),b}class P extends s.PureComponent{constructor(){super(...arguments),this.canvasElement=null,this.renderVisualization=()=>{const{width:E,value:g,height:h,onClick:D,text:v,theme:C,orientation:T}=this.props,S=y(E,h,g.title,T),O=T===l.wV.Vertical?`${S.gaugeHeight}px`:"100%",x=s.createElement("div",{style:{height:`${S.gaugeHeight}px`,width:O},ref:b=>this.canvasElement=b});return s.createElement(s.Fragment,null,D?s.createElement("button",{className:(0,u.my)(C),type:"button",onClick:D},x):x,S.showLabel&&s.createElement("div",{style:{textAlign:"center",fontSize:v?.titleSize??S.titleFontSize,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative",width:O,top:"-4px",cursor:"default"}},g.title))}}static{this.defaultProps={showThresholdMarkers:!0,showThresholdLabels:!1,field:{min:0,max:100,thresholds:c}}}componentDidMount(){this.draw()}componentDidUpdate(){this.draw()}draw(){const{field:E,showThresholdLabels:g,showThresholdMarkers:h,width:D,height:v,theme:C,value:T,orientation:S}=this.props,O=y(D,v,T.title),x=S===l.wV.Vertical?O.gaugeHeight:D,b=Math.min(x,O.gaugeHeight),M=C.colors.background.secondary,A=g?1.5:1,R=Math.min(b/5.5,40)/A,B=R/5,U=(0,r.cN)(T),N=Math.min(x,b*1.3)*.9-((R+(h?B:0)+(g?10:0))*2+10),w=this.props.text?.valueSize??(0,i.Vr)(U,N,b,1,R*1.7),L=Math.max(w/2.5,12);let V=E.min??o.tw,K=E.max??o.d1,k=T.numeric;E.thresholds?.mode===m.O.Percentage&&(V=0,K=100,T.percent===void 0?k=(k-V)/(K-V)*100:k=T.percent*100);const j=E.decimals===void 0?2:E.decimals;h&&(V=+V.toFixed(j),K=+K.toFixed(j));const H={series:{gauges:{gauge:{min:V,max:K,neutralValue:E.custom?.neutral,background:{color:M},border:{color:null},shadow:{show:!1},width:R},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0,vMargin:0},cell:{border:{width:0}},threshold:{values:f(j,E,T,C),label:{show:g,margin:B+1,font:{size:L}},show:h,width:B},value:{color:T.color,formatter:()=>U,font:{size:w,family:C.typography.fontFamily}},show:!0}}},J={data:[[0,k]],label:T.title};try{this.canvasElement&&n().plot(this.canvasElement,[J],H)}catch(X){console.error("Gauge rendering error",X,H,T)}}render(){return s.createElement("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},className:this.props.className},this.renderVisualization())}}},14578:(G,I,e)=>{"use strict";e.d(I,{I:()=>i});var t=e(32196),n=e(96540),s=e(8867),r=e(8887),o=e(40845),m=e(78318);const l=u=>({icon:(0,t.css)({display:"inline-block",fill:"currentColor",flexShrink:0,label:"Icon",lineHeight:0,verticalAlign:"middle"}),orange:(0,t.css)({fill:u.v1.palette.orange})}),i=n.forwardRef(({size:u="md",type:d="default",name:p,className:c,style:y,title:f="",...P},a)=>{const E=(0,o.of)(l);(0,r.n6)(p)||console.warn("Icon component passed an invalid icon name",p);const g=p==="fa fa-spinner"?"spinner":p,h=(0,m.Wj)(),D=(0,m.cs)(u),v=D,C=p.startsWith("gf-bar-align")?16:p.startsWith("gf-interp")?30:D,T=(0,m.Xi)(g,d),S=`${h}${T}/${g}.svg`,O=(0,t.cx)(E.icon,c,d==="mono"?{[E.orange]:p==="favorite"}:"",g==="spinner"&&"fa-spin");return n.createElement(s.default,{"aria-hidden":P.tabIndex===void 0&&!f&&!P["aria-label"]&&!P["aria-labelledby"]&&!P["aria-describedby"],innerRef:a,src:S,width:C,height:v,title:f,className:O,style:y,...P})});i.displayName="Icon"},78318:(G,I,e)=>{"use strict";e.d(I,{Wj:()=>o,Xi:()=>n,cs:()=>s});const t=["grafana","favorite","heart-break","heart","panel-add","library-panel","circle-mono"];function n(m,l){return m?.startsWith("gf-")?"custom":t.includes(m)?"mono":l==="default"?"unicons":l==="solid"?"solid":"mono"}function s(m){switch(m){case"xs":return 12;case"sm":return 14;case"md":return 16;case"lg":return 18;case"xl":return 24;case"xxl":return 36;case"xxxl":return 48}}let r;function o(){if(r)return r;const m=typeof window<"u"&&window.__grafana_public_path__;return m?r=m+"img/icons/":r="public/img/icons/",r}},29158:(G,I,e)=>{"use strict";e.d(I,{K:()=>d});var t=e(32196),n=e(96540),s=e(95344),r=e(23596),o=e(40845),m=e(16797),l=e(55852),i=e(78318),u=e(56034);const d=n.forwardRef((c,y)=>{const{size:f="md",variant:P="secondary"}=c;let a;f==="xxl"||f==="xxxl"?((0,s.l)("IconButton",'size="xxl" and size="xxxl"','size="xl"'),a="xl"):a=f;const E=(0,o.of)(p,a,P);let g,h;if("tooltip"in c){const{tooltip:D}=c;g=typeof D=="string"?D:void 0}else if("ariaLabel"in c||"aria-label"in c){const{ariaLabel:D,["aria-label"]:v}=c;g=v||D,h=y}if("tooltip"in c){const{name:D,iconType:v,className:C,tooltip:T,tooltipPlacement:S,...O}=c;return n.createElement(u.m,{ref:y,content:T,placement:S},n.createElement("button",{...O,ref:h,"aria-label":g,className:(0,t.cx)(E.button,C),type:"button"},n.createElement(l.Jt,{icon:D,size:a,className:E.icon,iconType:v})))}else{const{name:D,iconType:v,className:C,...T}=c;return n.createElement("button",{...T,ref:h,"aria-label":g,className:(0,t.cx)(E.button,C),type:"button"},n.createElement(l.Jt,{icon:D,size:a,className:E.icon,iconType:v}))}});d.displayName="IconButton";const p=(c,y,f)=>{const P=(0,i.cs)(y)+c.spacing.gridSize;let a=c.colors.text.primary;return f==="primary"?a=c.colors.primary.text:f==="destructive"&&(a=c.colors.error.text),{button:(0,t.css)({zIndex:0,position:"relative",margin:`0 ${c.spacing.x0_5} 0 0`,boxShadow:"none",border:"none",display:"inline-flex",background:"transparent",justifyContent:"center",alignItems:"center",padding:0,color:a,"&[disabled], &:disabled":{cursor:"not-allowed",color:c.colors.action.disabledText,opacity:.65},"&:before":{zIndex:-1,position:"absolute",opacity:0,width:`${P}px`,height:`${P}px`,borderRadius:c.shape.radius.default,content:'""',[c.transitions.handleMotion("no-preference","reduce")]:{transitionDuration:"0.2s",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionProperty:"opacity"}},"&:focus, &:focus-visible":(0,m.getFocusStyles)(c),"&:focus:not(:focus-visible)":(0,m.getMouseFocusStyles)(c),"&:hover":{"&:before":{backgroundColor:f==="secondary"?c.colors.action.hover:r.alpha(a,.12),opacity:1}}}),icon:(0,t.css)({verticalAlign:"baseline"})}}},86460:(G,I,e)=>{"use strict";e.d(I,{e:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(29678),o=e(37166);const m=n.memo(n.forwardRef(({title:i,featureState:u,...d},p)=>{const c=(0,s.of)(l),y=u?n.createElement(n.Fragment,null,n.createElement("div",{className:c.badge},n.createElement(r.y,{featureState:u})),n.createElement("h3",null,i)):n.createElement("h3",null,i);return n.createElement(o.w,{branded:!0,title:y,urlTitle:"Read documentation",ref:p,...d})}));m.displayName="FeatureInfoBox";const l=i=>({badge:(0,t.css)({marginBottom:i.spacing(1)})})},37166:(G,I,e)=>{"use strict";e.d(I,{w:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(42418),o=e(14578);const m=n.memo(n.forwardRef(({title:i,className:u,children:d,branded:p,url:c,urlTitle:y,onDismiss:f,severity:P="info",...a},E)=>{const g=(0,s.of)(l);return n.createElement(r.F,{severity:P,className:u,...a,ref:E,title:i},n.createElement("div",null,d),c&&n.createElement("a",{href:c,className:(0,t.cx)("external-link",g.docsLink),target:"_blank",rel:"noreferrer"},n.createElement(o.I,{name:"book"})," ",y||"Read more"))}));m.displayName="InfoBox";const l=i=>({docsLink:(0,t.css)({display:"inline-block",marginTop:i.spacing(2)})})},32982:(G,I,e)=>{"use strict";e.d(I,{r:()=>u});var t=e(32196),n=e(34743),s=e(36376),r=e(7315),o=e(96540),m=e(40845),l=e(14578),i=e(17464);function u({referenceElement:c,children:y,suffixIcon:f,placement:P}){const a=(0,m.of)(d),E=(0,m.$j)(),g=[(0,n.cY)(8),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)()],{context:h,refs:D,floatingStyles:v}=(0,s.we)({open:!0,placement:P,middleware:g,whileElementsMounted:r.ll,strategy:"fixed"});(0,o.useLayoutEffect)(()=>{D.setReference(c)},[c,D]);const{styles:C}=(0,s.DL)(h,{initial:({side:T})=>({opacity:0,transform:p(T,E)}),duration:E.transitions.duration.shortest});return o.createElement(i.ZL,null,o.createElement("div",{style:{display:"inline-block",...v},ref:D.setFloating,"aria-live":"polite"},o.createElement("span",{className:(0,t.cx)(a.root),style:C},y&&o.createElement("span",null,y),f&&o.createElement(l.I,{name:f}))))}const d=c=>({root:(0,t.css)({...c.typography.bodySmall,willChange:"transform",background:c.components.tooltip.background,color:c.components.tooltip.text,padding:c.spacing(.5,1.5),borderRadius:c.shape.radius.pill,display:"inline-flex",gap:c.spacing(.5),alignItems:"center"})}),p=(c,y)=>{switch(c){case"top":return`translateY(${y.spacing(1)})`;case"bottom":return`translateY(-${y.spacing(1)})`;case"left":return`translateX(${y.spacing(1)})`;case"right":return`translateX(-${y.spacing(1)})`}}},51440:(G,I,e)=>{"use strict";e.d(I,{D:()=>r});var t=e(96540),n=e(29413),s=e(10354);const r=t.forwardRef((m,l)=>{const{defaultValue:i="",minWidth:u=10,maxWidth:d,onCommitChange:p,onKeyDown:c,onBlur:y,...f}=m,[P,a]=t.useState(i),[E,g]=t.useState(u);return(0,t.useEffect)(()=>{g(o(P.toString(),u,d))},[P,d,u]),t.createElement(s.p,{...f,ref:l,value:P.toString(),onChange:h=>{a(h.currentTarget.value)},width:E,onBlur:h=>{y?y(h):p&&p(h)},onKeyDown:h=>{c?c(h):h.key==="Enter"&&p&&p(h)},"data-testid":"autosize-input"})});function o(m,l,i){if(!m)return l;const d=(0,n.kD)(m.toString(),14).width/8+3;return l&&d<l?l:i&&d>i?i:d}r.displayName="AutoSizeInput"},10354:(G,I,e)=>{"use strict";e.d(I,{n:()=>u,p:()=>i});var t=e(32196),n=e(96540),s=e(71473),r=e(40845),o=e(3911),m=e(87266),l=e(62930);const i=n.forwardRef((d,p)=>{const{className:c,addonAfter:y,addonBefore:f,prefix:P,suffix:a,invalid:E,loading:g,width:h=0,...D}=d,[v,C]=(0,s.A)(),[T,S]=(0,s.A)(),O=(0,r.$j)(),x=u({theme:O,invalid:!!E,width:h});return n.createElement("div",{className:(0,t.cx)(x.wrapper,c),"data-testid":"input-wrapper"},!!f&&n.createElement("div",{className:x.addon},f),n.createElement("div",{className:x.inputWrapper},P&&n.createElement("div",{className:x.prefix,ref:v},P),n.createElement("input",{ref:p,className:x.input,...D,style:{paddingLeft:P?C.width+12:void 0,paddingRight:a||g?S.width+12:void 0}}),(a||g)&&n.createElement("div",{className:x.suffix,ref:T},g&&n.createElement(l.y,{className:x.loadingIndicator,inline:!0}),a)),!!y&&n.createElement("div",{className:x.addon},y))});i.displayName="Input";const u=(0,o.N)(({theme:d,invalid:p=!1,width:c})=>{const y="28px",f=(0,t.css)({position:"absolute",top:0,zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,fontSize:d.typography.size.md,height:"100%",minWidth:y,color:d.colors.text.secondary});return{wrapper:(0,t.cx)((0,t.css)({label:"input-wrapper",display:"flex",width:c?d.spacing(c):"100%",height:d.spacing(d.components.height.md),borderRadius:d.shape.radius.default,"&:hover":{"> .prefix, .suffix, .input":{borderColor:p?d.colors.error.border:d.colors.primary.border},"input[type='number']":{appearance:"textfield"},"input[type='number']::-webkit-inner-spin-button, input[type='number']::-webkit-outer-spin-button":{WebkitAppearance:"inner-spin-button !important",opacity:1}}})),inputWrapper:(0,t.css)({label:"input-inputWrapper",position:"relative",flexGrow:1,zIndex:1,"&:not(:first-child):last-child":{"> input":{borderLeft:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0}},"&:first-child:not(:last-child)":{"> input":{borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0}},"&:not(:first-child):not(:last-child)":{"> input":{borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0,borderTopLeftRadius:0,borderBottomLeftRadius:0}},input:{"&:not(:first-child)":{paddingLeft:y},"&:not(:last-child)":{paddingRight:y},"&[readonly]":{cursor:"default"}}}),input:(0,t.cx)((0,m.gm)(d),(0,m.Xb)(d,p),(0,t.css)({label:"input-input",position:"relative",zIndex:0,flexGrow:1,borderRadius:d.shape.radius.default,height:"100%",width:"100%"})),inputDisabled:(0,t.css)({backgroundColor:d.colors.action.disabledBackground,color:d.colors.action.disabledText,border:`1px solid ${d.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}),addon:(0,t.css)({label:"input-addon",display:"flex",justifyContent:"center",alignItems:"center",flexGrow:0,flexShrink:0,position:"relative","&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0,"> :last-child":{borderTopRightRadius:0,borderBottomRightRadius:0}},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0,"> :first-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0}},"> *:focus":{zIndex:2}}),prefix:(0,t.cx)(f,(0,t.css)({label:"input-prefix",paddingLeft:d.spacing(1),paddingRight:d.spacing(.5),borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0})),suffix:(0,t.cx)(f,(0,t.css)({label:"input-suffix",paddingLeft:d.spacing(1),paddingRight:d.spacing(1),marginBottom:"-2px",borderLeft:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0,right:0})),loadingIndicator:(0,t.css)({"& + *":{marginLeft:d.spacing(.5)}})}})},16504:(G,I,e)=>{"use strict";e.d(I,{e:()=>n});var t=e(49785);const n=t.xI},48840:(G,I,e)=>{"use strict";e.d(I,{j:()=>E});var t=e(32196),n=e(2543),s=e(96540),r=e(32885),o=e(39070),m=e(40845),l=e(14578),i=e(19384),u=e(56034),d=e(29158);const p=(0,t.css)({display:"flex",alignItems:"center",height:"100%"});function c({row:v,__rowID:C}){return s.createElement("div",{className:p},s.createElement(d.K,{tooltip:"toggle row expanded","aria-controls":C,name:v.isExpanded?"angle-down":"angle-right","aria-expanded":v.isExpanded,...v.getToggleRowExpandedProps(),size:"lg"}))}function y({isAllRowsExpanded:v,toggleAllRowsExpanded:C}){return s.createElement("div",{className:p},s.createElement(d.K,{"aria-label":v?"Collapse all rows":"Expand all rows",name:v?"table-collapse-all":"table-expand-all",onClick:()=>C(),size:"lg",tooltip:v?"Collapse all rows":"Expand all rows",variant:"secondary"}))}const f="__expander";function P(v,C=!1){return[{id:f,Cell:c,...C&&{Header:y},disableSortBy:!0,width:0},...v.map(T=>({id:T.id,accessor:T.id,Header:T.header||(()=>null),sortType:T.sortType||"alphanumeric",disableSortBy:!T.sortType,width:T.disableGrow?0:void 0,visible:T.visible,...T.cell&&{Cell:T.cell}}))]}const a=v=>{const C=v.colors.emphasize(v.colors.background.primary,.03);return{container:(0,t.css)({display:"flex",gap:v.spacing(2),flexDirection:"column",width:"100%",overflowX:"auto"}),table:(0,t.css)({borderRadius:v.shape.radius.default,width:"100%",td:{padding:v.spacing(1)},"td, th":{minWidth:v.spacing(3)}}),disableGrow:(0,t.css)({width:0}),header:(0,t.css)({borderBottom:`1px solid ${v.colors.border.weak}`,"&, & > button":{position:"relative",whiteSpace:"nowrap",padding:v.spacing(1)},"& > button":{"&:after":{content:'"\\00a0"'},width:"100%",height:"100%",background:"none",border:"none",paddingRight:v.spacing(2.5),textAlign:"left",fontWeight:v.typography.fontWeightMedium}}),row:(0,t.css)({label:"row",borderBottom:`1px solid ${v.colors.border.weak}`,"&:hover":{backgroundColor:C},"&:last-child":{borderBottom:0}}),expandedRow:(0,t.css)({label:"expanded-row-content",borderBottom:"none"}),expandedContentRow:(0,t.css)({label:"expanded-row-content",td:{borderBottom:`1px solid ${v.colors.border.weak}`,position:"relative",padding:v.spacing(2,2,2,5),"&:before":{content:'""',position:"absolute",width:"1px",top:0,left:"16px",bottom:v.spacing(2),background:v.colors.border.medium}}}),sortableHeader:(0,t.css)({"&&":{padding:0}})}};function E({className:v,columns:C,data:T,getRowId:S,headerTooltips:O,pageSize:x=0,renderExpandedRow:b,showExpandAll:M=!1,fetchData:A}){const R=(0,m.of)(a),B=(0,s.useMemo)(()=>P(C,M),[C,M]),U=g(),W=(0,s.useCallback)(X=>`${U}-${X.id}`.replace(/\s/g,""),[U]),N=[r.useSortBy,r.useExpanded],w=T.length>x,L=x>0;L&&N.push(r.usePagination);const V=(0,r.useTable)({columns:B,data:T,autoResetExpanded:!1,autoResetSortBy:!1,disableMultiSort:!0,manualSortBy:!!A,getRowId:S,initialState:{hiddenColumns:[!b&&f,...B.filter(X=>!(!X.visible||X.visible(T))).map(X=>X.id).filter(o.zz)].filter(o.zz)}},...N),{getTableProps:K,getTableBodyProps:k,headerGroups:j,prepareRow:H}=V,{sortBy:J}=V.state;return(0,s.useEffect)(()=>{A&&A({sortBy:J})},[J,A]),(0,s.useEffect)(()=>{L&&V.setPageSize(x)},[L,x,V.setPageSize,V]),s.createElement("div",{className:R.container},s.createElement("table",{...K(),className:(0,t.cx)(R.table,v)},s.createElement("thead",null,j.map(X=>{const{key:se,...ae}=X.getHeaderGroupProps();return s.createElement("tr",{key:se,...ae},X.headers.map(ne=>{const{key:q,...ee}=ne.getHeaderProps(),z=O?.[ne.id];return s.createElement("th",{key:q,className:(0,t.cx)(R.header,{[R.disableGrow]:ne.width===0,[R.sortableHeader]:ne.canSort}),...ee,...ne.isSorted&&{"aria-sort":ne.isSortedDesc?"descending":"ascending"}},s.createElement(D,{column:ne,headerTooltip:z}))}))})),s.createElement("tbody",{...k()},(L?V.page:V.rows).map(X=>{H(X);const{key:se,...ae}=X.getRowProps(),ne=W(X),q=X.isExpanded;return s.createElement(s.Fragment,{key:se},s.createElement("tr",{...ae,className:(0,t.cx)(R.row,q&&R.expandedRow)},X.cells.map(ee=>{const{key:z,...te}=ee.getCellProps();return s.createElement("td",{key:z,...te},ee.render("Cell",{__rowID:ne}))})),q&&b&&s.createElement("tr",{...ae,id:ne,className:R.expandedContentRow},s.createElement("td",{colSpan:X.cells.length},b(X.original))))}))),L&&w&&s.createElement("span",null,s.createElement(i.d,{currentPage:V.state.pageIndex+1,numberOfPages:V.pageOptions.length,onNavigate:X=>V.gotoPage(X-1)})))}const g=()=>(0,s.useMemo)(()=>(0,n.uniqueId)("InteractiveTable"),[]),h=v=>({sortIcon:(0,t.css)({position:"absolute",top:v.spacing(1)}),headerTooltipIcon:(0,t.css)({marginLeft:v.spacing(.5)})});function D({column:{canSort:v,render:C,isSorted:T,isSortedDesc:S,getSortByToggleProps:O},headerTooltip:x}){const b=(0,m.of)(h),{onClick:M}=O(),A=s.createElement(s.Fragment,null,C("Header"),x&&s.createElement(u.m,{theme:"info-alt",content:x.content,placement:"top-end"},s.createElement(l.I,{className:b.headerTooltipIcon,name:x.iconName||"info-circle","data-testid":"header-tooltip-icon"})),T&&s.createElement("span",{"aria-hidden":"true",className:b.sortIcon},s.createElement(l.I,{name:S?"angle-down":"angle-up"})));return v?s.createElement("button",{type:"button",onClick:M},A):A}},24022:(G,I,e)=>{"use strict";e.d(I,{B:()=>s});var t=e(96540),n=e(44533);class s extends t.PureComponent{constructor(){super(...arguments),this.wrapperRef=(0,t.createRef)(),this.renderJson=()=>{const{json:o,config:m,open:l,onDidRender:i}=this.props,u=this.wrapperRef.current,d=new n.O(o,l,m);u.hasChildNodes()?u.replaceChild(d.render(),u.lastChild):u.appendChild(d.render()),i&&i(d.json)}}static{this.defaultProps={open:3,config:{animateOpen:!0}}}componentDidMount(){this.renderJson()}componentDidUpdate(){this.renderJson()}render(){const{className:o}=this.props;return t.createElement("div",{className:o,ref:this.wrapperRef})}}},44533:(G,I,e)=>{"use strict";e.d(I,{O:()=>E});var t=e(2543);function n(g){return g.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function s(g){return!!g&&typeof g==="object"}function r(g){if(g===void 0)return"";if(g===null||typeof g=="object"&&!g.constructor)return"Object";const D=/function ([^(]*)/.exec(g.constructor.toString());return D&&D.length>1?D[1]:""}function o(g){return g===null?"null":typeof g}function m(g,h){const D=o(g);return D==="null"||D==="undefined"?D:(D==="string"&&(h='"'+n(h)+'"'),D==="function"?g.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{\u2026}":h)}let l="";function i(g){return s(g)?(l=r(g),Array.isArray(g)&&(l+="["+g.length+"]")):l=m(g,g.toString()),l}function u(g){return`json-formatter-${g}`}function d(g,h,D){const v=document.createElement(g);return h&&v.classList.add(u(h)),D!==void 0&&(D instanceof Node?v.appendChild(D):v.appendChild(document.createTextNode(String(D)))),v}const p=/(^\d{1,4}[\.|\\/|-]\d{1,2}[\.|\\/|-]\d{1,4})(\s*(?:0?[1-9]:[0-5]|1(?=[012])\d:[0-5])\d\s*[ap]m)?$/,c=/\d{2}:\d{2}:\d{2} GMT-\d{4}/,y=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,f=10,P=typeof window<"u"&&window.requestAnimationFrame||(g=>(g(),0)),a={animateOpen:!0,animateClose:!0};class E{constructor(h,D=1,v=a,C){this.json=h,this.open=D,this.config=v,this.key=C,this._isOpen=null,this.element=null,this.skipChildren=!1}get isOpen(){return this._isOpen!==null?this._isOpen:this.open>0}set isOpen(h){this._isOpen=h}get isDate(){return this.type==="string"&&(p.test(this.json)||y.test(this.json)||c.test(this.json))}get isUrl(){return this.type==="string"&&this.json.indexOf("http")===0}get isArray(){return Array.isArray(this.json)}get isObject(){return s(this.json)}get isEmptyObject(){return!this.keys.length&&!this.isArray}get isEmpty(){return this.isEmptyObject||this.keys&&!this.keys.length&&this.isArray}get hasKey(){return typeof this.key<"u"}get constructorName(){return r(this.json)}get type(){return o(this.json)}get keys(){return this.isObject?Object.keys(this.json).map(h=>h||'""'):[]}toggleOpen(){this.isOpen=!this.isOpen,this.element&&(this.isOpen?this.appendChildren(this.config.animateOpen):this.removeChildren(this.config.animateClose),this.element.classList.toggle(u("open")))}openAtDepth(h=1){h<0||(this.open=h,this.isOpen=h!==0,this.element&&(this.removeChildren(!1),h===0?this.element.classList.remove(u("open")):(this.appendChildren(this.config.animateOpen),this.element.classList.add(u("open")))))}isNumberArray(){return this.json.length>0&&this.json.length<4&&((0,t.isNumber)(this.json[0])||(0,t.isNumber)(this.json[1]))}renderArray(){const h=d("span");return h.appendChild(d("span","bracket","[")),this.isNumberArray()?(this.json.forEach((D,v)=>{v>0&&h.appendChild(d("span","array-comma",",")),h.appendChild(d("span","number",D))}),this.skipChildren=!0):h.appendChild(d("span","number",this.json.length)),h.appendChild(d("span","bracket","]")),h}render(h=!1){this.element=d("div","row");const D=d("a","toggler-link"),v=d("span","toggler");if(this.isObject&&D.appendChild(v),this.hasKey&&D.appendChild(d("span","key",`${this.key}:`)),this.isObject){const T=d("span","value"),S=d("span"),O=d("span","constructor-name",this.constructorName);if(S.appendChild(O),this.isArray){const x=this.renderArray();S.appendChild(x)}T.appendChild(S),D.appendChild(T)}else{const T=this.isUrl?d("a"):d("span");T.classList.add(u(this.type)),this.isDate&&T.classList.add(u("date")),this.isUrl&&(T.classList.add(u("url")),T.setAttribute("href",this.json));const S=m(this.json,this.json);T.appendChild(document.createTextNode(S)),D.appendChild(T)}const C=d("div","children");return this.isObject&&C.classList.add(u("object")),this.isArray&&C.classList.add(u("array")),this.isEmpty&&C.classList.add(u("empty")),this.config&&this.config.theme&&this.element.classList.add(u(this.config.theme)),this.isOpen&&this.element.classList.add(u("open")),h||this.element.appendChild(D),this.skipChildren?D.removeChild(v):this.element.appendChild(C),this.isObject&&this.isOpen&&this.appendChildren(),this.isObject&&D.addEventListener("click",this.toggleOpen.bind(this)),this.element}appendChildren(h=!1){const D=this.element&&this.element.querySelector(`div.${u("children")}`);if(!(!D||this.isEmpty))if(h){let v=0;const C=()=>{const T=this.keys[v],S=new E(this.json[T],this.open-1,this.config,T);D.appendChild(S.render()),v+=1,v<this.keys.length&&(v>f?C():P(C))};P(C)}else this.keys.forEach(v=>{const C=new E(this.json[v],this.open-1,this.config,v);D.appendChild(C.render())})}removeChildren(h=!1){const D=this.element&&this.element.querySelector(`div.${u("children")}`);if(h){let v=0;const C=()=>{D&&D.children.length&&(D.removeChild(D.children[0]),v+=1,v>f?C():P(C))};P(C)}else D&&(D.innerHTML="")}}},90613:(G,I,e)=>{"use strict";e.d(I,{a:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(16795),o=e(55738);const m=(0,n.forwardRef)((d,p)=>{const{children:c,margin:y,marginX:f,marginY:P,marginTop:a,marginBottom:E,marginLeft:g,marginRight:h,padding:D,paddingX:v,paddingY:C,paddingTop:T,paddingBottom:S,paddingLeft:O,paddingRight:x,display:b,backgroundColor:M,grow:A,shrink:R,basis:B,flex:U,borderColor:W,borderStyle:N,borderRadius:w,direction:L,justifyContent:V,alignItems:K,boxShadow:k,element:j,gap:H,width:J,minWidth:X,maxWidth:se,height:ae,minHeight:ne,maxHeight:q,...ee}=d,z=(0,s.of)(u,y,f,P,a,E,g,h,D,v,C,T,S,O,x,b,M,A,R,B,U,W,N,w,L,V,K,k,H),te=(0,s.of)(o.E,J,X,se,ae,ne,q),ie=j??"div";return n.createElement(ie,{ref:p,className:(0,t.cx)(z.root,te),...ee},c)});m.displayName="Box";const l=(d,p)=>{switch(d){case"error":case"success":case"info":case"warning":return p.colors[d].borderTransparent;default:return d?p.colors.border[d]:void 0}},i=(d,p)=>{switch(d){case"error":case"success":case"info":case"warning":return p.colors[d].transparent;default:return d?p.colors.background[d]:void 0}},u=(d,p,c,y,f,P,a,E,g,h,D,v,C,T,S,O,x,b,M,A,R,B,U,W,N,w,L,V,K)=>({root:(0,t.css)([(0,r.Y)(d,p,k=>({margin:d.spacing(k)})),(0,r.Y)(d,c,k=>({marginLeft:d.spacing(k),marginRight:d.spacing(k)})),(0,r.Y)(d,y,k=>({marginTop:d.spacing(k),marginBottom:d.spacing(k)})),(0,r.Y)(d,f,k=>({marginTop:d.spacing(k)})),(0,r.Y)(d,P,k=>({marginBottom:d.spacing(k)})),(0,r.Y)(d,a,k=>({marginLeft:d.spacing(k)})),(0,r.Y)(d,E,k=>({marginRight:d.spacing(k)})),(0,r.Y)(d,g,k=>({padding:d.spacing(k)})),(0,r.Y)(d,h,k=>({paddingLeft:d.spacing(k),paddingRight:d.spacing(k)})),(0,r.Y)(d,D,k=>({paddingTop:d.spacing(k),paddingBottom:d.spacing(k)})),(0,r.Y)(d,v,k=>({paddingTop:d.spacing(k)})),(0,r.Y)(d,C,k=>({paddingBottom:d.spacing(k)})),(0,r.Y)(d,T,k=>({paddingLeft:d.spacing(k)})),(0,r.Y)(d,S,k=>({paddingRight:d.spacing(k)})),(0,r.Y)(d,O,k=>({display:k})),(0,r.Y)(d,x,k=>({backgroundColor:i(k,d)})),(0,r.Y)(d,N,k=>({flexDirection:k})),(0,r.Y)(d,b,k=>({flexGrow:k})),(0,r.Y)(d,M,k=>({flexShrink:k})),(0,r.Y)(d,A,k=>({flexBasis:k})),(0,r.Y)(d,R,k=>({flex:k})),(0,r.Y)(d,U,k=>({borderStyle:k})),(0,r.Y)(d,B,k=>({borderColor:l(k,d)})),(U||B)&&{borderWidth:"1px"},(0,r.Y)(d,w,k=>({justifyContent:k})),(0,r.Y)(d,L,k=>({alignItems:k})),(0,r.Y)(d,W,k=>({borderRadius:d.shape.radius[k]})),(0,r.Y)(d,V,k=>({boxShadow:d.shadows[k]})),(0,r.Y)(d,K,k=>({gap:d.spacing(k)}))])})},71259:(G,I,e)=>{"use strict";e.d(I,{x:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(16795);const o=(0,n.forwardRef)((l,i)=>{const{alignItems:u,children:d,gap:p,columns:c,minColumnWidth:y,...f}=l,P=(0,s.of)(m,p,c,y,u);return n.createElement("div",{ref:i,...f,className:P.grid},d)});o.displayName="Grid";const m=(l,i,u,d,p)=>({grid:(0,t.css)([{display:"grid"},(0,r.Y)(l,i,c=>({gap:l.spacing(c)})),d&&(0,r.Y)(l,d,c=>({gridTemplateColumns:`repeat(auto-fill, minmax(${l.spacing(c)}, 1fr))`})),u&&(0,r.Y)(l,u,c=>({gridTemplateColumns:`repeat(${c}, 1fr)`})),(0,r.Y)(l,p,c=>({alignItems:c}))])})},66864:(G,I,e)=>{"use strict";e.d(I,{Gy:()=>m,PE:()=>o,gW:()=>l,mc:()=>i});var t=e(32196),n=e(96540),s=e(40845),r=(c=>(c[c.Horizontal=0]="Horizontal",c[c.Vertical=1]="Vertical",c))(r||{});const o=({children:c,orientation:y=0,spacing:f="sm",justify:P="flex-start",align:a="normal",wrap:E=!1,width:g="100%",height:h="100%",...D})=>{const v=(0,s.of)(u,y,f,P,a,E);return n.createElement("div",{className:v.layout,style:{width:g,height:h},...D},n.Children.toArray(c).filter(Boolean).map((C,T)=>n.createElement("div",{className:v.childWrapper,key:T},C)))},m=({children:c,spacing:y,justify:f,align:P="center",wrap:a,width:E,height:g})=>n.createElement(o,{spacing:y,justify:f,orientation:0,align:P,width:E,height:g,wrap:a},c),l=({children:c,spacing:y,justify:f,align:P,width:a,height:E})=>n.createElement(o,{spacing:y,justify:f,orientation:1,align:P,width:a,height:E},c),i=({children:c,padding:y,margin:f,grow:P,shrink:a})=>{const E=(0,s.of)(p,y,f);return n.createElement("div",{className:(0,t.cx)(E.wrapper,P!==void 0&&(0,t.css)({flexGrow:P}),a!==void 0&&(0,t.css)({flexShrink:a}))},c)},u=(c,y,f,P,a,E)=>{const g=f!=="none"?c.spacing(d[f]):0,h=y===0&&!E||y===1?0:`-${g}`,D=y===1?"vertical-group":"horizontal-group";return{layout:(0,t.css)({label:D,display:"flex",flexDirection:y===1?"column":"row",flexWrap:E?"wrap":"nowrap",justifyContent:P,alignItems:a,height:"100%",maxWidth:"100%",marginBottom:h}),childWrapper:(0,t.css)({label:"layoutChildrenWrapper",marginBottom:y===0&&!E?0:g,marginRight:y===0?g:0,display:"flex",alignItems:a,"&:last-child":{marginBottom:y===1?0:void 0,marginRight:y===0?0:void 0}})}},d={none:0,xs:.5,sm:1,md:2,lg:3},p=(c,y,f)=>{const P=y&&y!=="none"&&c.spacing(d[y])||0,a=f&&f!=="none"&&c.spacing(d[f])||0;return{wrapper:(0,t.css)({label:"container",margin:a,padding:P})}}},68402:(G,I,e)=>{"use strict";e.d(I,{$:()=>s});var t=e(96540),n=e(90613);const s=({v:r=0,h:o=0,layout:m})=>t.createElement(n.a,{paddingRight:o,paddingBottom:r,display:m==="inline"?"inline-block":"block"})},67061:(G,I,e)=>{"use strict";e.d(I,{B:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(16795),o=e(55738);const m=n.forwardRef((i,u)=>{const{gap:d=1,alignItems:p,justifyContent:c,direction:y,wrap:f,children:P,grow:a,shrink:E,basis:g,flex:h,width:D,minWidth:v,maxWidth:C,height:T,minHeight:S,maxHeight:O,...x}=i,b=(0,s.of)(l,d,p,c,y,f,a,E,g,h),M=(0,s.of)(o.E,D,v,C,T,S,O);return n.createElement("div",{ref:u,className:(0,t.cx)(b.flex,M),...x},P)});m.displayName="Stack";const l=(i,u,d,p,c,y,f,P,a,E)=>({flex:(0,t.css)([{display:"flex"},(0,r.Y)(i,c,g=>({flexDirection:g})),(0,r.Y)(i,y,g=>({flexWrap:g})),(0,r.Y)(i,d,g=>({alignItems:g})),(0,r.Y)(i,p,g=>({justifyContent:g})),(0,r.Y)(i,u,g=>({gap:i.spacing(g)})),(0,r.Y)(i,f,g=>({flexGrow:g})),(0,r.Y)(i,P,g=>({flexShrink:g})),(0,r.Y)(i,a,g=>({flexBasis:g})),(0,r.Y)(i,E,g=>({flex:g}))])})},16795:(G,I,e)=>{"use strict";e.d(I,{Y:()=>n});function t(s,r,o,m){const l=r[m];if(l!=null)return{[s.breakpoints.up(m)]:o(l)}}function n(s,r,o){return r==null?null:typeof r!="object"||!("xs"in r)?o(r):[t(s,r,o,"xs"),t(s,r,o,"sm"),t(s,r,o,"md"),t(s,r,o,"lg"),t(s,r,o,"xl"),t(s,r,o,"xxl")]}},55738:(G,I,e)=>{"use strict";e.d(I,{E:()=>s});var t=e(32196),n=e(16795);const s=(r,o,m,l,i,u,d)=>(0,t.css)([(0,n.Y)(r,o,p=>({width:r.spacing(p)})),(0,n.Y)(r,m,p=>({minWidth:r.spacing(p)})),(0,n.Y)(r,l,p=>({maxWidth:r.spacing(p)})),(0,n.Y)(r,i,p=>({height:r.spacing(p)})),(0,n.Y)(r,u,p=>({minHeight:r.spacing(p)})),(0,n.Y)(r,d,p=>({maxHeight:r.spacing(p)}))])},50720:(G,I,e)=>{"use strict";e.d(I,{N:()=>o});var t=e(96540),n=e(54625),s=e(71733),r=e(40672);const o=(0,t.forwardRef)(({href:m,children:l,...i},u)=>{const d=s.I.stripBaseFromUrl(r.sQ.sanitizeUrl(m??""));return t.createElement(n.Link,{ref:u,to:d,...i},l)});o.displayName="Link"},72109:(G,I,e)=>{"use strict";e.d(I,{Y:()=>d});var t=e(32196),n=e(96540),s=e(40672),r=e(71733),o=e(40845),m=e(14578),l=e(71356),i=e(50720);const u={h1:"xl",h2:"xl",h3:"lg",h4:"lg",h5:"md",h6:"md",body:"md",bodySmall:"xs"},d=(0,n.forwardRef)(({href:c,color:y="link",external:f=!1,inline:P=!0,variant:a="body",weight:E,icon:g,children:h,...D},v)=>{const C=s.sQ.sanitizeUrl(c??""),T=(0,o.$j)(),S=p(T,P,a,E,y),O=g||"external-link-alt";if(f)return n.createElement("a",{href:C,ref:v,...D,target:"_blank",rel:"noreferrer",className:S},h,n.createElement(m.I,{size:u[a]||"md",name:O}));const x=r.I.stripBaseFromUrl(C);return n.createElement(i.N,{ref:v,href:x,...D,className:S},h,g&&n.createElement(m.I,{name:g,size:u[a]||"md"}))});d.displayName="TextLink";const p=(c,y,f,P,a)=>(0,t.css)([f&&{...c.typography[f]},P&&{fontWeight:(0,l.iV)(P,c)},a&&{color:c.colors.text[a]},{alignItems:"center",gap:"0.25em",display:"inline-flex",textDecoration:"none","&:hover":{textDecoration:"underline",color:c.colors.text.link}},y&&{textDecoration:"underline","&:hover":{textDecoration:"none"}}])},85918:(G,I,e)=>{"use strict";e.d(I,{p:()=>o});var t=e(32196),n=e(96540),s=e(3911);const r=(0,s.N)((m=!1)=>({list:(0,t.css)({listStyleType:"none",margin:0,padding:0}),item:(0,t.css)({display:m&&"inline-block"||"block"})}));class o extends n.PureComponent{constructor(l){super(l)}render(){const{items:l,renderItem:i,getItemKey:u,className:d,inline:p}=this.props,c=r(p);return n.createElement("ul",{className:(0,t.cx)(c.list,d)},l.map((y,f)=>n.createElement("li",{className:c.item,key:u?u(y):f},i(y,f))))}}},1551:(G,I,e)=>{"use strict";e.d(I,{c:()=>s});var t=e(96540),n=e(85918);class s extends t.PureComponent{render(){return t.createElement(n.p,{inline:!0,...this.props})}}},33552:(G,I,e)=>{"use strict";e.d(I,{B:()=>s});var t=e(96540),n=e(85918);class s extends t.PureComponent{render(){return t.createElement(n.p,{...this.props})}}},57514:(G,I,e)=>{"use strict";e.d(I,{G:()=>d});var t=e(32196),n=e(96540),s=e(40845);const r=28,o=2.4,m=500,l=4e3,i=300,u=100/r*100;function d({width:c,delay:y=i,ariaLabel:f="Loading bar"}){const P=Math.min(Math.max(Math.round(c*o),m),l),a=(0,s.of)(p,y,P),E={overflow:"hidden"};return n.createElement("div",{style:E},n.createElement("div",{"aria-label":f,className:a.bar}))}const p=(c,y,f)=>{const P=(0,t.keyframes)({"0%":{transform:"translateX(-100%)"},"85%, 100%":{transform:`translateX(${u}%)`}});return{bar:(0,t.css)({width:r+"%",height:1,background:"linear-gradient(90deg, rgba(110, 159, 255, 0) 0%, #6E9FFF 80.75%, rgba(110, 159, 255, 0) 100%)",transform:"translateX(-100%)",willChange:"transform",[c.transitions.handleMotion("no-preference")]:{animationName:P,animationDelay:`${y}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${f}ms`},[c.transitions.handleMotion("reduce")]:{animationName:P,animationDelay:`${y}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${4*f}ms`}})}}},39558:(G,I,e)=>{"use strict";e.d(I,{_:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(62930);const o=({text:l,className:i,...u})=>{const d=(0,s.of)(m);return n.createElement("div",{className:(0,t.cx)(d.container,i),...u},l," ",n.createElement(r.y,{inline:!0}))},m=l=>({container:(0,t.css)({marginBottom:l.spacing(4)})})},76218:(G,I,e)=>{"use strict";e.d(I,{O:()=>r});var t=e(96540),n=e(21594),s=e(64278);const r=({value:o,onChange:m,context:l,item:i})=>{const u=i.settings??{},d=(0,s.sE)(l.data,u?.filter),p=(0,s.m3)(d,o,void 0,void 0,u.baseNameMode),c=(0,t.useCallback)(f=>{if(!(f&&!(0,s.v3)(f.value,d)))return m(f?.value)},[d,m]),y=p.find(f=>f.value===o);return t.createElement(t.Fragment,null,t.createElement(n.l6,{value:y,placeholder:u.placeholderText??"Select field",options:p,onChange:c,noOptionsMessage:u.noFieldsMessage,width:u.width,isClearable:u.isClearable!==!1}))}},9988:(G,I,e)=>{"use strict";e.d(I,{bx:()=>i,cH:()=>p});var t=e(96540),n=e(11261),s=e(1173),r=e(85200),o=e(4025),m=e(21594);const l=(0,t.memo)(c=>{const{data:y,options:f,onChange:P,id:a}=c,E=u(y),g=d(E,f),h=(0,t.useCallback)(v=>P(v.value),[P]),D=g.find(v=>v.value===f);return t.createElement(m.l6,{inputId:a,value:D,options:g,onChange:h})});l.displayName="FieldTypeMatcherEditor";const i=[{value:n.PU.number,label:"Number",icon:(0,o.lV)(n.PU.number)},{value:n.PU.string,label:"String",icon:(0,o.lV)(n.PU.string)},{value:n.PU.time,label:"Time",icon:(0,o.lV)(n.PU.time)},{value:n.PU.boolean,label:"Boolean",icon:(0,o.lV)(n.PU.boolean)},{value:n.PU.trace,label:"Traces",icon:(0,o.lV)(n.PU.trace)},{value:n.PU.enum,label:"Enum",icon:(0,o.lV)(n.PU.enum)},{value:n.PU.other,label:"Other",icon:(0,o.lV)(n.PU.other)}],u=c=>(0,t.useMemo)(()=>{const y=new Map;for(const f of i)y.set(f.value,0);for(const f of c)for(const P of f.fields){const a=P.type||n.PU.other;let E=y.get(a);E||(E=0),y.set(a,E+1)}return y},[c]),d=(c,y)=>(0,t.useMemo)(()=>{let f=!1;const P=[];for(const a of i){const E=c.get(a.value),g=y===a.value;(E||g)&&P.push({...a,label:`${a.label} (${c.get(a.value)})`}),g&&(f=!0)}return y&&!f&&P.push({value:y,label:`${y} (No matches)`}),P},[c,y]),p={id:s.Ct.byType,component:l,matcher:r.sJ.get(s.Ct.byType),name:"Fields with type",description:"Set properties for fields of a specific type (number, string, boolean)",optionsToLabel:c=>c}},19346:(G,I,e)=>{"use strict";e.d(I,{N:()=>d,r1:()=>f});var t=e(32196),n=e(96540),s=e(75059),r=e(1173),o=e(85200),m=e(52622),l=e(40845),i=e(10354),u=e(21594);const d=[{label:"==",value:m.zT.EQ},{label:"!=",value:m.zT.NEQ},{label:">",value:m.zT.GT},{label:">=",value:m.zT.GTE},{label:"<",value:m.zT.LT},{label:"<=",value:m.zT.LTE}];function p(P){return P===s.gy.allIsNull||P===s.gy.allIsZero}const c=({options:P,onChange:a})=>{const E=(0,l.of)(y),g=(0,n.useMemo)(()=>s.AS.selectOptions([P?.reducer]),[P?.reducer]),h=(0,n.useCallback)(S=>a({...P,reducer:S.value}),[P,a]),D=(0,n.useCallback)(S=>a({...P,op:S.value}),[P,a]),v=(0,n.useCallback)(S=>{const O=S.currentTarget.valueAsNumber;return a({...P,value:O})},[P,a]),C=P??{},T=p(P.reducer);return n.createElement("div",{className:E.spot},n.createElement(u.l6,{value:g.current,options:g.options,onChange:h,placeholder:"Select field reducer"}),C.reducer&&!T&&n.createElement(n.Fragment,null,n.createElement(u.l6,{value:d.find(S=>S.value===C.op),options:d,onChange:D,"aria-label":"Comparison operator",width:19}),n.createElement(i.p,{type:"number",value:C.value,onChange:v})))},y=P=>({spot:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end",gap:"4px"})}),f={id:r.Ct.byValue,component:c,matcher:o.sJ.get(r.Ct.byValue),name:"Fields with values",description:"Set properties for fields with reducer condition",optionsToLabel:P=>`${P?.reducer} ${P?.op} ${P?.value}`}},74668:(G,I,e)=>{"use strict";e.d(I,{R:()=>d,X:()=>l});var t=e(96540),n=e(28240),s=e(1173),r=e(85200),o=e(21594);const m=(p,c,y)=>{if(!y)return;let f=p.find(P=>!c.some(a=>P===a));if(f)return f};function l({value:p,data:c,onChange:y,placeholder:f}){const P=(0,t.useMemo)(()=>i(c),[c]),[a,E]=(0,t.useState)({refIds:[],value:void 0}),g=(0,t.useMemo)(()=>P.find(D=>D.value===p)??m(P,a.refIds,a.value),[p,P,a]),h=(0,t.useCallback)(D=>{y(D?.value)},[y]);return(P!==a.refIds||g?.value!==a.value)&&E({refIds:P,value:g?.value}),t.createElement(o.l6,{options:P,onChange:h,isClearable:!0,placeholder:f??"Select query refId",value:g})}function i(p){const c=new Map;for(const f of p){const P=f.refId??"",a=c.get(P)??[];a.length===0&&c.set(P,a),a.push(f)}const y=[];for(const[f,P]of c.entries())y.push({value:f,label:`Query: ${f??"(missing refId)"}`,description:u(P)});return y}function u(p){return`Frames (${p.length}):
    ${p.slice(0,Math.min(3,p.length)).map(c=>(0,n.Ri)(c)).join(", ")} ${p.length>3?"...":""}`}const d={id:s.Ct.byFrameRefID,component:p=>t.createElement(l,{value:p.options,data:p.data,onChange:p.onChange}),matcher:r.sJ.get(s.Ct.byFrameRefID),name:"Fields returned by query",description:"Set properties for fields from a specific query",optionsToLabel:p=>p}},84349:(G,I,e)=>{"use strict";e.d(I,{g:()=>E});var t=e(83077),n=e(96540),s=e(1173),r=e(85200),o=e(10354);const m=(0,n.memo)(g=>{const{options:h,onChange:D}=g,v=(0,n.useCallback)(C=>D(C.target.value),[D]);return n.createElement(o.p,{placeholder:"Enter regular expression",defaultValue:h,onBlur:v})});m.displayName="FieldNameByRegexMatcherEditor";const l={id:s.Ct.byRegexp,component:m,matcher:r.sJ.get(s.Ct.byRegexp),name:"Fields with name matching regex",description:"Set properties for fields with names matching a regex",optionsToLabel:g=>g};var i=e(21594),u=e(64278);const d=(0,n.memo)(g=>{const{data:h,options:D,onChange:v,id:C}=g,T=(0,u.sE)(h),S=(0,u.m3)(T,D),O=(0,n.useCallback)(b=>{if((0,u.v3)(b.value,T))return v(b.value)},[T,v]),x=S.find(b=>b.value===D);return n.createElement(i.l6,{value:x,options:S,onChange:O,inputId:C})});d.displayName="FieldNameMatcherEditor";const p={id:s.Ct.byName,component:d,matcher:r.sJ.get(s.Ct.byName),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:g=>g},c=(0,n.memo)(g=>{const{data:h,options:D,onChange:v}=g,{readOnly:C,prefix:T}=D,S=(0,u.sE)(h),O=(0,u.m3)(S,void 0),x=(0,n.useCallback)(b=>{if(Array.isArray(b))return v({...D,names:b.reduce((M,A)=>((0,u.v3)(A.value,S)&&M.push(A.value),M),[])})},[S,v,D]);if(C){const b=(D.names??[]).join(", ");return n.createElement(o.p,{value:b,readOnly:!0,disabled:!0,prefix:T})}return n.createElement(i.KF,{value:D.names,options:O,onChange:x})});c.displayName="FieldNameMatcherEditor";const y={id:s.Ct.byNames,component:c,matcher:r.sJ.get(s.Ct.byNames),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:g=>(g.names??[]).join(", "),excludeFromPicker:!0};var f=e(9988),P=e(19346),a=e(74668);const E=new t.O(()=>[p,l,f.cH,a.R,y,P.r1])},64278:(G,I,e)=>{"use strict";e.d(I,{BP:()=>m,m3:()=>i,sE:()=>l,v3:()=>o});var t=e(96540),n=e(28240),s=e(27310),r=e(4025);function o(u,d){return u?d.display.has(u)||d.raw.has(u):!1}function m(u,d){const p={display:new Set,raw:new Set,fields:new Map};for(const c of u)for(const y of c.fields){if(d&&!d(y))continue;const f=(0,n.Ct)(y,c,u);p.display.add(f),p.fields.set(f,y),y.name&&f!==y.name&&(p.raw.add(y.name),p.fields.set(y.name,y))}return p}function l(u,d){return(0,t.useMemo)(()=>m(u,d),[u,d])}function i(u,d,p,c,y){return(0,t.useMemo)(()=>{let f=!1;const P=[];if(p&&P.push(p),y===s.X4.OnlyBaseNames)for(const a of u.raw)!f&&a===d&&(f=!0),P.push({value:a,label:`${a} (base field name)`});else{for(const a of u.display){!f&&a===d&&(f=!0);const E=u.fields.get(a);(!c||c===E?.type)&&P.push({value:a,label:a,icon:E?(0,r.SS)(E):void 0})}if(y!==s.X4.ExcludeBaseNames)for(const a of u.raw)u.display.has(a)||(!f&&a===d&&(f=!0),P.push({value:a,label:`${a} (base field name)`}))}return d&&!f&&P.push({value:d,label:`${d} (not found)`}),P},[u,d,p,c,y])}},38138:(G,I,e)=>{"use strict";e.d(I,{W:()=>d});var t=e(32196),n=e(96540),s=e(40845),r=e(90613),o=e(27183),m=e(59093),l=e(64539),i=e(32653);const u=n.forwardRef(({header:c,children:y,ariaLabel:f,onOpen:P,onClose:a,onKeyDown:E,...g},h)=>{const D=(0,s.of)(p),v=(0,n.useRef)(null);(0,n.useImperativeHandle)(h,()=>v.current);const[C]=(0,i.t)({isMenuOpen:!0,localRef:v,onOpen:P,onClose:a,onKeyDown:E});return n.createElement(r.a,{...g,"aria-label":f,backgroundColor:"primary",borderRadius:"default",boxShadow:"z3",display:"inline-block",onKeyDown:C,paddingX:0,paddingY:.5,ref:v,role:"menu",tabIndex:-1},c&&n.createElement("div",{className:(0,t.cx)(D.header,!!y&&n.Children.toArray(y).length>0&&D.headerBorder)},c),y)});u.displayName="Menu";const d=Object.assign(u,{Item:l.D,Divider:o.N,Group:m.r}),p=c=>({header:(0,t.css)({padding:c.spacing(.5,1,1,1)}),headerBorder:(0,t.css)({borderBottom:`1px solid ${c.colors.border.weak}`})})},27183:(G,I,e)=>{"use strict";e.d(I,{N:()=>r});var t=e(32196),n=e(96540),s=e(40845);function r(){const m=(0,s.of)(o);return n.createElement("div",{className:m.divider})}const o=m=>({divider:(0,t.css)({height:1,backgroundColor:m.colors.border.weak,margin:m.spacing(.5,0)})})},59093:(G,I,e)=>{"use strict";e.d(I,{r:()=>m});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(40845);const m=({label:i,ariaLabel:u,children:d})=>{const p=(0,o.of)(l),c=`group-label-${(0,n.uniqueId)()}`;return r.createElement("div",{role:"group","aria-labelledby":!u&&i?c:void 0,"aria-label":u},i&&r.createElement("label",{id:c,className:p.groupLabel,"aria-hidden":!0},i),d)};m.displayName="MenuGroup";const l=i=>({groupLabel:(0,t.css)({color:i.colors.text.secondary,fontSize:i.typography.size.sm,padding:i.spacing(.5,1)})})},64539:(G,I,e)=>{"use strict";e.d(I,{D:()=>c});var t=e(32196),n=e(96540),s=e(40845),r=e(16797),o=e(14578),m=e(67061),l=e(13544),i=e(32653);const u=f=>{if(!f)return!1;const P=f.parentElement.getBoundingClientRect(),a=f.getBoundingClientRect();return a.width!==0&&P.right+a.width+10>window.innerWidth},d=n.memo(({items:f,isOpen:P,close:a,customStyle:E})=>{const g=(0,s.of)(p),h=(0,n.useRef)(null),[D]=(0,i.t)({localRef:h,isMenuOpen:P,close:a}),[v,C]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{P&&h.current&&C(u(h.current))},[P]),n.createElement(n.Fragment,null,n.createElement("div",{className:g.iconWrapper,"aria-hidden":!0,"data-testid":l.Tp.components.Menu.SubMenu.icon},n.createElement(o.I,{name:"angle-right",className:g.icon})),P&&n.createElement("div",{ref:h,className:(0,t.cx)(g.subMenu,{[g.pushLeft]:v}),"data-testid":l.Tp.components.Menu.SubMenu.container,style:E},n.createElement("div",{tabIndex:-1,className:g.itemsWrapper,role:"menu",onKeyDown:D},f)))});d.displayName="SubMenu";const p=f=>({iconWrapper:(0,t.css)({display:"flex",flex:1,justifyContent:"end"}),icon:(0,t.css)({opacity:.7,marginLeft:f.spacing(1),color:f.colors.text.secondary}),itemsWrapper:(0,t.css)({background:f.colors.background.primary,boxShadow:f.shadows.z3,display:"inline-block",borderRadius:f.shape.radius.default}),pushLeft:(0,t.css)({right:"100%",left:"unset"}),subMenu:(0,t.css)({position:"absolute",top:0,left:"100%",zIndex:f.zIndex.dropdown})}),c=n.memo(n.forwardRef((f,P)=>{const{url:a,icon:E,label:g,description:h,ariaLabel:D,ariaChecked:v,target:C,onClick:T,className:S,active:O,disabled:x,destructive:b,childItems:M,role:A,tabIndex:R=-1,customSubMenuContainerStyles:B,shortcut:U,testId:W}=f,N=(0,s.of)(y),[w,L]=(0,n.useState)(O),[V,K]=(0,n.useState)(!1),k=(0,n.useCallback)(()=>{x||(K(!0),L(!0))},[x]),j=(0,n.useCallback)(()=>{x||(K(!1),L(!1))},[x]),H=M&&M.length>0,J=H?"div":a===void 0?"button":"a",X=(0,t.cx)({[N.item]:!0,[N.active]:w,[N.disabled]:x,[N.destructive]:b&&!x},S),se={[J==="button"?"disabled":"aria-disabled"]:x,...J==="a"&&x&&{href:void 0,onClick:void 0},...x&&{tabIndex:-1,"data-disabled":x}},ae=(0,n.useRef)(null);(0,n.useImperativeHandle)(P,()=>ae.current);const ne=z=>{switch(z.key){case"ArrowRight":z.preventDefault(),z.stopPropagation(),H&&(K(!0),L(!0));break;default:break}},q=()=>{K(!1),L(!1),ae?.current?.focus()},ee=!!(U&&U.length>0);return n.createElement(J,{target:C,className:X,rel:C==="_blank"?"noopener noreferrer":void 0,href:a,onClick:T,onMouseEnter:k,onMouseLeave:j,onKeyDown:ne,role:a?A:A||"menuitem","data-role":"menuitem",ref:ae,"data-testid":W,"aria-label":D,"aria-checked":v,tabIndex:R,...se},n.createElement(m.B,{direction:"row",justifyContent:"flex-start",alignItems:"center"},E&&n.createElement(o.I,{name:E,className:N.icon,"aria-hidden":!0}),n.createElement("span",{className:N.ellipsis},g),n.createElement("div",{className:(0,t.cx)(N.rightWrapper,{[N.withShortcut]:ee})},ee&&n.createElement("div",{className:N.shortcut},n.createElement(o.I,{name:"keyboard",title:"keyboard shortcut"}),U),H&&n.createElement(d,{items:M,isOpen:V,close:q,customStyle:B}))),h&&n.createElement("div",{className:(0,t.cx)(N.description,N.ellipsis,{[N.descriptionWithIcon]:E!==void 0})},h),f.component?n.createElement(f.component,null):null)}));c.displayName="MenuItem";const y=f=>({item:(0,t.css)({background:"none",cursor:"pointer",whiteSpace:"nowrap",color:f.colors.text.primary,display:"flex",flexDirection:"column",alignItems:"stretch",padding:f.spacing(.5,2),minHeight:f.spacing(4),margin:0,border:"none",width:"100%",position:"relative","&:hover, &:focus-visible":{background:f.colors.action.hover,color:f.colors.text.primary,textDecoration:"none"},"&:focus-visible":(0,r.getFocusStyles)(f)}),active:(0,t.css)({background:f.colors.action.hover}),destructive:(0,t.css)({color:f.colors.error.text,svg:{color:f.colors.error.text},"&:hover, &:focus, &:focus-visible":{background:f.colors.error.main,color:f.colors.error.contrastText,svg:{color:f.colors.error.contrastText}}}),disabled:(0,t.css)({color:f.colors.action.disabledText,label:"menu-item-disabled","&:hover, &:focus, &:focus-visible":{cursor:"not-allowed",background:"none",color:f.colors.action.disabledText}}),icon:(0,t.css)({opacity:.7,color:f.colors.text.secondary}),rightWrapper:(0,t.css)({display:"flex",alignItems:"center",marginLeft:"auto"}),withShortcut:(0,t.css)({minWidth:f.spacing(10.5)}),shortcut:(0,t.css)({display:"flex",alignItems:"center",gap:f.spacing(1),marginLeft:f.spacing(2),color:f.colors.text.secondary,opacity:.7}),description:(0,t.css)({...f.typography.bodySmall,color:f.colors.text.secondary,textAlign:"start"}),descriptionWithIcon:(0,t.css)({marginLeft:f.spacing(3)}),ellipsis:(0,t.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})})},32653:(G,I,e)=>{"use strict";e.d(I,{t:()=>o});var t=e(96540),n=e(94701);const s=(m,l)=>(m%l+l)%l,r=-1,o=({localRef:m,isMenuOpen:l,close:i,onOpen:u,onClose:d,onKeyDown:p})=>{const[c,y]=(0,t.useState)(r);return(0,t.useEffect)(()=>{l&&y(0)},[l]),(0,t.useEffect)(()=>{const P=m?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])');P?.[c]?.focus(),P?.forEach((a,E)=>{a.tabIndex=E===c?0:-1})},[m,c]),(0,n.A)(()=>{u?.(y)}),[P=>{const a=m?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])'),E=a?.length??0;switch(P.key){case"ArrowUp":P.preventDefault(),P.stopPropagation(),y(s(c-1,E));break;case"ArrowDown":P.preventDefault(),P.stopPropagation(),y(s(c+1,E));break;case"ArrowLeft":P.preventDefault(),P.stopPropagation(),y(r),i?.();break;case"Home":P.preventDefault(),P.stopPropagation(),y(0);break;case"End":P.preventDefault(),P.stopPropagation(),y(E-1);break;case"Enter":P.preventDefault(),P.stopPropagation(),a?.[c]?.click();break;case"Escape":d?.();break;case"Tab":P.preventDefault(),d?.();break;default:break}p?.(P)}]}},37390:(G,I,e)=>{"use strict";e.d(I,{a:()=>y});var t=e(32196),n=e(18828),s=e(85690),r=e(93225),o=e(59875),m=e(96540),l=e(40845),i=e(76412),u=e(29158),d=e(67061),p=e(29473),c=e(88448);function y(a){const{title:E,children:g,isOpen:h=!1,closeOnEscape:D=!0,closeOnBackdropClick:v=!0,className:C,contentClassName:T,onDismiss:S,onClickBackdrop:O,trapFocus:x=!0}=a,b=(0,l.of)(c.o),M=(0,m.useRef)(null),{overlayProps:A,underlayProps:R}=(0,r.e)({isKeyboardDismissDisabled:!D,isOpen:h,onClose:S},M),{dialogProps:B,titleProps:U}=(0,n.s)({},M);if(!h)return null;const W=(0,t.cx)(b.modalHeader,typeof E!="string"&&b.modalHeaderWithTabs);return m.createElement(o.Sf,null,m.createElement("div",{role:"presentation",className:b.modalBackdrop,onClick:O||(v?S:void 0),...R}),m.createElement(s.n1,{contain:x,autoFocus:!0,restoreFocus:!0},m.createElement("div",{className:(0,t.cx)(b.modal,C),ref:M,...A,...B},m.createElement("div",{className:W},typeof E=="string"&&m.createElement(P,{...a,title:E,id:U.id}),typeof E!="string"&&E,m.createElement("div",{className:b.modalHeaderClose},m.createElement(u.K,{name:"times",size:"xl",onClick:S,"aria-label":(0,i.t)("grafana-ui.modal.close-tooltip","Close")}))),m.createElement("div",{className:(0,t.cx)(b.modalContent,T)},g))))}function f({leftItems:a,children:E}){const g=(0,l.of)(c.o);return a?m.createElement("div",{className:g.modalButtonRow},m.createElement(d.B,{justifyContent:"space-between"},m.createElement(d.B,{justifyContent:"flex-start",gap:2},a),m.createElement(d.B,{justifyContent:"flex-end",gap:2},E))):m.createElement("div",{className:g.modalButtonRow},m.createElement(d.B,{justifyContent:"flex-end",gap:2,wrap:"wrap"},E))}y.ButtonRow=f;function P({icon:a,iconTooltip:E,title:g,id:h}){return m.createElement(p.r,{icon:a,iconTooltip:E,title:g,id:h})}},29473:(G,I,e)=>{"use strict";e.d(I,{r:()=>r});var t=e(96540),n=e(40845),s=e(88448);const r=({icon:o,iconTooltip:m,title:l,children:i,id:u})=>{const d=(0,n.of)(s.o);return t.createElement(t.Fragment,null,t.createElement("h2",{className:d.modalHeaderTitle,id:u},l),i)}},95246:(G,I,e)=>{"use strict";e.d(I,{O:()=>n});var t=e(96540);const n=({children:s})=>t.createElement("div",{className:"share-modal-body"},t.createElement("div",{className:"share-modal-header"},t.createElement("div",{className:"share-modal-content"},s)))},25897:(G,I,e)=>{"use strict";e.d(I,{J:()=>o});var t=e(96540),n=e(40675),s=e(63021),r=e(29473);const o=({icon:m,title:l,tabs:i,activeTab:u,onChangeTab:d})=>t.createElement(r.r,{icon:m,title:l},t.createElement(s.U,{hideBorder:!0},i.map((p,c)=>t.createElement(n.o,{key:`${p.value}-${c}`,label:p.label,icon:p.icon,suffix:p.tabSuffix,active:p.value===u,onChangeTab:()=>d(p)}))))},71678:(G,I,e)=>{"use strict";e.d(I,{$s:()=>o,EO:()=>r,YO:()=>s,wE:()=>n});var t=e(96540);const n=t.createContext({component:null,props:{},showModal:()=>{},hideModal:()=>{}});class s extends t.Component{constructor(l){super(l),this.showModal=(i,u)=>{this.setState({component:i,props:u})},this.hideModal=()=>{this.setState({component:null,props:{}})},this.state={component:l.component||null,props:l.props||{},showModal:this.showModal,hideModal:this.hideModal}}render(){return t.createElement(n.Provider,{value:this.state},this.props.children)}}const r=()=>t.createElement(n.Consumer,null,({component:m,props:l})=>m?t.createElement(m,{...l}):null),o=n.Consumer},88448:(G,I,e)=>{"use strict";e.d(I,{o:()=>n});var t=e(32196);const n=s=>{const r=s.shape.radius.default;return{modal:(0,t.css)({position:"fixed",zIndex:s.zIndex.modal,background:s.colors.background.primary,boxShadow:s.shadows.z3,borderRadius:r,border:`1px solid ${s.colors.border.weak}`,backgroundClip:"padding-box",outline:"none",width:"750px",maxWidth:"100%",left:0,right:0,marginLeft:"auto",marginRight:"auto",top:"10%",maxHeight:"80%",display:"flex",flexDirection:"column"}),modalBackdrop:(0,t.css)({position:"fixed",zIndex:s.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0,backgroundColor:s.components.overlay.background,backdropFilter:"blur(1px)"}),modalHeader:(0,t.css)({label:"modalHeader",display:"flex",alignItems:"center",minHeight:"42px",margin:s.spacing(1,2,0,2)}),modalHeaderWithTabs:(0,t.css)({borderBottom:`1px solid ${s.colors.border.weak}`}),modalHeaderTitle:(0,t.css)({fontSize:s.typography.size.lg,margin:s.spacing(0,4,0,1),display:"flex",alignItems:"center",position:"relative",top:"2px"}),modalHeaderIcon:(0,t.css)({marginRight:s.spacing(2),fontSize:"inherit","&:before":{verticalAlign:"baseline"}}),modalHeaderClose:(0,t.css)({height:"100%",display:"flex",alignItems:"center",color:s.colors.text.secondary,flexGrow:1,justifyContent:"flex-end"}),modalContent:(0,t.css)({overflow:"auto",padding:s.spacing(3),width:"100%"}),modalButtonRow:(0,t.css)({paddingTop:s.spacing(3)})}}},32372:(G,I,e)=>{"use strict";e.d(I,{B:()=>y});var t=e(32196),n=e(96540),s=e(96915),r=e(13544),o=e(40845),m=e(85828),l=e(19716);function i(P){for(let a=P.length-1;a>0;a--){const E=P.charAt(a);if(E==="$")return{index:a,prefix:P.substring(a)};if(E===" "||E==="	"||E==='"'||E==="'")return{index:a+1,prefix:P.substring(a+1)}}return{index:0,prefix:P}}function u(P,a,E,g){const h=[];for(const D of E)a&&!D.label.startsWith(a)||h.push({...D,kind:d(P,D.kind),range:g,insertText:D.insertText??D.label});return h}function d(P,a){switch(a){case l.q.Method:return P.languages.CompletionItemKind.Method;case l.q.Field:return P.languages.CompletionItemKind.Field;case l.q.Property:return P.languages.CompletionItemKind.Property;case l.q.Constant:return P.languages.CompletionItemKind.Constant;case l.q.Text:return P.languages.CompletionItemKind.Text}return P.languages.CompletionItemKind.Text}function p(P,a,E,g){if(!(!a||!E))return P.languages.registerCompletionItemProvider(a,{triggerCharacters:["$"],provideCompletionItems:(h,D,v)=>{if(h.id!==g)return;const C={startLineNumber:D.lineNumber,endLineNumber:D.lineNumber,startColumn:D.column,endColumn:D.column};if(v.triggerCharacter==="$")return C.startColumn=D.column-1,{suggestions:u(P,"$",E(),C)};const T=h.getValueInRange({startLineNumber:D.lineNumber,startColumn:1,endLineNumber:D.lineNumber,endColumn:D.column}),{index:S,prefix:O}=i(T);C.startColumn=S+1;const x=u(P,O,E(),C);if(x.length)return{suggestions:x}}})}class c extends n.PureComponent{constructor(a){super(a),this.loadCustomLanguage=()=>{const{language:E}=this.props,g=s.l.getIfExists(E);return g?g.init():Promise.resolve()},this.getEditorValue=()=>"",this.onBlur=()=>{const{onBlur:E}=this.props;E&&E(this.getEditorValue())},this.onFocus=()=>{const{onFocus:E}=this.props;E&&E(this.getEditorValue())},this.onSave=()=>{const{onSave:E}=this.props;E&&E(this.getEditorValue())},this.handleBeforeMount=E=>{this.monaco=E;const{onBeforeEditorMount:g}=this.props;g?.(E)},this.handleOnMount=(E,g)=>{const{getSuggestions:h,language:D,onChange:v,onEditorDidMount:C}=this.props;this.modelId=E.getModel()?.id,this.getEditorValue=()=>E.getValue(),h&&this.modelId&&(this.completionCancel=p(g,D,h,this.modelId)),E.onKeyDown(T=>{T.keyCode===g.KeyCode.KeyS&&(T.ctrlKey||T.metaKey)&&(T.preventDefault(),this.onSave())}),v&&E.getModel()?.onDidChangeContent(()=>v(E.getValue())),C&&C(E,g)}}componentWillUnmount(){this.completionCancel&&this.completionCancel.dispose(),this.props.onEditorWillUnmount?.()}componentDidUpdate(a){const{getSuggestions:E,language:g}=this.props,h=a.language!==g;if(a.getSuggestions!==E||h){if(this.completionCancel&&this.completionCancel.dispose(),!this.monaco){console.warn("Monaco instance not loaded yet");return}E&&this.modelId&&(this.completionCancel=p(this.monaco,g,E,this.modelId))}h&&this.loadCustomLanguage()}render(){const{theme:a,language:E,width:g,height:h,showMiniMap:D,showLineNumbers:v,readOnly:C,monacoOptions:T}=this.props,{alwaysConsumeMouseWheel:S,...O}=T??{},x=this.props.value??"",b=x.length>100,M=this.props.containerStyles??f(a).container,A={wordWrap:"off",tabSize:2,codeLens:!1,contextmenu:!1,minimap:{enabled:b&&D,renderCharacters:!1},readOnly:C,lineNumbersMinChars:4,lineDecorationsWidth:1*a.spacing.gridSize,overviewRulerBorder:!1,automaticLayout:!0,padding:{top:.5*a.spacing.gridSize,bottom:.5*a.spacing.gridSize},fixedOverflowWidgets:!0,scrollbar:{alwaysConsumeMouseWheel:S??!1}};return v||(A.glyphMargin=!1,A.folding=!1,A.lineNumbers="off",A.lineNumbersMinChars=0),n.createElement("div",{className:M,onFocus:this.onFocus,onBlur:this.onBlur,"data-testid":r.Tp.components.CodeEditor.container},n.createElement(m.m,{width:g,height:h,language:E,value:x,options:{...A,...O??{}},beforeMount:this.handleBeforeMount,onMount:this.handleOnMount,keepCurrentModel:!0}))}}const y=(0,o.cV)(c),f=P=>({container:(0,t.css)({borderRadius:P.shape.radius.default,border:`1px solid ${P.components.input.borderColor}`})})},85828:(G,I,e)=>{"use strict";e.d(I,{m:()=>u});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(16817);const m=p=>{const c=(0,o.A)(async()=>await p);return{...c,dependency:c.value}};var l=e(52446),i=e(39558);const u=p=>{const c=(0,r.of)(d),{loading:y,error:f,dependency:P}=m(Promise.all([e.e(8477),e.e(6556),e.e(8926)]).then(e.bind(e,16556)));if(y)return n.createElement(i._,{text:"Loading editor",className:c.container});if(f)return n.createElement(l.D,{title:"React Monaco Editor failed to load",error:f,errorInfo:{componentStack:f?.stack??""}});const a=P.ReactMonacoEditor;return n.createElement(a,{...p,loading:p.loading??null,wrapperProps:{"data-testid":s.Tp.components.ReactMonacoEditor.editorLazy}})},d=p=>({container:(0,t.css)({marginBottom:"unset",marginLeft:p.spacing(1)})})},19716:(G,I,e)=>{"use strict";e.d(I,{q:()=>t});var t=(n=>(n.Method="method",n.Field="field",n.Property="property",n.Constant="constant",n.Text="text",n))(t||{})},99544:(G,I,e)=>{"use strict";e.d(I,{O:()=>n});var t=e(19716);function n(s){const r="${"+s.value+"}",o=s.value===s.label?s.origin:`${s.label} / ${s.origin}`;return{label:r,kind:t.q.Property,detail:o,documentation:s.documentation}}},95247:(G,I,e)=>{"use strict";e.d(I,{d:()=>d});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(16797),m=e(14578),l=e(29158),i=e(50720),u=e(15068);const d=n.memo(({title:c,section:y,parent:f,pageIcon:P,onGoBack:a,children:E,titleHref:g,parentHref:h,leftItems:D,isFullscreen:v,className:C,"aria-label":T,buttonOverflowAlignment:S="right",forceShowLeftItems:O=!1})=>{const x=(0,r.of)(p),b=(0,t.cx)("page-toolbar",x.toolbar,{"page-toolbar--fullscreen":v,[x.noPageIcon]:!P},C),M=n.createElement(n.Fragment,null,n.createElement("span",{className:x.truncateText},c),y&&n.createElement("span",{className:x.pre}," / ",y));return n.createElement("nav",{className:b,"aria-label":T},n.createElement("div",{className:x.leftWrapper},P&&!a&&n.createElement("div",{className:x.pageIcon},n.createElement(m.I,{name:P,size:"lg","aria-hidden":!0})),a&&n.createElement("div",{className:x.pageIcon},n.createElement(l.K,{name:"arrow-left",tooltip:"Go back (Esc)",tooltipPlacement:"bottom",size:"xxl","data-testid":s.Tp.components.BackButton.backArrow,onClick:a})),n.createElement("nav",{"aria-label":"Search links",className:x.navElement},f&&h&&n.createElement(n.Fragment,null,n.createElement(i.N,{"aria-label":`Search dashboard in the ${f} folder`,className:(0,t.cx)(x.titleText,x.parentLink,x.titleLink,x.truncateText),href:h},f," ",n.createElement("span",{className:x.parentIcon})),g&&n.createElement("span",{className:(0,t.cx)(x.titleText,x.titleDivider),"aria-hidden":!0},"/")),(c||!!D?.length)&&n.createElement("div",{className:x.titleWrapper},c&&n.createElement("h1",{className:x.h1Styles},g?n.createElement(i.N,{"aria-label":"Search dashboard by name",className:(0,t.cx)(x.titleText,x.titleLink),href:g},M):n.createElement("div",{className:x.titleText},M)),D?.map((A,R)=>n.createElement("div",{className:(0,t.cx)(x.leftActionItem,{[x.forceShowLeftActionItems]:O}),key:R},A))))),n.createElement(u.U,{alignment:S},n.Children.toArray(E).filter(Boolean)))});d.displayName="PageToolbar";const p=c=>{const{spacing:y,typography:f}=c,P=(0,o.getFocusStyles)(c);return{pre:(0,t.css)({whiteSpace:"pre"}),toolbar:(0,t.css)({alignItems:"center",background:c.colors.background.canvas,display:"flex",gap:c.spacing(2),justifyContent:"space-between",padding:c.spacing(1.5,2),[c.breakpoints.down("md")]:{paddingLeft:"53px"}}),noPageIcon:(0,t.css)({[c.breakpoints.down("md")]:{paddingLeft:c.spacing(2)}}),leftWrapper:(0,t.css)({display:"flex",flexWrap:"nowrap",maxWidth:"70%"}),pageIcon:(0,t.css)({display:"none",[c.breakpoints.up("sm")]:{display:"flex",paddingRight:c.spacing(1),alignItems:"center"}}),truncateText:(0,t.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),titleWrapper:(0,t.css)({display:"flex",margin:0,minWidth:0}),navElement:(0,t.css)({display:"flex",alignItems:"center",minWidth:0}),h1Styles:(0,t.css)({margin:y(0,1,0,0),lineHeight:"inherit",flexGrow:1,minWidth:0}),parentIcon:(0,t.css)({marginLeft:c.spacing(.5)}),titleText:(0,t.css)({display:"flex",fontSize:f.size.lg,margin:0,borderRadius:c.shape.radius.default}),titleLink:(0,t.css)({"&:focus-visible":P}),titleDivider:(0,t.css)({padding:y(0,.5,0,.5),display:"none",[c.breakpoints.up("md")]:{display:"unset"}}),parentLink:(0,t.css)({display:"none",[c.breakpoints.up("md")]:{display:"unset",flex:1}}),leftActionItem:(0,t.css)({display:"none",alignItems:"center",paddingRight:y(.5),[c.breakpoints.up("md")]:{display:"flex"}}),forceShowLeftActionItems:(0,t.css)({display:"flex"})}}},19384:(G,I,e)=>{"use strict";e.d(I,{d:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(55852),o=e(14578);const m=({currentPage:i,numberOfPages:u,onNavigate:d,hideWhenSinglePage:p,showSmallVersion:c,className:y})=>{const f=(0,s.of)(l),P=c?1:8,a=(0,n.useMemo)(()=>{const E=[...new Array(u).keys()],g=u>P,h=(D,v)=>n.createElement("li",{key:D,className:f.item},n.createElement(r.$n,{size:"sm",variant:v,onClick:()=>d(D)},D));return E.reduce((D,v)=>{const C=v+1,T=C===i?"primary":"secondary",S=P,O=u-P+1,x=O-S,b=C===1||C===u,M=x>-1&&i>=S&&i<=O,A=c?1:3,R=c?0:2;return g?b||i<S&&C<S||x>=0&&i>O&&C>O||x<0&&i>=S&&C>O||M&&C>=i-R&&C<=i+R?D.push(h(C,T)):(C===S&&i<S||C===O&&i>O||M&&(C===i-A||C===i+A))&&D.push(n.createElement("li",{key:C,className:f.item},n.createElement(o.I,{className:f.ellipsis,name:"ellipsis-v"}))):D.push(h(C,T)),D},[])},[i,u,d,P,c,f.ellipsis,f.item]);return p&&u<=1?null:n.createElement("div",{className:(0,t.cx)(f.container,y)},n.createElement("ol",null,n.createElement("li",{className:f.item},n.createElement(r.$n,{"aria-label":"previous page",size:"sm",variant:"secondary",onClick:()=>d(i-1),disabled:i===1},n.createElement(o.I,{name:"angle-left"}))),a,n.createElement("li",{className:f.item},n.createElement(r.$n,{"aria-label":"next page",size:"sm",variant:"secondary",onClick:()=>d(i+1),disabled:i===u},n.createElement(o.I,{name:"angle-right"})))))},l=()=>({container:(0,t.css)({float:"right"}),item:(0,t.css)({display:"inline-block",paddingLeft:"10px",marginBottom:"5px"}),ellipsis:(0,t.css)({transform:"rotate(90deg)"})})},89963:(G,I,e)=>{"use strict";e.d(I,{I:()=>l});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(14578),m=e(56034);const l=({onCancel:u,loading:d})=>{const p=(0,r.of)(i);return d?n.createElement(m.m,{content:"Cancel query"},n.createElement(o.I,{className:(0,t.cx)("spin-clockwise",{[p.clickable]:!!u}),name:"sync",size:"sm",onClick:u,"data-testid":s.Tp.components.LoadingIndicator.icon})):null},i=()=>({clickable:(0,t.css)({cursor:"pointer"})})},79041:(G,I,e)=>{"use strict";e.d(I,{XF:()=>r,d2:()=>o,e4:()=>s});var t=e(96540),n=e(18226);const s=t.createContext({eventsScope:"global",eventBus:new n.o}),r=s.Provider,o=()=>t.useContext(s)},91052:(G,I,e)=>{"use strict";e.d(I,{NR:()=>U});var t=e(89963),n=e(32196),s=e(96540),r=e(42941),o=e(49185),m=e(39070),l=e(13544),i=e(40845),u=e(16797);function d({children:W,delay:N}){const[w,L]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{window.setTimeout(()=>{L(!0)},N)},[W,N]),s.createElement(s.Fragment,null,w?W:null)}var p=e(14578),c=e(57514),y=e(94753),f=e(56034),P=e(83122),a=e(27746);function E({menu:W,title:N,placement:w="bottom",offset:L,dragClassCancel:V,menuButtonClass:K,onOpenMenu:k}){const j=N?l.Tp.components.Panels.Panel.menu(N):"panel-menu-button",H=(0,s.useCallback)(J=>{J&&k&&k()},[k]);return s.createElement(P.m,{overlay:W,placement:w,offset:L,onVisibleChange:H},s.createElement(a.I,{"aria-label":`Menu for panel with ${N?`title ${N}`:"no title"}`,title:"Menu",icon:"ellipsis-v",iconSize:"md",narrow:!0,"data-testid":j,className:(0,n.cx)(K,V)}))}function g({menu:W,title:N,dragClass:w,children:L,offset:V=-32,onOpenMenu:K}){const k=(0,i.of)(h),j=(0,s.useRef)(null),H=l.Tp.components.Panels.Panel.HoverWidget,J=(0,s.useCallback)(se=>{j.current?.setPointerCapture(se.pointerId)},[]),X=(0,s.useCallback)(se=>{j.current?.releasePointerCapture(se.pointerId)},[]);return L===void 0||s.Children.count(L)===0?null:s.createElement("div",{className:(0,n.cx)(k.container,"show-on-hover"),style:{top:V},"data-testid":H.container},w&&s.createElement("div",{className:(0,n.cx)(k.square,k.draggable,w),onPointerDown:J,onPointerUp:X,ref:j,"data-testid":H.dragIcon},s.createElement(p.I,{name:"expand-arrows",className:k.draggableIcon})),L,W&&s.createElement(E,{menu:W,title:N,placement:"bottom",menuButtonClass:k.menuButton,onOpenMenu:K}))}function h(W){return{container:(0,n.css)({label:"hover-container-widget",[W.transitions.handleMotion("no-preference","reduce")]:{transition:"all .1s linear"},display:"flex",position:"absolute",zIndex:1,right:0,boxSizing:"content-box",alignItems:"center",background:W.colors.background.secondary,color:W.colors.text.primary,border:`1px solid ${W.colors.border.weak}`,borderRadius:W.shape.radius.default,height:W.spacing(4),boxShadow:W.shadows.z1}),square:(0,n.css)({display:"flex",justifyContent:"center",alignItems:"center",width:W.spacing(4),height:"100%"}),draggable:(0,n.css)({cursor:"move",[W.breakpoints.down("md")]:{display:"none"}}),menuButton:(0,n.css)({background:"inherit",border:"none","&:hover":{background:W.colors.secondary.main}}),draggableIcon:(0,n.css)({transform:"rotate(45deg)",color:W.colors.text.secondary,"&:hover":{color:W.colors.text.primary}})}}var D=e(55852);const v=(0,s.forwardRef)(({className:W,children:N,href:w,onClick:L,target:V,title:K,...k},j)=>{const H=(0,i.of)(C);return w?s.createElement("a",{ref:j,href:w,onClick:L,target:V,title:K,className:(0,n.cx)(H.linkItem,W),...k},N):L?s.createElement(D.$n,{ref:j,className:(0,n.cx)(H.item,W),variant:"secondary",fill:"text",onClick:L},N):s.createElement("span",{ref:j,className:(0,n.cx)(H.item,W),...k},N)});v.displayName="TitleItem";const C=W=>{const N=(0,n.css)({color:`${W.colors.text.secondary}`,label:"panel-header-item",cursor:"auto",border:"none",borderRadius:`${W.shape.radius.default}`,padding:`${W.spacing(0,1)}`,height:`${W.spacing(W.components.panel.headerHeight)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,u.getFocusStyles)(W),zIndex:1},"&: focus:not(:focus-visible)":(0,u.getMouseFocusStyles)(W),"&:hover ":{boxShadow:`${W.shadows.z1}`,background:`${W.colors.background.secondary}`,color:`${W.colors.text.primary}`}});return{item:N,linkItem:(0,n.cx)(N,(0,n.css)({cursor:"pointer"}))}};function T({description:W,className:N}){const w=(0,i.of)(S),L=()=>{const V=typeof W=="function"?W():W;return s.createElement("div",{className:"panel-info-content markdown-html"},s.createElement("div",{dangerouslySetInnerHTML:{__html:V}}))};return W!==""?s.createElement(f.m,{interactive:!0,content:L},s.createElement(v,{className:(0,n.cx)(N,w.description)},s.createElement(p.I,{name:"info-circle",size:"md"}))):null}const S=W=>({description:(0,n.css)({code:{whiteSpace:"normal",wordWrap:"break-word"},"pre > code":{display:"block"}})});function O({message:W,onClick:N,ariaLabel:w="status"}){const L=(0,i.of)(x);return s.createElement(a.I,{className:L.buttonStyles,onClick:N,variant:"destructive",icon:"exclamation-triangle",iconSize:"md",tooltip:W||"","aria-label":w,"data-testid":l.Tp.components.Panels.Panel.status("error")})}const x=W=>{const{headerHeight:N,padding:w}=W.components.panel;return{buttonStyles:(0,n.css)({label:"panel-header-state-button",display:"flex",alignItems:"center",justifyContent:"center",padding:W.spacing(w),width:W.spacing(N),height:W.spacing(N),borderRadius:W.shape.radius.default})}};function b({width:W,height:N,children:w,padding:L="md",title:V="",description:K="",displayMode:k="default",titleItems:j,menu:H,dragClass:J,dragClassCancel:X,hoverHeader:se=!1,hoverHeaderOffset:ae,loadingState:ne,statusMessage:q,statusMessageOnClick:ee,leftItems:z,actions:te,onCancelQuery:ie,onOpenMenu:ce,collapsible:ue=!1,collapsed:fe,onToggleCollapse:Te,onFocus:he,onMouseMove:de}){const le=(0,i.$j)(),pe=(0,i.of)(B),ve=(0,s.useId)(),be=!se,[Oe,Me]=(0,r.A)(!0);fe===void 0&&(fe=!Oe);const Ue="show-on-hover",we=k==="transparent",Re=A(le,be),{contentStyle:Fe,innerWidth:xe,innerHeight:Ve}=R(L,le,Re,fe,N,W),$e={height:Re,cursor:J?"move":"auto"},Xe={width:W,height:fe?void 0:N},[gt,{width:Dt}]=(0,o.A)();z&&(te=z);const nt=typeof V=="string"?l.Tp.components.Panels.Panel.title(V):"Panel",at=s.createElement(s.Fragment,null,!ue&&V&&s.createElement("div",{className:pe.title},s.createElement(y.E,{element:"h2",variant:"h6",truncate:!0,title:typeof V=="string"?V:void 0},V)),ue&&s.createElement("div",{className:pe.title},s.createElement(y.E,{element:"h2",variant:"h6"},s.createElement("button",{type:"button",className:pe.clearButtonStyles,onClick:()=>{Me(),Te&&Te(!fe)},"aria-expanded":!fe,"aria-controls":fe?void 0:ve},s.createElement(p.I,{name:fe?"angle-right":"angle-down","aria-hidden":!!V,"aria-label":V?void 0:"toggle collapse panel"}),s.createElement(y.E,{variant:"h6",truncate:!0},V)))),s.createElement("div",{className:(0,n.cx)(pe.titleItems,X),"data-testid":"title-items-container"},s.createElement(T,{description:K,className:X}),j),ne===m.Gu.Streaming&&s.createElement(f.m,{content:ie?"Stop streaming":"Streaming"},s.createElement(v,{className:X,"data-testid":"panel-streaming",onClick:ie},s.createElement(p.I,{name:"circle-mono",size:"md",className:pe.streaming}))),ne===m.Gu.Loading&&ie&&s.createElement(d,{delay:2e3},s.createElement(f.m,{content:"Cancel query"},s.createElement(v,{className:(0,n.cx)(X,pe.pointer),"data-testid":"panel-cancel-query",onClick:ie},s.createElement(p.I,{name:"sync-slash",size:"md"})))),s.createElement("div",{className:pe.rightAligned},te&&s.createElement("div",{className:pe.rightActions},M(te,Ae=>Ae))));return s.createElement("section",{className:(0,n.cx)(pe.container,{[pe.transparentContainer]:we}),style:Xe,"data-testid":nt,tabIndex:0,onFocus:he,onMouseMove:de,ref:gt},s.createElement("div",{className:pe.loadingBarContainer},ne===m.Gu.Loading?s.createElement(c.G,{width:Dt,ariaLabel:"Panel loading bar"}):null),se&&s.createElement(s.Fragment,null,s.createElement(g,{menu:H,title:typeof V=="string"?V:void 0,offset:ae,dragClass:J,onOpenMenu:ce},at),q&&s.createElement("div",{className:pe.errorContainerFloating},s.createElement(O,{message:q,onClick:ee,ariaLabel:"Panel status"}))),be&&s.createElement("div",{className:(0,n.cx)(pe.headerContainer,J),style:$e,"data-testid":"header-container"},q&&s.createElement("div",{className:X},s.createElement(O,{message:q,onClick:ee,ariaLabel:"Panel status"})),at,H&&s.createElement(E,{menu:H,title:typeof V=="string"?V:void 0,placement:"bottom-end",menuButtonClass:(0,n.cx)(pe.menuItem,X,Ue),onOpenMenu:ce})),!fe&&s.createElement("div",{id:ve,"data-testid":l.Tp.components.Panels.Panel.content,className:(0,n.cx)(pe.content,N===void 0&&pe.containNone),style:Fe},typeof w=="function"?w(xe,Ve):w))}const M=(W,N)=>{const w=s.Children.toArray(W).filter(Boolean);return w.length>0?N(w):null},A=(W,N)=>N?W.spacing.gridSize*W.components.panel.headerHeight:0,R=(W,N,w,L,V,K)=>{const k=(W==="md"?N.components.panel.padding:0)*N.spacing.gridSize,j=k*2,H=1*2;let J=0;K&&(J=K-j-H);let X=0;return V&&(X=V-w-j-H),L&&(X=w),{contentStyle:{padding:k},innerWidth:J,innerHeight:X}},B=W=>{const{background:N,borderColor:w,padding:L}=W.components.panel;return{container:(0,n.css)({label:"panel-container",backgroundColor:N,border:`1px solid ${w}`,position:"relative",borderRadius:W.shape.radius.default,height:"100%",display:"flex",flexDirection:"column",".show-on-hover":{opacity:"0",visibility:"hidden"},"&:focus-visible, &:hover":{".show-on-hover":{opacity:"1",visibility:"visible"}},"&:focus-visible":(0,u.getFocusStyles)(W),"&:focus-within:not(:focus)":{".show-on-hover":{visibility:"visible",opacity:"1"}}}),transparentContainer:(0,n.css)({label:"panel-transparent-container",backgroundColor:"transparent",border:"1px solid transparent",boxSizing:"border-box","&:hover":{border:`1px solid ${w}`}}),loadingBarContainer:(0,n.css)({label:"panel-loading-bar-container",position:"absolute",top:0,width:"100%"}),containNone:(0,n.css)({contain:"none"}),content:(0,n.css)({label:"panel-content",flexGrow:1,contain:"size layout"}),headerContainer:(0,n.css)({label:"panel-header",display:"flex",alignItems:"center"}),pointer:(0,n.css)({cursor:"pointer"}),streaming:(0,n.css)({label:"panel-streaming",marginRight:0,color:W.colors.success.text,"&:hover":{color:W.colors.success.text}}),title:(0,n.css)({label:"panel-title",display:"flex",padding:W.spacing(0,L),minWidth:0,"& > h2":{minWidth:0}}),items:(0,n.css)({display:"flex"}),item:(0,n.css)({display:"flex",justifyContent:"center",alignItems:"center"}),hiddenMenu:(0,n.css)({visibility:"hidden"}),menuItem:(0,n.css)({label:"panel-menu",border:"none",background:W.colors.secondary.main,"&:hover":{background:W.colors.secondary.shade}}),errorContainerFloating:(0,n.css)({label:"error-container",position:"absolute",left:0,top:0,zIndex:1}),rightActions:(0,n.css)({display:"flex",padding:W.spacing(0,L),gap:W.spacing(1)}),rightAligned:(0,n.css)({label:"right-aligned-container",marginLeft:"auto",display:"flex",alignItems:"center"}),titleItems:(0,n.css)({display:"flex",height:"100%"}),clearButtonStyles:(0,n.css)({alignItems:"center",display:"flex",gap:W.spacing(.5),background:"transparent",border:"none",padding:0,maxWidth:"100%"})}},U=b;U.LoadingIndicator=t.I,U.TitleItem=v},88895:(G,I,e)=>{"use strict";e.d(I,{B:()=>t});var t=(n=>(n.ToggleSelection="select",n.AppendToSelection="append",n))(t||{})},52494:(G,I,e)=>{"use strict";e.d(I,{_:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({children:m,className:l,...i})=>{const u=(0,s.of)(o);return n.createElement("div",{className:(0,t.cx)(u,l),...i},m)},o=m=>(0,t.css)({backgroundColor:m.components.panel.background,border:`1px solid ${m.components.panel.borderColor}`,borderRadius:m.shape.radius.default})},98624:(G,I,e)=>{"use strict";e.d(I,{B:()=>r});var t=e(96540),n=e(43429),s=e(39938);const r=({status:m,color:l,...i})=>{const u=o(m);return t.createElement(s.E,{text:u.text,color:u.color,icon:u.icon,tooltip:u.tooltip,...i})};r.displayName="PluginSignatureBadge";function o(m){switch(m||(m=n.Ac.invalid),m){case n.Ac.internal:return{text:"Core",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case n.Ac.valid:return{text:"Signed",icon:"lock",color:"green",tooltip:"Signed and verified plugin"};case n.Ac.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case n.Ac.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case n.Ac.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"};default:return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}}},17464:(G,I,e)=>{"use strict";e.d(I,{ZL:()=>r,gF:()=>o,qB:()=>m});var t=e(96540),n=e(40961),s=e(40845);function r(i){const{children:u,className:d,root:p,forwardedRef:c}=i,y=(0,s.$j)(),f=(0,t.useRef)(null),P=p??o();return f.current||(f.current=document.createElement("div"),d&&(f.current.className=d),f.current.style.position="relative",f.current.style.zIndex=`${y.zIndex.portal}`),(0,t.useLayoutEffect)(()=>(f.current&&P.appendChild(f.current),()=>{f.current&&P.removeChild(f.current)}),[P]),n.createPortal(t.createElement("div",{ref:c},u),f.current)}function o(){return window.document.getElementById("grafana-portal-container")??document.body}function m(){return t.createElement("div",{id:"grafana-portal-container"})}const l=t.forwardRef((i,u)=>t.createElement(r,{...i,forwardedRef:u}));l.displayName="RefForwardingPortal"},20084:(G,I,e)=>{"use strict";e.d(I,{X:()=>v});var t=e(32196),n=e(46942),s=e.n(n),r=e(2543),o=e.n(r),m=e(96540),l=e(75226),i=e(29317),u=e(13544),d=e(80903),p=e(4269),c=e(88295),y=e(74738),f=e(31589),P=e(1020),a=e(99453),E=e(40845),g=e(16797),h=e(72307);class D extends m.PureComponent{constructor(S){super(S),this.lastExecutedValue=null,this.mounted=!1,this.editor=null,this.onChange=(A,R)=>{const B=A.document!==this.state.value.document,U=this.state.value;this.props.onRichValueChange&&this.props.onRichValueChange(A),this.setState({value:A},()=>{if(B){const W=l.A.serialize(U)!==l.A.serialize(A);W&&R&&this.runOnChangeAndRunQuery(),W&&!R&&this.runOnChangeDebounced()}})},this.runOnChange=()=>{const{onChange:A}=this.props,R=l.A.serialize(this.state.value);A&&A(this.cleanText(R))},this.runOnRunQuery=()=>{const{onRunQuery:A}=this.props;A&&(A(),this.lastExecutedValue=this.state.value)},this.runOnChangeAndRunQuery=()=>{this.runOnChange(),this.runOnRunQuery()},this.handleBlur=(A,R,B)=>{const{onBlur:U}=this.props;if(U)U();else{const W=this.lastExecutedValue?l.A.serialize(this.lastExecutedValue):"",N=l.A.serialize(R.value);W!==N&&this.runOnChangeAndRunQuery()}return B()},this.runOnChangeDebounced=(0,r.debounce)(this.runOnChange,500);const{onTypeahead:O,cleanText:x,portalOrigin:b,onWillApplySuggestion:M}=S;this.plugins=[(0,d.Pz)({onTypeahead:O,cleanText:x,portalOrigin:b,onWillApplySuggestion:M}),(0,p.U)({handler:this.runOnChangeAndRunQuery}),(0,c.O)(),(0,y.v)(),(0,f.l)(),(0,P.T)(),(0,a.s)(),...S.additionalPlugins||[]].filter(A=>A),this.state={suggestions:[],typeaheadContext:null,typeaheadPrefix:"",typeaheadText:"",value:(0,h.mO)(S.query||"",S.syntax)}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}componentDidUpdate(S,O){const{query:x,syntax:b,syntaxLoaded:M}=this.props;if(!S.syntaxLoaded&&M&&this.editor){const R=this.editor.insertText(" ").deleteBackward(1);this.onChange(R.value,!0)}const{value:A}=this.state;x!==S.query&&x!==l.A.serialize(A)&&this.setState({value:(0,h.mO)(x||"",b)})}cleanText(S){return S.replace(/[\r]/g,"")}render(){const{disabled:S,theme:O}=this.props,x=s()("slate-query-field__wrapper",{"slate-query-field__wrapper--disabled":S}),b=C(O);return m.createElement("div",{className:(0,t.cx)(x,b.wrapper)},m.createElement("div",{className:"slate-query-field","data-testid":u.Tp.components.QueryField.container},m.createElement(i.KE,{ref:M=>this.editor=M,schema:h.yx,autoCorrect:!1,readOnly:this.props.disabled,onBlur:this.handleBlur,onClick:this.props.onClick,onChange:M=>{this.onChange(M.value,!1)},placeholder:this.props.placeholder,plugins:this.plugins,spellCheck:!1,value:this.state.value})))}}const v=(0,E.cV)(D);v.defaultProps={onBlur:()=>{}};const C=T=>{const S=(0,g.getFocusStyles)(T);return{wrapper:(0,t.css)({"&:focus-within":S})}}},11134:(G,I,e)=>{"use strict";e.d(I,{cC:()=>d,cb:()=>u});var t=e(91e3),n=e(96540),s=e(70416),r=e(13544),o=e(76412),m=e(19727),l=e(9261),i=e(27746);const u=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class d extends n.PureComponent{constructor(f){super(f),this.onChangeSelect=P=>{const{onIntervalChanged:a}=this.props;a&&P.value!=null&&a(P.value)}}static{this.offOption={label:"Off",value:"",ariaLabel:"Turn off auto refresh"}}static{this.liveOption={label:"Live",value:"LIVE",ariaLabel:"Turn on live streaming"}}static{this.autoOption={label:"Auto",value:"auto",ariaLabel:"Select refresh from the query range"}}static{this.isLive=f=>f===d.liveOption.value}getVariant(){return this.props.isLive||this.props.primary?"primary":this.props.isOnCanvas?"canvas":"default"}render(){const{onRefresh:f,intervals:P,tooltip:a,value:E,text:g,isLoading:h,noIntervalPicker:D,width:v,showAutoInterval:C}=this.props,T=E||"",S=this.getVariant(),O=c({intervals:P,showAutoInterval:C}),x=O.find(({value:L})=>L===T),b=p(d.offOption.value);let M=x||b;M.label===b.label&&(M={value:""});const A=M.ariaLabel,R=(0,o.t)("refresh-picker.aria-label.duration-selected","Choose refresh time interval with current interval {{durationAriaLabel}} selected",{durationAriaLabel:A}),B=(0,o.t)("refresh-picker.aria-label.choose-interval","Auto refresh turned off. Choose refresh time interval"),U=M.value===""?B:R,W=(0,o.t)("refresh-picker.tooltip.interval-selected","Set auto refresh interval"),N=(0,o.t)("refresh-picker.tooltip.turned-off","Auto refresh off"),w=M.value===""?N:W;return n.createElement(m.e,{className:"refresh-picker"},n.createElement(i.I,{"aria-label":g,tooltip:a,onClick:f,variant:S,icon:h?"spinner":"sync",style:v?{width:v}:void 0,"data-testid":r.Tp.components.RefreshPicker.runButtonV2},g),!D&&n.createElement(l.f,{value:M,options:O,onChange:this.onChangeSelect,variant:S,"data-testid":r.Tp.components.RefreshPicker.intervalButtonV2,"aria-label":U,tooltip:w}))}}function p(y){switch(y){case d.liveOption.value:return{label:(0,o.t)("refresh-picker.live-option.label","Live"),value:y,ariaLabel:(0,o.t)("refresh-picker.live-option.aria-label","Turn on live streaming")};case d.offOption.value:return{label:(0,o.t)("refresh-picker.off-option.label","Off"),value:y,ariaLabel:(0,o.t)("refresh-picker.off-option.aria-label","Turn off auto refresh")};case d.autoOption.value:return{label:(0,o.t)("refresh-picker.auto-option.label",d.autoOption.label),value:y,ariaLabel:(0,o.t)("refresh-picker.auto-option.aria-label",d.autoOption.ariaLabel)}}return{label:y,value:y}}function c({intervals:y=u,showAutoInterval:f=!1}={}){const P=y.map(a=>{const E=(0,s.E9)(a),g=(0,t.a)(E);return{label:a,value:a,ariaLabel:g}});return f&&P.unshift(p(d.autoOption.value)),P.unshift(p(d.offOption.value)),P}},44522:(G,I,e)=>{"use strict";e.d(I,{I:()=>s});var t=e(96540),n=e(40672);function s({component:r,content:o,...m}){return t.createElement(r||"span",{dangerouslySetInnerHTML:{__html:n.sQ.sanitize(o)},...m})}},56286:(G,I,e)=>{"use strict";e.d(I,{L:()=>i});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(55852),m=e(90090);const l=()=>({noRadiusInput:(0,t.css)({borderBottomRightRadius:"0 !important",borderTopRightRadius:"0 !important"}),noRadiusButton:(0,t.css)({borderBottomLeftRadius:"0 !important",borderTopLeftRadius:"0 !important"})}),i=({label:u="Password",labelWidth:d,inputWidth:p=12,onReset:c,isConfigured:y,tooltip:f,placeholder:P="Password",interactive:a,...E})=>{const g=l();return r.createElement(m.z,{label:u,tooltip:f,interactive:a,labelWidth:d,inputEl:y?r.createElement(r.Fragment,null,r.createElement("input",{type:"text",className:(0,t.cx)(`gf-form-input width-${p}`,g.noRadiusInput),disabled:!0,value:"configured",...(0,n.omit)(E,"value")}),r.createElement(o.$n,{onClick:c,variant:"secondary",type:"button"},"Reset")):r.createElement("input",{type:"password",className:`gf-form-input width-${p}`,placeholder:P,...E})})};i.displayName="SecretFormField"},9226:(G,I,e)=>{"use strict";e.d(I,{L4:()=>l});var t=e(96540),n=e(55852),s=e(10354),r=e(67061);const o="configured",m="Reset",l=({isConfigured:i,onReset:u,...d})=>t.createElement(r.B,null,!i&&t.createElement(s.p,{...d,type:"password"}),i&&t.createElement(t.Fragment,null,t.createElement(s.p,{...d,type:"text",disabled:!0,value:o}),t.createElement(n.$n,{onClick:u,variant:"secondary"},m)))},49718:(G,I,e)=>{"use strict";e.d(I,{L:()=>t.L4});var t=e(9226)},58724:(G,I,e)=>{"use strict";e.d(I,{lp:()=>p});var t=e(32196),n=e(96540),s=e(40845),r=e(55852),o=e(90613),m=e(67061),l=e(21744);const i="configured",u="Reset",d=c=>({configuredStyle:(0,t.css)({minHeight:c.spacing(c.components.height.md),paddingTop:c.spacing(.5),resize:"none"})}),p=({isConfigured:c,onReset:y,...f})=>{const P=(0,s.of)(d);return n.createElement(m.B,null,n.createElement(o.a,null,!c&&n.createElement(l.f,{...f}),c&&n.createElement(l.f,{...f,rows:1,disabled:!0,value:i,className:(0,t.cx)(P.configuredStyle)})),c&&n.createElement(r.$n,{onClick:y,variant:"secondary"},u))}},7968:(G,I,e)=>{"use strict";e.d(I,{l:()=>t.lp});var t=e(58724)},38401:(G,I,e)=>{"use strict";e.d(I,{Y:()=>d});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(40845),m=e(76892),l=e(13102),i=e(86997),u=e(2336);function d({options:p,value:c,onChange:y,Component:f,className:P,allowCustomValue:a,allowEmptyValue:E,placeholder:g,disabled:h,inputMinWidth:D,inputPlaceholder:v,onExpandedChange:C,autofocus:T=!1,...S}){const[O,x,b,M]=(0,u.Q)(T,C),A=D?Math.max(D,x):x,R=(0,o.of)(i.m);if(!b){const B=(0,n.isObject)(c)?c.label:c,U=B!=null?String(B):void 0;return r.createElement(O,{disabled:h,Component:f||r.createElement(m.c,{className:(0,t.cx)(R.segment,{[R.queryPlaceholder]:g!==void 0&&!c,[R.disabled]:h},P)},U||g)})}return r.createElement(l.a,{...S,value:c&&!(0,n.isObject)(c)?{value:c}:c,placeholder:v,options:p,width:A,onClickOutside:()=>M(!1),allowCustomValue:a,allowEmptyValue:E,onChange:B=>{M(!1),y(B)}})}},83684:(G,I,e)=>{"use strict";e.d(I,{s:()=>c});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(41053),m=e(40845),l=e(76412),i=e(76892),u=e(13102),d=e(86997),p=e(2336);function c({value:f,onChange:P,loadOptions:a,reloadOptionsOnChange:E=!1,Component:g,className:h,allowCustomValue:D,allowEmptyValue:v,disabled:C,placeholder:T,inputMinWidth:S,inputPlaceholder:O,autofocus:x=!1,onExpandedChange:b,noOptionMessageHandler:M=y,...A}){const[R,B]=(0,o.A)(a,[a]),[U,W,N,w]=(0,p.Q)(x,b),L=S?Math.max(S,W):W,V=(0,m.of)(d.m);if(!N){const K=(0,n.isObject)(f)?f.label:f,k=K!=null?String(K):void 0;return r.createElement(U,{onClick:E?void 0:B,disabled:C,Component:g||r.createElement(i.c,{className:(0,t.cx)(V.segment,{[V.queryPlaceholder]:T!==void 0&&!f,[V.disabled]:C},h)},k||T)})}return r.createElement(u.a,{...A,value:f&&!(0,n.isObject)(f)?{value:f}:f,placeholder:O,options:R.value??[],loadOptions:E?B:void 0,width:L,noOptionsMessage:M(R),allowCustomValue:D,allowEmptyValue:v,onClickOutside:()=>{w(!1)},onChange:K=>{w(!1),P(K)}})}function y(f){return f.loading?(0,l.t)("grafana-ui.segment-async.loading","Loading options..."):f.error?(0,l.t)("grafana-ui.segment-async.error","Failed to load options"):(0,l.t)("grafana-ui.segment-async.no-options","No options found")}},57752:(G,I,e)=>{"use strict";e.d(I,{o:()=>d});var t=e(32196),n=e(96540),s=e(37151),r=e(40845),o=e(29413),m=e(76892),l=e(86997),i=e(2336);const u=14;function d({value:p,onChange:c,Component:y,className:f,placeholder:P,inputPlaceholder:a,disabled:E,autofocus:g=!1,onExpandedChange:h,...D}){const v=(0,n.useRef)(null),[C,T]=(0,n.useState)(p),[S,O]=(0,n.useState)((0,o.kD)((p||"").toString(),u).width),[x,,b,M]=(0,i.Q)(g,h),A=(0,r.of)(l.m);if((0,s.A)(v,()=>{M(!1),c(C)}),!b)return n.createElement(x,{disabled:E,Component:y||n.createElement(m.c,{className:(0,t.cx)(A.segment,{[A.queryPlaceholder]:P!==void 0&&!C,[A.disabled]:E},f)},p||P)});const R=(0,t.css)({width:`${Math.max(S+20,32)}px`});return n.createElement("input",{...D,ref:v,autoFocus:!0,className:(0,t.cx)("gf-form gf-form-input",R),value:C,placeholder:a,onChange:B=>{const{width:U}=(0,o.kD)(B.target.value,u);O(U),T(B.target.value)},onBlur:()=>{M(!1),c(C)},onKeyDown:B=>{[13,27].includes(B.keyCode)&&(M(!1),c(C))}})}},64765:(G,I,e)=>{"use strict";e.d(I,{L:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(39268),o=e(76892);const m=({label:i,htmlFor:u,children:d,fill:p})=>{const c=(0,s.of)(l);return n.createElement(n.Fragment,null,n.createElement(r.C,null,n.createElement(o.c,{htmlFor:u,width:12,className:c.label},i),d,p&&n.createElement("div",{className:c.fill},n.createElement(o.c,null,""))))},l=i=>({label:(0,t.css)({color:i.colors.primary.text}),fill:(0,t.css)({flexGrow:1,marginBottom:i.spacing(.5)})})},13102:(G,I,e)=>{"use strict";e.d(I,{a:()=>r});var t=e(96540),n=e(40845),s=e(21594);function r({value:o,placeholder:m="",options:l=[],onChange:i,onClickOutside:u,loadOptions:d=void 0,width:p,noOptionsMessage:c="",allowCustomValue:y=!1,allowEmptyValue:f=!1,...P}){const a=(0,t.useRef)(null),E=(0,n.$j)();let g=p>0?p/E.spacing.gridSize:void 0,h,D={};return d?(h=s.DW,D={loadOptions:d,defaultOptions:!0}):h=s.l6,t.createElement("div",{...P,ref:a},t.createElement(h,{width:g,noOptionsMessage:c,placeholder:m,autoFocus:!0,isOpen:!0,onChange:i,options:l,value:o,closeMenuOnSelect:!1,onCloseMenu:()=>{if(a&&a.current){const v=a.current.querySelector('input[id^="react-select-"]');v&&(v.value||f)?i({value:v.value,label:v.value}):u()}},allowCustomValue:y,...D}))}},86997:(G,I,e)=>{"use strict";e.d(I,{m:()=>n});var t=e(32196);const n=s=>{const r="v1"in s?s.v1.palette:s.palette;return{segment:(0,t.css)({cursor:"pointer",width:"auto"}),queryPlaceholder:(0,t.css)({color:r.gray2}),disabled:(0,t.css)({cursor:"not-allowed",opacity:.65,boxShadow:"none"})}}},2336:(G,I,e)=>{"use strict";e.d(I,{Q:()=>r});var t=e(96540),n=e(40845),s=e(55852);const r=(o,m)=>{const l=(0,t.useRef)(null),i=(0,n.of)(s.my),[u,d]=(0,t.useState)(o),[p,c]=(0,t.useState)(0),y=P=>{d(P),m&&m(P)};return[({Component:P,onClick:a,disabled:E})=>t.createElement("button",{type:"button",className:i,ref:l,disabled:E,onClick:()=>{y(!0),l&&l.current&&c(l.current.clientWidth*1.25),a?.()}},P),p,u,y]}},5342:(G,I,e)=>{"use strict";e.d(I,{O:()=>o,p:()=>m});var t=e(96540),n=e(40845),s=e(29158),r=e(88824);const o=({innerProps:l,children:i})=>{const u=(0,n.$j)(),d=(0,r.J)(u);return t.createElement("div",{...l,className:d.multiValueContainer},i)},m=({children:l,innerProps:i})=>{const u=(0,n.$j)(),d=(0,r.J)(u);return t.createElement(s.K,{...i,name:"times",size:"sm",className:d.multiValueRemove,tooltip:"Remove"})}},21594:(G,I,e)=>{"use strict";e.d(I,{Iv:()=>he,DW:()=>ue,gZ:()=>Te,KF:()=>ce,l6:()=>ie,KA:()=>v.K,ip:()=>fe});var t=e(96540),n=e(72635),s=e(46005),r=e(8539),o=e(93943),m=e(66963),l=e(50877),i=e(40845),u=e(14578),d=e(62930),p=e(28581);const c=de=>{let le;return"data-testid"in de.selectProps&&de.selectProps["data-testid"]&&(le=de.selectProps["data-testid"]+"-input"),t.createElement(p.c.Input,{...de,"data-testid":le})};function y({selectProps:de}){const le=de.menuIsOpen,pe=le?"search":"angle-down",ve=le?"sm":"md";return t.createElement(u.I,{name:pe,size:ve})}var f=e(32196),P=e(10354);const a=t.forwardRef((de,le)=>{const{children:pe}=de,ve=(0,i.$j)(),be=(0,P.n)({theme:ve,invalid:!1});return t.createElement("div",{className:(0,f.cx)(be.suffix,(0,f.css)({position:"relative"})),ref:le},pe)});a.displayName="IndicatorsContainer";var E=e(87266);const g=t.forwardRef(function({focused:le,invalid:pe,disabled:ve,children:be,innerProps:Oe,prefix:Me,...Ue},we){const Re=(0,i.of)(h,pe,!!Me);return t.createElement("div",{className:Re.input,...Oe,ref:we},Me&&t.createElement("div",{className:(0,f.cx)(Re.prefix)},Me),be)}),h=(de,le,pe)=>{const ve=(0,P.n)({theme:de,invalid:le});return{input:(0,f.cx)((0,E.g$)(de),(0,f.css)({width:"100%",maxWidth:"100%",display:"flex",flexDirection:"row",alignItems:"center",flexWrap:"wrap",justifyContent:"space-between",paddingRight:0,position:"relative",boxSizing:"border-box"}),pe&&(0,f.css)({paddingLeft:0})),prefix:(0,f.cx)(ve.prefix,(0,f.css)({position:"relative"}))}};var D=e(5342),v=e(4603),C=e(2543),T=e(91793),S=e(8887),O=e(13544),x=e(40276),b=e(88824);const M=({children:de,maxHeight:le,innerRef:pe,innerProps:ve})=>{const be=(0,i.$j)(),Oe=(0,b.J)(be);return t.createElement("div",{...ve,className:Oe.menu,style:{maxHeight:le},"aria-label":"Select options menu"},t.createElement(x.E,{scrollRefCallback:pe,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0},de))};M.displayName="SelectMenu";const A=37,R=8,B=8,U=36,W=({children:de,maxHeight:le,options:pe,focusedOption:ve})=>{const be=(0,i.$j)(),Oe=(0,b.J)(be),Me=(0,t.useRef)(null),Ue=(0,t.useMemo)(()=>pe.flatMap($e=>$e.options?[$e,...$e.options]:[$e]),[pe]),we=Ue.findIndex($e=>$e.value===ve?.value);if((0,t.useEffect)(()=>{Me.current?.scrollToItem(we)},[we]),!Array.isArray(de))return null;const Re=de.flatMap($e=>N($e)?[t.cloneElement($e,{children:null}),...$e.props.children]:[$e]),xe=((0,C.max)(Ue.map($e=>$e.label?.length))??0)*R+B*2+U,Ve=Math.min(Re.length*A,le);return t.createElement(T.Y1,{ref:Me,className:Oe.menu,height:Ve,width:xe,"aria-label":"Select options menu",itemCount:Re.length,itemSize:A},({index:$e,style:Xe})=>t.createElement("div",{style:{...Xe,overflow:"hidden"}},Re[$e]))},N=de=>t.isValidElement(de)&&Array.isArray(de.props.children);W.displayName="VirtualizedSelectMenu";const w=({children:de,data:le,innerProps:pe,innerRef:ve,isFocused:be,isSelected:Oe,renderOptionLabel:Me})=>{const Ue=(0,i.$j)(),we=(0,b.J)(Ue),Re=le.icon?(0,S.Uo)(le.icon):void 0,{onMouseMove:Fe,onMouseOver:xe,...Ve}=pe;return t.createElement("div",{ref:ve,className:(0,f.cx)(we.option,be&&we.optionFocused,Oe&&we.optionSelected,le.isDisabled&&we.optionDisabled),...Ve,"data-testid":O.Tp.components.Select.option,title:le.title},Re&&t.createElement(u.I,{name:Re,className:we.optionIcon}),le.imgUrl&&t.createElement("img",{className:we.optionImage,src:le.imgUrl,alt:le.label||String(le.value)}),t.createElement("div",{className:we.optionBody},t.createElement("span",null,Me?Me(le):de),le.description&&t.createElement("div",{className:we.optionDescription},le.description),le.component&&t.createElement(le.component,null)))};w.displayName="SelectMenuOptions";const L=({children:de,cx:le,getClassNames:pe,getStyles:ve,Heading:be,headingProps:Oe,label:Me,selectProps:Ue,theme:we})=>{const Re=(0,i.of)(b.J);return t.createElement("div",{className:Re.group},t.createElement(be,{cx:le,getClassNames:pe,getStyles:ve,selectProps:Ue,theme:we,...Oe},Me),de)};var V=e(94753);const K=de=>{const le=(0,i.of)(b.J);return t.createElement("div",{className:le.groupHeader},t.createElement(V.E,{weight:"bold",variant:"bodySmall",color:"secondary"},de.children??""))};var k=e(62235);class j extends t.Component{render(){const{children:le}=this.props,{selectProps:pe}=this.props;if(pe&&Array.isArray(le)&&Array.isArray(le[0])&&pe.maxVisibleValues!==void 0&&!(pe.showAllSelectedWhenOpen&&pe.menuIsOpen)){const[ve,...be]=le,Oe=ve.slice(0,pe.maxVisibleValues);return this.renderContainer([Oe,...be])}return this.renderContainer(le)}renderContainer(le){const{isMulti:pe,theme:ve,selectProps:be}=this.props,Oe=this.props.selectProps?.noMultiValueWrap&&!this.props.selectProps?.menuIsOpen,Me=(0,b.J)(ve),Ue=be["data-testid"],we=(0,f.cx)(Me.valueContainer,{[Me.valueContainerMulti]:pe&&!Oe,[Me.valueContainerMultiNoWrap]:pe&&Oe});return t.createElement("div",{"data-testid":Ue,className:we},le)}}const H=(0,i.cV)(j);var J=e(23731);const X=(de,le)=>{if(Array.isArray(de)){const pe=de.filter(Boolean);return pe?.length?pe:void 0}if(typeof de=="object")return[de];if(typeof de=="string"||typeof de=="number"){const pe=se(de,le);if(pe)return[pe]}},se=(de,le)=>{for(const pe of le)if("options"in pe){let ve=se(de,pe.options);if(ve)return ve}else if("value"in pe&&pe.value===de)return pe;return null},ae=de=>de.map(({description:le,...pe})=>pe),ne=de=>{const{children:le,innerProps:pe,selectProps:{menuIsOpen:ve,onMenuClose:be,onMenuOpen:Oe},isFocused:Me,isMulti:Ue,getValue:we,innerRef:Re}=de,Fe=de.selectProps;return Fe.renderControl?t.createElement(Fe.renderControl,{isOpen:ve,value:Ue?we():we()[0],ref:Re,onClick:ve?be:Oe,onBlur:be,disabled:!!Fe.disabled,invalid:!!Fe.invalid}):t.createElement(g,{ref:Re,innerProps:pe,prefix:Fe.prefix,focused:Me,invalid:!!Fe.invalid,disabled:!!Fe.disabled},le)};function q({allowCustomValue:de=!1,allowCreateWhileLoading:le=!1,"aria-label":pe,"data-testid":ve,autoFocus:be=!1,backspaceRemovesValue:Oe=!0,blurInputOnSelect:Me,cacheOptions:Ue,className:we,closeMenuOnSelect:Re=!0,components:Fe,createOptionPosition:xe="last",defaultOptions:Ve,defaultValue:$e,disabled:Xe=!1,filterOption:gt,formatCreateLabel:Dt,getOptionLabel:nt,getOptionValue:at,inputValue:Ae,invalid:re,isClearable:Z=!1,id:oe,isLoading:Ee=!1,isMulti:ye=!1,inputId:Se,isOpen:Be,isOptionDisabled:We,isSearchable:Ke=!0,loadOptions:it,loadingMessage:rt="Loading options...",maxMenuHeight:ft=300,minMenuHeight:pt,maxVisibleValues:Ge,menuPlacement:qe="auto",menuPosition:bt,menuShouldPortal:Ft=!0,noOptionsMessage:Xt=(0,n.t)("grafana-ui.select.no-options-label","No options found"),onBlur:Lt,onChange:Qt,onCloseMenu:an,onCreateOption:gn,onInputChange:ut,onKeyDown:Nt,onMenuScrollToBottom:ht,onMenuScrollToTop:Rt,onOpenMenu:_t,onFocus:on,openMenuOnFocus:ln=!1,options:bn=[],placeholder:In=(0,n.t)("grafana-ui.select.placeholder","Choose"),prefix:Mn,renderControl:vt,showAllSelectedWhenOpen:nn=!0,tabSelectsValue:cn=!0,value:mt,virtualized:lt=!1,noMultiValueWrap:Tt,width:Vt,isValidNewOption:zt,formatOptionLabel:rn,hideSelectedOptions:mn,...dt}){const wt=(0,i.$j)(),en=(0,b.J)(wt),En=(0,t.useRef)(null),[yt,At]=(0,t.useState)(!1),Kt=(0,J.z)(wt,Vt),[Jt,Mt]=(0,t.useState)(!!Ae);(0,t.useEffect)(()=>{if(it&&Be&&En.current&&En.current.controlRef&&qe==="auto"){const oa=window.innerHeight-En.current.controlRef.getBoundingClientRect().bottom;At(oa<ft)}},[ft,qe,it,Be]);const Je=(0,t.useCallback)((oa,_n)=>{if(ye&&oa==null)return Qt([],_n);Qt(oa,_n)},[ye,Qt]);let Nn=s.Ay;const xn={};let Fn={},wn;if(ye&&it)wn=mt;else if(ye&&mt&&Array.isArray(mt)&&!it)wn=mt.map(oa=>{const _n=se(oa.value??oa,bn);return _n||(typeof oa=="string"?(0,l.z)(oa):oa)});else if(it){const oa=$e||mt;wn=oa?[oa]:[]}else wn=X(mt,bn);const Wn={"aria-label":pe,"data-testid":ve,autoFocus:be,backspaceRemovesValue:Oe,blurInputOnSelect:Me,captureMenuScroll:ht||Rt,closeMenuOnSelect:Re,defaultValue:$e,disabled:Xe,filterOption:Jt?gt:null,getOptionLabel:nt,getOptionValue:at,hideSelectedOptions:mn,inputValue:Ae,invalid:re,isClearable:Z,id:oe,isDisabled:Xe,isLoading:Ee,isMulti:ye,inputId:Se,isOptionDisabled:We,isSearchable:Ke,maxMenuHeight:ft,minMenuHeight:pt,maxVisibleValues:Ge,menuIsOpen:Be,menuPlacement:qe==="auto"&&yt?"top":qe,menuPosition:bt,menuShouldBlockScroll:!0,menuPortalTarget:Ft&&typeof document<"u"?document.body:void 0,menuShouldScrollIntoView:!1,onBlur:Lt,onChange:Je,onInputChange:(oa,_n)=>{const Wa=ut?.(oa,_n)??oa,za=!!Wa;return za!==Jt&&Mt(za),Wa},onKeyDown:Nt,onMenuClose:an,onMenuOpen:_t,onMenuScrollToBottom:ht,onMenuScrollToTop:Rt,onFocus:on,formatOptionLabel:rn,openMenuOnFocus:ln,options:lt?ae(bn):bn,placeholder:In,prefix:Mn,renderControl:vt,showAllSelectedWhenOpen:nn,tabSelectsValue:cn,value:ye?wn:wn?.[0],noMultiValueWrap:Tt};de&&(Nn=m.A,xn.allowCreateWhileLoading=le,xn.formatCreateLabel=Dt??ee,xn.onCreateOption=gn,xn.createOptionPosition=xe,xn.isValidNewOption=zt),it&&(Nn=de?o.A:r.A,Fn={loadOptions:it,cacheOptions:Ue,defaultOptions:Ve});const da=lt?W:M;return t.createElement(t.Fragment,null,t.createElement(Nn,{ref:En,components:{MenuList:da,Group:L,GroupHeading:K,ValueContainer:H,IndicatorsContainer:z,IndicatorSeparator:te,Control:ne,Option:w,ClearIndicator(oa){const{clearValue:_n}=oa;return t.createElement(u.I,{name:"times",role:"button","aria-label":"select-clear-value",className:en.singleValueRemove,onMouseDown:Wa=>{Wa.preventDefault(),Wa.stopPropagation(),_n()}})},LoadingIndicator(){return t.createElement(d.y,{inline:!0})},LoadingMessage(){return t.createElement("div",{className:en.loadingMessage},rt)},NoOptionsMessage(){return t.createElement("div",{className:en.loadingMessage,"aria-label":"No options provided"},Xt)},DropdownIndicator:y,SingleValue(oa){return t.createElement(k.K,{...oa,isDisabled:Xe})},SelectContainer:v.K,MultiValueContainer:D.O,MultiValueRemove:Xe?()=>null:D.p,Input:c,...Fe},styles:Kt,className:we,...Wn,...xn,...Fn,...dt}))}function ee(de){return t.createElement("div",{style:{display:"flex",gap:"8px",alignItems:"center"}},t.createElement("div",null,de),t.createElement("div",{style:{flexGrow:1}}),t.createElement("div",{className:"muted small",style:{display:"flex",gap:"8px",alignItems:"center"}},"Hit enter to add"))}function z(de){const{showAllSelectedWhenOpen:le,maxVisibleValues:pe,menuIsOpen:ve}=de.selectProps,be=de.getValue();if(pe!==void 0&&Array.isArray(de.children)){const Oe=be.length;if(Oe>pe&&!(le&&ve)){const Me=[...de.children];return Me.splice(-1,0,t.createElement("span",{key:"excess-values",id:"excess-values"},"(+",Oe-pe,")")),t.createElement(a,{...de},Me)}}return t.createElement(a,{...de})}function te(){return t.createElement(t.Fragment,null)}function ie(de){return t.createElement(q,{...de})}function ce(de){return t.createElement(q,{...de,isMulti:!0})}function ue(de){return t.createElement(q,{...de})}function fe(de){return t.createElement(q,{virtualized:!0,...de})}function Te(de){return t.createElement(q,{virtualized:!0,...de})}function he(de){return t.createElement(q,{...de,isMulti:!0})}},4603:(G,I,e)=>{"use strict";e.d(I,{K:()=>i});var t=e(32196),n=e(96540),s=e(28581),r=e(40845),o=e(16797),m=e(87266),l=e(10354);const i=d=>{const{isDisabled:p,isFocused:c,children:y,selectProps:{invalid:f=!1}}=d,P=(0,r.of)(u,c,p,f);return n.createElement(s.c.SelectContainer,{...d,className:(0,t.cx)(P.wrapper,d.className)},y)},u=(d,p,c,y)=>{const f=(0,l.n)({theme:d,invalid:y});return{wrapper:(0,t.cx)(f.wrapper,(0,m.Xb)(d,y),p&&(0,t.css)((0,o.getFocusStyles)(d)),c&&f.inputDisabled,(0,t.css)({position:"relative",boxSizing:"border-box",flexDirection:"row",flexWrap:"wrap",alignItems:"stretch",justifyContent:"space-between",minHeight:"32px",height:"auto",maxWidth:"100%",padding:0,cursor:c?"not-allowed":"pointer"}))}}},62235:(G,I,e)=>{"use strict";e.d(I,{K:()=>c});var t=e(32196),n=e(96540),s=e(28581),r=e(8887),o=e(40845);function m(f,P={}){const{duration:a=250,delay:E=250}=P,[g,h]=(0,n.useState)(f),D=(0,n.useRef)();return(0,n.useEffect)(()=>{let v;if(f)v=setTimeout(()=>{D.current=new Date,h(f)},E);else{const C=D.current?Date.now()-D.current.valueOf():0,T=()=>{D.current=void 0,h(f)};C>=a?T():v=setTimeout(T,a-C)}return()=>{v&&(clearTimeout(v),v=void 0)}},[f,a,E]),g}var l=e(14578),i=e(62930),u=e(31511),d=e(72960);const p=f=>({singleValue:(0,t.css)({label:"singleValue",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxSizing:"border-box",maxWidth:"100%",gridArea:"1 / 1 / 2 / 3"}),spinnerWrapper:(0,t.css)({width:"16px",height:"16px",display:"inline-block",marginRight:"10px",position:"relative",verticalAlign:"middle",overflow:"hidden"}),spinnerIcon:(0,t.css)({width:"100%",height:"100%",position:"absolute"}),optionIcon:(0,t.css)({marginRight:f.spacing(1),color:f.colors.text.secondary}),disabled:(0,t.css)({color:f.colors.text.disabled}),isOpen:(0,t.css)({color:f.colors.text.disabled})}),c=f=>{const{children:P,data:a,isDisabled:E}=f,g=(0,o.of)(p),h=m(a.loading||!1,{delay:250,duration:750}),D=a.icon?(0,r.Uo)(a.icon):void 0;return n.createElement(s.c.SingleValue,{...f,className:(0,t.cx)(g.singleValue,E&&g.disabled,f.selectProps.menuIsOpen&&g.isOpen)},a.imgUrl?n.createElement(y,{loading:h,imgUrl:a.imgUrl,styles:g,alt:String(a.label??a.value)}):n.createElement(n.Fragment,null,n.createElement(d.n,{horizontal:!0,size:16,visible:h,duration:150},n.createElement("div",{className:g.spinnerWrapper},n.createElement(i.y,{className:g.spinnerIcon,inline:!0}))),D&&n.createElement(l.I,{name:D,role:"img",className:g.optionIcon})),!a.hideText&&P)},y=f=>n.createElement("div",{className:f.styles.spinnerWrapper},n.createElement(u.A,{duration:150,visible:f.loading},n.createElement(i.y,{className:f.styles.spinnerIcon,inline:!0})),n.createElement(u.A,{duration:150,visible:!f.loading},n.createElement("img",{className:f.styles.spinnerIcon,src:f.imgUrl,alt:f.alt})))},88824:(G,I,e)=>{"use strict";e.d(I,{J:()=>s});var t=e(32196),n=e(3911);const s=(0,n.N)(r=>({menu:(0,t.css)({label:"grafana-select-menu",background:r.components.dropdown.background,boxShadow:r.shadows.z3,position:"relative",minWidth:"100%",zIndex:1}),option:(0,t.css)({label:"grafana-select-option",padding:"8px",display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent","&:hover":{background:r.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${r.colors.primary.border}`}}}),optionIcon:(0,t.css)({marginRight:r.spacing(1)}),optionImage:(0,t.css)({label:"grafana-select-option-image",width:"16px",marginRight:"10px"}),optionDescription:(0,t.css)({label:"grafana-select-option-description",fontWeight:"normal",fontSize:r.typography.size.sm,color:r.colors.text.secondary,whiteSpace:"normal",lineHeight:r.typography.body.lineHeight}),optionBody:(0,t.css)({label:"grafana-select-option-body",display:"flex",fontWeight:r.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),optionFocused:(0,t.css)({label:"grafana-select-option-focused",background:r.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${r.colors.primary.border}`}}),optionSelected:(0,t.css)({background:r.colors.action.selected}),optionDisabled:(0,t.css)({label:"grafana-select-option-disabled",backgroundColor:r.colors.action.disabledBackground,color:r.colors.action.disabledText,cursor:"not-allowed"}),singleValue:(0,t.css)({label:"grafana-select-single-value",color:r.components.input.text,gridArea:"1 / 1 / 2 / 3",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxSizing:"border-box",maxWidth:"100%"}),valueContainer:(0,t.css)({label:"grafana-select-value-container",alignItems:"center",display:"grid",position:"relative",boxSizing:"border-box",flex:"1 1 0%",outline:"none",overflow:"hidden"}),valueContainerMulti:(0,t.css)({label:"grafana-select-value-container-multi",flexWrap:"wrap",display:"flex"}),valueContainerMultiNoWrap:(0,t.css)({display:"grid",gridAutoFlow:"column"}),loadingMessage:(0,t.css)({label:"grafana-select-loading-message",padding:r.spacing(1),textAlign:"center",width:"100%"}),multiValueContainer:(0,t.css)({label:"grafana-select-multi-value-container",display:"flex",alignItems:"center",lineHeight:1,background:r.colors.background.secondary,borderRadius:r.shape.radius.default,margin:r.spacing(.25,1,.25,0),padding:r.spacing(.25,0,.25,1),color:r.colors.text.primary,fontSize:r.typography.size.sm,overflow:"hidden",whiteSpace:"nowrap","&:hover":{background:r.colors.emphasize(r.colors.background.secondary)}}),multiValueRemove:(0,t.css)({label:"grafana-select-multi-value-remove",margin:r.spacing(0,.5),cursor:"pointer",svg:{marginBottom:0}}),singleValueRemove:(0,t.css)({cursor:"pointer","&:hover":{color:r.colors.text.primary}}),groupHeader:(0,t.css)({padding:r.spacing(1,1,1,.75),borderLeft:"2px solid transparent"}),group:(0,t.css)({"&:not(:first-child)":{borderTop:`1px solid ${r.colors.border.weak}`},':has(+ [role="option"])':{borderBottom:`1px solid ${r.colors.border.weak}`}})}))},23731:(G,I,e)=>{"use strict";e.d(I,{A:()=>n,z:()=>s});var t=e(96540);function n(r){return{clearIndicator:()=>({}),container:()=>({}),control:()=>({}),dropdownIndicator:()=>({}),group:()=>({}),groupHeading:()=>({}),indicatorsContainer:()=>({}),indicatorSeparator:()=>({}),input:function(o){return{...o,color:"inherit",margin:0,padding:0,zIndex:1,overflow:"hidden"}},loadingIndicator:()=>({}),loadingMessage:()=>({}),menu:()=>({}),menuList:({maxHeight:o})=>({maxHeight:o}),multiValue:()=>({}),multiValueLabel:()=>({overflow:"hidden",textOverflow:"ellipsis"}),multiValueRemove:()=>({}),noOptionsMessage:()=>({}),option:()=>({}),placeholder:o=>({...o,color:r.colors.text.secondary}),singleValue:()=>({}),valueContainer:()=>({})}}function s(r,o){return(0,t.useMemo)(()=>({...n(r),menuPortal:m=>({...m,zIndex:r.zIndex.portal}),menu:({top:m,bottom:l,position:i})=>({top:m,bottom:l,position:i,minWidth:"100%",zIndex:r.zIndex.dropdown}),container:()=>({width:o?r.spacing(o):"100%",display:o==="auto"?"inline-flex":"flex"}),option:(m,l)=>({...m,opacity:l.isDisabled?.5:1})}),[r,o])}},62883:()=>{"use strict"},67570:(G,I,e)=>{"use strict";e.d(I,{u:()=>y});var t=e(2543),n=e.n(t),s=e(96540),r=e(13752),o=e(62467),m=e(11150),l=e(96083),i=e(63720),u=e(59099),d=e(54479),p=e(11134);function c(f){return{label:f,value:stringToMs(f)}}class y extends s.PureComponent{constructor(P){super(P),this.propsSubject=new r.B,this.subscription=null}componentDidMount(){this.subscription=this.propsSubject.pipe((0,i.n)(P=>p.cC.isLive(P.interval)?(0,o.of)({}):P.loading?m.t:(0,l.Y)((0,d.dc)(P.interval))),(0,u.M)(()=>this.props.func())).subscribe(),this.propsSubject.next(this.props)}componentDidUpdate(P){p.cC.isLive(P.interval)&&p.cC.isLive(this.props.interval)||(0,t.isEqual)(P,this.props)||this.propsSubject.next(this.props)}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe(),this.propsSubject.unsubscribe()}render(){return null}}},63250:(G,I,e)=>{"use strict";e.d(I,{I1:()=>E,_$:()=>y,gl:()=>p});var t=e(2543),n=e.n(t),s=e(75059),r=e(47070),o=e(50082),m=e(62398),l=e(24293),i=e(90708),u=e(47737);const d=["reduceOptions","orientation"];function p(g,h,D){let v=g.options;if(g.fieldConfig=g.fieldConfig||{defaults:{},overrides:[]},h==="singlestat"&&D.angular)return c(g,D);for(const C of d)D.hasOwnProperty(C)&&(v[C]=(0,t.cloneDeep)(D[C]));return v}function c(g,h){const D=h.angular,v=s.AS.getIfExists(D.valueName),C={reduceOptions:{calcs:[v?v.id:s.gy.mean]},orientation:r.wV.Horizontal},T={};if(D.format&&(T.unit=D.format),D.tableColumn&&(C.reduceOptions.fields=`/^${D.tableColumn}$/`),D.nullPointMode&&(T.nullValueMode=D.nullPointMode),D.nullText&&(T.noValue=D.nullText),(D.decimals||D.decimals===0)&&(T.decimals=D.decimals),D.thresholds&&D.colors){const O=D.thresholds.split(",").map(b=>Number(b.trim())),x=[];for(const b of D.colors){const M=x.length-1;M>=0?x.push({value:O[M],color:b}):x.push({value:-1/0,color:b})}T.thresholds={mode:o.O.Absolute,steps:x}}const S=(0,m.bh)(D,T.thresholds);return S&&S.length&&(T.mappings=S),D.gauge&&D.gauge.show&&(T.min=D.gauge.minValue,T.max=D.gauge.maxValue),g.fieldConfig.defaults=T,C}function y(g){if(!g.options)return{};const h=parseFloat(g.pluginVersion||"6.1");let D=g.options;h<6.2&&(D=P(D)),h<6.3&&(D=f(D));const{fieldOptions:v}=D;if(h<6.6&&v){if(v&&v.override){const{override:S,...O}=D.fieldOptions;D={...D,fieldOptions:{...O,overrides:[]}}}let C=v?.defaults?.thresholds;C?delete v.defaults.thresholds:(C=v?.thresholds,delete v.thresholds),C&&(v.defaults.thresholds={mode:o.O.Absolute,steps:C});const{defaults:T}=v;T.color&&typeof T.color=="string"&&(T.color={mode:l.Y.Fixed,fixedColor:T.color}),(0,i.BF)(T)}if(h<7&&(g.fieldConfig=g.fieldConfig||{defaults:{},overrides:[]},g.fieldConfig={defaults:v&&v.defaults?{...g.fieldConfig.defaults,...v.defaults}:g.fieldConfig.defaults,overrides:v&&v.overrides?[...g.fieldConfig.overrides,...v.overrides]:g.fieldConfig.overrides},v&&(D.reduceOptions={values:v.values,limit:v.limit,calcs:v.calcs}),delete D.fieldOptions),h<7.1){const C=g.fieldConfig.defaults.title;C!=null&&(g.fieldConfig.defaults.displayName=C,delete g.fieldConfig.defaults.title)}if(h<8){const C=g.fieldConfig?.defaults;let T=C?.unit;T==="percent"?((0,t.isNumber)(C.min)||(C.min=0),(0,t.isNumber)(C.max)||(C.max=100)):T==="percentunit"&&((0,t.isNumber)(C.min)||(C.min=0),(0,t.isNumber)(C.max)||(C.max=1))}return D}function f(g){const{fieldOptions:h}=g;if(!h)return g;const{mappings:D,...v}=g.fieldOptions;let C;return g.thresholds&&(C={mode:o.O.Absolute,steps:a(g.thresholds)}),{...g,fieldOptions:{...v,defaults:{...h.defaults,mappings:D,thresholds:C}}}}function P(g){const{valueOptions:h}=g;if(!h)return g;const D={},v={};if(D.mappings=g.valueMappings,D.thresholds=g.thresholds,D.defaults=v,v.unit=h.unit,v.decimals=h.decimals,h.stat){const T=s.AS.get(h.stat);T&&(D.calcs=[T.id])}v.min=g.minValue,v.max=g.maxValue;const C={...g,fieldOptions:D};return(0,t.omit)(C,"valueMappings","thresholds","valueOptions","minValue","maxValue")}function a(g){if(!g||!g.length)return;const h=g.map(D=>({value:D.value===null?-1/0:D.value,color:D.color}));return(0,u.RU)(h),h[0].value=-1/0,h}function E(g){return(0,m.bh)(g)}},37713:(G,I,e)=>{"use strict";e.d(I,{I1:()=>t.I1,_$:()=>t._$,gl:()=>t.gl});var t=e(63250)},47097:(G,I,e)=>{"use strict";e.d(I,{F:()=>p});var t=e(32196),n=e(94659),s=e(9821),r=e(96540),o=e(40845),m=e(80427);const l=c=>{const{value:y,children:f,visible:P,placement:a,tipFormatter:E,...g}=c,h=(0,r.useRef)(null),D=(0,r.useRef)(null),v=(0,o.of)(i);function C(){D.current!==null&&cancelAnimationFrame(D.current)}function T(){D.current=requestAnimationFrame(()=>{h.current?.forceAlign()})}return(0,r.useEffect)(()=>(P?T():C(),C),[y,P]),r.createElement(m.A,{overlayClassName:v.tooltip,placement:a,overlay:E??y,overlayInnerStyle:{minHeight:"auto"},ref:h,visible:P,...g},f)},i=c=>({tooltip:(0,t.css)({position:"absolute",display:"block",visibility:"visible",fontSize:c.typography.bodySmall.fontSize,opacity:.9,padding:3,zIndex:c.zIndex.tooltip})}),u=l;var d=e(24849);const p=({min:c,max:y,onChange:f,onAfterChange:P,orientation:a="horizontal",reverse:E,step:g,formatTooltipResult:h,value:D,tooltipAlwaysVisible:v=!0})=>{const C=(0,r.useCallback)(b=>{f?.(typeof b=="number"?[b,b]:b)},[f]),T=(0,r.useCallback)(b=>{P?.(typeof b=="number"?[b,b]:b)},[P]),S=a==="horizontal",O=(0,o.of)(d.$,S),x=(b,M)=>r.createElement(u,{value:M.value,visible:v||M.dragging,tipFormatter:h?()=>h(M.value):void 0,placement:S?"top":"right"},b);return r.createElement("div",{className:(0,t.cx)(O.container,O.slider)},r.createElement(n.Global,{styles:O.tooltip}),r.createElement(s.A,{min:c,max:y,step:g,defaultValue:D,range:!0,onChange:C,onChangeComplete:T,vertical:!S,reverse:E,handleRender:x}))};p.displayName="RangeSlider"},77014:(G,I,e)=>{"use strict";e.d(I,{A:()=>i});var t=e(32196),n=e(94659),s=e(9821),r=e(96540),o=e(40845),m=e(10354),l=e(24849);const i=({min:u,max:d,onChange:p,onAfterChange:c,orientation:y="horizontal",reverse:f,step:P,value:a,ariaLabelForHandle:E,marks:g,included:h})=>{const D=y==="horizontal",v=(0,o.of)(l.$,D,!!g),C=s.A,[T,S]=(0,r.useState)(a??u),O=(0,r.useCallback)(B=>{const U=typeof B=="number"?B:B[0];S(U),p?.(U)},[S,p]),x=(0,r.useCallback)(B=>{let U=+B.target.value;Number.isNaN(U)&&(U=0),S(U),p&&p(U),c&&c(U)},[p,c]),b=(0,r.useCallback)(B=>{const U=+B.target.value;U>d?S(d):U<u&&S(u)},[d,u]),M=(0,r.useCallback)(B=>{const U=typeof B=="number"?B:B[0];c?.(U)},[c]),A=D?[]:[v.sliderInputVertical],R=D?[]:[v.sliderInputFieldVertical];return r.createElement("div",{className:(0,t.cx)(v.container,v.slider)},r.createElement(n.Global,{styles:v.tooltip}),r.createElement("div",{className:(0,t.cx)(v.sliderInput,...A)},r.createElement(C,{min:u,max:d,step:P,defaultValue:a,value:T,onChange:O,onChangeComplete:M,vertical:!D,reverse:f,ariaLabelForHandle:E,marks:g,included:h}),r.createElement(m.p,{type:"text",className:(0,t.cx)(v.sliderInputField,...R),value:T,onChange:x,onBlur:b,min:u,max:d})))};i.displayName="Slider"},24849:(G,I,e)=>{"use strict";e.d(I,{$:()=>r});var t=e(32196),n=e(94659),s=e(12415);const r=(o,m,l=!1)=>{const{spacing:i}=o,u=o.colors.border.strong,d=o.colors.primary.main,p=o.colors.primary.main,y=`box-shadow: 0px 0px 0px 6px ${o.colors.primary.transparent}`;return{container:(0,t.css)({width:"100%",margin:m?"inherit":i(1,3,1,1),paddingBottom:m&&l?o.spacing(1):"inherit",height:m?"auto":"100%"}),slider:(0,t.css)`
      .rc-slider {
        display: flex;
        flex-grow: 1;
        margin-left: 7px; // half the size of the handle to align handle to the left on 0 value
      }
      .rc-slider-mark {
        top: ${o.spacing(1.75)};
      }
      .rc-slider-mark-text {
        color: ${o.colors.text.disabled};
        font-size: ${o.typography.bodySmall.fontSize};
      }
      .rc-slider-mark-text-active {
        color: ${o.colors.text.primary};
      }
      .rc-slider-handle {
        border: none;
        background-color: ${p};
        box-shadow: ${o.shadows.z1};
        cursor: pointer;
        opacity: 1;
      }

      .rc-slider-handle:hover,
      .rc-slider-handle:active,
      .rc-slider-handle-click-focused:focus {
        ${y};
      }

      // The triple class names is needed because that's the specificity used in the source css :(
      .rc-slider-handle-dragging.rc-slider-handle-dragging.rc-slider-handle-dragging,
      .rc-slider-handle:focus-visible {
        box-shadow: 0 0 0 5px ${o.colors.text.primary};
      }

      .rc-slider-dot,
      .rc-slider-dot-active {
        background-color: ${o.colors.text.primary};
        border-color: ${o.colors.text.primary};
      }

      .rc-slider-track {
        background-color: ${d};
      }
      .rc-slider-rail {
        background-color: ${u};
        cursor: pointer;
      }
    `,tooltip:(0,n.css)`
      body {
        .rc-slider-tooltip {
          cursor: grab;
          user-select: none;
          z-index: ${o.zIndex.tooltip};
        }

        .rc-slider-tooltip-inner {
          color: ${o.colors.text.primary};
          background-color: transparent !important;
          border-radius: 0;
          box-shadow: none;
        }

        .rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {
          display: none;
        }

        .rc-slider-tooltip-placement-top {
          padding: 0;
        }
      }
    `,sliderInput:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"center",width:"100%"}),sliderInputVertical:(0,t.css)({flexDirection:"column",height:"100%",".rc-slider":{margin:0,order:2}}),sliderInputField:(0,t.css)({marginLeft:o.spacing(3),width:"60px",input:{textAlign:"center"}}),sliderInputFieldVertical:(0,t.css)({margin:`0 0 ${o.spacing(3)} 0`,order:1})}}},5926:(G,I,e)=>{"use strict";e.d(I,{O:()=>a});var t=e(2543),n=e(96540),s=e(39624),r=e(21423),o=e(11261),m=e(8066),l=e(52622),i=e(81297),u=e(51336),d=e(16895),p=e(73060),c=e(14236),y=e(46294);function f(E,g){const h=E.y.values.length,D={...E.y.config,...g},v=E.x??{name:"",values:[...Array(h).keys()],type:o.PU.number,config:{}};let C={refId:"sparkline",fields:[v,{...E.y,config:D}],length:h};return(0,p.g2)(v.values)||(C=(0,c.ES)(C,0)),(0,y.M)({frame:C,refFieldPseudoMin:E.timeRange?.from.valueOf(),refFieldPseudoMax:E.timeRange?.to.valueOf()})}const P={drawStyle:l.GR.Line,showPoints:l.yL.Auto,axisPlacement:l.vM.Hidden,pointSize:2};class a extends n.PureComponent{constructor(g){super(g);const h=f(g.sparkline,g.config);this.state={data:(0,d.bq)(h,(0,d.ro)(h)),alignedDataFrame:h,configBuilder:this.prepareConfig(h)}}static getDerivedStateFromProps(g,h){const D=f(g.sparkline,g.config),v=(0,s.C)(D);return v?{...h,data:(0,d.bq)(v,(0,d.ro)(v)),alignedDataFrame:v}:{...h}}componentDidUpdate(g,h){const{alignedDataFrame:D}=this.state;if(!D)return;let v=!1;if(g.sparkline!==this.props.sparkline){const C=!(0,r.bW)(this.state.alignedDataFrame,h.alignedDataFrame),T=!(0,t.isEqual)(D.fields[1].state?.range,h.alignedDataFrame.fields[1].state?.range);v=C||T}else v=!(0,t.isEqual)(g.config,this.props.config);v&&this.setState({configBuilder:this.prepareConfig(D)})}getYRange(g){let{min:h,max:D}=this.state.alignedDataFrame.fields[1].state?.range;const v=+this.state.alignedDataFrame.fields[1].config?.noValue;return Number.isNaN(v)||(h=Math.min(h,+v),D=Math.max(D,+v)),h===D?(h===0?D=100:(h=0,D*=2),[h,D]):[Math.max(h,g.config.min??-1/0),Math.min(D,g.config.max??1/0)]}prepareConfig(g){const{theme:h}=this.props,D=new u.e;D.setCursor({show:!1,x:!1,y:!1});const v=g.fields[0];D.addScale({scaleKey:"x",orientation:l.Lt.Horizontal,direction:l.ON.Right,isTime:!1,range:()=>{const{sparkline:C}=this.props;if(C.x){if(C.timeRange&&C.x.type===o.PU.time)return[C.timeRange.from.valueOf(),C.timeRange.to.valueOf()];const T=C.x.values;return[T[0],T[T.length-1]]}return[0,C.y.values.length-1]}}),D.addAxis({scaleKey:"x",theme:h,placement:l.vM.Hidden});for(let C=0;C<g.fields.length;C++){const T=g.fields[C],S=T.config,O={...P,...S.custom};if(T===v||T.type!==o.PU.number)continue;const x=S.unit||"__fixed";D.addScale({scaleKey:x,orientation:l.Lt.Vertical,direction:l.ON.Up,range:()=>this.getYRange(T)}),D.addAxis({scaleKey:x,theme:h,placement:l.vM.Hidden});const b=(0,m.Qi)(T),M=b.getCalculator(T,h)(0,0),A=O.drawStyle===l.GR.Points?l.yL.Always:O.showPoints;D.addSeries({pxAlign:!1,scaleKey:x,theme:h,colorMode:b,thresholds:S.thresholds,drawStyle:O.drawStyle,lineColor:O.lineColor??M,lineWidth:O.lineWidth,lineInterpolation:O.lineInterpolation,showPoints:A,pointSize:O.pointSize,fillOpacity:O.fillOpacity,fillColor:O.fillColor,lineStyle:O.lineStyle,gradientMode:O.gradientMode})}return D}render(){const{data:g,configBuilder:h}=this.state,{width:D,height:v}=this.props;return n.createElement(i.Z,{data:g,config:h,width:D,height:v})}}},62930:(G,I,e)=>{"use strict";e.d(I,{y:()=>u});var t=e(32196),n=e(96540),s=e(8867),r=e(40845),o=e(4025),m=e(76412),l=e(14578),i=e(78318);const u=({className:c,inline:y=!1,iconClassName:f,style:P,size:a="md"})=>{const E=(0,r.of)(d),g=(0,r.of)(p,a),h=window.matchMedia("(prefers-reduced-motion: reduce)").matches,D=h?"hourglass":"spinner";if(typeof a!="string"||!(0,o.rJ)(a)){const v=(0,i.Wj)(),C="spinner",T=(0,i.Xi)(C,"default"),S=`${v}${T}/${C}.svg`;return n.createElement("div",{"data-testid":"Spinner",style:P,className:(0,t.cx)({[E.inline]:y},g.wrapper,c)},n.createElement(s.default,{src:S,width:a,height:a,className:(0,t.cx)("fa-spin",g.icon,c),style:P}))}return n.createElement("div",{"data-testid":"Spinner",style:P,className:(0,t.cx)({[E.inline]:y},c)},n.createElement(l.I,{className:(0,t.cx)({"fa-spin":!h},f),name:D,size:a,"aria-label":(0,m.t)("grafana-ui.spinner.aria-label","Loading")}))},d=c=>({inline:(0,t.css)({display:"inline-block"})}),p=(c,y)=>({wrapper:(0,t.css)({fontSize:typeof y=="string"?y:`${y}px`}),icon:(0,t.css)({display:"inline-block",fill:"currentColor",flexShrink:0,label:"Icon",lineHeight:0,verticalAlign:"middle"})})},21633:(G,I,e)=>{"use strict";e.d(I,{h:()=>p});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(40845),m=e(69144);const l=.3,i=new Set(["ArrowUp","ArrowDown"]),u=new Set(["ArrowLeft","ArrowRight"]),d={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function p(a){const{direction:E,initialSize:g=.5,dragPosition:h="middle",onResizing:D,onSizeChanged:v}=a,C=16,T=(0,r.useRef)(null),S=(0,r.useRef)(null),O=(0,r.useRef)(null),x=(0,r.useRef)(null),b=(0,r.useRef)(null),M=(0,r.useRef)("1fr"),A=(0,r.useRef)(void 0),R=(0,r.useRef)(void 0),B=d[E].dim,U=d[E].axis,W=d[E].min,N=d[E].max;f(x.current,te=>{for(const ie of te){if(!ie.target.isSameNode(x.current)||!S.current)return;const ce=S.current.getBoundingClientRect()[B],ue=y(S.current);T.current.ariaValueNow=c(ce,ue[W],ue[N])}},500,[N,W,E,B]);const w=(0,r.useRef)(null),L=(0,r.useCallback)(te=>{S.current&&(M.current=S.current.getBoundingClientRect()[B],b.current=x.current.getBoundingClientRect()[B],w.current=te[U],T.current.setPointerCapture(te.pointerId),A.current=y(S.current),R.current=void 0)},[B,U]),V=(0,r.useCallback)(te=>{if(w.current!==null&&M.current!=="1fr"){const ie=te[U]-w.current,ce=A.current,ue=(0,n.clamp)(M.current+ie,ce[W],ce[N]),fe=ue/(b.current-C);S.current.style.flexGrow=`${fe}`,O.current.style.flexGrow=`${1-fe}`,T.current.ariaValueNow=c(ue,ce[W],ce[N]),D?.(fe,ue)}},[C,U,W,N,D]),K=(0,r.useCallback)(te=>{te.preventDefault(),te.stopPropagation(),T.current.releasePointerCapture(te.pointerId),w.current=null,typeof M.current=="number"&&v?.(parseFloat(S.current.style.flexGrow),M.current)},[v]),k=(0,r.useRef)(new Set),j=(0,r.useRef)(null),H=(0,r.useCallback)(te=>{if(k.current.size===0){j.current=null;return}else if(M.current==="1fr")return;const ue=(te-(j.current??te))*l;let fe=0;E==="row"?(k.current.has("ArrowLeft")&&(fe-=ue),k.current.has("ArrowRight")&&(fe+=ue)):(k.current.has("ArrowUp")&&(fe-=ue),k.current.has("ArrowDown")&&(fe+=ue));const Te=A.current,he=S.current.getBoundingClientRect()[B],de=(0,n.clamp)(he+fe,Te[W],Te[N]),le=de/(b.current-C);S.current.style.flexGrow=`${le}`,O.current.style.flexGrow=`${1-le}`,T.current.ariaValueNow=c(de,Te[W],Te[N]),D?.(le,de),j.current=te,window.requestAnimationFrame(H)},[E,C,W,N,B,D]),J=(0,r.useCallback)(te=>{if(!S.current||!O.current||!T.current||!x.current)return;if(te.key==="Enter"){R.current===void 0?(R.current=S.current.style.flexGrow,S.current.style.flexGrow="0",O.current.style.flexGrow="1"):(S.current.style.flexGrow=R.current,O.current.style.flexGrow=`${1-parseFloat(R.current)}`,R.current=void 0);return}else if(te.key==="Home"){A.current=y(S.current),b.current=x.current.getBoundingClientRect()[B];const ce=A.current[W]/(b.current-C);S.current.style.flexGrow=`${ce}`,O.current.style.flexGrow=`${1-ce}`,T.current.ariaValueNow="0";return}else if(te.key==="End"){A.current=y(S.current),b.current=x.current.getBoundingClientRect()[B];const ce=A.current[N]/(b.current-C);S.current.style.flexGrow=`${ce}`,O.current.style.flexGrow=`${1-ce}`,T.current.ariaValueNow="100";return}if(!(E==="column"&&i.has(te.key)||E==="row"&&u.has(te.key))||k.current.has(te.key))return;if(R.current=void 0,te.preventDefault(),te.stopPropagation(),M.current=S.current.getBoundingClientRect()[B],b.current=x.current.getBoundingClientRect()[B],A.current=y(S.current),!k.current.has(te.key)){const ce=k.current.size===0;k.current.add(te.key),ce&&window.requestAnimationFrame(H)}},[E,H,C,N,B,W]),X=(0,r.useCallback)(te=>{E==="row"&&!u.has(te.key)||E==="column"&&!i.has(te.key)||(k.current.delete(te.key),typeof M.current=="number"&&v?.(parseFloat(S.current.style.flexGrow),M.current))},[E,v]),se=(0,r.useCallback)(()=>{if(!S.current||!O.current)return;S.current.style.flexGrow="0.5",O.current.style.flexGrow="0.5";const te=y(S.current);A.current=te,M.current=S.current.getBoundingClientRect()[B],T.current.ariaValueNow=`${c(M.current,te[W],te[N])}`},[N,B,W]),ae=(0,r.useCallback)(()=>{k.current.size>0&&(k.current.clear(),w.current=null,typeof M.current=="number"&&v?.(parseFloat(S.current.style.flexGrow),M.current))},[v]),ne=(0,o.of)(P,E),q=(0,o.of)(m.l,h),ee=E==="column"?q.dragHandleHorizontal:q.dragHandleVertical,z=(0,r.useId)();return{containerProps:{ref:x,className:ne.container},primaryProps:{ref:S,className:ne.panel,style:{[W]:"min-content",flexGrow:(0,n.clamp)(g??.5,0,1)}},secondaryProps:{ref:O,className:ne.panel,style:{flexGrow:(0,n.clamp)(1-g,0,1),[W]:"min-content"}},splitterProps:{onPointerUp:K,onPointerDown:L,onPointerMove:V,onKeyDown:J,onKeyUp:X,onDoubleClick:se,onBlur:ae,ref:T,style:{[B]:`${C}px`},role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":g*100,"aria-controls":`start-panel-${z}`,"aria-label":"Pane resize widget",tabIndex:0,className:ee}}}function c(a,E,g){return`${(0,n.clamp)((a-E)/(g-E)*100,0,100)}`}function y(a){const E=document.body.style.overflow,g=a.style.width,h=a.style.height,D=a.style.flexGrow;document.body.style.overflow="hidden",a.style.flexGrow="0";const{width:v,height:C}=a.getBoundingClientRect();a.style.flexGrow="100";const{width:T,height:S}=a.getBoundingClientRect();return document.body.style.overflow=E,a.style.width=g,a.style.height=h,a.style.flexGrow=D,{minWidth:v,maxWidth:T,minHeight:C,maxHeight:S}}function f(a,E,g=0,h){const D=(0,n.throttle)(E,g);(0,r.useLayoutEffect)(()=>{if(!a)return;const v=new ResizeObserver(D);return v.observe(a,{box:"device-pixel-content-box"}),()=>v.disconnect()},h)}function P(a,E){return{container:(0,t.css)({display:"flex",flexDirection:E==="row"?"row":"column",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,t.css)({display:"flex",position:"relative",flexBasis:0})}}},42734:(G,I,e)=>{"use strict";e.d(I,{S:()=>m});var t=e(2543),n=e.n(t),s=e(96540),r=e(75059),o=e(21594);class m extends s.PureComponent{constructor(){super(...arguments),this.checkInput=()=>{const{stats:i,allowMultiple:u,defaultStat:d,onChange:p}=this.props,c=r.AS.list(i);if(c.length!==i.length){const y=c.map(P=>P.id),f=(0,t.difference)(i,y);console.warn("Unknown stats",f,i),p(c.map(P=>P.id))}!u&&i.length>1&&(console.warn("Removing extra stat",i),p([i[0]])),d&&i.length<1&&p([d])},this.onSelectionChange=i=>{const{onChange:u}=this.props;Array.isArray(i)?u(i.map(d=>d.value)):u(i&&i.value?[i.value]:[])}}static{this.defaultProps={allowMultiple:!1}}componentDidMount(){this.checkInput()}componentDidUpdate(i){this.checkInput()}render(){const{stats:i,allowMultiple:u,defaultStat:d,placeholder:p,className:c,menuPlacement:y,width:f,inputId:P,filterOptions:a}=this.props,E=r.AS.selectOptions(i,a);return s.createElement(o.l6,{value:E.current,className:c,isClearable:!d,isMulti:u,width:f,isSearchable:!0,options:E.options,placeholder:p,onChange:this.onSelectionChange,menuPlacement:y,inputId:P})}}},15292:(G,I,e)=>{"use strict";e.d(I,{K:()=>d,d:()=>u});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(95344),m=e(40845),l=e(16797),i=e(14578);const u=r.forwardRef(({value:c,checked:y,onChange:f,id:P,label:a,disabled:E,invalid:g=!1,...h},D)=>{y&&(0,o.l)("Switch","checked prop","value");const v=(0,m.of)(p),C=(0,r.useRef)(P||(0,n.uniqueId)("switch-"));return r.createElement("div",{className:(0,t.cx)(v.switch,g&&v.invalid)},r.createElement("input",{type:"checkbox",disabled:E,checked:c,onChange:T=>{!E&&f?.(T)},id:C.current,...h,ref:D}),r.createElement("label",{htmlFor:C.current,"aria-label":a??"Toggle switch"},r.createElement(i.I,{name:"check",size:"xs"})))});u.displayName="Switch";const d=r.forwardRef(({transparent:c,className:y,showLabel:f,label:P,value:a,id:E,invalid:g,...h},D)=>{const v=(0,m.of)(p,c);return r.createElement("div",{className:(0,t.cx)(v.inlineContainer,y,h.disabled&&v.disabled,g&&v.invalid)},f&&r.createElement("label",{htmlFor:E,className:(0,t.cx)(v.inlineLabel,a&&v.inlineLabelEnabled,"inline-switch-label")},P),r.createElement(u,{...h,id:E,label:P,ref:D,value:a}))});d.displayName="Switch";const p=(c,y)=>({switch:(0,t.css)({width:"32px",height:"16px",position:"relative",lineHeight:1,input:{opacity:0,left:"-100vw",zIndex:-1e3,position:"absolute","&:checked + label":{background:c.colors.primary.main,borderColor:c.colors.primary.main,"&:hover":{background:c.colors.primary.shade},svg:{transform:"translate3d(17px, -50%, 0)",background:c.colors.primary.contrastText,color:c.colors.primary.main}},"&:disabled + label":{background:c.colors.action.disabledBackground,borderColor:c.colors.border.weak,cursor:"not-allowed",svg:{background:c.colors.text.disabled}},"&:disabled:checked + label":{background:c.colors.primary.transparent,svg:{color:c.colors.primary.contrastText}},"&:focus + label, &:focus-visible + label":(0,l.getFocusStyles)(c),"&:focus:not(:focus-visible) + label":(0,l.getMouseFocusStyles)(c)},label:{width:"100%",height:"100%",cursor:"pointer",borderRadius:c.shape.radius.pill,background:c.components.input.background,border:`1px solid ${c.components.input.borderColor}`,transition:"all 0.3s ease","&:hover":{borderColor:c.components.input.borderHover},svg:{position:"absolute",display:"block",color:"transparent",width:"12px",height:"12px",borderRadius:c.shape.radius.circle,background:c.colors.text.secondary,boxShadow:c.shadows.z1,top:"50%",transform:"translate3d(1px, -50%, 0)",transition:"transform 0.2s cubic-bezier(0.19, 1, 0.22, 1)","@media (forced-colors: active)":{border:`1px solid ${c.colors.primary.contrastText}`}}}}),inlineContainer:(0,t.css)({padding:c.spacing(0,1),height:c.spacing(c.components.height.md),display:"inline-flex",alignItems:"center",background:y?"transparent":c.components.input.background,border:`1px solid ${y?"transparent":c.components.input.borderColor}`,borderRadius:c.shape.radius.default,"&:hover":{border:`1px solid ${y?"transparent":c.components.input.borderHover}`,".inline-switch-label":{color:c.colors.text.primary}}}),disabled:(0,t.css)({backgroundColor:"rgba(204, 204, 220, 0.04)",color:"rgba(204, 204, 220, 0.6)",border:"1px solid rgba(204, 204, 220, 0.04)"}),inlineLabel:(0,t.css)({cursor:"pointer",paddingRight:c.spacing(1),color:c.colors.text.secondary,whiteSpace:"nowrap"}),inlineLabelEnabled:(0,t.css)({color:c.colors.text.primary}),invalid:(0,t.css)({"input + label, input:checked + label, input:hover + label":{border:`1px solid ${c.colors.error.border}`}})})},60734:(G,I,e)=>{"use strict";e.d(I,{q:()=>u});var t=e(32196),n=e(96540),s=e(29158),r=e(63021),o=e(40675),m=e(40980),l=e(40845),i=e(40276);function u({tabs:p,defaultTab:c,closeIconTooltip:y,onClose:f,testId:P}){const[a,E]=(0,n.useState)(p.some(C=>C.value===c)?c:p[0].value),g=(0,l.of)(d),h=(0,l.$j)(),D=C=>{E(C.value)},v=`calc(100% - (${h.components.menuTabs.height}px + ${h.spacing(1)}))`;return n.createElement("div",{className:g.container,"data-testid":P},n.createElement(r.U,{className:g.tabs},p.map(C=>n.createElement(o.o,{key:C.value,label:C.label,active:C.value===a,onChangeTab:()=>D(C),icon:C.icon})),n.createElement(s.K,{className:g.close,onClick:f,name:"times",tooltip:y??"Close"})),n.createElement(i.E,{autoHeightMin:v,autoHeightMax:v},n.createElement(m.J,{className:g.tabContent},p.find(C=>C.value===a)?.content)))}const d=p=>({container:(0,t.css)({height:"100%"}),tabContent:(0,t.css)({padding:p.spacing(2),backgroundColor:p.colors.background.primary,height:"100%"}),close:(0,t.css)({position:"absolute",right:"16px",top:"5px",cursor:"pointer",fontSize:p.typography.size.lg}),tabs:(0,t.css)({paddingTop:p.spacing(1),borderColor:p.colors.border.weak,ul:{marginLeft:p.spacing(2)}})})},92015:(G,I,e)=>{"use strict";e.d(I,{u:()=>l,d:()=>u});var t=e(96540),n=e(75059),s=e(13544),r=e(32196);const o=d=>{const p=(0,r.css)({width:"100%",listStyle:"none"}),c=(0,r.css)({width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between"});return d.value&&!Array.isArray(d.value)?t.createElement("span",null,d.value):d.value&&Array.isArray(d.value)&&d.value.length>0?t.createElement("ul",{className:p},d.value.map((y,f)=>{const P=Object.keys(y)[0];return t.createElement("li",{className:c,key:f},t.createElement("span",null,P),t.createElement("span",null,y[P]))})):m},m=()=>t.createElement("span",null,"\xA0");function l(d){const{totalColumnsWidth:p,footerGroups:c,isPaginationVisible:y,tableStyles:f}=d,P=s.Tp.components.Panels.Visualization.Table;return t.createElement("div",{style:{position:y?"relative":"absolute",width:p?`${p}px`:"100%",bottom:"0px"}},c.map(a=>{const{key:E,...g}=a.getFooterGroupProps();return t.createElement("div",{className:f.tfoot,...g,key:E,"data-testid":P.footer},a.headers.map(h=>i(h,f)))}))}function i(d,p){const c=d.getHeaderProps();return c?(c.style=c.style??{},c.style.position="absolute",c.style.justifyContent=d.justifyContent,t.createElement("div",{className:p.headerCell,...c},d.render("Footer"))):null}function u(d,p,c){if(p===void 0)return m;if(c){if(p[d]===void 0)return m;const y=n.AS.get(n.gy.count).name;return o({value:[{[y]:String(p[d])}]})}return o({value:p[d]})}},30355:(G,I,e)=>{"use strict";e.d(I,{a:()=>c,t:()=>p});var t=e(96540),n=e(58563),s=e(14236),r=e(11261),o=e(52622),m=e(40845),l=e(29413),i=e(9286),u=e(5926),d=e(57021);const p={type:o.ob.Sparkline,drawStyle:o.GR.Line,lineInterpolation:o.dx.Smooth,lineWidth:1,fillOpacity:17,gradientMode:o.on.Hue,pointSize:2,barAlignment:o.Nj.Center,showPoints:o.yL.Never,hideValue:!1},c=P=>{const{field:a,innerWidth:E,tableStyles:g,cell:h,cellProps:D,timeRange:v}=P,C=y(h.value),T=(0,m.$j)();if(!C)return t.createElement("div",{...D,className:g.cellContainer},a.config.noValue||"no data");C.x&&!C.x.config.interval&&C.x.values.length>1&&(C.x.config.interval=C.x.values[1]-C.x.values[0]),C.y.values=C.y.values.map(R=>Number.isFinite(R)?R:null);const S=(0,n.AP)(C.y);C.y.config.min=S.min,C.y.config.max=S.max,C.y.state={range:S},C.timeRange=v;const O=f(a),x={color:a.config.color,custom:{...p,...O}},b=a.config.custom?.cellOptions?.hideValue;let M=0,A=null;if(!b){const R=(0,s.LI)(h.value)?h.value.value:null,B=a.display(R),U=(0,d.zi)(a,B,h.row.index);M=(0,l.kD)(`${U.prefix??""}${U.text}${U.suffix??""}`,16).width+T.spacing.gridSize,A=t.createElement(i.i,{style:{width:`${M-T.spacing.gridSize}px`,textAlign:"right",marginRight:T.spacing(1)},value:B})}return t.createElement("div",{...D,className:g.cellContainer},A,t.createElement("div",null,t.createElement(u.O,{width:E-M,height:g.cellHeightInner,sparkline:C,config:x,theme:g.theme})))};function y(P){if(Array.isArray(P))return{y:{name:"test",type:r.PU.number,values:P,config:{}}};if((0,s.ci)(P)){const a=P.fields.find(g=>g.type===r.PU.time),E=P.fields.find(g=>g.type===r.PU.number);if(a&&E)return{x:a,y:E}}}function f(P){let a=(0,d.bk)(P);if(a.type===o.ob.Auto&&(a={...a,type:o.ob.Sparkline}),a.type===o.ob.Sparkline)return a;throw new Error(`Expected options type ${o.ob.Sparkline} but got ${a.type}`)}},77093:(G,I,e)=>{"use strict";e.d(I,{X:()=>be});var t=e(96540),n=e(32885),s=e(75059),r=e(11261),o=e(19845),m=e(13544),l=e(52622),i=e(40845),u=e(40276),d=e(19384),p=e(92015),c=e(4025),y=e(14578),f=e(32196),P=e(13840),a=e(91793),E=e(83195),g=e(67061),h=e(67647),D=e(9261),v=e(60029),C=e(10880);const T=28,S=T*5,O={Contains:{label:"Contains",value:"Contains",description:"Contains"},"=":{label:"=",value:"=",description:"Equals"},"!=":{label:"!=",value:"!=",description:"Not equals"},">":{label:">",value:">",description:"Greater"},">=":{label:">=",value:">=",description:"Greater or Equal"},"<":{label:"<",value:"<",description:"Less"},"<=":{label:"<=",value:"<=",description:"Less or Equal"},Expression:{label:"Expression",value:"Expression",description:'Bool Expression (Char $ represents the column value in the expression, e.g. "$ >= 10 && $ <= 12")'}},x=Object.values(O),b=O.Contains,M=O.Expression,A=Oe=>{if(Oe=Oe.trim().replace(/\\/g,""),/^(\d{4}-\d{2}-\d{2}|\d{4}\/\d{2}\/\d{2})/.test(Oe)){const we=new Date(Oe);if(!isNaN(we.getTime())){const Re=(0,E.j_)("dateTimeAsIso");return(0,E.cN)(Re(we.getTime()))}}const Me=parseFloat(Oe);if(!isNaN(Me))return Me;const Ue=Oe.toLowerCase();return Ue==="true"||Ue==="false"?Ue==="true":Oe},R=({options:Oe,values:Me,caseSensitive:Ue,showOperators:we,onChange:Re,searchFilter:Fe,setSearchFilter:xe,operator:Ve,setOperator:$e})=>{const Xe=(0,t.useMemo)(()=>new RegExp(Fe,Ue?void 0:"i"),[Fe,Ue]),gt=(0,t.useMemo)(()=>Oe.filter(We=>{if(!we||!Fe||Ve.value===b.value)return We.label===void 0?!1:Xe.test(We.label);if(Ve.value===M.value){if(We.value===void 0)return!1;try{const Ke=Fe.replace(/\\/g,""),it=new Function("$",`'use strict'; return ${Ke};`),rt=A(We.value);return it(rt)}catch{}return!1}else{if(We.value===void 0)return!1;const Ke=A(We.value),it=A(Fe);switch(Ve.value){case"=":return Ke===it;case"!=":return Ke!==it;case">":return Ke>it;case">=":return Ke>=it;case"<":return Ke<it;case"<=":return Ke<=it}return!1}}),[Oe,Xe,we,Ve,Fe]),Dt=(0,t.useMemo)(()=>gt.filter(We=>Me.includes(We)),[gt,Me]),nt=(0,t.useMemo)(()=>gt.length===Dt.length,[gt,Dt]),at=(0,t.useMemo)(()=>Dt.length>0&&gt.length>Dt.length,[gt,Dt]),Ae=(0,t.useMemo)(()=>Dt.length?`${Dt.length} selected`:"Select all",[Dt]),re=(0,t.useMemo)(()=>gt.length!==Dt.length?"Add all displayed values to the filter":"Remove all displayed values from the filter",[gt,Dt]),Z=(0,i.of)(B),Ee=(0,i.$j)().spacing.gridSize,ye=(0,t.useMemo)(()=>Math.min(gt.length*T,S)+Ee,[Ee,gt.length]),Se=(0,t.useCallback)(We=>Ke=>{const it=Ke.currentTarget.checked?Me.concat(We):Me.filter(rt=>rt.value!==We.value);Re(it)},[Re,Me]),Be=(0,t.useCallback)(()=>{if(gt.length===Dt.length){const We=Me.filter(Ke=>!gt.includes(Ke));Re(We)}else{const We=[...new Set([...Me,...gt])];Re(We)}},[Re,Me,gt,Dt]);return t.createElement(g.B,{direction:"column",gap:.25},!we&&t.createElement(h.Z,{placeholder:"Filter values",onChange:xe,value:Fe}),we&&t.createElement(g.B,{direction:"row",gap:0},t.createElement(D.f,{variant:"canvas",options:x,onChange:$e,value:Ve,tooltip:Ve.description}),t.createElement(h.Z,{placeholder:"Filter values",onChange:xe,value:Fe})),!gt.length&&t.createElement(v.J,null,"No values"),gt.length&&t.createElement(a.Y1,{height:ye,itemCount:gt.length,itemSize:T,width:"100%",className:Z.filterList},({index:We,style:Ke})=>{const it=gt[We],{value:rt,label:ft}=it,pt=Me.find(Ge=>Ge.value===rt)!==void 0;return t.createElement("div",{className:Z.filterListRow,style:Ke,title:ft},t.createElement(C.S,{value:pt,label:ft,onChange:Se(it)}))}),gt.length&&t.createElement(g.B,{direction:"column",gap:.25},t.createElement("div",{className:(0,f.cx)(Z.selectDivider)}),t.createElement("div",{className:(0,f.cx)(Z.filterListRow)},t.createElement(C.S,{value:nt,indeterminate:at,label:Ae,description:re,onChange:Be}))))},B=Oe=>({filterList:(0,f.css)({label:"filterList"}),filterListRow:(0,f.css)({label:"filterListRow",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:Oe.spacing(.5),":hover":{backgroundColor:Oe.colors.action.hover}}),selectDivider:(0,f.css)({label:"selectDivider",width:"100%",borderTop:`1px solid ${Oe.colors.border.medium}`,padding:Oe.spacing(.5,2)})});var U=e(8866),W=e(29158),N=e(55852),w=e(57021);const L=({column:{preFilteredRows:Oe,filterValue:Me,setFilter:Ue},onClose:we,field:Re,searchFilter:Fe,setSearchFilter:xe,operator:Ve,setOperator:$e})=>{const Xe=(0,i.$j)(),gt=(0,t.useMemo)(()=>(0,w.MY)(Oe,Re),[Oe,Re]),Dt=(0,t.useMemo)(()=>(0,w.Yz)(gt),[gt]),nt=(0,t.useMemo)(()=>(0,w.Sj)(Dt,Me),[Dt,Me]),[at,Ae]=(0,t.useState)(nt),[re,Z]=(0,t.useState)(!1),oe=(0,t.useCallback)(We=>we(),[we]),Ee=(0,t.useCallback)(We=>{const Ke=at.length?at:void 0;Ue(Ke),we()},[Ue,at,we]),ye=(0,t.useCallback)(We=>{Ue(void 0),we()},[Ue,we]),Se=(0,t.useMemo)(()=>Me!==void 0,[Me]),Be=(0,i.of)(V);return t.createElement(U.N,{onClick:oe,useCapture:!0},t.createElement("div",{className:(0,f.cx)(Be.filterContainer),onClick:K},t.createElement(g.B,{direction:"column",gap:3},t.createElement(g.B,{direction:"column",gap:.5},t.createElement(g.B,{justifyContent:"space-between",alignItems:"center"},t.createElement(v.J,{className:Be.label},"Filter by values:"),t.createElement(W.K,{name:"text-fields",tooltip:"Match case",style:{color:re?Xe.colors.text.link:Xe.colors.text.disabled},onClick:()=>{Z(We=>!We)}})),t.createElement("div",{className:(0,f.cx)(Be.listDivider)}),t.createElement(R,{onChange:Ae,values:at,options:Dt,caseSensitive:re,showOperators:!0,searchFilter:Fe,setSearchFilter:xe,operator:Ve,setOperator:$e})),t.createElement(g.B,{gap:3},t.createElement(g.B,null,t.createElement(N.$n,{size:"sm",onClick:Ee},"Ok"),t.createElement(N.$n,{size:"sm",variant:"secondary",onClick:oe},"Cancel")),Se&&t.createElement(g.B,null,t.createElement(N.$n,{fill:"text",size:"sm",onClick:ye},"Clear filter"))))))},V=Oe=>({filterContainer:(0,f.css)({label:"filterContainer",width:"100%",minWidth:"250px",height:"100%",maxHeight:"400px",backgroundColor:Oe.colors.background.primary,border:`1px solid ${Oe.colors.border.weak}`,padding:Oe.spacing(2),boxShadow:Oe.shadows.z3,borderRadius:Oe.shape.radius.default}),listDivider:(0,f.css)({label:"listDivider",width:"100%",borderTop:`1px solid ${Oe.colors.border.medium}`,padding:Oe.spacing(.5,2)}),label:(0,f.css)({marginBottom:0})}),K=Oe=>{Oe.stopPropagation()},k=({column:Oe,field:Me,tableStyles:Ue})=>{const we=(0,t.useRef)(null),[Re,Fe]=(0,t.useState)(!1),xe=(0,i.of)(j),Ve=(0,t.useMemo)(()=>!!Oe.filterValue,[Oe.filterValue]),$e=(0,t.useCallback)(()=>Fe(!0),[Fe]),Xe=(0,t.useCallback)(()=>Fe(!1),[Fe]),[gt,Dt]=(0,t.useState)(""),[nt,at]=(0,t.useState)(b);return!Me||!Me.config.custom?.filterable?null:t.createElement("button",{className:(0,f.cx)(Ue.headerFilter,Ve?xe.filterIconEnabled:xe.filterIconDisabled),ref:we,type:"button",onClick:$e},t.createElement(y.I,{name:"filter"}),Re&&we.current&&t.createElement(P.A,{content:t.createElement(L,{column:Oe,tableStyles:Ue,field:Me,onClose:Xe,searchFilter:gt,setSearchFilter:Dt,operator:nt,setOperator:at}),placement:"bottom-start",referenceElement:we.current,show:!0}))},j=Oe=>({filterIconEnabled:(0,f.css)({label:"filterIconEnabled",color:Oe.colors.primary.text}),filterIconDisabled:(0,f.css)({label:"filterIconDisabled",color:Oe.colors.text.disabled})}),H=Oe=>{const{headerGroups:Me,showTypeIcons:Ue,tableStyles:we}=Oe,Re=m.Tp.components.Panels.Visualization.Table;return t.createElement("div",{role:"rowgroup",className:we.headerRow},Me.map(Fe=>{const{key:xe,...Ve}=Fe.getHeaderGroupProps();return t.createElement("div",{className:we.thead,...Ve,key:xe,"aria-label":Re.header,role:"row"},Fe.headers.map(($e,Xe)=>J($e,we,Ue)))}))};function J(Oe,Me,Ue){const we=Oe.getHeaderProps(),Re=Oe.field??null,Fe=Re?.config.custom;Oe.canResize&&(we.style.userSelect=Oe.isResizing?"none":"auto"),we.style.position="absolute",we.style.justifyContent=Oe.justifyContent,we.style.left=Oe.totalLeft;let xe=Oe.render("Header"),Ve=Oe.canSort&&t.createElement(t.Fragment,null,t.createElement("button",{...Oe.getSortByToggleProps(),className:Me.headerCellLabel},Ue&&t.createElement(y.I,{name:(0,c.SS)(Re),title:Re?.type,size:"sm",className:Me.typeIcon}),t.createElement("div",null,xe),Oe.isSorted&&(Oe.isSortedDesc?t.createElement(y.I,{size:"lg",name:"arrow-down",className:Me.sortIcon}):t.createElement(y.I,{name:"arrow-up",size:"lg",className:Me.sortIcon}))),Oe.canFilter&&t.createElement(k,{column:Oe,tableStyles:Me,field:Re}));return Ve&&Fe?.headerComponent?Ve=t.createElement(Fe.headerComponent,{field:Re,defaultContent:Ve}):Fe?.headerComponent&&(xe=t.createElement(Fe.headerComponent,{field:Re,defaultContent:xe})),t.createElement("div",{className:Me.headerCell,...we,role:"columnheader"},Oe.canSort&&Ve,!Oe.canSort&&xe,!Oe.canSort&&Oe.canFilter&&t.createElement(k,{column:Oe,tableStyles:Me,field:Re}),Oe.canResize&&t.createElement("div",{...Oe.getResizerProps(),className:Me.resizeHandle}))}var X=e(64423),se=e(56978),ae=e(69129),ne=e(79041);function q({tableStyles:Oe,nestedData:Me,rowIndex:Ue,width:we,cellHeight:Re}){const Fe=Me.values,xe=[],Ve=(0,i.$j)(),$e=(0,i.of)(ee);let Xe=Oe.rowHeight+Ve.spacing.gridSize;return Fe[Ue].forEach((gt,Dt)=>{const nt=!!gt.meta?.custom?.noHeader,at=Oe.rowHeight*(gt.length+(nt?0:1)),Ae={height:at,paddingLeft:w.jV,position:"absolute",top:Xe};Xe+=at+Ve.spacing.gridSize,xe.push(t.createElement("div",{style:Ae,key:`subTable_${Ue}_${Dt}`},t.createElement(be,{data:gt,width:we-w.jV,height:Oe.rowHeight*(gt.length+1),noHeader:nt,cellHeight:Re})))}),t.createElement("div",{className:$e.subTables},xe)}const ee=Oe=>({subTables:(0,f.css)({"&:before":{content:'""',position:"absolute",width:"1px",top:Oe.spacing(5),left:Oe.spacing(1),bottom:Oe.spacing(2),background:Oe.colors.border.medium}})});function z(Oe,Me,Ue){return Oe.values[Me].reduce((Fe,xe)=>{if(xe.length){const Ve=!!xe.meta?.custom?.noHeader;return Fe+Ue.rowHeight*(xe.length+(Ve?0:1))+8}return Fe},Ue.rowHeight)??Ue.rowHeight}var te=e(49618);const ie=Oe=>{const{data:Me,rows:Ue,headerHeight:we,footerPaginationEnabled:Re,rowHeight:Fe,itemCount:xe,pageIndex:Ve,tableState:$e,prepareRow:Xe,onCellFilterAdded:gt,width:Dt,cellHeight:nt=l.qM.Sm,timeRange:at,tableStyles:Ae,nestedDataField:re,listHeight:Z,listRef:oe,enableSharedCrosshair:Ee=!1,initialRowIndex:ye=void 0,headerGroups:Se,longestField:Be}=Oe,[We,Ke]=(0,t.useState)(ye),it=(0,i.$j)(),rt=(0,ne.d2)();let ft=null;window.OffscreenCanvas!==void 0&&(ft=new OffscreenCanvas(256,1024).getContext("2d")),ft!=null&&(ft.font=`${it.typography.fontSize}px ${it.typography.body.fontFamily}`);const pt=(0,t.useMemo)(()=>{const Nt=Me.fields.find(ht=>ht.type===r.PU.time);return Nt?(0,w.HY)(Nt):0},[Me]),Ge=(0,t.useCallback)((Nt,ht)=>{if(!rt||!Ee||!(0,o.S1)(ht))return;const Rt=ht.fields.find(_t=>_t.type===r.PU.time);rt.eventBus.publish(new ae.b_({point:{time:Rt.values[Nt]}}))},[Ee,rt]),qe=(0,t.useCallback)(()=>{!rt||!Ee||rt.eventBus.publish(new ae.ql)},[Ee,rt]),bt=(0,t.useCallback)(Nt=>{if(Nt.payload.point?.time&&Nt.payload.rowIndex!==void 0){const ht=Me.fields.find(ln=>ln.type===r.PU.time),Rt=ht.values[Nt.payload.rowIndex],_t=Nt.payload.point.time;if((0,w.Iy)(_t,Rt,pt)){Ke(Nt.payload.rowIndex);return}const on=ht.values.findIndex(ln=>(0,w.Iy)(_t,ln,pt));if(on!==-1){Ke(on);return}Ke(void 0)}},[Me.fields,pt]);(0,t.useEffect)(()=>{if(!rt||!Ee||!(0,o.S1)(Me)||Re)return;const Nt=new X.yU;return Nt.add(rt.eventBus.getStream(ae.b_).pipe((0,se.B)(250)).subscribe({next:ht=>{rt.eventBus!==ht.origin&&bt(ht)}})),Nt.add(rt.eventBus.getStream(ae.ql).pipe((0,se.B)(250)).subscribe({next:ht=>{rt.eventBus!==ht.origin&&Ke(void 0)}})),()=>{Nt.unsubscribe()}},[Me,Ee,Re,bt,rt]);let Ft;if(We!==void 0){const Nt=Ue.findIndex(ht=>ht.index===We);Nt!==-1&&(Ft=we+(Nt-1)*Fe)}const Xt=(0,t.useCallback)(Nt=>$e.pageIndex*$e.pageSize+Nt,[$e.pageIndex,$e.pageSize]);let Lt,Qt;for(const Nt of Me.fields){const ht=Nt.config.custom,Rt=ht!==void 0&&ht.cellOptions!==void 0;Rt&&ht.cellOptions.type===l.ob.ColorBackground&&ht.cellOptions.applyToRow&&(Lt=_t=>{const on=Nt.display(Nt.values.get(_t));return(0,w.HW)(Ae,ht.cellOptions,on)}),Rt&&(ht.cellOptions.type===l.ob.Auto||ht.cellOptions.type===l.ob.ColorBackground||ht.cellOptions.type===l.ob.ColorText)&&ht.cellOptions.wrapText?Qt=Nt:Be!==void 0&&(Qt=Be)}const an=(0,t.useCallback)(({index:Nt,style:ht,rowHighlightIndex:Rt})=>{const _t=Xt(Nt),on=Ue[_t];let ln={};Xe(on);const bn=$e.expanded[on.id]?(0,f.css)({"&:hover":{background:"inherit"}}):{};if(Rt!==void 0&&on.index===Rt&&(ht={...ht,backgroundColor:it.components.table.rowHoverBackground},ln={"aria-selected":"true"}),Lt){const{bgColor:In,textColor:Mn}=Lt(on.index);ht.background=In,ht.color=Mn}if(Qt){const In=Me.fields.findIndex(nn=>nn.name===Qt.name),Mn=it.typography.body.lineHeight*it.typography.fontSize,vt=(0,w.M2)(Qt.values[Nt],Se[0].headers[In],ft,Mn,Ae.rowHeight);ht.height=vt.height}return t.createElement("div",{...on.getRowProps({style:ht,...ln}),className:(0,f.cx)(Ae.row,bn),onMouseEnter:()=>Ge(Nt,Me),onMouseLeave:qe},re&&$e.expanded[on.id]&&t.createElement(q,{nestedData:re,tableStyles:Ae,rowIndex:on.index,width:Dt,cellHeight:nt}),on.cells.map((In,Mn)=>t.createElement(te.n,{key:Mn,tableStyles:Ae,cell:In,onCellFilterAdded:gt,columnIndex:Mn,columnCount:on.cells.length,timeRange:at,frame:Me,rowStyled:Lt!==void 0,textWrapped:Qt!==void 0,height:Number(ht.height)})))},[nt,Me,re,gt,Ge,qe,Xe,Xt,Ue,$e.expanded,Ae,Qt,it.components.table.rowHoverBackground,it.typography.fontSize,it.typography.body.lineHeight,at,Dt,Lt,Se,ft]),gn=Nt=>{const ht=Xt(Nt),Rt=Ue[ht];if($e.expanded[Rt.id]&&re)return z(re,Rt.index,Ae);if(Qt){const _t=Me.fields.findIndex(ln=>ln.name===Qt.name),on=it.typography.fontSize*it.typography.body.lineHeight;return(0,w.M2)(Qt.values[Nt],Se[0].headers[_t],ft,on,Ae.rowHeight).height}return Ae.rowHeight},ut=Nt=>{const{scrollTop:ht}=Nt.currentTarget;oe.current!==null&&oe.current.scrollTo(ht)};return t.createElement(t.Fragment,null,t.createElement(u.A,{onScroll:ut,hideHorizontalTrack:!0,scrollTop:Ft},t.createElement(a._m,{key:Fe+Ve,height:Z,itemCount:xe,itemSize:gn,width:"100%",ref:oe,style:{overflow:void 0}},({index:Nt,style:ht})=>an({index:Nt,style:ht,rowHighlightIndex:We}))))};function ce(Oe,Me){(0,t.useEffect)(()=>{if(Oe.current&&Me.current){const Ue=Oe.current.querySelector(".track-vertical"),we=Me.current.firstChild;we&&Ue&&(Ue.remove(),we instanceof HTMLElement&&(we.querySelector(":scope > .track-vertical")?.remove(),we.append(Ue)))}})}function ue(Oe,Me,Ue,we){const Re=JSON.stringify(Object.keys(Oe.expanded));(0,t.useEffect)(()=>{let Fe=0;we||(Number.isFinite(Oe.lastExpandedOrCollapsedIndex)&&(Fe=Oe.lastExpandedOrCollapsedIndex),Fe=Oe.pageIndex===0?Fe-1:Fe-Oe.pageIndex-Oe.pageIndex*Oe.pageSize),Me.current?.resetAfterIndex(Math.max(Fe,0))},[Oe.lastExpandedOrCollapsedIndex,Oe.pageSize,Oe.pageIndex,Me,Ue,Re,we])}var fe=e(28240);function Te({onColumnResize:Oe,onSortByChange:Me,data:Ue}){return(0,t.useCallback)((we,Re)=>{switch(Re.type){case"columnDoneResizing":if(Oe){const xe=we.columnResizing.headerIdWidths[0][0],Ve=parseInt(xe,10),$e=Math.round(we.columnResizing.columnWidths[xe]),Xe=Ue.fields[Ve];if(!Xe)return we;const gt=(0,fe.Ct)(Xe,Ue);Oe(gt,$e)}case"toggleSortBy":if(Me){const Fe=[];for(const xe of we.sortBy){const Ve=Ue.fields[parseInt(xe.id,10)];Ve&&Fe.push({displayName:(0,fe.Ct)(Ve,Ue),desc:xe.desc})}Me(Fe)}case"toggleRowExpanded":if(Re.id)return{...we,lastExpandedOrCollapsedIndex:parseInt(Re.id,10)}}return we},[Ue,Oe,Me])}function he(Oe,Me){const Ue={};if(Oe){Ue.sortBy=[];for(const we of Oe)for(const Re of Me)Re.Header===we.displayName&&Ue.sortBy.push({id:Re.id,desc:we.desc})}return Ue}var de=e(69770);const le=150,pe=36,ve="No data",be=(0,t.memo)(Oe=>{const{ariaLabel:Me,data:Ue,height:we,onCellFilterAdded:Re,width:Fe,columnMinWidth:xe=le,noHeader:Ve,resizable:$e=!0,initialSortBy:Xe,footerOptions:gt,showTypeIcons:Dt,footerValues:nt,enablePagination:at,cellHeight:Ae=l.qM.Sm,timeRange:re,enableSharedCrosshair:Z=!1,initialRowIndex:oe=void 0,fieldConfig:Ee}=Oe,ye=(0,t.useRef)(null),Se=(0,t.useRef)(null),Be=(0,t.useRef)(null),We=(0,i.$j)(),Ke=(0,de.k)(We,Ae),it=Ve?0:Ke.rowHeight,[rt,ft]=(0,t.useState)(nt),pt=Ee?.defaults?.noValue??ve,Ge=(0,t.useMemo)(()=>{const dt=pe;let wt=0;if(!rt)return 0;for(const en of rt)Array.isArray(en)&&en.length>wt&&(wt=en.length);return wt>1?dt*wt:dt},[rt]),qe=(0,t.useMemo)(()=>Ue.fields.length?Array(Ue.length).fill(0):[],[Ue]),bt=!!(gt?.countRows&&gt.reducer&&gt.reducer.length&&gt.reducer[0]===s.gy.count),Ft=Ue.fields.find(dt=>dt.type===r.PU.nestedFrames),Xt=Ft!==void 0,Lt=(0,t.useMemo)(()=>(0,w.GH)(Ue,Fe,xe,Xt,rt,bt),[Ue,Fe,xe,rt,Xt,bt]),Qt=(0,t.useRef)(),an=Te({...Oe,onSortByChange:dt=>{Qt.current(!1),Oe.onSortByChange&&Oe.onSortByChange(dt)}}),gn=!!Ue.meta?.uniqueRowIdFields?.length,ut=(0,t.useMemo)(()=>{const dt={columns:Lt,data:qe,disableResizing:!$e,stateReducer:an,autoResetPage:!1,initialState:he(Xe,Lt),autoResetFilters:!1,sortTypes:{number:w.Ok,"alphanumeric-insensitive":w.IM}};return gn&&(dt.getRowId=(wt,en)=>(0,o.t9)(Ue,en),dt.autoResetExpanded=!1),dt},[Xe,Lt,qe,$e,an,gn,Ue]),{getTableProps:Nt,headerGroups:ht,footerGroups:Rt,rows:_t,prepareRow:on,totalColumnsWidth:ln,page:bn,state:In,gotoPage:Mn,setPageSize:vt,pageOptions:nn,toggleAllRowsExpanded:cn}=(0,n.useTable)(ut,n.useFilters,n.useSortBy,n.useAbsoluteLayout,n.useResizeColumns,n.useExpanded,n.usePagination),mt=In;Qt.current=cn,(0,t.useEffect)(()=>{gt||ft(nt)},[nt,gt]),(0,t.useEffect)(()=>{if(!gt)return;if(!gt.show){ft(void 0);return}if(bt){const wt=[];wt[0]=ht[0]?.headers[0]?.filteredRows.length.toString()??Ue.length.toString(),ft(wt);return}const dt=(0,w.Ux)(ht[0].headers,(0,w.XX)(_t),gt,We);ft(dt)},[gt,We,In.filters,Ue]);let lt=we-(it+Ge);at&&(lt-=Ke.cellHeight);const Tt=Math.round(lt/Ke.rowHeight)-1;(0,t.useEffect)(()=>{Tt<=0||vt(Tt)},[Tt,vt]),(0,t.useEffect)(()=>{Ue.length/Tt<In.pageIndex&&Mn(0)},[Ue]),ue(mt,ye,Ue,gn),ce(Be,Se);const Vt=(0,t.useCallback)(dt=>{Mn(dt-1)},[Mn]),zt=at?bn.length:_t.length;let rn=null;if(at){const dt=In.pageIndex*In.pageSize+1;let wt=dt+In.pageSize-1;const en=Fe<550;wt>Ue.length&&(wt=Ue.length),rn=t.createElement("div",{className:Ke.paginationWrapper},t.createElement(d.d,{currentPage:In.pageIndex+1,numberOfPages:nn.length,showSmallVersion:en,onNavigate:Vt}),en?null:t.createElement("div",{className:Ke.paginationSummary},dt," - ",wt," of ",Ue.length," rows"))}const mn=(0,w.O4)(Ee,Ue);return t.createElement("div",{...Nt(),className:Ke.table,"aria-label":Me,role:"table",ref:Se,style:{width:Fe,height:we}},t.createElement(u.E,{hideVerticalTrack:!0},t.createElement("div",{className:Ke.tableContentWrapper(ln)},!Ve&&t.createElement(H,{headerGroups:ht,showTypeIcons:Dt,tableStyles:Ke}),zt>0?t.createElement("div",{"data-testid":m.Tp.components.Panels.Visualization.Table.body,ref:Be},t.createElement(ie,{headerGroups:ht,data:Ue,rows:_t,width:Fe,cellHeight:Ae,headerHeight:it,rowHeight:Ke.rowHeight,itemCount:zt,pageIndex:In.pageIndex,listHeight:lt,listRef:ye,tableState:In,prepareRow:on,timeRange:re,onCellFilterAdded:Re,nestedDataField:Ft,tableStyles:Ke,footerPaginationEnabled:!!at,enableSharedCrosshair:Z,initialRowIndex:oe,longestField:mn})):t.createElement("div",{style:{height:we-it,width:Fe},className:Ke.noData},pt),rt&&t.createElement(p.u,{isPaginationVisible:!!at,footerValues:rt,footerGroups:Rt,totalColumnsWidth:ln,tableStyles:Ke}))),rn)});be.displayName="Table"},49618:(G,I,e)=>{"use strict";e.d(I,{n:()=>n});var t=e(96540);const n=({cell:s,tableStyles:r,onCellFilterAdded:o,timeRange:m,userProps:l,frame:i,rowStyled:u,textWrapped:d,height:p})=>{const c=s.getCellProps(),y=s.column.field;if(!y?.display)return null;c.style&&(c.style.minWidth=c.style.width,c.style.justifyContent=s.column.justifyContent);let f=(typeof s.column.width=="number"?s.column.width:24)-r.cellPadding*2;return t.createElement(t.Fragment,null,s.render("Cell",{field:y,tableStyles:r,onCellFilterAdded:o,cellProps:c,innerWidth:f,timeRange:m,userProps:l,frame:i,rowStyled:u,textWrapped:d,height:p}))}},69770:(G,I,e)=>{"use strict";e.d(I,{k:()=>n});var t=e(32196);function n(r,o){const m=r.colors.border.weak,l=r.colors.primary.border,i=6,u=s(r,o,i),d=u+2,p=28,c=(y,f,P,a,E,g,h,D)=>(0,t.css)({label:a?"cellContainerOverflow":"cellContainerNoOverflow",padding:`${i}px`,width:"100%",height:`${d-1}px`,wordBreak:h?"break-all":"inherit",display:"flex",...E?{overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}:{},alignItems:"center",borderRight:`1px solid ${m}`,color:D?"inherit":y??void 0,background:D?void 0:f??void 0,backgroundClip:"padding-box","&:last-child:not(:only-child)":{borderRight:"none"},"&:hover":{overflow:a&&!h?"visible":void 0,width:g||!a?"auto":"auto !important",height:(g||a)&&!h?"auto !important":`${d-1}px`,minHeight:`${d-1}px`,wordBreak:g?"break-word":void 0,whiteSpace:g&&a?"normal":"nowrap",boxShadow:a?`0 0 2px ${r.colors.primary.main}`:void 0,background:D?"inherit":P??r.colors.background.primary,zIndex:1,".cellActions":{color:"#FFF",visibility:"visible",opacity:1,width:"auto",background:"rgba(0, 0, 0, 0.6)"}},a:{color:"inherit"},".cellActions":{display:"flex",position:a?void 0:"absolute",top:a?void 0:"1px",right:a?void 0:0,margin:a?r.spacing(0,-.5,0,.5):"auto",visibility:"hidden",opacity:0,width:0,alignItems:"center",height:"100%",padding:r.spacing(1,.5,1,1),background:f?"none":"rgba(0, 0, 0, 0.5)",svg:{color:y}},".cellActionsLeft":{right:"auto !important",left:0},".cellActionsTransparent":{background:"none"}});return{theme:r,cellHeight:u,buildCellContainerStyle:c,cellPadding:i,cellHeightInner:u-i*2,rowHeight:d,table:(0,t.css)({height:"100%",width:"100%",overflow:"auto",display:"flex",flexDirection:"column"}),thead:(0,t.css)({label:"thead",height:`${p}px`,overflowY:"auto",overflowX:"hidden",position:"relative"}),tfoot:(0,t.css)({label:"tfoot",height:`${p}px`,borderTop:`1px solid ${m}`,overflowY:"auto",overflowX:"hidden",position:"relative"}),headerRow:(0,t.css)({label:"row",borderBottom:`1px solid ${m}`}),headerCell:(0,t.css)({height:"100%",padding:`0 ${i}px`,overflow:"hidden",whiteSpace:"nowrap",display:"flex",alignItems:"center",fontWeight:r.typography.fontWeightMedium,"&:last-child":{borderRight:"none"}}),headerCellLabel:(0,t.css)({border:"none",padding:0,background:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:r.typography.fontWeightMedium,display:"flex",alignItems:"center",marginRight:r.spacing(.5),"&:hover":{textDecoration:"underline",color:r.colors.text.link}}),cellContainerText:c(void 0,void 0,void 0,!0,!0),cellContainerTextNoOverflow:c(void 0,void 0,void 0,!1,!0),cellContainer:c(void 0,void 0,void 0,!0,!1),cellContainerNoOverflow:c(void 0,void 0,void 0,!1,!1),cellText:(0,t.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}),sortIcon:(0,t.css)({marginLeft:r.spacing(.5)}),cellLink:(0,t.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",color:r.colors.text.link,fontWeight:r.typography.fontWeightMedium,paddingRight:r.spacing(1.5),"&:hover":{textDecoration:"underline",color:r.colors.text.link}}),cellLinkForColoredCell:(0,t.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",fontWeight:r.typography.fontWeightMedium,textDecoration:"underline"}),imageCellLink:(0,t.css)({cursor:"pointer",overflow:"hidden",height:"100%"}),headerFilter:(0,t.css)({background:"transparent",border:"none",label:"headerFilter",padding:0}),paginationWrapper:(0,t.css)({display:"flex",height:`${u}px`,justifyContent:"center",alignItems:"center",width:"100%",li:{marginBottom:0}}),paginationSummary:(0,t.css)({color:r.colors.text.secondary,fontSize:r.typography.bodySmall.fontSize,display:"flex",justifyContent:"flex-end",padding:r.spacing(0,1,0,2)}),tableContentWrapper:y=>{const f=y!==void 0?`${y}px`:"100%";return(0,t.css)({label:"tableContentWrapper",width:f,display:"flex",flexDirection:"column"})},row:(0,t.css)({label:"row",borderBottom:`1px solid ${m}`,"&:hover":{backgroundColor:r.components.table.rowHoverBackground},"&:last-child":{borderBottom:0}}),imageCell:(0,t.css)({height:"100%"}),resizeHandle:(0,t.css)({label:"resizeHandle",cursor:"col-resize !important",display:"inline-block",background:l,opacity:0,[r.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.2s ease-in-out"},width:"8px",height:"100%",position:"absolute",right:"-4px",borderRadius:r.shape.radius.default,top:0,touchAction:"none","&:hover":{opacity:1}}),typeIcon:(0,t.css)({marginRight:r.spacing(1),color:r.colors.text.secondary}),noData:(0,t.css)({alignItems:"center",display:"flex",height:"100%",justifyContent:"center",width:"100%"}),expanderCell:(0,t.css)({display:"flex",flexDirection:"column",justifyContent:"center",height:`${d}px`,cursor:"pointer"})}}function s(r,o,m){const l=r.typography.fontSize,i=r.typography.body.lineHeight;switch(o){case"md":return 42;case"lg":return 48;case"sm":default:return m*2+l*i}}},88407:(G,I,e)=>{"use strict";e.d(I,{Zi:()=>n,mc:()=>t});const t="=",n="!="},57021:(G,I,e)=>{"use strict";e.d(I,{jV:()=>ee,HY:()=>$e,MY:()=>ue,XX:()=>Me,zi:()=>xe,HW:()=>Xe,bk:()=>we,GH:()=>te,Sj:()=>de,Ux:()=>be,j1:()=>z,O4:()=>Dt,M2:()=>gt,Iy:()=>Ve,o7:()=>Re,IM:()=>le,Ok:()=>pe,Yz:()=>Te});var t=e(2543),n=e(47078),s=e.n(n),r=e(84140),o=e(11261),m=e(28240),l=e(14236),i=e(19845),u=e(83195),d=e(75059),p=e(57875),c=e(52622),y=e(24284),f=e(96540),P=e(50082),a=e(58563),E=e(47070),g=e(97696),h=e(59796);const D={mode:P.O.Absolute,steps:[{color:"blue",value:-1/0},{color:"green",value:20}]},v=nt=>{const{field:at,innerWidth:Ae,tableStyles:re,cell:Z,cellProps:oe,row:Ee}=nt,ye=at.display(Z.value),Se=we(at);let Be=(0,a.xg)(at,!1);Be.thresholds||(Be={...Be,thresholds:D});let We=c.eX.Gradient,Ke;Se.type===c.ob.Gauge&&(We=Se.mode??c.eX.Gradient,Ke=Se.valueDisplayMode!==void 0?Se.valueDisplayMode:c.$l.Text);const it=()=>(0,t.isFunction)(at.getLinks)?at.getLinks({valueRowIndex:Ee.index}):[],rt=!!it().length,ft=xe(at,ye,Z.row.index),pt=Ge=>{const{openMenu:qe,targetClassName:bt}=Ge;return f.createElement(g.xE,{width:Ae,height:re.cellHeightInner,field:Be,display:at.display,text:{valueSize:14},value:ye,orientation:E.wV.Horizontal,theme:re.theme,alignmentFactors:ft,onClick:qe,className:bt,itemSpacing:1,lcdCellWidth:8,displayMode:We,valueDisplayMode:Ke})};return f.createElement("div",{...oe,className:re.cellContainer},rt&&f.createElement(h.e,{links:it,style:{display:"flex",width:"100%"}},Ge=>pt(Ge)),!rt&&pt({}))};var C=e(90914);const T=nt=>{const{field:at,row:Ae,cellProps:re,tableStyles:Z}=nt,oe=(0,C.k)(at,Ae);return f.createElement("div",{...re,className:Z.cellContainerText},oe&&oe.map((Ee,ye)=>f.createElement("span",{key:ye,className:Z.cellLink,onClick:Ee.onClick},f.createElement("a",{href:Ee.href,target:Ee.target},Ee.title))))};var S=e(32196),O=e(40845),x=e(55852),b=e(29158),M=e(67061),A=e(10534),R=e(87978),B=e(32372);function U({value:nt,onDismiss:at,mode:Ae}){let re=nt;if((0,t.isString)(nt)){const oe=nt.trim();if(oe[0]==="{"||oe[0]==="["||Ae==="code")try{nt=JSON.parse(nt),Ae="code"}catch{Ae="text"}else Ae="text"}else re=JSON.stringify(nt,null," ");let Z=re;return Ae==="code"&&(Z=JSON.stringify(nt,null," ")),f.createElement(R._,{onClose:at,title:"Inspect value"},Ae==="code"?f.createElement(B.B,{width:"100%",height:500,language:"json",showLineNumbers:!0,showMiniMap:(Z&&Z.length)>100,value:Z,readOnly:!0}):f.createElement("pre",null,Z),f.createElement(A.b,{icon:"copy",getText:()=>Z},"Copy to Clipboard"))}var W=e(88407);function N({field:nt,cell:at,previewMode:Ae,showFilters:re,onCellFilterAdded:Z}){const[oe,Ee]=(0,f.useState)(!1),ye=z(nt)==="flex-end",Se=!!nt.config.custom?.inspect,Be={size:"sm",tooltipPlacement:"top"},We=(0,f.useCallback)(it=>{Z&&Z({key:nt.name,operator:W.mc,value:at.value})},[at,nt,Z]),Ke=(0,f.useCallback)(it=>{Z&&Z({key:nt.name,operator:W.Zi,value:at.value})},[at,nt,Z]);return f.createElement(f.Fragment,null,f.createElement("div",{className:`cellActions${ye?" cellActionsLeft":""}`},f.createElement(M.B,{gap:.5},Se&&f.createElement(b.K,{name:"eye",tooltip:"Inspect value",onClick:()=>{Ee(!0)},...Be}),re&&f.createElement(b.K,{name:"search-plus",onClick:We,tooltip:"Filter for value",...Be}),re&&f.createElement(b.K,{name:"search-minus",onClick:Ke,tooltip:"Filter out value",...Be}))),oe&&f.createElement(U,{mode:Ae,value:at.value,onDismiss:()=>{Ee(!1)}}))}const w=nt=>{const{field:at,cell:Ae,tableStyles:re,row:Z,cellProps:oe,frame:Ee,rowStyled:ye,textWrapped:Se,height:Be}=nt,We=!!at.config.custom?.inspect,Ke=at.display(Ae.value),it=nt.onCellFilterAdded&&at.config.filterable,rt=it&&Ae.value!==void 0||We,ft=we(at),pt=!!(0,C.k)(at,Z)?.length,Ge=(0,O.of)(x.Ez),[qe,bt]=(0,f.useState)(!1);let Ft;const Xt=140,Lt=()=>{bt(!1)},Qt=()=>{bt(!0)};if(ft.type===c.ob.Custom){const Nt=ft.cellComponent;Ft=f.createElement(Nt,{field:at,value:Ae.value,rowIndex:Z.index,frame:Ee})}else f.isValidElement(Ae.value)?Ft=Ae.value:Ft=(0,u.cN)(Ke);const an=typeof Ft=="string",gn=Ke.text.length<=Xt&&/\s/.test(Ke.text),ut=L(re,ft,Ke,We,an,gn,Se,ye);if(an){let Nt=oe.style?.justifyContent;Nt==="flex-end"?oe.style={...oe.style,textAlign:"right"}:Nt==="center"&&(oe.style={...oe.style,textAlign:"center"})}return Be&&(oe.style={...oe.style,height:Be}),Se&&(oe.style={...oe.style,textWrap:"wrap"}),f.createElement("div",{...oe,onMouseEnter:rt?Qt:void 0,onMouseLeave:rt?Lt:void 0,className:ut},!pt&&(an?`${Ft}`:f.createElement("div",{className:re.cellText},Ft)),pt&&f.createElement(h.e,{links:()=>(0,C.k)(at,Z)||[]},Nt=>Nt.openMenu?f.createElement("button",{className:(0,S.cx)(Ge,V(re,ft,Nt.targetClassName)),onClick:Nt.openMenu},Ft):f.createElement("div",{className:V(re,ft,Nt.targetClassName)},Ft)),qe&&rt&&f.createElement(N,{...nt,previewMode:"text",showFilters:it}))};function L(nt,at,Ae,re=!1,Z=!1,oe=!1,Ee=!1,ye=!1){let Se,Be,We;const Ke=Xe(nt,at,Ae);return Se=Ke.textColor,Be=Ke.bgColor,We=Ke.bgHoverColor,nt.buildCellContainerStyle(Se,Be,We,!re,Z,oe,Ee,ye)}function V(nt,at,Ae){return at.type===c.ob.Auto?(0,S.cx)(nt.cellLink,Ae):(0,S.cx)(nt.cellLinkForColoredCell,Ae)}var K=e(92015),k=e(64136),j=e(27430);function H(nt){const{cell:at,tableStyles:Ae,cellProps:re}=nt;let Z="";return at.value instanceof j.A?Z=new k.A().writeGeometry(at.value,{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326"}):at.value!=null&&(Z=`${at.value}`),f.createElement("div",{...re,className:Ae.cellContainer},f.createElement("div",{className:Ae.cellText,style:{fontFamily:"monospace"}},Z))}const J=10,X=nt=>{const{field:at,cell:Ae,tableStyles:re,row:Z,cellProps:oe}=nt,Ee=at.display(Ae.value),ye=!!(0,C.k)(at,Z)?.length;return f.createElement("div",{...oe,className:re.cellContainer},!ye&&f.createElement("img",{src:Ee.text,className:re.imageCell,alt:""}),ye&&f.createElement(h.e,{style:{height:re.cellHeight-J,width:"auto"},links:()=>(0,C.k)(at,Z)||[]},Se=>{const Be=f.createElement("img",{style:{height:re.cellHeight-J,width:"auto"},src:Ee.text,className:re.imageCell,alt:""});return Se.openMenu?f.createElement("div",{onClick:Se.openMenu,role:"button",tabIndex:0,onKeyDown:We=>{We.key==="Enter"&&Se.openMenu&&Se.openMenu(We)}},Be):Be}))};function se(nt){const{cell:at,tableStyles:Ae,cellProps:re,field:Z,row:oe}=nt,Ee=!!Z.config.custom?.inspect,ye=(0,S.css)({cursor:"pointer",fontFamily:"monospace"});let Se=at.value,Be=Se;if((0,t.isString)(Se))try{Se=JSON.parse(Se)}catch{}else Be=JSON.stringify(Se,null," ");const We=!!(0,C.k)(Z,oe)?.length,Ke=(0,O.of)(x.Ez);return f.createElement("div",{...re,className:Ee?Ae.cellContainerNoOverflow:Ae.cellContainer},f.createElement("div",{className:(0,S.cx)(Ae.cellText,ye)},!We&&f.createElement("div",{className:Ae.cellText},Be),We&&f.createElement(h.e,{links:()=>(0,C.k)(Z,oe)||[]},it=>it.openMenu?f.createElement(x.$n,{className:(0,S.cx)(Ke),onClick:it.openMenu},Be):f.createElement(f.Fragment,null,Be))),Ee&&f.createElement(N,{...nt,previewMode:"code"}))}var ae=e(14578);function ne({row:nt,tableStyles:at}){return f.createElement("div",{className:at.expanderCell,...nt.getToggleRowExpandedProps()},f.createElement(ae.I,{"aria-label":nt.isExpanded?"Collapse row":"Expand row",name:nt.isExpanded?"angle-down":"angle-right",size:"lg"}))}var q=e(30355);const ee=50;function z(nt){if(!nt)return"flex-start";if(nt.config.custom)switch(nt.config.custom.align){case"right":return"flex-end";case"left":return"flex-start";case"center":return"center"}return nt.type===o.PU.number?"flex-end":"flex-start"}function te(nt,at,Ae,re,Z,oe){const Ee=[];let ye=0;re&&(Ee.push({Header:()=>null,id:"expander",Cell:ne,width:ee,minWidth:ee,filter:(Be,We,Ke)=>[],justifyContent:"left",field:nt.fields[0],sortType:"basic"}),at-=ee);for(const[Be,We]of nt.fields.entries()){const Ke=We.config.custom||{};if(Ke.hidden||We.type===o.PU.nestedFrames)continue;Ke.width?at-=Ke.width:ye++;const it=ft=>{switch(ft){case o.PU.number:case o.PU.frame:return"number";case o.PU.time:return"basic";default:return"alphanumeric-insensitive"}},rt=ie(Ke.cellOptions?.type,We);Ee.push({Cell:rt,id:Be.toString(),field:We,Header:Ke.hideHeader?"":(0,m.Ct)(We,nt),accessor:(ft,pt)=>We.values[pt],sortType:it(We.type),width:Ke.width,minWidth:Ke.minWidth??Ae,filter:s()(ce(We)),justifyContent:z(We),Footer:(0,K.d)(Be,Z,oe)})}let Se=at/ye;for(let Be=ye;Be>0;Be--)for(const We of Ee)!We.width&&We.minWidth>Se&&(We.width=We.minWidth,at-=We.width,ye-=1,Se=at/ye);for(const Be of Ee)Be.width||(Be.width=Se),Be.minWidth=50;return Ee}function ie(nt,at){switch(nt){case c.ob.Custom:case c.ob.ColorText:case c.ob.ColorBackground:return w;case c.ob.Image:return X;case c.ob.Gauge:return v;case c.ob.Sparkline:return q.a;case c.ob.JSONView:return se;case c.ob.DataLinks:return T}if(at.type===o.PU.geo)return H;if(at.type===o.PU.frame){const Ae=at.values[0];return(0,l.ci)(Ae)&&(0,i.aH)(Ae)?q.a:se}return at.type===o.PU.other?se:w}function ce(nt){return function(at,Ae,re){return at.length===0||!re||!nt?at:at.filter(Z=>{if(!Z.values.hasOwnProperty(Ae))return!1;const oe=fe(Z,nt);return re.find(Ee=>Ee.value===oe)!==void 0})}}function ue(nt,at){if(!at||nt.length===0)return{};const Ae={};for(let re=0;re<nt.length;re++){const Z=fe(nt[re],at);Ae[Z||"(Blanks)"]=Z}return Ae}function fe(nt,at){if(!at||!nt)return"";const Ae=at.values[nt.index],re=at.display?at.display(Ae):Ae;return at.display?(0,u.cN)(re):re}function Te(nt){return Object.keys(nt).reduce((at,Ae)=>at.concat({value:nt[Ae],label:Ae}),[]).sort(he)}function he(nt,at){return nt.label===void 0&&at.label===void 0?0:nt.label===void 0&&at.label!==void 0?-1:nt.label!==void 0&&at.label===void 0?1:nt.label<at.label?-1:nt.label>at.label?1:0}function de(nt,at){return at?nt.filter(Ae=>at.some(re=>re.value===Ae.value)):[]}function le(nt,at,Ae){return String(nt.values[Ae]).localeCompare(String(at.values[Ae]),void 0,{sensitivity:"base"})}function pe(nt,at,Ae){const re=ve(nt.values[Ae]),Z=ve(at.values[Ae]);return re===Z?0:re>Z?1:-1}function ve(nt){return(0,l.LI)(nt)?nt.value??Number.NEGATIVE_INFINITY:nt==null||nt===""||isNaN(nt)?Number.NEGATIVE_INFINITY:typeof nt=="number"?nt:Number(nt)}function be(nt,at,Ae,re){return Fe(nt),nt.map((Z,oe)=>{if(Z?.field?.type!==o.PU.number)return oe===0&&Ae.reducer&&Ae.reducer.length>0?d.AS.get(Ae.reducer[0]).name:void 0;let Ee=(0,t.clone)(Z.field);return Ee.values=at[Z.id],Ee.state=void 0,Z.field=Ee,Ae.fields&&Ae.fields.length>0?Ae.fields.find(Se=>Se===Z?.field?.name)?Oe(Z.field,Ae.reducer,re):void 0:Oe(Z.field,Ae.reducer||[],re)})}function Oe(nt,at,Ae){const re=at[0];if(re===void 0)return"";const Z=nt.display??(0,p.J)({field:nt,theme:Ae}),oe=(0,d.Nw)({field:nt,reducers:at})[re];return d.AS.get(re).preservesUnits?(0,u.cN)(Z(oe)):(0,u.cN)({text:oe})}function Me(nt){const at=[];for(const Ae in nt)for(const[re,Z]of Object.entries(nt[Ae].values))at[re]===void 0&&(at[re]=[]),at[re].push(Z);return at}const Ue={type:c.ob.Auto};function we(nt){return nt.config.custom?.displayMode?Re(nt.config.custom?.displayMode):nt.config.custom?.cellOptions?nt.config.custom.cellOptions:Ue}function Re(nt){switch(nt){case"basic":case"gradient-gauge":case"lcd-gauge":let at=c.eX.Basic;return nt==="gradient-gauge"?at=c.eX.Gradient:nt==="lcd-gauge"&&(at=c.eX.Lcd),{type:c.ob.Gauge,mode:at};case"color-background":case"color-background-solid":let Ae=c.Wq.Basic;return nt==="color-background"&&(Ae=c.Wq.Gradient),{type:c.ob.ColorBackground,mode:Ae};default:return{type:nt}}}function Fe(nt){const at=nt.findIndex((Ae,re)=>Ae?.id!==String(re));at===-1||nt[at]?.id==="expander"||(nt.splice(at,0,{id:String(at)}),Fe(nt))}function xe(nt,at,Ae){let re=nt.state?.alignmentFactors;if(re)return re.text.length<at.text.length&&(re.text=at.text),re;{re={...at};const Z=Math.min(nt.values.length,Ae+1e3);for(let oe=Ae+1;oe<Z;oe++)nt.display(nt.values[oe]).text.length>re.text.length&&(re.text=at.text);return nt.state?nt.state.alignmentFactors=re:nt.state={alignmentFactors:re},re}}function Ve(nt,at,Ae){return Math.abs(Math.floor(nt)-at)<Ae}function $e(nt){let at=-Number.MAX_VALUE,Ae=Number.MAX_VALUE;if(nt.values.length<2)return 0;for(let re=0;re<nt.values.length;re++){const Z=nt.values[re];Z>at&&(at=Z),Z<Ae&&(Ae=Z)}return(at-Ae)/nt.values.length}function Xe(nt,at,Ae){const re=nt.theme.isDark?1:-.7;let Z,oe,Ee;if(at.type===c.ob.ColorText)Z=Ae.color;else if(at.type===c.ob.ColorBackground){const ye=at.mode??c.Wq.Gradient;if(ye===c.Wq.Basic)Z=(0,y.mZ)(Ae.color,nt.theme.isDark),oe=(0,r.A)(Ae.color).toRgbString(),Ee=(0,r.A)(Ae.color).setAlpha(1).toRgbString();else if(ye===c.Wq.Gradient){const Se=(0,r.A)(Ae.color).setAlpha(1).toRgbString(),Be=(0,r.A)(Ae.color).darken(10*re).spin(5);Z=(0,y.mZ)(Ae.color,nt.theme.isDark),oe=`linear-gradient(120deg, ${Be.toRgbString()}, ${Ae.color})`,Ee=`linear-gradient(120deg, ${Be.setAlpha(1).toRgbString()}, ${Se})`}}return{textColor:Z,bgColor:oe,bgHoverColor:Ee}}function gt(nt,at,Ae,re,Z){const oe=Number(at.width??300),Ee=1.17,ye=42;if(Ae!==null&&typeof nt=="string"){const Se=nt.split(/\s/),Be=[];let We="",Ke=0,it=0;for(let pt=0;pt<Se.length;pt++){const Ge=Se[pt];let qe=Ae.measureText(We+" "+Ge).width;qe<oe?(We+=" "+Ge,Ke++):(Be.push({width:qe,line:We}),We=Ge,Ke=0)}for(let pt=0;pt<Be.length;pt++)if(Be[pt].width>oe){let Ge=Math.floor(Be[pt].width/oe)-1;it+=Ge}let rt=Be.length+it,ft=38;return rt>5?ft=rt*re*Ee:ft=rt*re+ye,{width:oe,height:ft}}return{width:oe,height:Z}}function Dt(nt,at){let Ae;if(nt!==void 0&&nt.defaults.custom!==void 0&&nt.defaults.custom.cellOptions.wrapText){const Z=at.fields.filter(oe=>oe.type===o.PU.string);if(Z.length>=1&&Z[0].values.length>0){const oe=Z[0].values.length;let Ee=0;if(oe<=30)for(const ye of Z){const Se=ye.values[0].length;Se>Ee&&(Ee=Se,Ae=ye)}else for(const ye of Z){const Se=(0,t.sampleSize)(ye.values,3),Be=(Se[0]?.length+Se[1]?.length+Se[2]?.length)/3;Be>Ee&&(Ee=Be,Ae=ye)}}}return Ae}},14746:(G,I,e)=>{"use strict";e.d(I,{b:()=>p});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(72436),m=e(40845),l=e(3911),i=e(14578),u=e(21744);class d extends r.PureComponent{constructor(f){super(f),this.readCSV=(0,n.debounce)(()=>{const{config:E}=this.props,{text:g}=this.state;this.setState({data:(0,o.Jh)(g,{config:E})})},150),this.onTextChange=E=>{this.setState({text:E.target.value})};const{text:P,config:a}=f;this.state={text:P,data:(0,o.Jh)(P,{config:a})}}componentDidUpdate(f,P){const{text:a}=this.state;(a!==P.text||this.props.config!==f.config)&&this.readCSV(),this.props.text!==f.text&&this.props.text!==a&&this.setState({text:this.props.text}),this.state.data!==P.data&&this.props.onSeriesParsed(this.state.data,this.state.text)}render(){const{width:f,height:P,theme:a}=this.props,{data:E}=this.state,g=c(a);return r.createElement("div",{className:g.tableInputCsv},r.createElement(u.f,{style:{width:f,height:P},placeholder:"Enter CSV here...",value:this.state.text,onChange:this.onTextChange,className:g.textarea}),E&&r.createElement("footer",{className:g.footer},E.map((h,D)=>r.createElement("span",{key:D},"Rows:",h.length,", Columns:",h.fields.length," \xA0",r.createElement(i.I,{name:"check-circle"})))))}}const p=(0,m.cV)(d);p.displayName="TableInputCSV";const c=(0,l.N)(y=>({tableInputCsv:(0,t.css)({position:"relative"}),textarea:(0,t.css)({height:"100%",width:"100%"}),footer:(0,t.css)({position:"absolute",bottom:"15px",right:"15px",border:"1px solid #222",background:y.colors.success.main,padding:`1px ${y.spacing(.5)}`,fontSize:"80%"})}))},53402:(G,I,e)=>{"use strict";e.d(I,{p:()=>o});var t=e(32196),n=e(96540),s=e(83195),r=e(40845);const o=({value:l})=>{const i=(0,r.of)(m);return n.createElement("span",{className:i.counter},(0,s.Hg)(l,0).text)},m=l=>({counter:(0,t.css)({label:"counter",marginLeft:l.spacing(1),borderRadius:l.spacing(3),backgroundColor:l.colors.action.hover,padding:l.spacing(.25,1),color:l.colors.text.secondary,fontWeight:l.typography.fontWeightMedium,fontSize:l.typography.size.sm})})},40675:(G,I,e)=>{"use strict";e.d(I,{o:()=>u});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(16797),m=e(55852),l=e(14578),i=e(53402);const u=n.forwardRef(({label:p,active:c,icon:y,onChangeTab:f,counter:P,suffix:a,className:E,href:g,...h},D)=>{const v=(0,r.of)(d),C=(0,r.of)(m.my),T=()=>n.createElement(n.Fragment,null,y&&n.createElement(l.I,{name:y}),p,typeof P=="number"&&n.createElement(i.p,{value:P}),a&&n.createElement(a,{className:v.suffix})),O={className:(0,t.cx)(C,v.link,c?v.activeStyle:v.notActive),...h,onClick:f,"aria-label":h["aria-label"]||s.Tp.components.Tab.title(p),role:"tab","aria-selected":c};return g?n.createElement("div",{className:v.item},n.createElement("a",{...O,href:g,ref:D},T())):n.createElement("div",{className:v.item},n.createElement("button",{...O,type:"button",ref:D},T()))});u.displayName="Tab";const d=p=>({item:(0,t.css)({listStyle:"none",position:"relative",display:"flex",whiteSpace:"nowrap",padding:p.spacing(.5)}),link:(0,t.css)({color:p.colors.text.secondary,padding:p.spacing(1,1.5,.5),borderRadius:p.shape.radius.default,display:"block",height:"100%",svg:{marginRight:p.spacing(1)},"&:focus-visible":(0,o.getFocusStyles)(p),"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"4px",borderRadius:p.shape.radius.default,bottom:0}}),notActive:(0,t.css)({"a:hover, &:hover, &:focus":{color:p.colors.text.primary,"&::before":{backgroundColor:p.colors.action.hover}}}),activeStyle:(0,t.css)({label:"activeTabStyle",color:p.colors.text.primary,overflow:"hidden","&::before":{backgroundImage:p.colors.gradients.brandHorizontal}}),suffix:(0,t.css)({marginLeft:p.spacing(1)})})},40980:(G,I,e)=>{"use strict";e.d(I,{J:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({children:m,className:l,...i})=>{const u=(0,s.of)(o);return n.createElement("div",{...i,className:(0,t.cx)(u.tabContent,l)},m)},o=m=>({tabContent:(0,t.css)({background:m.colors.background.primary})})},63021:(G,I,e)=>{"use strict";e.d(I,{U:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=n.forwardRef(({children:m,className:l,hideBorder:i=!1},u)=>{const d=(0,s.of)(o);return n.createElement("div",{className:(0,t.cx)(d.tabsWrapper,i&&d.noBorder,l),ref:u},n.createElement("div",{className:d.tabs,role:"tablist"},m))}),o=m=>({tabsWrapper:(0,t.css)({borderBottom:`1px solid ${m.colors.border.weak}`,overflowX:"auto"}),noBorder:(0,t.css)({borderBottom:0}),tabs:(0,t.css)({position:"relative",display:"flex",height:`${m.components.menuTabs.height}px`,alignItems:"center"})});r.displayName="TabsBar"},90685:(G,I,e)=>{"use strict";e.d(I,{s:()=>l});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(14578),m=e(53402);const l=n.forwardRef(({label:u,active:d,icon:p,counter:c,className:y,suffix:f,onChangeTab:P,href:a,...E},g)=>{const h=(0,r.of)(i),D=()=>n.createElement(n.Fragment,null,p&&n.createElement(o.I,{name:p}),u,typeof c=="number"&&n.createElement(m.p,{value:c}),f&&n.createElement(f,{className:h.suffix})),v=(0,t.cx)(h.link,d&&h.activeStyle);return n.createElement("a",{href:a,className:v,...E,onClick:P,"aria-label":E["aria-label"]||s.Tp.components.Tab.title(u),role:"tab","aria-selected":d,ref:g},D())});l.displayName="Tab";const i=u=>({link:(0,t.css)({padding:"6px 12px",display:"block",height:"100%",cursor:"pointer",position:"relative",color:u.colors.text.primary,svg:{marginRight:u.spacing(1)},"&:hover, &:focus":{textDecoration:"underline"}}),activeStyle:(0,t.css)({label:"activeTabStyle",color:u.colors.text.maxContrast,overflow:"hidden","&::before":{display:"block",content:'" "',position:"absolute",left:0,width:"4px",bottom:"2px",top:"2px",borderRadius:u.shape.radius.default,backgroundImage:"linear-gradient(0deg, #f05a28 30%, #fbca0a 99%)"}}),suffix:(0,t.css)({marginLeft:u.spacing(1)})})},78369:(G,I,e)=>{"use strict";e.d(I,{v:()=>d});var t=e(32196),n=e(96540),s=e(70255),r=e(40845),o=e(69613),m=e(72129),l=e(14578);const i=(0,n.forwardRef)(({name:y,onClick:f,icon:P,className:a,colorIndex:E,...g},h)=>{const D=(0,r.$j)(),v=c(D,y,E),C=S=>{S.preventDefault(),S.stopPropagation(),f?.(y,S)},T=(0,t.cx)(v.wrapper,a,{[v.hover]:f!==void 0});return f?n.createElement("button",{...g,className:T,onClick:C,ref:h},P&&n.createElement(l.I,{name:P}),y):n.createElement("span",{...g,className:T,ref:h},P&&n.createElement(l.I,{name:P}),y)});i.displayName="Tag";const u=({rootProps:y})=>{const f=(0,r.of)(p);return n.createElement(s.A,{width:60,height:22,containerClassName:f.container,...y})},d=(0,m.j)(i,u),p=()=>({container:(0,t.css)({lineHeight:1})}),c=(y,f,P)=>{let a;return P===void 0?a=(0,o.MC)(f):a=(0,o.yC)(P),{wrapper:(0,t.css)({appearance:"none",borderStyle:"none",fontWeight:y.typography.fontWeightMedium,fontSize:y.typography.size.sm,lineHeight:y.typography.bodySmall.lineHeight,verticalAlign:"baseline",backgroundColor:a.color,color:y.v1.palette.gray98,whiteSpace:"nowrap",textShadow:"none",padding:"3px 6px",borderRadius:y.shape.radius.default}),hover:(0,t.css)({"&:hover":{opacity:.85,cursor:"pointer"}})}}},64149:(G,I,e)=>{"use strict";e.d(I,{L:()=>i});var t=e(32196),n=e(96540),s=e(40845),r=e(72129),o=e(78369);const m=(0,n.memo)((0,n.forwardRef)(({displayMax:p,tags:c,icon:y,onClick:f,className:P,getAriaLabel:a,getColorIndex:E},g)=>{const h=(0,s.$j)(),D=d(h,!!(p&&p>0)),v=c.length,C=p?c.slice(0,p):c;return n.createElement("ul",{className:(0,t.cx)(D.wrapper,P),"aria-label":"Tags",ref:g},C.map((T,S)=>n.createElement("li",{className:D.li,key:T},n.createElement(o.v,{name:T,icon:y,onClick:f,"aria-label":a?.(T,S),"data-tag-id":S,colorIndex:E?.(T,S)}))),p&&p>0&&v-p>0&&n.createElement("span",{className:D.moreTagsLabel},"+ ",v-p))}));m.displayName="TagList";const l=({rootProps:p})=>{const c=(0,s.of)(u);return n.createElement("div",{className:c.container,...p},n.createElement(o.v.Skeleton,null),n.createElement(o.v.Skeleton,null))},i=(0,r.j)(m,l),u=p=>({container:(0,t.css)({display:"flex",gap:p.spacing(1)})}),d=(p,c)=>({wrapper:(0,t.css)({position:"relative",alignItems:c?"center":"unset",display:"flex",flex:"1 1 auto",flexWrap:"wrap",flexShrink:c?0:1,justifyContent:"flex-end",gap:"6px"}),moreTagsLabel:(0,t.css)({color:p.colors.text.secondary,fontSize:p.typography.size.sm}),li:(0,t.css)({listStyle:"none"})})},79924:(G,I,e)=>{"use strict";e.d(I,{u:()=>d});var t=e(32196),n=e(96540),s=e(40845),r=e(55852),o=e(10354),m=e(69613),l=e(29158);const i=({name:c,disabled:y,onRemove:f})=>{const{color:P,borderColor:a}=(0,n.useMemo)(()=>(0,m.MC)(c),[c]),E=(0,s.of)(u);return n.createElement("li",{className:E.itemStyle,style:{backgroundColor:P,borderColor:a}},n.createElement("span",{className:E.nameStyle},c),n.createElement(l.K,{name:"times",size:"lg",disabled:y,tooltip:`Remove "${c}" tag`,onClick:()=>f(c),className:E.buttonStyles}))},u=c=>{const y=c.spacing.gridSize*3;return{itemStyle:(0,t.css)({display:"flex",gap:"3px",alignItems:"center",height:`${y}px`,lineHeight:`${y-2}px`,color:"#fff",borderWidth:"1px",borderStyle:"solid",borderRadius:c.shape.radius.default,padding:`0 ${c.spacing(.5)}`,whiteSpace:"nowrap",textShadow:"none",fontWeight:500,fontSize:c.typography.size.sm}),nameStyle:(0,t.css)({maxWidth:"25ch",textOverflow:"ellipsis",overflow:"hidden"}),buttonStyles:(0,t.css)({margin:0,"&:hover::before":{display:"none"}})}},d=({placeholder:c="New tag (enter key to add)",tags:y=[],onChange:f,width:P,className:a,disabled:E,addOnBlur:g,invalid:h,id:D})=>{const[v,C]=(0,n.useState)(""),T=(0,s.of)(p),S=(0,s.$j)(),O=(0,n.useCallback)(R=>{C(R.target.value)},[]),x=R=>{f(y.filter(B=>B!==R))},b=R=>{R?.preventDefault(),y.includes(v)||f(y.concat(v)),C("")},M=()=>{g&&v&&b()},A=R=>{R.key==="Enter"&&v!==""&&b(R)};return n.createElement("div",{className:(0,t.cx)(T.wrapper,a,P?(0,t.css)({width:S.spacing(P)}):"")},n.createElement(o.p,{id:D,disabled:E,placeholder:c,onChange:O,value:v,onKeyDown:A,onBlur:M,invalid:h,suffix:n.createElement(r.$n,{fill:"text",className:T.addButtonStyle,onClick:b,size:"md",disabled:v.length<=0},"Add")}),y?.length>0&&n.createElement("ul",{className:T.tags},y.map(R=>n.createElement(i,{key:R,name:R,onRemove:x,disabled:E}))))},p=c=>({wrapper:(0,t.css)({minHeight:c.spacing(4),display:"flex",flexDirection:"column",gap:c.spacing(1),flexWrap:"wrap"}),tags:(0,t.css)({display:"flex",justifyContent:"flex-start",flexWrap:"wrap",gap:c.spacing(.5)}),addButtonStyle:(0,t.css)({margin:`0 -${c.spacing(1)}`})})},94753:(G,I,e)=>{"use strict";e.d(I,{E:()=>i});var t=e(32196),n=e(96540),s=e(40845),r=e(65848),o=e(56034);const m=n.forwardRef(({childElement:d,children:p},c)=>{const[y,f]=(0,n.useState)(!1),P=(0,n.useRef)(null);(0,n.useImperativeHandle)(c,()=>P.current);const a=(0,n.useMemo)(()=>new ResizeObserver(g=>{for(const h of g)h.target.clientWidth&&h.target.scrollWidth&&(h.target.scrollWidth>h.target.clientWidth&&f(!0),h.target.scrollWidth<=h.target.clientWidth&&f(!1))}),[]);(0,n.useEffect)(()=>{const{current:g}=P;return g&&a.observe(g),()=>{a.disconnect()}},[f,a]);const E=g=>typeof g=="string"?g:r.renderToStaticMarkup(n.createElement(n.Fragment,null,g)).replace(/(<([^>]+)>)/gi,"");return y?n.createElement(o.m,{ref:P,content:E(p)},d(void 0)):d(P)});m.displayName="TruncatedText";var l=e(71356);const i=n.forwardRef(({element:d="span",variant:p,weight:c,color:y,truncate:f,italic:P,textAlignment:a,children:E,tabular:g,...h},D)=>{const v=(0,s.of)(u,d,p,y,c,f,P,a,g),C=T=>(0,n.createElement)(d,{...h,style:void 0,className:v,ref:T},E);return!f||d==="span"?C(void 0):n.createElement(m,{childElement:C,children:E,ref:D})});i.displayName="Text";const u=(d,p,c,y,f,P,a,E,g)=>(0,t.css)([{margin:0,padding:0,...(0,l.d$)(d,p,c)},c&&{...d.typography[c]},y&&{color:(0,l.vT)(y,d)},f&&{fontWeight:(0,l.iV)(f,d)},P&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},a&&{fontStyle:"italic"},E&&{textAlign:E},g&&{fontFeatureSettings:'"tnum"'}])},71356:(G,I,e)=>{"use strict";e.d(I,{d$:()=>s,iV:()=>t,vT:()=>n});const t=(r,o)=>{switch(r){case"bold":return o.typography.fontWeightBold;case"medium":return o.typography.fontWeightMedium;case"light":return o.typography.fontWeightLight;case"regular":case void 0:return o.typography.fontWeightRegular}},n=(r,o)=>{switch(r){case"error":return o.colors.error.text;case"success":return o.colors.success.text;case"info":return o.colors.info.text;case"warning":return o.colors.warning.text;default:return r?o.colors.text[r]:void 0}},s=(r,o,m)=>{if(m)return r.typography[m];switch(o){case"span":return;case"h1":return r.typography.h1;case"h2":return r.typography.h2;case"h3":return r.typography.h3;case"h4":return r.typography.h4;case"h5":return r.typography.h5;case"h6":return r.typography.h6;default:return r.typography.body}}},21744:(G,I,e)=>{"use strict";e.d(I,{f:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(87266);const o=n.forwardRef(({invalid:l,className:i,...u},d)=>{const p=(0,s.of)(m,l);return n.createElement("textarea",{...u,className:(0,t.cx)(p.textarea,i),ref:d})}),m=(l,i=!1)=>({textarea:(0,t.cx)((0,r.Xb)(l),(0,r.gm)(l),(0,t.css)({display:"block",borderRadius:l.shape.radius.default,padding:`${l.spacing.gridSize/4}px ${l.spacing.gridSize}px`,width:"100%",borderColor:i?l.colors.error.border:l.components.input.borderColor}))});o.displayName="TextArea"},60782:(G,I,e)=>{"use strict";e.d(I,{G:()=>u});var t=e(32196),n=e(34743),s=e(36376),r=e(7315),o=e(96540),m=e(40845),l=e(18976),i=e(29158);const u=o.memo(({children:p,theme:c="info",placement:y="auto",content:f,title:P,closeButton:a=!0,onClose:E,footer:g,fitContent:h=!1,onOpen:D,show:v})=>{const C=(0,o.useRef)(null),T=(0,m.$j)(),S=(0,m.of)(d),O=S[c],[x,b]=(0,o.useState)(v),M=v??x,A=[(0,n.cY)(8),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)(),(0,n.UE)({element:C})],{context:R,refs:B,floatingStyles:U}=(0,s.we)({open:M,placement:(0,l.O)(y),onOpenChange:V=>{v===void 0&&b(V),V?D?.():E?.()},middleware:A,whileElementsMounted:r.ll,strategy:"fixed"}),W=(0,s.kp)(R),N=(0,s.s9)(R),{getReferenceProps:w,getFloatingProps:L}=(0,s.bv)([N,W]);return o.createElement(o.Fragment,null,o.cloneElement(p,{ref:B.setReference,tabIndex:0,"aria-expanded":M,...w()}),M&&o.createElement(s.s3,{context:R,modal:!1,closeOnFocusOut:!1},o.createElement("div",{"data-testid":"toggletip-content",className:(0,t.cx)(O.container,{[S.fitContent]:h}),ref:B.setFloating,style:U,...L()},o.createElement(s.ie,{strokeWidth:.3,stroke:T.colors.border.weak,className:O.arrow,ref:C,context:R}),!!P&&o.createElement("div",{className:O.header},P),a&&o.createElement("div",{className:O.headerClose},o.createElement(i.K,{"aria-label":"Close",name:"times","data-testid":"toggletip-header-close",onClick:()=>{b(!1),E?.()}})),o.createElement("div",{className:O.body},(typeof f=="string"||o.isValidElement(f))&&f,typeof f=="function"&&f({})),!!g&&o.createElement("div",{className:O.footer},g))))});u.displayName="Toggletip";const d=p=>{const c=(0,l.f)(p,p.colors.background.primary,p.colors.border.weak,p.components.tooltip.text,{topBottom:2,rightLeft:2}),y=(0,l.f)(p,p.colors.error.main,p.colors.error.main,p.colors.error.contrastText,{topBottom:2,rightLeft:2});return{info:c,error:y,fitContent:(0,t.css)({maxWidth:"fit-content"})}}},27746:(G,I,e)=>{"use strict";e.d(I,{I:()=>d});var t=e(32196),n=e(96540),s=e(8887),r=e(13544),o=e(40845),m=e(16797),l=e(55852),i=e(14578),u=e(56034);const d=(0,n.forwardRef)(({tooltip:f,icon:P,iconSize:a,className:E,children:g,imgSrc:h,imgAlt:D,fullWidth:v,isOpen:C,narrow:T,variant:S="default",iconOnly:O,"aria-label":x,isHighlighted:b,...M},A)=>{const R=(0,o.of)(y),B=(0,t.cx)({[R.button]:!0,[R.buttonFullWidth]:v,[R.narrow]:T},R[S],E),U=(0,t.cx)({[R.content]:!0,[R.contentWithIcon]:!!P,[R.contentWithRightIcon]:C!==void 0}),W=n.createElement("button",{ref:A,className:B,"aria-label":p(x,f),"aria-expanded":C,...M},c(P,a),h&&n.createElement("img",{className:R.img,src:h,alt:D??""}),g&&!O&&n.createElement("div",{className:U},g),C===!1&&n.createElement(i.I,{name:"angle-down"}),C===!0&&n.createElement(i.I,{name:"angle-up"}),b&&n.createElement("div",{className:R.highlight}));return f?n.createElement(u.m,{ref:A,content:f,placement:"bottom"},W):W});d.displayName="ToolbarButton";function p(f,P){return f||(P?r.Tp.components.PageToolbar.item(P):void 0)}function c(f,P){return f?(0,s.n6)(f)?n.createElement(i.I,{name:f,size:`${P||"lg"}`}):f:null}const y=f=>{const P=(0,l.U_)(f,"primary","solid"),a=(0,l.U_)(f,"destructive","solid"),E=(0,t.css)({color:f.colors.text.primary,background:f.colors.secondary.main,"&:hover":{color:f.colors.text.primary,background:f.colors.secondary.shade,border:`1px solid ${f.colors.border.medium}`}});return{button:(0,t.css)({label:"toolbar-button",position:"relative",display:"flex",alignItems:"center",height:f.spacing(f.components.height.md),padding:f.spacing(0,1),borderRadius:f.shape.radius.default,lineHeight:`${f.components.height.md*f.spacing.gridSize-2}px`,fontWeight:f.typography.fontWeightMedium,border:`1px solid ${f.colors.secondary.border}`,whiteSpace:"nowrap",[f.transitions.handleMotion("no-preference","reduce")]:{transition:f.transitions.create(["background","box-shadow","border-color","color"],{duration:f.transitions.duration.short})},"&:focus, &:focus-visible":{...(0,m.getFocusStyles)(f),zIndex:1},"&:focus:not(:focus-visible)":(0,m.getMouseFocusStyles)(f),"&:hover":{boxShadow:f.shadows.z1},"&[disabled], &:disabled":{cursor:"not-allowed",opacity:f.colors.action.disabledOpacity,background:f.colors.action.disabledBackground,boxShadow:"none","&:hover":{color:f.colors.text.disabled,background:f.colors.action.disabledBackground,boxShadow:"none"}}}),default:(0,t.css)({color:f.colors.text.secondary,background:"transparent",border:"1px solid transparent","&:hover":{color:f.colors.text.primary,background:f.colors.background.secondary}}),canvas:E,active:(0,t.cx)(E,(0,t.css)({"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"2px",bottom:0,borderRadius:f.shape.radius.default,backgroundImage:f.colors.gradients.brandHorizontal}})),primary:(0,t.css)(P),destructive:(0,t.css)(a),narrow:(0,t.css)({padding:f.spacing(0,.5)}),img:(0,t.css)({width:"16px",height:"16px",marginRight:f.spacing(1)}),buttonFullWidth:(0,t.css)({flexGrow:1}),content:(0,t.css)({flexGrow:1}),contentWithIcon:(0,t.css)({display:"none",paddingLeft:f.spacing(1),[`@media ${m.mediaUp(f.v1.breakpoints.md)}`]:{display:"block"}}),contentWithRightIcon:(0,t.css)({paddingRight:f.spacing(.5)}),highlight:(0,t.css)({backgroundColor:f.colors.success.main,borderRadius:f.shape.radius.circle,width:"6px",height:"6px",position:"absolute",top:"-3px",right:"-3px",zIndex:1})}}},15068:(G,I,e)=>{"use strict";e.d(I,{U:()=>u});var t=e(32196),n=e(18828),s=e(85690),r=e(93225),o=e(96540),m=e(40845),l=e(17464),i=e(27746);const u=(0,o.forwardRef)(({alignment:p="left",className:c,children:y,...f},P)=>{const a=o.Children.toArray(y).filter(A=>A!=null),[E,g]=(0,o.useState)(Array(a.length).fill(!1)),h=(0,o.useRef)(null),[D,v]=(0,o.useState)(!1),C=(0,o.useRef)(null),T=(0,o.createRef)(),{overlayProps:S}=(0,r.e)({onClose:()=>v(!1),isDismissable:!0,isOpen:D,shouldCloseOnInteractOutside:A=>{const R=(0,l.gF)();return!C.current?.contains(A)&&!R.contains(A)}},T),{dialogProps:O}=(0,n.s)({},T),x=(0,m.$j)(),b=p==="left"?E.indexOf(!1)-1:E.length,M=d(x,b,p);return(0,o.useLayoutEffect)(()=>{const A=new IntersectionObserver(R=>{R.forEach(B=>{if(B.target instanceof HTMLElement&&B.target.parentNode){const U=Array.prototype.indexOf.call(B.target.parentNode.children,B.target);g(W=>{const N=[...W];return N[U]=B.isIntersecting,N})}})},{threshold:1,root:h.current});return h.current&&Array.from(h.current.children).forEach(R=>{R instanceof HTMLElement&&R!==C.current&&A.observe(R)}),()=>A.disconnect()},[y]),o.createElement("div",{ref:h,className:(0,t.cx)(M.container,c),...f},a.map((A,R)=>o.createElement("div",{key:R,style:{order:R,visibility:E[R]?"visible":"hidden"},className:M.childWrapper},A)),E.includes(!1)&&o.createElement("div",{ref:C,className:M.overflowButton},o.createElement(i.I,{variant:D?"active":"default",tooltip:"Show more items",onClick:()=>v(!D),icon:"ellipsis-v",iconOnly:!0,narrow:!0}),D&&o.createElement(s.n1,{contain:!0,autoFocus:!0},o.createElement("div",{className:M.overflowItems,ref:T,...S,...O},a.map((A,R)=>!E[R]&&A)))))});u.displayName="ToolbarButtonRow";const d=(p,c,y)=>({overflowButton:(0,t.css)({order:c}),overflowItems:(0,t.css)({alignItems:"center",backgroundColor:p.colors.background.primary,borderRadius:p.shape.radius.default,boxShadow:p.shadows.z2,display:"flex",flexWrap:"wrap",gap:p.spacing(1),marginTop:p.spacing(1),maxWidth:"80vw",padding:p.spacing(.5,1),position:"absolute",right:0,top:"100%",width:"max-content",zIndex:p.zIndex.dropdown}),container:(0,t.css)({alignItems:"center",display:"flex",gap:p.spacing(1),justifyContent:y==="left"?"flex-start":"flex-end",minWidth:0,position:"relative"}),childWrapper:(0,t.css)({alignItems:"center",display:"flex",gap:p.spacing(1)})})},13840:(G,I,e)=>{"use strict";e.d(I,{A:()=>i});var t=e(34743),n=e(36376),s=e(7315),r=e(96540),o=e(40845),m=e(18976),l=e(17464);function i({content:u,show:d,placement:p,className:c,wrapperClassName:y,referenceElement:f,renderArrow:P,...a}){const E=(0,o.$j)(),g=(0,r.useRef)(null),h=[(0,t.cY)(8),(0,t.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,t.BN)()];P&&h.push((0,t.UE)({element:g}));const{context:D,refs:v,floatingStyles:C}=(0,n.we)({open:d,placement:(0,m.O)(p),middleware:h,whileElementsMounted:s.ll,strategy:"fixed"});(0,r.useLayoutEffect)(()=>{v.setReference(f)},[f,v]);const{styles:T}=(0,n.DL)(D,{initial:()=>({opacity:0}),duration:E.transitions.duration.enteringScreen});return d?r.createElement(l.ZL,null,r.createElement("div",{ref:v.setFloating,style:{...C,...T},className:y,...a},r.createElement("div",{className:c},P&&r.createElement(n.ie,{fill:E.colors.border.weak,ref:g,context:D}),typeof u=="string"&&u,r.isValidElement(u)&&r.cloneElement(u),typeof u=="function"&&u({})))):void 0}},95868:(G,I,e)=>{"use strict";e.d(I,{I:()=>n});var t=e(96540);class n extends t.Component{constructor(){super(...arguments),this.hideTimeout=null,this.state={show:!1},this.showPopper=()=>{this.hideTimeout&&clearTimeout(this.hideTimeout),this.setState({show:!0})},this.hidePopper=()=>{this.hideTimeout=setTimeout(()=>{this.setState({show:!1})},this.props.hideAfter)}}render(){const{children:r,content:o,placement:m="auto"}=this.props,{show:l}=this.state;return r(this.showPopper,this.hidePopper,{show:l,placement:m,content:o})}}},56034:(G,I,e)=>{"use strict";e.d(I,{m:()=>u});var t=e(34743),n=e(36376),s=e(7315),r=e(96540),o=e(13544),m=e(40845),l=e(18976),i=e(17464);const u=r.forwardRef(({children:p,theme:c,interactive:y,show:f,placement:P,content:a},E)=>{const g=(0,r.useRef)(null),[h,D]=(0,r.useState)(f),v=f??h,C=[(0,t.cY)(8),(0,t.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,t.BN)(),(0,t.UE)({element:g})],{context:T,refs:S,floatingStyles:O}=(0,n.we)({open:v,placement:(0,l.O)(P),onOpenChange:D,middleware:C,whileElementsMounted:s.ll}),x=(0,r.useId)(),b=(0,n.Mk)(T,{delay:{close:y?100:0},move:!1}),M=(0,n.iQ)(T),A=(0,n.s9)(T),{getReferenceProps:R,getFloatingProps:B}=(0,n.bv)([A,b,M]),U=typeof a=="function",N=(0,m.of)(d)[c??"info"],w=(0,r.useCallback)(V=>{S.setReference(V),typeof E=="function"?E(V):E&&(E.current=V)},[E,S]),L="aria-label"in p.props&&p.props["aria-label"]===a;return r.createElement(r.Fragment,null,r.cloneElement(p,{ref:w,tabIndex:0,"aria-describedby":!L&&v?x:void 0,...R()}),v&&r.createElement(i.ZL,null,r.createElement("div",{ref:S.setFloating,style:O,...B()},r.createElement(n.ie,{className:N.arrow,ref:g,context:T}),r.createElement("div",{"data-testid":o.Tp.components.Tooltip.container,id:x,role:"tooltip",className:N.container},typeof a=="string"&&a,r.isValidElement(a)&&r.cloneElement(a),U&&a({})))))});u.displayName="Tooltip";const d=p=>{const c=(0,l.f)(p,p.components.tooltip.background,p.components.tooltip.background,p.components.tooltip.text,{topBottom:.5,rightLeft:1}),y=(0,l.f)(p,p.colors.error.main,p.colors.error.main,p.colors.error.contrastText,{topBottom:.5,rightLeft:1});return{info:c,"info-alt":c,error:y}}},5313:(G,I,e)=>{"use strict";e.d(I,{z:()=>s});var t=e(96540);function n(r,o){const m=[];return r.forEach(l=>{m.push(l.start,l.end+1)}),m[0]!==0&&m.unshift(0),m[m.length-1]!==o&&m.push(o),m}const s=r=>{let{highlightParts:o,text:m,highlightClassName:l}=r;if(!o?.length)return null;let i=[],u=n(o,m.length),d=o[0].start===0;for(let p=1;p<u.length;p++){let c=u[p-1],y=u[p];i.push((0,t.createElement)(d?"mark":"span",{key:p-1,className:d?l:void 0},m.substring(c,y))),d=!d}return t.createElement("div",null,i)}},2056:(G,I,e)=>{"use strict";e.d(I,{p:()=>o});var t=e(96540),n=e(83195),s=e(3988);function r(m){return`Custom unit: ${m}`}class o extends t.PureComponent{constructor(){super(...arguments),this.onChange=l=>{this.props.onChange(l.value)}}render(){const{value:l,width:i}=this.props;let u;const p=(0,n.Ke)().map(c=>{const y=c.submenu.map(f=>{const P={label:f.text,value:f.value};return f.value===l&&(u=P),P});return{label:c.text,value:c.text,items:y}});return l&&!u&&(u={value:l,label:l}),t.createElement(s.v,{width:i,initialValue:u&&u.label,allowCustomValue:!0,changeOnSelect:!1,formatCreateLabel:r,options:p,placeholder:"Choose",isClearable:!0,onSelect:this.props.onChange})}}},12942:(G,I,e)=>{"use strict";e.d(I,{e:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(16795);const o=({src:l,alt:i,width:u,height:d})=>{const p=(0,s.of)(m,u,d);return n.createElement("img",{className:p.image,src:l,alt:i})},m=(l,i=3,u=3)=>({image:(0,t.css)([(0,r.Y)(l,i,d=>({width:l.spacing(d)})),(0,r.Y)(l,u,d=>({height:l.spacing(d)})),{borderRadius:l.shape.radius.circle}])})},99635:(G,I,e)=>{"use strict";e.d(I,{n:()=>i});var t=e(32196),n=e(96540),s=e(47232),r=e(40845),o=e(56034);const m=p=>{const y=(0,s.KQ)(p).diff((0,s.KQ)(),"hours",!1);return`Active last ${(Math.floor(-y/24)+1)*24}h`},l=p=>{if(!p)return"";const[c,y]=p.split(" ");return`${c?.[0]??""}${y?.[0]??""}`.toUpperCase()},i=({userView:p,className:c,children:y,onClick:f,showTooltip:P=!0})=>{const{user:a,lastActiveAt:E}=p,g=(0,s.KQ)(E).diff((0,s.KQ)(),"minutes",!0)>=-15,h=(0,r.$j)(),D=(0,n.useMemo)(()=>d(h,g),[h,g]),v=n.createElement("button",{type:"button",onClick:f,className:(0,t.cx)(D.container,f&&D.pointer,c),"aria-label":`${a.name} icon`},y?n.createElement("div",{className:(0,t.cx)(D.content,D.textContent)},y):a.avatarUrl?n.createElement("img",{className:D.content,src:a.avatarUrl,alt:`${a.name} avatar`}):n.createElement("div",{className:(0,t.cx)(D.content,D.textContent)},l(a.name)));if(P){const C=n.createElement("div",{className:D.tooltipContainer},n.createElement("div",{className:D.tooltipName},a.name),n.createElement("div",{className:D.tooltipDate},g?n.createElement("div",{className:D.dotContainer},n.createElement("span",null,"Active last 15m"),n.createElement("span",{className:D.dot})):m(E)));return n.createElement(o.m,{content:C},v)}else return v},u=p=>`0 0 0 1px ${p}`,d=(p,c)=>{const y=c?p.colors.primary.main:p.colors.border.medium,f=c?p.colors.primary.text:p.colors.border.strong;return{container:(0,t.css)({padding:0,width:"30px",height:"30px",background:"none",border:"none",borderRadius:p.shape.radius.circle,"& > *":{borderRadius:p.shape.radius.circle}}),content:(0,t.css)({lineHeight:"24px",maxWidth:"100%",border:`3px ${p.colors.background.primary} solid`,boxShadow:u(y),backgroundClip:"padding-box","&:hover":{boxShadow:u(f)}}),textContent:(0,t.css)({background:p.colors.background.primary,padding:0,color:p.colors.text.secondary,textAlign:"center",fontSize:p.typography.size.sm,"&:focus":{boxShadow:u(y)}}),tooltipContainer:(0,t.css)({textAlign:"center",padding:p.spacing(0,1)}),tooltipName:(0,t.css)({fontWeight:p.typography.fontWeightBold}),tooltipDate:(0,t.css)({fontWeight:p.typography.fontWeightRegular}),dotContainer:(0,t.css)({display:"flex",alignItems:"center"}),dot:(0,t.css)({height:"6px",width:"6px",backgroundColor:p.colors.primary.main,borderRadius:p.shape.radius.circle,display:"inline-block",marginLeft:p.spacing(1)}),pointer:(0,t.css)({cursor:"pointer"})}}},51986:(G,I,e)=>{"use strict";e.d(I,{i:()=>m});var t=e(96540),n=e(13544),s=e(40845),r=e(55852),o=e(21594);function m({"aria-label":l,label:i,icon:u,options:d,onChange:p,variant:c,minWidth:y=16,size:f="sm",isFullWidth:P=!0,menuPlacement:a,fill:E,buttonCss:g}){const[h,D]=(0,t.useState)(!1),v=(0,s.$j)();return t.createElement(t.Fragment,null,!h&&t.createElement(r.$n,{size:f||"sm",className:g,icon:u||"plus",onClick:()=>D(!0),variant:c,fill:E,fullWidth:P,"data-testid":n.Tp.components.ValuePicker.button(l??i)},i),h&&t.createElement("span",{style:{minWidth:v.spacing(y),flexGrow:P?1:void 0}},t.createElement(o.l6,{placeholder:i,options:d,"aria-label":n.Tp.components.ValuePicker.select(l??i),isOpen:!0,onCloseMenu:()=>D(!1),autoFocus:!0,onChange:C=>{D(!1),p(C)},menuPlacement:a})))}},67266:(G,I,e)=>{"use strict";e.d(I,{KU:()=>l});var t=e(32196),n=e(96540),s=e(49185),r=e(40845),o=e(16797),m=e(40276);const l=({width:d,height:p,legend:c,children:y})=>{const f=(0,r.$j)(),P=(0,r.of)(i),a={display:"flex",width:`${d}px`,height:`${p}px`},[E,g]=(0,s.A)();if(!c)return n.createElement(n.Fragment,null,n.createElement("div",{style:a,className:P.viz},y(d,p)));let{placement:h,maxHeight:D="35%",maxWidth:v="60%"}=c.props;document.body.clientWidth<f.breakpoints.values.lg&&(h="bottom");let C=null;const T={};switch(h){case"bottom":a.flexDirection="column",T.maxHeight=D,g.height&&(C={width:d,height:p-g.height});break;case"right":a.flexDirection="row",T.maxWidth=v,g.width&&(C={width:d-g.width,height:p}),c.props.width&&(T.width=c.props.width,C={width:d-c.props.width,height:p});break}return C?.width===0&&(C.width=d),C?.height===0&&(C.height=p),n.createElement("div",{style:a},n.createElement("div",{className:P.viz},C&&y(C.width,C.height)),n.createElement("div",{style:T,ref:E},n.createElement(m.E,{hideHorizontalTrack:!0},c)))},i=d=>({viz:(0,t.css)({flexGrow:2,borderRadius:d.shape.radius.default,"&:focus-visible":(0,o.getFocusStyles)(d)})}),u=({children:d})=>n.createElement(n.Fragment,null,d);l.Legend=u},94536:(G,I,e)=>{"use strict";e.d(I,{p:()=>o});var t=e(32196),n=e(96540),s=e(8066),r=e(40845);const o=n.memo(n.forwardRef(({color:l,className:i,gradient:u,lineStyle:d,...p},c)=>{const y=(0,r.$j)(),f=(0,r.of)(m);let P;if(u){const E=s.uf.get(u).getColors?.(y);E?.length?P=`linear-gradient(90deg, ${E.join(", ")})`:P=y.visualization.getColorByName("")}else P=l;let a;return d?.fill==="dot"&&!u?a={backgroundImage:`radial-gradient(circle at 2px 2px, ${l} 2px, transparent 0)`,backgroundSize:"4px 4px",backgroundRepeat:"space"}:d?.fill==="dash"&&!u?a={backgroundImage:`linear-gradient(to right, ${l} 100%, transparent 0%)`,backgroundSize:"6px 4px",backgroundRepeat:"space"}:a={background:P,borderRadius:y.shape.radius.pill},n.createElement("div",{"data-testid":"series-icon",ref:c,className:(0,t.cx)(i,f.forcedColors,f.container),style:a,...p})})),m=l=>({container:(0,t.css)({marginRight:"8px",display:"inline-block",width:"14px",height:"4px"}),forcedColors:(0,t.css)({"@media (forced-colors: active)":{forcedColorAdjust:"none"}})});o.displayName="SeriesIcon"},96516:(G,I,e)=>{"use strict";e.d(I,{t:()=>O});var t=e(96540),n=e(69129),s=e(52622),r=e(79041),o=e(88895),m=e(32196),l=e(40845),i=e(1551),u=e(33552),d=e(34375);const p=({items:x,itemRenderer:b,onLabelMouseOver:M,onLabelMouseOut:A,onLabelClick:R,placement:B,className:U,readonly:W})=>{const N=(0,l.of)(c);b||(b=L=>t.createElement(d.M,{item:L,onLabelClick:R,onLabelMouseOver:M,onLabelMouseOut:A,readonly:W}));const w=L=>`${L.getItemKey?L.getItemKey():L.label}`;switch(B){case"right":{const L=(V,K)=>t.createElement("span",{className:N.itemRight},b(V,K));return t.createElement("div",{className:(0,m.cx)(N.rightWrapper,U)},t.createElement(u.B,{items:x,renderItem:L,getItemKey:w}))}case"bottom":default:{const L=x.filter(k=>k.yAxis===1),V=x.filter(k=>k.yAxis!==1),K=(k,j)=>t.createElement("span",{className:N.itemBottom},b(k,j));return t.createElement("div",{className:(0,m.cx)(N.bottomWrapper,U)},L.length>0&&t.createElement("div",{className:N.section},t.createElement(i.c,{items:L,renderItem:K,getItemKey:w})),V.length>0&&t.createElement("div",{className:(0,m.cx)(N.section,N.sectionRight)},t.createElement(i.c,{items:V,renderItem:K,getItemKey:w})))}}};p.displayName="VizLegendList";const c=x=>{const b=(0,m.css)({paddingRight:"10px",display:"flex",fontSize:x.typography.bodySmall.fontSize,whiteSpace:"nowrap"});return{itemBottom:b,itemRight:(0,m.cx)(b,(0,m.css)({marginBottom:x.spacing(.5)})),rightWrapper:(0,m.css)({paddingLeft:x.spacing(.5)}),bottomWrapper:(0,m.css)({display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",paddingLeft:x.spacing(.5),gap:"15px 25px"}),section:(0,m.css)({display:"flex"}),sectionRight:(0,m.css)({justifyContent:"flex-end",flexGrow:1,flexBasis:"50%"})}};var y=e(14578),f=e(83195),P=e(16797),a=e(94134);const E=({item:x,onLabelClick:b,onLabelMouseOver:M,onLabelMouseOut:A,className:R,readonly:B})=>{const U=(0,l.of)(g),W=(0,t.useCallback)(L=>{M&&M(x,L)},[x,M]),N=(0,t.useCallback)(L=>{A&&A(x,L)},[x,A]),w=(0,t.useCallback)(L=>{b&&b(x,L)},[x,b]);return t.createElement("tr",{className:(0,m.cx)(U.row,R)},t.createElement("td",null,t.createElement("span",{className:U.itemWrapper},t.createElement(a.R,{color:x.color,seriesName:x.fieldName??x.label,readonly:B,lineStyle:x.lineStyle}),t.createElement("button",{disabled:B,type:"button",title:x.label,onBlur:N,onFocus:W,onMouseOver:W,onMouseOut:N,onClick:B?void 0:w,className:(0,m.cx)(U.label,x.disabled&&U.labelDisabled)},x.label," ",x.yAxis===2&&t.createElement("span",{className:U.yAxisLabel},"(right y-axis)")))),x.getDisplayValues&&x.getDisplayValues().map((L,V)=>t.createElement("td",{className:U.value,key:`${L.title}-${V}`},(0,f.cN)(L))))};E.displayName="LegendTableItem";const g=x=>{const b=P.hoverColor(x.colors.background.primary,x);return{row:(0,m.css)({label:"LegendRow",fontSize:x.v1.typography.size.sm,borderBottom:`1px solid ${x.colors.border.weak}`,td:{padding:x.spacing(.25,1),whiteSpace:"nowrap"},"&:hover":{background:b}}),label:(0,m.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,maxWidth:"600px",textOverflow:"ellipsis",overflow:"hidden",userSelect:"text"}),labelDisabled:(0,m.css)({label:"LegendLabelDisabled",color:x.colors.text.disabled}),itemWrapper:(0,m.css)({display:"flex",whiteSpace:"nowrap",alignItems:"center"}),value:(0,m.css)({textAlign:"right"}),yAxisLabel:(0,m.css)({color:x.colors.text.secondary})}},h="Name",D=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}).compare,v=({items:x,sortBy:b,sortDesc:M,itemRenderer:A,className:R,onToggleSort:B,onLabelClick:U,onLabelMouseOver:W,onLabelMouseOut:N,readonly:w,isSortable:L})=>{const V=(0,l.of)(C),K={};L&&(K[h]="");for(const k of x)if(k.getDisplayValues)for(const j of k.getDisplayValues())K[j.title??"?"]=j.description??"";if(b!=null){let k=new Map;x.forEach(H=>{if(b!==h&&H.getDisplayValues){const J=H.getDisplayValues().find(se=>se.title===b),X=J==null||Number.isNaN(J.numeric)?-1/0:J.numeric;k.set(H,X)}});let j=M?-1:1;b===h?x.sort((H,J)=>j*D(H.label,J.label)):x.sort((H,J)=>{const X=k.get(H)??0,se=k.get(J)??0;return j*(X-se)})}return A||(A=(k,j)=>t.createElement(E,{key:`${k.label}-${j}`,item:k,onLabelClick:U,onLabelMouseOver:W,onLabelMouseOut:N,readonly:w})),t.createElement("table",{className:(0,m.cx)(V.table,R)},t.createElement("thead",null,t.createElement("tr",null,!L&&t.createElement("th",null),Object.keys(K).map(k=>t.createElement("th",{title:K[k],key:k,className:(0,m.cx)(V.header,B&&V.headerSortable,L&&V.nameHeader,{[V.withIcon]:b===k}),onClick:()=>{B&&B(k)}},k,b===k&&t.createElement(y.I,{size:"xs",name:M?"angle-down":"angle-up"}))))),t.createElement("tbody",null,x.map(A)))},C=x=>({table:(0,m.css)({width:"100%","th:first-child":{width:"100%",borderBottom:`1px solid ${x.colors.border.weak}`}}),header:(0,m.css)({color:x.colors.primary.text,fontWeight:x.typography.fontWeightMedium,borderBottom:`1px solid ${x.colors.border.weak}`,padding:x.spacing(.25,1,.25,1),fontSize:x.typography.bodySmall.fontSize,textAlign:"right",whiteSpace:"nowrap"}),nameHeader:(0,m.css)({textAlign:"left",paddingLeft:"30px"}),withIcon:(0,m.css)({paddingRight:"4px"}),headerSortable:(0,m.css)({cursor:"pointer"})});var T=e(29995),S=e(44895);function O({items:x,displayMode:b,sortBy:M,seriesVisibilityChangeBehavior:A=T.K.Isolate,sortDesc:R,onLabelClick:B,onToggleSort:U,placement:W,className:N,itemRenderer:w,readonly:L,isSortable:V}){const{eventBus:K,onToggleSeriesVisibility:k,onToggleLegendSort:j}=(0,r.d2)(),H=(0,t.useCallback)((se,ae)=>{K?.publish({type:n.b_.type,payload:{raw:ae,x:0,y:0,dataId:se.label}})},[K]),J=(0,t.useCallback)((se,ae)=>{K?.publish({type:n.ql.type,payload:{raw:ae,x:0,y:0,dataId:se.label}})},[K]),X=(0,t.useCallback)((se,ae)=>{B&&B(se,ae),k&&k(se.fieldName??se.label,A===T.K.Hide?o.B.AppendToSelection:(0,S.W)(ae))},[k,B,A]);switch(b){case s.lm.Table:return t.createElement(v,{className:N,items:x,placement:W,sortBy:M,sortDesc:R,onLabelClick:X,onToggleSort:U||j,onLabelMouseOver:H,onLabelMouseOut:J,itemRenderer:w,readonly:L,isSortable:V});case s.lm.List:return t.createElement(p,{className:N,items:x,placement:W,onLabelMouseOver:H,onLabelMouseOut:J,onLabelClick:X,itemRenderer:w,readonly:L});default:return null}}O.displayName="VizLegend"},34375:(G,I,e)=>{"use strict";e.d(I,{M:()=>p});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(94134),m=e(2543),l=e(83195),i=e(1551);const u=({stats:y})=>{const f=(0,r.of)(d);return y.length===0?null:n.createElement(i.c,{className:f.list,items:y,renderItem:P=>n.createElement("div",{className:f.item,title:P.description},P.title&&`${(0,m.capitalize)(P.title)}:`," ",(0,l.cN)(P))})},d=()=>({list:(0,t.css)({flexGrow:1,textAlign:"right"}),item:(0,t.css)({marginLeft:"8px"})});u.displayName="VizLegendStatsList";const p=({item:y,onLabelClick:f,onLabelMouseOver:P,onLabelMouseOut:a,className:E,readonly:g})=>{const h=(0,r.of)(c),D=(0,n.useCallback)(T=>{P&&P(y,T)},[y,P]),v=(0,n.useCallback)(T=>{a&&a(y,T)},[y,a]),C=(0,n.useCallback)(T=>{f&&f(y,T)},[y,f]);return n.createElement("div",{className:(0,t.cx)(h.itemWrapper,y.disabled&&h.itemDisabled,E),"data-testid":s.Tp.components.VizLegend.seriesName(y.label)},n.createElement(o.R,{seriesName:y.fieldName??y.label,color:y.color,gradient:y.gradient,readonly:g,lineStyle:y.lineStyle}),n.createElement("button",{disabled:g,type:"button",onBlur:v,onFocus:D,onMouseOver:D,onMouseOut:v,onClick:C,className:h.label},y.label),y.getDisplayValues&&n.createElement(u,{stats:y.getDisplayValues()}))};p.displayName="VizLegendListItem";const c=y=>({label:(0,t.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,userSelect:"text"}),itemDisabled:(0,t.css)({label:"LegendLabelDisabled",color:y.colors.text.disabled}),itemWrapper:(0,t.css)({label:"LegendItemWrapper",display:"flex",whiteSpace:"nowrap",alignItems:"center",flexGrow:1}),value:(0,t.css)({textAlign:"right"}),yAxisLabel:(0,t.css)({color:y.v1.palette.gray2})})},94134:(G,I,e)=>{"use strict";e.d(I,{R:()=>o});var t=e(96540),n=e(83598),s=e(79041),r=e(94536);const o=t.memo(({seriesName:m,color:l,gradient:i,readonly:u,lineStyle:d})=>{const{onSeriesColorChange:p}=(0,s.d2)(),c=(0,t.useCallback)(y=>p(m,y),[m,p]);return m&&p&&l&&!u?t.createElement(n.Dp,{color:l,onChange:c,enableNamedColors:!0},({ref:y,showColorPicker:f,hideColorPicker:P})=>t.createElement(r.p,{color:l,className:"pointer",ref:y,onClick:f,onMouseLeave:P,lineStyle:d})):t.createElement(r.p,{color:l,gradient:i,lineStyle:d})});o.displayName="VizLegendSeriesIcon"},29995:(G,I,e)=>{"use strict";e.d(I,{K:()=>t});var t=(n=>(n[n.Isolate=0]="Isolate",n[n.Hide=1]="Hide",n))(t||{})},44895:(G,I,e)=>{"use strict";e.d(I,{W:()=>n});var t=e(88895);function n(s){return s.ctrlKey||s.metaKey||s.shiftKey?t.B.AppendToSelection:t.B.ToggleSelection}},12509:(G,I,e)=>{"use strict";e.d(I,{S:()=>m});var t=e(2543),n=e(96540),s=e(47070);const r=(i,u,d,p)=>{const c=o(i,u,p),y=o(u,i,p),f=Math.max(c,y);let P=Math.floor(i/f),a=Math.ceil(p/P);P=Math.ceil(p/a);const E=P-(P*a-p),g=i/E-d+d/E;return{width:i/P-d+d/P,height:u/a-d+d/a,widthOnLastRow:g,xCount:P,yCount:a}};function o(i,u,d){const p=Math.ceil(Math.sqrt(d*i/u));return Math.floor(p*u/i)*p<d?u/Math.ceil(p*u/i):i/p}class m extends n.PureComponent{static{this.defaultProps={itemSpacing:8}}constructor(u){super(u),this.state={values:u.getValues()}}componentDidUpdate(u){const{renderCounter:d,source:p}=this.props;(d!==u.renderCounter||p!==u.source)&&this.setState({values:this.props.getValues()})}getOrientation(){const{orientation:u,width:d,height:p}=this.props;return u===s.wV.Auto?d>p?s.wV.Vertical:s.wV.Horizontal:u}renderGrid(){const{renderValue:u,height:d,width:p,itemSpacing:c,getAlignmentFactors:y,orientation:f}=this.props,{values:P}=this.state,a=r(p,d,c,P.length),E=y?y(P,a.width,a.height):{};let g=0,h=0,D=[];for(let v=0;v<P.length;v++){const C=P[v],S=h===a.yCount-1?a.widthOnLastRow:a.width,O=a.height,x=g*S+c*g,b=h*O+c*h,M={position:"absolute",left:x,top:b,width:`${S}px`,height:`${O}px`};D.push(n.createElement("div",{key:v,style:M},u({value:C,width:S,height:O,alignmentFactors:E,orientation:f,count:P.length}))),g++,g===a.xCount&&(g=0,h++)}return n.createElement("div",{style:{position:"relative"}},D)}render(){const{renderValue:u,height:d,width:p,itemSpacing:c,getAlignmentFactors:y,autoGrid:f,orientation:P,maxVizHeight:a,minVizWidth:E,minVizHeight:g}=this.props,{values:h}=this.state;if(f&&P===s.wV.Auto)return this.renderGrid();const D={display:"flex"},v={display:"flex",overflow:`${E?"auto":"hidden"} ${g?"auto":"hidden"}`};let C=d,T=p;const S=this.getOrientation();switch(S){case s.wV.Horizontal:const x=(d+c)/h.length-c;v.flexDirection="column",v.height=`${d}px`,D.marginBottom=`${c}px`,T=p,C=(0,t.clamp)(x,g??0,a??x);break;case s.wV.Vertical:v.flexDirection="row",v.justifyContent="space-between",D.marginRight=`${c}px`,C=d,T=Math.max(p/h.length-c+c/h.length,E??0)}D.width=`${T}px`,D.height=`${C}px`;const O=y?y(h,T,C):{};return n.createElement("div",{style:v},h.map((x,b)=>n.createElement("div",{key:b,style:l(D,b,h.length)},u({value:x,width:T,height:C,alignmentFactors:O,orientation:S,count:h.length}))))}}function l(i,u,d){return u===d-1?{...i,marginRight:0,marginBottom:0}:i}},3139:(G,I,e)=>{"use strict";e.d(I,{g:()=>m,o:()=>l});var t=e(32196),n=e(96540),s=e(40845),r=e(94536);const o=i=>({icon:(0,t.css)({marginRight:i.spacing(1),verticalAlign:"middle"}),seriesTable:(0,t.css)({display:"table"}),seriesTableRow:(0,t.css)({display:"table-row",fontSize:i.typography.bodySmall.fontSize}),seriesTableCell:(0,t.css)({display:"table-cell"}),label:(0,t.css)({wordBreak:"break-all"}),value:(0,t.css)({paddingLeft:i.spacing(2),textAlign:"right"}),activeSeries:(0,t.css)({fontWeight:i.typography.fontWeightBold,color:i.colors.text.maxContrast}),timestamp:(0,t.css)({fontWeight:i.typography.fontWeightBold,fontSize:i.typography.bodySmall.fontSize})}),m=({color:i,label:u,value:d,isActive:p})=>{const c=(0,s.of)(o);return n.createElement("div",{"data-testid":"SeriesTableRow",className:(0,t.cx)(c.seriesTableRow,p&&c.activeSeries)},i&&n.createElement("div",{className:c.seriesTableCell},n.createElement(r.p,{color:i,className:c.icon})),u&&n.createElement("div",{className:(0,t.cx)(c.seriesTableCell,c.label)},u),d&&n.createElement("div",{className:(0,t.cx)(c.seriesTableCell,c.value)},d))},l=({timestamp:i,series:u})=>{const d=(0,s.of)(o);return n.createElement(n.Fragment,null,i&&n.createElement("div",{className:d.timestamp,"aria-label":"Timestamp"},i),u.map((p,c)=>n.createElement(m,{isActive:p.isActive,label:p.label,color:p.color,value:p.value,key:`${p.label}-${c}`})))}},75128:(G,I,e)=>{"use strict";e.d(I,{n:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(17464),o=e(69503);const m=({content:i,position:u,offset:d})=>{const p=(0,s.of)(l);return u?n.createElement(r.ZL,{className:p.portal},n.createElement(o.o,{position:u,offset:d||{x:0,y:0}},i)):null};m.displayName="VizTooltip";const l=()=>({portal:(0,t.css)({position:"absolute",top:0,left:0,pointerEvents:"none",width:"100%",height:"100%"})})},69503:(G,I,e)=>{"use strict";e.d(I,{o:()=>l});var t=e(32196),n=e(96540),s=e(52908),r=e(40845),o=e(16797),m=e(10875);const l=({position:{x:u,y:d},offset:{x:p,y:c},children:y,allowPointerEvents:f=!1,className:P,...a})=>{const E=(0,n.useRef)(null),[g,h]=(0,n.useState)({width:0,height:0}),{width:D,height:v}=(0,s.A)(),[C,T]=(0,n.useState)({x:u+p,y:d+c}),S=(0,n.useMemo)(()=>new ResizeObserver(x=>{for(let b of x){const M=Math.floor(b.contentRect.width+16),A=Math.floor(b.contentRect.height+2*8);(g.width!==M||g.height!==A)&&h({width:Math.min(M,D),height:Math.min(A,v)})}}),[g,D,v]);(0,n.useLayoutEffect)(()=>(E.current&&S.observe(E.current),()=>{S.disconnect()}),[S]),(0,n.useLayoutEffect)(()=>{if(E&&E.current){const{x,y:b}=(0,m.Ju)(u,d,g.width,g.height,p,c,D,v);T({x,y:b})}},[D,v,u,p,d,c,g]);const O=(0,r.of)(i);return n.createElement("div",{ref:E,style:{position:"fixed",left:0,pointerEvents:f?"auto":"none",top:0,transform:`translate(${C.x}px, ${C.y}px)`,transition:"transform ease-out 0.1s"},"aria-live":"polite","aria-atomic":"true",...a,className:(0,t.cx)(O.wrapper,P)},y)};l.displayName="VizTooltipContainer";const i=u=>({wrapper:(0,t.css)((0,o.getTooltipContainerStyles)(u))})},11389:(G,I,e)=>{"use strict";e.d(I,{o:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(13471);const o=({items:l,children:i,isPinned:u,scrollable:d=!1,maxHeight:p})=>{const c=(0,s.of)(m),y=d?{maxHeight:p,overflowY:"scroll"}:{};return n.createElement("div",{className:c.wrapper,style:y},l.map(({label:f,value:P,color:a,colorIndicator:E,colorPlacement:g,isActive:h,lineStyle:D},v)=>n.createElement(r.B,{key:v,label:f,value:P,color:a,colorIndicator:E,colorPlacement:g,isActive:h,justify:"space-between",isPinned:u,lineStyle:D,showValueScroll:!d})),i)},m=l=>({wrapper:(0,t.css)({display:"flex",flexDirection:"column",flex:1,gap:4,borderTop:`1px solid ${l.colors.border.medium}`,padding:l.spacing(1)})})},58749:(G,I,e)=>{"use strict";e.d(I,{S:()=>i});var t=e(32196),n=e(96540),s=e(67061),r=e(14689),o=e(55852),m=e(40845);const l="add-annotation-button",i=({dataLinks:d,annotate:p})=>{const c=(0,m.of)(u),y=()=>{const f={variant:"secondary"};return n.createElement(s.B,{direction:"column",justifyContent:"flex-start"},d.map((P,a)=>n.createElement(r.R,{key:a,link:P,buttonProps:f})))};return n.createElement("div",{className:c.wrapper},d.length>0&&n.createElement("div",{className:c.dataLinks},y()),p!=null&&n.createElement("div",{className:c.addAnnotations},n.createElement(o.$n,{icon:"comment-alt",variant:"secondary",size:"sm",id:l,onClick:p},"Add annotation")))},u=d=>({wrapper:(0,t.css)({display:"flex",flexDirection:"column",flex:1,padding:d.spacing(0)}),dataLinks:(0,t.css)({borderTop:`1px solid ${d.colors.border.medium}`,padding:d.spacing(1)}),addAnnotations:(0,t.css)({borderTop:`1px solid ${d.colors.border.medium}`,padding:d.spacing(1)})})},52415:(G,I,e)=>{"use strict";e.d(I,{A:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(13471);const o=({item:l,isPinned:i})=>{const u=(0,s.of)(m),{label:d,value:p,color:c,colorIndicator:y}=l;return n.createElement("div",{className:u.wrapper},n.createElement(r.B,{label:d,value:p,color:c,colorIndicator:y,marginRight:"22px",isPinned:i}))},m=l=>({wrapper:(0,t.css)({display:"flex",flexDirection:"column",flex:1,padding:l.spacing(1)})})},13471:(G,I,e)=>{"use strict";e.d(I,{B:()=>a});var t=e(32196),n=e(96540),s=e(40845),r=e(32982),o=e(56034),m=e(24293),l=e(94536),i=e(79871),u=e(10875),d=(g=>(g[g.Leading=0]="Leading",g[g.Trailing=1]="Trailing",g))(d||{});const p=({color:g=m.F,colorIndicator:h=i.Ev,position:D=0,lineStyle:v})=>{const C=(0,s.of)(c);return h===i.fX.series?n.createElement(l.p,{color:g,lineStyle:v,className:D===0?C.leading:C.trailing}):n.createElement("span",{style:{backgroundColor:g},className:(0,t.cx)(D===0?C.leading:C.trailing,(0,u.L$)(h,C))})},c=g=>({leading:(0,t.css)({marginRight:g.spacing(.5)}),trailing:(0,t.css)({marginLeft:g.spacing(.5)}),value:(0,t.css)({width:"12px",height:"12px",borderRadius:g.shape.radius.default,fontWeight:500,minWidth:"12px"}),hexagon:(0,t.css)({}),pie_1_4:(0,t.css)({}),pie_2_4:(0,t.css)({}),pie_3_4:(0,t.css)({}),marker_sm:(0,t.css)({width:"4px",height:"4px",borderRadius:g.shape.radius.circle,minWidth:"4px"}),marker_md:(0,t.css)({width:"8px",height:"8px",borderRadius:g.shape.radius.circle,minWidth:"8px"}),marker_lg:(0,t.css)({width:"12px",height:"12px",borderRadius:g.shape.radius.circle,minWidth:"12px"})});var y=(g=>(g.label="label",g.value="value",g))(y||{});const f="Copied to clipboard",P=2*1e3,a=({label:g,value:h,color:D,colorIndicator:v,colorPlacement:C=i.lJ.first,justify:T="flex-start",isActive:S=!1,marginRight:O="0px",isPinned:x,lineStyle:b,showValueScroll:M})=>{const A=(0,s.of)(E,T,O),R=M?{maxHeight:55,whiteSpace:"wrap",wordBreak:"break-word",overflowY:"scroll"}:{whiteSpace:"wrap",wordBreak:"break-word"},[B,U]=(0,n.useState)(!1),[W,N]=(0,n.useState)(null),[w,L]=(0,n.useState)(!1),V=(0,n.useRef)(null),K=(0,n.useRef)(null);(0,n.useEffect)(()=>{let X;return w&&(X=setTimeout(()=>{L(!1)},P)),()=>{window.clearTimeout(X)}},[w]);const k=async(X,se)=>{if(!(navigator?.clipboard&&window.isSecureContext)){j(X,se);return}try{await navigator.clipboard.writeText(X),N({[`${se}`]:X}),L(!0)}catch{N(null)}},j=(X,se)=>{const ae=document.createElement("textarea");V.current?.appendChild(ae),ae.value=X,ae.focus(),ae.select();try{document.execCommand("copy")&&(N({[`${se}`]:X}),L(!0))}catch(ne){console.error("Unable to copy to clipboard",ne)}ae.remove()},H=X=>{X.currentTarget.offsetWidth<X.currentTarget.scrollWidth&&U(!0)},J=()=>U(!1);return n.createElement("div",{className:A.contentWrapper},(D||g)&&n.createElement("div",{className:A.valueWrapper},D&&C===i.lJ.first&&n.createElement(p,{color:D,colorIndicator:v,lineStyle:b}),x?n.createElement(n.Fragment,null,n.createElement(o.m,{content:g,interactive:!1,show:B},n.createElement(n.Fragment,null,w&&W?.label&&n.createElement(r.r,{placement:"top",referenceElement:V.current},f),n.createElement("div",{className:(0,t.cx)(A.label,S&&A.activeSeries,navigator?.clipboard&&A.copy),onMouseEnter:H,onMouseLeave:J,onClick:()=>k(g,"label"),ref:V},g)))):n.createElement("div",{className:(0,t.cx)(A.label,S&&A.activeSeries)},g)),n.createElement("div",{className:A.valueWrapper},D&&C===i.lJ.leading&&n.createElement(p,{color:D,colorIndicator:v,position:d.Leading,lineStyle:b}),x?n.createElement(n.Fragment,null,w&&W?.value&&n.createElement(r.r,{placement:"top",referenceElement:K.current},f),n.createElement("div",{className:(0,t.cx)(A.value,S,navigator?.clipboard&&A.copy),style:R,onClick:()=>k(h?h.toString():"","value"),ref:K},h)):n.createElement("div",{className:(0,t.cx)(A.value,S),style:R},h),D&&C===i.lJ.trailing&&n.createElement(p,{color:D,colorIndicator:v,position:d.Trailing,lineStyle:b})))},E=(g,h,D)=>({contentWrapper:(0,t.css)({display:"flex",alignItems:"start",justifyContent:h,marginRight:D}),label:(0,t.css)({color:g.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:g.spacing(2)}),value:(0,t.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),valueWrapper:(0,t.css)({display:"flex",alignItems:"center"}),activeSeries:(0,t.css)({fontWeight:g.typography.fontWeightBold,color:g.colors.text.maxContrast}),copy:(0,t.css)({cursor:"pointer"})})},79871:(G,I,e)=>{"use strict";e.d(I,{Ev:()=>s,fX:()=>t,lJ:()=>n});var t=(r=>(r.series="series",r.value="value",r.hexagon="hexagon",r.pie_1_4="pie_1_4",r.pie_2_4="pie_2_4",r.pie_3_4="pie_3_4",r.marker_sm="marker_sm",r.marker_md="marker_md",r.marker_lg="marker_lg",r))(t||{}),n=(r=>(r.hidden="hidden",r.first="first",r.leading="leading",r.trailing="trailing",r))(n||{});const s="series"},10875:(G,I,e)=>{"use strict";e.d(I,{Ju:()=>l,L$:()=>i,cp:()=>c});var t=e(11261),n=e(8066),s=e(83195),r=e(24293),o=e(52622),m=e(79871);const l=(y=0,f=0,P=0,a=0,E=0,g=0,h=0,D=0)=>{let v=y,C=f;const T=Math.max(y+E+P-(h-E),0),S=Math.abs(Math.min(y-E-P-E,0)),O=T>0,x=S>0,b=Math.max(f+g+a-(D-g),0),M=Math.abs(Math.min(f-g-a-g,0)),A=b>0,R=M>0;return O&&x?v=T>S?E:h-E-P:O?v=y-E-P:v=y+E,A&&R?C=b>M?g:D-g-a:A?C=f-g-a:C=f+g,{x:v,y:C}},i=(y,f)=>{switch(y){case m.fX.value:return f.value;case m.fX.hexagon:return f.hexagon;case m.fX.pie_1_4:return f.pie_1_4;case m.fX.pie_2_4:return f.pie_2_4;case m.fX.pie_3_4:return f.pie_3_4;case m.fX.marker_sm:return f.marker_sm;case m.fX.marker_md:return f.marker_md;case m.fX.marker_lg:return f.marker_lg;default:return f.value}},u=(y,f)=>y.numeric-f.numeric,d=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),p=(y,f)=>d.compare(`${y.value}`,`${f.value}`),c=(y,f,P,a,E,g,h=D=>!0)=>{let D=[],v=!0;for(let C=0;C<y.length;C++){const T=y[C];if(T===f||T.type===t.PU.time||!h(T)||T.config.custom?.hideFrom?.tooltip||T.config.custom?.hideFrom?.viz||E===o.$N.Single&&a!==C)continue;let S=P[C];if(S==null)continue;T.type===t.PU.number||T.type===t.PU.boolean||T.type===t.PU.enum||(v=!1);const O=y[C].values[S];if(O==null&&T.config.noValue==null)continue;const x=T.display(O),b=Number.isNaN(x.numeric)?g===o.xB.Descending?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER:x.numeric,M=(0,n.Qi)(T);let A=m.fX.series,R=m.lJ.first;M.isByValue&&(A=m.fX.value,R=m.lJ.trailing),D.push({label:T.state?.displayName??T.name,value:(0,s.cN)(x),color:x.color??r.F,colorIndicator:A,colorPlacement:R,isActive:E===o.$N.Multi&&a===C,numeric:b,lineStyle:T.config.custom?.lineStyle})}if(g!==o.xB.None&&D.length>1){const C=v?u:p,T=g===o.xB.Descending?-1:1;D.sort((S,O)=>T*C(S,O))}return D}},94333:(G,I,e)=>{"use strict";e.r(I),e.d(I,{Alert:()=>Ke.F,AlertingSettings:()=>lt.i,AsyncMultiSelect:()=>nr.Iv,AsyncSelect:()=>nr.DW,AsyncVirtualizedSelect:()=>nr.gZ,AutoSaveField:()=>se.p,AutoSizeInput:()=>io.D,Avatar:()=>Pt.e,Badge:()=>_s.E,BarGauge:()=>Dt.xE,BarGaugeDisplayMode:()=>kn.eX,BigValue:()=>$e.yV,BigValueColorMode:()=>$e.yp,BigValueGraphMode:()=>$e.$p,BigValueJustifyMode:()=>$e.F8,BigValueTextMode:()=>$e.SV,Box:()=>Xa.a,BrowserLabel:()=>Rs.J,Button:()=>Fn.$n,ButtonCascader:()=>v.H,ButtonGroup:()=>wn.e,ButtonSelect:()=>fo.f,CallToActionCard:()=>Xt.c,Card:()=>Js.Z,CardContainer:()=>uo.Q,Cascader:()=>D.v,CertificationKey:()=>zt.K,Checkbox:()=>co.S,ClickOutsideWrapper:()=>bt.N,ClipboardButton:()=>h.b,CodeEditor:()=>ie.B,CodeEditorSuggestionItemKind:()=>ue.q,CollapsableSection:()=>ft.M,Collapse:()=>rt.S,ColorPicker:()=>O.sk,ColorPickerInput:()=>x.i,ConfirmButton:()=>d.Z,ConfirmModal:()=>z.u,Container:()=>cs.mc,ContextMenu:()=>Lt.t,ControlledCollapse:()=>rt.a,Counter:()=>xe.p,CustomHeadersSettings:()=>mt.P,CustomScrollbar:()=>E.E,DataLinkButton:()=>pt.R,DataLinkInput:()=>ht.l,DataLinksContextMenu:()=>Rt.e,DataLinksInlineEditor:()=>Nt.e,DataSourceHttpSettings:()=>cn.t,DatePicker:()=>K.l,DatePickerWithInput:()=>k.l,DateTimePicker:()=>j.K,DeleteButton:()=>p.e,Divider:()=>Pn.c,Drawer:()=>Kt._,Dropdown:()=>Vr.m,EmptySearchResult:()=>M.Z,EmptyState:()=>A.p,ErrorBoundary:()=>vt.tH,ErrorBoundaryAlert:()=>vt.Xw,ErrorWithStack:()=>nn.D,EventBusPlugin:()=>es.Ku,EventsCanvas:()=>Ra.a,FIXED_UNIT:()=>zs.s,FadeTransition:()=>mn.A,FeatureBadge:()=>bn.y,FeatureInfoBox:()=>ln.e,Field:()=>ls.D,FieldArray:()=>As.E,FieldLinkList:()=>Ge.n,FieldSet:()=>Fs.n,FieldValidationMessage:()=>Ts.P,FileDropzone:()=>Xr.gH,FileDropzoneDefaultChildren:()=>Xr.wI,FileListItem:()=>Xr.IB,FileUpload:()=>Ho.e,FilterInput:()=>Mo.Z,FilterPill:()=>ee.m,Form:()=>Je.l,FormattedValueDisplay:()=>mo.i,FullWidthButtonContainer:()=>qe.V,Gauge:()=>gt._,Graph:()=>dr.T,GraphContextMenu:()=>$r.H,GraphContextMenuHeader:()=>$r.i,GraphNG:()=>Ka.o,GraphSeriesToggler:()=>it.M,GraphWithLegend:()=>Us.I,Grid:()=>Cs.x,HorizontalGroup:()=>cs.Gy,Icon:()=>i.I,IconButton:()=>u.K,InfoBox:()=>on.w,InlineField:()=>Es.I,InlineFieldRow:()=>js.C,InlineFormLabel:()=>Gt.I,InlineLabel:()=>ps.c,InlineSegmentGroup:()=>gs.e,InlineSwitch:()=>Jr.K,InlineToast:()=>C.r,Input:()=>Kr.p,InputControl:()=>xn.e,InteractiveTable:()=>J.j,JSONFormatter:()=>In.B,JsonExplorer:()=>Mn.O,KeyboardPlugin:()=>es.Z7,Label:()=>Is.J,LegacyForms:()=>Io,LegacyInputStatus:()=>n.O,Legend:()=>ss.s,Link:()=>Wa.N,LinkButton:()=>Fn.z9,List:()=>H.B,LoadingBar:()=>S.G,LoadingPlaceholder:()=>T._,Marker:()=>Ra.pH,Menu:()=>Qt.W,MenuGroup:()=>an.r,MenuItem:()=>gn.D,Modal:()=>Te.a,ModalHeader:()=>he.r,ModalRoot:()=>pe.EO,ModalTabContent:()=>le.O,ModalTabsHeader:()=>de.J,ModalsContext:()=>pe.wE,ModalsController:()=>pe.$s,ModalsProvider:()=>pe.YO,MultiSelect:()=>nr.KF,PageToolbar:()=>ve.d,Pagination:()=>ae.d,PanelChrome:()=>Z.NR,PanelChromeLoadingIndicator:()=>oe.I,PanelContainer:()=>xr._,PanelContextProvider:()=>Ee.XF,PanelContextRoot:()=>Ee.e4,PlotLegend:()=>os.$,PluginSignatureBadge:()=>Oo.B,Popover:()=>f.A,PopoverController:()=>y.I,Portal:()=>a.ZL,PortalContainer:()=>a.qB,QueryField:()=>te.X,RadioButtonGroup:()=>Ys.z,RadioButtonList:()=>sr.a,RangeSlider:()=>Mt.F,ReactMonacoEditor:()=>ce.m,RefreshPicker:()=>U.cC,RelativeTimeRangePicker:()=>Ur.N,RenderUserContentAsHTML:()=>Ve.I,ScaleDistribution:()=>kn.L4,SecretInput:()=>cr.L,SecretTextArea:()=>lo.l,SecureSocksProxySettings:()=>Tt.Y,Segment:()=>wt.Y,SegmentAsync:()=>en.s,SegmentInput:()=>En.o,SegmentSection:()=>At.L,SegmentSelect:()=>yt.a,Select:()=>nr.l6,SelectContainer:()=>nr.KA,SeriesColorPicker:()=>O.Dp,SeriesColorPickerPopover:()=>b.o,SeriesColorPickerPopoverWithTheme:()=>b.t,SeriesIcon:()=>_t.p,SeriesTable:()=>Ae.o,SeriesTableRow:()=>Ae.g,SeriesVisibilityChangeBehavior:()=>Se.K,SeriesVisibilityChangeMode:()=>Ws.B,SetInterval:()=>be.u,SlideOutTransition:()=>dt.n,Slider:()=>Jt.A,Space:()=>ns.$,Sparkline:()=>Xe.O,Spinner:()=>rn.y,Stack:()=>Va.B,StatsPicker:()=>B.S,Switch:()=>Jr.d,TLSAuthSettings:()=>Vt.j,Tab:()=>we.o,TabContent:()=>Fe.J,TabbedContainer:()=>g.q,Table:()=>Oe.X,TableInputCSV:()=>Me.b,TabsBar:()=>Ue.U,Tag:()=>ne.v,TagList:()=>q.L,TagsInput:()=>X.u,Text:()=>_a.E,TextArea:()=>Rr.f,TextLink:()=>za.Y,TimeOfDayPicker:()=>w.R,TimePickerTooltip:()=>W.xS,TimeRangeInput:()=>xo.b,TimeRangeLabel:()=>N.f,TimeRangePicker:()=>W.$6,TimeSeries:()=>ys.Z,TimeZonePicker:()=>L.U,Toggletip:()=>P.G,ToolbarButton:()=>Wn.I,ToolbarButtonRow:()=>da.U,Tooltip:()=>c.m,TooltipPlugin:()=>go.T,TooltipPlugin2:()=>es.xl,UPLOT_AXIS_FONT_SIZE:()=>ua.pi,UPlotChart:()=>ra.Z,UPlotConfigBuilder:()=>xa.e,UnitPicker:()=>R.p,UserIcon:()=>vr.n,ValuePicker:()=>oa.i,VerticalGroup:()=>cs.gW,VerticalTab:()=>Re.s,VirtualizedSelect:()=>nr.ip,VizLayout:()=>ye.KU,VizLegend:()=>Be.t,VizLegendListItem:()=>We.M,VizRepeater:()=>re.S,VizTooltip:()=>nt.n,VizTooltipContainer:()=>at.o,WeekStartPicker:()=>V.l,WithContextMenu:()=>ut.n,XYCanvas:()=>Ra._X,ZoomPlugin:()=>Zr.j,buildScaleKey:()=>ds.My,clearButtonStyles:()=>Fn.my,convertOldAngularValueMapping:()=>Ft.I1,defaultIntervals:()=>U.cb,fieldMatchersUI:()=>_n.g,getCardStyles:()=>Js.H,getDragStyles:()=>hn.l,getInputStyles:()=>Kr.n,getPortalContainer:()=>a.gF,getSelectStyles:()=>hr.J,graphFieldOptions:()=>Hn.t,graphTickFormatter:()=>ks.Yn,graphTimeFormat:()=>ks.Jc,preparePlotFrame:()=>ds.mY,resetSelectStyles:()=>Qr.A,sharedInputStyle:()=>Nn.Xb,sharedSingleStatMigrationHandler:()=>Ft._$,sharedSingleStatPanelChangedHandler:()=>Ft.gl,useGraphNGContext:()=>Er.I,usePanelContext:()=>Ee.d2,useSplitter:()=>Ln.h,variableSuggestionToCodeEditorSuggestion:()=>fe.O,withErrorBoundary:()=>vt.Xc});var t=e(90090),n=e(91634),s=e(24169),r=e(11206),o=e(22209),m=e(74716),l=e(56286),i=e(14578),u=e(29158),d=e(82702),p=e(91605),c=e(56034),y=e(95868),f=e(13840),P=e(60782),a=e(17464),E=e(40276),g=e(60734),h=e(10534),D=e(3988),v=e(32012),C=e(32982),T=e(39558),S=e(57514),O=e(83598),x=e(99128),b=e(70104),M=e(41670),A=e(69529),R=e(2056),B=e(42734),U=e(11134),W=e(15666),N=e(3799),w=e(66070),L=e(20333),V=e(15648),K=e(56181),k=e(98239),j=e(63383),H=e(33552),J=e(48840),X=e(79924),se=e(28270),ae=e(19384),ne=e(78369),q=e(64149),ee=e(92174),z=e(96374),te=e(20084),ie=e(32372),ce=e(85828),ue=e(19716),fe=e(99544),Te=e(37390),he=e(29473),de=e(25897),le=e(95246),pe=e(71678),ve=e(95247),be=e(67570),Oe=e(77093),Me=e(14746),Ue=e(63021),we=e(40675),Re=e(90685),Fe=e(40980),xe=e(53402),Ve=e(44522),$e=e(37494),Xe=e(5926),gt=e(95164),Dt=e(97696),nt=e(75128),at=e(69503),Ae=e(3139),re=e(12509),Z=e(91052),oe=e(89963),Ee=e(79041),ye=e(67266),Se=e(29995),Be=e(96516),We=e(34375),Ke=e(42418),it=e(84656),rt=e(82762),ft=e(57418),pt=e(14689),Ge=e(79961),qe=e(61458),bt=e(8866),Ft=e(37713),Xt=e(76442),Lt=e(28122),Qt=e(38138),an=e(59093),gn=e(64539),ut=e(51686),Nt=e(64919),ht=e(64078),Rt=e(59796),_t=e(94536),on=e(37166),ln=e(86460),bn=e(29678),In=e(24022),Mn=e(44533),vt=e(66602),nn=e(52446),cn=e(91409),mt=e(11184),lt=e(19849),Tt=e(17081),Vt=e(95180),zt=e(28623),rn=e(62930),mn=e(31511),dt=e(72960),wt=e(38401),en=e(83684),En=e(57752),yt=e(13102),At=e(64765),Kt=e(87978),Jt=e(77014),Mt=e(47097),Je=e(51253),Nn=e(87266),xn=e(16504),Fn=e(55852),wn=e(19727),Wn=e(27746),da=e(15068),oa=e(51986),_n=e(84349),Wa=e(50720),za=e(72109),_a=e(94753),Xa=e(90613),Va=e(67061),Cs=e(71259),ns=e(68402),Is=e(60029),ls=e(88575),ss=e(17408),Fs=e(84167),Ts=e(72093),Es=e(14186),gs=e(63056),ps=e(76892),js=e(39268),As=e(95984),Qr=e(23731),nr=e(21594),hr=e(88824),ar=e(62883),Yr=e.n(ar),Qs={};for(const Ao in ar)["default","Icon","IconButton","ConfirmButton","DeleteButton","Tooltip","PopoverController","Popover","Toggletip","Portal","getPortalContainer","PortalContainer","CustomScrollbar","TabbedContainer","ClipboardButton","Cascader","ButtonCascader","InlineToast","LoadingPlaceholder","LoadingBar","ColorPicker","SeriesColorPicker","ColorPickerInput","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","EmptySearchResult","EmptyState","UnitPicker","StatsPicker","RefreshPicker","defaultIntervals","TimeRangePicker","TimePickerTooltip","TimeRangeLabel","TimeOfDayPicker","TimeZonePicker","WeekStartPicker","DatePicker","DatePickerWithInput","DateTimePicker","List","InteractiveTable","TagsInput","AutoSaveField","Pagination","Tag","TagList","FilterPill","ConfirmModal","QueryField","CodeEditor","ReactMonacoEditor","CodeEditorSuggestionItemKind","variableSuggestionToCodeEditorSuggestion","Modal","ModalHeader","ModalTabsHeader","ModalTabContent","ModalsProvider","ModalRoot","ModalsController","ModalsContext","PageToolbar","SetInterval","Table","TableInputCSV","TabsBar","Tab","VerticalTab","TabContent","Counter","RenderUserContentAsHTML","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Sparkline","Gauge","BarGauge","VizTooltip","VizTooltipContainer","SeriesTable","SeriesTableRow","VizRepeater","PanelChrome","PanelChromeLoadingIndicator","PanelContextProvider","PanelContextRoot","usePanelContext","VizLayout","SeriesVisibilityChangeBehavior","VizLegend","VizLegendListItem","Alert","GraphSeriesToggler","Collapse","ControlledCollapse","CollapsableSection","DataLinkButton","FieldLinkList","FullWidthButtonContainer","ClickOutsideWrapper","CallToActionCard","ContextMenu","Menu","MenuGroup","MenuItem","WithContextMenu","DataLinksInlineEditor","DataLinkInput","DataLinksContextMenu","SeriesIcon","InfoBox","FeatureInfoBox","FeatureBadge","JSONFormatter","JsonExplorer","ErrorBoundary","ErrorBoundaryAlert","withErrorBoundary","ErrorWithStack","DataSourceHttpSettings","CustomHeadersSettings","AlertingSettings","SecureSocksProxySettings","TLSAuthSettings","CertificationKey","Spinner","FadeTransition","SlideOutTransition","Segment","SegmentAsync","SegmentInput","SegmentSelect","SegmentSection","Drawer","Slider","RangeSlider","Form","sharedInputStyle","InputControl","Button","LinkButton","ButtonGroup","clearButtonStyles","ToolbarButton","ToolbarButtonRow","ValuePicker","fieldMatchersUI","Link","TextLink","Text","Box","Stack","Grid","Space","Label","Field","Legend","FieldSet","FieldValidationMessage","InlineField","InlineSegmentGroup","InlineLabel","InlineFieldRow","FieldArray","resetSelectStyles","getSelectStyles","HorizontalGroup","VerticalGroup","Container","Badge","RadioButtonGroup","RadioButtonList","Input","getInputStyles","AutoSizeInput","FilterInput","Switch","InlineSwitch","Checkbox","TextArea","FileUpload","TimeRangeInput","RelativeTimeRangePicker","Card","getCardStyles","CardContainer","FormattedValueDisplay","ButtonSelect","Dropdown","PluginSignatureBadge","UserIcon","Avatar","InlineFormLabel","Divider","getDragStyles","useSplitter","LegacyForms","LegacyInputStatus","ScaleDistribution","BarGaugeDisplayMode","UPlotConfigBuilder","UPLOT_AXIS_FONT_SIZE","UPlotChart","PlotLegend","FIXED_UNIT","BrowserLabel","PanelContainer","Graph","GraphWithLegend","GraphContextMenu","GraphContextMenuHeader","graphTimeFormat","graphTickFormatter","GraphNG","TimeSeries","useGraphNGContext","preparePlotFrame","buildScaleKey","ZoomPlugin","TooltipPlugin","convertOldAngularValueMapping","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","MultiSelect","Select","SelectContainer","VirtualizedSelect"].indexOf(Ao)<0&&(Qs[Ao]=()=>ar[Ao]);e.d(I,Qs);var cs=e(66864),_s=e(39938),Ys=e(94354),sr=e(5173),Kr=e(10354),io=e(51440),Mo=e(67647),cr=e(49718),lo=e(7968),Jr=e(15292),co=e(10880),Rr=e(21744),Ho=e(73546),Xr=e(92887),xo=e(54230),Ur=e(5308),Js=e(10860),uo=e(81507),mo=e(9286),fo=e(9261),Vr=e(83122),Oo=e(98624),vr=e(99635),Pt=e(12942),Gt=e(38894),Pn=e(25994),hn=e(69144),Ln=e(21633),Hn=e(52198),kn=e(52622),xa=e(51336),ua=e(30501),ra=e(81297),os=e(24182),Ra=e(96747),es=e(66737),zs=e(52811),Ws=e(88895),Rs=e(54438),xr=e(52494),dr=e(48747),Us=e(5484),$r=e(33083),ks=e(65036),Ka=e(99755),ys=e(18262),Er=e(16998),ds=e(65575),Zr=e(76284),go=e(90606);const Io={SecretFormField:l.L,FormField:t.z,Select:o.l6,AsyncSelect:o.DW,IndicatorsContainer:s.s,NoOptionsMessage:r.l,Input:n.p,Switch:m.d}},31511:(G,I,e)=>{"use strict";e.d(I,{A:()=>o});var t=e(32196),n=e(96540),s=e(86634),r=e(40845);function o(l){const{visible:i,children:u,duration:d=250}=l,p=(0,r.of)(m,d),c=(0,n.useRef)(null);return n.createElement(s.A,{in:i,mountOnEnter:!0,unmountOnExit:!0,timeout:d,classNames:p,nodeRef:c},n.cloneElement(u,{ref:c}))}const m=(l,i)=>({enter:(0,t.css)({label:"enter",opacity:0}),enterActive:(0,t.css)({label:"enterActive",opacity:1,[l.transitions.handleMotion("no-preference","reduce")]:{transition:`opacity ${i}ms ease-out`}}),exit:(0,t.css)({label:"exit",opacity:1}),exitActive:(0,t.css)({label:"exitActive",opacity:0,[l.transitions.handleMotion("no-preference","reduce")]:{transition:`opacity ${i}ms ease-out`}})})},72960:(G,I,e)=>{"use strict";e.d(I,{n:()=>o});var t=e(32196),n=e(96540),s=e(86634),r=e(40845);function o(l){const{visible:i,children:u,duration:d=250,horizontal:p,size:c}=l,y=(0,r.of)(m,d,p?"width":"height",c),f=(0,n.useRef)(null);return n.createElement(s.A,{in:i,mountOnEnter:!0,unmountOnExit:!0,timeout:d,classNames:y,nodeRef:f},n.cloneElement(u,{ref:f}))}const m=(l,i,u,d)=>({enter:(0,t.css)({label:"enter",[`${u}`]:0,opacity:0}),enterActive:(0,t.css)({label:"enterActive",[`${u}`]:`${d}px`,opacity:1,[l.transitions.handleMotion("no-preference")]:{transition:`opacity ${i}ms ease-out, ${u} ${i}ms ease-out`},[l.transitions.handleMotion("reduce")]:{transition:`opacity ${i}ms ease-out`}}),exit:(0,t.css)({label:"exit",[`${u}`]:`${d}px`,opacity:1}),exitActive:(0,t.css)({label:"exitActive",opacity:0,[`${u}`]:0,[l.transitions.handleMotion("no-preference")]:{transition:`opacity ${i}ms ease-out, ${u} ${i}ms ease-out`},[l.transitions.handleMotion("reduce")]:{transition:`opacity ${i}ms ease-out`}})})},81297:(G,I,e)=>{"use strict";e.d(I,{Z:()=>i});var t=e(96540),n=e(36613),s=e(16895),r=e(7650);function o(u,d){return d.width===u.width&&d.height===u.height}function m(u,d){return d.data===u.data}function l(u,d){return d.config===u.config}class i extends t.Component{constructor(d){super(d),this.plotContainer=(0,t.createRef)(),this.plotCanvasBBox=(0,t.createRef)(),this.state={plot:null}}reinitPlot(){let{width:d,height:p,plotRef:c}=this.props;if(this.state.plot?.destroy(),d===0&&p===0)return;this.props.config.addHook("setSize",P=>{P.over});const y={width:Math.floor(this.props.width),height:Math.floor(this.props.height),...this.props.config.getConfig()};(0,s.uY)("UPlot",!1,"Reinitializing plot",y);const f=new n.A(y,this.props.data,this.plotContainer.current);c&&c(f),this.setState({plot:f})}componentDidMount(){this.reinitPlot()}componentWillUnmount(){this.state.plot?.destroy()}componentDidUpdate(d){let{plot:p}=this.state;o(d,this.props)?l(d,this.props)?m(d,this.props)||p?.setData(this.props.data):this.reinitPlot():p?.setSize({width:Math.floor(this.props.width),height:Math.floor(this.props.height)})}render(){return t.createElement("div",{style:{position:"relative"}},t.createElement("div",{ref:this.plotContainer,"data-testid":"uplot-main-div"}),this.props.children)}}},24182:(G,I,e)=>{"use strict";e.d(I,{$:()=>d,t:()=>u});var t=e(96540),n=e(28240),s=e(8066),r=e(52622),o=e(40845),m=e(67266),l=e(96516),i=e(16895);function u(p,c){return p.getSeries().some(y=>{const f=y.props.dataFrameFieldIndex;if(!f)return!1;const P=c[f.frameIndex]?.fields[f.fieldIndex];return!(!P||P.config.custom?.hideFrom?.legend)})}const d=t.memo(({data:p,config:c,placement:y,calcs:f,displayMode:P,...a})=>{const E=(0,o.$j)(),g=c.getSeries().map(h=>{const D=h.props,v=D.dataFrameFieldIndex,C=c.getAxisPlacement(h.props.scaleKey);if(!v)return;const T=p[v.frameIndex]?.fields[v.fieldIndex];if(!T||T.config.custom?.hideFrom?.legend)return;const S=(0,n.Ct)(T,p[v.frameIndex],p),x=(0,s.lz)(T,E).color;return{disabled:!(D.show??!0),fieldIndex:v,color:x,label:S,yAxis:C===r.vM.Left||C===r.vM.Bottom?1:2,getDisplayValues:()=>(0,i.UO)(f,T,E),getItemKey:()=>`${S}-${v.frameIndex}-${v.fieldIndex}`,lineStyle:D.lineStyle}}).filter(h=>h!==void 0);return t.createElement(m.KU.Legend,{placement:y,...a},t.createElement(l.t,{placement:y,items:g,displayMode:P,sortBy:a.sortBy,sortDesc:a.sortDesc,isSortable:!0}))});d.displayName="PlotLegend"},52198:(G,I,e)=>{"use strict";e.d(I,{t:()=>n});var t=e(52622);const n={drawStyle:[{label:"Lines",value:t.GR.Line},{label:"Bars",value:t.GR.Bars},{label:"Points",value:t.GR.Points}],lineInterpolation:[{description:"Linear",value:t.dx.Linear,icon:"gf-interpolation-linear"},{description:"Smooth",value:t.dx.Smooth,icon:"gf-interpolation-smooth"},{description:"Step before",value:t.dx.StepBefore,icon:"gf-interpolation-step-before"},{description:"Step after",value:t.dx.StepAfter,icon:"gf-interpolation-step-after"}],barAlignment:[{description:"Before",value:t.Nj.Before,icon:"gf-bar-alignment-before"},{description:"Center",value:t.Nj.Center,icon:"gf-bar-alignment-center"},{description:"After",value:t.Nj.After,icon:"gf-bar-alignment-after"}],showPoints:[{label:"Auto",value:t.yL.Auto,description:"Show points when the density is low"},{label:"Always",value:t.yL.Always},{label:"Never",value:t.yL.Never}],axisPlacement:[{label:"Auto",value:t.vM.Auto,description:"First field on the left, everything else on the right"},{label:"Left",value:t.vM.Left},{label:"Right",value:t.vM.Right},{label:"Hidden",value:t.vM.Hidden}],fillGradient:[{label:"None",value:t.on.None},{label:"Opacity",value:t.on.Opacity,description:"Enable fill opacity gradient"},{label:"Hue",value:t.on.Hue,description:"Small color hue gradient"},{label:"Scheme",value:t.on.Scheme,description:"Use color scheme to define gradient"}],stacking:[{label:"Off",value:t.gs.None},{label:"Normal",value:t.gs.Normal},{label:"100%",value:t.gs.Percent}],thresholdsDisplayModes:[{label:"Off",value:t.Ly.Off},{label:"As lines",value:t.Ly.Line},{label:"As lines (dashed)",value:t.Ly.Dashed},{label:"As filled regions",value:t.Ly.Area},{label:"As filled regions and lines",value:t.Ly.LineAndArea},{label:"As filled regions and lines (dashed)",value:t.Ly.DashedAndArea}]}},30501:(G,I,e)=>{"use strict";e.d(I,{Zj:()=>c,pi:()=>u,zH:()=>p});var t=e(83195),n=e(97706),s=e(42994),r=e(72724),o=e(52622),m=e(29413),l=e(52811),i=e(93060);const u=12,d=8;class p extends l.R{merge(a){this.props.size=(0,i.Y)("max",this.props.size,a.size),this.props.label||(this.props.label=a.label),this.props.placement===o.vM.Auto&&(this.props.placement=a.placement)}calculateSpace(a,E,g,h,D){const v=a.axes[E],C=a.scales[v.scale];if(v.side!==2||!C)return 30;const T=40;if(C.time){const S=D/T,O=(h-g)/S,x=y(a,[g],E,T,O);return(0,m.kD)(x[0],u).width+18}return T}calculateAxisSize(a,E,g){const h=a.axes[g];let D=h.ticks.size;if(h.side===2)D+=h.gap+u;else if(E?.length){let v=E.reduce((T,S)=>Math.max(T,(0,m.kD)(S,u).width),0);const C=Math.min(a.width*.4,v);D+=h.gap+h.labelGap+C}return Math.ceil(D)}getConfig(){let{scaleKey:a,label:E,show:g=!0,placement:h=o.vM.Auto,grid:D={show:!0},ticks:v,space:C,filter:T,gap:S=5,formatValue:O,splits:x,values:b,incrs:M,isTime:A,timeZone:R,theme:B,tickLabelRotation:U,size:W,color:N,border:w,decimals:L,distr:V=o.L4.Linear}=this.props;const K=`${u}px ${B.typography.fontFamily}`,k=B.isDark?"rgba(240, 250, 255, 0.09)":"rgba(0, 10, 23, 0.09)";(0,t.j9)(a)&&(x=[0,1]),L===0&&V===o.L4.Linear&&(T=(H,J)=>J.map(X=>Number.isInteger(X)?X:null));let j={scale:a,show:g,stroke:N??B.colors.text.primary,side:f(h),font:K,size:W??((H,J,X)=>this.calculateAxisSize(H,J,X)),rotate:U,gap:S,labelGap:0,grid:{show:D.show,stroke:k,width:1/devicePixelRatio},ticks:Object.assign({show:!0,stroke:w?.show?N??B.colors.text.primary:k,width:1/devicePixelRatio,size:4},v),splits:x,values:b,space:C??((H,J,X,se,ae)=>this.calculateSpace(H,J,X,se,ae)),filter:T,incrs:M};return w?.show&&(j.border={stroke:N??B.colors.text.primary,width:1/devicePixelRatio,...w}),E!=null&&E.length>0&&(j.label=E,j.labelSize=u+d,j.labelFont=K,j.labelGap=d),b?j.values=b:A?j.values=y:O&&(j.values=(H,J,X,se,ae)=>{let ne=(0,n.E)((0,n.h)(ae,6));return J.map(q=>O(q,ne>0?ne:void 0))}),j.timeZone=R,j}}const c={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:28*24*60*60*1e3,year:365*24*60*60*1e3};function y(P,a,E,g,h){const D=P.axes[E],v="timeZone"in D&&typeof D.timeZone=="string"?D.timeZone:void 0,C=P.scales.x,T=(C?.max??0)-(C?.min??0),S=Math.round(c.year/c.day)*c.day,O=Math.round(h/c.day)*c.day;let x=s.WC.interval.year;return h<c.second?x=s.WC.interval.millisecond:h<=c.minute?x=s.WC.interval.second:T<=c.day?x=s.WC.interval.minute:h<=c.day?x=s.WC.interval.hour:T<c.year?x=s.WC.interval.day:O===S?x=s.WC.interval.year:h<=c.year&&(x=s.WC.interval.month),a.map(b=>b==null?"":(0,r.LE)(b,{format:x,timeZone:v}))}function f(P){switch(P){case o.vM.Top:return 0;case o.vM.Right:return 1;case o.vM.Bottom:return 2;case o.vM.Left:}return 3}},51336:(G,I,e)=>{"use strict";e.d(I,{e:()=>D});var t=e(2543),n=e(36613),s=e(43127),r=e(91410),o=e(52622),m=e(16895),l=e(30501),i=e(93060),u=e(24293),d=e(23596),p=e(52811),c=e(74863);class y extends p.R{getConfig(){const{facets:C,drawStyle:T,pathBuilder:S,pointsBuilder:O,pointsFilter:x,lineInterpolation:b,lineWidth:M,lineStyle:A,barAlignment:R,barWidthFactor:B,barMaxWidth:U,showPoints:W,pointSize:N,scaleKey:w,pxAlign:L,spanNulls:V,show:K=!0}=this.props;let k={},j=this.getLineColor();k.stroke=j,k.width=M,A&&A.fill!=="solid"&&(A.fill==="dot"&&(k.cap="round"),k.dash=A.dash??[10,10]),S!=null?k.paths=S:T===o.GR.Points?k.paths=()=>null:T!=null&&(k.paths=(X,se,ae,ne)=>P(T,b,R,B,U)(X,se,ae,ne));const H=typeof j=="string"?j:(X,se)=>X.series[se]._stroke,J={points:{stroke:H,fill:H,size:!N||N<M?void 0:N,filter:x}};return O!=null?J.points.show=O:T===o.GR.Points?J.points.show=!0:W===o.yL.Auto?T===o.GR.Bars&&(J.points.show=!1):W===o.yL.Never?J.points.show=!1:W===o.yL.Always&&(J.points.show=!0),{scale:w,facets:C,spanGaps:typeof V=="number"?!1:V,value:()=>"",pxAlign:L,show:K,fill:this.getFill(),...k,...J}}getLineColor(){const{lineColor:C,gradientMode:T,colorMode:S,thresholds:O,theme:x,hardMin:b,hardMax:M,softMin:A,softMax:R,dynamicSeriesColor:B}=this.props;return T===o.on.None&&B?(U,W)=>B(W)??C??u.F:T===o.on.Scheme&&S?.id!==u.Y.Fixed?(0,c.pl)(1,x,S,O,b,M,A,R):T===o.on.Hue?(0,c.B5)(C??u.F,1,x):C??u.F}getFill(){const{lineColor:C,fillColor:T,gradientMode:S,fillOpacity:O,colorMode:x,thresholds:b,theme:M,hardMin:A,hardMax:R,softMin:B,softMax:U,dynamicSeriesColor:W}=this.props;if(T)return T;const N=S??o.on.None,w=(O??0)/100;if(N===o.on.None&&W&&w>0)return(L,V)=>{let K=L.series[V]._stroke;return d.alpha(K??"",w)};switch(N){case o.on.Opacity:return(0,c.WO)(T??C,w);case o.on.Hue:return(0,c.B5)(T??C,w,M);case o.on.Scheme:if(x?.id!==u.Y.Fixed)return(0,c.pl)(w,M,x,b,A,R,B,U);default:if(w>0)return d.alpha(C??"",w)}}}let f;function P(v,C,T=o.Nj.Center,S=.6,O=200){const x=n.A.paths;if(f||(f={linear:x.linear(),smooth:x.spline(),stepBefore:x.stepped({align:-1}),stepAfter:x.stepped({align:1})}),v===o.GR.Bars){let b=`bars|${T}|${S}|${O}`;return f[b]||(f[b]=x.bars({size:[S,O],align:T})),f[b]}else if(v===o.GR.Line){if(C===o.dx.StepBefore)return f.stepBefore;if(C===o.dx.StepAfter)return f.stepAfter;if(C===o.dx.Smooth)return f.smooth}return f.linear}var a=e(84140),E=e(50082);function g(v){const C=v.config.mode===o.Ly.Dashed||v.config.mode===o.Ly.DashedAndArea?[10,10]:[];function T(W,N,w,L){let V=W.ctx,K=0;for(let k=0;k<w.length;k++)if(w[k].color==="transparent"){K=k;break}V.lineWidth=2,V.setLineDash(C);for(let k=1;k<w.length;k++){const j=w[k];let H;K>=k&&k>0?H=(0,a.A)(L.visualization.getColorByName(w[k-1].color)):H=(0,a.A)(L.visualization.getColorByName(j.color)),H.getAlpha()===1&&H.setAlpha(.7);let J=Math.round(W.bbox.left),X=Math.round(W.valToPos(j.value,N,!0)),se=Math.round(W.bbox.left+W.bbox.width),ae=Math.round(W.valToPos(j.value,N,!0));V.beginPath(),V.moveTo(J,X),V.lineTo(se,ae),V.strokeStyle=H.toString(),V.stroke()}}function S(W,N,w,L){let V=W.ctx,K=(0,c.Z8)(W,N,w.map(k=>{let j=(0,a.A)(L.visualization.getColorByName(k.color));return j.getAlpha()===1&&j.setAlpha(.15),[k.value,j.toString()]}),!0);V.fillStyle=K,V.fillRect(W.bbox.left,W.bbox.top,W.bbox.width,W.bbox.height)}const{scaleKey:O,thresholds:x,theme:b,config:M,hardMin:A,hardMax:R,softMin:B,softMax:U}=v;return W=>{const N=W.ctx,{min:w,max:L}=W.scales.x,{min:V,max:K}=W.scales[O];if(w==null||L==null||V==null||K==null)return;let{steps:k,mode:j}=x;if(j===E.O.Percentage){let[H,J]=(0,c.EJ)(W,O,A,R,B,U),X=J-H;k=k.map(se=>({...se,value:H+X*(se.value/100)}))}switch(N.save(),M.mode){case o.Ly.Line:case o.Ly.Dashed:T(W,O,k,b);break;case o.Ly.Area:S(W,O,k,b);break;case o.Ly.LineAndArea:case o.Ly.DashedAndArea:S(W,O,k,b),T(W,O,k,b)}N.restore()}}const h={drag:{setScale:!1},points:{size:(v,C)=>v.series[C].points.size*2,width:(v,C,T)=>T/4},focus:{prox:30}};class D{constructor(C=s.lE){this.uid=Math.random().toString(36).slice(2),this.series=[],this.axes={},this.scales=[],this.bands=[],this.stackingGroups=[],this.hasLeftAxis=!1,this.hooks={},this.tz=void 0,this.mode=1,this.frames=void 0,this.thresholds={},this.padding=void 0,this.prepData=void 0,this.scaleKeys=["",""],this.tzDate=T=>{let S=new Date(T);return this.tz?n.A.tzDate(S,this.tz):S},this.tz=(0,r.QZ)(C,Date.now())?.ianaName}addHook(C,T){(0,m.uY)("UPlotConfigBuilder",!1,"addHook",C),this.hooks[C]||(this.hooks[C]=[]),this.hooks[C].push(T)}addThresholds(C){this.thresholds[C.scaleKey]||(this.thresholds[C.scaleKey]=C,this.addHook("drawClear",g(C)))}addAxis(C){C.placement=C.placement??o.vM.Auto,C.grid=C.grid??{};let T=C.scaleKey;if(T==="x"&&(T+=C.timeZone??""),this.axes[T]){this.axes[T].merge(C);return}C.placement===o.vM.Auto&&(C.placement=this.hasLeftAxis?o.vM.Right:o.vM.Left),C.placement===o.vM.Left&&(this.hasLeftAxis=!0),C.placement===o.vM.Hidden&&(C.grid.show=!1,C.size=0),this.axes[T]=new l.zH(C)}getAxisPlacement(C){return this.axes[C]?.props.placement??o.vM.Left}setCursor(C){this.cursor=(0,t.merge)({},this.cursor,C)}setMode(C){this.mode=C}setSelect(C){this.select=C}addSeries(C){this.series.push(new y(C))}getSeries(){return this.series}addScale(C){const T=this.scales.find(S=>S.props.scaleKey===C.scaleKey);if(T){T.merge(C);return}this.scales.push(new i.G(C))}addBand(C){this.bands.push(C)}setStackingGroups(C){this.stackingGroups=C}getStackingGroups(){return this.stackingGroups}setPrepData(C){this.prepData=T=>(this.frames=T,C(T,this.getStackingGroups()))}setPadding(C){this.padding=C}getConfig(){if(this.cachedConfig)return this.cachedConfig;const C={...m.NN,mode:this.mode,series:[this.mode===2?null:{value:()=>""}]};C.axes=this.ensureNonOverlappingAxes(Object.values(this.axes)).map(S=>S.getConfig()),C.series=[...C.series,...this.series.map(S=>S.getConfig())],C.scales=this.scales.reduce((S,O)=>({...S,...O.getConfig()}),{}),C.hooks=this.hooks,C.select=this.select;const T=(S="")=>(O,x)=>{let b=O.series[x].points._stroke;if(typeof b!="string"){let M=this.frames[0].fields[x];b=M.display(M.values[O.cursor.idxs[x]]).color}return b+S};return C.cursor=(0,t.merge)({},h,{points:{stroke:T("80"),fill:T()}},this.cursor),C.tzDate=this.tzDate,Array.isArray(this.padding)&&(C.padding=this.padding),this.stackingGroups.forEach(S=>{(0,m.Tz)(S).forEach(O=>{this.addBand(O)})}),this.bands.length&&(C.bands=this.bands),this.cachedConfig=C,C}ensureNonOverlappingAxes(C){const T=C.find(x=>x.props.scaleKey==="x"),S=C.filter(x=>x.props.grid?.show===void 0),O=S.findIndex(x=>x.props.placement===o.vM.Left||x.props.placement===o.vM.Right||x.props.placement===o.vM.Bottom&&x!==T);for(let x=0;x<S.length;x++)S[x]===T||x===O?S[x].props.grid.show=!0:S[x].props.grid.show=!1;return C}}},93060:(G,I,e)=>{"use strict";e.d(I,{G:()=>m,Y:()=>l});var t=e(36613),n=e(77678),s=e(83195),r=e(52622),o=e(52811);class m extends o.R{merge(u){this.props.min=l("min",this.props.min,u.min),this.props.max=l("max",this.props.max,u.max)}getConfig(){let{isTime:u,scaleKey:d,min:p,max:c,softMin:y,softMax:f,range:P,direction:a,orientation:E,centeredZero:g,decimals:h}=this.props;const D=this.props.distribution,v=u?{}:{distr:D===r.L4.Symlog?4:D===r.L4.Log?3:D===r.L4.Ordinal?2:1,log:D===r.L4.Log||D===r.L4.Symlog?this.props.log??2:void 0,asinh:D===r.L4.Symlog?this.props.linearThreshold??1:void 0};if(D===r.L4.Log){let R=this.props.log,B=R===2?Math.log2:Math.log10;p!=null&&(p<=0?p=null:p=R**Math.floor(B(p))),c!=null&&(c<=0?c=null:c=R**Math.ceil(B(c))),y!=null&&(y<=0?y=null:y=R**Math.floor(B(y))),f!=null&&(f<=0?f=null:f=R**Math.ceil(B(f)))}let C=y==null?3:1,T=f==null?3:1;const S={min:{pad:.1,hard:p??-1/0,soft:y||0,mode:C},max:{pad:.1,hard:c??1/0,soft:f||0,mode:T}};let O=y==null&&p!=null,x=f==null&&c!=null,b=O&&x;const M=(R,B,U,W)=>{const N=R.scales[W];let w=[B,U];if(!b&&B==null&&U==null)return w;let L=N.log??10;if(N.distr===1||N.distr===2||N.distr===4){if(g){let V=Math.abs(B),K=Math.abs(U),k=Math.max(V,K);k===0&&(k=80),B=-k,U=k}N.distr===4?w=t.A.rangeAsinh(B,U,L,!0):w=t.A.rangeNum(O?p:B,x?c:U,S)}else N.distr===3&&(w=t.A.rangeLog(p??B,c??U,L,!0));if(h===0)if(N.distr===1||N.distr===2)w[0]=(0,n.rs)(w[0],1),w[1]=(0,n.Uh)(w[1],1);else if(N.distr===3){let V=N.log===2?Math.log2:Math.log10;if(w[0]<=1)w[0]=1;else{let k=Math.floor(V(w[0]));w[0]=L**k}let K=Math.ceil(V(w[1]));w[1]=L**K,w[0]===w[1]&&(w[1]*=L)}else N.distr===4&&(w[0]=(0,n.rs)(w[0],1),w[1]=(0,n.Uh)(w[1],1));return(N.distr===1||N.distr===4)&&(O&&(w[0]=p),x&&(w[1]=c)),w[0]>=w[1]&&(w[0]=N.distr===3?1:0,w[1]=100),w};let A=!u&&!b;return(0,s.j9)(d)&&(A=!1,P=[0,1]),{[d]:{time:u,auto:A,range:P??M,dir:a,ori:E,...v}}}}function l(i,u,d){const p=u!=null,c=d!=null;return p?c?i==="min"?u<d?u:d:u>d?u:d:u:d}},74863:(G,I,e)=>{"use strict";e.d(I,{B5:()=>u,EJ:()=>y,WO:()=>i,Z8:()=>p,pl:()=>P});var t=e(84140),n=e(23596),s=e(24293),r=e(50082),o=e(52622),m=e(29413);function l(a,E,g){let h=0,D=0,v=0,C=0;return a===3?(D=E.top,C=E.top+E.height):a===2?(h=E.left+E.width,v=E.left):a===1?(D=E.top+E.height,C=E.top):a===0&&(h=E.left,v=E.left+E.width),g.createLinearGradient(h,D,v,C)}function i(a,E){return(g,h)=>{const D=(0,m.Yc)(),v=l(g.scales.x.ori===o.Lt.Horizontal?3:2,g.bbox,D);return v.addColorStop(0,n.alpha(a,E)),v.addColorStop(1,n.alpha(a,0)),v}}function u(a,E,g){return(h,D)=>{const v=(0,m.Yc)(),C=l(h.scales.x.ori===o.Lt.Horizontal?3:2,h.bbox,v),T=(0,t.A)(a).spin(-25).darken(5),S=(0,t.A)(a).saturate(20).spin(20).brighten(10);return g.isDark?(C.addColorStop(0,S.lighten(10).setAlpha(E).toString()),C.addColorStop(1,T.darken(10).setAlpha(E).toString())):(C.addColorStop(0,S.lighten(10).setAlpha(E).toString()),C.addColorStop(1,T.setAlpha(E).toString())),C}}var d=(a=>(a[a.Right=0]="Right",a[a.Up=1]="Up",a[a.Left=2]="Left",a[a.Down=3]="Down",a))(d||{});function p(a,E,g,h=!1){let D=a.scales[E],v=null,C=null;for(let w=0;w<g.length;w++){let L=g[w][0];if((L<=D.min||v==null)&&(v=w),C=w,L>=D.max)break}if(v===C)return g[v][1];let T=g[v][0],S=g[C][0];T===-1/0&&(T=D.min),S===1/0&&(S=D.max);let O=Math.round(a.valToPos(T,E,!0)),x=Math.round(a.valToPos(S,E,!0)),b=O-x;if(b===0)return g[C][1];let M,A,R,B;a.scales.x.ori===o.Lt.Horizontal?(M=R=0,A=O,B=x):(A=B=0,M=O,R=x);let W=(0,m.Yc)().createLinearGradient(M,A,R,B),N;for(let w=v;w<=C;w++){let L=g[w],V=w===v?O:w===C?x:Math.round(a.valToPos(L[0],E,!0)),K=(O-V)/b;h&&w>v&&W.addColorStop(K,N),W.addColorStop(K,N=L[1])}return W}function c(a,E){let g=a.scales[E],h=1/0,D=-1/0;return a.series.forEach((v,C)=>{if(v.show&&v.scale===E)if(v.min==null){let T=a.data[C];for(let S=0;S<T.length;S++)T[S]!=null&&(h=Math.min(h,T[S]),D=Math.max(D,T[S]))}else h=Math.min(h,v.min),D=Math.max(D,v.max)}),D===h&&(h=g.min,D=g.max),[h,D]}function y(a,E,g,h,D,v){let C=g??D??null,T=h??v??null;if(C==null||T==null){let[S,O]=c(a,E);C=C??S??0,T=T??O??100}return[C,T]}function f(a){return a==="transparent"||a[0]==="#"&&a.slice(-2)==="00"}function P(a,E,g,h,D,v,C,T){if(!g)throw Error("Missing colorMode required for color scheme gradients");if(!h)throw Error("Missing thresholds required for color scheme gradients");return(S,O)=>{let x=S.series[O].scale,b="";if(g.id===s.Y.Thresholds)if(h.mode===r.O.Absolute){const M=h.steps.map(A=>[A.value,f(A.color)?"#0000":n.alpha(E.visualization.getColorByName(A.color),a)]);b=p(S,x,M,!0)}else{const[M,A]=y(S,x,D,v,C,T),R=A-M,B=h.steps.map(U=>[M+R*(U.value/100),n.alpha(E.visualization.getColorByName(U.color),a)]);b=p(S,x,B,!0)}else if(g.getColors){const M=g.getColors(E),[A,R]=y(S,x,D,v,C,T),B=R-A,U=M.map((W,N)=>[A+B*(N/(M.length-1)),n.alpha(E.visualization.getColorByName(W),a)]);b=p(S,x,U,!1)}return b}}},78226:(G,I,e)=>{"use strict";e.d(I,{a:()=>o});var t=e(96540),n=e(1604),s=e(6967),r=e(97620);function o({id:m,events:l,renderEventMarker:i,mapEventToXYCoords:u,config:d}){const p=(0,t.useRef)(),[c,y]=(0,t.useState)(0),f=(0,n.A)();(0,t.useLayoutEffect)(()=>{d.addHook("init",a=>{p.current=a}),d.addHook("draw",()=>{f()&&y(a=>a+1)})},[d,y]);const P=(0,t.useMemo)(()=>{const a=[];if(!p.current||l.length===0)return a;for(let E=0;E<l.length;E++){const g=l[E];for(let h=0;h<g.length;h++){const D=u(g,{fieldIndex:h,frameIndex:E});D&&a.push(t.createElement(s.p,{...D,key:`${m}-marker-${E}-${h}`},i(g,{fieldIndex:h,frameIndex:E})))}}return t.createElement(t.Fragment,null,a)},[l,i,c]);return p.current?t.createElement(r._,{left:p.current.bbox.left/window.devicePixelRatio,top:p.current.bbox.top/window.devicePixelRatio},P):null}},6967:(G,I,e)=>{"use strict";e.d(I,{p:()=>n});var t=e(96540);const n=({x:s,y:r,children:o})=>t.createElement("div",{style:{position:"absolute",top:`${r}px`,left:`${s}px`}},o)},97620:(G,I,e)=>{"use strict";e.d(I,{_:()=>s});var t=e(32196),n=e(96540);const s=({children:r,left:o,top:m})=>{const l=(0,n.useMemo)(()=>(0,t.css)({position:"absolute",overflow:"visible",left:`${o}px`,top:`${m}px`}),[o,m]);return n.createElement("div",{className:l},r)}},96747:(G,I,e)=>{"use strict";e.d(I,{_X:()=>s._,a:()=>t.a,pH:()=>n.p});var t=e(78226),n=e(6967),s=e(97620)},55129:(G,I,e)=>{"use strict";e.d(I,{M:()=>s});var t=e(52622),n=e(52811);function s(o,m){const l="na",i=`${o.min!==void 0?o.min:l}-${o.max!==void 0?o.max:l}`,u=`${o.custom?.axisSoftMin!==void 0?o.custom.axisSoftMin:l}-${o.custom?.axisSoftMax!==void 0?o.custom.axisSoftMax:l}`,d=`${o.custom?.axisPlacement!==void 0?o.custom?.axisPlacement:t.vM.Auto}`,p=o.unit??n.s,c=o.custom?.scaleDistribution?r(o.custom.scaleDistribution):t.L4.Linear,y=o.custom?.axisLabel?o.custom.axisLabel:l;return`${p}/${i}/${u}/${d}/${c}/${y}/${m}`}function r(o){return o.type===t.L4.Log?`${o.type}${o.log}`:o.type}},68268:(G,I,e)=>{"use strict";e.d(I,{K:()=>i});var t=e(2543),n=e.n(t),s=e(96540),r=e(64423),o=e(99165),m=e(69129),l=e(26272);const i=({config:u,eventBus:d,frame:p})=>{const c=(0,s.useRef)(p);return c.current=p,(0,s.useLayoutEffect)(()=>{let y=null;const f={point:{time:null},data:c.current};u.addHook("init",C=>{y=C});let P=null;u.addHook("setSeries",(C,T)=>{P=T}),u.addHook("setLegend",()=>{if(!(y.cursor.event==null)){let T=y.cursor.idxs.find(S=>S!=null);if(T==null)v();else{let S=T,O=P,x=y.data[0]??y.data[1][0];f.point.time=x[S],f.rowIndex=S??void 0,f.columnIndex=O??void 0,f.data=c.current;let b=y.cursor.top;f.point.panelRelY=b===0?.001:b>0?b/y.rect.height:1,D()}}});function a(C){const T=C.payload?.point?.time;if(T){const S=y.valToPos(T,"x");y.setCursor({left:S,top:y.rect.height/2})}}const E=new r.yU,g=new m.b_(f).setTags(["uplot"]),h=new m.ql().setTags(["uplot"]);let D=(0,t.throttle)(()=>{d.publish(g)},100),v=(0,t.throttle)(()=>{d.publish(h)},100);return E.add(d.getStream(m.b_).subscribe({next:C=>{d===C.origin||C.tags?.has("uplot")||a(C)}})),E.add(d.getStream(l.kb).subscribe({next:C=>a(C)})),E.add(d.getStream(m.ql).pipe((0,o.c)(50)).subscribe({next:C=>{d===C.origin||C.tags?.has("uplot")||y.cursor._lock||y.setCursor({left:-10,top:-10})}})),()=>{E.unsubscribe()}},[u]),null}},23117:(G,I,e)=>{"use strict";e.d(I,{Z:()=>i});var t=e(2543),n=e.n(t),s=e(96540);const r=.1,o=2,m=new Set(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Shift"," "]),l=u=>{let d=u.root,p=new Set,c=null,y=null;if(!d)return;d.tabIndex=0;const f=(v,C)=>{const{cursor:T}=u;if(T.left===void 0||T.top===void 0)return;const{width:S,height:O}=u.over.style,[x,b]=[Math.floor(parseFloat(S)),Math.floor(parseFloat(O))];u.setCursor({left:(0,t.clamp)(T.left+v,0,x),top:(0,t.clamp)(T.top+C,0,b)})},P=v=>{if(p.size===0||!u){y=null;return}const S=(v-(y??v))*r;let O=0,x=0;p.has("ArrowUp")&&(x-=S),p.has("ArrowDown")&&(x+=S),p.has("ArrowLeft")&&(O-=S),p.has("ArrowRight")&&(O+=S),p.has("Shift")&&(O*=o,x*=o),f(O,x);const{cursor:b}=u;if(p.has(" ")&&b){const M=Number(u.over.style.height.slice(0,-2));u.setSelect({left:b.left<c?b.left:c,top:0,width:Math.abs(b.left-(c??b.left)),height:M},!1)}y=v,window.requestAnimationFrame(P)},a=v=>{if(v.key==="Tab"){u.setCursor({left:-5,top:-5});return}if(!m.has(v.key))return;if(v.preventDefault(),v.stopPropagation(),!p.has(v.key)){const T=p.size===0;p.add(v.key),c=v.key===" "&&c===null?u.cursor.left:c,T&&window.requestAnimationFrame(P)}},E=v=>{m.has(v.key)&&(p.delete(v.key),v.key===" "&&(v.preventDefault(),v.stopPropagation(),u.setSelect(u.select),c=null))},g=()=>{if(!d?.matches(":focus-visible"))return;const v=parseFloat(u.over.style.width),C=parseFloat(u.over.style.height);u.setCursor({left:v/2,top:C/2})},h=()=>{y=null,c=null,p.clear(),u.setSelect({left:0,top:0,width:0,height:0},!1)};d.addEventListener("keydown",a),d.addEventListener("keyup",E),d.addEventListener("focus",g),d.addEventListener("blur",h);const D=()=>{d?.removeEventListener("keydown",a),d?.removeEventListener("keyup",E),d?.removeEventListener("focus",g),d?.removeEventListener("blur",h),d=null};(u.hooks.destroy??=[]).push(D)},i=({config:u})=>((0,s.useLayoutEffect)(()=>u.addHook("init",l),[u]),null)},77455:(G,I,e)=>{"use strict";e.d(I,{b3:()=>c,xl:()=>E});var t=e(32196),n=e(96540),s=e(40961),r=e(73134),o=e(40845),m=e(17464),l=e(29158);const i=({onClick:h,"aria-label":D,style:v})=>{const C=(0,o.of)(u);return n.createElement(l.K,{"aria-label":D??"Close",className:C,name:"times",onClick:h,style:v})},u=h=>(0,t.css)({position:"absolute",margin:"0px",right:h.spacing(1),top:h.spacing(1.25)}),d=void 0,p=10;var c=(h=>(h[h.xOne=0]="xOne",h[h.xAll=1]="xAll",h[h.xyOne=2]="xyOne",h))(c||{});function y(h,D){return{...h,...D,style:{...h.style,...D.style}}}function f(){return{style:{transform:"",pointerEvents:"none"},isHovering:!1,isPinned:!1,contents:null,plot:null,dismiss:()=>{}}}const P=5,a=h=>h!=null&&!h.ctrlKey&&!h.metaKey,E=({config:h,hoverMode:D,render:v,clientZoom:C=!1,queryZoom:T,onSelectRange:S,maxWidth:O,syncMode:x=r.yV.Off,syncScope:b="global"})=>{const M=(0,n.useRef)(null),A=(0,n.useRef)(null);A.current==null&&(A.current=(0,m.gF)());const[{plot:R,isHovering:B,isPinned:U,contents:W,style:N,dismiss:w},L]=(0,n.useReducer)(y,null,f),V=(0,n.useRef)(),K=(0,o.of)(g,O),k=(0,n.useRef)(v);return k.current=v,(0,n.useLayoutEffect)(()=>{V.current={width:0,height:0,observer:new ResizeObserver(xe=>{let Ve=V.current;for(const $e of xe)$e.borderBoxSize?.length>0?(Ve.width=$e.borderBoxSize[0].inlineSize,Ve.height=$e.borderBoxSize[0].blockSize):(Ve.width=$e.contentRect.width,Ve.height=$e.contentRect.height)})};let j=!1,H=!1,J=R,X=B,se=!1,ae=U,ne=N,q=!1;const ee=x===r.yV.Tooltip;x!==r.yV.Off&&h.scales[0].props.isTime&&h.setCursor({sync:{key:b,scales:["x",null]}});const z=()=>{Te?X=q&&se&&ee:X=fe!=null||D===1&&se};let te=0,ie=0,ce=null,ue=R?.cursor.idxs.slice(),fe=null,Te=!1,he=!1,de=!1;const le=(xe=!1)=>{he||(X?queueMicrotask(ve):setTimeout(ve,100),he=!0),xe&&(de=!0)},pe=xe=>{M.current.contains(xe.target)||be()},ve=()=>{he=!1,de&&(ne={pointerEvents:ae?"all":"none"},J.cursor._lock=ae,ae?(document.addEventListener("mousedown",pe,!0),document.addEventListener("keydown",pe,!0)):(document.removeEventListener("mousedown",pe,!0),document.removeEventListener("keydown",pe,!0)),de=!1);let xe={style:ne,isPinned:ae,isHovering:X,contents:X||ce!=null?k.current(J,ue,fe,ae,be,ce,Te):null,dismiss:be};L(xe),ce=null},be=()=>{let xe=ae;ae=!1,X=!1,J.setCursor({left:-10,top:-10}),le(xe)};h.addHook("init",xe=>{L({plot:J=xe}),C&&xe.over.addEventListener("mousedown",Ve=>{if(a(Ve)&&Ve.button===0&&Ve.shiftKey){H=!0,xe.cursor.drag.x=!1,xe.cursor.drag.y=!0;let $e=Xe=>{xe.cursor.drag.x=!0,xe.cursor.drag.y=!1,document.removeEventListener("mouseup",$e,!0)};document.addEventListener("mouseup",$e,!0)}},!0),xe.over.addEventListener("click",Ve=>{if(Ve.target===xe.over)if(Ve.ctrlKey||Ve.metaKey){let $e;xe.scales.x.ori===0?$e=xe.posToVal(xe.cursor.left,"x"):$e=xe.posToVal(xe.select.top+xe.select.height,"x"),ce={from:$e,to:$e},le(!1)}else X&&fe!=null&&!ae&&(ae=!0,le(!0))})}),h.addHook("setSelect",xe=>{const Ve=xe.scales.x.ori===0;if(!Te&&(C||T!=null))if(a(xe.cursor.event)){if(S!=null){let $e=[];const Xe=!!xe.cursor.drag.y,gt=!!xe.cursor.drag.x;let Dt=null,nt=[];gt&&(Dt={from:Ve?xe.posToVal(xe.select.left,"x"):xe.posToVal(xe.select.top+xe.select.height,"x"),to:Ve?xe.posToVal(xe.select.left+xe.select.width,"x"):xe.posToVal(xe.select.top,"x")}),Xe&&h.scales.forEach(at=>{const Ae=at.props.scaleKey;if(Ae!=="x"){let re={from:Ve?xe.posToVal(xe.select.top+xe.select.height,Ae):xe.posToVal(xe.select.left+xe.select.width,Ae),to:Ve?xe.posToVal(xe.select.top,Ae):xe.posToVal(xe.select.left,Ae)};nt.push(re)}}),gt?Xe?$e=nt.map(at=>({x:Dt,y:at})):$e=[{x:Dt}]:Xe&&($e=nt.map(at=>({y:at}))),S($e)}else if(C&&H){if(xe.select.height>=P){for(let $e in xe.scales)if($e!=="x"){const Xe=Ve?xe.posToVal(xe.select.top,$e):xe.posToVal(xe.select.left+xe.select.width,$e),gt=Ve?xe.posToVal(xe.select.top+xe.select.height,$e):xe.posToVal(xe.select.left,$e);xe.setScale($e,{min:gt,max:Xe})}j=!0}H=!1}else if(T!=null&&xe.select.width>=P){const $e=Ve?xe.posToVal(xe.select.left,"x"):xe.posToVal(xe.select.top+xe.select.height,"x"),Xe=Ve?xe.posToVal(xe.select.left+xe.select.width,"x"):xe.posToVal(xe.select.top,"x");T({from:$e,to:Xe}),j=!1}}else ce={from:Ve?xe.posToVal(xe.select.left,"x"):xe.posToVal(xe.select.top+xe.select.height,"x"),to:Ve?xe.posToVal(xe.select.left+xe.select.width,"x"):xe.posToVal(xe.select.top,"x")},le(!0);xe.setSelect({left:0,width:0,top:0,height:0},!1)}),(C||T!=null)&&h.setCursor({bind:{dblclick:xe=>()=>{if(!a(xe.cursor.event))return null;if(C&&j){for(let Ve in xe.scales)Ve!=="x"&&xe.setScale(Ve,{min:null,max:null});j=!1}else if(T!=null){let Ve=xe.scales.x;const $e=Ve.min,Xe=Ve.max,gt=(Xe-$e)/2;T({from:$e-gt,to:Xe+gt})}return null}}}),h.addHook("setData",xe=>{j=!1,H=!1,be()}),h.addHook("setSeries",(xe,Ve)=>{fe=Ve,Te=xe.cursor.event==null,z(),le()}),h.addHook("setLegend",xe=>{ue=J?.cursor.idxs.slice(),se=ue.some(($e,Xe)=>Xe>0&&$e!=null),Te=xe.cursor.event==null;let Ve=X;z(),(X||X!==Ve)&&le()});const Oe=16;let Me=0,Ue=0;const we=()=>{X&&!ae&&be(),Me=window.innerWidth-Oe,Ue=window.innerHeight-Oe},Re=()=>{q=J.rect.bottom<=Ue&&J.rect.top>=0&&J.rect.left>=0&&J.rect.right<=Me};we(),h.addHook("ready",Re),h.addHook("setCursor",xe=>{if(Te=xe.cursor.event==null,!X)return;let{left:Ve=-10,top:$e=-10}=xe.cursor;if(Ve>=0||$e>=0){let Xe=xe.rect.left+Ve,gt=xe.rect.top+$e,Dt="",{width:nt,height:at}=V.current;nt+=p,at+=p,ie!==0?gt+at<Ue||gt-at<0?ie=0:ie!==-at&&(ie=-at):gt+at>Ue&&gt-at>=0&&(ie=-at),te!==0?Xe+nt<Me||Xe-nt<0?te=0:te!==-nt&&(te=-nt):Xe+nt>Me&&Xe-nt>=0&&(te=-nt);const Ae=Xe+(te===0?p:-p),re=gt+(ie===0?p:-p);Dt=`translateX(${Ae}px) ${te===0?"":"translateX(-100%)"} translateY(${re}px) ${ie===0?"":"translateY(-100%)"}`,M.current!=null?M.current.style.transform=Dt:(ne.transform=Dt,le())}});const Fe=xe=>{Re(),X&&!ae&&xe.target instanceof HTMLElement&&xe.target.contains(J.root)&&be()};return window.addEventListener("resize",we),window.addEventListener("scroll",Fe,!0),()=>{window.removeEventListener("resize",we),window.removeEventListener("scroll",Fe,!0),document.removeEventListener("mousedown",pe,!0),document.removeEventListener("keydown",pe,!0)}},[h]),(0,n.useLayoutEffect)(()=>{const j=V.current;if(M.current!=null){j.observer.observe(M.current);const{width:H,height:J}=M.current.getBoundingClientRect();j.width=H,j.height=J;const X=R.cursor.event;X!=null?!(performance.now()-X.timeStamp>16)&&R.over.dispatchEvent(X):R.setCursor({left:R.cursor.left,top:R.cursor.top},!0)}else j.width=0,j.height=0},[B]),R&&B?(0,s.createPortal)(n.createElement("div",{className:(0,t.cx)(K.tooltipWrapper,U&&K.pinned),style:N,"aria-live":"polite","aria-atomic":"true",ref:M},U&&n.createElement(i,{onClick:w}),W),A.current):null},g=(h,D)=>({tooltipWrapper:(0,t.css)({top:0,left:0,zIndex:h.zIndex.portal,whiteSpace:"pre",borderRadius:h.shape.radius.default,position:"fixed",background:h.colors.background.primary,border:`1px solid ${h.colors.border.weak}`,boxShadow:h.shadows.z2,userSelect:"text",maxWidth:D??"none"}),pinned:(0,t.css)({boxShadow:h.shadows.z3})})},66737:(G,I,e)=>{"use strict";e.d(I,{Ku:()=>n.K,Z7:()=>s.Z,xl:()=>t.xl});var t=e(77455),n=e(68268),s=e(23117)},52811:(G,I,e)=>{"use strict";e.d(I,{R:()=>n,s:()=>t});const t="__fixed";class n{constructor(r){this.props=r}}},16895:(G,I,e)=>{"use strict";e.d(I,{NN:()=>d,Tz:()=>c,UO:()=>g,bq:()=>f,ro:()=>y,sw:()=>P,uY:()=>D});var t=e(11261),n=e(50311),s=e(75059),r=e(57875),o=e(52622),m=e(40621),l=e(91040),i=e(55129);const u=(v,C,T)=>{let S=C%2?T[0]||T[2]:T[1]||T[3];return T[C]||!S?0:8},d={ms:1,focus:{alpha:1},cursor:{focus:{prox:30}},legend:{show:!1},padding:[u,u,u,u],series:[],hooks:{}};var p=(v=>(v[v.Pos=1]="Pos",v[v.Neg=-1]="Neg",v))(p||{});function c(v){let C=[],{series:T,dir:S}=v,O=T.length-1,x=T.slice().reverse();return x.forEach((b,M)=>{if(M!==O){let A=x[M+1];C.push({series:[b,A],dir:-1*S})}}),C}function y(v){let C=new Map;return v.fields.forEach(({config:T,values:S,type:O},x)=>{if(x===0)return;let{custom:b}=T;if(b==null||b.hideFrom?.viz)return;let{stacking:M}=b;if(M==null)return;let{mode:A,group:R}=M;if(A===o.gs.None)return;let B=b.transform,U=a(B,S),W=b.drawStyle,N=W===o.GR.Bars?b.barAlignment:W===o.GR.Line?b.lineInterpolation:null,w=`${U}|${A}|${R}|${(0,i.M)(T,O)}|${W}|${N}`,L=C.get(w);L==null&&(L={series:[],dir:U},C.set(w,L)),L.series.push(x)}),[...C.values()]}function f(v,C,T){let S=Array(v.fields.length),O=C.length,x=v.length,b=O>0?Array(x).fill(0):[],M=O>0?Array(x).fill(!1):[],A=Array.from({length:O},()=>b.slice()),R=Array.from({length:O},()=>M.slice());if(C.forEach((B,U)=>{let W=R[U];B.series.forEach(N=>{let w=v.fields[N];if(w.config.custom?.hideFrom?.viz)return;let L=w.values;for(let V=0;V<x;V++)L[V]!=null&&(W[V]=!0)})}),v.fields.forEach((B,U)=>{let W=B.values;if(U===0){B.type===t.PU.time?S[0]=(0,n.ks)(B).values:S[0]=W;return}let{custom:N}=B.config;if(!N||N.hideFrom?.viz){S[U]=W;return}if(N.transform===o.NU.Constant){let L=W.findIndex(K=>K!=null),V=W[L];W=Array(W.length).fill(void 0),W[L]=V}else if(W=W.slice(),N.transform===o.NU.NegativeY)for(let L=0;L<W.length;L++)W[L]!=null&&(W[L]*=-1);let w=N.stacking?.mode;if(!w||w===o.gs.None)S[U]=W;else{let L=C.findIndex(j=>j.series.indexOf(U)>-1),V=A[L],K=R[L],k=S[U]=Array(x);for(let j=0;j<x;j++){let H=W[j];H!=null?k[j]=V[j]+=H:k[j]=K[j]?V[j]:H}}}),T){let B=S.map((U,W)=>{let N=C.findIndex(w=>w.series.indexOf(W)>-1);return N!==-1?A[N]:U});T({totals:B})}return v.fields.forEach((B,U)=>{if(U===0||B.config.custom?.hideFrom?.viz)return;if(B.config.custom?.stacking?.mode===o.gs.Percent){let N=C.findIndex(K=>K.series.indexOf(U)>-1),w=A[N],L=C[N],V=S[U];for(let K=0;K<x;K++){let k=V[K];k!=null&&(V[K]=w[K]===0?0:L.dir*(k/w[K]))}}}),S}function P(v,C){let T,S=1,O=1,x=v.data[1][C],b=v.data[1][C];for(let M=1;M<v.data.length;M++){const R=v.data[M][C];R!=null&&(x==null?x=R:R>x&&(x=v.data[M][C],S=M),b==null?b=R:R<b&&(b=v.data[M][C],O=M))}return b==null&&x==null?T=void 0:b!=null&&x!=null?T=(v.valToPos(b,v.series[O].scale)+v.valToPos(x,v.series[S].scale))/2:T=v.valToPos(b||x,v.series[S||O].scale),T!==void 0&&T<0&&(T=v.bbox.height/devicePixelRatio),T}function a(v,C){const T=E(C);return v===o.NU.NegativeY?T?1:-1:T?-1:1}function E(v,C=100){const T=v.length;if(T===0)return!1;let S=0,O=T-1;for(;S<=O&&v[S]==null;)S++;for(;O>=S&&v[O]==null;)O--;let x=0,b=0;if(O>=S){const M=Math.max(1,Math.floor((O-S+1)/C));for(let A=S;A<=O;A+=M){const R=v[A];R!=null&&typeof R=="number"&&(R<0||Object.is(R,-0)?x++:R>0&&b++)}if(x>b)return!0}return!1}const g=(v,C,T)=>{if(!v?.length)return[];const S=M=>M==null?"-":M.toFixed(1),O=C.display??S;let x=null;const b=(0,s.Nw)({field:C,reducers:v});return v.map(M=>{const A=s.AS.get(M);let R=O;return A.id===s.gy.diffperc&&(R=(0,r.J)({field:{...C,config:{...C.config,unit:"percent"}},theme:T})),(A.id===s.gy.count||A.id===s.gy.changeCount||A.id===s.gy.distinctCount)&&(x||(x=(0,r.J)({field:{...C,config:{...C.config,unit:"none"}},theme:T})),R=x),{...R(b[M]),title:A.name,description:A.description}})},h=(0,l.h)("uPlot"),D=h.logger;(0,m.h)("graphng",void 0,h)},48747:(G,I,e)=>{"use strict";e.d(I,{T:()=>a});var t=e(34796),n=e.n(t),s=e(2543),r=e(96540),o=e(61443),m=e(52622),l=e(75128),i=e(33083),u=e(3139),d=e(65036);const p=({dimensions:g,activeDimensions:h,pos:D,timeZone:v})=>{let C=null;if(h.xAxis===null)return null;h.yAxis&&(C=h.yAxis[0]);const T=h.xAxis[1]?(0,o.WK)(g.xAxis,h.xAxis[0],h.xAxis[1]):D.x,S=(0,d.DU)(g.yAxis.columns,g.xAxis.columns,T,v),O=S.time,x=S.results.map((b,M)=>({color:b.color,label:b.label,value:b.value,isActive:C===M}));return r.createElement(u.o,{series:x,timestamp:O})};p.displayName="MultiModeGraphTooltip";var c=e(83195),y=e(28240);const f=({dimensions:g,activeDimensions:h,timeZone:D})=>{if(h.yAxis===null||h.yAxis[1]===void 0||h.xAxis===null||h.xAxis[1]===void 0)return null;const v=(0,o.WK)(g.xAxis,h.xAxis[0],h.xAxis[1]),C=(0,o.P4)(g.xAxis,h.xAxis[0]),T=C.display?(0,c.cN)(C.display(v)):v,S=(0,o.P4)(g.yAxis,h.yAxis[0]),O=(0,o.WK)(g.yAxis,h.yAxis[0],h.yAxis[1]),x=S.display,b=x(O);return r.createElement(u.o,{series:[{color:b.color,label:(0,y.Ct)(S),value:(0,c.cN)(b)}],timestamp:T})};f.displayName="SingleModeGraphTooltip";const P=({mode:g=m.$N.Single,dimensions:h,activeDimensions:D,pos:v,timeZone:C})=>!D||!D.xAxis?null:g==="single"?r.createElement(f,{dimensions:h,activeDimensions:D,timeZone:C}):r.createElement(p,{dimensions:h,activeDimensions:D,pos:v,timeZone:C});P.displayName="GraphTooltip";class a extends r.PureComponent{constructor(){super(...arguments),this.state={isTooltipVisible:!1,isContextVisible:!1},this.element=null,this.$element=null,this.onPlotSelected=(h,D)=>{const{onHorizontalRegionSelected:v}=this.props;v&&v(D.xaxis.from,D.xaxis.to)},this.onPlotHover=(h,D,v)=>{this.setState({isTooltipVisible:!0,activeItem:v,pos:D})},this.onPlotClick=(h,D,v)=>{this.setState({isContextVisible:!0,isTooltipVisible:!1,contextItem:v,contextPos:D})},this.renderTooltip=()=>{const{children:h,series:D,timeZone:v}=this.props,{pos:C,activeItem:T,isTooltipVisible:S}=this.state;let O;if(!S||!C||D.length===0||(r.Children.forEach(h,N=>{if(O)return;(N&&N.type&&(N.type.displayName||N.type.name))===l.n.displayName&&(O=N)}),!O))return null;const x=O.props,b=x.mode||"single";if(!T&&b==="single")return null;const M=x.tooltipComponent||P,A=T?T.series.seriesIndex:0,R=T?T.dataIndex:void 0,B={xAxis:[A,R],yAxis:T?[T.series.seriesIndex,T.dataIndex]:null},U={dimensions:{xAxis:(0,o.r4)("xAxis",D.map(N=>N.timeField)),yAxis:(0,o.r4)("yAxis",D.map(N=>N.valueField))},activeDimensions:B,pos:C,mode:x.mode||m.$N.Single,timeZone:v},W=r.createElement(M,{...U});return r.cloneElement(O,{content:W,position:{x:C.pageX,y:C.pageY},offset:{x:10,y:10}})},this.renderContextMenu=()=>{const{series:h}=this.props,{contextPos:D,contextItem:v,isContextVisible:C}=this.state;if(!C||!D||!v||h.length===0)return null;const T=v?v.series.seriesIndex:0,S=v?v.dataIndex:void 0,O={xAxis:[T,S],yAxis:v?[v.series.seriesIndex,v.dataIndex]:null},x={xAxis:(0,o.r4)("xAxis",h.map(R=>R.timeField)),yAxis:(0,o.r4)("yAxis",h.map(R=>R.valueField))},b=()=>this.setState({isContextVisible:!1}),M=()=>({datapoint:v.datapoint,dataIndex:v.dataIndex,series:v.series,seriesIndex:v.series.seriesIndex,pageX:D.pageX,pageY:D.pageY}),A={x:D.pageX,y:D.pageY,onClose:b,getContextMenuSource:M,timeZone:this.props.timeZone,dimensions:x,contextDimensions:O};return r.createElement(i.H,{...A})},this.getBarWidth=()=>{const{series:h}=this.props;return Math.min(...h.map(D=>D.timeStep))}}static{this.defaultProps={showLines:!0,showPoints:!1,showBars:!1,isStacked:!1,lineWidth:1}}componentDidUpdate(h,D){h!==this.props&&this.draw()}componentDidMount(){this.draw(),this.element&&(this.$element=n()(this.element),this.$element.bind("plotselected",this.onPlotSelected),this.$element.bind("plothover",this.onPlotHover),this.$element.bind("plotclick",this.onPlotClick))}componentWillUnmount(){this.$element&&this.$element.unbind("plotselected",this.onPlotSelected)}getYAxes(h){return h.length===0?[{show:!0,min:-1,max:1}]:(0,s.uniqBy)(h.map(D=>{const v=D.yAxis?D.yAxis.index:1,C=D.yAxis&&D.yAxis.min&&!isNaN(D.yAxis.min)?D.yAxis.min:null,T=D.yAxis&&D.yAxis.tickDecimals&&!isNaN(D.yAxis.tickDecimals)?D.yAxis.tickDecimals:null;return{show:!0,index:v,position:v===1?"left":"right",min:C,tickDecimals:T}}),D=>D.index)}draw(){if(this.element===null)return;const{width:h,series:D,timeRange:v,showLines:C,showBars:T,showPoints:S,isStacked:O,lineWidth:x,timeZone:b,onHorizontalRegionSelected:M}=this.props;if(!h)return;const A=h/100,R=v.from.valueOf(),B=v.to.valueOf(),U=this.getYAxes(D),W={legend:{show:!1},series:{stack:O,lines:{show:C,lineWidth:x,zero:!1},points:{show:S,fill:1,fillColor:!1,radius:2},bars:{show:T,fill:1,barWidth:T?this.getBarWidth()/1.5:1,zero:!1,lineWidth:x},shadowSize:0},xaxis:{timezone:b,show:!0,mode:"time",min:R,max:B,label:"Datetime",ticks:A,timeformat:(0,d.Jc)(A,R,B),tickFormatter:d.Yn},yaxes:U,grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0,mouseActiveRadius:30},selection:{mode:M?"x":null,color:"#666"},crosshair:{mode:"x"}};try{n().plot(this.element,D.filter(N=>N.isVisible),W)}catch(N){throw console.error("Graph rendering error",N,W,D),new Error("Error rendering panel")}}render(){const{ariaLabel:h,height:D,width:v,series:C}=this.props,T=C.length===0,S=this.renderTooltip(),O=this.renderContextMenu();return r.createElement("div",{className:"graph-panel","aria-label":h},r.createElement("div",{className:"graph-panel__chart",ref:x=>this.element=x,style:{height:D,width:v},onMouseLeave:()=>{this.setState({isTooltipVisible:!1})}}),T&&r.createElement("div",{className:"datapoints-warning"},"No data"),S,O)}}const E=null},33083:(G,I,e)=>{"use strict";e.d(I,{H:()=>c,i:()=>y});var t=e(32196),n=e(96540),s=e(61443),r=e(72724),o=e(28122),m=e(9286),l=e(66864),i=e(59093),u=e(64539),d=e(94536),p=e(40845);const c=({getContextMenuSource:P,timeZone:a,itemsGroup:E,dimensions:g,contextDimensions:h,...D})=>{const v=P(),C=E?E.map(O=>({...O,items:O.items?.filter(x=>x.label)})):[],T=()=>{if(!v)return null;let O;if(g?.yAxis&&h?.yAxis?.[1]){const b=(0,s.WK)(g.yAxis,h.yAxis[0],h.yAxis[1]),M=v.series.valueField.display;O=M(b)}const x=(0,r.LE)(v.datapoint[0],{defaultWithMS:v.series.hasMsResolution,timeZone:a});return n.createElement(y,{timestamp:x,seriesColor:v.series.color,displayName:v.series.alias||v.series.label,displayValue:O})},S=()=>C?.map((O,x)=>n.createElement(i.r,{key:`${O.label}${x}`,label:O.label},(O.items||[]).map(b=>n.createElement(u.D,{key:`${b.label}`,url:b.url,label:b.label,target:b.target,icon:b.icon,active:b.active,onClick:b.onClick}))));return n.createElement(o.t,{...D,renderMenuItems:S,renderHeader:T})},y=({timestamp:P,seriesColor:a,displayName:E,displayValue:g})=>{const h=(0,p.of)(f);return n.createElement("div",{className:h.wrapper},n.createElement("strong",null,P),n.createElement(l.Gy,null,n.createElement("div",null,n.createElement(d.p,{color:a}),n.createElement("span",{className:h.displayName},E)),g&&n.createElement(m.i,{value:g})))};function f(P){return{wrapper:(0,t.css)({padding:P.spacing(.5,1),fontSize:P.typography.size.sm,zIndex:P.zIndex.tooltip}),displayName:(0,t.css)({whiteSpace:"nowrap",paddingLeft:P.spacing(.5)})}}},84656:(G,I,e)=>{"use strict";e.d(I,{M:()=>r});var t=e(2543),n=e.n(t),s=e(96540);class r extends s.Component{constructor(m){super(m),this.onSeriesToggle=this.onSeriesToggle.bind(this),this.state={hiddenSeries:[],toggledSeries:m.series}}componentDidUpdate(m){const{series:l}=this.props;(0,t.isEqual)(m.series,l)||this.setState({hiddenSeries:[],toggledSeries:l})}onSeriesToggle(m,l){const{series:i,onHiddenSeriesChanged:u}=this.props,{hiddenSeries:d}=this.state;if(l.ctrlKey||l.metaKey||l.shiftKey){const f=d.indexOf(m)>-1?d.filter(a=>a!==m):d.concat([m]),P=i.map(a=>({...a,isVisible:f.indexOf(a.label)===-1}));this.setState({hiddenSeries:f,toggledSeries:P},()=>u?u(f):void 0);return}const p=i.map(f=>f.label),c=d.length+1===p.length?[]:(0,t.difference)(p,[m]),y=i.map(f=>({...f,isVisible:c.indexOf(f.label)===-1}));this.setState({hiddenSeries:c,toggledSeries:y},()=>u?u(c):void 0)}render(){const{children:m}=this.props,{toggledSeries:l}=this.state;return m({onSeriesToggle:this.onSeriesToggle,toggledSeries:l})}}},5484:(G,I,e)=>{"use strict";e.d(I,{I:()=>i});var t=e(32196),n=e(96540),s=e(40276),r=e(96516),o=e(40845),m=e(48747);const l=(d,p=!1,c=!1)=>{const y=d.reduce((P,a)=>P+(a[1]||0),0)===0,f=!d.reduce((P,a)=>P&&a[1]!==null,!0);return p&&f||c&&y},i=d=>{const{series:p,timeRange:c,width:y,height:f,showBars:P,showLines:a,showPoints:E,sortLegendBy:g,sortLegendDesc:h,legendDisplayMode:D,legendVisibility:v,placement:C,onSeriesToggle:T,onToggleSort:S,hideEmpty:O,hideZero:x,isStacked:b,lineWidth:M,onHorizontalRegionSelected:A,timeZone:R,children:B,ariaLabel:U}=d,{graphContainer:W,wrapper:N,legendContainer:w}=(0,o.of)(u,d.placement),L=p.reduce((V,K)=>l(K.data,O,x)?V:V.concat([{label:K.label,color:K.color||"",disabled:!K.isVisible,yAxis:K.yAxis.index,getDisplayValues:()=>K.info||[]}]),[]);return n.createElement("div",{className:N,"aria-label":U},n.createElement("div",{className:W},n.createElement(m.T,{series:p,timeRange:c,timeZone:R,showLines:a,showPoints:E,showBars:P,width:y,height:f,isStacked:b,lineWidth:M,onHorizontalRegionSelected:A},B)),v&&n.createElement("div",{className:w},n.createElement(s.E,{hideHorizontalTrack:!0},n.createElement(r.t,{items:L,displayMode:D,placement:C,sortBy:g,sortDesc:h,onLabelClick:(V,K)=>{T&&T(V.label,K)},onToggleSort:S}))))},u=(d,p)=>({wrapper:(0,t.css)({display:"flex",flexDirection:p==="bottom"?"column":"row"}),graphContainer:(0,t.css)({minHeight:"65%",flexGrow:1}),legendContainer:(0,t.css)({padding:"10px 0",maxHeight:p==="bottom"?"35%":"none"})})},65036:(G,I,e)=>{"use strict";e.d(I,{DU:()=>m,Jc:()=>i,Yn:()=>l});var t=e(83195),n=e(28240),s=e(72724),r=e(42994);const o=(u,d)=>{let p=0,c=u.values.length-1,y;for(;;){if(p>c)return Math.max(c,0);y=Math.floor((p+c)/2);const f=u.values[y];if(f===d)return y;f&&f<d?p=y+1:c=y-1}},m=(u,d,p,c)=>{let y,f,P,a,E;const g=[];let h,D;for(y=0;y<u.length;y++){f=u[y];const v=d[y];P=o(v,p),a=p-v.values[P],E=v.values[P],(h===void 0||a>=0&&(a<h||h<0)||a<0&&a>h)&&(h=a,D=v.display?(0,t.cN)(v.display(E)):E);const C=f.display(f.values[P]);g.push({value:(0,t.cN)(C),datapointIndex:P,seriesIndex:y,color:C.color,label:(0,n.Ct)(f),time:v.display?(0,t.cN)(v.display(E)):E})}return{results:g,time:D}},l=(u,d)=>(0,s.LE)(u,{format:d?.options?.timeformat,timeZone:d?.options?.timezone}),i=(u,d,p)=>{if(d&&p&&u){const c=p-d,y=c/u/1e3,f=86400010,P=31536e6;return y<=10?r.WC.interval.millisecond:y<=45?r.WC.interval.second:c<=f?r.WC.interval.minute:y<=8e4?r.WC.interval.hour:c<=P?r.WC.interval.day:y<=31536e3?r.WC.interval.month:r.WC.interval.year}return r.WC.interval.minute}},99755:(G,I,e)=>{"use strict";e.d(I,{o:()=>P});var t=e(96540),n=e(64423),s=e(99165),r=e(85200),o=e(1173),m=e(11261),l=e(69129),i=e(26272),u=e(79041),d=e(67266),p=e(81297),c=e(16895),y=e(65575);function f(a,E,g=[]){for(const h of g)if(typeof h=="function"){if(!h(a,E))return!1}else if(E[h]!==a[h])return!1;return!0}class P extends t.Component{constructor(E){super(E),this.panelContext={},this.subscription=new n.yU,this.getTimeRange=()=>this.props.timeRange;let g=this.prepState(E);g.alignedData=g.config.prepData([g.alignedFrame]),this.state=g,this.plotInstance=t.createRef()}static{this.contextType=u.e4}prepState(E,g=!0){let h=null;const{frames:D,fields:v,preparePlotFrame:C}=E,S=(C||y.mY)(D,v||{x:r.sJ.get(o.Ct.firstTimeField).get({}),y:r.sJ.get(o.Ct.byTypes).get(new Set([m.PU.number,m.PU.enum]))},E.timeRange);if((0,c.uY)("GraphNG",!1,"data aligned",S),S){let O=this.state?.config;g&&(O=E.prepConfig(S,this.props.frames,this.getTimeRange),(0,c.uY)("GraphNG",!1,"config prepared",O)),h={alignedFrame:S,config:O},(0,c.uY)("GraphNG",!1,"data prepared",h.alignedData)}return h}handleCursorUpdate(E){const g=E.payload?.point?.time,h=this.plotInstance.current;if(h&&g){const D=h.valToPos(g,"x");let v;if(D&&(v=(0,c.sw)(h,h.posToIdx(D))),!v||!D)return;h.setCursor({left:D,top:v})}}componentDidMount(){this.panelContext=this.context;const{eventBus:E}=this.panelContext;this.subscription.add(E.getStream(l.b_).pipe((0,s.c)(50)).subscribe({next:g=>{E!==g.origin&&this.handleCursorUpdate(g)}})),this.subscription.add(E.getStream(i.kb).pipe((0,s.c)(50)).subscribe({next:g=>this.handleCursorUpdate(g)})),this.subscription.add(E.getStream(l.ql).pipe((0,s.c)(50)).subscribe({next:()=>{const g=this.plotInstance?.current;g&&!g.cursor._lock&&g.setCursor({left:-10,top:-10})}}))}componentDidUpdate(E){const{frames:g,structureRev:h,timeZone:D,propsToDiff:v}=this.props,C=!f(E,this.props,v);if(g!==E.frames||C||D!==E.timeZone){let T=this.prepState(this.props,!1);T&&((this.state.config===void 0||D!==E.timeZone||h!==E.structureRev||!h||C)&&(T.config=this.props.prepConfig(T.alignedFrame,this.props.frames,this.getTimeRange),(0,c.uY)("GraphNG",!1,"config recreated",T.config)),T.alignedData=T.config.prepData([T.alignedFrame]),this.setState(T))}}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{width:E,height:g,children:h,renderLegend:D}=this.props,{config:v,alignedFrame:C,alignedData:T}=this.state;return v?t.createElement(d.KU,{width:E,height:g,legend:D(v)},(S,O)=>t.createElement(p.Z,{config:v,data:T,width:S,height:O,plotRef:x=>this.plotInstance.current=x},h?h(v,C):null)):null}}},16998:(G,I,e)=>{"use strict";e.d(I,{I:()=>s});var t=e(96540);const n=t.createContext({}),s=()=>{const{data:r,dimFields:o,mapSeriesIndexToDataFrameFieldIndex:m}=(0,t.useContext)(n),l=(0,t.useCallback)(()=>{const i=o.x;let u=null;for(let d=0;d<r.fields.length;d++)if(i(r.fields[d],r,[r])){u=r.fields[d];break}return u},[r,o]);return{dimFields:o,mapSeriesIndexToDataFrameFieldIndex:m,getXAxisField:l,alignedData:r}}},65575:(G,I,e)=>{"use strict";e.d(I,{My:()=>y,wX:()=>d,mY:()=>c});var t=e(11261),n=e(73060),s=e(52622),r=e(52811);const o={threshold:(P,a,E)=>P+E,midpoint:(P,a,E)=>(P+a)/2,plusone:(P,a,E)=>P+1};function m(P){if(P.frame.length===0)return P.frame;let a=!0,{frame:E,refFieldName:g,refFieldPseudoMax:h,refFieldPseudoMin:D,insertMode:v}=P;v||(v=o.threshold);const C=d(E,g);if(C==null)return E;C.state={...C.state,nullThresholdApplied:!0};const T=E.fields.map(O=>O.config.custom?.insertNulls||C.config.interval||null),S=new Set(T);if(S.delete(null),S.size===0)return E;if(S.size===1){const O=S.values().next().value;if(O<=0)return E;const x=C.values,b=E.fields.map(A=>A.values),M=l(x,b,O,D,h,v,a);return M===b?E:{...E,length:M[0].length,fields:E.fields.map((A,R)=>({...A,values:M[R]}))}}return E}function l(P,a,E,g=null,h=null,D,v){const C=P.length,T=[];if(g!=null&&g<P[0]){let b=Math.ceil((P[0]-g)/E),M=P[0]-b*E;for(;M<P[0];)T.push(D(M-E,M,E)),M+=E}T.push(P[0]);let S=P[0];for(let b=1;b<C;b++){const M=P[b];for(;M-S>E&&(T.push(D(S,M,E)),S+=E,!!v););T.push(M),S=M}if(h!=null&&h>S)for(;S+E<h;)T.push(D(S,h,E)),S+=E;const O=T.length;if(O===C)return a;const x=[];for(let b of a){let M;if(b!==P){M=Array(O);for(let A=0,R=0;A<O;A++)M[A]=P[R]===T[A]?b[R++]:null}else M=T;x.push(M)}return x}function i(P,a,E){let g,h;for(let D=0;D<a.length;D++)if(a[D]==null)h==null&&g!=null&&(h=D);else{if(h!=null){if(P[D]-g<E)for(;h<D;)a[h++]=void 0;h=null}g=P[D]}return a}function u(P){return P.type===t.PU.number&&P.config.custom?.drawStyle===s.GR.Bars&&!P.config.custom?.hideFrom?.viz}function d(P,a){return P.fields.find(E=>a!=null?E.name===a:E.type===t.PU.time)}function p(P,a){const E=d(P,a);let g=E?.values;for(let h=0;h<P.fields.length;h++){let D=P.fields[h];if(D===E||u(D))continue;let v=D.config.custom?.spanNulls;typeof v=="number"&&v!==-1&&g&&(D.values=i(g,D.values,v))}return P}function c(P,a,E){let g;e:for(let C of P)for(let T of C.fields)if(a.x(T,C,P)){g=T;break e}P=P.map(C=>g?.state?.nullThresholdApplied?C:m({frame:C,refFieldName:g.name,refFieldPseudoMin:E?.from.valueOf(),refFieldPseudoMax:E?.to.valueOf()}));let h=0;P.forEach(C=>{C.fields.forEach(T=>{u(T)&&(T.config.custom={...T.config.custom,spanNulls:-1},h++)})});let D=1/0;h>1&&P.forEach(C=>{if(!C.fields.some(u))return;const T=g.values;for(let S=0;S<T.length;S++)S>0&&(D=Math.min(D,T[S]-T[S-1]))});let v=(0,n.Fd)({frames:P,joinBy:a.x,keep:a.y,keepOriginIndices:!0});return v?(v=p(v,g.name),D!==1/0&&(v.fields.forEach((C,T)=>{let S=C.values;if(T===0){let O=S[S.length-1];S.push(O+D,O+2*D)}else u(C)?S.push(null,null):S.push(void 0,void 0)}),v.length+=2),v):null}function y(P,a){const E="na",g=`${P.min!==void 0?P.min:E}-${P.max!==void 0?P.max:E}`,h=`${P.custom?.axisSoftMin!==void 0?P.custom.axisSoftMin:E}-${P.custom?.axisSoftMax!==void 0?P.custom.axisSoftMax:E}`,D=`${P.custom?.axisPlacement!==void 0?P.custom?.axisPlacement:s.vM.Auto}`,v=P.unit??r.s,C=P.custom?.scaleDistribution?f(P.custom.scaleDistribution):s.L4.Linear,T=P.custom?.axisLabel?P.custom.axisLabel:E;return`${v}/${g}/${h}/${D}/${C}/${T}/${a}`}function f(P){return P.type===s.L4.Log?`${P.type}${P.log}`:P.type}},18262:(G,I,e)=>{"use strict";e.d(I,{Z:()=>M});var t=e(96540),n=e(79041),s=e(24182),r=e(40845),o=e(99755),m=e(2543),l=e(36613),i=e(11261),u=e(83195),d=e(57875),p=e(8066),c=e(24293),y=e(28240),f=e(94624),P=e(52622),a=e(51336),E=e(74863),g=e(16895),h=e(65575);const D=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),v=Array(53);for(let A=0;A<v.length;A++)v[A]=2**A;const C=(A,R=1)=>A==null?"-":A.toFixed(R),T={drawStyle:P.GR.Line,showPoints:P.yL.Auto,axisPlacement:P.vM.Auto},S=({frame:A,theme:R,timeZones:B,getTimeRange:U,sync:W,allFrames:N,renderers:w,tweakScale:L=K=>K,tweakAxis:V=K=>K})=>{const K="__global_",k=new a.e(B[0]);let j;k.setPrepData(ie=>(j=ie[0],(0,g.bq)(ie[0],k.getStackingGroups())));const H=A.fields[0];if(!H)return k;const J="x";let X="";const se=H.config.custom?.axisPlacement!==P.vM.Hidden?P.vM.Bottom:P.vM.Hidden,ae=H.config.custom?.axisPlacement!==P.vM.Hidden;if(H.type===i.PU.time){k.addScale({scaleKey:J,orientation:P.Lt.Horizontal,direction:P.ON.Right,isTime:!0,range:()=>{const ce=U();return[ce.from.valueOf(),ce.to.valueOf()]}});const ie=B.length>1?(ce,ue)=>ue.map((fe,Te)=>Te<2?null:fe):void 0;for(let ce=0;ce<B.length;ce++){const ue=B[ce];k.addAxis({scaleKey:J,isTime:!0,placement:se,show:ae,label:H.config.custom?.axisLabel,timeZone:ue,theme:R,grid:{show:ce===0&&H.config.custom?.axisGridShow},filter:ie})}B.length>1&&k.addHook("drawAxes",ce=>{ce.ctx.save(),ce.ctx.fillStyle=R.colors.text.primary,ce.ctx.textAlign="left",ce.ctx.textBaseline="bottom";let ue=0;ce.axes.forEach(fe=>{if(fe.side===2){let Te=fe._pos+fe._size;ce.ctx.fillText(B[ue],ce.bbox.left,Te*l.A.pxRatio),ue++}}),ce.ctx.restore()})}else k.addScale({scaleKey:J,orientation:P.Lt.Horizontal,direction:P.ON.Right,range:(ie,ce,ue)=>[H.config.min??ce,H.config.max??ue]}),k.addAxis({scaleKey:J,placement:se,show:ae,label:H.config.custom?.axisLabel,theme:R,grid:{show:H.config.custom?.axisGridShow},formatValue:(ie,ce)=>(0,u.cN)(H.display(ie,ce))});let ne=w?.flatMap(ie=>Object.values(ie.fieldMap).filter(ce=>ie.indicesOnly.indexOf(ce)===-1))??[],q;for(let ie=1;ie<A.fields.length;ie++){const ce=A.fields[ie],ue={...ce.config,custom:{...T,...ce.config.custom}},fe=ue.custom;if(ce===H||ce.type!==i.PU.number&&ce.type!==i.PU.enum)continue;let Te=ce.display??C;ce.config.custom?.stacking?.mode===P.gs.Percent&&(Te=(0,d.J)({field:{...ce,config:{...ce.config,unit:"percentunit"}},theme:R}));const he=(0,h.My)(ue,ce.type),de=(0,p.Qi)(ce),pe=(0,p.lz)(ce,R).color;if(k.addScale(L({scaleKey:he,orientation:P.Lt.Vertical,direction:P.ON.Up,distribution:fe.scaleDistribution?.type,log:fe.scaleDistribution?.log,linearThreshold:fe.scaleDistribution?.linearThreshold,min:ce.config.min,max:ce.config.max,softMin:fe.axisSoftMin,softMax:fe.axisSoftMax,centeredZero:fe.axisCenteredZero,range:fe.stacking?.mode===P.gs.Percent?(Re,Fe,xe)=>(Fe=Fe<0?-1:0,xe=xe>0?1:0,[Fe,xe]):ce.type===i.PU.enum?(Re,Fe,xe)=>[-1,ce.config.type.enum.text.length]:void 0,decimals:ce.config.decimals},ce)),X||(X=he),fe.axisPlacement!==P.vM.Hidden){let Re;fe.axisColorMode===P.Y$.Series&&(de.isByValue&&ce.config.custom?.gradientMode===P.on.Scheme&&de.id===c.Y.Thresholds?Re=(0,E.pl)(1,R,de,ce.config.thresholds):Re=pe);const Fe={border:{show:fe.axisBorderShow||!1,width:1/devicePixelRatio,stroke:Re||R.colors.text.primary},ticks:{show:fe.axisBorderShow||!1,stroke:Re||R.colors.text.primary},color:Re||R.colors.text.primary};let xe,Ve,$e;if(D.has(ue.unit))xe=v;else if(ce.type===i.PU.enum){let Xe=ce.config.type.enum.text;$e=Xe.map((gt,Dt)=>Dt),Ve=Xe}k.addAxis(V({scaleKey:he,label:fe.axisLabel,size:fe.axisWidth,placement:fe.axisPlacement??P.vM.Auto,formatValue:(Xe,gt)=>(0,u.cN)(Te(Xe,gt)),theme:R,grid:{show:fe.axisGridShow},decimals:ce.config.decimals,distr:fe.scaleDistribution?.type,splits:$e,values:Ve,incrs:xe,...Fe},ce))}const ve=fe.drawStyle===P.GR.Points?P.yL.Always:fe.showPoints;let be=()=>null;fe.spanNulls!==!0&&(be=(Re,Fe,xe,Ve)=>{let $e=[],Xe=Re.series[Fe];if(!xe&&Ve&&Ve.length){const[gt,Dt]=Xe.idxs,nt=Re.data[0],at=Re.data[Fe],Ae=Math.round(Re.valToPos(nt[gt],"x",!0)),re=Math.round(Re.valToPos(nt[Dt],"x",!0));Ve[0][0]===Ae&&$e.push(gt);for(let Z=0;Z<Ve.length;Z++){let oe=Ve[Z],Ee=Ve[Z+1];if(Ee&&oe[1]===Ee[0]){let ye=Re.posToIdx(oe[1],!0);if(at[ye]==null)for(let Se=1;Se<100;Se++){if(at[ye+Se]!=null){ye+=Se;break}if(at[ye-Se]!=null){ye-=Se;break}}$e.push(ye)}}Ve[Ve.length-1][1]===re&&$e.push(Dt)}return $e.length?$e:null});let{fillOpacity:Oe}=fe,Me=null,Ue=null;if(ce.state?.origin){q||(q=O(A,N));const Re=N[ce.state.origin.frameIndex],Fe=Re?.fields[ce.state.origin.fieldIndex],xe=(0,y.Ct)(Fe??ce,Re,N);if(ne.indexOf(xe)>=0)Me=()=>null,Ue=()=>{};else if(fe.transform===P.NU.Constant){const Ve=l.A.paths.linear();Me=($e,Xe)=>{const gt=$e._data,Dt=U();let nt=[Dt.from.valueOf(),Dt.to.valueOf()],at=gt[Xe].find(Z=>Z!=null),Ae=[at,at],re=gt.slice();return re[0]=nt,re[Xe]=Ae,Ve({...$e,_data:re},Xe,0,1)}}if(fe.fillBelowTo){const Ve=A.fields.find(Dt=>fe.fillBelowTo===Dt.name||fe.fillBelowTo===Dt.config?.displayNameFromDS||fe.fillBelowTo===(0,y.Ct)(Dt,A,N)),$e=Ve?(0,y.Ct)(Ve,A,N):fe.fillBelowTo,Xe=q.get(xe),gt=q.get($e);(0,m.isNumber)(gt)&&(0,m.isNumber)(Xe)?(k.addBand({series:[Xe,gt],fill:void 0}),Oe||(Oe=35)):Oe=0}}let we;de.id===c.Y.Thresholds&&(we=Re=>(0,p.lz)(j.fields[Re],R).color),k.addSeries({pathBuilder:Me,pointsBuilder:Ue,scaleKey:he,showPoints:ve,pointsFilter:be,colorMode:de,fillOpacity:Oe,theme:R,dynamicSeriesColor:we,drawStyle:fe.drawStyle,lineColor:fe.lineColor??pe,lineWidth:fe.lineWidth,lineInterpolation:fe.lineInterpolation,lineStyle:fe.lineStyle,barAlignment:fe.barAlignment,barWidthFactor:fe.barWidthFactor,barMaxWidth:fe.barMaxWidth,pointSize:fe.pointSize,spanNulls:fe.spanNulls||!1,show:!fe.hideFrom?.viz,gradientMode:fe.gradientMode,thresholds:ue.thresholds,hardMin:ce.config.min,hardMax:ce.config.max,softMin:fe.axisSoftMin,softMax:fe.axisSoftMax,dataFrameFieldIndex:ce.state?.origin}),fe.thresholdsStyle&&ue.thresholds&&(fe.thresholdsStyle.mode??P.Ly.Off)!==P.Ly.Off&&k.addThresholds({config:fe.thresholdsStyle,thresholds:ue.thresholds,scaleKey:he,theme:R,hardMin:ce.config.min,hardMax:ce.config.max,softMin:fe.axisSoftMin,softMax:fe.axisSoftMax})}let ee=(0,g.ro)(A);k.setStackingGroups(ee),w?.forEach(ie=>{q||(q=O(A,N));let ce={};for(let ue in ie.fieldMap){let fe=ie.fieldMap[ue];ce[ue]=q.get(fe)}ie.init(k,ce)}),k.scaleKeys=[J,X];const z=15;let te={dataIdx:(ie,ce,ue,fe)=>{let Te=ie.data[ce];if(Te[ue]==null){let he=null,de=null,le;for(le=ue;he==null&&le-- >0;)Te[le]!=null&&(he=le);for(le=ue;de==null&&le++<Te.length;)Te[le]!=null&&(de=le);let pe=ie.data[0],ve=ie.valToPos(fe,"x"),be=de==null?1/0:ie.valToPos(pe[de],"x"),Oe=he==null?-1/0:ie.valToPos(pe[he],"x"),Me=ve-Oe,Ue=be-ve;Me<=Ue?Me<=z&&(ue=he):Ue<=z&&(ue=de)}return ue}};return W&&W()!==f.y.Off&&(te.sync={key:K,scales:[J,null]}),k.setCursor(te),k};function O(A,R){const B=new Map;return A.fields.forEach((U,W)=>{const N=U.state?.origin;if(N){const w=R[N.frameIndex]?.fields[N.fieldIndex];w&&B.set((0,y.Ct)(w,R[N.frameIndex],R),W)}}),B}const x=["legend","options","theme"];class b extends t.Component{constructor(){super(...arguments),this.prepConfig=(R,B,U)=>{const{sync:W}=this.context,{theme:N,timeZone:w,renderers:L,tweakAxis:V,tweakScale:K}=this.props;return S({frame:R,theme:N,timeZones:Array.isArray(w)?w:[w],getTimeRange:U,sync:W,allFrames:B,renderers:L,tweakScale:K,tweakAxis:V})},this.renderLegend=R=>{const{legend:B,frames:U}=this.props;return!R||B&&!B.showLegend||!(0,s.t)(R,U)?null:t.createElement(s.$,{data:U,config:R,...B})}}static{this.contextType=n.e4}render(){return t.createElement(o.o,{...this.props,prepConfig:this.prepConfig,propsToDiff:x,renderLegend:this.renderLegend})}}const M=(0,r.cV)(b);M.displayName="TimeSeries"},90606:(G,I,e)=>{"use strict";e.d(I,{T:()=>g});var t=e(32196),n=e(96540),s=e(1604),r=e(94624),o=e(57875),m=e(24293),l=e(28240),i=e(83195),u=e(11261),d=e(14588),p=e(52622),c=e(3139),y=e(17464),f=e(69503),P=e(16895),a=e(40845);const E=10,g=({mode:C=p.$N.Single,sortOrder:T=p.xB.None,sync:S,timeZone:O,config:x,renderTooltip:b,...M})=>{const A=(0,n.useRef)(),R=(0,a.$j)(),[B,U]=(0,n.useState)(null),[W,N]=(0,n.useState)(null),[w,L]=(0,n.useState)([]),[V,K]=(0,n.useState)(null),[k,j]=(0,n.useState)(!1),H=(0,s.A)();let J=null;const X=(0,a.of)(v);if((0,n.useLayoutEffect)(()=>{let ee;const z=()=>{H()&&(j(!0),A.current?.root.classList.add("plot-active"))},te=()=>{H()&&(K(null),j(!1),A.current?.root.classList.remove("plot-active"))};return x.addHook("syncRect",(ie,ce)=>ee=ce),x.addHook("init",ie=>{A.current=ie,ie.over.addEventListener("mouseenter",z),ie.over.addEventListener("mouseleave",te),J=ie.root.closest("[tabindex]"),J&&(J.addEventListener("focus",z),J.addEventListener("blur",te)),S&&S()===r.y.Crosshair&&ie.root.classList.add("shared-crosshair")}),x.addHook("setLegend",ie=>{H()&&(N(ie.legend.idx),L(ie.legend.idxs.slice()))}),x.addHook("setCursor",ie=>{if(!ee||!H())return;const{x:ce,y:ue}=D(ie,ee);K(ce!==void 0&&ue!==void 0?{x:ce,y:ue}:null)}),x.addHook("setSeries",(ie,ce)=>{H()&&U(ce)}),()=>{K(null),A.current&&(A.current.over.removeEventListener("mouseleave",te),A.current.over.removeEventListener("mouseenter",z),J&&(J.removeEventListener("focus",z),J.removeEventListener("blur",te)))}},[x,K,j,N,L]),W===null||!k&&S&&S()===r.y.Crosshair)return null;let se=M.data.fields[0];if(!se)return null;const ae=se.display||(0,o.J)({field:se,timeZone:O,theme:R});let ne=null,q=ae(se.values[W]).text;if(b)ne=b(M.data,B,W);else{if(C===p.$N.Single&&B!==null){const ee=M.data.fields[B];if(!ee)return null;const z=w?.[B]??W;q=ae(se.values[z]).text;const ie=(ee.display||(0,o.J)({field:ee,timeZone:O,theme:R}))(ee.values[z]);ne=n.createElement(c.o,{series:[{color:ie.color||m.F,label:(0,l.Ct)(ee,M.data,M.frames),value:ie?(0,i.cN)(ie):null}],timestamp:q})}if(C===p.$N.Multi){let ee=[];const z=M.data,te=z.fields,ie=[];for(let ce=0;ce<te.length;ce++){const ue=z.fields[ce];if(!ue||ue===se||ue.type===u.PU.time||ue.type!==u.PU.number||ue.config.custom?.hideFrom?.tooltip||ue.config.custom?.hideFrom?.viz)continue;const fe=M.data.fields[ce].values[w[ce]],Te=ue.display(fe);ie.push(fe),ee.push({color:Te.color||m.F,label:(0,l.Ct)(ue,z,M.frames),value:Te?(0,i.cN)(Te):null,isActive:B===ce})}if(T!==p.xB.None){const ce=[...ee],ue=d.sortValues(T);ee.sort((fe,Te)=>{const he=ce.indexOf(fe),de=ce.indexOf(Te);return ue(ie[he],ie[de])})}ne=n.createElement(c.o,{series:ee,timestamp:q})}}return n.createElement(y.ZL,{className:k?X.tooltipWrapper:void 0},ne&&V&&n.createElement(f.o,{position:{x:V.x,y:V.y},offset:{x:E,y:E}},ne))};function h({left:C,top:T},S){return C===void 0||T===void 0?!1:C<0||C>S.width||T<0||T>S.height}function D(C,T){let S,O;const x=C.cursor.left||0,b=C.cursor.top||0;if(h(C.cursor,T)){const M=C.posToIdx(x);if(b<0||b>T.height){let A=(0,P.sw)(C,M);A&&(O=T.top+A,x>=0&&x<=T.width&&(S=T.left+C.valToPos(C.data[0][C.posToIdx(x)],C.series[0].scale)))}}else S=T.left+x,O=T.top+b;return{x:S,y:O}}const v=C=>({tooltipWrapper:(0,t.css)({"z-index":C.zIndex.portal+1+" !important"})})},76284:(G,I,e)=>{"use strict";e.d(I,{j:()=>r});var t=e(96540);const n=5,s=o=>o!=null&&!o.ctrlKey&&!o.metaKey,r=({onZoom:o,config:m,withZoomY:l=!1})=>((0,t.useLayoutEffect)(()=>{let i=!1,u=!1;l&&m.addHook("init",d=>{d.over.addEventListener("mousedown",p=>{if(s(p)&&p.button===0&&p.shiftKey){u=!0,d.cursor.drag.x=!1,d.cursor.drag.y=!0;let c=y=>{d.cursor.drag.x=!0,d.cursor.drag.y=!1,document.removeEventListener("mouseup",c,!0)};document.addEventListener("mouseup",c,!0)}},!0)}),m.addHook("setSelect",d=>{const p=d.scales.x.ori===0;if(s(d.cursor.event)){if(l&&u){if(d.select.height>=n){for(let c in d.scales)if(c!=="x"){const y=p?d.posToVal(d.select.top,c):d.posToVal(d.select.left+d.select.width,c),f=p?d.posToVal(d.select.top+d.select.height,c):d.posToVal(d.select.left,c);d.setScale(c,{min:f,max:y})}i=!0}u=!1}else if(d.select.width>=n){const c=p?d.posToVal(d.select.left,"x"):d.posToVal(d.select.top+d.select.height,"x"),y=p?d.posToVal(d.select.left+d.select.width,"x"):d.posToVal(d.select.top,"x");o({from:c,to:y}),i=!1}}d.setSelect({left:0,width:0,top:0,height:0},!1)}),m.setCursor({bind:{dblclick:d=>()=>{if(!s(d.cursor.event))return null;if(l&&i){for(let p in d.scales)p!=="x"&&d.setScale(p,{min:null,max:null});i=!1}else{let p=d.scales.x;const c=p.min,y=p.max,f=(y-c)/2;o({from:c-f,to:y+f})}return null}}})},[m,o,l]),null)},8984:(G,I,e)=>{"use strict";e.r(I),e.d(I,{ALERTING_COLOR:()=>r.xj,AxisPlacement:()=>i.vM,BarAlignment:()=>i.Nj,BarValueVisibility:()=>i.TC,BracesPlugin:()=>l.e1,ClearPlugin:()=>l.vJ,ClipboardPlugin:()=>l.sW,DEFAULT_ANNOTATION_COLOR:()=>r.Mk,DOMUtil:()=>r.bk,DrawStyle:()=>i.yg,EventsWithValidation:()=>r.Pw,GlobalStyles:()=>o.kH,GraphGradientMode:()=>i.on,GraphThresholdsStyleMode:()=>i.Ly,IndentationPlugin:()=>l.TA,LegendDisplayMode:()=>i.lm,LineInterpolation:()=>i.dx,NO_DATA_COLOR:()=>r.nO,NewlinePlugin:()=>l.Om,NodeGraphDataFrameFieldNames:()=>r.uc,OK_COLOR:()=>r.Xw,PENDING_COLOR:()=>r.ct,PointVisibility:()=>i.nT,REGION_FILL_ALPHA:()=>r.UJ,ReactUtils:()=>r.zt,RunnerPlugin:()=>l.Ul,SCHEMA:()=>r.yx,ScaleDirection:()=>i.ON,ScaleOrientation:()=>i.Lt,SearchFunctionType:()=>r.Tt,SelectionShortcutsPlugin:()=>l.l9,SlatePrism:()=>l.De,StackingMode:()=>i.gs,SuggestionsPlugin:()=>l.Pz,TableCellDisplayMode:()=>i.ob,ThemeContext:()=>o.Dx,TooltipDisplayMode:()=>i.$N,ansicolor:()=>r.DB,attachDebugger:()=>r.hF,calculateFontSize:()=>r.Vr,colors:()=>r.Tj,commonOptionsBuilder:()=>m.j,createLogger:()=>r.h,fuzzyMatch:()=>r.It,getCanvasContext:()=>r.Yc,getCellLinks:()=>r.kl,getScrollbarWidth:()=>r.XJ,getTagColor:()=>r.yC,getTagColorIndexFromName:()=>r.JF,getTagColorsFromName:()=>r.MC,getTextColorForAlphaBackground:()=>r.mZ,getTextColorForBackground:()=>r.sg,getTheme:()=>o.O4,hasValidationEvent:()=>r.K,isCompactUrl:()=>r.Fr,linkModelToContextMenuItems:()=>r.Jl,makeFragment:()=>r.dF,makeValue:()=>r.mO,measureText:()=>r.kD,mockTheme:()=>o.mG,mockThemeContext:()=>o.fq,regexValidation:()=>r.RP,sortedColors:()=>r.Ih,styleMixins:()=>o.YF,stylesFactory:()=>o.N3,useForceUpdate:()=>r.CH,useStyles:()=>o.IS,useStyles2:()=>o.of,useTheme:()=>o.DP,useTheme2:()=>o.$j,validate:()=>r.tf,withTheme:()=>o.SL,withTheme2:()=>o.cV});var t=e(94333),s={};for(const u in t)u!=="default"&&(s[u]=()=>t[u]);e.d(I,s);var n=e(80186),s={};for(const u in n)["default","Icon","IconButton","ConfirmButton","DeleteButton","Tooltip","PopoverController","Popover","Toggletip","Portal","getPortalContainer","PortalContainer","CustomScrollbar","TabbedContainer","ClipboardButton","Cascader","ButtonCascader","InlineToast","LoadingPlaceholder","LoadingBar","ColorPicker","SeriesColorPicker","ColorPickerInput","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","EmptySearchResult","EmptyState","UnitPicker","StatsPicker","RefreshPicker","defaultIntervals","TimeRangePicker","TimePickerTooltip","TimeRangeLabel","TimeOfDayPicker","TimeZonePicker","WeekStartPicker","DatePicker","DatePickerWithInput","DateTimePicker","List","InteractiveTable","TagsInput","AutoSaveField","Pagination","Tag","TagList","FilterPill","ConfirmModal","QueryField","CodeEditor","ReactMonacoEditor","CodeEditorSuggestionItemKind","variableSuggestionToCodeEditorSuggestion","Modal","ModalHeader","ModalTabsHeader","ModalTabContent","ModalsProvider","ModalRoot","ModalsController","ModalsContext","PageToolbar","SetInterval","Table","TableInputCSV","TabsBar","Tab","VerticalTab","TabContent","Counter","RenderUserContentAsHTML","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Sparkline","Gauge","BarGauge","VizTooltip","VizTooltipContainer","SeriesTable","SeriesTableRow","VizRepeater","PanelChrome","PanelChromeLoadingIndicator","PanelContextProvider","PanelContextRoot","usePanelContext","VizLayout","SeriesVisibilityChangeBehavior","VizLegend","VizLegendListItem","Alert","GraphSeriesToggler","Collapse","ControlledCollapse","CollapsableSection","DataLinkButton","FieldLinkList","FullWidthButtonContainer","ClickOutsideWrapper","CallToActionCard","ContextMenu","Menu","MenuGroup","MenuItem","WithContextMenu","DataLinksInlineEditor","DataLinkInput","DataLinksContextMenu","SeriesIcon","InfoBox","FeatureInfoBox","FeatureBadge","JSONFormatter","JsonExplorer","ErrorBoundary","ErrorBoundaryAlert","withErrorBoundary","ErrorWithStack","DataSourceHttpSettings","CustomHeadersSettings","AlertingSettings","SecureSocksProxySettings","TLSAuthSettings","CertificationKey","Spinner","FadeTransition","SlideOutTransition","Segment","SegmentAsync","SegmentInput","SegmentSelect","SegmentSection","Drawer","Slider","RangeSlider","Form","sharedInputStyle","InputControl","Button","LinkButton","ButtonGroup","clearButtonStyles","ToolbarButton","ToolbarButtonRow","ValuePicker","fieldMatchersUI","Link","TextLink","Text","Box","Stack","Grid","Space","Label","Field","Legend","FieldSet","FieldValidationMessage","InlineField","InlineSegmentGroup","InlineLabel","InlineFieldRow","FieldArray","resetSelectStyles","getSelectStyles","HorizontalGroup","VerticalGroup","Container","Badge","RadioButtonGroup","RadioButtonList","Input","getInputStyles","AutoSizeInput","FilterInput","Switch","InlineSwitch","Checkbox","TextArea","FileUpload","TimeRangeInput","RelativeTimeRangePicker","Card","getCardStyles","CardContainer","FormattedValueDisplay","ButtonSelect","Dropdown","PluginSignatureBadge","UserIcon","Avatar","InlineFormLabel","Divider","getDragStyles","useSplitter","LegacyForms","LegacyInputStatus","ScaleDistribution","BarGaugeDisplayMode","UPlotConfigBuilder","UPLOT_AXIS_FONT_SIZE","UPlotChart","PlotLegend","FIXED_UNIT","BrowserLabel","PanelContainer","Graph","GraphWithLegend","GraphContextMenu","GraphContextMenuHeader","graphTimeFormat","graphTickFormatter","GraphNG","TimeSeries","useGraphNGContext","preparePlotFrame","buildScaleKey","ZoomPlugin","TooltipPlugin","convertOldAngularValueMapping","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","MultiSelect","Select","SelectContainer","VirtualizedSelect","SecretInput","SecretTextArea","FileDropzone","FileDropzoneDefaultChildren","FileListItem","graphFieldOptions","EventsCanvas","Marker","XYCanvas","EventBusPlugin","KeyboardPlugin","TooltipPlugin2","SeriesVisibilityChangeMode"].indexOf(u)<0&&(s[u]=()=>n[u]);e.d(I,s);var r=e(99598),o=e(7918),m=e(42482),l=e(50955),i=e(49149)},38248:(G,I,e)=>{"use strict";e.d(I,{W:()=>y,r:()=>d});var t=e(96540),n=e(11261),s=e(27310),r=e(52622),o=e(88575),m=e(94354),l=e(10354),i=e(21594),u=e(52198);function d(f,P,a){const E=["Axis"];f.addRadio({path:"axisPlacement",name:"Placement",category:E,defaultValue:u.t.axisPlacement[0].value,settings:{options:u.t.axisPlacement}}).addTextInput({path:"axisLabel",name:"Label",category:E,defaultValue:"",settings:{placeholder:"Optional text",expandTemplateVars:!0},showIf:g=>g.axisPlacement!==r.vM.Hidden,shouldApply:g=>g.type!==n.PU.time&&g.type!==n.PU.string}).addNumberInput({path:"axisWidth",name:"Width",category:E,settings:{placeholder:"Auto"},showIf:g=>g.axisPlacement!==r.vM.Hidden}).addRadio({path:"axisGridShow",name:"Show grid lines",category:E,defaultValue:void 0,settings:{options:[{value:void 0,label:"Auto"},{value:!0,label:"On"},{value:!1,label:"Off"}]},showIf:g=>g.axisPlacement!==r.vM.Hidden}).addRadio({path:"axisColorMode",name:"Color",category:E,defaultValue:r.Y$.Text,settings:{options:[{value:r.Y$.Text,label:"Text"},{value:r.Y$.Series,label:"Series"}]},showIf:g=>g.axisPlacement!==r.vM.Hidden}).addBooleanSwitch({path:"axisBorderShow",name:"Show border",category:E,defaultValue:!1,showIf:g=>g.axisPlacement!==r.vM.Hidden}),f.addCustomEditor({id:"scaleDistribution",path:"scaleDistribution",name:"Scale",category:E,editor:y,override:y,defaultValue:{type:r.L4.Linear},shouldApply:g=>g.type===n.PU.number,process:s.hS}).addBooleanSwitch({path:"axisCenteredZero",name:"Centered zero",category:E,defaultValue:!1,showIf:g=>g.scaleDistribution?.type!==r.L4.Log}).addNumberInput({path:"axisSoftMin",name:"Soft min",defaultValue:P.axisSoftMin,category:E,settings:{placeholder:"See: Standard options > Min"}}).addNumberInput({path:"axisSoftMax",name:"Soft max",defaultValue:P.axisSoftMax,category:E,settings:{placeholder:"See: Standard options > Max"}})}const p=[{label:"Linear",value:r.L4.Linear},{label:"Logarithmic",value:r.L4.Log},{label:"Symlog",value:r.L4.Symlog}],c=[{label:"2",value:2},{label:"10",value:10}],y=({value:f,onChange:P})=>{const a=f?.type??r.L4.Linear,E=f?.log??2;return t.createElement(t.Fragment,null,t.createElement("div",{style:{marginBottom:16}},t.createElement(m.z,{value:a,options:p,onChange:g=>{P({...f,type:g,log:g===r.L4.Linear?void 0:E})}})),(a===r.L4.Log||a===r.L4.Symlog)&&t.createElement(o.D,{label:"Log base"},t.createElement(i.l6,{options:c,value:E,onChange:g=>{P({...f,log:g.value})}})),a===r.L4.Symlog&&t.createElement(o.D,{label:"Linear threshold"},t.createElement(l.p,{placeholder:"1",value:f?.linearThreshold,onChange:g=>{P({...f,linearThreshold:Number(g.currentTarget.value)})}})))}},11404:(G,I,e)=>{"use strict";e.d(I,{e:()=>l});var t=e(2543),n=e.n(t),s=e(96540),r=e(92174),o=e(67061);const m=({value:i,onChange:u})=>{const d=(0,s.useCallback)(p=>{u({...i,[p]:!i[p]})},[i,u]);return s.createElement(o.B,{gap:.5},Object.keys(i).map(p=>{const c=p;return s.createElement(r.m,{icon:i[c]?"eye-slash":"eye",onClick:()=>d(c),key:c,label:(0,t.startCase)(c),selected:i[c]})}))};function l(i){i.addCustomEditor({id:"hideFrom",name:"Hide in area",category:["Series"],path:"hideFrom",defaultValue:{tooltip:!1,viz:!1,legend:!1},editor:m,override:m,shouldApply:()=>!0,hideFromDefaults:!0,process:u=>u})}},22680:(G,I,e)=>{"use strict";e.d(I,{H:()=>s});var t=e(69550),n=e(52622);function s(r,o=!0){r.addBooleanSwitch({path:"legend.showLegend",name:"Visibility",category:["Legend"],description:"",defaultValue:!0}).addRadio({path:"legend.displayMode",name:"Mode",category:["Legend"],description:"",defaultValue:n.lm.List,settings:{options:[{value:n.lm.List,label:"List"},{value:n.lm.Table,label:"Table"}]},showIf:m=>m.legend.showLegend}).addRadio({path:"legend.placement",name:"Placement",category:["Legend"],description:"",defaultValue:"bottom",settings:{options:[{value:"bottom",label:"Bottom"},{value:"right",label:"Right"}]},showIf:m=>m.legend.showLegend}).addNumberInput({path:"legend.width",name:"Width",category:["Legend"],settings:{placeholder:"Auto"},showIf:m=>m.legend.showLegend&&m.legend.placement==="right"}),o&&r.addCustomEditor({id:"legend.calcs",path:"legend.calcs",name:"Values",category:["Legend"],description:"Select values or calculations to show in legend",editor:t.D.get("stats-picker").editor,defaultValue:[],settings:{allowMultiple:!0},showIf:m=>m.legend.showLegend!==!1})}},56675:(G,I,e)=>{"use strict";e.d(I,{I:()=>p,m:()=>d});var t=e(96540),n=e(27310),s=e(11261),r=e(52622),o=e(94354),m=e(29158),l=e(10354),i=e(67061),u=e(52198);const d=({value:c,context:y,onChange:f,item:P})=>t.createElement(i.B,null,t.createElement(o.z,{value:c?.mode||r.gs.None,options:P.settings?.options??[],onChange:a=>{f({...c,mode:a})}}),y.isOverride&&c?.mode&&c?.mode!==r.gs.None&&t.createElement(l.p,{type:"text",placeholder:"Group",suffix:t.createElement(m.K,{name:"question-circle",tooltip:"Name of the stacking group",tooltipPlacement:"top"}),defaultValue:c?.group,onChange:a=>{f({...c,group:a.currentTarget.value.trim()})}}));function p(c,y,f=["Graph styles"]){c.addCustomEditor({id:"stacking",path:"stacking",name:"Stack series",category:f,defaultValue:y,editor:d,override:d,settings:{options:u.t.stacking},process:n.hS,shouldApply:P=>P.type===s.PU.number})}},71242:(G,I,e)=>{"use strict";e.d(I,{I:()=>t});function t(n,s=!0){s&&n.addNumberInput({path:"text.titleSize",category:["Text size"],name:"Title",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0}),n.addNumberInput({path:"text.valueSize",category:["Text size"],name:"Value",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0})}},89654:(G,I,e)=>{"use strict";e.d(I,{D:()=>n});var t=e(52622);function n(s,r=!1,o=!1,m){const l=["Tooltip"],i=r?[{value:t.$N.Single,label:"Single"},{value:t.$N.None,label:"Hidden"}]:[{value:t.$N.Single,label:"Single"},{value:t.$N.Multi,label:"All"},{value:t.$N.None,label:"Hidden"}],u=[{value:t.xB.None,label:"None"},{value:t.xB.Ascending,label:"Ascending"},{value:t.xB.Descending,label:"Descending"}];s.addRadio({path:"tooltip.mode",name:"Tooltip mode",category:l,defaultValue:m?.tooltip?.mode??t.$N.Single,settings:{options:i}}).addRadio({path:"tooltip.sort",name:"Values sort order",category:l,defaultValue:m?.tooltip?.sort??t.xB.None,showIf:d=>d.tooltip?.mode===t.$N.Multi,settings:{options:u}}),o&&s.addNumberInput({path:"tooltip.hoverProximity",name:"Hover proximity",description:"How close the cursor must be to a point to trigger the tooltip, in pixels",category:l,settings:{integer:!0}}),s.addNumberInput({path:"tooltip.maxWidth",name:"Max width",category:l,settings:{integer:!0}}).addNumberInput({path:"tooltip.maxHeight",name:"Max height",category:l,defaultValue:void 0,settings:{integer:!0},showIf:d=>d.tooltip?.mode===t.$N.Multi})}},42482:(G,I,e)=>{"use strict";e.d(I,{j:()=>t});var t={};e.r(t),e.d(t,{ScaleDistributionEditor:()=>n.W,StackingEditor:()=>l.m,addAxisConfig:()=>n.r,addHideFrom:()=>s.e,addLegendOptions:()=>r.H,addStackingConfig:()=>l.I,addTextSizeOptions:()=>m.I,addTooltipOptions:()=>o.D});var n=e(38248),s=e(11404),r=e(22680),o=e(89654),m=e(71242),l=e(56675)},49149:(G,I,e)=>{"use strict";e.d(I,{$N:()=>t.$N,Lt:()=>t.Lt,Ly:()=>t.Ly,Nj:()=>t.Nj,ON:()=>t.ON,TC:()=>t.yL,dx:()=>t.dx,gs:()=>t.gs,lm:()=>t.lm,nT:()=>t.yL,ob:()=>t.ob,on:()=>t.on,vM:()=>t.vM,yg:()=>t.GR});var t=e(52622)},74738:(G,I,e)=>{"use strict";e.d(I,{v:()=>t});function t(){return{onKeyDown(n,s,r){const o=s.value;if(o.selection.isExpanded)return r();if(n.key==="k"&&n.ctrlKey){n.preventDefault();const m=o.anchorText.text,l=o.selection.anchor.offset,u=m.length-l;return s.deleteForward(u),!0}return r()}}}},99453:(G,I,e)=>{"use strict";e.d(I,{s:()=>s});const t=(r,o,m)=>{if(!r.length)return;const l=r.slice(0,-1).join("").length+r.length-1;return r.join(`
`).slice(o,l+m)},n=r=>r?.replace(/[\uFEFF]/g,"");function s(){const r={onCopy(o,m,l){o.preventDefault();const{document:i,selection:u}=m.value,{start:{offset:d},end:{offset:p}}=u,c=i.getLeafBlocksAtRange(u).toArray().map(f=>f.text),y=n(t(c,d,p));return y&&o.clipboardData&&o.clipboardData.setData("Text",y),!0},onPaste(o,m,l){if(o.preventDefault(),o.clipboardData){const u=n(o.clipboardData.getData("Text"))?.split(`
`);if(u&&u.length){m.insertText(u[0]);for(const d of u.slice(1))m.splitBlock().insertText(d)}}return!0}};return{...r,onCut(o,m,l){return r.onCopy(o,m,l),m.deleteAtRange(m.value.selection),!0}}}},1020:(G,I,e)=>{"use strict";e.d(I,{T:()=>d});var t=e(57746),n=e(82611),s=e(75226);const r=(0,t.Sn)("mod+["),o=(0,t.Sn)("shift+tab"),m=(0,t.Sn)("mod+]"),l="  ",i=(p,c,y)=>{const{startBlock:f,endBlock:P,selection:{start:{offset:a,key:E},end:{offset:g,key:h}}}=c.value;if(s.A.serialize(c.value)==="")return;p.preventDefault();const D=f.getFirstText();D&&a===0&&E===D.key&&g===D.text.length&&h===D.key||!f.equals(P)?u(c,"right"):c.insertText(l)},u=(p,c)=>{const y=p.value.selection,f=p.value.document.getLeafBlocksAtRange(y).toArray();if(c==="left")for(const P of f){const a=P.text.length-P.text.trimLeft().length,E=P.getFirstText().key,g={anchor:{key:E,offset:a,path:[]},focus:{key:E,offset:a,path:[]}};p.deleteBackwardAtRange(n.Q6.create(g),Math.min(l.length,a))}else{const{startText:P}=p.value,a=P.text.slice(0,y.start.offset),E=/^\s*$/.test(a);for(const g of f)p.insertTextByKey(g.getFirstText().key,0,l);E&&p.moveStartBackward(l.length)}};function d(){return{onKeyDown(p,c,y){if(r(p)||o(p))p.preventDefault(),u(c,"left");else if(m(p))p.preventDefault(),u(c,"right");else if(p.key==="Tab")i(p,c,y);else return y();return!0}}}},50955:(G,I,e)=>{"use strict";e.d(I,{e1:()=>r,vJ:()=>o.v,sW:()=>m.s,TA:()=>l.T,Om:()=>i.O,Ul:()=>u.U,l9:()=>d.l,De:()=>p.D,Pz:()=>c.Pz});var t=e(62938);const n={"[":"]","{":"}","(":")"},s="brace_match";function r(){return{onKeyDown(y,f,P){const{value:a}=f;switch(y.key){case"(":case"{":case"[":{const{start:{offset:E,key:g},end:{offset:h,key:D},focus:{offset:v}}=a.selection,C=a.focusText.text;if(a.selection.isExpanded)return y.preventDefault(),f.insertTextByKey(g,E,y.key).insertTextByKey(D,h+1,n[y.key]).moveEndBackward(1),!0;if(v===C.length||C[v]===" "||Object.values(n).includes(C[v])){y.preventDefault();const T=n[y.key],S={key:`${s}-${(0,t.A)()}`,type:`${s}-${T}`,anchor:{key:g,offset:E,object:"point"},focus:{key:D,offset:h+1,object:"point"},object:"annotation"};return f.insertText(y.key).insertText(T).addAnnotation(S).moveBackward(1),!0}break}case")":case"}":case"]":{const E=a.anchorText.text,g=a.selection.anchor.offset,h=E[g],D=y.key,v=`${s}-${D}`,C=a.annotations.find(T=>T?.type===v&&T.anchor.key===a.anchorText.key);if(C&&h===D&&!a.selection.isExpanded)return y.preventDefault(),f.moveFocusForward(1).removeAnnotation(C).moveAnchorForward(1),!0;break}case"Backspace":{const E=a.anchorText.text,g=a.selection.anchor.offset,h=E[g-1],D=E[g];if(n[h]&&n[h]===D)return y.preventDefault(),f.deleteBackward(1).deleteForward(1).focus(),!0}default:break}return P()}}}var o=e(74738),m=e(99453),l=e(1020),i=e(88295),u=e(4269),d=e(31589),p=e(41781),c=e(80903)},88295:(G,I,e)=>{"use strict";e.d(I,{O:()=>n});function t(s){let r=s.length-s.trimLeft().length;if(r){let o=s[0];for(;--r;)o+=s[0];return o}return""}function n(){return{onKeyDown(s,r,o){const m=r.value;if(m.selection.isExpanded)return o();if(s.key==="Enter"){s.preventDefault();const{startBlock:l}=m,i=l.text,u=t(i);return r.splitBlock().insertText(u).focus()}return o()}}}},4269:(G,I,e)=>{"use strict";e.d(I,{U:()=>t});function t({handler:n}){return{onKeyDown(s,r,o){return n&&s.key==="Enter"&&(s.shiftKey||s.ctrlKey)?(s.preventDefault(),n(s),r):o()}}}},31589:(G,I,e)=>{"use strict";e.d(I,{l:()=>s});var t=e(57746);const n=(0,t.Sn)("mod+l");function s(){return{onKeyDown(r,o,m){if(n(r)){r.preventDefault();const{focusBlock:l,document:i}=o.value;o.moveAnchorToStartOfBlock(),i.getNextBlock(l.key)?o.moveFocusToStartOfNextBlock():o.moveFocusToEndOfText()}else return m();return!0}}}},84694:(G,I,e)=>{"use strict";e.d(I,{A:()=>n});const n="prism-token"},41781:(G,I,e)=>{"use strict";e.d(I,{D:()=>c,R:()=>a});var t=e(28848),n=e.n(t),s=e(82611),r=e(84694),o=e(49568),m=e(96540);function l(E){return E.object==="block"&&E.type==="code_block"}function i(E){return"javascript"}function u(E,g,h){const{decoration:D}=E;if(D.type!==r.A)return h();const v=D.data.get("className");return m.createElement("span",{className:v},E.children)}class d extends(0,o.Record)({onlyIn:l,getSyntax:i,renderDecoration:u}){constructor(g){super(g)}}const p=d;function c(E={},g=n().languages){const h=new p(E);return{decorateNode:(D,v,C)=>{if(!h.onlyIn(D))return C();const T=s.eB.create(D),S=h.getSyntax(T),O=g[S];if(!O)return[];const b=T.getTexts().map(B=>B&&B.getText()).join(`
`),M=n().tokenize(b,O),A=a(M),R=v.value.data.set("tokens",A);return v.setData(R),y(h,M,T)},renderDecoration:(D,v,C)=>h.renderDecoration({children:D.children,decoration:D.decoration},v,C)}}function y(E,g,h){const D=h.getTexts(),v=[];let C=0,T=0;return D.forEach(S=>{T=C+S.getText().length;let O=0;function x(b,M){if(typeof b=="string"){if(M){const A=f({text:S,textStart:C,textEnd:T,start:O,end:O+b.length,className:`prism-token token ${M}`,block:h});A&&v.push(A)}O+=b.length}else if(M=`${M} ${b.type}`,b.alias&&(M+=" "+b.alias),typeof b.content=="string"){const A=f({text:S,textStart:C,textEnd:T,start:O,end:O+b.content.length,className:`prism-token token ${M}`,block:h});A&&v.push(A),O+=b.content.length}else for(let A=0;A<b.content.length;A+=1)x(b.content[A],M)}g.forEach(x),C=T+1}),v}function f({text:E,textStart:g,textEnd:h,start:D,end:v,className:C,block:T}){return D>=h||v<=g?null:(D=Math.max(D,g),v=Math.min(v,h),D-=g,v-=g,T.createDecoration({object:"decoration",anchor:{key:E.key,offset:D,object:"point"},focus:{key:E.key,offset:v,object:"point"},type:r.A,data:{className:C}}))}function P(E){return typeof E=="string"?[{content:E,types:[],aliases:[]}]:Array.isArray(E)?E.flatMap(g=>P(g)):E instanceof n().Token?P(E.content).flatMap(g=>{let h=[];return typeof E.alias=="string"?h=[E.alias]:h=E.alias??[],{content:g.content,types:[E.type,...g.types],aliases:[...h,...g.aliases]}}):[]}function a(E){const g=P(E);if(!g.length)return[];const h=g[0];h.prev=null,h.next=g.length>=2?g[1]:null,h.offsets={start:0,end:h.content.length};for(let v=1;v<g.length-1;v++)g[v].prev=g[v-1],g[v].next=g[v+1],g[v].offsets={start:g[v-1].offsets.end,end:g[v-1].offsets.end+g[v].content.length};const D=g[g.length-1];return D.prev=g.length>=2?g[g.length-2]:null,D.next=null,D.offsets={start:g.length>=2?g[g.length-2].offsets.end:0,end:g.length>=2?g[g.length-2].offsets.end+D.content.length:D.content.length},g}},80903:(G,I,e)=>{"use strict";e.d(I,{Pz:()=>U});var t=e(2543),n=e(96540),s=e(32196),r=e(40961),o=e(91793),m=e(60578),l=e(50774),i=e(49579);const u=w=>w.reduce((L,{items:V,label:K})=>(L.push({label:K,kind:l.I.GroupTitle}),V.reduce((k,j)=>(k.push(j),k),L)),[]),d=w=>w.reduce((L,V)=>L.length<V.label.length?V.label:L,""),p=(w,L,V)=>{const K=(0,i.A)(V,{font:w.typography.fontFamilyMonospace,fontSize:w.typography.bodySmall.fontSize,fontWeight:"normal"}),k=y(K.width,w),j=c(K.height,w),H=f(j,L);return{listWidth:k,listHeight:H,itemHeight:j}},c=(w,L)=>{const V=L.spacing.gridSize*2;return w+V},y=(w,L)=>{const V=L.spacing.gridSize*3;return Math.min(Math.max(w+V,200),800)},f=(w,L)=>{const V=Math.min(L.length,10),K=100,k=V*w;return Math.max(k,K)};var P=e(36663),a=e(40845);const E=(w,L,V)=>({typeaheadItem:(0,s.css)({label:"type-ahead-item",zIndex:11,padding:w.spacing(1,1,1,2),border:w.colors.border.medium,overflowY:"scroll",overflowX:"hidden",outline:"none",background:w.colors.background.secondary,color:w.colors.text.secondary,boxShadow:`0 0 20px ${w.v1.colors.dropdownShadow}`,visibility:V===!0?"visible":"hidden",width:"250px",minHeight:`${L+parseInt(w.spacing(.25),10)}px`,position:"relative",wordBreak:"break-word"})}),g=({item:w,height:L})=>{const V=w&&!!w.documentation,K=w?w.label:"",k=(0,P.G)(w?.documentation),j=(0,a.$j)(),H=E(j,L,V);return n.createElement("div",{className:(0,s.cx)([H.typeaheadItem])},n.createElement("b",null,K),n.createElement("hr",null),n.createElement("div",{dangerouslySetInnerHTML:{__html:k}}))};var h=e(23257),D=e.n(h),v=e(5313);const C=w=>({typeaheadItem:(0,s.css)({border:"none",background:"none",textAlign:"left",label:"type-ahead-item",height:"auto",fontFamily:w.typography.fontFamilyMonospace,padding:w.spacing(1,1,1,2),fontSize:w.typography.bodySmall.fontSize,textOverflow:"ellipsis",overflow:"hidden",zIndex:11,display:"block",whiteSpace:"nowrap",cursor:"pointer",[w.transitions.handleMotion("no-preference","reduce")]:{transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"}}),typeaheadItemSelected:(0,s.css)({label:"type-ahead-item-selected",backgroundColor:w.colors.background.secondary}),typeaheadItemMatch:(0,s.css)({label:"type-ahead-item-match",color:w.v1.palette.yellow,borderBottom:`1px solid ${w.v1.palette.yellow}`,padding:"inherit",background:"inherit"}),typeaheadItemGroupTitle:(0,s.css)({label:"type-ahead-item-group-title",color:w.colors.text.secondary,fontSize:w.typography.bodySmall.fontSize,lineHeight:w.typography.body.lineHeight,padding:w.spacing(1)})}),T=w=>{const L=(0,a.of)(C),{isSelected:V,item:K,prefix:k,style:j,onMouseEnter:H,onMouseLeave:J,onClickItem:X}=w,se=V?(0,s.cx)([L.typeaheadItem,L.typeaheadItemSelected]):(0,s.cx)([L.typeaheadItem]),ae=(0,s.cx)([L.typeaheadItemMatch]),ne=(0,s.cx)([L.typeaheadItemGroupTitle]),q=K.label||"";return K.kind===l.I.GroupTitle?n.createElement("li",{className:ne,style:j},n.createElement("span",null,q)):n.createElement("li",{role:"none"},n.createElement("button",{role:"menuitem",className:se,style:j,onMouseDown:X,onMouseEnter:H,onMouseLeave:J,type:"button"},K.highlightParts!==void 0?n.createElement(v.z,{text:q,highlightClassName:ae,highlightParts:K.highlightParts}):n.createElement(D(),{textToHighlight:q,searchWords:[k??""],autoEscape:!0,highlightClassName:ae})))},S=(w,L)=>w-L*Math.floor(w/L);class O extends n.PureComponent{constructor(){super(...arguments),this.listRef=(0,n.createRef)(),this.state={hoveredItem:null,typeaheadIndex:null,allItems:[],listWidth:-1,listHeight:-1,itemHeight:-1},this.componentDidMount=()=>{this.props.menuRef&&this.props.menuRef(this),document.addEventListener("selectionchange",this.handleSelectionChange);const L=u(this.props.groupedItems),V=d(L),{listWidth:K,listHeight:k,itemHeight:j}=p(this.context,L,V);this.setState({listWidth:K,listHeight:k,itemHeight:j,allItems:L})},this.componentWillUnmount=()=>{document.removeEventListener("selectionchange",this.handleSelectionChange)},this.handleSelectionChange=()=>{this.forceUpdate()},this.componentDidUpdate=(L,V)=>{if(this.state.typeaheadIndex!==null&&V.typeaheadIndex!==this.state.typeaheadIndex&&this.listRef&&this.listRef.current){if(this.state.typeaheadIndex===1){this.listRef.current.scrollToItem(0);return}this.listRef.current.scrollToItem(this.state.typeaheadIndex)}if((0,t.isEqual)(L.groupedItems,this.props.groupedItems)===!1){const K=u(this.props.groupedItems),k=d(K),{listWidth:j,listHeight:H,itemHeight:J}=p(this.context,K,k);this.setState({listWidth:j,listHeight:H,itemHeight:J,allItems:K,typeaheadIndex:null})}},this.onMouseEnter=L=>{this.setState({hoveredItem:L})},this.onMouseLeave=()=>{this.setState({hoveredItem:null})},this.moveMenuIndex=L=>{const V=this.state.allItems.length;if(V){const K=this.state.typeaheadIndex||0;let k=S(K+L,V);this.state.allItems[k].kind===l.I.GroupTitle&&(k=S(k+L,V)),this.setState({typeaheadIndex:k});return}},this.insertSuggestion=()=>{this.props.onSelectSuggestion&&this.state.typeaheadIndex!==null&&this.props.onSelectSuggestion(this.state.allItems[this.state.typeaheadIndex])}}static{this.contextType=m.D}get menuPosition(){if(!window.getSelection)return"";const L=window.getSelection(),V=L&&L.anchorNode;if(V&&V.parentElement){const K=V.parentElement.getBoundingClientRect(),k=window.scrollX,j=window.scrollY;return`position: absolute; display: flex; top: ${K.top+j+K.height+6}px; left: ${K.left+k-2}px`}return""}render(){const{prefix:L,isOpen:V=!1,origin:K}=this.props,{allItems:k,listWidth:j,listHeight:H,itemHeight:J,hoveredItem:X,typeaheadIndex:se}=this.state,ae=b(this.context),ne=X||se,q=k[X||se||0];return n.createElement(x,{origin:K,isOpen:V,style:this.menuPosition},n.createElement("ul",{role:"menu",className:ae.typeahead,"data-testid":"typeahead"},n.createElement(o.Y1,{ref:this.listRef,itemCount:k.length,itemSize:J,itemKey:ee=>{const z=k&&k[ee];return z?`${ee}-${z.label}`:`${ee}`},width:j,height:H},({index:ee,style:z})=>{const te=k&&k[ee];return te?n.createElement(T,{onClickItem:()=>this.props.onSelectSuggestion?this.props.onSelectSuggestion(te):{},isSelected:se===null?!1:k[se]===te,item:te,prefix:L,style:z,onMouseEnter:()=>this.onMouseEnter(ee),onMouseLeave:this.onMouseLeave}):null})),ne&&n.createElement(g,{height:H,item:q}))}}class x extends n.PureComponent{constructor(L){super(L);const{index:V=0,origin:K="query",style:k}=L;this.node=document.createElement("div"),this.node.setAttribute("style",k),this.node.classList.add("slate-typeahead",`slate-typeahead-${K}-${V}`),document.body.appendChild(this.node)}componentWillUnmount(){document.body.removeChild(this.node)}render(){return this.props.isOpen?(this.node.setAttribute("style",this.props.style),this.node.classList.add("slate-typeahead--open"),r.createPortal(this.props.children,this.node)):(this.node.classList.remove("slate-typeahead--open"),null)}}const b=w=>({typeahead:(0,s.css)({maxHeight:300,overflowY:"auto",strong:{color:w.v1.palette.yellow}})});var M=e(72307),A=e(75071),R=e(84694);const B=250;function U({onTypeahead:w,cleanText:L,onWillApplySuggestion:V,portalOrigin:K}){let k,j={groupedItems:[],typeaheadPrefix:"",typeaheadContext:"",typeaheadText:""};const H=(0,t.debounce)(W,B),J=X=>{j={...j,...X}};return{onBlur:(X,se,ae)=>(j={...j,groupedItems:[]},ae()),onClick:(X,se,ae)=>(j={...j,groupedItems:[]},ae()),onKeyDown:(X,se,ae)=>{const q=j.groupedItems.length;switch(X.key){case"Escape":{if(q)return X.preventDefault(),j={...j,groupedItems:[]},se.insertText("");break}case"ArrowDown":case"ArrowUp":if(q){X.preventDefault(),k.moveMenuIndex(X.key==="ArrowDown"?1:-1);return}break;case"Enter":{if(!(X.shiftKey||X.ctrlKey)&&q)return X.preventDefault(),k.insertSuggestion();break}case"Tab":{if(q)return X.preventDefault(),k.insertSuggestion();break}default:{X.key.length===1&&H(se,J,w,L);break}}return ae()},commands:{selectSuggestion:(X,se)=>{const ae=j.groupedItems;if(!ae||!ae.length)return X;const ne=X.applyTypeahead(se);return H(X,J,w,L),ne},applyTypeahead:(X,se)=>{let ae=se.insertText||se.label;const ne=se.kind==="function",q=se.move||0,ee=q>0?q:0,z=q<0?-q:0,{typeaheadPrefix:te,typeaheadText:ie,typeaheadContext:ce}=j;V&&(ae=V(ae,{groupedItems:j.groupedItems,typeaheadContext:ce,typeaheadPrefix:te,typeaheadText:ie}));const{forward:ue,backward:fe}=N(ae,te,ie,ne,se.deleteBackwards,L);if(ae.match(/\n/)){const Te=(0,M.dF)(ae);return X.deleteBackward(fe).deleteForward(ue).insertFragment(Te).focus(),X}return j={...j,groupedItems:[]},X.snapshotSelection().deleteBackward(fe).deleteForward(ue).insertText(ae).moveForward(ee).moveBackward(z).focus(),X}},renderEditor(X,se,ae){if(se.value.selection.isExpanded)return ae();const ne=ae();return n.createElement(n.Fragment,null,ne,n.createElement(O,{menuRef:q=>k=q,origin:K,prefix:j.typeaheadPrefix,isOpen:!!j.groupedItems.length,groupedItems:j.groupedItems,onSelectSuggestion:se.selectSuggestion}))}}}const W=async(w,L,V,K)=>{if(!V)return;const{value:k}=w,{selection:j}=k,H=k.document.getClosestBlock(k.focusBlock.key),J=k.selection.start.offset-1,X=H&&H.getDecorations(w),se=X?X.filter(fe=>fe.start.offset<=J&&fe.end.offset>J&&fe.type===R.A).toArray():[],ae=X&&X.filter(fe=>fe.end.offset<=J&&fe.type===R.A&&fe.data.get("className").includes("label-key")).last(),ne=ae&&k.focusText.text.slice(ae.start.offset,ae.end.offset),q=se.map(fe=>fe.data.get("className")).join(" ").split(" ").filter(fe=>fe.length);let ee=k.focusText.text,z=ee.slice(0,j.focus.offset);se.length&&(ee=k.focusText.text.slice(se[0].start.offset,se[0].end.offset),z=k.focusText.text.slice(se[0].start.offset,j.focus.offset));const te=z.match(/(?:!?=~?"?|")(.*)/);te?z=te[1]:K&&(z=K(z));const{suggestions:ie,context:ce}=await V({prefix:z,text:ee,value:k,wrapperClasses:q,labelKey:ne||void 0,editor:w}),ue=ie.map(fe=>{if(!fe.items)return fe;const Te=fe.searchFunctionType||(fe.prefixMatch?A.T.Prefix:A.T.Word),he=A.H[Te];let de={...fe};return z&&(fe.skipFilter||(de.items=de.items.filter(le=>(le.filterText||le.label).length>=z.length),de.items=he(de.items,z)),de.items=de.items.filter(le=>!(le.insertText===z||(le.filterText??le.label)===z))),fe.skipSort||(de.items=(0,t.sortBy)(de.items,le=>le.sortText===void 0?le.sortValue!==void 0?le.sortValue:le.label:le.sortText||le.label)),de}).filter(fe=>fe.items&&fe.items.length);L({groupedItems:ue,typeaheadPrefix:z,typeaheadContext:ce,typeaheadText:ee}),w.blur().focus()};function N(w,L,V,K,k,j){const H=k||L.length,J=j?j(V):V,X=V.indexOf(L),se=X>-1?J.length-X-L.length:J.length-L.length;return{forward:!!(L&&se>0||w===V)&&!K?se+X:0,backward:H}}},17425:(G,I,e)=>{"use strict";e.d(I,{k:()=>g});var t=e(94659),n=e(96540),s=e(40845);function r(h){return(0,t.css)({".panel-options-group":{borderBottom:`1px solid ${h.colors.border.weak}`},".panel-options-group__header":{padding:h.spacing(1,2,1,1),position:"relative",display:"flex",alignItems:"center",cursor:"pointer",fontWeight:500,color:h.colors.text.primary,"&:hover":{background:h.colors.emphasize(h.colors.background.primary,.03)}},".panel-options-group__icon":{color:h.colors.text.secondary,marginRight:h.spacing(1),padding:h.spacing(0,.9,0,.6)},".panel-options-group__title":{position:"relative"},".panel-options-group__body":{padding:h.spacing(1,2,1,4)}})}function o(h){return(0,t.css)({".card-section":{marginBottom:h.spacing(4)},".card-list":{display:"flex",flexDirection:"row",flexWrap:"wrap",listStyleType:"none"},".card-item":{display:"block",height:"100%",background:h.colors.background.secondary,boxShadow:"none",padding:h.spacing(2),borderRadius:"4px","&:hover":{background:h.colors.emphasize(h.colors.background.secondary,.03)},".label-tag":{marginLeft:h.spacing(1),fontSize:"11px",padding:"2px 6px"}},".card-item-body":{display:"flex",overflow:"hidden"},".card-item-details":{overflow:"hidden"},".card-item-header":{marginBottom:h.spacing(2)},".card-item-type":{color:h.colors.text.secondary,textTransform:"uppercase",fontSize:h.typography.size.sm,fontWeight:h.typography.fontWeightMedium},".card-item-badge":{margin:"6px 0"},".card-item-notice":{fontSize:h.typography.size.sm},".card-item-name":{color:h.colors.text.primary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-label":{marginLeft:h.spacing(1)},".card-item-sub-name":{color:h.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-sub-name--header":{color:h.colors.text.secondary,textTransform:"uppercase",marginBottom:h.spacing(2),fontSize:h.typography.size.sm,fontWeight:"bold"},".card-list-layout-grid":{".card-item-type":{display:"inline-block"},".card-item-notice":{fontSize:h.typography.size.sm,display:"inline-block",marginLeft:h.spacing(2)},".card-item-header-action":{float:"right"},".card-item-wrapper":{width:"100%",padding:h.spacing(0,2,2,0)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item-figure":{margin:h.spacing(0,2,2,0),height:"80px",img:{width:"80px"}},".card-item-name":{fontSize:h.typography.h3.fontSize},[h.breakpoints.up("md")]:{".card-item-wrapper":{width:"50%"}},[h.breakpoints.up("lg")]:{".card-item-wrapper":{width:"33.333333%"}},"&.card-list-layout-grid--max-2-col":{[h.breakpoints.up("lg")]:{".card-item-wrapper":{width:"50%"}}}},".card-list-layout-list":{".card-item-wrapper":{padding:0,width:"100%",marginBottom:h.spacing(1)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item":{borderRadius:"2px"},".card-item-header":{float:"right",textAlign:"right"},".card-item-figure":{margin:h.spacing(0,2,0,0),img:{width:"48px"}},".card-item-name":{fontSize:h.typography.h4.fontSize},".card-item-sub-name":{fontSize:h.typography.size.sm},".layout-selector":{marginRight:0}}})}var m=e(16797);function l(h){return(0,t.css)({html:{MsOverflowStyle:"scrollbar",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",height:"100%",fontSize:`${h.typography.htmlFontSize}px`,fontFamily:h.typography.fontFamily,lineHeight:h.typography.body.lineHeight,fontKerning:"normal"},":root":{colorScheme:h.colors.mode},body:{height:"100%",width:"100%",position:"absolute",color:h.colors.text.primary,backgroundColor:h.colors.background.canvas,...i(h.typography.body)},"h1, .h1":i(h.typography.h1),"h2, .h2":i(h.typography.h2),"h3, .h3":i(h.typography.h3),"h4, .h4":i(h.typography.h4),"h5, .h5":i(h.typography.h5),"h6, .h6":i(h.typography.h6),p:{margin:h.spacing(0,0,2)},button:{letterSpacing:h.typography.body.letterSpacing,"&:focus-visible":(0,m.getFocusStyles)(h),"&:focus":{outline:"none"}},small:{fontSize:h.typography.bodySmall.fontSize},"b, strong":{fontWeight:h.typography.fontWeightMedium},em:{fontStyle:"italic",color:h.colors.text.primary},cite:{fontStyle:"normal"},".muted":{color:h.colors.text.secondary},"a.muted:hover, a.muted:focus":{color:h.colors.text.primary},".text-warning":{color:h.colors.warning.text,"&:hover, &:focus":{color:h.colors.emphasize(h.colors.warning.text,.15)}},".text-error":{color:h.colors.error.text,"&:hover, &:focus":{color:h.colors.emphasize(h.colors.error.text,.15)}},".text-success":{color:"$success-text-color","&:hover, &:focus":{color:h.colors.emphasize(h.colors.success.text,.15)}},a:{cursor:"pointer",color:h.colors.text.primary,textDecoration:"none","&:focus":{outline:"none"},"&:focus-visible":(0,m.getFocusStyles)(h),"&:[disabled]":{cursor:"default",pointerEvents:"none !important"}},".text-link":{textDecoration:"underline"},".text-left":{textAlign:"left"},".text-right":{textAlign:"right"},".text-center":{textAlign:"center"},".highlight-search-match":{background:h.components.textHighlight.background,color:h.components.textHighlight.text,padding:0}})}function i(h){return{margin:0,fontSize:h.fontSize,lineHeight:h.lineHeight,fontWeight:h.fontWeight,letterSpacing:h.letterSpacing,fontFamily:h.fontFamily,marginBottom:"0.45em"}}function u(h){return(0,t.css)({"iframe.intercom-borderless-frame":{colorScheme:h.colors.mode}})}function d(h){return(0,t.css)({"input, button, select, textarea":{fontFamily:h.typography.body.fontFamily,fontSize:h.typography.body.fontSize,fontWeight:h.typography.body.fontWeight,lineHeight:h.typography.body.lineHeight},"input, select":{backgroundColor:h.components.input.background,color:h.components.input.text,border:"none",boxShadow:"none"},textarea:{height:"auto"},"input[type='file'], input[type='image'], input[type='submit'], input[type='reset'], input[type='button'], input[type='radio'], input[type='checkbox']":{width:"auto"}})}function p(h){return(0,t.css)({".gf-form-select-box__control":{width:"100%",marginRight:h.spacing(.5),backgroundColor:h.components.input.background,border:`1px solid ${h.components.input.borderColor}`,borderRadius:h.shape.radius.default,color:h.components.input.text,cursor:"default",height:h.spacing(4),outline:"none",overflow:"hidden",position:"relative"},".gf-form-select-box__control--is-focused":{backgroundColor:h.components.input.background,borderColor:h.colors.primary.border,outline:"none",boxShadow:`inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px ${h.colors.primary.border}`},".gf-form-select-box__control--is-disabled":{backgroundColor:h.colors.action.disabledBackground},".gf-form-select-box__control--menu-right":{".gf-form-select-box__menu":{right:0,left:"unset"}},".gf-form-select-box__input":{input:{lineHeight:"inherit"}},".gf-form-select-box__menu":{background:h.colors.background.primary,boxShadow:h.shadows.z3,position:"absolute",zIndex:h.zIndex.dropdown,minWidth:"100%","&-notice--no-options":{backgroundColor:h.components.input.background,padding:"10px"}},".gf-form-select-box__menu-list":{overflowY:"auto",maxHeight:"300px",maxWidth:"600px"},".tag-filter .gf-form-select-box__menu":{width:"100%"},".gf-form-select-box__multi-value":{display:"inline",margin:"0 6px 0 0",cursor:"pointer"},".gf-form-select-box__multi-value__remove":{textAlign:"center",display:"inline-block",marginLeft:"2px",position:"relative"},".gf-form-select-box__multi-value__label":{display:"inline",verticalAlign:"middle"},".gf-form-select-box__option":{borderLeft:"2px solid transparent",whiteSpace:"nowrap",backgroundColor:h.components.input.background,"&.gf-form-select-box__option--is-focused":{color:h.colors.text.primary,background:h.colors.action.hover,borderImage:h.colors.gradients.brandVertical,borderImageSlice:1,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"},"&.gf-form-select-box__option--is-selected":{".fa":{color:h.colors.text.primary}}},".gf-form-select-box__placeholder":{color:h.colors.text.disabled},".gf-form-select-box__control--is-focused .gf-form-select-box__placeholder":{display:"none"},".gf-form-select-box__value-container":{display:"inline-block",padding:"6px 20px 6px 10px",verticalAlign:"middle","> div":{display:"inline-block",verticalAlign:"middle"}},".gf-form-select-box__indicators":{position:"absolute",height:"100%",right:"8px",top:"1px",display:"inline-block",textAlign:"right"},".gf-form-input--form-dropdown":{padding:0,border:0,overflow:"visible",position:"relative"},".gf-form--has-input-icon":{".gf-form-select-box__value-container":{paddingLeft:"30px"}},".gf-form-select-box__desc-option":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%"},".gf-form-select-box__desc-option__body":{display:"flex",flexDirection:"column",flexGrow:1,paddingRight:"10px",fontWeight:h.typography.fontWeightMedium},".gf-form-select-box__desc-option__desc":{fontWeight:"normal",fontSize:h.typography.bodySmall.fontSize,color:h.colors.text.secondary},".gf-form-select-box__desc-option__img":{width:"16px",marginRight:"10px"},".gf-form-select-box__option-group__header":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${h.v1.palette.dark9}`,textTransform:"capitalize",".fa":{paddingRight:"2px"}},".gf-form-select-box-button-select":{height:"auto"},".select-button":{display:"flex",alignItems:"center"}})}function c(h){return(0,t.css)({})}function y(h){const D=h.breakpoints.values.xxl+h.spacing.gridSize*2+h.components.sidemenu.width;return(0,t.css)({".grafana-app":{display:"flex",alignItems:"stretch",position:"absolute",width:"100%",height:"100%",top:0,left:0},".main-view":{position:"relative",display:"flex",flexDirection:"column",flexGrow:1,height:"100%",flex:"1 1 0",minWidth:0},".page-scrollbar-content":{display:"flex",minHeight:"100%",flexDirection:"column",width:"100%",height:"100%"},".page-container":{flexGrow:1,flexBasis:"100%",paddingLeft:h.spacing(2),paddingRight:h.spacing(2),[h.breakpoints.up("sm")]:{margin:h.spacing(0,1)},[h.breakpoints.up("md")]:{margin:h.spacing(0,2)},[`@media (min-width: ${D}px)`]:{maxWidth:`${h.breakpoints.values.xxl}px`,marginLeft:"auto",marginRight:"auto",width:"100%"}},".page-full":{marginLeft:h.spacing(2),paddingLeft:h.spacing(2),paddingRight:h.spacing(2)},".page-body":{padding:h.spacing(1),background:h.components.panel.background,border:`1px solid ${h.components.panel.borderColor}`,marginBottom:"32px",[h.breakpoints.up("md")]:{padding:h.spacing(2)},[h.breakpoints.up("lg")]:{padding:h.spacing(3)}},".page-heading":{fontSize:h.typography.h4.fontSize,marginTop:0,marginBottom:h.spacing(2)},".page-action-bar":{marginBottom:h.spacing(2),display:"flex",alignItems:"flex-start",gap:h.spacing(2)},".page-action-bar--narrow":{marginBottom:0},".page-action-bar__spacer":{width:h.spacing(2),flexGrow:1},".page-sub-heading":{marginBottom:h.spacing(2)},".page-sub-heading-icon":{marginLeft:h.spacing(1),marginTop:h.spacing(.5)},".page-hidden":{display:"none"}})}function f(h){return(0,t.css)({".rc-time-picker-input,.rc-time-picker-panel-input-wrap,.rc-time-picker-panel-inner":{backgroundColor:h.components.input.background,color:h.colors.text.secondary,borderColor:h.components.input.borderColor,fontSize:h.typography.body.fontSize},".rc-time-picker-input":{padding:h.spacing(0,1),height:h.spacing(4)},".rc-time-picker-panel":{width:"176px"},".rc-time-picker-panel-select":{width:"50%","&:only-child":{width:"100%"},".rc-time-picker-panel-select-option-selected":{backgroundColor:h.colors.background.secondary},"li:hover":{backgroundColor:h.colors.background.secondary}},".rc-time-picker-panel-narrow":{maxWidth:"none"}})}var P=e(72129);const a=h=>(0,t.css)({".react-loading-skeleton":P.Q});function E(h){return(0,t.css)({".uplot":{fontFamily:"inherit"},".u-select":{background:"rgba(120, 120, 130, 0.2)"},".u-hz .u-cursor-x, .u-vt .u-cursor-y":{borderRight:"1px dashed rgba(120, 120, 130, 0.5)"},".u-hz .u-cursor-y, .u-vt .u-cursor-x":{borderBottom:"1px dashed rgba(120, 120, 130, 0.5)"},".shared-crosshair:not(.plot-active) .u-cursor-pt":{display:"none !important"}})}function g(){const h=(0,s.$j)();return n.createElement(t.Global,{styles:[l(h),u(h),d(h),y(h),o(h),r(h),c(h),a(h),f(h),E(h),p(h)]})}},40845:(G,I,e)=>{"use strict";e.d(I,{$j:()=>y,DP:()=>c,IS:()=>f,SL:()=>d,cV:()=>p,fq:()=>a,of:()=>P});var t=e(4146),n=e.n(t),s=e(47078),r=e.n(s),o=e(96540),m=e(60578),l=e(3911);let i=null;const u=new WeakMap,d=E=>{const g=h=>{const D=i||m.D;return o.createElement(D.Consumer,null,v=>o.createElement(E,{...h,theme:v.v1}))};return g.displayName=`WithTheme(${E.displayName})`,n()(g,E),g},p=E=>{const g=h=>{const D=i||m.D;return o.createElement(D.Consumer,null,v=>o.createElement(E,{...h,theme:v}))};return g.displayName=`WithTheme(${E.displayName})`,n()(g,E),g};function c(){return(0,o.useContext)(i||m.D).v1}function y(){return(0,o.useContext)(i||m.D)}function f(E){const g=c();let h=u.get(E);return h||(h=(0,l.N)(E),u.set(E,h)),h(g)}function P(E,...g){const h=y();let D=u.get(E);return D||(D=r()(E,{maxSize:10}),u.set(E,D)),D(h,...g)}const a=E=>(i=o.createContext(E),()=>{i=null})},7918:(G,I,e)=>{"use strict";e.d(I,{kH:()=>i.k,Dx:()=>t.D,O4:()=>o,mG:()=>m,fq:()=>n.fq,YF:()=>u,N3:()=>l.N,IS:()=>n.IS,of:()=>n.of,DP:()=>n.DP,$j:()=>n.$j,SL:()=>n.SL,cV:()=>n.cV});var t=e(60578),n=e(40845),s=e(75972);let r;const o=(d="dark")=>r?r(d):(0,s.a)({colors:{mode:d}}).v1,m=d=>(r=d,()=>{r=null});var l=e(3911),i=e(17425),u=e(16797)},16797:(G,I,e)=>{"use strict";e.r(I),e.d(I,{cardChrome:()=>n,focusCss:()=>i,getFocusStyles:()=>d,getMouseFocusStyles:()=>u,getTooltipContainerStyles:()=>p,hoverColor:()=>s,listItem:()=>r,listItemSelected:()=>o,mediaUp:()=>m});var t=e(84140);function n(c){return`
    background: ${c.colors.background.secondary};
    &:hover {
      background: ${s(c.colors.background.secondary,c)};
    }
    box-shadow: ${c.components.panel.boxShadow};
    border-radius: ${c.shape.radius.default};
`}function s(c,y){return y.isDark?(0,t.A)(c).brighten(2).toString():(0,t.A)(c).darken(2).toString()}function r(c){return`
  background: ${c.colors.background.secondary};
  &:hover {
    background: ${s(c.colors.background.secondary,c)};
  }
  box-shadow: ${c.components.panel.boxShadow};
  border-radius: ${c.shape.radius.default};
`}function o(c){return`
    background: ${s(c.colors.background.secondary,c)};
    color: ${c.colors.text.maxContrast};
`}function m(c){return`only screen and (min-width: ${c})`}const l=c=>c.hasOwnProperty("v1"),i=c=>{const y=l(c),f=y?c.colors.background.canvas:c.colors.bodyBg,P=y?c.colors.primary.main:c.colors.formFocusOutline;return`
  outline: 2px dotted transparent;
  outline-offset: 2px;
  box-shadow: 0 0 0 2px ${f}, 0 0 0px 4px ${P};
  transition-property: outline, outline-offset, box-shadow;
  transition-duration: 0.2s;
  transition-timing-function: cubic-bezier(0.19, 1, 0.22, 1);`};function u(c){return{outline:"none",boxShadow:"none"}}function d(c){return{outline:"2px dotted transparent",outlineOffset:"2px",boxShadow:`0 0 0 2px ${c.colors.background.canvas}, 0 0 0px 4px ${c.colors.primary.main}`,transitionTimingFunction:"cubic-bezier(0.19, 1, 0.22, 1)",transitionDuration:"0.2s",transitionProperty:"outline, outline-offset, box-shadow"}}const p=c=>({overflow:"hidden",background:c.colors.background.secondary,boxShadow:c.shadows.z2,maxWidth:"800px",padding:c.spacing(1),borderRadius:c.shape.radius.default,zIndex:c.zIndex.tooltip})},3911:(G,I,e)=>{"use strict";e.d(I,{N:()=>s});var t=e(47078),n=e.n(t);function s(r){return n()(r)}},50774:(G,I,e)=>{"use strict";e.d(I,{I:()=>t});var t=(n=>(n.GroupTitle="GroupTitle",n))(t||{})},29621:()=>{"use strict"},4025:(G,I,e)=>{"use strict";e.d(I,{GO:()=>r,SS:()=>o,Uo:()=>t.Uo,lV:()=>m,rJ:()=>s});var t=e(8887),n=e(11261);const s=l=>["xs","sm","md","lg","xl","xxl","xxxl"].includes(l),r=()=>Object.keys(t.az);function o(l){return m(l?.type)}function m(l){if(l)switch(l){case n.PU.time:return"clock-nine";case n.PU.string:return"font";case n.PU.number:return"calculator-alt";case n.PU.boolean:return"toggle-on";case n.PU.trace:return"info-circle";case n.PU.enum:return"list-ol";case n.PU.geo:return"map-marker";case n.PU.other:return"brackets-curly"}return"question-circle"}},80186:(G,I,e)=>{"use strict";e.r(I),e.d(I,{CompletionItemKind:()=>o.I,getAvailableIcons:()=>i.GO,getFieldTypeIcon:()=>i.SS,getFieldTypeIconName:()=>i.lV,isIconSize:()=>i.rJ,toIconName:()=>i.Uo});var t=e(64611),n=e.n(t),P={};for(const a in t)a!=="default"&&(P[a]=()=>t[a]);e.d(I,P);var s=e(11866),r=e.n(s),P={};for(const a in s)a!=="default"&&(P[a]=()=>s[a]);e.d(I,P);var o=e(50774),m=e(29621),l=e.n(m),P={};for(const a in m)["default","CompletionItemKind"].indexOf(a)<0&&(P[a]=()=>m[a]);e.d(I,P);var i=e(4025),u=e(19932),d=e.n(u),P={};for(const a in u)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(a)<0&&(P[a]=()=>u[a]);e.d(I,P);var p=e(72389),c=e.n(p),P={};for(const a in p)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(a)<0&&(P[a]=()=>p[a]);e.d(I,P);var y=e(65484),f=e.n(y),P={};for(const a in y)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(a)<0&&(P[a]=()=>y[a]);e.d(I,P)},11866:()=>{"use strict"},65484:()=>{"use strict"},19932:()=>{"use strict"},72389:()=>{"use strict"},64611:()=>{"use strict"},40321:(G,I,e)=>{"use strict";e.d(I,{Q:()=>t});const t=(n,s)=>{n.key==="Tab"||n.altKey||n.ctrlKey||n.metaKey||(n.stopPropagation(),n.key==="Escape"&&s())}},24284:(G,I,e)=>{"use strict";e.d(I,{Ih:()=>E,Mk:()=>o,Tj:()=>p,UJ:()=>d,Xw:()=>m,ct:()=>u,mZ:()=>a,nO:()=>i,sg:()=>P,xj:()=>l});var t=e(2543),n=e.n(t),s=e(84140);const r=4,o="rgba(0, 211, 255, 1)",m="rgba(11, 237, 50, 1)",l="rgba(237, 46, 24, 1)",i="rgba(150, 150, 150, 1)",u="rgba(247, 149, 32, 1)",d=.09,p=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"];function c(g){const h=(0,t.map)(g,y),D=(0,t.sortBy)(h,["h"]),v=(0,t.chunk)(D,r),C=(0,t.map)(v,S=>(0,t.sortBy)(S,"l")),T=(0,t.flattenDeep)((0,t.zip)(...C));return(0,t.map)(T,f)}function y(g){return(0,s.A)(g).toHsl()}function f(g){return(0,s.A)(g).toHexString()}function P(g){return(0,s.A)(g).getBrightness()>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}function a(g,h){const D=(0,s.A)(g),v=D.getBrightness();return D.getAlpha()<.3?h?"rgb(247, 248, 250)":"rgb(32, 34, 38)":v>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}let E=c(p)},14555:(G,I,e)=>{"use strict";e.d(I,{F:()=>n,J:()=>t});const t=s=>s().map(r=>({label:r.title,ariaLabel:r.title,url:r.href,target:r.target,icon:`${r.target==="_blank"?"external-link-alt":"link"}`,onClick:r.onClick})),n=s=>/\/explore\?.*&(left|right)=\[(.*\,){2,}(.*){1}\]/.test(s)},40621:(G,I,e)=>{"use strict";e.d(I,{h:()=>t});function t(n,s,r){}},53550:(G,I,e)=>{"use strict";e.d(I,{i:()=>t});function t(n){const r=n.lastIndexOf("."),o=n.substring(r),m=n.substring(0,r);return m.length<16?n:`${m.substring(0,16)}...${o}`}},9830:(G,I,e)=>{"use strict";e.d(I,{I:()=>s});var t=e(2543),n=e.n(t);function s(r,o){let m=0,l=r.indexOf(o);o=o.replace(/\s/g,"");const i=[];if(l!==-1)return{distance:0,found:!0,ranges:[{start:l,end:l+o.length-1}]};for(const u of o){const d=r.indexOf(u,l);if(d===-1)return{distance:1/0,ranges:[],found:!1};if(l!==-1&&(m+=d-l),l=d+1,i.length===0)i.push({start:d,end:d});else{const p=(0,t.last)(i);d===p.end+1?p.end++:i.push({start:d,end:d})}}return{distance:m,ranges:i,found:!0}}},76412:(G,I,e)=>{"use strict";e.d(I,{t:()=>l,x:()=>o});var t=e(72635),n=e(96540),s=e(32389);function r(){typeof t.default.options.resources!="object"&&t.default.use(s.r9).init({resources:{},returnEmptyString:!1,lng:"en-US"})}const o=i=>(r(),n.createElement(s.x6,{...i})),m=t.default.t,l=(i,u,d)=>(r(),m(i,u,d))},99598:(G,I,e)=>{"use strict";e.d(I,{xj:()=>o.xj,Mk:()=>o.Mk,bk:()=>t,Pw:()=>m.Pw,nO:()=>o.nO,uc:()=>g,Xw:()=>o.Xw,ct:()=>o.ct,UJ:()=>o.UJ,zt:()=>r,yx:()=>l.yx,Tt:()=>f.T,DB:()=>P.DB,hF:()=>E.h,Vr:()=>c.Vr,Tj:()=>o.Tj,h:()=>a.h,It:()=>h.I,Yc:()=>c.Yc,kl:()=>p.k,XJ:()=>d.X,yC:()=>u.yC,JF:()=>u.JF,MC:()=>u.MC,mZ:()=>o.mZ,sg:()=>o.sg,K:()=>m.K,Fr:()=>i.F,Jl:()=>i.J,dF:()=>l.dF,mO:()=>l.mO,kD:()=>c.kD,RP:()=>m.RP,Ih:()=>o.Ih,CH:()=>y.C,tf:()=>m.tf});var t={};e.r(t),e.d(t,{getNextCharacter:()=>s,getPreviousCousin:()=>n}),typeof window<"u"&&"Element"in window&&!Element.prototype.closest&&(Element.prototype.closest=function(D){const v=(this.document||this.ownerDocument).querySelectorAll(D);let C=this,T;do{for(T=v.length;--T>=0&&v.item(T)!==C;);C=C.parentElement}while(T<0&&C);return C});function n(D,v){let C=D.parentElement.previousSibling,T;for(;C;){if(T=C.querySelector(v),T)return T;C=C.previousSibling}}function s(D){const v=(D||window).getSelection();if(!v||!v.anchorNode)return null;const C=v.getRangeAt(0),T=v.anchorNode.textContent,S=C.startOffset;return T.slice(S,S+1)}var r=e(67892),o=e(24284),m=e(29734),l=e(72307),i=e(14555),u=e(69613),d=e(5260),p=e(90914),c=e(29413),y=e(69731),f=e(75071),P=e(88838),a=e(91040),E=e(40621),g=(D=>(D.id="id",D.title="title",D.subTitle="subTitle",D.mainStat="mainStat",D.secondaryStat="secondaryStat",D.source="source",D.target="target",D.detail="detail__",D.arc="arc__",D.color="color",D))(g||{}),h=e(9830)},91040:(G,I,e)=>{"use strict";e.d(I,{h:()=>r});var t=e(2543),n=e.n(t);const s=(0,t.throttle)((...o)=>{console.log(...o)},500),r=o=>{let m=!1;return typeof window<"u"&&(m=window.localStorage.getItem("grafana.debug")==="true"),{logger:(l,i=!1,...u)=>{},enable:()=>m=!0,disable:()=>m=!1,isEnabled:()=>m}}},29413:(G,I,e)=>{"use strict";e.d(I,{Vr:()=>l,Yc:()=>o,kD:()=>m});let t;const n=new Map,s=500;let r="";function o(){return t||(t=document.createElement("canvas").getContext("2d")),t}function m(i,u,d=400){const p=`${d} ${u}px 'Inter'`,c=i+p,y=n.get(c);if(y)return y;const f=o();r!==p&&(f.font=r=p);const P=f.measureText(i);return n.size===s&&n.clear(),n.set(c,P),P}function l(i,u,d,p,c,y){const f=m(i,14,y),P=u/(f.width+2)*14,a=d/p,E=Math.min(a,P);return Math.min(E,c??E)}},67892:(G,I,e)=>{"use strict";e.r(I),e.d(I,{getChildId:()=>n,renderOrCallToRender:()=>s});var t=e(96540);function n(r){let o;const m=t.Children.only(r);return"id"in m?.props?o=m.props.id:"inputId"in m.props&&(o=m?.props.inputId),typeof o=="string"?o:void 0}function s(r,o){if(t.isValidElement(r)||typeof r=="string"||typeof r=="number")return r;if(typeof r=="function"&&o)return r(o);throw new Error(`${r} is not a React element nor a function that returns React element`)}},5260:(G,I,e)=>{"use strict";e.d(I,{X:()=>n});let t=null;function n(){if(t!==null)return t;if(typeof document<"u"){const s=document.createElement("div"),r={width:"100px",height:"100px",position:"absolute",top:"-9999px",overflow:"scroll",MsOverflowStyle:"scrollbar"};Object.keys(r).map(o=>{s.style[o]=r[o]}),document.body.appendChild(s),t=s.offsetWidth-s.clientWidth,document.body.removeChild(s)}else t=0;return t||0}},75071:(G,I,e)=>{"use strict";e.d(I,{H:()=>m,T:()=>n});var t=e(9830),n=(l=>(l.Word="Word",l.Prefix="Prefix",l.Fuzzy="Fuzzy",l))(n||{});const m={Word:(l,i)=>l.filter(u=>(u.filterText||u.label).includes(i)),Prefix:(l,i)=>l.filter(u=>(u.filterText||u.label).startsWith(i)),Fuzzy:(l,i)=>(i=i.toLowerCase(),l.filter(u=>{const{distance:d,ranges:p,found:c}=(0,t.I)(u.label.toLowerCase(),i);return c?(u.sortValue=d,u.highlightParts=p,!0):!1}))}},72129:(G,I,e)=>{"use strict";e.d(I,{Q:()=>r,j:()=>o});var t=e(32196),n=e(96540);const r={animationName:(0,t.keyframes)({"0%":{opacity:0},"100%":{opacity:1}}),animationDelay:"100ms",animationTimingFunction:"ease-in",animationDuration:"100ms",animationFillMode:"backwards"},o=(m,l)=>Object.assign(m,{Skeleton:u=>n.createElement(l,{...u,rootProps:{style:r}})})},72307:(G,I,e)=>{"use strict";e.d(I,{dF:()=>s,mO:()=>r,yx:()=>n});var t=e(82611);const n={document:{nodes:[{match:[{type:"paragraph"},{type:"code_block"},{type:"code_line"}]}]},inlines:{}},s=(o,m)=>{const l=o.split(`
`).map(u=>t.eB.create({type:"code_line",nodes:[t.EY.create(u)]})),i=t.eB.create({data:{syntax:m},type:"code_block",nodes:l});return t.yo.create({nodes:[i]})},r=(o,m)=>{const l=s(o,m);return t.WT.create({document:l})}},90914:(G,I,e)=>{"use strict";e.d(I,{k:()=>t});const t=(n,s)=>{let r;if(n.getLinks&&(r=n.getLinks({valueRowIndex:s.index})),!!r){for(let o=0;o<r?.length;o++)if(r[o].onClick){const m=r[o].onClick;r[o].onClick=l=>{l.ctrlKey||l.metaKey||l.shiftKey||(l.preventDefault(),m(l,{field:n,rowIndex:s.index}))}}return r}}},69613:(G,I,e)=>{"use strict";e.d(I,{JF:()=>s,MC:()=>r,yC:()=>o});const t=["#D32D20","#1E72B8","#B240A2","#705DA0","#466803","#497A3C","#3D71AA","#B15415","#890F02","#6E6E6E","#0A437C","#6D1F62","#584477","#4C7A3F","#2F4F4F","#BF1B00","#7662B1","#8A2EB8","#517A00","#000000","#3F6833","#2F575E","#99440A","#AE561A","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],n=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"];function s(i=""){const u=m(i.toLowerCase());return Math.abs(u%t.length)}function r(i=""){const u=s(i);return o(u)}function o(i){return{color:t[i],borderColor:n[i]}}function m(i){let u=5381;for(let d=0;d<i.length;d++)u=(u<<5)+u+i.charCodeAt(d);return u}var l={getTagColorsFromName:r}},18976:(G,I,e)=>{"use strict";e.d(I,{O:()=>n,f:()=>s});var t=e(32196);function n(r){switch(r){case"auto":return"bottom";case"auto-start":return"bottom-start";case"auto-end":return"bottom-end";default:return r??"bottom"}}function s(r,o,m,l,i){return{arrow:(0,t.css)({fill:o}),container:(0,t.css)({backgroundColor:o,borderRadius:r.shape.radius.default,border:`1px solid ${m}`,boxShadow:r.shadows.z2,color:l,fontSize:r.typography.bodySmall.fontSize,padding:r.spacing(i.topBottom,i.rightLeft),[r.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.3s"},zIndex:r.zIndex.tooltip,maxWidth:"400px",overflowWrap:"break-word","&[data-popper-interactive='false']":{pointerEvents:"none"}}),headerClose:(0,t.css)({color:r.colors.text.secondary,position:"absolute",right:r.spacing(1),top:r.spacing(1.5),backgroundColor:"transparent",border:0}),header:(0,t.css)({paddingTop:r.spacing(1),paddingBottom:r.spacing(2)}),body:(0,t.css)({paddingTop:r.spacing(1),paddingBottom:r.spacing(1)}),footer:(0,t.css)({paddingTop:r.spacing(2),paddingBottom:r.spacing(1)})}}},69731:(G,I,e)=>{"use strict";e.d(I,{C:()=>n});var t=e(96540);function n(){const[s,r]=(0,t.useState)(0);return(0,t.useCallback)(()=>r(o=>o+1),[])}},29734:(G,I,e)=>{"use strict";e.d(I,{K:()=>s,Pw:()=>t,RP:()=>r,tf:()=>n});var t=(o=>(o.onBlur="onBlur",o.onFocus="onFocus",o.onChange="onChange",o))(t||{});const n=(o,m)=>{const l=m.reduce((i,u)=>u.rule(o)?i:i.concat(u.errorMessage),[]);return l.length>0?l:null},s=(o,m)=>m&&m[o],r=(o,m)=>({rule:l=>!!l.match(o),errorMessage:m||"Value is not valid"})},91950:(G,I,e)=>{"use strict";e.d(I,{A:()=>s,f:()=>o});var t=e(2543),n=e.n(t);class s{constructor(l){if(this.columns=[],this.columnMap={},this.rows=[],this.type="table",l){if(l.columns)for(const i of l.columns)this.addColumn(i);if(l.rows)for(const i of l.rows)this.addRow(i)}}sort(l){l.col===null||l.col===void 0||this.columns.length<=l.col||(this.rows.sort((i,u)=>(i=i[l.col],u=u[l.col],+(i==null)-+(u==null)||+(i>u)||-(i<u))),l.desc&&this.rows.reverse(),this.columns[l.col].sort=!0,this.columns[l.col].desc=l.desc)}addColumn(l){this.columnMap[l.text]||(this.columns.push(l),this.columnMap[l.text]=l)}addRow(l){this.rows.push(l)}}function r(m,l,i){let u=!1;for(let d=0;d<m.length;d++)if(l[d]!==void 0&&i[d]!==void 0){if(l[d]!==i[d])return!1}else(l[d]===void 0||i[d]===void 0)&&(u=!0);return u}function o(m,...l){const i=m||new s;if(arguments.length===1)return i;if(arguments.length===2)return i.columns=l[0].hasOwnProperty("columns")?[...l[0].columns]:[],i.rows=l[0].hasOwnProperty("rows")?[...l[0].rows]:[],i;const u=l.filter(a=>!!a.columns),d={},p=u.slice().reduce((a,E)=>(E.columns.forEach(g=>{const{text:h}=g;d[h]===void 0&&(d[h]=a.length,a.push(g))}),a),[]),c=u.map(a=>a.columns.map(E=>d[E.text])),y=u.reduce((a,E,g)=>{const h=c[g];return E.rows.forEach(D=>{const v=[];h.forEach((C,T)=>{v[C]=D[T]}),a.push(v)}),a},[]),f={},P=y.reduce((a,E,g)=>{if(!f[g]){let h=g+1;for(;h<y.length;){const D=(0,t.findIndex)(y,v=>r(p,E,v),h);if(D>-1){const v=y[D];for(let C=0;C<p.length;C++)E[C]===void 0&&v[C]!==void 0&&(E[C]=v[C]);f[D]=v,h=D+1}else break}a.push(E)}return a},[]);return i.columns=p,i.rows=P,i}},97007:(G,I,e)=>{"use strict";e.d(I,{N:()=>n});var t=e(65307);const n=(0,t.VP)("core/cleanUpState")},82467:(G,I,e)=>{"use strict";e.d(I,{Do:()=>t.Do,Vz:()=>n.Vz,YA:()=>n.YA,dx:()=>t.dx});var t=e(16001),n=e(28215)},28138:(G,I,e)=>{"use strict";e.d(I,{A:()=>s,l:()=>n});var t=e(18226);const n=new t.o,s=n},5108:(G,I,e)=>{"use strict";e.d(I,{x:()=>N});var t=e(32196),n=e(2543),s=e(96540),r=e(40845),o=e(68402),m=e(90613),l=e(94753),i=e(55852),u=e(9025),d=e(8484),p=e(27677),c=e(43907),y=e(67061),f=e(21594),P=e(25469),a=e(17172);class E extends s.Component{constructor(X){super(X),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,n.debounce)(this.search,300,{leading:!0,trailing:!0})}search(X){return this.setState({isLoading:!0}),(0,n.isNil)(X)&&(X=""),(0,a.AI)().get("/api/serviceaccounts/search").then(se=>se.serviceAccounts.map(ae=>({id:ae.id,value:ae.id,label:ae.login,imgUrl:ae.avatarUrl,login:ae.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:X,onSelected:se,inputId:ae}=this.props,{isLoading:ne}=this.state;return s.createElement("div",{className:"service-account-picker","data-testid":"serviceAccountPicker"},s.createElement(f.DW,{isClearable:!0,className:X,inputId:ae,isLoading:ne,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:se,placeholder:"Start typing to search for service accounts",noOptionsMessage:"No service accounts found","aria-label":"Service Account picker"}))}}class g extends s.Component{constructor(X){super(X),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,n.debounce)(this.search,300,{leading:!0,trailing:!0})}componentDidMount(){const{teamId:X}=this.props;X&&(0,a.AI)().get(`/api/teams/${X}`).then(se=>{this.setState({value:{value:se,label:se.name,imgUrl:se.avatarUrl}})})}search(X){return this.setState({isLoading:!0}),(0,n.isNil)(X)&&(X=""),(0,a.AI)().get(`/api/teams/search?perpage=100&page=1&query=${X}`).then(se=>{const ae=se.teams.map(ne=>({value:ne,label:ne.name,imgUrl:ne.avatarUrl}));return this.setState({isLoading:!1}),ae})}render(){const{onSelected:X,className:se}=this.props,{isLoading:ae,value:ne}=this.state;return s.createElement("div",{className:"user-picker","data-testid":"teamPicker"},s.createElement(f.DW,{isLoading:ae,defaultOptions:!0,loadOptions:this.debouncedSearch,value:ne,onChange:X,className:se,placeholder:"Select a team",noOptionsMessage:"No teams found","aria-label":"Team picker"}))}}class h extends s.Component{constructor(X){super(X),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,n.debounce)(this.search,300,{leading:!0,trailing:!0})}search(X){return this.setState({isLoading:!0}),(0,n.isNil)(X)&&(X=""),(0,a.AI)().get(`/api/org/users/lookup?query=${X}&limit=100`).then(se=>se.map(ae=>({id:ae.userId,value:ae.userId,label:ae.login,imgUrl:ae.avatarUrl,login:ae.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:X,onSelected:se,inputId:ae}=this.props,{isLoading:ne}=this.state;return s.createElement("div",{className:"user-picker","data-testid":"userPicker"},s.createElement(f.DW,{isClearable:!0,className:X,inputId:ae,isLoading:ne,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:se,placeholder:"Start typing to search for user",noOptionsMessage:"No users found","aria-label":"User picker"}))}}var D=e(24897),v=(J=>(J.None="None",J.Team="Team",J.User="User",J.ServiceAccount="ServiceAccount",J.BuiltInRole="builtInRole",J))(v||{});const C=({title:J=(0,d.t)("access-control.add-permission.title","Add permission for"),permissions:X,assignments:se,onAdd:ae,onCancel:ne})=>{const[q,ee]=(0,s.useState)(v.None),[z,te]=(0,s.useState)(0),[ie,ce]=(0,s.useState)(0),[ue,fe]=(0,s.useState)(""),[Te,he]=(0,s.useState)(""),de=(0,s.useMemo)(()=>{const pe=[];return se.users&&pe.push({value:v.User,label:(0,d.t)("access-control.add-permission.user-label","User")}),se.serviceAccounts&&pe.push({value:v.ServiceAccount,label:(0,d.t)("access-control.add-permission.serviceaccount-label","Service Account")}),se.teams&&pe.push({value:v.Team,label:(0,d.t)("access-control.add-permission.team-label","Team")}),se.builtInRoles&&pe.push({value:v.BuiltInRole,label:(0,d.t)("access-control.add-permission.role-label","Role")}),pe},[se]);(0,s.useEffect)(()=>{X.length>0&&he(X[0])},[X]);const le=()=>q===v.Team&&z>0||q===v.User&&ie>0||q===v.ServiceAccount&&ie>0||v.BuiltInRole&&D.XT.hasOwnProperty(ue);return s.createElement("div",{className:"cta-form","aria-label":"Permissions slider"},s.createElement(P.J,{onClick:ne}),s.createElement("h5",null,J),s.createElement("form",{name:"addPermission",onSubmit:pe=>{pe.preventDefault(),ae({userId:ie,teamId:z,builtInRole:ue,permission:Te,target:q})}},s.createElement(y.B,{gap:1,direction:"row"},s.createElement(f.l6,{"aria-label":"Role to add new permission to",value:q,options:de,onChange:pe=>ee(pe.value),disabled:de.length===0,width:"auto"}),q===v.User&&s.createElement(h,{onSelected:pe=>ce(pe?.value||0)}),q===v.ServiceAccount&&s.createElement(E,{onSelected:pe=>ce(pe?.value||0)}),q===v.Team&&s.createElement(g,{onSelected:pe=>te(pe.value?.id||0)}),q===v.BuiltInRole&&s.createElement(f.l6,{"aria-label":"Built-in role picker",options:Object.values(D.XT).filter(pe=>pe!==D.XT.None).map(pe=>({value:pe,label:pe})),onChange:pe=>fe(pe.value||""),width:"auto"}),s.createElement(f.l6,{"aria-label":"Permission Level",width:"auto",value:X.find(pe=>pe===Te),options:X.map(pe=>({label:pe,value:pe})),onChange:pe=>he(pe.value||"")}),s.createElement(i.$n,{type:"submit",disabled:!le()},s.createElement(d.x6,{i18nKey:"access-control.add-permissions.save"},"Save")))))};var T=e(56034),S=e(14578);const O=({item:J,permissionLevels:X,canSet:se,onRemove:ae,onChange:ne})=>{const q=(0,r.of)(R);return s.createElement("tr",null,s.createElement("td",null,x(J)),s.createElement("td",null,M(J)),s.createElement("td",null,J.isInherited&&s.createElement("em",{className:"muted no-wrap"},"Inherited from folder")),s.createElement("td",null,s.createElement(f.l6,{disabled:!se||!J.isManaged,onChange:ee=>ne(J,ee.value),value:X.find(ee=>ee===J.permission),options:X.map(ee=>({value:ee,label:ee}))})),s.createElement("td",null,J.warning?s.createElement(T.m,{content:s.createElement(s.Fragment,null,s.createElement(m.a,{marginBottom:1},J.warning),A(J))},s.createElement(S.I,{name:"exclamation-triangle",className:q.warning})):s.createElement(T.m,{content:A(J)},s.createElement(S.I,{name:"info-circle"}))),s.createElement("td",null,J.isManaged?s.createElement(i.$n,{size:"sm",icon:"times",variant:"destructive",disabled:!se,onClick:()=>ae(J),"aria-label":`Remove permission for ${b(J)}`}):s.createElement(T.m,{content:J.isInherited?"Inherited Permission":"Provisioned Permission"},s.createElement(i.$n,{size:"sm",icon:"lock"}))))},x=J=>J.teamId?s.createElement("img",{className:"filter-table__avatar",src:J.teamAvatarUrl,alt:`Avatar for team ${J.teamId}`}):J.userId?s.createElement("img",{className:"filter-table__avatar",src:J.userAvatarUrl,alt:`Avatar for user ${J.userId}`}):s.createElement(S.I,{size:"xl",name:"shield"}),b=J=>J.userId?J.userLogin:J.teamId?J.team:J.builtInRole,M=J=>J.userId?s.createElement("span",{key:"name"},J.userLogin," "):J.teamId?s.createElement("span",{key:"name"},J.team," "):J.builtInRole?s.createElement("span",{key:"name"},J.builtInRole," "):s.createElement("span",{key:"name"}),A=J=>`Actions: ${[...new Set(J.actions)].sort().join(" ")}`,R=J=>({warning:(0,t.css)({color:J.colors.warning.main})}),B=({title:J,items:X,compareKey:se,permissionLevels:ae,canSet:ne,onRemove:q,onChange:ee})=>{const z=(0,s.useMemo)(()=>{const te={};for(let ie of X){const ce=ie[se];if(!te[ce]){te[ce]=ie;continue}if(ie.actions.length>te[ce].actions.length){te[ce]=ie;continue}ie.actions.length===te[ce].actions.length&&!ie.isInherited&&(te[ce]=ie)}return Object.keys(te).map(ie=>te[ie])},[X,se]);return z.length===0?null:s.createElement("div",null,s.createElement("table",{className:"filter-table gf-form-group"},s.createElement("thead",null,s.createElement("tr",null,s.createElement("th",{style:{width:"1%"}}),s.createElement("th",null,J),s.createElement("th",{style:{width:"1%"}}),s.createElement("th",{style:{width:"40%"}},s.createElement(d.x6,{i18nKey:"access-control.permission-list.permission"},"Permission")),s.createElement("th",{style:{width:"1%"}}),s.createElement("th",{style:{width:"1%"}}))),s.createElement("tbody",null,z.map((te,ie)=>s.createElement(O,{item:te,onRemove:q,onChange:ee,canSet:ne,key:`${ie}-${te.userId}`,permissionLevels:ae})))))},U="",W={permissions:[],assignments:{teams:!1,users:!1,serviceAccounts:!1,builtInRoles:!1}},N=({title:J=(0,d.t)("access-control.permissions.title","Permissions"),buttonLabel:X=(0,d.t)("access-control.permissions.add-label","Add a permission"),emptyLabel:se=(0,d.t)("access-control.permissions.no-permissions","There are no permissions"),resource:ae,resourceId:ne,canSetPermissions:q,addPermissionTitle:ee,getWarnings:z,epilogue:te})=>{const ie=(0,r.of)(H),[ce,ue]=(0,s.useState)(!1),[fe,Te]=(0,s.useState)([]),[he,de]=(0,s.useState)(W),le=(0,s.useCallback)(async()=>{let $e=await L(ae,ne);z&&($e=z($e)),Te($e)},[ae,ne,z]);(0,s.useEffect)(()=>{w(ae).then($e=>(de($e),le()))},[ae,ne,le]);const pe=$e=>{let Xe=null;$e.target===v.User||$e.target===v.ServiceAccount?Xe=V(ae,ne,$e.userId,$e.permission):$e.target===v.Team?Xe=K(ae,ne,$e.teamId,$e.permission):$e.target===v.BuiltInRole&&(Xe=k(ae,ne,$e.builtInRole,$e.permission)),Xe!==null&&Xe.then(le)},ve=$e=>{let Xe=null;$e.userId?Xe=V(ae,ne,$e.userId,U):$e.teamId?Xe=K(ae,ne,$e.teamId,U):$e.isServiceAccount&&$e.userId?Xe=V(ae,ne,$e.userId,U):$e.builtInRole&&(Xe=k(ae,ne,$e.builtInRole,U)),Xe!==null&&Xe.then(le)},be=($e,Xe)=>{$e.permission!==Xe&&($e.userId?pe({permission:Xe,userId:$e.userId,target:v.User}):$e.isServiceAccount?pe({permission:Xe,userId:$e.userId,target:v.User}):$e.teamId?pe({permission:Xe,teamId:$e.teamId,target:v.Team}):$e.builtInRole&&pe({permission:Xe,builtInRole:$e.builtInRole,target:v.BuiltInRole}))},Oe=(0,s.useMemo)(()=>(0,n.sortBy)(fe.filter($e=>$e.teamId),["team","isManaged"]),[fe]),Me=(0,s.useMemo)(()=>(0,n.sortBy)(fe.filter($e=>$e.userId&&!$e.isServiceAccount),["userLogin","isManaged"]),[fe]),Ue=(0,s.useMemo)(()=>(0,n.sortBy)(fe.filter($e=>$e.userId&&$e.isServiceAccount),["userLogin","isManaged"]),[fe]),we=(0,s.useMemo)(()=>(0,n.sortBy)(fe.filter($e=>$e.builtInRole),["builtInRole","isManaged"]),[fe]),Re=(0,d.t)("access-control.permissions.role","Role"),Fe=(0,d.t)("access-control.permissions.user","User"),xe=(0,d.t)("access-control.permissions.serviceaccount","Service Account"),Ve=(0,d.t)("access-control.permissions.team","Team");return s.createElement(s.Fragment,null,s.createElement("div",null,q&&ae==="folders"&&s.createElement(s.Fragment,null,s.createElement(d.x6,{i18nKey:"access-control.permissions.permissions-change-warning"},"This will change permissions for this folder and all its descendants. In total, this will affect:"),s.createElement(c.x,{selectedItems:{folder:{[ne]:!0},dashboard:{},panel:{},$all:!1}}),s.createElement(o.$,{v:2})),fe.length===0&&s.createElement(m.a,null,s.createElement(l.E,null,se)),s.createElement(B,{title:Re,items:we,compareKey:"builtInRole",permissionLevels:he.permissions,onChange:be,onRemove:ve,canSet:q}),s.createElement(B,{title:Fe,items:Me,compareKey:"userLogin",permissionLevels:he.permissions,onChange:be,onRemove:ve,canSet:q}),s.createElement(B,{title:xe,items:Ue,compareKey:"userLogin",permissionLevels:he.permissions,onChange:be,onRemove:ve,canSet:q}),s.createElement(B,{title:Ve,items:Oe,compareKey:"team",permissionLevels:he.permissions,onChange:be,onRemove:ve,canSet:q}),q&&s.createElement(s.Fragment,null,s.createElement(i.$n,{className:ie.addPermissionButton,variant:"primary",key:"add-permission",onClick:()=>ue(!0),icon:"plus"},X),s.createElement(u.a,{in:ce},s.createElement(C,{title:ee,onAdd:pe,permissions:he.permissions,assignments:he.assignments,onCancel:()=>ue(!1)})))),te&&te(fe))},w=async J=>{try{return await(0,p.AI)().get(`/api/access-control/${J}/description`)}catch(X){return console.error("failed to load resource description: ",X),W}},L=(J,X)=>(0,p.AI)().get(`/api/access-control/${J}/${X}`),V=(J,X,se,ae)=>j(J,X,"users",se,ae),K=(J,X,se,ae)=>j(J,X,"teams",se,ae),k=(J,X,se,ae)=>j(J,X,"builtInRoles",se,ae),j=(J,X,se,ae,ne)=>(0,p.AI)().post(`/api/access-control/${J}/${X}/${se}/${ae}`,{permission:ne}),H=J=>({breakdown:(0,t.css)({...J.typography.bodySmall,color:J.colors.text.secondary,marginBottom:J.spacing(2)}),addPermissionButton:(0,t.css)({marginBottom:J.spacing(2)})})},9025:(G,I,e)=>{"use strict";e.d(I,{a:()=>m});var t=e(96540),n=e(22669);const s="200px",r=200,o={transition:`max-height ${r}ms ease-in-out`,overflow:"hidden"},m=({children:l,in:i,maxHeight:u=s,style:d=o})=>{const p=(0,t.useRef)(null),c={exited:{maxHeight:0},entering:{maxHeight:u},entered:{maxHeight:"unset",overflow:"visible"},exiting:{maxHeight:0}};return t.createElement(n.Ay,{in:i,timeout:r,nodeRef:p},y=>t.createElement("div",{style:{...d,...c[y]},ref:p},l))}},75269:(G,I,e)=>{"use strict";e.d(I,{H:()=>s});var t=e(96540),n=e(76888);const s=t.memo(({actions:r})=>{const{chrome:o}=(0,n.Il)();return(0,t.useLayoutEffect)(()=>{o.update({actions:r})}),null});s.displayName="TopNavUpdate"},10804:(G,I,e)=>{"use strict";e.d(I,{K:()=>r});var t=e(32196),n=e(96540),s=e(40845);function r({className:m,leftActionsSeparator:l}){const i=(0,s.of)(o);return l?n.createElement("div",{className:(0,t.cx)(m,i.leftActionsSeparator)}):n.createElement("div",{className:(0,t.cx)(m,i.line)})}const o=m=>({leftActionsSeparator:(0,t.css)({display:"flex",flexGrow:1}),line:(0,t.css)({width:1,backgroundColor:m.colors.border.medium,height:24})})},57571:(G,I,e)=>{"use strict";e.d(I,{l:()=>t});const t=40},19361:(G,I,e)=>{"use strict";e.d(I,{M:()=>u});var t=e(32196),n=e(96540),s=e(23596),r=e(40845);const o=({className:d,logo:p})=>n.createElement("img",{className:d,src:`${p||"public/img/grafana_icon.svg"}`,alt:"Grafana"}),m=({className:d,children:p})=>{const c=(0,r.$j)(),y=(0,t.css)({"&:before":{content:'""',position:"fixed",left:0,right:0,bottom:0,top:0,background:`url(public/img/g8_login_${c.isDark?"dark":"light"}.svg)`,backgroundPosition:"top center",backgroundSize:"auto",backgroundRepeat:"no-repeat",opacity:0,transition:"opacity 3s ease-in-out",[c.breakpoints.up("md")]:{backgroundPosition:"center",backgroundSize:"cover"}}});return n.createElement("div",{className:(0,t.cx)(y,d)},p)},l=({className:d})=>n.createElement("img",{className:d,src:"public/img/grafana_icon.svg",alt:"Grafana"}),i=()=>{const d=(0,r.$j)();return(0,t.css)({background:s.alpha(d.colors.background.primary,.7),backgroundSize:"cover"})};class u{static{this.LoginLogo=o}static{this.LoginBackground=m}static{this.MenuLogo=l}static{this.LoginBoxBackground=i}static{this.AppTitle="Grafana"}static{this.LoginTitle="Welcome to Grafana"}static{this.HideEdition=!1}static{this.GetLoginSubTitle=()=>null}}},3984:(G,I,e)=>{"use strict";e.d(I,{Z:()=>t});function t(n,s,r){const o=[];let m=!1,l;function i(u,d=!1){if(m)return;const p=u.url?.split("?")??["",""];let c=p[0];const y=new URLSearchParams(p[1]);if(y.has("editview")&&(c+=`?editview=${y.get("editview")}`),r&&c===r.url){o.unshift({text:r.text,href:u.url??""}),m=!0;return}const f=c.length>0&&l===c;l=c,!u.hideFromBreadcrumbs&&!(d&&f)&&o.unshift({text:u.text,href:u.url??""}),u.parentItem&&i(u.parentItem)}return s&&i(s),i(n,!0),o}},25469:(G,I,e)=>{"use strict";e.d(I,{J:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(29158);const o=({onClick:l,"aria-label":i,style:u})=>{const d=(0,s.of)(m);return n.createElement(r.K,{"aria-label":i??"Close",className:d,name:"times",onClick:l,style:u,tooltip:"Close"})},m=l=>(0,t.css)({position:"absolute",right:l.spacing(.5),top:l.spacing(1)})},27921:(G,I,e)=>{"use strict";e.d(I,{A:()=>n});var t=e(96540);const n=s=>t.lazy(s)},38645:(G,I,e)=>{"use strict";e.d(I,{Dd:()=>l,wi:()=>p});var t=e(32196),n=e(96540),s=e(32264),r=e(40845),o=e(14578),m=e(8484);let l=()=>[{target:"_blank",id:"documentation",text:(0,m.t)("nav.help/documentation","Documentation"),icon:"document-info",url:"https://grafana.com/docs/grafana/latest/?utm_source=grafana_footer"},{target:"_blank",id:"support",text:(0,m.t)("nav.help/support","Support"),icon:"question-circle",url:"https://grafana.com/products/enterprise/?utm_source=grafana_footer"},{target:"_blank",id:"community",text:(0,m.t)("nav.help/community","Community"),icon:"comments-alt",url:"https://community.grafana.com/?utm_source=grafana_footer"}];function i(f){return{hasReleaseNotes:!0,isBeta:f.includes("-beta")}}function u(f){const{buildInfo:P,licenseInfo:a}=s.$,E=[],g=a.stateInfo?` (${a.stateInfo})`:"";if(f||E.push({target:"_blank",id:"license",text:`${P.edition}${g}`,url:a.licenseUrl}),P.hideVersion)return E;const{hasReleaseNotes:h}=i(P.version);return E.push({target:"_blank",id:"version",text:P.versionString,url:h?"https://github.com/grafana/grafana/blob/main/CHANGELOG.md":void 0}),P.hasUpdate&&E.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),E}function d(f){l=f}const p=n.memo(({customLinks:f,hideEdition:P})=>{const a=(f||l()).concat(u(P)),E=(0,r.of)(y);return n.createElement("footer",{className:E.footer},n.createElement("div",{className:"text-center"},n.createElement("ul",{className:E.list},a.map((g,h)=>n.createElement("li",{className:E.listItem,key:h},n.createElement(c,{item:g}))))))});p.displayName="Footer";function c({item:f}){const P=f.url?n.createElement("a",{href:f.url,target:f.target,rel:"noopener noreferrer",id:f.id},f.text):f.text;return n.createElement(n.Fragment,null,f.icon&&n.createElement(o.I,{name:f.icon})," ",P)}const y=f=>({footer:(0,t.css)({...f.typography.bodySmall,color:f.colors.text.primary,display:"block",padding:f.spacing(2,0),position:"relative",width:"98%","a:hover":{color:f.colors.text.maxContrast,textDecoration:"underline"},[f.breakpoints.down("md")]:{display:"none"}}),list:(0,t.css)({listStyle:"none"}),listItem:(0,t.css)({display:"inline-block","&:after":{content:"' | '",padding:f.spacing(0,1)},"&:last-child:after":{content:"''",paddingLeft:0}})})},53153:(G,I,e)=>{"use strict";e.d(I,{S:()=>f});var t=e(96540),n=e(49785),s=e(13544),r=e(32264),o=e(40845),m=e(42418),l=e(88575),i=e(67061),u=e(55852),d=e(56034),p=e(4691),c=e(78361),y=e(35043);const f=({onSubmit:P,onSkip:a,showDefaultPasswordWarning:E})=>{const g=(0,o.of)(p.$),[h,D]=(0,t.useState)(!1),[v,C]=(0,t.useState)(!0),{handleSubmit:T,register:S,getValues:O,formState:{errors:x},watch:b}=(0,n.mN)({defaultValues:{newPassword:"",confirmNew:""}}),M=b("newPassword"),A=R=>{P(R.newPassword)};return t.createElement("form",{onSubmit:T(A)},E&&t.createElement(m.F,{severity:"info",title:"Continuing to use the default password exposes you to security risks."}),t.createElement(l.D,{label:"New password",invalid:!!x.newPassword,error:x?.newPassword?.message},t.createElement(c.s,{onFocus:()=>D(!0),...S("newPassword",{required:"New Password is required",onBlur:()=>C(!1),validate:{strongPasswordValidationRegister:y.DP}}),id:"new-password",autoFocus:!0,autoComplete:"new-password"})),h&&t.createElement(y.zJ,{pristine:v,password:M,strongPasswordValidations:y.NQ}),t.createElement(l.D,{label:"Confirm new password",invalid:!!x.confirmNew,error:x?.confirmNew?.message},t.createElement(c.s,{...S("confirmNew",{required:"Confirmed Password is required",validate:R=>R===O().newPassword||"Passwords must match!"}),id:"confirm-new-password",autoComplete:"new-password"})),t.createElement(i.B,{direction:"column"},t.createElement(u.$n,{type:"submit",className:g.submitButton},"Submit"),!r.$.auth.basicAuthStrongPasswordPolicy&&a&&t.createElement(d.m,{content:"If you skip you will be prompted to change password next time you log in.",placement:"bottom"},t.createElement(u.$n,{fill:"text",onClick:a,type:"button","data-testid":s.Tp.pages.Login.skip},"Skip"))))}},72235:(G,I,e)=>{"use strict";e.d(I,{l:()=>r});var t=e(32196),n=e(96540),s=e(49785);function r({defaultValues:o,onSubmit:m,validateOnMount:l=!1,validateFieldsOnMount:i,children:u,validateOn:d="onSubmit",maxWidth:p=600,...c}){const{handleSubmit:y,trigger:f,formState:P,...a}=(0,s.mN)({mode:d,defaultValues:o});return(0,n.useEffect)(()=>{l&&f(i)},[f,i,l]),n.createElement("form",{className:(0,t.css)({maxWidth:p!=="none"?p+"px":p,width:"100%"}),onSubmit:y(m),...c},u({errors:P.errors,formState:P,trigger:f,...a}))}},30249:(G,I,e)=>{"use strict";e.d(I,{o:()=>c});var t=e(96540),n=e(85200),s=e(1173),r=e(11261),o=e(90708),m=e(67266),l=e(81297),i=e(16895),u=e(40458);function d(y,f,P=[]){for(const a of P)if(typeof a=="function"){if(!a(y,f))return!1}else if(f[a]!==y[a])return!1;return!0}const p={x:n.sJ.get(s.Ct.firstTimeField).get({}),y:n.sJ.get(s.Ct.byTypes).get(new Set([r.PU.number,r.PU.enum]))};class c extends t.Component{constructor(f){super(f),this.getTimeRange=()=>this.props.timeRange;let P=this.prepState(f);P.alignedData=P.config.prepData([P.alignedFrame]),this.state=P,this.plotInstance=t.createRef()}prepState(f,P=!0){let a=null;const{frames:E,fields:g=p,preparePlotFrame:h,replaceVariables:D,dataLinkPostProcessor:v}=f,C=h??u.m,T=E.some(O=>O.fields.some(x=>(x.config.links?.length??0)>0)),S=C(E,{...g,y:T?()=>!0:g.y},f.timeRange);if((0,i.uY)("GraphNG",!1,"data aligned",S),S){let O=S;if(T){const b=Array.isArray(this.props.timeZone)?this.props.timeZone[0]:this.props.timeZone;S.fields.forEach(M=>{M.getLinks=(0,o._M)(S,M,{...M.state?.scopedVars,__dataContext:{value:{data:[S],field:M,frame:S,frameIndex:0}}},D,b,v)}),O={...S,fields:S.fields.filter((M,A)=>A===0||g.y(M,S,[S]))}}let x=this.state?.config;P&&(x=f.prepConfig(O,this.props.frames,this.getTimeRange),(0,i.uY)("GraphNG",!1,"config prepared",x)),a={alignedFrame:O,config:x},(0,i.uY)("GraphNG",!1,"data prepared",a.alignedData)}return a}componentDidUpdate(f){const{frames:P,structureRev:a,timeZone:E,cursorSync:g,propsToDiff:h}=this.props,D=!d(f,this.props,h);if(P!==f.frames||D||E!==f.timeZone||g!==f.cursorSync){let v=this.prepState(this.props,!1);v&&((this.state.config===void 0||E!==f.timeZone||g!==f.cursorSync||a!==f.structureRev||!a||D)&&(v.config=this.props.prepConfig(v.alignedFrame,this.props.frames,this.getTimeRange),(0,i.uY)("GraphNG",!1,"config recreated",v.config)),v.alignedData=v.config.prepData([v.alignedFrame]),this.setState(v))}}render(){const{width:f,height:P,children:a,renderLegend:E}=this.props,{config:g,alignedFrame:h,alignedData:D}=this.state;return g?t.createElement(m.KU,{width:f,height:P,legend:E(g)},(v,C)=>t.createElement(l.Z,{config:g,data:D,width:v,height:C,plotRef:T=>this.plotInstance.current=T},a?a(g,h):null)):null}}},40458:(G,I,e)=>{"use strict";e.d(I,{m:()=>u});var t=e(11261),n=e(73060),s=e(46294);function r(d,p,c){let y,f;for(let P=0;P<p.length;P++)if(p[P]==null)f==null&&y!=null&&(f=P);else{if(f!=null&&y!=null){if(d[P]-y<c)for(;f<P;)p[f++]=void 0;f=null}y=d[P]}return p}var o=e(52622);function m(d){return d.type===t.PU.number&&d.config.custom?.drawStyle===o.GR.Bars&&!d.config.custom?.hideFrom?.viz}function l(d,p){return d.fields.find(c=>p!=null?c.name===p:c.type===t.PU.time)}function i(d,p){const c=l(d,p);let y=c?.values;for(let f=0;f<d.fields.length;f++){let P=d.fields[f];if(P===c||m(P))continue;let a=P.config.custom?.spanNulls;typeof a=="number"&&a!==-1&&y&&(P.values=r(y,P.values,a))}return d}function u(d,p,c){let y;e:for(let E of d)for(let g of E.fields)if(p.x(g,E,d)){y=g;break e}d=d.map(E=>y?.state?.nullThresholdApplied?E:(0,s.M)({frame:E,refFieldName:y.name,refFieldPseudoMin:c?.from.valueOf(),refFieldPseudoMax:c?.to.valueOf()}));let f=d.reduce((E,g)=>E+g.fields.reduce((h,D)=>h+(m(D)?1:0),0),0),P=1/0;f>1&&d.forEach(E=>{if(!E.fields.some(m))return;const g=y.values;for(let h=0;h<g.length;h++)h>0&&(P=Math.min(P,g[h]-g[h-1]))});let a=(0,n.Fd)({frames:d,joinBy:p.x,keep:p.y,keepOriginIndices:!0,keepDisplayNames:!0,nullMode:E=>{if(m(E))return n.WO;let g=E.config.custom?.spanNulls;return g===!0?n.RC:g===-1?n.WO:n.JI}});return a?(a=i(a,y.name),P!==1/0&&(a.fields.forEach((E,g)=>{let h=E.values;if(g===0){let D=h[h.length-1];h.push(D+P,D+2*P)}else m(E)?h.push(null,null):h.push(void 0,void 0)}),a.length+=2),a):null}},18759:(G,I,e)=>{"use strict";e.d(I,{T:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(16795);function o({children:l,spacing:i,level:u}){const d=(0,s.of)(m,i,u);return n.createElement("span",{className:(0,t.css)(d.indentor)},l)}const m=(l,i,u)=>({indentor:(0,t.css)((0,r.Y)(l,i,d=>({paddingLeft:l.spacing(d*u)})))})},61680:(G,I,e)=>{"use strict";e.d(I,{b:()=>s});var t=e(96540),n=e(33390);const s=r=>{const{children:o,storageKey:m,defaultValue:l}=r,[i,u]=(0,t.useState)({value:n.A.getObject(r.storageKey,r.defaultValue)});(0,t.useEffect)(()=>{const c=y=>{y.key===m&&u({value:n.A.getObject(r.storageKey,r.defaultValue)})};return window.addEventListener("storage",c),()=>{window.removeEventListener("storage",c)}});const d=c=>{try{n.A.setObject(m,c)}catch(y){console.error(y)}u({value:c})},p=()=>{try{n.A.delete(m)}catch(c){console.log(c)}u({value:l})};return t.createElement(t.Fragment,null,o(i.value,d,p))}},87570:(G,I,e)=>{"use strict";e.d(I,{A:()=>l});var t=e(96540),n=e(17172),s=e(2913),r=e(8484);const o=()=>!!s.Ay.oauth&&Object.keys(s.Ay.oauth).length>0;class m extends t.PureComponent{constructor(d){super(d),this.changePassword=p=>{const c={newPassword:p,confirmNew:p,oldPassword:"admin"};if(this.props.resetCode){const y={code:this.props.resetCode,newPassword:p,confirmPassword:p};(0,n.AI)().post("/api/user/password/reset",y).then(()=>{this.toGrafana()})}else(0,n.AI)().put("/api/user/password",c).then(()=>{this.toGrafana()}).catch(y=>console.error(y))},this.login=p=>{this.setState({loginErrorMessage:void 0,isLoggingIn:!0}),(0,n.AI)().post("/login",p,{showErrorAlert:!1}).then(c=>{if(this.result=c,p.password!=="admin"||s.Ay.ldapEnabled||s.Ay.authProxyEnabled){this.toGrafana();return}else this.changeView(p.password==="admin")}).catch(c=>{const y=(0,n.NF)(c)?i(c):void 0;this.setState({isLoggingIn:!1,loginErrorMessage:y||(0,r.t)("login.error.unknown","Unknown error occurred")})})},this.changeView=p=>{this.setState({isChangingPassword:!0,showDefaultPasswordWarning:p})},this.toGrafana=()=>{this.result?.redirectUrl?s.Ay.appSubUrl!==""&&!this.result.redirectUrl.startsWith(s.Ay.appSubUrl)?window.location.assign(s.Ay.appSubUrl+this.result.redirectUrl):window.location.assign(this.result.redirectUrl):window.location.assign(s.Ay.appSubUrl+"/")},this.state={isLoggingIn:!1,isChangingPassword:!1,showDefaultPasswordWarning:!1,loginErrorMessage:s.Ay.loginError}}render(){const{children:d}=this.props,{isLoggingIn:p,isChangingPassword:c,showDefaultPasswordWarning:y,loginErrorMessage:f}=this.state,{login:P,toGrafana:a,changePassword:E}=this,{loginHint:g,passwordHint:h,disableLoginForm:D,disableUserSignUp:v}=s.Ay;return t.createElement(t.Fragment,null,d({isOauthEnabled:o(),loginHint:g,passwordHint:h,disableLoginForm:D,disableUserSignUp:v,login:P,isLoggingIn:p,changePassword:E,skipPasswordChange:a,isChangingPassword:c,showDefaultPasswordWarning:y,loginErrorMessage:f}))}}const l=m;function i(u){switch(u.data?.messageId){case"password-auth.empty":case"password-auth.failed":case"password-auth.invalid":return(0,r.t)("login.error.invalid-user-or-password","Invalid username or password");case"login-attempt.blocked":return(0,r.t)("login.error.blocked","You have exceeded the number of login attempts for this user. Please try again later.");default:return u.data?.message}}},4691:(G,I,e)=>{"use strict";e.d(I,{$:()=>c,Q:()=>p});var t=e(32196),n=e(96540),s=e(49785),r=e(13544),o=e(40845),m=e(88575),l=e(10354),i=e(55852),u=e(8484),d=e(78361);const p=({children:y,onSubmit:f,isLoggingIn:P,passwordHint:a,loginHint:E})=>{const g=(0,o.of)(c),h=(0,n.useId)(),D=(0,n.useId)(),{handleSubmit:v,register:C,formState:{errors:T}}=(0,s.mN)({mode:"onChange"});return n.createElement("div",{className:g.wrapper},n.createElement("form",{onSubmit:v(f)},n.createElement(m.D,{label:(0,u.t)("login.form.username-label","Email or username"),invalid:!!T.user,error:T.user?.message},n.createElement(l.p,{...C("user",{required:(0,u.t)("login.form.username-required","Email or username is required")}),id:h,autoFocus:!0,autoCapitalize:"none",placeholder:E||(0,u.t)("login.form.username-placeholder","email or username"),"data-testid":r.Tp.pages.Login.username})),n.createElement(m.D,{label:(0,u.t)("login.form.password-label","Password"),invalid:!!T.password,error:T.password?.message},n.createElement(d.s,{...C("password",{required:(0,u.t)("login.form.password-required","Password is required")}),id:D,autoComplete:"current-password",placeholder:a||(0,u.t)("login.form.password-placeholder","password")})),n.createElement(i.$n,{type:"submit","data-testid":r.Tp.pages.Login.submit,className:g.submitButton,disabled:P},P?(0,u.t)("login.form.submit-loading-label","Logging in..."):(0,u.t)("login.form.submit-label","Log in")),y))},c=y=>({wrapper:(0,t.css)({width:"100%",paddingBottom:y.spacing(2)}),submitButton:(0,t.css)({justifyContent:"center",width:"100%"})})},20851:(G,I,e)=>{"use strict";e.d(I,{GU:()=>l,YO:()=>u,qm:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(19361),o=e(38645);const m=({children:d,enterAnimation:p=!0})=>{const c=(0,s.of)(u);return n.createElement("div",{className:(0,t.cx)(c.loginInnerBox,p&&c.enterAnimation)},d)},l=({children:d,branding:p,isChangingPassword:c})=>{const y=(0,s.of)(u),[f,P]=(0,n.useState)(!1),a=p?.loginSubtitle??r.M.GetLoginSubTitle(),E=p?.loginTitle??r.M.LoginTitle,g=p?.loginBoxBackground||r.M.LoginBoxBackground(),h=p?.loginLogo,D=p?.hideEdition??r.M.HideEdition;return(0,n.useEffect)(()=>P(!0),[]),n.createElement(r.M.LoginBackground,{className:(0,t.cx)(y.container,f&&y.loginAnim,p?.loginBackground)},n.createElement("div",{className:y.loginMain},n.createElement("div",{className:(0,t.cx)(y.loginContent,g,"login-content-box")},n.createElement("div",{className:y.loginLogoWrapper},n.createElement(r.M.LoginLogo,{className:y.loginLogo,logo:h}),n.createElement("div",{className:y.titleWrapper},c?n.createElement("h1",{className:y.mainTitle},"Update your password"):n.createElement(n.Fragment,null,n.createElement("h1",{className:y.mainTitle},E),a&&n.createElement("h3",{className:y.subTitle},a)))),n.createElement("div",{className:y.loginOuterBox},d))),p?.hideFooter?n.createElement(n.Fragment,null):n.createElement(o.wi,{hideEdition:D,customLinks:p?.footerLinks}))},i=(0,t.keyframes)`
from{
  opacity: 0;
  transform: translate(-60px, 0px);
}

to{
  opacity: 1;
  transform: translate(0px, 0px);
}`,u=d=>({loginMain:(0,t.css)({flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:"100%"}),container:(0,t.css)({minHeight:"100%",backgroundPosition:"center",backgroundRepeat:"no-repeat",minWidth:"100%",marginLeft:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),loginAnim:(0,t.css)({"&:before":{opacity:1},".login-content-box":{opacity:1}}),submitButton:(0,t.css)({justifyContent:"center",width:"100%"}),loginLogo:(0,t.css)({width:"100%",maxWidth:60,marginBottom:d.spacing(2),[d.breakpoints.up("sm")]:{maxWidth:100}}),loginLogoWrapper:(0,t.css)({display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",padding:d.spacing(3)}),titleWrapper:(0,t.css)({textAlign:"center"}),mainTitle:(0,t.css)({fontSize:22,[d.breakpoints.up("sm")]:{fontSize:32}}),subTitle:(0,t.css)({fontSize:d.typography.size.md,color:d.colors.text.secondary}),loginContent:(0,t.css)({maxWidth:478,width:"calc(100% - 2rem)",display:"flex",alignItems:"stretch",flexDirection:"column",position:"relative",justifyContent:"flex-start",zIndex:1,minHeight:320,borderRadius:d.shape.radius.default,padding:d.spacing(2,0),opacity:0,[d.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.5s ease-in-out"},[d.breakpoints.up("sm")]:{minHeight:d.spacing(40),justifyContent:"center"}}),loginOuterBox:(0,t.css)({display:"flex",overflowY:"hidden",alignItems:"center",justifyContent:"center"}),loginInnerBox:(0,t.css)({padding:d.spacing(0,2,2,2),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,maxWidth:415,width:"100%",transform:"translate(0px, 0px)",[d.transitions.handleMotion("no-preference")]:{transition:"0.25s ease"}}),enterAnimation:(0,t.css)({[d.transitions.handleMotion("no-preference")]:{animation:`${i} ease-out 0.2s`}})})},60188:(G,I,e)=>{"use strict";e.d(I,{Q:()=>m});var t=e(2543),n=e.n(t),s=e(96540),r=e(10354),o=e(88575);class m extends s.PureComponent{constructor(){super(...arguments),this.state={text:"",inputCorrected:!1},this.inputRef=s.createRef(),this.updateValue=()=>{const i=this.inputRef.current?.value;let u=!1,d="";const p=this.props.min,c=this.props.max;let y=i!==""?Number(i):void 0;y&&!Number.isNaN(y)&&(p!=null&&y<p?(d=p.toString(),u=!0):c!=null&&y>c?(d=c.toString(),u=!0):d=i??"",this.setState({text:d,inputCorrected:u})),u&&this.updateValueDebounced(),!Number.isNaN(y)&&y!==this.props.value&&this.props.onChange(y)},this.updateValueDebounced=(0,t.debounce)(this.updateValue,500),this.onChange=i=>{this.setState({text:i.currentTarget.value}),this.updateValueDebounced()},this.onKeyPress=i=>{i.key==="Enter"&&this.updateValue()}}componentDidMount(){this.setState({text:isNaN(this.props.value)?"":`${this.props.value}`})}componentDidUpdate(i){if(this.props.value!==i.value){const u=isNaN(this.props.value)?"":`${this.props.value}`;u!==this.state.text&&this.setState({text:u})}}renderInput(){return s.createElement(r.p,{type:"number",ref:this.inputRef,min:this.props.min,max:this.props.max,step:this.props.step,autoFocus:this.props.autoFocus,value:this.state.text,onChange:this.onChange,onBlur:this.updateValue,onKeyPress:this.onKeyPress,placeholder:this.props.placeholder,disabled:this.props.fieldDisabled,width:this.props.width,suffix:this.props.suffix})}render(){const{inputCorrected:i}=this.state;if(i){let u="",{min:d,max:p}=this.props;return p==null?d!=null&&(u=`< ${d}`):d!=null?u=`${d} < > ${p}`:u=`> ${p}`,s.createElement(o.D,{invalid:i,error:`Out of range ${u}`,validationMessageHorizontalOverflow:!0,style:{direction:"rtl"}},this.renderInput())}return this.renderInput()}}},77268:(G,I,e)=>{"use strict";e.d(I,{a:()=>l});var t=e(32196),n=e(96540),s=e(40845),r=e(83598),o=e(29158),m=e(83876);const l=({value:u,settings:d,onChange:p,details:c})=>{const y=(0,s.$j)(),f=(0,s.of)(i);return n.createElement(r.sk,{color:u??"",onChange:p,enableNamedColors:d?.enableNamedColors!==!1},({ref:P,showColorPicker:a,hideColorPicker:E})=>n.createElement("div",{className:f.spot},n.createElement("div",{className:f.colorPicker},n.createElement(m.q,{ref:P,onClick:a,onMouseLeave:E,color:u?y.visualization.getColorByName(u):y.components.input.borderColor})),c&&n.createElement(n.Fragment,null,u?n.createElement("span",{className:f.colorText,onClick:a},u):n.createElement("span",{className:f.placeholderText,onClick:a},d?.placeholder??"Select color"),d?.isClearable&&u&&n.createElement(o.K,{name:"times",onClick:()=>p(void 0),tooltip:"Clear settings"}))))},i=u=>({spot:(0,t.css)({cursor:"pointer",color:u.colors.text.primary,background:u.components.input.background,padding:"3px",height:u.v1.spacing.formInputHeight,border:`1px solid ${u.components.input.borderColor}`,display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end","&:hover":{border:`1px solid ${u.components.input.borderHover}`}}),colorPicker:(0,t.css)({padding:`0 ${u.spacing(1)}`}),colorText:(0,t.css)({flexGrow:2}),placeholderText:(0,t.css)({flexGrow:2,color:u.colors.text.secondary})})},72626:(G,I,e)=>{"use strict";e.d(I,{w:()=>s});var t=e(96540),n=e(60188);const s=({value:r,onChange:o,item:m})=>{const{settings:l}=m,i=(0,t.useCallback)(u=>{o(l?.integer&&u!==void 0?Math.floor(u):u)},[o,l?.integer]);return t.createElement(n.Q,{value:r,min:l?.min,max:l?.max,step:l?.step,placeholder:l?.placeholder,onChange:i})}},33919:(G,I,e)=>{"use strict";e.d(I,{H:()=>nt,u:()=>at});var t=e(96540),n=e(69550),s=e(27310),r=e(11261),o=e(50082),m=e(15292),l=e(94354),i=e(20333),u=e(76218),d=e(32196),p=e(2543),c=e(47737),y=e(60578),f=e(24284),P=e(10354),a=e(83598),E=e(29158),g=e(55852),h=e(60029),D=e(3911);const v=[{value:o.O.Absolute,label:"Absolute",description:"Pick thresholds based on the absolute values"},{value:o.O.Percentage,label:"Percentage",description:"Pick threshold based on the percent between min/max"}];class C extends t.PureComponent{constructor(re){super(re),this.onAddThreshold=()=>{const{steps:oe}=this.state;let Ee=0;oe.length>1&&(Ee=oe[oe.length-1].value+10);let ye=f.Tj.filter(We=>!oe.some(Ke=>Ke.color===We))[1];ye||(ye="#CCCCCC");const Se={value:Ee,color:ye,key:T++},Be=[...oe,Se];(0,c.RU)(Be),this.setState({steps:Be},()=>{this.latestThresholdInputRef.current&&this.latestThresholdInputRef.current.focus(),this.onChange()})},this.onRemoveThreshold=oe=>{const{steps:Ee}=this.state;Ee.length&&oe.key!==Ee[0].key&&this.setState({steps:Ee.filter(ye=>ye.key!==oe.key)},this.onChange)},this.onChangeThresholdValue=(oe,Ee)=>{const ye=oe.target.value.replace(/,/g,"."),Se=parseFloat(ye),Be=isNaN(Se)?"":Se,We=this.state.steps.map(Ke=>(Ke.key===Ee.key&&(Ke={...Ke,value:Be}),Ke));We.length&&(We[0].value=-1/0),(0,c.RU)(We),this.setState({steps:We})},this.onChangeThresholdColor=(oe,Ee)=>{const{steps:ye}=this.state,Se=ye.map(Be=>(Be.key===oe.key&&(Be={...Be,color:Ee}),Be));this.setState({steps:Se},this.onChange)},this.onBlur=()=>{const oe=[...this.state.steps];(0,c.RU)(oe),this.setState({steps:oe},this.onChange)},this.onChange=()=>{this.props.onChange(O(this.props.thresholds,this.state.steps))},this.onModeChanged=oe=>{this.props.onChange({...this.props.thresholds,mode:oe})};const Z=S(re.thresholds.steps);Z[0].value=-1/0,this.state={steps:Z},this.latestThresholdInputRef=t.createRef()}renderInput(re,Z,oe){const Ee=this.props.thresholds.mode===o.O.Percentage,ye=`Threshold ${oe+1}`;return isFinite(re.value)?t.createElement(P.p,{type:"number",step:"0.0001",key:Ee.toString(),onChange:Se=>this.onChangeThresholdValue(Se,re),value:re.value,"aria-label":ye,ref:oe===0?this.latestThresholdInputRef:null,onBlur:this.onBlur,prefix:t.createElement("div",{className:Z.inputPrefix},t.createElement("div",{className:Z.colorPicker},t.createElement(a.sk,{color:re.color,onChange:Se=>this.onChangeThresholdColor(re,Se),enableNamedColors:!0})),Ee&&t.createElement("div",{className:Z.percentIcon},"%")),suffix:t.createElement(E.K,{className:Z.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveThreshold(re),tooltip:`Remove ${ye}`})}):t.createElement(P.p,{type:"text",value:"Base","aria-label":ye,disabled:!0,prefix:t.createElement("div",{className:Z.colorPicker},t.createElement(a.sk,{color:re.color,onChange:Se=>this.onChangeThresholdColor(re,Se),enableNamedColors:!0}))})}render(){const{thresholds:re}=this.props,{steps:Z}=this.state;return t.createElement(y.D.Consumer,null,oe=>{const Ee=x(oe);return t.createElement("div",{className:Ee.wrapper},t.createElement(g.$n,{size:"sm",icon:"plus",onClick:()=>this.onAddThreshold(),variant:"secondary",className:Ee.addButton,fullWidth:!0},"Add threshold"),t.createElement("div",{className:Ee.thresholds},Z.slice(0).reverse().map((ye,Se)=>t.createElement("div",{className:Ee.item,key:`${ye.key}`},this.renderInput(ye,Ee,Se)))),t.createElement("div",null,t.createElement(h.J,{description:"Percentage means thresholds relative to min & max"},"Thresholds mode"),t.createElement(l.z,{options:v,onChange:this.onModeChanged,value:re.mode})))})}}let T=100;function S(Ae){return(!Ae||Ae.length===0)&&(Ae=[{value:-1/0,color:"green"}]),Ae.filter((re,Z)=>(0,p.isNumber)(re.value)||Z===0).map(re=>({color:re.color,value:re.value===null?-1/0:re.value,key:T++}))}function O(Ae,re){return{mode:Ae.mode??o.O.Absolute,steps:re.map(oe=>{const{key:Ee,...ye}=oe;return ye})}}const x=(0,D.N)(Ae=>({wrapper:(0,d.css)`
      display: flex;
      flex-direction: column;
    `,thresholds:(0,d.css)`
      display: flex;
      flex-direction: column;
      margin-bottom: ${Ae.spacing(2)};
    `,item:(0,d.css)`
      margin-bottom: ${Ae.spacing(1)};

      &:last-child {
        margin-bottom: 0;
      }
    `,colorPicker:(0,d.css)`
      padding: 0 ${Ae.spacing(1)};
    `,addButton:(0,d.css)`
      margin-bottom: ${Ae.spacing(1)};
    `,percentIcon:(0,d.css)`
      font-size: ${Ae.typography.bodySmall.fontSize};
      color: ${Ae.colors.text.secondary};
    `,inputPrefix:(0,d.css)`
      display: flex;
      align-items: center;
    `,trashIcon:(0,d.css)`
      color: ${Ae.colors.text.secondary};
      cursor: pointer;
      margin-right: 0;

      &:hover {
        color: ${Ae.colors.text};
      }
    `}));class b extends t.PureComponent{constructor(re){super(re)}render(){const{onChange:re}=this.props;let Z=this.props.value;return Z||(Z={mode:o.O.Percentage,steps:[]}),t.createElement(C,{thresholds:Z,onChange:re})}}var M=e(25019),A=e(40845),R=e(66864),B=e(14578),U=e(37390),W=e(80744),N=e(25148),w=e(75494),L=e(51986),V=e(21594);function K({mapping:Ae,index:re,onChange:Z,onRemove:oe,onDuplicate:Ee,showIconPicker:ye}){const{key:Se,result:Be,id:We}=Ae,Ke=(0,A.of)(k),it=(0,t.useRef)(null),rt=(0,t.useCallback)(ut=>{const Nt={...Ae,result:{...Ae.result}};ut(Nt),Z(re,Nt)},[Ae,re,Z]);(0,t.useEffect)(()=>{it.current&&Ae.isNew&&(it.current.focus(),rt(ut=>{ut.isNew=!1}))},[Ae,it,rt]);const ft=ut=>{rt(Nt=>{Nt.result.color=ut})},pt=()=>{rt(ut=>{ut.result.color=void 0})},Ge=ut=>{rt(Nt=>{Nt.result.icon=ut})},qe=()=>{rt(ut=>{ut.result.icon=void 0})},bt=ut=>{rt(Nt=>{Nt.key=ut.currentTarget.value})},Ft=ut=>{rt(Nt=>{Nt.result.text=ut.currentTarget.value})},Xt=ut=>{rt(Nt=>{Nt.from=parseFloat(ut.currentTarget.value)})},Lt=ut=>{rt(Nt=>{Nt.to=parseFloat(ut.currentTarget.value)})},Qt=ut=>{rt(Nt=>{Nt.pattern=ut.currentTarget.value})},an=ut=>{rt(Nt=>{Nt.specialMatch=ut.value})},gn=[{label:"Null",value:M.W.Null,description:"Matches null and undefined values"},{label:"NaN",value:M.W.NaN,description:"Matches against Number.NaN (not a number)"},{label:"Null + NaN",value:M.W.NullAndNaN,description:"Matches null, undefined and NaN"},{label:"True",value:M.W.True,description:"Boolean true values"},{label:"False",value:M.W.False,description:"Boolean false values"},{label:"Empty",value:M.W.Empty,description:"Empty string"}];return t.createElement(w.sx,{key:We,draggableId:We,index:re},ut=>t.createElement("tr",{className:Ke.dragRow,ref:ut.innerRef,...ut.draggableProps},t.createElement("td",null,t.createElement("div",{className:Ke.dragHandle,...ut.dragHandleProps},t.createElement(B.I,{name:"draggabledots",size:"lg"}))),t.createElement("td",{className:Ke.typeColumn},Ae.type),t.createElement("td",null,Ae.type===M.d.ValueToText&&t.createElement(P.p,{ref:it,type:"text",value:Se??"",onChange:bt,placeholder:"Exact value to match"}),Ae.type===M.d.RangeToText&&t.createElement("div",{className:Ke.rangeInputWrapper},t.createElement(P.p,{type:"number",value:Ae.from??"",placeholder:"Range start",onChange:Xt,prefix:"From"}),t.createElement(P.p,{type:"number",value:Ae.to??"",placeholder:"Range end",onChange:Lt,prefix:"To"})),Ae.type===M.d.RegexToText&&t.createElement(P.p,{type:"text",value:Ae.pattern??"",placeholder:"Regular expression",onChange:Qt}),Ae.type===M.d.SpecialValue&&t.createElement(V.l6,{value:gn.find(Nt=>Nt.value===Ae.specialMatch),options:gn,onChange:an})),t.createElement("td",null,t.createElement(P.p,{type:"text",value:Be.text??"",onChange:Ft,placeholder:"Optional display text"})),t.createElement("td",{className:Ke.textAlignCenter},Be.color&&t.createElement(R.Gy,{spacing:"sm",justify:"center"},t.createElement(a.sk,{color:Be.color,onChange:ft,enableNamedColors:!0}),t.createElement(E.K,{name:"times",onClick:pt,tooltip:"Remove color",tooltipPlacement:"top"})),!Be.color&&t.createElement(a.sk,{color:"gray",onChange:ft,enableNamedColors:!0},Nt=>t.createElement(g.$n,{variant:"primary",fill:"text",onClick:Nt.showColorPicker,ref:Nt.ref,size:"sm"},"Set color"))),ye&&t.createElement("td",{className:Ke.textAlignCenter},t.createElement(R.Gy,{spacing:"sm",justify:"center"},t.createElement(N.n,{onChange:Ge,onClear:qe,value:Be.icon,size:W.Iy.SMALL,folderName:W.Iu.Icon,mediaType:W.zu.Icon,color:Be.color}),Be.icon&&t.createElement(E.K,{name:"times",onClick:qe,tooltip:"Remove icon",tooltipPlacement:"top"}))),t.createElement("td",{className:Ke.textAlignCenter},t.createElement(R.Gy,{spacing:"sm"},t.createElement(E.K,{name:"copy",onClick:()=>Ee(re),"data-testid":"duplicate-value-mapping","aria-label":"Duplicate value mapping",tooltip:"Duplicate"}),t.createElement(E.K,{name:"trash-alt",onClick:()=>oe(re),"data-testid":"remove-value-mapping","aria-label":"Delete value mapping",tooltip:"Delete"})))))}const k=Ae=>({dragRow:(0,d.css)({position:"relative"}),dragHandle:(0,d.css)({cursor:"grab","&:focus-visible&:after":{bottom:0,content:'""',left:0,position:"absolute",right:0,top:0,outline:`2px solid ${Ae.colors.primary.main}`,outlineOffset:"-2px"}}),rangeInputWrapper:(0,d.css)({display:"flex","> div:first-child":{marginRight:Ae.spacing(2)}}),regexInputWrapper:(0,d.css)({display:"flex","> div:first-child":{marginRight:Ae.spacing(2)}}),typeColumn:(0,d.css)({textTransform:"capitalize",textAlign:"center",width:"1%"}),textAlignCenter:(0,d.css)({textAlign:"center"})});function j({value:Ae,onChange:re,onClose:Z,showIconPicker:oe}){const Ee=(0,A.of)(H),[ye,Se]=(0,t.useState)([]);(0,t.useEffect)(()=>{Se(ne(Ae))},[Ae]);const Be=Ge=>{if(!Ae||!Ge.destination)return;const qe=[...ye],bt=qe[Ge.source.index];qe.splice(Ge.source.index,1),qe.splice(Ge.destination.index,0,bt),Se(qe)},We=(Ge,qe)=>{const bt=[...ye];bt.splice(Ge,1,qe),Se(bt)},Ke=Ge=>{const qe=[...ye];qe.splice(Ge,1),Se(qe)},it=[{label:"Value",value:M.d.ValueToText,description:"Match a specific text value"},{label:"Range",value:M.d.RangeToText,description:"Match a numerical range of values"},{label:"Regex",value:M.d.RegexToText,description:"Match a regular expression with replacement"},{label:"Special",value:M.d.SpecialValue,description:"Match on null, NaN, boolean and empty values"}],rt=Ge=>{Se([...ye,X({type:Ge.value,result:{},isNew:!0})])},ft=Ge=>{const qe=se(ye[Ge]),bt=[...ye];bt.splice(Ge,0,{...qe});for(let Ft=Ge;Ft<ye.length;Ft++)bt[Ft].result.index=Ft;Se(bt)},pt=()=>{re(ae(ye)),Z()};return(0,t.useEffect)(()=>{Ae?.length||rt({value:M.d.ValueToText})},[]),t.createElement(t.Fragment,null,t.createElement("div",{className:Ee.tableWrap},t.createElement("table",{className:Ee.editTable},t.createElement("thead",null,t.createElement("tr",null,t.createElement("th",{style:{width:"1%"}}),t.createElement("th",{style:{width:"40%",textAlign:"left"},colSpan:2},"Condition"),t.createElement("th",{style:{textAlign:"left"}},"Display text"),t.createElement("th",{style:{width:"10%"}},"Color"),oe&&t.createElement("th",{style:{width:"10%"}},"Icon"),t.createElement("th",{style:{width:"1%"}}))),t.createElement(w.JY,{onDragEnd:Be},t.createElement(w.gL,{droppableId:"sortable-field-mappings",direction:"vertical"},Ge=>t.createElement("tbody",{ref:Ge.innerRef,...Ge.droppableProps},ye.map((qe,bt)=>t.createElement(K,{key:qe.id,mapping:qe,index:bt,onChange:We,onRemove:Ke,onDuplicate:ft,showIconPicker:oe})),Ge.placeholder))))),t.createElement(U.a.ButtonRow,{leftItems:t.createElement(L.i,{label:"Add a new mapping",variant:"secondary",size:"md",icon:"plus",menuPlacement:"auto",minWidth:40,options:it,onChange:rt})},t.createElement(g.$n,{variant:"secondary",fill:"outline",onClick:Z},"Cancel"),t.createElement(g.$n,{variant:"primary",onClick:pt},"Update")))}const H=Ae=>({tableWrap:(0,d.css)`
    max-height: calc(80vh - 170px);
    min-height: 40px;
    overflow: auto;
  `,editTable:(0,d.css)({width:"100%",marginBottom:Ae.spacing(2),"thead th":{textAlign:"center"},"tbody tr:hover":{background:Ae.colors.action.hover}," th, td":{padding:Ae.spacing(1)}})});function J(){return(0,p.uniqueId)("mapping-")}function X(Ae){return{type:M.d.ValueToText,result:{},id:J(),...Ae}}function se(Ae){return{...X(Ae),id:J()}}function ae(Ae){const re=[],Z={type:M.d.ValueToText,options:{}};return Ae.forEach((oe,Ee)=>{const ye={...oe.result,index:Ee};switch((!ye.text||ye.text.trim().length===0)&&(ye.text=void 0),oe.type){case M.d.ValueToText:oe.key!=null&&(Z.options[oe.key]=ye);break;case M.d.RangeToText:oe.from!=null&&oe.to!=null&&re.push({type:oe.type,options:{from:oe.from,to:oe.to,result:ye}});break;case M.d.RegexToText:oe.pattern!=null&&re.push({type:oe.type,options:{pattern:oe.pattern,result:ye}});break;case M.d.SpecialValue:re.push({type:oe.type,options:{match:oe.specialMatch,result:ye}})}}),Object.keys(Z.options).length>0&&re.unshift(Z),re}function ne(Ae){const re=[];if(Ae)for(const Z of Ae)switch(Z.type){case M.d.ValueToText:for(const oe in Z.options)re.push(X({type:Z.type,result:Z.options[oe],key:oe}));break;case M.d.RangeToText:re.push(X({type:Z.type,result:Z.options.result,from:Z.options.from??0,to:Z.options.to??0}));break;case M.d.RegexToText:re.push(X({type:Z.type,result:Z.options.result,pattern:Z.options.pattern}));break;case M.d.SpecialValue:re.push(X({type:Z.type,result:Z.options.result,specialMatch:Z.options.match??M.W.Null}))}return re.sort((Z,oe)=>(Z.result.index??0)>(oe.result.index??0)?1:-1),re}const q=t.memo(Ae=>{const{value:re,onChange:Z,item:oe}=Ae,Ee=(0,A.of)(ee),ye=oe.settings?.icon,[Se,Be]=(0,t.useState)(!1),We=(0,t.useCallback)(()=>{Be(!1)},[Be]),Ke=(0,t.useMemo)(()=>ne(re),[re]),it=(0,t.useCallback)((ft,pt)=>{Ke[pt].result.color=ft,Z(ae(Ke))},[Ke,Z]),rt=(0,t.useCallback)((ft,pt)=>{Ke[pt].result.icon=ft,Z(ae(Ke))},[Ke,Z]);return t.createElement(R.gW,null,t.createElement("table",{className:Ee.compactTable},t.createElement("tbody",null,Ke.map((ft,pt)=>t.createElement("tr",{key:pt.toString()},t.createElement("td",null,ft.type===M.d.ValueToText&&ft.key,ft.type===M.d.RangeToText&&t.createElement("span",null,"[",ft.from," - ",ft.to,"]"),ft.type===M.d.RegexToText&&ft.pattern,ft.type===M.d.SpecialValue&&ft.specialMatch),t.createElement("td",null,t.createElement(B.I,{name:"arrow-right"})),t.createElement("td",null,ft.result.text),ft.result.color&&t.createElement("td",null,t.createElement(a.sk,{color:ft.result.color,onChange:Ge=>it(Ge,pt),enableNamedColors:!0})),ye&&ft.result.icon&&t.createElement("td",{"data-testid":"iconPicker"},t.createElement(N.n,{onChange:Ge=>rt(Ge,pt),value:ft.result.icon,size:W.Iy.SMALL,folderName:W.Iu.Icon,mediaType:W.zu.Icon,color:ft.result.color})))))),t.createElement(g.$n,{variant:"secondary",size:"sm",fullWidth:!0,onClick:()=>Be(!0)},Ke.length>0&&t.createElement("span",null,"Edit value mappings"),Ke.length===0&&t.createElement("span",null,"Add value mappings")),t.createElement(U.a,{isOpen:Se,title:"Value mappings",onDismiss:We,className:Ee.modal,closeOnBackdropClick:!1},t.createElement(j,{value:re,onChange:Z,onClose:We,showIconPicker:ye})))});q.displayName="ValueMappingsEditor";const ee=Ae=>({modal:(0,d.css)({width:"980px"}),compactTable:(0,d.css)({width:"100%","tbody td":{padding:Ae.spacing(.5)}})});var z=e(59429);const te=({value:Ae,onChange:re,item:Z})=>{const{placeholder:oe,isClearable:Ee}=Z?.settings??{},ye=(0,t.useCallback)(Se=>{re(Se?.value?.uid)},[re]);return t.createElement(z.b,{isClearable:Ee,defaultOptions:!0,onChange:ye,placeholder:oe,value:Ae})};var ie=e(77268),ce=e(8066),ue=e(24293),fe=e(88575);const Te=({value:Ae,onChange:re,item:Z,id:oe})=>{const Ee=(0,A.$j)(),ye=(0,A.of)(de),Se=(0,ce.Hs)(Ae?.mode),We=(Z.settings?.byValueSupport?ce.uf.list():ce.uf.list().filter(pt=>!pt.isByValue)).filter(pt=>!pt.excludeFromPicker).map(pt=>{let Ge=pt.isByValue?" (by value)":"";return{value:pt.id,label:`${pt.name}${Ge}`,description:pt.description,isContinuous:pt.isContinuous,isByValue:pt.isByValue,component(){return t.createElement(he,{mode:pt,theme:Ee})}}}),Ke=pt=>{re({...Ae,mode:pt.value})},it=pt=>{re({...Ae,mode:ft,fixedColor:pt})},rt=pt=>{re({...Ae,mode:ft,seriesBy:pt})},ft=Ae?.mode??ue.Y.Thresholds;if(ft===ue.Y.Fixed||ft===ue.Y.Shades)return t.createElement("div",{className:ye.group},t.createElement(V.l6,{minMenuHeight:200,options:We,value:ft,onChange:Ke,className:ye.select,inputId:oe}),t.createElement(ie.a,{value:Ae?.fixedColor,onChange:it}));if(Z.settings?.bySeriesSupport&&Se.isByValue){const pt=[{label:"Last",value:"last"},{label:"Min",value:"min"},{label:"Max",value:"max"}];return t.createElement(t.Fragment,null,t.createElement("div",{style:{marginBottom:Ee.spacing(2)}},t.createElement(V.l6,{minMenuHeight:200,options:We,value:ft,onChange:Ke,inputId:oe})),t.createElement(fe.D,{label:"Color series by"},t.createElement(l.z,{value:Ae?.seriesBy??"last",options:pt,onChange:rt})))}return t.createElement(V.l6,{minMenuHeight:200,options:We,value:ft,onChange:Ke,inputId:oe})},he=({mode:Ae,theme:re})=>{if(!Ae.getColors)return null;const Z=Ae.getColors(re).map(re.visualization.getColorByName),oe={height:"8px",width:"100%",margin:"2px 0",borderRadius:"3px",opacity:1};if(Ae.isContinuous)oe.background=`linear-gradient(90deg, ${Z.join(",")})`;else{let Ee="",ye="";for(let Se=0;Se<Z.length;Se++){const Be=Z[Se];if(Ee==="")Ee=`linear-gradient(90deg, ${Be} 0%`;else{const Ke=Se/(Z.length-1)*100;Ee+=`, ${ye} ${Ke}%, ${Be} ${Ke}%`}ye=Be}oe.background=Ee}return t.createElement("div",{style:oe})},de=Ae=>({group:(0,d.css)({display:"flex"}),select:(0,d.css)({marginRight:Ae.spacing(1),flexGrow:1})});var le=e(91890),pe=e(64919);const ve=({value:Ae,onChange:re,context:Z})=>t.createElement(pe.e,{links:Ae,onChange:re,data:Z.data,getSuggestions:()=>Z.getSuggestions?Z.getSuggestions(le.uP.Values):[]});class be extends t.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:re}=this.props,{settings:Z}=re;let oe=re.settings?.options||[];Z?.getOptions&&(oe=await Z.getOptions(this.props.context)),this.state.options!==oe&&this.setState({isLoading:!1,options:oe})}}componentDidMount(){this.updateOptions()}componentDidUpdate(re){const Z=re.item?.settings,oe=this.props.item?.settings;if(Z!==oe)this.updateOptions();else if(oe?.getOptions){const Ee=re.context?.data,ye=this.props.context?.data;Ee!==ye&&this.updateOptions()}}render(){const{options:re,isLoading:Z}=this.state,{value:oe,onChange:Ee,item:ye}=this.props,{settings:Se}=ye;return t.createElement(V.KF,{isLoading:Z,value:oe,defaultValue:oe,allowCustomValue:Se?.allowCustomValue,onChange:Be=>{Ee(Be.map(We=>We.value).flatMap(We=>We!==void 0?[We]:[]))},options:re})}}var Oe=e(72626);class Me extends t.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:re}=this.props,{settings:Z}=re;let oe=re.settings?.options||[];Z?.getOptions&&(oe=await Z.getOptions(this.props.context)),this.state.options!==oe&&this.setState({isLoading:!1,options:oe})}}componentDidMount(){this.updateOptions()}componentDidUpdate(re){const Z=re.item?.settings,oe=this.props.item?.settings;if(Z!==oe)this.updateOptions();else if(oe?.getOptions){const Ee=re.context?.data,ye=this.props.context?.data;Ee!==ye&&this.updateOptions()}}render(){const{options:re,isLoading:Z}=this.state,{value:oe,onChange:Ee,item:ye}=this.props,{settings:Se}=ye;let Be=re.find(We=>We.value===oe);return!Be&&oe&&(Be={label:`${oe}`,value:oe}),t.createElement(V.l6,{isLoading:Z,value:Be,defaultValue:oe,allowCustomValue:Se?.allowCustomValue,isClearable:Se?.isClearable,onChange:We=>Ee(We?.value),options:re})}}var Ue=e(57602),we=e(42734);const Re=({value:Ae,onChange:re,item:Z,id:oe})=>t.createElement(we.S,{stats:Ae,onChange:re,allowMultiple:!!Z.settings?.allowMultiple,defaultStat:Z.settings?.defaultStat,inputId:oe});var Fe=e(29286),xe=e(32264);class Ve extends t.PureComponent{constructor(){super(...arguments),this.state={showAdd:!1},this.onRemoveString=re=>{const{value:Z,onChange:oe}=this.props,Ee=[...Z];Ee.splice(re,1),oe(Ee)},this.onValueChange=(re,Z)=>{if("key"in re&&re.key!=="Enter")return;const{value:oe,onChange:Ee}=this.props,ye=re.currentTarget.value.trim();if(Z<0){ye&&(re.currentTarget.value="",Ee([...oe,ye])),this.setState({showAdd:!1});return}if(!ye)return this.onRemoveString(Z);const Se=[...oe];Se[Z]=ye,Ee(Se)}}render(){const{value:re,item:Z}=this.props,{showAdd:oe}=this.state,Ee=$e(xe.$.theme2),ye=Z.settings?.placeholder||"Add text";return t.createElement("div",null,re.map((Se,Be)=>t.createElement(P.p,{className:Ee.textInput,key:`${Be}/${Se}`,defaultValue:Se||"",onBlur:We=>this.onValueChange(We,Be),onKeyDown:We=>this.onValueChange(We,Be),suffix:t.createElement(B.I,{className:Ee.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveString(Be)})})),oe?t.createElement(P.p,{autoFocus:!0,className:Ee.textInput,placeholder:ye,defaultValue:"",onBlur:Se=>this.onValueChange(Se,-1),onKeyDown:Se=>this.onValueChange(Se,-1),suffix:t.createElement(B.I,{name:"plus-circle"})}):t.createElement(g.$n,{icon:"plus",size:"sm",variant:"secondary",onClick:()=>this.setState({showAdd:!0})},ye))}}const $e=(0,D.N)(Ae=>({textInput:(0,d.css)({marginBottom:"5px","&:hover":{border:`1px solid ${Ae.components.input.borderHover}`}}),trashIcon:(0,d.css)({color:Ae.colors.text.secondary,cursor:"pointer","&:hover":{color:Ae.colors.text.primary}})}));var Xe=e(2056);function gt({value:Ae,onChange:re,item:Z}){const oe=(0,A.of)(Dt);return Z?.settings?.isClearable&&Ae!=null?t.createElement("div",{className:oe.wrapper},t.createElement("span",{className:oe.first},t.createElement(Xe.p,{value:Ae,onChange:re})),t.createElement(E.K,{name:"times",onClick:()=>re(void 0),tooltip:"Clear unit selection"})):t.createElement(Xe.p,{value:Ae,onChange:re})}const Dt=Ae=>({wrapper:(0,d.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center"}),first:(0,d.css)({marginRight:Ae.spacing(1),flexGrow:2})}),nt=()=>{const Ae={id:"number",name:"Number",description:"Allows numeric values input",editor:Oe.w},re={id:"slider",name:"Slider",description:"Allows numeric values input",editor:Ue.G},Z={id:"text",name:"Text",description:"Allows string values input",editor:Fe.g},oe={id:"strings",name:"String array",description:"An array of strings",editor:Ve},Ee={id:"boolean",name:"Boolean",description:"Allows boolean values input",editor(Xt){const{id:Lt,...Qt}=Xt;return t.createElement(m.d,{...Qt,onChange:an=>Xt.onChange(an.currentTarget.checked)})}},ye={id:"select",name:"Select",description:"Allows option selection",editor:Me},Se={id:"multi-select",name:"Multi select",description:"Allows for multiple option selection",editor:be},Be={id:"radio",name:"Radio",description:"Allows option selection",editor(Xt){return t.createElement(l.z,{...Xt,options:Xt.item.settings?.options})}},We={id:"unit",name:"Unit",description:"Allows unit input",editor:gt},Ke={id:"color",name:"Color",description:"Allows color selection",editor(Xt){return t.createElement(ie.a,{value:Xt.value,onChange:Xt.onChange,settings:Xt.item.settings,details:!0})}},it={id:"fieldColor",name:"Field Color",description:"Field color selection",editor:Te},rt={id:"links",name:"Links",description:"Allows defining data links",editor:ve},ft={id:"stats-picker",name:"Stats Picker",editor:Re,description:""},pt={id:"timezone",name:"Time zone",description:"Time zone selection",editor:i.U},Ge={id:"field-name",name:"Field name",description:"Allows selecting a field name from a data frame",editor:u.O};return[Z,Ae,re,Ee,Be,ye,We,rt,ft,oe,pt,it,Ke,Se,Ge,{id:"dashboard-uid",name:"Dashboard",description:"Select dashboard",editor:te},{id:"mappings",name:"Mappings",description:"Allows defining value mappings",editor:q},{id:"thresholds",name:"Thresholds",description:"Allows defining thresholds",editor:b}]},at=()=>{const Ae=["Standard options"],re={id:"displayName",path:"displayName",name:"Display name",description:"Change the field or series name",editor:n.D.get("text").editor,override:n.D.get("text").editor,process:s.AM,settings:{placeholder:"none",expandTemplateVars:!0},shouldApply:()=>!0,category:Ae},Z={id:"unit",path:"unit",name:"Unit",description:"",editor:n.D.get("unit").editor,override:n.D.get("unit").editor,process:s.OU,settings:{placeholder:"none"},shouldApply:()=>!0,category:Ae},oe={id:"fieldMinMax",path:"fieldMinMax",name:"Field min/max",description:"Calculate min max per field",editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:s.FM,shouldApply:pt=>pt.type===r.PU.number,showIf:pt=>pt.min===void 0||pt.max===void 0,category:Ae},Ee={id:"min",path:"min",name:"Min",description:"Leave empty to calculate based on all values",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:s.m0,settings:{placeholder:"auto"},shouldApply:pt=>pt.type===r.PU.number,category:Ae},ye={id:"max",path:"max",name:"Max",description:"Leave empty to calculate based on all values",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:s.m0,settings:{placeholder:"auto"},shouldApply:pt=>pt.type===r.PU.number,category:Ae},Se={id:"decimals",path:"decimals",name:"Decimals",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:s.m0,settings:{placeholder:"auto",min:0,max:15,integer:!0},shouldApply:pt=>pt.type===r.PU.number,category:Ae},Be={id:"noValue",path:"noValue",name:"No value",description:"What to show when there is no value",editor:n.D.get("text").editor,override:n.D.get("text").editor,process:s.OU,settings:{placeholder:"-"},shouldApply:()=>!0,category:Ae},We={id:"links",path:"links",name:"Data links",editor:n.D.get("links").editor,override:n.D.get("links").editor,process:s.Ch,settings:{placeholder:"-"},shouldApply:()=>!0,category:["Data links"],getItemsCount:pt=>pt?pt.length:0},Ke={id:"color",path:"color",name:"Color scheme",editor:n.D.get("fieldColor").editor,override:n.D.get("fieldColor").editor,process:s.hS,shouldApply:()=>!0,settings:{byValueSupport:!0,preferThresholdsMode:!0},category:Ae},it={id:"mappings",path:"mappings",name:"Value mappings",description:"Modify the display text based on input value",editor:n.D.get("mappings").editor,override:n.D.get("mappings").editor,process:s.xT,settings:{},defaultValue:[],shouldApply:pt=>pt.type!==r.PU.time,category:["Value mappings"],getItemsCount:pt=>pt?pt.length:0},rt={id:"thresholds",path:"thresholds",name:"Thresholds",editor:n.D.get("thresholds").editor,override:n.D.get("thresholds").editor,process:s.N7,settings:{},defaultValue:{mode:o.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]},shouldApply:()=>!0,category:["Thresholds"],getItemsCount:pt=>pt?pt.steps.length:0},ft={id:"filterable",path:"filterable",name:"Ad-hoc filterable",hideFromDefaults:!0,editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:s.FM,shouldApply:()=>!0,settings:{},category:Ae};return[Z,Ee,ye,oe,Se,re,Ke,Be,We,it,rt,ft]}},57602:(G,I,e)=>{"use strict";e.d(I,{G:()=>i});var t=e(32196),n=e(94659),s=e(9821),r=e(96540),o=e(40845),m=e(24849),l=e(60188);const i=({value:p,onChange:c,item:y})=>{const f=(0,r.useRef)(null),{settings:P}=y,a=P?.min||0,E=P?.max||100,g=P?.step,h=P?.marks||{[a]:a,[E]:E},D=P?.included,v=P?.ariaLabelForHandle,C=75,T=!0,S=(0,o.$j)(),[O,x]=(0,r.useState)(p??a),[b,M]=(0,r.useState)(C);(0,r.useEffect)(()=>{p!=null&&p!==O&&x(p)},[p,O]),(0,r.useEffect)(()=>{const N=getComputedStyle(f.current),w=N.getPropertyValue("font-weight")||"normal",L=N.getPropertyValue("font-size")||"16px",V=N.getPropertyValue("font-family")||"Arial",K="0",k=4,j=8,H=Math.max((E+(g||0)).toString().length,(E-(g||0)).toString().length)+k,J=K.repeat(H),X=u(J,`${w} ${L} ${V}`);X&&M(X+j*2)},[E,g]);const A=(0,r.useCallback)(N=>{const w=typeof N=="number"?N:N[0];x(w),c&&c(w)},[x,c]),R=(0,r.useCallback)(N=>{let w=N;(Number.isNaN(w)||!w)&&(w=0),x(w),c&&c(w)},[c]),B=(0,m.$)(S,T,!!h),U=d(S,b),W=T?[]:[B.sliderInputVertical];return r.createElement("div",{className:(0,t.cx)(B.container,B.slider)},r.createElement(n.Global,{styles:B.slider}),r.createElement("div",{className:(0,t.cx)(B.sliderInput,...W)},r.createElement(s.A,{min:a,max:E,step:g,defaultValue:p,value:O,onChange:A,vertical:!T,reverse:!1,ariaLabelForHandle:v,marks:h,included:D}),r.createElement("span",{className:U.numberInputWrapper,ref:f},r.createElement(l.Q,{value:O,onChange:R,max:E,min:a,step:g}))))};function u(p,c){const f=document.createElement("canvas").getContext("2d");return f?(f.font=c,f.measureText(p).width):null}const d=(p,c)=>({numberInputWrapper:(0,t.css)({marginLeft:p.spacing(3),maxHeight:"32px",maxWidth:c,minWidth:c,overflow:"visible",width:"100%"})})},29286:(G,I,e)=>{"use strict";e.d(I,{g:()=>r});var t=e(96540),n=e(21744),s=e(10354);const r=({value:o,onChange:m,item:l,suffix:i})=>{const u=l.settings?.useTextarea?n.f:s.p,d=(0,t.useCallback)(p=>{let c=o??"";"key"in p?p.key==="Enter"&&!l.settings?.useTextarea&&(c=p.currentTarget.value.trim()):c=p.currentTarget.value.trim(),c!==o&&m(c===""?void 0:c)},[o,l.settings?.useTextarea,m]);return t.createElement(u,{placeholder:l.settings?.placeholder,defaultValue:o||"",rows:l.settings?.useTextarea&&l.settings.rows||5,onBlur:d,onKeyDown:d,suffix:i})}},67608:(G,I,e)=>{"use strict";e.d(I,{Y:()=>K});var t=e(32196),n=e(96540),s=e(64388),r=e(40845),o=e(76888),m=e(32264),l=e(40276);function i(j){return m.$.featureToggles.betterPageScrolling?n.createElement(u,{...j},j.children):n.createElement(l.E,{...j})}function u({children:j,scrollRefCallback:H,scrollTop:J,divId:X}){const se=(0,r.of)(d),ae=(0,n.useRef)(null);return(0,n.useEffect)(()=>{ae.current&&H&&H(ae.current)},[ae,H]),(0,n.useEffect)(()=>{ae.current&&J!=null&&ae.current?.scrollTo(0,J)},[J]),n.createElement("div",{ref:ae,className:(0,t.cx)(se.nativeScrollbars,"scrollbar-view"),id:X},j)}function d(){return{nativeScrollbars:(0,t.css)({label:"native-scroll-container",minHeight:"calc(100% + 0px)",maxHeight:"calc(100% + 0px)",display:"flex",flexDirection:"column",flexGrow:1,overflow:"auto"})}}var p=e(39419);const c=({isLoading:j,children:H,className:J})=>{let X=J?n.createElement("div",{className:J},H):H;return n.createElement(n.Fragment,null,j?n.createElement(p.A,null):X)};var y=e(13773),f=e(17172),P=e(94753),a=e(29158),E=e(88575),g=e(10354);const h=({value:j,onEdit:H})=>{const J=(0,r.of)(D),[X,se]=(0,n.useState)(j),[ae,ne]=(0,n.useState)(!1),[q,ee]=(0,n.useState)(!1),[z,te]=(0,n.useState)();(0,n.useEffect)(()=>{se(j)},[j]);const ie=(0,n.useCallback)(async ce=>{const ue=ce.currentTarget.value;if(!ue)te("Please enter a title");else if(ue===j)te(void 0),ne(!1);else{ee(!0);try{await H(ue),te(void 0),ne(!1)}catch(fe){(0,f.NF)(fe)?te(fe.data.message):fe instanceof Error&&te(fe.message)}ee(!1)}},[H,j]);return ae?n.createElement("div",{className:J.inputContainer},n.createElement(E.D,{className:J.field,loading:q,invalid:!!z,error:z},n.createElement(g.p,{className:J.input,defaultValue:X,onKeyDown:ce=>{ce.key==="Enter"&&ie(ce)},autoFocus:!0,onBlur:ie,onChange:ce=>se(ce.currentTarget.value),onFocus:()=>ne(!0)}))):n.createElement("div",{className:J.textContainer},n.createElement("div",{className:J.textWrapper},n.createElement(P.E,{element:"h1",truncate:!0},X),n.createElement(a.K,{name:"pen",size:"lg",tooltip:"Edit title",onClick:()=>ne(!0)})))};h.displayName="EditableTitle";const D=j=>({textContainer:(0,t.css)({minWidth:0}),field:(0,t.css)({flex:1,left:`calc(-${j.spacing(1)} - 1px)`,position:"relative",marginBottom:0}),input:(0,t.css)({input:{...j.typography.h1}}),inputContainer:(0,t.css)({display:"flex",flex:1}),textWrapper:(0,t.css)({alignItems:"center",display:"flex",gap:j.spacing(1)})});function v({navItem:j,renderTitle:H,actions:J,info:X,subTitle:se,onEditTitle:ae}){const ne=(0,r.of)(C),q=se??j.subTitle,ee=ae?n.createElement(h,{value:j.text,onEdit:ae}):n.createElement("div",{className:ne.title},j.img&&n.createElement("img",{className:ne.img,src:j.img,alt:`logo for ${j.text}`}),H?H(j.text):n.createElement("h1",null,j.text));return n.createElement("div",{className:ne.pageHeader},n.createElement("div",{className:ne.topRow},n.createElement("div",{className:ne.titleInfoContainer},ee,X&&n.createElement(y.Q,{info:X})),n.createElement("div",{className:ne.actions},J)),q&&n.createElement("div",{className:ne.subTitle},q))}const C=j=>({topRow:(0,t.css)({alignItems:"flex-start",display:"flex",flexDirection:"row",flexWrap:"wrap",gap:j.spacing(1,3)}),title:(0,t.css)({display:"flex",flexDirection:"row",maxWidth:"100%",h1:{display:"flex",marginBottom:0}}),actions:(0,t.css)({display:"flex",flexDirection:"row",gap:j.spacing(1)}),titleInfoContainer:(0,t.css)({display:"flex",label:"title-info-container",flex:1,flexWrap:"wrap",gap:j.spacing(1,4),justifyContent:"space-between",maxWidth:"100%",minWidth:"200px"}),pageHeader:(0,t.css)({label:"page-header",display:"flex",flexDirection:"column",gap:j.spacing(1),marginBottom:j.spacing(2)}),subTitle:(0,t.css)({position:"relative",color:j.colors.text.secondary}),img:(0,t.css)({width:"32px",height:"32px",marginRight:j.spacing(2)})});var T=e(63021),S=e(8984),O=e(40675);function x({navItem:j}){const H=(0,r.of)(b);return n.createElement("div",{className:H.tabsWrapper},n.createElement(T.U,null,j.children.map((J,X)=>{const se=J.icon?(0,S.toIconName)(J.icon):void 0;return!J.hideFromTabs&&n.createElement(O.o,{label:J.text,active:J.active,key:`${J.url}-${X}`,icon:se,counter:J.tabCounter,href:J.url,suffix:J.tabSuffix,onChangeTab:J.onClick})})))}const b=j=>({tabsWrapper:(0,t.css)({paddingBottom:j.spacing(3)})});var M=e(25508),A=e(17422),R=e(99140),B=e(31678);function U(j,H){if(H)return H;if(j&&R.M_)return(0,B.useSelector)((0,M.Mz)(W,J=>(0,A.tc)(J,j??"home")))}function W(j){return j.navIndex}var N=e(28215),w=e(19361),L=e(3984);function V(j,H){const J=(0,B.useSelector)(X=>X.navIndex)?.[N.Id];(0,n.useEffect)(()=>{const X=(j?.node!==j?.main?j?.node:j?.main)??{text:"Grafana"},se=(0,L.Z)(X,H,J).map(ae=>ae.text).reverse();se[se.length-1]=w.M.AppTitle,document.title=se.join(" - ")},[J,j,H])}const K=({navId:j,navModel:H,pageNav:J,renderTitle:X,onEditTitle:se,actions:ae,subTitle:ne,children:q,className:ee,info:z,layout:te=s.k.Standard,scrollTop:ie,scrollRef:ce,...ue})=>{const fe=(0,r.of)(k),Te=U(j,H),{chrome:he}=(0,o.Il)();V(Te,J);const de=J??Te?.node;return(0,n.useLayoutEffect)(()=>{Te&&he.update({sectionNav:Te,pageNav:J,layout:te})},[Te,J,he,te]),n.createElement("div",{className:(0,t.cx)(fe.wrapper,ee),...ue},te===s.k.Standard&&n.createElement(i,{divId:"page-scrollbar",autoHeightMin:"100%",scrollTop:ie,scrollRefCallback:ce},n.createElement("div",{className:fe.pageInner},de&&n.createElement(v,{actions:ae,onEditTitle:se,navItem:de,renderTitle:X,info:z,subTitle:ne}),J&&J.children&&n.createElement(x,{navItem:J}),n.createElement("div",{className:fe.pageContent},q))),te===s.k.Canvas&&n.createElement(i,{divId:"page-scrollbar",autoHeightMin:"100%",scrollTop:ie,scrollRefCallback:ce},n.createElement("div",{className:fe.canvasContent},q)),te===s.k.Custom&&q)};K.Contents=c;const k=j=>({wrapper:(0,t.css)({label:"page-wrapper",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0}),pageContent:(0,t.css)({label:"page-content",flexGrow:1}),primaryBg:(0,t.css)({background:j.colors.background.primary}),pageInner:(0,t.css)({label:"page-inner",padding:j.spacing(2),borderBottom:"none",background:j.colors.background.primary,display:"flex",flexDirection:"column",flexGrow:1,margin:j.spacing(0,0,0,0),[j.breakpoints.up("md")]:{padding:j.spacing(4)}}),canvasContent:(0,t.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:j.spacing(2),flexBasis:"100%",flexGrow:1})})},13773:(G,I,e)=>{"use strict";e.d(I,{Q:()=>r});var t=e(32196),n=e(96540),s=e(40845);function r({info:m}){const l=(0,s.of)(o);return n.createElement("div",{className:l.container},m.map((i,u)=>n.createElement(n.Fragment,{key:u},n.createElement("div",{className:l.infoItem},n.createElement("div",{className:l.label},i.label),i.value),u+1<m.length&&n.createElement("div",{"data-testid":"page-info-separator",className:l.separator}))))}const o=m=>({container:(0,t.css)({display:"flex",flexDirection:"row",gap:m.spacing(1.5),overflow:"auto"}),infoItem:(0,t.css)({...m.typography.bodySmall,display:"flex",flexDirection:"column",gap:m.spacing(.5)}),label:(0,t.css)({color:m.colors.text.secondary}),separator:(0,t.css)({borderLeft:`1px solid ${m.colors.border.weak}`})})},39419:(G,I,e)=>{"use strict";e.d(I,{A:()=>o});var t=e(96540),n=e(90613),s=e(39558);const o=({pageName:m=""})=>{const l=`Loading ${m}...`;return t.createElement(n.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10},t.createElement(s._,{text:l}))}},7392:(G,I,e)=>{"use strict";e.d(I,{L:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(69529),o=e(72109);function m({entity:i="Page"}){const u=(0,s.of)(l);return n.createElement("div",{className:u.container},n.createElement(r.p,{message:`${i} not found`,variant:"not-found"},"We're looking but can't seem to find this ",i.toLowerCase(),". Try returning"," ",n.createElement(o.Y,{href:"/"},"home")," or seeking help on the"," ",n.createElement(o.Y,{href:"https://community.grafana.com",external:!0},"community site.")))}function l(i){return{container:(0,t.css)({padding:i.spacing(8,2,2,2)})}}},68313:(G,I,e)=>{"use strict";e.d(I,{$:()=>u});var t=e(32196),n=e(96540),s=e(32264),r=e(40845),o=e(55852),m=e(21594),l=e(14578),i=e(17706);const u=({onChange:p,maxMenuHeight:c,isWidget:y=!1})=>{const f=()=>s.$.featureToggles.vizAndWidgetSplit?y?(0,i.nr)():(0,i.if)():(0,i.A4)(),P=(0,n.useMemo)(f,[y]),a=(0,n.useMemo)(()=>P.map(C=>({label:C.name,imgUrl:C.info.logos.small,value:C})).sort((C,T)=>C.label?.localeCompare(T.label)),[P]),[E,g]=(0,n.useState)([]),h=(0,n.useCallback)(C=>{const T=C.filter(S=>S.value).map(S=>S.value);p(T),g(C)},[p]),D=(0,r.of)(d),v={defaultOptions:!0,getOptionLabel:C=>C.label,getOptionValue:C=>C.value,noOptionsMessage:"No Panel types found",placeholder:"Filter by type",maxMenuHeight:c,options:a,value:E,onChange:h};return n.createElement("div",{className:D.container},E.length>0&&n.createElement(o.$n,{size:"xs",icon:"trash-alt",fill:"text",className:D.clear,onClick:()=>h([]),"aria-label":"Clear types"},"Clear types"),n.createElement(m.KF,{...v,prefix:n.createElement(l.I,{name:"filter"}),"aria-label":"Panel Type filter"}))};function d(p){return{container:(0,t.css)`
      label: container;
      position: relative;
      min-width: 180px;
      flex-grow: 1;
    `,clear:(0,t.css)`
      label: clear;
      font-size: ${p.spacing(1.5)};
      position: absolute;
      top: -${p.spacing(4.5)};
      right: 0;
    `}}},78361:(G,I,e)=>{"use strict";e.d(I,{s:()=>o});var t=e(96540),n=e(13544),s=e(10354),r=e(29158);const o=t.forwardRef((m,l)=>{const[i,u]=(0,t.useState)(!1);return t.createElement(s.p,{...m,type:i?"text":"password","data-testid":n.Tp.pages.Login.password,ref:l,suffix:t.createElement(r.K,{name:i?"eye-slash":"eye","aria-controls":m.id,role:"switch","aria-checked":i,onClick:()=>{u(!i)},tooltip:i?"Hide password":"Show password"})})});o.displayName="PasswordField"},22214:(G,I,e)=>{"use strict";e.d(I,{j:()=>o});var t=e(32196),n=e(96540),s=e(36663),r=e(40845);const o=n.memo(n.forwardRef(({className:i,children:u,markdown:d,styleOverrides:p,onRemove:c,...y},f)=>{const P=(0,r.of)(a=>l(a,p?.borderTop));return n.createElement("div",{className:(0,t.cx)(P.wrapper,i),...y,ref:f},d&&m(d),u)}));function m(i){const u=(0,s.G)(i);return n.createElement("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:u}})}o.displayName="OperationRowHelp";const l=(i,u)=>{const d=i.shape.radius.default,p=i.colors.background.secondary;return{wrapper:(0,t.css)`
      padding: ${i.spacing(2)};
      border: 2px solid ${p};
      border-top: ${u?u+p:"none"};
      border-radius: 0 0 ${d} ${d};
      position: relative;
      top: -4px;
    `}}},10343:(G,I,e)=>{"use strict";e.d(I,{A:()=>i,q:()=>l});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(29158);function m(d){const p=(0,r.of)(u);return n.createElement("div",{className:(0,t.cx)(p.icon,"active"in d&&d.active&&p.active)},n.createElement(o.K,{name:d.icon,tooltip:d.title,className:p.icon,disabled:!!d.disabled,onClick:d.onClick,type:"button","data-testid":d.dataTestId??s.Tp.components.QueryEditorRow.actionButton(d.title),..."active"in d&&{"aria-pressed":d.active}}))}function l(d){return n.createElement(m,{...d})}const i=d=>n.createElement(m,{...d}),u=d=>({icon:(0,t.css)({display:"flex",position:"relative",color:d.colors.text.secondary}),active:(0,t.css)({"&:before":{display:"block",content:'" "',position:"absolute",left:-1,right:2,height:3,borderRadius:d.shape.radius.default,bottom:-8,backgroundImage:d.colors.gradients.brandHorizontal}})})},7788:(G,I,e)=>{"use strict";e.d(I,{u:()=>f});var t=e(32196),n=e(96540),s=e(75494),r=e(22589),o=e(14110),m=e(40845),l=e(67892),i=e(29158),u=e(67061),d=e(14578),p=e(8484);const c=({actionsElement:a,disabled:E,draggable:g,collapsable:h=!0,dragHandleProps:D,headerElement:v,isContentVisible:C,onRowToggle:T,reportDragMousePosition:S,title:O,id:x,expanderMessages:b})=>{const M=(0,m.of)(y);let A=C?(0,p.t)("query-operation.header.collapse-row","Collapse query row"):(0,p.t)("query-operation.header.expand-row","Expand query row");b!==void 0&&C?A=b.close:b!==void 0&&(A=b?.open);const R=(0,p.t)("query-operation.header.drag-and-drop","Drag and drop to reorder");return n.createElement("div",{className:M.header},n.createElement("div",{className:M.column},h&&n.createElement(i.K,{name:C?"angle-down":"angle-right",tooltip:A,className:M.collapseIcon,onClick:T,"aria-expanded":C,"aria-controls":x}),O&&n.createElement("div",{className:M.titleWrapper,onClick:T,"aria-label":"Query operation row title"},n.createElement("div",{className:(0,t.cx)(M.title,E&&M.disabled)},O)),v),n.createElement(u.B,{gap:1,alignItems:"center"},a,g&&n.createElement("div",{onMouseMove:S,...D},n.createElement(d.I,{title:R,name:"draggabledots",size:"lg",className:M.dragIcon}))))},y=a=>({header:(0,t.css)`
    label: Header;
    padding: ${a.spacing(.5,.5)};
    border-radius: ${a.shape.radius.default};
    background: ${a.colors.background.secondary};
    min-height: ${a.spacing(4)};
    display: grid;
    grid-template-columns: minmax(100px, max-content) min-content;
    align-items: center;
    justify-content: space-between;
    white-space: nowrap;

    &:focus {
      outline: none;
    }
  `,column:(0,t.css)`
    label: Column;
    display: flex;
    align-items: center;
  `,dragIcon:(0,t.css)`
    cursor: grab;
    color: ${a.colors.text.disabled};
    margin: ${a.spacing(0,.5)};
    &:hover {
      color: ${a.colors.text};
    }
  `,collapseIcon:(0,t.css)`
    margin-left: ${a.spacing(.5)};
    color: ${a.colors.text.disabled};
    }
  `,titleWrapper:(0,t.css)`
    display: flex;
    align-items: center;
    flex-grow: 1;
    cursor: pointer;
    overflow: hidden;
    margin-right: ${a.spacing(.5)};
  `,title:(0,t.css)`
    font-weight: ${a.typography.fontWeightBold};
    color: ${a.colors.text.link};
    margin-left: ${a.spacing(.5)};
    overflow: hidden;
    text-overflow: ellipsis;
  `,disabled:(0,t.css)`
    color: ${a.colors.text.disabled};
  `});c.displayName="QueryOperationRowHeader";function f({children:a,actions:E,title:g,headerElement:h,onClose:D,onOpen:v,isOpen:C,disabled:T,draggable:S,collapsable:O,index:x,id:b,expanderMessages:M}){const[A,R]=(0,n.useState)(C!==void 0?C:!0),B=(0,m.of)(P),U=(0,n.useCallback)(()=>{R(!A)},[A,R]);(0,n.useEffect)(()=>{typeof C=="boolean"&&R(C)},[C]);const W=(0,n.useCallback)(V=>{if(V.defaultPrevented){const K=V.currentTarget.getBoundingClientRect(),k=V.clientX-K.left,j=V.clientY-K.top;(0,o.rR)("query_row_reorder_drag_position",{x:k/K.width,y:j/K.height,width:K.width,height:K.height})}},[]);(0,r.A)(()=>{A?v&&v():D&&D()},[A]);const N={isOpen:A,onOpen:()=>{R(!0)},onClose:()=>{R(!1)}},w=E&&l.renderOrCallToRender(E,N),L=h&&l.renderOrCallToRender(h,N);return S?n.createElement(s.sx,{draggableId:b,index:x},V=>n.createElement(n.Fragment,null,n.createElement("div",{ref:V.innerRef,className:B.wrapper,...V.draggableProps},n.createElement("div",null,n.createElement(c,{id:b,actionsElement:w,disabled:T,draggable:!0,collapsable:O,dragHandleProps:V.dragHandleProps,headerElement:L,isContentVisible:A,onRowToggle:U,reportDragMousePosition:W,title:g,expanderMessages:M})),A&&n.createElement("div",{className:B.content},a)))):n.createElement("div",{className:B.wrapper},n.createElement(c,{id:b,actionsElement:w,disabled:T,draggable:!1,collapsable:O,headerElement:L,isContentVisible:A,onRowToggle:U,reportDragMousePosition:W,title:g,expanderMessages:M}),A&&n.createElement("div",{className:B.content},a))}const P=a=>({wrapper:(0,t.css)`
      margin-bottom: ${a.spacing(2)};
    `,content:(0,t.css)`
      margin-top: ${a.spacing(.5)};
      margin-left: ${a.spacing(3)};
    `});f.displayName="QueryOperationRow"},37425:(G,I,e)=>{"use strict";e.d(I,{n:()=>Te});var t=e(96540),n=e(40845),s=e(8866),r=e(17464),o=e(32196),m=e(62930),l=e(14578),i=e(56034),u=e(10354),d=e(87266),p=e(16797),c=e(88824);const y=(0,t.forwardRef)(({children:he,iconName:de},le)=>{const pe=(0,n.of)(f);return t.createElement("div",{className:pe.container,ref:le},de&&t.createElement(l.I,{name:de,size:"xs"}),he)});y.displayName="ValueContainer";const f=he=>{const{prefix:de}=(0,u.n)({theme:he}),{multiValueContainer:le}=(0,c.J)(he);return{container:(0,o.cx)(de,le,(0,o.css)`
        position: relative;
        padding: ${he.spacing(.5,1,.5,1)};

        svg {
          margin-right: ${he.spacing(.5)};
        }
      `)}},P=360,a=300,E=320,g=360,h=320,D=360,v=g+D,C=he=>he.stopPropagation(),T=({appliedRoles:he,basicRole:de,disabled:le,isFocused:pe,query:ve,showBasicRole:be,width:Oe,isLoading:Me,onOpen:Ue,onClose:we,onQueryChange:Re,...Fe})=>{const xe=(0,n.of)(O,!1,!!pe,!!le,!1,Oe),Ve=(0,t.useRef)(null);(0,t.useEffect)(()=>{pe&&Ve.current?.focus()});const $e=gt=>{const Dt=gt.target?.value;Re(Dt)},Xe=be&&de!=="None";return pe?t.createElement("div",{className:xe.wrapper},Xe&&t.createElement(y,null,de),he.map(gt=>t.createElement(y,{key:gt.uid},gt.group+":"+(gt.displayName||gt.name))),!le&&t.createElement("input",{...Fe,className:xe.input,ref:Ve,onMouseDown:C,onChange:$e,"data-testid":"role-picker-input",placeholder:pe?"Select role":"",value:ve}),t.createElement("div",{className:xe.suffix},t.createElement(l.I,{name:"angle-up",className:xe.dropdownIndicator,onMouseDown:we}))):t.createElement("div",{className:(0,o.cx)(xe.wrapper,xe.selectedRoles),onMouseDown:Ue},Xe&&t.createElement(y,null,de),t.createElement(S,{appliedRoles:he,numberOfRoles:he.length,showBuiltInRole:Xe}),Me&&t.createElement("div",{className:xe.spinner},t.createElement(m.y,{size:16,inline:!0})))};T.displayName="RolePickerInput";const S=({showBuiltInRole:he,numberOfRoles:de,appliedRoles:le})=>{const pe=(0,n.of)(ve=>x(ve));return t.createElement(t.Fragment,null,de?t.createElement(i.m,{content:t.createElement("div",{className:pe.tooltip},le?.map(ve=>t.createElement("p",{key:ve.uid},ve.group+":"+(ve.displayName||ve.name))))},t.createElement(y,null,`${he?"+":""}${de} role${de>1?"s":""}`)):!he&&t.createElement(y,null,"No roles assigned"))},O=(he,de,le,pe,ve,be)=>{const Oe=(0,u.n)({theme:he,invalid:de});return{wrapper:(0,o.cx)(Oe.wrapper,(0,d.Xb)(he,de),le&&(0,o.css)`
          ${p.focusCss(he.v1)}
        `,pe&&Oe.inputDisabled,(0,o.css)({minWidth:be||P+"px",width:be,minHeight:"32px",height:"auto",flexDirection:"row",paddingRight:he.spacing(1),maxWidth:"100%",alignItems:"center",display:"flex",flexWrap:"wrap",justifyContent:"flex-start",position:"relative",boxSizing:"border-box",cursor:"default"}),ve&&(0,o.css)`
          padding-left: 0;
        `),input:(0,o.cx)((0,d.Xb)(he,de),(0,o.css)`
        max-width: 120px;
        border: none;
        cursor: ${le?"default":"pointer"};
      `),suffix:Oe.suffix,dropdownIndicator:(0,o.css)`
      cursor: pointer;
    `,selectedRoles:(0,o.css)`
      display: flex;
      align-items: center;
      cursor: ${pe?"not-allowed":"pointer"};
    `,tooltip:(0,o.css)`
      p {
        margin-bottom: ${he.spacing(.5)};
      }
    `,spinner:(0,o.css)({display:"flex",flexGrow:1,justifyContent:"flex-end"})}},x=he=>({tooltip:(0,o.css)`
    p {
      margin-bottom: ${he.spacing(.5)};
    }
  `});var b=e(72109),M=e(40276),A=e(67061),R=e(55852),B=e(5173),U=e(31678);const W=he=>({hideScrollBar:(0,o.css)({".scrollbar-view":{"&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"}}),menuWrapper:(0,o.css)({display:"flex",maxHeight:"650px",position:"absolute",zIndex:he.zIndex.dropdown,overflow:"hidden",minWidth:"auto"}),menu:(0,o.css)({minWidth:`${E}px`,maxWidth:`${g}px`,"& > div":{paddingTop:he.spacing(1)}}),menuLeft:(0,o.css)({flexDirection:"row-reverse"}),subMenu:(0,o.css)({height:"100%",minWidth:`${h}px`,maxWidth:`${D}px`,display:"flex",flexDirection:"column",borderLeft:`1px solid ${he.components.input.borderColor}`,"& > div":{paddingTop:he.spacing(1)}}),subMenuLeft:(0,o.css)({borderRight:`1px solid ${he.components.input.borderColor}`,borderLeft:"unset"}),groupHeader:(0,o.css)({padding:he.spacing(0,4.5),display:"flex",alignItems:"center",color:he.colors.text.primary,fontWeight:he.typography.fontWeightBold}),container:(0,o.css)({padding:he.spacing(1),border:`1px ${he.colors.border.weak} solid`,borderRadius:he.shape.radius.default,backgroundColor:he.colors.background.primary,zIndex:he.zIndex.modal}),menuSection:(0,o.css)({marginBottom:he.spacing(2)}),menuOptionCheckbox:(0,o.css)({display:"flex",margin:he.spacing(0,1,0,.25)}),menuButtonRow:(0,o.css)({backgroundColor:he.colors.background.primary,padding:he.spacing(1)}),menuOptionBody:(0,o.css)({fontWeight:he.typography.fontWeightRegular,padding:he.spacing(0,1.5,0,0)}),menuOptionDisabled:(0,o.css)({color:he.colors.text.disabled,cursor:"not-allowed"}),menuOptionExpand:(0,o.css)({position:"absolute",right:he.spacing(2.5),color:he.colors.text.disabled,"&:after":{content:'">"'}}),menuOptionInfoSign:(0,o.css)({color:he.colors.text.disabled}),basicRoleSelector:(0,o.css)({margin:he.spacing(1,1.25,1,1.5)}),subMenuPortal:(0,o.css)({height:"100%","> div":{height:"100%"}}),subMenuButtonRow:(0,o.css)({backgroundColor:he.colors.background.primary,padding:he.spacing(1)}),checkboxPartiallyChecked:(0,o.css)({input:{"&:checked + span":{"&:after":{borderWidth:"0 3px 0px 0",transform:"rotate(90deg)"}}}}),loadingSpinner:(0,o.css)({marginLeft:he.spacing(1)})}),N=Object.values(U.OrgRole).map(he=>({label:he===U.OrgRole.None?"No basic role":he,value:he})),w=({value:he,onChange:de,disabled:le,disabledMesssage:pe,tooltipMessage:ve})=>{const be=(0,n.of)(W),Oe=(0,n.$j)();return t.createElement(t.Fragment,null,t.createElement("div",{className:be.groupHeader},t.createElement("span",{style:{marginRight:Oe.spacing(1)}},"Basic roles"),le&&pe&&t.createElement(i.m,{placement:"right-end",interactive:!0,content:t.createElement("div",null,pe)},t.createElement(l.I,{name:"question-circle"})),!le&&ve&&t.createElement(i.m,{placement:"right-end",interactive:!0,content:ve},t.createElement(l.I,{name:"info-circle",size:"xs"}))),t.createElement(B.a,{name:"Basic Role Selector",className:be.basicRoleSelector,options:N,value:he,onChange:de,disabled:le}))};var L=e(10880);const V=(0,t.memo)(t.forwardRef(({name:he,value:de,isFocused:le,isSelected:pe,partiallySelected:ve,disabled:be,onChange:Oe,onClick:Me,onOpenSubMenu:Ue,onCloseSubMenu:we,children:Re,root:Fe},xe)=>{const Ve=(0,n.$j)(),$e=(0,c.J)(Ve),Xe=(0,n.of)(W),gt=(0,o.cx)($e.option,le&&$e.optionFocused,be&&Xe.menuOptionDisabled),Dt=re=>{be||de&&Oe(de)},nt=re=>{Me&&Me(de)},at=()=>{Ue&&Ue(de)},Ae=()=>{we&&we()};return t.createElement("div",{onMouseEnter:at,onMouseLeave:Ae},t.createElement("div",{ref:xe,className:gt,"aria-label":"Role picker option",onClick:nt},t.createElement(L.S,{value:pe,className:(0,o.cx)(Xe.menuOptionCheckbox,{[Xe.checkboxPartiallyChecked]:ve}),onChange:Dt,disabled:be}),t.createElement("div",{className:(0,o.cx)($e.optionBody,Xe.menuOptionBody)},t.createElement("span",null,he),t.createElement("span",{className:Xe.menuOptionExpand})),Fe&&Re&&t.createElement(r.ZL,{className:Xe.subMenuPortal,root:Fe},Re)))}));V.displayName="RoleMenuGroupOption";const K=t.forwardRef(({data:he,isFocused:de,isSelected:le,disabled:pe,onChange:ve,hideDescription:be},Oe)=>{const Me=(0,n.$j)(),Ue=(0,c.J)(Me),we=(0,n.of)(W),Re=(0,o.cx)(Ue.option,de&&Ue.optionFocused,pe&&we.menuOptionDisabled),Fe=xe=>{pe||(xe.preventDefault(),xe.stopPropagation(),ve(he))};return t.createElement("div",{ref:Oe,className:Re,"aria-label":"Role picker option",onClick:Fe},t.createElement(L.S,{value:le,className:we.menuOptionCheckbox,onChange:Fe,disabled:pe}),t.createElement("div",{className:(0,o.cx)(Ue.optionBody,we.menuOptionBody)},t.createElement("span",null,he.displayName||he.name),!be&&he.description&&t.createElement("div",{className:Ue.optionDescription},he.description)),he.description&&t.createElement(i.m,{content:he.description},t.createElement(l.I,{name:"info-circle",className:we.menuOptionInfoSign})))});K.displayName="RoleMenuOption";var k=e(3246);const j=({options:he,selectedOptions:de,disabledOptions:le,onSelect:pe,onClear:ve,showOnLeft:be})=>{const Oe=(0,n.$j)(),Me=(0,c.J)(Oe),Ue=(0,n.of)(W),we=async()=>{ve&&ve()};return t.createElement("div",{className:(0,o.cx)(Ue.subMenu,{[Ue.subMenuLeft]:be}),"aria-label":"Role picker submenu"},t.createElement(M.E,{autoHide:!1,autoHeightMax:`${a}px`,hideHorizontalTrack:!0},t.createElement("div",{className:Me.optionBody},he.map((Re,Fe)=>t.createElement(K,{data:Re,key:Fe,isSelected:!!(Re.uid&&(de.find(xe=>xe.uid===Re.uid)||le?.find(xe=>xe.uid===Re.uid))),disabled:!!(Re.uid&&le?.find(xe=>xe.uid===Re.uid))||(0,k.W)(Re),onChange:pe,hideDescription:!0})))),t.createElement("div",{className:Ue.subMenuButtonRow},t.createElement(A.B,{justifyContent:"flex-end"},t.createElement(R.$n,{size:"sm",fill:"text",onClick:we},"Clear"))))},H=t.forwardRef(({roles:he,renderedName:de,showGroups:le,optionGroups:pe,onGroupChange:ve,groupSelected:be,groupPartiallySelected:Oe,subMenuNode:Me,selectedOptions:Ue,onRoleChange:we,onClearSubMenu:Re,showOnLeftSubMenu:Fe},xe)=>{const[Ve,$e]=(0,t.useState)(!1),[Xe,gt]=(0,t.useState)(""),Dt=(0,n.$j)(),nt=(0,c.J)(Dt),at=(0,n.of)(W),Ae=(0,t.useCallback)(Z=>{gt(Z),$e(!0)},[]),re=(0,t.useCallback)(()=>{$e(!1),gt("")},[]);return t.createElement("div",null,he.length>0&&t.createElement("div",{className:at.menuSection},t.createElement("div",{className:at.groupHeader},de),t.createElement("div",{className:nt.optionBody}),le&&pe?.length?pe.map(Z=>t.createElement(V,{key:Z.value,name:Z.name,value:Z.value,isSelected:be(Z.value)||Oe(Z.value),partiallySelected:Oe(Z.value),disabled:Z.options?.every(k.W),onChange:ve,onOpenSubMenu:Ae,onCloseSubMenu:re,root:Me,isFocused:Ve&&Xe===Z.value},Ve&&Xe===Z.value&&t.createElement(j,{options:Z.options,selectedOptions:Ue,onSelect:we,onClear:()=>Re(Xe),showOnLeft:Fe}))):he.map(Z=>t.createElement(K,{data:Z,key:Z.uid,isSelected:!!(Z.uid&&Ue.find(oe=>oe.uid===Z.uid)),disabled:(0,k.W)(Z),onChange:we,hideDescription:!0}))))});H.displayName="RoleMenuGroupsSection";var J=(he=>(he.fixed="fixed",he.custom="custom",he.plugin="plugin",he))(J||{});const X={ldap:"LDAP",current:"Current org"},se=t.createElement(t.Fragment,null,'You can now select the "No basic role" option and add permissions to your custom needs. You can find more information in\xA0',t.createElement(b.Y,{href:"https://grafana.com/docs/grafana/latest/administration/roles-and-permissions/#organization-roles",variant:"bodySmall",external:!0},"our documentation"),"."),ae=({basicRole:he,options:de,appliedRoles:le,showGroups:pe,basicRoleDisabled:ve,disabledMessage:be,showBasicRole:Oe,onSelect:Me,onBasicRoleSelect:Ue,onUpdate:we,updateDisabled:Re,offset:Fe,menuLeft:xe,apply:Ve})=>{const[$e,Xe]=(0,t.useState)(le),[gt,Dt]=(0,t.useState)(he),[nt,at]=(0,t.useState)({}),Ae=(0,t.useRef)(null),re=(0,n.$j)(),Z=(0,c.J)(re),oe=(0,n.of)(W);(0,t.useEffect)(()=>{Me($e)},[$e,Me]),(0,t.useEffect)(()=>{Ue&&gt&&Ue(gt)},[gt,Ue]),(0,t.useEffect)(()=>{const pt=de.filter(ne).sort(ue),Ge=de.filter(q).sort(ue),qe=de.filter(ee).sort(ue),bt={fixed:z(Ge).sort((Ft,Xt)=>Ft.name.localeCompare(Xt.name)),custom:z(pt).sort((Ft,Xt)=>Ft.name.localeCompare(Xt.name)),plugin:z(qe).sort((Ft,Xt)=>Ft.name.localeCompare(Xt.name))};at({fixed:{groupType:"fixed",optionGroup:bt.fixed,renderedName:"Fixed roles",roles:Ge},custom:{groupType:"custom",optionGroup:bt.custom,renderedName:"Custom roles",roles:pt},plugin:{groupType:"plugin",optionGroup:bt.plugin,renderedName:"Plugin roles",roles:qe}})},[de]);const Ee=pt=>{const Ge=[];for(const qe of $e)te(qe)===pt&&Ge.push(qe);return Ge},ye=(pt,Ge)=>{const qe=Ee(Ge),bt=nt[pt]?.optionGroup.find(Ft=>Ft.value===Ge);return qe.length>0&&qe.length>=bt.options.length},Se=(pt,Ge)=>{const qe=Ee(Ge),bt=nt[pt]?.optionGroup.find(Ft=>Ft.value===Ge);return qe.length>0&&qe.length<bt.options.length},Be=pt=>{$e.find(Ge=>Ge.uid===pt.uid)?Xe($e.filter(Ge=>Ge.uid!==pt.uid)):Xe([...$e,pt])},We=(pt,Ge)=>{const qe=nt[pt]?.optionGroup.find(bt=>bt.value===Ge);if(qe)if(ye(pt,Ge)||Se(pt,Ge))Xe($e.filter(bt=>!qe.options.find(Ft=>bt.uid===Ft.uid)));else{const bt=qe.options.filter(Xt=>Xt.delegatable),Ft=$e.filter(Xt=>!qe.options.find(Lt=>Xt.uid===Lt.uid));Xe([...Ft,...bt])}},Ke=pt=>{Dt(pt)},it=async()=>{Xe([])},rt=pt=>{const Ge=$e.filter(qe=>te(qe)!==pt);Xe(Ge)},ft=()=>{we($e,gt)};return t.createElement("div",{className:(0,o.cx)(Z.menu,oe.menuWrapper,{[oe.menuLeft]:xe},(0,o.css)({top:`${Fe.vertical}px`,left:xe?"unset":`${Fe.horizontal}px`,right:xe?`${Fe.horizontal}px`:"unset"}))},t.createElement("div",{className:oe.menu,"aria-label":"Role picker menu"},t.createElement(M.E,{autoHide:!1,autoHeightMax:`${a}px`,hideHorizontalTrack:!0,hideVerticalTrack:!0,className:(0,o.cx)(oe.hideScrollBar)},Oe&&t.createElement("div",{className:oe.menuSection},t.createElement(w,{value:gt,onChange:Ke,disabled:ve,disabledMesssage:be,tooltipMessage:se})),Object.entries(nt).map(([pt,Ge])=>t.createElement(H,{key:pt,roles:Ge.roles,renderedName:Ge.renderedName,showGroups:pe,optionGroups:Ge.optionGroup,groupSelected:qe=>ye(Ge.groupType,qe),groupPartiallySelected:qe=>Se(Ge.groupType,qe),onGroupChange:qe=>We(Ge.groupType,qe),subMenuNode:Ae?.current,selectedOptions:$e,onRoleChange:Be,onClearSubMenu:rt,showOnLeftSubMenu:xe}))),t.createElement("div",{className:oe.menuButtonRow},t.createElement(A.B,{justifyContent:"flex-end"},t.createElement(R.$n,{size:"sm",fill:"text",onClick:it,disabled:Re},"Clear all"),t.createElement(R.$n,{size:"sm",onClick:ft,disabled:Re},Ve?"Apply":"Update")))),t.createElement("div",{ref:Ae}))},ne=he=>!he.name?.startsWith("fixed:")&&!he.name.startsWith("plugins:"),q=he=>he.name?.startsWith("fixed:"),ee=he=>he.name?.startsWith("plugins:"),z=he=>{const de={};return he.forEach(pe=>{const ve=te(pe),be=ie(pe);de[ve]||(de[ve]={name:be,roles:[]}),de[ve].roles.push(pe)}),Object.entries(de).map(([pe,ve])=>({name:X[pe]||fe(ve.name),value:pe,options:ve.roles.sort(ue)}))},te=he=>{const de=ce(he),le=ie(he);return`${de}:${le}`},ie=he=>he.group||"Other",ce=he=>{const de=he.name.indexOf(":");return de<0?"unknown":he.name.substring(0,de)},ue=(he,de)=>he.name.localeCompare(de.name),fe=he=>he.slice(0,1).toUpperCase()+he.slice(1),Te=({basicRole:he,appliedRoles:de,roleOptions:le,disabled:pe,isLoading:ve,basicRoleDisabled:be,basicRoleDisabledMessage:Oe,showBasicRole:Me,onRolesChange:Ue,onBasicRoleChange:we,canUpdateRoles:Re=!0,apply:Fe=!1,maxWidth:xe=P,width:Ve})=>{const[$e,Xe]=(0,t.useState)(!1),[gt,Dt]=(0,t.useState)(de),[nt,at]=(0,t.useState)(he),[Ae,re]=(0,t.useState)(""),[Z,oe]=(0,t.useState)({vertical:0,horizontal:0}),[Ee,ye]=(0,t.useState)(!1),Se=(0,t.useRef)(null),Be=(0,n.$j)(),We=typeof Ve=="number"?Be.spacing(Ve):Ve;(0,t.useEffect)(()=>{at(he),Dt(de)},[de,he,we]);const Ke=(0,t.useCallback)(()=>{const{horizontal:Lt,vertical:Qt,menuToLeft:an}=it();Lt&&Qt&&(oe({horizontal:Lt,vertical:Qt}),ye(an))},[]);(0,t.useEffect)(()=>{$e&&Ke()},[$e,gt,Ke]);const it=()=>{const Lt=Se?.current?.getBoundingClientRect();if(!Lt)return{};const{bottom:Qt,top:an,left:gn,right:ut}=Lt;let Nt=gn,ht=!1;const Rt=window.innerHeight-Qt;let _t=Qt+5,on=!1;return Rt<a+20&&(_t=an-a-50),an<a+50&&(_t=an,Nt=ut+5,on=!0),Nt+v>window.innerWidth&&(Nt=window.innerWidth-(on?gn:ut),ht=!0),{horizontal:Nt,vertical:_t,menuToLeft:ht}},rt=(0,t.useCallback)(Lt=>{pe||(Lt.preventDefault(),Lt.stopPropagation(),Ke(),Xe(!0))},[pe,Ke]),ft=(0,t.useCallback)(()=>{Xe(!1),re(""),Dt(de),at(he)},[de,he]),pt=()=>$e&&ft(),Ge=Lt=>{re(Lt||"")},qe=Lt=>{Dt(Lt)},bt=Lt=>{at(Lt)},Ft=(Lt,Qt)=>{we&&Qt&&Qt!==he&&we(Qt),Re&&Ue(Lt),re(""),Xe(!1)},Xt=()=>{const Lt=le.map(Qt=>({...Qt,delegatable:Re&&Qt.delegatable}));return Ae&&Ae.trim()!==""?Lt.filter(Qt=>Qt.name?.toLowerCase().includes(Ae.toLowerCase())):Lt};return t.createElement("div",{"data-testid":"role-picker",style:{position:"relative",maxWidth:We||xe,width:We},ref:Se},t.createElement(s.N,{onClick:pt,useCapture:!1},t.createElement(T,{basicRole:nt,appliedRoles:gt,query:Ae,onQueryChange:Ge,onOpen:rt,onClose:ft,isFocused:$e,disabled:pe,showBasicRole:Me,width:We,isLoading:ve}),$e&&t.createElement(r.ZL,null,t.createElement("div",{onClick:Lt=>Lt.stopPropagation()},t.createElement(ae,{options:Xt(),basicRole:nt,appliedRoles:de,onBasicRoleSelect:bt,onSelect:qe,onUpdate:Ft,showGroups:Ae.length===0||Ae.trim()==="",basicRoleDisabled:be,disabledMessage:Oe,showBasicRole:Me,updateDisabled:be&&!Re,apply:Fe,offset:Z,menuLeft:Ee})))))}},89062:(G,I,e)=>{"use strict";e.d(I,{y:()=>l});var t=e(96540),n=e(41053),s=e(10096),r=e(31678),o=e(37425),m=e(85927);const l=({basicRole:i,roles:u,userId:d,orgId:p,onBasicRoleChange:c,roleOptions:y,disabled:f,basicRoleDisabled:P,basicRoleDisabledMessage:a,apply:E=!1,onApplyRoles:g,pendingRoles:h,maxWidth:D,width:v,isLoading:C})=>{const[{loading:T,value:S=u||[]},O]=(0,n.A)(async()=>{try{if(u)return u;if(E&&h?.length)return h;if(s.TP.hasPermission(r.AccessControlAction.ActionUserRolesList)&&d>0)return await(0,m.Xh)(d,p)}catch{console.error("Error loading options")}return[]},[p,d,h,u]);(0,t.useEffect)(()=>{p&&O()},[O,p]);const x=async M=>{E?g&&g(M,d,p):(await(0,m.eA)(M,d,p),await O())},b=s.TP.hasPermission(r.AccessControlAction.ActionUserRolesAdd)&&s.TP.hasPermission(r.AccessControlAction.ActionUserRolesRemove);return t.createElement(o.n,{appliedRoles:S,basicRole:i,onRolesChange:x,onBasicRoleChange:c,roleOptions:y,isLoading:T||C,disabled:f,basicRoleDisabled:P,basicRoleDisabledMessage:a,showBasicRole:!0,apply:E,canUpdateRoles:b,maxWidth:D,width:v})}},85927:(G,I,e)=>{"use strict";e.d(I,{G3:()=>l,RL:()=>s,Xh:()=>r,eA:()=>o,xN:()=>m});var t=e(17172),n=e(3246);const s=async i=>{let u="/api/access-control/roles?delegatable=true";i&&(u+=`&targetOrgId=${i}`);const d=await(0,t.AI)().get(u);return!d||!d.length?[]:d.map(n.c)},r=async(i,u)=>{let d=`/api/access-control/users/${i}/roles`;u&&(d+=`?targetOrgId=${u}`);try{const p=await(0,t.AI)().get(d);return!p||!p.length?[]:p.map(n.c)}catch(p){return(0,t.NF)(p)&&(p.isHandled=!0),[]}},o=(i,u,d)=>{let p=`/api/access-control/users/${u}/roles`;d&&(p+=`?targetOrgId=${d}`);const c=i.flatMap(y=>y.uid);return(0,t.AI)().put(p,{orgId:d,roleUids:c})},m=async(i,u)=>{let d=`/api/access-control/teams/${i}/roles`;u&&(d+=`?targetOrgId=${u}`);try{const p=await(0,t.AI)().get(d);return!p||!p.length?[]:p.map(n.c)}catch(p){return(0,t.NF)(p)&&(p.isHandled=!0),[]}},l=(i,u,d)=>{let p=`/api/access-control/teams/${u}/roles`;d&&(p+=`?targetOrgId=${d}`);const c=i.flatMap(y=>y.uid);return(0,t.AI)().put(p,{orgId:d,roleUids:c})}},3246:(G,I,e)=>{"use strict";e.d(I,{W:()=>t,c:()=>n});const t=s=>s.delegatable!==void 0&&!s.delegatable,n=s=>{const r="fixed:";if(!s.displayName&&s.name.startsWith(r)){let o="";o=s.name.replace(r,"").replace(/:/g," "),s.displayName=o}return s}},47694:(G,I,e)=>{"use strict";e.d(I,{y:()=>d});var t=e(96540),n=e(8867),s=e(40672),r=e(62938);const o=2,m=5,l=f=>{const P=f.match(new RegExp('<style type="text/css">([\\s\\S]*?)<\\/style>'));return P?P[0]:null},i=f=>f.match(new RegExp(`<svg.*id\\s*=\\s*(['"])(.*?)\\1`))?.[o],u=f=>{let P=i(f);if(!P){P=`x${(0,r.A)()}`;const E=f.indexOf("<svg")+m;f=f.substring(0,E)+`id="${P}" `+f.substring(E)}let a=l(f);if(a){let E=a.replace(/(#(.*?))?\./g,`#${P} .`);f=f.replace(a,E)}return f},d=f=>{const{cleanStyle:P,...a}=f;return t.createElement(n.default,{...a,cacheRequests:!0,preProcessor:P?y:c})};let p=new Map;function c(f){let P=p.get(f);return P||(P=s.sQ.sanitizeSVGContent(f),p.set(f,P)),P}function y(f){let P=p.get(f);return P||(P=s.sQ.sanitizeSVGContent(f),P.indexOf('<style type="text/css">')>-1&&(P=u(P)),p.set(f,P)),P}},59429:(G,I,e)=>{"use strict";e.d(I,{b:()=>d});var t=e(76459),n=e.n(t),s=e(96540),r=e(21594),o=e(27677),m=e(28676);const l=(p="General",c)=>`${p}/${c}`;async function i(p=""){return o.IB.search({type:"dash-db",query:p,limit:100}).then(c=>c.map(y=>({value:{uid:y.uid,title:y.title,folderTitle:y.folderTitle,folderUid:y.folderUid},label:l(y?.folderTitle,y.title)})))}const u=n()(i,250,{leading:!0}),d=({value:p,onChange:c,placeholder:y="Select dashboard",noOptionsMessage:f="No dashboards found",...P})=>{const[a,E]=(0,s.useState)();(0,s.useEffect)(()=>{!p||p===a?.value?.uid||(async()=>{const h=await(0,m.n)().getDashboardDTO(p);h.dashboard&&E({value:{uid:h.dashboard.uid,title:h.dashboard.title,folderTitle:h.meta.folderTitle,folderUid:h.meta.folderUid},label:l(h.meta?.folderTitle,h.dashboard.title)})})()},[p]);const g=(0,s.useCallback)(h=>{E(h),c?.(h?.value)},[c,E]);return s.createElement(r.DW,{loadOptions:u,onChange:g,placeholder:y,noOptionsMessage:f,value:a,defaultOptions:!0,...P})}},36607:(G,I,e)=>{"use strict";e.d(I,{d:()=>ie});var t=e(96540),n=e(32264),s=e(32196),r=e(34743),o=e(36376),m=e(7315),l=e(76459),i=e.n(l),u=e(40845),d=e(10354),p=e(14578),c=e(42418),y=e(57514),f=e(8484),P=e(55314),a=e(24439),E=e(40957),g=e(31678),h=e(70255),D=e(91793),v=e(10022),C=e(29158),T=e(94753),S=e(18759),O=e(37690);const x=40,b="md",M=(ue,fe)=>`${ue}-${fe||"root"}`;function A({items:ue,focusedItemIndex:fe,foldersAreOpenable:Te,idPrefix:he,selectedFolder:de,onFolderExpand:le,onFolderSelect:pe,isItemLoaded:ve,requestLoadMore:be}){const Oe=(0,t.useRef)(null),Me=(0,u.of)(U),Ue=(0,t.useMemo)(()=>({items:ue,focusedItemIndex:fe,foldersAreOpenable:Te,selectedFolder:de,onFolderExpand:le,onFolderSelect:pe,idPrefix:he}),[ue,fe,Te,de,le,pe,he]),we=(0,t.useCallback)(Fe=>ve(Fe),[ve]),Re=(0,t.useCallback)((Fe,xe)=>{const{parentUID:Ve}=ue[Fe];be(Ve)},[be,ue]);return t.createElement("div",{className:Me.table,role:"tree"},ue.length>0?t.createElement(v.A,{ref:Oe,itemCount:ue.length,isItemLoaded:we,loadMoreItems:Re},({onItemsRendered:Fe,ref:xe})=>t.createElement(D.Y1,{ref:xe,height:x*Math.min(6.5,ue.length),width:"100%",itemData:Ue,itemSize:x,itemCount:ue.length,onItemsRendered:Fe},B)):t.createElement("div",{className:Me.emptyMessage},t.createElement(f.x6,{i18nKey:"browse-dashboards.folder-picker.empty-message"},"No folders found")))}const R=[100,200,130,160,150];function B({index:ue,style:fe,data:Te}){const{items:he,focusedItemIndex:de,foldersAreOpenable:le,selectedFolder:pe,onFolderExpand:ve,onFolderSelect:be,idPrefix:Oe}=Te,{item:Me,isOpen:Ue,level:we,parentUID:Re}=he[ue],Fe=(0,t.useRef)(null),xe=(0,t.useId)(),Ve=(0,g.useSelector)(O.ku),$e=(0,g.useSelector)(O.Am),Xe=(Me.uid?$e[Me.uid]:Ve)?.items??[];let gt=[];Me.uid&&(gt=(Re?$e[Re]:Ve)?.items??[]);const Dt=(0,u.of)(U),nt=(0,t.useCallback)(Ae=>{Ae.preventDefault(),Ae.stopPropagation(),Me.uid&&ve(Me.uid,!Ue)},[Me.uid,Ue,ve]),at=(0,t.useCallback)(()=>{Me.kind==="folder"&&be(Me)},[Me,be]);return Me.kind==="ui"&&Me.uiKind==="pagination-placeholder"?t.createElement("span",{style:fe,className:Dt.row},t.createElement(S.T,{level:we,spacing:2}),t.createElement(h.A,{width:R[ue%R.length]})):Me.kind!=="folder"?null:t.createElement("div",{ref:Fe,style:fe,className:(0,s.cx)(Dt.row,{[Dt.rowFocused]:ue===de,[Dt.rowSelected]:Me.uid===pe}),tabIndex:-1,onClick:at,"aria-expanded":Ue,"aria-selected":Me.uid===pe,"aria-labelledby":xe,"aria-level":we+1,role:"treeitem","aria-owns":Xe.length>0?Xe.map(Ae=>M(Oe,Ae.uid)).join(" "):void 0,"aria-setsize":Xe.length,"aria-posinset":gt.findIndex(Ae=>Ae.uid===Me.uid)+1,id:M(Oe,Me.uid)},t.createElement("div",{className:Dt.rowBody},t.createElement(S.T,{level:we,spacing:2}),le?t.createElement(C.K,{size:b,onMouseDown:nt,tabIndex:-1,"aria-label":Ue?`Collapse folder ${Me.title}`:`Expand folder ${Me.title}`,name:Ue?"angle-down":"angle-right"}):t.createElement("span",{className:Dt.folderButtonSpacer}),t.createElement("label",{className:Dt.label,id:xe},t.createElement(T.E,{truncate:!0},Me.title))))}const U=ue=>{const fe=(0,s.css)({height:x,display:"flex",position:"relative",alignItems:"center",flexGrow:1,gap:ue.spacing(.5),overflow:"hidden",padding:ue.spacing(0,1)});return{table:(0,s.css)({background:ue.components.input.background}),emptyMessage:(0,s.css)({padding:ue.spacing(1),textAlign:"center",width:"100%"}),folderButtonSpacer:(0,s.css)({paddingLeft:ue.spacing(.5)}),row:(0,s.css)({display:"flex",position:"relative",alignItems:"center",":not(:first-child)":{borderTop:`solid 1px ${ue.colors.border.weak}`}}),rowFocused:(0,s.css)({backgroundColor:ue.colors.background.secondary}),rowSelected:(0,s.css)({"&::before":{display:"block",content:'""',position:"absolute",left:0,bottom:0,top:0,width:4,borderRadius:ue.shape.radius.default,backgroundImage:ue.colors.gradients.brandVertical}}),rowBody:fe,label:(0,s.css)({lineHeight:x+"px",flexGrow:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","&:hover":{textDecoration:"underline",cursor:"pointer"}})}};var W=e(16797);function N({handleClearSelection:ue,isLoading:fe,invalid:Te,label:he,...de},le){const pe=(0,u.$j)(),ve=L(pe,Te),be=Oe=>{(Oe.key==="Enter"||Oe.key===" ")&&ue?.(Oe)};return t.createElement("div",{className:ve.wrapper},t.createElement("div",{className:ve.inputWrapper},he?t.createElement("div",{className:ve.prefix},t.createElement(p.I,{name:"folder"})):void 0,t.createElement("button",{type:"button",className:(0,s.cx)(ve.fakeInput,he?ve.hasPrefix:void 0),...de,ref:le},fe?t.createElement(h.A,{width:100}):he?t.createElement(T.E,{truncate:!0},he):t.createElement(T.E,{truncate:!0,color:"secondary"},t.createElement(f.x6,{i18nKey:"browse-dashboards.folder-picker.button-label"},"Select folder")),!fe&&ue&&t.createElement(p.I,{role:"button",tabIndex:0,"aria-label":(0,f.t)("browse-dashboards.folder-picker.clear-selection","Clear selection"),className:ve.clearIcon,name:"times",onClick:ue,onKeyDown:be})),t.createElement("div",{className:ve.suffix},t.createElement(p.I,{name:"angle-down"}))))}const w=(0,t.forwardRef)(N),L=(ue,fe=!1)=>{const Te=(0,d.n)({theme:ue,invalid:fe});return{wrapper:Te.wrapper,inputWrapper:Te.inputWrapper,prefix:(0,s.css)([Te.prefix,{pointerEvents:"none",color:ue.colors.text.primary}]),suffix:(0,s.css)([Te.suffix,{pointerEvents:"none"}]),fakeInput:(0,s.css)([Te.input,{textAlign:"left",letterSpacing:"normal","&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,s.css)`
          ${(0,W.focusCss)(ue)}
        `,alignItems:"center",display:"flex",flexWrap:"nowrap",justifyContent:"space-between",paddingRight:28}]),hasPrefix:(0,s.css)({paddingLeft:28}),clearIcon:(0,s.css)({color:ue.colors.text.secondary,cursor:"pointer","&:hover":{color:ue.colors.text.primary},"&:focus:not(:focus-visible)":(0,W.getMouseFocusStyles)(ue),"&:focus-visible":(0,W.getFocusStyles)(ue)})}};var V=e(25508),K=e(92955),k=e(93519),j=e(64756);const H=(0,V.Mz)([ue=>ue,(ue,fe)=>fe],(ue,fe)=>{const Te=new Set,he=[],de={};let le=!1;for(const pe of fe){if(Te.has(pe.requestId))continue;const ve=P.cU.endpoints.listFolders.select({parentUid:pe.arg.parentUid,page:pe.arg.page,limit:pe.arg.limit,permission:pe.arg.permission})(ue);ve.status==="pending"&&(le=!0);const be=ve.originalArgs?.parentUid;be?(de[be]||(de[be]=[]),de[be].push(ve)):he.push(ve)}return{isLoading:le,rootPages:he,pagesByParent:de}});function J(ue){const fe=ue.at(-1),Te=fe?.originalArgs?.page;return fe?.data?[fe.data.length<fe.originalArgs.limit,Te]:[!1,Te]}function X(ue,fe,Te){const he=(0,j.wA)(),de=(0,t.useRef)([]),le=(0,j.d4)(be=>H(be,de.current)),pe=(0,t.useCallback)(be=>{const Oe=be?le.pagesByParent[be]:le.rootPages,[Me,Ue]=J(Oe??[]);if(Me)return;const we={parentUid:be,page:(Ue??0)+1,limit:K.md,permission:Te},Re=he(P.cU.endpoints.listFolders.initiate(we));de.current=de.current.concat([Re])},[le,he,Te]);return(0,t.useEffect)(()=>()=>{for(const be of de.current)be.unsubscribe()},[]),{items:(0,t.useMemo)(()=>{if(!ue)return[];function be(Me,Ue,we){const Re=Ue.flatMap(xe=>(xe.data??[]).flatMap($e=>{const Xe=fe[$e.uid],gt={isOpen:!!Xe,level:we,item:{kind:"folder",title:$e.title,uid:$e.uid}},Dt=Xe&&le.pagesByParent[$e.uid];if(Dt){const nt=be($e.uid,Dt,we+1);return[gt,...nt]}return gt})),[Fe]=J(Ue);return Fe||Re.push(...(0,k.T)(K.md,Me,we)),Re}const Oe=be(void 0,le.rootPages,1);return Oe.unshift(se),Oe},[le,ue,fe]),isLoading:le.isLoading,requestNextPage:pe}}const se={isOpen:!0,level:0,item:{kind:"folder",title:"Dashboards",uid:""}};function ae({tree:ue,handleCloseOverlay:fe,handleFolderSelect:Te,handleFolderExpand:he,idPrefix:de,search:le,visible:pe}){const[ve,be]=(0,t.useState)(-1),Oe=!!n.$.featureToggles.nestedFolders;(0,t.useEffect)(()=>{pe&&be(-1)},[pe]),(0,t.useEffect)(()=>{be(0)},[le]),(0,t.useEffect)(()=>{document.getElementById(M(de,ue[ve]?.item.uid))?.scrollIntoView({block:"nearest",inline:"nearest"})},[ve,de,ue]);const Me=(0,t.useCallback)(Ue=>{const we=Oe&&!le;switch(Ue.key){case"ArrowRight":case"ArrowLeft":we&&(Ue.preventDefault(),he(ue[ve].item.uid,Ue.key==="ArrowRight"));break;case"ArrowUp":ve>0&&(Ue.preventDefault(),be(ve-1));break;case"ArrowDown":ve<ue.length-1&&(Ue.preventDefault(),be(ve+1));break;case"Enter":Ue.preventDefault();const Re=ue[ve].item;Re.kind==="folder"&&Te(Re);break;case"Tab":Ue.stopPropagation(),fe();break;case"Escape":Ue.stopPropagation(),Ue.preventDefault(),fe();break}},[ve,fe,he,Te,Oe,le,ue]);return{focusedItemIndex:ve,handleKeyDown:Me}}const ne=i()(q,300);async function q(ue,fe){const Te=await(0,a.getGrafanaSearcher)().search({query:ue,kind:["folder"],limit:100,permission:fe}),he=Te.view.map(de=>(0,E.hI)(de,Te.view));return{...Te,items:he}}function ee({value:ue,invalid:fe,showRootFolder:Te=!0,clearable:he=!1,excludeUIDs:de,permission:le=g.PermissionLevelString.Edit,onChange:pe}){const ve=(0,u.of)(z),be=(0,P.kH)(ue||P.hT),Oe=!!n.$.featureToggles.nestedFolders,[Me,Ue]=(0,t.useState)(""),[we,Re]=(0,t.useState)(null),[Fe,xe]=(0,t.useState)(!1),[Ve,$e]=(0,t.useState)(!1),[Xe,gt]=(0,t.useState)(!1),[Dt,nt]=(0,t.useState)({}),at=(0,t.useId)(),[Ae]=(0,t.useState)(void 0),re=(0,t.useRef)(0),Z=!!(Xe&&!(Me&&we)),{items:oe,isLoading:Ee,requestNextPage:ye}=X(Z,Dt,le);(0,t.useEffect)(()=>{if(!Me){Re(null);return}const Rt=Date.now();xe(!0),ne(Me,le).then(_t=>{if(Rt>re.current){const on=_t.view.map(ln=>(0,E.hI)(ln,_t.view));Re({..._t,items:on}),xe(!1),re.current=Rt}})},[Me,le]);const Se=[(0,r.UU)({crossAxis:!1,boundary:document.body})],{context:Be,refs:We,floatingStyles:Ke,elements:it}=(0,o.we)({open:Xe,placement:"bottom",onOpenChange:Rt=>{Rt&&(Ue(""),$e(!0)),gt(Rt)},middleware:Se,whileElementsMounted:m.ll}),rt=(0,o.kp)(Be),ft=(0,o.s9)(Be),{getReferenceProps:pt,getFloatingProps:Ge}=(0,o.bv)([ft,rt]),qe=(0,t.useCallback)(async(Rt,_t)=>{nt(on=>({...on,[Rt]:_t})),_t&&!Dt[Rt]&&ye(Rt)},[ye,Dt]),bt=(0,t.useCallback)(Rt=>{pe&&pe(Rt.uid,Rt.title),gt(!1)},[pe]),Ft=(0,t.useCallback)(Rt=>{Rt.preventDefault(),Rt.stopPropagation(),pe&&pe(void 0,void 0)},[pe]),Xt=(0,t.useCallback)(()=>gt(!1),[gt]),Lt=(0,t.useCallback)(Rt=>{Me||ye(Rt)},[Me,ye]),Qt=(0,t.useMemo)(()=>{let Rt=[];return Z?Rt=oe:Rt=we?.items.map(_t=>({isOpen:!1,level:0,item:{kind:"folder",title:_t.title,uid:_t.uid}}))??[],(!Te||de?.length)&&(Rt=Rt.filter(_t=>!(!Te&&_t===se||de?.includes(_t.item.uid)))),Rt},[oe,de,Z,we?.items,Te]),an=(0,t.useCallback)(Rt=>{const _t=Qt[Rt];if(!_t)return!1;const on=_t.item;return!(on.kind==="ui"&&on.uiKind==="pagination-placeholder")},[Qt]),gn=Ee||Fe,{focusedItemIndex:ut,handleKeyDown:Nt}=ae({tree:Qt,handleCloseOverlay:Xt,handleFolderSelect:bt,handleFolderExpand:qe,idPrefix:at,search:Me,visible:Xe});let ht=be.data?.title;return ue===""&&(ht="Dashboards"),Xe?t.createElement(t.Fragment,null,t.createElement(d.p,{ref:We.setReference,autoFocus:!0,prefix:ht?t.createElement(p.I,{name:"folder"}):null,placeholder:ht??(0,f.t)("browse-dashboards.folder-picker.search-placeholder","Search folders"),value:Me,invalid:fe,className:ve.search,onChange:Rt=>Ue(Rt.currentTarget.value),"aria-autocomplete":"list","aria-expanded":!0,"aria-haspopup":!0,"aria-controls":at,"aria-owns":at,"aria-activedescendant":M(at,Qt[ut]?.item.uid),role:"combobox",suffix:t.createElement(p.I,{name:"search"}),...pt(),onKeyDown:Nt}),t.createElement("fieldset",{ref:We.setFloating,id:at,className:ve.tableWrapper,style:{...Ke,width:it.domReference?.clientWidth},...Ge()},Ae?t.createElement(c.F,{className:ve.error,severity:"warning",title:(0,f.t)("browse-dashboards.folder-picker.error-title","Error loading folders")},Ae.message||Ae.toString?.()||(0,f.t)("browse-dashboards.folder-picker.unknown-error","Unknown error")):t.createElement("div",null,gn&&t.createElement("div",{className:ve.loader},t.createElement(y.G,{width:600})),t.createElement(A,{items:Qt,selectedFolder:ue,focusedItemIndex:ut,onFolderExpand:qe,onFolderSelect:bt,idPrefix:at,foldersAreOpenable:Oe&&!(Me&&we),isItemLoaded:an,requestLoadMore:Lt})))):t.createElement(w,{label:ht,handleClearSelection:he&&ue!==void 0?Ft:void 0,invalid:fe,isLoading:be.isLoading,autoFocus:Ve,ref:We.setReference,"aria-label":ht?(0,f.t)("browse-dashboards.folder-picker.accessible-label","Select folder: {{ label }} currently selected",{label:ht}):void 0,...pt()})}const z=ue=>({button:(0,s.css)({maxWidth:"100%"}),error:(0,s.css)({marginBottom:0}),tableWrapper:(0,s.css)({boxShadow:ue.shadows.z3,position:"relative",zIndex:ue.zIndex.portal}),loader:(0,s.css)({position:"absolute",top:0,left:0,right:0,zIndex:ue.zIndex.portal+1,overflow:"hidden"}),search:(0,s.css)({input:{cursor:"default"}})});var te=e(85242);function ie(ue){const fe=n.$.featureToggles.newFolderPicker||n.$.featureToggles.nestedFolders,{initialTitle:Te,dashboardId:he,enableCreateNew:de,...le}=ue;return fe?t.createElement(ee,{...le}):t.createElement(ce,{...ue})}function ce({value:ue,showRootFolder:fe,onChange:Te,initialTitle:he,dashboardId:de,enableCreateNew:le,inputId:pe,skipInitialLoad:ve}){const be=(0,t.useCallback)(Oe=>{Te&&Te(Oe.uid,Oe.title)},[Te]);return t.createElement(te.sR,{onChange:be,showRoot:fe,initialFolderUid:ue,initialTitle:he,inputId:pe,skipInitialLoad:ve,dashboardId:de,enableCreateNew:le})}},85242:(G,I,e)=>{"use strict";e.d(I,{sR:()=>h});var t=e(32196),n=e(76459),s=e.n(n),r=e(96540),o=e(16817),m=e(26272),l=e(13544),i=e(14110),u=e(40845),d=e(10354),p=e(21594),c=e(28138),y=e(8484),f=e(16233),P=e(11230),a=e(31678);const E="+ Add new",g="-10";function h(T){const{dashboardId:S,allowEmpty:O,onChange:x,filter:b,enableCreateNew:M,inputId:A,onClear:R,enableReset:B,initialFolderUid:U,initialTitle:W="",permissionLevel:N=a.PermissionLevelString.Edit,rootName:w,showRoot:L=!0,skipInitialLoad:V,searchQueryType:K,customAdd:k,folderWarning:j,invalid:H}=T,J=w??"Dashboards",[X,se]=(0,r.useState)(null),[ae,ne]=(0,r.useState)(!1),[q,ee]=(0,r.useState)(""),[z,te]=(0,r.useState)(X?.title??""),ie=(0,u.of)(C),ce=typeof R=="function",ue=(0,r.useCallback)(async Ue=>{const we=await(0,P.c0)(Ue,N,K),Fe=D(we,b);return(0,i.rR)("grafana_folder_picker_results_loaded",{results:Fe.length,searchTermLength:Ue.length,enableCreateNew:!!M}),(f.TP.hasPermission(a.AccessControlAction.DashboardsWrite)||f.TP.hasPermission(a.AccessControlAction.DashboardsCreate))&&J?.toLowerCase().startsWith(Ue.toLowerCase())&&L&&Fe.unshift({label:J,value:""}),B&&Ue===""&&W!==""&&!Fe.find(Ve=>Ve.label===W)&&Fe.unshift({label:W,value:U}),M&&k?[...Fe,{value:g,label:E,title:Ue}]:Fe},[B,U,W,N,J,L,K,b,M,k]),fe=(0,r.useMemo)(()=>s()(ue,300,{leading:!0}),[ue]),Te=async()=>{const Ue={label:W,value:void 0},we={label:J,value:""},Re=await ue("");let Fe=null;U!=null?Fe=Re.find(xe=>xe.value===U)||null:B&&W?Fe=Ue:U&&(Fe=Re.find(xe=>xe.id===U)||null),!Fe&&!O&&(f.TP.isEditor?Fe=we:!!S?Fe=Ue:Fe=Re.length>0?Re[0]:Ue),!ae&&se(Fe)};(0,r.useEffect)(()=>{X&&X.value!==U&&!ae&&X.value&&X.label&&x({uid:X.value,title:X.label})},[X,U]),(0,o.A)(async()=>{if(V){const Ue=await v({getFolder:P.Ql,folderUid:U,folderName:W});se(Ue)}await Te()},[V,U,W]),(0,r.useEffect)(()=>{X&&X.id===g&&ne(!0)},[X]);const he=(0,r.useCallback)((Ue,we)=>{if(Ue?.value===g)se({id:g,title:q}),te(q);else{if(Ue||(Ue={value:"",label:J}),we.action==="clear"&&R){R();return}se(Ue),x({uid:Ue.value,title:Ue.label})}},[x,R,J,q]),de=(0,r.useCallback)(async Ue=>{if(j?.warningCondition(Ue))return(0,i.rR)("grafana_folder_picker_folder_created",{status:"failed_condition"}),!1;const we=await(0,P.vV)({title:Ue});let Re={value:"",label:"Not created"};return we.uid?((0,i.rR)("grafana_folder_picker_folder_created",{status:"success"}),c.A.emit(m.r1.alertSuccess,["Folder Created","OK"]),Re={value:we.uid,label:we.title},se(we),he(Re,{action:"create-option",option:Re})):((0,i.rR)("grafana_folder_picker_folder_created",{status:"failed"}),c.A.emit(m.r1.alertError,["Folder could not be created"])),Re},[j,he]),le=(0,r.useCallback)(Ue=>{const we=!!k?.disallowValues;if(Ue.key==="Enter"&&we&&!k?.isAllowedValue(z)){Ue.preventDefault();return}switch(Ue.key){case"Enter":{de(X?.title),ne(!1);break}case"Escape":se({value:"",label:J}),ne(!1)}},[k?.disallowValues,k?.isAllowedValue,z,de,X?.title,J]),pe=Ue=>{const we=Ue.currentTarget.value;te(we),se({id:void 0,title:we})},ve=()=>{se({value:"",label:J}),ne(!1)},be=(Ue,{action:we})=>{we==="input-change"&&ee(Re=>Ue),we==="menu-close"&&ee(Re=>Ue)},Oe=()=>j?.warningCondition(z)?r.createElement(j.warningComponent,null):null,Me=()=>j?.warningCondition(q)?r.createElement(j.warningComponent,null):null;return ae?r.createElement(r.Fragment,null,r.createElement(Oe,null),r.createElement("div",{className:ie.newFolder},"Press enter to create the new folder."),r.createElement(d.p,{width:30,autoFocus:!0,value:z,onChange:pe,onKeyDown:le,placeholder:"Press enter to confirm new folder.",onBlur:ve})):r.createElement("div",{"data-testid":l.Tp.components.FolderPicker.containerV2},r.createElement(Me,null),r.createElement(p.gZ,{inputId:A,"data-testid":l.Tp.components.FolderPicker.input,loadingMessage:(0,y.t)("folder-picker.loading","Loading folders..."),defaultOptions:!0,defaultValue:X,inputValue:q,onInputChange:be,value:X,allowCustomValue:M&&!k,loadOptions:fe,onChange:he,onCreateOption:de,invalid:H,isClearable:ce}))}function D(T,S){return(S?S(T):T).map(x=>({label:x.title,value:x.uid}))}async function v({folderName:T,folderUid:S,getFolder:O}){if(S==null)throw new Error("folderUid is not found.");return T?{label:T,value:S}:{label:(await O(S)).title,value:S}}const C=T=>({newFolder:(0,t.css)({color:T.colors.warning.main,fontSize:T.typography.bodySmall.fontSize,paddingBottom:T.spacing(1)})})},73725:(G,I,e)=>{"use strict";e.d(I,{r:()=>i});var t=e(96540),n=e(16817),s=e(21594),r=e(14578),o=e(53477),m=e(24439);const l=()=>(0,m.getGrafanaSearcher)().getSortOptions();function i({onChange:u,value:d,placeholder:p,filter:c,getSortOptions:y,isClearable:f}){const P=(0,n.A)(async()=>{const E=await(y??l)();return c?E.filter(g=>c.includes(g.value)):E},[y,c]);if(P.loading)return null;const a=!!(d?.includes("desc")||d?.startsWith("-"));return t.createElement(s.l6,{key:d,width:28,onChange:u,value:P.value?.find(E=>E.value===d)??null,options:P.value,"aria-label":"Sort",placeholder:p??`Sort (Default ${o.r4.label})`,prefix:t.createElement(r.I,{name:a?"sort-amount-down":"sort-amount-up"}),isClearable:f})}},46334:(G,I,e)=>{"use strict";e.d(I,{E:()=>r});var t=e(96540),n=e(69613),s=e(14578);class r extends t.Component{constructor(m){super(m)}render(){const{label:m,removeIcon:l,count:i,onClick:u}=this.props,{color:d}=(0,n.MC)(m),p={backgroundColor:d},c=i!==0&&t.createElement("span",{style:{marginLeft:"3px"}},`(${i})`);return t.createElement("span",{className:"label label-tag",style:p},l&&t.createElement(s.I,{onClick:u,name:"times"}),m," ",c)}}},99818:(G,I,e)=>{"use strict";e.d(I,{$:()=>y});var t=e(32196),n=e(96540),s=e(28581),r=e(54479),o=e(40845),m=e(21594),l=e(14578),i=e(8484),u=e(46334);const d=({data:P,className:a,label:E,isFocused:g,innerProps:h})=>{const D=(0,o.of)(p);return n.createElement("div",{className:(0,t.cx)(D.option,g&&D.optionFocused),"aria-label":"Tag option",...h},n.createElement("div",{className:(0,t.cx)(D.optionInner,a)},typeof E=="string"?n.createElement(u.E,{label:E,removeIcon:!1,count:P.count??0}):E))},p=P=>({option:(0,t.css)({padding:P.spacing(1),whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent","&:hover":{background:P.colors.background.secondary}}),optionFocused:(0,t.css)({background:P.colors.background.secondary,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"}),optionInner:(0,t.css)({position:"relative",textAlign:"left",width:"100%",display:"block",cursor:"pointer",padding:"2px 0"})}),c=(P,a)=>RegExp((0,r.jD)(a),"i").test(P.value),y=({allowCustomValue:P=!1,formatCreateLabel:a,hideValues:E,inputId:g,isClearable:h,onChange:D,placeholder:v,tagOptions:C,tags:T,width:S})=>{const O=(0,o.of)(f),x=T.map(j=>({value:j,label:j,count:0})),[b,M]=(0,n.useState)(x),[A,R]=(0,n.useState)(!1),[B,U]=(0,n.useState)(T),[W,N]=(0,n.useState)(x),w=(0,n.useMemo)(()=>T.join(),[T]),L=(0,n.useCallback)(async()=>(await C()).map(H=>T.includes(H.term)?{value:H.term,label:H.term,count:0}:{value:H.term,label:H.term,count:H.count}),[C,T]),V=(0,n.useCallback)(async()=>{R(!0);const j=await L();P&&W.forEach(H=>j.push(H)),M(j),R(!1)},[P,W,L]);(0,n.useEffect)(()=>{T.length>0&&b.length===0&&V()},[V,b.length,T.length]),(0,n.useEffect)(()=>{T!==B&&(U(T),V())},[V,B,T]);const K=j=>{j.forEach(H=>H.count=0),D((j||[]).map(H=>H.value)),P&&N(j.filter(H=>!T.includes(H)))},k={key:w,onFocus:V,isLoading:A,options:b,allowCreateWhileLoading:!0,allowCustomValue:P,formatCreateLabel:a,defaultOptions:!0,filterOption:c,getOptionLabel:j=>j.label,getOptionValue:j=>j.value,inputId:g,isMulti:!0,onChange:K,loadingMessage:(0,i.t)("tag-filter.loading","Loading..."),noOptionsMessage:(0,i.t)("tag-filter.no-tags","No tags found"),placeholder:v||(0,i.t)("tag-filter.placeholder","Filter by tag"),value:x,width:S,components:{Option:d,MultiValueLabel:()=>null,MultiValueRemove(j){const{data:H}=j;return n.createElement(s.c.MultiValueRemove,{...j},n.createElement(u.E,{key:H.label,label:H.label,removeIcon:!0,count:H.count}))},MultiValueContainer:E?()=>null:s.c.MultiValueContainer}};return n.createElement("div",{className:O.tagFilter},h&&T.length>0&&n.createElement("button",{className:O.clear,onClick:()=>K([])},"Clear tags"),n.createElement(m.KF,{...k,prefix:n.createElement(l.I,{name:"tag-alt"}),"aria-label":"Tag filter"}))};y.displayName="TagFilter";const f=P=>({tagFilter:(0,t.css)`
    position: relative;
    min-width: 180px;
    flex-grow: 1;

    .label-tag {
      margin-left: 6px;
      cursor: pointer;
    }
  `,clear:(0,t.css)`
    background: none;
    border: none;
    text-decoration: underline;
    font-size: 12px;
    padding: none;
    position: absolute;
    top: -17px;
    right: 0;
    cursor: pointer;
    color: ${P.colors.text.secondary};

    &:hover {
      color: ${P.colors.text.primary};
    }
  `})},25573:(G,I,e)=>{"use strict";e.d(I,{m:()=>c});var t=e(2543),n=e.n(t),s=e(96540),r=e(26272),o=e(65879),m=e(47232),l=e(15666),i=e(76412),u=e(28138),d=e(61680);const p="grafana.dashboard.timepicker.history",c=g=>s.createElement(d.b,{storageKey:p,defaultValue:[]},(h,D)=>{const v=f(h),C=y(v);return s.createElement(l.$6,{...g,history:C,onChange:T=>{P(T,v,D),g.onChange(T)},onError:T=>u.A.emit(r.r1.alertError,[(0,i.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,i.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:T})])})});function y(g){return g.map(h=>o.convertRawToRange(h,"utc",void 0,"YYYY-MM-DD HH:mm:ss"))}function f(g){return g.map(h=>{const D=typeof h.from=="string"?h.from:h.from.toISOString(),v=typeof h.to=="string"?h.to:h.to.toISOString();return{from:D,to:v}})}function P(g,h,D){if(!a(g))return;const v={from:typeof g.raw.from=="string"?g.raw.from:g.raw.from.toISOString(),to:typeof g.raw.to=="string"?g.raw.to:g.raw.to.toISOString()},C=E([v,...h]);D(C)}function a(g){return(0,m.Ar)(g.raw.from)||(0,m.Ar)(g.raw.to)}function E(g){return(0,t.uniqBy)(g,h=>h.from+h.to).slice(0,4)}},82389:(G,I,e)=>{"use strict";e.d(I,{I:()=>d});var t=e(96540),n=e(24293),s=e(11261),r=e(52622),o=e(67266),m=e(96516),l=e(30249),i=e(28895);const u=["rowHeight","colWidth","showValue","mergeValues","alignValue","tooltip"];class d extends t.Component{constructor(){super(...arguments),this.getValueColor=(c,y,f)=>{const P=this.props.frames[c].fields[y];if(P.display){const a=P.display(f);if(a.color)return a.color}return n.F},this.prepConfig=(c,y,f)=>(0,i.iE)({frame:c,getTimeRange:f,allFrames:this.props.frames,...this.props,timeZones:Array.isArray(this.props.timeZone)?this.props.timeZone:[this.props.timeZone],rowHeight:c.fields.length>2?this.props.rowHeight:1,getValueColor:this.getValueColor,hoverMulti:this.props.tooltip?.mode===r.$N.Multi}),this.renderLegend=c=>{const{legend:y,legendItems:f}=this.props;return!c||!f||!y||y.showLegend===!1?null:t.createElement(o.KU.Legend,{placement:y.placement},t.createElement(m.t,{placement:y.placement,items:f,displayMode:y.displayMode,readonly:!0}))}}render(){return t.createElement(l.o,{...this.props,fields:{x:c=>c.type===s.PU.time,y:c=>c.type===s.PU.number||c.type===s.PU.boolean||c.type===s.PU.string||c.type===s.PU.enum},prepConfig:this.prepConfig,propsToDiff:u,renderLegend:this.renderLegend})}}},28895:(G,I,e)=>{"use strict";e.d(I,{pm:()=>A,GY:()=>k,c5:()=>j,jY:()=>V,EI:()=>w,iE:()=>B,Qe:()=>N,Or:()=>L});var t=e(24293),n=e(28240),s=e(83195),r=e(11261),o=e(50082),m=e(58563),l=e(47737),i=e(73060),u=e(46294),d=e(39624),p=e(73134),c=e(52622),y=e(51336),f=e(52811),P=e(16895),a=e(36613),E=e(23596),g=e(39758),h=e(4134);const{round:D,min:v,ceil:C}=Math,T=2;let S=6;const O=g.ur;function x(H,J,X,se,ae){(0,g.mn)(X,H,O,J,(ne,q,ee)=>{let z=se*q,te=se*ee;ae(ne,z,te)})}function b(H){const{mode:J,numSeries:X,isDiscrete:se,hasMappedNull:ae,rowHeight:ne=0,colWidth:q=0,showValue:ee,mergeValues:z=!1,theme:te,label:ie,formatValue:ce,alignValue:ue="left",getTimeRange:fe,getValueColor:Te,getFieldConfig:he,hoverMulti:de}=H;let le,pe;const ve=oe=>{pe=Array(X).fill(null).map(Ee=>Array(oe).fill(null))},be=`500 ${Math.round(12*devicePixelRatio)}px ${te.typography.fontFamily}`,Oe=Array(X).fill(null);let Me=null;const Ue=[q,1/0],we=1-Ue[0],Re=(Ue[1]??1/0)*a.A.pxRatio,Fe=new Map,xe=new Map;function Ve(oe){Fe.forEach((Ee,ye)=>{oe.fillStyle=ye,oe.fill(Ee)}),xe.forEach((Ee,ye)=>{oe.strokeStyle=ye,oe.stroke(Ee)}),Fe.clear(),xe.clear()}function $e(oe,Ee,ye,Se,Be,We,Ke,it,rt,ft,pt,Ge,qe){Ke=Math.max(1,Ke);const bt=Te(ft+1,Ge),Ft=he(ft),Xt=M(Ft,bt);if(pe[ft][pt]={x:D(Be-ye),y:D(We-Se),w:Ke,h:it,sidx:ft+1,didx:pt,fillColor:Xt},qe){let Lt=Xt,Qt=Fe.get(Lt);if(Qt==null&&Fe.set(Lt,Qt=new Path2D),Ee(Qt,Be,We,Ke,it),rt){let an=bt,gn=xe.get(an);gn==null&&xe.set(an,gn=new Path2D),Ee(gn,Be+rt/2,We+rt/2,Ke-rt,it-rt)}}else oe.beginPath(),Ee(oe,Be,We,Ke,it),oe.fillStyle=Xt,oe.fill(),rt&&(oe.beginPath(),Ee(oe,Be+rt/2,We+rt/2,Ke-rt,it-rt),oe.strokeStyle=bt,oe.lineWidth=rt,oe.stroke())}const Xe=(oe,Ee,ye,Se)=>(a.A.orient(oe,Ee,(Be,We,Ke,it,rt,ft,pt,Ge,qe,bt,Ft,Xt,Lt,Qt)=>{let an=D((Be.width||0)*a.A.pxRatio),gn=se(Ee),ut=gn&&ae(Ee);oe.ctx.save(),Qt(oe.ctx,oe.bbox.left,oe.bbox.top,oe.bbox.width,oe.bbox.height),oe.ctx.clip(),x(ne,Ee-1,X,Ft,(Nt,ht,Rt)=>{if(J===A.Changes)for(let _t=0;_t<Ke.length;_t++){let on=Ke[_t];if(on!=null||ut){let ln=Math.round(ft(We[_t],it,bt,Ge)),bn=_t;for(;++bn<Ke.length&&(Ke[bn]===void 0||z&&Ke[bn]===on););let In=bn===Ke.length?Ge+bt+an:Math.round(ft(We[bn],it,bt,Ge));$e(oe.ctx,Qt,Ge,qe,ln,D(qe+ht),In-ln,D(Rt),an,Nt,_t,on,gn),_t=bn-1}}else if(J===A.Samples){let _t=ft(We[1],it,bt,Ge)-ft(We[0],it,bt,Ge),on=_t*we,ln=D(v(Re,_t-on)-an),bn=ln/2;for(let In=ye;In<=Se;In++){let Mn=Ke[In];if(Mn!=null||ut){let vt=ft(We[In],it,bt,Ge);$e(oe.ctx,Qt,Ge,qe,D(vt-bn),D(qe+ht),ln,D(Rt),an,Nt,In,Mn,gn)}}}}),gn&&(oe.ctx.lineWidth=an,Ve(oe.ctx)),oe.ctx.restore()}),null),gt=ce==null||ee===c.yL.Never?!1:(oe,Ee,ye,Se)=>(oe.ctx.save(),oe.ctx.rect(oe.bbox.left,oe.bbox.top,oe.bbox.width,oe.bbox.height),oe.ctx.clip(),oe.ctx.font=be,oe.ctx.textAlign=J===A.Changes?ue:"center",oe.ctx.textBaseline="middle",a.A.orient(oe,Ee,(Be,We,Ke,it,rt,ft,pt,Ge,qe,bt,Ft)=>{let Xt=D((Be.width||0)*a.A.pxRatio),Qt=se(Ee)&&ae(Ee),an=D(pt(re[Ee-1],rt,Ft,qe));for(let gn=0;gn<Ke.length;gn++)if(Ke[gn]!=null||Qt){const ut=pe[Ee-1][gn];if(!ut||ut.x>=bt)continue;let Nt=Math.floor(ut?.w/S);if(ee===c.yL.Auto&&Nt<2)continue;let ht=ce(Ee,Ke[gn]),Rt=D(ut.x+Ge+ut.w/2);J===A.Changes&&(ue==="left"?Rt=D(ut.x+Ge+Xt+T):ue==="right"&&(Rt=D(ut.x+Ge+ut.w-Xt-T))),oe.ctx.fillStyle=te.colors.getContrastText(ut.fillColor,3),oe.ctx.fillText(ht.slice(0,Nt),Rt,an)}}),oe.ctx.restore(),!1),Dt=oe=>{let Ee="";for(let ye=32;ye<=126;ye++)Ee+=String.fromCharCode(ye);S=Math.ceil(oe.ctx.measureText(Ee).width/Ee.length*a.A.pxRatio),S+=2.5,oe.root.querySelectorAll(".u-cursor-pt").forEach(ye=>{ye.style.borderRadius="0"})},nt=oe=>{le=le||new h.C$(0,0,oe.bbox.width,oe.bbox.height),le.clear(),ve(oe.data[0].length),oe.series.forEach(Ee=>{Ee._paths=null})};function at(oe,Ee,ye=!1){Oe.fill(null),Me=null,!(oe<0)&&le.get(oe,0,a.A.pxRatio,1e4,Se=>{oe>=Se.x&&oe<=Se.x+Se.w&&(Ee>=Se.y&&Ee<=Se.y+Se.h?Oe[Se.sidx]=Me=Se:(de||ye)&&(Oe[Se.sidx]=Se))})}const Ae={x:J===A.Changes,y:!1,dataIdx:(oe,Ee)=>{if(Ee===1){if(le.o.length===0&&le.q==null)for(const Be of pe)for(const We of Be)We&&le.add(We);let ye=oe.cursor.left*a.A.pxRatio,Se=oe.cursor.top*a.A.pxRatio;at(ye,Se,oe.cursor.event==null)}return Oe[Ee]?.didx},focus:{prox:1e3,dist:(oe,Ee)=>Me?.sidx===Ee?0:1/0},points:{fill:"rgba(255,255,255,0.2)",bbox:(oe,Ee)=>{let ye=Oe[Ee],Se=ye!=null;return{left:Se?ye.x/a.A.pxRatio:-10,top:Se?ye.y/a.A.pxRatio:-10,width:Se?ye.w/a.A.pxRatio:0,height:Se?ye.h/a.A.pxRatio:0}}}},re=Array(X).fill(0),Z=[0,1];return{cursor:Ae,xSplits:J===A.Samples?(oe,Ee,ye,Se,Be,We)=>{let Ke=[],it=oe.data[0][1]-oe.data[0][0],rt=C(Be/it);for(let ft=0;ft<oe.data[0].length;ft+=rt){let pt=oe.data[0][ft];pt>=ye&&pt<=Se&&Ke.push(pt)}return Ke}:null,xRange:oe=>{const Ee=fe();let ye=Ee.from.valueOf(),Se=Ee.to.valueOf();if(J===A.Samples){let Ke=(oe.data[0][1]-oe.data[0][0])/2;ye<=oe.data[0][0]&&(ye=oe.data[0][0]-Ke);let it=oe.data[0].length-1;Se>=oe.data[0][it]&&(Se=oe.data[0][it]+Ke)}return[ye,Se]},ySplits:oe=>(x(ne,null,X,oe.bbox.height,(Ee,ye,Se)=>{let Be=D(ye+Se/2);re[Ee]=oe.posToVal(Be/a.A.pxRatio,f.s)}),re),yValues:(oe,Ee)=>Ee.map((ye,Se)=>ie(Se+1)),yRange:Z,drawPaths:Xe,drawPoints:gt,init:Dt,drawClear:nt}}function M(H,J){if(J[0]==="#"&&J.length===9)return J;const X=(H.fillOpacity??100)/100;return(0,E.alpha)(J,X)}var A=(H=>(H.Changes="changes",H.Samples="samples",H))(A||{});const R={lineWidth:0,fillOpacity:80},B=({frame:H,theme:J,timeZones:X,getTimeRange:se,mode:ae,rowHeight:ne,colWidth:q,showValue:ee,alignValue:z,mergeValues:te,getValueColor:ie,hoverMulti:ce})=>{const ue=new y.e(X[0]),fe="x",Te=be=>{const Oe=be.config?.color?.mode;return!(Oe&&be.display&&Oe.startsWith("continuous-"))},he=be=>be.config.mappings?.some(Oe=>Oe.type===p.dM.SpecialValue&&Oe.options.match==="null")||!1,de=(be,Oe)=>{const Me=H.fields[be];return Me.state?.origin?.fieldIndex!==void 0&&Me.state?.origin?.frameIndex!==void 0&&ie?ie(Me.state?.origin?.frameIndex,Me.state?.origin?.fieldIndex,Oe):t.F},le={mode:ae,numSeries:H.fields.length-1,isDiscrete:be=>Te(H.fields[be]),hasMappedNull:be=>he(H.fields[be]),mergeValues:te,rowHeight:ne,colWidth:q,showValue:ee,alignValue:z,theme:J,label:be=>(0,n.Ct)(H.fields[be],H),getFieldConfig:be=>H.fields[be].config.custom,getValueColor:de,getTimeRange:se,formatValue:(be,Oe)=>(0,s.cN)(H.fields[be].display(Oe)),hoverMulti:ce},pe=b(le);ue.addHook("init",pe.init),ue.addHook("drawClear",pe.drawClear),ue.setPrepData(be=>(0,P.bq)(be[0],(0,P.ro)(be[0]))),ue.setCursor(pe.cursor),ue.addScale({scaleKey:fe,isTime:!0,orientation:c.Lt.Horizontal,direction:c.ON.Right,range:pe.xRange}),ue.addScale({scaleKey:f.s,isTime:!1,orientation:c.Lt.Vertical,direction:c.ON.Up,range:pe.yRange}),ue.addAxis({scaleKey:fe,isTime:!0,splits:pe.xSplits,placement:c.vM.Bottom,timeZone:X[0],theme:J,grid:{show:!0}}),ue.addAxis({scaleKey:f.s,isTime:!1,placement:c.vM.Left,splits:pe.ySplits,values:pe.yValues,grid:{show:!1},ticks:{show:!1},gap:16,theme:J});let ve=0;for(let be=0;be<H.fields.length;be++){if(be===0)continue;const Oe=H.fields[be],Me=Oe.config,Ue={...R,...Me.custom};Oe.state.seriesIndex=ve++,ue.addSeries({scaleKey:f.s,pathBuilder:pe.drawPaths,pointsBuilder:pe.drawPoints,lineWidth:Ue.lineWidth,fillOpacity:Ue.fillOpacity,theme:J,show:!Ue.hideFrom?.viz,thresholds:Me.thresholds,dataFrameFieldIndex:Oe.state?.origin})}return ue};function U(H){let J=H.config.custom?.spanNulls;return J?J===!0?1/0:J:-1}function W(H,J){const X=H.config.thresholds;if(H.type!==r.PU.number||!X||!X.steps.length)return;const se=w(H.config,J);if(se.length!==X.steps.length)return;const ae=new Map,ne=new Map;for(let z=0;z<se.length;z++)ae.set(X.steps[z],se[z].label),ne.set(se[z].label,se[z].color);let q=H.values;const ee=new Array(H.values.length);if(X.mode===o.O.Percentage){const{min:z,max:te}=(0,m.xg)(H),ie=te-z;q=q.map(ce=>ce==null?ce:(ce-z)/ie*100)}for(let z=0;z<ee.length;z++){const te=q[z];te==null?ee[z]=te:ee[z]=ae.get((0,l.yQ)(te,X.steps))}return{...H,config:{...H.config,custom:{...H.config.custom,spanNulls:U(H)}},type:r.PU.string,values:ee,display:z=>({text:String(z),color:ne.get(String(z)),numeric:NaN})}}function N(H,J,X,se){if(!H?.length)return{warn:"No data in response"};(0,n.Fm)(H);let ae=!1;const ne=[];for(let q of H){let ee=-1,z=-1;for(let fe=0;fe<q.fields.length;fe++)if(q.fields[fe].type===r.PU.time){if(ee===-1)ee=fe;else if(z===-1){z=fe;break}}let te=ee!==-1,ie=!1;if(q=(0,i.Yj)(q,ee),z!==-1){let fe={...q,fields:q.fields.filter((he,de)=>de!==z)},Te={length:q.length,fields:[q.fields[z]]};q=(0,i.Fd)({frames:[fe,Te],keepDisplayNames:!0,nullMode:()=>i.WO}),q.fields.forEach((he,de)=>{if(de>0){let le=he.values;for(let pe=0;pe<le.length;pe++)le[pe]==null&&(le[pe]=null)}}),ie=!0}let ce=(0,u.M)({frame:q,refFieldPseudoMin:X.from.valueOf(),refFieldPseudoMax:X.to.valueOf()});ce!==q&&(ie=!0),q=(0,d.C)(ce);const ue=[];for(let fe of q.fields)if(!fe.config.custom?.hideFrom?.viz)switch(fe.type){case r.PU.time:te=!0,ae=!0,ue.push(fe);break;case r.PU.enum:case r.PU.number:if(J&&fe.config.color?.mode===t.Y.Thresholds){const Te=W(fe,se);if(Te){ue.push(Te),ie=!0;continue}}case r.PU.boolean:case r.PU.string:fe={...fe,config:{...fe.config,custom:{...fe.config.custom,spanNulls:U(fe)}}},ie=!0,ue.push(fe);break;default:ie=!0}te&&ue.length>1&&(ae=!0,ie?ne.push({...q,fields:ue}):ne.push(q))}return ae?ne.length?{frames:ne}:{warn:"No graphable fields"}:{warn:"Data does not have a time field"}}function w(H,J){const X=[],se=H.thresholds;if(!se||!se.steps.length)return X;const ae=se.steps,ne=(0,s.j_)(se.mode===o.O.Percentage?"percent":H.unit??""),q=ee=>(0,s.cN)(ne(ee,H.decimals??void 0));for(let ee=0;ee<ae.length;ee++){let z=ae[ee],te=z.value,ie="",ce="";te===-1/0&&ee<ae.length-1?(te=ae[ee+1].value,ie="< "):ce="+",X.push({label:`${ie}${q(te)}${ce}`,color:J.visualization.getColorByName(z.color),yAxis:1})}return X}function L(H,J,X){if(!(!H||J.showLegend===!1))return V(K(H),X)}function V(H,J){if(!H.length)return;const X=[],se=H[0].config,ae=se.color?.mode??t.Y.Fixed,ne=se.thresholds;if(ae===t.Y.Thresholds&&ne?.steps&&ne.steps.length>1)return w(se,J);if(ae.startsWith("continuous"))return;const q=new Map;return H.forEach(ee=>{ee.config.custom?.hideFrom?.legend||ee.values.forEach(z=>{let te=ee.display(z);te.color&&q.set(te.text,te.color)})}),q.forEach((ee,z)=>{z.length>0&&X.push({label:z,color:J.visualization.getColorByName(ee??t.F),yAxis:1})}),X}function K(H){const J=[];for(const X of H)for(const se of X.fields)se.type!==r.PU.time&&J.push(se);return J}function k(H,J){let X,se=J+1;if(se>=H.values.length)return null;const ae=H.values[J];for(;X===void 0;){if(se>=H.values.length)return null;const ne=H.values[se];ne===void 0||ne===ae?se++:X=se}return X}function j(H){if(H<0||Number.isNaN(H))return"";let J,X,se,ae,ne,q,ee,z;return ee=Math.floor(H/1e3),q=Math.floor(ee/60),ee=ee%60,ne=Math.floor(q/60),q=q%60,ae=Math.floor(ne/24),ne=ne%24,J=Math.floor(ae/365),J>0&&(ae=ae%365),X=Math.floor(ae/30),X>0&&(ae=ae%30),se=Math.floor(ae/7),se>0&&(ae=ae%7),z=Math.round(H%1e3*1e3)/1e3,(J>0?J+"y "+(X>0?X+"mo ":"")+(se>0?se+"w ":"")+(ae>0?ae+"d ":""):X>0?X+"mo "+(se>0?se+"w ":"")+(ae>0?ae+"d ":""):se>0?se+"w "+(ae>0?ae+"d ":""):ae>0?ae+"d "+(ne>0?ne+"h ":""):ne>0?ne+"h "+(q>0?q+"m ":""):q>0?q+"m "+(ee>0?ee+"s ":""):ee>0?ee+"s "+(z>0?z+"ms ":""):z>0?z+"ms ":"0").trim()}},35043:(G,I,e)=>{"use strict";e.d(I,{DP:()=>d,NQ:()=>u,zJ:()=>p});var t=e(32196),n=e(96540),s=e(90613),r=e(40845),o=e(14578),m=e(94753),l=e(2913),i=e(8484);const u=[{message:"At least 12 characters",validation:f=>f.length>=12},{message:"One uppercase letter",validation:f=>/[A-Z]+/.test(f)},{message:"One lowercase letter",validation:f=>/[a-z]+/.test(f)},{message:"One number",validation:f=>/[0-9]+/.test(f)},{message:"One symbol",validation:f=>/[\W]/.test(f)}],d=f=>!l.Ay.auth.basicAuthStrongPasswordPolicy||u.every(P=>P.validation(f))||(0,i.t)("profile.change-password.strong-password-validation-register","Password does not comply with the strong password policy"),p=({strongPasswordValidations:f,password:P,pristine:a})=>n.createElement(s.a,{marginBottom:2},f.map(E=>n.createElement(c,{key:E.message,strongPasswordValidation:E,password:P,pristine:a}))),c=({strongPasswordValidation:f,password:P,pristine:a})=>{const E=(0,r.of)(y),{basicAuthStrongPasswordPolicy:g}=l.Ay.auth;if(!g)return null;const{message:h,validation:D}=f,v=P.length>0&&D(P),C=v||a?"check":"exclamation-triangle",T=v?"secondary":a?"primary":"error";let S;return v?S=E.icon.valid:a?S=E.icon.pending:S=E.icon.error,n.createElement(s.a,{key:h,display:"flex",alignItems:"center",marginTop:1},n.createElement(o.I,{className:(0,t.cx)(E.icon.style,S),name:C}),n.createElement(m.E,{color:T},h))},y=f=>({icon:{style:(0,t.css)({marginRight:f.spacing(1)}),valid:(0,t.css)({color:f.colors.success.text}),pending:(0,t.css)({color:f.colors.secondary.text}),error:(0,t.css)({color:f.colors.error.text})}})},93522:(G,I,e)=>{"use strict";e.d(I,{N:()=>d});var t=e(32196),n=e(96540),s=e(40845),r=e(37390),o=e(71259),m=e(94753),l=e(8484),i=e(63917);const u=f=>[{category:(0,l.t)("help-modal.shortcuts-category.global","Global"),shortcuts:[{keys:["g","h"],description:(0,l.t)("help-modal.shortcuts-description.go-to-home-dashboard","Go to Home Dashboard")},{keys:["g","d"],description:(0,l.t)("help-modal.shortcuts-description.go-to-dashboards","Go to Dashboards")},{keys:["g","e"],description:(0,l.t)("help-modal.shortcuts-description.go-to-explore","Go to Explore")},{keys:["g","p"],description:(0,l.t)("help-modal.shortcuts-description.go-to-profile","Go to Profile")},{keys:[`${f} + k`],description:(0,l.t)("help-modal.shortcuts-description.open-search","Open search")},{keys:["esc"],description:(0,l.t)("help-modal.shortcuts-description.exit-edit/setting-views","Exit edit/setting views")},{keys:["?"],description:(0,l.t)("help-modal.shortcuts-description.show-all-shortcuts","Show all keyboard shortcuts")},{keys:["c","t"],description:(0,l.t)("help-modal.shortcuts-description.change-theme","Change theme")}]},{category:(0,l.t)("help-modal.shortcuts-category.time-range","Time range"),shortcuts:[{keys:["t","z"],description:(0,l.t)("help-modal.shortcuts-description.zoom-out-time-range","Zoom out time range")},{keys:["t","\u2190"],description:(0,l.t)("help-modal.shortcuts-description.move-time-range-back","Move time range back")},{keys:["t","\u2192"],description:(0,l.t)("help-modal.shortcuts-description.move-time-range-forward","Move time range forward")},{keys:["t","a"],description:(0,l.t)("help-modal.shortcuts-description.make-time-range-permanent","Make time range absolute/permanent")},{keys:["t","c"],description:(0,l.t)("help-modal.shortcuts-description.copy-time-range","Copy time range")},{keys:["t","v"],description:(0,l.t)("help-modal.shortcuts-description.paste-time-range","Paste time range")}]},{category:(0,l.t)("help-modal.shortcuts-category.dashboard","Dashboard"),shortcuts:[{keys:[`${f} + s`],description:(0,l.t)("help-modal.shortcuts-description.save-dashboard","Save dashboard")},{keys:["d","r"],description:(0,l.t)("help-modal.shortcuts-description.refresh-all-panels","Refresh all panels")},{keys:["d","s"],description:(0,l.t)("help-modal.shortcuts-description.dashboard-settings","Dashboard settings")},{keys:["d","v"],description:(0,l.t)("help-modal.shortcuts-description.toggle-active-mode","Toggle in-active / view mode")},{keys:["d","k"],description:(0,l.t)("help-modal.shortcuts-description.toggle-kiosk","Toggle kiosk mode (hides top nav)")},{keys:["d","\u21E7 + e"],description:(0,l.t)("help-modal.shortcuts-description.expand-all-rows","Expand all rows")},{keys:["d","\u21E7 + c"],description:(0,l.t)("help-modal.shortcuts-description.collapse-all-rows","Collapse all rows")},{keys:["d","a"],description:(0,l.t)("help-modal.shortcuts-description.toggle-auto-fit","Toggle auto fit panels (experimental feature)")},{keys:[`${f} + o`],description:(0,l.t)("help-modal.shortcuts-description.toggle-graph-crosshair","Toggle shared graph crosshair")},{keys:["d","l"],description:(0,l.t)("help-modal.shortcuts-description.toggle-all-panel-legends","Toggle all panel legends")},{keys:["d","x"],description:(0,l.t)("help-modal.shortcuts-description.toggle-exemplars","Toggle exemplars in all panel")}]},{category:(0,l.t)("help-modal.shortcuts-category.focused-panel","Focused panel"),shortcuts:[{keys:["e"],description:(0,l.t)("help-modal.shortcuts-description.toggle-panel-edit","Toggle panel edit view")},{keys:["v"],description:(0,l.t)("help-modal.shortcuts-description.toggle-panel-fullscreen","Toggle panel fullscreen view")},{keys:["p","s"],description:(0,l.t)("help-modal.shortcuts-description.open-shared-modal","Open Panel Share Modal")},{keys:["p","d"],description:(0,l.t)("help-modal.shortcuts-description.duplicate-panel","Duplicate Panel")},{keys:["p","r"],description:(0,l.t)("help-modal.shortcuts-description.remove-panel","Remove Panel")},{keys:["p","l"],description:(0,l.t)("help-modal.shortcuts-description.toggle-panel-legend","Toggle panel legend")}]}],d=({onDismiss:f})=>{const P=(0,s.of)(y),a=(0,n.useMemo)(()=>(0,i.gn)(),[]),E=(0,n.useMemo)(()=>u(a),[a]);return n.createElement(r.a,{title:(0,l.t)("help-modal.title","Shortcuts"),isOpen:!0,onDismiss:f,onClickBackdrop:f},n.createElement(o.x,{columns:{xs:1,sm:2},gap:3,tabIndex:0},Object.values(E).map(({category:g,shortcuts:h})=>n.createElement("section",{key:g},n.createElement("table",{className:P.table},n.createElement("caption",null,n.createElement(m.E,{element:"p",variant:"h5"},g)),n.createElement("thead",{className:"sr-only"},n.createElement("tr",null,n.createElement("th",null,"Keys"),n.createElement("th",null,"Description"))),n.createElement("tbody",null,h.map(({keys:D,description:v})=>n.createElement("tr",{key:D.join()},n.createElement("td",{className:P.keys},D.map(C=>n.createElement(p,{key:C},C))),n.createElement("td",null,n.createElement(m.E,{variant:"bodySmall",element:"p"},v))))))))))},p=({children:f})=>{const P=(0,s.of)(y),a=(0,n.useMemo)(()=>c(f),[f]),E=n.createElement("span",{dangerouslySetInnerHTML:{__html:a}});return n.createElement("kbd",{className:P.shortcutTableKey},n.createElement(m.E,{variant:"code"},E))};function c(f){let P,a;if(f.includes("ctrl"))P="ctrl",a="Control";else if(f.includes("esc"))P="esc",a="Escape";else return f;return f.replace(P,`<span class="sr-only">${a}</span><span aria-hidden="true" role="none">${P}</span>`)}function y(f){return{table:(0,t.css)({borderCollapse:"separate",borderSpacing:f.spacing(2),"& caption":{captionSide:"top"}}),keys:(0,t.css)({textAlign:"end",whiteSpace:"nowrap",minWidth:83}),shortcutTableKey:(0,t.css)({display:"inline-block",textAlign:"center",marginRight:f.spacing(.5),padding:"3px 5px",lineHeight:"10px",verticalAlign:"middle",border:`solid 1px ${f.colors.border.medium}`,borderRadius:f.shape.radius.default,color:f.colors.text.primary,backgroundColor:f.colors.background.secondary})}}},2913:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>r,_R:()=>m,config:()=>n.$,yn:()=>l,zj:()=>o});var t=e(43429),n=e(32264);let s=n.$;const r=s,o=()=>s,m=i=>{s={...s,...i}},l=n.$.panels?.debug?.state===t.pn.alpha},15054:(G,I,e)=>{"use strict";e.d(I,{FG:()=>c,HG:()=>o,IZ:()=>d,MM:()=>f,Pz:()=>r,bJ:()=>l,cV:()=>s,cx:()=>i,dU:()=>n,o9:()=>m,sD:()=>t,tH:()=>u,wV:()=>y});const t=30,n=8,s=24,r="v",o="h",m=4,l=250,i=t*3,u="panel-copy",d=2,p=23763571993,c=40,y="VisualizationSelectPane.ListMode",f="WidgetSelectPane.ListMode"},76888:(G,I,e)=>{"use strict";e.d(I,{Il:()=>r,YE:()=>s,ni:()=>o});var t=e(96540),n=e(12131);const s=t.createContext(void 0);function r(){const m=(0,t.useContext)(s);if(!m)throw new Error("No GrafanaContext found");return m}function o(){const{chrome:m}=r();return(0,t.useCallback)((l,i)=>{const{pathname:u,search:d}=n.Ny.getLocation();m.setReturnToPrevious({title:l,href:i??u+d})},[m])}},3169:(G,I,e)=>{"use strict";e.d(I,{_2:()=>c,gi:()=>d,q8:()=>p,tZ:()=>u});var t=e(96540),n=e(62938),s=e(94954),r=e(31678),o=e(82467);const m={title:"",text:"",severity:r.AppNotificationSeverity.Success,icon:"check"},l={title:"",text:"",severity:r.AppNotificationSeverity.Warning,icon:"exclamation-triangle"},i={title:"",text:"",severity:r.AppNotificationSeverity.Error,icon:"exclamation-triangle"},u=(y,f="",P)=>({...m,title:y,text:f,id:(0,n.A)(),timestamp:Date.now(),showing:!0}),d=(y,f="",P,a)=>({...i,text:(0,s.q)(f),title:y,id:(0,n.A)(),traceId:P,component:a,timestamp:Date.now(),showing:!0}),p=(y,f="",P)=>({...l,title:y,text:f,traceId:P,id:(0,n.A)(),timestamp:Date.now(),showing:!0});function c(){const y=(0,r.useDispatch)();return(0,t.useMemo)(()=>({success:(f,P="")=>{y((0,o.dx)(u(f,P)))},warning:(f,P="",a)=>{y((0,o.dx)(p(f,P,a)))},error:(f,P="",a)=>{y((0,o.dx)(d(f,P,a)))}}),[y])}},10096:(G,I,e)=>{"use strict";e.d(I,{Ef:()=>n.E,TP:()=>s.TP,lE:()=>t.A,rO:()=>r.r});var t=e(28138),n=e(18898),s=e(16233),r=e(31140)},39640:(G,I,e)=>{"use strict";e.d(I,{$H:()=>u,Ay:()=>d});var t=e(2543),n=e(33390),s=e(38877),r=e(19347);const o=h=>{const D=(0,r.l)().getInstanceSettings(h.datasourceName);return{id:h.ts.toString(),createdAt:h.ts,datasourceName:h.datasourceName,datasourceUid:D?.uid||"",starred:h.starred,comment:h.comment,queries:h.queries}},m=h=>{if(!(0,r.l)().getInstanceSettings({uid:h.datasourceUid}))throw new Error("Datasource not found.");return{ts:h.createdAt,datasourceName:h.datasourceName,starred:h.starred,comment:h.comment,queries:h.queries}};var l=e(75533);const i="grafana.explore.richHistory",u=1e4;class d{async getRichHistory(D){const v=f().map(o),C=D.starred?v.filter(O=>O.starred===!0):v,T=D.from&&D.to?[D.from,D.to]:void 0,S=(0,l.a_)(C,D.sortOrder,D.datasourceFilters,D.search,T);return{richHistory:S,total:S.length}}async addToRichHistory(D){const v=Date.now(),C={id:v.toString(),createdAt:v,...D},T=m(C),S=c(f()),O=T.queries.map(R=>(0,t.omit)(R,["key","refId"])),x=S.length>0&&S[0].queries.map(R=>(0,t.omit)(R,["key","refId"]));if((0,t.isEqual)(O,x)){const R=new Error("Entry already exists");throw R.name=s.m.DuplicatedEntry,R}const{queriesToKeep:b,limitExceeded:M}=y(S),A=[T,...b];try{n.A.setObject(i,A)}catch(R){if(R instanceof Error&&R.name==="QuotaExceededError")g(s.m.StorageFull,`Saving rich history failed: ${R.message}`);else throw R}return M?{warning:{type:s.C.LimitExceeded,message:`Query history reached the limit of ${u}. Old, not-starred items have been removed.`},richHistoryQuery:C}:{richHistoryQuery:C}}async deleteAll(){n.A.delete(i)}async deleteRichHistory(D){const v=parseInt(D,10),T=n.A.getObject(i,[]).filter(S=>S.ts!==v);n.A.setObject(i,T)}async updateStarred(D,v){return p(D,C=>C.starred=v)}async updateComment(D,v){return p(D,C=>C.comment=v)}async getSettings(){return{activeDatasourcesOnly:n.A.getObject(l.mE.activeDatasourcesOnly)??n.A.getObject(l.mE.legacyActiveDatasourceOnly,!1),retentionPeriod:n.A.getObject(l.mE.retentionPeriod,7),starredTabAsFirstTab:n.A.getBool(l.mE.starredTabAsFirstTab,!1),lastUsedDatasourceFilters:n.A.getObject(l.mE.datasourceFilters,[]).map(v=>v.value)}}async updateSettings(D){n.A.set(l.mE.activeDatasourcesOnly,D.activeDatasourcesOnly),n.A.set(l.mE.retentionPeriod,D.retentionPeriod),n.A.set(l.mE.starredTabAsFirstTab,D.starredTabAsFirstTab),n.A.setObject(l.mE.datasourceFilters,(D.lastUsedDatasourceFilters||[]).map(v=>({value:v})))}}function p(h,D){const v=parseInt(h,10),C=n.A.getObject(i,[]),T=(0,t.find)(C,{ts:v});if(!T)throw new Error("Rich history item not found.");return D(T),n.A.setObject(i,C),o(T)}function c(h){const D=n.A.getObject(l.mE.retentionPeriod,7),v=(0,l.wQ)(D,{isLastTs:!1});return h.filter(C=>C.ts>v||C.starred===!0)||[]}function y(h){let D=!1,v=h.length-1;for(;v>=0&&h.length>=u;)h[v].starred||(h.splice(v,1),D=!0),v--;return{queriesToKeep:h,limitExceeded:D}}function f(){const h=n.A.getObject(i,[]);return P(h)}function P(h){return h.map(v=>{const C=v.queries.map((T,S)=>a(v,T,S));return{...v,queries:C}})}function a(h,D,v){const C="ABCDEFGHIJKLMNOPQRSTUVXYZ";return typeof D=="object"?D:E(D)?JSON.parse(D):{expr:D,refId:C[v]}}function E(h){try{JSON.parse(h)}catch{return!1}return!0}function g(h,D){const v=new Error(D);throw v.name=h,v}},38877:(G,I,e)=>{"use strict";e.d(I,{C:()=>n,m:()=>t});var t=(s=>(s.StorageFull="StorageFull",s.DuplicatedEntry="DuplicatedEntry",s))(t||{}),n=(s=>(s.LimitExceeded="LimitExceeded",s))(n||{})},75533:(G,I,e)=>{"use strict";e.d(I,{a_:()=>o,mE:()=>p,wQ:()=>m});var t=e(2543),n=e.n(t),s=e(47232),r=e(91650);function o(c,y,f,P,a){const E=i(c,f),g=u(E,P),h=a?l(g,a):g;return d(h,y)}const m=(c,y)=>{let f=y.now;return f||(f=y.tz?(0,s.oZ)(y.tz):(0,s.KQ)()),f.add(-c,"d"),(y.isLastTs?f.endOf("d"):f.startOf("d")).valueOf()};function l(c,y){return c.filter(f=>f.createdAt>y[0]&&f.createdAt<y[1])}function i(c,y){return y.length>0?c.filter(f=>y.includes(f.datasourceName)):c}function u(c,y){return c.filter(f=>f.comment.includes(y)?!0:f.queries.filter(a=>Object.values((0,t.omit)(a,["datasource","key","refId","hide","queryType"])).some(E=>E?.toString().includes(y))).length>0)}const d=(c,y)=>{let f;return y===r.x.Ascending&&(f=(P,a)=>P.createdAt<a.createdAt?-1:P.createdAt>a.createdAt?1:0),y===r.x.Descending&&(f=(P,a)=>P.createdAt<a.createdAt?1:P.createdAt>a.createdAt?-1:0),y===r.x.DatasourceZA&&(f=(P,a)=>P.datasourceName<a.datasourceName?-1:P.datasourceName>a.datasourceName?1:0),y===r.x.DatasourceAZ&&(f=(P,a)=>P.datasourceName<a.datasourceName?1:P.datasourceName>a.datasourceName?-1:0),c.sort(f)},p={retentionPeriod:"grafana.explore.richHistory.retentionPeriod",starredTabAsFirstTab:"grafana.explore.richHistory.starredTabAsFirstTab",legacyActiveDatasourceOnly:"grafana.explore.richHistory.activeDatasourceOnly",activeDatasourcesOnly:"grafana.explore.richHistory.activeDatasourcesOnly",datasourceFilters:"grafana.explore.richHistory.datasourceFilters"}},11401:(G,I,e)=>{"use strict";e.d(I,{tU:()=>a,a:()=>P,gQ:()=>E});var t=e(32264),n=e(10096),s=e(91650),r=e(39640),o=e(75505),m=e(17172),l=e(19347),i=e(65615);const u=g=>{const h=(0,l.l)().getInstanceSettings({uid:g.datasourceUid});return{id:g.uid,createdAt:g.createdAt*1e3,datasourceName:h?.name||"",datasourceUid:g.datasourceUid,starred:g.starred,comment:g.comment,queries:g.queries}},d=g=>({uid:g.id,createdAt:Math.floor(g.createdAt/1e3),datasourceUid:g.datasourceUid,starred:g.starred,comment:g.comment,queries:g.queries});class p{constructor(){this.preferenceService=new i.W("user")}async addToRichHistory(h){const{result:D}=await(0,m.AI)().post("/api/query-history",{dataSourceUid:h.datasourceUid,queries:h.queries});return{richHistoryQuery:u(D)}}async deleteAll(){throw new Error("not supported")}async deleteRichHistory(h){(0,m.AI)().delete(`/api/query-history/${h}`)}async getRichHistory(h){const D=c(h);let v="query-history-get-all";h.starred&&(v="query-history-get-starred");const T=(await(0,o.s)((0,m.AI)().fetch({method:"GET",url:`/api/query-history?${D}`,requestId:v}))).data,S=(T.result.queryHistory||[]).map(u),O=T.result.totalCount||0;return{richHistory:S,total:O}}async getSettings(){return{activeDatasourcesOnly:!1,lastUsedDatasourceFilters:void 0,retentionPeriod:14,starredTabAsFirstTab:(await this.preferenceService.load()).queryHistory?.homeTab==="starred"}}async updateComment(h,D){const v=await(0,m.AI)().patch(`/api/query-history/${h}`,{comment:D});return u(v.result)}updateSettings(h){return this.preferenceService.patch({queryHistory:{homeTab:h.starredTabAsFirstTab?"starred":"query"}})}async updateStarred(h,D){let v;return D?v=await(0,m.AI)().post(`/api/query-history/star/${h}`):v=await(0,m.AI)().delete(`/api/query-history/star/${h}`),u(v.result)}}function c(g){let h=`${g.datasourceFilters.map(D=>{const v=(0,l.l)().getInstanceSettings(D).uid;return`datasourceUid=${encodeURIComponent(v)}`}).join("&")}`;return g.search&&(h=h+`&searchString=${g.search}`),g.sortOrder&&(h=h+`&sort=${g.sortOrder===s.x.Ascending?"time-asc":"time-desc"}`),g.starred||(h=h+`&to=${g.to}`,h=h+`&from=${g.from}`),h=h+"&limit=100",h=h+`&page=${g.page||1}`,g.starred&&(h=h+`&onlyStarred=${g.starred}`),h}const y=new r.Ay,f=new p,P=()=>t.$.queryHistoryEnabled?f:y,a=()=>y,E=()=>t.$.queryHistoryEnabled?{availableFilters:[s.x.Descending,s.x.Ascending],lastUsedDataSourcesAvailable:!1,clearHistory:!1,onlyActiveDataSource:!1,changeRetention:!1,queryHistoryAvailable:n.TP.isSignedIn}:{availableFilters:[s.x.Descending,s.x.Ascending,s.x.DatasourceAZ,s.x.DatasourceZA],lastUsedDataSourcesAvailable:!0,clearHistory:!0,onlyActiveDataSource:!0,changeRetention:!0,queryHistoryAvailable:!0}},16021:(G,I,e)=>{"use strict";e.d(I,{u:()=>n});var t=e(96540);function n(s,r){const[o,m]=(0,t.useState)();return(0,t.useEffect)(()=>{const l=s.subscribe(r,m);return()=>l.unsubscribe()},[s,r]),o}},60619:(G,I,e)=>{"use strict";e.d(I,{Y:()=>n});var t=e(96540);function n({breakpoint:s,onChange:r}){(0,t.useEffect)(()=>{const o=window.matchMedia(`(min-width: ${s}px)`),m=l=>r(l);return o.addEventListener("change",m),()=>o.removeEventListener("change",m)},[s,r])}},25249:(G,I,e)=>{"use strict";e.d(I,{C:()=>s});var t=e(31678),n=e(17422);const s=r=>{const o=(0,t.useSelector)(m=>m.navIndex);return(0,n.tc)(o,r)}},83277:(G,I,e)=>{"use strict";e.d(I,{s:()=>r});var t=e(96540),n=e(24180),s=e(12131);function r(){const{search:o}=(0,n.zy)(),m=(0,t.useMemo)(()=>(0,s.SE)(o||""),[o]),l=(0,t.useCallback)((i,u)=>s.Ny.partial(i,u),[]);return[m,l]}},74513:(G,I,e)=>{"use strict";e.d(I,{Nm:()=>d,Yj:()=>p,dK:()=>y,rd:()=>c,wi:()=>u});var t=e(2543),n=e.n(t);const s="en-US",r="fr-FR",o="es-ES",m="de-DE",l="pt-br",i="zh-Hans",u="pseudo-LOCALE",d=s,p=[{code:s,name:"English",loader:{grafana:()=>e.e(9521).then(e.t.bind(e,19521,19))}},{code:r,name:"Fran\xE7ais",loader:{grafana:()=>e.e(5648).then(e.t.bind(e,35648,19))}},{code:o,name:"Espa\xF1ol",loader:{grafana:()=>e.e(680).then(e.t.bind(e,70680,19))}},{code:m,name:"Deutsch",loader:{grafana:()=>e.e(3082).then(e.t.bind(e,23082,19))}},{code:i,name:"\u4E2D\u6587\uFF08\u7B80\u4F53\uFF09",loader:{grafana:()=>e.e(9538).then(e.t.bind(e,29538,19))}},{code:l,name:"Portugu\xEAs Brasileiro",loader:{grafana:()=>e.e(2288).then(e.t.bind(e,12288,19))}}];{const f=e(55905);if(f.keys().includes("app/extensions/locales/localeExtensions")){const{LOCALE_EXTENSIONS:P,ENTERPRISE_I18N_NAMESPACE:a}=f("app/extensions/locales/localeExtensions");for(const E of p){const g=P[E.code];g&&(E.loader[a]=g)}}}const c=p.map(f=>f.code),y=(0,t.uniq)(p.flatMap(f=>Object.keys(f.loader)))},8484:(G,I,e)=>{"use strict";e.d(I,{x6:()=>p,Xj:()=>y,JL:()=>u,t:()=>c});var t=e(72635),n=e(94997),s=e(96540),r=e(32389),o=e(74513);const m=f=>f.split("-")[0].toLowerCase(),l={type:"backend",init(){},async read(f,P,a){let E=o.Yj.find(D=>D.code===f);if(E||(E=o.Yj.find(D=>m(D.code)===m(f))),!E)return a(new Error(`No message loader available for ${f}`),null);const g=E.loader[P];if(!g)return a(new Error(`No message loader available for ${f} with namespace ${P}`),null);const h=await g();a(null,h)}};let i;async function u(f){const P={partialBundledLanguages:!0,resources:{},returnEmptyString:!1,supportedLngs:o.rd,fallbackLng:o.Nm,ns:o.dK};let a=t.default;if(f==="detect"){a=a.use(n.A);const g={order:["navigator"],caches:[]};P.detection=g}else P.lng=o.rd.includes(f)?f:void 0;return await a.use(l).use(r.r9).init(P),i=t.default.getFixedT(null,o.dK),{language:a.resolvedLanguage}}function d(f){const P=VALID_LANGUAGES.includes(f)?f:void 0;return i18n.changeLanguage(P)}const p=f=>s.createElement(r.x6,{shouldUnescape:!0,ns:o.dK,...f}),c=(f,P,a)=>(i||(console.warn("t() was called before i18n was initialized. This is probably caused by calling t() in the root module scope, instead of lazily on render"),i=t.default.t),i(f,P,a)),y=(f,P={})=>typeof f=="string"?y(new Date(f),P):new Intl.DateTimeFormat(t.default.language,P).format(f)},18898:(G,I,e)=>{"use strict";e.d(I,{E:()=>n});class t{constructor(){this.panelsRendered=0,this.enabled=void 0}renderingCompleted(){this.panelsRendered+=1,window.panelsRendered=this.panelsRendered}}const n=new t},16001:(G,I,e)=>{"use strict";e.d(I,{$K:()=>P,Do:()=>d,XC:()=>c,XR:()=>p,dx:()=>u,fX:()=>h,g5:()=>f,oF:()=>y,qN:()=>g});var t=e(65307),n=e(25508),s=e(31678);const r=25,o="notifications",m=`${o}/lastRead`,l={byId:T(),lastRead:Number.parseInt(window.localStorage.getItem(m)??`${Date.now()}`,10)},i=(0,t.Z0)({name:"appNotifications",initialState:l,reducers:{notifyApp:(O,{payload:x})=>{Object.values(O.byId).some(b=>D(x,b)&&b.showing)||(O.byId[x.id]=x,S(O.byId))},hideAppNotification:(O,{payload:x})=>{x in O.byId&&(O.byId[x].showing=!1,S(O.byId))},clearNotification:(O,{payload:x})=>{delete O.byId[x],S(O.byId)},clearAllNotifications:O=>{O.byId={},S(O.byId)},readAllNotifications:(O,{payload:x})=>{O.lastRead=x}}}),{notifyApp:u,hideAppNotification:d,clearNotification:p,clearAllNotifications:c,readAllNotifications:y}=i.actions,f=i.reducer,P=O=>O.lastRead,a=O=>O.byId,E=(0,n.Mz)(a,O=>Object.values(O).sort((x,b)=>b.timestamp-x.timestamp)),g=(0,n.Mz)(E,O=>O.filter(v)),h=(0,n.Mz)(a,O=>Object.values(O).filter(x=>x.showing));function D(O,x){return O.icon===x.icon&&O.severity===x.severity&&O.text===x.text&&O.title===x.title}function v(O){return O.severity===s.AppNotificationSeverity.Warning||O.severity===s.AppNotificationSeverity.Error}function C(O){return typeof O=="object"&&O!==null&&"id"in O&&"icon"in O&&"title"in O&&"text"in O}function T(){const O=window.localStorage.getItem(o);if(!O)return{};const x=JSON.parse(O);return Object.values(x).every(b=>C(b))?x:{}}function S(O){const x=Object.values(O).filter(v).sort((b,M)=>M.timestamp-b.timestamp).slice(0,r).reduce((b,M)=>(b[M.id]={id:M.id,severity:M.severity,icon:M.icon,title:M.title,text:M.text,traceId:M.traceId,timestamp:M.timestamp,showing:!1},b),{});try{window.localStorage.setItem(o,JSON.stringify(x))}catch(b){console.error("Unable to persist notifications to local storage"),console.error(b)}}},91219:(G,I,e)=>{"use strict";e.d(I,{I_:()=>p,L1:()=>m,TU:()=>d,ci:()=>i,fc:()=>u});var t=e(65307),n=e(32264),s=e(36689);const r=n.$.bootData?.navTree??[];function o(c){return c.map(y=>{const f=y.children&&o(y.children);return{...y,children:f,text:(0,s.C)(y.id)??y.text,subTitle:(0,s.o)(y.id)??y.subTitle,emptyMessage:(0,s.C)(y.emptyMessageId)}})}const m="starred/",l=(0,t.Z0)({name:"navBarTree",initialState:()=>o(n.$.bootData?.navTree??[]),reducers:{setStarred:(c,y)=>{const f=c.find(h=>h.id==="starred"),{id:P,title:a,url:E,isStarred:g}=y.payload;if(f)if(g){f.children||(f.children=[]);const h={id:m+P,text:a,url:E};f.children.push(h),f.children.sort((D,v)=>D.text.localeCompare(v.text))}else{const h=f.children?.findIndex(D=>D.id===m+P)??-1;h>-1&&f?.children?.splice(h,1)}},updateDashboardName:(c,y)=>{const{id:f,title:P,url:a}=y.payload,E=c.find(g=>g.id==="starred");if(E){const g=E.children?.find(h=>h.id===f);g&&(g.text=P,g.url=a,E.children?.sort((h,D)=>h.text.localeCompare(D.text)))}},removePluginFromNavTree:(c,y)=>{const f="plugin-page-"+y.payload.pluginID,P=c.findIndex(a=>a.id===f);P>-1&&c.splice(P,1)}}}),{setStarred:i,removePluginFromNavTree:u,updateDashboardName:d}=l.actions,p=l.reducer},28215:(G,I,e)=>{"use strict";e.d(I,{Id:()=>m,Im:()=>y,Vz:()=>p,YA:()=>c,_h:()=>P,s2:()=>l});var t=e(65307),n=e(2543),s=e.n(n),r=e(2913),o=e(36689);const m="home";function l(){const a={},E=(0,n.cloneDeep)(r.Ay.bootData.navTree),g=E.find(D=>D.id===m),h=E.filter(D=>D.id!==m);return g&&i(a,[g]),i(a,h,a[m]),a}function i(a,E,g){const h=[];for(const D of E){const v={...D,text:(0,o.C)(D.id)??D.text,subTitle:(0,o.o)(D.id)??D.subTitle,emptyMessage:(0,o.C)(D.emptyMessageId),parentItem:g};v.id&&(a[v.id]=v),v.children&&i(a,v.children,v),h.push(v)}g&&(g.children=h),a["not-found"]={...u("Page not found","404 Error").node},a.error={...u("Page error","An unexpected error").node}}function u(a,E){const g={text:a,subTitle:E,icon:"exclamation-triangle"};return{node:g,main:g}}const d={},p=(0,t.VP)("navIndex/updateNavIndex"),c=(0,t.VP)("navIndex/updateConfigurationSubtitle"),y=(0,t.VP)("navIndex/removeNavIndex"),f=(a,E)=>({...a,parentItem:{...a.parentItem,text:a.parentItem?.text??"",subTitle:E}}),P=(a=d,E)=>{if(p.match(E)){let h=function(C){if(C.children)for(const T of C.children)D[T.id]={...T,parentItem:C};C.parentItem&&h(C.parentItem)};var g=h;const D={},v=E.payload;return h(v),{...a,...D}}else if(c.match(E)){const h=`Organization: ${E.payload}`;return{...a,cfg:{...a.cfg,subTitle:h},datasources:f(a.datasources,h),correlations:f(a.correlations,h),users:f(a.users,h),teams:f(a.teams,h),plugins:f(a.plugins,h),"org-settings":f(a["org-settings"],h),apikeys:f(a.apikeys,h)}}else y.match(E)&&delete a[E.payload];return a}},17422:(G,I,e)=>{"use strict";e.d(I,{rH:()=>m,tc:()=>o});var t=e(41811),n=e(71101),s=e(28215);const r=()=>{const u={id:"not-found",text:"Page not found",icon:"exclamation-triangle",subTitle:"404 Error",url:"not-found"};return{node:u,main:u}},o=(0,t.A)((u,d,p,c=!1)=>{if(u[d]){const y=u[d],f=c?y:m(y),P=l(f,d);return{node:y,main:P}}return p||r()});function m(u){return u.id===n.Rj?u:u.parentItem&&u.parentItem.id!==s.Id?m(u.parentItem):u}function l(u,d){return u.id===d?{...u,active:!0}:u.children&&u.children.length>0?{...u,children:u.children.map(p=>l(p,d))}:u}const i=u=>`${u.main.text}${u.node.text?": "+u.node.text:""}`},65615:(G,I,e)=>{"use strict";e.d(I,{W:()=>n});var t=e(27677);class n{constructor(r){this.resourceUri=r}update(r){return t.IB.put(`/api/${this.resourceUri}/preferences`,r)}patch(r){return t.IB.patch(`/api/${this.resourceUri}/preferences`,r)}load(){return t.IB.get(`/api/${this.resourceUri}/preferences`)}}},2619:(G,I,e)=>{"use strict";e.d(I,{Q:()=>r});var t=e(96540),n=e(13752),s=e(69731);class r{constructor(l){this._subject=new n.B,this._state=l}useState(){return o(this)}get state(){return this._state}setState(l){this._state={...this._state,...l},this._subject.next(this._state)}subscribeToState(l){return this._subject.subscribe(l)}}function o(m){const l=(0,s.C)();return(0,t.useEffect)(()=>{const i=m.subscribeToState({next:l});return()=>i.unsubscribe()},[m,l]),m.state}},27677:(G,I,e)=>{"use strict";e.d(I,{Mf:()=>Me,IB:()=>Ue,AI:()=>we});var t=e(56568),n=e(13752),s=e(75505),r=e(88483),o=e(64423),m=e(13288),l=e(65474),i=e(20039),u=e(81160),d=e(69862),p=e(59099),c=e(37748),y=e(66847),f=e(67791),P=e(16126),a=e(41560),E=e(69850),g=e(1005),h=e(62938),D=e(26272),v=e(40187),C=e(95344),T=e(32264),S=e(28138),O=e(2913),x=e(92315),b=e(67027),M=e(28676),A=e(32196),R=e(96540),B=e(40845),U=e(17464),W=e(37166),N=e(55852),w=e(88448);const L=Re=>{const Fe=(0,B.of)(V),xe=(0,B.$j)(),Ve=(0,w.o)(xe),$e=!!Re.maxConcurrentSessions,Xe=()=>{window.location.reload()};return R.createElement(U.ZL,null,R.createElement("div",{className:Ve.modal},R.createElement(W.w,{title:"You have been automatically signed out",severity:"warning",className:Fe.infobox},R.createElement("div",{className:Fe.text},R.createElement("p",null,"Your session token was automatically revoked because you have reached",R.createElement("strong",null,` the maximum number of ${$e?Re.maxConcurrentSessions:""} concurrent sessions `),"for your account."),R.createElement("p",null,R.createElement("strong",null,"To resume your session, sign in again."),"Contact your administrator or visit the license page to review your quota if you are repeatedly signed out automatically.")),R.createElement(N.$n,{size:"md",variant:"primary",onClick:Xe},"Sign in"))),R.createElement("div",{className:(0,A.cx)(Ve.modalBackdrop,Fe.backdrop)}))},V=Re=>({infobox:(0,A.css)`
    margin-bottom: 0;
  `,text:(0,A.css)`
    margin: ${Re.spacing(1,0,2)};
  `,backdrop:(0,A.css)`
    background-color: ${Re.colors.background.canvas};
    opacity: 0.8;
  `});var K=e(28444),k=e(2543);const j=Re=>{const Fe=Re.method,xe=q(Re),Ve=ee(xe),$e=z(Re,Ve),Xe=ue(Re);return{method:Fe,headers:xe,body:$e,credentials:Xe}},H={canParse:()=>!0,parse:Re=>(Re.get("accept")||Re.set("accept","application/json, text/plain, */*"),Re)},J=Re=>({canParse:Fe=>(Fe?.method?Fe?.method.toLowerCase():"")===Re,parse:Fe=>(Fe.get("content-type")||Fe.set("content-type","application/json"),Fe)}),X=J("post"),se=J("put"),ae=J("patch"),ne=[X,se,ae,H],q=Re=>{const Fe=Re?.headers?new Headers(Re.headers):new Headers;return ne.filter($e=>$e.canParse(Re)).reduce(($e,Xe)=>Xe.parse($e),Fe)},ee=Re=>{if(!Re)return!1;const Fe=Re.get("content-type");return!!(Fe&&Fe.toLowerCase()==="application/json")},z=(Re,Fe)=>Re&&(!Re.data||typeof Re.data=="string"||Re.data instanceof Blob?Re.data:Fe?JSON.stringify(Re.data):new URLSearchParams(Re.data));async function te(Re,Fe){if(Fe)switch(Fe){case"arraybuffer":return Re.arrayBuffer();case"blob":return Re.blob();case"json":return Re.headers.get("Content-Length")==="0"?(console.warn(`${Re.url} returned an invalid JSON`),{}):await Re.json();case"text":return Re.text()}const xe=await Re.text();try{return JSON.parse(xe)}catch{}return xe}function ie(Re){return Object.keys(Re).map(Fe=>{const xe=Re[Fe];return Array.isArray(xe)?xe.map(Ve=>`${encodeURIComponent(Fe)}=${encodeURIComponent(Ve)}`).join("&"):`${encodeURIComponent(Fe)}=${encodeURIComponent(xe)}`}).join("&")}const ce=Re=>{const Fe=(0,k.omitBy)(Re.params,Ve=>Ve===void 0||Ve&&Ve.length===0),xe=ie(Fe);return Re.params&&xe.length?`${Re.url}?${xe}`:Re.url},ue=Re=>Re&&(Re.credentials?Re.credentials:Re.withCredentials?((0,C.l)("BackendSrvRequest","withCredentials","credentials"),"include"):"same-origin");var fe=e(21969),Te=(Re=>(Re[Re.Pending=0]="Pending",Re[Re.InProgress=1]="InProgress",Re[Re.Done=2]="Done",Re))(Te||{});class he{constructor(Fe=!1){this.state={},this.queue=new n.B,this.updates=new n.B,this.add=(xe,Ve)=>this.queue.next({id:xe,options:Ve,state:0}),this.setInProgress=xe=>this.queue.next({id:xe,state:1}),this.setDone=xe=>this.queue.next({id:xe,state:2}),this.getUpdates=()=>this.updates.asObservable(),this.getUpdate=xe=>{const Ve=Object.keys(xe).filter(Xe=>xe[Xe].state===1).length;return{noOfPending:Object.keys(xe).filter(Xe=>xe[Xe].state===0).length,noOfInProgress:Ve,state:xe}},this.publishUpdate=(xe,Ve)=>{this.printState(xe,Ve),this.updates.next(xe)},this.printState=(xe,Ve)=>{if(!Ve)return;const $e=Object.keys(xe.state).reduce((Xe,gt)=>{const Dt={id:gt,state:xe.state[gt].state};return Xe.push(Dt),Xe},[]);console.log("FetchQueue noOfStarted",xe.noOfInProgress),console.log("FetchQueue noOfNotStarted",xe.noOfPending),console.log("FetchQueue state",$e)},this.queue.subscribe(xe=>{const{id:Ve,state:$e,options:Xe}=xe;if(this.state[Ve]||(this.state[Ve]={state:0,options:{url:""}}),$e===2){delete this.state[Ve];const Dt=this.getUpdate(this.state);this.publishUpdate(Dt,Fe);return}this.state[Ve].state=$e,Xe&&(this.state[Ve].options=Xe);const gt=this.getUpdate(this.state);this.publishUpdate(gt,Fe)})}}var de=e(95864);class le{constructor(Fe,xe,Ve){const $e=Ve?.http2Enabled?1e3:5;Fe.getUpdates().pipe((0,P.p)(({noOfPending:Xe})=>Xe>0),(0,de.H)(({state:Xe,noOfInProgress:gt})=>{const Dt=Object.keys(Xe).filter(re=>Xe[re].state===Te.Pending&&!(0,fe.dr)(Xe[re].options.url)).reduce((re,Z)=>{const oe={id:Z,options:Xe[Z].options};return re.push(oe),re},[]),nt=Object.keys(Xe).filter(re=>Xe[re].state===Te.Pending&&(0,fe.dr)(Xe[re].options.url)).reduce((re,Z)=>{const oe={id:Z,options:Xe[Z].options};return re.push(oe),re},[]),at=Math.max($e-gt-Dt.length,0),Ae=nt.slice(0,at);return Dt.concat(Ae)})).subscribe(({id:Xe,options:gt})=>{xe.add(Xe,gt)})}}class pe{constructor(Fe,xe){this.queue=new n.B,this.responses=new n.B,this.add=(Ve,$e)=>{this.queue.next({id:Ve,options:$e})},this.getResponses=Ve=>this.responses.asObservable().pipe((0,P.p)($e=>$e.id===Ve)),this.queue.subscribe(Ve=>{const{id:$e,options:Xe}=Ve;Fe.setInProgress($e),this.responses.next({id:$e,observable:xe(Xe)})})}}var ve=e(16233);const be="cancel_all_requests_request_id",Oe="grafana-trace-id";class Me{constructor(Fe){this.inFlightRequests=new n.B,this.HTTP_REQUEST_CANCELED=-1,this.inspectorStream=new n.B,this._tokenRotationInProgress=null,this.deviceID=null,this.dependencies={fromFetch:i.$,appEvents:S.A,contextSrv:ve.TP,logout:()=>{ve.TP.setLoggedOut()}},Fe&&(this.dependencies={...this.dependencies,...Fe}),this.noBackendCache=!1,this.internalFetch=this.internalFetch.bind(this),this.fetchQueue=new he,this.responseQueue=new pe(this.fetchQueue,this.internalFetch),this.initGrafanaDeviceID(),new le(this.fetchQueue,this.responseQueue,(0,O.zj)())}async initGrafanaDeviceID(){try{const xe=await(await t.Ay.load()).get();this.deviceID=xe.visitorId}catch(Fe){console.error(Fe)}}async request(Fe){return await(0,s.s)(this.fetch(Fe).pipe((0,u.T)(xe=>xe.data)))}fetch(Fe){const xe=(0,h.A)(),Ve=this.fetchQueue;return new r.c($e=>{const Xe=new o.yU;return Xe.add(this.responseQueue.getResponses(xe).subscribe(gt=>{Xe.add(gt.observable.subscribe($e))})),this.fetchQueue.add(xe,Fe),function(){Ve.setDone(xe),Xe.unsubscribe()}})}internalFetch(Fe){Fe.requestId&&this.inFlightRequests.next(Fe.requestId),Fe=this.parseRequestOptions(Fe);const xe=(0,b.r)();return xe!==null&&xe!==""&&T.$.jwtUrlLogin&&T.$.jwtHeaderName&&(Fe.headers=Fe.headers??{},Fe.headers[T.$.jwtHeaderName]=`${xe}`),this.deviceID&&(Fe.headers=Fe.headers??{},Fe.headers["X-Grafana-Device-Id"]=`${this.deviceID}`),this.getFromFetchStream(Fe).pipe(this.handleStreamResponse(Fe),this.handleStreamError(Fe),this.handleStreamCancellation(Fe))}resolveCancelerIfExists(Fe){this.inFlightRequests.next(Fe)}cancelAllInFlightRequests(){this.inFlightRequests.next(be)}async datasourceRequest(Fe){return(0,s.s)(this.fetch(Fe))}parseRequestOptions(Fe){const xe=this.dependencies.contextSrv.user?.orgId;return Fe.retry=Fe.retry??0,(0,fe.Lr)(Fe.url)&&(xe&&(Fe.headers=Fe.headers??{},Fe.headers["X-Grafana-Org-Id"]=xe),Fe.url.startsWith("/")&&(Fe.url=Fe.url.substring(1)),Fe.headers?.Authorization&&(Fe.headers["X-DS-Authorization"]=Fe.headers.Authorization,delete Fe.headers.Authorization),this.noBackendCache&&(Fe.headers=Fe.headers??{},Fe.headers["X-Grafana-NoCache"]="true")),Fe.hideFromInspector===void 0&&(Fe.hideFromInspector=(0,fe.Lr)(Fe.url)&&!(0,fe.dr)(Fe.url)),Fe}getFromFetchStream(Fe){const xe=ce(Fe),Ve=j(Fe);return this.dependencies.fromFetch(xe,Ve).pipe((0,d.Z)(async $e=>{const{status:Xe,statusText:gt,ok:Dt,headers:nt,url:at,type:Ae,redirected:re}=$e,Z=Fe.responseType??(ee(nt)?"json":void 0),oe=await te($e,Z);return{status:Xe,statusText:gt,ok:Dt,data:oe,headers:nt,url:at,type:Ae,redirected:re,config:Fe,traceId:$e.headers.get(Oe)??void 0}}))}showApplicationErrorAlert(Fe){}showSuccessAlert(Fe){const{config:xe}=Fe;if(xe.showSuccessAlert===!1||xe.showSuccessAlert===void 0&&(xe.method==="GET"||(0,fe.dr)(xe.url)||!(0,fe.Lr)(xe.url)))return;const Ve=Fe.data;Ve?.message&&this.dependencies.appEvents.emit(D.r1.alertSuccess,[Ve.message])}showErrorAlert(Fe,xe){if(Fe.showErrorAlert===!1||Fe.showErrorAlert===void 0&&((0,fe.dr)(Fe.url)||!(0,fe.Lr)(Fe.url)))return;let Ve="",$e=xe.data.message;$e==="Unexpected error"&&xe.message&&($e=xe.message),$e.length>80&&(Ve=$e,$e="Error"),xe.status===422&&(Ve=xe.data.message,$e="Validation failed"),this.dependencies.appEvents.emit(xe.status<500?D.r1.alertWarning:D.r1.alertError,[$e,Ve,xe.data.traceID])}processRequestError(Fe,xe){return xe.data=xe.data??{message:"Unexpected error"},typeof xe.data=="string"&&(xe.data={message:xe.data,error:xe.statusText,response:xe.data}),xe.data&&!xe.data.message&&typeof xe.data.error=="string"&&(xe.data.message=xe.data.error),xe.data.message&&setTimeout(()=>{xe.isHandled||this.showErrorAlert(Fe,xe)},50),this.inspectorStream.next({response:xe,requestId:Fe.requestId}),xe}handleStreamResponse(Fe){return xe=>xe.pipe((0,u.T)(Ve=>{if(!Ve.ok){const{status:$e,statusText:Xe,data:gt}=Ve;throw{status:$e,statusText:Xe,data:gt,config:Fe,traceId:Ve.headers.get(Oe)??void 0}}return Ve}),(0,p.M)(Ve=>{this.showSuccessAlert(Ve),this.inspectorStream.next({response:Ve,requestId:Fe.requestId})}))}handleStreamError(Fe){const{isSignedIn:xe}=this.dependencies.contextSrv.user;return Ve=>Ve.pipe((0,c.l)($e=>$e.pipe((0,d.Z)((Xe,gt)=>{const Dt=gt===0&&Fe.retry===0;if(Xe.status===401&&(0,fe.Lr)(Fe.url)&&Dt&&xe){if(Xe.data?.error?.id==="ERR_TOKEN_REVOKED")return this.dependencies.appEvents.publish(new K.S8({component:L,props:{maxConcurrentSessions:Xe.data?.error?.maxConcurrentSessions}})),(0,m.$)(()=>Xe);let nt=this.loginPing();return(0,x.m)()&&(0,x.W)()*1e3<Date.now()&&(nt=this.rotateToken()),(0,l.H)(nt).pipe((0,y.W)(at=>(at.status===401&&this.dependencies.logout(),(0,m.$)(at))))}return(0,m.$)(Xe)}))),(0,y.W)($e=>(0,m.$)(()=>this.processRequestError(Fe,$e))))}handleStreamCancellation(Fe){return xe=>xe.pipe((0,f.Q)(this.inFlightRequests.pipe((0,P.p)(Ve=>{let $e=!1;return Fe&&Fe.requestId&&Fe.requestId===Ve&&($e=!0),Ve===be&&($e=!0),$e}))),(0,a.v)(()=>({type:v.v2.Cancelled,cancelled:!0,data:null,status:this.HTTP_REQUEST_CANCELED,statusText:"Request was aborted",config:Fe})))}getInspectorStream(){return this.inspectorStream}async get(Fe,xe,Ve,$e){return this.request({...$e,method:"GET",url:Fe,params:xe,requestId:Ve})}async delete(Fe,xe,Ve){return this.request({...Ve,method:"DELETE",url:Fe,data:xe})}async post(Fe,xe,Ve){return this.request({...Ve,method:"POST",url:Fe,data:xe})}async patch(Fe,xe,Ve){return this.request({...Ve,method:"PATCH",url:Fe,data:xe})}async put(Fe,xe,Ve){return this.request({...Ve,method:"PUT",url:Fe,data:xe})}withNoBackendCache(Fe){return this.noBackendCache=!0,Fe().finally(()=>{this.noBackendCache=!1})}rotateToken(){return this._tokenRotationInProgress?this._tokenRotationInProgress:(this._tokenRotationInProgress=this.fetch({url:"/api/user/auth-tokens/rotate",method:"POST",retry:1}).pipe((0,E.j)(()=>{this._tokenRotationInProgress=null}),(0,g.u)()),this._tokenRotationInProgress)}loginPing(){return this.fetch({url:"/api/login/ping",method:"GET",retry:1})}search(Fe){return this.get("/api/search",Fe)}getDashboardByUid(Fe){return(0,C.l)("backend_srv","getDashboardByUid(uid)","getDashboardAPI().getDashboardDTO(uid)"),(0,M.n)().getDashboardDTO(Fe)}validateDashboard(Fe){return Promise.resolve({isValid:!1,message:"dashboard validation is not supported"})}getPublicDashboardByUid(Fe){return this.get(`/api/public/dashboards/${Fe}`)}getFolderByUid(Fe,xe={}){const Ve=new URLSearchParams;return xe.withAccessControl&&Ve.set("accesscontrol","true"),this.get(`/api/folders/${Fe}?${Ve.toString()}`,void 0,void 0,{showErrorAlert:!1})}}const Ue=new Me,we=()=>Ue},16233:(G,I,e)=>{"use strict";e.d(I,{SM:()=>u,TP:()=>c});var t=e(2543),n=e.n(t),s=e(65879),r=e(17172),o=e(33378),m=e(92315),l=e(31678),i=e(2913);const u="auto";class d{constructor(){this.id=0,this.uid="",this.isGrafanaAdmin=!1,this.isSignedIn=!1,this.orgRole="",this.orgId=0,this.orgName="",this.login="",this.externalUserId="",this.orgCount=0,this.timezone="",this.fiscalYearStartMonth=0,this.helpFlags1=0,this.theme="dark",this.hasEditPermissionInFolders=!1,this.email="",this.name="",this.locale="",this.language="",this.weekStart="",this.gravatarUrl="",this.analytics={identifier:""},this.authenticatedBy="",i.Ay.bootData.user&&(0,t.extend)(this,i.Ay.bootData.user)}}class p{constructor(){this.sidemenuSmallBreakpoint=!1,this.tokenRotationJobId=0,i.Ay.bootData||(i.Ay.bootData={user:{},settings:{},navTree:[]}),this.user=new d,this.isSignedIn=this.user.isSignedIn,this.isGrafanaAdmin=this.user.isGrafanaAdmin,this.isEditor=this.hasRole("Editor")||this.hasRole("Admin"),this.hasEditPermissionInFolders=this.user.hasEditPermissionInFolders,this.minRefreshInterval=i.Ay.minRefreshInterval,this.scheduleTokenRotationJob()}async fetchUserPermissions(){try{this.user.permissions=await(0,r.AI)().get("/api/access-control/user/actions",{reloadcache:!0})}catch(P){console.error(P)}}setLoggedOut(){this.cancelTokenRotationJob(),this.user.isSignedIn=!1,this.isSignedIn=!1,window.location.reload()}hasRole(P){return P==="ServerAdmin"?this.isGrafanaAdmin:this.user.orgRole===P}licensedAccessControlEnabled(){return(0,o.a)("accesscontrol")}hasPermissionInMetadata(P,a){return!!a.accessControl?.[P]}hasPermission(P){return!!this.user.permissions?.[P]}isGrafanaVisible(){return document.visibilityState===void 0||document.visibilityState==="visible"}isAllowedInterval(P){return!i.Ay.minRefreshInterval||P===u?!0:s.intervalToMs(P)>=s.intervalToMs(i.Ay.minRefreshInterval)}getValidInterval(P){return this.isAllowedInterval(P)?P:i.Ay.minRefreshInterval}getValidIntervals(P){return this.minRefreshInterval?P.filter(a=>a!=="").filter(this.isAllowedInterval):P}hasAccessToExplore(){return this.hasPermission(l.AccessControlAction.DataSourcesExplore)&&i.Ay.exploreEnabled}evaluatePermission(P){return P.some(a=>this.hasPermission(a))?[]:["Reject"]}scheduleTokenRotationJob(){if(this.canScheduleRotation()){let P=(0,m.W)(),E=(P-Math.floor(Math.random()*19+1))*1e3-Date.now();this.tokenRotationJobId=setTimeout(()=>{if((0,m.W)()>P){this.scheduleTokenRotationJob();return}this.rotateToken().then()},E)}}canScheduleRotation(){return!(!this.isSignedIn||(0,m.W)()===0)}cancelTokenRotationJob(){this.tokenRotationJobId>0&&clearTimeout(this.tokenRotationJobId)}rotateToken(){return fetch(i.Ay.appSubUrl+"/api/user/auth-tokens/rotate",{method:"POST"}).then(P=>{if(P.status===200){this.scheduleTokenRotationJob();return}if(P.status===401){this.setLoggedOut();return}}).catch(P=>{console.error(P)})}}let c=new p;const y=f=>{throw new Error("contextSrv can be only overridden in test environment")}},42614:(G,I,e)=>{"use strict";e.d(I,{n:()=>n});var t=e(63415);const n=(r,o)=>{(0,t.x$)().addEvent({type:t.on.Performance,payload:{name:r,value:o}})},s=r=>faro?.api?.pushError(r)},62301:(G,I,e)=>{"use strict";e.d(I,{A:()=>i});var t=e(2543),n=e.n(t),s=e(17172),r=e(2913),o=e(33390);class m{constructor(){}addDashboardImpression(d){const p=this.impressionKey();let c=[];o.A.exists(p)&&(c=JSON.parse(o.A.get(p)),(0,t.isArray)(c)||(c=[])),c=c.filter(y=>d!==y),c.unshift(d),c.length>50&&c.pop(),o.A.set(p,JSON.stringify(c))}async convertToUIDs(){let d=this.getImpressions();const p=(0,t.filter)(d,y=>(0,t.isNumber)(y));if(!p.length)return;const c=await(0,s.AI)().get(`/api/dashboards/ids/${p.join(",")}`);o.A.set(this.impressionKey(),JSON.stringify([...(0,t.filter)(d,y=>(0,t.isString)(y)),...c]))}getImpressions(){const d=o.A.get(this.impressionKey())||"[]";return JSON.parse(d)}async getDashboardOpened(){try{await this.convertToUIDs()}catch{}return(0,t.filter)(this.getImpressions(),p=>(0,t.isString)(p))}impressionKey(){return"dashboard_impressions-"+r.Ay.bootData.user.orgId}}const i=new m},4898:(G,I,e)=>{"use strict";e.d(I,{R:()=>g});let t={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},n={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},r={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},o=null;for(let h=1;h<20;++h)t[111+h]="f"+h;for(let h=0;h<=9;++h)t[h+96]=h.toString();function m(h){if(h.type==="keypress"){let D=String.fromCharCode(h.which);return h.shiftKey||(D=D.toLowerCase()),D}return t[h.which]?t[h.which]:n[h.which]?n[h.which]:String.fromCharCode(h.which).toLowerCase()}function l(h,D){return h.sort().join(",")===D.sort().join(",")}function i(h){let D=[];return h.shiftKey&&D.push("shift"),h.altKey&&D.push("alt"),h.ctrlKey&&D.push("ctrl"),h.metaKey&&D.push("meta"),D}function u(h){if(h.preventDefault){h.preventDefault();return}h.returnValue=!1}function d(h){if(h.stopPropagation){h.stopPropagation();return}h.cancelBubble=!0}function p(h){return h==="shift"||h==="ctrl"||h==="alt"||h==="meta"}function c(){if(!o){o={};for(let h in t){const D=parseInt(h,10);D>95&&D<112||t.hasOwnProperty(h)&&(o[t[h]]=h)}}return o}function y(h,D,v){return v||(v=c()[h]?"keydown":"keypress"),v==="keypress"&&D.length&&(v="keydown"),v}function f(h){return h==="+"?["+"]:(h=h.replace(/\+{2}/g,"+plus"),h.split("+"))}function P(h,D){let v,C,T,S=[];for(v=f(h),T=0;T<v.length;++T)C=v[T],r[C]&&(C=r[C]),D&&D!=="keypress"&&s[C]&&(C=s[C],S.push("shift")),p(C)&&S.push(C);if(!C)throw new Error("Unable to get key");return D=y(C,S,D),{key:C,modifiers:S,action:D}}function a(h,D){return h===null||h===document?!1:h===D?!0:a(h.parentNode,D)}class E{constructor(D){this._callbacks={},this._directMap={},this._sequenceLevels={},this._resetTimer=void 0,this._ignoreNextKeyup=!1,this._ignoreNextKeypress=!1,this._nextExpectedAction=!1,this._globalCallbacks={},this._resetSequences=v=>{v=v||{};let C=!1,T;for(T in this._sequenceLevels){if(v[T]){C=!0;continue}this._sequenceLevels[T]=0}C||(this._nextExpectedAction=!1)},this._getMatches=(v,C,T,S,O,x)=>{let b,M,A=[],R=T.type;if(!this._callbacks[v])return[];for(R==="keyup"&&p(v)&&(C=[v]),b=0;b<this._callbacks[v].length;++b)if(M=this._callbacks[v][b],!(!S&&M.seq&&this._sequenceLevels[M.seq]!==M.level)&&R===M.action&&(R==="keypress"&&!T.metaKey&&!T.ctrlKey||l(C,M.modifiers))){let B=!S&&M.combo===O,U=S&&M.seq===S&&M.level===x;(B||U)&&this._callbacks[v].splice(b,1),A.push(M)}return A},this._fireCallback=(v,C,T,S)=>{const O=C.target||C.srcElement;O&&O instanceof HTMLElement&&this.stopCallback(C,O,T,S)||v(C,T)===!1&&(u(C),d(C))},this._handleKey=(v,C,T)=>{let S=this._getMatches(v,C,T),O,x={},b=0,M=!1;for(O=0;O<S.length;++O)S[O].seq&&(b=Math.max(b,S[O].level??0));for(O=0;O<S.length;++O){const R=S[O].seq;if(R){if(S[O].level!==b)continue;M=!0,x[R]=1,this._fireCallback(S[O].callback,T,S[O].combo,R);continue}M||this._fireCallback(S[O].callback,T,S[O].combo)}let A=T.type==="keypress"&&this._ignoreNextKeypress;T.type===this._nextExpectedAction&&!p(v)&&!A&&this._resetSequences(x),this._ignoreNextKeypress=M&&T.type==="keydown"},this._handleKeyEvent=v=>{if(!(v instanceof KeyboardEvent))throw new Error("Didn't get a KeyboardEvent");const C=v;typeof C.which!="number"&&(C.which=C.keyCode);let T=m(C);if(T){if(C.type==="keyup"&&this._ignoreNextKeyup===T){this._ignoreNextKeyup=!1;return}this.handleKey(T,i(C),C)}},this._resetSequenceTimer=()=>{clearTimeout(this._resetTimer),this._resetTimer=setTimeout(this._resetSequences,1e3)},this._bindSequence=(v,C,T,S)=>{this._sequenceLevels[v]=0;const O=b=>()=>{this._nextExpectedAction=b,++this._sequenceLevels[v],this._resetSequenceTimer()},x=b=>{this._fireCallback(T,b,v),S!=="keyup"&&(this._ignoreNextKeyup=m(b)),setTimeout(this._resetSequences,10)};for(let b=0;b<C.length;++b){let A=b+1===C.length?x:O(S||P(C[b+1]).action);this._bindSingle(C[b],A,S,v,b)}},this._bindSingle=(v,C,T,S,O)=>{this._directMap[v+":"+T]=C,v=v.replace(/\s+/g," ");let x=v.split(" "),b;if(x.length>1){this._bindSequence(v,x,C,T);return}b=P(v,T),this._callbacks[b.key]=this._callbacks[b.key]||[];const M={type:b.action,metaKey:!1,ctrlKey:!1};this._getMatches(b.key,b.modifiers,M,S,v,O);const A={callback:C,modifiers:b.modifiers,action:b.action,seq:S,level:O,combo:v};this._callbacks[b.key][S?"unshift":"push"](A)},this._bindMultiple=(v,C,T)=>{for(let S=0;S<v.length;++S)this._bindSingle(v[S],C,T)},this.bind=(v,C,T)=>(v=v instanceof Array?v:[v],this._bindMultiple(v,C,T),self),this.unbind=(v,C)=>this.bind(v,function(){},C),this.bindGlobal=(v,C,T)=>{if(this.bind(v,C,T),v instanceof Array){for(let S=0;S<v.length;S++)this._globalCallbacks[v[S]]=!0;return}this._globalCallbacks[v]=!0},this.unbindGlobal=(v,C)=>{if(this.unbind(v,C),v instanceof Array){for(let T=0;T<v.length;T++)this._globalCallbacks[v[T]]=!1;return}this._globalCallbacks[v]=!1},this.trigger=(v,C)=>{let T=this;return T._directMap[v+":"+C]&&T._directMap[v+":"+C]({},v),T},this.reset=()=>(this._callbacks={},this._directMap={},this),this.stopCallback=(v,C,T,S)=>{if(this._globalCallbacks[T]||S&&this._globalCallbacks[S]||(" "+C.className+" ").indexOf(" mousetrap ")>-1||a(C,this.target))return!1;if("composedPath"in v&&typeof v.composedPath=="function"){let O=v.composedPath()[0];O!==v.target&&O instanceof HTMLElement&&(C=O)}return!!(C.tagName==="INPUT"||C.tagName==="SELECT"||C.tagName==="TEXTAREA"||"isContentEditable"in C&&C.isContentEditable)},this.handleKey=(...v)=>this._handleKey(...v),this.addKeycodes=v=>{for(let C in v)v.hasOwnProperty(C)&&(t[C]=v[C]);o=null},this.target=D,this.target.addEventListener("keypress",v=>{v instanceof KeyboardEvent&&this._handleKeyEvent(v)}),this.target.addEventListener("keydown",v=>{v instanceof KeyboardEvent&&this._handleKeyEvent(v)}),this.target.addEventListener("keyup",v=>{v instanceof KeyboardEvent&&this._handleKeyEvent(v)})}}const g=new E(document)},2769:(G,I,e)=>{"use strict";e.d(I,{K:()=>l,O:()=>i});var t=e(97594),n=e(3591),s=e(28138),r=e(2913),o=e(10096),m=e(65615);async function l(u,d){const p=r.config.theme2,c=(0,t.g)(u);if(s.A.publish(new n.E8(c)),p.colors.mode!==c.colors.mode){const P=document.createElement("link");P.rel="stylesheet",P.href=r.config.bootData.assets[c.colors.mode],P.onload=()=>{const a=document.getElementsByTagName("link");for(let E=0;E<a.length;E++){const g=a[E];g.href&&g.href.includes(`build/grafana.${p.colors.mode}`)&&g.remove()}},document.head.insertBefore(P,document.head.firstChild)}if(d||!o.TP.isSignedIn)return;const y=new m.W("user"),f=await y.load();await y.update({...f,theme:c.colors.mode})}async function i(u){const d=r.config.theme2;l(d.isDark?"light":"dark",u)}},33390:(G,I,e)=>{"use strict";e.d(I,{A:()=>s});class t{get(o){return window.localStorage[o]}set(o,m){window.localStorage[o]=m}getBool(o,m){return m!==void 0&&!this.exists(o)?m:window.localStorage[o]==="true"}getObject(o,m){let l=m;if(this.exists(o)){const i=window.localStorage[o];try{l=JSON.parse(i)}catch(u){console.error(`Error parsing store object: ${o}. Returning default: ${m}. [${u}]`)}}return l}setObject(o,m){let l;try{l=JSON.stringify(m)}catch(i){throw new Error(`Could not stringify object: ${o}. [${i}]`)}try{this.set(o,l)}catch(i){const u=new Error(`Could not save item in localStorage: ${o}. [${i}]`);throw i instanceof Error&&(u.name=i.name),u}return!0}exists(o){return window.localStorage[o]!==void 0}delete(o){window.localStorage.removeItem(o)}}const s=new t},31140:(G,I,e)=>{"use strict";e.d(I,{A:()=>u,r:()=>i});var t=e(2543),n=e.n(t),s=e(54479),r=e(83195);function o(d,p){if(!d)return!1;if(d[0]==="/"){const c=(0,s.dO)(d);return p.match(c)!=null}return d===p}function m(d){return d===0?.001:d/10}function l(d){return d?{colors:[{opacity:0},{opacity:d/10}]}:null}function i(d,p,c){for(let y=0;y<d.length;y++){const f=d[y],P=p.yaxes,a=f.yaxis||1,E=P[a-1],g=(0,r.j_)(E.format);(0,t.isNumber)(p.decimals)?f.updateLegendValues(g,p.decimals):(0,t.isNumber)(E.decimals)?f.updateLegendValues(g,E.decimals+1):f.updateLegendValues(g,null)}}class u{constructor(p){this.datapoints=p.datapoints,this.label=p.alias,this.id=p.alias,this.alias=p.alias,this.aliasEscaped=(0,t.escape)(p.alias),this.color=p.color,this.bars={fillColor:p.color},this.valueFormater=(0,r.j_)("none"),this.stats={},this.legend=!0,this.unit=p.unit,this.dataFrameIndex=p.dataFrameIndex,this.fieldIndex=p.fieldIndex,this.hasMsResolution=this.isMsResolutionNeeded()}applySeriesOverrides(p){this.lines={},this.dashes={dashLength:[]},this.points={},this.yaxis=1,this.zindex=0,this.nullPointMode=null,delete this.stack,delete this.bars.show;for(let c=0;c<p.length;c++){const y=p[c];o(y.alias,this.alias)&&(y.lines!==void 0&&(this.lines.show=y.lines),y.dashes!==void 0&&(this.dashes.show=y.dashes,this.lines.lineWidth=0),y.points!==void 0&&(this.points.show=y.points),y.bars!==void 0&&(this.bars.show=y.bars),y.fill!==void 0&&(this.lines.fill=m(y.fill)),y.fillGradient!==void 0&&(this.lines.fillColor=l(y.fillGradient)),y.stack!==void 0&&(this.stack=y.stack),y.linewidth!==void 0&&(this.lines.lineWidth=this.dashes.show?0:y.linewidth,this.dashes.lineWidth=y.linewidth),y.dashLength!==void 0&&(this.dashes.dashLength[0]=y.dashLength),y.spaceLength!==void 0&&(this.dashes.dashLength[1]=y.spaceLength),y.nullPointMode!==void 0&&(this.nullPointMode=y.nullPointMode),y.pointradius!==void 0&&(this.points.radius=y.pointradius),y.steppedLine!==void 0&&(this.lines.steps=y.steppedLine),y.zindex!==void 0&&(this.zindex=y.zindex),y.fillBelowTo!==void 0&&(this.fillBelowTo=y.fillBelowTo),y.color!==void 0&&this.setColor(y.color),y.transform!==void 0&&(this.transform=y.transform),y.legend!==void 0&&(this.legend=y.legend),y.hideTooltip!==void 0&&(this.hideTooltip=y.hideTooltip),y.yaxis!==void 0&&(this.yaxis=y.yaxis),y.hiddenSeries!==void 0&&(this.hiddenSeries=y.hiddenSeries))}}getFlotPairs(p){const c=[];this.stats.total=0,this.stats.max=-Number.MAX_VALUE,this.stats.min=Number.MAX_VALUE,this.stats.logmin=Number.MAX_VALUE,this.stats.avg=null,this.stats.current=null,this.stats.first=null,this.stats.delta=0,this.stats.diff=null,this.stats.diffperc=0,this.stats.range=null,this.stats.timeStep=Number.MAX_VALUE,this.allIsNull=!0,this.allIsZero=!0;const y=p==="connected",f=p==="null as zero";let P,a,E=0,g,h=0,D=!0;for(let v=0;v<this.datapoints.length;v++){if(a=this.datapoints[v][0],P=this.datapoints[v][1],g!==void 0){const C=P-g;C<this.stats.timeStep&&(this.stats.timeStep=C)}if(g=P,a===null){if(y)continue;f&&(a=0)}a!==null&&((0,t.isNumber)(a)&&(this.stats.total+=a,this.allIsNull=!1,E++),a>this.stats.max&&(this.stats.max=a),a<this.stats.min&&(this.stats.min=a),this.stats.first===null?this.stats.first=a:h>a?(D=!1,v===this.datapoints.length-1&&(this.stats.delta+=a)):(D?this.stats.delta+=a-h:this.stats.delta+=a,D=!0),h=a,a<this.stats.logmin&&a>0&&(this.stats.logmin=a),a!==0&&(this.allIsZero=!1)),c.push([P,a])}return this.stats.max===-Number.MAX_VALUE&&(this.stats.max=null),this.stats.min===Number.MAX_VALUE&&(this.stats.min=null),c.length&&!this.allIsNull&&(this.stats.avg=this.stats.total/E,this.stats.current=c[c.length-1][1],this.stats.current===null&&c.length>1&&(this.stats.current=c[c.length-2][1])),this.stats.max!==null&&this.stats.min!==null&&(this.stats.range=this.stats.max-this.stats.min),this.stats.current!==null&&this.stats.first!==null&&(this.stats.diff=this.stats.current-this.stats.first,this.stats.diffperc=this.stats.diff/this.stats.first),this.stats.count=c.length,c}updateLegendValues(p,c){this.valueFormater=p,this.decimals=c}formatValue(p){return(0,t.isFinite)(p)||(p=null),(0,r.cN)(this.valueFormater(p,this.decimals))}isMsResolutionNeeded(){for(let p=0;p<this.datapoints.length;p++)if(this.datapoints[p][1]!==null&&this.datapoints[p][1]!==void 0){const c=this.datapoints[p][1].toString();if(c.length===13&&c%1e3!==0)return!0}return!1}hideFromLegend(p){return!!(p.hideEmpty&&this.allIsNull||!this.legend||p.hideZero&&this.allIsZero)}setColor(p){this.color=p,this.bars.fillColor=p}}},6262:(G,I,e)=>{"use strict";e.d(I,{G:()=>r});var t=e(40672),n=e(32264);const s=n.$.bootData.settings.cspReportOnlyEnabled,r={createHTML:(o,m,l)=>s?(console.error("[HTML not sanitized with Trusted Types]",o,m,l),o):o.replace(/<script/gi,"&lt;script"),createScript:o=>o,createScriptURL:(o,m,l)=>s?(console.error("[ScriptURL not sanitized with Trusted Types]",o,m,l),o):t.sQ.sanitizeUrl(o)};n.$.bootData.settings.trustedTypesDefaultPolicyEnabled&&window.trustedTypes&&window.trustedTypes.createPolicy&&window.trustedTypes.createPolicy("default",r)},96378:(G,I,e)=>{"use strict";e.d(I,{N:()=>i,e:()=>u});var t=e(96540),n=e(70255),s=e(60578),r=e(3591),o=e(32264),m=e(10096),l=e(34295);const i=({children:d,value:p})=>{const[c,y]=(0,t.useState)(p);return(0,t.useEffect)(()=>{const f=m.lE.subscribe(r.E8,P=>{o.$.theme2=P.payload,y(P.payload)});return()=>f.unsubscribe()},[]),t.createElement(s.D.Provider,{value:c},t.createElement(n.z,{baseColor:c.colors.emphasize(c.colors.background.secondary),highlightColor:c.colors.emphasize(c.colors.background.secondary,.1),borderRadius:c.shape.radius.default},d))},u=(d,p)=>function(y){return t.createElement(i,{value:p},t.createElement(d,{...y}))}},67278:(G,I,e)=>{"use strict";e.d(I,{c:()=>t});class t extends window.Worker{constructor(s,r){const o=s.toString(),m=o.split("/");m.pop();const l=`${m.join("/")}/`,i=`importScripts('${o}');`,u=URL.createObjectURL(new Blob([`__webpack_worker_public_path__ = '${l}'; ${i}`],{type:"application/javascript"}));super(u,r),URL.revokeObjectURL(u)}}},80714:(G,I,e)=>{"use strict";e.d(I,{F:()=>t});function t(n={}){return{...n,accesscontrol:!0}}},94041:(G,I,e)=>{"use strict";e.d(I,{b:()=>t});const t=(n,s,r)=>(n.splice(r,0,n.splice(s,1)[0]),n)},92315:(G,I,e)=>{"use strict";e.d(I,{W:()=>t,m:()=>n});function t(){const s=document.cookie.split("; ").find(o=>o.startsWith("grafana_session_expiry="));if(!s)return 0;let r=s.split("=").at(1);return r?parseInt(r,10):0}function n(){return document.cookie.split("; ").findIndex(s=>s.startsWith("grafana_session_expiry="))>-1}},63917:(G,I,e)=>{"use strict";e.d(I,{gn:()=>s});function t(){const r=navigator.userAgent.indexOf("MSIE")>-1,o=navigator.userAgent.indexOf("Edge/")>-1||navigator.userAgent.indexOf("Edg/")>-1,m=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,l=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),i=/Edge\/([0-9.]+)/.exec(navigator.userAgent);return r&&parseFloat(/Trident\/([0-9.]+)/.exec(navigator.userAgent)[1])<=7||o&&(i&&parseFloat(i[1])<=16||parseFloat(/Edg\/([0-9.]+)/.exec(navigator.userAgent)[1])<=16)||m&&parseFloat(/Firefox\/([0-9.]+)/.exec(navigator.userAgent)[1])<=64?!1:!(l&&parseFloat(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1])<=54)}function n(){return/(iPhone|iPad|Mac)/.test(navigator.platform)}function s(){return n()?"\u2318":"ctrl"}},34525:(G,I,e)=>{"use strict";e.d(I,{TS:()=>s});class t{_linkTo(l,i){i<=0&&l.inputEdges.push(this),i>=0&&l.outputEdges.push(this),l.edges.push(this)}link(l,i){if(!l)throw Error("inputNode is required");if(!i)throw Error("outputNode is required");return this.unlink(),this.inputNode=l,this.outputNode=i,this._linkTo(l,1),this._linkTo(i,-1),this}unlink(){let l;const i=this.inputNode,u=this.outputNode;i&&u&&(l=i.edges.indexOf(this),l>-1&&i.edges.splice(l,1),l=u.edges.indexOf(this),l>-1&&u.edges.splice(l,1),l=i.outputEdges.indexOf(this),l>-1&&i.outputEdges.splice(l,1),l=u.inputEdges.indexOf(this),l>-1&&u.inputEdges.splice(l,1))}}class n{constructor(l){this.name=l,this.edges=[],this.inputEdges=[],this.outputEdges=[]}getEdgeFrom(l){return l?typeof l=="object"?this.inputEdges.find(i=>i.inputNode?.name===l.name):this.inputEdges.find(i=>i.inputNode?.name===l):null}getEdgeTo(l){return l?typeof l=="object"?this.outputEdges.find(i=>i.outputNode?.name===l.name):this.outputEdges.find(i=>i.outputNode?.name===l):null}getOptimizedInputEdges(){const l=[];return this.inputEdges.forEach(i=>{i.inputNode?.inputEdges.map(d=>d.inputNode)?.forEach(d=>{const p=d?.getEdgeTo(this.name);p&&l.push(p)})}),this.inputEdges.filter(i=>l.indexOf(i)===-1)}}class s{constructor(){this.nodes={}}createNode(l){const i=new n(l);return this.nodes[l]=i,i}createNodes(l){const i=[];return l.forEach(u=>{i.push(this.createNode(u))}),i}link(l,i){let u=[],d=[];const p=[],c=[];l instanceof Array?u=l:u=[l],i instanceof Array?d=i:d=[i];for(let f=0;f<u.length;f++){const P=u[f];if(typeof P=="string"){const a=this.getNode(P);if(!a)throw Error(`cannot link input node named ${P} since it doesn't exist in graph`);p.push(a)}else p.push(P)}for(let f=0;f<d.length;f++){const P=d[f];if(typeof P=="string"){const a=this.getNode(P);if(!a)throw Error(`cannot link output node named ${P} since it doesn't exist in graph`);c.push(a)}else c.push(P)}const y=[];return p.forEach(f=>{c.forEach(P=>{y.push(this.createEdge().link(f,P))})}),y}descendants(l){if(!l.length)return new Set;const i=new Set(o(l)?l.map(u=>this.nodes[u]).filter(u=>u!==void 0):l);return this.descendantsRecursive(i)}descendantsRecursive(l,i=new Set){for(const u of l){const d=new Set;for(const{inputNode:p}of u.inputEdges)p&&!i.has(p)&&(i.add(p),d.add(p));this.descendantsRecursive(d,i)}return i}createEdge(){return new t}getNode(l){return this.nodes[l]}}const r=m=>{Object.keys(m.nodes).forEach(l=>{const i=m.nodes[l];let u=i.outputEdges.map(p=>p.outputNode?.name).join(", ");u||(u="<none>");let d=i.inputEdges.map(p=>p.inputNode?.name).join(", ");d||(d="<none>"),console.log(`${i.name}:
 - links to:   ${u}
 - links from: ${d}`)})};function o(m){return m.length>0&&typeof m[0]=="string"}},94954:(G,I,e)=>{"use strict";e.d(I,{q:()=>n});var t=e(17172);function n(s){if(typeof s=="string")return s;if(s){if(s instanceof Error)return s.message;if((0,t.NF)(s)){if(s.data&&s.data.message)return s.data.message;if(s.statusText)return s.statusText}}return JSON.stringify(s)}},87490:(G,I,e)=>{"use strict";e.d(I,{HQ:()=>g,Ll:()=>b,MA:()=>O,WP:()=>f,Xe:()=>v,_u:()=>w,bI:()=>T,dY:()=>U,di:()=>A,dr:()=>h,eF:()=>M,o$:()=>D,uE:()=>N,uJ:()=>V,uq:()=>C,w4:()=>S,zT:()=>B,zq:()=>W});var t=e(44329),n=e(62938),s=e(52622),r=e(76885),o=e(41987),m=e(43127),l=e(77789),i=e(65879),u=e(19347),d=e(11134),p=e(33390),c=e(66718);const y={dedupStrategy:s.fY.none},f="0123456789abcdefghijklmnopqrstuvwxyz",P=(0,t.d_)(f,3),a="grafana.explore.datasource",E=K=>`${a}.${K}`,g=K=>p.A.getObject(E(K)),h=(K,k)=>p.A.setObject(E(K),k);function D(){for(;;){const K=P(3);if(!/^\d+$/.test(K))return K}}async function v(K){const{queries:k,dsRef:j,timeRange:H,scopedVars:J,adhocFilters:X}=K,se=(await Promise.allSettled(k.filter(ne=>ne.datasource?.uid!==c.Uj).map(async ne=>{const q=await(0,u.l)().get(ne.datasource||j);return{...q.interpolateVariablesInQueries?.([ne],J??{},X)[0]||ne,...!q.meta.mixed&&{datasource:q.getRef()}}}))).filter(ne=>ne.status==="fulfilled").map(ne=>ne.value),ae=JSON.stringify({[D()]:{range:(0,r.sQ)(H.raw),queries:se,datasource:j?.uid}});return r.kM.renderUrl("/explore",{panes:ae,schemaVersion:1})}function C(K){return`explore_${K}`}function T(K,k,j,H,J,X,se){const ae=Number.parseInt(K,36),{interval:ne,intervalMs:q}=L(H,j.minInterval,j.maxDataPoints),ee={app:o.Jk.Explore,timezone:X||m.lE,startTime:Date.now(),interval:ne,intervalMs:q,panelId:ae,targets:k,range:H,requestId:C(K),rangeRaw:H.raw,scopedVars:{__interval:{text:ne,value:ne},__interval_ms:{text:q,value:q},...se},maxDataPoints:j.maxDataPoints,liveStreaming:j.liveStreaming,skipQueryCache:!0};return{queries:k,request:ee,scanning:J,id:x(),done:!1}}const S=({key:K,...k})=>k,O=(K,k)=>{if(K==null)return"";try{return JSON.stringify(K,null,k)}catch(j){console.error(j)}return""};function x(K=0){return`Q-${(0,n.A)()}-${K}`}async function b(K,k=0,j){let H,J,X;return j?J=j:K.length>0&&K[K.length-1].datasource?J=K[K.length-1].datasource:(H=await(0,u.l)().get(),X=H.getDefaultQuery?.(o.Jk.Explore),J=H.getRef()),H||(H=await(0,u.l)().get(J),X=H.getDefaultQuery?.(o.Jk.Explore)),{...X,refId:(0,l.M)(K),key:x(k),datasource:J}}const M=(K,k,j=0)=>{const H=x(j),J=K.refId||(0,l.M)(k);return{...K,refId:J,key:H}};async function A(K,k){if(K&&typeof K=="object"&&K.length>0){const j=[];for(let H=0;H<K.length;H++){const J=K[H],X=x(H);let se=J.refId;se||(se=(0,l.M)(j));let ae=!0;if(J.datasource)try{await(0,u.l)().get(J.datasource.uid)}catch{console.error("One of the queries has a datasource that is no longer available and was removed."),ae=!1}ae&&j.push({...J,refId:se,key:X})}return j}try{const j=k??(await(0,u.l)().get()).getRef();return[await b(K??[],void 0,j)]}catch{return[]}}const R=["refId","key","context","datasource"];function B(K){return K&&K.some(k=>Object.entries(k).filter(([H,J])=>R.indexOf(H)===-1).filter(([H,J])=>J).length>0)}const U=K=>K.reduce((j,H,J)=>{const X=H.datasource?.uid||H.key;return j.concat(`${X}-${J}`)},[]),W=(K,k,j)=>i.convertRawToRange(k,K,j),N=K=>d.cC.isLive(K)?s.uH.Ascending:s.uH.Descending,w=K=>{K&&K.unsubscribe()};function L(K,k,j){return j?i.calculateInterval(K,j,k):{interval:"1s",intervalMs:1e3}}const V=K=>{if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(K);else{const k=document.createElement("textarea");k.value=K,document.body.appendChild(k),k.select(),document.execCommand("copy"),document.body.removeChild(k)}}},78827:(G,I,e)=>{"use strict";e.r(I),e.d(I,{default:()=>t});function t(n,s){s=s||{};const r=s.delimiter||".";let o=s.maxDepth||3,m=1;const l={};function i(u,d){Object.entries(u).forEach(([p,c])=>{const y=s?.safe&&Array.isArray(c),P=Object.prototype.toString.call(c)==="[object Object]",a=d?d+r+p:p;if(s?.maxDepth||(o=m+1),!y&&P&&Object.keys(c).length&&m<o)return++m,i(c,a);l[a]=c})}return i(n,null),l}},68576:(G,I,e)=>{"use strict";e.d(I,{A:()=>l});var t=e(95344),n=e(54479),s=e(65879),r=e(83195);const m={valueFormats:{},intervalRegex:/(\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,intervalsInSeconds:{y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001},regexEscape:i=>((0,t.l)("kbn.ts","kbn.regexEscape()","escapeRegex from @grafana/data"),(0,n.$f)(i)),roundInterval:i=>((0,t.l)("kbn.ts","kbn.roundInterval()","@grafana/data"),s.roundInterval(i)),secondsToHms:i=>((0,t.l)("kbn.ts","kbn.secondsToHms()","@grafana/data"),s.secondsToHms(i)),secondsToHhmmss:i=>{const u=[],d=Math.floor(i/3600),p=Math.floor(i%3600/60),c=Math.floor(i%3600%60);return d>9?u.push(""+d):u.push("0"+d),p>9?u.push(""+p):u.push("0"+p),c>9?u.push(""+c):u.push("0"+c),u.join(":")},toPercent:(i,u)=>Math.floor(i/u*1e4)/100+"%",addSlashes:i=>i.replace(/[\'\"\\0]/g,"\\$&"),describeInterval:i=>((0,t.l)("kbn.ts","kbn.describeInterval()","@grafana/data"),s.describeInterval(i)),intervalToSeconds:i=>((0,t.l)("kbn.ts","rangeUtil.intervalToSeconds()","@grafana/data"),s.intervalToSeconds(i)),intervalToMs:i=>((0,t.l)("kbn.ts","rangeUtil.intervalToMs()","@grafana/data"),s.intervalToMs(i)),calculateInterval:(i,u,d)=>((0,t.l)("kbn.ts","kbn.calculateInterval()","@grafana/data"),s.calculateInterval(i,u,d)),queryColorDot:(i,u)=>'<div class="icon-circle" style="'+["display:inline-block","color:"+i,"font-size:"+u+"px"].join(";")+'"></div>',slugifyForUrl:i=>i.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),stringToJsRegex:i=>((0,t.l)("kbn.ts","kbn.stringToJsRegex()","@grafana/data"),(0,n.dO)(i)),toFixed:(i,u)=>{if(i===null)return"";const d=u?Math.pow(10,Math.max(0,u)):1,p=String(Math.round(i*d)/d);if(p.indexOf("e")!==-1||i===0)return p;if(u!=null){const c=p.indexOf("."),y=c===-1?0:p.length-c-1;if(y<u)return(y?p:p+".")+String(d).slice(1,u-y+1)}return p},toFixedScaled:(i,u,d,p,c)=>d===null?m.toFixed(i,u)+c:m.toFixed(i,d+p)+c,roundValue:(i,u)=>{if(i===null)return null;const d=Math.pow(10,u),p=(d*i).toFixed(u);return Math.round(parseFloat(p))/d},getUnitFormats:r.Ke};typeof Proxy<"u"?m.valueFormats=new Proxy(m.valueFormats,{get(i,u,d){if(typeof u!="string")throw{message:`Value format ${String(u)} is not a string`};const p=(0,r.j_)(u);return p?(c,y,f,P)=>(0,r.cN)(p(c,y,f,P?"utc":"browser")):Reflect.get(i,u,d)}}):m.valueFormats=(0,r.uH)();const l=m},78160:(G,I,e)=>{"use strict";e.d(I,{j:()=>n,z:()=>s});var t=e(42614);function n(r){if(!(!performance||!performance.mark))try{performance.mark(`${r}_started`)}catch(o){console.error(`[Metrics] Failed to startMeasure ${r}`,o)}}function s(r){if(!(!performance||!performance.mark))try{const o=`${r}_started`,m=`${r}_completed`,l=`${r}_measured`;performance.mark(m);const i=performance.measure(l,o,m);return(0,t.n)(`${r}_ms`,i.duration),performance.clearMarks(o),performance.clearMarks(m),performance.clearMeasures(l),i}catch(o){console.error(`[Metrics] Failed to stopMeasure ${r}`,o);return}}},36689:(G,I,e)=>{"use strict";e.d(I,{C:()=>n,o:()=>s});var t=e(8484);function n(r){switch(r){case"home":return(0,t.t)("nav.home.title","Home");case"new":return(0,t.t)("nav.new.title","New");case"create":return(0,t.t)("nav.create.title","Create");case"create-dashboard":return(0,t.t)("nav.create-dashboard.title","Dashboard");case"folder":return(0,t.t)("nav.create-folder.title","Folder");case"import":return(0,t.t)("nav.create-import.title","Import dashboard");case"alert":return(0,t.t)("nav.create-alert.title","New alert rule");case"starred":return(0,t.t)("nav.starred.title","Starred");case"starred-empty":return(0,t.t)("nav.starred-empty.title","Your starred dashboards will appear here");case"dashboards":return(0,t.t)("nav.dashboards.title","Dashboards");case"dashboards/browse":return(0,t.t)("nav.dashboards.title","Dashboards");case"dashboards/playlists":return(0,t.t)("nav.playlists.title","Playlists");case"dashboards/snapshots":return(0,t.t)("nav.snapshots.title","Snapshots");case"dashboards/library-panels":return(0,t.t)("nav.library-panels.title","Library panels");case"reports":return(0,t.t)("nav.reporting.title","Reporting");case"dashboards/public":return(0,t.t)("nav.public.title","Public dashboards");case"dashboards/recentlyDeleted":return(0,t.t)("nav.recentlyDeleted.title","Recently Deleted");case"dashboards/new":return(0,t.t)("nav.new-dashboard.title","New dashboard");case"dashboards/folder/new":return(0,t.t)("nav.new-folder.title","New folder");case"dashboards/import":return(0,t.t)("nav.create-import.title","Import dashboard");case"scenes":return(0,t.t)("nav.scenes.title","Scenes");case"explore":return(0,t.t)("nav.explore.title","Explore");case"alerting":return(0,t.t)("nav.alerting.title","Alerting");case"plugin-page-grafana-oncall-app":return(0,t.t)("nav.oncall.title","OnCall");case"alerting-legacy":return(0,t.t)("nav.alerting-legacy.title","Alerting (legacy)");case"alerting-upgrade":return(0,t.t)("nav.alerting-upgrade.title","Alerting upgrade");case"alert-home":return(0,t.t)("nav.alerting-home.title","Home");case"alert-list":return(0,t.t)("nav.alerting-list.title","Alert rules");case"alert-list-legacy":return(0,t.t)("nav.alert-list-legacy.title","Alert rules");case"receivers":return(0,t.t)("nav.alerting-receivers.title","Contact points");case"am-routes":return(0,t.t)("nav.alerting-am-routes.title","Notification policies");case"channels":return(0,t.t)("nav.alerting-channels.title","Notification channels");case"silences":return(0,t.t)("nav.alerting-silences.title","Silences");case"groups":return(0,t.t)("nav.alerting-groups.title","Groups");case"alerting-admin":return(0,t.t)("nav.alerting-admin.title","Settings");case"cfg":return(0,t.t)("nav.config.title","Administration");case"cfg/general":return(0,t.t)("nav.config-general.title","General");case"cfg/plugins":return(0,t.t)("nav.config-plugins.title","Plugins and data");case"cfg/access":return(0,t.t)("nav.config-access.title","Users and access");case"datasources":return(0,t.t)("nav.datasources.title","Data sources");case"authentication":return(0,t.t)("nav.authentication.title","Authentication");case"licensing":return(0,t.t)("nav.statistics-and-licensing.title","Statistics and licensing");case"recordedQueries":return(0,t.t)("nav.recorded-queries.title","Recorded queries");case"correlations":return(0,t.t)("nav.correlations.title","Correlations");case"users":return(0,t.t)("nav.users.title","Users");case"teams":return(0,t.t)("nav.teams.title","Teams");case"plugins":return(0,t.t)("nav.plugins.title","Plugins");case"org-settings":return(0,t.t)("nav.org-settings.title","Default preferences");case"apikeys":return(0,t.t)("nav.api-keys.title","API keys");case"serviceaccounts":return(0,t.t)("nav.service-accounts.title","Service accounts");case"admin":return(0,t.t)("nav.admin.title","Server admin");case"support-bundles":return(0,t.t)("nav.support-bundles.title","Support bundles");case"global-users":return(0,t.t)("nav.global-users.title","Users");case"global-orgs":return(0,t.t)("nav.global-orgs.title","Organizations");case"server-settings":return(0,t.t)("nav.server-settings.title","Settings");case"storage":return(0,t.t)("nav.storage.title","Storage");case"migrate-to-cloud":return(0,t.t)("nav.migrate-to-cloud.title","Migrate to Grafana Cloud");case"upgrading":return(0,t.t)("nav.upgrading.title","Stats and license");case"monitoring":return(0,t.t)("nav.monitoring.title","Observability");case"infrastructure":return(0,t.t)("nav.infrastructure.title","Infrastructure");case"frontend":return(0,t.t)("nav.frontend.title","Frontend");case"apps":return(0,t.t)("nav.apps.title","Apps");case"alerts-and-incidents":return(0,t.t)("nav.alerts-and-incidents.title","Alerts & IRM");case"testing-and-synthetics":return(0,t.t)("nav.testing-and-synthetics.title","Testing & synthetics");case"plugin-page-grafana-incident-app":return(0,t.t)("nav.incidents.title","Incidents");case"plugin-page-grafana-ml-app":return(0,t.t)("nav.machine-learning.title","Machine learning");case"plugin-page-grafana-slo-app":return(0,t.t)("nav.slo.title","SLO");case"plugin-page-k6-app":return(0,t.t)("nav.k6.title","Performance");case"monitoring":return(0,t.t)("nav.observability.title","Observability");case"plugin-page-grafana-k8s-app":return(0,t.t)("nav.kubernetes.title","Kubernetes");case"plugin-page-grafana-app-observability-app":return(0,t.t)("nav.application.title","Application");case"plugin-page-grafana-pyroscope-app":return(0,t.t)("nav.profiles.title","Profiles");case"plugin-page-grafana-kowalski-app":return(0,t.t)("nav.frontend-app.title","Frontend");case"plugin-page-grafana-synthetic-monitoring-app":return(0,t.t)("nav.synthetics.title","Synthetics");case"help":return(0,t.t)("nav.help.title","Help");case"profile/settings":return(0,t.t)("nav.profile/settings.title","Profile");case"profile/notifications":return(0,t.t)("nav.profile/notifications.title","Notification history");case"profile/password":return(0,t.t)("nav.profile/password.title","Change password");case"sign-out":return(0,t.t)("nav.sign-out.title","Sign out");case"search":return(0,t.t)("nav.search-dashboards.title","Search dashboards");case"connections":return(0,t.t)("nav.connections.title","Connections");case"connections-add-new-connection":return(0,t.t)("nav.add-new-connections.title","Add new connection");case"standalone-plugin-page-/connections/collector":return(0,t.t)("nav.collector.title","Collector");case"connections-datasources":return(0,t.t)("nav.data-sources.title","Data sources");case"standalone-plugin-page-/connections/infrastructure":return(0,t.t)("nav.integrations.title","Integrations");case"standalone-plugin-page-/connections/connect-data":return(0,t.t)("nav.connect-data.title","Connect data");case"standalone-plugin-page-/connections/private-data-source-connections":return(0,t.t)("nav.private-data-source-connections.title","Private data source connect");case"plugin-page-grafana-detect-app":return(0,t.t)("nav.detect.title","Detect");case"plugin-page-grafana-quaderno-app":return(0,t.t)("nav.grafana-quaderno.title","Grafana Quaderno");default:return}}function s(r){switch(r){case"dashboards":return(0,t.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"dashboards/browse":return(0,t.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"manage-folder":return(0,t.t)("nav.manage-folder.subtitle","Manage folder dashboards and permissions");case"dashboards/playlists":return(0,t.t)("nav.playlists.subtitle","Groups of dashboards that are displayed in a sequence");case"dashboards/snapshots":return(0,t.t)("nav.snapshots.subtitle","Interactive, publically available, point-in-time representations of dashboards");case"dashboards/library-panels":return(0,t.t)("nav.library-panels.subtitle","Reusable panels that can be added to multiple dashboards");case"dashboards/recentlyDeleted":return(0,t.t)("nav.recentlyDeleted.subtitle","Any items listed here for more than 30 days will be automatically deleted.");case"alerting":return(0,t.t)("nav.alerting.subtitle","Learn about problems in your systems moments after they occur");case"alerting-upgrade":return(0,t.t)("nav.alerting-upgrade.subtitle","Upgrade your existing legacy alerts and notification channels to the new Grafana Alerting");case"alerting-admin":return(0,t.t)("nav.alerting-admin.subtitle","Manage Alertmanager configurations");case"alert-list":return(0,t.t)("nav.alerting-list.subtitle","Rules that determine whether an alert will fire");case"receivers":return(0,t.t)("nav.alerting-receivers.subtitle","Choose how to notify your contact points when an alert instance fires");case"am-routes":return(0,t.t)("nav.alerting-am-routes.subtitle","Determine how alerts are routed to contact points");case"silences":return(0,t.t)("nav.alerting-silences.subtitle","Stop notifications from one or more alerting rules");case"groups":return(0,t.t)("nav.alerting-groups.subtitle","See grouped alerts from an Alertmanager instance");case"datasources":return(0,t.t)("nav.datasources.subtitle","Add and configure data sources");case"correlations":return(0,t.t)("nav.correlations.subtitle","Add and configure correlations");case"users":return(0,t.t)("nav.users.subtitle","Invite and assign roles to users");case"teams":return(0,t.t)("nav.teams.subtitle","Groups of users that have common dashboard and permission needs");case"plugins":return(0,t.t)("nav.plugins.subtitle","Extend the Grafana experience with plugins");case"org-settings":return(0,t.t)("nav.org-settings.subtitle","Manage preferences across an organization");case"apikeys":return(0,t.t)("nav.api-keys.subtitle","Manage and create API keys that are used to interact with Grafana HTTP APIs");case"serviceaccounts":return(0,t.t)("nav.service-accounts.subtitle","Use service accounts to run automated workloads in Grafana");case"global-users":return(0,t.t)("nav.global-users.subtitle","Manage users in Grafana");case"global-orgs":return(0,t.t)("nav.global-orgs.subtitle","Isolated instances of Grafana running on the same server");case"server-settings":return(0,t.t)("nav.server-settings.subtitle","View the settings defined in your Grafana config");case"storage":return(0,t.t)("nav.storage.subtitle","Manage file storage");case"migrate-to-cloud":return(0,t.t)("nav.migrate-to-cloud.subtitle","Copy configuration from your self-managed installation to a cloud stack");case"support-bundles":return(0,t.t)("nav.support-bundles.subtitle","Download support bundles");case"admin":return(0,t.t)("nav.admin.subtitle","Manage server-wide settings and access to resources such as organizations, users, and licenses");case"cfg/general":return(0,t.t)("nav.config-general.subtitle","Manage default preferences and settings across Grafana");case"cfg/plugins":return(0,t.t)("nav.config-plugins.subtitle","Install plugins and define the relationships between data");case"cfg/access":return(0,t.t)("nav.config-access.subtitle","Configure access for individual users, teams, and service accounts");case"apps":return(0,t.t)("nav.apps.subtitle","App plugins that extend the Grafana experience");case"monitoring":return(0,t.t)("nav.monitoring.subtitle","Out-of-the-box observability solutions");case"infrastructure":return(0,t.t)("nav.infrastructure.subtitle","Understand your infrastructure's health");case"frontend":return(0,t.t)("nav.frontend.subtitle","Gain real user monitoring insights");case"alerts-and-incidents":return(0,t.t)("nav.alerts-and-incidents.subtitle","Alerting and incident management apps");case"testing-and-synthetics":return(0,t.t)("nav.testing-and-synthetics.subtitle","Optimize performance with k6 and Synthetic Monitoring insights");case"connections-add-new-connection":return(0,t.t)("nav.connections.subtitle","Browse and create new connections");case"connections-datasources":return(0,t.t)("nav.data-sources.subtitle","View and manage your connected data source connections");case"connections-private-data-source-connections":return(0,t.t)("nav.private-data-source-connections.subtitle","Query data that lives within a secured network without opening the network to inbound traffic from Grafana Cloud. Learn more in our docs.");default:return}}},28874:(G,I,e)=>{"use strict";e.d(I,{v:()=>s});var t=e(2543),n=e.n(t);function s(r){return(0,t.isArray)(r)?r.map(s):(0,t.isPlainObject)(r)?Object.keys(r).sort().reduce((o,m)=>{const l=r[m];return l!=null&&(o[m]=s(l)),o},{}):r}},21969:(G,I,e)=>{"use strict";e.d(I,{Ih:()=>n,Lr:()=>o,U7:()=>s,dr:()=>r,fE:()=>m});var t=e(77789);function n(l){const i=["refId","hide","key","queryType","datasource"];for(const u in l)if(u!=="label"&&!i.includes(u))return!1;return!0}function s(l,i,u){const d={...i,refId:(0,t.M)(l),hide:!1};return!d.datasource&&u&&(d.datasource=u),[...l,d]}function r(l){return l.indexOf("api/datasources/proxy")!==-1||l.indexOf("api/ds/query")!==-1}function o(l){return!l.match(/^http/)}function m(l){return l||void 0}},81523:(G,I,e)=>{"use strict";e.d(I,{Ax:()=>M,DI:()=>a,Gx:()=>g,IA:()=>S,NC:()=>C,TR:()=>R,U3:()=>T,X1:()=>h,cX:()=>v,ev:()=>x,l0:()=>P,oU:()=>D,rs:()=>E,x8:()=>A,xB:()=>f.x});var t=e(2543),n=e.n(t),s=e(76885),r=e(72724),o=e(19347),m=e(82467),l=e(3169),i=e(8484),u=e(99140),d=e(38877),p=e(75533),c=e(11401),y=e(16233),f=e(91650);async function P(U){const{queries:W,localOverride:N,datasource:w,starred:L,comment:V,showNotif:K}=U,k=K?.quotaExceededError??!0,j=K?.limitExceededWarning??!0,H=K?.otherErrors??!0,J=W&&W.filter(X=>B(X));if(J.length>0){let X=!1,se=!1,ae;try{ae=(await(N?(0,c.tU)():(0,c.a)()).addToRichHistory({datasourceUid:w.uid,datasourceName:w.name??"",queries:J,starred:L,comment:V??""})).warning}catch(ne){return ne instanceof Error&&(ne.name===d.m.StorageFull?(X=!0,k&&(0,u.JD)((0,m.dx)((0,l.gi)(ne.message)))):H&&ne.name!==d.m.DuplicatedEntry&&(0,u.JD)((0,m.dx)((0,l.gi)((0,i.t)("explore.rich-history-utils-notification.update-failed","Rich History update failed"),ne.message)))),{richHistoryStorageFull:X,limitExceeded:se}}return ae&&ae.type===d.C.LimitExceeded&&(se=!0,j&&(0,u.JD)((0,m.dx)((0,l.q8)(ae.message)))),{richHistoryStorageFull:X,limitExceeded:se}}return{}}async function a(U){const W={...U,from:U.to===void 0?U.to:(0,p.wQ)(U.to,{isLastTs:!0,tz:y.TP.user?.timezone}),to:U.from===void 0?U.from:(0,p.wQ)(U.from,{isLastTs:!0,tz:y.TP.user?.timezone})};return await(0,c.a)().getRichHistory(W)}async function E(U){await(0,c.a)().updateSettings(U)}async function g(){return await(0,c.a)().getSettings()}async function h(){return(0,c.a)().deleteAll()}async function D(U,W){try{return await(0,c.a)().updateStarred(U,W)}catch(N){N instanceof Error&&(0,u.JD)((0,m.dx)((0,l.gi)((0,i.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),N.message)));return}}async function v(U,W){try{return await(0,c.a)().updateComment(U,W)}catch(N){N instanceof Error&&(0,u.JD)((0,m.dx)((0,l.gi)((0,i.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),N.message)));return}}async function C(U){try{return await(0,c.a)().deleteRichHistory(U),U}catch(W){W instanceof Error&&(0,u.JD)((0,m.dx)((0,l.gi)((0,i.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),W.message)));return}}const T=U=>{const W={range:{from:(0,i.t)("explore.rich-history-utils.default-from","now-1h"),to:(0,i.t)("explore.rich-history-utils.default-to","now")},datasource:U.datasourceName,queries:U.queries},N=(0,s.Pp)(W),w=/.*(?=\/explore)/.exec(`${window.location.href}`)[0];return s.kM.renderUrl(`${w}/explore`,{left:N})},S=U=>{let W;switch(U){case 0:W=(0,i.t)("explore.rich-history-utils.today","today");break;case 1:W=(0,i.t)("explore.rich-history-utils.yesterday","yesterday");break;case 7:W=(0,i.t)("explore.rich-history-utils.a-week-ago","a week ago");break;case 14:W=(0,i.t)("explore.rich-history-utils.two-weeks-ago","two weeks ago");break;default:W=(0,i.t)("explore.rich-history-utils.days-ago","{{num}} days ago",{num:`${U}`})}return W};function O(U){return(0,r.LE)(U,{format:"MMMM D"})}function x(U){const W=(0,t.omit)(U,["key","refId","datasource"]);return JSON.stringify(W)}function b(U,W){let N="";return W===f.x.DatasourceAZ||W===f.x.DatasourceZA?N=U.datasourceName:N=O(U.createdAt),N}function M(U,W){return W?.getQueryDisplayText?W.getQueryDisplayText(U):x(U)}function A(U,W){let N={};return U.forEach(w=>{let L=b(w,W);L in N?N[L]=[...N[L],w]:N[L]=[w]}),N}function R(){return(0,o.l)().getList({mixed:!0}).map(U=>({name:U.name,uid:U.uid}))}function B(U){const W=(0,t.omit)(U,["key","refId","datasource"]);return Object.keys(W).length>0}},91650:(G,I,e)=>{"use strict";e.d(I,{x:()=>t});var t=(n=>(n.Descending="Descending",n.Ascending="Ascending",n.DatasourceAZ="Datasource A-Z",n.DatasourceZA="Datasource Z-A",n))(t||{})},7030:(G,I,e)=>{"use strict";e.d(I,{$l:()=>E,VN:()=>a,VP:()=>f,fn:()=>y,fv:()=>P});var t=e(41811),n=e(32264),s=e(17172),r=e(12131),o=e(16401),m=e(82467),l=e(3169),i=e(11982),u=e(99140),d=e(87490);function p(){return`${window.location.protocol}//${window.location.host}${n.$.appSubUrl}`}function c(g){let h=g.replace(p(),"");return h.startsWith("/")?h.substring(1,h.length):h}const y=(0,t.A)(async function(g){try{return(await(0,s.AI)().post("/api/short-urls",{path:c(g)})).url}catch(h){console.error("Error when creating shortened link: ",h),(0,u.JD)((0,m.dx)((0,l.gi)("Error generating shortened link")))}}),f=async g=>{const h=await y(g);h?((0,d.uJ)(h),(0,u.JD)((0,m.dx)((0,l.tZ)("Shortened link copied to clipboard")))):(0,u.JD)((0,m.dx)((0,l.gi)("Error generating shortened link")))},P=async(g,h,D)=>{const v=await a(g,h,D);await f(v)},a=async(g,h,D)=>{const v=r.Ny.getLocation(),C=o.jh.getTimeRange(D??g),T=E(h,C,D);return(0,i.uZ)({uid:g.state.uid,slug:g.state.meta.slug,currentQueryParams:v.search,updateQuery:T,absolute:!0})},E=(g,h,D)=>{const v={};return D&&(v.viewPanel=D.state.key),g.useAbsoluteTimeRange&&(v.from=h.state.value.from.toISOString(),v.to=h.state.value.to.toISOString()),g.theme!=="current"&&(v.theme=g.theme),v}},92247:(G,I,e)=>{"use strict";e.r(I),e.d(I,{getPrecision:()=>o,getScaledDecimals:()=>n,getStringPrecision:()=>m,grafanaTimeFormat:()=>s,logp:()=>r,tickStep:()=>t});function t(l,i,u){const d=Math.sqrt(50),p=Math.sqrt(10),c=Math.sqrt(2),y=Math.abs(i-l)/Math.max(0,u);let f=Math.pow(10,Math.floor(Math.log(y)/Math.LN10));const P=y/f;return P>=d?f*=10:P>=p?f*=5:P>=c&&(f*=2),i<l?-f:f}function n(l,i){return l-Math.floor(Math.log(i)/Math.LN10)}function s(l,i,u){if(i&&u&&l){const d=u-i,p=d/l/1e3,c=864e5,y=31536e6;return p<=45?"HH:mm:ss":p<=7200||d<=c?"HH:mm":p<=8e4?"MM/DD HH:mm":p<=2419200||d<=y?"MM/DD":"YYYY-MM"}return"HH:mm"}function r(l,i){return Math.log(l)/Math.log(i)}function o(l){const i=l.toString();return m(i)}function m(l){if(isNaN(l))return 0;const i=l.indexOf(".");return i===-1?0:l.length-i-1}},80582:(G,I,e)=>{"use strict";e.d(I,{Wb:()=>n,Zk:()=>s,zG:()=>r});var t=e(47232);const n=(o,m)=>{const l={from:(0,t.yT)(m.from),to:(0,t.yT)(m.to)},i=(l.to.valueOf()-l.from.valueOf())/2;let u,d;return o===-1?(u=l.to.valueOf()-i,d=l.from.valueOf()-i):o===1?(u=l.to.valueOf()+i,d=l.from.valueOf()+i,u>Date.now()&&l.to.valueOf()<Date.now()&&(u=Date.now(),d=l.from.valueOf())):(u=l.to.valueOf(),d=l.from.valueOf()),{from:d,to:u}},s=(o,m)=>{const l=o.to.valueOf()-o.from.valueOf(),i=o.to.valueOf()-l/2,u=l===0?3e4:l*m,d=i+u/2;return{from:i-u/2,to:d}};async function r(){const o=await navigator.clipboard.readText();let m;try{return m=JSON.parse(o),!m.from||!m.to?{range:o,isError:!0}:{range:m,isError:!1}}catch{return{range:o,isError:!0}}}},94515:(G,I,e)=>{"use strict";e.d(I,{iU:()=>n});var t=e(47232);function n(o,m){if(!(o.fromDayOfWeek||o.from)&&!(o.toDayOfWeek||o.to))return[];const l={...o};l.from&&!l.to&&(l.to=l.from),!l.from&&l.to&&(l.from=l.to);const i={from:s(l.from),to:s(l.to)};if(!l.fromDayOfWeek&&l.toDayOfWeek&&(l.fromDayOfWeek=l.toDayOfWeek),!l.toDayOfWeek&&l.fromDayOfWeek&&(l.toDayOfWeek=l.fromDayOfWeek),l.fromDayOfWeek&&(i.from.dayOfWeek=Number(l.fromDayOfWeek)),l.toDayOfWeek&&(i.to.dayOfWeek=Number(l.toDayOfWeek)),i.from.dayOfWeek&&i.from.h==null&&i.from.m==null&&(i.from.h=0,i.from.m=0,i.from.s=0),i.to.dayOfWeek&&i.to.h==null&&i.to.m==null&&(i.to.h=23,i.to.m=59,i.to.s=59),!i.from||!i.to)return[];i.from.h==null&&(i.from.h=0),i.to.h==null&&(i.to.h=23);const u=[],d=(0,t.KQ)(m.from).utc();for(d.set("hour",0),d.set("minute",0),d.set("second",0),d.set("millisecond",0),d.add(i.from.h,"hours"),d.add(i.from.m,"minutes"),d.add(i.from.s,"seconds");d.unix()<=m.to.unix();){for(;i.from.dayOfWeek&&i.from.dayOfWeek!==d.isoWeekday();)d.add(24,"hours");if(d.unix()>m.to.unix())break;const p=(0,t.KQ)(d).utc();if(p.hour)if(i.from.h<=i.to.h)p.add(i.to.h-i.from.h,"hours");else if(i.from.h>i.to.h)for(;p.hour()!==i.to.h;)p.add(1,"hours");else for(p.add(24-i.from.h,"hours");p.hour()!==i.to.h;)p.add(1,"hours");for(p.set("minute",i.to.m??0),p.set("second",i.to.s??0);i.to.dayOfWeek&&i.to.dayOfWeek!==p.isoWeekday();)p.add(24,"hours");d.unix()<m.from.unix()&&p.unix()<m.from.unix()||d.unix()>m.to.unix()&&p.unix()>m.to.unix()||u.push({from:d.valueOf(),to:p.valueOf()}),d.add(24,"hours")}return u}function s(o){const m={};if(!o?.length)return m;const l=o.split(":");return l?.length&&(m.h=Math.min(23,Math.max(0,Number(l[0]))),l.length>1&&(m.m=Math.min(60,Math.max(0,Number(l[1]))),l.length>2&&(m.s=Math.min(60,Math.max(0,Number(l[2])))))),m}function r(o){if(!o||o.h==null&&o.m==null&&o.s==null)return"";let m=String(o.h??0).padStart(2,"0")+":"+String(o.m??0).padStart(2,"0");return o.s!=null&&(m+=String(o.s??0).padStart(2,"0")),m}},67027:(G,I,e)=>{"use strict";e.d(I,{r:()=>n});let t="";const n=()=>{const r=new URLSearchParams(window.location.search).get("auth_token");return r!==null&&r!==""?(t=r,r):t}},5133:(G,I,e)=>{"use strict";e.d(I,{r:()=>m});var t=e(96540),n=e(62625),s=e(21594);const o=Object.values(n.X).filter(l=>l!==n.X.None).map(l=>({label:l,value:l}));function m({value:l,onChange:i,"aria-label":u,inputId:d,autoFocus:p,...c}){return t.createElement(s.l6,{inputId:d,value:l,options:o,onChange:y=>i(y.value??n.X.None),placeholder:"Choose role...","aria-label":u,autoFocus:p,...c})}},57334:(G,I,e)=>{"use strict";e.d(I,{$u:()=>V,A5:()=>X,Bc:()=>se,DX:()=>B,JI:()=>A,Jc:()=>U,Kg:()=>R,MV:()=>a,N6:()=>h,P3:()=>C,Pi:()=>T,T$:()=>O,TK:()=>f,VR:()=>x,Vk:()=>k,hG:()=>g,hU:()=>N,is:()=>ae,kz:()=>c,ly:()=>P,mI:()=>M,nM:()=>L,nh:()=>v,nr:()=>E,pm:()=>b,xq:()=>H,yd:()=>K});var t=e(2543),n=e.n(t),s=e(72724),r=e(33378),o=e(17172),m=e(12131),l=e(2913),i=e(10096),u=e(80714),d=e(31678),p=e(44672);function c(ne){return async q=>{try{q((0,p.D1)(!1)),await q(y(ne)),await q(D(ne)),await q(S(ne)),l.Ay.ldapEnabled&&(0,r.a)("ldapsync")&&await q(b()),q((0,p.D1)(!0))}catch(ee){if(console.error(ee),(0,o.NF)(ee)){const z={title:ee.data.message,body:ee.data.error};q((0,p.PV)(z))}}}}function y(ne){return async q=>{const ee=await(0,o.AI)().get(`/api/users/${ne}`,(0,u.F)());q((0,p.G_)(ee))}}function f(ne){return async q=>{await(0,o.AI)().put(`/api/users/${ne.id}`,ne),q(c(ne.id))}}function P(ne,q){return async ee=>{const z={password:q};await(0,o.AI)().put(`/api/admin/users/${ne}/password`,z),ee(c(ne))}}function a(ne){return async q=>{await(0,o.AI)().post(`/api/admin/users/${ne}/disable`),m.Ny.push("/admin/users")}}function E(ne){return async q=>{await(0,o.AI)().post(`/api/admin/users/${ne}/enable`),q(c(ne))}}function g(ne){return async q=>{await(0,o.AI)().delete(`/api/admin/users/${ne}`),m.Ny.push("/admin/users")}}function h(ne,q){return async ee=>{const z={isGrafanaAdmin:q};await(0,o.AI)().put(`/api/admin/users/${ne}/permissions`,z),ee(c(ne))}}function D(ne){return async q=>{const ee=await(0,o.AI)().get(`/api/users/${ne}/orgs`);q((0,p.OF)(ee))}}function v(ne,q,ee){return async z=>{const te={loginOrEmail:ne.login,role:ee};await(0,o.AI)().post(`/api/orgs/${q}/users/`,te),z(c(ne.id))}}function C(ne,q,ee){return async z=>{const te={role:ee};await(0,o.AI)().patch(`/api/orgs/${q}/users/${ne}`,te),z(c(ne))}}function T(ne,q){return async ee=>{await(0,o.AI)().delete(`/api/orgs/${q}/users/${ne}`),ee(c(ne))}}function S(ne){return async q=>{if(!i.TP.hasPermission(d.AccessControlAction.UsersAuthTokenList))return;const ee=await(0,o.AI)().get(`/api/admin/users/${ne}/auth-tokens`);ee.reverse();const z=ee.map(te=>({id:te.id,isActive:te.isActive,seenAt:(0,s.fq)(te.seenAt),createdAt:te.createdAt,clientIp:te.clientIp,browser:te.browser,browserVersion:te.browserVersion,os:te.os,osVersion:te.osVersion,device:te.device}));q((0,p.ag)(z))}}function O(ne,q){return async ee=>{const z={authTokenId:ne};await(0,o.AI)().post(`/api/admin/users/${q}/revoke-auth-token`,z),ee(S(q))}}function x(ne){return async q=>{await(0,o.AI)().post(`/api/admin/users/${ne}/logout`),q(S(ne))}}function b(){return async ne=>{const q=i.TP.hasPermission(d.AccessControlAction.LDAPStatusRead);if((0,r.a)("ldapsync")&&q){const ee=await(0,o.AI)().get("/api/admin/ldap-sync-status");ne((0,p.OR)(ee))}}}function M(ne){return async q=>{await(0,o.AI)().post(`/api/admin/ldap/sync/${ne}`),q(c(ne))}}function A(){return async ne=>{if(i.TP.hasPermission(d.AccessControlAction.LDAPStatusRead))try{const q=await(0,o.AI)().get("/api/admin/ldap/status");ne((0,p.pH)(q))}catch(q){if((0,o.NF)(q)){q.isHandled=!0;const ee={title:q.data.message,body:q.data.error};ne((0,p.V$)(ee))}}}}function R(ne){return async q=>{try{const ee=await(0,o.AI)().get(`/api/admin/ldap/${encodeURIComponent(ne)}`),{name:z,surname:te,email:ie,login:ce,isGrafanaAdmin:ue,isDisabled:fe,roles:Te,teams:he}=ee,de={info:{name:z,surname:te,email:ie,login:ce},permissions:{isGrafanaAdmin:ue,isDisabled:fe},roles:Te,teams:he};q((0,p.TW)(de))}catch(ee){if((0,o.NF)(ee)){ee.isHandled=!0;const z={title:ee.data.message,body:ee.data.error};q((0,p.Vv)()),q((0,p.Nf)(z))}}}}function B(){return ne=>{ne((0,p.zi)())}}function U(){return ne=>{ne((0,p.zi)()),ne((0,p.Vv)())}}const W=ne=>ne.map(q=>Array.isArray(q.value)?q.value.map(ee=>`${q.name}=${ee.value}`).join("&"):`${q.name}=${q.value}`).join("&");function N(){return async(ne,q)=>{try{const{perPage:ee,page:z,query:te,filters:ie,sort:ce}=q().userListAdmin;let ue=`/api/users/search?perpage=${ee}&page=${z}&query=${te}&${W(ie)}`;ce&&(ue+=`&sort=${ce}`);const fe=await(0,o.AI)().get(ue);ne((0,p.Mb)(fe))}catch(ee){(0,p.g4)(),console.error(ee)}}}const w=(0,t.debounce)(ne=>ne(N()),500);function L(ne){return async q=>{q((0,p.Cj)()),q((0,p.L5)(ne)),w(q)}}function V(ne){return async q=>{q((0,p.Cj)()),q((0,p.jX)(ne)),w(q)}}function K(ne){return async q=>{q((0,p.Cj)()),q((0,p.EC)(ne)),q(N())}}function k({sortBy:ne}){const q=ne.length?`${ne[0].id}-${ne[0].desc?"desc":"asc"}`:void 0;return async(ee,z)=>{z().userListAdmin.sort!==q&&(ee((0,p.Cj)()),ee((0,p.$u)(q)),ee(N()))}}const j=ne=>ne.map(q=>Array.isArray(q.value)?q.value.map(ee=>`${q.name}=${ee.value}`).join("&"):`${q.name}=${q.value}`).join("&");function H(){return async(ne,q)=>{try{const{perPage:ee,page:z,query:te,filters:ie,sort:ce}=q().userListAnonymousDevices;let ue=`/api/anonymous/search?perpage=${ee}&page=${z}&query=${te}&${j(ie)}`;ce&&(ue+=`&sort=${ce}`);const fe=await(0,o.AI)().get(ue);ne((0,p.o3)(fe))}catch(ee){console.error(ee)}}}const J=(0,t.debounce)(ne=>ne(H()),500);function X({sortBy:ne}){const q=ne.length?`${ne[0].id}-${ne[0].desc?"desc":"asc"}`:void 0;return async(ee,z)=>{z().userListAnonymousDevices.sort!==q&&(ee((0,p.kh)(q)),ee(H()))}}function se(ne){return async q=>{q((0,p.xx)(ne)),J(q)}}function ae(ne){return async q=>{q((0,p.iK)(ne)),q(H())}}},44672:(G,I,e)=>{"use strict";e.d(I,{$u:()=>M,Ay:()=>V,Cj:()=>T,D1:()=>E,EC:()=>x,G_:()=>f,L5:()=>O,Mb:()=>C,Nf:()=>u,OF:()=>P,OR:()=>i,PV:()=>g,TW:()=>d,V$:()=>l,Vv:()=>o,ag:()=>a,g4:()=>S,iK:()=>N,jX:()=>b,kh:()=>W,o3:()=>U,pH:()=>m,xx:()=>w,zi:()=>r});var t=e(65307);const n={connectionInfo:[],syncInfo:void 0,user:void 0,connectionError:void 0,userError:void 0},s=(0,t.Z0)({name:"ldap",initialState:n,reducers:{ldapConnectionInfoLoadedAction:(K,k)=>({...K,ldapError:void 0,connectionInfo:k.payload}),ldapFailedAction:(K,k)=>({...K,ldapError:k.payload}),ldapSyncStatusLoadedAction:(K,k)=>({...K,syncInfo:k.payload}),userMappingInfoLoadedAction:(K,k)=>({...K,user:k.payload,userError:void 0}),userMappingInfoFailedAction:(K,k)=>({...K,user:void 0,userError:k.payload}),clearUserMappingInfoAction:(K,k)=>({...K,user:void 0}),clearUserErrorAction:(K,k)=>({...K,userError:void 0})}}),{clearUserErrorAction:r,clearUserMappingInfoAction:o,ldapConnectionInfoLoadedAction:m,ldapFailedAction:l,ldapSyncStatusLoadedAction:i,userMappingInfoFailedAction:u,userMappingInfoLoadedAction:d}=s.actions,p=s.reducer,c={user:void 0,sessions:[],orgs:[],isLoading:!0,error:void 0},y=(0,t.Z0)({name:"userAdmin",initialState:c,reducers:{userProfileLoadedAction:(K,k)=>({...K,user:k.payload}),userOrgsLoadedAction:(K,k)=>({...K,orgs:k.payload}),userSessionsLoadedAction:(K,k)=>({...K,sessions:k.payload}),userAdminPageLoadedAction:(K,k)=>({...K,isLoading:!k.payload}),userAdminPageFailedAction:(K,k)=>({...K,error:k.payload,isLoading:!1})}}),{userProfileLoadedAction:f,userOrgsLoadedAction:P,userSessionsLoadedAction:a,userAdminPageLoadedAction:E,userAdminPageFailedAction:g}=y.actions,h=y.reducer,D={users:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!1}],isLoading:!0},v=(0,t.Z0)({name:"userListAdmin",initialState:D,reducers:{usersFetched:(K,k)=>{const{totalCount:j,perPage:H,...J}=k.payload,X=Math.ceil(j/H);return{...K,...J,totalPages:X,perPage:H,showPaging:X>1,isLoading:!1}},usersFetchBegin:K=>({...K,isLoading:!0}),usersFetchEnd:K=>({...K,isLoading:!1}),queryChanged:(K,k)=>({...K,query:k.payload,page:0}),pageChanged:(K,k)=>({...K,page:k.payload}),sortChanged:(K,k)=>({...K,page:0,sort:k.payload}),filterChanged:(K,k)=>{const{name:j,value:H}=k.payload;return K.filters.some(J=>J.name===j)?{...K,page:0,filters:K.filters.map(J=>J.name===j?{...J,value:H}:J)}:{...K,page:0,filters:[...K.filters,k.payload]}}}}),{usersFetched:C,usersFetchBegin:T,usersFetchEnd:S,queryChanged:O,pageChanged:x,filterChanged:b,sortChanged:M}=v.actions,A=v.reducer,R={devices:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!0}]},B=(0,t.Z0)({name:"userListAnonymousDevices",initialState:R,reducers:{usersAnonymousDevicesFetched:(K,k)=>{const{totalCount:j,perPage:H,...J}=k.payload,X=Math.ceil(j/H);return{...K,...J,totalPages:X,perPage:H,showPaging:X>1}},anonQueryChanged:(K,k)=>({...K,query:k.payload,page:0}),anonPageChanged:(K,k)=>({...K,page:k.payload}),anonUserSortChanged:(K,k)=>({...K,page:0,sort:k.payload}),filterChanged:(K,k)=>{const{name:j,value:H}=k.payload;return K.filters.some(J=>J.name===j)?{...K,page:0,filters:K.filters.map(J=>J.name===j?{...J,value:H}:J)}:{...K,page:0,filters:[...K.filters,k.payload]}}}}),{usersAnonymousDevicesFetched:U,anonUserSortChanged:W,anonPageChanged:N,anonQueryChanged:w}=B.actions,L=B.reducer,V={ldap:p,userAdmin:h,userListAdmin:A,userListAnonymousDevices:L}},55907:(G,I,e)=>{"use strict";e.d(I,{A:()=>h,p:()=>l});var t=e(2543),n=e.n(t),s=e(1062);const r=new s.tI({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["10s","1m","5m","10m","15m","1h","2h","6h","12h","24h","48h"]},{name:"to",type:"string",options:["now","now-1m","now-5m","now-10m","now-1h"]}],defaultParams:["#A","15m","now","avg"]}),o=[{text:"Query",value:"query"}],m={alerting:1,firing:1,no_data:2,pending:3,ok:4,paused:5,inactive:5};var l=(D=>(D.IsAbove="gt",D.IsBelow="lt",D.IsOutsideRange="outside_range",D.IsWithinRange="within_range",D.HasNoValue="no_value",D))(l||{});const i=[{value:"gt",text:"IS ABOVE"},{value:"lt",text:"IS BELOW"},{value:"outside_range",text:"IS OUTSIDE RANGE"},{value:"within_range",text:"IS WITHIN RANGE"},{value:"no_value",text:"HAS NO VALUE"}],u=[{text:"OR",value:"or"},{text:"AND",value:"and"}],d=[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"diff_abs()",value:"diff_abs"},{text:"percent_diff()",value:"percent_diff"},{text:"percent_diff_abs()",value:"percent_diff_abs"},{text:"count_non_null()",value:"count_non_null"}],p=[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],c=[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}];function y(D){const v=new s.tI({type:D.type,defaultParams:[]});return new s.kW(D,v)}function f(D){return D.toLowerCase().replace(/_/g,"").split(" ")[0]}function P(D){switch(f(D)){case"normal":case"ok":return{text:"OK",iconClass:"heart",stateClass:"alert-state-ok"};case"alerting":return{text:"ALERTING",iconClass:"heart-break",stateClass:"alert-state-critical"};case"nodata":return{text:"NO DATA",iconClass:"question-circle",stateClass:"alert-state-warning"};case"paused":return{text:"PAUSED",iconClass:"pause",stateClass:"alert-state-paused"};case"pending":return{text:"PENDING",iconClass:"hourglass",stateClass:"alert-state-warning"};case"firing":return{text:"FIRING",iconClass:"fire",stateClass:""};case"inactive":return{text:"INACTIVE",iconClass:"check",stateClass:""};case"error":return{text:"ERROR",iconClass:"heart-break",stateClass:"alert-state-critical"};case"unknown":default:return{text:"UNKNOWN",iconClass:"question-circle",stateClass:".alert-state-paused"}}}function a(D,v){return(0,t.reduce)(D,(C,T)=>(T.metric!==void 0&&T.value!==void 0&&C.push(T.metric+"="+T.value),T.Metric!==void 0&&T.Value!==void 0&&C.push(T.Metric+"="+T.Value),C),[]).join(v)}function E(D){return(0,t.isArray)(D.data)?a(D.data,", "):(0,t.isArray)(D.data.evalMatches)?a(D.data.evalMatches,", "):D.data.error?"Error: "+D.data.error:""}function g(D){return(0,t.isArray)(D)?a(D,", "):(0,t.isArray)(D.evalMatches)?a(D.evalMatches,", "):D.error?"Error: "+D.error:""}const h={alertQueryDef:r,getStateDisplayModel:P,conditionTypes:o,evalFunctions:i,evalOperators:u,noDataModes:p,executionErrorModes:c,reducerTypes:d,createReducerPart:y,getAlertAnnotationInfo:E,getAlertAnnotationText:g,alertStateSortScore:m}},1062:(G,I,e)=>{"use strict";e.d(I,{Dw:()=>m,Wn:()=>o,kW:()=>r,tI:()=>s});var t=e(2543),n=e.n(t);class s{constructor(d){this.type=d.type,this.params=d.params,this.defaultParams=d.defaultParams,this.renderer=d.renderer,this.category=d.category,this.addStrategy=d.addStrategy}}class r{constructor(d,p){if(this.part=d,this.def=p,!this.def)throw{message:"Could not find query part "+d.type};d.params=d.params||(0,t.clone)(this.def.defaultParams),this.params=d.params,this.text="",this.updateText()}render(d){return this.def.renderer(this,d)}hasMultipleParamsInString(d,p){return d.indexOf(",")===-1?!1:this.def.params[p+1]&&this.def.params[p+1].optional}updateParam(d,p){if(this.hasMultipleParamsInString(d,p)){(0,t.each)(d.split(","),(c,y)=>{this.updateParam(c.trim(),y)});return}d===""&&this.def.params[p].optional?this.params.splice(p,1):this.params[p]=d,this.part.params=this.params,this.updateText()}updateText(){if(this.params.length===0){this.text=this.def.type+"()";return}let d=this.def.type+"(";d+=this.params.join(", "),d+=")",this.text=d}}function o(u,d){const p=u.def.type+"(",c=(0,t.map)(u.params,(y,f)=>{const P=u.def.params[f];return P.type==="time"&&y==="auto"&&(y="$__interval"),P.quote==="single"?"'"+y+"'":P.quote==="double"?'"'+y+'"':y});return d&&c.unshift(d),p+c.join(", ")+")"}function m(u,d){return d+" "+u.params[0]}function l(u,d){return u.params[0]}function i(u,d){return'"'+u.params[0]+'"'}},25027:(G,I,e)=>{"use strict";e.d(I,{AK:()=>x,Cl:()=>L,Fb:()=>U,IR:()=>O,KF:()=>E,Ke:()=>h,QA:()=>P,Rk:()=>S,Sn:()=>R,Sq:()=>C,U6:()=>N,U7:()=>a,aL:()=>B,fH:()=>c,hJ:()=>W,l$:()=>f,le:()=>p,nf:()=>T,t6:()=>w,vV:()=>y,zs:()=>M});var t=e(2543),n=e.n(t),s=e(47232),r=e(34867),o=e(17172),m=e(32264),l=e(14110),i=e(10096),u=e(28475);const d=7,p={filterByLabel:"filtering alert instances by label",loadedList:"loaded Alert Rules list",leavingRuleGroupEdit:"leaving rule group edit without saving",alertRuleFromPanel:"creating alert rule from panel",alertRuleFromScratch:"creating alert rule from scratch",recordingRuleFromScratch:"creating recording rule from scratch",clickingAlertStateFilters:"clicking alert state filters",cancelSavingAlertRule:"user canceled alert rule creation",successSavingAlertRule:"alert rule saved successfully",unknownMessageFromError:"unknown messageFromError"},{logInfo:c,logError:y,logMeasurement:f}=(0,r.DW)("features.alerting",{module:"Alerting"});function P(V,K,k){return async function(...j){const H=performance.now(),J=await K(...j),X=performance.now()-H;return f(V,{loadTimesMs:X},k),J}}function a(V,K,k){return async(...j)=>{const H=performance.now(),J=await K(...j),{namespacesCount:X,groupsCount:se,rulesCount:ae}=g(J);return f(V,{loadTimeMs:performance.now()-H,namespacesCount:X,groupsCount:se,rulesCount:ae},k),J}}function E(V){Object.entries(V).forEach(([K,k])=>{const j=k.message??"unknown error",H=String(k.type)??"unknown",J=new Error(j);y(J,{field:K,type:H})})}function g(V){const K=V.length,k=V.flatMap(J=>J.groups).length,j=V.flatMap(J=>J.groups).flatMap(J=>J.rules).length;return{namespacesCount:K,groupsCount:k,rulesCount:j}}function h(V,K,k){return async(...j)=>{const H=performance.now(),J=await K(...j),{namespacesCount:X,groupsCount:se,rulesCount:ae}=D(J);return f(V,{namespacesCount:X,groupsCount:se,rulesCount:ae,loadTimeMs:performance.now()-H},k),J}}function D(V){const K=Object.keys(V),k=Object.values(V).flatMap(H=>H),j=k.flatMap(H=>H.rules);return{namespacesCount:K.length,groupsCount:k.length,rulesCount:j.length}}async function v(){try{const{createdAt:V}=await(0,o.AI)().get("/api/user"),K=(0,s.KQ)().subtract(d,"days"),k=(0,s.KQ)(V);return K.isBefore(k)}catch{return!0}}const C=async(V={grafana_version:m.$.buildInfo.version,org_id:i.TP.user.orgId,user_id:i.TP.user.id})=>{await v()||(0,l.rR)("grafana_alerting_navigation",V)},T=V=>{(0,l.rR)("grafana_alerting_rule_creation",V)},S=V=>{(0,l.rR)("grafana_alerting_rule_aborted",V)},O=V=>{(0,l.rR)("grafana_alerting_rule_form_error",V)},x=async V=>{const K={grafana_version:m.$.buildInfo.version,org_id:i.TP.user.orgId,user_id:i.TP.user.id};(0,l.rR)("grafana_alerting_insights",{...K,...V})};function b(V){(0,l.rR)("grafana_alerting_rules_search",{...V})}function M({oldQuery:V,newQuery:K}){try{const k=(0,u.XY)(V),j=(0,u.XY)(K),H=A(k);A(j).filter(se=>!H.includes(se)).forEach(se=>{b({filter:se,triggeredBy:"typing"})})}catch(k){k instanceof Error&&y(k)}}function A(V){return Object.entries(V).filter(([K,k])=>!(0,t.isEmpty)(k)).map(([K])=>K)}function R(V){b({filter:V,triggeredBy:"component"})}function B(V){(0,l.rR)("grafana_alerting_rules_list_mode",{...V})}function U(){(0,l.rR)("grafana_alerting_switch_to_simplified_routing")}function W(){(0,l.rR)("grafana_alerting_switch_to_policies_routing")}function N(){(0,l.rR)("grafana_alerting_contact_point_form_edit_input_with_template")}function w(){(0,l.rR)("grafana_alerting_contact_point_form_use_custom_input_in_template")}function L(){(0,l.rR)("grafana_alerting_contact_point_form_use_single_template_in_input")}},79741:(G,I,e)=>{"use strict";e.r(I),e.d(I,{default:()=>P,defaultPageNav:()=>y});var t=e(96540),n=e(17172),s=e(42418),r=e(66602),o=e(7392),m=e(37959),l=e(5179),i=e(45314),u=e(730),d=e(56361),p=e(18461);const c=a=>{const E=(0,p.uE)(a.match.params),g=t.useMemo(()=>{if(!E)throw new Error("Rule ID is required");return(0,p.qg)(E,!0)},[E]),{loading:h,error:D,result:v}=(0,u.ZU)({ruleIdentifier:g});return D?t.createElement(m.d,{pageNav:y,navId:"alert-list"},t.createElement(f,{error:D})):h?t.createElement(m.d,{pageNav:y,navId:"alert-list",isLoading:!0},t.createElement(t.Fragment,null)):v?t.createElement(l.K,{identifier:g,rule:v},t.createElement(i.Ay,null)):t.createElement(m.d,{pageNav:y,navId:"alert-list"},t.createElement(o.L,{entity:"Rule"}))},y={id:"alert-rule-view",text:""};function f({error:a}){return(0,n.NF)(a)&&a.status===404?t.createElement(o.L,{entity:"Rule"}):t.createElement(s.F,{title:"Something went wrong loading the rule"},(0,d.JZ)(a))}const P=(0,r.Xc)(c,{style:"page"})},79938:(G,I,e)=>{"use strict";e.d(I,{hK:()=>p});var t=e(2543),n=e.n(t),s=e(57220),r=e(75214),o=e(23662),m=e(49962),l=e(49498),i=e(28220);const u="/api/v1/rule/test/grafana",d="api/prometheus/grafana/api/v1/rules",p=m.H.injectEndpoints({endpoints:c=>({preview:c.mutation({query:({alertQueries:y,condition:f,customLabels:P,folder:a,alertName:E,alertUid:g})=>({url:u,data:{rule:{grafana_alert:{data:y,condition:f,no_data_state:"Alerting",title:E,uid:g??"N/A"},for:"0s",labels:(0,r.x4)(P),annotations:{}},folderUid:a.uid,folderTitle:a.title},method:"POST"})}),prometheusRulesByNamespace:c.query({query:({limitAlerts:y,identifier:f,filter:P,state:a,matcher:E})=>{const g=new URLSearchParams;y&&g.set("limit_alerts",String(y)),f&&((0,o.Mj)(f)||(0,o.X4)(f))&&(g.set("file",f.namespace),g.set("rule_group",f.groupName));const h=(0,l.bZ)(g,P);return{url:d,params:(0,l.Dj)(h,a,E)}},transformResponse:y=>(0,l.lH)(y.data.groups,s.hY)}),prometheusRuleNamespaces:c.query({query:({ruleSourceName:y,namespace:f,groupName:P,ruleName:a,dashboardUid:E,panelId:g})=>{const h={rule_group:P,rule_name:a,dashboard_uid:E,panel_id:g?.toString()};return f&&((0,s.z2)(y)?(0,t.set)(h,"folder_uid",f):(0,t.set)(h,"file",f)),{url:`api/prometheus/${(0,s.w5)(y)}/api/v1/rules`,params:h}},transformResponse:(y,f,P)=>(0,l.lH)(y.data.groups,P.ruleSourceName),providesTags:["CombinedAlertRule"]}),rulerRules:c.query({query:({rulerConfig:y,filter:f})=>{const{path:P,params:a}=(0,i.$o)(y).rules(f);return{url:P,params:a}},providesTags:["CombinedAlertRule"]}),rulerNamespace:c.query({query:({rulerConfig:y,namespace:f})=>{const{path:P,params:a}=(0,i.$o)(y).namespace(f);return{url:P,params:a}}}),rulerRuleGroup:c.query({query:({rulerConfig:y,namespace:f,group:P})=>{const{path:a,params:E}=(0,i.$o)(y).namespaceGroup(f,P);return{url:a,params:E}},providesTags:["CombinedAlertRule"]}),getAlertRule:c.query({query:({uid:y})=>({url:`/api/ruler/${s.hY}/api/v1/rule/${y}`}),providesTags:(y,f,{uid:P})=>[{type:"GrafanaRulerRule",id:P}]}),exportRules:c.query({query:({format:y,folderUid:f,group:P,ruleUid:a})=>({url:"/api/ruler/grafana/api/v1/export/rules",params:{format:y,folderUid:f,group:P,ruleUid:a},responseType:"text"}),keepUnusedDataFor:0}),exportReceiver:c.query({query:({receiverName:y,decrypt:f,format:P})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:P,decrypt:f,name:y},responseType:"text"}),keepUnusedDataFor:0}),exportReceivers:c.query({query:({decrypt:y,format:f})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:f,decrypt:y},responseType:"text"}),keepUnusedDataFor:0}),exportPolicies:c.query({query:({format:y})=>({url:"/api/v1/provisioning/policies/export/",params:{format:y},responseType:"text"}),keepUnusedDataFor:0}),exportModifiedRuleGroup:c.mutation({query:({payload:y,format:f,nameSpaceUID:P})=>({url:`/api/ruler/grafana/api/v1/rules/${P}/export/`,params:{format:f},responseType:"text",data:y,method:"POST"})}),exportMuteTimings:c.query({query:({format:y})=>({url:"/api/v1/provisioning/mute-timings/export/",params:{format:y},responseType:"text"}),keepUnusedDataFor:0}),exportMuteTiming:c.query({query:({format:y,muteTiming:f})=>({url:`/api/v1/provisioning/mute-timings/${f}/export/`,params:{format:y},responseType:"text"}),keepUnusedDataFor:0}),updateRule:c.mutation({query:({payload:y,nameSpaceUID:f})=>({url:`/api/ruler/grafana/api/v1/rules/${f}/`,data:y,method:"POST"}),invalidatesTags:["CombinedAlertRule"]})})})},91540:(G,I,e)=>{"use strict";e.d(I,{F:()=>r});var t=e(26272),n=e(28138),s=e(49962);const r=s.H.injectEndpoints({endpoints:o=>({getSilences:o.query({query:({datasourceUid:m,ruleMetadata:l,accessControl:i})=>({url:`/api/alertmanager/${m}/api/v2/silences`,params:{ruleMetadata:l,accesscontrol:i}}),providesTags:m=>m?m.map(({id:l})=>({type:"AlertmanagerSilences",id:l})):["AlertmanagerSilences"]}),getSilence:o.query({query:({datasourceUid:m,id:l,ruleMetadata:i,accessControl:u})=>({url:`/api/alertmanager/${m}/api/v2/silence/${l}`,showErrorAlert:!1,params:{ruleMetadata:i,accesscontrol:u}}),providesTags:(m,l,{id:i})=>m?[{type:"AlertmanagerSilences",id:i}]:["AlertmanagerSilences"]}),createSilence:o.mutation({query:({datasourceUid:m,payload:l})=>({url:`/api/alertmanager/${m}/api/v2/silences`,method:"POST",data:l}),invalidatesTags:["AlertmanagerSilences","AlertmanagerAlerts"],onQueryStarted:async(m,{queryFulfilled:l})=>{try{await l,n.A.emit(t.r1.alertSuccess,["Silence created"])}catch{n.A.emit(t.r1.alertError,["Could not create silence"])}}}),expireSilence:o.mutation({query:({datasourceUid:m,silenceId:l})=>({url:`/api/alertmanager/${m}/api/v2/silence/${l}`,method:"DELETE"}),invalidatesTags:["AlertmanagerSilences"]})})})},49962:(G,I,e)=>{"use strict";e.d(I,{H:()=>m});var t=e(75816),n=e(75505),s=e(17172),r=e(25027);const o=()=>async l=>{try{const i=performance.now(),{data:u,...d}=await(0,n.s)((0,s.AI)().fetch(l));return(0,r.l$)("backendSrvBaseQuery",{loadTimeMs:performance.now()-i},{url:l.url,method:l.method??"GET",responseStatus:d.statusText}),{data:u,meta:d}}catch(i){return{error:i}}},m=(0,t.xP)({reducerPath:"alertingApi",baseQuery:o(),tagTypes:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","AlertmanagerAlerts","AlertmanagerSilences","OnCallIntegrations","OrgMigrationState","DataSourceSettings","GrafanaLabels","CombinedAlertRule","GrafanaRulerRule"],endpoints:()=>({})})},32415:(G,I,e)=>{"use strict";e.d(I,{By:()=>d,VO:()=>u,WS:()=>o,f4:()=>i,nd:()=>l,vk:()=>m});var t=e(75505),n=e(39070),s=e(17172),r=e(57220);async function o(P){try{const a=await(0,t.s)((0,s.AI)().fetch({url:`/api/alertmanager/${(0,r.w5)(P)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}));return{template_files:a.data.template_files??{},template_file_provenances:a.data.template_file_provenances??{},alertmanager_config:a.data.alertmanager_config??{},last_applied:a.data.last_applied,id:a.data.id}}catch(a){if(P===r.hY&&(0,s.NF)(a)&&a.data?.message?.includes("could not find an Alertmanager configuration"))return{template_files:{},alertmanager_config:{}};throw a}}async function m(P,a){await(0,t.s)((0,s.AI)().fetch({method:"POST",url:`/api/alertmanager/${(0,r.w5)(P)}/config/api/v1/alerts`,data:a,showErrorAlert:!1,showSuccessAlert:!1}))}async function l(P){await(0,t.s)((0,s.AI)().fetch({method:"DELETE",url:`/api/alertmanager/${(0,r.w5)(P)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}))}async function i(P){return(await(0,t.s)((0,s.AI)().fetch({url:`/api/alertmanager/${(0,r.w5)(P)}/api/v2/alerts/groups`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function u(P){return(await(0,t.s)((0,s.AI)().fetch({url:`/api/alertmanager/${(0,r.w5)(P)}/api/v2/status`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function d(P,a,E){const g={receivers:a,alert:E};try{const h=await(0,t.s)((0,s.AI)().fetch({method:"POST",data:g,url:`/api/alertmanager/${(0,r.w5)(P)}/config/api/v1/receivers/test`,showErrorAlert:!1,showSuccessAlert:!1}));if(p(h.data))throw new Error(f(h.data))}catch(h){throw(0,s.NF)(h)&&c(h.data)&&p(h.data)?new Error(f(h.data)):h}}function p(P){return P.receivers.some(a=>a.grafana_managed_receiver_configs.some(E=>E.status==="failed"))}function c(P){return(0,n.Gv)(P)&&"receivers"in P&&Array.isArray(P.receivers)?P.receivers.every(y):!1}function y(P){return(0,n.Gv)(P)&&"name"in P&&typeof P.name=="string"&&"grafana_managed_receiver_configs"in P&&Array.isArray(P.grafana_managed_receiver_configs)}function f(P){return P.receivers.flatMap(a=>a.grafana_managed_receiver_configs.filter(E=>E.status==="failed").map(E=>E.error??"Unknown error.")).join("; ")}},82843:(G,I,e)=>{"use strict";e.d(I,{m:()=>f});var t=e(2543),n=e.n(t),s=e(99140),r=e(25027),o=e(98164),m=e(57220),l=e(56361),i=e(88467),u=e(49962),d=e(32415),p=e(77583);const c=30,y=30*1e3,f=u.H.injectEndpoints({endpoints:P=>({getAlertmanagerAlerts:P.query({query:({amSourceName:a,filter:E,showErrorAlert:g=!0})=>{const h=E?.matchers?.filter(x=>x.name&&x.value).map(x=>`${x.name}${(0,o.MN)(x)}${(0,l.Y9)(x.value)}`),{silenced:D,inhibited:v,unprocessed:C,active:T}=E||{},S=Object.fromEntries(Object.entries({silenced:D,active:T,inhibited:v,unprocessed:C}).filter(([x,b])=>b!==void 0)),O={filter:h};return S&&Object.keys(S).forEach(x=>{O[x]=S[x]}),{url:`/api/alertmanager/${(0,m.w5)(a)}/api/v2/alerts`,params:O,showErrorAlert:g}},providesTags:["AlertmanagerAlerts"]}),getAlertmanagerAlertGroups:P.query({query:({amSourceName:a})=>({url:`/api/alertmanager/${(0,m.w5)(a)}/api/v2/alerts/groups`})}),grafanaNotifiers:P.query({query:()=>({url:"/api/alert-notifiers"})}),getGrafanaAlertingConfiguration:P.query({query:()=>({url:"/api/v1/ngalert/admin_config",showErrorAlert:!1}),providesTags:["AlertingConfiguration"]}),getGrafanaAlertingConfigurationStatus:P.query({query:()=>({url:"/api/v1/ngalert"}),providesTags:["AlertingConfiguration"]}),getExternalAlertmanagers:P.query({query:()=>({url:"/api/v1/ngalert/alertmanagers"}),transformResponse:a=>a.data,providesTags:["AlertmanagerConnectionStatus"]}),updateGrafanaAlertingConfiguration:P.mutation({query:a=>({url:"/api/v1/ngalert/admin_config",method:"POST",data:a,showSuccessAlert:!1}),invalidatesTags:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus"]}),getAlertmanagerConfigurationHistory:P.query({query:()=>({url:`/api/alertmanager/${(0,m.w5)(m.hY)}/config/history`,params:{limit:c}}),providesTags:["AlertmanagerConfiguration"]}),resetAlertmanagerConfigurationToOldVersion:P.mutation({query:a=>({url:`/api/alertmanager/${(0,m.w5)(m.hY)}/config/history/${a.id}/_activate`,method:"POST"}),invalidatesTags:["AlertmanagerConfiguration"]}),getAlertmanagerConfiguration:P.query({queryFn:async a=>{const E=a===m.hY;if((0,m.AL)(a))return(0,i.$I)((0,d.VO)(a).then(S=>({data:{alertmanager_config:S.config,template_files:{}}})));const{data:h}=await(0,s.JD)(p.L.endpoints.discoverAmFeatures.initiate({amSourceName:a})),D={alertmanager_config:{},template_files:{},template_file_provenances:{}},v=h?.lazyConfigInit??!1,C=(0,r.QA)("unifiedalerting/fetchAmConfig",d.WS,{dataSourceName:a,thunk:"unifiedalerting/fetchAmConfig"}),T=(0,l.i9)(()=>C(a),S=>!!(0,i.CZ)(S)?.includes("alertmanager storage object not found")&&!v,y).then(S=>E?S:(0,t.isEmpty)(S.alertmanager_config)&&(0,t.isEmpty)(S.template_files)?(0,d.VO)(a).then(x=>({alertmanager_config:x.config,template_files:{},template_file_provenances:S.template_file_provenances,last_applied:S.last_applied,id:S.id})):S).then(S=>S??D).then(S=>({data:S})).catch(S=>{if(v&&(0,i.CZ)(S)?.includes("alertmanager storage object not found"))return{data:D};throw S});return(0,i.$I)(T).catch(S=>({error:S,data:void 0}))},providesTags:["AlertmanagerConfiguration"]}),updateAlertmanagerConfiguration:P.mutation({query:({selectedAlertmanager:a,config:E,...g})=>({url:`/api/alertmanager/${(0,m.w5)(a)}/config/api/v1/alerts`,method:"POST",data:E,...g}),invalidatesTags:["AlertmanagerConfiguration"]}),getContactPointsStatus:P.query({query:()=>({url:`/api/alertmanager/${(0,m.w5)(m.hY)}/config/api/v1/receivers`}),transformResponse:a=>{const E=g=>g.startsWith("0001-01-01");return a.map(g=>({...g,integrations:g.integrations.map(h=>{const D=E(h.lastNotifyAttempt);return{...h,lastNotifyAttempt:D?"":h.lastNotifyAttempt,lastNotifyAttemptDuration:D?"":h.lastNotifyAttemptDuration}})}))}}),getContactPointsList:P.query({query:()=>({url:"/api/v1/notifications/receivers"})}),getMuteTimingList:P.query({query:()=>({url:"/api/v1/notifications/time-intervals"})})})})},92240:(G,I,e)=>{"use strict";e.d(I,{O5:()=>p,_y:()=>d,nD:()=>i});var t=e(75505),n=e(17172),s=e(94822),r=e(55740),o=e(57220),m=e(49498),l=e(28220);async function i(E){if(E===o.hY)return{features:{rulerApiEnabled:!0}};const g=(0,o.oh)(E);if(!g)throw new Error(`Cannot find data source configuration for ${E}`);const{url:h,name:D,type:v}=g;if(!h)throw new Error("The data source url cannot be empty.");if(v!=="prometheus"&&v!=="loki")throw new Error(`The build info request is not available for ${v}. Only 'prometheus' and 'loki' are supported`);return u({name:D,url:h,type:v})}async function u(E){const{url:g,name:h,type:D}=E,v=D==="loki"?void 0:await y(g);if(!(v!==void 0)){if(!await f(h))throw new Error(`Unable to fetch alert rules. Is the ${h} data source properly configured?`);const O=await P(h);return{application:s.N1.Cortex,features:{rulerApiEnabled:O}}}const{features:T}=v.data;return T?{application:s.N1.Mimir,features:{rulerApiEnabled:T?.ruler_config_api==="true"}}:{application:s.N1.Prometheus,features:{rulerApiEnabled:!1}}}async function d(E){if(E===o.hY)return{lazyConfigInit:!1};const g=c(E),{url:h,type:D}=g;if(!h)throw new Error("The data source url cannot be empty.");if(D!=="alertmanager")throw new Error(`Alertmanager feature discovery is not available for ${D}. Only 'alertmanager' type is supported`);return await p(h)}async function p(E){try{return{lazyConfigInit:(await y(E))?.data?.application==="Grafana Mimir"}}catch{return{lazyConfigInit:!1}}}function c(E){const g=(0,o.oh)(E);if(!g)throw new Error(`Cannot find data source configuration for ${E}`);return g}async function y(E){return(await(0,t.s)((0,n.AI)().fetch({url:`${E}/api/v1/status/buildinfo`,showErrorAlert:!1,showSuccessAlert:!1})).catch(h=>{if(!("status"in h&&h.status===404))throw h}))?.data}async function f(E){try{return await(0,m.sA)(E),!0}catch{return!1}}async function P(E){try{return await(0,l.Zp)(E),!0}catch(g){if(a(g))return!1;throw g}}function a(E){return(0,n.NF)(E)?E.data.message?.includes("GetRuleGroup unsupported in rule local store")||E.data.message?.includes("page not found")||E.data.message?.includes(r.UU):E instanceof Error&&E.message?.includes("404 from rules config endpoint")}},77583:(G,I,e)=>{"use strict";e.d(I,{L:()=>m});var t=e(94822),n=e(25027),s=e(57220),r=e(49962),o=e(92240);const m=r.H.injectEndpoints({endpoints:l=>({discoverAmFeatures:l.query({queryFn:async({amSourceName:i})=>{try{return{data:await(0,o._y)(i)}}catch(u){return{error:u}}}}),discoverDsFeatures:l.query({queryFn:async({rulesSourceName:i})=>{const u=(0,s.Jz)(i);if(!u)return{error:new Error(`Missing data source configuration for ${i}`)};const p=await(0,n.QA)("unifiedalerting/featureDiscoveryApi/discoverDsFeatures",o.nD,{dataSourceName:i,endpoint:"unifiedalerting/featureDiscoveryApi/discoverDsFeatures"})(u.name);return{data:{rulerConfig:p.features.rulerApiEnabled?{dataSourceName:u.name,apiVersion:p.application===t.N1.Cortex?"legacy":"config"}:void 0}}}})})})},68788:(G,I,e)=>{"use strict";e.d(I,{Es:()=>r,pB:()=>i});var t=e(75505),n=e(17172),s=e(57220);function r(){return(0,n.AI)().get("/api/alert-notifiers")}const o=u=>{const d=u.match(/^(\w+)(\[\d+\])?$/);return d?{type:d[1],index:d[2]}:{type:u,index:void 0}},m=u=>{const d={receivers:{},errorCount:0};u.forEach(c=>{d.receivers[c.name]={active:c.active,notifiers:{},errorCount:0};const y=d.receivers[c.name];c.integrations.forEach(f=>{!!f?.lastNotifyAttemptError&&(y.errorCount+=1);const a=l(f.name);a&&(y.notifiers[a]||(y.notifiers[a]=[]),y.notifiers[a].push(f))})});const p=Object.values(d.receivers).reduce((c,y)=>c+y.errorCount,0);return{...d,errorCount:p}},l=u=>o(u)?.type;async function i(u){try{const d=await(0,t.s)((0,n.AI)().fetch({url:`/api/alertmanager/${(0,s.w5)(u)}/config/api/v1/receivers`,showErrorAlert:!1,showSuccessAlert:!1}));return m(d.data)}catch{return m([])}}},26423:(G,I,e)=>{"use strict";e.d(I,{Pc:()=>o,WG:()=>l,uz:()=>d});var t=e(17172),n=e(37534),s=e(99494),r=e(49962);const o="grafana_alerting_v2",m=p=>`/api/plugin-proxy/${s.W.OnCall}${p}`,l=r.H.injectEndpoints({endpoints:p=>({grafanaOnCallIntegrations:p.query({query:()=>({url:m("/api/internal/v1/alert_receive_channels/"),params:{filters:!0,integration:[n.FI,"legacy_grafana_alerting"],skip_pagination:!0},showErrorAlert:!1}),transformResponse:c=>i(c)?c.results:c,providesTags:["OnCallIntegrations"]}),validateIntegrationName:p.query({query:c=>({url:m("/api/internal/v1/alert_receive_channels/validate_name/"),params:{verbal_name:c},showErrorAlert:!1})}),createIntegration:p.mutation({query:c=>({url:m("/api/internal/v1/alert_receive_channels/"),data:c,method:"POST",showErrorAlert:!0}),invalidatesTags:["OnCallIntegrations"]}),features:p.query({query:()=>({url:m("/api/internal/v1/features/"),showErrorAlert:!1})}),onCallConfigChecks:p.query({query:()=>({url:m("/api/internal/v1/organization/config-checks/"),showErrorAlert:!1})})})});function i(p){return"results"in p&&Array.isArray(p.results)}const{useGrafanaOnCallIntegrationsQuery:u}=l;function d(p){return(0,t.NF)(p)&&"detail"in p.data}},49498:(G,I,e)=>{"use strict";e.d(I,{Dj:()=>l,Kw:()=>u,bZ:()=>m,lH:()=>i,sA:()=>p});var t=e(75505),n=e(17172),s=e(57220),r=e(23662);function o(c){const{dataSourceName:y,limitAlerts:f,identifier:P}=c;return{rules:(a,E,g)=>{const h=new URLSearchParams;y===s.hY&&f&&h.set("limit_alerts",String(f)),P&&((0,r.Mj)(P)||(0,r.X4)(P))&&(h.set("file",P.namespace),h.set("rule_group",P.groupName));const D=m(h,a);return{url:`/api/prometheus/${(0,s.w5)(y)}/api/v1/rules`,params:l(D,E,g)}}}}function m(c,y){return y?.dashboardUID&&(c.set("dashboard_uid",y.dashboardUID),y?.panelId&&c.set("panel_id",String(y.panelId))),Object.fromEntries(c)}function l(c,y,f){let P={...c};if(y?.length&&(P={...P,state:y}),f?.length){const a=f.map(E=>JSON.stringify(E));P={...P,matcher:a}}return P}const i=(c,y)=>{const f={};return c.forEach(P=>{P.rules.forEach(a=>{a.query=a.query||""}),f[P.file]?f[P.file].groups.push(P):f[P.file]={dataSourceName:y,name:P.file,groups:[P]}}),Object.values(f)},u=(c=[])=>c?.flatMap(y=>y.groups.flatMap(f=>d(f,y.name)));function d(c,y){return{name:c.name,file:y,rules:c.rules,interval:c.interval}}async function p(c,y,f,P,a,E){if(y?.dashboardUID&&c!==s.hY)throw new Error("Filtering by dashboard UID is only supported for Grafana Managed rules.");const{url:g,params:h}=o({dataSourceName:c,limitAlerts:f,identifier:E}).rules(y,a,P),D=await(0,t.s)((0,n.AI)().fetch({url:g,params:h,showErrorAlert:!1,showSuccessAlert:!1})).catch(v=>{throw"status"in v&&v.status===404?new Error("404 from rule state endpoint. Perhaps ruler API is not enabled?"):v});return i(D.data.data.groups,c)}},28220:(G,I,e)=>{"use strict";e.d(I,{$o:()=>l,AJ:()=>y,BK:()=>g,E8:()=>i,HO:()=>c,Zp:()=>p,iy:()=>u});var t=e(75505),n=e(39070),s=e(17172),r=e(55740),o=e(57220),m=e(49498);function l(h){const v=`${`/api/ruler/${(0,o.w5)(h.dataSourceName)}`}/api/v1/rules`,C=new URLSearchParams;return C.set("subtype",h.apiVersion==="legacy"?"cortex":"mimir"),{rules:T=>{const S=(0,m.bZ)(C,T);return{path:`${v}`,params:S}},namespace:T=>({path:`${v}/${encodeURIComponent(T)}`,params:Object.fromEntries(C)}),namespaceGroup:(T,S)=>({path:`${v}/${encodeURIComponent(T)}/${encodeURIComponent(S)}`,params:Object.fromEntries(C)})}}async function i(h,D,v){const{path:C,params:T}=l(h).namespace(D);await(0,t.s)((0,s.AI)().fetch({method:"POST",url:C,data:v,showErrorAlert:!1,showSuccessAlert:!1,params:T}))}async function u(h,D){if(D?.dashboardUID&&h.dataSourceName!==o.hY)throw new Error("Filtering by dashboard UID is only supported by Grafana.");const{path:v,params:C}=l(h).rules(D);return f(v,{},C)}async function d(h,D){const{path:v,params:C}=l(h).namespace(D);return(await f(v,{},C))[D]||[]}async function p(h){return f(`/api/ruler/${(0,o.w5)(h)}/api/v1/rules/test/test`,null)}async function c(h,D,v){const{path:C,params:T}=l(h).namespaceGroup(D,v);return f(C,null,T)}async function y(h,D,v){const{path:C,params:T}=l(h).namespaceGroup(D,v);await(0,t.s)((0,s.AI)().fetch({url:C,method:"DELETE",showSuccessAlert:!1,showErrorAlert:!1,params:T}))}async function f(h,D,v){try{return(await(0,t.s)((0,s.AI)().fetch({url:h,showErrorAlert:!1,showSuccessAlert:!1,params:v}))).data}catch(C){if(!P(C))throw C;if(E(C))return D;throw a(C)?{...C,data:{...C.data,message:r.UU}}:C}}function P(h){if(!(0,n.Gv)(h))return!1;const D="data"in h&&h.data!==null&&h.data!==void 0;return"status"in h&&Number.isFinite(h.status)&&D}function a(h){return h.status===404||h.status===500&&h.data.message?.includes("unexpected content type from upstream. expected YAML, got text/html")}function E(h){return h.status===404&&(h.data.message?.includes("group does not exist")||h.data.message?.includes("no rule groups found"))}async function g(h,D){const{path:v,params:C}=l(h).namespace(D);await(0,t.s)((0,s.AI)().fetch({method:"DELETE",url:v,showErrorAlert:!1,showSuccessAlert:!1,params:C}))}},15458:(G,I,e)=>{"use strict";e.d(I,{R:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(29158);const o=({labelKey:l,value:i,operator:u="=",onRemoveLabel:d})=>{const p=(0,s.of)(m);return n.createElement("div",{className:p.wrapper},l,u,i,!!d&&n.createElement(r.K,{name:"times",size:"xs",onClick:d,tooltip:"Remove label"}))},m=l=>({wrapper:(0,t.css)({padding:l.spacing(.5,1),borderRadius:l.shape.radius.default,border:`solid 1px ${l.colors.border.medium}`,fontSize:l.typography.bodySmall.fontSize,backgroundColor:l.colors.background.secondary,fontWeight:l.typography.fontWeightBold,color:l.colors.text.primary,display:"inline-block",lineHeight:"1.2"})})},69087:(G,I,e)=>{"use strict";e.d(I,{m:()=>c});var t=e(32196),n=e(2543),s=e.n(n),r=e(55127),o=e.n(r),m=e(96540),l=e(40845),i=e(55852),u=e(69613),d=e(75214),p=e(8406);const c=({labels:P,commonLabels:a={},size:E})=>{const g=(0,l.of)(f,E),[h,D]=(0,m.useState)(!1),v=(0,n.chain)(P).toPairs().reject(d.w0).reject(([S])=>h?!1:S in a).value(),C=Object.keys(a).length,T=C>0;return m.createElement("div",{className:g.wrapper,role:"list","aria-label":"Labels"},v.map(([S,O])=>m.createElement(p.J,{key:S+O,size:E,label:S,value:O,color:y(S)})),!h&&T&&m.createElement(i.$n,{variant:"secondary",fill:"text",onClick:()=>D(!0),tooltip:"Show common labels",tooltipPlacement:"top",size:"sm"},"+",C," common ",o()("label",C)),h&&T&&m.createElement(i.$n,{variant:"secondary",fill:"text",onClick:()=>D(!1),tooltipPlacement:"top",size:"sm"},"Hide common labels"))};function y(P){return(0,u.MC)(P).color}const f=(P,a)=>({wrapper:(0,t.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:a==="md"?P.spacing():P.spacing(.5)})})},37959:(G,I,e)=>{"use strict";e.d(I,{d:()=>E,y:()=>g});var t=e(96540),n=e(87586),s=e(67608),r=e(70383),o=e(32196),m=e(40845),l=e(14186),i=e(21594),u=e(57220);function d(v){return v.name===u.hY?"Grafana":v.name.slice(0,37)}const p=({disabled:v=!1})=>{const C=(0,m.of)(c),{selectedAlertmanager:T,availableAlertManagers:S,setSelectedAlertmanager:O}=(0,r.VI)(),x=(0,t.useMemo)(()=>S.map(A=>({label:d(A),value:A.name,imgUrl:A.imgUrl,meta:A.meta})),[S]),b=v||x.length===1,M=b?"Alertmanager":"Choose Alertmanager";return t.createElement(l.I,{className:C.field,label:M,disabled:b,"data-testid":"alertmanager-picker"},t.createElement(i.l6,{"aria-label":M,width:29,className:"ds-picker select-container",backspaceRemovesValue:!1,onChange:A=>{A?.value&&O(A.value)},options:x,maxMenuHeight:500,noOptionsMessage:"No datasources found",value:T,getOptionLabel:A=>A.label}))},c=v=>({field:(0,o.css)({margin:0})});var y=e(42418);const f=()=>t.createElement(y.F,{title:"No Alertmanager found",severity:"warning"},"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."),P=()=>t.createElement(y.F,{title:"Selected Alertmanager not found.",severity:"warning"},"The selected Alertmanager no longer exists or you may not have permission to access it. You can select a different Alertmanager from the dropdown."),a=({availableAlertManagers:v})=>{const C=v.length>0;return t.createElement("div",null,C?t.createElement(P,null):t.createElement(f,null))},E=({children:v,isLoading:C,...T})=>t.createElement(s.Y,{...T},t.createElement(s.Y.Contents,{isLoading:C},v)),g=({children:v,accessType:C,...T})=>{const S=h();return t.createElement(r.b9,{accessType:C},t.createElement(E,{...T,actions:t.createElement(p,{disabled:S})},t.createElement(D,null,v)))};function h(){const v=(0,n.A)();return["/edit","/new"].some(T=>v?.pathname?.includes(T))}const D=({children:v})=>{const{availableAlertManagers:C,selectedAlertmanager:T}=(0,r.VI)();return T?t.createElement(t.Fragment,null,v):t.createElement(a,{availableAlertManagers:C})}},71223:(G,I,e)=>{"use strict";e.d(I,{s:()=>p});var t=e(32196),n=e(96540),s=e(56034),r=e(40845),o=e(72109),m=e(55740),l=e(84396),i=e(16577),u=e(73750);const d=["message","description"],p=({annotationKey:f,value:P,valueLink:a})=>{const E=f,g=m.J3[E]?n.createElement(s.m,{content:f,placement:"top",theme:"info"},n.createElement("span",null,m.J3[E])):f;return n.createElement(l.X,{label:g,horizontal:!0},n.createElement(c,{annotationKey:f,value:P,valueLink:a}))},c=({annotationKey:f,value:P,valueLink:a})=>{const E=(0,r.of)(y),g=d.includes(f),h=P&&P.startsWith("http"),D=n.createElement(i.Y,{input:P,delimiter:["{{","}}"]});return a?n.createElement(o.Y,{href:a,external:!0},P):g?n.createElement(u.L,{className:E.well},D):h?n.createElement(o.Y,{href:P,external:!0},P):n.createElement(n.Fragment,null,D)},y=f=>({well:(0,t.css)({wordBreak:"break-word"})})},84396:(G,I,e)=>{"use strict";e.d(I,{X:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({className:m,label:l,horizontal:i,children:u,childrenWrapperClassName:d})=>{const p=(0,s.of)(o);return n.createElement("div",{className:(0,t.cx)(p.field,i?p.fieldHorizontal:p.fieldVertical,m)},n.createElement("div",null,l),n.createElement("div",{className:d},u))},o=m=>({fieldHorizontal:(0,t.css)({flexDirection:"row",[m.breakpoints.down("md")]:{flexDirection:"column"}}),fieldVertical:(0,t.css)({flexDirection:"column"}),field:(0,t.css)({display:"flex",margin:`${m.spacing(2)} 0`,"& > div:first-child":{width:"110px",paddingRight:m.spacing(1),fontSize:m.typography.size.sm,fontWeight:m.typography.fontWeightBold,lineHeight:1.8},"& > div:nth-child(2)":{flex:1,color:m.colors.text.secondary}})})},75591:(G,I,e)=>{"use strict";e.d(I,{E:()=>u});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(29158),m=e(19384),l=e(98439),i=e(22620);const u=({cols:p,items:c,isExpandable:y=!1,onCollapse:f,onExpand:P,isExpanded:a,renderExpandedContent:E,testIdGenerator:g,pagination:h,paginationStyles:D,renderPrefixCell:v,renderPrefixHeader:C,footerRow:T,dataTestId:S})=>{const O=(0,r.of)(i.H);if((f||P||a)&&!(f&&P&&a))throw new Error("either all of onCollapse, onExpand, isExpanded must be provided, or none");if((y||E)&&!(y&&E))throw new Error("either both isExpanded and renderExpandedContent must be provided, or neither");const x=(0,r.of)(d(p,y,!!C)),[b,M]=(0,n.useState)([]),A=w=>{a&&f&&P?a(w)?f(w):P(w):M(b.includes(w.id)?b.filter(L=>L!==w.id):[...b,w.id])},R=h?.itemsPerPage??c.length,{page:B,numberOfPages:U,onPageChange:W,pageItems:N}=(0,l.W)(c,1,R);return n.createElement(n.Fragment,null,n.createElement("div",{className:x.container,"data-testid":S??"dynamic-table"},n.createElement("div",{className:x.row,"data-testid":"header"},C&&C(),y&&n.createElement("div",{className:x.cell}),p.map(w=>n.createElement("div",{className:x.cell,key:w.id},w.label))),N.map((w,L)=>{const V=a?a(w):b.includes(w.id);return n.createElement("div",{className:x.row,key:`${w.id}-${L}`,"data-testid":g?.(w,L)??"row"},v&&v(w,L,c),y&&n.createElement("div",{className:(0,t.cx)(x.cell,x.expandCell)},n.createElement(o.K,{tooltip:`${V?"Collapse":"Expand"} row`,"data-testid":s.Tp.components.AlertRules.toggle,name:V?"angle-down":"angle-right",onClick:()=>A(w)})),p.map(K=>n.createElement("div",{className:(0,t.cx)(x.cell,x.bodyCell,K.className),"data-column":K.label,key:`${w.id}-${K.id}`},K.renderCell(w,L))),V&&E&&n.createElement("div",{className:x.expandedContentRow,"data-testid":s.Tp.components.AlertRules.expandedContent},E(w,L,c)))}),T&&n.createElement("div",{className:(0,t.cx)(x.row,x.footerRow)},T)),h&&n.createElement(m.d,{className:(0,t.cx)(O,D),currentPage:B,numberOfPages:U,onNavigate:W,hideWhenSinglePage:!0}))},d=(p,c,y)=>{const f=p.map(P=>P.size?typeof P.size=="number"?`${P.size}fr`:P.size:"auto");return c&&f.unshift("calc(1em + 16px)"),y&&f.unshift("0"),P=>({container:(0,t.css)({border:`1px solid ${P.colors.border.weak}`,borderRadius:P.shape.radius.default,color:P.colors.text.secondary}),row:(0,t.css)({display:"grid",gridTemplateColumns:f.join(" "),gridTemplateRows:"1fr auto","&:nth-child(2n + 1)":{backgroundColor:P.colors.background.secondary},"&:nth-child(2n)":{backgroundColor:P.colors.background.primary},[P.breakpoints.down("sm")]:{gridTemplateColumns:"auto 1fr",gridTemplateAreas:"left right",padding:`0 ${P.spacing(.5)}`,"&:first-child":{display:"none"},"& > *:first-child":{display:y?"none":void 0}}}),footerRow:(0,t.css)({display:"flex",padding:P.spacing(1)}),cell:(0,t.css)({display:"flex",alignItems:"center",padding:P.spacing(1),[P.breakpoints.down("sm")]:{padding:`${P.spacing(1)} 0`,gridTemplateColumns:"1fr"}}),bodyCell:(0,t.css)({overflow:"hidden",[P.breakpoints.down("sm")]:{gridColumnEnd:"right",gridColumnStart:"right","&::before":{content:"attr(data-column)",display:"block",color:P.colors.text.primary}}}),expandCell:(0,t.css)({justifyContent:"center",[P.breakpoints.down("sm")]:{alignItems:"start",gridArea:"left"}}),expandedContentRow:(0,t.css)({gridColumnEnd:f.length+1,gridColumnStart:y?3:2,gridRow:2,padding:`0 ${P.spacing(3)} 0 ${P.spacing(1)}`,position:"relative",[P.breakpoints.down("sm")]:{gridColumnStart:2,borderTop:`1px solid ${P.colors.border.strong}`,gridRow:"auto",padding:`${P.spacing(1)} 0 0 0`}})})}},10562:(G,I,e)=>{"use strict";e.d(I,{B:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(75591);const o=({renderExpandedContent:l,...i})=>{const u=(0,s.of)(m);return n.createElement(r.E,{renderExpandedContent:l?(d,p,c)=>n.createElement(n.Fragment,null,p!==c.length-1&&n.createElement("div",{className:(0,t.cx)(u.contentGuideline,u.guideline)}),l(d,p,c)):void 0,renderPrefixHeader:()=>n.createElement("div",{className:u.relative},n.createElement("div",{className:(0,t.cx)(u.headerGuideline,u.guideline)})),renderPrefixCell:(d,p,c)=>n.createElement("div",{className:u.relative},n.createElement("div",{className:(0,t.cx)(u.topGuideline,u.guideline)}),p!==c.length-1&&n.createElement("div",{className:(0,t.cx)(u.bottomGuideline,u.guideline)})),...i})},m=l=>({relative:(0,t.css)({position:"relative",height:"100%"}),guideline:(0,t.css)({left:"-19px",borderLeft:`1px solid ${l.colors.border.weak}`,position:"absolute",[l.breakpoints.down("md")]:{display:"none"}}),topGuideline:(0,t.css)({width:"18px",borderBottom:`1px solid ${l.colors.border.medium}`,top:0,bottom:"50%"}),bottomGuideline:(0,t.css)({top:"50%",bottom:0}),contentGuideline:(0,t.css)({top:0,bottom:0,left:"-49px !important"}),headerGuideline:(0,t.css)({top:"-17px",bottom:0})})},35108:(G,I,e)=>{"use strict";e.d(I,{j:()=>u});var t=e(32196),n=e(46942),s=e.n(n),r=e(96540),o=e(40845),m=e(67061),l=e(95868),i=e(13840);const u=({children:p,header:c,content:y,footer:f,arrow:P,showAfter:a=300,wrapperClassName:E,disabled:g=!1,...h})=>{const D=(0,r.useRef)(null),v=(0,o.of)(d);if(g)return p;const C=r.createElement(m.B,{direction:"column",gap:0,role:"tooltip"},c&&r.createElement("div",{className:v.card.header},c),r.createElement("div",{className:v.card.body},y),f&&r.createElement("div",{className:v.card.footer},f));return r.createElement(l.I,{content:C,hideAfter:100},(T,S,O)=>r.createElement(r.Fragment,null,D.current&&r.createElement(i.A,{...O,...h,wrapperClassName:s()(v.popover,E),onMouseLeave:S,onMouseEnter:T,onFocus:T,onBlur:S,referenceElement:D.current,renderArrow:P}),r.cloneElement(p,{ref:D,onMouseEnter:T,onMouseLeave:S,onFocus:T,onBlur:S,tabIndex:0})))},d=p=>({popover:(0,t.css)({borderRadius:p.shape.radius.default,boxShadow:p.shadows.z3,background:p.colors.background.primary,border:`1px solid ${p.colors.border.medium}`}),card:{body:(0,t.css)({padding:p.spacing(1)}),header:(0,t.css)({padding:p.spacing(1),background:p.colors.background.secondary,borderBottom:`solid 1px ${p.colors.border.medium}`}),footer:(0,t.css)({padding:p.spacing(.5,1),background:p.colors.background.secondary,borderTop:`solid 1px ${p.colors.border.medium}`})}})},93810:(G,I,e)=>{"use strict";e.d(I,{A:()=>r});var t=e(96540),n=e(42418);const r=()=>t.createElement(n.F,{severity:"info",title:"Alert evaluation currently paused"},"Notifications for this rule will not fire and no alert instances will be created until the rule is un-paused.")},8406:(G,I,e)=>{"use strict";e.d(I,{J:()=>l});var t=e(32196),n=e(96540),s=e(84140),r=e(40845),o=e(67061),m=e(14578);const l=({label:u,value:d,icon:p,color:c,size:y="md"})=>{const f=(0,r.of)(i,c,y),P=`${u}: ${d}`;return n.createElement("div",{className:f.wrapper,role:"listitem","aria-label":P,"data-testid":"label-value"},n.createElement(o.B,{direction:"row",gap:0,alignItems:"stretch"},n.createElement("div",{className:f.label},n.createElement(o.B,{direction:"row",gap:.5,alignItems:"center"},p&&n.createElement(m.I,{name:p}),u&&n.createElement("span",{className:f.labelText,title:u.toString()},u??""))),d&&n.createElement("div",{className:f.value,title:d.toString()},d)))},i=(u,d,p)=>{const c=d??u.colors.secondary.main,y=u.isDark?(0,s.A)(c).lighten(5).toString():(0,s.A)(c).darken(5).toString(),f=u.isDark?(0,s.A)(c).darken(5).toString():(0,s.A)(c).lighten(5).toString(),P=d?s.A.mostReadable(c,["#000","#fff"]).toString():u.colors.text.primary;let a=u.spacing(.33,1);switch(p){case"sm":a=u.spacing(.2,.6);break;case"xs":a=u.spacing(0,.5);break;default:break}return{wrapper:(0,t.css)({color:P,fontSize:u.typography.bodySmall.fontSize,borderRadius:u.shape.borderRadius(2)}),labelText:(0,t.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"}),label:(0,t.css)({display:"flex",alignItems:"center",color:"inherit",padding:a,background:c,border:`solid 1px ${y}`,borderTopLeftRadius:u.shape.borderRadius(2),borderBottomLeftRadius:u.shape.borderRadius(2)}),value:(0,t.css)({color:"inherit",padding:a,background:f,border:`solid 1px ${y}`,borderLeft:"none",borderTopRightRadius:u.shape.borderRadius(2),borderBottomRightRadius:u.shape.borderRadius(2),whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"})}}},55196:(G,I,e)=>{"use strict";e.d(I,{P:()=>l});var t=e(32196),n=e(96540),s=e(40845),r=e(94753),o=e(67061),m=e(14578);const l=({children:u,icon:d,color:p="secondary",direction:c="row",...y})=>{const f=(0,s.of)(i),P=typeof y.onClick=="function",a=c==="row",E=a?"center":"flex-start",g=a?.5:0;return n.createElement("div",{className:(0,t.cx)({[f.interactive]:P}),...y},n.createElement(r.E,{variant:"bodySmall",color:p},n.createElement(o.B,{direction:c,alignItems:E,gap:g,wrap:"wrap"},d&&n.createElement(m.I,{size:"xs",name:d}),u)))},i=()=>({interactive:(0,t.css)({cursor:"pointer"})})},90141:(G,I,e)=>{"use strict";e.d(I,{A:()=>m});var t=e(96540),n=e(55852),s=e(67061),r=e(14578);const m=(0,t.forwardRef)(function(i,u){return t.createElement(n.$n,{variant:"secondary",size:"sm",type:"button","aria-label":"More",ref:u,...i},t.createElement(s.B,{direction:"row",alignItems:"center",gap:0},"More ",t.createElement(r.I,{name:"angle-down"})))})},76156:(G,I,e)=>{"use strict";e.d(I,{h:()=>r});var t=e(96540),n=e(12210);const s=({children:o,plugin:m,loadingComponent:l,notInstalledFallback:i})=>{const{loading:u,installed:d}=usePluginBridge(m);return u?l??null:d?React.createElement(React.Fragment,null,o):i??null};function r(o,m,l){const i=new URLSearchParams(l).toString();return`/a/${o}${m}`+(i?"?"+i:"")}},48205:(G,I,e)=>{"use strict";e.d(I,{Yi:()=>o,hk:()=>r,rS:()=>m});var t=e(96540),n=e(42418),s=e(39938),r=(l=>(l.ContactPoint="contact point",l.Template="template",l.MuteTiming="mute timing",l.AlertRule="alert rule",l.RootNotificationPolicy="root notification policy",l))(r||{});const o=({resource:l,...i})=>t.createElement(n.F,{title:`This ${l} cannot be edited through the UI`,severity:"info",...i},"This ",l," has been provisioned, that means it was created by config. Please contact your server admin to update this ",l,"."),m=()=>t.createElement(s.E,{text:"Provisioned",color:"purple"})},82437:(G,I,e)=>{"use strict";e.d(I,{c:()=>r});var t=e(96540),n=e(94753),s=e(14578);const r=({namespace:o,group:m})=>m?t.createElement(n.E,{element:"h3",variant:"body"},o," ",t.createElement(s.I,{name:"angle-right","aria-label":">"})," ",m):t.createElement(n.E,{element:"h3",variant:"body"},o)},26058:(G,I,e)=>{"use strict";e.d(I,{h:()=>s});var t=e(32196),n=e(96540);const s=()=>n.createElement("span",{className:(0,t.css)({flex:1})})},65415:(G,I,e)=>{"use strict";e.d(I,{O:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=(0,n.forwardRef)(({children:m,state:l,size:i="md",muted:u=!1},d)=>{const p=(0,s.of)(o);return n.createElement("span",{className:(0,t.cx)(p.common,p[l],p[i],{[p.muted]:u}),ref:d},m||l)});r.displayName="StateTag";const o=m=>({common:(0,t.css)({display:"inline-block",color:"white",borderRadius:m.shape.radius.default,fontSize:m.typography.size.sm,textTransform:"capitalize",lineHeight:"1.2",textAlign:"center",fontWeight:m.typography.fontWeightBold}),good:(0,t.css)({backgroundColor:m.colors.success.main,border:`solid 1px ${m.colors.success.main}`,color:m.colors.success.contrastText}),warning:(0,t.css)({backgroundColor:m.colors.warning.main,border:`solid 1px ${m.colors.warning.main}`,color:m.colors.warning.contrastText}),bad:(0,t.css)({backgroundColor:m.colors.error.main,border:`solid 1px ${m.colors.error.main}`,color:m.colors.error.contrastText}),neutral:(0,t.css)({backgroundColor:m.colors.secondary.main,border:`solid 1px ${m.colors.secondary.main}`,color:m.colors.secondary.contrastText}),info:(0,t.css)({backgroundColor:m.colors.primary.main,border:`solid 1px ${m.colors.primary.main}`,color:m.colors.primary.contrastText}),md:(0,t.css)({padding:m.spacing(.5,1),minWidth:m.spacing(8)}),sm:(0,t.css)({padding:m.spacing(.3,.5),minWidth:"52px"}),muted:(0,t.css)({opacity:"0.5"})})},16577:(G,I,e)=>{"use strict";e.d(I,{Y:()=>i});var t=e(32196),n=e(96540),s=e(40845),r=e(39938),o=e(35108),m=e(83225);const l=["$",".",'"'];function i({input:a,delimiter:E=["{{","}}"]}){const g=(0,s.of)(P),[h,D]=E,v=new RegExp(`(?<before>.*?)(${h}(?<token>.*?)${D}|$)`,"gm"),C=a.split(`
`),T=[];return C.forEach((S,O)=>{Array.from(S.matchAll(v)).forEach((b,M)=>{const A=b.groups?.before,R=b.groups?.token?.trim();if(A&&T.push(n.createElement("span",{key:`${O}-${M}-before`},A)),R){const B=f(R),U=B==="variable"?R:"",W=`${h} ${R} ${D}`;T.push(n.createElement(d,{key:`${O}-${M}-token`,content:W,type:B,description:U}))}}),T.push(n.createElement("br",{key:`${O}-newline`}))}),n.createElement("span",{className:g.wrapper},T)}var u=(a=>(a.Variable="variable",a.Function="function",a.Keyword="keyword",a.Unknown="unknown",a))(u||{});function d({content:a,description:E,type:g}){const h=(0,s.of)(P),D=!g;return n.createElement(o.j,{placement:"top-start",disabled:D,content:n.createElement("div",{className:h.hoverTokenItem},n.createElement(r.E,{tabIndex:0,text:n.createElement(n.Fragment,null,g),color:"blue"})," ",E&&n.createElement("code",null,E))},n.createElement("span",null,n.createElement(r.E,{tabIndex:0,className:h.token,text:a,color:"blue"})))}function p(a){return l.some(E=>a.startsWith(E))}function c(a){return m.keywords.some(E=>a.startsWith(E))}function y(a){return m.builtinFunctions.some(E=>a.startsWith(E))}function f(a){let E;return p(a)?E="variable":c(a)?E="keyword":y(a)?E="function":E="unknown",E}const P=a=>({wrapper:(0,t.css)({whiteSpace:"pre-wrap"}),token:(0,t.css)({cursor:"default",fontFamily:a.typography.fontFamilyMonospace}),popover:(0,t.css)({borderRadius:a.shape.radius.default,boxShadow:a.shadows.z3,background:a.colors.background.primary,border:`1px solid ${a.colors.border.medium}`,padding:a.spacing(1)}),hoverTokenItem:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"center",gap:a.spacing(1)})})},73750:(G,I,e)=>{"use strict";e.d(I,{L:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({children:m,className:l})=>{const i=(0,s.of)(o);return n.createElement("div",{className:(0,t.cx)(i.wrapper,l)},m)},o=m=>({wrapper:(0,t.css)({backgroundColor:m.components.panel.background,border:`solid 1px ${m.components.input.borderColor}`,borderRadius:m.shape.radius.default,padding:m.spacing(.5,1),fontFamily:m.typography.fontFamilyMonospace})})},96636:(G,I,e)=>{"use strict";e.d(I,{d:()=>s});var t=e(96540),n=e(14778);const s=({component:r,title:o="previous page"})=>{const m=(0,n.i)(),l=(0,t.useCallback)(()=>{m(o)},[m,o]);return t.cloneElement(r,{onClick:l})}},53876:(G,I,e)=>{"use strict";e.d(I,{X:()=>y});var t=e(32196),n=e(96540),s=e(40996),r=e(40845),o=e(14578),m=e(88575),l=e(60029),i=e(67061),u=e(56034),d=e(10354),p=e(25027),c=e(98164);const y=({onFilterChange:P,defaultQueryString:a})=>{const E=(0,r.of)(f),[g,h]=n.useState(a??"");(0,s.A)(()=>{(0,p.fH)(p.le.filterByLabel),P(g)},600,[g]);const D=n.createElement(o.I,{name:"search"}),v=a?(0,c.J$)(a).length===0:!1;return n.createElement(m.D,{className:E.fixMargin,invalid:v||void 0,error:v?"Query must use valid matcher syntax. See the examples in the help tooltip.":null,label:n.createElement(l.J,null,n.createElement(i.B,{gap:.5,alignItems:"center"},n.createElement("span",null,"Search by label"),n.createElement(u.m,{content:n.createElement("div",null,"Filter alerts using label querying without spaces, ex:",n.createElement("pre",null,'{severity="critical", instance=~"cluster-us-.+"}'),"Invalid use of spaces:",n.createElement("pre",null,'{severity= "critical"}'),n.createElement("pre",null,'{severity ="critical"}'),"Valid use of spaces:",n.createElement("pre",null,'{severity=" critical"}'),"Filter alerts using label querying without braces, ex:",n.createElement("pre",null,'severity="critical", instance=~"cluster-us-.+"'))},n.createElement(o.I,{name:"info-circle",size:"sm"}))))},n.createElement(d.p,{placeholder:"Search",value:g,onChange:C=>h(C.currentTarget.value),"data-testid":"search-query-input",prefix:D,className:E.inputWidth}))},f=P=>({fixMargin:(0,t.css)({marginBottom:0}),inputWidth:(0,t.css)({width:340,flexGrow:0})})},56528:(G,I,e)=>{"use strict";e.d(I,{GX:()=>B,r4:()=>A});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(49785),m=e(39070),l=e(19845),i=e(72724),u=e(40845),d=e(42418),p=e(67061),c=e(55852),y=e(51440),f=e(29158),P=e(98808),a=e(71680),E=e(1712),g=e(34263),h=e(18225),D=e(76658),v=e(66718),C=e(94822),T=e(98439),S=e(35108),O=e(26058),x=e(30423),b=e(81875),M=e(99106);const A=({queries:K=[],query:k,data:j,error:H,warning:J,isAlertCondition:X,onSetCondition:se,onUpdateRefId:ae,onRemoveExpression:ne,onUpdateExpressionType:q,onChangeQuery:ee})=>{const z=(0,u.of)(V),te=k?.type,{setError:ie,clearErrors:ce}=(0,o.xW)(),ue=(0,r.useCallback)(Me=>{Me?ie("queries",{type:"custom",message:Me}):ce("queries")},[ie,ce]),fe=j&&Object.values(j).some(Me=>!!Me&&Me.state===m.Gu.Loading),Te=Array.isArray(j?.series)&&!fe,he=j?.series??[],de=X??!1,{seriesCount:le,groupedByState:pe}=W(he),ve=(0,r.useCallback)(Me=>{const Ue=K.filter(we=>Me.refId!==we.refId).map(we=>({value:we.refId,label:we.refId}));switch(Me.type){case v.Tz.math:return r.createElement(a.z,{onChange:ee,query:Me,labelWidth:"auto",onRunQuery:()=>{}});case v.Tz.reduce:return r.createElement(E.Z,{onChange:ee,refIds:Ue,labelWidth:"auto",query:Me});case v.Tz.resample:return r.createElement(g.C,{onChange:ee,query:Me,labelWidth:"auto",refIds:Ue});case v.Tz.classic:return r.createElement(P.z,{onChange:ee,query:Me,refIds:Ue});case v.Tz.threshold:return r.createElement(D.O,{onChange:ee,query:Me,labelWidth:"auto",refIds:Ue,onError:ue,useHysteresis:!0});case v.Tz.sql:return r.createElement(h.k,{onChange:ee,query:Me,refIds:Ue});default:return r.createElement(r.Fragment,null,"Expression not supported: ",Me.type)}},[ee,K,ue]),Oe=v.uQ.find(Me=>Me.value===te)?.description??"";return r.createElement("div",{className:(0,t.cx)(z.expression.wrapper,de&&z.expression.alertCondition,te===v.Tz.classic&&z.expression.classic,te!==v.Tz.classic&&z.expression.nonClassic)},r.createElement("div",{className:z.expression.stack},r.createElement(N,{refId:k.refId,queryType:te,onRemoveExpression:()=>ne(k.refId),onUpdateRefId:Me=>ae(k.refId,Me),onUpdateExpressionType:Me=>q(k.refId,Me),onSetCondition:se,query:k,alertCondition:de}),r.createElement("div",{className:z.expression.body},H&&r.createElement(d.F,{title:"Expression failed",severity:"error"},H.message),J&&r.createElement(d.F,{title:"Expression warning",severity:"warning"},J.message),r.createElement("div",{className:z.expression.description},Oe),ve(k)),Te&&r.createElement(r.Fragment,null,r.createElement(B,{series:he,isAlertCondition:X}),r.createElement("div",{className:z.footer},r.createElement(p.B,{direction:"row",alignItems:"center"},r.createElement(O.h,null),r.createElement(U,{isCondition:!!X,firing:pe[C.cF.Firing].length,normal:pe[C.cF.Inactive].length,seriesCount:le}))))))},R=20,B=({series:K,isAlertCondition:k})=>{const{pageItems:j,previousPage:H,nextPage:J,numberOfPages:X,pageStart:se,pageEnd:ae}=(0,T.W)(K,1,R),ne=(0,u.of)(V),q=(0,M.PI)(K),ee=!q&&(0,l.jq)(K),z=X>1;return r.createElement("div",{className:ne.expression.results},!q&&ee&&r.createElement("div",null,j.map((te,ie)=>r.createElement(L,{key:(0,n.uniqueId)(),frame:te,index:se+ie,isAlertCondition:k}))),!q&&!ee&&j.map((te,ie)=>r.createElement(w,{key:(0,n.uniqueId)(),frame:te,index:se+ie,isAlertCondition:k})),q&&r.createElement("div",{className:(0,t.cx)(ne.expression.noData,ne.mutedText)},"No data"),z&&r.createElement("div",{className:ne.pagination.wrapper,"data-testid":"paginate-expression"},r.createElement(p.B,null,r.createElement(c.$n,{variant:"secondary",fill:"outline",onClick:H,icon:"angle-left",size:"sm","aria-label":"previous-page"}),r.createElement(O.h,null),r.createElement("span",{className:ne.mutedText},se," - ",ae," of ",K.length),r.createElement(O.h,null),r.createElement(c.$n,{variant:"secondary",fill:"outline",onClick:J,icon:"angle-right",size:"sm","aria-label":"next-page"}))))},U=({firing:K,normal:k,isCondition:j,seriesCount:H})=>{const{mutedText:J}=(0,u.of)(V);return H===0?r.createElement("span",{className:J},"No series"):j?r.createElement("span",{className:J},`${H} series: ${K} firing, ${k} normal`):r.createElement("span",{className:J},`${H} series`)};function W(K){const k=K.filter(J=>(0,M.Lm)(J)===void 0).length,j={[C.cF.Firing]:K.filter(J=>(0,M.Lm)(J)!==void 0&&(0,M.Lm)(J)!==0),[C.cF.Inactive]:K.filter(J=>(0,M.Lm)(J)===0)},H=K.length-k;return{groupedByState:j,seriesCount:H}}const N=({refId:K,queryType:k,onUpdateRefId:j,onRemoveExpression:H,onSetCondition:J,alertCondition:X,query:se})=>{const ae=(0,u.of)(V),ne=(0,u.of)(c.my),[q,ee]=(0,r.useState)(!1),te=q!==!1&&q==="refId";return r.createElement("header",{className:ae.header.wrapper},r.createElement(p.B,{direction:"row",gap:.5,alignItems:"center"},r.createElement(p.B,{direction:"row",gap:1,alignItems:"center"},!te&&r.createElement("button",{type:"button",className:(0,t.cx)(ne,ae.editable),onClick:()=>ee("refId")},r.createElement("div",{className:ae.expression.refId},K)),te&&r.createElement(y.D,{autoFocus:!0,defaultValue:K,minWidth:5,onChange:ie=>{j(ie.currentTarget.value),ee(!1)},onFocus:ie=>ie.target.select(),onBlur:ie=>{j(ie.currentTarget.value),ee(!1)}}),r.createElement("div",null,(0,v.NI)(k))),r.createElement(O.h,null),r.createElement(b.a,{onSetCondition:()=>J(se.refId),isCondition:X}),r.createElement(f.K,{name:"trash-alt",variant:"secondary",className:ae.mutedIcon,onClick:H,tooltip:"Remove expression"})))},w=({frame:K,index:k,isAlertCondition:j})=>{const H=(0,u.of)(V),J=(0,M.Jw)(K)||"Series "+k,X=(0,M.Lm)(K),se=(0,M.JQ)(K),ae=Object.entries(se),ne=ae.length>0,q=j&&X!==0,ee=j&&X===0,z=`${ne?"":J}${ne?`{${(0,M.h6)(se)}}`:""}`;return r.createElement("div",{className:H.expression.resultsRow},r.createElement(p.B,{direction:"row",gap:1,alignItems:"center"},r.createElement("div",{className:H.expression.resultLabel,title:z},r.createElement("span",null,ne?"":J),ne&&r.createElement(r.Fragment,null,r.createElement("span",null,"{"),ae.map(([te,ie],ce)=>r.createElement("span",{key:(0,n.uniqueId)()},r.createElement("span",{className:H.expression.labelKey},te),r.createElement("span",null,"="),r.createElement("span",null,'"'),r.createElement("span",{className:H.expression.labelValue},ie),r.createElement("span",null,'"'),ce<ae.length-1&&r.createElement("span",null,", "))),r.createElement("span",null,"}"))),r.createElement("div",{className:H.expression.resultValue},X),q&&r.createElement(x.C,{state:C.cF.Firing,size:"sm"}),ee&&r.createElement(x.C,{state:C.cF.Inactive,size:"sm"})))},L=({frame:K,index:k})=>{const j=(0,u.of)(V),H=K.fields[1],J=H.labels,se=H.config?.displayNameFromDS??(J?(0,M.h6)(H.labels??{}):"Series "+k),ae=K.fields[0].values,ne=ee=>K.fields[0].values[ee],q=ee=>K.fields[1].values[ee];return r.createElement("div",{className:j.expression.resultsRow},r.createElement(p.B,{direction:"row",alignItems:"center"},r.createElement("span",{className:(0,t.cx)(j.mutedText,j.expression.resultLabel),title:se},se),r.createElement("div",{className:j.expression.resultValue},r.createElement(S.j,{placement:"right",wrapperClassName:j.timeseriesTableWrapper,content:r.createElement("table",{className:j.timeseriesTable},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Timestamp"),r.createElement("th",null,"Value"))),r.createElement("tbody",null,ae.map((ee,z)=>r.createElement("tr",{key:z},r.createElement("td",{className:j.mutedText},(0,i.LE)(ne(z))),r.createElement("td",{className:j.expression.resultValue},q(z))))))},r.createElement("span",null,"Time series data")))))},V=K=>({expression:{wrapper:(0,t.css)({display:"flex",border:`solid 1px ${K.colors.border.medium}`,flex:1,flexBasis:"400px",borderRadius:K.shape.radius.default}),stack:(0,t.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",gap:0,width:"100%",minWidth:"0"}),classic:(0,t.css)({maxWidth:"100%"}),nonClassic:(0,t.css)({maxWidth:"640px"}),alertCondition:(0,t.css)({}),body:(0,t.css)({padding:K.spacing(1),flex:1}),description:(0,t.css)({marginBottom:K.spacing(1),fontSize:K.typography.size.xs,color:K.colors.text.secondary}),refId:(0,t.css)({fontWeight:K.typography.fontWeightBold,color:K.colors.primary.text}),results:(0,t.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",borderTop:`solid 1px ${K.colors.border.medium}`}),noResults:(0,t.css)({display:"flex",alignItems:"center",justifyContent:"center"}),resultsRow:(0,t.css)({padding:`${K.spacing(.75)} ${K.spacing(1)}`,"&:nth-child(odd)":{backgroundColor:K.colors.background.secondary},"&:hover":{backgroundColor:K.colors.background.canvas}}),labelKey:(0,t.css)({color:K.isDark?"#73bf69":"#56a64b"}),labelValue:(0,t.css)({color:K.isDark?"#ce9178":"#a31515"}),resultValue:(0,t.css)({textAlign:"right"}),resultLabel:(0,t.css)({flex:1,overflowX:"auto",display:"inline-block",whiteSpace:"nowrap"}),noData:(0,t.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:K.spacing()})},mutedText:(0,t.css)({color:K.colors.text.secondary,fontSize:"0.9em",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),header:{wrapper:(0,t.css)({background:K.colors.background.secondary,padding:`${K.spacing(.5)} ${K.spacing(1)}`,borderBottom:`solid 1px ${K.colors.border.weak}`})},footer:(0,t.css)({background:K.colors.background.secondary,padding:K.spacing(1),borderTop:`solid 1px ${K.colors.border.weak}`}),draggableIcon:(0,t.css)({cursor:"grab"}),mutedIcon:(0,t.css)({color:K.colors.text.secondary}),editable:(0,t.css)({padding:`${K.spacing(.5)} ${K.spacing(1)}`,border:`solid 1px ${K.colors.border.weak}`,borderRadius:K.shape.radius.default,display:"flex",flexDirection:"row",alignItems:"center",gap:K.spacing(1),cursor:"pointer"}),timeseriesTableWrapper:(0,t.css)({maxHeight:"500px",overflowY:"scroll"}),timeseriesTable:(0,t.css)({tableLayout:"auto",width:"100%",height:"100%","td, th":{padding:K.spacing(1)},td:{background:K.colors.background.primary},th:{background:K.colors.background.secondary},tr:{borderBottom:`1px solid ${K.colors.border.medium}`,"&:last-of-type":{borderBottom:"none"}}}),pagination:{wrapper:(0,t.css)({borderTop:`1px solid ${K.colors.border.medium}`,padding:K.spacing()})}})},81875:(G,I,e)=>{"use strict";e.d(I,{a:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(39938),o=e(55852);const m=({isCondition:i,onSetCondition:u})=>{const d=(0,s.of)(l);return i?n.createElement(r.E,{key:"condition",color:"green",icon:"check",text:"Alert condition"}):n.createElement("button",{key:"make-condition",type:"button",className:d.actionLink,onClick:()=>u&&u()},"Set as alert condition")},l=i=>{const u=(0,o.my)(i);return{actionLink:(0,t.css)(u,{color:i.colors.text.link,cursor:"pointer","&:hover":{textDecoration:"underline"}})}}},99106:(G,I,e)=>{"use strict";e.d(I,{EL:()=>u,JQ:()=>l,Jw:()=>o,Lm:()=>m,PI:()=>p,h6:()=>i,wf:()=>d});var t=e(2543),n=e.n(t),s=e(97706),r=e(57220);const o=c=>{const y=c.fields[0];return y?.config?.displayNameFromDS??c.name??y?.labels?.__name__},m=c=>{const y=c.fields[0]?.values[0];return Number.isFinite(y)?(0,s.h)(y,5):y},l=c=>c.fields[0]?.labels??{},i=c=>Object.entries(c).map(([y,f])=>y+"="+f).join(", "),u=c=>{const y=c.name;if((0,r.Eb)(c.rulesSource))return{name:y,parents:[]};try{const f=JSON.parse(y);if(!Array.isArray(f))throw new Error("not a nested Grafana folder");const P=(0,t.last)(f)??y,a=(0,t.dropRight)(f,1);return{name:P,parents:a}}catch{return{name:c.name,parents:[]}}},d=(c,y=[])=>JSON.stringify(y.concat(c)),p=c=>c.every(f=>f.fields.every(P=>P.values.every(a=>a==null)))},83225:(G,I,e)=>{"use strict";e.r(I),e.d(I,{AlertmanagerTemplateFunction:()=>n,availableAlertManagerFunctions:()=>s,builtinFunctions:()=>o,conf:()=>i,keywords:()=>m,language:()=>l});var t=(u=>(u.Delimiter="delimiter",u.Keyword="keyword",u.Function="type.identifier",u.String="string",u.Variable="variable.name",u.Number="number",u.Comment="comment",u.Operator="operator",u.Identifier="idenfifier",u))(t||{}),n=(u=>(u.toUpper="toUpper",u.toLower="toLower",u.title="title",u.join="join",u.match="match",u.safeHtml="safeHtml",u.reReplaceAll="reReplaceAll",u.stringSlice="stringSlice",u))(n||{});const s=Object.values(n),o=["and","call","html","index","slice","js","len","not","or","print","printf","println","urlquery",...["eq","ne","lt","le","gt","ge"]],m=["define","if","else","end","range","break","continue","template","block","with"],l={defaultToken:"",keywords:m,functions:[...o,...s],operators:["|"],tokenizer:{root:[[/"/,"string","@string"],[/`/,"string","@rawstring"],[/\d*\d+[eE]([\-+]?\d+)?/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F]/,"number.hex"],[/0[0-7']*[0-7]/,"number.octal"],[/0[bB][0-1']*[0-1]/,"number.binary"],[/\d[\d']*/,"number"],[/\d/,"number"],[/[;,.]/,"delimiter"],[/{{-?/,"delimiter"],[/-?}}/,"delimiter"],[/\.([A-Za-z]+)?/,"variable.name"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":{token:"keyword"},"@functions":{token:"type.identifier"},"@default":"idenfifier"}}],[/\/\*.*\*\//,"comment"]],string:[[/[^\\"]+/,"string"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],rawstring:[[/[^\`]/,"string"],[/`/,"string","@pop"]]}},i={comments:{blockComment:["/*","*/"]},brackets:[["{{","}}"],["(",")"]],autoClosingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}]}},37534:(G,I,e)=>{"use strict";e.d(I,{FI:()=>t,J4:()=>n,p8:()=>r});const t="grafana_alerting";var n=(o=>(o.OnCall="oncall",o))(n||{});const s=(o,m)=>m.includes(o),r=(o,m)=>{if(!o.grafana_managed_receiver_configs)return!1;const l=o.grafana_managed_receiver_configs.length===1,i=s(o.grafana_managed_receiver_configs[0]?.settings?.url??"",m.map(u=>u.integration_url));return l&&i}},74685:(G,I,e)=>{"use strict";e.d(I,{j:()=>d});var t=e(32196),n=e(96540),s=e(70713),r=e(19845),o=e(40845),m=e(28138),l=e(72519),i=e(56528),u=e(7921);const d=({data:c,thresholds:y,thresholdsType:f})=>{const P=(0,o.of)(p),a=(0,r.jq)(c.series),E=(0,u.yW)(c),g=f?{mode:f}:void 0,h={from:c.timeRange.from.valueOf(),to:c.timeRange.to.valueOf()};return n.createElement("div",{className:P.wrapper},n.createElement(s.Ay,{disableHeight:!0},({width:D})=>n.createElement("div",{style:{width:D}},a?n.createElement(l.y,{statusMessage:E,data:c.series,eventBus:m.A,height:300,width:D,absoluteRange:h,timeZone:"browser",onChangeTime:()=>{},splitOpenFn:()=>{},loadingState:c.state,thresholdsConfig:y,thresholdsStyle:g}):n.createElement("div",{className:P.instantVectorResultWrapper},n.createElement("header",{className:P.title},"Table"),n.createElement(i.GX,{series:c.series})))))},p=c=>({wrapper:(0,t.css)({width:"100%",position:"relative"}),instantVectorResultWrapper:(0,t.css)({border:`solid 1px ${c.colors.border.medium}`,borderRadius:c.shape.radius.default,padding:0,display:"flex",flexDirection:"column",flexWrap:"nowrap"}),title:(0,t.css)({label:"panel-title",padding:c.spacing(),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:c.typography.h6.fontSize,fontWeight:c.typography.h6.fontWeight})})},7921:(G,I,e)=>{"use strict";e.d(I,{G0:()=>T,zy:()=>S,lb:()=>O,YG:()=>B,yW:()=>A,an:()=>b,I3:()=>D,xb:()=>C,_u:()=>R,yr:()=>x});var t=e(2543),n=e(19845),s=e(50082),r=e(39070),o=e(52622),m=e(2913),l=e(55907),i=e(69437),u=e(66718),d=e(86590),p=e(41811),c=e(34525);const y=(0,p.A)(f,(U,W)=>h(U[0])===h(W[0]));function f(U){const W=new c.TS,N=U.map(w=>w.refId);return W.createNodes(N),U.forEach(w=>{const L=w.refId;((0,i.f)(w.model)&&w.model.type==="math"?P(w.model.expression??""):[w.model.expression]).forEach(k=>{L&&k&&!(L===k)&&W.link(k,L)})}),W}function P(U){const W=new RegExp(/\$\{(?<var>[a-zA-Z0-9_ ]+?)\}/gm),N=new RegExp(/\$(?<var>[a-zA-Z0-9_]+)/gm),w=Array.from(U.matchAll(W)).map(V=>V.groups?.var),L=Array.from(U.matchAll(N)).map(V=>V.groups?.var);return(0,t.compact)((0,t.uniq)([...w,...L]))}const a=(0,t.memoize)(E,(U,W)=>U+g(W));function E(U,W){const N=W.getNode(U);let w=[];function L(V){const K=V.inputEdges;K.length>0?K.forEach(k=>{k.inputNode&&L(k.inputNode)}):w?.push(V)}return L(N),w.map(V=>V.name)}function g(U){return Object.keys(U.nodes).map(W=>{const N=U.nodes[W];let w=N.outputEdges.map(V=>V.outputNode?.name).join(", "),L=N.inputEdges.map(V=>V.inputNode?.name).join(", ");return`${N.name}:${w}:${L}`}).join(" ")}function h(U){return U.map(W=>{const N=(0,i.f)(W.model)?W.model.type:W.queryType;return W.refId+(W.model.expression??"")+N}).join()}function D(U,W,N){return U.map(w=>{if(W===N||!(0,i.f)(w.model))return w;const L=w.model.type==="math",V=w.model.type==="reduce",K=w.model.type==="resample",k=w.model.type==="classic_conditions",j=w.model.type==="threshold";if(L)return{...w,model:{...w.model,expression:v(w.model.expression??"",W,N)}};if(K||V||j){const H=w.model.expression===W;return{...w,model:{...w.model,expression:H?N:w.model.expression}}}if(k){const H=w.model.conditions?.map(J=>({...J,query:{...J.query,params:J.query.params.map(X=>X===W?N:X)}}));return{...w,model:{...w.model,conditions:H}}}return w})}function v(U,W,N){const w=new RegExp("(\\$"+W+"\\b)|(\\${"+W+"})","gm"),L="${"+N+"}";return U.replace(w,L)}function C(U,W){return U.find(N=>N.refId===W)!==void 0}function T(U){return U.includes("/")||U.includes("\\")?'Cannot contain "/" or "\\" characters':!0}function S(U){if(U.series.length===0)return;const W=(0,n.jq)(U.series);let N;return W&&(N=new Error("You cannot use time series data as an alert condition, consider adding a reduce expression.")),N}function O(U){if(U.errors?.length)return new Error(U.errors[0].message)}function x(U){const N=(U[0]?.meta?.notices??[]).find(w=>w.severity==="warning")?.text;return N?new Error(N):void 0}function b(U,W){const N={},w=[u.Tz.threshold,u.Tz.classic];if(!W)return N;for(const K of U){if(!(0,i.f)(K.model)||!w.includes(K.model.type)||!Array.isArray(K.model.conditions)||K.model.refId!==W)continue;const k=K.model.conditions.some(M);K.model.conditions.forEach(j=>{const H=j.evaluator.params,J=j.query?.params[0]??K.model.expression;if(!J)return;const X=M(j);try{const se=y(U),ae=a(J,se);U.filter(q=>ae.includes(q.refId)).forEach(q=>{const ee=q.refId,te=!!(!(0,i.f)(q?.model)&&ee);ee&&!N[ee]&&(N[ee]={config:{mode:s.O.Absolute,steps:[]},mode:o.Ly.Line}),ee&&te&&!X&&!k?L(ee,H[0]):ee&&te&&X&&(V(ee,H,j.evaluator.type),N[ee].mode=o.Ly.LineAndArea)})}catch(se){console.error("Failed to parse thresholds",se);return}})}function L(K,k){N[K].config.steps.push({value:-1/0,color:"transparent"},{value:k,color:m.config.theme2.colors.error.main})}function V(K,k,j){j===l.p.IsWithinRange&&N[K].config.steps.push({value:-1/0,color:"transparent"},{value:k[0],color:m.config.theme2.colors.error.main},{value:k[1],color:m.config.theme2.colors.error.main},{value:k[1],color:"transparent"}),j===l.p.IsOutsideRange&&N[K].config.steps.push({value:-1/0,color:m.config.theme2.colors.error.main},{value:k[0],color:m.config.theme2.colors.error.main},{value:k[0],color:"transparent"},{value:k[1],color:m.config.theme2.colors.error.main}),N[K].config.steps.sort((H,J)=>H.value-J.value),N[K].config.steps=N[K].config.steps.filter(H=>H.value!==void 0)}return N}function M(U){return U.evaluator.type===l.p.IsWithinRange||U.evaluator.type===l.p.IsOutsideRange}function A(U){const W="Failed to fetch data";if(U.state!==r.Gu.Error)return;const N=U.errors;return N?.length?N.map(w=>w.message??W).join(", "):U.error?.message??W}function R(U=""){return U==="recording"?d.Z.cloudRecording:d.Z.grafana}function B(U,W){const N=W.filter(K=>!(0,i.f)(K.model)).map(K=>K.refId),w=U.filter(K=>!(0,i.f)(K.model)).map(K=>K.refId),[L,V]=(0,t.xor)(w,N);return[L,V]}},13064:(G,I,e)=>{"use strict";e.d(I,{C:()=>l});var t=e(87836),n=e(72880),s=e(70416),r=e(47232),o=e(72724),m=e(25968);function l(u,d){if(!u||!d||!(0,s.vd)(u))return;let p;try{p=(0,m.M9)(d)}catch{return}if((0,m.mo)(u))return;const c=Date.parse(u||""),y=(0,t.A)(c,p);return(0,n.Y)(y,new Date)?{humanized:`within ${d}`,fullDate:`within ${d}`}:{humanized:`in ${(0,r.KQ)(y).locale("en").fromNow(!0)}`,fullDate:(0,o.LE)(y,{format:"YYYY-MM-DD HH:mm:ss"})}}function i(u){if(!u)return null;if(!isNullDate(u))return formatDistanceToNowStrict(new Date(u))}},5179:(G,I,e)=>{"use strict";e.d(I,{K:()=>s,k:()=>r});var t=e(96540);const n=t.createContext(void 0),s=({children:o,rule:m,identifier:l})=>{const i={rule:m,identifier:l};return t.createElement(n.Provider,{value:i},o)},r=()=>{const o=t.useContext(n);if(o===void 0)throw new Error("useAlertRule must be used within a AlertRuleContext");return o}},45314:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>mn,lf:()=>lt});var t=e(32196),n=e(2543),s=e(96540),r=e(67061),o=e(42418),m=e(40980),l=e(72109),i=e(94753),u=e(40845),d=e(55852),p=e(83277),c=e(93810),y=e(6671),f=e(94822),P=e(79741),a=e(85244),E=e(55740),g=e(56361),h=e(23662),D=e(3704),v=e(69087),C=e(37959),T=e(48205),S=e(96636),O=e(99106),x=e(51921);function b(){return s.createElement(o.F,{severity:"info",title:"This rule is part of a federated rule group.",bottomSpacing:0,topSpacing:2},s.createElement(r.B,{direction:"column"},"Federated rule groups are currently an experimental feature.",s.createElement(d.$n,{fill:"text",icon:"book"},s.createElement("a",{href:"https://grafana.com/docs/metrics-enterprise/latest/tenant-management/tenant-federation/#cross-tenant-alerting-and-recording-rule-federation"},"Read documentation"))))}var M=e(14578);function A(){return s.createElement(i.E,{variant:"bodySmall",color:"warning"},s.createElement(r.B,{direction:"row",alignItems:"center",gap:.25,wrap:"nowrap",flex:"0 0 auto"},s.createElement(M.I,{name:"pause",size:"xs"})," Paused"))}var R=e(5179);const B=dt=>{const wt=(0,u.of)(U,dt);return s.createElement(r.B,{direction:"row",gap:.5},s.createElement("div",{className:wt.dot}))},U=(dt,wt)=>{const en=dt.spacing(1.25),En=`calc(${en} / 2.5)`,yt=wt.color==="error",At=wt.color==="success",Kt=wt.color==="warning";return{dot:(0,t.css)({width:en,height:en,borderRadius:"100%",backgroundColor:dt.colors.secondary.main,outline:`solid ${En} ${dt.colors.secondary.transparent}`,margin:En},At&&(0,t.css)({backgroundColor:dt.colors.success.main,outlineColor:dt.colors.success.transparent}),Kt&&(0,t.css)({backgroundColor:dt.colors.warning.main,outlineColor:dt.colors.warning.transparent}),yt&&(0,t.css)({backgroundColor:dt.colors.error.main,outlineColor:dt.colors.error.transparent}))}},W=({health:dt})=>{const wt=lt(dt),en=wt?"error":"success",En=wt?"Recording error":"Recording";return s.createElement(w,{color:en,text:En})},N=({state:dt,health:wt})=>{let en,En;switch(dt){case f.cF.Inactive:En="success",en="Normal";break;case f.cF.Firing:En="error",en="Firing";break;case f.cF.Pending:En="warning",en="Pending";break}return lt(wt)&&(En="error",en="Error"),wt==="nodata"&&(En="warning",en="No data"),s.createElement(w,{color:En,text:en})};function w({color:dt,text:wt}){return s.createElement(r.B,{direction:"row",gap:.5,wrap:"nowrap",flex:"0 0 auto"},s.createElement(B,{color:dt}),s.createElement(i.E,{variant:"bodySmall",color:dt},wt))}var L=e(72095),V=e(10534),K=e(55196),k=e(16577),j=(dt=>(dt.GrafanaManagedAlertRule="Grafana-managed alert rule",dt.CloudAlertRule="Cloud alert rule",dt.CloudRecordingRule="Cloud recording rule",dt))(j||{});const H=({rule:dt})=>{const wt=(0,u.of)(X);let en;(0,h.lT)(dt.rulerRule)?en="Grafana-managed alert rule":(0,h.i7)(dt.rulerRule)?en="Cloud recording rule":en="Cloud alert rule";const En=dt.promRule?.evaluationTime,yt=dt.promRule?.lastEvaluation,At=(0,s.useCallback)(()=>(0,h.lT)(dt.rulerRule)?dt.rulerRule.grafana_alert.uid:"",[dt.rulerRule]),Kt=(0,h.i7)(dt.rulerRule)?void 0:dt.annotations??[],Jt=Number.isFinite(En);return s.createElement(r.B,{direction:"column",gap:3},s.createElement("div",{className:wt.metadataWrapper},s.createElement(K.P,{direction:"column"},"Rule type",s.createElement(i.E,{color:"primary"},en)),s.createElement(K.P,{direction:"column"},(0,h.lT)(dt.rulerRule)&&s.createElement(s.Fragment,null,"Rule Identifier",s.createElement(r.B,{direction:"row",alignItems:"center",gap:.5},s.createElement(i.E,{color:"primary"},dt.rulerRule.grafana_alert.uid,s.createElement(V.b,{fill:"text",variant:"secondary",icon:"copy",size:"sm",getText:At}))))),s.createElement(K.P,{direction:"column"},Jt&&s.createElement(s.Fragment,null,"Last evaluation",yt&&En?s.createElement("span",null,s.createElement(i.E,{color:"primary"},(0,L.B)(new Date(yt))," ago"),", took"," ",s.createElement(i.E,{color:"primary"},En,"ms")):null)),s.createElement(K.P,{direction:"column"},!(0,h.i7)(dt.rulerRule)&&s.createElement(s.Fragment,null,"Pending period",s.createElement(i.E,{color:"primary"},dt.rulerRule?.for??"0s"))),(0,h.lT)(dt.rulerRule)&&s.createElement(s.Fragment,null,s.createElement(K.P,{direction:"column"},"Alert state if no data or all values are null",s.createElement(i.E,{color:"primary"},dt.rulerRule.grafana_alert.no_data_state)),s.createElement(K.P,{direction:"column"},"Alert state if execution error or timeout",s.createElement(i.E,{color:"primary"},dt.rulerRule.grafana_alert.exec_err_state)))),Kt&&s.createElement(s.Fragment,null,s.createElement(i.E,{variant:"h4"},"Annotations"),Object.keys(Kt).length===0?s.createElement(i.E,{variant:"bodySmall",color:"secondary",italic:!0},"No annotations"):s.createElement("div",{className:wt.metadataWrapper},Object.entries(Kt).map(([Mt,Je])=>s.createElement(K.P,{direction:"column",key:Mt},Mt,s.createElement(J,{value:Je}))))))};function J({value:dt}){const wt=dt&&dt.startsWith("http"),en=s.createElement(k.Y,{input:dt,delimiter:["{{","}}"]});return wt?s.createElement(l.Y,{variant:"bodySmall",href:dt,external:!0},dt):s.createElement(i.E,{color:"primary"},en)}const X=dt=>({metadataWrapper:(0,t.css)({display:"grid",gridTemplateColumns:"auto auto",rowGap:dt.spacing(3),columnGap:dt.spacing(12)})});var se=e(32264),ae=e(46013);const ne=(0,s.lazy)(()=>e.e(7409).then(e.bind(e,87409))),q=(0,s.lazy)(()=>e.e(1121).then(e.bind(e,31121))),ee=({rule:dt})=>{const wt=se.$.unifiedAlerting.alertStateHistoryBackend,en=se.$.unifiedAlerting.alertStateHistoryPrimary,yt=[wt,en].some(Jt=>Jt===ae.Q.Loki)?ae.Q.Loki:ae.Q.Annotations,At=dt.grafana_alert.id??"",Kt=dt.grafana_alert.uid;return s.createElement(s.Suspense,{fallback:"Loading..."},yt===ae.Q.Loki&&s.createElement(q,{ruleUID:Kt}),yt===ae.Q.Annotations&&s.createElement(ne,{alertId:At}))};var z=e(15054),te=e(99938);const ie=({rule:dt})=>s.createElement(te.s,{rule:dt,pagination:{itemsPerPage:z.FG},enableFiltering:!0});var ce=e(24120),ue=e(39070),fe=e(76885),Te=e(65879),he=e(11807),de=e(66602),le=e(39938),pe=e(69437),ve=e(66718),be=e(55907),Oe=e(26058),Me=e(56528),Ue=e(7921),we=e(74685);function Re({data:dt,thresholds:wt}){return dt?s.createElement(we.j,{data:dt,thresholds:wt?.config,thresholdsType:wt?.mode}):null}var Fe=e(20382),xe=e(57220),Ve=e(63066),$e=e(85828);const Xe=({expression:dt})=>s.createElement($e.m,{options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastColumn:0,scrollBeyondLastLine:!1,lineNumbers:"off",cursorWidth:0,overviewRulerLanes:0},defaultLanguage:"sql",height:80,defaultValue:dt,width:"100%"});function gt(dt){return"rawSql"in dt}const Dt=null,nt=s.lazy(()=>e.e(8468).then(e.bind(e,58468))),at=s.lazy(()=>e.e(7011).then(e.bind(e,67011)));function Ae({model:dt,dataSource:wt}){return wt.type===xe.ol.Prometheus&&(0,Ve.Bu)(dt)?s.createElement(nt,{query:dt.expr}):wt.type===xe.ol.Loki&&(0,Ve.Bu)(dt)?s.createElement(at,{query:dt.expr??""}):gt(dt)?s.createElement(Xe,{expression:dt.rawSql}):s.createElement("pre",null,s.createElement("code",null,(0,Fe.Bh)(dt)))}var re=e(19073);function Z({rule:dt,queries:wt,condition:en,evalDataByQuery:En={}}){const yt=(0,n.keyBy)(Object.values(se.$.datasources),Je=>Je.uid),At=wt.filter(Je=>!(0,pe.f)(Je.model)),Kt=wt.filter(Je=>(0,pe.f)(Je.model)),Jt=(0,u.of)(Ft),Mt=(0,Ue.an)(wt,en);return s.createElement(r.B,{gap:1,direction:"column",flex:"1 1 320px"},s.createElement("div",{className:Jt.maxWidthContainer},s.createElement(r.B,{gap:1,wrap:"wrap","data-testid":"queries-container"},At.map(({model:Je,relativeTimeRange:Nn,refId:xn,datasourceUid:Fn},wn)=>{const Wn=yt[Fn];return s.createElement(oe,{rule:dt,key:wn,refId:xn,isAlertCondition:en===xn,model:Je,relativeTimeRange:Nn,dataSource:Wn,thresholds:Mt[xn],queryData:En[xn]})}))),s.createElement("div",{className:Jt.maxWidthContainer},s.createElement(r.B,{gap:1,wrap:"wrap","data-testid":"expressions-container"},Kt.map(({model:Je,refId:Nn,datasourceUid:xn},Fn)=>{const wn=yt[xn];return(0,pe.f)(Je)&&s.createElement(Be,{key:Fn,refId:Nn,isAlertCondition:en===Nn,model:Je,dataSource:wn,evalData:En[Nn]})}))))}function oe({refId:dt,rule:wt,thresholds:en,model:En,dataSource:yt,queryData:At,relativeTimeRange:Kt}){const Jt=(0,u.of)(Se),Mt=(0,pe.f)(En),[Je,Nn]=(0,re.mh)(wt,re.j5.Explore),xn=Je&&Nn,Fn=[];if(yt){const Wn=yt.name??"[[Data source not found]]",da=yt.meta.info.logos.small;Fn.push(s.createElement(ye,{name:Wn,imgUrl:da,key:"datasource"}))}Kt&&Fn.push(s.createElement(i.E,{color:"secondary",key:"timerange"},(0,Te.secondsToHms)(Kt.from)," to now"));let wn;return!Mt&&xn&&(wn=yt&&Ee(yt,En)),s.createElement(s.Fragment,null,s.createElement(We,{refId:dt,headerItems:Fn,exploreLink:wn},s.createElement("div",{className:Jt.queryPreviewWrapper},s.createElement(de.Xw,null,En&&yt&&s.createElement(Ae,{model:En,dataSource:yt})))),yt&&s.createElement(Re,{data:At,thresholds:en}))}function Ee(dt,wt){const{uid:en,type:En}=dt,{refId:yt,...At}=wt;return fe.kM.renderUrl(`${se.$.appSubUrl}/explore`,{left:JSON.stringify({datasource:dt.uid,queries:[{refId:"A",...At,datasource:{type:En,uid:en}}],range:{from:"now-1h",to:"now"}})})}function ye({name:dt,imgUrl:wt}){const en=(0,u.of)(Se);return s.createElement("div",{className:en.dataSource,key:"datasource"},s.createElement("img",{src:wt,width:16,alt:dt}),dt)}const Se=dt=>({queryPreviewWrapper:(0,t.css)({margin:dt.spacing(1)}),contentBox:(0,t.css)({flex:"1 0 100%"}),visualization:(0,t.css)({padding:dt.spacing(1)}),dataSource:(0,t.css)({border:`1px solid ${dt.colors.border.weak}`,borderRadius:dt.shape.radius.default,padding:dt.spacing(.5,1),display:"flex",alignItems:"center",gap:dt.spacing(1)})});function Be({refId:dt,model:wt,evalData:en,isAlertCondition:En}){function yt(){switch(wt.type){case ve.Tz.math:return s.createElement(Xt,{model:wt});case ve.Tz.reduce:return s.createElement(ft,{model:wt});case ve.Tz.resample:return s.createElement(Ge,{model:wt});case ve.Tz.classic:return s.createElement(it,{model:wt});case ve.Tz.threshold:return s.createElement(bt,{model:wt});case ve.Tz.sql:return s.createElement(he.l,{rawSql:wt.expression||"",datasourceType:wt.datasource?.type});default:return s.createElement(s.Fragment,null,"Expression not supported: ",wt.type)}}return s.createElement(We,{refId:dt,headerItems:[s.createElement(i.E,{color:"secondary",key:"expression-type"},(0,n.startCase)(wt.type))],isAlertCondition:En},yt(),s.createElement(Oe.h,null),en&&s.createElement(Me.GX,{series:en.series,isAlertCondition:En}))}function We({refId:dt,headerItems:wt=[],children:en,isAlertCondition:En,exploreLink:yt}){const At=(0,u.of)(Ke);return s.createElement("div",{className:(0,t.cx)(At.container)},s.createElement("header",{className:At.header},s.createElement("span",{className:At.refId},dt),wt,s.createElement(Oe.h,null),En&&s.createElement(le.E,{color:"green",icon:"check",text:"Alert condition"}),yt&&s.createElement(S.d,{component:s.createElement(d.z9,{size:"md",variant:"secondary",icon:"compass",href:yt},"View in Explore")})),en)}const Ke=dt=>({container:(0,t.css)({flex:"1 0 25%",border:`1px solid ${dt.colors.border.weak}`,maxWidth:"100%",borderRadius:dt.shape.radius.default,display:"flex",flexDirection:"column"}),header:(0,t.css)({display:"flex",alignItems:"center",gap:dt.spacing(1),padding:dt.spacing(1),backgroundColor:dt.colors.background.secondary}),textBlock:(0,t.css)({border:`1px solid ${dt.colors.border.weak}`,padding:dt.spacing(.5,1),backgroundColor:dt.colors.background.primary,borderRadius:dt.shape.radius.default}),refId:(0,t.css)({color:dt.colors.text.link,padding:dt.spacing(.5,1),border:`1px solid ${dt.colors.border.weak}`,borderRadius:dt.shape.radius.default})});function it({model:dt}){const wt=(0,u.of)(rt),en=(0,n.keyBy)(be.A.reducerTypes,At=>At.value),En=(0,n.keyBy)(be.A.evalOperators,At=>At.value),yt=(0,n.keyBy)(be.A.evalFunctions,At=>At.value);return s.createElement("div",{className:wt.container},dt.conditions?.map(({query:At,operator:Kt,reducer:Jt,evaluator:Mt},Je)=>{const Nn=Qt(Mt);return s.createElement(s.Fragment,{key:Je},s.createElement("div",{className:wt.blue},Je===0?"WHEN":!!Kt?.type&&En[Kt?.type]?.text),s.createElement("div",{className:wt.bold},Jt?.type&&en[Jt.type]?.text),s.createElement("div",{className:wt.blue},"OF"),s.createElement("div",{className:wt.bold},At.params[0]),s.createElement("div",{className:wt.blue},yt[Mt.type].text),s.createElement("div",{className:wt.bold},Nn?`(${Mt.params[0]}; ${Mt.params[1]})`:Mt.params[0]))}))}const rt=dt=>({container:(0,t.css)({padding:dt.spacing(1),display:"grid",gridTemplateColumns:"repeat(6, max-content)",gap:dt.spacing(0,1)}),...Lt(dt)});function ft({model:dt}){const wt=(0,u.of)(pt),{reducer:en,expression:En,settings:yt}=dt,At=ve.Cu.find(Mt=>Mt.value===en),Kt=yt?.mode??ve.Mt.Strict,Jt=ve.HZ.find(Mt=>Mt.value===Kt);return s.createElement("div",{className:wt.container},s.createElement("div",{className:wt.label},"Function"),s.createElement("div",{className:wt.value},At?.label),s.createElement("div",{className:wt.label},"Input"),s.createElement("div",{className:wt.value},En),s.createElement("div",{className:wt.label},"Mode"),s.createElement("div",{className:wt.value},Jt?.label))}const pt=dt=>({container:(0,t.css)({padding:dt.spacing(1),display:"grid",gap:dt.spacing(.5),gridTemplateRows:"1fr 1fr",gridTemplateColumns:"repeat(4, 1fr)","> :nth-child(6)":{gridColumn:"span 3"}}),...Lt(dt)});function Ge({model:dt}){const wt=(0,u.of)(qe),{expression:en,window:En,downsampler:yt,upsampler:At}=dt,Kt=ve.PN.find(Mt=>Mt.value===yt),Jt=ve.iX.find(Mt=>Mt.value===At);return s.createElement("div",{className:wt.container},s.createElement("div",{className:wt.label},"Input"),s.createElement("div",{className:wt.value},en),s.createElement("div",{className:wt.label},"Resample to"),s.createElement("div",{className:wt.value},En),s.createElement("div",{className:wt.label},"Downsample"),s.createElement("div",{className:wt.value},Kt?.label),s.createElement("div",{className:wt.label},"Upsample"),s.createElement("div",{className:wt.value},Jt?.label))}const qe=dt=>({container:(0,t.css)({padding:dt.spacing(1),display:"grid",gap:dt.spacing(.5),gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"1fr 1fr"}),...Lt(dt)});function bt({model:dt}){const wt=(0,u.of)(Ft),{expression:en,conditions:En}=dt,yt=En&&En[0]?.evaluator,At=ve.zd.find(Nn=>Nn.value===yt?.type),Kt=yt?Qt(yt):!1,Jt=En&&En[0]?.unloadEvaluator,Mt=ve.zd.find(Nn=>Nn.value===Jt?.type),Je=Jt?Qt(Jt):!1;return s.createElement(s.Fragment,null,s.createElement("div",{className:wt.container},s.createElement("div",{className:wt.label},"Input"),s.createElement("div",{className:wt.value},en),yt&&s.createElement(s.Fragment,null,s.createElement("div",{className:wt.blue},At?.label),s.createElement("div",{className:wt.bold},Kt?`(${yt.params[0]}; ${yt.params[1]})`:yt.params[0]))),s.createElement("div",{className:wt.container},Jt&&s.createElement(s.Fragment,null,s.createElement("div",{className:wt.label},"Stop alerting when "),s.createElement("div",{className:wt.value},en),s.createElement(s.Fragment,null,s.createElement("div",{className:wt.blue},Mt?.label),s.createElement("div",{className:wt.bold},Je?`(${Jt.params[0]}; ${Jt.params[1]})`:Jt.params[0])))))}const Ft=dt=>{const{blue:wt,bold:en,...En}=Lt(dt);return{...En,maxWidthContainer:(0,t.css)({maxWidth:"100%"}),container:(0,t.css)({padding:dt.spacing(1),display:"flex",gap:dt.spacing(.5)}),blue:(0,t.css)(wt,{margin:"auto 0"}),bold:(0,t.css)(en,{margin:"auto 0"})}};function Xt({model:dt}){const wt=(0,u.of)(Ft),{expression:en}=dt;return s.createElement("div",{className:wt.container},s.createElement("div",{className:wt.label},"Input"),s.createElement("div",{className:wt.value},en))}const Lt=dt=>({blue:(0,t.css)({color:dt.colors.text.link}),bold:(0,t.css)({fontWeight:dt.typography.fontWeightBold}),label:(0,t.css)({display:"flex",alignItems:"center",padding:dt.spacing(.5,1),backgroundColor:dt.colors.background.secondary,fontSize:dt.typography.bodySmall.fontSize,lineHeight:dt.typography.bodySmall.lineHeight,fontWeight:dt.typography.fontWeightBold,borderRadius:dt.shape.radius.default}),value:(0,t.css)({padding:dt.spacing(.5,1),border:`1px solid ${dt.colors.border.weak}`,borderRadius:dt.shape.radius.default})});function Qt(dt){return dt.type===be.p.IsWithinRange||dt.type===be.p.IsOutsideRange}var an=e(36135),gn=e(28318),ut=e(1932),Nt=e(25968);function ht(dt){if(!dt)return[];const{namespace:wt,rulerRule:en}=dt,{rulesSource:En}=wt;if((0,h.lT)(en)){const yt=en.grafana_alert.data;return Rt(yt,en.for,dt.group.interval)}if((0,xe.Eb)(En)){const yt=on(En,dt);return[_t(yt,En.uid)]}return[]}function Rt(dt,wt,en){const En=(0,Nt.P8)(wt)??(0,Nt.P8)(en??"1m"),yt=Math.floor(En/1e3);return dt.map(At=>(0,ut.jM)(At,Kt=>{const Jt=Kt.relativeTimeRange?.from??0,Mt=Math.max(yt*3,Jt+yt*2);Kt.relativeTimeRange={from:Mt,to:0}}))}function _t(dt,wt){return{refId:dt.refId,datasourceUid:wt,queryType:"",model:dt,relativeTimeRange:{from:360,to:0}}}function on(dt,wt){const en="A";switch(dt.type){case"prometheus":return{refId:en,expr:wt.query};case"loki":return{refId:en,expr:wt.query};default:throw new Error(`Query for datasource type ${dt.type} is currently not supported by cloud alert rules.`)}}const ln=({rule:dt})=>{const wt=(0,s.useMemo)(()=>new gn.t,[]),en=(0,ce.A)(wt.get()),En=bn(en),yt=(0,s.useMemo)(()=>ht(dt),[dt]),{allDataSourcesAvailable:At}=(0,an.g)(yt),Kt=(0,s.useCallback)(()=>{if(yt.length>0&&At){let Mt;dt&&(0,h.lT)(dt.rulerRule)&&(Mt=dt.rulerRule.grafana_alert.condition),wt.run(yt,Mt??"A")}},[yt,At,dt,wt]);(0,s.useEffect)(()=>{At&&Kt()},[At,Kt]),(0,s.useEffect)(()=>()=>wt.destroy(),[wt]);const Jt=(0,h.YN)(dt.group);return s.createElement(s.Fragment,null,En?"Loading...":s.createElement(s.Fragment,null,(0,h.lT)(dt.rulerRule)&&!Jt&&s.createElement(Z,{rule:dt,condition:dt.rulerRule.grafana_alert.condition,queries:yt,evalDataByQuery:en}),!(0,h.lT)(dt.rulerRule)&&!Jt&&en&&Object.keys(en).length>0&&s.createElement(r.B,{direction:"column",gap:1},yt.map(Mt=>s.createElement(oe,{key:Mt.refId,rule:dt,refId:Mt.refId,model:Mt.model,dataSource:Object.values(se.$.datasources).find(Je=>Je.uid===Mt.datasourceUid),queryData:en[Mt.refId],relativeTimeRange:Mt.relativeTimeRange,isAlertCondition:!1}))),!Jt&&!At&&s.createElement(o.F,{title:"Query not available",severity:"warning"},"Cannot display the query preview. Some of the data sources used in the queries are not available.")))};function bn(dt){return dt?!!Object.values(dt).find(wt=>wt.state===ue.Gu.Loading):!0}const In=()=>s.createElement(s.Fragment,null,"Routing");var Mn=(dt=>(dt.Query="query",dt.Instances="instances",dt.History="history",dt.Routing="routing",dt.Details="details",dt))(Mn||{});const vt=()=>{const{rule:dt}=(0,R.k)(),{pageNav:wt,activeTab:en}=zt(dt),[En,yt]=(0,s.useState)(),{annotations:At,promRule:Kt}=dt,Jt=lt(dt.promRule?.health),Mt=(0,h.Z8)(Kt),Je=(0,h.YN)(dt.group),Nn=(0,h.lT)(dt.rulerRule)&&!!dt.rulerRule.grafana_alert.provenance,xn=(0,h.lT)(dt.rulerRule)&&(0,h.HH)(dt.rulerRule),Fn=Jt&&!xn,wn=(0,h.uo)(dt),Wn=At[E.YH.summary];return s.createElement(C.d,{pageNav:wt,navId:"alert-list",isLoading:!1,renderTitle:da=>s.createElement(mt,{name:da,paused:xn,state:Mt?Kt.state:void 0,health:dt.promRule?.health,ruleType:dt.promRule?.type,ruleOrigin:wn}),actions:s.createElement(y.l,{rule:dt,showCopyLinkButton:!0,rulesSource:dt.namespace.rulesSource}),info:nn(dt),subTitle:s.createElement(r.B,{direction:"column"},xn&&s.createElement(c.A,null),Wn,Je&&s.createElement(b,null),Nn&&s.createElement(T.Yi,{resource:T.hk.AlertRule,bottomSpacing:0,topSpacing:2}),Fn&&s.createElement(o.F,{title:"Something went wrong when evaluating this alert rule",bottomSpacing:0,topSpacing:2},s.createElement("pre",{style:{marginBottom:0}},s.createElement("code",null,dt.promRule?.lastError??"No error message"))))},s.createElement(r.B,{direction:"column",gap:2},s.createElement(m.J,null,en==="query"&&s.createElement(ln,{rule:dt}),en==="instances"&&s.createElement(ie,{rule:dt}),en==="history"&&(0,h.lT)(dt.rulerRule)&&s.createElement(ee,{rule:dt.rulerRule}),en==="routing"&&s.createElement(In,null),en==="details"&&s.createElement(H,{rule:dt}))),En&&s.createElement(x.Z,{redirectTo:!0,identifier:En,isProvisioned:Nn,onDismiss:()=>yt(void 0)}))},nn=dt=>{const{labels:wt,annotations:en,group:En}=dt,yt=[],At=en[E.YH.runbookURL],Kt=en[E.YH.dashboardUID],Jt=en[E.YH.panelID],Mt=Kt&&Jt,Je=Kt,Nn=!(0,n.isEmpty)(wt),xn=En.interval;return At&&yt.push({label:"Runbook",value:s.createElement(l.Y,{variant:"bodySmall",href:At,external:!0},(0,n.truncate)(At,{length:42}))}),Mt?yt.push({label:"Dashboard and panel",value:s.createElement(S.d,{title:dt.name,component:s.createElement(l.Y,{variant:"bodySmall",href:(0,g.D2)(Kt,Jt)},"View panel")})}):Je&&yt.push({label:"Dashboard",value:s.createElement(S.d,{title:dt.name,component:s.createElement(l.Y,{title:dt.name,variant:"bodySmall",href:(0,g.JM)(Kt)},"View dashboard")})}),xn&&yt.push({label:"Evaluation interval",value:s.createElement(i.E,{color:"primary"},"Every ",xn)}),Nn&&yt.push({label:"Labels",value:s.createElement(v.m,{labels:wt,size:"sm"})}),yt},cn=dt=>{const wt=new URLSearchParams([["search",dt.map(([en,En])=>`${en}:"${En}"`).join(" ")]]);return(0,D.c)("/alerting/list?"+wt.toString())},mt=({name:dt,paused:wt=!1,state:en,health:En,ruleType:yt,ruleOrigin:At})=>{const Kt=(0,u.of)(rn),[Jt]=(0,p.s)(),Mt=yt===f.JS.Recording,Je=Jt.returnTo?String(Jt.returnTo):"/alerting/list";return s.createElement("div",{className:Kt.title},s.createElement(d.z9,{variant:"secondary",icon:"angle-left",href:Je}),At&&s.createElement(a.T,{pluginId:At.pluginId}),s.createElement(i.E,{variant:"h1",truncate:!0},dt),wt?s.createElement(A,null):s.createElement(s.Fragment,null,en&&s.createElement(N,{state:en,health:En}),Mt&&s.createElement(W,{health:En})))},lt=dt=>dt==="error"||dt==="err";function Tt(){const[dt,wt]=(0,p.s)(),en=dt.tab;return[Vt(en)?en:"query",At=>{wt({tab:At})}]}function Vt(dt){return typeof dt=="string"&&Object.values(Mn).includes(dt)}function zt(dt){const[wt,en]=Tt(),{annotations:En,promRule:yt}=dt,At=En[E.YH.summary],Kt=(0,h.Z8)(yt),Jt=Kt?(yt.alerts??[]).length:void 0,Mt=(0,O.EL)(dt.namespace).name,Je=dt.group.name,Nn=(0,h.lT)(dt.rulerRule)&&Kt,xn=(0,h.KB)(dt.promRule);return{pageNav:{...P.defaultPageNav,text:dt.name,subTitle:At,children:[{text:"Query and conditions",active:wt==="query",onClick:()=>{en("query")}},{text:"Instances",active:wt==="instances",onClick:()=>{en("instances")},tabCounter:Jt,hideFromTabs:xn},{text:"History",active:wt==="history",onClick:()=>{en("history")},hideFromTabs:!Nn},{text:"Details",active:wt==="details",onClick:()=>{en("details")}}],parentItem:{text:Je,url:cn([["namespace",Mt],["group",Je]]),parentItem:{text:Mt,url:cn([["namespace",Mt]])}}},activeTab:wt}}const rn=()=>({title:(0,t.css)({display:"flex",alignItems:"center",gap:8,minWidth:0})}),mn=vt},2426:(G,I,e)=>{"use strict";e.d(I,{D:()=>h});var t=e(96540),n=e(8249),s=e(47232),r=e(74135),o=e(23662),m=e(69087),l=e(75591),i=e(3197),u=e(83122),d=e(29158),p=e(24401),c=e(30973);const y=({rule:v,instance:C,extensionPointId:T})=>{const[S,O]=(0,t.useState)(),x=(0,t.useMemo)(()=>({instance:C,rule:v}),[C,v]),{extensions:b}=(0,i.vl)({context:x,extensionPointId:T,limitPerPlugin:3});if(b.length===0)return null;const M=t.createElement(c.w,{extensions:b,onSelect:O});return t.createElement(t.Fragment,null,t.createElement(u.m,{placement:"bottom-start",overlay:M},t.createElement(d.K,{name:"ellipsis-v","aria-label":"Actions",variant:"secondary"})),!!S&&!!S.path&&t.createElement(p.s,{path:S.path,title:S.title,onDismiss:()=>O(void 0)}))};var f=e(33225),P=e(71223),a=e(84396);const E=({instance:v})=>{const C=(0,f.Hx)(v.annotations),T=(0,f.gO)(C);return t.createElement("div",null,v.value&&t.createElement(a.X,{label:"Value",horizontal:!0},v.value),C.map(([S,O])=>t.createElement(P.s,{key:S,annotationKey:S,value:O,valueLink:T.get(S)})))};var g=e(30423);const h=({rule:v,instances:C,pagination:T,footerRow:S})=>{const O=(0,t.useMemo)(()=>C.length>1?(0,n.yO)(C.map(b=>b.labels)):{},[C]),x=(0,t.useMemo)(()=>C.map(b=>({data:{rule:v,alert:{...b,commonLabels:O}},id:(0,o.RI)(b)})),[O,C,v]);return t.createElement(l.E,{cols:D,isExpandable:!0,items:x,renderExpandedContent:({data:b})=>t.createElement(E,{instance:b.alert}),pagination:T,footerRow:S})},D=[{id:"state",label:"State",renderCell:({data:{alert:{state:v}}})=>t.createElement(g.C,{state:v}),size:"80px"},{id:"labels",label:"Labels",renderCell:({data:{alert:{labels:v,commonLabels:C}}})=>t.createElement(m.m,{labels:v,commonLabels:C,size:"sm"})},{id:"created",label:"Created",renderCell:({data:{alert:{activeAt:v}}})=>t.createElement(t.Fragment,null,v.startsWith("0001")?"-":(0,s.KQ)(v).format("YYYY-MM-DD HH:mm:ss")),size:"150px"},{id:"actions",label:"",renderCell:({data:{alert:v,rule:C}})=>t.createElement(y,{rule:C,instance:v,extensionPointId:r.S.AlertInstanceAction,key:"alert-instance-extension-point"}),size:"40px"}]},30423:(G,I,e)=>{"use strict";e.d(I,{C:()=>m});var t=e(96540),n=e(56034),s=e(14578),r=e(23662),o=e(65415);const m=t.memo(({state:l,isPaused:i=!1,size:u="md",muted:d=!1})=>i?t.createElement(n.m,{content:"Alert evaluation is currently paused",placement:"top"},t.createElement(o.O,{state:"warning",size:u,muted:d},t.createElement(s.I,{name:"pause",size:"xs"})," Paused")):t.createElement(o.O,{state:(0,r.Wy)(l),size:u,muted:d},(0,r.XI)(l)));m.displayName="AlertStateTag"},51921:(G,I,e)=>{"use strict";e.d(I,{Z:()=>m});var t=e(96540),n=e(24180),s=e(96374),r=e(55852),o=e(18461);function m({identifier:i,isProvisioned:u,redirectTo:d=!1,onDismiss:p}){const c=(0,n.zy)(),[y,f]=(0,t.useState)(u?"confirm":"redirect");if(y==="redirect"){const P=o.$9(i),a=c.pathname+c.search,E=new URLSearchParams({copyFrom:P,returnTo:d?a:""});return t.createElement(n.rd,{to:"/alerting/new?"+E.toString(),push:!0})}return t.createElement(s.u,{isOpen:y==="confirm",title:"Copy provisioned alert rule",body:t.createElement("div",null,t.createElement("p",null,"The new rule will ",t.createElement("strong",null,"not")," be marked as a provisioned rule."),t.createElement("p",null,"You will need to set a new evaluation group for the copied rule because the original one has been provisioned and cannot be used for rules created in the UI.")),confirmText:"Copy",onConfirm:()=>f("redirect"),onDismiss:p})}const l=t.forwardRef(({text:i,ruleIdentifier:u,isProvisioned:d,className:p},c)=>{const[y,f]=(0,t.useState)(!1);return t.createElement(t.Fragment,null,t.createElement(r.$n,{title:"Copy",className:p,size:"sm",key:"clone",variant:"secondary",icon:"copy",onClick:()=>f(!0),ref:c},i),y&&t.createElement(m,{identifier:u,isProvisioned:d,onDismiss:()=>f(!1)}))});l.displayName="CloneRuleButton"},6671:(G,I,e)=>{"use strict";e.d(I,{l:()=>fe});var t=e(32196),n=e(96540),s=e(24180),r=e(40845),o=e(55852),m=e(67061),l=e(26272),i=e(38138),u=e(83122),d=e(28138),p=e(1932),c=e(3169),y=e(79938),f=e(23662),P=e(730);const E=({rule:he,onPauseChange:de})=>{const[le]=y.hK.endpoints.rulerRuleGroup.useLazyQuery(),pe=(0,c._2)(),[ve]=y.hK.endpoints.updateRule.useMutation(),be=(0,f.lT)(he.rulerRule)&&(0,f.HH)(he.rulerRule),Oe=be?"play":"pause",Me=be?"Resume evaluation":"Pause evaluation",Ue=async we=>{if(!(0,f.lT)(he.rulerRule))return;const Re=he.rulerRule.grafana_alert.uid,Fe=await le({rulerConfig:P.$q,namespace:he.namespace.uid||he.rulerRule.grafana_alert.namespace_uid,group:he.group.name}).unwrap();if(!Fe){pe.error(`Failed to ${we?"pause":"resume"} the rule. Could not get the target group to update the rule.`);return}const xe=Fe.rules.map($e=>(0,f.lT)($e)&&$e.grafana_alert.uid===Re?(0,p.jM)($e,Xe=>{Xe.grafana_alert.is_paused=we}):$e),Ve={interval:Fe.interval,name:Fe.name,rules:xe};await ve({nameSpaceUID:he.namespace.uid||he.rulerRule.grafana_alert.namespace_uid,payload:Ve}).unwrap(),de?.()};return n.createElement(i.W.Item,{label:Me,icon:Oe,onClick:()=>{Ue(!be)}})};var g=e(90141),h=e(74135),D=e(3197),v=e(94822);function C(he){const de=T(he),{extensions:le}=(0,D.vl)(de),pe=(0,f.uo)(he),ve=he.promRule?.type;if(!pe||!ve)return[];const{pluginId:be}=pe;return le.filter(Oe=>Oe.pluginId===be)}function T(he){return(0,n.useMemo)(()=>{switch(he.promRule?.type){case v.JS.Alerting:return{extensionPointId:h.S.AlertingAlertingRuleAction,context:{name:he.name,namespace:he.namespace.name,group:he.group.name,expression:he.query,labels:he.labels,annotations:he.annotations}};case v.JS.Recording:return{extensionPointId:h.S.AlertingRecordingRuleAction,context:{name:he.name,namespace:he.namespace.name,group:he.group.name,expression:he.query,labels:he.labels}};default:return{extensionPointId:""}}},[he])}var S=e(19073),O=e(56361),x=e(18461),b=e(3704),M=e(56034),A=e(12210),R=e(99494),B=e(76156);const U=({title:he="",severity:de="",url:le=""})=>{const pe=createBridgeURL(SupportedPlugin.Incident,"/incidents/declare",{title:he,severity:de,url:le}),{loading:ve,installed:be,settings:Oe}=usePluginBridge(SupportedPlugin.Incident);return React.createElement(React.Fragment,null,ve===!0&&React.createElement(Button,{icon:"fire",size:"sm",type:"button",disabled:!0},"Declare Incident"),be===!1&&React.createElement(Tooltip,{content:"Grafana Incident is not installed or is not configured correctly"},React.createElement(Button,{icon:"fire",size:"sm",type:"button",disabled:!0},"Declare Incident")),Oe&&React.createElement(LinkButton,{icon:"fire",size:"sm",type:"button",href:pe},"Declare Incident"))},W=({title:he="",severity:de="",url:le=""})=>{const pe=(0,B.h)(R.W.Incident,"/incidents/declare",{title:he,severity:de,url:le}),{loading:ve,installed:be,settings:Oe}=(0,A._)(R.W.Incident);return n.createElement(n.Fragment,null,ve===!0&&n.createElement(i.W.Item,{label:"Declare incident",icon:"fire",disabled:!0}),be===!1&&n.createElement(M.m,{content:"Grafana Incident is not installed or is not configured correctly"},n.createElement(i.W.Item,{label:"Declare incident",icon:"fire",disabled:!0})),Oe&&n.createElement(i.W.Item,{label:"Declare incident",url:pe,icon:"fire"}))},N=({rule:he,identifier:de,showCopyLinkButton:le,handleSilence:pe,handleDelete:ve,handleDuplicateRule:be,onPauseChange:Oe,buttonSize:Me})=>{const[Ue,we]=(0,S.mh)(he,S.j5.Pause),Re=Ue&&we,[Fe,xe]=(0,S.mh)(he,S.j5.Delete),Ve=Fe&&xe,[$e,Xe]=(0,S.mh)(he,S.j5.Duplicate),gt=$e&&Xe,[Dt,nt]=(0,S.mh)(he,S.j5.Silence),at=Dt&&nt,[Ae,re]=(0,S.mh)(he,S.j5.ModifyExport),Z=Ae&&re,oe=C(he),Ee=oe.length>0,ye=(!(0,O.y$)()||(0,O.ES)())&&(0,f.Z8)(he.promRule)&&he.promRule.state===v.cF.Firing,Se=(0,O.S2)(he.namespace.rulesSource,he),Be=[Re,at,ye,gt].some(Boolean)&&[le,Z].some(Boolean),We=n.createElement(n.Fragment,null,Re&&n.createElement(E,{rule:he,onPauseChange:Oe}),at&&n.createElement(i.W.Item,{label:"Silence notifications",icon:"bell-slash",onClick:pe}),ye&&n.createElement(W,{title:he.name,url:""}),gt&&n.createElement(i.W.Item,{label:"Duplicate",icon:"copy",onClick:()=>be(de)}),Be&&n.createElement(i.W.Divider,null),Se&&n.createElement(i.W.Item,{label:"Copy link",icon:"share-alt",onClick:()=>w(Se)}),Z&&n.createElement(i.W.Item,{label:"Export",icon:"download-alt",childItems:[n.createElement(L,{key:"export-with-modifications",identifier:de})]}),Ee&&n.createElement(n.Fragment,null,n.createElement(i.W.Divider,null),oe.map(Ke=>n.createElement(i.W.Item,{key:Ke.id,label:Ke.title,icon:Ke.icon,onClick:Ke.onClick}))),Ve&&n.createElement(n.Fragment,null,n.createElement(i.W.Divider,null),n.createElement(i.W.Item,{label:"Delete",icon:"trash-alt",destructive:!0,onClick:()=>ve(he)})));return n.createElement(u.m,{overlay:n.createElement(i.W,null,We)},n.createElement(g.A,{size:Me}))};function w(he){navigator.clipboard?.writeText(he).then(()=>{d.A.emit(l.r1.alertSuccess,["URL copied to clipboard"])})}const L=({identifier:he})=>{const de=location.pathname+location.search,le=(0,b.c)(`/alerting/${encodeURIComponent(x.$9(he))}/modify-export`,{returnTo:de});return n.createElement(i.W.Item,{key:"with-modifications",label:"With modifications",icon:"file-edit-alt",url:le})},V=N;var K=e(96374),k=e(99140),j=e(23770),H=e(57220);const J=()=>{const[he,de]=(0,n.useState)(),le=(0,n.useCallback)(()=>{de(void 0)},[]),pe=(0,n.useCallback)(Oe=>{de(Oe)},[]),ve=(0,n.useCallback)(Oe=>{if(Oe&&Oe.rulerRule){const Me=(0,x.P1)((0,H.EV)(Oe.namespace.rulesSource),Oe.namespace.name,Oe.group.name,Oe.rulerRule);(0,k.JD)((0,j.KH)(Me,{navigateTo:"/alerting/list"})),le()}},[le]);return[(0,n.useMemo)(()=>n.createElement(K.u,{isOpen:!!he,title:"Delete rule",body:"Deleting this rule will permanently remove it from your alert rule list. Are you sure you want to delete this rule?",confirmText:"Yes, delete",icon:"exclamation-triangle",onConfirm:()=>ve(he),onDismiss:le}),[ve,le,he]),pe,le]};var X=e(75648),se=e(87978),ae=e(98569),ne=e(17272);const ee=({rulerRule:he,onClose:de})=>{const{uid:le}=he.grafana_alert,pe=(0,ne.Di)();return n.createElement(se._,{title:"Silence alert rule",subtitle:"Configure silences to stop notifications from a particular alert rule.",onClose:de,size:"md"},n.createElement(m.B,{direction:"column"},n.createElement(ae.G,{ruleUid:le,formValues:pe,alertManagerSourceName:H.hY,onSilenceCreated:de,onCancel:de})))};var z=e(14285),te=e(70383),ie=e(31678),ce=e(51921);const ue=he=>window.matchMedia(`(max-width: ${he}px)`).matches,fe=({compact:he,showViewButton:de,showCopyLinkButton:le,rule:pe,rulesSource:ve})=>{const be=(0,ie.useDispatch)(),Oe=(0,s.zy)(),Me=(0,r.of)(Te),[Ue,we]=J(),[Re,Fe]=(0,n.useState)(!1),[xe,Ve]=(0,n.useState)(void 0),{namespace:$e,group:Xe,rulerRule:gt}=pe,{hasActiveFilters:Dt}=(0,z.dI)(),nt=Oe.pathname+Oe.search,at=(0,f.lT)(pe.rulerRule)&&!!pe.rulerRule.grafana_alert.provenance,[Ae,re]=(0,S.mh)(pe,S.j5.Update),Z=Ae&&re,oe=[],Ee=(0,t.cx)({[Me.compactButton]:he}),ye=he?"sm":"md",Se=(0,H.EV)(ve),Be=x.UP(Se,pe);if(de&&oe.push(n.createElement(o.z9,{tooltip:he?"View":void 0,tooltipPlacement:"top",className:Ee,title:"View",size:ye,key:"view",variant:"secondary",icon:"eye",href:(0,O.w$)(ve,pe,nt)},!he&&"View")),gt&&Z){const We=x.P1(Se,$e.name,Xe.name,gt),Ke=(0,b.c)(`/alerting/${encodeURIComponent(x.$9(We))}/edit`,{returnTo:nt});oe.push(n.createElement(o.z9,{tooltip:he?"Edit":void 0,tooltipPlacement:"top",title:"Edit",className:Ee,size:ye,key:"edit",variant:"secondary",icon:"pen",href:Ke},!he&&"Edit"))}return n.createElement(m.B,{gap:1},oe,n.createElement(V,{buttonSize:ye,rule:pe,identifier:Be,showCopyLinkButton:le,handleDelete:()=>we(pe),handleSilence:()=>Fe(!0),handleDuplicateRule:()=>Ve({identifier:Be,isProvisioned:at}),onPauseChange:()=>{const We=Dt?void 0:X.Ys+1;be((0,j.Lc)({rulesSourceName:H.hY,limitAlerts:We}))}}),Ue,(0,f.lT)(pe.rulerRule)&&Re&&n.createElement(te.b9,{accessType:"instance"},n.createElement(ee,{rulerRule:pe.rulerRule,onClose:()=>Fe(!1)})),xe?.identifier&&n.createElement(ce.Z,{identifier:xe.identifier,isProvisioned:xe.isProvisioned,onDismiss:()=>Ve(void 0)}))},Te=he=>({compactButton:(0,t.css)({padding:`0 ${he.spacing(2)}`})})},75648:(G,I,e)=>{"use strict";e.d(I,{Ys:()=>se,DI:()=>ae});var t=e(32196),n=e(96540),s=e(72724),r=e(47232),o=e(40845),m=e(56034),l=e(97814),i=e(33225),u=e(23662),d=e(25968),p=e(69087),c=e(84396),y=e(71223);function f(ee){const z=(0,o.of)(P),{annotations:te}=ee,ie=(0,i.gO)(te);return te.length===0?null:n.createElement("div",{className:z.annotations},te.map(([ce,ue])=>n.createElement(y.s,{key:ce,annotationKey:ce,value:ue,valueLink:ie.get(ce)})))}const P=()=>({annotations:(0,t.css)({marginTop:"46px"})});var a=e(40672),E=e(14778),g=e(55852),h=e(67061),D=e(19073),v=e(46013),C=e(55740),T=e(57220),S=e(56361);const x=({rule:ee,rulesSource:z})=>{const{group:te}=ee,{StateHistoryModal:ie,showStateHistoryModal:ce}=(0,v.G)(),ue=(0,E.i)(),[fe,Te]=(0,D.mh)(ee,D.j5.Explore),he=[],de=(0,u.YN)(te);if((0,T.Eb)(z)&&fe&&Te&&!de&&he.push(n.createElement(g.z9,{size:"sm",key:"explore",variant:"primary",icon:"chart-line",target:"_blank",href:(0,S.Yp)(z,ee.query)},"See graph")),ee.annotations[C.YH.runbookURL]&&he.push(n.createElement(g.z9,{size:"sm",key:"runbook",variant:"primary",icon:"book",target:"_blank",href:a.sQ.sanitizeUrl(ee.annotations[C.YH.runbookURL])},"View runbook")),ee.annotations[C.YH.dashboardUID]){const le=ee.annotations[C.YH.dashboardUID];if(le){he.push(n.createElement(g.z9,{size:"sm",key:"dashboard",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(le)}`,onClick:()=>{ue(ee.name)}},"Go to dashboard"));const pe=ee.annotations[C.YH.panelID];pe&&he.push(n.createElement(g.z9,{size:"sm",key:"panel",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(le)}?viewPanel=${encodeURIComponent(pe)}`,onClick:()=>{ue(ee.name)}},"Go to panel"))}}return(0,u.lT)(ee.rulerRule)&&he.push(n.createElement(n.Fragment,{key:"history"},n.createElement(g.$n,{size:"sm",icon:"history",onClick:()=>(0,u.lT)(ee.rulerRule)&&ce(ee.rulerRule)},"Show state history"),ie)),he.length?n.createElement(h.B,null,he):null};var b=e(19347),M=e(66718);function A(ee){const{rulesSource:z,rule:te}=ee,ie=(0,o.of)(R),ce=(0,n.useMemo)(()=>{if((0,T.Eb)(z))return[{name:z.name,icon:z.meta.info.logos.small}];if((0,u.lT)(te.rulerRule)){const{data:ue}=te.rulerRule.grafana_alert,fe=ue.reduce((Te,he)=>{const de=(0,b.l)().getInstanceSettings(he.datasourceUid);return!de||de.uid===M.Uj||(Te[de.name]={name:de.name,icon:de.meta.info.logos.small}),Te},{});return Object.values(fe)}return[]},[te,z]);return ce.length===0?null:n.createElement(c.X,{label:"Data source"},ce.map(({name:ue,icon:fe},Te)=>n.createElement("div",{key:ue},fe&&n.createElement(n.Fragment,null,n.createElement("img",{alt:`${ue} datasource logo`,className:ie.dataSourceIcon,src:fe})," "),ue)))}function R(ee){const z=ee.spacing(2);return{dataSourceIcon:(0,t.css)({width:z,height:z})}}var B=e(28848),U=e(29317),W=e(20719),N=e(41781),w=e(72307),L=e(71713),V=e(73750);const K=({language:ee,expr:z})=>{const te=(0,n.useMemo)(()=>[(0,N.D)({onlyIn:ce=>"type"in ce&&ce.type==="code_block",getSyntax:()=>ee},{...B.languages,[ee]:ee==="logql"?L.Ay:W.n6})],[ee]),ie=(0,n.useMemo)(()=>(0,w.mO)(z),[z]);return n.createElement(U.KE,{"data-testid":"expression-editor",plugins:te,value:ie})},k=({expression:ee,rulesSource:z})=>{const te=(0,o.of)(j);return n.createElement(V.L,{className:(0,t.cx)(te.well,"slate-query-field")},(0,T.Eb)(z)?n.createElement(K,{expr:ee,language:z.type===T.ol.Loki?"logql":"promql"}):ee)},j=ee=>({well:(0,t.css)({fontFamily:ee.typography.fontFamilyMonospace})});function H(ee){const{annotations:z,rulesSource:te,rule:ie}=ee,ce=J();return(0,T.Eb)(te)?n.createElement(c.X,{label:"Expression",horizontal:!0,className:(0,t.cx)({[ce.exprRow]:!!z.length})},n.createElement(k,{expression:ie.query,rulesSource:te})):null}const J=()=>({exprRow:(0,t.css)({marginBottom:"46px"})});var X=e(99938);const se=15,ae=({rule:ee})=>{const z=(0,o.of)(q),{namespace:{rulesSource:te}}=ee,ie=(0,i.Hx)(ee.annotations);return n.createElement("div",null,n.createElement(x,{rule:ee,rulesSource:te}),n.createElement("div",{className:z.wrapper},n.createElement("div",{className:z.leftSide},n.createElement(ne,{rule:ee}),!!ee.labels&&!!Object.keys(ee.labels).length&&n.createElement(c.X,{label:"Labels",horizontal:!0},n.createElement(p.m,{labels:ee.labels})),n.createElement(H,{rulesSource:te,rule:ee,annotations:ie}),n.createElement(f,{annotations:ie})),n.createElement("div",{className:z.rightSide},n.createElement(A,{rulesSource:te,rule:ee}))),n.createElement(c.X,{label:"Instances",horizontal:!0},n.createElement(X.s,{rule:ee,itemsDisplayLimit:se})))},ne=({rule:ee})=>{let z,te=ee.group.interval,ie=ee.promRule?.lastEvaluation,ce=ee.promRule?.evaluationTime;return(0,u.i7)(ee.rulerRule)||(z=ee.rulerRule?.for??"0s"),n.createElement(n.Fragment,null,te&&n.createElement(c.X,{label:"Evaluate",horizontal:!0},"Every ",te),n.createElement(c.X,{label:"Pending period",horizontal:!0},z),ie&&!(0,d.mo)(ie)&&n.createElement(c.X,{label:"Last evaluation",horizontal:!0},n.createElement(m.m,{placement:"top",content:`${(0,s.LE)(ie,{format:"YYYY-MM-DD HH:mm:ss"})}`,theme:"info"},n.createElement("span",null,`${(0,r.KQ)(ie).locale("en").fromNow(!0)} ago`))),ie&&!(0,d.mo)(ie)&&ce!==void 0&&n.createElement(c.X,{label:"Evaluation time",horizontal:!0},n.createElement(m.m,{placement:"top",content:`${ce}s`,theme:"info"},n.createElement("span",null,(0,l.g)({timeInMs:ce*1e3,humanize:!0})))))},q=ee=>({wrapper:(0,t.css)({display:"flex",flexDirection:"row",[ee.breakpoints.down("md")]:{flexDirection:"column"}}),leftSide:(0,t.css)({flex:1}),rightSide:(0,t.css)({[ee.breakpoints.up("md")]:{paddingLeft:"90px",width:"300px"}})})},99938:(G,I,e)=>{"use strict";e.d(I,{s:()=>v});var t=e(32196),n=e(2543),s=e(96540),r=e(40845),o=e(55852),m=e(53876),l=e(78369),i=e(60029),u=e(94354),d=e(94822);const p=({className:S,onStateFilterChange:O,stateFilter:x,filterType:b,itemPerStateStats:M})=>{const A=(0,r.of)(c),R=w=>function(){return M&&M[w]?s.createElement(l.v,{name:M[w].toFixed(0),colorIndex:9,className:A.tag}):null},B=Object.values(d.Gi).map(w=>({label:w,value:w,component:R(w)})),W=[d.cF.Firing,d.cF.Pending].map(w=>({label:(0,n.capitalize)(w),value:w,component:R(w)})),N=b==="grafana"?B:W;return s.createElement("div",{className:S,"data-testid":"alert-instance-state-filter"},s.createElement(i.J,null,"State"),s.createElement(u.z,{options:N,value:x,onChange:O,onClick:w=>{w===x&&O(void 0)}}))};function c(S){return{tag:(0,t.css)({fontSize:"11px",fontWeight:"normal",padding:S.spacing(.25,.5),verticalAlign:"middle",marginLeft:S.spacing(.5)})}}var y=e(98164),f=e(56361),P=e(64861),a=e(57220),E=e(23662),g=e(2426),h=e(92467);function D({stats:S,onClick:O,href:x}){const b=(0,r.of)(T);return s.createElement("div",{className:b.footerRow},s.createElement("div",null,"Showing ",S.visibleItemsCount," out of ",S.totalItemsCount," instances"),s.createElement(o.z9,{size:"sm",variant:"secondary","data-testid":"show-all",onClick:O,href:x},"Show all ",S.totalItemsCount," alert instances"))}function v(S){const{rule:O,itemsDisplayLimit:x=Number.POSITIVE_INFINITY,pagination:b,enableFiltering:M=!1}=S,{promRule:A,namespace:R,instanceTotals:B}=O,[U,W]=(0,s.useState)(),[N,w]=(0,s.useState)(),[L]=(0,s.useState)(Math.floor(Math.random()*100)),V=`queryString-${L}`,K=(0,r.of)(T),k=(0,a.z2)(R.rulesSource)?a.hY:"prometheus",j=(0,s.useMemo)(()=>(0,E.Z8)(A)&&A.alerts?.length?C(U,N,(0,f.Cp)(P.xB.Importance,A.alerts)):[],[A,N,U]);if(!(0,E.Z8)(A))return null;const H=j.slice(0,x),J=(0,n.countBy)(A.alerts,te=>(0,d.lh)(te.state)),X=(0,n.sum)([B.alerting,B.inactive,B.pending,B.nodata]),se=X-H.length,ae={totalItemsCount:X,visibleItemsCount:H.length},ne=(0,f.w$)(R.rulesSource,S.rule,location.pathname+location.search),q=(0,h.kc)(B),ee=()=>w(void 0),z=se?s.createElement(D,{stats:ae,onClick:M?ee:void 0,href:M?void 0:ne}):void 0;return s.createElement(s.Fragment,null,M&&s.createElement("div",{className:(0,t.cx)(K.flexRow,K.spaceBetween)},s.createElement("div",{className:K.flexRow},s.createElement(m.X,{key:V,defaultQueryString:U,onFilterChange:te=>W(te)}),s.createElement(p,{filterType:k,stateFilter:N,onStateFilterChange:w,itemPerStateStats:J}))),!M&&s.createElement("div",{className:K.stats},q),s.createElement(g.D,{rule:O,instances:H,pagination:b,footerRow:z}))}function C(S,O,x){let b=[...x];if(S){const M=(0,y.J$)(S||"");b=b.filter(({labels:A})=>(0,y.Av)(A,M))}return O&&(b=b.filter(M=>(0,d.lh)(M.state)===O)),b}const T=S=>({flexRow:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"flex-end",width:"100%",flexWrap:"wrap",marginBottom:S.spacing(1),gap:S.spacing(1)}),spaceBetween:(0,t.css)({justifyContent:"space-between"}),footerRow:(0,t.css)({display:"flex",flexDirection:"column",gap:S.spacing(1),justifyContent:"space-between",alignItems:"center",width:"100%"}),instancesContainer:(0,t.css)({marginBottom:S.spacing(2)}),stats:(0,t.css)({display:"flex",gap:S.spacing(1),padding:S.spacing(1,0)})})},92467:(G,I,e)=>{"use strict";e.d(I,{M_:()=>p,j7:()=>c,kc:()=>y});var t=e(2543),n=e.n(t),s=e(55127),r=e.n(s),o=e(96540),m=e(67061),l=e(39938),i=e(54317),u=e(94822);const d={recording:0,alerting:0,[u.cF.Pending]:0,[u.cF.Inactive]:0,paused:0,error:0,nodata:0},p=({namespaces:f})=>{const P={...d};f.forEach(({groups:h})=>{h.forEach(D=>{const v=(0,t.omitBy)(D.totals,t.isUndefined);for(let C in v)P[C]+=v[C]})});const a=y(P),E=!!a.length,g=(0,t.sum)(Object.values(P));return a.unshift(o.createElement(o.Fragment,{key:"total"},g," ",r()("rule",g))),o.createElement(m.B,{direction:"row"},E&&o.createElement("div",null,o.createElement(m.B,{gap:.5},a)))},c=({group:f})=>{const P=f.totals,a=f?.interval,E=y(P),g=!!E.length;return o.createElement(m.B,{direction:"row"},g&&o.createElement("div",null,o.createElement(m.B,{gap:.5},E)),a&&o.createElement(o.Fragment,null,o.createElement("div",null,"|"),o.createElement(l.E,{text:a,icon:"clock-nine",color:"blue"})))};function y(f){const P=[];return f[i.$.Alerting]&&P.push(o.createElement(l.E,{color:"red",key:"firing",text:`${f[i.$.Alerting]} firing`})),f.error&&P.push(o.createElement(l.E,{color:"red",key:"errors",text:`${f.error} errors`})),f.nodata&&P.push(o.createElement(l.E,{color:"blue",key:"nodata",text:`${f.nodata} no data`})),f[i.$.Pending]&&P.push(o.createElement(l.E,{color:"orange",key:"pending",text:`${f[i.$.Pending]} pending`})),f[i.$.Normal]&&f.paused&&P.push(o.createElement(l.E,{color:"green",key:"paused",text:`${f[i.$.Normal]} normal (${f.paused} paused)`})),f[i.$.Normal]&&!f.paused&&P.push(o.createElement(l.E,{color:"green",key:"inactive",text:`${f[i.$.Normal]} normal`})),f.recording&&P.push(o.createElement(l.E,{color:"purple",key:"recording",text:`${f.recording} recording`})),P}},80215:(G,I,e)=>{"use strict";e.d(I,{s:()=>W});var t=e(32196),n=e(96540),s=e(40845),r=e(56034),o=e(15054),m=e(83903),l=e(85244),i=e(55740),u=e(23662),d=e(75591),p=e(10562),c=e(48205),y=e(82437),f=e(16577),P=e(13064),a=e(6671),E=e(32264),g=e(14578),h=e(82775);function D({rule:L}){const V=(0,s.of)(v),{exceedsLimit:K}=(0,n.useMemo)(()=>(0,h.q)(L.group.interval),[L.group.interval]);return K?n.createElement(r.m,{theme:"error",content:n.createElement("div",null,"A minimum evaluation interval of"," ",n.createElement("span",{className:V.globalLimitValue},E.$.unifiedAlerting.minInterval)," has been configured in Grafana and will be used instead of the ",L.group.interval," interval configured for the Rule Group.")},n.createElement(g.I,{name:"stopwatch-slash",className:V.icon})):null}function v(L){return{globalLimitValue:(0,t.css)({fontWeight:L.typography.fontWeightBold}),icon:(0,t.css)({fill:L.colors.warning.text})}}var C=e(75648),T=e(45314);const S=({rule:L})=>{const V=(0,s.of)(O);return(0,T.lf)(L.health)?n.createElement(r.m,{theme:"error",content:L.lastError||"No error message provided."},n.createElement("div",{className:V.warn},n.createElement(g.I,{name:"exclamation-triangle"}),n.createElement("span",null,"error"))):n.createElement(n.Fragment,null,L.health)},O=L=>({warn:(0,t.css)({display:"inline-flex",flexDirection:"row",alignItems:"center",gap:L.spacing(1),color:L.colors.warning.text})});var x=e(70416),b=e(67061),M=e(62930),A=e(94822),R=e(30423);const B=({rule:L,isDeleting:V,isCreating:K,isPaused:k})=>{const j=(0,s.of)(U),{promRule:H}=L,J=(0,n.useMemo)(()=>{if(H&&(0,u.Z8)(H)&&H.alerts?.length&&H.state!==A.cF.Inactive){const X=H.activeAt?new Date(H.activeAt):(0,u.Om)(H);if(X)return n.createElement("span",{title:String(X),className:j.for},"for"," ",(0,x.dU)({start:X,end:new Date},!1))}return null},[H,j]);return V?n.createElement(b.B,{gap:1},n.createElement(M.y,null),"Deleting"):K?n.createElement(b.B,{gap:1},n.createElement(M.y,null),"Creating"):H&&(0,u.Z8)(H)?n.createElement(b.B,{gap:1},n.createElement(R.C,{state:H.state,isPaused:k}),!k&&J):H&&(0,u.KB)(H)?n.createElement(n.Fragment,null,"Recording rule"):n.createElement(n.Fragment,null,"n/a")},U=L=>({for:(0,t.css)({fontSize:L.typography.bodySmall.fontSize,color:L.colors.text.secondary,whiteSpace:"nowrap",paddingTop:"2px"})}),W=({rules:L,className:V,showGuidelines:K=!1,emptyMessage:k="No rules found.",showGroupColumn:j=!1,showSummaryColumn:H=!1,showNextEvaluationColumn:J=!1})=>{const X=(0,s.of)(N),se=(0,t.cx)(X.wrapper,V,{[X.wrapperMargin]:K}),ae=(0,n.useMemo)(()=>L.map((ee,z)=>({id:`${ee.namespace.name}-${ee.group.name}-${ee.name}-${z}`,data:ee})),[L]),ne=w(H,j,J);if(!L.length)return n.createElement("div",{className:(0,t.cx)(se,X.emptyMessage)},k);const q=K?p.B:d.E;return n.createElement("div",{className:se,"data-testid":"rules-table"},n.createElement(q,{cols:ne,isExpandable:!0,items:ae,renderExpandedContent:({data:ee})=>n.createElement(C.DI,{rule:ee}),pagination:{itemsPerPage:o.FG},paginationStyles:X.pagination}))},N=L=>({wrapperMargin:(0,t.css)({[L.breakpoints.up("md")]:{marginLeft:"36px"}}),emptyMessage:(0,t.css)({padding:L.spacing(1)}),wrapper:(0,t.css)({width:"auto",borderRadius:L.shape.radius.default}),pagination:(0,t.css)({display:"flex",margin:0,paddingTop:L.spacing(1),paddingBottom:L.spacing(.25),justifyContent:"center",borderLeft:`1px solid ${L.colors.border.medium}`,borderRight:`1px solid ${L.colors.border.medium}`,borderBottom:`1px solid ${L.colors.border.medium}`})});function w(L,V,K){const{hasRuler:k,rulerRulesLoaded:j}=(0,m.y)();return(0,n.useMemo)(()=>{const H=[{id:"state",label:"State",renderCell:({data:J})=>{const{namespace:X}=J,{rulesSource:se}=X,{promRule:ae,rulerRule:ne}=J,q=!!(k(se)&&j(se)&&ae&&!ne),ee=!!(k(se)&&j(se)&&ne&&!ae),z=(0,u.lT)(J.rulerRule)&&(0,u.HH)(J.rulerRule);return n.createElement(B,{rule:J,isDeleting:q,isCreating:ee,isPaused:z})},size:"165px"},{id:"name",label:"Name",renderCell:({data:J})=>J.name,size:K?4:5},{id:"metadata",label:"",renderCell:({data:J})=>{const X=J.rulerRule,se=(0,u.uo)(J);return se?n.createElement(l.T,{pluginId:se.pluginId}):(0,u.lT)(X)&&X.grafana_alert.provenance?n.createElement(c.rS,null):null},size:"100px"},{id:"warnings",label:"",renderCell:({data:J})=>n.createElement(D,{rule:J}),size:"45px"},{id:"health",label:"Health",renderCell:({data:{promRule:J,group:X}})=>J?n.createElement(S,{rule:J}):null,size:"75px"}];return L&&H.push({id:"summary",label:"Summary",renderCell:({data:J})=>n.createElement(f.Y,{input:J.annotations[i.YH.summary]??""}),size:K?4:5}),K&&H.push({id:"nextEvaluation",label:"Next evaluation",renderCell:({data:J})=>{const X=(0,P.C)(J.promRule?.lastEvaluation,J.group.interval);return X&&n.createElement(r.m,{placement:"top",content:`${X?.fullDate}`,theme:"info"},n.createElement("span",null,X?.humanized))},size:2}),V&&H.push({id:"group",label:"Group",renderCell:({data:J})=>{const{namespace:X,group:se}=J;return se.name==="default"?n.createElement(y.c,{namespace:X.name}):n.createElement(y.c,{namespace:X.name,group:se.name})},size:5}),H.push({id:"actions",label:"Actions",renderCell:({data:J})=>n.createElement(a.l,{compact:!0,showViewButton:!0,rule:J,rulesSource:J.namespace.rulesSource}),size:"200px"}),H},[L,V,K,k,j])}},97754:(G,I,e)=>{"use strict";e.d(I,{y:()=>o});var t=e(96540),n=e(60021),s=e(65415);const r={[n.Or.Active]:"bad",[n.Or.Unprocessed]:"neutral",[n.Or.Suppressed]:"info"},o=({state:m})=>t.createElement(s.O,{state:r[m]},m)},98569:(G,I,e)=>{"use strict";e.d(I,{G:()=>te,A:()=>ce});var t=e(32196),n=e(2543),s=e(96540),r=e(49785),o=e(40996),m=e(70416),l=e(47232),i=e(17172),u=e(12131),d=e(32264),p=e(39558),c=e(42418),y=e(40845),f=e(84167),P=e(88575),a=e(10354),E=e(21744),g=e(67061),h=e(55852),D=e(91540),v=e(55740),C=e(57220),T=e(60021),S=e(19073),O=e(98164),x=e(56361),b=e(25994),M=e(21594),A=e(29158),R=e(79938);const B=({className:ue,required:fe,ruleUid:Te})=>{const he=(0,y.of)(U),de=(0,r.xW)(),{control:le,register:pe,formState:{errors:ve}}=de,{fields:be=[],append:Oe,remove:Me}=(0,r.jz)({name:"matchers"}),[Ue,{data:we}]=R.hK.endpoints.getAlertRule.useLazyQuery();return(0,s.useEffect)(()=>{Te&&Ue({uid:Te})},[Ue,Te]),s.createElement("div",{className:ue},s.createElement(P.D,{label:"Refine affected alerts",required:fe},s.createElement("div",null,s.createElement("div",{className:(0,t.cx)(he.matchers,he.indent)},we&&s.createElement("div",null,s.createElement(P.D,{label:"Alert rule",disabled:!0},s.createElement(a.p,{id:"alert-rule-name",defaultValue:we.grafana_alert.title,disabled:!0})),s.createElement(b.c,null)),be.map((Re,Fe)=>s.createElement("div",{className:he.row,key:`${Re.id}`,"data-testid":"matcher"},s.createElement(P.D,{label:"Label",invalid:!!ve?.matchers?.[Fe]?.name,error:ve?.matchers?.[Fe]?.name?.message},s.createElement(a.p,{...pe(`matchers.${Fe}.name`,{required:{value:fe,message:"Required."}}),defaultValue:Re.name,placeholder:"label",id:`matcher-${Fe}-label`})),s.createElement(P.D,{label:"Operator"},s.createElement(r.xI,{control:le,render:({field:{onChange:xe,ref:Ve,...$e}})=>s.createElement(M.l6,{...$e,onChange:Xe=>xe(Xe.value),className:he.matcherOptions,options:O.xH,"aria-label":"operator",id:`matcher-${Fe}-operator`}),defaultValue:Re.operator||O.xH[0].value,name:`matchers.${Fe}.operator`,rules:{required:{value:fe,message:"Required."}}})),s.createElement(P.D,{label:"Value",invalid:!!ve?.matchers?.[Fe]?.value,error:ve?.matchers?.[Fe]?.value?.message},s.createElement(a.p,{...pe(`matchers.${Fe}.value`,{required:{value:fe,message:"Required."}}),defaultValue:Re.value,placeholder:"value",id:`matcher-${Fe}-value`})),(be.length>1||!fe)&&s.createElement(A.K,{"aria-label":"Remove matcher",className:he.removeButton,name:"trash-alt",onClick:()=>Me(Fe)},"Remove")))),s.createElement(h.$n,{className:he.indent,tooltip:"Refine which alert instances are silenced by selecting label matchers",type:"button",icon:"plus",variant:"secondary",onClick:()=>{const Re={name:"",value:"",operator:T.ho.equal};Oe(Re)}},"Add matcher"))))},U=ue=>({wrapper:(0,t.css)({marginTop:ue.spacing(2)}),row:(0,t.css)({marginTop:ue.spacing(1),display:"flex",alignItems:"flex-start",flexDirection:"row",backgroundColor:ue.colors.background.secondary,padding:`${ue.spacing(1)} ${ue.spacing(1)} 0 ${ue.spacing(1)}`,"& > * + *":{marginLeft:ue.spacing(2)}}),removeButton:(0,t.css)({marginLeft:ue.spacing(1),marginTop:ue.spacing(2.5)}),matcherOptions:(0,t.css)({minWidth:"140px"}),matchers:(0,t.css)({maxWidth:`${ue.breakpoints.values.sm}px`,margin:`${ue.spacing(1)} 0`,paddingTop:ue.spacing(.5)}),indent:(0,t.css)({marginLeft:ue.spacing(2)})}),W=B;var N=e(54230);const w=()=>{const{control:ue,getValues:fe}=(0,r.xW)(),{field:{onChange:Te,value:he},fieldState:{invalid:de}}=(0,r.as)({name:"startsAt",control:ue,rules:{validate:Re=>fe().endsAt>Re}}),{field:{onChange:le,value:pe},fieldState:{invalid:ve}}=(0,r.as)({name:"endsAt",control:ue,rules:{validate:Re=>fe().startsAt<Re}}),{field:{onChange:be,value:Oe}}=(0,r.as)({name:"timeZone",control:ue}),Me=de||ve,Ue=(0,l.KQ)(he),we=(0,l.KQ)(pe);return s.createElement(P.D,{className:L.timeRange,label:"Silence start and end",error:Me?"To is before or the same as from":"",invalid:Me},s.createElement(N.b,{value:{from:Ue,to:we,raw:{from:Ue,to:we}},timeZone:Oe,onChange:Re=>{Te((0,l.KQ)(Re.from)),le((0,l.KQ)(Re.to))},onChangeTimeZone:Re=>be(Re),hideTimeZone:!1,hideQuickRanges:!0,placeholder:"Select time range"}))},L={timeRange:(0,t.css)({width:"400px"})};var V=e(45214),K=e(39938),k=e(82843),j=e(25968),H=e(69087),J=e(75591),X=e(97754);const se=(ue,fe,Te)=>{const[he,de]=(0,s.useState)();(0,o.A)(ue,fe,[he]),(0,V.A)(()=>{de(Te)},[Te])},ae=({amSourceName:ue,matchers:fe,ruleUid:Te})=>{const he=[...Te?[{name:v.kW,value:Te,operator:T.ho.equal}]:[],...fe].map(O.Wc),de=k.m.endpoints.getAlertmanagerAlerts.useLazyQuery,le=(0,y.of)(q),pe=ne(),ve=Te||fe.some(Re=>Re.value&&Re.name),[be,{currentData:Oe=[],isFetching:Me,isError:Ue}]=de();if(se(()=>{ve&&be({amSourceName:ue,filter:{matchers:he}})},500,[ue,he]),Ue)return s.createElement(c.F,{title:"Preview not available",severity:"error"},"Error occured when generating preview of affected alerts. Are your matchers valid?");const we=Oe.map(Re=>({id:Re.fingerprint,data:Re}));return s.createElement("div",null,s.createElement("h4",{className:le.title},"Affected alert rule instances",we.length>0?s.createElement(K.E,{className:le.badge,color:"blue",text:we.length}):null),!ve&&s.createElement("span",null,"Add a valid matcher to see affected alerts"),Me&&s.createElement(p._,{text:"Loading affected alert rule instances..."}),!Me&&!Ue&&ve&&s.createElement("div",{className:le.table},we.length>0?s.createElement(J.E,{items:we,isExpandable:!1,cols:pe,pagination:{itemsPerPage:10}}):s.createElement("span",null,"No firing alert instances found")))};function ne(){const ue=(0,y.of)(q);return[{id:"state",label:"State",renderCell:function({data:Te}){return s.createElement(X.y,{state:Te.status.state})},size:"120px",className:ue.stateColumn},{id:"labels",label:"Labels",renderCell:function({data:Te}){return s.createElement(H.m,{labels:Te.labels,size:"sm"})},size:"auto"},{id:"created",label:"Created",renderCell:function({data:Te}){return s.createElement(s.Fragment,null,(0,j.mo)(Te.startsAt)?"-":(0,l.KQ)(Te.startsAt).format("YYYY-MM-DD HH:mm:ss"))},size:"180px"}]}const q=ue=>({table:(0,t.css)({maxWidth:`${ue.breakpoints.values.lg}px`}),moreMatches:(0,t.css)({marginTop:ue.spacing(1)}),title:(0,t.css)({display:"flex",alignItems:"center"}),badge:(0,t.css)({marginLeft:ue.spacing(1)}),stateColumn:(0,t.css)({display:"flex",alignItems:"center"})});var ee=e(17272);const z=({silenceId:ue,alertManagerSourceName:fe})=>{const{data:Te,isLoading:he,error:de}=D.F.endpoints.getSilence.useQuery({id:ue,datasourceUid:(0,C.w5)(fe),ruleMetadata:!0,accessControl:!0}),le=Te?.matchers?.find(Me=>Me.name===v.kW)?.value,pe=fe===C.hY,ve=(0,s.useMemo)(()=>{if(!Te)return;const Me=Te.matchers?.filter(Ue=>Ue.name!==v.kW);return(0,ee.Ee)({...Te,matchers:Me})},[Te]);return ue&&he?s.createElement(p._,{text:"Loading existing silence information..."}):(0,i.NF)(de)&&de.status===404?s.createElement(c.F,{title:`Existing silence "${ue}" not found`,severity:"warning"}):(pe?Te?.accessControl?.write:!0)?s.createElement(te,{ruleUid:le,formValues:ve,alertManagerSourceName:fe}):s.createElement(c.F,{title:"You do not have permission to edit/recreate this silence",severity:"error"})},te=({formValues:ue=(0,ee.Di)(),alertManagerSourceName:fe,onSilenceCreated:Te,onCancel:he,ruleUid:de})=>{const[le,pe]=(0,S.L7)(S.QI.PreviewSilencedInstances),ve=le&&pe,[be,{isLoading:Oe}]=D.F.endpoints.createSilence.useMutation(),Me=(0,r.mN)({defaultValues:ue}),Ue=(0,y.of)(ie),{register:we,handleSubmit:Re,formState:Fe,watch:xe,setValue:Ve,clearErrors:$e}=Me,[Xe,gt,Dt,nt]=xe(["duration","startsAt","endsAt","matchers"]),at=()=>{u.Ny.push((0,x.nL)("/alerting/silences",fe))},Ae=Te||at,re=he||at,Z=async Se=>{const{id:Be,startsAt:We,endsAt:Ke,comment:it,createdBy:rt,matchers:ft}=Se;de&&ft.push({name:v.kW,value:de,operator:T.ho.equal});const pt=ft.map(O.Wc).filter(qe=>qe.name&&qe.value),Ge=(0,n.pickBy)({id:Be,startsAt:We,endsAt:Ke,comment:it,createdBy:rt,matchers:pt},qe=>!!qe);await be({datasourceUid:(0,C.w5)(fe),payload:Ge}).unwrap().then(qe=>{Ae?.(qe)})},[oe,Ee]=(0,s.useState)(Xe);(0,o.A)(()=>{if((0,m.vd)(gt)&&(0,m.vd)(Dt))if(Xe!==oe)Ve("endsAt",(0,l.KQ)((0,m.Ri)(new Date(gt),(0,m.E9)(Xe))).toISOString()),Ee(Xe);else{const Se=new Date(gt).valueOf();if(new Date(Dt).valueOf()>Se){const We=(0,m.dU)({start:new Date(gt),end:new Date(Dt)});Ve("duration",We),Ee(We)}}},700,[$e,Xe,Dt,oe,Ve,gt]);const ye=!!(d.$.bootData.user.isSignedIn&&d.$.bootData.user.name);return s.createElement(r.Op,{...Me},s.createElement("form",{onSubmit:Re(Z)},s.createElement(f.n,{className:Ue.formContainer},s.createElement("div",{className:Ue.silencePeriod},s.createElement(w,null),s.createElement(P.D,{label:"Duration",invalid:!!Fe.errors.duration,error:Fe.errors.duration&&(Fe.errors.duration.type==="required"?"Required field":Fe.errors.duration.message)},s.createElement(a.p,{...we("duration",{validate:Se=>Object.keys((0,m.E9)(Se)).length===0?"Invalid duration. Valid example: 1d 4h (Available units: y, M, w, d, h, m, s)":void 0}),id:"duration"}))),s.createElement(W,{required:!de,ruleUid:de}),s.createElement(P.D,{label:"Comment",required:!0,error:Fe.errors.comment?.message,invalid:!!Fe.errors.comment},s.createElement(E.f,{...we("comment",{required:{value:!0,message:"Required."}}),rows:5,placeholder:"Details about the silence",id:"comment"})),!ye&&s.createElement(P.D,{label:"Created By",required:!0,error:Fe.errors.createdBy?.message,invalid:!!Fe.errors.createdBy},s.createElement(a.p,{...we("createdBy",{required:{value:!0,message:"Required."}}),placeholder:"Who's creating the silence"})),ve&&s.createElement(ae,{amSourceName:fe,matchers:nt,ruleUid:de})),s.createElement(g.B,{gap:1},Oe&&s.createElement(h.$n,{disabled:!0,icon:"spinner",variant:"primary"},"Saving..."),!Oe&&s.createElement(h.$n,{type:"submit"},"Save silence"),s.createElement(h.z9,{onClick:re,variant:"secondary"},"Cancel"))))},ie=ue=>({formContainer:(0,t.css)({maxWidth:ue.breakpoints.values.md}),alertRule:(0,t.css)({paddingBottom:ue.spacing(2)}),silencePeriod:(0,t.css)({display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:ue.spacing(1),maxWidth:ue.breakpoints.values.sm,paddingTop:ue.spacing(2)})}),ce=z},17272:(G,I,e)=>{"use strict";e.d(I,{Di:()=>d,Ee:()=>u,LP:()=>i});var t=e(70416),n=e(43127),s=e(47232),r=e(32264),o=e(98164),m=e(32642),l=e(60021);const i=p=>{const c={},y=p.get("comment"),f=p.getAll("matcher"),P=(0,m.ou)(f);return P.length&&(c.matchers=P.map(o.MU)),y&&(c.comment=y),c},u=p=>{const c=new Date,f=Date.parse(p.endsAt)<Date.now()?{start:c,end:(0,t.Ri)(c,{hours:2})}:{start:new Date(p.startsAt),end:new Date(p.endsAt)};return{id:p.id,startsAt:f.start.toISOString(),endsAt:f.end.toISOString(),comment:p.comment,createdBy:p.createdBy,duration:(0,t.dU)(f),isRegex:!1,matchers:p.matchers?.map(o.MU)||[],matcherName:"",matcherValue:"",timeZone:n.lE}},d=p=>{const c=new Date,y=(0,t.Ri)(c,{hours:2});return{id:"",startsAt:c.toISOString(),endsAt:y.toISOString(),comment:`created ${(0,s.KQ)().format("YYYY-MM-DD HH:mm")}`,createdBy:r.$.bootData.user.name,duration:"2h",isRegex:!1,matcherName:"",matcherValue:"",timeZone:n.lE,matchers:[{name:"",value:"",operator:l.ho.equal}],...p}}},19073:(G,I,e)=>{"use strict";e.d(I,{Ej:()=>h,Hl:()=>O,L7:()=>S,QI:()=>y,RY:()=>P,e2:()=>g,iI:()=>T,j5:()=>f,mh:()=>D});var t=e(96540),n=e(16233),s=e(11167),r=e(60021),o=e(31678),m=e(82843),l=e(70383),i=e(75471),u=e(57220),d=e(56361),p=e(23662),c=e(97009),y=(M=>(M.ViewExternalConfiguration="view-external-configuration",M.UpdateExternalConfiguration="update-external-configuration",M.CreateContactPoint="create-contact-point",M.ViewContactPoint="view-contact-point",M.UpdateContactPoint="edit-contact-points",M.DeleteContactPoint="delete-contact-point",M.ExportContactPoint="export-contact-point",M.CreateNotificationTemplate="create-notification-template",M.ViewNotificationTemplate="view-notification-template",M.UpdateNotificationTemplate="edit-notification-template",M.DeleteNotificationTemplate="delete-notification-template",M.DecryptSecrets="decrypt-secrets",M.CreateNotificationPolicy="create-notification-policy",M.ViewNotificationPolicyTree="view-notification-policy-tree",M.UpdateNotificationPolicyTree="update-notification-policy-tree",M.DeleteNotificationPolicy="delete-notification-policy",M.ExportNotificationPolicies="export-notification-policies",M.ViewAutogeneratedPolicyTree="view-autogenerated-policy-tree",M.CreateSilence="create-silence",M.ViewSilence="view-silence",M.UpdateSilence="update-silence",M.PreviewSilencedInstances="preview-silenced-alerts",M.ViewMuteTiming="view-mute-timing",M.CreateMuteTiming="create-mute-timing",M.UpdateMuteTiming="update-mute-timing",M.DeleteMuteTiming="delete-mute-timing",M.ExportMuteTimings="export-mute-timings",M))(y||{}),f=(M=>(M.Duplicate="duplicate-alert-rule",M.View="view-alert-rule",M.Update="update-alert-rule",M.Delete="delete-alert-rule",M.Explore="explore-alert-rule",M.Silence="silence-alert-rule",M.ModifyExport="modify-export-rule",M.Pause="pause-alert-rule",M))(f||{}),P=(M=>(M.CreateAlertRule="create-alert-rule",M.ViewAlertRule="view-alert-rule",M.UpdateAlertRule="update-alert-rule",M.DeleteAlertRule="delete-alert-rule",M.ExportGrafanaManagedRules="export-grafana-managed-rules",M.ReadConfigurationStatus="read-configuration-status",M.CreateExternalAlertRule="create-external-alert-rule",M.ViewExternalAlertRule="view-external-alert-rule",M.UpdateExternalAlertRule="update-external-alert-rule",M.DeleteExternalAlertRule="delete-external-alert-rule",M))(P||{});const a=!0,E=!1,g=()=>({"create-alert-rule":b(a,o.AccessControlAction.AlertingRuleCreate),"view-alert-rule":b(a,o.AccessControlAction.AlertingRuleRead),"update-alert-rule":b(a,o.AccessControlAction.AlertingRuleUpdate),"delete-alert-rule":b(a,o.AccessControlAction.AlertingRuleDelete),"export-grafana-managed-rules":b(a,o.AccessControlAction.AlertingRuleRead),"read-configuration-status":[a,n.TP.hasPermission(o.AccessControlAction.AlertingInstanceRead)||n.TP.hasPermission(o.AccessControlAction.AlertingNotificationsRead)],"create-external-alert-rule":b(a,o.AccessControlAction.AlertingRuleExternalWrite),"view-external-alert-rule":b(a,o.AccessControlAction.AlertingRuleExternalRead),"update-external-alert-rule":b(a,o.AccessControlAction.AlertingRuleExternalWrite),"delete-external-alert-rule":b(a,o.AccessControlAction.AlertingRuleExternalWrite)}),h=M=>g()[M];function D(M,A){const R=C(M);return(0,t.useMemo)(()=>R[A],[R,A])}function v(M,A){const R=C(M);return useMemo(()=>A.map(B=>R[B]),[R,A])}function C(M){const A=M.namespace.rulesSource,R=typeof A=="string"?A:A.name,B=(0,p.lT)(M.rulerRule)&&!!M.rulerRule.grafana_alert.provenance,U=(0,p.YN)(M.group),W=(0,p.lT)(M.rulerRule),N=(0,p.Tm)(M),w=B||U||N,{isEditable:L,isRemovable:V,isRulerAvailable:K=!1,loading:k}=(0,c.g)(R,M.rulerRule),[j,H]=h("export-grafana-managed-rules"),J=k?E:K,X=w?E:J,se=N?E:J,ae=(0,i.Wd)(R),ne=x(M);return{"duplicate-alert-rule":b(se,ae.create),"view-alert-rule":b(a,ae.read),"update-alert-rule":[X,L??!1],"delete-alert-rule":[X,V??!1],"explore-alert-rule":b(a,o.AccessControlAction.DataSourcesExplore),"silence-alert-rule":ne,"modify-export-rule":[W,H],"pause-alert-rule":[X&&W,L??!1]}}function T(){const{selectedAlertmanager:M,hasConfigurationAPI:A,isGrafanaAlertmanager:R}=(0,l.VI)(),B=(0,i.lV)(M),U=(0,i.jy)(M);return{"view-external-configuration":b(a,o.AccessControlAction.AlertingNotificationsExternalRead),"update-external-configuration":b(A,o.AccessControlAction.AlertingNotificationsExternalWrite),"create-contact-point":b(A,B.create),"view-contact-point":b(a,B.read),"edit-contact-points":b(A,B.update),"delete-contact-point":b(A,B.delete),"export-contact-point":b(R,B.read),"create-notification-template":b(A,B.create),"view-notification-template":b(a,B.read),"edit-notification-template":b(A,B.update),"delete-notification-template":b(A,B.delete),"create-notification-policy":b(A,B.create),"view-notification-policy-tree":b(a,B.read),"update-notification-policy-tree":b(A,B.update),"delete-notification-policy":b(A,B.delete),"export-notification-policies":b(R,B.read),"decrypt-secrets":b(R,B.provisioning.readSecrets),"view-autogenerated-policy-tree":[R,(0,d.qc)()],"create-silence":b(a,U.create),"view-silence":b(a,U.read),"update-silence":b(a,U.update),"preview-silenced-alerts":b(a,U.read),"create-mute-timing":b(A,B.create),"view-mute-timing":b(a,B.read),"update-mute-timing":b(A,B.update),"delete-mute-timing":b(A,B.delete),"export-mute-timings":b(R,B.read)}}function S(M){const A=T();return(0,t.useMemo)(()=>A[M],[A,M])}function O(M){const A=T();return(0,t.useMemo)(()=>M.map(R=>A[R]),[A,M])}function x(M){const R=M.namespace.rulesSource===u.hY,{currentData:B,isLoading:U}=m.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery(void 0,{skip:!R}),W=(0,p.lT)(M.rulerRule)?M.rulerRule.grafana_alert.namespace_uid:void 0,{loading:N,folder:w}=(0,s.a)(W);if(!R||U||N||!w)return[!1,!1];const L=B?.alertmanagersChoice===r.nA.External,V=B?.alertmanagersChoice===r.nA.All,K=!L||V,{accessControl:k={}}=w,j=!!(n.TP.hasPermission(o.AccessControlAction.AlertingInstanceCreate)||k[o.AccessControlAction.AlertingSilenceCreate]);return[K,j]}const b=(M,A)=>[M,n.TP.hasPermission(A)]},62190:(G,I,e)=>{"use strict";e.d(I,{W:()=>s});var t=e(96540),n=e(57220);function s(r){return(0,t.useMemo)(()=>(0,n.sq)(r),[r])}},36135:(G,I,e)=>{"use strict";e.d(I,{g:()=>r});var t=e(96540),n=e(19347),s=e(26657);function r(o){return{allDataSourcesAvailable:(0,t.useMemo)(()=>o.filter(l=>!(0,s.s9)(l.datasourceUid)).every(l=>!!(0,n.l)().getInstanceSettings(l.datasourceUid)),[o])}}},730:(G,I,e)=>{"use strict";e.d(I,{$q:()=>v,Ll:()=>D,O3:()=>T,ZU:()=>E,we:()=>f});var t=e(96540),n=e(16817),s=e(31678),r=e(79938),o=e(77583),m=e(23770),l=e(57220),i=e(88467),u=e(18461),d=e(23662),p=e(9518),c=e(61410);function y(S,O){const x=P(O),b=useCombinedRuleNamespaces(O),M=useMemo(()=>{if(!S||!O||b.length===0)return[];const A=[];for(const R of b)for(const B of R.groups)for(const U of B.rules)U.name===S&&A.push(U);return A},[S,O,b]);return{...x,result:M}}function f(S,O,x){const b=(0,l.oh)(O),{dsFeatures:M,isLoadingDsFeatures:A}=T(O),{currentData:R,isLoading:B,error:U}=r.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:O,ruleName:S,namespace:x?.namespace,groupName:x?.groupName}),[W]=r.hK.endpoints.rulerRuleGroup.useLazyQuery(),{loading:N,error:w,value:L}=(0,n.A)(async()=>{if(!b)throw new Error("Unable to obtain data source settings");if(U)throw new Error("Unable to obtain Prometheus rules");const V=R||[],K=[];if(M?.rulerConfig){const H=M.rulerConfig,J=V.map(X=>X.groups.map(se=>({namespace:X,group:se}))).flat();await Promise.allSettled(J.map(async X=>{const se=await W({rulerConfig:H,namespace:X.namespace.name,group:X.group.name}).unwrap();K.push(se)}))}return V.map(H=>(0,p.O6)(b,H,K)).flatMap(H=>H.groups.flatMap(J=>J.rules))},[b,M,B,U,R,W]);return{loading:A||N,error:w,rules:L}}function P(S,O){const x=useDispatch(),b=useUnifiedAlertingSelector(U=>U.promRules),M=a(S,b),A=useUnifiedAlertingSelector(U=>U.rulerRules),R=a(S,A),{loading:B}=useAsync(async()=>{S&&await x(fetchPromAndRulerRulesAction({rulesSourceName:S,identifier:O}))},[x,S]);return{loading:B,error:M.error??isRulerNotSupportedResponse(R)?void 0:R.error,dispatched:M.dispatched&&R.dispatched}}function a(S,O){if(!S)return initialAsyncRequestState;const x=O[S];return x||initialAsyncRequestState}function E({ruleIdentifier:S}){const{ruleSourceName:O}=S,x=h(S),{dsFeatures:b,isLoadingDsFeatures:M}=T(O),{loading:A,error:R,result:B}=g(S),{currentData:U,isLoading:W,error:N}=r.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:S.ruleSourceName,namespace:B?.namespace,groupName:B?.group,ruleName:B?.ruleName},{skip:!B||A,refetchOnMountOrArgChange:!0}),[w,{currentData:L,isLoading:V,error:K,isUninitialized:k}]=r.hK.endpoints.rulerRuleGroup.useLazyQuery();(0,t.useEffect)(()=>{!b?.rulerConfig||!B||w({rulerConfig:b.rulerConfig,namespace:B.namespace,group:B.group})},[b,w,B]);const j=(0,t.useMemo)(()=>{if(!(!U||!x)&&U.length>0){const H=U.map(J=>(0,p.O6)(x,J,L?[L]:[]));for(const J of H)for(const X of J.groups)for(const se of X.rules){const ae=u.UP(O,se);if(u.LC(ae,S))return se}}},[S,O,U,L,x]);return{loading:M||W||V||k,error:R??N??K,result:j}}function g(S){const{isLoading:O,currentData:x,error:b,isUninitialized:M}=r.hK.endpoints.getAlertRule.useQuery({uid:(0,d.A4)(S)?S.uid:""},{skip:!(0,d.A4)(S),refetchOnMountOrArgChange:!0});return(0,t.useMemo)(()=>(0,d.Mj)(S)||(0,d.X4)(S)?{result:{namespace:S.namespace,group:S.groupName,ruleName:S.ruleName},loading:!1}:(0,d.A4)(S)?O||M?{loading:!0}:b?{loading:!1,error:b}:x?{result:{namespace:x.grafana_alert.namespace_uid,group:x.grafana_alert.rule_group,ruleName:x.grafana_alert.title},loading:!1}:{loading:!1,error:new Error(`Unable to obtain rule location for rule ${S.uid}`)}:{loading:!1,error:new Error("Unsupported rule identifier")},[S,O,M,b,x])}function h(S){return(0,d.A4)(S)?"grafana":(0,l.oh)(S.ruleSourceName)}function D({ruleIdentifier:S}){const O=h(S),{dsFeatures:x,isLoadingDsFeatures:b}=T(S.ruleSourceName),{loading:M,error:A,result:R}=g(S),[B,{currentData:U,isLoading:W,isUninitialized:N,error:w}]=r.hK.endpoints.rulerRuleGroup.useLazyQuery();(0,t.useEffect)(()=>{!x?.rulerConfig||!R||B({rulerConfig:x.rulerConfig,namespace:R.namespace,group:R.group})},[x,B,R]);const L=(0,t.useMemo)(()=>{const{ruleSourceName:V}=S;if(!U||!O||!R)return;const K=U.rules.find(k=>{const j=u.P1(V,R.namespace,R.group,k);return u.LC(j,S)});if(K)return{ruleSourceName:V,group:U,namespace:R.namespace,rule:K}},[S,U,O,R]);return{loading:M||b||W||N,error:A??w,result:L}}const v={dataSourceName:l.hY,apiVersion:"legacy"},C={rulerConfig:v};function T(S){const O=(0,l.z2)(S),{currentData:x,isLoading:b}=o.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:S},{skip:O});return O?{isLoadingDsFeatures:!1,dsFeatures:C}:{isLoadingDsFeatures:b,dsFeatures:x}}},9518:(G,I,e)=>{"use strict";e.d(I,{Jr:()=>a,NW:()=>v,O6:()=>f,Tj:()=>C,Ug:()=>D,dy:()=>c,kU:()=>A});var t=e(2543),n=e.n(t),s=e(96540),r=e(54317),o=e(94822),m=e(79938),l=e(55740),i=e(57220),u=e(23662),d=e(730),p=e(61410);function c(R,B){const U=(0,p.$)(L=>L.promRules),W=(0,p.$)(L=>L.rulerRules),N=(0,s.useRef)({}),w=(0,s.useMemo)(()=>{if(R){const L=(0,i.Zw)(R);if(!L)throw new Error(`Unknown rules source: ${R}`);return[L]}return(0,i.lS)()},[R]);return(0,s.useMemo)(()=>w.map(L=>{const V=(0,i.Eb)(L)?L.name:L,K=W[V]?.result;let k=U[V]?.result;V===i.hY&&B&&(k=B);const j=N.current[V];if(j&&j.promRules===k&&j.rulerRules===K)return j.result;const H={};Object.entries(K||{}).forEach(([X,se])=>{const ae={rulesSource:L,name:X,groups:[]};(0,u.lT)(se[0].rules[0])&&(ae.uid=se[0].rules[0].grafana_alert.namespace_uid),H[X]=ae,g(ae,se)}),k?.forEach(({name:X,groups:se})=>{const ae=H[X]=H[X]||{rulesSource:L,name:X,groups:[]};h(ae,se)});const J=Object.values(H);return N.current[V]={promRules:k,rulerRules:K,result:J},J}).flat(),[U,W,w,B])}function y(R,B,U){const W={};return Object.entries(U||{}).forEach(([N,w])=>{const L={rulesSource:R,name:N,groups:[]};W[N]=L,g(L,w)}),B?.forEach(({name:N,groups:w})=>{const L=W[N]=W[N]||{rulesSource:R,name:N,groups:[]};h(L,w)}),Object.values(W)}function f(R,B,U){const W={rulesSource:R,name:B.name,groups:[]};return g(W,U),h(W,B.groups),W.groups.forEach(N=>{N.rules=N.rules.filter(w=>w.promRule)}),W}function P(R,B,U){return g(R,U),h(R,B),R}function a(R){return R.map(B=>{const U={...B,groups:[]};return U.groups.push({name:"default",rules:E(B.groups.flatMap(W=>W.rules)),totals:T(B.groups)}),U})}function E(R){return R.sort((B,U)=>B.name.localeCompare(U.name))}function g(R,B=[]){R.groups=B.map(U=>{const W=U.rules.filter(L=>(0,u.i7)(L)).length,N=U.rules.filter(L=>(0,u.lT)(L)&&L.grafana_alert.is_paused).length,w={name:U.name,interval:U.interval,source_tenants:U.source_tenants,rules:[],totals:{paused:N,recording:W}};return w.rules=U.rules.map(L=>O(L,R,w)),w})}function h(R,B){const U=new Map;R.groups.forEach(W=>U.set(W.name,W)),B.forEach(W=>{let N=U.get(W.name);N||(N={name:W.name,rules:[],totals:C(W)},R.groups.push(N),U.set(W.name,N)),N.totals={...N.totals,...C(W)};const w=new Map;N.rules.forEach(L=>{const V=w.get(L.name);V?V.push(L):w.set(L.name,[L])}),(W.rules??[]).forEach(L=>{const V=x(L,w,R.rulesSource);V?(V.promRule=L,V.instanceTotals=(0,u.Z8)(L)?D(L):{},V.filteredInstanceTotals=(0,u.Z8)(L)?v(L):{}):N.rules.push(S(L,R,N))})})}function D(R){const B=(0,t.countBy)(R.alerts,"state");if(R.totals){const{normal:U,...W}=R.totals;return{...W,inactive:U}}return{alerting:B[r.$.Alerting]||B.firing,pending:B[r.$.Pending],inactive:B[r.$.Normal],nodata:B[r.$.NoData],error:B[r.$.Error]||B.err||void 0}}function v(R){if(R.totalsFiltered){const{normal:B,...U}=R.totalsFiltered;return{...U,inactive:B}}return{}}function C(R){if(R.totals){const{firing:N,...w}=R.totals;return{...w,alerting:N}}const B=(0,t.countBy)(R.rules,N=>(0,u.Z8)(N)&&N.state),U=(0,t.countBy)(R.rules,N=>N.health),W=R.rules.filter(N=>(0,u.KB)(N)).length;return{alerting:B[o.cF.Firing],error:U.error,nodata:U.nodata,inactive:B[o.cF.Inactive],pending:B[o.cF.Pending],recording:W}}function T(R){const B={};return R.forEach(U=>{const W=U.totals;Object.entries(W).forEach(([N,w])=>{B[N]||(B[N]=0),B[N]+=w})}),B}function S(R,B,U){return{name:R.name,query:R.query,labels:R.labels||{},annotations:(0,u.Z8)(R)?R.annotations||{}:{},promRule:R,namespace:B,group:U,instanceTotals:(0,u.Z8)(R)?D(R):{},filteredInstanceTotals:(0,u.Z8)(R)?v(R):{}}}function O(R,B,U){return(0,u.$y)(R)?{name:R.alert,query:R.expr,labels:R.labels||{},annotations:R.annotations||{},rulerRule:R,namespace:B,group:U,instanceTotals:{},filteredInstanceTotals:{}}:(0,u.i7)(R)?{name:R.record,query:R.expr,labels:R.labels||{},annotations:{},rulerRule:R,namespace:B,group:U,instanceTotals:{},filteredInstanceTotals:{}}:{name:R.grafana_alert.title,query:"",labels:R.labels||{},annotations:R.annotations||{},rulerRule:R,namespace:B,group:U,instanceTotals:{},filteredInstanceTotals:{}}}function x(R,B,U){const W=B.get(R.name);if(!W)return;if((0,i.z2)(U))return W[0];const N=W.find(L=>!L.promRule&&b(L,R,!0));if(N)return N;const w=W.find(L=>!L.promRule&&b(L,R,!1));if(w)return w}function b(R,B,U=!0){return R.name===B.name?(0,t.isEqual)([U?M(R.query):"",R.labels,R.annotations],[U?M(B.query):"",B.labels||{},(0,u.Z8)(B)?B.annotations||{}:{}]):!1}function M(R){return R.length>1&&R[0]==="("&&R[R.length-1]===")"&&(R=R.slice(1,-1)),R=R.replace(/\s|\n/g,""),R.split("").sort().join("")}function A(R,B,U){const{currentData:W,isLoading:N,error:w}=m.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:i.hY,dashboardUid:R,panelId:B},{pollingInterval:U?l.HH:void 0}),{currentData:L,isLoading:V,error:K}=m.hK.endpoints.rulerRules.useQuery({rulerConfig:d.$q,filter:{dashboardUID:R,panelId:B}},{pollingInterval:U?l.HH:void 0}),k=(0,s.useRef)({}),j=(0,i.Zw)(i.hY),H=(0,s.useMemo)(()=>{if(!j)return[];const J=k.current[i.hY];if(J&&J.promRules===W&&J.rulerRules===L)return J.result;const X={};Object.entries(L||{}).forEach(([ae,ne])=>{const q={rulesSource:j,name:ae,groups:[]};(0,u.lT)(ne[0].rules[0])&&(q.uid=ne[0].rules[0].grafana_alert.namespace_uid),X[ae]=q,g(q,ne)}),W?.forEach(({name:ae,groups:ne})=>{const q=X[ae]=X[ae]||{rulesSource:j,name:ae,groups:[]};h(q,ne)});const se=Object.values(X);return k.current[i.hY]={promRules:W,rulerRules:L,result:se},se},[W,L,j]);return{loading:N||V,error:w??K,result:H}}},14285:(G,I,e)=>{"use strict";e.d(I,{dI:()=>g,i7:()=>h});var t=e(53076),n=e(1932),s=e(2543),r=e.n(s),o=e(96540),m=e(19347),l=e(94822),i=e(28475),u=e(98164),d=e(55740),p=e(57220),c=e(32642),y=e(23662),f=e(9518),P=e(39964);const a=25,E=1/0;function g(){const[b,M]=(0,P.l)(),A=b.get("search")??"",R=(0,o.useMemo)(()=>(0,i.XY)(A),[A]),B=(0,o.useMemo)(()=>Object.values(R).some(N=>!(0,s.isEmpty)(N)),[R]),U=(0,o.useCallback)(N=>{const w=(0,i.kL)(A,N);M({search:w})},[A,M]),W=(0,o.useCallback)(N=>{M({search:N})},[M]);return(0,o.useEffect)(()=>{const N={dataSource:b.get("dataSource")??void 0,alertState:b.get("alertState")??void 0,ruleType:b.get("ruleType")??void 0,labels:(0,u.J$)(b.get("queryString")??"").map(u.MU)};Object.values(N).some(L=>!(0,s.isEmpty)(L))&&(M({dataSource:void 0,alertState:void 0,ruleType:void 0,queryString:void 0}),U((0,n.jM)(R,L=>{if(L.dataSourceNames??=N.dataSource?[N.dataSource]:[],N.alertState&&(0,l.Si)(N.alertState)&&(L.ruleState??=N.alertState),N.ruleType&&(0,y.nf)(N.ruleType)&&(L.ruleType??=N.ruleType),L.labels.length===0&&N.labels.length>0){const V=N.labels.map(({name:K,operator:k,value:j})=>`${K}${k}${j}`);L.labels.push(...V)}})))},[b,U,R,M]),{filterState:R,hasActiveFilters:B,searchQuery:A,setSearchQuery:W,updateFilters:U}}const h=(b,M)=>(0,o.useMemo)(()=>{const A=D(b,M);return A.forEach(R=>{R.groups.forEach(B=>{B.rules.forEach(U=>{(0,y.Z8)(U.promRule)&&(U.instanceTotals=(0,f.Ug)(U.promRule),U.filteredInstanceTotals=(0,f.NW)(U.promRule))}),B.totals=(0,f.Tj)({rules:B.rules.map(U=>U.promRule).filter(U=>!!U)})})}),A},[b,M]),D=(b,M={dataSourceNames:[],labels:[],freeFormWords:[]})=>{let A=b;const R=M.dataSourceNames;R.length&&(A=A.filter(({rulesSource:U})=>(0,p.Eb)(U)?R.includes(U.name):!0));const B=M.namespace;if(B){const U=A.map(V=>V.name),W=O(B),[N,w,L]=W.search(U,B,T(B),E);w&&L?A=L.map(V=>A[w.idx[V]]):N&&(A=N.map(V=>A[V]))}return A.reduce(v(M),[])},v=b=>(M,A)=>{const R=b.groupName;let B=A.groups;if(R){const U=B.map(V=>V.name),W=O(R),[N,w,L]=W.search(U,R,T(R),E);w&&L?B=L.map(V=>B[w.idx[V]]):N&&(B=N.map(V=>B[V]))}return B=B.reduce(C(b),[]),B.length&&M.push({...A,groups:B}),M},C=b=>{const M=b.ruleName??b.freeFormWords.join(" ");return(A,R)=>{let B=R.rules;if(M){const U=B.map(V=>V.name),W=O(M),[N,w,L]=W.search(U,M,T(M),E);w&&L?B=L.map(V=>B[w.idx[V]]):N&&(B=N.map(V=>B[V]))}return B=B.filter(U=>{const W=U.promRule,N=(0,s.chain)(b).pick(["ruleType","dataSourceNames","ruleHealth","labels","ruleState","dashboardUid","plugins"]).omitBy(s.isEmpty).mapValues(()=>!1).value();if("ruleType"in N&&b.ruleType===W?.type&&(N.ruleType=!0),"plugins"in N&&b.plugins==="hide"&&(N.plugins=!(0,y.Tm)(U)),"dataSourceNames"in N&&((0,y.lT)(U.rulerRule)?x(U.rulerRule,b)&&(N.dataSourceNames=!0):N.dataSourceNames=!0),"ruleHealth"in b&&W){const w=(0,y.f6)(W.health);b.ruleHealth===w&&(N.ruleHealth=!0)}if("labels"in N){const w=(0,s.compact)(b.labels.map(S)),L=w.length>0&&(0,u.Av)(U.labels,w),V=w.length>0&&W&&W.type===l.JS.Alerting&&W.alerts&&W.alerts.some(K=>(0,u.Av)(K.labels,w));(L||V)&&(N.labels=!0)}if("ruleState"in N){const w=U.promRule;w&&(0,y.Z8)(w)&&w.state===b.ruleState&&(N.ruleState=!0)}return"dashboardUid"in N&&U.annotations[d.YH.dashboardUID]===b.dashboardUid&&(N.dashboardUid=!0),Object.values(N).every(w=>w===!0)}),B.length&&A.push({...R,rules:B}),A}};function T(b){return O(b).split(b).length<5?4:0}function S(b){try{return(0,c.qR)(b)}catch{return{name:b,value:"",isRegex:!0,isEqual:!0}}}function O(b){const M=b.length>a;return new t.A({intraMode:M?0:1,interSplit:"\\s+"})}const x=(b,M)=>M.dataSourceNames?.length?!!b.grafana_alert.data.find(A=>{if(!A.datasourceUid)return!1;const R=(0,m.l)().getInstanceSettings(A.datasourceUid);return R?.name&&M?.dataSourceNames?.includes(R.name)}):!0},11167:(G,I,e)=>{"use strict";e.d(I,{a:()=>m});var t=e(96540),n=e(31678),s=e(23770),r=e(88467),o=e(61410);function m(l){const i=(0,n.useDispatch)(),u=(0,o.$)(d=>d.folders);if((0,t.useEffect)(()=>{l&&i((0,s.Om)(l))},[i,l]),l){const d=u[l]||r.jA;return{folder:d.result,loading:d.loading}}return{loading:!1}}},83903:(G,I,e)=>{"use strict";e.d(I,{y:()=>r});var t=e(96540),n=e(57220),s=e(61410);function r(){const o=(0,s.$)(i=>i.rulerRules),m=(0,t.useCallback)(i=>{const u=typeof i=="string"?i:i.name;return u===n.hY||!!o[u]?.result},[o]),l=(0,t.useCallback)(i=>{const u=(0,n.EV)(i);return!!o[u]?.result},[o]);return{hasRuler:m,rulerRulesLoaded:l}}},97009:(G,I,e)=>{"use strict";e.d(I,{g:()=>l});var t=e(16233),n=e(77583),s=e(75471),r=e(23662),o=e(11167),m=e(61410);function l(i,u){const d=(0,m.$)(D=>D.dataSources),{currentData:p,isLoading:c}=n.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:i}),y=u&&(0,r.lT)(u)?u.grafana_alert.namespace_uid:void 0,f=(0,s.Wd)(i),{folder:P,loading:a}=(0,o.a)(y);if(!u)return{isEditable:!1,isRemovable:!1,loading:!1};if((0,r.lT)(u)){if(!y)throw new Error(`Rule ${u.grafana_alert.title} does not have a folder uid, cannot determine if it is editable.`);if(!P)return{isRulerAvailable:!0,isEditable:!1,isRemovable:!1,loading:a};const D=t.TP.hasPermissionInMetadata(f.update,P),v=t.TP.hasPermissionInMetadata(f.delete,P);return{isRulerAvailable:!0,isEditable:D,isRemovable:v,loading:a||c}}const E=!!d[i]?.result?.rulerConfig||!!p?.rulerConfig,g=t.TP.hasPermission(f.update),h=t.TP.hasPermission(f.delete);return{isRulerAvailable:E,isEditable:g&&E,isRemovable:h&&E,loading:c||d[i]?.loading}}},98439:(G,I,e)=>{"use strict";e.d(I,{W:()=>r});var t=e(2543),n=e.n(t),s=e(96540);function r(o,m=1,l){const[i,u]=(0,s.useState)(m),d=(0,s.useMemo)(()=>(0,t.chunk)(o,l),[o,l]),p=d.length,c=d[i-1]??[],y=(i-1)*l+1,f=(0,t.clamp)(i*l,o.length),P=(0,s.useCallback)(g=>{u((0,t.clamp)(g,1,d.length))},[u,d]),a=(0,s.useCallback)(()=>P(i+1),[i,P]),E=(0,s.useCallback)(()=>P(i-1),[i,P]);return(0,s.useEffect)(()=>u(1),[p]),{page:i,onPageChange:P,numberOfPages:p,pageItems:c,pageStart:y,pageEnd:f,nextPage:a,previousPage:E}}},27747:(G,I,e)=>{"use strict";e.d(I,{S:()=>n});var t=e(9518);function n({dashboardUID:s,panelId:r,poll:o=!1}){const{result:m,loading:l,error:i}=(0,t.kU)(s,r,o);return{rules:m?m.flatMap(d=>d.groups).flatMap(d=>d.rules):[],errors:i?[i]:[],loading:l}}},12210:(G,I,e)=>{"use strict";e.d(I,{_:()=>s});var t=e(16817),n=e(27716);function s(r){const{loading:o,error:m,value:l}=(0,t.A)(()=>(0,n.x)(r,{showErrorAlert:!1})),i=l&&!m&&!o,u=l?.enabled;return o&&!l?{loading:!0}:!i||!u?{loading:!1,installed:!1}:{loading:o,installed:!0,settings:l}}},46013:(G,I,e)=>{"use strict";e.d(I,{G:()=>u,Q:()=>i});var t=e(32196),n=e(96540),s=e(32264),r=e(40845),o=e(37390);const m=(0,n.lazy)(()=>e.e(7409).then(e.bind(e,87409))),l=(0,n.lazy)(()=>e.e(1121).then(e.bind(e,31121)));var i=(p=>(p.Loki="loki",p.Annotations="annotations",p))(i||{});function u(){const[p,c]=(0,n.useState)(!1),[y,f]=(0,n.useState)(),P=(0,r.of)(d),a=s.$.unifiedAlerting.alertStateHistoryBackend,E=s.$.unifiedAlerting.alertStateHistoryPrimary,h=[a,E].some(T=>T==="loki")?"loki":"annotations",D=(0,n.useCallback)(()=>{f(void 0),c(!1)},[]),v=(0,n.useCallback)(T=>{f(T),c(!0)},[]);return{StateHistoryModal:(0,n.useMemo)(()=>y?n.createElement(o.a,{isOpen:p,onDismiss:D,closeOnBackdropClick:!0,closeOnEscape:!0,title:"State history",className:P.modal,contentClassName:P.modalContent},n.createElement(n.Suspense,{fallback:"Loading..."},h==="loki"&&n.createElement(l,{ruleUID:y.grafana_alert.uid}),h==="annotations"&&n.createElement(m,{alertId:y.grafana_alert.id??""}))):null,[y,p,D,h,P]),showStateHistoryModal:v,hideStateHistoryModal:D}}const d=p=>({modal:(0,t.css)({width:"80%",height:"80%",minWidth:"800px"}),modalContent:(0,t.css)({height:"100%",width:"100%",padding:p.spacing(2)})})},39964:(G,I,e)=>{"use strict";e.d(I,{l:()=>r});var t=e(96540),n=e(24180),s=e(12131);function r(){const{search:o}=(0,n.zy)(),m=(0,t.useMemo)(()=>new URLSearchParams(o),[o]),l=(0,t.useCallback)((i,u)=>{s.Ny.partial(i,u)},[]);return[m,l]}},61410:(G,I,e)=>{"use strict";e.d(I,{$:()=>s});var t=e(25508),n=e(31678);function s(r,o){return(0,n.useSelector)((0,t.Mz)(m=>m.unifiedAlerting,m=>r(m)),o)}},85244:(G,I,e)=>{"use strict";e.d(I,{T:()=>m});var t=e(96540),n=e(16817),s=e(39938),r=e(56034),o=e(27716);function m({pluginId:l}){const{value:i}=(0,n.A)(()=>(0,o.x)(l)),u=i?.info.logos?.small,d=u?t.createElement("img",{src:u,alt:i?.name,style:{width:"20px",height:"20px"}}):t.createElement(s.E,{text:l,color:"orange"}),p=i?`This rule is managed by the ${i?.name} plugin`:"This rule is managed by a plugin";return t.createElement(r.m,{content:p},t.createElement("div",null,d))}},28475:(G,I,e)=>{"use strict";e.d(I,{Jc:()=>k,kL:()=>H,XY:()=>j});var t=e(94822),n=e(23662);const s=1,r=2,o=3,m=4,l=5,i=6,u=7,d=8,p=9,c=10,y=11,f=12,P=13,a=14,E=0,g=1,h=2,D=3,v=4,C=5,T=6,S=7,O=8,x=9;var b=e(2543),M=e(48820);const A=M.U1.deserialize({version:14,states:"!vOQOPOOOxOPO'#CjOOOO'#Cj'#CjOQOPO'#CnOOOO'#Ck'#CkQQOPOOO!sOQO'#C^O!xOPO'#ClO!}OPO,59UOOOO,59Y,59YOOOO-E6i-E6iOOOO,58x,58xOOOO,59W,59WOOOO-E6j-E6j",stateData:"$h~ORUOTUOUUOVUOWUOXUOYUOZUO[UO]UOcPOeQO~OdVOR^XT^XU^XV^XW^XX^XY^XZ^X[^X]^Xc^Xe^X~OSZO~Oc[O~OdVOR^aT^aU^aV^aW^aX^aY^aZ^a[^a]^ac^ae^a~OR~T~U~V~W~Y~Z~[~]~R][ZYXWVUTc~",goto:"|cPPdPPPPPPPPPPPdioPuVRORTQTORYTQWPR]WSSOTRXR",nodeNames:"\u26A0 AlertRuleSearch FilterExpression DataSourceToken FilterValue NameSpaceToken LabelToken GroupToken RuleToken StateToken TypeToken HealthToken DashboardToken PluginsToken FreeFormExpression",maxTerm:21,skippedNodes:[0],repeatNodeCount:2,tokenData:"#<RRRsqr#`rs&lst#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]+n!]#W#`#W#X-Q#X#Z#`#Z#[Ig#[#]!$a#]#`#`#`#a!.s#a#b#`#b#c!7m#c#d#`#d#e!Fk#e#f#`#f#g#$g#g#h#+w#h#i#4q#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#gcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`Q$wcSQqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rQ&VP;=`<%l$rQ&]P;=`;NQ$rR&cP;=`<%l#`R&iP;=`;NQ#`R&orX^(ypq(yqr(yst(ytu(yuv(yvw(ywx(yxy(yyz(yz{(y{|(y|!P(y!P!Q(y!Q![(y![!](y!]#y(y#y#z(y#z$f(y$f$g(y$g#BY(y#BY#BZ(y#BZ$Ch(y$IS$I_(y$I|$JO(y$JT$JU(y$JU$KV(y$KV$KW(y$KW&FU(y&FU&FV(y&FV;'S(y;'S;(d+b;(d;(e+h<%lO(yR(|sX^(ypq(yqr(yrs+Zst(ytu(yuv(yvw(ywx(yxy(yyz(yz{(y{|(y|!P(y!P!Q(y!Q![(y![!](y!]#y(y#y#z(y#z$f(y$f$g(y$g#BY(y#BY#BZ(y#BZ$Ch(y$IS$I_(y$I|$JO(y$JT$JU(y$JU$KV(y$KV$KW(y$KW&FU(y&FU&FV(y&FV;'S(y;'S;(d+b;(d;(e+h<%lO(yR+bOSQePR+eP;=`<%l(yR+kP;=`;NQ(yR+ucSQdPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR-XeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U.j#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R.qfSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h0V#h#i<R#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R0^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#[#`#[#]1o#]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R1veSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#U#`#U#V3X#V$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R3`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#d4q#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R4xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U6Z#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R6beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#g7s#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R7zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#W#`#W#X9]#X$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R9dcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]:o!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R:vcSQ[Pqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR<YeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U=k#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R=reSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h?T#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R?[eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#d@m#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R@teSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#jBV#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RB^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#gCo#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RCveSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#V#`#V#WEX#W$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RE`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#YFq#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RFxcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]HT!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RH[cSQRPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rRIneSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#gKP#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RKWeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#dLi#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RLpeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#jNR#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RNYeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e! k#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R! rcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!!}!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!#UcSQVPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!$heSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!%y#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!&QeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!'c#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!'jeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!({#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!)SeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i!*e#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!*leSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#[#`#[#]!+}#]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!,UcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!-a!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!-hcSQZPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!.zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!0]#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!0deSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#U#`#U#V!1u#V$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!1|eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!3_#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!3feSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!4w#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!5OcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!6Z!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!6bcSQUPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!7teSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!9V#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!9^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#a#`#a#b!:o#b$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!:veSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!<X#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!<`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h!=q#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!=xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e!?Z#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!?beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!@s#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!@zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#V#`#V#W!B]#W$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!BdeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!Cu#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!C|cSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!EX!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!E`cSQTPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!FreSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!HT#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!H[eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#j!Im#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!IteSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#Z#`#Z#[!KV#[$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!K^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#]#`#]#^!Lo#^$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!LveSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#b#`#b#c!NX#c$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!N`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h# q#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R# xcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]##T!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R##[cSQ]Pqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#$neSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#j#&P#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#&WeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a#'i#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#'peSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#)R#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#)YcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#*e!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#*lcSQWPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#,OeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i#-a#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#-heSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U#.y#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#/QeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i#0c#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#0jeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#1{#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#2ScSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#3_!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#3fcSQXPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#4xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#m#`#m#n#6Z#n$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#6beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e#7s#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#7zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#9]#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#9dcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#:o!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#:vcSQYPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$r",tokenizers:[0,1],topRules:{AlertRuleSearch:[0,1]},dialects:{dataSourceFilter:132,nameSpaceFilter:134,labelFilter:136,groupFilter:138,ruleFilter:140,stateFilter:78,typeFilter:142,healthFilter:144,dashboardFilter:146,pluginsFilter:148},tokenPrec:150}),R={[o]:"datasource",[l]:"namespace",[i]:"label",[d]:"rule",[u]:"group",[p]:"state",[c]:"type",[y]:"health",[f]:"dashboard",[P]:"plugins"};var B=(X=>(X.dataSource="dataSourceFilter",X.nameSpace="nameSpaceFilter",X.label="labelFilter",X.group="groupFilter",X.rule="ruleFilter",X.state="stateFilter",X.type="typeFilter",X.health="healthFilter",X.dashboard="dashboardFilter",X.plugins="pluginsFilter",X))(B||{});function U(X,se,ae){L(X,se,ne=>{if(ne.type.id===r){const q=W(X,ne);if(q.type&&q.value){const ee=ae[q.type];ee&&ee(q.value)}}else if(ne.type.id===a){const q=ae[a];q&&q(N(X,ne))}})}function W(X,se){if(se.type.id!==r)throw new Error("Invalid node provided. Only FilterExpression nodes are supported");const ae=se.firstChild;if(!ae)return{type:void 0,value:void 0};const ne=se.getChild(m),q=ne?(0,b.trim)(N(X,ne),'"'):void 0;return{type:ae.type.id,value:q}}function N(X,se){return X.slice(se.from,se.to).trim().replace(/\"/g,"")}function w(X,se,ae){const ne=[];L(X,se,ee=>{ee.type.id===r&&ee.firstChild&&ne.push(ee.firstChild),ee.type.id===a&&ne.push(ee)});let q=[];return ne.forEach(ee=>{const z=ae.findIndex(te=>te.type===ee.type.id);if(z!==-1){if(ee.parent?.type.is(r)){const te=R[ee.type.id],ie=ae.splice(z,1)[0];q.push(`${te}:${V(ie.value)}`)}if(ee.type.is(a)){const te=ae.splice(z,1)[0];q.push(te.value)}}}),ae.forEach(ee=>{ee.type===a?q.push(ee.value):q.push(`${R[ee.type]}:${V(ee.value)}`)}),q.join(" ")}function L(X,se,ae){const ne=se.join(" ");let ee=A.configure({dialect:ne}).parse(X).cursor();do ae(ee.node);while(ee.next())}function V(X){return/\s/.test(X)?`"${X}"`:X}const K=[B.dataSource,B.nameSpace,B.label,B.group,B.rule,B.state,B.type,B.health,B.dashboard,B.plugins];var k=(X=>(X.Ok="ok",X.Error="error",X.NoData="nodata",X.Unknown="unknown",X))(k||{});function j(X){const se={labels:[],freeFormWords:[],dataSourceNames:[]},ae={[o]:ne=>se.dataSourceNames.push(ne),[l]:ne=>se.namespace=ne,[u]:ne=>se.groupName=ne,[d]:ne=>se.ruleName=ne,[i]:ne=>se.labels.push(ne),[p]:ne=>se.ruleState=J(ne),[c]:ne=>(0,n.nf)(ne)?se.ruleType=ne:void 0,[y]:ne=>se.ruleHealth=(0,n.f6)(ne),[f]:ne=>se.dashboardUid=ne,[P]:ne=>se.plugins=ne==="hide"?ne:void 0,[a]:ne=>se.freeFormWords.push(ne)};return U(X,K,ae),se}function H(X,se){const ae=[];return se.dataSourceNames&&ae.push(...se.dataSourceNames.map(ne=>({type:o,value:ne}))),se.namespace&&ae.push({type:l,value:se.namespace}),se.groupName&&ae.push({type:u,value:se.groupName}),se.ruleName&&ae.push({type:d,value:se.ruleName}),se.ruleState&&ae.push({type:p,value:se.ruleState}),se.ruleType&&ae.push({type:c,value:se.ruleType}),se.ruleHealth&&ae.push({type:y,value:se.ruleHealth}),se.labels&&ae.push(...se.labels.map(ne=>({type:i,value:ne}))),se.dashboardUid&&ae.push({type:f,value:se.dashboardUid}),se.plugins&&ae.push({type:P,value:se.plugins}),se.freeFormWords&&ae.push(...se.freeFormWords.map(ne=>({type:a,value:ne}))),w(X,K,ae)}function J(X){if(X==="normal")return t.cF.Inactive;if((0,t.Si)(X))return X}},28318:(G,I,e)=>{"use strict";e.d(I,{t:()=>A});var t=e(2543),n=e(39741),s=e(62467),r=e(66847),o=e(1005),m=e(81160),l=e(62938),i=e(39070),u=e(14236),d=e(72495),p=e(65879),c=e(43127),y=e(89667),f=e(19347),P=e(26657),a=e(12091),E=e(27677),g=e(69437),h=e(81583),D=e(72955),v=e(66718);const C={from:21600,to:0},T=(L,V)=>{const K=S(L,V);if(!K)return C;const{from:k,to:j}=x(K,V);return!k.length&&!j.length?C:{from:Math.max(...k),to:Math.min(...j)}},S=(L,V)=>{switch(L.type){case v.Tz.classic:return O(L);case v.Tz.math:case v.Tz.sql:return b(L,V);case v.Tz.resample:case v.Tz.reduce:case v.Tz.threshold:return M(L)}},O=L=>L.conditions?.map(V=>V.query.params[0]),x=(L,V)=>{let K=[],k=[C.to];for(const j of L){const H=V.find(J=>J.refId===j);!H||!H.relativeTimeRange||(K.push(H.relativeTimeRange.from),k.push(H.relativeTimeRange.to))}return{from:K,to:k}},b=(L,V)=>V.filter(K=>K.queryType==="query"&&L.expression?.includes(K.refId)).map(K=>K.refId),M=L=>L.expression?[L.expression]:void 0;class A{constructor(V=(0,E.AI)(),K=(0,f.l)()){this.backendSrv=V,this.dataSourceSrv=K,this.subject=new n.m(1),this.lastResult={}}get(){return this.subject.asObservable()}async run(V,K){const k=B(V,i.Gu.Done),j=[];for(const J of V){const X=J.model.refId;if((0,g.f)(J.model))continue;const se=await this.dataSourceSrv.get(J.datasourceUid);se instanceof P.iy&&se.filterQuery&&!se.filterQuery(J.model)&&j.push(X)}const H=(0,t.reject)(V,J=>j.includes(J.model.refId));if(H.length===0)return this.subject.next(k);this.subscription=R(this.backendSrv,H,K).subscribe({next:J=>{const X=w(J,(se,ae)=>{const ne=this.lastResult[se],q=(0,u.N$)(ae,ne);return(0,D.B)(q,ne)});this.lastResult=X,this.subject.next(this.lastResult)},error:J=>{this.lastResult=N(this.lastResult,J),this.subject.next(this.lastResult)}})}cancel(){if(!this.subscription)return;this.subscription.unsubscribe();let V=!1;const K=w(this.lastResult,(k,j)=>(j.state===i.Gu.Loading&&(V=!0),{...j,state:i.Gu.Done}));V&&this.subject.next(K)}destroy(){this.subject&&this.subject.complete(),this.cancel()}}const R=(L,V,K)=>{const k=B(V,i.Gu.Loading),j={data:{data:V,condition:K},url:"/api/v1/eval",method:"POST",requestId:(0,l.A)()};return(0,d.k)({whileLoading:k,source:L.fetch(j).pipe(W(k),(0,r.W)(H=>(0,s.of)(N(k,H))),(0,h.N)(L,j.requestId),(0,o.u)())})},B=(L,V)=>L.reduce((K,k)=>(K[k.refId]={state:V,series:[],timeRange:U(k,L)},K),{}),U=(L,V)=>{if((0,g.f)(L.model)){const K=T(L.model,V);return p.relativeToTimeRange(K)}return L.relativeTimeRange?p.relativeToTimeRange(L.relativeTimeRange):(console.warn(`Query with refId: ${L.refId} did not have any relative time range, using default.`),(0,c.E2)())},W=L=>(0,m.T)(V=>{const{data:K}=V,k={};for(const[j,H]of Object.entries(K.results)){const{error:J,status:X,frames:se=[]}=H,ae=J?[{message:J,refId:j,status:X}]:[];k[j]={errors:ae,timeRange:L[j].timeRange,state:i.Gu.Done,series:se.map(y.or)}}return k}),N=(L,V)=>{const K=(0,a.u)(V);return w(L,(k,j)=>({...j,state:i.Gu.Error,error:K}))},w=(L,V)=>{const K={};for(const[k,j]of Object.entries(L))K[k]=V(k,j);return K}},70383:(G,I,e)=>{"use strict";e.d(I,{Kh:()=>y,VI:()=>d,b9:()=>u});var t=e(96540),n=e(33390),s=e(60021),r=e(62190),o=e(39964),m=e(55740),l=e(57220);const i=t.createContext(void 0),u=({children:f,accessType:P,alertmanagerSourceName:a})=>{const[E,g]=(0,o.l)(),h=(0,r.W)(P),D=h.availableInternalDataSources.concat(h.availableExternalDataSources),v=t.useCallback(U=>{p(D,U)&&(U===l.hY?(n.A.delete(m.Oq),g({[m.DD]:void 0})):(n.A.set(m.Oq,U),g({[m.DD]:U})))},[D,g]),C=E.get(m.DD),T=n.A.get(m.Oq),S=l.hY;t.useEffect(()=>{C&&C!==T&&n.A.set(m.Oq,C)},[C,T]);const O=a??C??T??S,x=p(D,O)?O:void 0,b=(0,l.r3)(x)?.jsonData,M=x===l.hY,A=b?y(b):!1,B={selectedAlertmanager:x,hasConfigurationAPI:M||A,isGrafanaAlertmanager:M,selectedAlertmanagerConfig:b,availableAlertManagers:D,setSelectedAlertmanager:v};return t.createElement(i.Provider,{value:B},f)};function d(){const f=t.useContext(i);if(f===void 0)throw new Error("useAlertmanager must be used within a AlertmanagerContext");return f}function p(f,P){return f.map(E=>E.name).includes(P)}const c=[s.Oz.mimir,s.Oz.cortex,void 0];function y(f){return c.includes(f.implementation)}},23770:(G,I,e)=>{"use strict";e.d(I,{nO:()=>ce,$8:()=>ue,KH:()=>H,g6:()=>j,EY:()=>ee,D3:()=>ie,yo:()=>K,wE:()=>L,nV:()=>k,Tp:()=>z,Om:()=>te,JH:()=>ae,mF:()=>se,Lc:()=>N,mB:()=>U,eB:()=>W,HB:()=>w,DC:()=>V,uQ:()=>Te,_$:()=>J,bO:()=>fe,RW:()=>ne,LU:()=>he,DN:()=>de});var t=e(65307),n=e(2543),s=e(12131),r=e(34867),o=e(94822),m=e(27677),l=e(25027),i=e(79938),u=e(32415),d=e(82843),p=e(17172);function c(le){return(0,p.AI)().get("/api/annotations",{alertId:le}).then(pe=>pe?.sort(y))}function y(le,pe){const ve=(Me,Ue)=>Me>Ue?-1:Ue>Me?1:0,be=ve(le.timeEnd,pe.timeEnd);if(be)return be;const Oe=ve(le.time,pe.time);return Oe||ve(le.id,pe.id)}var f=e(92240),P=e(68788),a=e(49498),E=e(28220),g=e(99106),h=e(86590),D=e(98164),v=e(57220),C=e(56361),T=e(88467),S=e(18461),O=e(63066),x=e(23662);function b(le){const pe=async Re=>{if((0,x.A4)(Re)){const Fe=await(0,E.iy)(le);for(const[xe,Ve]of Object.entries(Fe))for(const $e of Ve){const Xe=$e.rules.find(gt=>(0,x.lT)(gt)&&gt.grafana_alert?.uid===Re.uid);if(Xe)return{group:$e,ruleSourceName:v.hY,namespace:xe,namespace_uid:(0,x.lT)(Xe)&&Xe.grafana_alert.namespace_uid||void 0,rule:Xe}}}if((0,x.X4)(Re)){const{ruleSourceName:Fe,namespace:xe,groupName:Ve}=Re,$e=await(0,E.HO)(le,xe,Ve);if(!$e)return null;const Xe=$e.rules.find(gt=>{const Dt=S.P1(Fe,xe,$e.name,gt);return S.LC(Dt,Re)});return Xe?{group:$e,ruleSourceName:Fe,namespace:xe,rule:Xe}:null}if((0,x.Mj)(Re))throw new Error("Native prometheus rules can not be edited in grafana.");return null},ve=async Re=>{const{namespace:Fe,group:xe,rule:Ve,namespace_uid:$e}=Re;if(xe.rules.length===1){await(0,E.AJ)(le,$e||Fe,xe.name);return}await(0,E.E8)(le,$e||Fe,{...xe,rules:xe.rules.filter(Xe=>Xe!==Ve)})},be=async(Re,Fe,xe)=>{const{dataSourceName:Ve,group:$e,namespace:Xe}=Re,gt=(0,O.l1)(Re);if(Ve&&$e&&Xe){if(xe){const at=await pe(S.Yd(xe));if(!at)throw new Error("Rule not found.");if(at.namespace!==Xe||at.group.name!==$e)await ve(at);else{const Ae={...at.group,rules:at.group.rules.map(re=>re===at.rule?gt:re),evaluateEvery:Fe};return await(0,E.E8)(le,Xe,Ae),S.P1(Ve,Xe,$e,gt)}}const Dt=await(0,E.HO)(le,Xe,$e),nt=Dt?{...Dt,rules:[...Dt.rules,gt]}:{name:$e,rules:[gt]};return await(0,E.E8)(le,Xe,nt),S.P1(Ve,Xe,$e,gt)}else throw new Error("Data source and location must be specified")},Oe=async(Re,Fe,xe)=>{const{folder:Ve,group:$e}=Re;if(!Ve)throw new Error("Folder must be specified");const Xe=(0,O.Z9)(Re),gt=Ve.uid,Dt={name:$e,interval:Fe};if(!xe)return Me(gt,Dt,Xe);const nt=await pe(S.Yd(xe));if(!nt)throw new Error("Rule not found.");const at=nt.namespace_uid===gt,Ae=nt.group.name===Re.group;return at&&Ae?we(nt,Xe,Fe):Ue(gt,Dt,nt,Xe)},Me=async(Re,Fe,xe)=>{const Ve=await(0,E.HO)(le,Re,Fe.name);if(!Ve)throw new Error(`No group found with name "${Fe.name}"`);const $e={name:Fe.name,interval:Fe.interval,rules:(Ve.rules??[]).concat(xe)};return await(0,E.E8)(le,Re,$e),{uid:xe.grafana_alert.uid??"",ruleSourceName:v.hY}},Ue=async(Re,Fe,xe,Ve)=>(M(xe,Ve),await Me(Re,Fe,Ve)),we=async(Re,Fe,xe)=>{M(Re,Fe);const Ve=Re.group.rules.map($e=>(0,x.lT)($e)&&$e.grafana_alert.uid===Re.rule.grafana_alert.uid?Fe:$e);return await(0,E.E8)(le,Re.namespace_uid??"",{name:Re.group.name,interval:xe,rules:Ve}),{uid:Re.rule.grafana_alert.uid,ruleSourceName:v.hY}};return{findEditableRule:pe,deleteRule:ve,saveLotexRule:be,saveGrafanaRule:Oe}}function M(le,pe){if(!(0,x.lT)(le.rule))throw new Error("The rule is not a Grafana managed rule");const ve=le.rule.grafana_alert.uid;pe.grafana_alert.uid=ve}var A=e(25968);function R(le,pe){const be=le().unifiedAlerting.dataSources[pe]?.result;if(!be)throw new Error(`Data source configuration is not available for "${pe}" data source`);return be}function B(le,pe){const ve=R(le,pe);if(!ve.rulerConfig)throw new Error(`Ruler API is not available for ${pe}`);return ve.rulerConfig}const U=(0,t.zD)("unifiedalerting/fetchPromRules",async({rulesSourceName:le,filter:pe,limitAlerts:ve,matcher:be,state:Oe,identifier:Me},Ue)=>{await Ue.dispatch(V({rulesSourceName:le}));const we=(0,l.U7)("unifiedalerting/fetchPromRules",a.sA,{dataSourceName:le,thunk:"unifiedalerting/fetchPromRules"});return await(0,T.$I)(we(le,pe,ve,be,Oe,Me))}),W=(0,t.zD)("unifiedalerting/fetchRulerRules",async({rulesSourceName:le,filter:pe},{dispatch:ve,getState:be})=>{await ve(V({rulesSourceName:le}));const Oe=B(be,le),Me=(0,l.Ke)("unifiedalerting/fetchRulerRules",E.iy,{dataSourceName:le,thunk:"unifiedalerting/fetchRulerRules"});return await(0,T.$I)(Me(Oe,pe))});function N({rulesSourceName:le,identifier:pe,filter:ve,limitAlerts:be,matcher:Oe,state:Me}){return async(Ue,we)=>{await Ue(V({rulesSourceName:le}));const Re=R(we,le);await Ue(U({rulesSourceName:le,identifier:pe,filter:ve,limitAlerts:be,matcher:Oe,state:Me})),Re.rulerConfig&&await Ue(W({rulesSourceName:le}))}}function w(le){return(pe,ve)=>{const{rulerRules:be}=ve().unifiedAlerting,Oe=be[le];(0,n.isEmpty)(Oe?.result)&&!(Oe&&(0,x.$7)(Oe))&&!Oe?.loading&&pe(W({rulesSourceName:le}))}}function L(){return async le=>{const pe=(0,v.gR)().map(ve=>le(V({rulesSourceName:ve})));await Promise.allSettled(pe)}}const V=(0,t.zD)("unifiedalerting/fetchPromBuildinfo",async({rulesSourceName:le})=>(0,T.$I)((async()=>{if(le===v.hY)return{name:v.hY,id:v.hY,rulerConfig:{dataSourceName:v.hY,apiVersion:"legacy"}};const pe=(0,v.Jz)(le);if(!pe)throw new Error(`Missing data source configuration for ${le}`);const{id:ve,name:be}=pe,Me=await(0,l.QA)("unifiedalerting/fetchPromBuildinfo",f.nD,{dataSourceName:le,thunk:"unifiedalerting/fetchPromBuildinfo"})(be),Ue=Me.features.rulerApiEnabled?{dataSourceName:be,apiVersion:Me.application===o.N1.Cortex?"legacy":"config"}:void 0;return{name:be,id:ve,rulerConfig:Ue}})()),{condition:({rulesSourceName:le},{getState:pe})=>{const ve=pe().unifiedAlerting.dataSources,be=!!ve[le]?.result,Oe=!!ve[le]?.error;return!(be||Oe)}});function K(le=!1,pe={}){return async(ve,be)=>{const Oe=performance.now();await Promise.allSettled((0,v.gR)().map(async Me=>{await ve(V({rulesSourceName:Me}));const{promRules:Ue,rulerRules:we,dataSources:Re}=be().unifiedAlerting,Fe=Re[Me].result;if(!Fe)return;const xe=le||!Ue[Me]?.loading,Ve=(le||!we[Me]?.loading)&&!!Fe.rulerConfig;await Promise.allSettled([xe&&ve(U({rulesSourceName:Me,...pe})),Ve&&ve(W({rulesSourceName:Me}))])})),(0,r.l$)("unifiedalerting/fetchAllPromAndRulerRulesAction",{loadTimeMs:performance.now()-Oe})}}function k(le=!1){return async(pe,ve)=>{const{promRules:be}=ve().unifiedAlerting;(0,v.gR)().map(Oe=>{(le||!be[Oe]?.loading)&&pe(U({rulesSourceName:Oe}))})}}function j(le,pe){return async(ve,be)=>{(0,T.v5)((async()=>{const Oe=(0,v.EV)(le.rulesSource),Me=B(be,Oe);await(0,E.AJ)(Me,le.name,pe.name),await ve(N({rulesSourceName:Oe}))})(),{successMessage:"Group deleted"})}}function H(le,pe={}){return async(ve,be)=>{await ve(V({rulesSourceName:le.ruleSourceName})),(0,T.v5)((async()=>{const Oe=B(be,le.ruleSourceName),Me=b(Oe),Ue=await Me.findEditableRule(le);if(!Ue)throw new Error("Rule not found.");await Me.deleteRule(Ue),await ve(N({rulesSourceName:Ue.ruleSourceName})),pe.navigateTo&&s.Ny.replace(pe.navigateTo)})(),{successMessage:"Rule deleted."})}}const J=(0,t.zD)("unifiedalerting/saveRuleForm",({values:le,existing:pe,redirectOnSave:ve,evaluateEvery:be},Oe)=>(0,T.v5)((0,T.$I)((async()=>{const{type:Me}=le;let Ue;if(Me===h.Z.cloudAlerting||Me===h.Z.cloudRecording){if(!le.dataSourceName)throw new Error("The Data source has not been defined.");const we=B(Oe.getState,le.dataSourceName);Ue=await b(we).saveLotexRule(le,be,pe),await Oe.dispatch(W({rulesSourceName:le.dataSourceName}))}else if(Me===h.Z.grafana){const we=B(Oe.getState,v.hY);Ue=await b(we).saveGrafanaRule(le,be,pe),X(le,pe),Oe.dispatch(i.hK.util.invalidateTags([{type:"GrafanaRulerRule",id:Ue.uid}]))}else throw new Error("Unexpected rule form type");if((0,l.fH)(l.le.successSavingAlertRule,{type:Me,isNew:(!pe).toString()}),ve)s.Ny.push(ve);else{const we=S.$9(Ue);if(!we){s.Ny.push("/alerting/list");return}const Re=`/alerting/${encodeURIComponent(we)}/edit`;s.Ny.getLocation().pathname!==Re&&s.Ny.replace(Re)}})()),{successMessage:pe?`Rule "${le.name}" updated.`:`Rule "${le.name}" saved.`,errorMessage:"Failed to save rule"}));function X(le,pe){if((0,x.lT)(pe?.rule)){const be=!!pe?.rule.grafana_alert?.notification_settings?.receiver,Oe=le.manualRouting,Me=!be&&Oe,Ue=be&&!Oe;Me&&(0,l.Fb)(),Ue&&(0,l.hJ)()}}const se=(0,t.zD)("unifiedalerting/fetchGrafanaNotifiers",()=>(0,T.$I)((0,P.Es)())),ae=(0,t.zD)("unifiedalerting/fetchGrafanaAnnotations",le=>(0,T.$I)(c(le))),ne=(0,t.zD)("unifiedalerting/updateAMConfig",({alertManagerSourceName:le,oldConfig:pe,newConfig:ve,successMessage:be,redirectPath:Oe,redirectSearch:Me},Ue)=>(0,T.v5)((0,T.$I)((async()=>{const we=await Ue.dispatch(d.m.endpoints.getAlertmanagerConfiguration.initiate(le,{forceRefetch:!0})).unwrap(),Re=(0,n.isEmpty)(we.alertmanager_config)&&(0,n.isEmpty)(we.template_files),Fe=JSON.stringify(we)!==JSON.stringify(pe);if(!Re&&Fe)throw new Error("A newer Alertmanager configuration is available. Please reload the page and try again to not overwrite recent changes.");if(await(0,u.vk)(le,(0,D.MZ)(ve)),Ue.dispatch(d.m.util.invalidateTags(["AlertmanagerConfiguration"])),Oe){const xe=new URLSearchParams(Me??"");s.Ny.push((0,C.nL)(Oe,le,xe))}})()),{successMessage:be})),q=(le,pe)=>async ve=>{const be=await ve(alertmanagerApi.endpoints.getAlertmanagerConfiguration.initiate(pe)).unwrap();if(!be)throw new Error(`Config for ${pe} not found`);if(!be.alertmanager_config.receivers?.find(Me=>Me.name===le))throw new Error(`Cannot delete receiver ${le}: not found in config.`);const Oe={...be,alertmanager_config:{...be.alertmanager_config,receivers:be.alertmanager_config.receivers.filter(Me=>Me.name!==le)}};return ve(ne({newConfig:Oe,oldConfig:be,alertManagerSourceName:pe,successMessage:"Contact point deleted."}))},ee=(le,pe)=>async ve=>{const be=await ve(d.m.endpoints.getAlertmanagerConfiguration.initiate(pe)).unwrap();if(!be)throw new Error(`Config for ${pe} not found`);if(typeof be.template_files?.[le]!="string")throw new Error(`Cannot delete template ${le}: not found in config.`);const Oe={...be.template_files};delete Oe[le];const Me={...be,alertmanager_config:{...be.alertmanager_config,templates:be.alertmanager_config.templates?.filter(Ue=>Ue!==le)},template_files:Oe};return ve(ne({newConfig:Me,oldConfig:be,alertManagerSourceName:pe,successMessage:"Template deleted."}))},z=(0,t.zD)("unifiedalerting/fetchFolder",le=>(0,T.$I)(m.IB.getFolderByUid(le,{withAccessControl:!0}))),te=le=>(pe,ve)=>{ve().unifiedAlerting.folders[le]?.dispatched||pe(z(le))},ie=(0,t.zD)("unifiedalerting/fetchAlertGroups",le=>(0,T.$I)((0,u.f4)(le))),ce=(0,t.zD)("unifiedalerting/deleteAlertManagerConfig",async(le,pe)=>(0,T.v5)((0,T.$I)((async()=>{await(0,u.nd)(le),await pe.dispatch(d.m.util.invalidateTags(["AlertmanagerConfiguration"]))})()),{errorMessage:"Failed to reset Alertmanager configuration",successMessage:"Alertmanager configuration reset."})),ue=(le,pe)=>async ve=>{const be=await ve(d.m.endpoints.getAlertmanagerConfiguration.initiate(le)).unwrap(),Oe=le===v.hY,Me=(be?.alertmanager_config?.mute_time_intervals??[])?.filter(({name:Re})=>Re!==pe)??[],Ue=(be?.alertmanager_config?.time_intervals??[])?.filter(({name:Re})=>Re!==pe)??[],we=Oe?{mute_time_intervals:[...Me,...Ue]}:{time_intervals:Ue,mute_time_intervals:Me};if(be){const{mute_time_intervals:Re,...Fe}=be?.alertmanager_config??{};(0,T.v5)(ve(ne({alertManagerSourceName:le,oldConfig:be,newConfig:{...be,alertmanager_config:{...Fe,route:be.alertmanager_config.route?(0,D.Dk)(pe,be.alertmanager_config?.route):void 0,...we}}})),{successMessage:`Deleted "${pe}" from Alertmanager configuration`,errorMessage:"Failed to delete mute timing"})}},fe=(0,t.zD)("unifiedalerting/testReceivers",({alertManagerSourceName:le,receivers:pe,alert:ve})=>(0,T.v5)((0,T.$I)((0,u.By)(le,pe,ve)),{errorMessage:"Failed to send test alert.",successMessage:"Test alert sent."})),Te=(le,pe)=>le.filter(ve=>{const{forDuration:be}=(0,x.jg)(ve,pe),Oe=(0,A.P8)(be),Me=(0,A.P8)(pe);return Oe!==0&&Oe<Me}),he=(0,t.zD)("unifiedalerting/updateLotexNamespaceAndGroup",async(le,pe)=>(0,T.v5)((0,T.$I)((async()=>{const{rulesSourceName:ve,namespaceName:be,groupName:Oe,newNamespaceName:Me,newGroupName:Ue,groupInterval:we,folderUid:Re}=le,Fe=B(pe.getState,ve),xe=await(0,E.iy)(Fe);if(!!!xe[be])throw new Error(`Namespace "${be}" not found.`);const $e=xe[be].find(at=>at.name===Oe);if(!$e)throw new Error(`Group "${Oe}" not found.`);const Xe=!!xe[be].find(at=>at.name===Ue);if(Ue!==Oe&&Xe)throw new Error(`Group "${Ue}" already exists in namespace "${be}".`);const gt=!!xe[Me],nt=ve===v.hY?(0,g.wf)(be):be;if(Me!==nt&&gt)throw new Error(`Namespace "${Me}" already exists.`);if(Me===nt&&Oe===Ue&&we===$e.interval)throw new Error("Nothing changed.");if(we!==$e.interval){const at=Te($e.rules,we??"1m");if(at.length>0)throw new Error(`These alerts belonging to this group will have an invalid 'For' value: ${at.map(Ae=>{const{alertName:re}=(0,x.jg)(Ae,we??"");return re}).join(",")}`)}if(Me!==nt){for(const at of xe[be])await(0,E.E8)(Fe,Me,at.name===Oe?{...at,name:Ue,interval:we}:at);await(0,E.BK)(Fe,Re||be)}else await(0,E.E8)(Fe,Re||be,{...$e,name:Ue,interval:we}),Ue!==Oe&&await(0,E.AJ)(Fe,Re||be,Oe);await pe.dispatch(W({rulesSourceName:ve}))})()),{errorMessage:"Failed to update namespace / group",successMessage:"Update successful"})),de=(0,t.zD)("unifiedalerting/updateRulesOrderForGroup",async(le,pe)=>(0,T.v5)((0,T.$I)((async()=>{const{rulesSourceName:ve,namespaceName:be,groupName:Oe,newRules:Me,folderUid:Ue}=le,we=B(pe.getState,ve),Fe=(await(0,E.iy)(we))[be].find(Ve=>Ve.name===Oe);if(!Fe)throw new Error(`Group "${Oe}" not found.`);if(Fe.rules.length!==Me.length){const Ve=new Error("Rules count mismatch. Please refresh the page and try again.");throw(0,l.vV)(Ve,{namespaceName:be,groupName:Oe}),Ve}const xe={name:Fe.name,interval:Fe.interval,rules:Me};await(0,E.E8)(we,Ue??be,xe),await pe.dispatch(W({rulesSourceName:ve}))})()),{errorMessage:"Failed to update namespace / group",successMessage:"Update successful"}))},22620:(G,I,e)=>{"use strict";e.d(I,{H:()=>n});var t=e(32196);const n=s=>(0,t.css)({float:"none",display:"flex",justifyContent:"flex-start",margin:s.spacing(2,0)})},99494:(G,I,e)=>{"use strict";e.d(I,{W:()=>t});var t=(n=>(n.Incident="grafana-incident-app",n.OnCall="grafana-oncall-app",n.MachineLearning="grafana-ml-app",n.Labels="grafana-labels-app",n))(t||{})},86590:(G,I,e)=>{"use strict";e.d(I,{Z:()=>t});var t=(n=>(n.grafana="grafana",n.cloudAlerting="cloud-alerting",n.cloudRecording="cloud-recording",n))(t||{})},41068:(G,I,e)=>{"use strict";e.d(I,{y:()=>t});var t=(n=>(n.seconds="s",n.minutes="m",n.hours="h",n.days="d",n.weeks="w",n))(t||{})},75471:(G,I,e)=>{"use strict";e.d(I,{C0:()=>f,HL:()=>m,Q9:()=>P,VQ:()=>l,Wd:()=>y,jy:()=>p,lV:()=>c,nU:()=>i,q0:()=>a});var t=e(2913),n=e(16233),s=e(31678),r=e(57220);function o(E){return(0,r.z2)(E)?"grafana":"external"}const m={read:{grafana:s.AccessControlAction.AlertingInstanceRead,external:s.AccessControlAction.AlertingInstancesExternalRead},create:{grafana:s.AccessControlAction.AlertingInstanceCreate,external:s.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:s.AccessControlAction.AlertingInstanceUpdate,external:s.AccessControlAction.AlertingInstancesExternalWrite},delete:{grafana:s.AccessControlAction.AlertingInstanceUpdate,external:s.AccessControlAction.AlertingInstancesExternalWrite}},l={read:{grafana:s.AccessControlAction.AlertingNotificationsRead,external:s.AccessControlAction.AlertingNotificationsExternalRead},create:{grafana:s.AccessControlAction.AlertingNotificationsWrite,external:s.AccessControlAction.AlertingNotificationsExternalWrite},update:{grafana:s.AccessControlAction.AlertingNotificationsWrite,external:s.AccessControlAction.AlertingNotificationsExternalWrite},delete:{grafana:s.AccessControlAction.AlertingNotificationsWrite,external:s.AccessControlAction.AlertingNotificationsExternalWrite}},i={read:{grafana:s.AccessControlAction.AlertingSilenceRead,external:s.AccessControlAction.AlertingInstanceRead},create:{grafana:s.AccessControlAction.AlertingSilenceCreate,external:s.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:s.AccessControlAction.AlertingSilenceUpdate,external:s.AccessControlAction.AlertingInstancesExternalWrite}},u={read:s.AccessControlAction.AlertingProvisioningRead,readSecrets:s.AccessControlAction.AlertingProvisioningReadSecrets,write:s.AccessControlAction.AlertingProvisioningWrite},d={read:{grafana:s.AccessControlAction.AlertingRuleRead,external:s.AccessControlAction.AlertingRuleExternalRead},create:{grafana:s.AccessControlAction.AlertingRuleCreate,external:s.AccessControlAction.AlertingRuleExternalWrite},update:{grafana:s.AccessControlAction.AlertingRuleUpdate,external:s.AccessControlAction.AlertingRuleExternalWrite},delete:{grafana:s.AccessControlAction.AlertingRuleDelete,external:s.AccessControlAction.AlertingRuleExternalWrite}};function p(E){const g=o(E);return{read:m.read[g],create:m.create[g],update:m.update[g],delete:m.delete[g]}}function c(E){const g=o(E);return{read:l.read[g],create:l.create[g],update:l.update[g],delete:l.delete[g],provisioning:u}}function y(E){const g=o(E);return{read:d.read[g],create:d.create[g],update:d.update[g],delete:d.delete[g]}}function f(E){return()=>n.TP.evaluatePermission(E)}function P(){return{canCreateGrafanaRules:n.TP.hasPermission(s.AccessControlAction.FoldersRead)&&n.TP.hasPermission(d.create.grafana),canCreateCloudRules:n.TP.hasPermission(s.AccessControlAction.DataSourcesRead)&&n.TP.hasPermission(d.create.external),canEditRules:E=>n.TP.hasPermission(y(E).update)}}function a(){const{unifiedAlertingEnabled:E}=(0,t.zj)(),g=n.TP.hasPermission(y(r.hY).read),h=n.TP.hasPermission(y(r.hY).update);return E&&g&&h}},98164:(G,I,e)=>{"use strict";e.d(I,{$P:()=>A,Av:()=>D,Dk:()=>i,Dm:()=>x,EU:()=>v,J$:()=>g,LF:()=>O,Lt:()=>u,MN:()=>p,MU:()=>y,MZ:()=>l,NL:()=>E,UL:()=>M,VE:()=>C,Wc:()=>f,mP:()=>R,uH:()=>b,xH:()=>a});var t=e(2543),n=e.n(t),s=e(60021),r=e(82775),o=e(57220),m=e(32642);function l(B){return B.alertmanager_config.receivers||(B.alertmanager_config.receivers=[{name:"default "}]),B.alertmanager_config.route||(B.alertmanager_config.route={receiver:B.alertmanager_config.receivers[0].name}),B.template_files||(B.template_files={}),B}function i(B,U){return{...U,mute_time_intervals:U.mute_time_intervals?.filter(N=>N!==B)??[],routes:U.routes?.map(N=>i(B,N))}}function u(B,U,W){return{...W,mute_time_intervals:W.mute_time_intervals?.map(N=>N===U?B:N),routes:W.routes?.map(N=>u(B,U,N))}}function d(B){return B.map(([U,W,N])=>[U,W,unquoteWithUnescape(N)])}function p(B){return B.isEqual?B.isRegex?s.ho.regex:s.ho.equal:B.isRegex?s.ho.notRegex:s.ho.notEqual}function c(B){switch(B){case s.ho.equal:return{isEqual:!0,isRegex:!1};case s.ho.notEqual:return{isEqual:!1,isRegex:!1};case s.ho.regex:return{isEqual:!0,isRegex:!0};case s.ho.notRegex:return{isEqual:!1,isRegex:!0}}}function y(B){return{name:B.name,value:B.value,operator:p(B)}}function f(B){return{name:B.name,value:B.value,...c(B.operator)}}function P(B){return`{${B.map(y).reduce((N,w)=>{const L=`${w.name}${w.operator}"${w.value}"`;return N?`${N},${L}`:L},"")}}`}const a=[{label:s.ho.equal,description:"Equals",value:s.ho.equal},{label:s.ho.notEqual,description:"Does not equal",value:s.ho.notEqual},{label:s.ho.regex,description:"Matches regex",value:s.ho.regex},{label:s.ho.notRegex,description:"Does not match regex",value:s.ho.notRegex}];function E(B){const U=p(B);return[B.name,U,B.value]}function g(B){const U=/\b([\w.-]+)(=~|!=|!~|=(?="?\w))"?([^"\n,}]*)"?/g,W=[];return B.replace(U,(N,w,L,V)=>{const K=L===s.ho.equal||L===s.ho.regex,k=L===s.ho.regex||L===s.ho.notRegex;return W.push({name:w,value:k?h(V.trim()):V.trim(),isEqual:K,isRegex:k}),""}),W}function h(B){try{return new RegExp(B),B}catch{return""}}function D(B,U){return U.every(({name:W,value:N,isRegex:w,isEqual:L})=>Object.entries(B).some(([V,K])=>{const k=W===V;let j;return L&&!w&&(j=N===K),!L&&!w&&(j=N!==K),L&&w&&(j=new RegExp(N).test(K)),!L&&w&&(j=!new RegExp(N).test(K)),k&&j}))}function v(...B){const U=B.map(g).flat(),W=(0,t.uniqWith)(U,t.isEqual);return P(W)}function C(B){return B===o.hY?"default":"unquote"}function T(){return getAllDataSources().filter(B=>B.type===DataSourceType.Alertmanager)}function S(B){return T().find(U=>B===U.uid)}function O(B){const{times:U,weekdays:W,days_of_month:N,months:w,years:L,location:V}=B,K=x(U,V),k=b(W),j=M(N),H=A(w),J=R(L);return[K,k,j,H,J].join(", ")}function x(B,U){return"Times: "+(B?B?.map(({start_time:W,end_time:N})=>`${W} - ${N} [${U??"UTC"}]`).join(" and "):"All")}function b(B){return"Weekdays: "+(B?.map(U=>{if(U.includes(":"))return U.split(":").map(W=>{const N=W.slice(0,3);return N[0].toLocaleUpperCase()+N.slice(1)}).join("-");{const W=U.slice(0,3);return W[0].toLocaleUpperCase()+W.slice(1)}}).join(", ")??"All")}function M(B){return"Days of the month: "+(B?.join(", ")??"All")}function A(B){return"Months: "+(B?.join(", ")??"All")}function R(B){return"Years: "+(B?.join(", ")??"All")}},33225:(G,I,e)=>{"use strict";e.d(I,{Hx:()=>o,gO:()=>m});var t=e(96540),n=e(55740),s=e(56361);function r(l){return{dashboardUID:l.find(([i])=>i===n.YH.dashboardUID)?.[1],panelId:l.find(([i])=>i===n.YH.panelID)?.[1]}}function o(l){return(0,t.useMemo)(()=>Object.entries(l||{}).filter(([i,u])=>!!u.trim()),[l])}function m(l){const i=new Map,{panelId:u,dashboardUID:d}=r(l);return d&&i.set(n.YH.dashboardUID,(0,s.JM)(d)),d&&u&&i.set(n.YH.panelID,(0,s.D2)(d,u)),i}},82775:(G,I,e)=>{"use strict";e.d(I,{k:()=>s,q:()=>r});var t=e(32264),n=e(25968);function s(){return Object.values(t.$.datasources)}function r(o){if(!(0,n.TN)(t.$.unifiedAlerting.minInterval))return{globalLimit:0,exceedsLimit:!1};const m=(0,n.P8)(t.$.unifiedAlerting.minInterval);if(!o||!(0,n.TN)(o))return{globalLimit:m,exceedsLimit:!1};const l=(0,n.P8)(o),i=m>l&&l>0;return{globalLimit:m,exceedsLimit:i}}},55740:(G,I,e)=>{"use strict";e.d(I,{DD:()=>s,H8:()=>y,HH:()=>n,J3:()=>c,Oq:()=>r,U3:()=>m,UU:()=>t,YH:()=>p,cB:()=>l,kW:()=>P,kl:()=>f,wG:()=>o});const t="ruler not supported",n=2e4,s="alertmanager",r="alerting-alertmanager",o=2e4,m=2e4,l=2e4,i="timeseries",u="table",d="stat";var p=(a=>(a.description="description",a.summary="summary",a.runbookURL="runbook_url",a.alertId="__alertId__",a.dashboardUID="__dashboardUid__",a.panelID="__panelId__",a))(p||{});const c={description:"Description",summary:"Summary",runbook_url:"Runbook URL",__dashboardUid__:"Dashboard UID",__panelId__:"Panel ID",__alertId__:"Alert ID"},y={description:"Description of what the alert rule does.",summary:"Short summary of what happened and why.",runbook_url:"Webpage where you keep your runbook for the alert.",__dashboardUid__:"",__panelId__:"",__alertId__:""},f=[{key:"summary",value:""},{key:"description",value:""},{key:"runbook_url",value:""}],P="__alert_rule_uid__"},57220:(G,I,e)=>{"use strict";e.d(I,{AL:()=>W,EV:()=>R,Eb:()=>U,Jz:()=>E,Vr:()=>se,Zw:()=>K,bD:()=>D,cy:()=>O,gR:()=>M,hP:()=>X,hY:()=>p,iV:()=>C,k5:()=>H,lS:()=>A,oh:()=>L,ol:()=>y,qi:()=>P,r3:()=>V,sq:()=>x,v0:()=>B,v8:()=>a,vv:()=>c,w5:()=>j,y9:()=>J,yc:()=>N,z2:()=>w});var t=e(19347),n=e(16233),s=e(60021),r=e(31678),o=e(94822),m=e(82843),l=e(62190),i=e(70383),u=e(75471),d=e(82775);const p="grafana",c="-- Grafana --";var y=(ae=>(ae.Alertmanager="alertmanager",ae.Loki="loki",ae.Prometheus="prometheus",ae))(y||{});const f=["loki","prometheus"];function P(){return n.TP.hasPermission(r.AccessControlAction.AlertingRuleExternalRead)?(0,d.k)().filter(ae=>f.includes(ae.type)&&ae.jsonData.manageAlerts!==!1).sort((ae,ne)=>ae.name.localeCompare(ne.name)):[]}function a(ae){return w(ae)?"grafana":ae.uid??ae.id}function E(ae){return P().find(ne=>ne.name===ae)}function g(){return(0,d.k)().filter(h).sort((ae,ne)=>ae.name.localeCompare(ne.name))}function h(ae){return ae.type==="alertmanager"}function D(ae){return ae.type==="alertmanager"}function v(){return g().filter(ae=>ae.jsonData.handleGrafanaManagedAlerts)}function C(ae){return ae.jsonData.handleGrafanaManagedAlerts===!0}const T={name:p,imgUrl:"public/img/grafana_icon.svg",hasConfigurationAPI:!0};function S(){return[T,...g().map(ae=>({name:ae.name,displayName:ae.name,imgUrl:ae.meta.info.logos.small,meta:ae.meta}))]}function O(ae){const ne=(0,l.W)(ae),q=ne.availableExternalDataSources.filter(ie=>ie.handleGrafanaManagedAlerts),ee=ne.availableInternalDataSources,{currentData:z}=m.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery();switch(z?.alertmanagersChoice){case s.nA.Internal:return ee;case s.nA.External:return q;default:return[...ee,...q]}}function x(ae){const ne=[],q=[],ee={instance:u.HL.read,notification:u.VQ.read,silence:u.nU.read};if(Object.values(ee).flatMap(ie=>ie.grafana).some(ie=>n.TP.hasPermission(ie))&&ne.push(T),n.TP.hasPermission(ee[ae].external)){const ie=g().map(ce=>({name:ce.name,displayName:ce.name,imgUrl:ce.meta.info.logos.small,meta:ce.meta,hasConfigurationAPI:(0,i.Kh)(ce.jsonData),handleGrafanaManagedAlerts:ce.jsonData.handleGrafanaManagedAlerts}));q.push(...ie)}return{availableInternalDataSources:ne,availableExternalDataSources:q}}function b(ae){const ne=L(ae);if(!ne)throw new Error(`Data source ${ae} not found`);if(ne.type!=="loki"&&ne.type!=="prometheus")throw new Error(`Unexpected data source type ${ne.type}`);return ne}function M(){const ae=P().map(ne=>ne.name);return n.TP.hasPermission(r.AccessControlAction.AlertingRuleRead)&&ae.push(p),ae}function A(){const ae=P();return n.TP.hasPermission(r.AccessControlAction.AlertingRuleRead)&&ae.push(p),ae}function R(ae){return U(ae)?ae.name:ae}function B(ae){return U(ae)?ae.uid:p}function U(ae){return ae!==p}function W(ae){return ae!==p&&V(ae)?.jsonData?.implementation===s.Oz.prometheus}function N(ae){return ae.readOnly===!0}function w(ae){return ae===p}function L(ae){return(0,d.k)().find(ne=>ne.name===ae)}function V(ae){return(0,d.k)().filter(h).find(ne=>ne.name===ae)}function K(ae){return ae===p?p:L(ae)}function k(ae){if(ae===p)return p;const ne=L(ae);if(!ne)throw new Error(`Datasource "${ae}" not found`);return String(ne.id)}function j(ae){if(ae===p)return p;const ne=L(ae);if(!ne)throw new Error(`Datasource "${ae}" not found`);return ne.uid}function H(){return(0,t.l)().getList({alerting:!0})[0]}function J(){const ae=(0,t.l)().getInstanceSettings("default");return ae?.meta.alerting??!1?ae:H()}function X(ae){return ae.jsonData.manageAlerts!==!1}function se(ae){return w(ae)?"grafana":"prometheusType"in ae.jsonData?ae.jsonData?.prometheusType??o.N1.Prometheus:ae.type==="loki"?"loki":o.N1.Prometheus}},75214:(G,I,e)=>{"use strict";e.d(I,{Dd:()=>n,F2:()=>l,M4:()=>t,lL:()=>o,rm:()=>m,w0:()=>i,x4:()=>r,zm:()=>s});function t(u){return Object.entries(u).map(([d,p])=>`${d}=${p}`).sort()}function n(u){return Object.entries(u).map(([d,p])=>[d,p])}function s(u){const d={};return u.forEach(p=>{d[p[0]]=p[1]}),d}function r(u){const d={};return u.forEach(p=>{p.key&&(d[p.key]=p.value)}),d}const o="__grafana_origin";function m(u){return Object.keys(u).filter(d=>!l(d)).length}function l(u){return u.startsWith("__")&&u.endsWith("__")||u===o}const i=([u,d])=>l(u)},32642:(G,I,e)=>{"use strict";e.d(I,{Ig:()=>y,J$:()=>p,J9:()=>d,So:()=>l,ot:()=>c,ou:()=>u,qR:()=>m,t8:()=>f});var t=e(2543),n=e.n(t),s=e(60021),r=e(75214);const o=[s.ho.regex,s.ho.notRegex,s.ho.notEqual,s.ho.equal];function m(g){if(g.startsWith("{")&&g.endsWith("}"))throw new Error("this function does not support PromQL-style matcher syntax, call parsePromQLStyleMatcher() instead");const h=o.map(S=>[S,g.indexOf(S)]).filter(([S,O])=>O>-1).sort((S,O)=>S[1]-O[1]);if(!h.length)throw new Error(`Invalid matcher: ${g}`);const[D,v]=h[0],C=g.slice(0,v).trim(),T=g.slice(v+D.length);if(!C)throw new Error(`Invalid matcher: ${g}`);return{name:C,value:T,isRegex:D===s.ho.regex||D===s.ho.notRegex,isEqual:D===s.ho.equal||D===s.ho.regex}}function l(g){return P(g)?i(g):[m(g)]}function i(g){if(!P(g))throw new Error("not a PromQL style matcher");const h=/,(?=(?:[^"]*"[^"]*")*[^"]*$)/,D=g.replace(/^\{/,"").replace(/\}$/,"").trim().split(h);return(0,t.compact)(D).flatMap(m).map(v=>({...v,name:y(v.name),value:y(v.value)}))}function u(g){const h=g.filter(D=>!!D.trim()).map(D=>m(D));return(0,t.uniqBy)(h,D=>D.name)}const d=g=>{const h=Object.entries(g).filter(([v])=>!(0,r.F2)(v)),D=new URLSearchParams;return h.forEach(([v,C])=>D.append("matcher",`${v}=${C}`)),D},p=g=>{let h=[];return g.matchers&&g.matchers.forEach(D=>{const v=l(D).map(a);h=h.concat(v)}),g.object_matchers&&h.push(...g.object_matchers),g.match_re&&Object.entries(g.match_re).forEach(([D,v])=>{h.push([D,s.ho.regex,v])}),g.match&&Object.entries(g.match).forEach(([D,v])=>{h.push([D,s.ho.equal,v])}),h};function c(g){return`"${g.replace(/[\\"]/g,D=>`\\${D}`)}"`}function y(g){return/^"(.*)"$/.test(g)?g.replace(/^"(.*)"$/,"$1").replace(/\\"/g,'"').replace(/\\\\/g,"\\"):g}const f={default:([g,h,D])=>`${g} ${h} ${D||""}`,unquote:([g,h,D])=>{const v=y(g),C=y(D)||'""';return`${v} ${h} ${C}`}};function P(g){return g.startsWith("{")&&g.endsWith("}")}function a(g){const h=E(g);return[g.name,h,g.value]}function E(g){return g.isEqual?g.isRegex?s.ho.regex:s.ho.equal:g.isRegex?s.ho.notRegex:s.ho.notEqual}},56361:(G,I,e)=>{"use strict";e.d(I,{BK:()=>M,Cp:()=>V,D2:()=>N,ES:()=>j,GD:()=>A,Ht:()=>v,JM:()=>W,JZ:()=>J,KT:()=>S,NH:()=>R,S2:()=>h,Sl:()=>D,Y9:()=>b,Yp:()=>a,bg:()=>E,c$:()=>B,i7:()=>g,i9:()=>w,nL:()=>O,qN:()=>U,qc:()=>k,qy:()=>T,u7:()=>H,w$:()=>P,y$:()=>K});var t=e(2543),n=e.n(t),s=e(61268),r=e(32264),o=e(17172),m=e(16233),l=e(18461),i=e(23662),u=e(64861),d=e(94822),p=e(55740),c=e(57220),y=e(32642),f=e(3704);function P(X,se,ae){const ne=(0,c.EV)(X),q=l.UP(ne,se),ee=encodeURIComponent(l.$9(q)),z=encodeURIComponent(ne);return(0,f.c)(`/alerting/${z}/${ee}/view`,ae?{returnTo:ae}:{})}function a(X,se){const{uid:ae,type:ne}=X;return(0,f.c)("/explore",{left:JSON.stringify({datasource:X.uid,queries:[{refId:"A",datasource:{uid:ae,type:ne},expr:se}],range:{from:"now-1h",to:"now"}})})}function E(X,se=""){return(0,f.c)(`/alerting/notifications/receivers/${encodeURIComponent(X)}/edit`,{alertmanager:se})}function g(X,se=""){return(0,f.c)("/alerting/routes/mute-timing/edit",{muteName:X,alertmanager:se})}function h(X,se){if((0,c.Eb)(X))return(0,f.z)(`/alerting/${encodeURIComponent(X.name)}/${encodeURIComponent((0,l.PH)(se.name))}/find`);if((0,i.lT)(se.rulerRule))return(0,f.z)(`/alerting/grafana/${se.rulerRule.grafana_alert.uid}/view`)}function D(X){return X.reduce((se,{key:ae,value:ne})=>(se[ae]=ne,se),{})}const v=X=>{const se=X.queryString===void 0?void 0:String(X.queryString),ae=X.alertState===void 0?void 0:String(X.alertState),ne=X.dataSource===void 0?void 0:String(X.dataSource),q=X.ruleType===void 0?void 0:String(X.ruleType),ee=X.groupBy===void 0?void 0:String(X.groupBy).split(",");return{queryString:se,alertState:ae,dataSource:ne,groupBy:ee,ruleType:q}},C=X=>({queryString:X.get("queryString")??void 0,contactPoint:X.get("contactPoint")??void 0}),T=X=>{const se=X.queryString===void 0?void 0:String(X.queryString),ae=X.silenceState===void 0?void 0:String(X.silenceState);return{queryString:se,silenceState:ae}};function S(X){return Object.entries(X).map(([se,ae])=>({key:se,value:ae}))}function O(X,se,ae){const ne=new URLSearchParams(ae);return se&&ne.set(p.DD,se),`${X}?${ne.toString()}`}const x=X=>X.replace(/\"/g,'\\"');function b(X){return X.startsWith('"')&&X.endsWith('"')?x(X):`"${x(X)}"`}function M(X,se){const ae=new URLSearchParams;return ae.append("alertmanager",X),(0,y.J9)(se).forEach((q,ee)=>ae.append(ee,q)),(0,f.c)("/alerting/silence/new",ae)}function A(X){return(0,f.c)(`/datasources/edit/${X}`)}function R(X){return(0,f.c)(`/dashboards/f/${X}`)}function B(X,se){return(0,f.c)(`/dashboards/f/${X}/${se}/alerting`)}function U(X){return(0,f.c)(`/dashboards/f/${X}/settings`)}function W(X){return(0,f.c)(`/d/${encodeURIComponent(X)}`)}function N(X,se){const ae=new URLSearchParams({viewPanel:se});return(0,f.c)(`/d/${encodeURIComponent(X)}`,ae)}function w(X,se,ae,ne=1e3){const q=new Date().getTime(),ee=()=>X().catch(z=>{if(se(z)&&new Date().getTime()-q<ae)return new Promise(te=>setTimeout(te,ne)).then(ee);throw z});return ee()}const L={[d.Gi.Alerting]:1,[d.cF.Firing]:1,[d.Gi.Error]:1,[d.Gi.Pending]:2,[d.cF.Pending]:2,[d.cF.Inactive]:2,[d.Gi.NoData]:3,[d.Gi.Normal]:4};function V(X,se){if(X===u.xB.Importance)return(0,t.sortBy)(se,ne=>[L[(0,d.lh)(ne.state)],(0,i.RI)(ne).toLocaleLowerCase()]);if(X===u.xB.TimeAsc)return(0,t.sortBy)(se,ne=>[new Date(ne.activeAt)||new Date,(0,i.RI)(ne).toLocaleLowerCase()]);if(X===u.xB.TimeDesc)return(0,t.sortBy)(se,ne=>[new Date(ne.activeAt)||new Date,(0,i.RI)(ne).toLocaleLowerCase()]).reverse();const ae=(0,t.sortBy)(se,ne=>(0,i.RI)(ne).toLocaleLowerCase());return X===u.xB.AlphaDesc&&ae.reverse(),ae}function K(){return r.$.buildInfo.edition===s.r.OpenSource}function k(){return m.TP.hasRole("Admin")||m.TP.isGrafanaAdmin}function j(){return r.$.buildInfo.env==="development"}function H(X){return!!(X&&typeof X=="object"&&"message"in X)}function J(X){return(0,o.NF)(X)?X.message?X.message:"message"in X.data&&typeof X.data.message=="string"?X.data.message:X.statusText?X.statusText:String(X.status)||"Unknown error":H(X)?X.message:String(X)}},88467:(G,I,e)=>{"use strict";e.d(I,{$I:()=>p,BU:()=>v,CZ:()=>f,J7:()=>u,ML:()=>C,Vf:()=>h,Xw:()=>d,jA:()=>l,p0:()=>P,t4:()=>D,v5:()=>c});var t=e(65307),n=e(26272),s=e(17172),r=e(10096),o=e(25027),m=e(56361);const l=Object.freeze({loading:!1,result:void 0,error:void 0,dispatched:!1});function i(T,S=l,O){if(T.pending.match(O))return{result:S.result,loading:!0,error:S.error,dispatched:!0,requestId:O.meta.requestId};if(T.fulfilled.match(O)){if(S.requestId===void 0||S.requestId===O.meta.requestId)return{...S,result:O.payload,loading:!1,error:void 0}}else if(T.rejected.match(O)&&S.requestId===O.meta.requestId)return{...S,loading:!1,error:O.error};return S}function u(T,S){return(0,t.Z0)({name:T,initialState:l,reducers:{},extraReducers:O=>O.addDefaultCase((x,b)=>i(S,x,b))})}function d(T,S,O){return(0,t.Z0)({name:T,initialState:{},reducers:{},extraReducers:x=>x.addDefaultCase((b,M)=>{if((0,t.$S)(S)(M)){const A=M,R=O(A.meta.arg);return{...b,[R]:i(S,b[R],A)}}return b})})}function p(T){return T.catch(S=>{throw{message:f(S),code:S.statusCode}})}function c(T,S){return T.then(O=>(S.successMessage&&r.lE.emit(n.r1.alertSuccess,[S.successMessage]),O)).catch(O=>{const x=f(O);throw r.lE.emit(n.r1.alertError,[`${S.errorMessage??"Error"}: ${x}`]),O})}const y="Unknown Error";function f(T){if((0,s.NF)(T))if(T.data?.message){let S=T.data?.message;return typeof T.data?.error=="string"&&(S+=`; ${T.data.error}`),S}else{if(Array.isArray(T.data)&&T.data.length&&T.data[0]?.message)return T.data.map(S=>S?.message).filter(S=>!!S).join(" ");if(T.statusText)return T.statusText}return(0,m.u7)(T)?T.message:((0,o.fH)(o.le.unknownMessageFromError,{error:JSON.stringify(T)}),y)}function P(T){return Object.values(T).every(a)}function a(T){return T.dispatched&&!T.loading}function E(T){return Object.values(T).every(g)}function g(T){return T.dispatched&&!T.loading&&!T.error}function h(T){return Object.values(T).some(C)}function D(T){return Object.values(T).some(S=>S.dispatched)}function v(T){return Object.values(T).some(g)}function C(T){return T?T.dispatched&&T.loading:!1}},63066:(G,I,e)=>{"use strict";e.d(I,{Bu:()=>ne,IJ:()=>x,J6:()=>J,JE:()=>R,Q8:()=>v,QX:()=>N,Qk:()=>w,Rk:()=>q,T6:()=>O,XI:()=>L,Z9:()=>U,ir:()=>ee,l1:()=>M,mp:()=>H,qO:()=>V});var t=e(2543),n=e.n(t),s=e(43127),r=e(65879),o=e(77789),m=e(32264),l=e(19347),i=e(26657),u=e(16401),d=e(74730),p=e(66718),c=e(94822),y=e(55907),f=e(86590),P=e(75471),a=e(55740),E=e(57220),g=e(56361),h=e(23662),D=e(25968);const v="grafana.alerting.manualRouting",C=(0,D.P8)(m.$.unifiedAlerting?.minInterval??"10s"),T=(0,D.P8)("1m"),O=(0,D.an)((0,t.clamp)(C,T,1/0)),x=()=>{const{canCreateGrafanaRules:z,canCreateCloudRules:te}=(0,P.Q9)();return Object.freeze({name:"",uid:"",labels:[{key:"",value:""}],annotations:a.kl,dataSourceName:null,type:z?f.Z.grafana:te?f.Z.cloudAlerting:void 0,group:"",folder:null,queries:[],recordingRulesQueries:[],condition:"",noDataState:c.Q8.NoData,execErrState:c.Q8.Error,evaluateFor:O,evaluateEvery:O,manualRouting:b(),contactPoints:{},overrideGrouping:!1,overrideTimings:!1,muteTimeIntervals:[],namespace:"",expression:"",forTime:1,forTimeUnit:"m"})},b=()=>m.$.featureToggles.alertingSimplifiedRouting??!1?localStorage.getItem(v)!=="false":!1;function M(z){const{name:te,expression:ie,forTime:ce,forTimeUnit:ue,keepFiringForTime:fe,keepFiringForTimeUnit:Te,type:he}=z;if(he===f.Z.cloudAlerting){let de;return fe&&Te&&(de=`${fe}${Te}`),{alert:te,for:`${ce}${ue}`,keep_firing_for:de,annotations:(0,g.Sl)(z.annotations||[]),labels:(0,g.Sl)(z.labels||[]),expr:ie}}else if(he===f.Z.cloudRecording)return{record:te,labels:(0,g.Sl)(z.labels||[]),expr:ie};throw new Error(`unexpected rule type: ${he}`)}function A(z,te){const ie=[...(0,g.KT)(z||{})];return te&&ie.push({key:"",value:""}),ie}function R(z){const te=[...z];return a.kl.map(ce=>ce.key).forEach((ce,ue)=>{const fe=te.findIndex(Te=>Te.key===ce);if(fe===-1){const Te={key:ce,value:""};te.splice(ue,0,Te)}else fe!==ue&&te.splice(ue,0,te.splice(fe,1)[0])}),te}function B(z,te){if(te?.grafana?.selectedContactPoint&&z)return{receiver:te?.grafana?.selectedContactPoint,mute_time_intervals:te?.grafana?.muteTimeIntervals,group_by:te?.grafana?.overrideGrouping?te?.grafana?.groupBy:void 0,group_wait:te?.grafana?.overrideTimings&&te?.grafana?.groupWaitValue?te?.grafana?.groupWaitValue:void 0,group_interval:te?.grafana?.overrideTimings&&te?.grafana?.groupIntervalValue?te?.grafana?.groupIntervalValue:void 0,repeat_interval:te?.grafana?.overrideTimings&&te?.grafana?.repeatIntervalValue?te?.grafana?.repeatIntervalValue:void 0}}function U(z){const{name:te,condition:ie,noDataState:ce,execErrState:ue,evaluateFor:fe,queries:Te,isPaused:he,contactPoints:de,manualRouting:le}=z;if(ie){const pe=B(le,de);return{grafana_alert:{title:te,condition:ie,no_data_state:ce,exec_err_state:ue,data:Te.map(se),is_paused:!!he,notification_settings:pe},for:fe,annotations:(0,g.Sl)(z.annotations||[]),labels:(0,g.Sl)(z.labels||[])}}throw new Error("Cannot create rule without specifying alert condition")}function W(z){const te=z.notification_settings?{selectedContactPoint:z.notification_settings.receiver,muteTimeIntervals:z.notification_settings.mute_time_intervals??[],overrideGrouping:Array.isArray(z.notification_settings.group_by)&&z.notification_settings.group_by.length>0,overrideTimings:[z.notification_settings.group_wait,z.notification_settings.group_interval,z.notification_settings.repeat_interval].some(Boolean),groupBy:z.notification_settings.group_by||[],groupWaitValue:z.notification_settings.group_wait||"",groupIntervalValue:z.notification_settings.group_interval||"",repeatIntervalValue:z.notification_settings.repeat_interval||""}:void 0;return te?{[E.hY]:te}:void 0}function N(z){const{ruleSourceName:te,namespace:ie,group:ce,rule:ue}=z,fe=x();if((0,E.z2)(te))if((0,h.lT)(ue)){const Te=ue.grafana_alert,he=W(Te);return{...fe,name:Te.title,type:f.Z.grafana,group:ce.name,evaluateEvery:ce.interval||fe.evaluateEvery,evaluateFor:ue.for||"0",noDataState:Te.no_data_state,execErrState:Te.exec_err_state,queries:Te.data,condition:Te.condition,annotations:R(A(ue.annotations,!1)),labels:A(ue.labels,!0),folder:{title:ie,uid:Te.namespace_uid},isPaused:Te.is_paused,contactPoints:he,manualRouting:!!he}}else throw new Error("Unexpected type of rule for grafana rules source");else if((0,h.$y)(ue)){const he={refId:"A",datasourceUid:(0,l.l)().getInstanceSettings(te)?.uid??"",queryType:"",relativeTimeRange:(0,s.Cn)(),expr:ue.expr,model:{refId:"A",hide:!1,expr:ue.expr}},de=w(ue);return{...fe,...de,queries:[he],annotations:R(A(ue.annotations,!1)),type:f.Z.cloudAlerting,dataSourceName:te,namespace:ie,group:ce.name}}else if((0,h.i7)(ue)){const Te=L(ue);return{...fe,...Te,type:f.Z.cloudRecording,dataSourceName:te,namespace:ie,group:ce.name}}else throw new Error("Unexpected type of rule for cloud rules source")}function w(z){const te=x(),[ie,ce]=z.for?(0,D.P1)(z.for):[0,"s"],[ue,fe]=z.keep_firing_for?(0,D.P1)(z.keep_firing_for):[te.keepFiringForTime,te.keepFiringForTimeUnit];return{name:z.alert,expression:z.expr,forTime:ie,forTimeUnit:ce,keepFiringForTime:ue,keepFiringForTimeUnit:fe,annotations:A(z.annotations,!1),labels:A(z.labels,!0)}}function L(z){return{name:z.record,expression:z.expr,labels:A(z.labels,!0)}}const V=()=>{const z=(0,E.y9)();if(!z)return[...k("A","B")];const te=(0,s.Cn)();return[{refId:"A",datasourceUid:z.uid,queryType:"",relativeTimeRange:te,model:{refId:"A"}},...k("B","C")]},K=z=>{const te=getDefaultRelativeTimeRange();return[{refId:"A",datasourceUid:z[0]?.uid||"",queryType:"",relativeTimeRange:te,model:{refId:"A"}}]},k=(...z)=>{const te=z[0],ie=z[1],ce={refId:z[0],type:p.Tz.reduce,datasource:{uid:p.Uj,type:i.dR.type},conditions:[{type:"query",evaluator:{params:[],type:y.p.IsAbove},operator:{type:"and"},query:{params:[te]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"},ue={refId:ie,type:p.Tz.threshold,datasource:{uid:p.Uj,type:i.dR.type},conditions:[{type:"query",evaluator:{params:[0],type:y.p.IsAbove},operator:{type:"and"},query:{params:[ie]},reducer:{params:[],type:"last"}}],expression:te};return[{refId:te,datasourceUid:p.Uj,queryType:"",model:ce},{refId:ie,datasourceUid:p.Uj,queryType:"",model:ue}]},j=async(z,te,ie,ce,ue,fe)=>{const Te=[];for(const he of z){const de=await(0,l.l)().get(he.datasource?.uid?he.datasource:ce),le={uid:de.uid,type:de.type},pe=r.relativeToTimeRange(te),{interval:ve,intervalMs:be}=X(pe,fe??de.interval,ue),Oe={__interval:{text:ve,value:ve},__interval_ms:{text:be,value:be},...ie},Me=de.interpolateVariablesInQueries?de.interpolateVariablesInQueries([he],Oe)[0]:he;if(le.uid===p.Uj){const Ue={refId:Me.refId,queryType:"",relativeTimeRange:te,datasourceUid:p.Uj,model:Me};Te.push(Ue)}else{const Ue=(0,l.l)().getInstanceSettings(le);if(Ue&&Ue.meta.alerting){const we={refId:Me.refId,queryType:Me.queryType??"",relativeTimeRange:te,datasourceUid:Ue.uid,model:{...Me,maxDataPoints:ue,intervalMs:be}};Te.push(we)}}}return Te},H=async(z,te)=>{const{targets:ie}=z;if(!z.id||!te.uid)return;const ce=r.timeRangeToRelative(r.convertRawToRange(te.time)),ue=await j(ie,ce,z.scopedVars||{},z.datasource??void 0,z.maxDataPoints??void 0,z.interval??void 0);if(!ue.length||!ue.find(de=>de.datasourceUid!==p.Uj))return;if(!ue.find(de=>de.datasourceUid===p.Uj)){const[de,le]=k((0,o.M)(ue),"-");ue.push(de);const[pe,ve]=k(de.refId,(0,o.M)(ue));ue.push(ve)}const{folderTitle:fe,folderUid:Te}=te.meta;return{type:f.Z.grafana,folder:Te&&fe?{uid:Te,title:fe}:void 0,queries:ue,name:z.title,condition:ue[ue.length-1].refId,annotations:[{key:a.YH.dashboardUID,value:te.uid},{key:a.YH.panelID,value:String(z.id)}]}},J=async z=>{if(!z.state.key)return;const te=u.jh.getTimeRange(z),ie=(0,d.un)(z);if(!ie)return;const{queries:ce,datasource:ue,maxDataPoints:fe,minInterval:Te}=ie.state,he=(0,d.YQ)(z);if(!he||!he.state.uid)return;const de=await j(ce,r.timeRangeToRelative(r.convertRawToRange(te.state.value.raw)),{__sceneObject:{value:z}},ue,fe,Te);if(!de.length||!de.find(be=>be.datasourceUid!==p.Uj))return;if(!de.find(be=>be.datasourceUid===p.Uj)){const[be,Oe]=k((0,o.M)(de),"-");de.push(be);const[Me,Ue]=k(be.refId,(0,o.M)(de));de.push(Ue)}const{folderTitle:le,folderUid:pe}=he.state.meta;return{type:f.Z.grafana,folder:pe&&le?{uid:pe,title:le}:void 0,queries:de,name:z.state.title,condition:de[de.length-1].refId,annotations:[{key:a.YH.dashboardUID,value:he.state.uid},{key:a.YH.panelID,value:String((0,d.Cs)(z))}]}};function X(z,te,ie){return ie?r.calculateInterval(z,ie,te):te&&r.intervalToMs(te)>1e3?{interval:te,intervalMs:r.intervalToMs(te)}:{interval:"1s",intervalMs:1e3}}function se(z){const te=z.model;return ae(te)&&te.instant&&te.range?{...z,model:{...te,range:!0,instant:!1}}:z}function ae(z){return"expr"in z&&"instant"in z&&"range"in z}function ne(z){return"expr"in z}const q=z=>({...z,queries:z.queries?.map(te=>(0,t.omit)(te,"model.hide"))});function ee(z){return q(N(z))}},18461:(G,I,e)=>{"use strict";e.d(I,{$9:()=>h,LC:()=>d,Ns:()=>v,P1:()=>m,PH:()=>P,UP:()=>i,VY:()=>S,Yd:()=>u,c:()=>a,qg:()=>E,uE:()=>O,x6:()=>g});var t=e(2543),n=e.n(t),s=e(12131),r=e(57220),o=e(23662);function m(x,b,M,A){return(0,o.lT)(A)?{uid:A.grafana_alert.uid,ruleSourceName:"grafana"}:{ruleSourceName:x,namespace:b,groupName:M,ruleName:(0,o.$y)(A)?A.alert:A.record,rulerRuleHash:v(A)}}function l(x,b,M,A){return{ruleSourceName:x,namespace:b,groupName:M,ruleName:A.name,ruleHash:C(A)}}function i(x,b){const M=b.namespace.name,A=b.group.name;if(b.rulerRule)return m(x,M,A,b.rulerRule);if(b.promRule)return l(x,M,A,b.promRule);throw new Error("Could not create an id for a rule that is missing both `rulerRule` and `promRule`.")}function u(x){return m(x.ruleSourceName,x.namespace,x.group.name,x.rule)}function d(x,b){return(0,o.A4)(x)&&(0,o.A4)(b)?x.uid===b.uid:(0,o.X4)(x)&&(0,o.X4)(b)?x.groupName===b.groupName&&x.namespace===b.namespace&&x.ruleName===b.ruleName&&x.rulerRuleHash===b.rulerRuleHash&&x.ruleSourceName===b.ruleSourceName:(0,o.Mj)(x)&&(0,o.Mj)(b)?x.groupName===b.groupName&&x.namespace===b.namespace&&x.ruleName===b.ruleName&&x.ruleHash===b.ruleHash&&x.ruleSourceName===b.ruleSourceName:!1}const p="cri",c="pri";function y(x){return x.replace(/\$/g,"_DOLLAR_")}function f(x){return x.replace(/\_DOLLAR\_/g,"$")}function P(x){return x.replace(/\//g,"").replace(/\\/g,"")}function a(x){return x.replace(/\x1f/g,"/").replace(/\x1e/g,"\\")}function E(x,b=!1){const A=(b?decodeURIComponent(x):x).split("$");if(A.length===1)return{uid:x,ruleSourceName:"grafana"};if(A.length===6){const[R,B,U,W,N,w]=A.map(f).map(a);if(R===p)return{ruleSourceName:B,namespace:U,groupName:W,ruleName:N,rulerRuleHash:w};if(R===c)return{ruleSourceName:B,namespace:U,groupName:W,ruleName:N,ruleHash:w}}throw new Error(`Failed to parse rule location: ${x}`)}function g(x,b=!1){if(x)try{return E(x,b)}catch{return}}function h(x){return(0,o.A4)(x)?x.uid:(0,o.X4)(x)?[p,x.ruleSourceName,x.namespace,x.groupName,x.ruleName,x.rulerRuleHash].map(String).map(y).map(P).join("$"):[c,x.ruleSourceName,x.namespace,x.groupName,x.ruleName,x.ruleHash].map(String).map(y).map(P).join("$")}function D(x){let b=0;if(x.length===0)return b;for(let M=0;M<x.length;M++){const A=x.charCodeAt(M);b=(b<<5)-b+A,b=b&b}return b}function v(x){if((0,o.i7)(x))return D(JSON.stringify([x.record,x.expr,T(x.labels)])).toString();if((0,o.$y)(x))return D(JSON.stringify([x.alert,x.expr,T(x.annotations),T(x.labels)])).toString();if((0,o.lT)(x))return x.grafana_alert.uid;throw new Error("only recording and alerting ruler rules can be hashed")}function C(x){if((0,o.KB)(x))return D(JSON.stringify([x.type,x.query,T(x.labels)])).toString();if((0,o.Z8)(x))return D(JSON.stringify([x.type,x.query,T(x.annotations),T(x.labels)])).toString();throw new Error("only recording and alerting rules can be hashed")}function T(x){return JSON.stringify(Object.entries(x||{}).sort((b,M)=>b[0].localeCompare(M[0])))}function S(x){return(0,o.A4)(x)?r.hY:x.ruleSourceName}function O(x){const{pathname:b=""}=s.Ny.getLocation(),{id:M}=x;return M?(0,t.nth)(b.split("/"),-2):void 0}},23662:(G,I,e)=>{"use strict";e.d(I,{$7:()=>g,$y:()=>y,A4:()=>h,HH:()=>a,KB:()=>c,Mj:()=>C,Om:()=>W,RI:()=>E,TU:()=>A,Tm:()=>x,Wy:()=>B,X4:()=>D,XI:()=>b,YN:()=>N,Z8:()=>p,dS:()=>R,f6:()=>T,i7:()=>f,jg:()=>L,lT:()=>P,nf:()=>v,qz:()=>w,uo:()=>S});var t=e(2543),n=e.n(t),s=e(43585),r=e(32264),o=e(94822),m=e(28475),l=e(55740),i=e(57220),u=e(75214),d=e(25968);function p(K){return typeof K=="object"&&K.type===o.JS.Alerting}function c(K){return typeof K=="object"&&K.type===o.JS.Recording}function y(K){return typeof K=="object"&&"alert"in K}function f(K){return typeof K=="object"&&"record"in K}function P(K){return typeof K=="object"&&"grafana_alert"in K}function a(K){return K&&P(K)&&!!K.grafana_alert.is_paused}function E(K){return JSON.stringify(K.labels)}function g(K){return K.error&&K.error?.message?.includes(l.UU)}function h(K){return"uid"in K}function D(K){return"rulerRuleHash"in K}function v(K){return Object.values(o.JS).includes(K)}function C(K){return"ruleHash"in K}function T(K){switch(K){case"ok":return m.Jc.Ok;case"nodata":return m.Jc.NoData;case"error":case"err":return m.Jc.Error;case"unknown":return m.Jc.Unknown;default:return}}function S(K){const k=K.labels[u.lL];if(!k)return;const j=k.match(/^plugin\/(?<pluginId>.+)$/);if(!j?.groups)return;const H=j.groups.pluginId;if(O(H))return{pluginId:H}}function O(K){return!!r.$.apps[K]}function x(K){return!!S(K)}function b(K){return K===o.cF.Inactive?"Normal":(0,t.capitalize)(K)}const M=K=>K.reduce((k,{dataSourceName:j,name:H,groups:J})=>(J.forEach(({name:X,rules:se})=>{se.forEach(ae=>{p(ae)&&k.push({dataSourceName:j,namespaceName:H,groupName:X,rule:ae})})}),k),[]),A=K=>p(K.promRule)?K.promRule:null,R=K=>K.reduce((k,{rulesSource:j,name:H,groups:J})=>(J.forEach(({name:X,rules:se})=>{se.forEach(ae=>{ae.promRule&&p(ae.promRule)&&k.push({dataSourceName:(0,i.EV)(j),namespaceName:H,groupName:X,...ae})})}),k),[]);function B(K){let k;return Object.values(s.O).includes(K)?k=K:k=(0,o.lh)(K),U[k]}const U={[o.cF.Inactive]:"good",[o.cF.Firing]:"bad",[o.cF.Pending]:"warning",[o.Gi.Alerting]:"bad",[o.Gi.Error]:"bad",[o.Gi.NoData]:"info",[o.Gi.Normal]:"good",[o.Gi.Pending]:"warning",[s.O.NoData]:"info",[s.O.Paused]:"warning",[s.O.Alerting]:"bad",[s.O.OK]:"good",[s.O.Unknown]:"info"};function W(K){return K?.alerts?K.alerts.reduce((k,j)=>{const H=(0,o.lh)(j.state)!==o.Gi.Normal;if(j.activeAt&&H){const J=new Date(j.activeAt);if(k===null||k.getTime()>J.getTime())return J}return k},null):null}function N(K){return Array.isArray(K.source_tenants)}function w(K){return P(K)?K.grafana_alert.title:y(K)?K.alert:f(K)?K.record:""}const L=(K,k)=>{const j={alertName:"",forDuration:"0s",evaluationsToFire:0};return P(K)?{alertName:K.grafana_alert.title,forDuration:K.for,evaluationsToFire:V(K.for,k)}:y(K)?{alertName:K.alert,forDuration:K.for??"0s",evaluationsToFire:V(K.for??"0s",k)}:j},V=(K,k)=>{const j=(0,d.P8)(k),H=(0,d.P8)(K);return H===0&&j!==0?1:j===0||H/j<1?0:Math.ceil(H/j)+1}},25968:(G,I,e)=>{"use strict";e.d(I,{M9:()=>u,P1:()=>n,P8:()=>p,TN:()=>o,an:()=>d,mo:()=>c,sc:()=>r,yl:()=>y});var t=e(41068);function n(f){const P=f.match(/(\d+)(\w+)/);if(P)return[Number(P[1]),P[2]];throw new Error(`Invalid interval description: ${f}`)}function s(f){const{sec:P,count:a}=describeInterval(f);return P*a}const r=Object.entries(t.y).map(([f,P])=>({label:f[0].toUpperCase()+f.slice(1),value:P}));function o(f){try{return u(f),!0}catch{return!1}}const m={ms:1,s:1e3,m:60*1e3,h:60*60*1e3,d:24*60*60*1e3,w:7*24*60*60*1e3,y:365*24*60*60*1e3},l=new RegExp(/^(?:(?<value>\d+)(?<type>ms|s|m|h|d|w|y))|0$/),i=new Error(`Must be of format "(number)(unit)", for example "1m", or just "0". Available units: ${Object.values(t.y).join(", ")}`);function u(f){let P=f,a=[];function E(h){const D=l.exec(h),v=D?.groups?.value&&D?.groups?.type;if(!D||!v)throw i;D&&D.groups?.value&&D.groups?.type&&(P=P.replace(D[0],""),a.push([Number(D.groups.value),D.groups.type])),P&&E(P)}if(E(f),!a.length)throw i;return a.reduce((h,[D,v])=>{const C=D*m[v];return h+C},0)}function d(f){const P=Math.floor(f/1e3),a=Math.floor(P/60),E=Math.floor(a/60),g=Math.floor(E/24),h=Math.floor(g/7),D=Math.floor(g/365);return f===0?"0s":[[D,"y"],[h%52,"w"],[g%365-7*(h%52),"d"],[E%24,"h"],[a%60,"m"],[P%60,"s"],[f%1e3,"ms"]].filter(([C])=>C>0).map(([C,T])=>C+T).join("")}const p=f=>{try{return u(f)}catch{return 0}},c=f=>f.includes("0001-01-01T00");function y(f){return f%(1e3*60*60)===0?f/(1e3*60*60)+"h":f%(1e3*60)===0?f/(1e3*60)+"m":f%1e3===0?f/1e3+"s":f.toFixed()+"ms"}},3704:(G,I,e)=>{"use strict";e.d(I,{c:()=>n,z:()=>s});var t=e(32264);function n(r,o){const l=new URLSearchParams(o).toString();return`${t.$.appSubUrl}${r}${l?`?${l}`:""}`}function s(r,o){const l=new URLSearchParams(o).toString();try{return`${new URL(t.$.appSubUrl+r,t.$.appUrl).href}${l?`?${l}`:""}`}catch{return n(r,o)}}},10154:(G,I,e)=>{"use strict";e.d(I,{Xm:()=>r,rJ:()=>s,vJ:()=>n,vy:()=>o});var t=e(17172);function n(m){return(0,t.AI)().post("/api/annotations",m)}function s(m){return(0,t.AI)().put(`/api/annotations/${m.id}`,m)}function r(m){return(0,t.AI)().delete(`/api/annotations/${m.id}`)}async function o(){return(await(0,t.AI)().get("/api/annotations/tags")).result.tags.map(({tag:l,count:i})=>({term:l,count:i}))}},82241:(G,I,e)=>{"use strict";e.d(I,{A:()=>C});var t=e(96540),n=e(75505),s=e(39070),r=e(76287),o=e(13544),m=e(68402),l=e(62930),i=e(55852),u=e(42418),d=e(14792),p=e(74856),c=e(34214),y=e(27302),f=e(42493),P=e(28240),a=e(8790),E=e(83195),g=e(56034),h=e(14578),D=e(21594);class v extends t.PureComponent{constructor(S){super(S),this.updateFields=()=>{const O=this.props.response?.panelData,x=O?.series?.[0]??O?.annotations?.[0];if(x&&x.fields){const b=x.fields.map(M=>{const A=(0,P.Ct)(M,x);let R="";for(let B=0;B<x.length;B++){if(B>0&&(R+=", "),B>2){R+="...";break}R+=M.values[B]}return R.length>50&&(R=R.substring(0,50)+"..."),{label:`${A} (${M.type})`,value:A,description:R}});this.setState({fieldNames:b})}},this.onFieldSourceChange=(O,x)=>{const b=this.props.mappings||{},M=b[O]||{};this.props.change({...b,[O]:{...M,source:x.value||a.V.Field}})},this.onFieldNameChange=(O,x)=>{const b=this.props.mappings||{};if(!x){const A={...this.props.mappings};delete A[O],this.props.change(A);return}const M=b[O]||{};this.props.change({...b,[O]:{...M,value:x.value,source:a.V.Field}})},this.state={fieldNames:[]}}componentDidMount(){this.updateFields()}componentDidUpdate(S){S.response!==this.props.response&&this.updateFields()}renderRow(S,O,x){const{fieldNames:b}=this.state;let M=[...b];const A=O.value;let R=b.find(U=>A===U.value);A&&!R&&M.push({label:A,value:A});let B=x?x[S.key]:"";if(B&&S.key.startsWith("time")){const U=(0,E.j_)("dateTimeAsIso");B=(0,E.cN)(U(B))}return B==null&&(B=""),t.createElement("tr",{key:S.key},t.createElement("td",null,S.label||S.key," ",S.help&&t.createElement(g.m,{content:S.help},t.createElement(h.I,{name:"info-circle"}))),t.createElement("td",null,t.createElement(D.l6,{value:R,options:M,placeholder:S.placeholder||S.key,onChange:U=>{this.onFieldNameChange(S.key,U)},noOptionsMessage:"Unknown field names",allowCustomValue:!0,isClearable:!0})),t.createElement("td",null,`${B}`))}render(){const S=this.props.response?.events?.[0],O=this.props.mappings||{};return t.createElement("table",{className:"filter-table"},t.createElement("thead",null,t.createElement("tr",null,t.createElement("th",null,"Annotation"),t.createElement("th",null,"From"),t.createElement("th",null,"First Value"))),t.createElement("tbody",null,f.kj.map(x=>this.renderRow(x,O[x.key]||{},S))))}}class C extends t.PureComponent{constructor(){super(...arguments),this.state={},this.onRunQuery=async()=>{const{datasource:S,annotation:O}=this.props;if((0,f.E7)(S))return;const x=(0,d.UA)().getCurrent();if(!x)return;this.setState({running:!0});const b=await(0,n.s)((0,y.b)({range:(0,p.jG)().timeRange(),panel:new c.a({}),dashboard:x},S,O));this.setState({running:!1,response:b})},this.onQueryChange=S=>{this.props.onChange({...this.props.annotation,target:S})},this.onMappingChange=S=>{this.props.onChange({...this.props.annotation,mappings:S})},this.onAnnotationChange=S=>{this.props.onChange(S)}}componentDidMount(){this.verifyDataSource()}componentDidUpdate(S){this.props.annotation!==S.annotation&&!(0,f.E7)(this.props.datasource)&&this.verifyDataSource()}verifyDataSource(){const{datasource:S,annotation:O}=this.props,b={...f.CU,...S.annotations}.prepareAnnotation(O);b!==O?this.props.onChange(b):this.onRunQuery()}getStatusSeverity(S){const{events:O,panelData:x}=S;return x?.errors||x?.error?"error":O?.length?"success":"warning"}renderStatusText(S,O){const{events:x,panelData:b}=S;if(O||S?.panelData?.state===s.Gu.Loading||!S)return t.createElement("p",null,"loading...");if(b?.errors)return t.createElement(t.Fragment,null,b.errors.map((A,R)=>t.createElement("p",{key:R},A.message)));if(b?.error)return t.createElement("p",null,b.error.message??"There was an error fetching data");if(!x?.length)return t.createElement("p",null,"No events found");const M=b?.series?.[0]??b?.annotations?.[0];return t.createElement("p",null,x.length," events (from ",M?.fields.length," fields)")}renderStatus(){const{response:S,running:O}=this.state;return S?t.createElement(t.Fragment,null,t.createElement(m.$,{v:2}),t.createElement("div",null,O?t.createElement(l.y,null):t.createElement(i.$n,{"data-testid":o.Tp.components.Annotations.editor.testButton,variant:"secondary",size:"xs",onClick:this.onRunQuery},"Test annotation query")),t.createElement(m.$,{v:2,layout:"block"}),t.createElement(u.F,{"data-testid":o.Tp.components.Annotations.editor.resultContainer,severity:this.getStatusSeverity(S),title:"Query result"},this.renderStatusText(S,O))):null}render(){const{datasource:S,annotation:O,datasourceInstanceSettings:x}=this.props,{response:b}=this.state;let M=S.annotations?.QueryEditor||S.components?.QueryEditor;if(!M)return t.createElement("div",null,"Annotations are not supported. This datasource needs to export a QueryEditor");const A={...S.annotations?.getDefaultQuery?.(),...O.target??{refId:"Anno"}};return t.createElement(t.Fragment,null,t.createElement(r.p,{instanceSettings:x},t.createElement(M,{key:S?.name,query:A,datasource:S,onChange:this.onQueryChange,onRunQuery:this.onRunQuery,data:b?.panelData,range:(0,p.jG)().timeRange(),annotation:O,onAnnotationChange:this.onAnnotationChange})),(0,f.JX)(S)&&t.createElement(t.Fragment,null,this.renderStatus(),t.createElement(v,{response:b,mappings:O.mappings,change:this.onMappingChange})))}}},27302:(G,I,e)=>{"use strict";e.d(I,{b:()=>d});var t=e(62467),n=e(69862),s=e(81160),r=e(65879),o=e(41987),m=e(39374),l=e(42493);let i=100;function u(){return"AQ"+i++}function d(p,c,y){const f={...l.CU,...c.annotations},P={...f.getDefaultQuery?.(),...y},a=f.prepareAnnotation(P);if(!a)return(0,t.of)({});const E=f.prepareQuery(a);if(!E)return(0,t.of)({});const g=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h=r.calculateInterval(p.range,g,c.interval),D={__interval:{text:h.interval,value:h.interval},__interval_ms:{text:h.intervalMs.toString(),value:h.intervalMs},__annotation:{text:a.name,value:a}},v={startTime:Date.now(),requestId:u(),range:p.range,maxDataPoints:g,scopedVars:D,...h,app:o.Jk.Dashboard,timezone:p.dashboard.timezone,targets:[{...E,refId:"Anno"}]};return(0,m.BN)(c,v).pipe((0,n.Z)(C=>{const T=C?.series.length?C.series:C.annotations;return T?.length?f.processEvents(a,T).pipe((0,s.T)(S=>({panelData:C,events:S}))):(0,t.of)({panelData:C,events:[]})}))}},42493:(G,I,e)=>{"use strict";e.d(I,{CU:()=>p,E7:()=>h,JX:()=>g,kj:()=>y});var t=e(2543),n=e.n(t),s=e(62467),r=e(69862),o=e(81160),m=e(57934),l=e(11261),i=e(28240),u=e(8790),d=e(2913);const p={prepareAnnotation:D=>{if((0,t.isString)(D?.query)){const{query:v,...C}=D;return{...C,target:{refId:"annotation_query",query:v},mappings:{}}}return D},prepareQuery:D=>D.target,processEvents:(D,v)=>a(v,D.mappings)};function c(){return D=>D.pipe((0,r.Z)(v=>{if(!v?.length)return(0,s.of)(void 0);if(v.length===1)return(0,s.of)(v[0]);const C={interpolate:T=>T};return(0,s.of)(v).pipe(m.c.mergeTransformer.operator({},C),(0,o.T)(T=>T[0]))}))}const y=[{key:"time",field:D=>D.fields.find(v=>v.type===l.PU.time),placeholder:"time, or the first time field"},{key:"timeEnd",label:"end time",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:D=>D.fields.find(v=>v.type===l.PU.string),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],f=[{key:"color"},{key:"isRegion"},{key:"source"}],P=[...d.config.publicDashboardAccessToken?f:[],...y,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}];function a(D,v){return(0,s.of)(D).pipe(c(),(0,o.T)(C=>{if(!C?.length)return[];let T=!1,S=!1;const O={};for(const M of C.fields){const A=(0,i.Ct)(M,C);O[A.toLowerCase()]=M}v||(v={});const x=[];for(const M of P){const A=v[M.key]||{};if(A.source===u.V.Skip)continue;const R={key:M.key,split:M.split};if(A.source===u.V.Text)R.text=A.value;else{const B=(A.value||M.key).toLowerCase();R.field=O[B],!R.field&&M.field&&(R.field=M.field(C))}(R.field||R.text)&&(x.push(R),R.key==="time"?T=!0:R.key==="text"&&(S=!0))}if(!T||!S)return console.error("Cannot process annotation fields. No time or text present."),[];const b=[];for(let M=0;M<C.length;M++){const A={type:"default",color:"red"};for(const R of x){let B;if(R.text)B=R.text;else if(R.field&&(B=R.field.values[M],B!==void 0&&R.regex)){const U=R.regex.exec(B);U&&(B=U[1]?U[1]:U[0])}B!=null&&(R.split&&typeof B=="string"&&(B=B.split(",")),A[R.key]=B)}b.push(A)}return b}))}const E=["prometheus","loki","elasticsearch","grafana-opensearch-datasource"];function g(D){const{type:v}=D;return!(v==="datasource"||E.includes(v))}function h(D){const{type:v}=D;return E.includes(v)}},93584:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>d,QB:()=>i,Ri:()=>l,Sf:()=>r,cV:()=>o,h8:()=>m});var t=e(65307);const n={hasFetched:!1,includeExpired:!1,keys:[],keysIncludingExpired:[],searchQuery:"",migrationResult:{total:0,migrated:0,failed:0,failedApikeyIDs:[0],failedDetails:[]}},s=(0,t.Z0)({name:"apiKeys",initialState:n,reducers:{apiKeysLoaded:(p,c)=>{const{keys:y,keysIncludingExpired:f}=c.payload,P=c.payload.keys.length===0&&c.payload.keysIncludingExpired.length>0?!0:p.includeExpired;return{...p,hasFetched:!0,keys:y,keysIncludingExpired:f,includeExpired:P}},setSearchQuery:(p,c)=>({...p,searchQuery:c.payload}),includeExpiredToggled:p=>({...p,includeExpired:!p.includeExpired}),isFetching:p=>({...p,hasFetched:!1}),setMigrationResult:(p,c)=>({...p,migrationResult:c.payload})}}),{apiKeysLoaded:r,includeExpiredToggled:o,isFetching:m,setSearchQuery:l,setMigrationResult:i}=s.actions,d={apiKeys:s.reducer}},2468:(G,I,e)=>{"use strict";e.d(I,{w:()=>s});var t=e(32264),n=e(17172);class s{constructor(o,m=!0){const l=m?`namespaces/${t.$.namespace}/`:"";this.url=`/apis/${o.group}/${o.version}/${l}${o.resource}`}async create(o){return!o.metadata.name&&!o.metadata.generateName&&(o.metadata.generateName="g"),(0,n.AI)().post(this.url,o)}async get(o){return(0,n.AI)().get(`${this.url}/${o}`)}async subresource(o,m){return(0,n.AI)().get(`${this.url}/${o}/${m}`)}async list(o){const m=o||{};return m.labelSelector=this.parseListOptionsSelector(m?.labelSelector),m.fieldSelector=this.parseListOptionsSelector(m?.fieldSelector),(0,n.AI)().get(this.url,o)}async update(o){return(0,n.AI)().put(`${this.url}/${o.metadata.name}`,o)}async delete(o){return(0,n.AI)().delete(`${this.url}/${o}`)}parseListOptionsSelector(o){return Array.isArray(o)?o.map(m=>{const l=String(m.key),i=m.operator;switch(i){case"=":case"!=":return`${l}${i}${m.value}`;case"in":case"notin":return`${l} ${i} (${m.value.join(",")})`;case"":case"!":return`${i}${l}`;default:return null}}).filter(Boolean).join(","):o}}},73399:(G,I,e)=>{"use strict";e.d(I,{getAuthProviderStatus:()=>d,getRegisteredAuthProviders:()=>l,initAuthConfig:()=>p});var t=e(10096),n=e(27677),s=e(31678);const r=[],o={};function m(y,f){r.find(P=>P.id===y.id)||(r.push(y),f&&(o[y.id]=f))}function l(){return r}function i(y){return r.find(f=>f.id===y)}function u(y){const f=[];for(const[P,a]of Object.entries(y)){const E=r.find(g=>`auth.${g.id}`===P);if(E){const g={...a,providerId:E.id,displayName:a.name||E.displayName};f.push(g)}}return f}async function d(y){if(o[y]){const f=o[y];return f()}return{configured:!1,enabled:!1}}function p(){m({id:"ldap",type:"LDAP",protocol:"LDAP",displayName:"LDAP",configPath:"ldap"},c)}async function c(){if(t.TP.hasPermission(s.AccessControlAction.SettingsRead)){const f=(await(0,n.AI)().get("/api/admin/settings"))["auth.ldap"]||{};return{configured:f.enabled==="true",enabled:f.enabled==="true",hide:f.enabled!=="true"}}return{configured:!1,enabled:!1}}},20604:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>f,MH:()=>l,Nh:()=>i,Oy:()=>c,SH:()=>u,TO:()=>o,jA:()=>r,sr:()=>m});var t=e(65307);const n={settings:{},providerStatuses:{},isLoading:!1,providers:[]},s=(0,t.Z0)({name:"authConfig",initialState:n,reducers:{settingsUpdated:(P,a)=>({...P,settings:a.payload}),providerStatusesLoaded:(P,a)=>({...P,providerStatuses:a.payload}),loadingBegin:P=>({...P,isLoading:!0}),loadingEnd:P=>({...P,isLoading:!1}),setError:(P,a)=>({...P,updateError:a.payload}),resetError:P=>({...P,updateError:void 0}),setWarning:(P,a)=>({...P,warning:a.payload}),resetWarning:P=>({...P,warning:void 0}),providersLoaded:(P,a)=>({...P,providers:a.payload})}}),{settingsUpdated:r,providerStatusesLoaded:o,loadingBegin:m,loadingEnd:l,setError:i,resetError:u,setWarning:d,resetWarning:p,providersLoaded:c}=s.actions,f={authConfig:s.reducer}},55314:(G,I,e)=>{"use strict";e.d(I,{G2:()=>D,Ko:()=>g,Vc:()=>S,aF:()=>C,cU:()=>a,e8:()=>O,hT:()=>f.hT,iB:()=>x,kH:()=>v,uz:()=>h,vZ:()=>E,wt:()=>T});var t=e(75816),n=e(75505),s=e(71733),r=e(39070),o=e(17172),m=e(12131),l=e(82467),i=e(3169),u=e(10096),d=e(28676),p=e(6473),c=e(37690),y=e(92955),f=e(10378);function P({baseURL:b}){async function M(A){try{const{data:R,...B}=await(0,n.s)((0,o.AI)().fetch({...A,url:b+A.url,showErrorAlert:A.showErrorAlert}));return{data:R,meta:B}}catch(R){return A.manageError?A.manageError(R):{error:R}}}return M}const a=(0,t.xP)({tagTypes:["getFolder"],reducerPath:"browseDashboardsAPI",baseQuery:P({baseURL:"/api"}),endpoints:b=>({listFolders:b.query({providesTags:M=>M?.map(A=>({type:"getFolder",id:A.uid}))??[],query:({parentUid:M,limit:A,page:R,permission:B})=>({url:"/folders",params:{parentUid:M,limit:A,page:R,permission:B}})}),getFolder:b.query({providesTags:(M,A,R)=>[{type:"getFolder",id:R}],query:M=>({url:`/folders/${M}`,params:{accesscontrol:!0}})}),newFolder:b.mutation({query:({title:M,parentUid:A})=>({method:"POST",url:"/folders",data:{title:M,parentUid:A}}),onQueryStarted:({parentUid:M},{queryFulfilled:A,dispatch:R})=>{A.then(async({data:B})=>{await u.TP.fetchUserPermissions(),R((0,l.dx)((0,i.tZ)("Folder created"))),R((0,c.bw)({parentUID:M,pageSize:y.md})),m.Ny.push(s.I.stripBaseFromUrl(B.url))})}}),saveFolder:b.mutation({invalidatesTags:["getFolder"],query:({uid:M,title:A,version:R})=>({method:"PUT",url:`/folders/${M}`,data:{title:A,version:R}}),onQueryStarted:({parentUid:M},{queryFulfilled:A,dispatch:R})=>{A.then(()=>{R((0,c.bw)({parentUID:M,pageSize:y.md}))})}}),moveFolder:b.mutation({invalidatesTags:["getFolder"],query:({folder:M,destinationUID:A})=>({url:`/folders/${M.uid}/move`,method:"POST",data:{parentUID:A}}),onQueryStarted:({folder:M,destinationUID:A},{queryFulfilled:R,dispatch:B})=>{const{parentUid:U}=M;R.then(()=>{B((0,c.bw)({parentUID:U,pageSize:y.md})),B((0,c.bw)({parentUID:A,pageSize:y.md}))})}}),deleteFolder:b.mutation({query:({uid:M})=>({url:`/folders/${M}`,method:"DELETE",params:{forceDeleteRules:!1}}),onQueryStarted:({parentUid:M},{queryFulfilled:A,dispatch:R})=>{A.then(()=>{R((0,c.bw)({parentUID:M,pageSize:y.md}))})}}),getAffectedItems:b.query({queryFn:async M=>{const R=Object.keys(M.folder).filter(W=>M.folder[W]).map(W=>(0,o.AI)().get(`/api/folders/${W}/counts`)),B=await Promise.all(R),U={folder:Object.values(M.folder).filter(r.zz).length,dashboard:Object.values(M.dashboard).filter(r.zz).length,libraryPanel:0,alertRule:0};for(const W of B)U.folder+=W.folder??0,U.dashboard+=W.dashboard,U.alertRule+=W.alertrule,U.libraryPanel+=W.librarypanel;return{data:U}}}),moveItems:b.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:M,destinationUID:A},R,B,U)=>{const W=Object.keys(M.dashboard).filter(w=>M.dashboard[w]),N=Object.keys(M.folder).filter(w=>M.folder[w]);for(const w of N)await U({url:`/folders/${w}/move`,method:"POST",data:{parentUID:A}});for(const w of W){const V={dashboard:(await(0,d.n)().getDashboardDTO(w)).dashboard,folderUid:A,overwrite:!1,message:""};await U({url:"/dashboards/db",method:"POST",data:V})}return{data:void 0}},onQueryStarted:({destinationUID:M,selectedItems:A},{queryFulfilled:R,dispatch:B})=>{const U=Object.keys(A.dashboard).filter(N=>A.dashboard[N]),W=Object.keys(A.folder).filter(N=>A.folder[N]);R.then(()=>{B((0,c.bw)({parentUID:M,pageSize:y.md})),B((0,c.Zw)([...W,...U]))})}}),deleteItems:b.mutation({queryFn:async({selectedItems:M},A,R,B)=>{const U=Object.keys(M.dashboard).filter(N=>M.dashboard[N]),W=Object.keys(M.folder).filter(N=>M.folder[N]);for(const N of W)await B({url:`/folders/${N}`,method:"DELETE",params:{forceDeleteRules:!1}});for(const N of U)await B({url:`/dashboards/uid/${N}`,method:"DELETE"});return{data:void 0}},onQueryStarted:({selectedItems:M},{queryFulfilled:A,dispatch:R})=>{const B=Object.keys(M.dashboard).filter(W=>M.dashboard[W]),U=Object.keys(M.folder).filter(W=>M.folder[W]);A.then(()=>{R((0,c.Zw)([...U,...B]))})}}),saveDashboard:b.mutation({query:({dashboard:M,folderUid:A,message:R,overwrite:B,showErrorAlert:U})=>({url:"/dashboards/db",method:"POST",showErrorAlert:U,data:{dashboard:M,folderUid:A,message:R??"",overwrite:!!B}}),onQueryStarted:({folderUid:M},{queryFulfilled:A,dispatch:R})=>{p.t.ignoreNextSave(),A.then(async()=>{await u.TP.fetchUserPermissions(),R((0,c.bw)({parentUID:M,pageSize:y.md}))})}}),importDashboard:b.mutation({query:({dashboard:M,overwrite:A,inputs:R,folderUid:B})=>({method:"POST",url:"/dashboards/import",data:{dashboard:M,overwrite:A,inputs:R,folderUid:B}}),onQueryStarted:({folderUid:M},{queryFulfilled:A,dispatch:R})=>{A.then(async B=>{R((0,c.bw)({parentUID:M,pageSize:y.md}));const U=s.I.stripBaseFromUrl(B.data.importedUrl);m.Ny.push(U)})}})})}),{endpoints:E,useDeleteFolderMutation:g,useDeleteItemsMutation:h,useGetAffectedItemsQuery:D,useGetFolderQuery:v,useMoveFolderMutation:C,useMoveItemsMutation:T,useNewFolderMutation:S,useSaveDashboardMutation:O,useSaveFolderMutation:x}=a},92955:(G,I,e)=>{"use strict";e.d(I,{aw:()=>p,md:()=>u,uT:()=>d});var t=e(32264),n=e(17172),s=e(53477),r=e(24439),o=e(40957),m=e(10096),l=e(31678),i=e(49952);const u=50;async function d(c,y,f=1,P=u){if(c&&!t.$.featureToggles.nestedFolders)return[];const a=(0,n.AI)();let E=[];m.TP.hasPermission(l.AccessControlAction.FoldersRead)&&(E=await a.get("/api/folders",{parentUid:c,page:f,limit:P}));const g=t.$.appSubUrl??"";return E.map(h=>({kind:"folder",uid:h.uid,title:h.title,parentTitle:y,parentUID:c,url:(0,i.I)(h.uid)?void 0:`${g}/dashboards/f/${h.uid}/`}))}async function p(c,y=1,f=u){const a=await(0,r.getGrafanaSearcher)().search({kind:["dashboard"],query:"*",location:c||"general",from:(y-1)*f,limit:f});return a.view.map(E=>{const g=(0,o.hI)(E,a.view);return g.parentUID===s.TF&&(g.parentUID=void 0),g})}},43907:(G,I,e)=>{"use strict";e.d(I,{x:()=>i});var t=e(96540),n=e(70255),s=e(94753),r=e(42418),o=e(55314),m=e(8484);function l(u,d,p,c){const y=u+d+p+c,f=[];u&&f.push((0,m.t)("browse-dashboards.counts.folder","{{count}} folder",{count:u})),d&&f.push((0,m.t)("browse-dashboards.counts.dashboard","{{count}} dashboard",{count:d})),p&&f.push((0,m.t)("browse-dashboards.counts.libraryPanel","{{count}} library panel",{count:p})),c&&f.push((0,m.t)("browse-dashboards.counts.alertRule","{{count}} alert rule",{count:c}));let P=(0,m.t)("browse-dashboards.counts.total","{{count}} item",{count:y});return f.length>0&&(P+=`: ${f.join(", ")}`),P}const i=({selectedItems:u})=>{const{data:d,isFetching:p,isLoading:c,error:y}=(0,o.G2)(u);return t.createElement(t.Fragment,null,t.createElement(s.E,{element:"p",color:"secondary"},d&&l(d.folder,d.dashboard,d.libraryPanel,d.alertRule),(p||c)&&t.createElement(n.A,{width:200})),y&&t.createElement(r.F,{severity:"error",title:"Unable to retrieve descendant information"}))}},49952:(G,I,e)=>{"use strict";e.d(I,{I:()=>s,e:()=>n});var t=e(32264);function n(r,o){return r+o.uid}function s(r){return r===t.$.sharedWithMeFolderUID}},36141:(G,I,e)=>{"use strict";e.d(I,{Ii:()=>l,Zw:()=>o,bw:()=>m});var t=e(53477),n=e(31678),s=e(92955),r=e(93519);const o=(0,n.createAsyncThunk)("browseDashboards/refreshParents",async(i,{getState:u,dispatch:d})=>{const{browseDashboards:p}=u(),{rootItems:c,childrenByParentUID:y}=p,f=new Set;for(const P of i){const a=(0,r.R)(c?.items??[],y,P);f.add(a?.parentUID)}for(const P of f)d(m({parentUID:P,pageSize:s.md}))}),m=(0,n.createAsyncThunk)("browseDashboards/refetchChildren",async({parentUID:i,pageSize:u})=>{const d=i===t.TF?void 0:i;let p=1,c="folder",y=await(0,s.uT)(d,void 0,p,u),f=y.length<u;if(c==="folder"&&f){c="dashboard",p=1;const P=await(0,s.aw)(d,p,u);f=P.length<u,y=y.concat(P)}return{children:y,lastPageOfKind:f,page:p,kind:c}}),l=(0,n.createAsyncThunk)("browseDashboards/fetchNextChildrenPage",async({parentUID:i,excludeKinds:u=[],pageSize:d},p)=>{const c=!u.includes("dashboard"),y=i===t.TF?void 0:i,f=p.getState().browseDashboards,P=y?f.childrenByParentUID[y]:f.rootItems;let a=1,E;if(P?P.lastFetchedKind==="dashboard"&&!P.lastKindHasMoreItems?console.warn(`fetchNextChildrenPage called for ${y} but that collection is fully loaded`):P.lastFetchedKind==="folder"&&P.lastKindHasMoreItems?(a=P.lastFetchedPage+1,E="folder"):c&&(a=P.lastFetchedKind==="folder"?1:P.lastFetchedPage+1,E="dashboard"):(a=1,E="folder"),!E)return;let g=E==="folder"?await(0,s.uT)(y,void 0,a,d):await(0,s.aw)(y,a,d),h=g.length<d;if(E==="folder"&&h&&c){E="dashboard",a=1;const D=await(0,s.aw)(y,a,d);h=D.length<d,g=g.concat(D)}return{children:g,lastPageOfKind:h,page:a,kind:E}})},37690:(G,I,e)=>{"use strict";e.d(I,{Am:()=>d,Ii:()=>n.Ii,bw:()=>n.bw,Zw:()=>n.Zw,ku:()=>u,cT:()=>t.cT,wn:()=>t.wn,t$:()=>t.t$,xK:()=>v,eC:()=>a,Ms:()=>h,V6:()=>D,q0:()=>E,QE:()=>g,Zg:()=>C});var t=e(79763),n=e(36141),s=e(96540),r=e(25508),o=e(31678),m=e(92955),l=e(49952),i=e(93519);const u=S=>S.browseDashboards.rootItems,d=S=>S.browseDashboards.childrenByParentUID,p=S=>S.browseDashboards.openFolders,c=S=>S.browseDashboards.selectedItems,y=(0,r.Mz)(u,d,p,(S,O)=>O,(S,O,x,b)=>T(b,S,O,x)),f=(0,r.Mz)(c,S=>Object.values(S).some(O=>Object.values(O).some(x=>x))),P=(0,r.Mz)(c,d,(S,O)=>{const x={dashboard:{...S.dashboard},folder:{...S.folder}};for(const b of Object.keys(S.folder))if(S.folder[b]){const A=O[b];if(A)for(const R of A.items)R.kind==="dashboard"&&(x.dashboard[R.uid]=!1),R.kind==="folder"&&(x.folder[R.uid]=!1)}return x});function a(S){return(0,o.useSelector)(O=>(S?O.browseDashboards.childrenByParentUID[S]:O.browseDashboards.rootItems)?"fulfilled":"pending")}function E(S){return(0,o.useSelector)(O=>y(O,S))}function g(){return(0,o.useSelector)(S=>f(S))}function h(){return(0,o.useSelector)(c)}function D(){return(0,o.useSelector)(S=>S.browseDashboards.childrenByParentUID)}function v(){return(0,o.useSelector)(S=>P(S))}function C(S=[]){const O=(0,o.useDispatch)(),x=(0,s.useRef)(!1);return(0,s.useCallback)(M=>{if(x.current)return Promise.resolve();x.current=!0;const A=O((0,n.Ii)({parentUID:M,excludeKinds:S,pageSize:m.md}));return A.finally(()=>x.current=!1),A},[O,S])}function T(S,O,x,b,M=0,A=[],R=[]){function B(K,k,j){if(A.includes(K.kind)||R.includes(K.uid))return[];const H=T(K.uid,O,x,b,j+1,A,R),J=!!b[K.uid],X=x[K.uid]?.items.length===0;J&&X&&!A.includes("empty-folder")&&H.push({isOpen:!1,level:j+1,item:{kind:"ui",uiKind:"empty-folder",uid:K.uid+"empty-folder"},parentUID:k});const se={item:K,parentUID:k,level:j,isOpen:J},ae=[se,...H];return(0,l.I)(se.item.uid)&&ae.push({item:{kind:"ui",uiKind:"divider",uid:"shared-with-me-divider"},parentUID:k,level:j+1,isOpen:!1}),ae}const U=S&&b[S]||M===0,W=S?x[S]:O;let w=((S?U&&W?.items:W?.items)||[]).flatMap(K=>B(K,S,M));const L=A.includes("dashboard")&&W?.lastFetchedKind==="dashboard";return(M===0&&!W||U&&W&&!(W.isFullyLoaded||L))&&(w=w.concat((0,i.T)(m.md,S,M))),w}},79763:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>D,cT:()=>h,wn:()=>E,t$:()=>g});var t={};e.r(t),e.d(t,{fetchNextChildrenPageFulfilled:()=>l,refetchChildrenFulfilled:()=>m,setAllSelection:()=>d,setFolderOpenState:()=>i,setItemSelectionState:()=>u});var n=e(65307),s=e(36141),r=e(49952),o=e(93519);function m(v,C){const{children:T,page:S,kind:O,lastPageOfKind:x}=C.payload,{parentUID:b}=C.meta.arg,M={items:T,lastFetchedKind:O,lastFetchedPage:S,lastKindHasMoreItems:!x,isFullyLoaded:O==="dashboard"&&x};b?v.childrenByParentUID[b]=M:v.rootItems=M}function l(v,C){const T=C.payload;if(!T)return;const{children:S,page:O,kind:x,lastPageOfKind:b}=T,{parentUID:M,excludeKinds:A=[]}=C.meta.arg,U={items:((M?v.childrenByParentUID[M]:v.rootItems)?.items??[]).concat(S),lastFetchedKind:x,lastFetchedPage:O,lastKindHasMoreItems:!b,isFullyLoaded:(A.includes("dashboard")||x==="dashboard")&&b};if(!M){v.rootItems=U;return}if(v.childrenByParentUID[M]=U,v.selectedItems.folder[M])for(const N of S)v.selectedItems[N.kind][N.uid]=!0}function i(v,C){const{folderUID:T,isOpen:S}=C.payload;v.openFolders[T]=S}function u(v,C){const{item:T,isSelected:S}=C.payload;if((0,r.I)(T.uid))return;function O(x,b){if(v.selectedItems[x][b]=S,x!=="folder")return;let M=v.childrenByParentUID[b];for(const A of M?.items??[])O(A.kind,A.uid)}if(O(T.kind,T.uid),!S){let x=T.parentUID;for(;x;){const b=(0,o.R)(v.rootItems?.items??[],v.childrenByParentUID,x);if(!b)break;v.selectedItems[b.kind][b.uid]=!1,x=b.parentUID}}v.selectedItems.$all=v.rootItems?.items?.every(x=>v.selectedItems[x.kind][x.uid])??!1}function d(v,C){const{isSelected:T,folderUID:S}=C.payload;if(!(S&&(0,r.I)(S)))if(v.selectedItems.$all=T,T){let x=function(b){if(b&&(0,r.I)(b))return;const M=b?v.childrenByParentUID[b]:v.rootItems;if(M)for(const A of M.items)(0,r.I)(A.uid)||(v.selectedItems[A.kind][A.uid]=T,A.kind==="folder"&&x(A.uid))};var O=x;x(S)}else for(const x in v.selectedItems){if(!(x==="dashboard"||x==="panel"||x==="folder"))continue;const b=v.selectedItems[x];for(const M in b)b[M]=T}}const{fetchNextChildrenPageFulfilled:p,refetchChildrenFulfilled:c,...y}=t,f={rootItems:void 0,childrenByParentUID:{},openFolders:{},selectedItems:{dashboard:{},folder:{},panel:{},$all:!1}},P=(0,n.Z0)({name:"browseDashboards",initialState:f,reducers:y,extraReducers:v=>{v.addCase(s.Ii.fulfilled,p),v.addCase(s.bw.fulfilled,c)}}),a=P.reducer,{setFolderOpenState:E,setItemSelectionState:g,setAllSelection:h}=P.actions,D={browseDashboards:a}},93519:(G,I,e)=>{"use strict";e.d(I,{R:()=>t,T:()=>n});function t(s,r,o){for(const m of s)if(m.uid===o)return m;for(const m in r){const l=r[m];if(l){for(const i of l.items)if(i.uid===o)return i}}}function n(s,r,o){return new Array(s).fill(null).map((m,l)=>({parentUID:r,level:o,isOpen:!1,item:{kind:"ui",uiKind:"pagination-placeholder",uid:`${r}-pagination-${l}`}}))}},6320:(G,I,e)=>{"use strict";e.d(I,{b:()=>n,q:()=>t});const t="connections",n={Base:`/${t}`,DataSources:`/${t}/datasources`,DataSourcesNew:`/${t}/datasources/new`,DataSourcesEdit:`/${t}/datasources/edit/:uid`,DataSourcesDashboards:`/${t}/datasources/edit/:uid/dashboards`,AddNewConnection:`/${t}/add-new-connection`,DataSourcesDetails:`/${t}/datasources/:id`,ConnectDataOutdated:`/${t}/connect-data`,YourConnectionsOutdated:`/${t}/your-connections`}},67023:(G,I,e)=>{"use strict";e.d(I,{k:()=>o});var t=e(60455),n=e.n(t),s=e(91890),r=e(87490);const o=(m,l,i)=>{let u={},d={};if(m.type===s.CC.Regex&&m.expression){const p=new RegExp(m.expression,"gi"),y=(typeof l=="string"?l:(0,r.MA)(l)).matchAll(p);for(const f of y)f.groups?d=f.groups:d[m.mapValue||i]=f[1]||f[0]}else m.type===s.CC.Logfmt&&(d=n().parse(l));return Object.keys(d).forEach(p=>{const c=typeof d[p]=="string"?d[p]:(0,r.MA)(d[p]);u[p]={value:c}}),u}},40511:(G,I,e)=>{"use strict";e.d(I,{F0:()=>i,bQ:()=>u,lW:()=>d});var t=e(41053),n=e(75505),s=e(19347),r=e(76888),o=e(18380);const m=({sourceUID:p,targetUID:c,...y})=>{const f=(0,s.l)().getInstanceSettings(p),P=(0,s.l)().getInstanceSettings(c);if((y?.orgId===void 0||y?.orgId===null||y?.orgId===0)&&o.kb.logWarning("Invalid correlation config: Missing org id."),f&&f?.uid!==void 0&&P&&P.uid!==void 0)return{...y,source:f,target:P};o.kb.logWarning("Invalid correlation config: Missing source or target.",{source:JSON.stringify(f),target:JSON.stringify(P)})},l=p=>!!p,i=p=>({...p,correlations:p.correlations.map(m).filter(l)});function u(p){return p.data}const d=()=>{const{backend:p}=(0,r.Il)(),[c,y]=(0,t.A)(D=>(0,n.s)(p.fetch({url:"/api/datasources/correlations",params:{page:D.page},method:"GET",showErrorAlert:!1})).then(u).then(i),[p]),[f,P]=(0,t.A)(({sourceUID:D,...v})=>p.post(`/api/datasources/uid/${D}/correlations`,v).then(C=>{const T=m(C.result);if(T!==void 0)return T;throw new Error("invalid sourceUID")}),[p]),[a,E]=(0,t.A)(({sourceUID:D,uid:v})=>p.delete(`/api/datasources/uid/${D}/correlations/${v}`),[p]),[g,h]=(0,t.A)(({sourceUID:D,uid:v,...C})=>p.patch(`/api/datasources/uid/${D}/correlations/${v}`,C).then(T=>{const S=m(T.result);if(S!==void 0)return S;throw new Error("invalid sourceUID")}),[p]);return{create:{execute:P,...f},update:{execute:h,...g},get:{execute:y,...c},remove:{execute:E,...a}}}},18380:(G,I,e)=>{"use strict";e.d(I,{$q:()=>p,J6:()=>d,cA:()=>i,kb:()=>f,tZ:()=>y});var t=e(75505),n=e(91890),s=e(17172),r=e(19347),o=e(34867),m=e(9651),l=e(40511);const i=(P,a,E)=>(P.forEach(g=>{const h=g.refId;if(!h)return;let D=E[h];if(D===void 0&&g.meta?.preferredVisualisationType==="rawPrometheus"){const C=(0,m.a)(h);D=E[C]}const v=a.filter(C=>C.source.uid===D);u(g,v)}),P),u=(P,a)=>{P.fields.forEach(E=>{E.config.links=E.config.links?.filter(g=>g.origin!==n.x0.Correlations)||[],a.map(g=>{if(g.config?.field===E.name){const h=g.config?.target||{};E.config.links.push({internal:{query:{...h,datasource:{uid:g.target.uid}},datasourceUid:g.target.uid,datasourceName:g.target.name,transformations:g.config?.transformations},url:"",title:g.label||g.target.name,origin:n.x0.Correlations})}})})},d=async P=>(0,t.s)((0,s.AI)().fetch({url:"/api/datasources/correlations",method:"GET",showErrorAlert:!1,params:{sourceUID:P}})).then(l.bQ).then(l.F0),p=async(P,a)=>(0,s.AI)().post(`/api/datasources/uid/${P}/correlations`,a),c=async P=>P.datasourceInstance?.meta.mixed?await(0,r.l)().get(P.queries[0].datasource):P.datasourceInstance,y=async(P,a)=>Promise.all([c(P),c(a)]).then(E=>E[0]?.name!==void 0&&E[1]?.name!==void 0?`${E[0]?.name} to ${E[1]?.name}`:""),f=(0,o.DW)("features.correlations")},41524:(G,I,e)=>{"use strict";e.d(I,{W:()=>s});var t=e(11261);function n(){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o="abcdefghijklmnopqrstuvwxyz",m=r.length,l=new Map;return i=>{const u=l.get(i);if(u!=null)return u;const d=[...i].map(p=>p.toLowerCase()&&p!==p.toUpperCase()?o.charAt(Math.floor(Math.random()*m)):p.toUpperCase()&&p!==p.toUpperCase()?r.charAt(Math.floor(Math.random()*m)):p).join("");return l.set(i,d),d}}function s(r,o){if(!(o.labels||o.names||o.values))return r;const m=new Set(["time","value","exemplar","traceid","id","uid","uuid","__name__","le","name"]),l=n();return r.map(i=>{let{schema:u,data:d}=i;if(u&&d){if(o.labels){for(const p of u.fields)if(p.labels){const c={};for(const[y,f]of Object.entries(p.labels))c[y]=l(f);p.labels=c}}if(o.names)for(const p of u.fields)p.name?.length&&!m.has(p.name.toLowerCase())&&(p.name=l(p.name));o.values&&u.fields.forEach((p,c)=>{if(p.type===t.PU.string&&d){const y=d.values[c].map(f=>l(String(f)));d.values[c]=y}})}return{schema:u,data:d}})}},72255:(G,I,e)=>{"use strict";e.d(I,{m6:()=>h,sP:()=>C});var t=e(71733),n=e(17172),s=e(12131),r=e(32264),o=e(2619),m=e(33390),l=e(78160),i=e(17493),u=e(14792),d=e(79999),p=e(16833),c=e(31678),y=e(71176),f=e(85445),P=e(27734),a=e(77431);const E=500,g="loadDashboardScene",h="__grafana_home_uid__";class D extends o.Q{constructor(){super(...arguments),this.cache={}}async fetchDashboard({uid:S,route:O,urlFolderUid:x,keepDashboardFromExploreInLocalStorage:b}){const M=m.A.getObject(d.us);if(M)return b||(0,d.yZ)(),M;const A=O===c.DashboardRoutes.Home?h:S,R=this.getFromCache(A);if(R)return R;let B;try{switch(O){case c.DashboardRoutes.New:B=await(0,y.X)(x);break;case c.DashboardRoutes.Home:if(B=await(0,n.AI)().get("/api/dashboards/home"),B.redirectUri)return B;B?.meta&&(B.meta.canSave=!1,B.meta.canShare=!1,B.meta.canStar=!1);break;case c.DashboardRoutes.Public:return await i.np.loadDashboard("public","",S);default:B=await i.np.loadDashboard("db","",S),O===c.DashboardRoutes.Embedded&&(B.meta.isEmbedded=!0)}if(B.meta.url&&O===c.DashboardRoutes.Normal){const U=t.I.stripBaseFromUrl(B.meta.url),W=s.Ny.getLocation().pathname;U!==W&&(s.Ny.replace({...s.Ny.getLocation(),pathname:U}),console.log("not correct url correcting",U,W))}B.meta.folderUid&&await(0,a.Q)(B.meta.folderUid),this.dashboardCache={dashboard:B,ts:Date.now(),cacheKey:A}}catch(U){if((0,n.NF)(U)&&U.cancelled)return null;throw console.error(U),U}return B}async loadSnapshot(S){try{const O=await this.loadSnapshotScene(S);this.setState({dashboard:O,isLoading:!1})}catch(O){this.setState({isLoading:!1,loadError:String(O)})}}async loadSnapshotScene(S){const O=await i.np.loadDashboard("snapshot",S,"");if(O?.dashboard)return(0,f.wM)(O);throw new Error("Snapshot not found")}async loadDashboard(S){try{(0,l.j)(g);const O=await this.loadScene(S);if(!O)return;r.$.featureToggles.preserveDashboardStateWhenNavigating&&S.uid&&(0,P.Gq)(O),r.$.publicDashboardAccessToken&&O.state.controls?.state.hideTimeControls||O.startUrlSync(),this.setState({dashboard:O,isLoading:!1});const x=(0,l.z)(g);(0,p.D)(O,x?.duration)}catch(O){this.setState({isLoading:!1,loadError:String(O)})}}async loadScene(S){const O=!!(m.A.getObject(d.us)&&S.keepDashboardFromExploreInLocalStorage===!1);this.setState({isLoading:!0});const x=await this.fetchDashboard(S),b=this.cache[S.uid];if(!O&&b&&b.state.version===x?.dashboard.version)return b;if(x?.dashboard){const M=(0,f.wM)(x);return S.uid&&!O&&(this.cache[S.uid]=M),M}if(x?.redirectUri){const M=t.I.stripBaseFromUrl(x.redirectUri);return s.Ny.replace(M),null}throw new Error("Dashboard not found")}getFromCache(S){const O=this.dashboardCache;return O&&O.cacheKey===S&&Date.now()-O?.ts<E?O.dashboard:null}clearState(){(0,u.UA)().setCurrent(void 0),this.setState({dashboard:void 0,loadError:void 0,isLoading:!1,panelEditor:void 0})}setDashboardCache(S,O){this.dashboardCache={dashboard:O,ts:Date.now(),cacheKey:S}}clearDashboardCache(){this.dashboardCache=void 0}}let v=null;function C(){return v||(v=new D({})),v}},77431:(G,I,e)=>{"use strict";e.d(I,{Q:()=>o});var t=e(82467),n=e(27677),s=e(71101),r=e(99140);async function o(m){try{const l=await n.IB.getFolderByUid(m);r.M_.dispatch((0,t.Vz)((0,s.R4)(l)))}catch(l){console.warn("Error fetching parent folder",m,"for dashboard",l)}}},79280:(G,I,e)=>{"use strict";e.d(I,{p:()=>i});var t=e(96540),n=e(13544),s=e(90613),r=e(67061),o=e(94753),m=e(55852),l=e(8484);function i(u){return t.createElement(s.a,{alignItems:"center",padding:4},t.createElement(r.B,{direction:"column",alignItems:"center",gap:2},t.createElement(o.E,{element:"h3",textAlignment:"center"},t.createElement(l.x6,{key:"transformations.empty.add-transformation-header"},"Start transforming data")),t.createElement(o.E,{element:"p",textAlignment:"center","data-testid":n.Tp.components.Transforms.noTransformationsMessage},t.createElement(l.x6,{key:"transformations.empty.add-transformation-body"},"Transformations allow data to be changed in various ways before your visualization is shown.",t.createElement("br",null),"This includes joining data together, renaming fields, making calculations, formatting data for display, and more.")),t.createElement(m.$n,{icon:"plus",variant:"primary",size:"md",onClick:u.onShowPicker,"data-testid":n.Tp.components.Transforms.addTransformationButton},"Add transformation")))}},19293:(G,I,e)=>{"use strict";e.d(I,{i:()=>en,L:()=>En});var t=e(12131),n=e(32264),s=e(16401),r=e(41507),o=e(60656),m=e(74730),l=e(32196),i=e(96540),u=e(13544),d=e(40845),p=e(63021),c=e(40276),y=e(40980),f=e(66864),P=e(95689),a=e(42418),E=e(39558),g=e(40675),h=e(10096),D=e(80215),v=e(27747),C=e(75471),T=e(56361),S=e(24180),O=e(16817),x=e(76885),b=e(34867),M=e(55852),A=e(25027),R=e(63066);const B=({panel:yt,className:At})=>{const Kt=(0,S.zy)(),{loading:Jt,value:Mt}=(0,O.A)(()=>(0,R.J6)(yt),[yt]);if(Jt)return i.createElement(M.$n,{disabled:!0},"New alert rule");if(!Mt)return i.createElement(a.F,{severity:"info",title:"No alerting capable query found"},"Cannot create alerts from this panel because no query to an alerting capable datasource is found.");const Je=async()=>{(0,b.fH)(A.le.alertRuleFromPanel);const Nn=await(0,R.J6)(yt),xn=x.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(Nn),returnTo:Kt.pathname+Kt.search});t.Ny.push(xn)};return i.createElement(M.$n,{icon:"bell",onClick:Je,className:At,"data-testid":"create-alert-rule-button"},"New alert rule")};var U=(yt=>(yt.Queries="queries",yt.Transformations="transformations",yt.Alert="alert",yt))(U||{});class W extends s.Bs{constructor(At){super({}),this.tabId=U.Alert,this.TabComponent=Kt=>L({...Kt,model:this}),this._panelManager=At}static{this.Component=N}getTabLabel(){return"Alert"}getDashboardUID(){return this.getDashboard().state.uid}getDashboard(){return(0,m.YQ)(this._panelManager)}getLegacyPanelId(){return(0,m.Cs)(this._panelManager.state.panel)}getCanCreateRules(){const At=(0,C.Wd)("grafana");return this.getDashboard().state.meta.canSave&&h.TP.hasPermission(At.create)}get panelManager(){return this._panelManager}get panel(){return this._panelManager.state.panel}}function N(yt){const{model:At}=yt,Kt=(0,d.of)(w),{errors:Jt,loading:Mt,rules:Je}=(0,v.S)({dashboardUID:At.getDashboardUID(),panelId:At.getLegacyPanelId()}),Nn=Jt.length?i.createElement(a.F,{title:"Errors loading rules",severity:"error"},Jt.map((wn,Wn)=>i.createElement("div",{key:Wn},"Failed to load Grafana rules state: ",(0,T.JZ)(wn)))):null;if(Mt&&!Je.length)return i.createElement(i.Fragment,null,Nn,i.createElement(E._,{text:"Loading rules..."}));const{panel:xn}=At,Fn=At.getCanCreateRules();return Je.length?i.createElement(i.Fragment,null,i.createElement(D.s,{rules:Je}),Fn&&i.createElement(B,{className:Kt.newButton,panel:xn})):i.createElement("div",{className:Kt.noRulesWrapper},i.createElement("p",null,"There are no alert rules linked to this panel."),Fn&&i.createElement(B,{panel:xn}))}const w=yt=>({newButton:(0,l.css)({marginTop:yt.spacing(3)}),noRulesWrapper:(0,l.css)({margin:yt.spacing(2),backgroundColor:yt.colors.background.secondary,padding:yt.spacing(3)})});function L(yt){const{model:At}=yt,{rules:Kt}=(0,v.S)({dashboardUID:At.getDashboardUID(),panelId:At.getLegacyPanelId(),poll:!1});return i.createElement(g.o,{key:yt.key,label:At.getTabLabel(),icon:"bell",counter:Kt.length,active:yt.active,onChangeTab:yt.onChangeTab})}var V=e(41987),K=e(19347),k=e(67061),j=e(21969),H=e(53478),J=e(64152),X=e(44932),se=e(37464),ae=e(14348),ne=e(7928);class q extends s.Bs{constructor(At){super({}),this.tabId=U.Queries,this.icon="database",this.onOpenInspector=()=>{this._panelManager.inspectPanel()},this.onChangeDataSource=async(Kt,Jt)=>{this._panelManager.changePanelDataSource(Kt,Jt)},this.onQueryOptionsChange=Kt=>{this._panelManager.changeQueryOptions(Kt)},this.onQueriesChange=Kt=>{this._panelManager.changeQueries(Kt)},this.onRunQueries=()=>{this._panelManager.queryRunner.runQueries()},this.addQueryClick=()=>{const Kt=this.getQueries();this.onQueriesChange((0,j.U7)(Kt,this.newQuery()))},this.onAddQuery=Kt=>{const Jt=this.getQueries(),Mt=this._panelManager.state.dsSettings;this.onQueriesChange((0,j.U7)(Jt,Kt,{type:Mt?.type,uid:Mt?.uid}))},this.onAddExpressionClick=()=>{const Kt=this.getQueries();this.onQueriesChange((0,j.U7)(Kt,H.Ex.newQuery()))},this.TabComponent=Kt=>z({...Kt,model:this}),this._panelManager=At}static{this.Component=ee}getTabLabel(){return"Queries"}getItemsCount(){return this.getQueries().length}buildQueryOptions(){const At=this._panelManager,Kt=this._panelManager.state.panel,Jt=this._panelManager.queryRunner,Mt=s.jh.getTimeRange(Kt);let Je={from:void 0,shift:void 0,hide:void 0};Mt instanceof ne.v&&(Je={from:Mt.state.timeFrom,shift:Mt.state.timeShift,hide:Mt.state.hideTimeOverride});let Nn=Jt.state.queries;return{cacheTimeout:At.state.dsSettings?.meta.queryOptions?.cacheTimeout?Jt.state.cacheTimeout:void 0,queryCachingTTL:At.state.dsSettings?.cachingConfig?.enabled?Jt.state.queryCachingTTL:void 0,dataSource:{default:At.state.dsSettings?.isDefault,type:At.state.dsSettings?.type,uid:At.state.dsSettings?.uid},queries:Nn,maxDataPoints:Jt.state.maxDataPoints,minInterval:Jt.state.minInterval,timeRange:Je}}getQueries(){return this._panelManager.queryRunner.state.queries}newQuery(){const{dsSettings:At,datasource:Kt}=this._panelManager.state;let Jt;return At?.meta.mixed?Kt?.meta.mixed?Jt=(0,K.l)().getInstanceSettings(n.$.defaultDatasource):Jt=Kt:Jt=At,{...Kt?.getDefaultQuery?.(V.Jk.PanelEditor),datasource:{uid:Jt?.uid,type:Jt?.type}}}isExpressionsSupported(At){return(At.meta.alerting||At.meta.mixed)===!0}renderExtraActions(){return J.m.getAllExtraRenderAction().map((At,Kt)=>At({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:Kt})).filter(Boolean)}get queryRunner(){return this._panelManager.queryRunner}get panelManager(){return this._panelManager}}function ee({model:yt}){const{datasource:At,dsSettings:Kt}=yt.panelManager.useState(),{data:Jt,queries:Mt}=yt.panelManager.queryRunner.useState();if(!At||!Kt||!Jt)return null;const Je=!(0,ae.kN)(Kt.name);return i.createElement("div",{"data-testid":u.Tp.components.QueryTab.content},i.createElement(se.K,{data:Jt,dsSettings:Kt,dataSource:At,options:yt.buildQueryOptions(),onDataSourceChange:yt.onChangeDataSource,onOptionsChange:yt.onQueryOptionsChange,onOpenQueryInspector:yt.onOpenInspector}),i.createElement(X.L,{data:Jt,queries:Mt,dsSettings:Kt,onAddQuery:yt.onAddQuery,onQueriesChange:yt.onQueriesChange,onRunQueries:yt.onRunQueries}),i.createElement(k.B,{gap:2},Je&&i.createElement(M.$n,{icon:"plus",onClick:yt.addQueryClick,variant:"secondary","data-testid":u.Tp.components.QueryTab.addQuery},"Add query"),n.$.expressionsEnabled&&yt.isExpressionsSupported(Kt)&&i.createElement(M.$n,{icon:"plus",onClick:yt.onAddExpressionClick,variant:"secondary","data-testid":u.Tp.components.QueryTab.addExpression},i.createElement("span",null,"Expression\xA0")),yt.renderExtraActions()))}function z(yt){const{model:At}=yt,Kt=At.queryRunner.useState();return i.createElement(g.o,{key:yt.key,label:At.getTabLabel(),icon:"database",counter:Kt.queries.length,active:yt.active,onChangeTab:yt.onChangeTab})}var te=e(75494),ie=e(19727),ce=e(96374),ue=e(57650),fe=e(79280),Te=e(97497),he=e(29158),de=e(21427),le=e(66879);function pe(yt){const{isOpen:At,series:Kt,onClose:Jt,onTransformationAdd:Mt}=yt,[Je,Nn]=(0,i.useState)({search:"",showIllustrations:!0}),xn=_n=>Nn({...Je,search:_n.currentTarget.value}),Fn=_n=>Nn({...Je,showIllustrations:_n}),wn=_n=>Nn({...Je,selectedFilter:_n}),Wn=(0,i.useMemo)(()=>Te.h.list().sort((_n,Wa)=>_n.name>Wa.name?1:Wa.name>_n.name?-1:0),[]),da=Wn.filter(_n=>Je.selectedFilter&&Je.selectedFilter!==le.e&&!_n.categories?.has(Je.selectedFilter)?!1:_n.name.toLocaleLowerCase().includes(Je.search.toLocaleLowerCase())),oa=i.createElement(i.Fragment,null,da.length," / ",Wn.length," \xA0\xA0",i.createElement(he.K,{name:"times",onClick:()=>{Nn({...Je,search:""})},tooltip:"Clear search"}));if(At)return i.createElement(de.R,{data:Kt,onTransformationAdd:Mt,xforms:da,search:Je.search,noTransforms:!1,suffix:Je.search!==""?oa:i.createElement(i.Fragment,null),selectedFilter:Je.selectedFilter,onSearchChange:xn,onSearchKeyDown:()=>{},showIllustrations:Je.showIllustrations,onShowIllustrationsChange:Fn,onSelectedFilterChange:wn,onClose:Jt})}class ve extends s.Bs{constructor(At){super({}),this.tabId=U.Transformations,this.icon="process",this.TabComponent=Kt=>Ue({...Kt,model:this}),this._panelManager=At}static{this.Component=be}getTabLabel(){return"Transformations"}getQueryRunner(){return this._panelManager.queryRunner}getDataTransformer(){return this._panelManager.dataTransformer}onChangeTransformations(At){this._panelManager.changeTransformations(At)}get panelManager(){return this._panelManager}}function be({model:yt}){const At=(0,d.of)(Me),Kt=yt.getQueryRunner().useState(),{data:Jt,transformations:Mt}=yt.getDataTransformer().useState(),Je=Mt,[Nn,xn]=(0,i.useState)(!1),[Fn,wn]=(0,i.useState)(!1),Wn=()=>xn(!0),da=()=>xn(!1);if(!Jt||!Kt.data)return;const oa=i.createElement(pe,{onClose:da,onTransformationAdd:_n=>{_n.value!==void 0&&(yt.onChangeTransformations([...Je,{id:_n.value,options:{}}]),da())},isOpen:Nn,series:Jt.series});return Je.length<1?i.createElement(i.Fragment,null,i.createElement(fe.p,{onShowPicker:Wn}),oa):i.createElement(i.Fragment,null,i.createElement(Oe,{data:Kt.data,transformations:Je,model:yt}),i.createElement(ie.e,null,i.createElement(M.$n,{icon:"plus",variant:"secondary",onClick:Wn,"data-testid":u.Tp.components.Transforms.addTransformationButton},"Add another transformation"),i.createElement(M.$n,{"data-testid":u.Tp.components.Transforms.removeAllTransformationsButton,className:At.removeAll,icon:"times",variant:"secondary",onClick:()=>wn(!0)},"Delete all transformations")),i.createElement(ce.u,{isOpen:Fn,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>{yt.onChangeTransformations([]),wn(!1)},onDismiss:()=>wn(!1)}),oa)}function Oe({transformations:yt,model:At,data:Kt}){const Jt=yt.map((Je,Nn)=>({id:`${Nn} - ${Je.id}`,transformation:Je})),Mt=Je=>{if(!Je||!Je.destination)return;const Nn=Je.source.index,xn=Je.destination.index;if(Nn===xn)return;const Fn=Array.from(Jt),[wn]=Fn.splice(Nn,1);Fn.splice(xn,0,wn),At.onChangeTransformations(Fn.map(Wn=>Wn.transformation))};return i.createElement(te.JY,{onDragEnd:Mt},i.createElement(te.gL,{droppableId:"transformations-list",direction:"vertical"},Je=>i.createElement("div",{ref:Je.innerRef,...Je.droppableProps},i.createElement(ue.A,{onChange:(Nn,xn)=>{const Fn=yt.slice();Fn[Nn]=xn,At.onChangeTransformations(Fn)},onRemove:Nn=>{const xn=yt.slice();xn.splice(Nn,1),At.onChangeTransformations(xn)},configs:Jt,data:Kt}),Je.placeholder)))}const Me=yt=>({removeAll:(0,l.css)({marginLeft:yt.spacing(2)})});function Ue(yt){const{model:At}=yt,Kt=At.getDataTransformer().useState();return i.createElement(g.o,{key:yt.key,label:At.getTabLabel(),icon:"process",counter:Kt.transformations.length,active:yt.active,onChangeTab:yt.onChangeTab})}class we extends s.Bs{constructor(At){super({tab:U.Queries,tabs:[]}),this._urlSync=new s.So(this,{keys:["tab"]}),this._initialTabsBuilt=!1,this.onChangeTab=Kt=>{this.setState({tab:Kt.tabId})},this.panelManager=At,this.addActivationHandler(()=>this.onActivate())}static{this.Component=Re}getUrlState(){return{tab:this.state.tab}}updateFromUrl(At){At.tab&&typeof At.tab=="string"&&this.setState({tab:At.tab})}onActivate(){const At=this.panelManager.state.panel;return this.setupPanelSubscription(At),this.buildTabs(),this._subs.add(this.panelManager.subscribeToState((Kt,Jt)=>{Kt.panel!==Jt.panel&&(this.buildTabs(),this.setupPanelSubscription(Kt.panel))})),()=>{this.panelSubscription&&(this.panelSubscription.unsubscribe(),this.panelSubscription=void 0)}}setupPanelSubscription(At){this.panelSubscription&&(this._initialTabsBuilt=!1,this.panelSubscription.unsubscribe()),this.panelSubscription=At.subscribeToState(()=>{At.getPlugin()&&!this._initialTabsBuilt&&(this.buildTabs(),this._initialTabsBuilt=!0)})}buildTabs(){const Kt=this.panelManager.state.panel,Jt=this.panelManager.queryRunner,Mt=[];if(Kt){const Je=Kt.getPlugin();if(!Je)return;if(Je.meta.skipDataQuery){this.setState({tabs:Mt});return}else Jt&&Mt.push(new q(this.panelManager)),Mt.push(new ve(this.panelManager)),(0,P.e)(Je)&&Mt.push(new W(this.panelManager))}this.setState({tabs:Mt})}}function Re({model:yt}){const{tab:At,tabs:Kt}=yt.useState(),Jt=(0,d.of)(Fe);if(!Kt)return;const Mt=Kt.find(Je=>Je.tabId===At);return i.createElement("div",{className:Jt.dataPane,"data-testid":u.Tp.components.PanelEditor.DataPane.content},i.createElement(p.U,{hideBorder:!0,className:Jt.tabsBar},Kt.map((Je,Nn)=>i.createElement(Je.TabComponent,{key:`${Je.getTabLabel()}-${Nn}`,active:Je.tabId===At,onChangeTab:()=>yt.onChangeTab(Je)}))),i.createElement(c.E,{className:Jt.scroll},i.createElement(y.J,{className:Jt.tabContent},i.createElement(f.mc,null,Mt&&i.createElement(Mt.Component,{model:Mt})))))}function Fe(yt){return{dataPane:(0,l.css)({display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,height:"100%",width:"100%"}),tabContent:(0,l.css)({padding:yt.spacing(2),border:`1px solid ${yt.colors.border.weak}`,borderLeft:"none",borderBottom:"none",borderTopRightRadius:yt.shape.radius.default,flexGrow:1}),tabsBar:(0,l.css)({flexShrink:0,paddingLeft:yt.spacing(2)}),scroll:(0,l.css)({background:yt.colors.background.primary})}}var xe=e(27746),Ve=e(31807),$e=e(54174),Xe=e(40996),gt=e(37390),Dt=e(10354),nt=e(14578),at=e(57767),Ae=e(43535);const re=({libraryPanel:yt,isUnsavedPrompt:At,onDismiss:Kt,onConfirm:Jt,onDiscard:Mt})=>{const[Je,Nn]=(0,i.useState)(""),xn=(0,O.A)(async()=>{const _n=await(0,at.xV)(yt.state.uid);return _n.length>0?_n.map(Wa=>Wa.title):[]},[yt.state.uid]),[Fn,wn]=(0,i.useState)([]);(0,Xe.A)(()=>xn.value?wn(xn.value.filter(_n=>_n.toLowerCase().includes(Je.toLowerCase()))):wn([]),300,[xn.value,Je]);const Wn=(0,d.of)(Ae.o),da=(0,i.useCallback)(()=>{Mt()},[Mt]),oa=At?"Unsaved library panel changes":"Save library panel";return i.createElement(gt.a,{title:oa,icon:"save",onDismiss:Kt,isOpen:!0},i.createElement("div",null,i.createElement("p",{className:Wn.textInfo},"This update will affect ",i.createElement("strong",null,yt.state._loadedPanel?.meta?.connectedDashboards," ",yt.state._loadedPanel?.meta?.connectedDashboards===1?"dashboard":"dashboards","."),"The following dashboards using the panel will be affected:"),i.createElement(Dt.p,{className:Wn.dashboardSearch,prefix:i.createElement(nt.I,{name:"search"}),placeholder:"Search affected dashboards",value:Je,onChange:_n=>Nn(_n.currentTarget.value)}),xn.loading?i.createElement("p",null,"Loading connected dashboards..."):i.createElement("table",{className:Wn.myTable},i.createElement("thead",null,i.createElement("tr",null,i.createElement("th",null,"Dashboard name"))),i.createElement("tbody",null,Fn.map((_n,Wa)=>i.createElement("tr",{key:`dashrow-${Wa}`},i.createElement("td",null,_n))))),i.createElement(gt.a.ButtonRow,null,i.createElement(M.$n,{variant:"secondary",onClick:Kt,fill:"outline"},"Cancel"),At&&i.createElement(M.$n,{variant:"destructive",onClick:da},"Discard"),i.createElement(M.$n,{onClick:()=>{Jt()}},"Update all"))))};var Z=e(21633);function oe(yt){const{paneOptions:At}=yt,[Kt,Jt]=i.useState({collapsed:!1}),Mt=(0,i.useCallback)((da,oa)=>{if(da<=0&&oa<=0)return;const _n=oa/da*(1-da);Kt.collapsed&&_n>At.collapseBelowPixels&&Jt({collapsed:!1}),!Kt.collapsed&&_n<At.collapseBelowPixels&&Jt({collapsed:!0})},[Kt,At.collapseBelowPixels]),Je=(0,i.useCallback)((da,oa)=>{if(da<=0&&oa<=0)return;const _n=1-da,Wa=Kt.snapSize===0,za=oa/da,Xa=(At.snapOpenToPixels??za/2)/za;Kt.collapsed?Jt(Wa?{snapSize:Math.max(_n,Xa),collapsed:!1}:{snapSize:0,collapsed:!0}):Wa&&Jt({snapSize:_n,collapsed:!1})},[Kt,At.snapOpenToPixels]),Nn=(0,i.useCallback)(()=>{Jt({collapsed:!Kt.collapsed})},[Kt.collapsed]),{containerProps:xn,primaryProps:Fn,secondaryProps:wn,splitterProps:Wn}=(0,Z.h)({...yt,onResizing:Mt,onSizeChanged:Je});return wn.style.overflow="hidden",wn.style.minWidth="unset",wn.style.minHeight="unset",Kt.snapSize?(Fn.style={...Fn.style,flexGrow:1-Kt.snapSize},wn.style.flexGrow=Kt.snapSize):Kt.snapSize===0&&(Fn.style.flexGrow=1,wn.style.flexGrow=0,wn.style.minWidth="unset",wn.style.minHeight="unset",wn.style.overflow="unset"),{containerProps:xn,primaryProps:Fn,secondaryProps:wn,splitterProps:Wn,splitterState:Kt,onToggleCollapse:Nn}}function Ee({model:yt}){const At=(0,m.YQ)(yt),{optionsPane:Kt}=yt.useState(),Jt=(0,d.of)(Se),{containerProps:Mt,primaryProps:Je,secondaryProps:Nn,splitterProps:xn,splitterState:Fn,onToggleCollapse:wn}=oe({direction:"row",dragPosition:"end",initialSize:.75,paneOptions:{collapseBelowPixels:250,snapOpenToPixels:400}});return i.createElement(i.Fragment,null,i.createElement(Ve.c,{dashboard:At}),i.createElement("div",{...Mt,"data-testid":u.Tp.components.PanelEditor.General.content},i.createElement("div",{...Je,className:(0,l.cx)(Je.className,Jt.body)},i.createElement(ye,{model:yt})),i.createElement("div",{...xn}),i.createElement("div",{...Nn,className:(0,l.cx)(Nn.className,Jt.optionsPane)},Fn.collapsed&&i.createElement("div",{className:Jt.expandOptionsWrapper},i.createElement(xe.I,{tooltip:"Open options pane",icon:"arrow-to-right",onClick:wn,variant:"canvas",className:Jt.rotate180,"aria-label":"Open options pane"})),!Fn.collapsed&&i.createElement(Kt.Component,{model:Kt}))))}function ye({model:yt}){const At=(0,m.YQ)(yt),{vizManager:Kt,dataPane:Jt,showLibraryPanelSaveModal:Mt,showLibraryPanelUnlinkModal:Je}=yt.useState(),{sourcePanel:Nn}=Kt.useState(),xn=(0,m.Yr)(Nn.resolve()),{controls:Fn,scopes:wn}=At.useState(),Wn=(0,d.of)(Se),{containerProps:da,primaryProps:oa,secondaryProps:_n,splitterProps:Wa,splitterState:za,onToggleCollapse:_a}=oe({direction:"column",dragPosition:"start",initialSize:.5,paneOptions:{collapseBelowPixels:150}});return da.className=(0,l.cx)(da.className,Wn.container),Jt||(oa.style.flexGrow=1),i.createElement("div",{className:(0,l.cx)(Wn.pageContainer,Fn&&!wn&&Wn.pageContainerWithControls,wn&&Wn.pageContainerWithScopes)},wn&&i.createElement(wn.Component,{model:wn}),Fn&&i.createElement("div",{className:(0,l.cx)(Wn.controlsWrapper,wn&&Wn.controlsWrapperWithScopes)},i.createElement(Fn.Component,{model:Fn})),i.createElement("div",{...da},i.createElement("div",{...oa},i.createElement(Kt.Component,{model:Kt})),Mt&&xn&&i.createElement(re,{libraryPanel:xn,onDismiss:yt.onDismissLibraryPanelSaveModal,onConfirm:yt.onConfirmSaveLibraryPanel,onDiscard:yt.onDiscard}),Je&&xn&&i.createElement($e.l,{onDismiss:yt.onDismissUnlinkLibraryPanelModal,onConfirm:yt.onConfirmUnlinkLibraryPanel,isOpen:!0}),Jt&&i.createElement(i.Fragment,null,i.createElement("div",{...Wa}),i.createElement("div",{..._n},za.collapsed&&i.createElement("div",{className:Wn.expandDataPane},i.createElement(M.$n,{tooltip:"Open query pane",icon:"arrow-to-right",onClick:_a,variant:"secondary",size:"sm",className:Wn.openDataPaneButton,"aria-label":"Open query pane"})),!za.collapsed&&i.createElement(Jt.Component,{model:Jt})))))}function Se(yt){return{pageContainer:(0,l.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%"}),pageContainerWithControls:(0,l.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopes:(0,l.css)({gridTemplateAreas:`
        "scopes controls"
        "panels panels"`,gridTemplateColumns:`${yt.spacing(32)} 1fr`,gridTemplateRows:"auto 1fr"}),container:(0,l.css)({gridArea:"panels",height:"100%"}),canvasContent:(0,l.css)({label:"canvas-content",display:"flex",flexDirection:"column",flexBasis:"100%",flexGrow:1,minHeight:0,width:"100%"}),body:(0,l.css)({label:"body",flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}),optionsPane:(0,l.css)({flexDirection:"column",borderLeft:`1px solid ${yt.colors.border.weak}`,background:yt.colors.background.primary}),expandOptionsWrapper:(0,l.css)({display:"flex",flexDirection:"column",padding:yt.spacing(2,1)}),expandDataPane:(0,l.css)({display:"flex",flexDirection:"row",padding:yt.spacing(1),borderTop:`1px solid ${yt.colors.border.weak}`,borderRight:`1px solid ${yt.colors.border.weak}`,background:yt.colors.background.primary,flexGrow:1,justifyContent:"space-around"}),rotate180:(0,l.css)({rotate:"180deg"}),controlsWrapper:(0,l.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:yt.spacing(2,0,2,2)}),controlsWrapperWithScopes:(0,l.css)({padding:yt.spacing(2,0)}),openDataPaneButton:(0,l.css)({width:yt.spacing(8),justifyContent:"center",svg:{rotate:"-90deg"}})}}var Be=e(67647),We=e(26443),Ke=e(41394),it=e(17706),rt=e(22290),ft=e(66211),pt=e(15292),Ge=e(94354),qe=e(21594),bt=e(64919),Ft=e(21744),Xt=e(20214),Lt=e(74410),Qt=e(48192),an=e(74097),gn=e(92378),ut=e(6923),Nt=e(20455),ht=e(32023);function Rt(yt,At,Kt){const Jt=new Qt.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),Mt=ht.b4.getPanelLinks(At),Je=Mt?.state.rawLinks??[],Nn=(0,m.YQ)(At);return Jt.addItem(new an.v({title:"Title",value:At.state.title,popularRank:1,render:function(){return i.createElement(on,{vizManager:yt})},addon:n.$.featureToggles.dashgpt&&i.createElement(Lt.h,{onGenerate:xn=>yt.setPanelTitle(xn),panel:(0,Nt.Z6)(At),dashboard:(0,Nt.Uy)(Nn)})})).addItem(new an.v({title:"Description",value:At.state.description,render:function(){return i.createElement(ln,{panel:At})},addon:n.$.featureToggles.dashgpt&&i.createElement(Xt.t,{onGenerate:xn=>At.setState({description:xn}),panel:(0,Nt.Z6)(At)})})).addItem(new an.v({title:"Transparent background",render:function(){return i.createElement(pt.d,{value:At.state.displayMode==="transparent",id:"transparent-background",onChange:()=>{At.setState({displayMode:At.state.displayMode==="transparent"?"default":"transparent"})}})}})).addCategory(new Qt.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:Je?.length}).addItem(new an.v({title:"Panel links",render:()=>i.createElement(_t,{panelLinks:Mt??void 0})}))).addCategory(new Qt.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new an.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return i.createElement(gn.U,{id:"repeat-by-variable-select",parent:At,repeat:Kt,onChange:Fn=>{const wn={repeat:Fn};Fn&&!yt.state.repeatDirection&&(wn.repeatDirection="h"),yt.setState(wn)}})}})).addItem(new an.v({title:"Repeat direction",showIf:()=>!!yt.state.repeat,render:function(){const Fn=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return i.createElement(Ge.z,{options:Fn,value:yt.state.repeatDirection??"h",onChange:wn=>yt.setState({repeatDirection:wn})})}})).addItem(new an.v({title:"Max per row",showIf:()=>!!(yt.state.repeat&&yt.state.repeatDirection==="h"),render:function(){const Fn=[2,3,4,6,8,12].map(wn=>({label:wn.toString(),value:wn}));return i.createElement(qe.l6,{options:Fn,value:yt.state.maxPerRow,onChange:wn=>yt.setState({maxPerRow:wn.value})})}})))}function _t({panelLinks:yt}){const{rawLinks:At}=yt?yt.useState():{rawLinks:[]};return i.createElement(bt.e,{links:At,onChange:Kt=>yt?.setState({rawLinks:Kt}),getSuggestions:ut.Fq,data:[]})}function on({vizManager:yt}){const{title:At}=yt.state.panel.useState();return i.createElement(Dt.p,{"data-testid":"panel-edit-panel-title-input",value:At,onChange:Kt=>yt.setPanelTitle(Kt.currentTarget.value)})}function ln({panel:yt}){const{description:At}=yt.useState();return i.createElement(Ft.f,{id:"description-text-area",value:At,onChange:Kt=>yt.setState({description:Kt.currentTarget.value})})}const bn=i.memo(({vizManager:yt,searchQuery:At,listMode:Kt,data:Jt})=>{const{panel:Mt,sourcePanel:Je,repeat:Nn}=yt.useState(),xn=Je.resolve().parent,{options:Fn,fieldConfig:wn,_pluginInstanceState:Wn}=Mt.useState(),da=(0,i.useMemo)(()=>Rt(yt,Mt,Nn),[yt,Mt,Nn]),oa=(0,i.useMemo)(()=>{const Xa=Mt.getPlugin();if(Xa)return(0,ft.Z4)({panel:Mt,data:Jt,plugin:Xa,eventBus:Mt.getPanelContext().eventBus,instanceState:Wn})},[Mt,Fn,wn,Wn]),_n=(0,i.useMemo)(()=>{if(xn instanceof o.F)return(0,ft.tN)(xn)},[xn]),Wa=(0,i.useMemo)(()=>(0,rt.v)(wn,Mt.getPlugin()?.fieldConfigRegistry,Jt?.series??[],At,Xa=>{Mt.setState({fieldConfig:Xa})}),[At,Mt,wn]),za=At.length>0,_a=[];if(za)_a.push((0,We.Po)([da,..._n?[_n]:[],...oa??[]],Wa,At));else switch(Kt){case We.gs.All:_n&&_a.push(_n.render()),_a.push(da.render());for(const Xa of oa??[])_a.push(Xa.render());for(const Xa of Wa)_a.push(Xa.render());break;case We.gs.Overrides:for(const Xa of Wa)_a.push(Xa.render());default:break}return _a});bn.displayName="PanelOptions";var In=e(78685),Mn=e(88575),vt=e(15054),nn=e(32696),cn=e(56707),mt=e(86292),lt=e(53543);function Tt({vizManager:yt,data:At,onChange:Kt}){const{panel:Jt}=yt.useState(),Mt=(0,d.of)(Vt),[Je,Nn]=(0,i.useState)(""),xn=!1,Fn=xn?vt.MM:vt.wV,wn=xn?nn.__.Widgets:nn.__.Visualizations,Wn=(0,i.useMemo)(()=>new lt.R(Jt),[Jt]),da=(0,i.useMemo)(()=>new Set([nn.__.Widgets,nn.__.Visualizations,nn.__.Suggestions]),[]),[oa,_n]=(0,In.A)(Fn,wn);(0,i.useEffect)(()=>{oa&&!da.has(oa)&&_n(wn)},[wn,oa,_n,da]);const Wa=[{label:"Visualizations",value:nn.__.Visualizations},{label:"Suggestions",value:nn.__.Suggestions}],za=_a=>{yt.changePluginType(_a.pluginId),Kt()};return i.createElement("div",{className:Mt.wrapper},i.createElement(Be.Z,{className:Mt.filter,value:Je,onChange:Nn,autoFocus:!0,placeholder:"Search for..."}),i.createElement(Mn.D,{className:Mt.customFieldMargin},i.createElement(Ge.z,{options:Wa,value:oa,onChange:_n,fullWidth:!0})),i.createElement(c.E,null,oa===nn.__.Visualizations&&i.createElement(mt.G,{pluginId:Jt.state.pluginId,searchQuery:Je,onChange:za}),oa===nn.__.Suggestions&&i.createElement(cn.a,{onChange:za,searchQuery:Je,panel:Wn,data:At})))}const Vt=yt=>({wrapper:(0,l.css)({display:"flex",flexDirection:"column",flexGrow:1,padding:yt.spacing(2,1),height:"100%",gap:yt.spacing(2),border:`1px solid ${yt.colors.border.weak}`,borderRight:"none",borderBottom:"none",borderTopLeftRadius:yt.shape.radius.default}),customFieldMargin:(0,l.css)({marginBottom:yt.spacing(1)}),filter:(0,l.css)({minHeight:yt.spacing(4)})});class zt extends s.Bs{constructor(At){super({searchQuery:"",listMode:We.gs.All,...At}),this.onToggleVizPicker=()=>{this.setState({isVizPickerOpen:!this.state.isVizPickerOpen})},this.onSetSearchQuery=Kt=>{this.setState({searchQuery:Kt})},this.onSetListMode=Kt=>{this.setState({listMode:Kt})}}static{this.Component=({model:At})=>{const{isVizPickerOpen:Kt,searchQuery:Jt,listMode:Mt}=At.useState(),Je=s.jh.getAncestor(At,en).state.vizManager,{pluginId:Nn}=Je.state.panel.useState(),{data:xn}=s.jh.getData(Je.state.panel).useState(),Fn=(0,d.of)(rn);return i.createElement(i.Fragment,null,!Kt&&i.createElement(i.Fragment,null,i.createElement("div",{className:Fn.top},i.createElement(mn,{pluginId:Nn,onOpen:At.onToggleVizPicker}),i.createElement(Be.Z,{className:Fn.searchOptions,value:Jt,placeholder:"Search options",onChange:At.onSetSearchQuery})),i.createElement("div",{className:Fn.listOfOptions},i.createElement(bn,{vizManager:Je,searchQuery:Jt,listMode:Mt,data:xn}))),Kt&&i.createElement(Tt,{vizManager:Je,onChange:At.onToggleVizPicker,data:xn}))}}}function rn(yt){return{top:(0,l.css)({display:"flex",flexDirection:"column",padding:yt.spacing(2,1),gap:yt.spacing(2)}),listOfOptions:(0,l.css)({display:"flex",flexDirection:"column",flexGrow:"1",overflow:"auto"}),searchOptions:(0,l.css)({minHeight:yt.spacing(4)}),searchWrapper:(0,l.css)({padding:yt.spacing(2,2,2,0)}),vizField:(0,l.css)({marginBottom:yt.spacing(1)}),rotateIcon:(0,l.css)({rotate:"180deg"})}}function mn({pluginId:yt,onOpen:At}){const Kt=(0,d.of)(dt);let Jt=(0,i.useMemo)(()=>(0,it.A4)().filter(Mt=>Mt.id===yt)[0],[yt]);return Jt||(Jt=(0,Ke.$)(`Panel plugin not found (${yt})`,!0).meta),i.createElement(k.B,{gap:1},i.createElement(xe.I,{className:Kt.vizButton,tooltip:"Click to change visualization",imgSrc:Jt.info.logos.small,onClick:At,"data-testid":u.Tp.components.PanelEditor.toggleVizPicker,"aria-label":"Change Visualization",variant:"canvas",isOpen:!1,fullWidth:!0},Jt.name))}function dt(yt){return{vizButton:(0,l.css)({textAlign:"left"})}}var wt=e(89681);class en extends s.Bs{constructor(At){super(At),this._initialRepeatOptions={},this._discardChanges=!1,this.onDiscard=()=>{this._discardChanges=!0,t.Ny.partial({editPanel:null})},this.onSaveLibraryPanel=()=>{this.setState({showLibraryPanelSaveModal:!0})},this.onConfirmSaveLibraryPanel=()=>{this.state.vizManager.commitChanges(),t.Ny.partial({editPanel:null})},this.onDismissLibraryPanelSaveModal=()=>{this.setState({showLibraryPanelSaveModal:!1})},this.onUnlinkLibraryPanel=()=>{this.setState({showLibraryPanelUnlinkModal:!0})},this.onDismissUnlinkLibraryPanelModal=()=>{this.setState({showLibraryPanelUnlinkModal:!1})},this.onConfirmUnlinkLibraryPanel=()=>{this.state.vizManager.unlinkLibraryPanel(),this.setState({showLibraryPanelUnlinkModal:!1})};const{repeat:Kt,repeatDirection:Jt,maxPerRow:Mt}=At.vizManager.state;this._initialRepeatOptions={repeat:Kt,repeatDirection:Jt,maxPerRow:Mt},this.addActivationHandler(this._activationHandler.bind(this))}static{this.Component=Ee}_activationHandler(){const At=this.state.vizManager,Kt=At.state.panel;return this._subs.add(At.subscribeToState((Jt,Mt)=>{Jt.panel.state.pluginId!==Mt.panel.state.pluginId&&this._initDataPane(Jt.panel.state.pluginId)})),this._initDataPane(Kt.state.pluginId),()=>{this._discardChanges?this.state.isNewPanel&&(0,m.YQ)(this).removePanel(At.state.sourcePanel.resolve()):this.commitChanges()}}_initDataPane(At){const Kt=n.$.panels[At]?.skipDataQuery;Kt&&this.state.dataPane&&(t.Ny.partial({tab:null},!0),this.setState({dataPane:void 0})),!Kt&&!this.state.dataPane&&this.setState({dataPane:new we(this.state.vizManager)})}getUrlKey(){return this.state.panelId.toString()}getPageNav(At,Kt){return{text:"Edit panel",parentItem:(0,m.YQ)(this).getPageNav(At,Kt)}}commitChanges(){const At=(0,m.YQ)(this);At.state.isEditing||At.onEnterEditMode();const Mt=this.state.vizManager.state.sourcePanel.resolve().parent,Je=Mt instanceof o.F,Nn=Je?Mt.parent:Mt;if(!Je){if(!(Nn instanceof r.U)){console.error("Unsupported scene object type");return}this.commitChangesToSource(Nn)}}commitChangesToSource(At){let Kt=At.state.width??1,Jt=At.state.height;const Mt=this.state.vizManager,Je=this._initialRepeatOptions.repeatDirection==="h"&&Mt.state.repeatDirection==="v",Nn=this._initialRepeatOptions.repeatDirection==="v"&&Mt.state.repeatDirection==="h";Je?Kt=Math.floor(Kt/(At.state.maxPerRow??1)):Nn&&(Kt=24),At.setState({body:Mt.state.panel.clone(),repeatDirection:Mt.state.repeatDirection,variableName:Mt.state.repeat,maxPerRow:Mt.state.maxPerRow,width:Kt,height:Jt})}}function En(yt,At=!1){return new en({panelId:(0,m.Cs)(yt),optionsPane:new zt({}),vizManager:wt.j.createFor(yt),isNewPanel:At})}},89681:(G,I,e)=>{"use strict";e.d(I,{j:()=>S});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(581),m=e(19347),l=e(32264),i=e(12131),u=e(16401),d=e(40845),p=e(84423),c=e(36974),y=e(47311),f=e(57767),P=e(93117),a=e(13530),E=e(45429),g=e(41507),h=e(60656),D=e(7928),v=e(20455),C=e(74730),T=(x=>(x[x.Fill=0]="Fill",x[x.Fit=1]="Fit",x[x.Exact=2]="Exact",x))(T||{});class S extends u.Bs{constructor(b){super(b),this._cachedPluginOptions={},this._detectPanelModelChanges=(0,n.debounce)(()=>{const{hasChanges:M}=(0,E.yO)((0,v.Z6)(this.state.sourcePanel.resolve()),(0,v.Z6)(this.state.panel));this.setState({isDirty:M})},250),this._handleStateChange=M=>{a.l.isUpdatingPersistedState(M)&&this._detectPanelModelChanges()},this.addActivationHandler(()=>this._onActivate())}static createFor(b){let M={};const A=b.parent instanceof h.F?b.parent.parent:b.parent;if(!(A instanceof g.U))throw console.error("VizPanel is not a child of a dashboard grid item"),new Error("VizPanel is not a child of a dashboard grid item");const{variableName:R,repeatDirection:B,maxPerRow:U}=A.state;M={repeat:R,repeatDirection:B,maxPerRow:U};let W;return A.parent?.state.$variables&&(W=A.parent.state.$variables.clone()),new S({$variables:W,panel:b.clone(),sourcePanel:b.getRef(),...M})}_onActivate(){this.loadDataSource();const b=this.subscribeToEvent(u.bZ,this._handleStateChange);return()=>{b.unsubscribe()}}async loadDataSource(){if(!this.state.panel.state.$data)return;let M=this.queryRunner.state.datasource;try{let A,R;if(M)A=await(0,m.l)().get(M),R=(0,m.l)().getInstanceSettings(M);else{const U=(0,C.YQ)(this).state.uid??"",W=(0,c.CW)(U);W?.datasourceUid!==null&&(R=(0,m.l)().getInstanceSettings({uid:W?.datasourceUid}),R&&(A=await(0,m.l)().get({uid:W?.datasourceUid,type:R.type}),this.queryRunner.setState({datasource:{uid:W?.datasourceUid,type:R.type}})))}A&&R&&(this.setState({datasource:A,dsSettings:R}),(0,y.tw)({type:R.type,uid:R.uid}))}catch(A){const R=await(0,m.l)().get(l.$.defaultDatasource),B=(0,m.l)().getInstanceSettings(l.$.defaultDatasource);R&&B&&(this.setState({datasource:R,dsSettings:B}),this.queryRunner.setState({datasource:{uid:B.uid,type:B.type}})),console.error(A)}}changePluginType(b){const{options:M,fieldConfig:A,pluginId:R,...B}=u.Go.cloneSceneObjectState(this.state.panel.state);let U={defaults:{...A.defaults,custom:{}},overrides:(0,o.aW)(A.overrides,o.nx)};this._cachedPluginOptions[R]={options:M,fieldConfig:A};const W=this._cachedPluginOptions[b]?.options,N=this._cachedPluginOptions[b]?.fieldConfig;N&&(U=(0,o.H9)(U,N));const w=new u.Eb({options:W??{},fieldConfig:U,pluginId:b,...B});if(!this.state.panel.state.$data&&!l.$.panels[b].skipDataQuery){let k=(0,c.CW)((0,C.YQ)(this).state.uid)?.datasourceUid;k||(k=l.$.defaultDatasource),w.setState({$data:new u.Es({$data:new u.dt({datasource:{uid:k},queries:[{refId:"A"}]}),transformations:[]})})}const L=w.getPlugin(),V={title:w.state.title,options:w.state.options,fieldConfig:w.state.fieldConfig,id:1,type:b},K=L?.onPanelTypeChanged?.(V,R,M,A);K&&w.onOptionsChange(K,!0),L?.onPanelMigration&&w.setState({pluginVersion:(0,p.Ar)(L)}),this.setState({panel:w}),this.loadDataSource()}async changePanelDataSource(b,M){const{dsSettings:A}=this.state,R=this.queryRunner,B=A?await(0,m.l)().get({uid:A.uid}):void 0,U=await(0,m.l)().get({uid:b.uid}),W=R.state.queries,N=M||await(0,P.y)(U,b.uid,W,B);R.setState({datasource:{type:b.type,uid:b.uid},queries:N}),M&&R.runQueries(),this.loadDataSource()}changeQueryOptions(b){const M=this.state.panel,A=this.queryRunner,R=M.state.$timeRange,B={},U={};b.maxDataPoints!==A.state.maxDataPoints&&(B.maxDataPoints=b.maxDataPoints??void 0),b.minInterval!==A.state.minInterval&&b.minInterval!==null&&(B.minInterval=b.minInterval),b.timeRange&&(U.timeFrom=b.timeRange.from??void 0,U.timeShift=b.timeRange.shift??void 0,U.hideTimeOverride=b.timeRange.hide),R instanceof D.v?U.timeFrom!==void 0||U.timeShift!==void 0?R.setState(U):M.setState({$timeRange:void 0}):M.setState({$timeRange:new D.v(U)}),b.cacheTimeout!==A?.state.cacheTimeout&&(B.cacheTimeout=b.cacheTimeout),b.queryCachingTTL!==A?.state.queryCachingTTL&&(B.queryCachingTTL=b.queryCachingTTL),A.setState(B),A.runQueries()}changeQueries(b){this.queryRunner.setState({queries:b})}changeTransformations(b){const M=this.dataTransformer;M.setState({transformations:b}),M.reprocessTransformations()}inspectPanel(){const b=this.state.panel,M=(0,C.Cs)(b);i.Ny.partial({inspect:M,inspectTab:"query"})}get queryRunner(){const b=(0,C.un)(this.state.panel);if(!b)throw new Error("Query runner not found");return b}get dataTransformer(){const b=this.state.panel.state.$data;if(!b||!(b instanceof u.Es))throw new Error("Could not find SceneDataTransformer for panel");return b}toggleTableView(){if(this.state.tableView){this.setState({tableView:void 0});return}this.setState({tableView:u.d0.table().setTitle("").setOption("showTypeIcons",!0).setOption("showHeader",!0).setData(this.dataTransformer).build()})}unlinkLibraryPanel(){const b=this.state.sourcePanel.resolve();if(!(b.parent instanceof h.F))throw new Error("VizPanel is not a child of a library panel");const M=b.parent.parent;if(!(M instanceof g.U))throw new Error("Library panel not a child of a grid item");const A=this.state.panel.clone({$data:this.state.$data?.clone()});M.setState({body:A}),this.setState({sourcePanel:A.getRef()})}commitChanges(){const b=this.state.sourcePanel.resolve();this.commitChangesTo(b)}commitChangesTo(b){const M={variableName:this.state.repeat,repeatDirection:this.state.repeatDirection,maxPerRow:this.state.maxPerRow};if(b.parent instanceof g.U&&b.parent.setState({...M,body:this.state.panel.clone()}),b.parent instanceof h.F&&b.parent.parent instanceof g.U){const A=b.parent.clone({panel:this.state.panel.clone()});b.parent.parent.setState({body:A,...M}),(0,f.GX)(A).then(R=>{b.parent instanceof h.F&&A.setPanelFromLibPanel(R)})}}getPanelSaveModel(){const b=this.state.sourcePanel.resolve(),A=b.parent instanceof h.F?b.parent.parent:b.parent;if(!(A instanceof g.U))return{error:"Unsupported panel parent"};const R=A.clone({body:this.state.panel.clone()});return(0,v.ZB)(R)}setPanelTitle(b){this.state.panel.setState({title:b,hoverHeader:b===""})}static{this.Component=({model:b})=>{const{panel:M,tableView:A}=b.useState(),R=(0,d.of)(O),B=A??M,U=B.state.$data;return(0,r.useEffect)(()=>U?.activate(),[U]),r.createElement(r.Fragment,null,r.createElement("div",{className:R.wrapper},r.createElement(B.Component,{model:B})))}}}function O(x){return{wrapper:(0,t.css)({height:"100%",width:"100%",paddingLeft:x.spacing(2)})}}},13530:(G,I,e)=>{"use strict";e.d(I,{l:()=>f});var t=e(16401),n=e(67278);const s=()=>new n.c(new URL(e.p+e.u(9666),e.b));var r=e(89681),o=e(38477),m=e(33278),l=e(41507),i=e(24283),u=e(60656),d=e(42397),p=e(7928),c=e(20455),y=e(17663);class f{constructor(a){this._dashboard=a}static isUpdatingPersistedState({payload:a}){return Object.keys(a.partialUpdate).length===0?!1:!!(a.changedObject instanceof t.Eb||a.changedObject instanceof l.U||a.changedObject instanceof p.v||a.changedObject instanceof r.j&&(Object.prototype.hasOwnProperty.call(a.partialUpdate,"repeat")||Object.prototype.hasOwnProperty.call(a.partialUpdate,"repeatDirection")||Object.prototype.hasOwnProperty.call(a.partialUpdate,"maxPerRow"))||a.changedObject instanceof t.dt&&!Object.prototype.hasOwnProperty.call(a.partialUpdate,"data")||a.changedObject instanceof t.Es&&!Object.prototype.hasOwnProperty.call(a.partialUpdate,"data")||a.changedObject instanceof d.$||a.changedObject instanceof u.F&&Object.prototype.hasOwnProperty.call(a.partialUpdate,"name")||a.changedObject instanceof t.WM&&(Object.prototype.hasOwnProperty.call(a.partialUpdate,"intervals")||Object.prototype.hasOwnProperty.call(a.partialUpdate,"refresh"))||a.changedObject instanceof t.Gg.K2||a.changedObject instanceof t.kh||a.changedObject instanceof l.U||a.changedObject instanceof t.hy||a.changedObject instanceof i.H$&&Object.keys(a.partialUpdate).some(E=>i.vk.includes(E))||a.changedObject instanceof t.JZ||a.changedObject instanceof m.x&&Object.prototype.hasOwnProperty.call(a.partialUpdate,"hideTimeControls")||a.changedObject instanceof t.Pj||a.changedObject instanceof o.g&&!Object.prototype.hasOwnProperty.call(a.partialUpdate,"data")||a.changedObject instanceof t.Gg.en||(0,y.c7)(a.changedObject))}onStateChanged(a){f.isUpdatingPersistedState(a)&&this.detectSaveModelChanges()}detectSaveModelChanges(){this._changesWorker?.postMessage({changed:(0,c.Uy)(this._dashboard),initial:this._dashboard.getInitialSaveModel()})}hasMetadataChanges(){return this._dashboard.state.meta.folderUid!==this._dashboard.getInitialState()?.meta.folderUid}updateIsDirty(a){const{hasChanges:E}=a;E||this.hasMetadataChanges()?this._dashboard.state.isDirty||this._dashboard.setState({isDirty:!0}):this._dashboard.state.isDirty&&this._dashboard.setState({isDirty:!1})}init(){this._changesWorker=s()}startTrackingChanges(){this._changesWorker||this.init(),this._changesWorker.onmessage=a=>{this.updateIsDirty(a.data)},this._changeTrackerSub=this._dashboard.subscribeToEvent(t.bZ,this.onStateChanged.bind(this))}stopTrackingChanges(){this._changeTrackerSub?.unsubscribe()}terminate(){this.stopTrackingChanges(),this._changesWorker?.terminate()}}},45429:(G,I,e)=>{"use strict";e.d(I,{Yy:()=>o,yO:()=>u});var t=e(56596);function n(d,p){try{let c=d;for(const y of p)c=c[y];return c}catch{return}}function s(d,p){return typeof d==typeof p&&(typeof d=="string"&&d===p||Array.isArray(d)&&d.length===p.length&&d.every((c,y)=>c===p[y]))}function r(d,p){return d===p||d&&p&&d.selected===p.selected&&s(d.text,p.text)&&s(d.value,p.value)}function o(d,p,c,y,f){const P=d,a=p,E=m(a,P),g=i(a,P,y),h=a.refresh!==P.refresh;c||(a.time=P.time),f||(a.refresh=P.refresh);const D=(0,t.G4)(P,a),v=Object.values(D).reduce((C,T)=>C+T.length,0);return{changedSaveModel:a,initialSaveModel:P,diffs:D,diffCount:v,hasChanges:v>0,hasTimeChanges:E,isNew:a.version===0,hasVariableValueChanges:g,hasRefreshChange:h}}function m(d,p){return d.time?.from!==p.time?.from||d.time?.to!==p.time?.to}function l(d,p){if(d.filters===void 0||p.filters===void 0)throw new Error("AdHoc variable missing filter property");if(d.filters.length!==p.filters.length)return!1;for(let c=0;c<d.filters.length;c++){const y=d.filters[c],f=p.filters[c];if(y.key!==f.key||y.operator!==f.operator||y.value!==f.value)return!1}return!0}function i(d,p,c){const y=p.templating?.list??[],f=d.templating?.list??[];let P=!1;for(const a of f){const E=y.find(({name:g,type:h})=>g===a.name&&h===a.type);if(E&&(E.current&&delete E.current.selected,r(a.current,E.current)?a.type==="adhoc"&&!l(a,E)&&(P=!0):P=!0,!c)){const g=a;g.type==="adhoc"?g.filters=E.filters:(a.current=E.current,a.options=E.options)}}return P}function u(d,p){const c=(0,t.G4)(p,d),y=Object.values(c).reduce((f,P)=>f+P.length,0);return{changedSaveModel:d,initialSaveModel:p,diffs:c,diffCount:y,hasChanges:y>0}}},57109:(G,I,e)=>{"use strict";e.d(I,{o:()=>d});var t=e(96540),n=e(16401),s=e(87978),r=e(8484),o=e(16678),m=e(32023),l=e(74730),i=e(41507),u=e(60656);class d extends n.Bs{constructor(){super(...arguments),this.onClose=()=>{(0,l.YQ)(this).closeModal()},this.onAddLibraryPanel=c=>{const y=(0,l.YQ)(this),f=y.state.body;if(!(f instanceof n.hy))throw new Error("Trying to add a library panel in a layout that is not SceneGridLayout");const P=m.b4.getNextPanelId(y),a=new u.F({title:"Panel Title",uid:c.uid,name:c.name,panelKey:(0,l.XA)(P)}),E=this.state.panelToReplaceRef?.resolve();if(E){const g=E.parent;if(!(g instanceof i.U))throw new Error("Trying to replace a panel that does not have a DashboardGridItem");g.setState({body:a})}else{const g=new i.U({height:l.sw,width:l.vm,x:0,y:0,body:a,key:`grid-item-${P}`});f.setState({children:[g,...f.state.children]})}this.onClose()}}static{this.Component=({model:c})=>{const y=(0,r.t)("library-panel.add-widget.title","Add panel from panel library");return t.createElement(s._,{title:y,onClose:c.onClose},t.createElement(o.j,{onClick:c.onAddLibraryPanel,variant:o.s.Tight,showPanelFilter:!0}))}}}},91309:(G,I,e)=>{"use strict";e.d(I,{C:()=>C,S:()=>T});var t=e(65474),n=e(81160),s=e(52622),r=e(43585),o=e(14236),m=e(39070),l=e(32264),i=e(16401),u=e(82467),d=e(3169),p=e(10096),c=e(94954),y=e(79938),f=e(49498),P=e(55740),a=e(57220),E=e(23662),g=e(99140),h=e(31678),D=e(94822),v=e(74730);class C extends i.VE{constructor(O){super({isEnabled:!0,...O,isHidden:!0}),this.hasAlertRules=!0,this.topic=s.QR.AlertStates,this.handleError=x=>{const b=(0,d.gi)("AlertStatesDataLayer",(0,c.q)(x));(0,g.JD)((0,u.dx)(b))}}onEnable(){const O=i.jh.getTimeRange(this);this._timeRangeSub=O.subscribeToState(()=>{this.runWithTimeRange(O)})}onDisable(){this._timeRangeSub?.unsubscribe()}runLayer(){const O=i.jh.getTimeRange(this);this.runWithTimeRange(O)}async runWithTimeRange(O){const x=(0,v.YQ)(this),{uid:b,id:M}=x.state;if(this.querySub&&this.querySub.unsubscribe(),!this.canWork(O))return;const A=async()=>{const U=await(0,g.JD)(y.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:a.hY,dashboardUid:b}));if(U.error)throw new Error("Unexpected alert rules response.");return U.data},B=(0,t.H)(A()).pipe((0,n.T)(U=>(0,f.Kw)(U))).pipe((0,n.T)(U=>{this.hasAlertRules=!1;const W={};return U.forEach(N=>N.rules.forEach(w=>{if((0,E.Z8)(w)&&w.annotations&&w.annotations[P.YH.panelID]){this.hasAlertRules=!0;const L=Number(w.annotations[P.YH.panelID]),V=T(w.state);W[L]?V===r.O.Alerting&&W[L].state!==r.O.Alerting?W[L].state=r.O.Alerting:V===r.O.Pending&&W[L].state!==r.O.Alerting&&W[L].state!==r.O.Pending&&(W[L].state=r.O.Pending):W[L]={state:V,id:Object.keys(W).length,panelId:L,dashboardId:M}}})),Object.values(W)}));this.querySub=B.subscribe({next:U=>{const W=(0,o.Vc)(U);this.publishResults({state:m.Gu.Done,series:[{...W,meta:{...W.meta,dataTopic:s.QR.AlertStates}}],timeRange:O.state.value})},error:U=>{this.handleError(U),this.publishResults({state:m.Gu.Error,series:[],errors:[{message:(0,c.q)(U)}],timeRange:O.state.value})}})}canWork(O){const x=(0,v.YQ)(this),{uid:b}=x.state;return!(!b||l.$.publicDashboardAccessToken||O.state.value.raw.to!=="now"||this.hasAlertRules===!1||!(p.TP.hasPermission(h.AccessControlAction.AlertingRuleRead)&&p.TP.hasPermission(h.AccessControlAction.AlertingRuleExternalRead)))}}function T(S){return S===D.cF.Firing?r.O.Alerting:S===D.cF.Pending?r.O.Pending:r.O.OK}},38477:(G,I,e)=>{"use strict";e.d(I,{g:()=>l});var t=e(43127),n=e(33948),s=e(52622),r=e(32264),o=e(16401),m=e(90569);class l extends o.tV.g{async resolveDataSource(u){return r.$.publicDashboardAccessToken?new m.X:super.resolveDataSource(u)}processEvents(u,d){if(r.$.publicDashboardAccessToken){const p={series:[],timeRange:(0,t.E2)(),state:d.state},c=(0,n.I)(d.events);return c.meta={...c.meta,dataTopic:s.QR.Annotations},p.annotations=[c],p}else return super.processEvents(u,d)}}},33278:(G,I,e)=>{"use strict";e.d(I,{x:()=>g});var t=e(32196),n=e(96540),s=e(13544),r=e(16401),o=e(40845),m=e(67061),l=e(90613),i=e(32264),u=e(15292);function d({panelEditor:v}){const C=v.state.vizManager,{panel:T,tableView:S}=C.useState(),O=i.$.panels[T.state.pluginId]?.skipDataQuery;return n.createElement(n.Fragment,null,!O&&n.createElement(u.K,{label:"Table view",showLabel:!0,id:"table-view",value:!!S,onClick:()=>C.toggleTableView(),"aria-label":"toggle-table-view","data-testid":s.Tp.components.PanelEditor.toggleTableView}))}var p=e(74730),c=e(80997),y=e(56034),f=e(52424),P=e(6923),a=e(4588);function E({links:v,uid:C}){return!v||!C?null:n.createElement(n.Fragment,null,v.map((T,S)=>{const O=(0,P.mQ)().getAnchorInfo(T),x=`${T.title}-$${S}`;if(T.type==="dashboards")return n.createElement(f.aK,{key:x,link:T,linkInfo:O,dashboardUID:C});const b=a.G[T.icon],M=n.createElement(f.Zx,{icon:b,href:(0,c.Jf)(O.href),target:T.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":s.Tp.components.DashboardLinks.link},O.title);return n.createElement("div",{key:x,"data-testid":s.Tp.components.DashboardLinks.container},T.tooltip?n.createElement(y.m,{content:O.tooltip},M):M)}))}class g extends r.Bs{constructor(C){super({variableControls:[],timePicker:C.timePicker??new r.KE({}),refreshPicker:C.refreshPicker??new r.WM({}),...C}),this._variableDependency=new r.Sh(this,{onAnyVariableChanged:this._onAnyVariableChanged.bind(this)})}static{this.Component=h}_onAnyVariableChanged(){(0,p.YQ)(this).state.links?.length>0&&this.forceRender()}}function h({model:v}){const{variableControls:C,refreshPicker:T,timePicker:S,hideTimeControls:O}=v.useState(),x=(0,p.YQ)(v),{links:b,meta:M,editPanel:A}=x.useState(),R=(0,o.of)(D),B=location.search.includes("scene-debugger");return n.createElement("div",{"data-testid":s.Tp.pages.Dashboard.Controls,className:(0,t.cx)(R.controls,M.isEmbedded&&R.embedded)},n.createElement(m.B,{grow:1,wrap:"wrap"},C.map(U=>n.createElement(U.Component,{model:U,key:U.state.key})),n.createElement(l.a,{grow:1}),!A&&n.createElement(E,{links:b,uid:x.state.uid}),A&&n.createElement(d,{panelEditor:A})),!O&&n.createElement(m.B,{justifyContent:"flex-end"},n.createElement(S.Component,{model:S}),n.createElement(T.Component,{model:T})),B&&n.createElement(r.or,{scene:v,key:"scene-debugger"}))}function D(v){return{controls:(0,t.css)({display:"flex",alignItems:"flex-start",flex:"100%",gap:v.spacing(1),flexDirection:"row",flexWrap:"nowrap",position:"sticky",top:0,background:v.colors.background.canvas,zIndex:v.zIndex.activePanel,width:"100%",marginLeft:"auto",[v.breakpoints.down("sm")]:{flexDirection:"column-reverse",alignItems:"stretch"}}),embedded:(0,t.css)({background:"unset",position:"unset"})}}},16279:(G,I,e)=>{"use strict";e.d(I,{s:()=>s});var t=e(96540),n=e(16401);class s extends n.ps{constructor(o){super({...o,name:o.name??"Data layers",annotationLayers:o.annotationLayers??[]}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){return this._subs.add(this.subscribeToState((o,m)=>{o.annotationLayers!==m.annotationLayers&&(this.querySub?.unsubscribe(),this.subscribeToAllLayers(this.getAllLayers()))})),this.subscribeToAllLayers(this.getAllLayers()),()=>{this.querySub?.unsubscribe()}}addAnnotationLayer(o){this.setState({annotationLayers:[...this.state.annotationLayers,o]})}getAllLayers(){const o=[...this.state.annotationLayers];return this.state.alertStatesLayer&&o.push(this.state.alertStatesLayer),o}static{this.Component=({model:o})=>{const{annotationLayers:m}=o.useState();return t.createElement(t.Fragment,null,m.map(l=>t.createElement(l.Component,{model:l,key:l.state.key})))}}}},39820:(G,I,e)=>{"use strict";e.d(I,{L:()=>o});var t=e(16401),n=e(14348),s=e(74730),r=e(60656);class o extends t.Bs{constructor(l){super(l),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){const l=this.parent;let i,u;if(!(l instanceof t.dt))throw new Error("DashboardDatasourceBehaviour must be attached to a SceneQueryRunner");if(l.state.datasource?.uid!==n.K)return;try{i=(0,s.YQ)(l)}catch{return}const d=l.state.queries.find(a=>a.panelId!==void 0);if(!d)return;const p=d.panelId,c=(0,s.XA)(p),y=(0,s.vL)(i,c);if(!(y instanceof t.Eb))return;const f=(0,s.un)(y);let P;if(f)this.prevRequestId&&this.prevRequestId!==f.state.data?.request?.requestId&&l.runQueries();else if(y.parent instanceof r.F)y.parent.isActive||(P=y.parent.activate()),u=y.parent.subscribeToState((a,E)=>{this.handleLibPanelStateUpdates(a,E,l)});else throw new Error("Could not find SceneQueryRunner for panel");return()=>{this.prevRequestId=f?.state.data?.request?.requestId,u&&u.unsubscribe(),P&&P()}}handleLibPanelStateUpdates(l,i,u){if(l.panel&&l.panel!==i.panel){if(!((0,s.un)(l.panel)instanceof t.dt))throw new Error("Could not find SceneQueryRunner for panel");u.runQueries()}}}},41507:(G,I,e)=>{"use strict";e.d(I,{U:()=>y});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(32264),m=e(16401),l=e(15054),i=e(74730),u=e(57109),d=e(60656),p=e(7196),c=e(30195);class y extends m.Bs{constructor(E){super(E),this._variableDependency=new m.Sh(this,{variableNames:this.state.variableName?[this.state.variableName]:[],onVariableUpdateCompleted:this._onVariableUpdateCompleted.bind(this)}),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){return this.state.variableName&&(this._subs.add(this.subscribeToState((E,g)=>this._handleGridResize(E,g))),this._performRepeat()),this._subs.add(this.subscribeToState((E,g)=>{E.body!==g.body&&E.body instanceof d.F&&this.setupLibraryPanelChangeSubscription(E.body)})),this.state.body instanceof d.F&&this.setupLibraryPanelChangeSubscription(this.state.body),()=>{this._libPanelSubscription?.unsubscribe(),this._libPanelSubscription=void 0}}setupLibraryPanelChangeSubscription(E){this._libPanelSubscription&&(this._libPanelSubscription.unsubscribe(),this._libPanelSubscription=void 0),this._libPanelSubscription=E.subscribeToState(g=>{g._loadedPanel?.model.repeat&&(this._variableDependency.setVariableNames([g._loadedPanel.model.repeat]),this.setState({variableName:g._loadedPanel.model.repeat,repeatDirection:g._loadedPanel.model.repeatDirection,maxPerRow:g._loadedPanel.model.maxPerRow}),this._performRepeat())})}_onVariableUpdateCompleted(){this.state.variableName&&this._performRepeat()}_handleGridResize(E,g){const h=this.state.repeatedPanels?.length??1,D={};if(E.height!==g.height){if(this.getRepeatDirection()==="v"){const v=Math.ceil(E.height/h);D.itemHeight=v}else{const v=Math.ceil(h/this.getMaxPerRow());D.itemHeight=Math.ceil(E.height/v)}D.itemHeight!==this.state.itemHeight&&this.setState(D)}}_performRepeat(){if(this.state.body instanceof u.o||!this.state.variableName||this._variableDependency.hasDependencyInLoadingState())return;const E=m.jh.lookupVariable(this.state.variableName,this)??new m.yP({name:"_____default_sys_repeat_var_____",options:[],value:"",text:"",query:"A"});if(!(E instanceof m.n8)){console.error("DashboardGridItem: Variable is not a MultiValueVariable");return}const{values:g,texts:h}=(0,i.a7)(E);if((0,n.isEqual)(this._prevRepeatValues,g))return;this._prevRepeatValues=g;const D=this.state.body instanceof d.F?this.state.body.state.panel:this.state.body,v=[];for(let b=0;b<g.length;b++){const M={$variables:new m.Pj({variables:[new m.xc({name:E.state.name,value:g[b],text:String(h[b])})]}),key:`${D.state.key}-clone-${b}`};b>0&&(M.menu=new m.Lw({$behaviors:[p.t0]}));const A=D.clone(M);v.push(A)}const C=this.getRepeatDirection(),T={repeatedPanels:v},S=this.state.itemHeight??10,O=this.state.height,x=this.getMaxPerRow();if(C==="h"){const b=Math.ceil(v.length/x);T.height=b*S}else T.height=v.length*S;if(this.setState(T),O!==this.state.height){const b=m.jh.getLayout(this);b instanceof m.hy&&b.forceRender()}this.publishEvent(new c.d({source:this}),!0)}getMaxPerRow(){return this.state.maxPerRow??4}getRepeatDirection(){return this.state.repeatDirection==="v"?"v":"h"}getClassName(){return this.state.variableName?"panel-repeater-grid-item":""}isRepeated(){return this.state.variableName!==void 0}static{this.Component=({model:E})=>{const{repeatedPanels:g,itemHeight:h,variableName:D,body:v}=E.useState(),C=g?.length??0,T=f(E.getRepeatDirection(),C,E.getMaxPerRow(),h??10);if(!D){if(v instanceof m.Eb)return r.createElement(v.Component,{model:v,key:v.state.key});if(v instanceof d.F)return r.createElement(v.Component,{model:v,key:v.state.key});if(v instanceof u.o)return r.createElement(v.Component,{model:v,key:v.state.key})}return g?r.createElement("div",{className:T},g.map(S=>r.createElement("div",{className:P,key:S.state.key},r.createElement(S.Component,{model:S,key:S.state.key})))):null}}}function f(a,E,g,h){return(0,r.useMemo)(()=>{const D=o.$.theme2,v=h*l.sD*E+(E-1)*l.dU;if(a==="h"){const C=Math.ceil(E/g),T=Math.min(E,g);return(0,t.css)({display:"grid",height:"100%",width:"100%",gridTemplateColumns:`repeat(${T}, 1fr)`,gridTemplateRows:`repeat(${C}, 1fr)`,gridColumnGap:D.spacing(1),gridRowGap:D.spacing(1),[D.breakpoints.down("md")]:{display:"flex",flexDirection:"column",height:v}})}return(0,t.css)({display:"flex",height:"100%",width:"100%",flexDirection:"column",gap:D.spacing(1),[D.breakpoints.down("md")]:{height:v}})},[a,E,g,h])}const P=(0,t.css)({display:"flex",flexGrow:1,position:"relative"})},24283:(G,I,e)=>{"use strict";e.d(I,{H$:()=>ma,vk:()=>Oa});var t=e(71733),n=e(26272),s=e(41987),r=e(32264),o=e(12131),m=e(16401),l=e(28138),i=e(15054),u=e(17422),d=e(33390),p=e(14792),c=e(34214),y=e(6473),f=e(11230),P=e(80484),a=e(28444),E=e(13530),g=e(96540),h=e(63021),D=e(40675),v=e(87978),C=e(54943),T=e(76459),S=e.n(T),O=e(49785),x=e(13544),b=e(55852),M=e(42418),A=e(67061),R=e(88575),B=e(10354),U=e(21744),W=e(15292),N=e(90613),w=e(60029),L=e(36607),V=e(71500),K=e(17172);function k(He){return(0,K.NF)(He)&&He.data&&He.data.status==="version-mismatch"}function j(He){return(0,K.NF)(He)&&He.data&&He.data.status==="name-exists"}function H(He){return(0,K.NF)(He)&&He.data&&He.data.status==="plugin-dashboard"}function J({cancelButton:He,saveButton:Ie}){return g.createElement(M.F,{title:"Name already exists",severity:"error"},g.createElement("p",null,"A dashboard with the same name in selected folder already exists. Would you still like to save this dashboard?"),g.createElement(N.a,{paddingTop:2},g.createElement(A.B,{alignItems:"center"},He,Ie(!0))))}function X({overwrite:He,isLoading:Ie,isValid:je,onSave:tt}){return g.createElement(b.$n,{disabled:!je||Ie,icon:Ie?"spinner":void 0,onClick:()=>tt(He),variant:He?"destructive":"primary","data-testid":x.Tp.components.Drawer.DashboardSaveDrawer.saveButton},Ie?"Saving...":He?"Save and overwrite":"Save")}var se=e(41053),ae=e(14110),ne=e(3169),q=e(91219),ee=e(55314),z=e(31678),te=e(36974);function ie(He=!1){const Ie=(0,z.useDispatch)(),je=(0,ne._2)(),[tt]=(0,ee.e8)(),[St,$t]=(0,se.A)(async(Yt,pn,Bn)=>{{const Cn=await tt({dashboard:pn,folderUid:Bn.folderUid,message:Bn.message,overwrite:Bn.overwrite,showErrorAlert:!1});if("error"in Cn)throw Cn.error;const Xn=Cn.data;Yt.saveCompleted(pn,Xn,Bn.folderUid),l.A.publish(new a.Eu),je.success("Dashboard saved"),(0,te.ko)(Xn.uid),He?(0,ae.rR)("grafana_dashboard_copied",{name:pn.title,url:Xn.url}):(0,ae.rR)(`grafana_dashboard_${Xn.uid?"saved":"created"}`,{name:pn.title,url:Xn.url});const na=o.Ny.getLocation(),va=t.I.stripBaseFromUrl(Xn.url);return va!==na.pathname&&setTimeout(()=>{Yt.stopUrlSync(),o.Ny.push({pathname:va,search:na.search}),Yt.startUrlSync()}),Yt.state.meta.isStarred&&Ie((0,q.TU)({id:Xn.uid,title:Yt.state.title,url:va})),Cn.data}},[Ie,je]);return{state:St,onSaveDashboard:$t}}function ce({dashboard:He,changeInfo:Ie}){const{changedSaveModel:je}=Ie,{register:tt,handleSubmit:St,setValue:$t,formState:Yt,getValues:pn,watch:Bn}=(0,O.mN)({mode:"onBlur",defaultValues:{title:Ie.isNew?je.title:`${je.title} Copy`,description:je.description??"",folder:{uid:He.state.meta.folderUid,title:He.state.meta.folderTitle},copyTags:!1}}),{errors:Cn,isValid:Xn,defaultValues:na}=Yt,va=Bn(),{state:ba,onSaveDashboard:fa}=ie(!1),Ga=async ta=>{const Zn=pn(),La=he(je,Zn,Ie.isNew);(await fa(He,La,{overwrite:ta,folderUid:Zn.folder.uid})).status==="success"&&He.closeModal()},Ta=g.createElement(b.$n,{variant:"secondary",onClick:()=>He.closeModal(),fill:"outline"},"Cancel"),Fa=ta=>g.createElement(X,{isValid:Xn,isLoading:ba.loading,onSave:Ga,overwrite:ta});function $n(ta){return j(ta)?g.createElement(J,{cancelButton:Ta,saveButton:Fa}):g.createElement(g.Fragment,null,ta&&g.createElement(M.F,{title:"Failed to save dashboard",severity:"error"},g.createElement("p",null,ta.message)),g.createElement(A.B,{alignItems:"center"},Ta,Fa(!1)))}return g.createElement("form",{onSubmit:St(()=>Ga(!1))},g.createElement(R.D,{label:g.createElement(ue,{dashboard:je,onChange:$t}),invalid:!!Cn.title,error:Cn.title?.message},g.createElement(B.p,{...tt("title",{required:"Required",validate:Te}),"aria-label":"Save dashboard title field","data-testid":x.Tp.components.Drawer.DashboardSaveDrawer.saveAsTitleInput,onChange:S()(async ta=>{$t("title",ta.target.value,{shouldValidate:!0})},400)})),g.createElement(R.D,{label:g.createElement(fe,{dashboard:je,onChange:$t}),invalid:!!Cn.description,error:Cn.description?.message},g.createElement(U.f,{...tt("description",{required:!1}),"aria-label":"Save dashboard description field",autoFocus:!0})),g.createElement(R.D,{label:"Folder"},g.createElement(L.d,{onChange:(ta,Zn)=>$t("folder",{uid:ta,title:Zn}),value:va.folder?.uid,initialTitle:na.folder.title,dashboardId:je.id??void 0,enableCreateNew:!0})),!Ie.isNew&&g.createElement(R.D,{label:"Copy tags"},g.createElement(W.d,{...tt("copyTags")})),g.createElement(N.a,{paddingTop:2},$n(ba.error)))}function ue(He){return g.createElement(A.B,{justifyContent:"space-between"},g.createElement(w.J,{htmlFor:"description"},"Title"))}function fe(He){return g.createElement(A.B,{justifyContent:"space-between"},g.createElement(w.J,{htmlFor:"description"},"Description"))}async function Te(He,Ie){if(He===Ie.folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await V.P.validateNewDashboardName(Ie.folder.uid??"general",He),!0}catch(je){return je instanceof Error?je.message:"Dashboard name is invalid"}}function he(He,Ie,je){return{...He,id:null,uid:"",title:Ie.title,description:Ie.description,tags:je||Ie.copyTags?He.tags:[]}}var de=e(10880);function le({dashboard:He,drawer:Ie,changeInfo:je}){const{changedSaveModel:tt,hasChanges:St}=je,{state:$t,onSaveDashboard:Yt}=ie(!1),[pn,Bn]=(0,g.useState)({folderUid:He.state.meta.folderUid}),Cn=async ba=>{(await Yt(He,tt,{...pn,overwrite:ba})).status==="success"&&(He.closeModal(),Ie.state.onSaveSuccess?.())},Xn=g.createElement(b.$n,{variant:"secondary",onClick:()=>He.closeModal(),fill:"outline"},"Cancel"),na=ba=>g.createElement(X,{isValid:St,isLoading:$t.loading,onSave:Cn,overwrite:ba});function va(ba){return k(ba)?g.createElement(M.F,{title:"Someone else has updated this dashboard",severity:"error"},g.createElement("p",null,"Would you still like to save this dashboard?"),g.createElement(N.a,{paddingTop:2},g.createElement(A.B,{alignItems:"center"},Xn,na(!0)))):j(ba)?g.createElement(J,{cancelButton:Xn,saveButton:na}):H(ba)?g.createElement(M.F,{title:"Plugin dashboard",severity:"error"},g.createElement("p",null,"Your changes will be lost when you update the plugin. Use ",g.createElement("strong",null,"Save As")," to create custom version."),g.createElement(N.a,{paddingTop:2},g.createElement(A.B,{alignItems:"center"},Xn,na(!0)))):g.createElement(g.Fragment,null,ba&&g.createElement(M.F,{title:"Failed to save dashboard",severity:"error"},g.createElement("p",null,ba.message)),g.createElement(A.B,{alignItems:"center"},Xn,na(!1),!St&&g.createElement("div",null,"No changes to save")))}return g.createElement(A.B,{gap:2,direction:"column"},g.createElement(pe,{drawer:Ie,changeInfo:je}),g.createElement(R.D,{label:"Message"},g.createElement(U.f,{"aria-label":"message",value:pn.message??"",onChange:ba=>{Bn({...pn,message:ba.currentTarget.value})},placeholder:"Add a note to describe your changes (optional).",autoFocus:!0,rows:5})),va($t.error))}function pe({drawer:He,changeInfo:Ie}){const{saveVariables:je=!1,saveTimeRange:tt=!1,saveRefresh:St=!1}=He.useState(),{hasTimeChanges:$t,hasVariableValueChanges:Yt,hasRefreshChange:pn}=Ie;return g.createElement(A.B,{direction:"column",alignItems:"flex-start"},$t&&g.createElement(de.S,{id:"save-timerange",checked:tt,onChange:He.onToggleSaveTimeRange,label:"Update default time range",description:"Will make current time range the new default","data-testid":x.Tp.pages.SaveDashboardModal.saveTimerange}),pn&&g.createElement(de.S,{id:"save-refresh",label:"Update default refresh value",description:"Will make the current refresh the new default",checked:St,onChange:He.onToggleSaveRefresh,"data-testid":x.Tp.pages.SaveDashboardModal.saveRefresh}),Yt&&g.createElement(de.S,{id:"save-variables",label:"Update default variable values",description:"Will make the current values the new default",checked:je,onChange:He.onToggleSaveVariables,"data-testid":x.Tp.pages.SaveDashboardModal.saveVariables}))}var ve=e(32196),be=e(4213),Oe=e.n(be),Me=e(70713),Ue=e(32372),we=e(10534);function Re({dashboard:He,drawer:Ie,changeInfo:je}){const tt=(0,g.useMemo)(()=>JSON.stringify(je.changedSaveModel,null,2),[je]),St=(0,g.useCallback)(()=>{const $t=new Blob([tt],{type:"application/json;charset=utf-8"});(0,be.saveAs)($t,je.changedSaveModel.title+"-"+new Date().getTime()+".json")},[je.changedSaveModel,tt]);return g.createElement("div",{className:Fe.container},g.createElement(A.B,{direction:"column",gap:2,grow:1},g.createElement("div",null,"This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",g.createElement("br",null),g.createElement("i",null,"See"," ",g.createElement("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer"},"documentation")," ","for more information about provisioning."),g.createElement("br",null)," ",g.createElement("br",null),g.createElement("strong",null,"File path: ")," ",He.state.meta.provisionedExternalId),g.createElement(pe,{drawer:Ie,changeInfo:je}),g.createElement("div",{className:Fe.json},g.createElement(Me.Ay,{disableWidth:!0},({height:$t})=>g.createElement(Ue.B,{width:"100%",height:$t,language:"json",showLineNumbers:!0,showMiniMap:tt.length>100,value:tt,readOnly:!0}))),g.createElement(N.a,{paddingTop:2},g.createElement(A.B,{gap:2},g.createElement(b.$n,{variant:"secondary",onClick:Ie.onClose,fill:"outline"},"Cancel"),g.createElement(we.b,{icon:"copy",getText:()=>tt},"Copy JSON to clipboard"),g.createElement(b.$n,{type:"submit",onClick:St},"Save JSON to file")))))}const Fe={container:(0,ve.css)({height:"100%",display:"flex"}),json:(0,ve.css)({flexGrow:1,maxHeight:"800px"})};var xe=e(20455),Ve=e(45429);function $e(He,Ie,je,tt){const St=(0,Ve.Yy)(He.getInitialSaveModel(),(0,xe.Uy)(He),Ie,je,tt),$t=He.getInitialState()?.meta.folderUid!==He.state.meta.folderUid;return{...St,hasFolderChanges:$t,hasChanges:St.hasChanges||$t}}class Xe extends m.Bs{constructor(){super(...arguments),this.onClose=()=>{this.state.dashboardRef.resolve().setState({overlay:void 0})},this.onToggleSaveTimeRange=()=>{this.setState({saveTimeRange:!this.state.saveTimeRange})},this.onToggleSaveVariables=()=>{this.setState({saveVariables:!this.state.saveVariables})},this.onToggleSaveRefresh=()=>{this.setState({saveRefresh:!this.state.saveRefresh})}}static{this.Component=({model:Ie})=>{const{showDiff:je,saveAsCopy:tt,saveTimeRange:St,saveVariables:$t,saveRefresh:Yt}=Ie.useState(),pn=$e(Ie.state.dashboardRef.resolve(),St,$t,Yt),{changedSaveModel:Bn,initialSaveModel:Cn,diffs:Xn,diffCount:na,hasFolderChanges:va}=pn,ba=na+(va?1:0),fa=Ie.state.dashboardRef.resolve(),{meta:Ga}=fa.useState(),{provisioned:Ta,folderTitle:Fa}=Ga,$n=g.createElement(h.U,null,g.createElement(D.o,{label:"Details",active:!je,onChangeTab:()=>Ie.setState({showDiff:!1})}),ba>0&&g.createElement(D.o,{label:"Changes",active:je,onChangeTab:()=>Ie.setState({showDiff:!0}),counter:ba}));let ta="Save dashboard";tt?ta="Save dashboard copy":Ta&&(ta="Provisioned dashboard");const Zn=()=>je?g.createElement(C.l,{diff:Xn,oldValue:Cn,newValue:Bn,hasFolderChanges:va,oldFolder:fa.getInitialState()?.meta.folderTitle,newFolder:Fa}):tt||pn.isNew?g.createElement(ce,{dashboard:fa,changeInfo:pn}):Ta?g.createElement(Re,{dashboard:fa,changeInfo:pn,drawer:Ie}):g.createElement(le,{dashboard:fa,changeInfo:pn,drawer:Ie});return g.createElement(v._,{title:ta,subtitle:fa.state.title,onClose:Ie.onClose,tabs:$n},Zn())}}}var gt=e(85445),Dt=e(57714),nt=e(64423),at=e(18226),Ae=e(94624),re=e(72724),Z=e(3591),oe=e(41507),Ee=e(13989),ye=e(53543),Se=e(74730);class Be{constructor(Ie){this._scene=Ie,this.events=new at.o,this._subs=new nt.yU;const je=m.jh.getTimeRange(Ie);this.formatDate=this.formatDate.bind(this),this._subs.add(je.subscribeToState((tt,St)=>{tt.value!==St.value&&this.events.publish(new Z.sR(tt.value))}))}get id(){return this._scene.state.id??null}get uid(){return this._scene.state.uid??null}get title(){return this._scene.state.title}get description(){return this._scene.state.description}get editable(){return this._scene.state.editable}get graphTooltip(){return this._getSyncMode()}get timepicker(){return{refresh_intervals:this._scene.state.controls.state.refreshPicker.state.intervals,hidden:this._scene.state.controls.state.hideTimeControls??!1}}get timezone(){return this.getTimezone()}get weekStart(){return m.jh.getTimeRange(this._scene).state.weekStart}get tags(){return this._scene.state.tags}get links(){return this._scene.state.links}get meta(){return this._scene.state.meta}get time(){const Ie=m.jh.getTimeRange(this._scene);return{from:Ie.state.from,to:Ie.state.to}}get panels(){return We(this._scene,je=>je instanceof m.Eb).map(je=>new ye.R(je))}get annotations(){const Ie={list:[]};return this._scene.state.$data instanceof m.kh&&(Ie.list=(0,Ee.O)(this._scene.state.$data.state.layers)),Ie}getTimezone(){return m.jh.getTimeRange(this._scene).getTimeZone()}sharedTooltipModeEnabled(){return this._getSyncMode()>0}sharedCrosshairModeOnly(){return this._getSyncMode()===1}_getSyncMode(){if(this._scene.state.$behaviors){for(const Ie of this._scene.state.$behaviors)if(Ie instanceof m.Gg.K2)return Ie.state.sync}return Ae.y.Off}otherPanelInFullscreen(Ie){return!1}formatDate(Ie,je){return(0,re.LE)(Ie,{format:je,timeZone:this.getTimezone()})}getPanelById(Ie){const je=(0,Se.vL)(this._scene,(0,Se.XA)(Ie));return je?new ye.R(je):null}removePanel(Ie){const je=(0,Se.vL)(this._scene,(0,Se.XA)(Ie.id));if(!je){console.error("Trying to remove a panel that was not found in scene",Ie);return}const tt=je.parent;if(!(tt instanceof oe.U)){console.error("Trying to remove a panel that is not wrapped in DashboardGridItem");return}const St=m.jh.getLayout(je);if(!(St instanceof m.hy)){console.error("Trying to remove a panel in a layout that is not SceneGridLayout ");return}if(St===tt.parent&&St.setState({children:St.state.children.filter($t=>$t!==tt)}),tt.parent instanceof m.tI){const $t=St.clone({children:St.state.children.filter(Yt=>Yt!==tt)});St.parent instanceof m.hy&&St.parent.setState({children:St.parent.state.children.map(Yt=>Yt===St?$t:Yt)})}}canEditAnnotations(Ie){return this._scene.canEditDashboard()?Ie?!!this._scene.state.meta.annotationsPermissions?.dashboard.canEdit:!!this._scene.state.meta.annotationsPermissions?.organization.canEdit:!1}panelInitialized(){}destroy(){this.events.removeAllListeners(),this._subs.unsubscribe()}hasUnsavedChanges(){return this._scene.state.isDirty}}function We(He,Ie){let je=[];return He.forEachChild(tt=>{Ie(tt)?je.push(tt):je=je.concat(We(tt,Ie))}),je}var Ke=e(32023);function it(He){let Ie=5381;for(let je=0;je<He.length;je++)Ie=Ie*33^He.charCodeAt(je);return Ie>>>0}var rt=e(11982),ft=e(57109),pt=e(24180),Ge=e(64388),qe=e(40845),bt=e(40276),Ft=e(67608),Xt=e(68064),Lt=e(31807);function Qt({model:He}){const{controls:Ie,overlay:je,editview:tt,editPanel:St,isEmpty:$t,scopes:Yt,meta:pn}=He.useState(),{isExpanded:Bn}=Yt?.useState()??{},Cn=(0,qe.of)(an),Xn=(0,pt.zy)(),na=(0,z.useSelector)($n=>$n.navIndex),va=He.getPageNav(Xn,na),ba=He.getBodyToRender(),fa=(0,u.tc)(na,"dashboards/browse"),Ga=!pn.url&&!pn.slug&&!pn.isNew&&!pn.isSnapshot;if(tt)return g.createElement(g.Fragment,null,g.createElement(tt.Component,{model:tt}),je&&g.createElement(je.Component,{model:je}));const Ta=g.createElement(Xt.A,{dashboard:He,canCreate:!!He.state.meta.canEdit}),Fa=g.createElement("div",{className:(0,ve.cx)(Cn.body)},g.createElement(ba.Component,{model:ba}));return g.createElement(Ft.Y,{navModel:fa,pageNav:va,layout:Ge.k.Custom},St&&g.createElement(St.Component,{model:St}),!St&&g.createElement("div",{className:(0,ve.cx)(Cn.pageContainer,Ie&&!Yt&&Cn.pageContainerWithControls,Yt&&Cn.pageContainerWithScopes,Yt&&Bn&&Cn.pageContainerWithScopesExpanded)},Yt&&g.createElement(Yt.Component,{model:Yt}),g.createElement(Lt.c,{dashboard:He}),!Ga&&Ie&&g.createElement("div",{className:(0,ve.cx)(Cn.controlsWrapper,Yt&&!Bn&&Cn.controlsWrapperWithScopes)},g.createElement(Ie.Component,{model:Ie})),g.createElement(bt.E,{divId:"page-scrollbar",autoHeightMin:"100%",className:Cn.scrollbarContainer,testId:x.Tp.pages.Dashboard.DashNav.scrollContainer},g.createElement("div",{className:(0,ve.cx)(Cn.canvasContent,Ga&&Cn.homePagePadding)},g.createElement(g.Fragment,null,$t&&Ta),Fa))),je&&g.createElement(je.Component,{model:je}))}function an(He){return{pageContainer:(0,ve.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%"}),pageContainerWithControls:(0,ve.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopes:(0,ve.css)({gridTemplateAreas:`
        "scopes controls"
        "panels panels"`,gridTemplateColumns:`${He.spacing(32)} 1fr`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopesExpanded:(0,ve.css)({gridTemplateAreas:`
        "scopes controls"
        "scopes panels"`}),scrollbarContainer:(0,ve.css)({gridArea:"panels"}),controlsWrapper:(0,ve.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:He.spacing(2)}),controlsWrapperWithScopes:(0,ve.css)({padding:He.spacing(2,2,2,0)}),homePagePadding:(0,ve.css)({padding:He.spacing(2,2)}),canvasContent:(0,ve.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:He.spacing(0,2),flexBasis:"100%",flexGrow:1}),body:(0,ve.css)({label:"body",flexGrow:1,display:"flex",gap:"8px",marginBottom:He.spacing(2)})}}var gn=e(65123),ut=e(54612),Nt=e(16560),ht=e(29678),Rt=e(14578),_t=e(62930),on=e(21594),ln=e(16233),bn=e(83195),In=e(2619),Mn=e(2543),vt=e(89667),nn=e(52622),cn=e(39070),mt=e(68706),lt=e(60656),Tt=e(41524);function Vt(He){const Ie=[];if(He?.series)for(const je of He.series)Ie.push((0,vt.Nw)(je));if(He?.annotations)for(const je of He.annotations){const tt=(0,vt.Nw)(je);tt.schema?.meta||(tt.schema.meta={}),tt.schema.meta.dataTopic=nn.QR.Annotations,Ie.push(tt)}return Ie}function zt(He,Ie){const je={panelType:He.state.pluginId,datasource:"??"},tt=r.$.buildInfo.versionString;let St=`| Key | Value |
|--|--|
| Panel | ${je.panelType} @ ${He.state.pluginVersion??tt} |
| Grafana | ${tt} // ${r.$.buildInfo.edition} |
`;return Ie&&(St+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+Ie+"\n```\n</details>"),St}async function rn(He,Ie,je){let tt;const St=He.parent instanceof lt.F,$t=St?He.parent.parent:He.parent;St?tt={...(0,xe.ZB)($t),...(0,xe.Z6)(He)}:tt=(0,xe.ZB)($t);const Yt=(0,Mn.cloneDeep)(en),pn={panelType:He.state.pluginId,datasource:"??"},Bn=(0,Se.un)(He);if(!Bn.state.data)return;const Cn=Bn.state.data,Xn=Bn?.state.datasource,na=(0,Tt.W)(Vt(Cn),Ie),va=r.$.buildInfo.versionString,ba=Bn.state.queries??[],fa=Cn.annotations?Cn.annotations.reduce((Ta,Fa)=>Fa.length+Ta,0):0,Ga=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${pn.panelType} @ ${tt.pluginVersion??va}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${ba.map(Ta=>{const Fa=Ta.datasource??Xn;return`${Ta.refId}[${Fa?.type}]`}).join(", ")}</td>
    </tr>
    ${mn(tt)}
    ${dt(Cn,na)}
    ${wt(Cn)}
    <tr>
      <th>Grafana</th>
      <td>${va} // ${r.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(Yt.panels[0]={...tt,...Yt.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:mt.nj.Snapshot,snapshot:na}]},delete Yt.panels[0].libraryPanel,tt.transformations?.length){const Ta=Yt.panels[Yt.panels.length-1];Ta.title=Ta.title+" (after transformations)";const Fa=(0,Mn.cloneDeep)(Ta);Fa.id=100,Fa.title="Data (before transformations)",Fa.gridPos.w=24,Fa.targets[0].withTransforms=!1,Yt.panels.push(Fa)}return fa>0&&Yt.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:nn.QR.Annotations,refId:"A"}]}),Yt.panels[1].options.content=Ga,Yt.panels[2].options.content=JSON.stringify(tt,null,2),Yt.title=`Debug: ${tt.title} // ${(0,re.LE)(new Date)}`,Yt.tags=["debug",`debug-${pn.panelType}`],Yt.time={from:je.from.toISOString(),to:je.to.toISOString()},Yt}function mn(He){return He.transformations?`<tr>
      <th>Transform</th>
      <td>${He.transformations.map(Ie=>Ie.id).join(", ")}</td>
  </tr>`:""}function dt(He,Ie){let je=He.series.length??0,tt=0,St=0;for(const $t of He.series)tt+=$t.fields.length,St+=$t.length;return`<tr><th>Data</th><td>${He.state!==cn.Gu.Done?He.state:""} ${je} frames, ${tt} fields, ${St} rows </td></tr>`}function wt(He){return He.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${He.annotations.reduce((Ie,je)=>je.length+Ie,0)}</td>
</tr>`:""}const en={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37};var En=(He=>(He[He.Support=0]="Support",He[He.Data=1]="Data",He))(En||{}),yt=(He=>(He[He.PanelSnapshot=0]="PanelSnapshot",He[He.GithubComment=1]="GithubComment",He))(yt||{});class At extends In.Q{constructor(Ie){super({panel:Ie,panelTitle:m.jh.interpolate(Ie,Ie.state.title,{},"text"),currentTab:0,showMessage:1,snapshotText:"",markdownText:"",randomize:{},snapshotUpdate:0,options:[{label:"GitHub comment",description:"Copy and paste this message into a GitHub issue or comment",value:1},{label:"Panel support snapshot",description:"Dashboard JSON used to help troubleshoot visualization issues",value:0}]}),this.onCurrentTabChange=je=>{this.setState({currentTab:je})},this.onShowMessageChange=je=>{this.setState({showMessage:je.value})},this.onGetMarkdownForClipboard=()=>{const{markdownText:je}=this.state,tt=Math.pow(1024,2)*1.5;return je.length>tt?(this.setState({error:{title:"Copy to clipboard failed",message:"Snapshot is too large, consider download and attaching a file instead"}}),""):je},this.onDownloadDashboard=()=>{const{snapshotText:je,panelTitle:tt}=this.state,St=new Blob([je],{type:"text/plain"}),$t=`debug-${tt}-${(0,re.LE)(new Date)}.json.txt`;Oe()(St,$t)},this.onSetSnapshotText=je=>{this.setState({snapshotText:je})},this.onToggleRandomize=je=>{const{randomize:tt}=this.state;this.setState({randomize:{...tt,[je]:!tt[je]}})}}async buildDebugDashboard(){const{panel:Ie,randomize:je,snapshotUpdate:tt}=this.state,St=await rn(Ie,je,m.jh.getTimeRange(Ie).state.value),$t=JSON.stringify(St,null,2),Yt=zt(Ie,$t),pn=(0,bn.cN)((0,bn.j_)("bytes")($t?.length??0));let Bn;if(St)try{Bn=(0,gt.wM)({dashboard:St,meta:{isEmbedded:!0}}).state.body}catch(Cn){console.log("Error creating scene:",Cn)}this.setState({snapshot:St,snapshotText:$t,markdownText:Yt,snapshotSize:pn,snapshotUpdate:tt+1,scene:Bn})}}function Kt({panel:He,onClose:Ie}){const je=(0,qe.of)(Jt),tt=(0,g.useMemo)(()=>new At(He),[He]),St=He.getPlugin(),{currentTab:$t,loading:Yt,error:pn,options:Bn,showMessage:Cn,snapshotSize:Xn,markdownText:na,snapshotText:va,randomize:ba,panelTitle:fa,scene:Ga}=tt.useState();if((0,g.useEffect)(()=>{tt.buildDebugDashboard()},[tt,St,ba]),!St)return null;const Ta=[{label:"Snapshot",value:En.Support},{label:"Data",value:En.Data}],Fa=r.$.supportBundlesEnabled&&ln.TP.hasPermission(z.AccessControlAction.ActionSupportBundlesCreate);return g.createElement(v._,{title:"Get help with this panel",size:"lg",onClose:Ie,subtitle:g.createElement(A.B,{direction:"column",gap:1},g.createElement(A.B,{direction:"row",gap:1},g.createElement(ht.y,{featureState:s.Ay.beta}),g.createElement("a",{href:"https://grafana.com/docs/grafana/latest/troubleshooting/",target:"blank",className:"external-link",rel:"noopener noreferrer"},"Troubleshooting docs ",g.createElement(Rt.I,{name:"external-link-alt"}))),g.createElement("span",{className:"muted"},"To request troubleshooting help, send a snapshot of this panel to Grafana Labs Technical Support. The snapshot contains query response data and panel settings."),Fa&&g.createElement("span",{className:"muted"},"You can also retrieve a support bundle containing information concerning your Grafana instance and configured datasources in the ",g.createElement("a",{href:"/support-bundles"},"support bundles section"),".")),tabs:g.createElement(h.U,null,Ta.map(($n,ta)=>g.createElement(D.o,{key:`${$n.value}-${ta}`,label:$n.label,active:$n.value===$t,onChangeTab:()=>tt.onCurrentTabChange($n.value)})))},Yt&&g.createElement(_t.y,null),pn&&g.createElement(M.F,{title:pn.title},pn.message),$t===En.Data&&g.createElement("div",{className:je.code},g.createElement("div",{className:je.opts},g.createElement(R.D,{label:"Template",className:je.field},g.createElement(on.l6,{options:Bn,value:Cn,onChange:tt.onShowMessageChange})),Cn===yt.GithubComment?g.createElement(we.b,{icon:"copy",getText:tt.onGetMarkdownForClipboard},"Copy to clipboard"):g.createElement(b.$n,{icon:"download-alt",onClick:tt.onDownloadDashboard},"Download (",Xn,")")),g.createElement(Me.Ay,{disableWidth:!0},({height:$n})=>g.createElement(Ue.B,{width:"100%",height:$n,language:Cn===yt.GithubComment?"markdown":"json",showLineNumbers:!0,showMiniMap:!0,value:Cn===yt.GithubComment?na:va,readOnly:!1,onBlur:tt.onSetSnapshotText}))),$t===En.Support&&g.createElement(g.Fragment,null,g.createElement(R.D,{label:"Randomize data",description:"Modify the original data to hide sensitve information.  Note the lengths will stay the same, and duplicate values will be equal."},g.createElement(A.B,null,g.createElement(W.K,{label:"Labels",id:"randomize-labels",showLabel:!0,value:!!ba.labels,onChange:()=>tt.onToggleRandomize("labels")}),g.createElement(W.K,{label:"Field names",id:"randomize-field-names",showLabel:!0,value:!!ba.names,onChange:()=>tt.onToggleRandomize("names")}),g.createElement(W.K,{label:"String values",id:"randomize-string-values",showLabel:!0,value:!!ba.values,onChange:()=>tt.onToggleRandomize("values")}))),g.createElement(R.D,{label:"Support snapshot",description:`Panel: ${fa}`},g.createElement(A.B,null,g.createElement(b.$n,{icon:"download-alt",onClick:tt.onDownloadDashboard},"Dashboard (",Xn,")"),g.createElement(we.b,{icon:"github",getText:tt.onGetMarkdownForClipboard,title:"Copy a complete GitHub comment to the clipboard"},"Copy to clipboard"))),g.createElement(Me.Ay,{disableWidth:!0},({height:$n})=>g.createElement("div",{style:{height:$n,overflow:"auto"}},Ga&&g.createElement(Ga.Component,{model:Ga})))))}const Jt=He=>({code:(0,ve.css)({flexGrow:1,height:"100%",overflow:"scroll"}),field:(0,ve.css)({width:"100%"}),opts:(0,ve.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end","& button":{marginLeft:He.spacing(1)}})});var Mt=e(8484),Je=e(61453);class Nn extends m.Bs{constructor(Ie){super({...Ie,options:{withTransforms:!0,withFieldConfig:!0}}),this.onOptionsChange=je=>{this.setState({options:je})}}getTabLabel(){return(0,Mt.t)("dashboard.inspect.data-tab","Data")}getTabValue(){return Nt.q.Data}static{this.Component=({model:Ie})=>{const{options:je}=Ie.useState(),tt=Ie.state.panelRef.resolve(),St=m.jh.getData(tt),{data:$t}=Fn(St,je.withTransforms).useState(),Yt=m.jh.getTimeRange(tt);return g.createElement(Je.q,{isLoading:$t?.state===cn.Gu.Loading,data:$t?.series,options:je,hasTransformations:xn(St),timeZone:Yt.getTimeZone(),panelPluginId:tt.state.pluginId,dataName:tt.state.title,fieldConfig:tt.state.fieldConfig,onOptionsChange:Ie.onOptionsChange})}}}function xn(He){return He instanceof m.Es?He.state.transformations.length>0:!1}function Fn(He,Ie){return!Ie&&He instanceof m.Es&&He.state.$data?He.state.$data:He}var wn=e(18803),Wn=e(26323),da=e(77938),oa=e(6204),_n=e(89681);class Wa extends m.Bs{constructor(Ie){super({...Ie,source:"panel-json",jsonText:za("panel-json",Ie.panelRef.resolve())}),this.onChangeSource=je=>{this.setState({source:je.value,jsonText:za(je.value,this.state.panelRef.resolve())})},this.onApplyChange=()=>{const je=this.state.panelRef.resolve(),tt=(0,Se.YQ)(je),St=JSON.parse(this.state.jsonText),$t=new c.a(St),Yt=(0,gt.tt)($t),pn=m.Go.cloneSceneObjectState(Yt.state);if(!(je.parent instanceof oe.U)){console.error("Cannot update state of panel",je,Yt);return}this.state.onClose(),tt.state.isEditing||tt.onEnterEditMode(),je.parent.setState(pn),(0,oa.B9)(Nt.q.JSON,"apply",{panel_type_changed:je.state.pluginId!==$t.type,panel_id_changed:(0,Se.Cs)(je)!==$t.id,panel_grid_pos_changed:Va(je.parent.state,pn),panel_targets_changed:Cs((0,Se.un)(je),(0,Se.un)(pn.$data))})},this.onCodeEditorBlur=je=>{this.setState({jsonText:je})}}getTabLabel(){return(0,Mt.t)("dashboard.inspect.json-tab","JSON")}getTabValue(){return Nt.q.JSON}getOptions(){const Ie=this.state.panelRef.resolve(),je=Ie.state.$data??Ie.parent?.state.$data,tt=[{label:(0,Mt.t)("dashboard.inspect-json.panel-json-label","Panel JSON"),description:(0,Mt.t)("dashboard.inspect-json.panel-json-description","The model saved in the dashboard JSON that configures how everything works."),value:"panel-json"}];return je&&(tt.push({label:(0,Mt.t)("dashboard.inspect-json.panel-data-label","Panel data"),description:(0,Mt.t)("dashboard.inspect-json.panel-data-description","The raw model passed to the panel visualization"),value:"panel-data"}),tt.push({label:(0,Mt.t)("dashboard.inspect-json.dataframe-label","DataFrame JSON (from Query)"),description:(0,Mt.t)("dashboard.inspect-json.dataframe-description","Raw data without transformations and field config applied. "),value:"data-frames"})),tt}isEditable(){if(this.state.source!=="panel-json")return!1;const Ie=this.state.panelRef.resolve();return Ie.parent instanceof lt.F||Ie.parent instanceof oe.U&&Ie.parent.isRepeated()?!1:(0,Se.YQ)(Ie).state.meta.canEdit}static{this.Component=({model:Ie})=>{const{source:je,jsonText:tt}=Ie.useState(),St=(0,qe.of)(Wn.A),$t=Ie.getOptions();return g.createElement("div",{className:St.wrap},g.createElement("div",{className:St.toolbar,"data-testid":x.Tp.components.PanelInspector.Json.content},g.createElement(R.D,{label:(0,Mt.t)("dashboard.inspect-json.select-source","Select source"),className:"flex-grow-1"},g.createElement(on.l6,{inputId:"select-source-dropdown",options:$t,value:$t.find(Yt=>Yt.value===je)??$t[0].value,onChange:Ie.onChangeSource})),Ie.isEditable()&&g.createElement(b.$n,{className:St.toolbarItem,onClick:Ie.onApplyChange},"Apply")),g.createElement("div",{className:St.content},g.createElement(Me.Ay,{disableWidth:!0},({height:Yt})=>g.createElement(Ue.B,{width:"100%",height:Yt,language:"json",showLineNumbers:!0,showMiniMap:tt.length>100,value:tt,readOnly:!Ie.isEditable(),onBlur:Ie.onCodeEditorBlur}))))}}}function za(He,Ie){let je={};switch(He){case"panel-json":{(0,oa.B9)(Nt.q.JSON,"panelData");const tt=Ie.parent instanceof lt.F,St=tt?Ie.parent.parent:Ie.parent;if(tt){je=_a(Ie);break}if(Ie.parent instanceof _n.j){je=Ie.parent.getPanelSaveModel();break}St instanceof oe.U&&(je=(0,xe.ZB)(St));break}case"panel-data":{(0,oa.B9)(Nt.q.JSON,"panelJSON");const tt=m.jh.getData(Ie);tt.state.data&&(je=Ie.applyFieldConfig(tt.state.data));break}case"data-frames":{(0,oa.B9)(Nt.q.JSON,"dataFrame");const tt=m.jh.getData(Ie);tt.state.data&&(tt instanceof m.Es&&tt.state.$data?.state.data?je=(0,wn.B6)(tt.state.$data.state.data):je=(0,wn.B6)(tt.state.data))}}return(0,da.p)(je)}function _a(He){if(!(He.parent instanceof lt.F))throw"Panel not child of LibraryVizPanel";if(!(He.parent.parent instanceof oe.U))throw"LibraryPanel not child of DashboardGridItem";const Ie=He.parent.parent,je={x:Ie.state.x||0,y:Ie.state.y||0,h:Ie.state.height||0,w:Ie.state.width||0},tt=Xa(He),St=(0,xe.Z6)(He,je,!1,Ie);return{libraryPanel:{...tt},...St}}function Xa(He){if(!(He.parent instanceof lt.F))throw new Error("Panel not a child of LibraryVizPanel");if(!He.parent.state._loadedPanel)throw new Error("Library panel not loaded");return He.parent.state._loadedPanel}function Va(He,Ie){return He.x!==Ie.x||He.y!==Ie.y||He.width!==Ie.width||He.height!==Ie.height}function Cs(He,Ie){return He===void 0||Ie===void 0?!1:!(0,Mn.isEqual)(He.state.queries,Ie.state.queries)}class ns extends m.Bs{getTabLabel(){return(0,Mt.t)("dashboard.inspect.meta-tab","Meta data")}getTabValue(){return Nt.q.Meta}static{this.Component=({model:Ie})=>{const{panelRef:je,dataSource:tt}=Ie.state,St=m.jh.getData(je.resolve()),$t=tt.components?.MetadataInspector;return!St.state.data||!$t?null:g.createElement($t,{datasource:tt,data:St.state.data.series})}}}var Is=e(90820);class ls extends m.Bs{constructor(){super(...arguments),this.onRefreshQuery=()=>{const Ie=(0,Se.un)(this.state.panelRef.resolve());Ie&&Ie.runQueries()}}getTabLabel(){return(0,Mt.t)("dashboard.inspect.query-tab","Query")}getTabValue(){return Nt.q.Query}static{this.Component=({model:Ie})=>{const je=m.jh.getData(Ie.state.panelRef.resolve()).useState();return je.data?g.createElement(Is.e,{data:je.data,onRefreshQuery:Ie.onRefreshQuery}):null}}}var ss=e(32067);class Fs extends m.Bs{getTabLabel(){return(0,Mt.t)("dashboard.inspect.stats-tab","Stats")}getTabValue(){return Nt.q.Stats}static{this.Component=({model:Ie})=>{const je=m.jh.getData(Ie.state.panelRef.resolve()).useState(),tt=m.jh.getTimeRange(Ie.state.panelRef.resolve());return je.data?g.createElement(ss.N,{data:je.data,timeZone:tt.getTimeZone()}):null}}}class Ts extends m.Bs{constructor(Ie){super(Ie),this.onClose=()=>{const je=(0,Se.YQ)(this);o.Ny.push((0,rt.uZ)({uid:je.state.uid,slug:je.state.meta.slug,currentQueryParams:o.Ny.getLocation().search,updateQuery:{inspect:null,inspectTab:null}}))},this.addActivationHandler(()=>this._activationHandler())}static{this.Component=Es}_activationHandler(){this.buildTabs(0)}async buildTabs(Ie){const je=this.state.panelRef,tt=je?.resolve()?.getPlugin(),St=[];if(tt||(Ie<2e3?setTimeout(()=>this.buildTabs(Ie+100),100):this.setState({pluginNotLoaded:!0})),je){if((0,ut.$)(tt)){const $t=m.jh.getData(je.resolve());St.push(new Nn({panelRef:je})),St.push(new Fs({panelRef:je})),St.push(new ls({panelRef:je}));const Yt=await(0,gn.BN)($t.state.data);Yt&&St.push(new ns({panelRef:je,dataSource:Yt}))}St.push(new Wa({panelRef:je,onClose:this.onClose}))}this.setState({tabs:St})}getDrawerTitle(){const Ie=this.state.panelRef?.resolve();return Ie?m.jh.interpolate(Ie,`Inspect: ${Ie.state.title}`):"Inspect panel"}}function Es({model:He}){const{tabs:Ie,pluginNotLoaded:je,panelRef:tt}=He.useState(),St=(0,pt.zy)(),$t=new URLSearchParams(St.search);if(!Ie)return null;const Yt=$t.get("inspectTab"),pn=Ie.find(Cn=>Cn.getTabValue()===Yt)??Ie[0],Bn=tt.resolve();return Yt===Nt.q.Help?g.createElement(Kt,{panel:Bn,onClose:He.onClose}):g.createElement(v._,{title:He.getDrawerTitle(),onClose:He.onClose,size:"md",tabs:g.createElement(h.U,null,Ie.map(Cn=>g.createElement(D.o,{key:Cn.state.key,label:Cn.getTabLabel(),active:Cn===pn,href:t.I.getUrlForPartial(St,{inspectTab:Cn.getTabValue()})})))},je&&g.createElement(M.F,{title:"Panel plugin not loaded"},"Make sure the panel you want to inspect is visible and has been displayed before opening inspect."),pn&&pn.Component&&g.createElement(pn.Component,{model:pn}))}var gs=e(19293),ps=e(10096),js=e(22391),As=e(19347),Qr=e(38477);class nr{constructor(Ie){this._scene=Ie}getKeys(){return["editIndex"]}getUrlState(){const Ie=this._scene.state;return{editIndex:Ie.editIndex!==void 0?String(Ie.editIndex):void 0}}updateFromUrl(Ie){let je={};typeof Ie.editIndex=="string"?je={editIndex:Number(Ie.editIndex)}:je={editIndex:void 0},Object.keys(je).length>0&&this._scene.setState(je)}}var hr=e(16817),ar=e(84167),Yr=e(77268),Qs=e(82241),cs=e(51612),_s=e(46502);const Ys="New annotation",sr=({annotation:He,editIndex:Ie,panels:je,onUpdate:tt,onBackToList:St,onDelete:$t})=>{const Yt=(0,qe.of)(Kr),pn=(0,g.useMemo)(()=>He.filter?He.filter.exclude?2:1:0,[He.filter]),{value:Bn}=(0,hr.A)(()=>(0,As.l)().get(He.datasource),[He.datasource]),Cn=(0,As.l)().getInstanceSettings(He.datasource),Xn=Zn=>{tt({...He,name:Zn.currentTarget.value},Ie)},na=Zn=>{const La=(0,js.p$)(Zn);He.datasource?.type!==La.type?tt({datasource:La,builtIn:He.builtIn,enable:He.enable,iconColor:He.iconColor,name:He.name,hide:He.hide,filter:He.filter,mappings:He.mappings,type:He.type},Ie):tt({...He,datasource:La},Ie)},va=Zn=>{const La=Zn.currentTarget;tt({...He,[La.name]:La.type==="checkbox"?La.checked:La.value},Ie)},ba=Zn=>{tt({...He,iconColor:Zn},Ie)},fa=Zn=>{let La=Zn.value===0?void 0:{exclude:Zn.value===2,ids:He.filter?.ids??[]};tt({...He,filter:La},Ie)},Ga=Zn=>{if(!Array.isArray(Zn))return;const La={exclude:pn===2,ids:[]};Zn.forEach(us=>us.value&&La.ids.push(us.value)),tt({...He,filter:La},Ie)},Ta=()=>{$t(Ie),St()},Fa=He.name===Ys,$n=(Zn,La)=>Zn.label&&La.label?Zn.label.toLowerCase().localeCompare(La.label.toLowerCase()):-1,ta=(0,g.useMemo)(()=>je.filter(Zn=>r.$.panels[Zn.state.pluginId]).map(Zn=>({value:(0,Se.Cs)(Zn),label:Zn.state.title??`Panel ${(0,Se.Cs)(Zn)}`,description:Zn.state.description,imgUrl:r.$.panels[Zn.state.pluginId].info.logos.small})).sort($n)??[],[je]);return g.createElement("div",null,g.createElement(ar.n,{className:Yt.settingsForm},g.createElement(R.D,{label:"Name"},g.createElement(B.p,{"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:Fa,value:He.name,onChange:Xn})),g.createElement(R.D,{label:"Data source",htmlFor:"data-source-picker"},g.createElement(cs.s,{annotations:!0,variables:!0,current:He.datasource,onChange:na})),g.createElement(R.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh"},g.createElement(de.S,{name:"enable",id:"enable",value:He.enable,onChange:va,"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.enable})),g.createElement(R.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden."},g.createElement(de.S,{name:"hide",id:"hide",value:He.hide,onChange:va,"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.hide})),g.createElement(R.D,{label:"Color",description:"Color to use for the annotation event markers"},g.createElement(A.B,null,g.createElement(Yr.a,{value:He?.iconColor,onChange:ba}))),g.createElement(R.D,{label:"Show in","data-testid":x.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel},g.createElement(g.Fragment,null,g.createElement(on.l6,{options:Mo,value:pn,onChange:fa,"data-testid":x.Tp.components.Annotations.annotationsTypeInput}),pn!==0&&g.createElement(on.KF,{options:ta,value:ta.filter(Zn=>He.filter?.ids.includes(Zn.value)),onChange:Ga,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:Yt.select,"data-testid":x.Tp.components.Annotations.annotationsChoosePanelInput})))),g.createElement(ar.n,null,g.createElement("h3",{className:"page-heading"},"Query"),Bn?.annotations&&Cn&&g.createElement(Qs.A,{datasource:Bn,datasourceInstanceSettings:Cn,annotation:He,onChange:Zn=>tt(Zn,Ie)}),Bn&&!Bn.annotations&&g.createElement(_s.F,{datasource:Bn,annotation:He,onChange:Zn=>tt(Zn,Ie)})),g.createElement(A.B,null,!He.builtIn&&g.createElement(b.$n,{variant:"destructive",onClick:Ta,"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.delete},"Delete"),g.createElement(b.$n,{variant:"secondary",onClick:St,"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.apply},"Back to list")))},Kr=He=>({settingsForm:(0,ve.css)({maxWidth:He.spacing(60),marginBottom:He.spacing(2)}),select:(0,ve.css)({marginTop:"8px"})});var io=(He=>(He[He.AllPanels=0]="AllPanels",He[He.IncludePanels=1]="IncludePanels",He[He.ExcludePanels=2]="ExcludePanels",He))(io||{});const Mo=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var cr=e(29158),lo=e(91605),Jr=e(69529),co=e(72109),Rr=e(46991);const Ho="Add annotation query",Xr=({annotations:He,onNew:Ie,onEdit:je,onMove:tt,onDelete:St})=>{const $t=(0,qe.of)(xo),Yt=He.length===0||He.length===1&&He[0].builtIn,pn=Cn=>Cn.enable===!1?g.createElement("em",{className:"muted"},"(Disabled) \xA0 ",Cn.name):Cn.builtIn?g.createElement("em",{className:"muted"},Cn.name," \xA0 (Built-in)"):g.createElement(g.Fragment,null,Cn.name),Bn=(0,As.l)();return g.createElement(A.B,{direction:"column"},He.length>0&&g.createElement("div",{className:$t.table},g.createElement("table",{role:"grid",className:"filter-table filter-table--hover"},g.createElement("thead",null,g.createElement("tr",null,g.createElement("th",null,"Query name"),g.createElement("th",null,"Data source"),g.createElement("th",{colSpan:3}))),g.createElement("tbody",{"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.List.annotations},He.map((Cn,Xn)=>g.createElement("tr",{key:`${Cn.name}-${Xn}`},Cn.builtIn?g.createElement("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>je(Xn)},g.createElement(b.$n,{size:"sm",fill:"text",variant:"secondary"},pn(Cn))):g.createElement("td",{role:"gridcell",className:"pointer",onClick:()=>je(Xn)},g.createElement(b.$n,{size:"sm",fill:"text",variant:"secondary"},pn(Cn))),g.createElement("td",{role:"gridcell",className:"pointer",onClick:()=>je(Xn)},Bn.getInstanceSettings(Cn.datasource)?.name||Cn.datasource?.uid),g.createElement("td",{role:"gridcell",style:{width:"1%"}},Xn!==0&&g.createElement(cr.K,{name:"arrow-up",onClick:()=>tt(Xn,Ur.UP),tooltip:"Move up"})),g.createElement("td",{role:"gridcell",style:{width:"1%"}},He.length>1&&Xn!==He.length-1?g.createElement(cr.K,{name:"arrow-down",onClick:()=>tt(Xn,Ur.DOWN),tooltip:"Move down"}):null),g.createElement("td",{role:"gridcell",style:{width:"1%"}},!Cn.builtIn&&g.createElement(lo.e,{size:"sm",onConfirm:()=>St(Xn),"aria-label":`Delete query with title "${Cn.name}"`}))))))),Yt&&g.createElement(A.B,{direction:"column"},g.createElement(Jr.p,{variant:"call-to-action",button:g.createElement(b.$n,{"data-testid":x.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:Ie,size:"lg"},g.createElement(Mt.x6,{i18nKey:"annotations.empty-state.button-title"},"Add annotation query")),message:(0,Mt.t)("annotations.empty-state.title","There are no custom annotation queries added yet")},g.createElement(Mt.x6,{i18nKey:"annotations.empty-state.info-box-content"},g.createElement("p",null,"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database.")),g.createElement(Mt.x6,{i18nKey:"annotations.empty-state.info-box-content-2"},"Checkout the"," ",g.createElement(co.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/"},"Annotations documentation")," ","for more information."))),!Yt&&g.createElement(Rr.d,{"data-testid":x.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:Ie},"New query"))},xo=()=>({table:(0,ve.css)({width:"100%",overflowX:"auto"})});var Ur=(He=>(He[He.UP=-1]="UP",He[He.DOWN=1]="DOWN",He))(Ur||{});class Js extends m.Bs{constructor(){super(...arguments),this._urlSync=new nr(this),this.onNew=()=>{const Ie={name:Ys,enable:!0,datasource:(0,js.p$)((0,As.l)().getInstanceSettings(null)),iconColor:"red"},je=new Qr.g({query:Ie,name:Ie.name,isEnabled:!!Ie.enable,isHidden:!!Ie.hide}),tt=Ke.b4.getDataLayers(this._dashboard);tt.addAnnotationLayer(je),this.setState({editIndex:tt.state.annotationLayers.length-1})},this.onEdit=Ie=>{this.setState({editIndex:Ie})},this.onBackToList=()=>{this.setState({editIndex:void 0})},this.onMove=(Ie,je)=>{const tt=Ke.b4.getDataLayers(this._dashboard),St=[...tt.state.annotationLayers],[$t]=St.splice(Ie,1);St.splice(Ie+je,0,$t),tt.setState({annotationLayers:St})},this.onDelete=Ie=>{const je=Ke.b4.getDataLayers(this._dashboard),tt=[...je.state.annotationLayers];tt.splice(Ie,1),je.setState({annotationLayers:tt})},this.onUpdate=(Ie,je)=>{const tt=this.getDataLayer(je);tt.setState({name:Ie.name,isEnabled:!!Ie.enable,isHidden:!!Ie.hide,query:Ie}),tt.runLayer()}}static{this.Component=uo}getUrlKey(){return"annotations"}get _dashboard(){return(0,Se.YQ)(this)}getDataLayer(Ie){const tt=Ke.b4.getDataLayers(this._dashboard).state.annotationLayers[Ie];if(!(tt instanceof m.tV.g))throw new Error("AnnotationsDataLayer not found at index "+Ie);return tt}getDashboard(){return this._dashboard}}function uo({model:He}){const Ie=He.getDashboard(),{annotationLayers:je}=Ke.b4.getDataLayers(Ie).useState(),{navModel:tt,pageNav:St}=wr(Ie,He.getUrlKey()),{editIndex:$t}=He.useState(),Yt=Ke.b4.getVizPanels(Ie),pn=(0,Ee.O)(je);return $t!=null&&$t<je.length?g.createElement(mo,{annotationLayer:He.getDataLayer($t),pageNav:St,panels:Yt,editIndex:$t,navModel:tt,dashboard:Ie,onUpdate:He.onUpdate,onBackToList:He.onBackToList,onDelete:He.onDelete}):g.createElement(Ft.Y,{navModel:tt,pageNav:St,layout:Ge.k.Standard},g.createElement(Lt.c,{dashboard:Ie}),g.createElement(Xr,{annotations:pn,onNew:He.onNew,onEdit:He.onEdit,onDelete:He.onDelete,onMove:He.onMove}))}function mo({annotationLayer:He,pageNav:Ie,navModel:je,panels:tt,editIndex:St,dashboard:$t,onUpdate:Yt,onBackToList:pn,onDelete:Bn}){const Cn=Ie.children.find(ba=>ba.active);Cn.parentItem=Ie;const{name:Xn,query:na}=He.useState(),va={text:Xn,parentItem:Cn};return g.createElement(Ft.Y,{navModel:je,pageNav:va,layout:Ge.k.Standard},g.createElement(Lt.c,{dashboard:$t}),g.createElement(sr,{annotation:na,editIndex:St,panels:tt,onUpdate:Yt,onBackToList:pn,onDelete:Bn}))}var fo=e(14588),Vr=e(65857),Oo=e(6199),vr=e(4588);class Pt extends m.Bs{constructor(){super(...arguments),this._urlSync=new nr(this),this.onNewLink=()=>{this.links=[...this.links,vr.q],this.setState({editIndex:this.links.length-1})},this.onDelete=Ie=>{this.links=[...this.links.slice(0,Ie),...this.links.slice(Ie+1)],this.setState({editIndex:void 0})},this.onDuplicate=Ie=>{this.links=[...this.links,{...Ie}]},this.onOrderChange=(Ie,je)=>{this.links=fo.moveItemImmutably(this.links,Ie,Ie+je)},this.onEdit=Ie=>{this.setState({editIndex:Ie})},this.onUpdateLink=Ie=>{const je=this.state.editIndex;je!==void 0&&(this.links=[...this.links.slice(0,je),Ie,...this.links.slice(je+1)])},this.onGoBack=()=>{this.setState({editIndex:void 0})}}static{this.Component=Gt}getUrlKey(){return"links"}get dashboard(){return(0,Se.YQ)(this)}get links(){return this.dashboard.state.links}set links(Ie){this.dashboard.setState({links:Ie})}}function Gt({model:He}){const{editIndex:Ie}=He.useState(),je=(0,Se.YQ)(He),{links:tt}=je.useState(),{navModel:St,pageNav:$t}=wr(je,He.getUrlKey()),Yt=Ie!==void 0?tt[Ie]:void 0;return Yt?g.createElement(Pn,{pageNav:$t,navModel:St,link:Yt,dashboard:je,onChange:He.onUpdateLink,onGoBack:He.onGoBack}):g.createElement(Ft.Y,{navModel:St,pageNav:$t,layout:Ge.k.Standard},g.createElement(Lt.c,{dashboard:je}),g.createElement(Oo.X,{links:tt,onNew:He.onNewLink,onEdit:He.onEdit,onDelete:He.onDelete,onDuplicate:He.onDuplicate,onOrderChange:He.onOrderChange}))}function Pn({pageNav:He,link:Ie,navModel:je,dashboard:tt,onChange:St,onGoBack:$t}){const Yt=He.children.find(Bn=>Bn.active);Yt.parentItem=He;const pn={text:"Edit link",parentItem:Yt};return g.createElement(Ft.Y,{navModel:je,pageNav:pn,layout:Ge.k.Standard},g.createElement(Lt.c,{dashboard:tt}),g.createElement(Vr.d,{link:Ie,onUpdate:St,onGoBack:$t}))}var hn=e(79924),Ln=e(94354),Hn=e(57418),kn=e(75590),xa=e(81394),ua=e(27966),ra=e(77431),os=e(42941),Ra=e(96374),es=e(37390);function zs({dashboard:He}){const[Ie,je]=(0,os.A)(!1);return g.createElement(g.Fragment,null,g.createElement(b.$n,{variant:"destructive",onClick:je,"data-testid":x.Tp.pages.Dashboard.Settings.General.deleteDashBoard},g.createElement(Mt.x6,{i18nKey:"dashboard-settings.dashboard-delete-button"},"Delete dashboard")),Ie&&g.createElement(Ws,{dashboard:He,onClose:je}))}function Ws({dashboard:He,onClose:Ie}){const[,je]=(0,se.A)(async()=>{Ie(),await He.deleteDashboard()},[He,Ie]);return He.state.meta.provisioned?g.createElement(Rs,{dashboard:He,onClose:Ie}):g.createElement(Ra.u,{isOpen:!0,body:g.createElement(g.Fragment,null,g.createElement("p",null,"Do you want to delete this dashboard?"),g.createElement("p",null,He.state.title)),onConfirm:je,onDismiss:Ie,title:"Delete",icon:"trash-alt",confirmText:"Delete"})}function Rs({dashboard:He,onClose:Ie}){return g.createElement(es.a,{isOpen:!0,title:"Cannot delete provisioned dashboard",icon:"trash-alt",onDismiss:Ie},g.createElement("p",null,"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."),g.createElement("p",null,g.createElement("i",null,"See"," ",g.createElement("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer"},"documentation")," ","for more information about provisioning."),g.createElement("br",null),"File path: ",He.state.meta.provisionedExternalId),g.createElement(es.a.ButtonRow,null,g.createElement(b.$n,{variant:"primary",onClick:Ie},"OK")))}const xr=[{label:"Editable",value:!0},{label:"Read-only",value:!1}],dr=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];class Us extends m.Bs{constructor(){super(...arguments),this.onTitleChange=Ie=>{this._dashboard.setState({title:Ie})},this.onDescriptionChange=Ie=>{this._dashboard.setState({description:Ie})},this.onTagsChange=Ie=>{this._dashboard.setState({tags:Ie})},this.onFolderChange=async(Ie,je)=>{const tt={...this._dashboard.state.meta,folderUid:Ie||this._dashboard.state.meta.folderUid,folderTitle:je||this._dashboard.state.meta.folderTitle};tt.folderUid&&await(0,ra.Q)(tt.folderUid),this._dashboard.setState({meta:tt})},this.onEditableChange=Ie=>{this._dashboard.setState({editable:Ie})},this.onTimeZoneChange=Ie=>{this.getTimeRange().setState({timeZone:Ie})},this.onWeekStartChange=Ie=>{this.getTimeRange().setState({weekStart:Ie})},this.onRefreshIntervalChange=Ie=>{this.getRefreshPicker()?.setState({intervals:Ie})},this.onNowDelayChange=Ie=>{this.getTimeRange()?.setState({UNSAFE_nowDelay:Ie})},this.onHideTimePickerChange=Ie=>{this.getDashboardControls()?.setState({hideTimeControls:Ie})},this.onLiveNowChange=Ie=>{try{const je=this.getLiveNowTimer();Ie?je.enable():je.disable()}catch(je){console.error(je)}},this.onTooltipChange=Ie=>{this.getCursorSync()?.setState({sync:Ie})},this.onDeleteDashboard=()=>{}}get _dashboard(){return(0,Se.YQ)(this)}getUrlKey(){return"settings"}getDashboard(){return this._dashboard}getTimeRange(){return m.jh.getTimeRange(this._dashboard)}getRefreshPicker(){return this.getDashboardControls().state.refreshPicker}getCursorSync(){return Ke.b4.getCursorSync(this._dashboard)}getLiveNowTimer(){const Ie=m.jh.findObject(this._dashboard,je=>je instanceof m.Gg.en);if(Ie instanceof m.Gg.en)return Ie;throw new Error("LiveNowTimer could not be found")}getDashboardControls(){return this._dashboard.state.controls}static{this.Component=({model:Ie})=>{const je=Ie.getDashboard(),{navModel:tt,pageNav:St}=wr(je,Ie.getUrlKey()),{title:$t,description:Yt,tags:pn,meta:Bn,editable:Cn}=je.useState(),{sync:Xn}=Ie.getCursorSync()?.useState()||{},{timeZone:na,weekStart:va,UNSAFE_nowDelay:ba}=Ie.getTimeRange().useState(),{intervals:fa}=Ie.getRefreshPicker().useState(),{hideTimeControls:Ga}=Ie.getDashboardControls().useState(),{enabled:Ta}=Ie.getLiveNowTimer().useState();return g.createElement(Ft.Y,{navModel:tt,pageNav:St,layout:Ge.k.Standard},g.createElement(Lt.c,{dashboard:je}),g.createElement("div",{style:{maxWidth:"600px"}},g.createElement(N.a,{marginBottom:5},g.createElement(R.D,{label:g.createElement(A.B,{justifyContent:"space-between"},g.createElement(w.J,{htmlFor:"title-input"},g.createElement(Mt.x6,{i18nKey:"dashboard-settings.general.title-label"},"Title")),r.$.featureToggles.dashgpt&&g.createElement(ua.Z,{onGenerate:Fa=>Ie.onTitleChange(Fa)}))},g.createElement(B.p,{id:"title-input",name:"title",value:$t,onChange:Fa=>Ie.onTitleChange(Fa.target.value)})),g.createElement(R.D,{label:g.createElement(A.B,{justifyContent:"space-between"},g.createElement(w.J,{htmlFor:"description-input"},(0,Mt.t)("dashboard-settings.general.description-label","Description")),r.$.featureToggles.dashgpt&&g.createElement(xa.V,{onGenerate:Fa=>Ie.onDescriptionChange(Fa)}))},g.createElement(U.f,{id:"description-input",name:"description",value:Yt,onChange:Fa=>Ie.onDescriptionChange(Fa.target.value)})),g.createElement(R.D,{label:(0,Mt.t)("dashboard-settings.general.tags-label","Tags")},g.createElement(hn.u,{id:"tags-input",tags:pn,onChange:Ie.onTagsChange,width:40})),g.createElement(R.D,{label:(0,Mt.t)("dashboard-settings.general.folder-label","Folder")},g.createElement(L.d,{value:Bn.folderUid,onChange:Ie.onFolderChange,initialTitle:Bn.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,skipInitialLoad:!0})),g.createElement(R.D,{label:(0,Mt.t)("dashboard-settings.general.editable-label","Editable"),description:(0,Mt.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect")},g.createElement(Ln.z,{value:Cn,options:xr,onChange:Ie.onEditableChange}))),g.createElement(kn.p,{onTimeZoneChange:Ie.onTimeZoneChange,onWeekStartChange:Ie.onWeekStartChange,onRefreshIntervalChange:Ie.onRefreshIntervalChange,onNowDelayChange:Ie.onNowDelayChange,onHideTimePickerChange:Ie.onHideTimePickerChange,onLiveNowChange:Ie.onLiveNowChange,refreshIntervals:fa,timePickerHidden:Ga,nowDelay:ba||"",liveNow:Ta,timezone:na||"",weekStart:va||""}),g.createElement(Hn.M,{label:(0,Mt.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0},g.createElement(R.D,{label:(0,Mt.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,Mt.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect")},g.createElement(Ln.z,{onChange:Ie.onTooltipChange,options:dr,value:Xn}))),g.createElement(N.a,{marginTop:3},Bn.canDelete&&g.createElement(zs,{dashboard:je}))))}}}class $r extends m.Bs{constructor(Ie){super({...Ie,jsonText:""}),this.onCodeEditorBlur=je=>{this.setState({jsonText:je})},this.onSaveSuccess=je=>{const tt=JSON.parse(this.state.jsonText),St=this.getDashboard();tt.version=je.version;const $t={dashboard:tt,meta:St.state.meta},Yt=(0,gt.wM)($t),pn=m.Go.cloneSceneObjectState(Yt.state);St.pauseTrackingChanges(),St.setInitialSaveModel($t.dashboard),St.setState(pn),this.setState({jsonText:this.getJsonText()})},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getUrlKey(){return"json-model"}getDashboard(){return(0,Se.YQ)(this)}getSaveModel(){const Ie=this.getDashboard();return(0,xe.Uy)(Ie)}getJsonText(){const Ie=this.getSaveModel();return(0,da.p)(Ie)}static{this.Component=({model:Ie})=>{const{state:je,onSaveDashboard:tt}=ie(!1),[St,$t]=(0,g.useState)(!1),Yt=Ie.getDashboard(),{navModel:pn,pageNav:Bn}=wr(Yt,Ie.getUrlKey()),Cn=Yt.useState().meta.canSave,{jsonText:Xn}=Ie.useState(),na=async Ta=>{const Fa=await tt(Yt,JSON.parse(Ie.state.jsonText),{folderUid:Yt.state.meta.folderUid,overwrite:Ta});$t(!0),Fa.status==="success"?(Ie.onSaveSuccess(Fa),$t(!1)):$t(!0)},va=Ta=>g.createElement(b.$n,{type:"submit",onClick:()=>{na(Ta)},variant:Ta?"destructive":"primary"},Ta?"Save and overwrite":g.createElement(Mt.x6,{i18nKey:"dashboard-settings.json-editor.save-button"},"Save changes")),ba=g.createElement(b.$n,{variant:"secondary",onClick:()=>$t(!1),fill:"outline"},"Cancel"),fa=(0,qe.of)(ks);function Ga(Ta){if(Ta&&St){if(k(Ta))return g.createElement(M.F,{title:"Someone else has updated this dashboard",severity:"error"},g.createElement("p",null,"Would you still like to save this dashboard?"),g.createElement(N.a,{paddingTop:2},g.createElement(A.B,{alignItems:"center"},ba,va(!0))));if(j(Ta))return g.createElement(J,{saveButton:va,cancelButton:ba});if(H(Ta))return g.createElement(M.F,{title:"Plugin dashboard",severity:"error"},g.createElement("p",null,"Your changes will be lost when you update the plugin. Use ",g.createElement("strong",null,"Save As")," to create custom version."),g.createElement(N.a,{paddingTop:2},g.createElement(A.B,{alignItems:"center"},va(!0))))}return g.createElement(g.Fragment,null,Ta&&St&&g.createElement(M.F,{title:"Failed to save dashboard",severity:"error"},g.createElement("p",null,Ta.message)),g.createElement(A.B,{alignItems:"center"},va(!1)))}return g.createElement(Ft.Y,{navModel:pn,pageNav:Bn,layout:Ge.k.Standard},g.createElement(Lt.c,{dashboard:Yt}),g.createElement("div",{className:fa.wrapper},g.createElement(Mt.x6,{i18nKey:"dashboard-settings.json-editor.subtitle"},"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."),g.createElement(Ue.B,{width:"100%",value:Xn,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:fa.codeEditor,onBlur:Ie.onCodeEditorBlur}),Cn&&g.createElement(N.a,{paddingTop:2},Ga(je.error))))}}}const ks=He=>({wrapper:(0,ve.css)({display:"flex",height:"100%",flexDirection:"column",gap:He.spacing(2)}),codeEditor:(0,ve.css)({flexGrow:1})});var Ka=e(5108);class ys extends m.Bs{static{this.Component=Er}get _dashboard(){return(0,Se.YQ)(this)}getUrlKey(){return"permissions"}getDashboard(){return this._dashboard}}function Er({model:He}){const Ie=He.getDashboard(),{uid:je}=Ie.useState(),{navModel:tt,pageNav:St}=wr(Ie,He.getUrlKey()),$t=ps.TP.hasPermission(z.AccessControlAction.DashboardsPermissionsWrite);return g.createElement(Ft.Y,{navModel:tt,pageNav:St,layout:Ge.k.Standard},g.createElement(Lt.c,{dashboard:Ie}),g.createElement(Ka.x,{resource:"dashboards",resourceId:je??"",canSetPermissions:$t}))}var ds=e(75505),Zr=e(79422),go=e(71678),Io=e(39558),Ao=e(8964),Go=e(58975),_i=e(85140),bi=e(14329),ur=e(41820),ri=e(85830),zi=e(89458),Ss=e(17663);function po({onChange:He,type:Ie}){const je=(0,g.useMemo)(()=>(0,Ss.B$)(),[]),tt=(0,g.useMemo)(()=>je.find(St=>St.value===Ie)??je[0],[je,Ie]);return g.createElement(zi.v,{name:"Select variable type",value:tt,options:je,onChange:He,testId:x.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}function Ro({variable:He,onTypeChange:Ie,onGoBack:je,onDelete:tt,onValidateVariableName:St}){const $t=(0,qe.of)(Ci),[Yt,pn]=(0,g.useState)(null),{name:Bn,type:Cn,label:Xn,description:na,hide:va,key:ba}=He.useState(),fa=(0,Ss.bZ)(Cn)?(0,Ss.CD)(Cn):void 0,[Ga,Ta]=(0,se.A)(async()=>{await(0,ds.s)(He.validateAndUpdate())},[He]),Fa=Da=>{Da.value&&Ie(Da.value)},$n=(0,g.useCallback)(Da=>{const[,fr]=St(Da.currentTarget.value,ba);Yt!==fr&&pn(fr)},[ba,Yt,St]),ta=Da=>{Yt||He.setState({name:Da.currentTarget.value})},Zn=Da=>He.setState({label:Da.currentTarget.value}),La=Da=>He.setState({description:Da.currentTarget.value}),us=Da=>He.setState({hide:Da}),ts=(0,Ss.n_)(He),Hs=Da=>()=>{(0,ae.rR)("Delete variable"),tt(Bn),Da()};return g.createElement("form",{"aria-label":"Variable editor Form"},g.createElement(po,{onChange:Fa,type:Cn}),g.createElement(Go.Y,null,"General"),g.createElement(bi._,{name:"Name",description:"The name of the template variable. (Max. 50 characters)",placeholder:"Variable name",defaultValue:Bn??"",onChange:$n,onBlur:ta,testId:x.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:ri.M.MaxSize,required:!0,invalid:!!Yt,error:Yt}),g.createElement(bi._,{name:"Label",description:"Optional display name",placeholder:"Label name",defaultValue:Xn??"",onBlur:Zn,testId:x.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),g.createElement(_i.Z,{name:"Description",defaultValue:na??"",placeholder:"Descriptive text",onBlur:La,width:52}),g.createElement(Ao.D,{onChange:us,hide:va||Zr.rw.hide,type:Cn}),fa&&g.createElement(fa,{variable:He,onRunQuery:Ta}),ts&&g.createElement(ur.j,{options:He.getOptionsForSelect()}),g.createElement("div",{className:$t.buttonContainer},g.createElement(A.B,{gap:2},g.createElement(go.$s,null,({showModal:Da,hideModal:fr})=>g.createElement(b.$n,{variant:"destructive",fill:"outline",onClick:()=>{Da(Ra.u,{title:"Delete variable",body:`Are you sure you want to delete: ${Bn}?`,confirmText:"Delete variable",onConfirm:Hs(fr),onDismiss:fr,isOpen:!0})}},"Delete")),g.createElement(b.$n,{variant:"secondary","data-testid":x.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,onClick:je},"Back to list"),ts&&g.createElement(b.$n,{disabled:Ga.loading,variant:"secondary","data-testid":x.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,onClick:Ta},Ga.loading?g.createElement(Io._,{className:$t.loadingPlaceHolder,text:"Running query..."}):"Run query"))))}const Ci=He=>({buttonContainer:(0,ve.css)({marginTop:He.spacing(2)}),loadingPlaceHolder:(0,ve.css)({marginBottom:0})});var Lo=e(75494);function Bo({index:He,variable:Ie,onEdit:je,onDuplicate:tt,onDelete:St}){const $t=(0,qe.$j)(),Yt=(0,qe.of)(jo),pn=(0,Ss.Ao)(Ie),Bn=Ie.state,Cn=Bn.name,[Xn,na]=(0,g.useState)(!1),va=fa=>()=>{na(fa)},ba=()=>{(0,ae.rR)("Delete variable"),St(Cn)};return g.createElement(Lo.sx,{draggableId:JSON.stringify(Cn),index:He},(fa,Ga)=>g.createElement("tr",{ref:fa.innerRef,...fa.draggableProps,style:{userSelect:Ga.isDragging?"none":"auto",background:Ga.isDragging?$t.colors.background.secondary:void 0,...fa.draggableProps.style}},g.createElement("td",{role:"gridcell",className:Yt.column},g.createElement(b.$n,{size:"xs",fill:"text",onClick:Ta=>{Ta.preventDefault(),je(Cn)},className:Yt.nameLink,"data-testid":x.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(Bn.name)},Bn.name)),g.createElement("td",{role:"gridcell",className:Yt.definitionColumn,onClick:Ta=>{Ta.preventDefault(),je(Cn)},"data-testid":x.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(Bn.name)},pn),g.createElement("td",{role:"gridcell",className:Yt.column},g.createElement("div",{className:Yt.icons},g.createElement(cr.K,{onClick:Ta=>{Ta.preventDefault(),(0,ae.rR)("Duplicate variable"),tt(Cn)},name:"copy",tooltip:"Duplicate variable","data-testid":x.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(Bn.name)}),g.createElement(cr.K,{onClick:Ta=>{Ta.preventDefault(),na(!0)},name:"trash-alt",tooltip:"Remove variable","data-testid":x.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(Bn.name)}),g.createElement(Ra.u,{isOpen:Xn,title:"Delete variable",body:`Are you sure you want to delete: ${Bn.name}?`,confirmText:"Delete variable",onConfirm:ba,onDismiss:va(!1)}),g.createElement("div",{...fa.dragHandleProps,className:Yt.dragHandle},g.createElement(Rt.I,{name:"draggabledots",size:"lg"}))))))}function jo(He){return{dragHandle:(0,ve.css)({cursor:"grab",marginLeft:He.spacing(1)}),column:(0,ve.css)({width:"1%"}),nameLink:(0,ve.css)({cursor:"pointer",color:He.colors.primary.text}),definitionColumn:(0,ve.css)({width:"100%",maxWidth:"200px",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),iconPassed:(0,ve.css)({color:He.v1.palette.greenBase,marginRight:He.spacing(2)}),iconFailed:(0,ve.css)({color:He.v1.palette.orange,marginRight:He.spacing(2)}),icons:(0,ve.css)({display:"flex",gap:He.spacing(2),alignItems:"center"})}}function Nr({variables:He,onChangeOrder:Ie,onDelete:je,onDuplicate:tt,onAdd:St,onEdit:$t}){const Yt=(0,qe.of)(oi),pn=Bn=>{!Bn.destination||!Bn.source||((0,ae.rR)("Variable drag and drop"),Ie(Bn.source.index,Bn.destination.index))};return g.createElement("div",null,g.createElement("div",null,He.length===0&&g.createElement(Ns,{onAdd:St}),He.length>0&&g.createElement(A.B,{direction:"column",gap:3},g.createElement("div",{className:Yt.tableContainer},g.createElement("table",{className:"filter-table filter-table--hover","data-testid":x.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid"},g.createElement("thead",null,g.createElement("tr",null,g.createElement("th",null,"Variable"),g.createElement("th",null,"Definition"),g.createElement("th",{colSpan:5}))),g.createElement(Lo.JY,{onDragEnd:pn},g.createElement(Lo.gL,{droppableId:"variables-list",direction:"vertical"},Bn=>g.createElement("tbody",{ref:Bn.innerRef,...Bn.droppableProps},He.map((Cn,Xn)=>{const na=Cn.state;return g.createElement(Bo,{index:Xn,key:`${na.name}-${Xn}`,variable:Cn,onDelete:je,onDuplicate:tt,onEdit:$t})}),Bn.placeholder))))),g.createElement(A.B,null,g.createElement(b.$n,{"data-testid":x.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:St,icon:"plus"},"New variable")))))}function Ns({onAdd:He}){return g.createElement(A.B,{direction:"column"},g.createElement(Jr.p,{variant:"call-to-action",button:g.createElement(b.$n,{"data-testid":x.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:He,size:"lg"},g.createElement(Mt.x6,{i18nKey:"variables.empty-state.button-title"},"Add variable")),message:(0,Mt.t)("variables.empty-state.title","There are no variables added yet")},g.createElement("p",null,g.createElement(Mt.x6,{i18nKey:"variables.empty-state.info-box-content"},"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard.")),g.createElement(Mt.x6,{i18nKey:"variables.empty-state.info-box-content-2"},"Check out the"," ",g.createElement(co.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/"},"Templates and variables documentation")," ","for more information.")))}const oi=()=>({tableContainer:(0,ve.css)({overflow:"scroll",width:"100%"})});class ki extends m.Bs{constructor(){super(...arguments),this._urlSync=new nr(this),this.getVariableIndex=Ie=>this.getVariables().findIndex(tt=>tt.state.name===Ie),this.replaceEditVariable=Ie=>{const je=this.state.editIndex??-1,{variables:tt}=this.getVariableSet().state;if(!tt[je]){console.error("Variable not found");return}const $t=[...tt.slice(0,je),Ie,...tt.slice(je+1)];this.getVariableSet().setState({variables:$t})},this.onDelete=Ie=>{const je=this.getVariableIndex(Ie),{variables:tt}=this.getVariableSet().state;if(je===-1){console.error("Variable not found");return}const St=[...tt.slice(0,je),...tt.slice(je+1)];this.getVariableSet().setState({variables:St}),this.setState({editIndex:void 0})},this.onDuplicated=Ie=>{const je=this.getVariableIndex(Ie),tt=this.getVariableSet().state.variables;if(je===-1){console.error("Variable not found");return}const St=tt[je];let $t=0,Yt=`copy_of_${St.state.name}`;for(;tt.some(Cn=>Cn.state.name===Yt);)$t++,Yt=`copy_of_${St.state.name}_${$t}`;const pn=St.clone(St.state);pn.setState({name:Yt});const Bn=[...tt.slice(0,je+1),pn,...tt.slice(je+1)];this.getVariableSet().setState({variables:Bn})},this.onOrderChanged=(Ie,je)=>{const tt=this.getVariableSet().state.variables;if(!this.getVariableSet())return;if(Ie<0||Ie>=tt.length||je<0||je>=tt.length){console.error("Invalid index");return}const St=[...tt],$t=St.splice(Ie,1);St.splice(je,0,$t[0]),this.getVariableSet().setState({variables:St})},this.onEdit=Ie=>{const je=this.getVariableIndex(Ie);if(je===-1){console.error("Variable not found");return}this.setState({editIndex:je})},this.onAdd=()=>{const Ie=this.getVariables(),je=Ie.length,tt=(0,Ss.kh)(Ie);this.getVariableSet().setState({variables:[...this.getVariables(),tt]}),this.setState({editIndex:je})},this.onTypeChange=Ie=>{const je=this.state.editIndex??-1,{variables:tt}=this.getVariableSet().state,St=tt[je];if(!St){console.error("Variable not found");return}const{name:$t,label:Yt}=St.state,pn=(0,Ss.No)(Ie,{name:$t,label:Yt});this.replaceEditVariable(pn)},this.onGoBack=()=>{this.setState({editIndex:void 0})},this.onValidateVariableName=(Ie,je)=>{let tt=null;Ss.cH.test(Ie)||(tt="Template names cannot begin with '__', that's reserved for Grafana's global variables"),Ss.mJ.test(Ie)||(tt="Only word characters are allowed in variable names");const St=this.getVariableSet().getByName(Ie)?.state;return St&&St.key!==je&&(tt="Variable with the same name already exists"),tt?[!0,tt]:[!1,null]}}static{this.Component=Ti}getUrlKey(){return"variables"}getDashboard(){return(0,Se.YQ)(this)}getVariableSet(){return m.jh.getVariables(this.getDashboard())}getVariables(){return this.getVariableSet().state.variables}}function Ti({model:He}){const Ie=He.getDashboard(),{navModel:je,pageNav:tt}=wr(Ie,He.getUrlKey()),{onDelete:St,onDuplicated:$t,onOrderChanged:Yt,onEdit:pn,onTypeChange:Bn,onGoBack:Cn,onAdd:Xn}=He,{variables:na}=He.getVariableSet().useState(),{editIndex:va}=He.useState();if(va!==void 0&&na[va]){const ba=na[va];if(ba)return g.createElement(Hi,{variable:ba,onTypeChange:Bn,onGoBack:Cn,pageNav:tt,navModel:je,dashboard:Ie,onDelete:St,onValidateVariableName:He.onValidateVariableName})}return g.createElement(Ft.Y,{navModel:je,pageNav:tt,layout:Ge.k.Standard},g.createElement(Lt.c,{dashboard:Ie}),g.createElement(Nr,{variables:na,onDelete:St,onDuplicate:$t,onChangeOrder:Yt,onAdd:Xn,onEdit:pn}))}function Hi({variable:He,pageNav:Ie,navModel:je,dashboard:tt,onTypeChange:St,onGoBack:$t,onDelete:Yt,onValidateVariableName:pn}){const Bn=Ie.children.find(na=>na.active);Bn.parentItem=Ie;const{name:Cn}=He.useState(),Xn={text:Cn,parentItem:Bn};return g.createElement(Ft.Y,{navModel:je,pageNav:Xn,layout:Ge.k.Standard},g.createElement(Lt.c,{dashboard:tt}),g.createElement(Ro,{variable:He,onTypeChange:St,onGoBack:$t,onDelete:Yt,onValidateVariableName:pn,key:He.state.key}))}const Si=10;class Mi extends m.Bs{constructor(Ie){super({...Ie,versions:[],isLoading:!0,isAppending:!0,viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}),this._limit=Si,this._start=0,this.fetchVersions=(je=!1)=>{const tt=this._dashboard.state.uid;tt&&(this.setState({isAppending:je}),Dt.wL.getHistoryList(tt,{limit:this._limit,start:this._start}).then(St=>{this.setState({isLoading:!1,versions:[...this.state.versions??[],...this.decorateVersions(St)]}),this._start+=this._limit}).catch(St=>console.log(St)).finally(()=>this.setState({isAppending:!1})))},this.getDiff=async()=>{const je=this.versions.filter(Bn=>Bn.checked),[tt,St]=je,$t=tt.version===this._dashboard.state.version;if(this.setState({isLoading:!0}),!this._dashboard.state.uid)return;const Yt=await Dt.wL.getDashboardVersion(this._dashboard.state.uid,St.version),pn=await Dt.wL.getDashboardVersion(this._dashboard.state.uid,tt.version);this.setState({baseInfo:St,isLoading:!1,isNewLatest:$t,newInfo:tt,viewMode:"compare",diffData:{lhs:Yt.data,rhs:pn.data}})},this.reset=()=>{this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.versions.map(je=>({...je,checked:!1})),viewMode:"list"})},this.onCheck=(je,tt)=>{this.setState({versions:this.versions.map(St=>St.id===tt?{...St,checked:je.currentTarget.checked}:St)})},this.addActivationHandler(()=>{this.fetchVersions()})}static{this.Component=Gi}get _dashboard(){return(0,Se.YQ)(this)}get diffData(){return this.state.diffData??{lhs:"",rhs:""}}get versions(){return this.state.versions??[]}get limit(){return this._limit}get start(){return this._start}getUrlKey(){return"versions"}getDashboard(){return this._dashboard}getTimeRange(){return m.jh.getTimeRange(this._dashboard)}decorateVersions(Ie){const je=this.getTimeRange().getTimeZone();return Ie.map(tt=>({...tt,createdDateString:(0,re.LE)(tt.created,{timeZone:je}),ageString:(0,re.fq)(tt.created,{timeZone:je}),checked:!1}))}}function Gi({model:He}){const Ie=He.getDashboard(),{isLoading:je,isAppending:tt,viewMode:St,baseInfo:$t,newInfo:Yt,isNewLatest:pn}=He.useState(),{navModel:Bn,pageNav:Cn}=wr(Ie,He.getUrlKey()),Xn=He.versions.filter(Ta=>Ta.checked).length===2,na=He.versions.length>1,va=He.versions.length>=He.limit,ba=He.versions.find(Ta=>Ta.version===1),fa=g.createElement(g.Fragment,null,g.createElement(Dt.me,{onClick:He.reset,baseVersion:$t?.version,newVersion:Yt?.version,isNewLatest:pn}),je?g.createElement(ii,{msg:"Fetching changes\u2026"}):g.createElement(Dt.Cc,{newInfo:Yt,baseInfo:$t,isNewLatest:pn,diffData:He.diffData,onRestore:Ie.onRestore})),Ga=g.createElement(g.Fragment,null,je?g.createElement(ii,{msg:"Fetching history list\u2026"}):g.createElement(Dt.bS,{versions:He.versions,onCheck:He.onCheck,canCompare:Xn,onRestore:Ie.onRestore}),tt&&g.createElement(ii,{msg:"Fetching more entries\u2026"}),na&&g.createElement(Dt.rJ,{hasMore:va,canCompare:Xn,getVersions:He.fetchVersions,getDiff:He.getDiff,isLastPage:!!ba}));return g.createElement(Ft.Y,{navModel:Bn,pageNav:Cn,layout:Ge.k.Standard},g.createElement(Lt.c,{dashboard:Ie}),St==="compare"?fa:Ga)}const ii=({msg:He})=>g.createElement(A.B,null,g.createElement(_t.y,null),g.createElement("em",null,He));function wr(He,Ie){const je=(0,pt.zy)(),tt=(0,z.useSelector)(pn=>pn.navIndex),St=(0,u.tc)(tt,"dashboards/browse"),$t=He.getPageNav(je,tt),Yt={text:"Settings",url:t.I.getUrlForPartial(je,{editview:"settings",editIndex:null}),children:[],parentItem:$t};return He.state.meta.canEdit&&(Yt.children.push({text:(0,Mt.t)("dashboard-settings.general.title","General"),url:t.I.getUrlForPartial(je,{editview:"settings",editIndex:null}),active:Ie==="settings"}),Yt.children.push({text:(0,Mt.t)("dashboard-settings.annotations.title","Annotations"),url:t.I.getUrlForPartial(je,{editview:"annotations",editIndex:null}),active:Ie==="annotations"}),Yt.children.push({text:(0,Mt.t)("dashboard-settings.variables.title","Variables"),url:t.I.getUrlForPartial(je,{editview:"variables",editIndex:null}),active:Ie==="variables"}),Yt.children.push({text:(0,Mt.t)("dashboard-settings.links.title","Links"),url:t.I.getUrlForPartial(je,{editview:"links",editIndex:null}),active:Ie==="links"})),He.state.id&&He.state.meta.canSave&&Yt.children.push({text:(0,Mt.t)("dashboard-settings.versions.title","Versions"),url:t.I.getUrlForPartial(je,{editview:"versions",editIndex:null}),active:Ie==="versions"}),He.state.id&&He.state.meta.canAdmin&&ps.TP.hasPermission(z.AccessControlAction.DashboardsPermissionsRead)&&Yt.children.push({text:(0,Mt.t)("dashboard-settings.permissions.title","Permissions"),url:t.I.getUrlForPartial(je,{editview:"permissions",editIndex:null}),active:Ie==="permissions"}),Yt.children.push({text:(0,Mt.t)("dashboard-settings.json-editor.title","JSON Model"),url:t.I.getUrlForPartial(je,{editview:"json-model",editIndex:null}),active:Ie==="json-model"}),{navModel:St,pageNav:Yt}}function ho(He){switch(He){case"annotations":return new Js({});case"variables":return new ki({});case"links":return new Pt({});case"versions":return new Mi({});case"json-model":return new $r({});case"permissions":return new ys({});case"settings":default:return new Us({})}}class Uo extends m.Bs{constructor(Ie){super(Ie),this.addActivationHandler(this._activationHandler.bind(this))}_activationHandler(){const Ie=this.state.panelRef.resolve(),je=m.Go.cloneSceneObjectState(Ie.state,{key:Ie.state.key+"-view",$variables:this.getScopedVariables(Ie)}),tt=new m.Eb(je);return this.setState({body:tt}),()=>{tt.state.$data&&Ie.setState({$data:tt.state.$data.clone()})}}getScopedVariables(Ie){const je=Qo(Ie),tt=[];if(je&&je.state.$variables)for(const St of je.state.$variables.state.variables)tt.push(St.clone());if(Ie.state.$variables)for(const St of Ie.state.$variables.state.variables)tt.push(St.clone());if(tt.length>0)return new m.Pj({variables:tt})}getUrlKey(){return this.state.panelRef.resolve().state.key}static{this.Component=({model:Ie})=>{const{body:je}=Ie.useState();return je?g.createElement(je.Component,{model:je}):null}}}function Qo(He){try{return m.jh.getAncestor(He,m.tI)}catch{return}}var qr=e(30195);class ji{constructor(Ie){this._scene=Ie}getKeys(){return["inspect","viewPanel","editPanel","editview","autofitpanels"]}getUrlState(){const Ie=this._scene.state;return{inspect:Ie.inspectPanelKey,autofitpanels:Ie.body instanceof m.hy&&Ie.body.state.UNSAFE_fitPanels?"true":void 0,viewPanel:Ie.viewPanelScene?.getUrlKey(),editview:Ie.editview?.getUrlKey(),editPanel:Ie.editPanel?.getUrlKey()||void 0}}updateFromUrl(Ie){const{inspectPanelKey:je,viewPanelScene:tt,isEditing:St,editPanel:$t}=this._scene.state,Yt={};if(typeof Ie.editview=="string"&&this._scene.canEditDashboard()?(Yt.editview=ho(Ie.editview),St||(this._scene.state.editable?setTimeout(()=>this._scene.onEnterEditMode()):Yt.editview=void 0)):Ie.hasOwnProperty("editview")&&(Yt.editview=void 0),typeof Ie.inspect=="string"){let pn=(0,Se.vL)(this._scene,Ie.inspect);if(!pn){l.A.emit(n.r1.alertError,["Panel not found"]),o.Ny.partial({inspect:null});return}if((0,Se.Yr)(pn)){this._handleLibraryPanel(pn,Bn=>{if(Bn.state.key===void 0)throw new Error("library panel key is undefined");const Cn=new Ts({$behaviors:[new No({panelKey:Bn.state.key})]});this._scene.setState({overlay:Cn,inspectPanelKey:Bn.state.key})});return}Yt.inspectPanelKey=Ie.inspect,Yt.overlay=new Ts({$behaviors:[new No({panelKey:Ie.inspect})]})}else je&&(Yt.inspectPanelKey=void 0,Yt.overlay=void 0);if(typeof Ie.viewPanel=="string"){const pn=(0,Se.vL)(this._scene,Ie.viewPanel);if(!pn){if((0,Se.SN)(Ie.viewPanel)){this._handleViewRepeatClone(Ie.viewPanel);return}l.A.emit(n.r1.alertError,["Panel not found"]),o.Ny.partial({viewPanel:null});return}if((0,Se.Yr)(pn)){this._handleLibraryPanel(pn,Bn=>this._buildLibraryPanelViewScene(Bn));return}Yt.viewPanelScene=new Uo({panelRef:pn.getRef()})}else tt&&Ie.viewPanel===null&&(Yt.viewPanelScene=void 0);if(typeof Ie.editPanel=="string"){const pn=(0,Se.vL)(this._scene,Ie.editPanel);if(!pn){console.warn(`Panel ${Ie.editPanel} not found`);return}if(this._scene.state.viewPanelScene&&this._scene.setState({viewPanelScene:void 0}),St||this._scene.onEnterEditMode(),(0,Se.Yr)(pn)){this._handleLibraryPanel(pn,Bn=>{this._scene.setState({editPanel:(0,gs.L)(Bn)})});return}Yt.editPanel=(0,gs.L)(pn)}else $t&&Ie.editPanel===null&&(Yt.editPanel=void 0);if(this._scene.state.body instanceof m.hy){const pn=typeof Ie.autofitpanels=="string";!!this._scene.state.body.state.UNSAFE_fitPanels!==pn&&this._scene.state.body.setState({UNSAFE_fitPanels:pn})}Object.keys(Yt).length>0&&this._scene.setState(Yt)}_buildLibraryPanelViewScene(Ie){this._scene.setState({viewPanelScene:new Uo({panelRef:Ie.getRef()})})}_handleLibraryPanel(Ie,je){if(!(Ie.parent instanceof lt.F))throw new Error("Panel is not a child of a LibraryVizPanel");const tt=Ie.parent;tt.state.isLoaded?je(Ie):(tt.subscribeToState(St=>{je(St.panel)}),tt.activate())}_handleViewRepeatClone(Ie){this._eventSub||(this._eventSub=this._scene.subscribeToEvent(qr.d,()=>{const je=(0,Se.vL)(this._scene,Ie);je&&(this._eventSub?.unsubscribe(),this._scene.setState({viewPanelScene:new Uo({panelRef:je.getRef()})}))}))}}class No extends m.Bs{constructor(Ie){super(Ie),this._onActivate=()=>{const je=this.parent;if(!je||!(je instanceof Ts))throw new Error("ResolveInspectPanelByKey must be attached to a PanelInspectDrawer");const tt=(0,Se.YQ)(je);if(!tt)return;const St=this.state.panelKey;let $t=(0,Se.vL)(tt,St);tt.state.editPanel&&($t=tt.state.editPanel.state.vizManager.state.panel),tt.state.viewPanelScene&&tt.state.viewPanelScene.state.body&&($t=tt.state.viewPanelScene.state.body),$t&&je.setState({panelRef:$t.getRef()})},this.addActivationHandler(this._onActivate)}}var xi=e(79284),Yo=e(54625),li=e(76885),rr=e(83277),eo=e(2468);const Lr="scope.grafana.app",wo="v0alpha1",Qi=r.$.namespace??"default",_r=`/apis/${Lr}/${wo}/namespaces/${Qi}/find/scope_node_children`,Fr=`/apis/${Lr}/${wo}/namespaces/${Qi}/find/scope_dashboard_bindings`,Fo=new eo.w({group:Lr,version:wo,resource:"scopes"}),vo=new Map;async function mr(He,Ie){try{return(await(0,K.AI)().get(_r,{parent:He,query:Ie}))?.items??[]}catch{return[]}}async function Jo(He,Ie){return(await mr(He,Ie)).reduce((je,{metadata:{name:tt},spec:St})=>(je[tt]={name:tt,...St,isExpandable:St.nodeType==="container",isSelectable:St.linkType==="scope",isExpanded:!1,query:"",nodes:{}},je),{})}async function Or(He){if(vo.has(He))return vo.get(He);const Ie=new Promise(async je=>{const tt={metadata:{name:He},spec:{filters:[],title:He,type:"",category:"",description:""}};try{const St=await Fo.get(He),$t={...tt,metadata:{...tt.metadata,...St.metadata},spec:{...tt.spec,...St.spec}};je($t)}catch{vo.delete(He),je(tt)}});return vo.set(He,Ie),Ie}async function Yi(He){return await Promise.all(He.map(Or))}async function Wo(He){try{return(await(0,K.AI)().get(Fr,{scope:He.map(({metadata:{name:je}})=>je)}))?.items??[]}catch{return[]}}class to extends m.Bs{static{this.Component=Ji}constructor(){super({dashboards:[],filteredDashboards:[],isLoading:!1,searchQuery:""})}async fetchDashboards(Ie){if(Ie.length===0)return this.setState({dashboards:[],filteredDashboards:[],isLoading:!1});this.setState({isLoading:!0});const je=await Wo(Ie);this.setState({dashboards:je,filteredDashboards:this.filterDashboards(je,this.state.searchQuery),isLoading:!1})}changeSearchQuery(Ie){this.setState({filteredDashboards:Ie?this.filterDashboards(this.state.dashboards,Ie):this.state.dashboards,searchQuery:Ie??""})}filterDashboards(Ie,je){const tt=je.toLowerCase();return Ie.filter(({spec:{dashboardTitle:St}})=>St.toLowerCase().includes(tt))}}function Ji({model:He}){const{filteredDashboards:Ie,isLoading:je}=He.useState(),tt=(0,qe.of)(Oi),[St]=(0,rr.s)();return g.createElement(g.Fragment,null,g.createElement("div",{className:tt.searchInputContainer},g.createElement(B.p,{prefix:g.createElement(Rt.I,{name:"search"}),placeholder:(0,Mt.t)("scopes.suggestedDashboards.search","Filter"),disabled:je,"data-testid":"scopes-dashboards-search",onChange:$t=>He.changeSearchQuery($t.currentTarget.value)})),je?g.createElement(Io._,{className:tt.loadingIndicator,text:(0,Mt.t)("scopes.suggestedDashboards.loading","Loading dashboards"),"data-testid":"scopes-dashboards-loading"}):g.createElement(bt.E,null,Ie.map(({spec:{dashboard:$t,dashboardTitle:Yt}})=>g.createElement(Yo.Link,{key:$t,to:li.kM.renderUrl(`/d/${$t}/`,St),className:tt.dashboardItem,"data-testid":`scopes-dashboards-${$t}`},Yt))))}const Oi=He=>({searchInputContainer:(0,ve.css)({flex:"0 1 auto"}),loadingIndicator:(0,ve.css)({alignSelf:"center"}),dashboardItem:(0,ve.css)({padding:He.spacing(1,0),borderBottom:`1px solid ${He.colors.border.weak}`,"& :is(:first-child)":{paddingTop:0}})});function Eo({showQuery:He,nodes:Ie,nodePath:je,loadingNodeName:tt,scopeNames:St,onNodeUpdate:$t,onNodeSelectToggle:Yt}){const pn=(0,qe.of)(Xi),Bn=je[je.length-1],Cn=Ie[Bn],Xn=Cn.nodes,na=Object.values(Xn),va=na.some(({isExpanded:fa})=>fa),ba=na.some(({linkId:fa})=>fa&&St.includes(fa));return g.createElement(g.Fragment,null,He&&!va&&g.createElement(B.p,{prefix:g.createElement(Rt.I,{name:"filter"}),className:pn.searchInput,disabled:!!tt,placeholder:(0,Mt.t)("scopes.tree.search","Filter"),defaultValue:Cn.query,"data-testid":`scopes-tree-${Bn}-search`,onChange:(0,Mn.debounce)(fa=>{$t(je,!0,fa.target.value)},500)}),g.createElement("div",{role:"tree"},na.map(fa=>{const Ga=fa.isSelectable&&St.includes(fa.linkId);if(va&&!fa.isExpanded&&!Ga)return null;const Ta=[...je,fa.name];return g.createElement("div",{key:fa.name,role:"treeitem","aria-selected":fa.isExpanded},g.createElement("div",{className:pn.itemTitle},fa.isSelectable&&!fa.isExpanded?g.createElement(de.S,{checked:Ga,disabled:!!tt||ba&&!Ga&&Cn.disableMultiSelect,"data-testid":`scopes-tree-${fa.name}-checkbox`,onChange:()=>{Yt(Ta)}}):null,fa.isExpandable&&g.createElement(cr.K,{disabled:ba&&!fa.isExpanded||!!tt,name:fa.isExpanded?tt===fa.name?"spinner":"angle-down":"angle-right","aria-label":fa.isExpanded?(0,Mt.t)("scopes.tree.collapse","Collapse"):(0,Mt.t)("scopes.tree.expand","Expand"),"data-testid":`scopes-tree-${fa.name}-expand`,onClick:()=>{$t(Ta,!fa.isExpanded,fa.query)}}),g.createElement("span",{"data-testid":`scopes-tree-${fa.name}-title`},fa.title)),g.createElement("div",{className:pn.itemChildren},fa.isExpanded&&g.createElement(Eo,{showQuery:He,nodes:Cn.nodes,nodePath:Ta,loadingNodeName:tt,scopeNames:St,onNodeUpdate:$t,onNodeSelectToggle:Yt})))})))}const Xi=He=>({searchInput:(0,ve.css)({margin:He.spacing(1,0)}),itemTitle:(0,ve.css)({alignItems:"center",display:"flex",gap:He.spacing(1),fontSize:He.typography.pxToRem(14),lineHeight:He.typography.pxToRem(22),padding:He.spacing(.5,0)}),itemChildren:(0,ve.css)({paddingLeft:He.spacing(4)})});function Zi({model:He}){const Ie=(0,qe.of)(ci),{nodes:je,loadingNodeName:tt,dirtyScopeNames:St,isLoadingScopes:$t,isAdvancedOpened:Yt}=He.useState();return Yt?g.createElement(v._,{title:(0,Mt.t)("scopes.advancedSelector.title","Select scopes"),size:"sm",onClose:()=>{He.closeAdvancedSelector(),He.resetDirtyScopeNames()}},$t?g.createElement(_t.y,{"data-testid":"scopes-advanced-loading"}):g.createElement(Eo,{showQuery:!0,nodes:je,nodePath:[""],loadingNodeName:tt,scopeNames:St,onNodeUpdate:(pn,Bn,Cn)=>He.updateNode(pn,Bn,Cn),onNodeSelectToggle:pn=>He.toggleNodeSelect(pn)}),g.createElement("div",{className:Ie.buttonGroup},g.createElement(b.$n,{variant:"primary","data-testid":"scopes-advanced-apply",onClick:()=>{He.closeAdvancedSelector(),He.updateScopes()}},g.createElement(Mt.x6,{i18nKey:"scopes.advancedSelector.apply"},"Apply")),g.createElement(b.$n,{variant:"secondary","data-testid":"scopes-advanced-cancel",onClick:()=>{He.closeAdvancedSelector(),He.resetDirtyScopeNames()}},g.createElement(Mt.x6,{i18nKey:"scopes.advancedSelector.cancel"},"Cancel")))):null}const ci=He=>({buttonGroup:(0,ve.css)({display:"flex",gap:He.spacing(1),marginTop:He.spacing(8)})});var di=e(60782);function Ii({model:He}){const Ie=(0,qe.of)(ke),{nodes:je,loadingNodeName:tt,scopes:St,dirtyScopeNames:$t,isLoadingScopes:Yt,isBasicOpened:pn}=He.useState(),{isViewing:Bn}=He.scopesParent.useState(),Cn=St.map(({spec:{title:Xn}})=>Xn).join(", ");return g.createElement("div",{className:Ie.container,"data-testid":"scopes-basic-container"},g.createElement(di.G,{show:pn,closeButton:!1,content:g.createElement("div",{className:Ie.innerContainer,"data-testid":"scopes-basic-inner-container"},Yt?g.createElement(_t.y,{"data-testid":"scopes-basic-loading"}):g.createElement(Eo,{showQuery:!1,nodes:je,nodePath:[""],loadingNodeName:tt,scopeNames:$t,onNodeUpdate:(Xn,na,va)=>He.updateNode(Xn,na,va),onNodeSelectToggle:Xn=>He.toggleNodeSelect(Xn)})),footer:g.createElement("button",{className:Ie.openAdvancedButton,"data-testid":"scopes-basic-open-advanced",onClick:()=>He.openAdvancedSelector()},g.createElement(Mt.x6,{i18nKey:"scopes.basicSelector.openAdvanced"},"Open advanced scope selector ",g.createElement(Rt.I,{name:"arrow-right"}))),onOpen:()=>He.openBasicSelector(),onClose:()=>{He.closeBasicSelector(),He.updateScopes()}},g.createElement(B.p,{readOnly:!0,placeholder:(0,Mt.t)("scopes.basicSelector.placeholder","Select scopes..."),loading:Yt,value:Cn,"aria-label":(0,Mt.t)("scopes.basicSelector.placeholder","Select scopes..."),"data-testid":"scopes-basic-input",suffix:St.length>0&&!Bn?g.createElement(cr.K,{"aria-label":(0,Mt.t)("scopes.basicSelector.removeAll","Remove all scopes"),name:"times",onClick:()=>He.removeAllScopes()}):void 0})))}const ke=He=>({container:(0,ve.css)({width:"100%","& > div":(0,ve.css)({padding:0,"& > div":(0,ve.css)({padding:0,margin:0})})}),innerContainer:(0,ve.css)({minWidth:400,padding:He.spacing(0,1)}),openAdvancedButton:(0,ve.css)({backgroundColor:He.colors.secondary.main,border:"none",borderTop:`1px solid ${He.colors.secondary.border}`,display:"block",fontSize:He.typography.pxToRem(12),margin:0,padding:He.spacing(1.5),textAlign:"right",width:"100%"})});class Ye extends m.Bs{constructor(){super({nodes:{"":{name:"",nodeType:"container",title:"",isExpandable:!0,isSelectable:!1,isExpanded:!0,query:"",nodes:{}}},loadingNodeName:void 0,scopes:[],dirtyScopeNames:[],isLoadingScopes:!1,isBasicOpened:!1,isAdvancedOpened:!1}),this._urlSync=new m.So(this,{keys:["scopes"]}),this.addActivationHandler(()=>{this.fetchBaseNodes()})}static{this.Component=Ze}get scopesParent(){return m.jh.getAncestor(this,ct)}getUrlState(){return{scopes:this.getScopeNames()}}updateFromUrl(Ie){let je=Ie.scopes??[];je=Array.isArray(je)?je:[je],this.updateScopes(je)}fetchBaseNodes(){return this.updateNode([""],!0,"")}async updateNode(Ie,je,tt){let St={...this.state.nodes},$t=St;for(let Bn=0;Bn<Ie.length-1;Bn++)$t=$t[Ie[Bn]].nodes;const Yt=Ie[Ie.length-1],pn=$t[Yt];(je||pn.query!==tt)&&(this.setState({loadingNodeName:Yt}),pn.nodes=await Jo(Yt,tt)),pn.isExpanded=je,pn.query=tt,this.setState({nodes:St,loadingNodeName:void 0})}toggleNodeSelect(Ie){let je=[...this.state.dirtyScopeNames],tt=this.state.nodes;for(let pn=0;pn<Ie.length-1;pn++)tt=tt[Ie[pn]].nodes;const St=Ie[Ie.length-1],{linkId:$t}=tt[St],Yt=je.findIndex(pn=>pn===$t);if(Yt===-1){Or($t);const pn=je.length===0||Object.values(tt).some(({linkId:Bn})=>Bn===je[0]);this.setState({dirtyScopeNames:pn?[...je,$t]:[$t]})}else je.splice(Yt,1),this.setState({dirtyScopeNames:je})}openBasicSelector(){this.scopesParent.state.isViewing||this.setState({isBasicOpened:!0,isAdvancedOpened:!1})}closeBasicSelector(){this.setState({isBasicOpened:!1})}openAdvancedSelector(){this.scopesParent.state.isViewing||this.setState({isBasicOpened:!1,isAdvancedOpened:!0})}closeAdvancedSelector(){this.setState({isAdvancedOpened:!1})}getSelectedScopes(){return this.state.scopes}async updateScopes(Ie=this.state.dirtyScopeNames){(0,Mn.isEqual)(Ie,this.getScopeNames())||(this.setState({dirtyScopeNames:Ie,isLoadingScopes:!0}),this.setState({scopes:await Yi(Ie),isLoadingScopes:!1}))}resetDirtyScopeNames(){this.setState({dirtyScopeNames:this.getScopeNames()})}removeAllScopes(){this.setState({scopes:[],dirtyScopeNames:[],isLoadingScopes:!1})}enterViewMode(){this.setState({isBasicOpened:!1,isAdvancedOpened:!1})}getScopeNames(){return this.state.scopes.map(({metadata:{name:Ie}})=>Ie)}}function Ze({model:He}){return g.createElement(g.Fragment,null,g.createElement(Ii,{model:He}),g.createElement(Zi,{model:He}))}class ct extends m.Bs{static{this.Component=It}constructor(){super({dashboards:new to,filters:new Ye,isExpanded:!1,isViewing:!1}),this.addActivationHandler(()=>{this._subs.add(this.state.filters.subscribeToState((Ie,je)=>{Ie.scopes!==je.scopes&&(this.state.isExpanded&&this.state.dashboards.fetchDashboards(Ie.scopes),m.jh.getTimeRange(this.parent).onRefresh())})),this._subs.add(this.parent?.subscribeToState(Ie=>{const je="isEditing"in Ie?!!Ie.isEditing:!1;je!==this.state.isViewing&&(je?this.enterViewMode():this.exitViewMode())}))})}getSelectedScopes(){return this.state.filters.getSelectedScopes()}toggleIsExpanded(){const Ie=!this.state.isExpanded;Ie&&this.state.dashboards.fetchDashboards(this.getSelectedScopes()),this.setState({isExpanded:Ie})}enterViewMode(){this.setState({isExpanded:!1,isViewing:!0}),this.state.filters.enterViewMode()}exitViewMode(){this.setState({isViewing:!1})}}function It({model:He}){const{filters:Ie,dashboards:je,isExpanded:tt,isViewing:St}=He.useState(),$t=(0,qe.of)(Ht);return g.createElement("div",{className:(0,ve.cx)($t.container,tt&&$t.containerExpanded)},g.createElement("div",{className:(0,ve.cx)($t.filtersContainer,tt&&$t.filtersContainerExpanded)},!St&&g.createElement(cr.K,{name:"arrow-to-right",className:(0,ve.cx)(!tt&&$t.iconNotExpanded),"aria-label":tt?(0,Mt.t)("scopes.root.collapse","Collapse scope filters"):(0,Mt.t)("scopes.root.expand","Expand scope filters"),"data-testid":"scopes-root-expand",onClick:()=>He.toggleIsExpanded()}),g.createElement(Ie.Component,{model:Ie})),tt&&!St&&g.createElement("div",{className:$t.dashboardsContainer,"data-testid":"scopes-dashboards-container"},g.createElement(je.Component,{model:je})))}const Ht=He=>({container:(0,ve.css)({display:"flex",flexDirection:"column",gridArea:"scopes"}),containerExpanded:(0,ve.css)({backgroundColor:He.colors.background.primary,height:"100%"}),filtersContainer:(0,ve.css)({display:"flex",flex:"0 1 auto",flexDirection:"row",padding:He.spacing(2,2,2,2)}),filtersContainerExpanded:(0,ve.css)({borderBottom:`1px solid ${He.colors.border.weak}`,padding:He.spacing(2)}),iconNotExpanded:(0,ve.css)({transform:"scaleX(-1)"}),dashboardsContainer:(0,ve.css)({display:"flex",flex:"1 1 auto",flexDirection:"column",gap:He.spacing(3),overflow:"hidden",padding:He.spacing(2)})});var tn=e(69129),dn=e(4898);class yn{constructor(){this._binds=[]}addBinding(Ie){dn.R.bind(Ie.key,je=>{je.preventDefault(),je.stopPropagation(),je.returnValue=!1,Ie.onTrigger()},"keydown"),this._binds.push(Ie)}removeAll(){this._binds.forEach(Ie=>{dn.R.unbind(Ie.key,Ie.type)}),this._binds=[]}}var Rn=e(58441),Yn=e(7196);function qn(He){const Ie=new yn;let je=null;const tt=l.A.subscribe(tn.Tp,$t=>{typeof $t.payload.panelId=="string"&&(je=$t.payload.panelId)});function St($t,Yt){return()=>{const pn=m.jh.findObject($t,Bn=>Bn.state.key===je);if(pn&&pn instanceof m.Eb){Yt(pn);return}}}return Ie.addBinding({key:"v",onTrigger:St(He,$t=>{He.state.viewPanelScene||o.Ny.push((0,rt.r7)($t))})}),Ie.addBinding({key:"e",onTrigger:St(He,async $t=>{if($t.getRoot()instanceof ma){const pn=(0,Se.Cs)($t);He.state.editPanel||o.Ny.push((0,rt.e0)(pn))}})}),Ie.addBinding({key:"p s",onTrigger:St(He,async $t=>{He.showModal(new Rn.Z({panelRef:$t.getRef(),dashboardRef:He.getRef()}))})}),Ie.addBinding({key:"i",onTrigger:St(He,async $t=>{o.Ny.push((0,rt.Uu)($t))})}),Ie.addBinding({key:"p x",onTrigger:St(He,async $t=>{const Yt=await(0,rt.Lp)($t);Yt&&o.Ny.push(Yt)})}),Ie.addBinding({key:"p l",onTrigger:St(He,Yn.vR)}),Ie.addBinding({key:"d r",onTrigger:()=>m.jh.getTimeRange(He).onRefresh()}),Ie.addBinding({key:"t z",onTrigger:()=>{Jn(He)}}),Ie.addBinding({key:"ctrl+z",onTrigger:()=>{Jn(He)}}),Ie.addBinding({key:"t left",onTrigger:()=>{ca(He,"left")}}),Ie.addBinding({key:"t right",onTrigger:()=>{ca(He,"right")}}),Ie.addBinding({key:"d s",onTrigger:He.onOpenSettings}),Ie.addBinding({key:"mod+s",onTrigger:()=>He.openSaveDrawer({})}),Ie.addBinding({key:"p r",onTrigger:St(He,$t=>{He.state.isEditing&&(0,Yn.MI)(He,$t)})}),Ie.addBinding({key:"p d",onTrigger:St(He,$t=>{He.state.isEditing&&He.duplicatePanel($t)})}),()=>{Ie.removeAll(),tt.unsubscribe()}}function Jn(He){Ke.b4.getTimePicker(He)?.onZoom()}function ca(He,Ie){const je=Ke.b4.getTimePicker(He);je&&(Ie==="left"&&je.onMoveBackward(),Ie==="right"&&je.onMoveForward())}const Oa=["title","description","tags","editable","graphTooltip","links","meta"];class ma extends m.Bs{constructor(Ie){super({title:"Dashboard",meta:{},editable:!0,body:Ie.body??new m.G1({children:[]}),links:Ie.links??[],hasCopiedPanel:d.A.exists(i.tH),scopes:Ie.uid&&r.$.featureToggles.scopeFilters?new ct:void 0,...Ie}),this._urlSync=new ji(this),this._variableDependency=new $a(this),this._fromExplore=!1,this.onEnterEditMode=(je=!1)=>{this._fromExplore=je,this._initialState=m.Go.cloneSceneObjectState(this.state),this._initialUrlState=o.Ny.getLocation(),this.setState({isEditing:!0}),this.propagateEditModeChange(),this._changeTracker.startTrackingChanges()},this.onRestore=async je=>{const tt=await Dt.wL.restoreDashboard(je.uid,je.version);if(!Number.isInteger(tt.version))return!1;const St={dashboard:new c.G(je.data),meta:this.state.meta},$t=(0,gt.wM)(St),Yt=m.Go.cloneSceneObjectState($t.state);return Yt.version=tt.version,this.setState(Yt),this.exitEditMode({skipConfirm:!0,restoreInitialState:!1}),!0},this.onOpenSettings=()=>{o.Ny.partial({editview:"settings"})},this._changeTracker=new E.l(this),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=Qt}_activationHandler(){let Ie=window.__grafanaSceneContext;window.__grafanaSceneContext=this,this.state.isEditing&&(this._initialUrlState=o.Ny.getLocation(),this._changeTracker.startTrackingChanges()),this.state.meta.isNew&&(this.onEnterEditMode(),this.setState({isDirty:!0})),!this.state.meta.isEmbedded&&this.state.uid&&y.t.watch(this.state.uid);let je=()=>{};r.$.publicDashboardAccessToken||(je=qn(this));const tt=new Be(this);return(0,p.UA)().setCurrent(tt),()=>{window.__grafanaSceneContext=Ie,je(),this._changeTracker.terminate(),this.stopUrlSync(),tt.destroy(),y.t.leave()}}startUrlSync(){this.state.meta.isEmbedded||(0,m.Is)().initSync(this)}stopUrlSync(){(0,m.Is)().cleanUp(this)}saveCompleted(Ie,je,tt){this._initialSaveModel={...Ie,id:je.id,uid:je.uid,version:je.version},this._changeTracker.stopTrackingChanges(),this.setState({version:je.version,isDirty:!1,uid:je.uid,id:je.id,meta:{...this.state.meta,uid:je.uid,url:je.url,slug:je.slug,folderUid:tt,isNew:!1}}),this._changeTracker.startTrackingChanges()}propagateEditModeChange(){this.state.body instanceof m.hy&&(this.state.body.setState({isDraggable:this.state.isEditing,isResizable:this.state.isEditing}),(0,Se.X0)(this.state.body,!0))}exitEditMode({skipConfirm:Ie,restoreInitialState:je}){if(!this.canDiscard()){console.error("Trying to discard back to a state that does not exist, initialState undefined");return}if(!this.state.isDirty||Ie){this.exitEditModeConfirmed(je||this.state.isDirty);return}l.A.publish(new a.bY({title:"Discard changes to dashboard?",text:"You have unsaved changes to this dashboard. Are you sure you want to discard them?",icon:"trash-alt",yesText:"Discard",onConfirm:this.exitEditModeConfirmed.bind(this)}))}exitEditModeConfirmed(Ie=!0){this._changeTracker.stopTrackingChanges(),this.stopUrlSync(),o.Ny.replace(t.I.getUrlForPartial(this._initialUrlState,{editPanel:null,editview:null,inspect:null,inspectTab:null})),this._fromExplore&&this.cleanupStateFromExplore(),Ie?this.setState({...this._initialState,isEditing:!1}):this.setState({isEditing:!1}),this.startUrlSync(),this.propagateEditModeChange()}cleanupStateFromExplore(){this._fromExplore=!1,this._initialSaveModel?.panels&&(this._initialSaveModel.panels=this._initialSaveModel.panels.slice(1)),this._initialState&&this._initialState.body instanceof m.hy&&this._initialState.body.setState({children:this._initialState.body.state.children.slice(1)})}canDiscard(){return this._initialState!==void 0}pauseTrackingChanges(){this._changeTracker.stopTrackingChanges()}resumeTrackingChanges(){this._changeTracker.startTrackingChanges()}openSaveDrawer({saveAsCopy:Ie,onSaveSuccess:je}){this.state.isEditing&&this.setState({overlay:new Xe({dashboardRef:this.getRef(),saveAsCopy:Ie,onSaveSuccess:je})})}getPageNav(Ie,je){const{meta:tt,viewPanelScene:St,editPanel:$t}=this.state;let Yt={text:this.state.title,url:(0,rt.uZ)({uid:this.state.uid,slug:tt.slug,currentQueryParams:Ie.search,updateQuery:{viewPanel:null,inspect:null,editview:null,editPanel:null,tab:null},isHomeDashboard:!tt.url&&!tt.slug&&!tt.isNew})};const{folderUid:pn}=tt;if(pn){const Bn=(0,u.tc)(je,`folder-dashboards-${pn}`).main;Bn.id!=="not-found"&&(Yt={...Yt,parentItem:Bn})}return St&&(Yt={text:"View panel",parentItem:Yt,url:(0,rt.r7)(St.state.panelRef.resolve())}),$t&&(Yt={text:"Edit panel",parentItem:Yt}),Yt}getBodyToRender(){return this.state.viewPanelScene??this.state.body}getInitialState(){return this._initialState}addRow(Ie){if(!(this.state.body instanceof m.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const je=this.state.body,tt=je.state.children.findIndex($t=>$t instanceof m.tI),St=je.state.children.splice(0,tt===-1?je.state.children.length:tt).map($t=>$t.clone());St&&Ie.setState({children:St}),je.setState({children:[Ie,...je.state.children]})}removeRow(Ie,je=!1){if(!(this.state.body instanceof m.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const tt=this.state.body,St=tt.state.children.filter($t=>$t.state.key!==Ie.state.key);if(!je){const $t=Ie.state.children.map(pn=>pn.clone()),Yt=tt.state.children.findIndex(pn=>pn.state.key===Ie.state.key);St.splice(Yt,0,...$t)}tt.setState({children:St})}addPanel(Ie){if(!(this.state.body instanceof m.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const je=this.state.body,tt=(0,Se.Cs)(Ie),St=new oe.U({height:Se.sw,width:Se.vm,x:0,y:0,body:Ie,key:`grid-item-${tt}`});je.setState({children:[St,...je.state.children]})}createLibraryPanel(Ie,je){if(!(this.state.body instanceof m.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const St=Ie.state.key,$t=new lt.F({title:je.model?.title??"Panel",uid:je.uid,name:je.name,panelKey:St??(0,Se.XA)(Ke.b4.getNextPanelId(this))}),Yt=Ie.parent;if(!(Yt instanceof oe.U))throw new Error("Trying to replace a panel that doesn't have a parent grid item");Yt.setState({body:$t})}duplicatePanel(Ie){if(!Ie.parent)return;const je=(0,Ke.WZ)(Ie),tt=je?je.parent:Ie.parent;if(!(tt instanceof oe.U)){console.error("Trying to duplicate a panel in a layout that is not DashboardGridItem");return}let St,$t,Yt;const pn=Ke.b4.getNextPanelId(this);if(je){const Cn=m.Go.cloneSceneObjectState(tt.state);Yt=new oe.U({x:Cn.x,y:Cn.y,width:Cn.width,height:Cn.height,body:new lt.F({title:je.state.title,uid:je.state.uid,name:je.state.name,panelKey:(0,Se.XA)(pn)})})}else tt instanceof oe.U?(St=m.Go.cloneSceneObjectState(tt.state.body.state),$t=m.jh.getData(tt.state.body).clone()):(St=m.Go.cloneSceneObjectState(Ie.state),$t=m.jh.getData(Ie).clone()),delete $t.state.data?.alertState,Yt=new oe.U({x:tt.state.x,y:tt.state.y,height:Se.sw,width:Se.vm,body:new m.Eb({...St,$data:$t,key:(0,Se.XA)(pn)})});if(!(this.state.body instanceof m.hy)){console.error("Trying to duplicate a panel in a layout that is not SceneGridLayout ");return}const Bn=this.state.body;if(tt.parent instanceof m.tI){const Cn=tt.parent;Cn.setState({children:[...Cn.state.children,Yt]}),Bn.forceRender();return}Bn.setState({children:[...Bn.state.children,Yt]})}copyPanel(Ie){if(!Ie.parent)return;let je=Ie.parent;if(Ie.parent instanceof lt.F){const St=Ie.parent;if(!St.parent)return;je=St.parent}if(!(je instanceof oe.U))throw console.error("Trying to copy a panel that is not DashboardGridItem child"),new Error("Trying to copy a panel that is not DashboardGridItem child");const tt=(0,xe.ZB)(je);d.A.set(i.tH,JSON.stringify(tt)),l.A.emit(n.r1.alertSuccess,["Panel copied. Use **Paste panel** toolbar action to paste."]),this.setState({hasCopiedPanel:!0})}pastePanel(){if(!(this.state.body instanceof m.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const Ie=d.A.get(i.tH),je=JSON.parse(Ie),tt=new c.a(je),St=tt.libraryPanel?(0,gt.Al)(tt):(0,gt.tt)(tt),$t=this.state.body;if(!(St instanceof oe.U))throw new Error("Cannot paste invalid grid item");const Yt=Ke.b4.getNextPanelId(this);if(St instanceof oe.U&&St.state.body instanceof lt.F){const pn=(0,Se.XA)(Yt);St.state.body.setState({panelKey:pn});const Bn=St.state.body.state.panel;Bn instanceof m.Eb&&Bn.setState({key:pn})}else St instanceof oe.U&&St.state.body?St.state.body.setState({key:(0,Se.XA)(Yt)}):St instanceof oe.U&&St.state.body.setState({key:(0,Se.XA)(Yt)});St.setState({height:Se.sw,width:Se.vm,x:0,y:0,key:`grid-item-${Yt}`}),$t.setState({children:[St,...$t.state.children]}),this.setState({hasCopiedPanel:!1}),d.A.delete(i.tH)}removePanel(Ie){const je=[],tt=Ie.parent instanceof lt.F?Ie.parent.parent?.state.key:Ie.parent?.state.key;if(!tt)return;let St;try{St=m.jh.getAncestor(Ie,m.tI)}catch{St=void 0}if(St){St.state.children.forEach(Yt=>{Yt.state.key!==tt&&je.push(Yt)}),St.setState({children:je}),this.state.body.forceRender();return}this.state.body.forEachChild(Yt=>{Yt.state.key!==tt&&je.push(Yt)});const $t=this.state.body;($t instanceof m.hy||$t instanceof m.G1)&&$t.setState({children:je})}unlinkLibraryPanel(Ie){if(!Ie.parent)return;const je=Ie.parent;if(!(je instanceof oe.U)){console.error("Trying to unlinka a lib panel in a layout that is not DashboardGridItem");return}je?.setState({body:Ie.state.panel?.clone()})}showModal(Ie){this.setState({overlay:Ie})}closeModal(){this.setState({overlay:void 0})}async onStarDashboard(){const{meta:Ie,uid:je}=this.state;if(je)try{const tt=await(0,p.UA)().starDashboard(je,!!Ie.isStarred);this.setState({meta:{...Ie,isStarred:tt}})}catch(tt){console.error("Failed to star dashboard",tt)}}onShowAddLibraryPanelDrawer(Ie){this.setState({overlay:new ft.o({panelToReplaceRef:Ie})})}onCreateNewRow(){const Ie=(0,Se.Ws)(this);return this.addRow(Ie),(0,Se.Cs)(Ie)}onCreateNewPanel(){this.state.isEditing||this.onEnterEditMode();const Ie=(0,Se.O8)(this);return this.addPanel(Ie),Ie}enrichDataRequest(Ie){const je=(0,Se.YQ)(Ie);let tt=(0,Se.xz)(Ie);je.state.isEditing&&je.state.editPanel&&(tt=je.state.editPanel.state.vizManager.state.panel);let St=0;return tt&&tt.state.key&&((0,Se.SN)(tt.state.key)?St=it(tt?.state.key):St=(0,Se.Cs)(tt)),{app:s.Jk.Dashboard,dashboardUID:this.state.uid,panelId:St,panelPluginId:tt?.state.pluginId,scopes:this.state.scopes?.getSelectedScopes()}}canEditDashboard(){const{meta:Ie}=this.state;return!!(Ie.canEdit||Ie.canMakeEditable)}getInitialSaveModel(){return this._initialSaveModel}setInitialSaveModel(Ie){this._initialSaveModel=Ie}async deleteDashboard(){await(0,f.A_)(this.state.uid,!0),this.setState({isDirty:!1}),o.Ny.replace("/")}}class $a{constructor(Ie){this._dashboard=Ie,this._emptySet=new Set}getNames(){return this._emptySet}hasDependencyOn(){return!1}variableUpdateCompleted(Ie,je){je&&l.A.publish(new P.og({refreshAll:!0,panelIds:[]}));const tt=this._dashboard.state.body;if(tt instanceof m.hy){for(const St of tt.state.children)if(!(!(St instanceof m.tI)||!St.state.$behaviors))for(const $t of St.state.$behaviors)$t instanceof xi.L&&($t.isWaitingForVariables||$t.state.variableName===Ie.state.name&&je)&&$t.performRepeat()}}}},60656:(G,I,e)=>{"use strict";e.d(I,{F:()=>d});var t=e(96540),n=e(16401),s=e(34214),r=e(57767),o=e(96556),m=e(41507),l=e(42397),i=e(7196),u=e(99589);class d extends n.Bs{constructor(f){super({panel:f.panel??p(f.title,f.panelKey),isLoaded:f.isLoaded??!1,...f}),this._onActivate=()=>{this.state.isLoaded||this.loadLibraryPanelFromPanelModel()},this.addActivationHandler(this._onActivate)}static{this.Component=c}setPanelFromLibPanel(f){if(this.state._loadedPanel?.version===f.version)return;const P=new s.a(f.model),a={title:P.title,key:this.state.panelKey,options:P.options??{},fieldConfig:P.fieldConfig,pluginId:P.type,pluginVersion:P.pluginVersion,displayMode:P.transparent?"transparent":void 0,description:P.description,hoverHeader:!P.title&&!P.timeFrom&&!P.timeShift,hoverHeaderOffset:0,$data:(0,o.w)(P),menu:new n.Lw({$behaviors:[i._i]}),titleItems:[new l.$({rawLinks:P.links,menu:new l.m({$behaviors:[i.oV]})}),new u.W]},E=new n.Eb(a);this.setState({panel:E,_loadedPanel:f,isLoaded:!0,name:f.name})}async loadLibraryPanelFromPanelModel(){let f=this.state.panel;try{const P=await(0,r.Yr)(this.state.uid,!0);this.setPanelFromLibPanel(P),this.parent instanceof m.U&&this.parent.setState({variableName:P.model.repeat,repeatDirection:P.model.repeatDirection==="h"?"h":"v",maxPerRow:P.model.maxPerRow})}catch{f.setState({_pluginLoadError:`Unable to load library panel: ${this.state.uid}`})}}}function p(y,f){return new n.Eb({key:f,title:y,menu:new n.Lw({$behaviors:[i._i]})})}function c({model:y}){const{panel:f}=y.useState();return f?t.createElement(f.Component,{model:f}):null}},31807:(G,I,e)=>{"use strict";e.d(I,{c:()=>K});var t=e(32196),n=e(96540),s=e(13544),r=e(32264),o=e(12131),m=e(40845),l=e(27746),i=e(14578),u=e(39938),d=e(83122),p=e(38138),c=e(55852),y=e(19727),f=e(15068),P=e(75269),a=e(10804),E=e(10096),g=e(8484),h=e(14792),D=e(2609),v=e(19293),C=e(41053),T=e(7030),S=e(7758);const O=s.Tp.pages.Dashboard.DashNav.newShareButton.menu;function x({dashboard:se}){const[ae,ne]=(0,C.A)(async()=>await(0,T.fv)(se,{useAbsoluteTimeRange:!0,theme:"current"}),[se]);return n.createElement(p.W,{"data-testid":O.container},n.createElement(p.W.Item,{testId:O.shareInternally,label:"Share internally",description:"Copy link",icon:"building",onClick:ne}))}const b=s.Tp.pages.Dashboard.DashNav.newShareButton;function M({dashboard:se}){const[ae,ne]=(0,n.useState)(!1),[q,ee]=(0,C.A)(async()=>await(0,T.fv)(se,{useAbsoluteTimeRange:!0,theme:"current"}),[se]),z=(0,n.useCallback)(ie=>{ie&&S.c.toolbarShareClick(),ne(ie)},[]),te=()=>n.createElement(x,{dashboard:se});return n.createElement(y.e,{"data-testid":b.container},n.createElement(c.$n,{"data-testid":b.shareLink,size:"sm",tooltip:"Copy shortened URL",onClick:ee},"Share"),n.createElement(d.m,{overlay:te,placement:"bottom-end",onVisibleChange:z},n.createElement(c.$n,{"data-testid":b.arrowMenu,size:"sm",icon:ae?"angle-up":"angle-down"})))}var A=e(58441),R=e(99246),B=e(40672),U=e(96374),W=e(28138),N=e(28444);function w(se){return n.createElement(l.I,{key:"button-snapshot","data-testid":"button-snapshot",tooltip:(0,g.t)("dashboard.toolbar.open-original","Open original dashboard"),icon:"link",onClick:()=>L(se.originalURL)})}const L=se=>{const ae=se??"",ne=B.sQ.sanitizeUrl(ae);try{const q=new URL(ne,r.$.appUrl),ee=new URL(r.$.appUrl);q.host!==ee.host?W.A.publish(new N.S8({component:U.u,props:{title:"Proceed to external site?",modalClass:(0,t.css)({width:"max-content",maxWidth:"80vw"}),body:n.createElement(n.Fragment,null,n.createElement("p",null,"This link connects to an external website at"," ",n.createElement("code",null,ae)),n.createElement("p",null,"Are you sure you'd like to proceed?")),confirmVariant:"primary",confirmText:"Proceed",onConfirm:()=>{window.location.href=q.href}}})):o.Ny.push(ne)}catch(q){console.error("Failed to open original dashboard",q)}};var V=e(60656);const K=n.memo(({dashboard:se})=>{const ae=n.createElement(k,{dashboard:se});return n.createElement(P.H,{actions:ae})});K.displayName="NavToolbarActions";function k({dashboard:se}){const{isEditing:ae,viewPanelScene:ne,isDirty:q,uid:ee,meta:z,editview:te,editPanel:ie,editable:ce,hasCopiedPanel:ue}=se.useState(),{isPlaying:fe}=D._o.useState(),[Te,he]=(0,n.useState)(!1),de=E.TP.hasEditPermissionInFolders,le=[],pe=(0,m.of)(X),ve=!!ie,be=!!ne,Oe=J(ie),Me=H(ie),Ue=!!ue,we=!te&&!be&&!ve,Re=ae&&we;ve||j(le,R.C.left,"left-actions"),le.push({group:"icon-actions",condition:ee&&!!z.canStar&&we&&!ae,render:()=>{let Xe=z.isStarred?(0,g.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,g.t)("dashboard.toolbar.mark-favorite","Mark as favorite");return n.createElement(l.I,{tooltip:Xe,icon:n.createElement(i.I,{name:z.isStarred?"favorite":"star",size:"lg",type:z.isStarred?"mono":"default"}),key:"star-dashboard-button","data-testid":s.Tp.components.NavToolbar.markAsFavorite,onClick:()=>{S.c.toolbarFavoritesClick(),se.onStarDashboard()}})}}),z.publicDashboardEnabled&&le.push({group:"icon-actions",condition:ee&&!!z.canStar&&we&&!ae,render:()=>n.createElement(u.E,{color:"blue",text:"Public",key:"public-dashboard-button-badge",className:pe.publicBadge,"data-testid":s.Tp.pages.Dashboard.DashNav.publicDashboardTag})});const Fe=r.$.buildInfo.env==="development";le.push({group:"icon-actions",condition:Fe&&ee&&we&&!ae,render:()=>n.createElement(l.I,{key:"view-in-old-dashboard-button",tooltip:"Switch to old dashboard page",icon:"apps",onClick:()=>{o.Ny.partial({scenes:!1})}})}),le.push({group:"icon-actions",condition:z.isSnapshot&&!ae,render:()=>n.createElement(w,{key:"go-to-snapshot-origin",originalURL:se.getInitialSaveModel()?.snapshot?.originalUrl??""})}),!ve&&!ae&&j(le,R.C.right,"icon-actions"),le.push({group:"add-panel",condition:Re,render:()=>n.createElement(d.m,{key:"add-panel-dropdown",onVisibleChange:Xe=>{he(Xe),S.c.toolbarAddClick()},overlay:()=>n.createElement(p.W,null,n.createElement(p.W.Item,{key:"add-visualization",testId:s.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,g.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Xe=se.onCreateNewPanel();S.c.toolbarAddButtonClicked({item:"add_visualization"}),se.setState({editPanel:(0,v.L)(Xe,!0)})}}),n.createElement(p.W.Item,{key:"add-panel-lib",testId:s.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,g.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{se.onShowAddLibraryPanelDrawer(),S.c.toolbarAddButtonClicked({item:"add_library_panel"})}}),n.createElement(p.W.Item,{key:"add-row",testId:s.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,g.t)("dashboard.add-menu.row","Row"),onClick:()=>{se.onCreateNewRow(),S.c.toolbarAddButtonClicked({item:"add_row"})}}),n.createElement(p.W.Item,{key:"paste-panel",disabled:!Ue,testId:s.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,g.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{se.pastePanel(),S.c.toolbarAddButtonClicked({item:"paste_panel"})}})),placement:"bottom",offset:[0,6]},n.createElement(c.$n,{key:"add-panel-button",variant:"primary",size:"sm",fill:"outline","data-testid":s.Tp.components.PageToolbar.itemButton("Add button")},n.createElement(g.x6,{i18nKey:"dashboard.toolbar.add"},"Add"),n.createElement(i.I,{name:Te?"angle-up":"angle-down",size:"lg"})))}),le.push({group:"playlist-actions",condition:fe&&we&&!ae,render:()=>n.createElement(l.I,{key:"play-list-prev","data-testid":s.Tp.pages.Dashboard.DashNav.playlistControls.prev,tooltip:(0,g.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:()=>D._o.prev()})}),le.push({group:"playlist-actions",condition:fe&&we&&!ae,render:()=>n.createElement(l.I,{key:"play-list-stop",onClick:()=>D._o.stop(),"data-testid":s.Tp.pages.Dashboard.DashNav.playlistControls.stop},n.createElement(g.x6,{i18nKey:"dashboard.toolbar.playlist-stop"},"Stop playlist"))}),le.push({group:"playlist-actions",condition:fe&&we&&!ae,render:()=>n.createElement(l.I,{key:"play-list-next","data-testid":s.Tp.pages.Dashboard.DashNav.playlistControls.next,tooltip:(0,g.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:()=>D._o.next(),narrow:!0})}),le.push({group:"back-button",condition:(be||ve)&&!Me,render:()=>n.createElement(c.$n,{onClick:()=>{o.Ny.partial({viewPanel:null,editPanel:null})},tooltip:"",key:"back",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":s.Tp.components.NavToolbar.editDashboard.backToDashboardButton},"Back to dashboard")}),le.push({group:"back-button",condition:!!te,render:()=>n.createElement(c.$n,{onClick:()=>{o.Ny.partial({editview:null})},tooltip:"",key:"back",fill:"text",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":s.Tp.components.NavToolbar.editDashboard.backToDashboardButton},"Back to dashboard")});const xe=ee&&!ae&&!z.isSnapshot&&!fe;le.push({group:"main-buttons",condition:!r.$.featureToggles.newDashboardSharingComponent&&xe,render:()=>n.createElement(c.$n,{key:"share-dashboard-button",tooltip:(0,g.t)("dashboard.toolbar.share","Share dashboard"),size:"sm",className:pe.buttonWithExtraMargin,fill:"outline",onClick:()=>{S.c.toolbarShareClick(),se.showModal(new A.Z({dashboardRef:se.getRef()}))},"data-testid":s.Tp.components.NavToolbar.shareDashboard},"Share")}),le.push({group:"main-buttons",condition:!ae&&se.canEditDashboard()&&!be&&!fe&&ce,render:()=>n.createElement(c.$n,{onClick:()=>{se.onEnterEditMode()},tooltip:"Enter edit mode",key:"edit",className:pe.buttonWithExtraMargin,variant:r.$.featureToggles.newDashboardSharingComponent?"secondary":"primary",size:"sm","data-testid":s.Tp.components.NavToolbar.editDashboard.editButton},"Edit")}),le.push({group:"main-buttons",condition:!ae&&se.canEditDashboard()&&!be&&!fe&&!ce,render:()=>n.createElement(c.$n,{onClick:()=>{se.onEnterEditMode(),se.setState({editable:!0,meta:{...z,canEdit:!0}})},tooltip:"This dashboard was marked as read only",key:"edit",className:pe.buttonWithExtraMargin,variant:"secondary",size:"sm","data-testid":s.Tp.components.NavToolbar.editDashboard.editButton},"Make editable")}),le.push({group:"new-share-dashboard-button",condition:r.$.featureToggles.newDashboardSharingComponent&&xe,render:()=>n.createElement(M,{key:"new-share-dashboard-button",dashboard:se})}),le.push({group:"settings",condition:ae&&se.canEditDashboard()&&we,render:()=>n.createElement(c.$n,{onClick:()=>{se.onOpenSettings()},tooltip:"Dashboard settings",fill:"text",size:"sm",key:"settings",variant:"secondary","data-testid":s.Tp.components.NavToolbar.editDashboard.settingsButton},"Settings")}),le.push({group:"main-buttons",condition:ae&&!z.isNew&&we,render:()=>n.createElement(c.$n,{onClick:()=>se.exitEditMode({skipConfirm:!1}),tooltip:"Exits edit mode and discards unsaved changes",size:"sm",key:"discard",fill:"text",variant:"primary","data-testid":s.Tp.components.NavToolbar.editDashboard.exitButton},"Exit edit")}),le.push({group:"main-buttons",condition:ve&&!Me&&!te&&!be,render:()=>n.createElement(c.$n,{onClick:ie?.onDiscard,tooltip:ie?.state.isNewPanel?"Discard panel":"Discard panel changes",size:"sm",disabled:!Oe||!q,key:"discard",fill:"outline",variant:"destructive","data-testid":s.Tp.components.NavToolbar.editDashboard.discardChangesButton},ie?.state.isNewPanel?"Discard panel":"Discard panel changes")}),le.push({group:"main-buttons",condition:ve&&Me&&!te&&!be,render:()=>n.createElement(c.$n,{onClick:ie?.onDiscard,tooltip:"Discard library panel changes",size:"sm",key:"discardLibraryPanel",fill:"outline",variant:"destructive","data-testid":s.Tp.components.NavToolbar.editDashboard.discardChangesButton},"Discard library panel changes")}),le.push({group:"main-buttons",condition:ve&&Me&&!te&&!be,render:()=>n.createElement(c.$n,{onClick:ie?.onUnlinkLibraryPanel,tooltip:"Unlink library panel",size:"sm",key:"unlinkLibraryPanel",fill:"outline",variant:"secondary","data-testid":s.Tp.components.NavToolbar.editDashboard.unlinkLibraryPanelButton},"Unlink library panel")}),le.push({group:"main-buttons",condition:ve&&Me&&!te&&!be,render:()=>n.createElement(c.$n,{onClick:ie?.onSaveLibraryPanel,tooltip:"Save library panel",size:"sm",key:"saveLibraryPanel",fill:"outline",variant:"primary","data-testid":s.Tp.components.NavToolbar.editDashboard.saveLibraryPanelButton},"Save library panel")}),le.push({group:"main-buttons",condition:ae&&!Me&&(z.canSave||de),render:()=>{if(z.isNew)return n.createElement(c.$n,{onClick:()=>{S.c.toolbarSaveClick(),se.openSaveDrawer({})},className:pe.buttonWithExtraMargin,tooltip:"Save changes",key:"save",size:"sm",variant:"primary","data-testid":s.Tp.components.NavToolbar.editDashboard.saveButton},"Save dashboard");if(de&&!z.canSave&&!z.canMakeEditable)return n.createElement(c.$n,{onClick:()=>{S.c.toolbarSaveClick(),se.openSaveDrawer({saveAsCopy:!0})},className:pe.buttonWithExtraMargin,tooltip:"Save as copy",key:"save",size:"sm",variant:q?"primary":"secondary"},"Save as copy");const Xe=n.createElement(p.W,null,n.createElement(p.W.Item,{label:"Save",icon:"save",onClick:()=>{S.c.toolbarSaveClick(),se.openSaveDrawer({})}}),n.createElement(p.W.Item,{label:"Save as copy",icon:"copy",onClick:()=>{S.c.toolbarSaveAsClick(),se.openSaveDrawer({saveAsCopy:!0})}}));return n.createElement(y.e,{className:pe.buttonWithExtraMargin,key:"save"},n.createElement(c.$n,{onClick:()=>{S.c.toolbarSaveClick(),se.openSaveDrawer({})},tooltip:"Save changes",size:"sm","data-testid":s.Tp.components.NavToolbar.editDashboard.saveButton,variant:q?"primary":"secondary"},"Save dashboard"),n.createElement(d.m,{overlay:Xe},n.createElement(c.$n,{icon:"angle-down",variant:q?"primary":"secondary",size:"sm"})))}});const Ve=[];let $e="";for(const Xe of le)Xe.condition&&($e&&$e!==Xe.group&&$e&&Ve.push(n.createElement(a.K,{key:`${Xe.group}-separator`})),Ve.push(Xe.render()),$e=Xe.group);return n.createElement(f.U,{alignment:"right"},Ve)}function j(se,ae,ne){if(ae.length>0)for(const q of ae){const ee={dashboard:(0,h.UA)().getCurrent()};if(q.show(ee)){const z=q.component;se.push({group:ne,condition:!0,render:()=>n.createElement(z,{...ee,key:se.length})})}}}function H(se){const[ae,ne]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(se){const q=se.state.vizManager.subscribeToState(ee=>ne(ee.sourcePanel.resolve().parent instanceof V.F));return()=>{q.unsubscribe()}}ne(!1)},[se]),ae}function J(se){const[ae,ne]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(se){const q=se.state.vizManager.subscribeToState(ee=>ne(ee.isDirty||!1));return()=>{q.unsubscribe()}}ne(!1)},[se]),ae}function X(se){return{buttonWithExtraMargin:(0,t.css)({margin:se.spacing(0,.5)}),publicBadge:(0,t.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})}}},42397:(G,I,e)=>{"use strict";e.d(I,{$:()=>u,m:()=>p});var t=e(96540),n=e(16401),s=e(91052),r=e(14578),o=e(83122),m=e(27746),l=e(38138),i=e(7196);class u extends n.Bs{static{this.Component=d}}function d({model:y}){const{menu:f,rawLinks:P}=y.useState();if(!(y.parent instanceof n.Eb))throw new Error("VizPanelLinks must be a child of VizPanel");if(!P||P.length===0)return null;if(P.length===1){const a=(0,i.eQ)(y.parent)[0];return t.createElement(s.NR.TitleItem,{href:a.href,onClick:a.onClick,target:a.target,title:a.title},t.createElement(r.I,{name:"external-link-alt",size:"md"}))}return t.createElement(o.m,{overlay:()=>t.createElement(f.Component,{model:f,key:f.state.key})},t.createElement(m.I,{icon:"external-link-alt",iconSize:"md","aria-label":"panel links"}))}class p extends n.Bs{static{this.Component=c}}function c({model:y}){const{links:f}=y.useState();return f?t.createElement(l.W,null,f?.map((P,a)=>t.createElement(l.W.Item,{key:a,label:P.title,url:P.href,target:P.target,onClick:P.onClick}))):null}},7196:(G,I,e)=>{"use strict";e.d(I,{eQ:()=>le,MI:()=>ve,oV:()=>de,_i:()=>ue,t0:()=>fe,vR:()=>Oe});var t=e(74135),n=e(1933),s=e(76885),r=e(32264),o=e(4402),m=e(12131),l=e(16401),i=e(28138),u=e(8484),d=e(63066),p=e(22699),c=e(16560),y=e(32349),f=e(75462),P=e(19347),a=e(74730),E=e(75176),g=e(40588),h=e(96540),D=e(56833);class v extends l.Bs{static{this.Component=C}constructor(Re){super(Re),this.trail=T(Re)}}function C({model:we}){return h.createElement(we.trail.Component,{model:we.trail})}function T({metric:we,filters:Re,dataSourceUid:Fe,timeRange:xe}){return new D.b({$timeRange:xe,metric:we,initialDS:Fe,initialFilters:Re,embedded:!0})}var S=e(32196),O=e(40845),x=e(87978),b=e(28444);function M(we){const{scene:Re,title:Fe,onDismiss:xe}=we,Ve=(0,O.of)(B);return h.createElement(x._,{title:Fe,onClose:xe,size:"lg"},h.createElement("div",{className:Ve.drawerInnerWrapper},h.createElement(Re.Component,{model:Re})))}class A extends l.Bs{constructor(Re){super(Re)}static Component({model:Re}){const Fe=Re.useState();return h.createElement(M,{...Fe})}}function R(we){const Re={component:M,props:we};appEvents.publish(new ShowModalReactEvent(Re))}function B(we){return{drawerInnerWrapper:(0,S.css)({display:"flex",padding:we.spacing(2),background:we.isDark?we.colors.background.canvas:we.colors.background.primary,position:"absolute",left:0,right:0,top:0})}}var U=e(76040);function W(we){return we.op==="="}function N(we){return we.state.$timeRange.clone()}function w({metric:we,labelFilters:Re}){if(Re.length===0)return we;const Fe=`{${Re.map(({label:xe,op:Ve,value:$e})=>`${xe}${Ve}"${$e}"`)}}`;return`${we}${Fe}`}function L(we){return we?.map(Re=>({key:Re.label,value:Re.value,operator:Re.op}))}function V(we){const Re=[];return we.forEach(Fe=>{const xe=(0,U.u)(Fe);if(xe.errors.length>0)return;const{metric:Ve,labels:$e}=xe.query;Re.push({metric:Ve,labelFilters:$e.filter(W),query:Fe}),xe.query.binaryQueries?.forEach(({query:{metric:Xe,labels:gt}})=>{Re.push({metric:Xe,labelFilters:gt.filter(W),query:Fe})})}),Re}async function K(we,Re,Fe){if(Re.state.pluginId!=="timeseries")return;const xe=(0,a.un)(Re);if(xe==null)return;const{queries:Ve,datasource:$e,data:Xe}=xe.state;if($e==null||$e.type!=="prometheus")return;const gt=await(0,P.l)().get($e);if(gt.interpolateVariablesInQueries==null)return;const Dt=gt.interpolateVariablesInQueries(Ve,{__sceneObject:{value:Re}},Xe?.request?.filters).filter(X),at=V(Dt.map(Ae=>Ae.expr)).map(Ae=>({text:w(Ae),onClick:J(Ae,we,gt)}));at.length>0&&Fe.push({text:"Explore metrics",iconClassName:"code-branch",subMenu:k(at)})}function k(we){const Re=new Set;function Fe({text:xe}){const Ve=Re.size;return Re.add(xe),Re.size>Ve}return we.filter(Fe)}function j({metric:we,labelFilters:Re,query:Fe},xe,Ve){return{metric:we,filters:L(Re),dataSourceUid:Ve,timeRange:xe}}function H(we,Re,Fe){const xe=N(Re),Ve=j(we,xe,Fe.uid),$e=new v(Ve);return $e.trail.addActivationHandler(()=>{$e.trail.state.topScene instanceof E.R&&$e.trail.state.topScene.setActionView("breakdown")}),{scene:$e,title:"Explore metrics"}}function J(we,Re,Fe){return()=>{const xe=H(we,Re,Fe),Ve=new A({...xe,onDismiss:()=>Re.closeModal()});(0,g.z)("exploration_started",{cause:"dashboard_panel"}),Re.showModal(Ve)}}function X(we){return"expr"in we}var se=e(58441),ae=e(7758),ne=e(11982),q=e(24283),ee=e(60656),z=e(42397),te=e(54174);class ie extends l.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,a.YQ)(this).closeModal()},this.onConfirm=()=>{const Re=(0,a.YQ)(this);Re.unlinkLibraryPanel(this.state.panelRef.resolve()),Re.closeModal()}}static{this.Component=ce}}function ce({model:we}){return h.createElement(te.l,{isOpen:!0,onConfirm:()=>{we.onConfirm(),we.onDismiss()},onDismiss:we.onDismiss})}function ue(we,Re=!1){(async()=>{const xe=we.parent,Ve=xe.parent,$e=xe.getPlugin(),Xe=[],gt=[],Dt=(0,a.YQ)(xe),{isEmbedded:nt}=Dt.state.meta,at=await Te(xe);if(nt){at&&we.setState({items:[at]});return}const Ae=!!Dt.state.editPanel;Ae||Xe.push({text:(0,u.t)("panel.header-menu.view","View"),iconClassName:"eye",shortcut:"v",onClick:()=>ae.c.panelMenuItemClicked("view"),href:(0,ne.r7)(xe)}),Dt.canEditDashboard()&&Dt.state.editable&&!Re&&!Ae&&Xe.push({text:(0,u.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",shortcut:"e",onClick:()=>ae.c.panelMenuItemClicked("edit"),href:(0,ne.e0)((0,a.Cs)(xe))}),Xe.push({text:(0,u.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:()=>{ae.c.panelMenuItemClicked("share"),Dt.showModal(new se.Z({panelRef:xe.getRef(),dashboardRef:Dt.getRef()}))},shortcut:"p s"}),Dt.state.isEditing&&!Re&&!Ae&&gt.push({text:(0,u.t)("panel.header-menu.duplicate","Duplicate"),onClick:()=>{ae.c.panelMenuItemClicked("duplicate"),Dt.duplicatePanel(xe)},shortcut:"p d"}),Ae||gt.push({text:(0,u.t)("panel.header-menu.copy","Copy"),onClick:()=>{ae.c.panelMenuItemClicked("copy"),Dt.copyPanel(xe)}}),Dt.state.isEditing&&!Re&&!Ae&&(Ve instanceof ee.F?(gt.push({text:(0,u.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),onClick:()=>{ae.c.panelMenuItemClicked("unlinkLibraryPanel"),Dt.showModal(new ie({panelRef:Ve.getRef()}))}}),gt.push({text:(0,u.t)("panel.header-menu.replace-library-panel","Replace library panel"),onClick:()=>{ae.c.panelMenuItemClicked("replaceLibraryPanel"),Dt.onShowAddLibraryPanelDrawer(Ve.getRef())}})):gt.push({text:(0,u.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:()=>{ae.c.panelMenuItemClicked("createLibraryPanel"),Dt.showModal(new se.Z({panelRef:xe.getRef(),dashboardRef:Dt.getRef(),activeTab:p.wr.libraryPanel}))}})),gt.push({text:(0,u.t)("panel.header-menu.new-alert-rule","New alert rule"),onClick:Z=>be(xe)}),Me(xe.state.options)&&!Ae&&gt.push({text:xe.state.options.legend.showLegend?(0,u.t)("panel.header-menu.hide-legend","Hide legend"):(0,u.t)("panel.header-menu.show-legend","Show legend"),onClick:Z=>{Z.preventDefault(),Oe(xe)},shortcut:"p l"}),Dt.canEditDashboard()&&$e&&!$e.meta.skipDataQuery&&!Re&&gt.push({text:(0,u.t)("panel.header-menu.get-help","Get help"),onClick:Z=>{Z.preventDefault(),Ue(xe,c.q.Help)}}),r.$.featureToggles.exploreMetrics&&await K(Dt,xe,Xe),at&&Xe.push(at),Xe.push(he($e,xe,Dt));const{extensions:re}=(0,o.Kf)({extensionPointId:t.S.DashboardPanelMenu,context:pe(xe,Dt),limitPerPlugin:3});re.length>0&&!Dt.state.isEditing&&Xe.push({text:"Extensions",iconClassName:"plug",type:"submenu",subMenu:(0,f.N9)(re)}),gt.length&&Xe.push({type:"submenu",text:(0,u.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:gt,onClick:Z=>{Z.preventDefault()}}),Dt.state.isEditing&&!Re&&!Ae&&(Xe.push({text:"",type:"divider"}),Xe.push({text:(0,u.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:()=>{ae.c.panelMenuItemClicked("remove"),ve(Dt,xe)},shortcut:"p r"})),we.setState({items:Xe})})()}const fe=we=>ue(we,!0);async function Te(we){const Re=await(0,ne.Lp)(we);if(Re)return{text:(0,u.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",shortcut:"p x",onClick:()=>ae.c.panelMenuItemClicked("explore"),href:Re}}function he(we,Re,Fe){const xe=[];return we&&!we.meta.skipDataQuery&&(xe.push({text:(0,u.t)("panel.header-menu.inspect-data","Data"),href:(0,ne.Uu)(Re,c.q.Data),onClick:Ve=>{Ve.preventDefault(),m.Ny.partial({inspect:Re.state.key,inspectTab:c.q.Data}),ae.c.panelMenuInspectClicked(c.q.Data)}}),Fe instanceof q.H$&&Fe.state.meta.canEdit&&xe.push({text:(0,u.t)("panel.header-menu.query","Query"),href:(0,ne.Uu)(Re,c.q.Query),onClick:Ve=>{Ve.preventDefault(),m.Ny.partial({inspect:Re.state.key,inspectTab:c.q.Query}),ae.c.panelMenuInspectClicked(c.q.Query)}})),xe.push({text:(0,u.t)("panel.header-menu.inspect-json","Panel JSON"),href:(0,ne.Uu)(Re,c.q.JSON),onClick:Ve=>{Ve.preventDefault(),m.Ny.partial({inspect:Re.state.key,inspectTab:c.q.JSON}),ae.c.panelMenuInspectClicked(c.q.JSON)}}),{text:(0,u.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",shortcut:"i",href:(0,ne.Uu)(Re),onClick:Ve=>{Ve.isDefaultPrevented()||(m.Ny.partial({inspect:Re.state.key,inspectTab:c.q.Data}),ae.c.panelMenuInspectClicked(c.q.Data))},subMenu:xe.length>0?xe:void 0}}function de(we){if(!(we.parent instanceof z.$))throw new Error("parent of VizPanelLinksMenu must be VizPanelLinks");const Re=we.parent.parent;if(!(Re instanceof l.Eb))throw new Error("parent of VizPanelLinks must be VizPanel");we.setState({links:le(Re)})}function le(we){const Re=(Ve,$e)=>l.jh.interpolate(we,Ve,$e),Fe=(0,y.CH)(we,Re);if(!Fe)return[];const xe=Fe.getLinks(Re);return xe.map(Ve=>({...Ve,onClick:(Xe,gt)=>{ae.c.panelLinkClicked({has_multiple_links:xe.length>1}),Ve.onClick?.(Xe,gt)}}))}function pe(we,Re){const Fe=l.jh.getTimeRange(we);let xe=(0,a.un)(we);const Ve=xe?.state.queries,$e=(0,a.Cs)(we);let Xe={};if(we.state.$variables&&we.state.$variables.state.variables.forEach(gt=>{gt instanceof l.xc&&(Xe={...Xe,[gt.state.name]:{value:gt.getValue(),text:gt.getValueText()}})}),we.parent?.parent instanceof l.tI){const gt=we.parent.parent;gt.state.$variables&&gt.state.$variables.state.variables.forEach(Dt=>{Dt instanceof l.xc&&(Xe={...Xe,[Dt.state.name]:{value:Dt.getValue(),text:Dt.getValueText()}})})}return{id:$e,pluginId:we.state.pluginId,title:we.state.title,timeRange:Fe.state.value.raw,timeZone:(0,n.O)({timeZone:Fe.getTimeZone()}),dashboard:{uid:Re.state.uid,title:Re.state.title,tags:Re.state.tags||[]},targets:Ve,scopedVars:Xe,data:xe?.state.data}}function ve(we,Re){i.A.publish(new b.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",yesText:"Remove",onConfirm:()=>we.removePanel(Re)}))}const be=async we=>{ae.c.panelMenuItemClicked("create-alert");const Re=await(0,d.J6)(we),Fe=s.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(Re),returnTo:location.pathname+location.search});m.Ny.push(Fe),ae.c.panelMenuItemClicked("create-alert")};function Oe(we){const Re=we.state.options;Me(Re)&&typeof Re.legend.showLegend=="boolean"&&we.onOptionsChange({legend:{showLegend:!Re.legend.showLegend}}),ae.c.panelMenuItemClicked("toggleLegend")}function Me(we){return we!=null&&typeof we=="object"&&"legend"in we}const Ue=(we,Re)=>{m.Ny.partial({inspect:we.state.key,inspectTab:Re}),ae.c.panelMenuInspectClicked(Re??c.q.Data)}},99589:(G,I,e)=>{"use strict";e.d(I,{W:()=>o});var t=e(96540),n=e(16401),s=e(2038),r=e(74730);class o extends n.Bs{constructor(){super({}),this.onActivate=()=>{const i=this.parent;if(!i||!(i instanceof n.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=m}getPanel(){const i=this.parent;return i&&i instanceof n.Eb?i:null}}function m({model:l}){const i=l.getPanel(),d=n.jh.getData(l).useState();if(!i)return null;const p=(0,r.Cs)(i);return d.data?.series?t.createElement(s.Z,{frames:d.data?.series,panelId:p}):null}},7928:(G,I,e)=>{"use strict";e.d(I,{v:()=>c});var t=e(32196),n=e(96540),s=e(43127),r=e(65879),o=e(85858),m=e(16401),l=e(40845),i=e(56034),u=e(15666),d=e(91052),p=e(14578);class c extends m.XQ{static{this.Component=y}constructor(a={}){super({...a,from:"now-6h",to:"now",value:(0,s.E2)()}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){this._subs.add(this.subscribeToState((a,E)=>{if(a.timeFrom!==E.timeFrom||a.timeShift!==E.timeShift){const{timeInfo:g,timeRange:h}=this.getTimeOverride(this.getAncestorTimeRange().state.value);this.setState({timeInfo:g,value:h})}}))}ancestorTimeRangeChanged(a){const E=this.getTimeOverride(a.value);this.setState({value:E.timeRange,timeInfo:E.timeInfo})}getTimeOverride(a){const{timeFrom:E,timeShift:g}=this.state,h={timeInfo:"",timeRange:a};if(E){const D=m.jh.interpolate(this,this.state.timeFrom),v=r.describeTextRange(D);if(v.invalid)return h.timeInfo="invalid time override",h;r.isRelativeTimeRange(a.raw)&&(h.timeInfo=v.display,h.timeRange={from:o.parse(v.from),to:o.parse(v.to),raw:{from:v.from,to:v.to}})}if(g){const D=m.jh.interpolate(this,this.state.timeShift);if(r.describeTextRange(D).invalid)return h.timeInfo="invalid timeshift",h;const C="-"+D;h.timeInfo+=" timeshift "+C;const T=o.parseDateMath(C,h.timeRange.from,!1),S=o.parseDateMath(C,h.timeRange.to,!0);h.timeRange={from:T,to:S,raw:{from:T,to:S}}}return h}}function y({model:P}){const{timeInfo:a,hideTimeOverride:E}=P.useState(),g=(0,l.of)(f);return!a||E?null:n.createElement(i.m,{content:n.createElement(u.xS,{timeRange:P.state.value,timeZone:P.getTimeZone()})},n.createElement(d.NR.TitleItem,{className:g.timeshift},n.createElement(p.I,{name:"clock-nine",size:"sm"})," ",a))}const f=P=>({timeshift:(0,t.css)({color:P.colors.text.link,gap:P.spacing(.5),whiteSpace:"nowrap"})})},79284:(G,I,e)=>{"use strict";e.d(I,{L:()=>m});var t=e(2543),n=e.n(t),s=e(16401),r=e(74730),o=e(30195);class m extends s.Bs{constructor(c){super(c),this._variableDependency=new s.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>{}}),this.isWaitingForVariables=!1,this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.performRepeat()}_getRow(){if(!(this.parent instanceof s.tI))throw new Error("RepeatedRowBehavior: Parent is not a SceneGridRow");return this.parent}_getLayout(){const c=s.jh.getLayout(this);if(!(c instanceof s.hy))throw new Error("RepeatedRowBehavior: Layout is not a SceneGridLayout");return c}performRepeat(){if(this.isWaitingForVariables=this._variableDependency.hasDependencyInLoadingState(),this.isWaitingForVariables)return;const c=s.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!c){console.error("RepeatedRowBehavior: Variable not found");return}if(!(c instanceof s.n8)){console.error("RepeatedRowBehavior: Variable is not a MultiValueVariable");return}const y=this._getRow(),f=this._getLayout(),{values:P,texts:a}=(0,r.a7)(c);if((0,t.isEqual)(this._prevRepeatValues,P))return;this._prevRepeatValues=P;const E=[],g=y.state.children,h=l(g);let D=0;for(let v=0;v<P.length;v++){const C=[],T=P[v];for(const O of g){const b=(O.state.y??0)+(h+1)*v,M=v>0?`${O.state.key}-clone-${T}`:O.state.key,A=O.clone({key:M,y:b});v>0&&d(A,T),C.push(A),D<b+A.state.height&&(D=b+A.state.height)}const S=this.getRowClone(y,v,T,a[v],h,C);E.push(S)}i(f,E,D,y),this.publishEvent(new o.d({source:this}),!0)}getRowClone(c,y,f,P,a,E){if(y===0)return c.setState({$variables:new s.Pj({variables:[new s.xc({name:this.state.variableName,value:f,text:String(P)})]}),children:E}),c;const g=c.state.y??0;return c.clone({key:`${c.state.key}-clone-${f}`,$variables:new s.Pj({variables:[new s.xc({name:this.state.variableName,value:f,text:String(P)})]}),$behaviors:[],children:E,y:g+a*y+y,actions:void 0})}removeBehavior(){const c=this._getRow(),y=this._getLayout(),f=u(this._getLayout(),this._getRow());y.setState({children:f}),c.setState({$behaviors:c.state.$behaviors.filter(P=>P!==this),$variables:void 0})}}function l(p){let c=0,y=Number.MAX_VALUE;if(p.length===0)return 0;for(const f of p)f.state.y+f.state.height>c&&(c=f.state.y+f.state.height),f.state.y<y&&(y=f.state.y);return c-y}function i(p,c,y,f){const P=u(p,f),a=P.indexOf(f);if(a===-1)throw new Error("RowRepeaterBehavior: Parent row not found in layout children");const E=[...P.slice(0,a),...c,...P.slice(a+1)];if(P.length>a+1){const g=P.slice(a+1),h=g[0].state.y,D=y-h;for(const v of g)if(v.setState({y:v.state.y+D}),v instanceof s.tI)for(const C of v.state.children)C.setState({y:C.state.y+D})}p.setState({children:E})}function u(p,c){return p.state.children.filter(y=>!y.state.key?.startsWith(`${c.state.key}-clone-`))}function d(p,c){p.forEachChild(y=>{y.setState({key:`${y.state.key}-clone-${c}`}),d(y,c)})}},54174:(G,I,e)=>{"use strict";e.d(I,{l:()=>s});var t=e(96540),n=e(96374);const s=({isOpen:r,onConfirm:o,onDismiss:m})=>t.createElement(n.u,{title:"Do you really want to unlink this panel?",icon:"question-circle",body:`If you unlink this panel, you will be able to edit it without affecting any other dashboards.
            However, once you make a change you will not be able to revert to its original reusable panel.`,confirmText:"Yes, unlink",onConfirm:()=>{o(),m()},onDismiss:m,isOpen:r})},58029:(G,I,e)=>{"use strict";e.d(I,{u:()=>x});var t=e(32196),n=e(96540),s=e(16401),r=e(72109),o=e(40845),m=e(14578),l=e(28138),i=e(14348),u=e(28444),d=e(74730),p=e(41507),c=e(79284),y=e(71678),f=e(37390),P=e(49785),a=e(13544),E=e(88575),g=e(10354),h=e(42418),D=e(55852),v=e(92378);const C=({repeat:M,title:A,parent:R,warning:B,onUpdate:U,onCancel:W})=>{const[N,w]=(0,n.useState)(M),L=(0,n.useCallback)(j=>w(j),[w]),{handleSubmit:V,register:K}=(0,P.mN)({defaultValues:{title:A}}),k=j=>{U(j.title,N)};return n.createElement("form",{onSubmit:V(k)},n.createElement(E.D,{label:"Title"},n.createElement(g.p,{...K("title"),type:"text"})),n.createElement(E.D,{label:"Repeat for"},n.createElement(v.U,{parent:R,repeat:N,onChange:L})),B&&n.createElement(h.F,{"data-testid":a.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0},B),n.createElement(f.a.ButtonRow,null,n.createElement(D.$n,{type:"button",variant:"secondary",onClick:W,fill:"outline"},"Cancel"),n.createElement(D.$n,{type:"submit"},"Update")))},T=({repeat:M,title:A,parent:R,onDismiss:B,onUpdate:U,warning:W})=>{const N=(0,o.of)(S);return n.createElement(f.a,{isOpen:!0,title:"Row options",onDismiss:B,className:N.modal},n.createElement(C,{parent:R,repeat:M,title:A,onCancel:B,onUpdate:U,warning:W}))},S=()=>({modal:(0,t.css)({label:"RowOptionsModal",width:"500px"})}),O=({repeat:M,title:A,parent:R,onUpdate:B,warning:U})=>{const W=N=>(w,L)=>{B(w,L),N()};return n.createElement(y.$s,null,({showModal:N,hideModal:w})=>n.createElement("button",{type:"button",className:"pointer","aria-label":"Row options",onClick:()=>{N(T,{title:A,repeat:M,parent:R,onDismiss:w,onUpdate:W(w),warning:U})}},n.createElement(m.I,{name:"cog"})))};O.displayName="RowOptionsButton";class x extends s.Bs{constructor(){super(...arguments),this.onUpdate=(A,R)=>{const B=this.getParent();let U;if(B.state.$behaviors)for(let W of B.state.$behaviors)W instanceof c.L&&(U=W);if(R&&!U){const W=new c.L({variableName:R});B.setState({$behaviors:[...B.state.$behaviors??[],W]})}else U&&U.removeBehavior();A!==B.state.title&&B.setState({title:A})},this.onDelete=()=>{l.A.publish(new u.bY({title:"Delete row",text:"Are you sure you want to remove this row and all its panels?",altActionText:"Delete row only",icon:"trash-alt",onConfirm:()=>{this.getDashboard().removeRow(this.getParent(),!0)},onAltAction:()=>{this.getDashboard().removeRow(this.getParent())}}))},this.getWarning=()=>{if(this.getParent().state.children.some(U=>{if(!(U instanceof p.U))return!1;const W=U.state.body;return W instanceof s.Eb?(0,d.un)(W)?.state.datasource?.uid===i.K:!1}))return n.createElement("div",null,n.createElement("p",null,"Panels in this row use the ",i.K," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."),n.createElement(r.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows"},"Learn more"))}}getParent(){if(!(this.parent instanceof s.tI))throw new Error("RowActions must have a SceneGridRow parent");return this.parent}getDashboard(){return(0,d.YQ)(this)}static{this.Component=({model:A})=>{const R=A.getDashboard(),B=A.getParent(),{title:U}=B.useState(),{meta:W,isEditing:N}=R.useState(),w=(0,o.of)(b),L=B.state.$behaviors?.find(V=>V instanceof c.L);return n.createElement(n.Fragment,null,W.canEdit&&N&&n.createElement(n.Fragment,null,n.createElement("div",{className:w.rowActions},n.createElement(O,{title:U,repeat:L instanceof c.L?L.state.variableName:void 0,parent:R,onUpdate:A.onUpdate,warning:A.getWarning()}),n.createElement("button",{type:"button",onClick:A.onDelete,"aria-label":"Delete row"},n.createElement(m.I,{name:"trash-alt"})))))}}}const b=M=>({rowActions:(0,t.css)({color:M.colors.text.secondary,lineHeight:"27px",button:{color:M.colors.text.secondary,paddingLeft:M.spacing(2),background:"transparent",border:"none","&:hover":{color:M.colors.text.maxContrast}}})})},30195:(G,I,e)=>{"use strict";e.d(I,{d:()=>n});var t=e(65463);class n extends t.x{static{this.type="dashboard-repeats-processed"}}},71176:(G,I,e)=>{"use strict";e.d(I,{X:()=>r});var t=e(32264),n=e(79422),s=e(31193);async function r(o){let m=n.Ye.templating?.list;if(t.$.featureToggles.newDashboardWithFiltersAndGroupBy){const i=await(0,s.tR)().get();if(i.getTagKeys){const u={type:i.meta.id,uid:i.uid},d={datasource:u,filters:[],name:"Filter",type:"adhoc"},p={datasource:u,name:"Group by",type:"groupby"};m=(m||[]).concat([d,p])}}const l={meta:{canStar:!1,canShare:!1,canDelete:!1,isNew:!0,folderUid:""},dashboard:{...n.Ye,uid:"",title:"New dashboard",panels:[]}};return m&&(l.dashboard.templating={list:m}),o&&(l.meta.folderUid=o),l}},70665:(G,I,e)=>{"use strict";e.d(I,{x:()=>t});const t={name:"grafana",uid:"grafana"}},13989:(G,I,e)=>{"use strict";e.d(I,{O:()=>n});var t=e(16401);function n(s){const r=[];for(const o of s){if(!(o instanceof t.tV.g))continue;const m={...o.state.query,enable:!!o.state.isEnabled,hide:!!o.state.isHidden};r.push(m)}return r}},53287:(G,I,e)=>{"use strict";e.d(I,{C:()=>m});var t=e(32264),n=e(16401),s=e(79422),r=e(73134),o=e(74730);function m(i){const u=[];for(const d of i.state.variables){const p={name:d.state.name,label:d.state.label,description:d.state.description??void 0,skipUrlSync:!!d.state.skipUrlSync,hide:d.state.hide||s.zL.dontHide,type:d.state.type};if(n.Go.isQueryVariable(d)){let c=[];d.state.refresh===r.CO.never&&(c=l(d.state)),u.push({...p,current:{value:d.state.value,text:d.state.text},options:c,query:d.state.query,definition:d.state.definition,datasource:d.state.datasource,sort:d.state.sort,refresh:d.state.refresh,regex:d.state.regex,allValue:d.state.allValue,includeAll:d.state.includeAll,multi:d.state.isMulti,skipUrlSync:d.state.skipUrlSync})}else if(n.Go.isCustomVariable(d))u.push({...p,current:{text:d.state.value,value:d.state.value},options:l(d.state),query:d.state.query,multi:d.state.isMulti,allValue:d.state.allValue,includeAll:d.state.includeAll});else if(n.Go.isDataSourceVariable(d))u.push({...p,current:{value:d.state.value,text:d.state.text},options:[],regex:d.state.regex,refresh:r.CO.onDashboardLoad,query:d.state.pluginId,multi:d.state.isMulti,allValue:d.state.allValue,includeAll:d.state.includeAll});else if(n.Go.isConstantVariable(d))u.push({...p,current:{value:d.state.value,text:d.state.value},query:d.state.value,hide:s.zL.hideVariable});else if(n.Go.isIntervalVariable(d)){const c=(0,o.bx)(d.state.intervals);u.push({...p,current:{text:d.state.value,value:d.state.value},query:c,refresh:d.state.refresh,options:d.state.intervals.map(y=>({value:y,text:y,selected:y===d.state.value})),auto:d.state.autoEnabled,auto_min:d.state.autoMinInterval,auto_count:d.state.autoStepCount})}else if(n.Go.isTextBoxVariable(d)){const c={text:d.state.value,value:d.state.value};u.push({...p,current:c,options:[{...c,selected:!0}],query:d.state.value})}else if(n.Go.isGroupByVariable(d)&&t.$.featureToggles.groupByVariable)u.push({...p,datasource:d.state.datasource,options:d.state.defaultOptions?.map(c=>({text:c.text,value:String(c.value)})),current:{text:d.state.text,value:d.state.value}});else if(n.Go.isAdHocVariable(d))u.push({...p,name:d.state.name,type:"adhoc",datasource:d.state.datasource,baseFilters:d.state.baseFilters,filters:d.state.filters,defaultKeys:d.state.defaultKeys});else throw new Error("Unsupported variable type")}for(const d of u)d.hide===s.zL.dontHide&&delete d.hide,d.skipUrlSync||delete d.skipUrlSync,d.label===""&&delete d.label,d.multi||delete d.multi,d.sort===r.ZG.disabled&&delete d.sort;return u}function l(i){return i.options.map(u=>({value:String(u.value),text:u.label,selected:Array.isArray(i.value)?i.value.includes(u.value):i.value===u.value}))}},85445:(G,I,e)=>{"use strict";e.d(I,{Al:()=>H,tt:()=>J,EH:()=>k,wM:()=>L});var t=e(2543),n=e(32264),s=e(16401),r=e(34214),o=e(91309),m=e(38477),l=e(33278),i=e(16279),u=e(41507),d=e(74730);class p{constructor(ee,z){this._sceneObject=z,this.state={name:ee,type:"dashboard_macro"}}getValue(ee){const z=(0,d.YQ)(this._sceneObject);switch(ee){case"uid":return z.state.uid||"";case"title":case"name":case"id":default:return z.state.title}}getValueText(){return""}}function c(){const q=s.Go.registerVariableMacro("__dashboard",p);return()=>q()}var y=e(24283),f=e(60656),P=e(42397),a=e(7196),E=e(99589),g=e(7928),h=e(79284),D=e(58029),v=e(41987),C=e(69129),T=e(10154),S=e(32023);function O(q,ee){ee.app=v.Jk.Dashboard,ee.canAddAnnotations=()=>{const z=(0,d.YQ)(q);return!x(z)||!z.canEditDashboard()?!1:!!z.state.meta.annotationsPermissions?.dashboard.canAdd},ee.canEditAnnotations=z=>{const te=(0,d.YQ)(q);return te.canEditDashboard()?z?!!te.state.meta.annotationsPermissions?.dashboard.canEdit:!!te.state.meta.annotationsPermissions?.organization.canEdit:!1},ee.canDeleteAnnotations=z=>{const te=(0,d.YQ)(q);return te.canEditDashboard()?z?!!te.state.meta.annotationsPermissions?.dashboard.canDelete:!!te.state.meta.annotationsPermissions?.organization.canDelete:!1},ee.onAnnotationCreate=async z=>{const te=(0,d.YQ)(q),ie=z.from!==z.to,ce={dashboardUID:te.state.uid,panelId:(0,d.Cs)(q),isRegion:ie,time:z.from,timeEnd:ie?z.to:0,tags:z.tags,text:z.description};await(0,T.vJ)(ce),b(te),ee.eventBus.publish(new C.We(ce))},ee.onAnnotationUpdate=async z=>{const te=(0,d.YQ)(q),ie=z.from!==z.to,ce={id:z.id,dashboardUID:te.state.uid,panelId:(0,d.Cs)(q),isRegion:ie,time:z.from,timeEnd:ie?z.to:0,tags:z.tags,text:z.description};await(0,T.rJ)(ce),b(te),ee.eventBus.publish(new C.We(ce))},ee.onAnnotationDelete=async z=>{await(0,T.Xm)({id:z}),b((0,d.YQ)(q)),ee.eventBus.publish(new C.We({id:z}))},ee.onAddAdHocFilter=z=>{const te=(0,d.YQ)(q),ie=(0,d.un)(q);if(!ie)return;const ce=M(te,ie.state.datasource);A(ce,z)},ee.onUpdateData=z=>Promise.resolve(!0)}function x(q){const ee=S.b4.getDataLayers(q);for(const z of ee.state.annotationLayers)if(z instanceof s.tV.g&&z.state.isEnabled&&z.state.query.builtIn)return z}function b(q){const ee=x(q);ee&&ee.runLayer()}function M(q,ee){const z=s.jh.getVariables(q);for(const ie of z.state.variables)if(s.Go.isAdHocVariable(ie)){const ce=ie.state.datasource;if(ce===ee||ce?.uid===ee?.uid)return ie}const te=new s.H9({name:"Filters",datasource:ee,useQueriesAsFilterForOptions:!0});return z.setState({variables:[...z.state.variables,te]}),te}function A(q,ee){for(const z of q.state.filters)if(z.key===ee.key){q.setState({filters:q.state.filters.map(te=>te.key===ee.key?ee:te)});return}q.setState({filters:[...q.state.filters,ee]})}var R=e(96556),B=e(27734),U=e(7758),W=e(84423);function N(q){return function(z,te){if(te.angularPanelCtrl){z.options={angularOptions:q.getOptionsToRemember()};return}if((!q.options||Object.keys(q.options).length===0)&&(0,t.defaults)(z,q.getOptionsToRemember()),q.autoMigrateFrom){const ie=W.NB[q.autoMigrateFrom]!=null,ce=q.getOptionsToRemember(),ue=q.autoMigrateFrom;if(te.onPanelTypeChanged){const fe=ie?{angular:ce}:ce.options;Object.assign(z.options,te.onPanelTypeChanged(z,ue,fe,z.fieldConfig))}}}}var w=e(70665);function L(q){const ee=new r.G(q.dashboard,q.meta),z=k(ee);return z.setInitialSaveModel(q.dashboard),z}function V(q){const ee=[];let z=null,te=[];for(const ie of q)if(ie.type==="row")z?z.id!==ie.id&&(ee.push(K(z,te)),z=ie,te=[]):ie.collapsed?ee.push(K(ie,[])):z=ie;else if(ie.libraryPanel?.uid&&!("model"in ie.libraryPanel)){const ce=H(ie);if(!ce)continue;z?te.push(ce):ee.push(ce)}else{ie.snapshotData&&ae(ie);const ce=J(ie);z?te.push(ce):ee.push(ce)}return z&&ee.push(K(z,te)),ee}function K(q,ee){q.collapsed&&q.panels&&(ee=q.panels.map(ie=>{if(ie instanceof r.a||(ie=new r.a(ie)),ie.libraryPanel?.uid&&!("model"in ie.libraryPanel)){const ce=H(ie);if(!ce)throw new Error("Failed to build grid item for library panel");return ce}return J(ie)}));let z,te=ee;return q.repeat&&(z=[new h.L({variableName:q.repeat})]),new s.tI({key:(0,d.XA)(q.id),title:q.title,y:q.gridPos.y,isCollapsed:q.collapsed,children:te,$behaviors:z,actions:new D.u({})})}function k(q){let ee,z=[],te;if(q.templating?.list?.length){const ue=q.templating.list.map(fe=>{try{return j(fe)}catch(Te){return console.error(Te),null}}).filter(fe=>!!fe);ee=new s.Pj({variables:ue})}else ee=new s.Pj({variables:[]});q.annotations?.list?.length&&!q.isSnapshot()&&(z=q.annotations?.list.map(ue=>new m.g({key:(0,t.uniqueId)("annotations-"),query:ue,name:ue.name,isEnabled:!!ue.enable,isHidden:!!ue.hide})));let ie=n.$.unifiedAlertingEnabled;return ie||q.panels.find(ue=>!!ue.alert)&&(ie=!0),ie&&(te=new o.C({key:"alert-states",name:"Alert States"})),new y.H$({description:q.description,editable:q.editable,id:q.id,isDirty:!1,links:q.links||[],meta:q.meta,tags:q.tags||[],title:q.title,uid:q.uid,version:q.version,body:new s.hy({isLazy:!0,children:V(q.panels),$behaviors:[ne]}),$timeRange:new s.JZ({from:q.time.from,to:q.time.to,fiscalYearStartMonth:q.fiscalYearStartMonth,timeZone:q.timezone,weekStart:q.weekStart,UNSAFE_nowDelay:q.timepicker?.nowDelay}),$variables:ee,$behaviors:[new s.Gg.K2({sync:q.graphTooltip}),new s.Gg.Hf,c,X,new s.Gg.en({enabled:q.liveNow}),B.zf],$data:new i.s({annotationLayers:z,alertStatesLayer:te}),controls:new l.x({variableControls:[new s.K8({}),new s.i7],timePicker:new s.KE({}),refreshPicker:new s.WM({refresh:q.refresh,intervals:q.timepicker.refresh_intervals,withText:!0}),hideTimeControls:q.timepicker.hidden})})}function j(q){const ee={name:q.name,label:q.label,description:q.description};if(q.type==="adhoc")return new s.H9({...ee,description:q.description,skipUrlSync:q.skipUrlSync,hide:q.hide,datasource:q.datasource,applyMode:"auto",filters:q.filters??[],baseFilters:q.baseFilters??[],defaultKeys:q.defaultKeys,useQueriesAsFilterForOptions:!0});if(q.type==="custom")return new s.yP({...ee,value:q.current?.value??"",text:q.current?.text??"",query:q.query,isMulti:q.multi,allValue:q.allValue||void 0,includeAll:q.includeAll,defaultToAll:!!q.includeAll,skipUrlSync:q.skipUrlSync,hide:q.hide});if(q.type==="query")return new s.fS({...ee,value:q.current?.value??"",text:q.current?.text??"",query:q.query,datasource:q.datasource,sort:q.sort,refresh:q.refresh,regex:q.regex,allValue:q.allValue||void 0,includeAll:q.includeAll,defaultToAll:!!q.includeAll,isMulti:q.multi,skipUrlSync:q.skipUrlSync,hide:q.hide,definition:q.definition});if(q.type==="datasource")return new s.mI({...ee,value:q.current?.value??"",text:q.current?.text??"",regex:q.regex,pluginId:q.query,allValue:q.allValue||void 0,includeAll:q.includeAll,defaultToAll:!!q.includeAll,skipUrlSync:q.skipUrlSync,isMulti:q.multi,hide:q.hide});if(q.type==="interval"){const z=(0,d.Sm)(q.query),te=(0,d.pk)(q,z);return new s.Yj({...ee,value:te,intervals:z,autoEnabled:q.auto,autoStepCount:q.auto_count,autoMinInterval:q.auto_min,refresh:q.refresh,skipUrlSync:q.skipUrlSync,hide:q.hide})}else{if(q.type==="constant")return new s.x0({...ee,value:q.query,skipUrlSync:q.skipUrlSync,hide:q.hide});if(q.type==="textbox"){let z;return q?.current?.value?typeof q.current.value=="string"?z=q.current.value:z=q.current.value[0]:z=q.query,new s.TS({...ee,value:z,skipUrlSync:q.skipUrlSync,hide:q.hide})}else{if(n.$.featureToggles.groupByVariable&&q.type==="groupby")return new s.ZG({...ee,datasource:q.datasource,value:q.current?.value||[],text:q.current?.text||[],skipUrlSync:q.skipUrlSync,hide:q.hide,defaultOptions:q.options});throw new Error(`Scenes: Unsupported variable type ${q.type}`)}}}function H(q){if(!q.libraryPanel)return null;const ee=new f.F({title:q.title,uid:q.libraryPanel.uid,name:q.libraryPanel.name,panelKey:(0,d.XA)(q.id)});return new u.U({key:`grid-item-${q.id}`,y:q.gridPos.y,x:q.gridPos.x,width:q.gridPos.w,height:q.gridPos.h,itemHeight:q.gridPos.h,body:ee})}function J(q){const ee=q.repeatDirection==="h"?"h":"v",z=q.repeat?{variableName:q.repeat,repeatDirection:ee}:{},te=[];te.push(new P.$({rawLinks:q.links,menu:new P.m({$behaviors:[a.oV]})})),te.push(new E.W);const ie={key:(0,d.XA)(q.id),title:q.title,description:q.description,pluginId:q.type,options:q.options??{},fieldConfig:q.fieldConfig,pluginVersion:q.pluginVersion,displayMode:q.transparent?"transparent":void 0,hoverHeader:!q.title&&!q.timeFrom&&!q.timeShift,hoverHeaderOffset:0,$data:(0,R.w)(q),titleItems:te,extendPanelContext:O,_UNSAFE_customMigrationHandler:N(q)};n.$.publicDashboardAccessToken||(ie.menu=new s.Lw({$behaviors:[a._i]})),(q.timeFrom||q.timeShift)&&(ie.$timeRange=new g.v({timeFrom:q.timeFrom,timeShift:q.timeShift,hideTimeOverride:q.hideTimeOverride}));const ce=new s.Eb(ie);return new u.U({key:`grid-item-${q.id}`,x:q.gridPos.x,y:q.gridPos.y,width:ee==="h"?24:q.gridPos.w,height:q.gridPos.h,itemHeight:q.gridPos.h,body:ce,maxPerRow:q.maxPerRow,...z})}function X(q){q.subscribeToEvent(s.Kw,ee=>{const{interaction:z}=ee.payload;switch(z){case"panel-status-message-clicked":U.c.panelStatusMessageClicked();break;case"panel-cancel-query-clicked":U.c.panelCancelQueryClicked();break;case"panel-menu-shown":U.c.panelMenuShown();break}})}const se=q=>q.map(ee=>({data:{values:ee.fields.map(z=>z.values).filter(z=>z!==void 0)},schema:{fields:ee.fields.map(z=>({name:z.name,type:z.type,config:z.config}))}})),ae=q=>{q.snapshotData&&(q.datasource=w.x,q.targets=[{refId:q.snapshotData[0]?.refId??"",datasource:q.datasource,queryType:"snapshot",snapshot:se(q.snapshotData)}],q.snapshotData=[])};function ne(q){(0,d.YQ)(q).setState({isEmpty:q.state.children.length===0});const ee=q.subscribeToState((z,te)=>{(z.children.length!==te.children.length||z.children!==te.children)&&(0,d.YQ)(q).setState({isEmpty:z.children.length===0})});return()=>{ee.unsubscribe()}}},20455:(G,I,e)=>{"use strict";e.d(I,{Uy:()=>v,Z6:()=>S,ZB:()=>T,c:()=>M});var t=e(2543),n=e.n(t),s=e(92041),r=e(16401),o=e(79422),m=e(73134),l=e(28874),i=e(18803),u=e(79056),d=e(68706),p=e(16279),c=e(41507),y=e(60656),f=e(7928),P=e(79284),a=e(32023),E=e(74730),g=e(70665),h=e(13989),D=e(53287);function v(R,B=!1){const U=R.state,W=U.$timeRange.state,N=U.$data,w=U.$variables,L=U.body;let V=[],K=[];if(L instanceof r.hy){for(const ne of L.state.children)if(ne instanceof c.U&&(ne.state.variableName?V=V.concat(x(ne,U,B)):V.push(T(ne,U,B))),ne instanceof r.tI){if(ne.state.key.indexOf("-clone-")>0&&!B)continue;b(ne,V,U,B)}}let k=[];N instanceof p.s&&(k=(0,h.O)(N.state.annotationLayers)),w instanceof r.Pj&&(K=(0,D.C)(w));const j=U.controls?.state,H=j?.refreshPicker,J=A({refresh_intervals:H?.state.intervals,hidden:j?.hideTimeControls,nowDelay:W.UNSAFE_nowDelay},o.lt),X=U.$behaviors?.find(ne=>ne instanceof r.Gg.K2)?.state.sync??o.Ye.graphTooltip,se=U.$behaviors?.find(ne=>ne instanceof r.Gg.en)?.isEnabled||void 0,ae={...o.Ye,title:U.title,description:U.description||void 0,uid:U.uid,id:U.id,editable:U.editable,time:{from:W.from,to:W.to},timepicker:J,panels:V,annotations:{list:k},templating:{list:K},version:U.version,timezone:W.timeZone,fiscalYearStartMonth:W.fiscalYearStartMonth,weekStart:W.weekStart,tags:U.tags,links:U.links,graphTooltip:X,liveNow:se,schemaVersion:u.O2,refresh:H?.state.refresh};return(0,l.v)(ae)}function C(R,B){if(!R.state.panel)throw new Error("Library panel has no panel");return{id:(0,E.Cs)(R.state.panel),title:R.state.title,gridPos:B,libraryPanel:{name:R.state.name,uid:R.state.uid}}}function T(R,B,U=!1){let W,N=0,w=0,L=0,V=0;if(R.state.body instanceof y.F)return N=R.state.x??0,w=R.state.y??0,L=R.state.width??0,V=R.state.height??0,C(R.state.body,{x:N,y:w,w:L,h:V});let K=R;if(B&&B.editPanel?.state.vizManager&&B.editPanel.state.vizManager.state.sourcePanel.resolve()===R.state.body){const j=R.clone();j.state.body instanceof r.Eb&&(B.editPanel.state.vizManager.commitChangesTo(j.state.body),K=j)}if(!(K.state.body instanceof r.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");if(W=K.state.body,N=K.state.x??0,w=K.state.y??0,L=K.state.width??0,V=K.state.height??0,!W)throw new Error("Unsupported grid item type");return S(W,{x:N,y:w,h:V,w:L},U,K)}function S(R,B,U=!1,W){const N={id:(0,E.Cs)(R),type:R.state.pluginId,title:R.state.title,description:R.state.description??void 0,gridPos:B,fieldConfig:R.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:R.state.displayMode==="transparent",pluginVersion:R.state.pluginVersion,...O(R,U)};if(R.state.options){const{angularOptions:V,...K}=R.state.options;N.options=K,V&&(0,t.defaults)(N,V)}const w=R.state.$timeRange;w instanceof f.v&&(N.timeFrom=w.state.timeFrom,N.timeShift=w.state.timeShift,N.hideTimeOverride=w.state.hideTimeOverride),W instanceof c.U&&(W.state.variableName&&(N.repeat=W.state.variableName),W.state.maxPerRow&&(N.maxPerRow=W.state.maxPerRow),W.state.repeatDirection&&(N.repeatDirection=W.getRepeatDirection()));const L=a.b4.getPanelLinks(R);return N.links=L?.state.rawLinks??[],N.links.length===0&&delete N.links,N.transformations?.length===0&&delete N.transformations,N.transparent||delete N.transparent,N}function O(R,B=!1){const U=R.state.$data,W={},N=(0,E.un)(R);if(N&&(W.targets=N.state.queries,W.maxDataPoints=N.state.maxDataPoints,W.datasource=N.state.datasource,N.state.cacheTimeout&&(W.cacheTimeout=N.state.cacheTimeout),N.state.queryCachingTTL&&(W.queryCachingTTL=N.state.queryCachingTTL),N.state.minInterval&&(W.interval=N.state.minInterval)),U instanceof r.Es&&(W.transformations=U.state.transformations),U&&B){W.datasource=g.x;let w=(0,i.B6)(U.state.data);U instanceof r.Es&&(w=(0,i.B6)(U.state.$data.state.data)),W.targets=[{refId:"A",datasource:W.datasource,queryType:d.nj.Snapshot,snapshot:w}]}return W}function x(R,B,U=!1){if(U){if(R.state.body instanceof y.F){const{x:W=0,y:N=0,width:w=0,height:L=0}=R.state;return[C(R.state.body,{x:W,y:N,w,h:L})]}if(R.state.repeatedPanels){const W=R.state.itemHeight??10,N=Math.ceil(R.state.repeatedPanels.length/R.getMaxPerRow()),w=Math.ceil(R.state.repeatedPanels.length/N),L=24/w,V=W;return R.state.repeatedPanels.map((k,j)=>{let H=0,J=0;R.state.repeatDirection==="v"?(H=R.state.x,J=j*V):(H=j%w*L,J=R.state.y+Math.floor(j/w)*V);const X={x:H,y:J,w:L,h:V},se=k.state.$variables.getByName(R.state.variableName);return{id:(0,E.Cs)(k),type:k.state.pluginId,title:k.state.title,gridPos:X,options:k.state.options,fieldConfig:k.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:k.state.displayMode==="transparent",scopedVars:{[R.state.variableName]:{text:se?.state.text,value:se?.state.value}},...O(k,U)}})}return[]}else return[T(R,B)]}function b(R,B,U,W=!1){const N=!!R.state.isCollapsed,w={type:"row",id:(0,E.Cs)(R),title:R.state.title,gridPos:{x:R.state.x??0,y:R.state.y??0,w:R.state.width??24,h:R.state.height??1},collapsed:N,panels:[]};if(R.state.$behaviors?.length){const V=R.state.$behaviors[0];V instanceof P.L&&(w.repeat=V.state.variableName)}if(W&&R.state.$variables){const K=R.state.$variables.state.variables.reduce((k,j)=>({...k,[j.state.name]:{text:j.state.text,value:j.state.value}}),{});w.scopedVars=K}B.push(w);let L=[];W?R.state.children.forEach(V=>{V instanceof c.U&&(V.state.variableName?L=L.concat(x(V,U,!N)):L.push(T(V,U,!N)))}):L=R.state.children.map(V=>{if(!(V instanceof c.U))throw new Error("Row child expected to be DashboardGridItem");return T(V,U)}),R.state.isCollapsed?w.panels=L:B.push(...L)}function M(R,B,U,W){let N={...U,title:R,time:{from:B.from.toISOString(),to:B.to.toISOString()},links:[]};if(W){const w=U.panels?.find(L=>L.id===(0,E.Cs)(W));w&&(w.gridPos={w:24,x:0,y:0,h:20},N={...N,panels:[w]})}if(N.panels?.forEach(w=>{"links"in w&&(w.links=[])}),N.annotations){const L=(N.annotations.list?.filter(V=>V.enable)||[]).map(V=>({name:V.name,enable:V.enable,iconColor:V.iconColor,type:V.type,builtIn:V.builtIn,hide:V.hide,snapshotData:[]}));N.annotations.list=L}return N.templating&&N.templating.list?.forEach(w=>{"query"in w&&(w.query=""),"options"in w&&(w.options=w.current&&!(0,s.R)(w.current)?[w.current]:[]),"refresh"in w&&(w.refresh=m.CO.never)}),N}function A(R,B){const U={...R};for(const W in B)(0,t.isEqual)(U[W],B[W])&&delete U[W];return U}},46502:(G,I,e)=>{"use strict";e.d(I,{F:()=>s});var t=e(96540),n=e(7376);class s extends t.PureComponent{constructor(){super(...arguments),this.ref=null}componentWillUnmount(){this.angularComponent&&this.angularComponent.destroy()}componentDidMount(){this.ref&&this.loadAngular()}componentDidUpdate(o){o.datasource!==this.props.datasource&&this.loadAngular(),this.scopeProps&&this.scopeProps.ctrl.currentAnnotation!==this.props.annotation&&(this.scopeProps.ctrl.ignoreNextWatcherFiring=!0,this.scopeProps.ctrl.currentAnnotation=this.props.annotation,this.angularComponent?.digest())}loadAngular(){this.angularComponent&&(this.angularComponent.destroy(),this.scopeProps=void 0);const o=(0,n.E)(),m='<plugin-component type="annotations-query-ctrl"> </plugin-component>',l={ctrl:{currentDatasource:this.props.datasource,currentAnnotation:this.props.annotation,ignoreNextWatcherFiring:!1}};this.angularComponent=o.load(this.ref,l,m),this.angularComponent.digest(),this.angularComponent.getScope().$watch(()=>{if(l.ctrl.ignoreNextWatcherFiring){l.ctrl.ignoreNextWatcherFiring=!1;return}this.props.onChange(l.ctrl.currentAnnotation)}),this.scopeProps=l}render(){return t.createElement("div",{ref:o=>this.ref=o})}}},65857:(G,I,e)=>{"use strict";e.d(I,{d:()=>c});var t=e(96540),n=e(88575),s=e(10354),r=e(21594),o=e(79924),m=e(57418),l=e(10880),i=e(55852),u=e(4588);const d=[{value:"dashboards",label:"Dashboards"},{value:"link",label:"Link"}],p=Object.keys(u.G).map(y=>({label:y,value:y}));function c({link:y,onUpdate:f,onGoBack:P}){const a=v=>{f({...y,tags:v})},E=v=>{const C={...y,type:v.value};C.type==="dashboards"?(C.url="",C.tooltip=""):C.tags=[],f(C)},g=v=>{f({...y,icon:v.value})},h=v=>{const C=v.currentTarget;f({...y,[C.name]:C.type==="checkbox"?C.checked:C.value})},D=y.title===u.q.title;return t.createElement("div",{style:{maxWidth:"600px"}},t.createElement(n.D,{label:"Title"},t.createElement(s.p,{name:"title",id:"title",value:y.title,onChange:h,autoFocus:D})),t.createElement(n.D,{label:"Type"},t.createElement(r.l6,{inputId:"link-type-input",value:y.type,options:d,onChange:E})),y.type==="dashboards"&&t.createElement(t.Fragment,null,t.createElement(n.D,{label:"With tags"},t.createElement(o.u,{tags:y.tags,onChange:a}))),y.type==="link"&&t.createElement(t.Fragment,null,t.createElement(n.D,{label:"URL"},t.createElement(s.p,{name:"url",value:y.url,onChange:h})),t.createElement(n.D,{label:"Tooltip"},t.createElement(s.p,{name:"tooltip",value:y.tooltip,onChange:h,placeholder:"Open dashboard"})),t.createElement(n.D,{label:"Icon"},t.createElement(r.l6,{value:y.icon,options:p,onChange:g}))),t.createElement(m.M,{label:"Options",isOpen:!0},y.type==="dashboards"&&t.createElement(n.D,null,t.createElement(l.S,{label:"Show as dropdown",name:"asDropdown",value:y.asDropdown,onChange:h})),t.createElement(n.D,null,t.createElement(l.S,{label:"Include current time range",name:"keepTime",value:y.keepTime,onChange:h})),t.createElement(n.D,null,t.createElement(l.S,{label:"Include current template variable values",name:"includeVars",value:y.includeVars,onChange:h})),t.createElement(n.D,null,t.createElement(l.S,{label:"Open link in new tab",name:"targetBlank",value:y.targetBlank,onChange:h}))),t.createElement(i.$n,{variant:"secondary",onClick:P},"Back to list"))}},6199:(G,I,e)=>{"use strict";e.d(I,{X:()=>y});var t=e(32196),n=e(96540),s=e(40845),r=e(67061),o=e(69529),m=e(55852),l=e(72109),i=e(14578),u=e(64149),d=e(29158),p=e(91605),c=e(8484);function y({links:P,onNew:a,onOrderChange:E,onEdit:g,onDuplicate:h,onDelete:D}){const v=(0,s.of)(f);return P.length===0?n.createElement(r.B,{direction:"column"},n.createElement(o.p,{variant:"call-to-action",button:n.createElement(m.$n,{onClick:a,size:"lg"},n.createElement(c.x6,{i18nKey:"dashboard-links.empty-state.button-title"},"Add dashboard link")),message:(0,c.t)("dashboard-links.empty-state.title","There are no dashboard links added yet")},n.createElement(c.x6,{i18nKey:"dashboard-links.empty-state.info-box-content"},"Dashboard links allow you to place links to other dashboards and web sites directly below the dashboard header."," ",n.createElement(l.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-dashboard-links/"},"Learn more")))):n.createElement(n.Fragment,null,n.createElement("table",{role:"grid",className:"filter-table filter-table--hover"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Type"),n.createElement("th",null,"Info"),n.createElement("th",{colSpan:3}))),n.createElement("tbody",null,P.map((T,S)=>n.createElement("tr",{key:`${T.title}-${S}`},n.createElement("td",{role:"gridcell",className:"pointer",onClick:()=>g(S)},n.createElement(i.I,{name:"external-link-alt"})," \xA0 ",T.type),n.createElement("td",{role:"gridcell",className:"pointer",onClick:()=>g(S)},n.createElement(r.B,null,T.title&&n.createElement("span",{className:v.titleWrapper},T.title),T.type==="link"&&n.createElement("span",{className:v.urlWrapper},T.url),T.type==="dashboards"&&n.createElement(u.L,{tags:T.tags??[]}))),n.createElement("td",{style:{width:"1%"},role:"gridcell"},S!==0&&n.createElement(d.K,{name:"arrow-up",onClick:()=>E(S,-1),tooltip:"Move link up"})),n.createElement("td",{style:{width:"1%"},role:"gridcell"},P.length>1&&S!==P.length-1?n.createElement(d.K,{name:"arrow-down",onClick:()=>E(S,1),tooltip:"Move link down"}):null),n.createElement("td",{style:{width:"1%"},role:"gridcell"},n.createElement(d.K,{name:"copy",onClick:()=>h(T),tooltip:"Copy link"})),n.createElement("td",{style:{width:"1%"},role:"gridcell"},n.createElement(p.e,{"aria-label":`Delete link with title "${T.title}"`,size:"sm",onConfirm:()=>D(S)})))))),n.createElement(m.$n,{className:v.newLinkButton,icon:"plus",onClick:a},"New link"))}const f=P=>({titleWrapper:(0,t.css)({width:"20vw",textOverflow:"ellipsis",overflow:"hidden"}),urlWrapper:(0,t.css)({width:"40vw",textOverflow:"ellipsis",overflow:"hidden"}),newLinkButton:(0,t.css)({marginTop:P.spacing(3)})})},4588:(G,I,e)=>{"use strict";e.d(I,{G:()=>n,q:()=>t});const t={icon:"external link",title:"New link",tooltip:"",type:"dashboards",url:"",asDropdown:!1,tags:[],targetBlank:!1,keepTime:!1,includeVars:!1},n={"external link":"external-link-alt",dashboard:"apps",question:"question-circle",info:"info-circle",bolt:"bolt",doc:"file-alt",cloud:"cloud"}},27803:(G,I,e)=>{"use strict";e.d(I,{Q:()=>d});var t=e(96540),n=e(72436),s=e(13544),r=e(88575),o=e(42418),m=e(15292),l=e(32372),i=e(51612),u=e(58975);function d({datasource:p,infoText:c,onDataSourceChange:y,onDefaultKeysChange:f,defaultKeys:P}){const a=(0,t.useCallback)(E=>{const g=(0,n.Jh)(`key,value
`+E)[0],h=[];for(let D=0;D<g.length;D++)h.push({text:g.fields[0].values[D],value:g.fields[1].values[D]});f?.(h)},[f]);return t.createElement(t.Fragment,null,t.createElement(u.Y,null,"Ad-hoc options"),t.createElement(r.D,{label:"Data source",htmlFor:"data-source-picker"},t.createElement(i.s,{current:p,onChange:y,width:30,variables:!0,noDefault:!0})),c?t.createElement(o.F,{title:c,severity:"info","data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.infoText}):null,f&&t.createElement(t.Fragment,null,t.createElement(r.D,{label:"Use static key dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId"},t.createElement(m.d,{"data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.modeToggle,value:P!==void 0,onChange:E=>{f(P===void 0?[]:void 0)}})),P!==void 0&&t.createElement(l.B,{height:300,language:"csv",value:P.map(E=>`${E.text},${E.value}`).join(`
`),onBlur:a,onSave:a,showMiniMap:!1,showLineNumbers:!0})))}},95802:(G,I,e)=>{"use strict";e.d(I,{d:()=>o});var t=e(96540),n=e(13544),s=e(58975),r=e(14329);function o({onChange:m,constantValue:l}){return t.createElement(t.Fragment,null,t.createElement(s.Y,null,"Constant options"),t.createElement(r._,{defaultValue:l,name:"Value",placeholder:"your metric prefix",onBlur:m,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.ConstantVariable.constantOptionsQueryInputV2,width:30}))}},58711:(G,I,e)=>{"use strict";e.d(I,{w:()=>m});var t=e(96540),n=e(13544),s=e(58975),r=e(85140),o=e(94618);function m({query:l,multi:i,allValue:u,includeAll:d,onQueryChange:p,onMultiChange:c,onIncludeAllChange:y,onAllValueChange:f}){return t.createElement(t.Fragment,null,t.createElement(s.Y,null,"Custom options"),t.createElement(r.Z,{name:"Values separated by comma",defaultValue:l,placeholder:"1, 10, mykey : myvalue, myvalue, escaped\\,value",onBlur:p,required:!0,width:52,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput}),t.createElement(s.Y,null,"Selection options"),t.createElement(o.B,{multi:i,includeAll:d,allValue:u,onMultiChange:c,onIncludeAllChange:y,onAllValueChange:f}))}},98917:(G,I,e)=>{"use strict";e.d(I,{y:()=>l});var t=e(96540),n=e(13544),s=e(94618),r=e(58975),o=e(89458),m=e(14329);function l({query:i,regex:u,optionTypes:d,onChange:p,onRegExBlur:c,multi:y,includeAll:f,allValue:P,onMultiChange:a,onIncludeAllChange:E,onAllValueChange:g}){const h=d.find(D=>D.value===i)??d[0];return t.createElement(t.Fragment,null,t.createElement(r.Y,null,"Data source options"),t.createElement(o.v,{name:"Type",value:h,options:d,onChange:p,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.datasourceSelect}),t.createElement(m._,{defaultValue:u,name:"Instance name filter",placeholder:"/.*-(.*)-.*/",onBlur:c,description:t.createElement("div",null,"Regex filter for which data source instances to choose from in the variable value list. Leave empty for all.",t.createElement("br",null),t.createElement("br",null),"Example: ",t.createElement("code",null,"/^prod/"))}),t.createElement(r.Y,null,"Selection options"),t.createElement(s.B,{multi:y,includeAll:f,allValue:P,onMultiChange:a,onIncludeAllChange:E,onAllValueChange:g}))}},49317:(G,I,e)=>{"use strict";e.d(I,{s:()=>u});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(99615),m=e(58975),l=e(89458),i=e(14329);function u({intervals:p,onIntervalsChange:c,onAutoEnabledChange:y,onAutoMinIntervalChanged:f,onAutoCountChanged:P,autoEnabled:a,autoMinInterval:E,autoStepCount:g}){const h=[1,2,3,4,5,10,20,30,40,50,100,200,300,400,500].map(C=>({label:`${C}`,value:C})),D=(0,r.of)(d),v=h.find(C=>C.value===g)??h[0];return n.createElement(n.Fragment,null,n.createElement(m.Y,null,"Interval options"),n.createElement(i._,{defaultValue:p,name:"Values",placeholder:"1m,10m,1h,6h,1d,7d",onBlur:c,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.intervalsValueInput,width:32,required:!0}),n.createElement(o.c,{value:a,name:"Auto option",description:"Dynamically calculates interval by dividing time range by the count specified",onChange:y,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.autoEnabledCheckbox}),a&&n.createElement("div",{className:D.autoFields},n.createElement(l.v,{name:"Step count",description:"How many times the current time range should be divided to calculate the value",value:v,options:h,onChange:P,width:9,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.stepCountIntervalSelect}),n.createElement(i._,{value:E,name:"Min interval",description:"The calculated value will not go below this threshold",placeholder:"10s",onChange:f,width:11,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.minIntervalInput})))}const d=p=>({autoFields:(0,t.css)({marginTop:p.spacing(2),display:"flex",flexDirection:"column"})})},44890:(G,I,e)=>{"use strict";e.d(I,{u:()=>x});var t=e(96540),n=e(16817),s=e(13544),r=e(19347),o=e(88575),m=e(39070),l=e(72574),i=e(90613),u=e(94753),d=e(24240);function p({query:b,datasource:M,VariableQueryEditor:A,onLegacyQueryChange:R,onQueryChange:B,timeRange:U}){let W;return typeof b=="string"?W=b||(M.variables?.getDefaultQuery?.()??""):W={...M.variables?.getDefaultQuery?.(),...b},A&&(0,d.VN)(A,M)?t.createElement(i.a,{marginBottom:2},t.createElement(u.E,{element:"h4"},"Query"),t.createElement(i.a,{marginTop:1},t.createElement(A,{key:M.uid,datasource:M,query:W,templateSrv:(0,l.w)(),onChange:R}))):A&&(0,d.CH)(A,M)?t.createElement(i.a,{marginBottom:2},t.createElement(u.E,{element:"h4"},"Query"),t.createElement(i.a,{marginTop:1},t.createElement(A,{key:M.uid,datasource:M,query:W,onChange:B,onRunQuery:()=>{},data:{series:[],state:m.Gu.Done,timeRange:U},range:U,onBlur:()=>{},history:[]}))):null}var c=e(94618),y=e(51612),f=e(70766),P=e(12470),a=e(40845),E=e(94354),g=e(60619);const h=[{label:"On dashboard load",value:P.CO.onDashboardLoad},{label:"On time range change",value:P.CO.onTimeRangeChanged}];function D({onChange:b,refresh:M,testId:A}){const R=(0,a.$j)(),[B,U]=(0,t.useState)(!1);(0,g.Y)({breakpoint:R.breakpoints.values.sm,onChange:N=>{U(!N.matches)}});const W=(0,t.useMemo)(()=>h.find(N=>N.value===M)?.value??h[0].value,[M]);return t.createElement(o.D,{label:"Refresh",description:"When to update the values of this variable","data-testid":A},t.createElement(E.z,{options:h,onChange:b,value:W,size:B?"sm":"md"}))}var v=e(89458);const C=[{label:"Disabled",value:P.ZG.disabled},{label:"Alphabetical (asc)",value:P.ZG.alphabeticalAsc},{label:"Alphabetical (desc)",value:P.ZG.alphabeticalDesc},{label:"Numerical (asc)",value:P.ZG.numericalAsc},{label:"Numerical (desc)",value:P.ZG.numericalDesc},{label:"Alphabetical (case-insensitive, asc)",value:P.ZG.alphabeticalCaseInsensitiveAsc},{label:"Alphabetical (case-insensitive, desc)",value:P.ZG.alphabeticalCaseInsensitiveDesc},{label:"Natural (asc)",value:P.ZG.naturalAsc},{label:"Natural (desc)",value:P.ZG.naturalDesc}];function T({onChange:b,sort:M,testId:A}){const R=(0,t.useMemo)(()=>C.find(B=>B.value===M)??C[0],[M]);return t.createElement(v.v,{name:"Sort",description:"How to sort the values of this variable",value:R,options:C,onChange:b,testId:A,width:25})}var S=e(58975),O=e(85140);function x({datasource:b,onDataSourceChange:M,query:A,onQueryChange:R,onLegacyQueryChange:B,timeRange:U,regex:W,onRegExChange:N,sort:w,onSortChange:L,refresh:V,onRefreshChange:K,isMulti:k,onMultiChange:j,includeAll:H,onIncludeAllChange:J,allValue:X,onAllValueChange:se}){const{value:ae}=(0,n.A)(async()=>{const ee=await(0,r.l)().get(b??""),z=await(0,f.y)(ee);return{datasource:ee,VariableQueryEditor:z}},[b]),{datasource:ne,VariableQueryEditor:q}=ae??{};return t.createElement(t.Fragment,null,t.createElement(S.Y,null,"Query options"),t.createElement(o.D,{label:"Data source",htmlFor:"data-source-picker"},t.createElement(y.s,{current:b,onChange:M,variables:!0,width:30})),ne&&q&&t.createElement(p,{onQueryChange:R,onLegacyQueryChange:B,datasource:ne,query:A,VariableQueryEditor:q,timeRange:U}),t.createElement(O.Z,{defaultValue:W??"",name:"Regex",description:t.createElement("div",null,"Optional, if you want to extract part of a series name or metric node segment.",t.createElement("br",null),"Named capture groups can be used to separate the display text and value (",t.createElement("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/variables/filter-variables-with-regex#filter-and-modify-using-named-text-and-value-capture-groups",target:"__blank"},"see examples"),")."),placeholder:"/.*-(?<text>.*)-(?<value>.*)-.*/",onBlur:N,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRegExInputV2,width:52}),t.createElement(T,{testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsSortSelectV2,onChange:L,sort:w}),t.createElement(D,{testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRefreshSelectV2,onChange:K,refresh:V}),t.createElement(S.Y,null,"Selection options"),t.createElement(c.B,{multi:!!k,includeAll:!!H,allValue:X,onMultiChange:j,onIncludeAllChange:J,onAllValueChange:se}))}},94618:(G,I,e)=>{"use strict";e.d(I,{B:()=>m});var t=e(96540),n=e(13544),s=e(67061),r=e(99615),o=e(14329);function m({multi:l,includeAll:i,allValue:u,onMultiChange:d,onIncludeAllChange:p,onAllValueChange:c}){return t.createElement(s.B,{direction:"column",gap:2,height:"inherit",alignItems:"start"},t.createElement(r.c,{value:l,name:"Multi-value",description:"Enables multiple values to be selected at the same time",onChange:d,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsMultiSwitch}),t.createElement(r.c,{value:i,name:"Include All option",description:"Enables an option to include all variables",onChange:p,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsIncludeAllSwitch}),i&&t.createElement(o._,{defaultValue:u??"",onBlur:c,name:"Custom all value",placeholder:"blank = auto",testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsCustomAllInput}))}},99615:(G,I,e)=>{"use strict";e.d(I,{c:()=>r});var t=e(92145),n=e(96540),s=e(10880);function r({value:o,name:m,description:l,onChange:i,ariaLabel:u,testId:d}){const p=(0,t.Bi)();return n.createElement(s.S,{id:p,label:m,description:l,value:o,onChange:i,"aria-label":u,"data-testid":d})}},8964:(G,I,e)=>{"use strict";e.d(I,{D:()=>m});var t=e(96540),n=e(12470),s=e(88575),r=e(94354);const o=[{label:"Label and value",value:n.zL.dontHide},{label:"Value",value:n.zL.hideLabel},{label:"Nothing",value:n.zL.hideVariable}];function m({onChange:l,hide:i,type:u}){const d=(0,t.useMemo)(()=>o.find(p=>p.value===i)?.value??o[0].value,[i]);return u==="constant"?null:t.createElement(s.D,{label:"Show on dashboard"},t.createElement(r.z,{options:o,onChange:l,value:d}))}},58975:(G,I,e)=>{"use strict";e.d(I,{Y:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(17408);function o({className:l,...i}){const u=(0,s.of)(m);return n.createElement(r.s,{...i,className:(0,t.cx)(u.legend,l)})}function m(l){return{legend:(0,t.css)({marginTop:l.spacing(3),marginBottom:l.spacing(1)})}}},89458:(G,I,e)=>{"use strict";e.d(I,{v:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(88575),o=e(21594);function m({name:i,description:u,value:d,options:p,onChange:c,testId:y,width:f}){const P=(0,s.of)(l),a=(0,n.useId)(),E=`variable-select-input-${i}-${a}`;return n.createElement(r.D,{label:i,description:u,htmlFor:E},n.createElement(o.l6,{"data-testid":y,inputId:E,onChange:c,value:d,width:f??30,options:p,className:P.selectContainer}))}function l(i){return{selectContainer:(0,t.css)({marginRight:i.spacing(.5)})}}},85140:(G,I,e)=>{"use strict";e.d(I,{$:()=>i,Z:()=>l});var t=e(32196),n=e(92145),s=e(96540),r=e(40845),o=e(88575),m=e(21744);function l({value:u,defaultValue:d,name:p,description:c,placeholder:y,onChange:f,onBlur:P,ariaLabel:a,required:E,width:g,testId:h}){const D=(0,r.of)(i),v=(0,n.Bi)();return s.createElement(o.D,{label:p,description:c,htmlFor:v},s.createElement(m.f,{id:v,rows:2,value:u,defaultValue:d,onChange:f,onBlur:P,placeholder:y,required:E,"aria-label":a,cols:g,className:D.textarea,"data-testid":h}))}function i(u){return{textarea:(0,t.css)({whiteSpace:"pre-wrap",minHeight:u.spacing(4),height:"auto",overflow:"auto",padding:`${u.spacing(.75)} ${u.spacing(1)}`,width:"inherit",[u.breakpoints.down("sm")]:{width:"100%"}})}}},14329:(G,I,e)=>{"use strict";e.d(I,{_:()=>o});var t=e(92145),n=e(96540),s=e(88575),r=e(10354);function o({value:m,defaultValue:l,name:i,placeholder:u="",onChange:d,testId:p,width:c,required:y,onBlur:f,grow:P,description:a,invalid:E,error:g,maxLength:h}){const D=(0,t.Bi)(i);return n.createElement(s.D,{label:i,description:a,invalid:E,error:g,htmlFor:D},n.createElement(r.p,{type:"text",id:D,placeholder:u,value:m,defaultValue:l,onChange:d,onBlur:f,width:P?void 0:c??30,"data-testid":p,maxLength:h,required:y}))}},41820:(G,I,e)=>{"use strict";e.d(I,{j:()=>i});var t=e(32196),n=e(96540),s=e(13544),r=e(40845),o=e(39268),m=e(76892),l=e(55852);const i=({options:d})=>{const[p,c]=(0,n.useState)(20),[y,f]=(0,n.useState)([]),P=(0,n.useCallback)(E=>{E.preventDefault(),c(p+20)},[p,c]),a=(0,r.of)(u);return(0,n.useEffect)(()=>f(d.slice(0,p)),[p,d]),y.length?n.createElement("div",{style:{display:"flex",flexDirection:"column",marginTop:"16px"}},n.createElement("h5",null,"Preview of values"),n.createElement(o.C,null,y.map((E,g)=>n.createElement(o.C,{key:`${E.value}-${g}`,className:a.optionContainer},n.createElement(m.c,{"data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.General.previewOfValuesOption},n.createElement("div",{className:a.label},E.label))))),d.length>p&&n.createElement(o.C,{className:a.optionContainer},n.createElement(l.$n,{onClick:P,variant:"secondary",size:"sm","aria-label":"Variable editor Preview of Values Show More link"},"Show more"))):null};i.displayName="VariableValuesPreview";function u(d){return{wrapper:(0,t.css)({display:"flex",flexDirection:"column",marginTop:d.spacing(2)}),optionContainer:(0,t.css)({marginLeft:d.spacing(.5),marginBottom:d.spacing(.5)}),label:(0,t.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"50vw"})}}},17663:(G,I,e)=>{"use strict";e.d(I,{cH:()=>q,mJ:()=>ee,Ao:()=>X,e4:()=>se,kh:()=>j,CD:()=>K,No:()=>k,B$:()=>V,n_:()=>J,bZ:()=>N,c7:()=>ne});var t=e(2543),n=e(32264),s=e(19347),r=e(16401),o=e(79422),m=e(74730),l=e(96540),i=e(16817),u=e(27803);function d(z){const{variable:te}=z,{datasource:ie,defaultKeys:ce}=te.useState(),{value:ue}=(0,i.A)(async()=>await(0,s.l)().get(ie),[ie]),fe=ue?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.",Te=de=>{const le={uid:de.uid,type:de.type};te.setState({datasource:le})},he=de=>{te.setState({defaultKeys:de})};return l.createElement(u.Q,{datasource:ie??void 0,infoText:fe,onDataSourceChange:Te,defaultKeys:ce,onDefaultKeysChange:he})}var p=e(95802);function c({variable:z}){const{value:te}=z.useState(),ie=ce=>{z.setState({value:ce.currentTarget.value})};return l.createElement(p.d,{constantValue:String(te),onChange:ie})}var y=e(58711);function f({variable:z,onRunQuery:te}){const{query:ie,isMulti:ce,allValue:ue,includeAll:fe}=z.useState(),Te=pe=>{z.setState({isMulti:pe.currentTarget.checked})},he=pe=>{z.setState({includeAll:pe.currentTarget.checked})},de=pe=>{z.setState({query:pe.currentTarget.value}),te()},le=pe=>{z.setState({allValue:pe.currentTarget.value})};return l.createElement(y.w,{query:ie??"",multi:!!ce,allValue:ue??"",includeAll:!!fe,onMultiChange:Te,onIncludeAllChange:he,onQueryChange:de,onAllValueChange:le})}var P=e(98917);function a({variable:z,onRunQuery:te}){const{pluginId:ie,regex:ce,isMulti:ue,allValue:fe,includeAll:Te}=z.useState(),he=se(),de=Oe=>{z.setState({pluginId:Oe.value}),te()},le=Oe=>{z.setState({regex:Oe.currentTarget.value}),te()},pe=Oe=>{z.setState({isMulti:Oe.currentTarget.checked})},ve=Oe=>{z.setState({includeAll:Oe.currentTarget.checked})},be=Oe=>{z.setState({allValue:Oe.currentTarget.value})};return l.createElement(P.y,{query:ie,regex:ce,multi:ue||!1,allValue:fe,includeAll:Te||!1,optionTypes:he,onChange:de,onRegExBlur:le,onMultiChange:pe,onIncludeAllChange:ve,onAllValueChange:be})}var E=e(72436),g=e(13544),h=e(88575),D=e(42418),v=e(15292),C=e(32372),T=e(51612),S=e(58975);function O({datasource:z,defaultOptions:te,infoText:ie,onDataSourceChange:ce,onDefaultOptionsChange:ue}){const fe=(0,l.useCallback)(Te=>{const he=(0,E.Jh)(`key,value
`+Te)[0],de=[];for(let le=0;le<he.length;le++)de.push({text:he.fields[0].values[le],value:he.fields[1].values[le]});ue(de)},[ue]);return l.createElement(l.Fragment,null,l.createElement(S.Y,null,"Group by options"),l.createElement(h.D,{label:"Data source",htmlFor:"data-source-picker"},l.createElement(T.s,{current:z,onChange:ce,width:30,variables:!0,noDefault:!0})),ie?l.createElement(D.F,{title:ie,severity:"info","data-testid":g.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.infoText}):null,l.createElement(h.D,{label:"Use static Group By dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId"},l.createElement(v.d,{"data-testid":g.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.modeToggle,value:te!==void 0,onChange:Te=>{ue(te===void 0?[]:void 0)}})),te!==void 0&&l.createElement(C.B,{height:300,language:"csv",value:te.map(Te=>`${Te.text},${Te.value}`).join(`
`),onBlur:fe,onSave:fe,showMiniMap:!1,showLineNumbers:!0}))}function x(z){const{variable:te,onRunQuery:ie}=z,{datasource:ce,defaultOptions:ue}=te.useState(),{value:fe}=(0,i.A)(async()=>await(0,s.l)().get(ce),[te.state]),Te=fe?.getTagKeys?"Group by dimensions are applied automatically to all queries that target this data source":"This data source does not support group by variable yet.",he=async le=>{const pe={uid:le.uid,type:le.type};te.setState({datasource:pe}),ie()},de=async le=>{te.setState({defaultOptions:le}),ie()};return l.createElement(O,{defaultOptions:ue,datasource:ce??void 0,infoText:ce?Te:void 0,onDataSourceChange:he,onDefaultOptionsChange:de})}var b=e(49317);function M({variable:z,onRunQuery:te}){const{intervals:ie,autoStepCount:ce,autoEnabled:ue,autoMinInterval:fe,value:Te}=z.useState(),he=(0,m.bx)(ie),de=be=>{const Oe=(0,m.Sm)(be.currentTarget.value),Me=Oe.includes(Te)?Te:Oe[0];z.setState({intervals:Oe,value:Me}),te()},le=be=>{z.setState({autoStepCount:be.value})},pe=be=>{z.setState({autoEnabled:be.target.checked})},ve=be=>{z.setState({autoMinInterval:be.currentTarget.value})};return l.createElement(b.s,{intervals:he,autoStepCount:ce,autoEnabled:ue,onAutoCountChanged:le,onIntervalsChange:de,onAutoEnabledChange:pe,onAutoMinIntervalChanged:ve,autoMinInterval:fe})}var A=e(44890);function R({variable:z,onRunQuery:te}){const{datasource:ie,regex:ce,sort:ue,refresh:fe,isMulti:Te,includeAll:he,allValue:de,query:le}=z.useState(),{value:pe}=r.jh.getTimeRange(z).useState(),ve=xe=>{z.setState({regex:xe.currentTarget.value})},be=xe=>{z.setState({sort:xe.value})},Oe=xe=>{z.setState({refresh:xe})},Me=xe=>{z.setState({isMulti:xe.currentTarget.checked})},Ue=xe=>{z.setState({includeAll:xe.currentTarget.checked})},we=xe=>{z.setState({allValue:xe.currentTarget.value})},Re=xe=>{const Ve={uid:xe.uid,type:xe.type};if(z.state.datasource&&z.state.datasource.type!==Ve.type){z.setState({datasource:Ve,query:"",definition:""});return}z.setState({datasource:Ve})},Fe=xe=>{let Ve;typeof xe=="string"?Ve=xe:xe.hasOwnProperty("query")&&typeof xe.query=="string"?Ve=xe.query:Ve="",z.setState({query:xe,definition:Ve}),te()};return l.createElement(A.u,{datasource:ie??void 0,onDataSourceChange:Re,query:le,onQueryChange:Fe,onLegacyQueryChange:Fe,timeRange:pe,regex:ce,onRegExChange:ve,sort:ue,onSortChange:be,refresh:fe,onRefreshChange:Oe,isMulti:!!Te,onMultiChange:Me,includeAll:!!he,onIncludeAllChange:Ue,allValue:de??"",onAllValueChange:we})}var B=e(14329);function U({defaultValue:z,value:te,onChange:ie,onBlur:ce}){return l.createElement(l.Fragment,null,l.createElement(S.Y,null,"Text options"),l.createElement(B._,{value:te,defaultValue:z,name:"Default value",placeholder:"default value, if any",onChange:ie,onBlur:ce,width:30,testId:g.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2}))}function W({variable:z}){const{value:te}=z.useState(),ie=ce=>{z.setState({value:ce.currentTarget.value})};return l.createElement(U,{defaultValue:te,onBlur:ie})}function N(z){return z!=="system"}const w={custom:{name:"Custom",description:"Define variable values manually",editor:f},query:{name:"Query",description:"Variable values are fetched from a datasource query",editor:R},constant:{name:"Constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share",editor:c},interval:{name:"Interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",editor:M},datasource:{name:"Data source",description:"Enables you to dynamically switch the data source for multiple panels",editor:a},adhoc:{name:"Ad hoc filters",description:"Add key/value filters on the fly",editor:d},groupby:{name:"Group by",description:"Add keys to group by on the fly",editor:x},textbox:{name:"Textbox",description:"Define a textbox variable, where users can enter any arbitrary string",editor:W}},L=["query","custom","textbox","constant","datasource","interval","adhoc","groupby"];function V(){const z=L.map(te=>({label:w[te].name,value:te,description:w[te].description}));return n.$.featureToggles.groupByVariable?z:z.filter(te=>te.value!=="groupby")}function K(z){return w[z].editor}function k(z,te){switch(z){case"custom":return new r.yP(te);case"query":return new r.fS(te);case"constant":return new r.x0({...te,hide:o.zL.hideVariable});case"interval":return new r.Yj(te);case"datasource":return new r.mI(te);case"adhoc":return new r.H9(te);case"groupby":return new r.ZG(te);case"textbox":return new r.TS(te)}}function j(z){const ie=H("query",z);return new r.fS({name:ie})}function H(z,te){let ie=0,ce=`${z}${ie}`;for(;te.find(ue=>ue.state.name===ce);)ce=`${z}${++ie}`;return ce}function J(z){return"options"in z.state||"intervals"in z.state}function X(z){let te="";return z instanceof r.fS?te=z.state.definition||(typeof z.state.query=="string"?z.state.query:""):z instanceof r.mI?te=String(z.state.pluginId):z instanceof r.yP?te=z.state.query:z instanceof r.Yj?te=(0,m.bx)(z.state.intervals):(z instanceof r.TS||z instanceof r.x0)&&(te=String(z.state.value)),te}function se(){const z=(0,s.l)().getList({metrics:!0,variables:!0}),te=(0,t.chain)(z).uniqBy("meta.id").map(ie=>({label:ie.meta.name,value:ie.meta.id})).value();return te.unshift({label:"",value:""}),te}function ae(z){return"type"in z.state&&"getValue"in z}function ne(z){return ae(z)?r.Go.isAdHocVariable(z)||r.Go.isConstantVariable(z)||r.Go.isCustomVariable(z)||r.Go.isDataSourceVariable(z)||r.Go.isIntervalVariable(z)||r.Go.isQueryVariable(z)||r.Go.isTextBoxVariable(z)||r.Go.isGroupByVariable(z):!1}const q=/^(?!__).*$/,ee=/^\w+$/},19626:(G,I,e)=>{"use strict";e.d(I,{D:()=>c});var t=e(32196),n=e(2543),s=e(96540),r=e(40845),o=e(14578);const m=({diff:f})=>{const P=(0,r.of)(l),a=!(0,n.isUndefined)(f.originalValue)&&!(0,n.isArray)(f.originalValue)&&!(0,n.isObject)(f.originalValue),E=!(0,n.isUndefined)(f.value)&&!(0,n.isArray)(f.value)&&!(0,n.isObject)(f.value);return s.createElement(s.Fragment,null,a&&s.createElement("span",{className:P},String(f.originalValue)),a&&E?s.createElement(o.I,{name:"arrow-right"}):null,E&&s.createElement("span",{className:P},String(f.value)))},l=f=>(0,t.css)({backgroundColor:f.colors.action.hover,borderRadius:f.shape.radius.default,color:f.colors.text.primary,fontSize:f.typography.body.fontSize,margin:f.spacing(0,.5),padding:f.spacing(.25,.5)});var i=e(56596);const u={op:"replace",originalValue:void 0,path:[""],value:void 0,startLineNumber:0,endLineNumber:0},d=({diff:f,title:P})=>{const a=(0,r.of)(p);return f?s.createElement(s.Fragment,null,s.createElement(o.I,{type:"mono",name:"circle",className:a[f.op],size:"xs"})," ",s.createElement("span",{className:a.embolden},P)," ",s.createElement("span",null,(0,i.Fl)(f,f.path.length>1))," ",s.createElement(m,{diff:f})):s.createElement("div",{className:a.withoutDiff},s.createElement(o.I,{type:"mono",name:"circle",className:a.replace,size:"xs"})," ",s.createElement("span",{className:a.embolden},P)," ",s.createElement("span",null,(0,i.Fl)(u,!1)))},p=f=>({embolden:(0,t.css)({fontWeight:f.typography.fontWeightBold}),add:(0,t.css)({color:f.colors.success.main}),replace:(0,t.css)({color:f.colors.success.main}),move:(0,t.css)({color:f.colors.success.main}),copy:(0,t.css)({color:f.colors.success.main}),_get:(0,t.css)({color:f.colors.success.main}),test:(0,t.css)({color:f.colors.success.main}),remove:(0,t.css)({color:f.colors.success.main}),withoutDiff:(0,t.css)({marginBottom:f.spacing(1)})}),c=({diffs:f,title:P})=>{const a=(0,r.of)(y);return f.length===1?s.createElement("div",{className:a.container,"data-testid":"diffGroup"},s.createElement(d,{title:P,diff:f[0]})):s.createElement("div",{className:a.container,"data-testid":"diffGroup"},s.createElement(d,{title:P}),s.createElement("ul",{className:a.list},f.map((E,g)=>s.createElement("li",{className:a.listItem,key:`${(0,n.last)(E.path)}__${g}`},s.createElement("span",null,(0,i.Fl)(E))," ",s.createElement(m,{diff:E})))))},y=f=>({container:(0,t.css)({}),list:(0,t.css)({marginLeft:f.spacing(4)}),listItem:(0,t.css)({marginBottom:f.spacing(1),"&:last-child":{marginBottom:0}})})},22764:(G,I,e)=>{"use strict";e.d(I,{M:()=>l});var t=e(32196),n=e(96540),s=e(24773),r=e.n(s),o=e(84140),m=e(40845);const l=({oldValue:i,newValue:u,...d})=>{const p=(0,m.$j)(),c={variables:{dark:{diffViewerBackground:p.colors.background.canvas,diffViewerColor:p.colors.text.primary,addedBackground:(0,o.A)(p.v1.palette.greenShade).setAlpha(.3).toString(),addedColor:"white",removedBackground:(0,o.A)(p.v1.palette.redShade).setAlpha(.3).toString(),removedColor:"white",wordAddedBackground:(0,o.A)(p.v1.palette.greenBase).setAlpha(.4).toString(),wordRemovedBackground:(0,o.A)(p.v1.palette.redBase).setAlpha(.4).toString(),addedGutterBackground:(0,o.A)(p.v1.palette.greenShade).setAlpha(.2).toString(),removedGutterBackground:(0,o.A)(p.v1.palette.redShade).setAlpha(.2).toString(),gutterBackground:p.colors.background.primary,gutterBackgroundDark:p.colors.background.primary,highlightBackground:(0,o.A)(p.colors.primary.main).setAlpha(.4).toString(),highlightGutterBackground:(0,o.A)(p.colors.primary.shade).setAlpha(.2).toString(),codeFoldGutterBackground:p.colors.background.secondary,codeFoldBackground:p.colors.background.secondary,emptyLineBackground:p.colors.background.secondary,gutterColor:p.colors.text.disabled,addedGutterColor:p.colors.text.primary,removedGutterColor:p.colors.text.primary,codeFoldContentColor:p.colors.text.disabled,diffViewerTitleBackground:p.colors.background.secondary,diffViewerTitleColor:p.colors.text.disabled,diffViewerTitleBorderColor:p.colors.border.strong}},codeFold:{fontSize:p.typography.bodySmall.fontSize},gutter:{pre:{color:(0,o.A)(p.colors.text.disabled).setAlpha(1).toString(),opacity:.61}}};return n.createElement("div",{className:(0,t.css)({fontSize:p.typography.bodySmall.fontSize,pre:{all:"revert"}})},n.createElement(r(),{styles:c,oldValue:i,newValue:u,splitView:!1,compareMethod:s.DiffMethod.CSS,useDarkTheme:p.isDark,...d}))}},57714:(G,I,e)=>{"use strict";e.d(I,{Cc:()=>A,me:()=>h,bS:()=>f,rJ:()=>T,wL:()=>s});var t=e(17172);class n{getHistoryList(U,W){return typeof U!="string"?Promise.resolve([]):(0,t.AI)().get(`api/dashboards/uid/${U}/versions`,W)}getDashboardVersion(U,W){return typeof U!="string"?Promise.resolve({}):(0,t.AI)().get(`api/dashboards/uid/${U}/versions/${W}`)}restoreDashboard(U,W){if(typeof U!="string")return Promise.resolve({});const N=`api/dashboards/uid/${U}/restore`;return(0,t.AI)().post(N,{version:W})}}const s=new n;var r=e(32196),o=e(96540),m=e(40845),l=e(10880),i=e(78369),u=e(71678),d=e(55852),p=e(96374),c=e(3169);const y=({hideModal:B,onRestore:U,version:W})=>{const N=(0,c._2)(),w=async()=>{await U(W)?N.success("Dashboard restored",`Restored from version ${W.version}`):N.error("Dashboard restore failed",`Failed to restore from version ${W.version}`),B()};return o.createElement(p.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:B,onConfirm:w,body:o.createElement("p",null,"Are you sure you want to restore the dashboard to version ",W.version,"? All unsaved changes will be lost."),confirmText:`Yes, restore to version ${W.version}`})},f=({versions:B,canCompare:U,onCheck:W,onRestore:N})=>{const w=(0,m.of)(P);return o.createElement("div",{className:w.margin},o.createElement("table",{className:"filter-table"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",{className:"width-4"}),o.createElement("th",{className:"width-4"},"Version"),o.createElement("th",{className:"width-14"},"Date"),o.createElement("th",{className:"width-10"},"Updated by"),o.createElement("th",null,"Notes"),o.createElement("th",null))),o.createElement("tbody",null,B.map((L,V)=>o.createElement("tr",{key:L.id},o.createElement("td",null,o.createElement(l.S,{"aria-label":`Toggle selection of version ${L.version}`,className:(0,r.css)({display:"inline"}),checked:L.checked,onChange:K=>W(K,L.id),disabled:!L.checked&&U})),o.createElement("td",null,L.version),o.createElement("td",null,L.createdDateString),o.createElement("td",null,L.createdBy),o.createElement("td",null,L.message),o.createElement("td",{className:"text-right"},V===0?o.createElement(i.v,{name:"Latest",colorIndex:17}):o.createElement(u.$s,null,({showModal:K,hideModal:k})=>o.createElement(d.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{K(y,{version:L,hideModal:k,onRestore:N})}},"Restore"))))))))};function P(B){return{margin:(0,r.css)({marginBottom:B.spacing(4)})}}var a=e(2543),E=e(29158),g=e(14578);const h=({onClick:B=a.noop,baseVersion:U=0,newVersion:W=0,isNewLatest:N=!1})=>{const w=(0,m.of)(D);return o.createElement("h3",{className:w.header},o.createElement(E.K,{name:"arrow-left",size:"xl",onClick:B,tooltip:"Reset version"}),o.createElement("span",null,"Comparing ",U," ",o.createElement(g.I,{name:"arrows-h"})," ",W," ",N&&o.createElement("cite",{className:"muted"},"(Latest)")))},D=B=>({header:(0,r.css)({fontSize:B.typography.h3.fontSize,display:"flex",gap:B.spacing(2),marginBottom:B.spacing(2)})});var v=e(67061),C=e(56034);const T=({hasMore:B,canCompare:U,getVersions:W,getDiff:N,isLastPage:w})=>o.createElement(v.B,null,B&&o.createElement(d.$n,{type:"button",onClick:()=>W(!0),variant:"secondary",disabled:w},"Show more versions"),o.createElement(C.m,{content:"Select two versions to start comparing",placement:"bottom"},o.createElement(d.$n,{type:"button",disabled:!U,onClick:N,icon:"code-branch"},"Compare versions")));var S=e(90613),O=e(57418),x=e(19626),b=e(22764),M=e(56596);const A=({baseInfo:B,newInfo:U,diffData:W,isNewLatest:N,onRestore:w})=>{const L=(0,M.G4)(W.lhs,W.rhs),V=(0,m.of)(R);return o.createElement(v.B,{direction:"column",gap:1},o.createElement(v.B,{justifyContent:"space-between",alignItems:"center"},o.createElement(v.B,{alignItems:"center"},o.createElement("span",{className:(0,r.cx)(V.versionInfo,V.noMarginBottom)},o.createElement("strong",null,"Version ",B.version)," updated by ",B.createdBy," ",B.ageString,B.message),o.createElement(g.I,{name:"arrow-right",size:"sm"}),o.createElement("span",{className:V.versionInfo},o.createElement("strong",null,"Version ",U.version)," updated by ",U.createdBy," ",U.ageString,U.message)),N&&o.createElement(u.$s,null,({showModal:K,hideModal:k})=>o.createElement(d.$n,{variant:"destructive",icon:"history",onClick:()=>{K(y,{version:B,onRestore:w,hideModal:k})}},"Restore to version ",B.version))),Object.entries(L).map(([K,k])=>o.createElement(x.D,{diffs:k,key:K,title:K})),o.createElement(S.a,{paddingTop:2},o.createElement(O.M,{isOpen:!1,label:"View JSON Diff"},o.createElement(b.M,{oldValue:JSON.stringify(W.lhs,null,2),newValue:JSON.stringify(W.rhs,null,2)}))))},R=B=>({versionInfo:(0,r.css)({color:B.colors.text.secondary,fontSize:B.typography.bodySmall.fontSize}),noMarginBottom:(0,r.css)({marginBottom:0})})},56596:(G,I,e)=>{"use strict";e.d(I,{Fl:()=>m,G4:()=>o});var t=e(16111),n=e(25504),s=e(2543),r=e.n(s);const o=(u,d)=>{const p=(0,t.UD)(u,d),c=n.stringify(u,null,2),y=n.stringify(d,null,2),f=E=>E.map(g=>{let h,D,v=0,C=0;const T=(0,s.tail)(g.path.split("/"));return g.op==="replace"&&y.pointers[g.path]&&(h=(0,s.get)(u,T),D=g.value,v=y.pointers[g.path].value.line,C=y.pointers[g.path].valueEnd.line),g.op==="add"&&y.pointers[g.path]&&(D=g.value,v=y.pointers[g.path].value.line,C=y.pointers[g.path].valueEnd.line),g.op==="remove"&&c.pointers[g.path]&&(h=(0,s.get)(u,T),v=c.pointers[g.path].value.line,C=c.pointers[g.path].valueEnd.line),{op:g.op,value:D,path:T,originalValue:h,startLineNumber:v,endLineNumber:C}}),P=E=>(0,s.sortBy)(E,"startLineNumber"),a=E=>E.reduce((g,h)=>{const D=h.path[0];return g[D]||(g[D]=[]),g[D].push(h),g},{});return(0,s.flow)([f,P,a])(p)},m=(u,d=!0)=>{const p=(0,s.last)(u.path),c=l(p),y=u.op==="remove"?u.originalValue:u.value;let f=i(u.op);return d&&(c?f+=` item ${p}`:(0,s.isArray)(y)&&!(0,s.isEmpty)(y)?f+=` ${y.length} ${p}`:f+=` ${p}`),f},l=u=>!(0,s.isNaN)((0,s.toNumber)(u)),i=u=>u==="add"?"added":u==="remove"?"deleted":"changed"},58441:(G,I,e)=>{"use strict";e.d(I,{Z:()=>Ke});var t=e(96540),n=e(32264),s=e(16401),r=e(25897),o=e(37390),m=e(40980),l=e(10096),i=e(8484),u=e(72254),d=e(22699),p=e(60656),c=e(7758),y=e(74730),f=e(4213),P=e.n(f),a=e(16817),E=e(70713),g=e(67061),h=e(88575),D=e(15292),v=e(55852),C=e(32372),T=e(10534),S=e(15858),O=e(34214),x=e(20455),b=e(73788);class M extends s.Bs{constructor(ft){super({isSharingExternally:!1,isViewingJSON:!1,...ft}),this.tabId=d.wr.export,this._exporter=new S.M,this.onShareExternallyChange=()=>{this.setState({isSharingExternally:!this.state.isSharingExternally})},this.onViewJSON=()=>{this.setState({isViewingJSON:!this.state.isViewingJSON})}}static{this.Component=A}getTabLabel(){return(0,i.t)("share-modal.tab-title.export","Export")}getClipboardText(){}async getExportableDashboardJson(){const{dashboardRef:ft,isSharingExternally:pt}=this.state,Ge=(0,x.Uy)(ft.resolve());return pt?await this._exporter.makeExportable(new O.G(Ge,void 0,{getVariablesFromState:()=>(0,b.E)(window.__grafanaSceneContext)})):Ge}async onSaveAsFile(){const ft=await this.getExportableDashboardJson(),pt=JSON.stringify(ft,null,2),{isSharingExternally:Ge}=this.state,qe=new Blob([pt],{type:"application/json;charset=utf-8"}),bt=new Date().getTime();let Ft="dashboard";"title"in ft&&ft.title&&(Ft=ft.title),P()(qe,`${Ft}-${bt}.json`),c.c.exportDownloadJsonClicked({externally:Ge})}}function A({model:rt}){const{isSharingExternally:ft,isViewingJSON:pt,modalRef:Ge}=rt.useState(),qe=(0,a.A)(async()=>{if(pt){const Ft=await rt.getExportableDashboardJson();return JSON.stringify(Ft,null,2)}return""},[pt]),bt=(0,i.t)("share-modal.export.share-externally-label","Export for sharing externally");return t.createElement(t.Fragment,null,!pt&&t.createElement(t.Fragment,null,t.createElement("p",{className:"share-modal-info-text"},t.createElement(i.x6,{i18nKey:"share-modal.export.info-text"},"Export this dashboard.")),t.createElement(g.B,{gap:2,direction:"column"},t.createElement(h.D,{label:bt},t.createElement(D.d,{id:"share-externally-toggle",value:ft,onChange:rt.onShareExternallyChange}))),t.createElement(o.a.ButtonRow,null,t.createElement(v.$n,{variant:"secondary",onClick:()=>{Ge?.resolve().onDismiss()},fill:"outline"},t.createElement(i.x6,{i18nKey:"share-modal.export.cancel-button"},"Cancel")),t.createElement(v.$n,{variant:"secondary",icon:"brackets-curly",onClick:rt.onViewJSON},t.createElement(i.x6,{i18nKey:"share-modal.export.view-button"},"View JSON")),t.createElement(v.$n,{variant:"primary",icon:"save",onClick:()=>rt.onSaveAsFile()},t.createElement(i.x6,{i18nKey:"share-modal.export.save-button"},"Save to file")))),pt&&t.createElement(t.Fragment,null,t.createElement(E.Ay,{disableHeight:!0},({width:Ft})=>qe.value?t.createElement(C.B,{value:qe.value??"",language:"json",showMiniMap:!1,height:"500px",width:Ft}):qe.loading?t.createElement("div",null,"Loading..."):null),t.createElement(o.a.ButtonRow,null,t.createElement(v.$n,{variant:"secondary",fill:"outline",onClick:rt.onViewJSON,icon:"arrow-left"},t.createElement(i.x6,{i18nKey:"share-modal.export.back-button"},"Back to export config")),t.createElement(T.b,{variant:"secondary",icon:"copy",disabled:qe.loading,getText:()=>qe.value??""},t.createElement(i.x6,{i18nKey:"share-modal.view-json.copy-button"},"Copy to Clipboard")),t.createElement(v.$n,{variant:"primary",icon:"save",disabled:qe.loading,onClick:()=>rt.onSaveAsFile()},t.createElement(i.x6,{i18nKey:"share-modal.export.save-button"},"Save to file")))))}var R=e(86394),B=e(41507);class U extends s.Bs{constructor(){super(...arguments),this.tabId=d.wr.libraryPanel}static{this.Component=W}getTabLabel(){return(0,i.t)("share-modal.tab-title.library-panel","Library panel")}}function W({model:rt}){const{panelRef:ft,dashboardRef:pt,modalRef:Ge}=rt.useState();if(!ft)return null;const qe=ft.resolve(),bt=qe.parent;if(bt instanceof B.U){const Ft=pt.resolve(),Xt=(0,x.ZB)(bt),Lt=new O.a(Xt),Qt=(0,x.Uy)(Ft),an=new O.G(Qt);return t.createElement(R.j,{initialFolderUid:Ft.state.meta.folderUid,dashboard:an,panel:Lt,onDismiss:()=>{Ge?.resolve().onDismiss()},onCreateLibraryPanel:gn=>Ft.createLibraryPanel(qe,gn)})}return null}var N=e(47232),w=e(13544),L=e(84167),V=e(10354),K=e(14578),k=e(42418),j=e(7030),H=e(87895),J=e(11982);class X extends s.Bs{constructor(ft){super({...ft,useLockedTime:!0,useShortUrl:!1,selectedTheme:"current",shareUrl:"",imageUrl:""}),this.tabId=d.wr.link,this.onToggleLockedTime=()=>{this.setState({useLockedTime:!this.state.useLockedTime}),this.buildUrl()},this.onUrlShorten=()=>{this.setState({useShortUrl:!this.state.useShortUrl}),this.buildUrl()},this.onThemeChange=pt=>{this.setState({selectedTheme:pt}),this.buildUrl()},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{c.c.shareLinkCopied({currentTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,d.hD)(this.state.panelRef)})},this.addActivationHandler(()=>{this.buildUrl()})}static{this.Component=se}async buildUrl(){const{panelRef:ft,dashboardRef:pt,useLockedTime:Ge,useShortUrl:qe,selectedTheme:bt}=this.state,Ft=pt.resolve(),Xt=ft?.resolve(),Lt={useAbsoluteTimeRange:Ge,theme:bt};let Qt=await(0,j.VN)(Ft,Lt,Xt);qe&&(Qt=await(0,j.fn)(Qt));const an=s.jh.getTimeRange(Xt??Ft),gn=(0,j.$l)(Lt,an,Xt);let ut=gn;Xt&&(delete ut.viewPanel,ut.panelId=Xt.state.key,ut["__feature.dashboardSceneSolo"]=!0);const Nt=(0,J.uZ)({uid:Ft.state.uid,currentQueryParams:location.search,updateQuery:{...gn,panelId:Xt?.state.key},absolute:!0,soloRoute:!0,render:!0,timeZone:ae(an.getTimeZone())});this.setState({shareUrl:Qt,imageUrl:Nt})}getTabLabel(){return(0,i.t)("share-modal.tab-title.link","Link")}}function se({model:rt}){const ft=rt.useState(),{panelRef:pt,dashboardRef:Ge}=ft,qe=Ge.resolve(),bt=pt?.resolve(),Xt=s.jh.getTimeRange(bt??qe).state.to==="now",{useLockedTime:Lt,useShortUrl:Qt,selectedTheme:an,shareUrl:gn,imageUrl:ut}=ft,Nt=w.Tp.pages.SharePanelModal,ht=!!qe.state.uid,Rt=(0,i.t)("share-modal.link.time-range-label","Lock time range"),_t=(0,i.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),on=(0,i.t)("share-modal.link.shorten-url","Shorten URL"),ln=(0,i.t)("share-modal.link.link-url","Link URL");return t.createElement(t.Fragment,null,t.createElement("p",{className:"share-modal-info-text"},t.createElement(i.x6,{i18nKey:"share-modal.link.info-text"},"Create a direct link to this dashboard or panel, customized with the options below.")),t.createElement(L.n,null,t.createElement(h.D,{label:Rt,description:Xt?_t:""},t.createElement(D.d,{id:"share-current-time-range",value:Lt,onChange:rt.onToggleLockedTime})),t.createElement(H.w,{selectedTheme:an,onChange:rt.onThemeChange}),t.createElement(h.D,{label:on},t.createElement(D.d,{id:"share-shorten-url",value:Qt,onChange:rt.onUrlShorten})),t.createElement(h.D,{label:ln},t.createElement(V.p,{id:"link-url-input",value:gn,readOnly:!0,addonAfter:t.createElement(T.b,{icon:"copy",variant:"primary",getText:rt.getShareUrl,onClipboardCopy:rt.onCopy},t.createElement(i.x6,{i18nKey:"share-modal.link.copy-link-button"},"Copy"))}))),bt&&n.$.rendererAvailable&&t.createElement(t.Fragment,null,ht&&t.createElement("div",{className:"gf-form"},t.createElement("a",{href:ut,target:"_blank",rel:"noreferrer","aria-label":Nt.linkToRenderedImage},t.createElement(K.I,{name:"camera"}),"\xA0",t.createElement(i.x6,{i18nKey:"share-modal.link.rendered-image"},"Direct link rendered image"))),!ht&&t.createElement(k.F,{severity:"info",title:(0,i.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0},t.createElement(i.x6,{i18nKey:"share-modal.link.save-dashboard"},"To render a panel image, you must save the dashboard first."))),bt&&!n.$.rendererAvailable&&t.createElement(k.F,{severity:"info",title:(0,i.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0},t.createElement(i.x6,{i18nKey:"share-modal.link.render-instructions"},"To render a panel image, you must install the"," ",t.createElement("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link"},"Grafana image renderer plugin"),". Please contact your Grafana administrator to install the plugin.")))}function ae(rt){const ft="UTC"+encodeURIComponent((0,N.KQ)().format("Z"));if(rt==="utc")return"UTC";if(rt==="browser"){if(!window.Intl)return ft;const Ge=window.Intl.DateTimeFormat().resolvedOptions();return Ge.timeZone?Ge.timeZone:ft}return rt}var ne=e(35280),q=e(7928);class ee extends s.Bs{constructor(ft){super(ft),this.tabId=d.wr.embed}static{this.Component=z}getTabLabel(){return(0,i.t)("share-modal.tab-title.panel-embed","Embed")}}function z({model:rt}){const{panelRef:ft,dashboardRef:pt}=rt.useState(),Ge=ft.resolve(),qe=pt.resolve(),{uid:bt}=qe.useState(),Ft=(0,y.Cs)(Ge),Xt=s.jh.getTimeRange(Ge),Lt=Xt instanceof q.v?Xt.state.timeFrom:void 0;return t.createElement(ne.D,{panel:{id:Ft,timeFrom:Lt},range:Xt.state.value,dashboard:{uid:bt??"",time:Xt.state.value},buildIframe:te(qe)})}const te=rt=>(ft,pt,Ge,qe,bt)=>{const Ft=(0,d.XV)({useCurrentTimeRange:ft,selectedTheme:Ge,panel:qe,range:bt}),Xt=Ft.get("editPanel")??Ft.get("viewPanel")??"";return Ft.set("panelId",Xt),Ft.delete("editPanel"),Ft.delete("viewPanel"),Ft.set("__feature.dashboardSceneSolo","true"),`<iframe src="${(0,J.uZ)({absolute:!0,soloRoute:!0,uid:rt.state.uid,slug:rt.state.meta.slug,currentQueryParams:Ft.toString()})}" width="450" height="200" frameborder="0"></iframe>`};var ie=e(5805),ce=e(17172),ue=e(94354),fe=e(69064);const Te=w.Tp.pages.ShareDashboardModal.SnapshotScene,he=()=>{const rt={label:(0,i.t)("share-modal.snapshot.expire-week","1 Week"),value:604800};return[{label:(0,i.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,i.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},rt,{label:(0,i.t)("share-modal.snapshot.expire-never","Never"),value:0}]},de=()=>he()[2];class le extends s.Bs{constructor(ft){super({...ft,snapshotName:ft.dashboardRef.resolve().state.title,selectedExpireOption:de()}),this.tabId=d.wr.snapshot,this.onSnasphotNameChange=pt=>{this.setState({snapshotName:pt.trim()})},this.onExpireChange=pt=>{this.setState({selectedExpireOption:he().find(Ge=>Ge.value===pt)})},this.onSnapshotCreate=async(pt=!1)=>{const{selectedExpireOption:Ge}=this.state,qe=this.prepareSnapshot(),bt={dashboard:qe,name:qe.title,expires:Ge?.value,external:pt};try{return await(0,fe.s)().create(bt)}finally{pt?c.c.publishSnapshotClicked({expires:bt.expires,shareResource:(0,d.hD)(this.state.panelRef)}):c.c.publishSnapshotLocalClicked({expires:bt.expires,shareResource:(0,d.hD)(this.state.panelRef)})}},this.addActivationHandler(()=>{this._onActivate()})}static{this.Component=pe}_onActivate(){(0,fe.s)().getSharingOptions().then(ft=>{this.isActive&&this.setState({snapshotSharingOptions:ft})})}getTabLabel(){return(0,i.t)("share-modal.tab-title.snapshot","Snapshot")}prepareSnapshot(){const ft=s.jh.getTimeRange(this),{dashboardRef:pt,panelRef:Ge}=this.state,qe=(0,x.Uy)(pt.resolve(),!0);return(0,x.c)(this.state.snapshotName||"",ft.state.value,qe,Ge?.resolve())}}function pe({model:rt}){const{snapshotName:ft,selectedExpireOption:pt,modalRef:Ge,snapshotSharingOptions:qe}=rt.useState(),[bt,Ft]=(0,ie.default)(async(Qt=!1)=>rt.onSnapshotCreate(Qt)),[Xt,Lt]=(0,ie.default)(async Qt=>await(0,ce.AI)().get(Qt));return Xt.value?t.createElement(i.x6,{i18nKey:"share-modal.snapshot.deleted-message"},"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."):t.createElement(t.Fragment,null,!bt.value&&t.createElement(t.Fragment,null,t.createElement("div",null,t.createElement("p",{className:"share-modal-info-text"},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.info-text-1"},"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard.")),t.createElement("p",{className:"share-modal-info-text"},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.info-text-2"},"Keep in mind, your snapshot ",t.createElement("em",null,"can be viewed by anyone")," that has the link and can access the URL. Share wisely."))),t.createElement(h.D,{label:(0,i.t)("share-modal.snapshot.name","Snapshot name")},t.createElement(V.p,{id:"snapshot-name-input",width:30,defaultValue:ft,onBlur:Qt=>rt.onSnasphotNameChange(Qt.target.value)})),t.createElement(h.D,{label:(0,i.t)("share-modal.snapshot.expire","Expire")},t.createElement(ue.z,{id:"expire-select-input",options:he(),value:pt?.value,onChange:rt.onExpireChange})),t.createElement(o.a.ButtonRow,null,t.createElement(v.$n,{variant:"secondary",onClick:()=>{Ge?.resolve().onDismiss()},fill:"outline"},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.cancel-button"},"Cancel")),qe?.externalEnabled&&t.createElement(v.$n,{variant:"secondary",disabled:bt.loading,onClick:()=>Ft(!0)},qe?.externalSnapshotName),t.createElement(v.$n,{variant:"primary",disabled:bt.loading,onClick:()=>Ft(),"data-testid":Te.PublishSnapshot},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.local-button"},"Publish Snapshot")))),bt.value&&t.createElement(t.Fragment,null,t.createElement(h.D,{label:(0,i.t)("share-modal.snapshot.url-label","Snapshot URL")},t.createElement(V.p,{"data-testid":Te.CopyUrlInput,id:"snapshot-url-input",value:bt.value.url,readOnly:!0,addonAfter:t.createElement(T.b,{"data-testid":Te.CopyUrlButton,icon:"copy",variant:"primary",getText:()=>bt.value.url},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.copy-link-button"},"Copy"))})),t.createElement("div",{className:"pull-right",style:{padding:"5px"}},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.mistake-message"},"Did you make a mistake? "),"\xA0",t.createElement(v.$n,{fill:"outline",size:"md",variant:"destructive",onClick:()=>{Lt(bt.value.deleteUrl)}},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.delete-button"},"Delete snapshot.")))))}var ve=e(72686),be=e(4785),Oe=e(32196),Me=e(40845),Ue=e(59037),we=e(31678),Re=e(96374);class Fe extends s.Bs{static{this.Component=xe}constructor(ft){super({confirmVariant:"destructive",dismissText:"Cancel",dismissVariant:"secondary",icon:"exclamation-triangle",confirmButtonVariant:"destructive",...ft})}onDismiss(){}}function xe({model:rt}){const ft=rt.useState();return t.createElement(Re.u,{...ft})}var Ve=e(26657),$e=e(31204),Xe=e(31193);const gt=async rt=>{let ft=new Set;for(const pt of rt)$e.z.has(pt)&&await(0,Xe.tR)().get(pt)instanceof Ve.iy||ft.add(pt);return Array.from(ft)};function Dt(rt){const ft=new Set,pt=rt.state.body;if(!(pt instanceof s.hy))return[];for(const Ge of pt.state.children){if(Ge instanceof B.U){const qe=at(Ge);for(const bt of qe)ft.add(bt)}if(Ge instanceof s.tI){const qe=nt(Ge);for(const bt of qe)ft.add(bt)}}return Array.from(ft).sort()}function nt(rt){return new Set(rt.state.children.map(pt=>at(pt)).flat())}function at(rt){let ft;if(rt instanceof B.U)if(rt.state.body instanceof p.F)ft=rt.state.body.state.panel;else if(rt.state.body instanceof s.Eb)ft=rt.state.body;else throw new Error("DashboardGridItem body expected to be VizPanel");if(!ft)throw new Error("Unsupported grid item type");const pt=ft.state.$data,Ge=new Set;if(pt instanceof s.dt)for(const qe of pt.state.queries)Ge.add(qe.datasource?.type??"");if(pt instanceof s.Es){const qe=pt.state.$data;if(qe instanceof s.dt)for(const bt of qe.state.queries)Ge.add(bt.datasource?.type??"")}return Array.from(Ge)}function Ae(rt){const{value:ft}=(0,a.A)(async()=>{const pt=Dt(rt);return gt(pt)},[]);return ft}function re({model:rt,publicDashboard:ft,isGetLoading:pt}){const Ge=(0,Me.of)(Z),qe=l.TP.hasPermission(we.AccessControlAction.DashboardsPublicWrite),{dashboardRef:bt}=rt.useState(),Ft=bt.resolve(),{isDirty:Xt}=Ft.useState(),[Lt]=(0,ve.bN)(),Qt=(Ft.state.$variables?.state.variables.length??0)>0,an=Ae(Ft),ut=s.jh.getTimeRange(rt).useState();return t.createElement(Ue.b,{dashboard:Ft,publicDashboard:ft,unsupportedDatasources:an,onRevoke:()=>{Ft.showModal(new Fe({isOpen:!0,title:"Revoke public URL",icon:"trash-alt",confirmText:"Revoke public URL",body:t.createElement("p",{className:Ge.description},"Are you sure you want to revoke this URL? The dashboard will no longer be public."),onDismiss:()=>{Ft.showModal(new Ke({dashboardRef:bt,activeTab:"Public Dashboard"}))},onConfirm:()=>{Lt({dashboard:Ft,dashboardUid:Ft.state.uid,uid:ft.uid}),Ft.closeModal()}}))},timeRange:ut.value,showSaveChangesAlert:qe&&Xt,hasTemplateVariables:Qt})}const Z=rt=>({description:(0,Oe.css)({fontSize:rt.typography.body.fontSize})});var oe=e(22234);function Ee({model:rt}){const{dashboardRef:ft}=rt.useState(),pt=ft.resolve(),Ge=Ae(pt),qe=(pt.state.$variables?.state.variables.length??0)>0;return t.createElement(oe.D,{dashboard:pt,unsupportedDatasources:Ge,unsupportedTemplateVariables:qe})}class ye extends s.Bs{constructor(){super(...arguments),this.tabId=d.wr.publicDashboard}static{this.Component=Se}getTabLabel(){return(0,i.t)("share-modal.tab-title.public-dashboard","Public Dashboard")}}function Se({model:rt}){const{data:ft,isLoading:pt}=(0,ve.Bs)(rt.state.dashboardRef.resolve().state.uid);return t.createElement(t.Fragment,null,pt?t.createElement(be.a,null):(0,u.lI)(ft)?t.createElement(re,{model:rt,publicDashboard:ft,isGetLoading:pt}):t.createElement(Ee,{model:rt}))}const Be=[];function We(rt){Be.push(rt)}class Ke extends s.Bs{constructor(ft){super({activeTab:"link",...ft}),this.onDismiss=()=>{(0,y.YQ)(this).closeModal()},this.onChangeTab=pt=>{c.c.sharingTabChanged({item:pt.value,shareResource:(0,d.hD)(this.state.panelRef)}),this.setState({activeTab:pt.value})},this.addActivationHandler(()=>this.buildTabs())}static{this.Component=it}buildTabs(){const{dashboardRef:ft,panelRef:pt}=this.state,Ge=this.getRef(),qe=[new X({dashboardRef:ft,panelRef:pt,modalRef:Ge})],bt=(0,y.YQ)(this);if(pt||qe.push(new M({dashboardRef:ft,modalRef:Ge})),l.TP.isSignedIn&&n.$.snapshotEnabled&&bt.canEditDashboard()&&qe.push(new le({panelRef:pt,dashboardRef:ft,modalRef:Ge})),pt){qe.push(new ee({panelRef:pt,dashboardRef:ft}));const Ft=pt.resolve(),Xt=Ft.parent instanceof p.F;Ft instanceof s.Eb&&(Xt||qe.push(new U({panelRef:pt,dashboardRef:ft,modalRef:Ge})))}pt||(qe.push(...Be.map(Ft=>new Ft({dashboardRef:ft,modalRef:Ge}))),(0,u.iR)()&&qe.push(new ye({dashboardRef:ft,modalRef:Ge}))),this.setState({tabs:qe})}}function it({model:rt}){const{panelRef:ft,tabs:pt,activeTab:Ge}=rt.useState(),qe=ft?(0,i.t)("share-modal.panel.title","Share Panel"):(0,i.t)("share-modal.dashboard.title","Share");if(!pt)return;const bt=pt?.map(Lt=>({label:Lt.getTabLabel(),value:Lt.tabId})),Ft=t.createElement(r.J,{title:qe,icon:"share-alt",tabs:bt,activeTab:Ge,onChangeTab:rt.onChangeTab}),Xt=pt.find(Lt=>Lt.tabId===Ge);return t.createElement(o.a,{isOpen:!0,title:Ft,onDismiss:rt.onDismiss},t.createElement(m.J,null,Xt&&t.createElement(Xt.Component,{model:Xt})))}},53543:(G,I,e)=>{"use strict";e.d(I,{R:()=>s});var t=e(16401),n=e(74730);class s{constructor(o){this._vizPanel=o}get id(){const o=(0,n.Cs)(this._vizPanel);return isNaN(o)?(console.error("VizPanel key could not be translated to a legacy numeric panel id",this._vizPanel),0):o}get description(){return this._vizPanel.state.description}get type(){return this._vizPanel.state.pluginId}get title(){return this._vizPanel.state.title}get transformations(){return this._vizPanel.state.$data instanceof t.Es?this._vizPanel.state.$data.state.transformations:[]}get targets(){const o=(0,n.un)(this._vizPanel);return o?o.state.queries:[]}get datasource(){return(0,n.un)(this._vizPanel)?.state.datasource}get options(){return this._vizPanel.state.options}get fieldConfig(){return this._vizPanel.state.fieldConfig}get pluginVersion(){return this._vizPanel.state.pluginVersion}}},96556:(G,I,e)=>{"use strict";e.d(I,{w:()=>r});var t=e(32264),n=e(16401),s=e(39820);function r(o){if(!o.targets?.length||t.$.panels[o.type]?.skipDataQuery)return;let m;return m=new n.dt({datasource:o.datasource??void 0,queries:o.targets,maxDataPoints:o.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:o.cacheTimeout,queryCachingTTL:o.queryCachingTTL,minInterval:o.interval??void 0,dataLayerFilter:{panelId:o.id},$behaviors:[new s.L({})]}),new n.Es({$data:m,transformations:o.transformations||[]})}},32023:(G,I,e)=>{"use strict";e.d(I,{WZ:()=>f,b4:()=>P});var t=e(16401),n=e(16279),s=e(41507),r=e(60656),o=e(42397),m=e(74730);function l(a){return a.state.controls?.state.timePicker}function i(a){return a.state.controls?.state.refreshPicker}function u(a){return a.state.titleItems&&Array.isArray(a.state.titleItems)&&a.state.titleItems[0]instanceof o.$?a.state.titleItems[0]:null}function d(a){const E=[];return a.state.body.forEachChild(g=>{if(!(g instanceof s.U)&&!(g instanceof t.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");g instanceof s.U?g.state.body instanceof t.Eb&&E.push(g.state.body):g instanceof t.tI&&g.forEachChild(h=>{h instanceof s.U&&h.state.body instanceof t.Eb&&E.push(h.state.body)})}),E}function p(a){const E=t.jh.getData(a);if(!(E instanceof n.s))throw new Error("DashboardDataLayerSet not found");return E}function c(a){const E=a.state.$behaviors?.find(g=>g instanceof t.Gg.K2);if(E instanceof t.Gg.K2)return E}function y(a){let E=0;const g=a.state.body;if(!(g instanceof t.hy))throw new Error("Dashboard body is not a SceneGridLayout");for(const h of g.state.children){if(h instanceof s.U){const D=h.state.body;if(D){const v=D instanceof r.F?(0,m.RQ)(D):(0,m.Cs)(D);v>E&&(E=v)}}if(h instanceof t.tI){const D=(0,m.Cs)(h);D>E&&(E=D);for(const v of h.state.children)if(v instanceof s.U){const C=v.state.body;if(C){const T=C instanceof r.F?(0,m.RQ)(C):(0,m.Cs)(C);T>E&&(E=T)}}}}return E+1}const f=a=>a.parent instanceof r.F?a.parent:a.parent instanceof s.U&&a.parent.state.body instanceof r.F?a.parent.state.body:null,P={getTimePicker:l,getRefreshPicker:i,getPanelLinks:u,getVizPanels:d,getDataLayers:p,getNextPanelId:y,getCursorSync:c}},27734:(G,I,e)=>{"use strict";e.d(I,{Gq:()=>m,zf:()=>l});var t=e(76885),n=e(12131),s=e(32264),r=e(16401);const o="grafana.dashboard.preservedUrlFiltersState";function m(i){const u=window.sessionStorage.getItem(o);if(u){const d=new URLSearchParams(u),p=n.Ny.getSearch();d.forEach((y,f)=>{p.has(f)&&p.getAll(f).includes(y)||p.append(f,y)});for(const y of Array.from(p.keys()))y.startsWith("var-")&&(i.state.$variables?.getByName(y.replace("var-",""))||p.delete(y));const c=p.toString();c&&n.Ny.replace({search:c})}}function l(i){if(s.$.featureToggles.preserveDashboardStateWhenNavigating)return()=>{if(!i.state.uid)return;const u=Object.fromEntries(Object.entries(new r.g5().getUrlState(i)).filter(([p])=>p.startsWith("var-")||p==="from"||p==="to"||p==="timezone")),d=Object.fromEntries(Object.entries(u).filter(([p,c])=>!(Array.isArray(c)&&c.length===0)));Object.keys(d).length>0?window.sessionStorage.setItem(o,t.kM.renderUrl("",d)):window.sessionStorage.removeItem(o)}}},73788:(G,I,e)=>{"use strict";e.d(I,{E:()=>s});var t=e(16401),n=e(53287);function s(r){const o=t.jh.getVariables(r);return(0,n.C)(o)}},7758:(G,I,e)=>{"use strict";e.d(I,{c:()=>s});var t=e(14110);let n=!1;const s={dashboardInitialized:o=>{r("init_dashboard_completed",{...o})},panelMenuShown:o=>{r("panelheader_menu",{...o,item:"menu"})},panelMenuItemClicked:o=>{r("panelheader_menu",{item:o})},panelMenuInspectClicked(o){r("panelheader_menu",{item:"inspect",tab:o})},panelLinkClicked:o=>{r("panelheader_datalink_clicked",o)},panelStatusMessageClicked:o=>{r("panelheader_statusmessage_clicked",o)},panelCancelQueryClicked:o=>{r("panelheader_cancelquery_clicked",o)},sharingTabChanged:o=>{r("sharing_category_clicked",o)},shareLinkCopied:o=>{r("sharing_link_copy_clicked",o)},embedSnippetCopy:o=>{r("sharing_embed_copy_clicked",o)},publishSnapshotClicked:o=>{r("sharing_snapshot_publish_clicked",o)},publishSnapshotLocalClicked:o=>{r("sharing_snapshot_local_clicked",o)},exportDownloadJsonClicked:o=>{r("sharing_export_download_json_clicked",o)},exportCopyJsonClicked:o=>{r("sharing_export_copy_json_clicked",o)},exportSaveJsonClicked:o=>{r("sharing_export_save_json_clicked",o)},exportViewJsonClicked:o=>{r("sharing_export_view_json_clicked",o)},generatePublicDashboardUrlClicked:o=>{r("sharing_public_generate_url_clicked",o)},revokePublicDashboardEmailClicked:o=>{r("sharing_public_email_revoke_clicked",o)},resendPublicDashboardEmailClicked:o=>{r("sharing_public_email_resend_clicked",o)},publicDashboardEmailInviteClicked:o=>{r("sharing_public_email_invite_clicked",o)},publicDashboardShareTypeChange:o=>{r("sharing_public_can_view_clicked",o)},publicDashboardTimeSelectionChanged:o=>{r("sharing_public_time_picker_clicked",o)},publicDashboardAnnotationsSelectionChanged:o=>{r("sharing_public_annotations_clicked",o)},publicDashboardUrlCopied:o=>{r("sharing_public_copy_url_clicked",o)},publicDashboardPauseSharingClicked:o=>{r("sharing_public_pause_clicked",o)},revokePublicDashboardClicked:o=>{r("sharing_public_revoke_clicked",o)},emptyDashboardButtonClicked:o=>{r("emptydashboard_clicked",o)},toolbarAddButtonClicked:o=>{r("toolbar_add_clicked",o)},toolbarFavoritesClick:()=>{r("toolbar_actions_clicked",{item:"favorites"})},toolbarSettingsClick:()=>{r("toolbar_actions_clicked",{item:"settings"})},toolbarRefreshClick:()=>{r("toolbar_actions_clicked",{item:"refresh"})},toolbarTimePickerClick:()=>{r("toolbar_actions_clicked",{item:"time_picker"})},toolbarZoomClick:()=>{r("toolbar_actions_clicked",{item:"zoom_out_time_range"})},toolbarShareClick:()=>{r("toolbar_actions_clicked",{item:"share"})},toolbarSaveClick:()=>{r("toolbar_actions_clicked",{item:"save"})},toolbarSaveAsClick:()=>{r("toolbar_actions_clicked",{item:"save_as"})},toolbarAddClick:()=>{r("toolbar_actions_clicked",{item:"add"})},setScenesContext:()=>(n=!0,()=>{n=!1})},r=(o,m)=>{const l=n?{scenesView:!0}:{};m?(0,t.rR)(`dashboards_${o}`,{...m,...l}):(0,t.rR)(`dashboards_${o}`)}},99246:(G,I,e)=>{"use strict";e.d(I,{C:()=>t,Y:()=>n});const t={left:[],right:[]};function n(s,r){t[s].push(r)}},11982:(G,I,e)=>{"use strict";e.d(I,{Lp:()=>y,Uu:()=>c,e0:()=>p,r7:()=>d,uZ:()=>u});var t=e(76885),n=e(71733),s=e(12131),r=e(32264),o=e(16401),m=e(10096),l=e(87490),i=e(74730);function u(f){let P=`/d/${f.uid}`;f.uid||(P="/dashboard/new"),f.soloRoute&&(P=`/d-solo/${f.uid}`),f.slug&&(P+=`/${f.slug}`),f.subPath&&(P+=f.subPath),f.render&&(P="/render"+P,f.updateQuery={...f.updateQuery,width:1e3,height:500,tz:f.timeZone}),f.isHomeDashboard&&(P="/");const a=f.currentQueryParams?(0,s.SE)(f.currentQueryParams):{};if(f.updateQuery)for(const g in f.updateQuery)f.updateQuery[g]===null||f.updateQuery[g]===void 0?delete a[g]:a[g]=f.updateQuery[g];const E=t.kM.renderUrl(P,a);return f.absolute?r.$.appUrl+E.slice(1):E}function d(f){return n.I.getUrlForPartial(s.Ny.getLocation(),{viewPanel:f.state.key,editPanel:void 0})}function p(f){return n.I.getUrlForPartial(s.Ny.getLocation(),{editPanel:f,viewPanel:void 0})}function c(f,P){const a=f.state.key?.replace("-view","");return n.I.getUrlForPartial(s.Ny.getLocation(),{inspect:a,inspectTab:P})}function y(f){const P=f.getPlugin(),a=(0,i.un)(f);if(!m.TP.hasAccessToExplore()||P?.meta.skipDataQuery||!a)return Promise.resolve(void 0);const E=o.jh.getTimeRange(f);return(0,l.Xe)({queries:a.state.queries,dsRef:a.state.datasource,timeRange:E.state.value,scopedVars:{__sceneObject:{value:f}},adhocFilters:a.state.data?.request?.filters})}},74730:(G,I,e)=>{"use strict";e.d(I,{Cs:()=>P,O8:()=>M,RQ:()=>a,SN:()=>b,Sm:()=>v,Ws:()=>A,X0:()=>h,XA:()=>f,YQ:()=>O,Yr:()=>R,a7:()=>D,bx:()=>C,pk:()=>T,sw:()=>c,un:()=>S,vL:()=>E,vm:()=>y,xz:()=>x});var t=e(22391),n=e(19347),s=e(16401),r=e(81515),o=e(39820),m=e(24283),l=e(60656),i=e(42397),u=e(7196),d=e(58029),p=e(32023);const c=8,y=12;function f(B){return`panel-${B}`}function P(B){return parseInt(B.state.key.replace("panel-",""),10)}function a(B){return parseInt(B.state.panelKey.replace("panel-",""),10)}function E(B,U){if(!U)return null;const W=g(B,U);if(W)return W;const N=parseInt(U,10);return isNaN(N)?null:g(B,f(N))}function g(B,U){if(!U)return null;const W=s.jh.findObject(B,N=>N.state.key===U?!0:(N instanceof s.Eb,!1));if(W){if(W instanceof s.Eb)return W;throw new Error(`Found panel with key ${U} but it was not a VizPanel`)}return null}function h(B,U){B.forEachChild(W=>{W.isActive&&(W.forceRender(),h(W,U))})}function D(B){const{value:U,text:W,options:N}=B.state;return B.hasAllValue()?{values:N.map(w=>w.value),texts:N.map(w=>w.label)}:{values:Array.isArray(U)?U:[U],texts:Array.isArray(W)?W:[W]}}function v(B){const U=B.match(/(["'])(.*?)\1|\w+/g);if(!U)return r.Ez.query?.split(",")??[];const W=new Set,N=U.reduce((w,L)=>{const V=L.replace(/["']+/g,"");return V.startsWith("$__auto_interval_")||w.add(V),w},W);return Array.from(N)}function C(B){return Array.isArray(B)?B.join(","):""}function T(B,U){const W=Array.isArray(B.current.value)?B.current.value[0]:B.current.value;return W.startsWith("$__auto_interval_")?"$__auto":U.includes(W)?W:U[0]}function S(B){if(!B)return;const U=B.state.$data??B.parent?.state.$data;if(U instanceof s.dt)return U;if(U instanceof s.Es)return S(U)}function O(B){const U=B.getRoot();if(U instanceof m.H$)return U;throw new Error("SceneObject root is not a DashboardScene")}function x(B){return B instanceof s.Eb?B:B.parent?x(B.parent):null}function b(B){return B.includes("clone")}function M(B){const U=p.b4.getNextPanelId(B);return new s.Eb({title:"Panel Title",key:f(U),pluginId:"timeseries",titleItems:[new i.$({menu:new i.m({})})],hoverHeaderOffset:0,menu:new s.Lw({$behaviors:[u._i]}),$data:new s.Es({$data:new s.dt({queries:[{refId:"A"}],datasource:(0,t.p$)((0,n.l)().getInstanceSettings(null)),$behaviors:[new o.L({})]}),transformations:[]})})}function A(B){const U=p.b4.getNextPanelId(B);return new s.tI({key:f(U),title:"Row title",actions:new d.u({}),y:0})}function R(B){if(B.parent instanceof l.F)return B.parent}},28676:(G,I,e)=>{"use strict";e.d(I,{n:()=>i});var t=e(17172),n=e(32264),s=e(2468),r=e(6473);class o{constructor(){}saveDashboard(d){return r.t.ignoreNextSave(),(0,t.AI)().post("/api/dashboards/db/",{dashboard:d.dashboard,message:d.message??"",overwrite:d.overwrite??!1,folderUid:d.folderUid})}deleteDashboard(d,p){return(0,t.AI)().delete(`/api/dashboards/uid/${d}`,{showSuccessAlert:p})}getDashboardDTO(d){return(0,t.AI)().get(`/api/dashboards/uid/${d}`)}}class m{constructor(d){this.legacy=d,this.client=new s.w({group:"dashboard.grafana.app",version:"v0alpha1",resource:"dashboards"})}saveDashboard(d){return this.legacy.saveDashboard(d)}deleteDashboard(d,p){return this.legacy.deleteDashboard(d,p)}async getDashboardDTO(d){const p=await this.client.get(d);return{meta:{...await this.client.subresource(d,"access"),isNew:!1,isFolder:!1,uid:p.metadata.name},dashboard:p.spec}}}let l;function i(){if(!l){const u=new o;l=n.$.featureToggles.kubernetesDashboards?new m(u):u}return l}},72686:(G,I,e)=>{"use strict";e.d(I,{$L:()=>E,AK:()=>h,Bs:()=>p,NA:()=>g,NY:()=>a,Sm:()=>d,T2:()=>y,U9:()=>c,_e:()=>P,bN:()=>f,g9:()=>v,kd:()=>D});var t=e(75816),n=e(75505),s=e(17172),r=e(82467),o=e(3169),m=e(24283);function l(C){return typeof C=="object"&&C!=null&&"error"in C}const i=({baseUrl:C})=>async T=>{try{const{data:S,...O}=await(0,n.s)((0,s.AI)().fetch({...T,url:C+T.url,showErrorAlert:T.showErrorAlert}));return{data:S,meta:O}}catch(S){return T.manageError?T.manageError(S):{error:S}}},u=C=>({error:(0,s.NF)(C)&&C.status!==404?C:null}),d=(0,t.xP)({reducerPath:"publicDashboardApi",baseQuery:i({baseUrl:"/api"}),tagTypes:["PublicDashboard","AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"],refetchOnMountOrArgChange:!0,endpoints:C=>({getPublicDashboard:C.query({query:T=>({url:`/dashboards/uid/${T}/public-dashboards`,manageError:u,showErrorAlert:!1}),async onQueryStarted(T,{dispatch:S,queryFulfilled:O}){try{await O}catch(x){l(x)&&(0,s.NF)(x.error)&&S((0,r.dx)((0,o.gi)(x.error.data.message)))}},providesTags:(T,S,O)=>[{type:"PublicDashboard",id:O}]}),createPublicDashboard:C.mutation({query:T=>({url:`/dashboards/uid/${T.dashboard instanceof m.H$?T.dashboard.state.uid:T.dashboard.uid}/public-dashboards`,method:"POST",data:T.payload}),async onQueryStarted({dashboard:T,payload:S},{dispatch:O,queryFulfilled:x}){const{data:b}=await x;O((0,r.dx)((0,o.tZ)("Dashboard is public!"))),T instanceof m.H$?T.setState({meta:{...T.state.meta,publicDashboardEnabled:b.isEnabled}}):T.updateMeta({publicDashboardEnabled:b.isEnabled})},invalidatesTags:(T,S,{dashboard:O})=>[{type:"PublicDashboard",id:O instanceof m.H$?O.state.uid:O.uid}]}),updatePublicDashboard:C.mutation({query:({payload:T,dashboard:S})=>({url:`/dashboards/uid/${S instanceof m.H$?S.state.uid:S.uid}/public-dashboards/${T.uid}`,method:"PATCH",data:T}),async onQueryStarted({dashboard:T},{dispatch:S,queryFulfilled:O}){const{data:x}=await O;S((0,r.dx)((0,o.tZ)("Public dashboard updated!"))),T instanceof m.H$?T.setState({meta:{...T.state.meta,publicDashboardEnabled:x.isEnabled}}):T.updateMeta?.({publicDashboardEnabled:x.isEnabled})},invalidatesTags:(T,S,{payload:O})=>[{type:"PublicDashboard",id:O.dashboardUid},"AuditTablePublicDashboard"]}),addRecipient:C.mutation({query:()=>({url:""})}),deleteRecipient:C.mutation({query:()=>({url:""})}),reshareAccessToRecipient:C.mutation({query:()=>({url:""})}),getActiveUsers:C.query({query:()=>({url:"/"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:C.query({query:()=>({url:""}),providesTags:(T,S,O)=>[{type:"ActiveUserDashboards",id:O}]}),listPublicDashboards:C.query({query:(T=1)=>({url:`/dashboards/public-dashboards?page=${T}&perpage=8`}),transformResponse:T=>({...T,totalPages:Math.ceil(T.totalCount/T.perPage)}),providesTags:["AuditTablePublicDashboard"]}),deletePublicDashboard:C.mutation({query:T=>({url:`/dashboards/uid/${T.dashboardUid}/public-dashboards/${T.uid}`,method:"DELETE"}),async onQueryStarted({dashboard:T},{dispatch:S,queryFulfilled:O}){await O,S((0,r.dx)((0,o.tZ)("Public dashboard deleted!"))),T instanceof m.H$?T.setState({meta:{...T.state.meta,publicDashboardEnabled:!1}}):T?.updateMeta({publicDashboardEnabled:!1})},invalidatesTags:(T,S,{dashboardUid:O})=>[{type:"PublicDashboard",id:O},"AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"]}),revokeAllAccess:C.mutation({query:()=>({url:""})})})}),{useGetPublicDashboardQuery:p,useCreatePublicDashboardMutation:c,useUpdatePublicDashboardMutation:y,useDeletePublicDashboardMutation:f,useListPublicDashboardsQuery:P,useAddRecipientMutation:a,useDeleteRecipientMutation:E,useReshareAccessToRecipientMutation:g,useGetActiveUsersQuery:h,useGetActiveUserDashboardsQuery:D,useRevokeAllAccessMutation:v}=d},15858:(G,I,e)=>{"use strict";e.d(I,{M:()=>p});var t=e(2543),n=e(12470),s=e(19347),r=e(2913),o=e(57767),m=e(75096),l=e(82792),i=e(98796),u=e(24240);function d(c){return!!(c.libraryPanel?.name&&c.libraryPanel?.uid)}class p{async makeExportable(y){y.cleanUpRepeats();const f=y.getSaveModelCloneOld();f.id=null,y.processRepeats();const P=[],a={},E={},g={},h=new Map;for(const T of f.getVariables())g[T.name]=T;const D=(T,S)=>{if(T.datasource===void 0){T.datasource=S;return}let O=T.datasource,x=null;const b=O?.uid,M=b&&m.SY.exec(b);if(M){const A=M[1]||M[2]||M[4];x=g[A],x&&x.current&&(O=x.current.value)}return(0,s.l)().get(O).then(A=>{if(A.meta?.builtIn||(a["datasource"+A.meta?.id]={type:"datasource",id:A.meta.id,name:A.meta.name,version:A.meta.info.version||"1.0.0"},x))return;const R=T.libraryPanel,B=R?"-for-library-panel":"";let U="DS_"+A.name.replace(" ","_").toUpperCase()+B.toUpperCase();if(E[U]={name:U,label:A.name,description:"",type:"datasource",pluginId:A.meta?.id,pluginName:A.meta?.name,usage:E[U]?.usage},R){const W=E[U]?.usage?.libraryPanels||[];W.push({name:R.name,uid:R.uid}),E[U].usage={libraryPanels:W}}T.datasource={type:A.meta.id,uid:"${"+U+"}"}})},v=async T=>{if(T.type!=="row"){if(await D(T),T.targets)for(const O of T.targets)await D(O,T.datasource);const S=r.Ay.panels[T.type];S&&(a["panel"+S.id]={type:"panel",id:S.id,name:S.name,version:S.info.version})}},C=async T=>{if((0,l.X)(T)){const{name:S,uid:O}=T.libraryPanel;let x=T.libraryPanel.model;x||(x=(await(0,o.Yr)(O,!0)).model),await D(x);const{gridPos:b,id:M,...A}=x;h.has(O)||h.set(O,{name:S,uid:O,kind:i.i.Panel,model:A})}};try{for(const O of f.panels)if(await v(O),O.collapsed!==void 0&&O.collapsed===!0&&O.panels)for(const x of O.panels)await v(x);for(const O of f.getVariables())O.type==="query"?(await D(O),O.options=[],O.current={},O.refresh=O.refresh!==n.CO.never?O.refresh:n.CO.onDashboardLoad):O.type==="datasource"&&(O.current={});for(const O of f.annotations.list)await D(O);a.grafana={type:"grafana",id:"grafana",name:"Grafana",version:r.Ay.buildInfo.version};for(const O of f.panels)if(await C(O),O.collapsed!==void 0&&O.collapsed===!0&&O.panels)for(const x of O.panels)await C(x);(0,t.each)(E,O=>{P.push(O)});for(const O of f.getVariables())if((0,u.VO)(O)){const x="VAR_"+O.name.replace(" ","_").toUpperCase();P.push({name:x,type:"constant",label:O.label||O.name,value:O.query,description:""}),O.query="${"+x+"}",O.current={value:O.query,text:O.query,selected:!1},O.options=[O.current]}const T=[...h.entries()].reduce((O,[x,b])=>(O[x]=b,O),{}),S=(0,t.defaults)({__inputs:P,__elements:T,__requires:(0,t.sortBy)(a,["id"])},f);for(let O=0;O<S.panels.length;O++){const x=S.panels[O];d(x)&&(S.panels[O]={gridPos:x.gridPos,id:x.id,libraryPanel:{uid:x.libraryPanel.uid,name:x.libraryPanel.name}})}return S}catch(T){return console.error("Export failed:",T),{error:T}}}}},20120:(G,I,e)=>{"use strict";e.d(I,{fP:()=>ce,Ay:()=>fe});var t=e(32196),n=e(96540),s=e(71468),r=e(24180),o=e(40672),m=e(13544),l=e(12131),i=e(69731),u=e(96374),d=e(39938),p=e(19727),c=e(27746),y=e(71678),f=e(15068),P=e(82467),a=e(75269),E=e(10804),g=e(2913),h=e(3169),D=e(10096),v=e(16021),C=e(8484),T=e(91219),S=e(28215),O=e(83122),x=e(55852),b=e(14578),M=e(32264),A=e(38138),R=e(36974),B=e(7758),U=e(31678),W=e(28601);const w=({dashboard:de})=>{const le=(0,n.useMemo)(()=>(0,R._u)(),[]),pe=(0,U.useDispatch)(),ve=(0,U.useSelector)(be=>be.dashboard.initialDatasource);return n.createElement(A.W,null,n.createElement(A.W.Item,{key:"add-visualisation",testId:m.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,C.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const be=(0,R.OK)(de,ve);B.c.toolbarAddButtonClicked({item:"add_visualization"}),l.Ny.partial({editPanel:be}),pe((0,W.Ub)(void 0))}}),M.$.featureToggles.vizAndWidgetSplit&&n.createElement(A.W.Item,{key:"add-widget",testId:m.Tp.pages.AddDashboard.itemButton("Add new widget menu item"),label:(0,C.t)("dashboard.add-menu.widget","Widget"),onClick:()=>{B.c.toolbarAddButtonClicked({item:"add_widget"}),l.Ny.partial({addWidget:!0})}}),n.createElement(A.W.Item,{key:"add-row",testId:m.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,C.t)("dashboard.add-menu.row","Row"),onClick:()=>{B.c.toolbarAddButtonClicked({item:"add_row"}),(0,R.SD)(de)}}),n.createElement(A.W.Item,{key:"add-panel-lib",testId:m.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,C.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{B.c.toolbarAddButtonClicked({item:"import_from_library"}),(0,R.s3)(de)}}),n.createElement(A.W.Item,{key:"add-panel-clipboard",testId:m.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,C.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{B.c.toolbarAddButtonClicked({item:"paste_panel"}),(0,R.no)(de,le)},disabled:!le}))},V=({dashboard:de,onToolbarAddMenuOpen:le})=>{const[pe,ve]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{pe&&le&&le()},[pe,le]),n.createElement(O.m,{overlay:()=>n.createElement(w,{dashboard:de}),placement:"bottom",offset:[0,6],onVisibleChange:ve},n.createElement(x.$n,{variant:"secondary",size:"sm",fill:"outline","data-testid":m.Tp.components.PageToolbar.itemButton("Add button")},n.createElement(C.x6,{i18nKey:"dashboard.toolbar.add"},"Add"),n.createElement(b.I,{name:pe?"angle-up":"angle-down",size:"lg"})))};var K=e(70497),k=e(14792),j=e(2609),H=e(81862),J=e(28444),X=e(99246),se=e(93030),ae=e(62367);const ne=({dashboard:de})=>n.createElement(x.$n,{"data-testid":m.Tp.pages.Dashboard.DashNav.shareButton,variant:"primary",size:"sm",onClick:()=>{B.c.toolbarShareClick(),l.Ny.partial({shareView:"link"})}},n.createElement(C.x6,{i18nKey:"dashboard.toolbar.share-button"},"Share")),q={removeNavIndex:S.Im,setStarred:T.ci,updateTimeZoneForSession:H.Cj,updateNavIndex:P.Vz},ee=de=>({navIndex:de.navIndex}),z=(0,s.connect)(ee,q),te=m.Tp.pages.Dashboard.DashNav;function ie(de){registerDynamicDashNavAction("left",de)}function ce(de){(0,X.Y)("right",de)}const ue=n.memo(de=>{(0,r.zy)();const le=(0,i.C)();(0,v.u)(de.dashboard.events,J.Cf);const pe=de.dashboard.snapshot?.originalUrl??"",ve=()=>{window.location.href=o.sQ.sanitizeUrl(de.dashboard.snapshot.originalUrl)},be=(0,h._2)(),Oe=()=>{try{const nt=new URL(o.sQ.sanitizeUrl(pe),g.Ay.appUrl),at=new URL(g.Ay.appUrl);nt.host!==at.host?D.lE.publish(new J.S8({component:u.u,props:{title:"Proceed to external site?",modalClass:Te,body:n.createElement(n.Fragment,null,n.createElement("p",null,"This link connects to an external website at"," ",n.createElement("code",null,pe)),n.createElement("p",null,"Are you sure you'd like to proceed?")),confirmVariant:"primary",confirmText:"Proceed",onConfirm:ve}})):ve()}catch(nt){be.error("Invalid URL",nt instanceof Error?nt.message:void 0)}},Me=()=>{B.c.toolbarFavoritesClick();const nt=(0,k.UA)(),{dashboard:at,navIndex:Ae,removeNavIndex:re,setStarred:Z,updateNavIndex:oe}=de;nt.starDashboard(at.uid,!!at.meta.isStarred).then(Ee=>{Z({id:at.uid,title:at.title,url:at.meta.url??"",isStarred:Ee});const ye=Ae.starred;if(Ee)ye.children?.push({id:T.L1+at.uid,text:at.title,url:at.meta.url??"",parentItem:ye});else{re(T.L1+at.uid);const Se=ye.children?.findIndex(Be=>Be.id===T.L1+at.uid);Se&&ye.children?.splice(Se,1)}oe(ye),at.meta.isStarred=Ee,le()})},Ue=()=>{B.c.toolbarSettingsClick(),l.Ny.partial({editview:"settings"})},we=()=>{j._o.prev()},Re=()=>{j._o.next()},Fe=()=>{j._o.stop(),le()},xe=(nt,at)=>{nt.map((Ae,re)=>{const Z=Ae.component,oe=n.createElement(Z,{...de,key:`button-custom-${re}`});typeof Ae.index=="number"?at.splice(Ae.index,0,oe):at.push(oe)})},Ve=()=>j._o.state.isPlaying,$e=()=>{const{dashboard:nt,kioskMode:at}=de,{canStar:Ae,isStarred:re}=nt.meta,Z=[];if(at||Ve())return[];if(Ae){let oe=re?(0,C.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,C.t)("dashboard.toolbar.mark-favorite","Mark as favorite");Z.push(n.createElement(se._,{tooltip:oe,icon:re?"favorite":"star",iconType:re?"mono":"default",iconSize:"lg",onClick:Me,key:"button-star"}))}return nt.meta.publicDashboardEnabled&&Z.push(n.createElement(d.E,{color:"blue",text:"Public",key:"public-dashboard-button-badge",className:he,"data-testid":te.publicDashboardTag})),g.Ay.featureToggles.scenes&&Z.push(n.createElement(se._,{key:"button-scenes",tooltip:"View as Scene",icon:"apps",onClick:()=>{l.Ny.partial({scenes:!0})}})),xe(X.C.left,Z),Z},Xe=()=>n.createElement(p.e,{key:"playlist-buttons"},n.createElement(c.I,{tooltip:(0,C.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:we,narrow:!0}),n.createElement(c.I,{onClick:Fe},n.createElement(C.x6,{i18nKey:"dashboard.toolbar.playlist-stop"},"Stop playlist")),n.createElement(c.I,{tooltip:(0,C.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:Re,narrow:!0})),gt=()=>{const{dashboard:nt,updateTimeZoneForSession:at,hideTimePicker:Ae}=de;return Ae?null:n.createElement(ae.$,{dashboard:nt,onChangeTimeZone:at,onToolbarRefreshClick:B.c.toolbarRefreshClick,onToolbarZoomClick:B.c.toolbarZoomClick,onToolbarTimePickerClick:B.c.toolbarTimePickerClick,key:"time-controls"})},Dt=()=>{const{dashboard:nt,isFullscreen:at,kioskMode:Ae,hideTimePicker:re}=de,{canSave:Z,canEdit:oe,showSettings:Ee,canShare:ye}=nt.meta,{snapshot:Se}=nt,Be=Se&&Se.originalUrl,We=[];return Ve()?[Xe(),gt()]:Ae===U.KioskMode.TV?[gt()]:(Be&&We.push(n.createElement(c.I,{tooltip:(0,C.t)("dashboard.toolbar.open-original","Open original dashboard"),onClick:Oe,icon:"link",key:"button-snapshot"})),Z&&!at&&We.push(n.createElement(y.$s,{key:"button-save"},({showModal:Ke,hideModal:it})=>n.createElement(c.I,{tooltip:(0,C.t)("dashboard.toolbar.save","Save dashboard"),icon:"save",onClick:()=>{B.c.toolbarSaveClick(),Ke(K.$,{dashboard:nt,onDismiss:it})}}))),xe(X.C.right,We),Ee&&We.push(n.createElement(c.I,{tooltip:(0,C.t)("dashboard.toolbar.settings","Dashboard settings"),icon:"cog",onClick:Ue,key:"button-settings"})),oe&&!at&&We.push(n.createElement(V,{dashboard:nt,onToolbarAddMenuOpen:B.c.toolbarAddClick,key:"panel-add-dropdown"})),ye&&We.push(n.createElement(ne,{key:"button-share",dashboard:nt})),re||We.push(n.createElement(E.K,{key:"toolbar-separator"})),We.push(gt()),We)};return n.createElement(a.H,{actions:n.createElement(n.Fragment,null,$e(),n.createElement(E.K,{leftActionsSeparator:!0}),n.createElement(f.U,{alignment:"right"},Dt()))})});ue.displayName="DashNav";const fe=z(ue),Te=(0,t.css)({width:"max-content",maxWidth:"80vw"}),he=(0,t.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})},93030:(G,I,e)=>{"use strict";e.d(I,{_:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(29158);const o=({icon:l,iconType:i,iconSize:u,tooltip:d,onClick:p,children:c})=>{const y=(0,s.of)(m);return n.createElement("div",{className:y.noBorderContainer},l&&n.createElement(r.K,{name:l,size:u,iconType:i,tooltip:d,tooltipPlacement:"bottom",onClick:p}),c)},m=l=>({noBorderContainer:(0,t.css)({padding:`0 ${l.spacing(.5)}`,display:"flex"})})},62367:(G,I,e)=>{"use strict";e.d(I,{$:()=>p});var t=e(96540),n=e(85858),s=e(3591),r=e(11134),o=e(25573),m=e(10096),l=e(8484),i=e(16233),u=e(74856),d=e(28444);class p extends t.Component{constructor(){super(...arguments),this.onChangeRefreshInterval=y=>{(0,u.jG)().setAutoRefresh(y),this.forceUpdate()},this.onRefresh=()=>((0,u.jG)().refreshTimeModel(),Promise.resolve()),this.onMoveBack=()=>{m.lE.publish(new d.Io({direction:d.xL.Left}))},this.onMoveForward=()=>{m.lE.publish(new d.Io({direction:d.xL.Right}))},this.onChangeTimePicker=y=>{const{dashboard:f}=this.props,P=f.timepicker,a=P.nowDelay&&y.raw.to==="now",E=n.isMathString(y.raw.from)?y.raw.from:y.from,g=n.isMathString(y.raw.to)?y.raw.to:y.to,h={from:E,to:a?"now-"+P.nowDelay:g};(0,u.jG)().setTime(h)},this.onChangeTimeZone=y=>{this.props.dashboard.timezone=y,this.props.onChangeTimeZone(y),this.onRefresh()},this.onChangeFiscalYearStartMonth=y=>{this.props.dashboard.fiscalYearStartMonth=y,this.onRefresh()},this.onZoom=()=>{this.props.onToolbarZoomClick&&this.props.onToolbarZoomClick(),m.lE.publish(new d.U0({scale:2}))},this.onRefreshClick=()=>{this.props.onToolbarRefreshClick&&this.props.onToolbarRefreshClick(),this.onRefresh()}}componentDidMount(){this.sub=this.props.dashboard.events.subscribe(s.sR,()=>this.forceUpdate())}componentWillUnmount(){this.sub?.unsubscribe()}render(){const{dashboard:y,isOnCanvas:f}=this.props,{refresh_intervals:P}=y.timepicker,a=(0,u.jG)().getValidIntervals(P||r.cb),E=(0,u.jG)().timeRange(),g=y.getTimezone(),h=y.fiscalYearStartMonth,D=y.panelInEdit?.isEditing;let v;return y.refresh===i.SM&&(v=(0,u.jG)().getAutoRefreshInteval().interval),t.createElement(t.Fragment,null,t.createElement(o.m,{value:E,onChange:this.onChangeTimePicker,timeZone:g,fiscalYearStartMonth:h,onMoveBackward:this.onMoveBack,onMoveForward:this.onMoveForward,onZoom:this.onZoom,onChangeTimeZone:this.onChangeTimeZone,onChangeFiscalYearStartMonth:this.onChangeFiscalYearStartMonth,isOnCanvas:f,onToolbarTimePickerClick:this.props.onToolbarTimePickerClick}),t.createElement(r.cC,{onIntervalChanged:this.onChangeRefreshInterval,onRefresh:this.onRefreshClick,value:y.refresh,intervals:a,isOnCanvas:f,tooltip:(0,l.t)("dashboard.toolbar.refresh","Refresh dashboard"),noIntervalPicker:D,showAutoInterval:!0,text:v}))}}},16495:(G,I,e)=>{"use strict";e.d(I,{U:()=>t.Ay});var t=e(20120)},46991:(G,I,e)=>{"use strict";e.d(I,{d:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(55852);const o=({children:l,...i})=>{const u=(0,s.of)(m);return n.createElement("div",{className:u.buttonWrapper},n.createElement(r.$n,{icon:"plus",...i},l))},m=l=>({buttonWrapper:(0,t.css)({padding:`${l.spacing(3)} 0`})})},75590:(G,I,e)=>{"use strict";e.d(I,{p:()=>E});var t=e(2543),n=e(96540),s=e(65879),r=e(13544),o=e(57418),m=e(88575),l=e(20333),i=e(15648),u=e(10354),d=e(15292),p=e(8484),c=e(11134),y=e(74856);const f=({refreshIntervals:g,onRefreshIntervalChange:h,getIntervalsFunc:D=a,validateIntervalsFunc:v=P})=>{const[C,T]=(0,n.useState)(D(g??c.cb)),[S,O]=(0,n.useState)(null);(0,n.useEffect)(()=>{const A=D(g??c.cb);T(A)},[D,g]);const x=(0,n.useMemo)(()=>Array.isArray(C)?C.join(","):"",[C]),b=(0,n.useCallback)(A=>{const R=A.currentTarget.value?A.currentTarget.value.split(","):[];T(R)},[T]),M=(0,n.useCallback)(A=>{const R=v(C);R===null&&h(D(C)),O(R)},[D,C,h,v]);return n.createElement(m.D,{label:(0,p.t)("dashboard-settings.general.auto-refresh-label","Auto refresh"),description:(0,p.t)("dashboard-settings.general.auto-refresh-description","Define the auto refresh intervals that should be available in the auto refresh list. Use the format '5s' for seconds, '1m' for minutes, '1h' for hours, and '1d' for days (e.g.: '5s,10s,30s,1m,5m,15m,30m,1h,2h,1d')."),error:S,invalid:!!S},n.createElement(u.p,{id:"auto-refresh-input",invalid:!!S,value:x,onChange:b,onBlur:M}))},P=(g,h={getTimeSrv:y.jG})=>{try{return a(g,h),null}catch(D){return D instanceof Error?D.message:"Invalid intervals"}},a=(g,h={getTimeSrv:y.jG})=>{const D=g.filter(v=>v.trim()!=="").map(v=>v.replace(/\s+/g,""));return[...new Set(h.getTimeSrv().getValidIntervals(D))]};class E extends n.PureComponent{constructor(){super(...arguments),this.state={isNowDelayValid:!0},this.onNowDelayChange=h=>{const D=h.currentTarget.value;if((0,t.isEmpty)(D))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(D);if(s.isValidTimeSpan(D))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(D);this.setState({isNowDelayValid:!1})},this.onHideTimePickerChange=()=>{this.props.onHideTimePickerChange(!this.props.timePickerHidden)},this.onLiveNowChange=()=>{this.props.onLiveNowChange(!this.props.liveNow)},this.onTimeZoneChange=h=>{typeof h=="string"&&this.props.onTimeZoneChange(h)},this.onWeekStartChange=h=>{this.props.onWeekStartChange(h)}}render(){return n.createElement(o.M,{label:(0,p.t)("dashboard-settings.time-picker.time-options-label","Time options"),isOpen:!0},n.createElement(m.D,{label:(0,p.t)("dashboard-settings.time-picker.time-zone-label","Time zone"),"data-testid":r.Tp.components.TimeZonePicker.containerV2},n.createElement(l.U,{inputId:"time-options-input",includeInternal:!0,value:this.props.timezone,onChange:this.onTimeZoneChange,width:40})),n.createElement(m.D,{label:(0,p.t)("dashboard-settings.time-picker.week-start-label","Week start"),"data-testid":r.Tp.components.WeekStartPicker.containerV2},n.createElement(i.l,{inputId:"week-start-input",width:40,value:this.props.weekStart,onChange:this.onWeekStartChange})),n.createElement(f,{refreshIntervals:this.props.refreshIntervals,onRefreshIntervalChange:this.props.onRefreshIntervalChange}),n.createElement(m.D,{label:(0,p.t)("dashboard-settings.time-picker.now-delay-label","Now delay"),description:(0,p.t)("dashboard-settings.time-picker.now-delay-description","Exclude recent data that may be incomplete.")},n.createElement(u.p,{id:"now-delay-input",invalid:!this.state.isNowDelayValid,placeholder:"0m",onChange:this.onNowDelayChange,defaultValue:this.props.nowDelay})),n.createElement(m.D,{label:(0,p.t)("dashboard-settings.time-picker.hide-time-picker","Hide time picker")},n.createElement(d.d,{id:"hide-time-picker-toggle",value:!!this.props.timePickerHidden,onChange:this.onHideTimePickerChange})),n.createElement(m.D,{label:(0,p.t)("dashboard-settings.time-picker.refresh-live-dashboards-label","Refresh live dashboards"),description:(0,p.t)("dashboard-settings.time-picker.refresh-live-dashboards-description","Continuously re-draw panels where the time range references 'now'")},n.createElement(d.d,{id:"refresh-live-dashboards-toggle",value:!!this.props.liveNow,onChange:this.onLiveNowChange})))}}},16561:(G,I,e)=>{"use strict";e.d(I,{s:()=>uo});var t=e(96540),n=e(24180),s=e(71733),r=e(13544),o=e(12131),m=e(55852),l=e(15068),i=e(67061),u=e(94753),d=e(75269),p=e(67608),c=e(8484),y=e(16233),f=e(31678),P=e(28444),a=e(71468),E=e(14644),g=e(32196),h=e(16817),D=e(14110),v=e(40845),C=e(57418),T=e(66864),S=e(62930),O=e(56034),x=e(14578),b=e(29158),M=e(37390);const A=({nodes:Pt,edges:Gt,direction:Pn,width:hn,height:Ln,onDoubleClick:Hn})=>{const kn=(0,t.useRef)(null),xa=(0,t.useRef)(null),ua=(0,t.useCallback)(ra=>{Hn&&Hn(ra.nodes[0])},[Hn]);return(0,t.useEffect)(()=>((async()=>{const os=await e.e(5083).then(e.t.bind(e,83416,23)),Ra={nodes:R(os,Pt),edges:B(os,Gt)},es={width:"100%",height:"100%",autoResize:!0,layout:{improvedLayout:!0,hierarchical:{enabled:!0,direction:Pn??"DU",sortMethod:"directed"}},interaction:{navigationButtons:!0,dragNodes:!1}};kn.current=new os.Network(xa.current,Ra,es),kn.current?.on("doubleClick",ua)})(),()=>{kn.current&&kn.current.off("doubleClick")}),[Pn,Gt,Pt,ua]),t.createElement("div",null,t.createElement("div",{ref:xa,style:{width:hn??"100%",height:Ln??"60vh"}}))};function R(Pt,Gt){const Pn=Gt.map(hn=>({...hn,shape:"box"}));return new Pt.DataSet(Pn)}function B(Pt,Gt){const Pn=Gt.map(hn=>({...hn,arrows:"to",dashes:!0}));return new Pt.DataSet(Pn)}function U({edges:Pt,nodes:Gt,show:Pn,title:hn,children:Ln}){const[Hn,kn]=(0,t.useState)(Pn),xa=(0,t.useCallback)(()=>kn(!0),[kn]),ua=(0,t.useCallback)(()=>kn(!1),[kn]);return t.createElement(t.Fragment,null,t.createElement(M.a,{isOpen:Hn,title:hn,icon:"info-circle",iconTooltip:"The graph can be moved, zoomed in, and zoomed out.",onClickBackdrop:ua,onDismiss:ua},t.createElement(A,{nodes:Gt,edges:Pt})),Ln({showModal:xa}))}const W=({id:Pt,usages:Gt})=>{const Pn=(0,t.useMemo)(()=>Gt.find(Ln=>Ln.variable.id===Pt),[Pt,Gt]);if(!Pn)return null;const hn=Pn.nodes.map(Ln=>Ln.label.includes(`$${Pt}`)?{...Ln,color:"#FB7E81"}:Ln);return t.createElement(U,{show:!1,title:`Showing usages for: $${Pt}`,nodes:hn,edges:Pn.edges},({showModal:Ln})=>t.createElement(b.K,{onClick:()=>Ln(),name:"code-branch",tooltip:"Show usages","data-testid":"VariablesUnknownButton"}))};var N=e(12846);const w=1e3;function L({variables:Pt,dashboard:Gt}){const[Pn,hn]=(0,t.useState)(!1),[Ln,Hn]=(0,t.useState)(0),[kn,xa]=(0,t.useState)([]),ua=(0,v.of)(j);(0,t.useEffect)(()=>Hn(Ra=>Ra+1),[Pt,Gt]);const{loading:ra}=(0,h.A)(async()=>{if(Pn&&Ln>0){const Ra=Date.now(),es=await(0,N.g0)(Pt,Gt),Ws=Date.now()-Ra;return Ws>=w&&(0,D.rR)("Slow unknown variables expansion",{elapsed:Ws}),Hn(0),xa(es),es}return[]},[Pt,Gt,Pn,Ln]),os=Ra=>{Ra&&(0,D.rR)("Unknown variables section expanded"),hn(Ra)};return t.createElement("div",{className:ua.container},t.createElement(C.M,{label:t.createElement(V,null),isOpen:Pn,onToggle:os},ra&&t.createElement(T.gW,{justify:"center"},t.createElement(T.Gy,{justify:"center"},t.createElement("span",null,"Loading..."),t.createElement(S.y,null))),!ra&&kn&&t.createElement(t.Fragment,null,kn.length===0&&t.createElement(K,null),kn.length>0&&t.createElement(k,{usages:kn}))))}function V(){const Pt=(0,v.of)(j);return t.createElement("h5",null,"Renamed or missing variables",t.createElement(O.m,{content:"Click to expand a list with all variable references that have been renamed or are missing from the dashboard."},t.createElement(x.I,{name:"info-circle",className:Pt.infoIcon})))}function K(){return t.createElement("span",null,"No renamed or missing variables found.")}function k({usages:Pt}){const Gt=(0,v.of)(j);return t.createElement("table",{className:"filter-table filter-table--hover"},t.createElement("thead",null,t.createElement("tr",null,t.createElement("th",null,"Variable"),t.createElement("th",{colSpan:5}))),t.createElement("tbody",null,Pt.map(Pn=>{const{variable:hn}=Pn,{id:Ln,name:Hn}=hn;return t.createElement("tr",{key:Ln},t.createElement("td",{className:Gt.firstColumn},t.createElement("span",null,Hn)),t.createElement("td",{className:Gt.defaultColumn}),t.createElement("td",{className:Gt.defaultColumn}),t.createElement("td",{className:Gt.defaultColumn}),t.createElement("td",{className:Gt.lastColumn},t.createElement(W,{id:hn.id,usages:Pt})))})))}const j=Pt=>({container:(0,g.css)`
    margin-top: ${Pt.spacing(4)};
    padding-top: ${Pt.spacing(4)};
  `,infoIcon:(0,g.css)`
    margin-left: ${Pt.spacing(1)};
  `,defaultColumn:(0,g.css)`
    width: 1%;
  `,firstColumn:(0,g.css)`
    width: 1%;
    vertical-align: top;
    color: ${Pt.colors.text.maxContrast};
  `,lastColumn:(0,g.css)`
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    width: 100%;
    text-align: right;
  `});var H=e(48594),J=e(87421),X=e(56968),se=e(75096),ae=e(96374);function ne({varName:Pt,isOpen:Gt=!1,onConfirm:Pn,onDismiss:hn}){return t.createElement(ae.u,{title:"Delete variable",isOpen:Gt,onConfirm:Pn,onDismiss:hn,body:`
      Are you sure you want to delete variable "${Pt}"?
    `,modalClass:q.modal,confirmText:"Delete"})}const q={modal:(0,g.css)({width:"max-content",maxWidth:"80vw"})};var ee=e(39070),z=e(8964),te=e(58975),ie=e(85140),ce=e(14329),ue=e(41820),fe=e(20601),Te=e(24240),he=e(72401),de=e(89458);function le({onChange:Pt,type:Gt}){const Pn=(0,t.useMemo)(()=>(0,se.AX)(),[]),hn=(0,t.useMemo)(()=>Pn.find(Ln=>Ln.value===Gt)??Pn[0],[Pn,Gt]);return t.createElement(de.v,{name:"Select variable type",value:hn,options:Pn,onChange:Pt,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}var pe=e(2543),ve=e(27238),be=e(3843);const Oe=Pt=>async Gt=>{const{rootStateKey:Pn}=Pt;Gt((0,H.kb)(Pn,(0,be.sJ)({name:(0,J.dn)(Pt).name,id:Pt.id})))},Me=Pt=>async(Gt,Pn)=>{const{rootStateKey:hn}=Pt;Gt((0,H.kb)(hn,(0,be.T7)((0,se.qD)(Pt))))},Ue=(Pt,Gt)=>(Pn,hn)=>{const{id:Ln,rootStateKey:Hn}=Pt;let kn=null;if(Gt.match(/^(?!__).*$/)||(kn="Template names cannot begin with '__', that's reserved for Grafana's global variables"),Gt.match(/^\w+$/)||(kn="Only word characters are allowed in variable names"),(0,J.SS)(Hn,hn()).filter(ra=>ra.name===Gt&&ra.id!==Ln).length&&(kn="Variable with the same name already exists"),kn){Pn((0,H.kb)(Hn,(0,be.DW)({newName:Gt,errorText:kn})));return}Pn(we(Pt,Gt))},we=(Pt,Gt)=>(Pn,hn)=>{const{rootStateKey:Ln}=Pt,Hn=(0,J.dn)(Pt,hn());if(Hn.name===Gt){Pn((0,H.kb)(Ln,(0,be.FN)((0,se.qD)(Pt,{newName:Gt}))));return}const kn={...(0,pe.cloneDeep)(Hn),name:Gt,id:Gt},xa=Hn.global,ua=Hn.index,ra=(0,se.jX)(kn);Pn((0,H.kb)(Ln,(0,X.QV)((0,se.qD)(ra,{global:xa,index:ua,model:kn})))),Pn((0,H.kb)(Ln,(0,be.FN)((0,se.qD)(ra,{newName:Gt})))),Pn((0,H.kb)(Ln,(0,X.Hr)((0,se.qD)(Pt,{reIndex:!1}))))},Re=(Pt,Gt="query")=>(Pn,hn)=>{const Ln=(0,se.q4)(Pt),Hn=(0,J.SS)(Ln,hn()),kn=xe(Gt,Hn),xa={type:Gt,id:kn},ua=!1,ra=(0,J.hk)(Ln,hn()),os=(0,pe.cloneDeep)(fe.B.get(Gt).initialState);os.id=kn,os.name=kn,os.rootStateKey=Ln,Pn((0,H.kb)(Ln,(0,X.QV)((0,se.qD)(xa,{global:ua,model:os,index:ra})))),o.Ny.partial({editIndex:Hn.length})},Fe=Pt=>(Gt,Pn)=>{const hn=(0,se.q4)(Pt),Ln=Pn(),Hn=(0,J.nS)(hn,Ln),kn=Ln.dashboard.getModel(),{usages:xa}=(0,N.hM)(Hn,kn),ua=(0,N.Ow)(xa);Gt((0,H.kb)(hn,(0,ve.bX)({usages:xa,usagesNetwork:ua})))};function xe(Pt,Gt){let Pn=0,hn=`${Pt}${Pn}`;for(;Gt.find(Ln=>Ln.id===hn);)hn=`${Pt}${++Pn}`;return hn}var Ve=e(85830);const $e=(Pt,Gt)=>({editor:(0,J.nx)(Gt.identifier.rootStateKey,Pt).editor,variable:(0,J.dn)(Gt.identifier,Pt)}),Xe=Pt=>({...(0,E.bindActionCreators)({variableEditorMount:Oe,variableEditorUnMount:Me,changeVariableName:Ue,updateOptions:he.mZ},Pt),changeVariableProp:(Gt,Pn,hn)=>Pt((0,H.kb)(Gt.rootStateKey,(0,X.QP)((0,se.qD)(Gt,{propName:Pn,propValue:hn})))),changeVariableType:(Gt,Pn)=>Pt((0,H.kb)(Gt.rootStateKey,(0,X.l_)((0,se.qD)(Gt,{newType:Pn})))),removeVariable:Gt=>{Pt((0,H.kb)(Gt.rootStateKey,(0,X.Hr)((0,se.qD)(Gt,{reIndex:!0}))))}}),gt=(0,a.connect)($e,Xe);class Dt extends t.PureComponent{constructor(){super(...arguments),this.state={showDeleteModal:!1},this.onNameChange=Gt=>{Gt.preventDefault(),this.props.changeVariableName(this.props.identifier,Gt.currentTarget.value)},this.onTypeChange=Gt=>{Gt.value&&this.props.changeVariableType(this.props.identifier,Gt.value)},this.onLabelChange=Gt=>{Gt.preventDefault(),this.props.changeVariableProp(this.props.identifier,"label",Gt.currentTarget.value)},this.onDescriptionChange=Gt=>{this.props.changeVariableProp(this.props.identifier,"description",Gt.currentTarget.value)},this.onHideChange=Gt=>{this.props.changeVariableProp(this.props.identifier,"hide",Gt)},this.onPropChanged=({propName:Gt,propValue:Pn,updateOptions:hn=!1})=>{this.props.changeVariableProp(this.props.identifier,Gt,Pn),hn&&this.props.updateOptions((0,se.jX)(this.props.variable))},this.onHandleSubmit=async Gt=>{Gt.preventDefault(),this.props.editor.isValid&&this.props.updateOptions((0,se.jX)(this.props.variable))},this.onModalOpen=()=>{this.setState({showDeleteModal:!0})},this.onModalClose=()=>{this.setState({showDeleteModal:!1})},this.onDelete=()=>{this.props.removeVariable(this.props.identifier),this.onModalClose(),o.Ny.partial({editIndex:null})},this.onApply=()=>{o.Ny.partial({editIndex:null})},this.getVariableOptions=()=>{const{variable:Gt}=this.props;return(0,Te.SP)(Gt)?Gt.options.map(Pn=>({label:String(Pn.text),value:String(Pn.value)})):[]}}componentDidMount(){this.props.variableEditorMount(this.props.identifier)}componentWillUnmount(){this.props.variableEditorUnMount(this.props.identifier)}render(){const{variable:Gt}=this.props,Pn=fe.B.get(this.props.variable.type).editor;if(!Pn)return null;const hn=Gt.state===ee.Gu.Loading;return t.createElement(t.Fragment,null,t.createElement("form",{"aria-label":"Variable editor Form",onSubmit:this.onHandleSubmit},t.createElement(le,{onChange:this.onTypeChange,type:this.props.variable.type}),t.createElement(te.Y,null,"General"),t.createElement(ce._,{value:this.props.editor.name,onChange:this.onNameChange,name:"Name",placeholder:"Variable name",description:"The name of the template variable. (Max. 50 characters)",invalid:!!this.props.editor.errors.name,error:this.props.editor.errors.name,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:Ve.M.MaxSize,required:!0}),t.createElement(ce._,{name:"Label",description:"Optional display name",value:this.props.variable.label??"",placeholder:"Label name",onChange:this.onLabelChange,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),t.createElement(ie.Z,{name:"Description",value:Gt.description??"",placeholder:"Descriptive text",onChange:this.onDescriptionChange,width:52}),t.createElement(z.D,{onChange:this.onHideChange,hide:this.props.variable.hide,type:this.props.variable.type}),Pn&&t.createElement(Pn,{variable:this.props.variable,onPropChange:this.onPropChanged}),(0,Te.SP)(this.props.variable)?t.createElement(ue.j,{options:this.getVariableOptions()}):null,t.createElement("div",{style:{marginTop:"16px"}},t.createElement(T.Gy,{spacing:"md",height:"inherit"},t.createElement(m.$n,{variant:"destructive",fill:"outline",onClick:this.onModalOpen},"Delete"),t.createElement(m.$n,{type:"submit","data-testid":r.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,disabled:hn,variant:"secondary"},"Run query",hn&&t.createElement(x.I,{className:"spin-clockwise",name:"sync",size:"sm",style:{marginLeft:"2px"}})),t.createElement(m.$n,{variant:"primary",onClick:this.onApply,"data-testid":r.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton},"Apply")))),t.createElement(ne,{isOpen:this.state.showDeleteModal,varName:this.props.editor.name,onConfirm:this.onDelete,onDismiss:this.onModalClose}))}}const nt=gt(Dt);var at=e(75494),Ae=e(69529),re=e(72109),Z=e(99140);const oe=({variables:Pt})=>{const Gt=(0,t.useMemo)(()=>(0,N.hI)(Pt),[Pt]),Pn=(0,t.useMemo)(()=>(0,N.qJ)(Pt),[Pt]);return Pn.length?t.createElement(U,{show:!1,title:"Dependencies",nodes:(0,N.H7)(Gt,Pn),edges:Pn},({showModal:hn})=>t.createElement(m.$n,{onClick:()=>{(0,D.rR)("Show variable dependencies"),hn()},icon:"channel-add",variant:"secondary"},"Show dependencies")):null},Ee=Pt=>t.createElement(a.Provider,{store:Z.M_},t.createElement(oe,{...Pt})),ye=({id:Pt,usages:Gt,isAdhoc:Pn})=>{const hn=(0,t.useMemo)(()=>Gt.find(Hn=>Hn.variable.id===Pt),[Gt,Pt]);if(Gt.length===0||Pn||!hn)return null;const Ln=hn.nodes.map(Hn=>Hn.label.includes(`$${Pt}`)?{...Hn,color:"#FB7E81"}:Hn);return t.createElement(U,{show:!1,title:`Showing usages for: $${Pt}`,nodes:Ln,edges:hn.edges},({showModal:Hn})=>t.createElement(b.K,{onClick:()=>{(0,D.rR)("Show variable usages"),Hn()},name:"code-branch",tooltip:"Show usages"}))};function Se({index:Pt,variable:Gt,usageTree:Pn,usagesNetwork:hn,onEdit:Ln,onDuplicate:Hn,onDelete:kn}){const xa=(0,v.$j)(),ua=(0,v.of)(Ke),ra=Be(Gt),Ra=(0,N.PK)(Gt.id,Pn)>0||Gt.type==="adhoc",es=(0,se.jX)(Gt);return t.createElement(at.sx,{draggableId:JSON.stringify(es),index:Pt},(zs,Ws)=>t.createElement("tr",{ref:zs.innerRef,...zs.draggableProps,style:{userSelect:Ws.isDragging?"none":"auto",background:Ws.isDragging?xa.colors.background.secondary:void 0,...zs.draggableProps.style}},t.createElement("td",{role:"gridcell",className:ua.column},t.createElement(m.$n,{size:"xs",fill:"text",onClick:Rs=>{Rs.preventDefault(),Ln(es)},className:ua.nameLink,"aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(Gt.name)},Gt.name)),t.createElement("td",{role:"gridcell",className:ua.definitionColumn,onClick:Rs=>{Rs.preventDefault(),Ln(es)},"aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(Gt.name)},ra),t.createElement("td",{role:"gridcell",className:ua.column},t.createElement("div",{className:ua.icons},t.createElement(We,{passed:Ra}),t.createElement(ye,{id:Gt.id,isAdhoc:Gt.type==="adhoc",usages:hn}),t.createElement(b.K,{onClick:Rs=>{Rs.preventDefault(),(0,D.rR)("Duplicate variable"),Hn(es)},name:"copy",tooltip:"Duplicate variable","aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(Gt.name)}),t.createElement(b.K,{onClick:Rs=>{Rs.preventDefault(),(0,D.rR)("Delete variable"),kn(es)},name:"trash-alt",tooltip:"Remove variable","aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(Gt.name)}),t.createElement("div",{...zs.dragHandleProps,className:ua.dragHandle},t.createElement(x.I,{name:"draggabledots",size:"lg"}))))))}function Be(Pt){let Gt="";return Pt.type==="query"?Pt.definition?Gt=Pt.definition:typeof Pt.query=="string"&&(Gt=Pt.query):(0,Te.SP)(Pt)&&(Gt=Pt.query),Gt}function We({passed:Pt}){const Gt=(0,v.of)(Ke);return Pt?t.createElement(x.I,{name:"check",className:Gt.iconPassed,title:"This variable is referenced by other variables or dashboard."}):t.createElement(x.I,{name:"exclamation-triangle",className:Gt.iconFailed,title:"This variable is not referenced by any variable or dashboard."})}function Ke(Pt){return{dragHandle:(0,g.css)`
      cursor: grab;
      margin-left: ${Pt.spacing(1)};
    `,column:(0,g.css)`
      width: 1%;
    `,nameLink:(0,g.css)`
      cursor: pointer;
      color: ${Pt.colors.primary.text};
    `,definitionColumn:(0,g.css)`
      width: 100%;
      max-width: 200px;
      cursor: pointer;
      overflow: hidden;
      text-overflow: ellipsis;
      -o-text-overflow: ellipsis;
      white-space: nowrap;
    `,iconPassed:(0,g.css)`
      color: ${Pt.v1.palette.greenBase};
      margin-right: ${Pt.spacing(2)};
    `,iconFailed:(0,g.css)`
      color: ${Pt.v1.palette.orange};
      margin-right: ${Pt.spacing(2)};
    `,icons:(0,g.css)`
      display: flex;
      gap: ${Pt.spacing(2)};
      align-items: center;
    `}}function it({variables:Pt,usages:Gt,usagesNetwork:Pn,onChangeOrder:hn,onAdd:Ln,onEdit:Hn,onDelete:kn,onDuplicate:xa}){const ua=(0,v.of)(ft),ra=os=>{if(!os.destination||!os.source)return;(0,D.rR)("Variable drag and drop");const Ra=JSON.parse(os.draggableId);hn(Ra,Pt[os.source.index].index,Pt[os.destination.index].index)};return t.createElement("div",null,t.createElement("div",null,Pt.length===0&&t.createElement(rt,{onAdd:Ln}),Pt.length>0&&t.createElement(i.B,{direction:"column",gap:4},t.createElement("div",{className:ua.tableContainer},t.createElement("table",{className:"filter-table filter-table--hover","aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid"},t.createElement("thead",null,t.createElement("tr",null,t.createElement("th",null,"Variable"),t.createElement("th",null,"Definition"),t.createElement("th",{colSpan:5}))),t.createElement(at.JY,{onDragEnd:ra},t.createElement(at.gL,{droppableId:"variables-list",direction:"vertical"},os=>t.createElement("tbody",{ref:os.innerRef,...os.droppableProps},Pt.map((Ra,es)=>t.createElement(Se,{index:es,key:`${Ra.name}-${es}`,variable:Ra,usageTree:Gt,usagesNetwork:Pn,onDelete:kn,onDuplicate:xa,onEdit:Hn})),os.placeholder))))),t.createElement(i.B,null,t.createElement(Ee,{variables:Pt}),t.createElement(m.$n,{"aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:Ln,icon:"plus"},"New variable")))))}function rt({onAdd:Pt}){return t.createElement(i.B,{direction:"column"},t.createElement(Ae.p,{variant:"call-to-action",button:t.createElement(m.$n,{"data-testid":r.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:Pt,size:"lg"},t.createElement(c.x6,{i18nKey:"variables.empty-state.button-title"},"Add variable")),message:(0,c.t)("variables.empty-state.title","There are no variables added yet")},t.createElement("p",null,t.createElement(c.x6,{i18nKey:"variables.empty-state.info-box-content"},"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard.")),t.createElement(c.x6,{i18nKey:"variables.empty-state.info-box-content-2"},"Check out the"," ",t.createElement(re.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/"},"Templates and variables documentation")," ","for more information.")))}const ft=()=>({tableContainer:(0,g.css)`
    overflow: scroll;
    width: 100%;
  `}),pt=(Pt,Gt)=>{const{uid:Pn}=Gt.dashboard,hn=(0,J.nx)(Pn,Pt);return{variables:(0,J.nS)(Pn,Pt),idInEditor:hn.editor.id,usagesNetwork:hn.inspect.usagesNetwork,usages:hn.inspect.usages}},Ge=Pt=>({...(0,E.bindActionCreators)({createNewVariable:Re,initListMode:Fe},Pt),changeVariableOrder:(Gt,Pn,hn)=>Pt((0,H.kb)(Gt.rootStateKey,(0,X.hj)((0,se.qD)(Gt,{fromIndex:Pn,toIndex:hn})))),duplicateVariable:Gt=>Pt((0,H.kb)(Gt.rootStateKey,(0,X.ut)((0,se.qD)(Gt,{newId:void 0})))),removeVariable:Gt=>{Pt((0,H.kb)(Gt.rootStateKey,(0,X.Hr)((0,se.qD)(Gt,{reIndex:!0}))))}}),qe=(0,a.connect)(pt,Ge);class bt extends t.PureComponent{constructor(){super(...arguments),this.state={variableId:void 0},this.onEditVariable=Gt=>{const Pn=this.props.variables.findIndex(hn=>hn.id===Gt.id);o.Ny.partial({editIndex:Pn})},this.onNewVariable=()=>{this.props.createNewVariable(this.props.dashboard.uid)},this.onChangeVariableOrder=(Gt,Pn,hn)=>{this.props.changeVariableOrder(Gt,Pn,hn)},this.onDuplicateVariable=Gt=>{this.props.duplicateVariable(Gt)},this.onModalOpen=Gt=>{this.setState({variableId:Gt})},this.onModalClose=()=>{this.setState({variableId:void 0})},this.onRemoveVariable=()=>{this.props.removeVariable(this.state.variableId),this.onModalClose()}}componentDidMount(){this.props.initListMode(this.props.dashboard.uid)}render(){const{editIndex:Gt,variables:Pn,sectionNav:hn}=this.props,Ln=Gt!=null?Pn[Gt]:void 0,Hn=hn.node,kn=Hn.parentItem?{...Hn.parentItem,url:Hn.url}:void 0,xa=Ln?{text:Ln.name,parentItem:kn}:kn;return t.createElement(p.Y,{navModel:this.props.sectionNav,pageNav:xa},!Ln&&t.createElement(it,{variables:this.props.variables,onAdd:this.onNewVariable,onEdit:this.onEditVariable,onChangeOrder:this.onChangeVariableOrder,onDuplicate:this.onDuplicateVariable,onDelete:this.onModalOpen,usages:this.props.usages,usagesNetwork:this.props.usagesNetwork}),!Ln&&this.props.variables.length>0&&t.createElement(L,{variables:this.props.variables,dashboard:this.props.dashboard}),Ln&&t.createElement(nt,{identifier:(0,se.jX)(Ln)}),t.createElement(ne,{isOpen:this.state.variableId!==void 0,varName:this.state.variableId?.id??"",onConfirm:this.onRemoveVariable,onDismiss:this.onModalClose}))}}const Ft=qe(bt);var Xt=e(5108),Lt=e(10096);const Qt=({dashboard:Pt,sectionNav:Gt})=>{const Pn=Lt.TP.hasPermission(f.AccessControlAction.DashboardsPermissionsWrite),hn=Gt.node.parentItem;return t.createElement(p.Y,{navModel:Gt,pageNav:hn},t.createElement(Xt.x,{resource:"dashboards",resourceId:Pt.uid,canSetPermissions:Pn}))};var an=e(78050),gn=e(22391),ut=e(19347),Nt=e(84167),ht=e(88575),Rt=e(10354),_t=e(10880),on=e(21594),ln=e(77268),bn=e(2913),In=e(82241),Mn=e(46502),vt=e(51612);const nn="New annotation",cn=({editIdx:Pt,dashboard:Gt})=>{const Pn=(0,v.of)(mt),[hn,Ln]=(0,t.useState)(Gt.annotations.list[Pt]),Hn=(0,t.useMemo)(()=>hn.filter?hn.filter.exclude?2:1:0,[hn.filter]),{value:kn}=(0,h.A)(()=>(0,ut.l)().get(hn.datasource),[hn.datasource]),xa=(0,ut.l)().getInstanceSettings(hn.datasource),ua=Ka=>{const ys=[...Gt.annotations.list];ys.splice(Pt,1,Ka),Ln(Ka),Gt.annotations.list=ys},ra=Ka=>{ua({...hn,name:Ka.currentTarget.value})},os=Ka=>{const ys=(0,gn.p$)(Ka);hn.datasource?.type!==ys.type?ua({datasource:ys,builtIn:hn.builtIn,enable:hn.enable,iconColor:hn.iconColor,name:hn.name,hide:hn.hide,filter:hn.filter,mappings:hn.mappings,type:hn.type}):ua({...hn,datasource:ys})},Ra=Ka=>{const ys=Ka.currentTarget;ua({...hn,[ys.name]:ys.type==="checkbox"?ys.checked:ys.value})},es=Ka=>{ua({...hn,iconColor:Ka})},zs=Ka=>{let ys=Ka.value===0?void 0:{exclude:Ka.value===2,ids:hn.filter?.ids??[]};ua({...hn,filter:ys})},Ws=Ka=>{if(!Array.isArray(Ka))return;const ys={exclude:Hn===2,ids:[]};Ka.forEach(Er=>Er.value&&ys.ids.push(Er.value)),ua({...hn,filter:ys})},Rs=lt,xr=()=>{o.Ny.partial({editview:null,editIndex:null})},dr=()=>{const Ka=Gt.annotations.list;Gt.annotations.list=[...Ka.slice(0,Pt),...Ka.slice(Pt+1)],lt()},Us=hn.name===nn,$r=(Ka,ys)=>Ka.label&&ys.label?Ka.label.toLowerCase().localeCompare(ys.label.toLowerCase()):-1,ks=(0,t.useMemo)(()=>Gt?.panels.filter(Ka=>bn.Ay.panels[Ka.type]).map(Ka=>({value:Ka.id,label:Ka.title??`Panel ${Ka.id}`,description:Ka.description,imgUrl:bn.Ay.panels[Ka.type].info.logos.small})).sort($r)??[],[Gt]);return t.createElement("div",null,t.createElement(Nt.n,{className:Pn.settingsForm},t.createElement(ht.D,{label:"Name"},t.createElement(Rt.p,{"data-testid":r.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:Us,value:hn.name,onChange:ra})),t.createElement(ht.D,{label:"Data source",htmlFor:"data-source-picker"},t.createElement(vt.s,{annotations:!0,variables:!0,current:hn.datasource,onChange:os})),t.createElement(ht.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh"},t.createElement(_t.S,{name:"enable",id:"enable",value:hn.enable,onChange:Ra})),t.createElement(ht.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden."},t.createElement(_t.S,{name:"hide",id:"hide",value:hn.hide,onChange:Ra})),t.createElement(ht.D,{label:"Color",description:"Color to use for the annotation event markers"},t.createElement(T.Gy,null,t.createElement(ln.a,{value:hn?.iconColor,onChange:es}))),t.createElement(ht.D,{label:"Show in","data-testid":r.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel},t.createElement(t.Fragment,null,t.createElement(on.l6,{options:Vt,value:Hn,onChange:zs,"data-testid":r.Tp.components.Annotations.annotationsTypeInput}),Hn!==0&&t.createElement(on.KF,{options:ks,value:ks.filter(Ka=>hn.filter?.ids.includes(Ka.value)),onChange:Ws,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:Pn.select,"data-testid":r.Tp.components.Annotations.annotationsChoosePanelInput})))),t.createElement(Nt.n,null,t.createElement("h3",{className:"page-heading"},"Query"),kn?.annotations&&xa&&t.createElement(In.A,{datasource:kn,datasourceInstanceSettings:xa,annotation:hn,onChange:ua}),kn&&!kn.annotations&&t.createElement(Mn.F,{datasource:kn,annotation:hn,onChange:ua})),t.createElement(i.B,null,!hn.builtIn&&t.createElement(m.$n,{variant:"destructive",onClick:dr},"Delete"),t.createElement(m.$n,{variant:"secondary",onClick:xr,"data-testid":r.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.previewInDashboard},"Preview in dashboard"),t.createElement(m.$n,{variant:"primary",onClick:Rs},"Apply")))},mt=Pt=>({settingsForm:(0,g.css)({maxWidth:Pt.spacing(60),marginBottom:Pt.spacing(2)}),select:(0,g.css)({marginTop:"8px"})});function lt(){o.Ny.partial({editIndex:null})}var Tt=(Pt=>(Pt[Pt.AllPanels=0]="AllPanels",Pt[Pt.IncludePanels=1]="IncludePanels",Pt[Pt.ExcludePanels=2]="ExcludePanels",Pt))(Tt||{});const Vt=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var zt=e(14588),rn=e(91605),mn=e(46991);const dt=({dashboard:Pt,onNew:Gt,onEdit:Pn})=>{const hn=(0,v.of)(wt),[Ln,Hn]=(0,t.useState)(Pt.annotations.list),kn=(Ra,es)=>{Pt.annotations.list=zt.moveItemImmutably(Ln,Ra,Ra+es),Hn(Pt.annotations.list)},xa=Ra=>{Pt.annotations.list=[...Ln.slice(0,Ra),...Ln.slice(Ra+1)],Hn(Pt.annotations.list)},ua=Ln.length===0||Ln.length===1&&Ln[0].builtIn,ra=Ra=>Ra.enable===!1?t.createElement(t.Fragment,null,t.createElement("em",{className:"muted"},"(Disabled) \xA0 ",Ra.name)):Ra.builtIn?t.createElement(t.Fragment,null,t.createElement("em",{className:"muted"},Ra.name," \xA0 (Built-in)")):t.createElement(t.Fragment,null,Ra.name),os=(0,ut.l)();return t.createElement(i.B,{direction:"column"},Ln.length>0&&t.createElement("div",{className:hn.table},t.createElement("table",{role:"grid",className:"filter-table filter-table--hover"},t.createElement("thead",null,t.createElement("tr",null,t.createElement("th",null,"Query name"),t.createElement("th",null,"Data source"),t.createElement("th",{colSpan:3}))),t.createElement("tbody",null,Pt.annotations.list.map((Ra,es)=>t.createElement("tr",{key:`${Ra.name}-${es}`},Ra.builtIn?t.createElement("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>Pn(es)},t.createElement(m.$n,{size:"sm",fill:"text",variant:"secondary"},ra(Ra))):t.createElement("td",{role:"gridcell",className:"pointer",onClick:()=>Pn(es)},t.createElement(m.$n,{size:"sm",fill:"text",variant:"secondary"},ra(Ra))),t.createElement("td",{role:"gridcell",className:"pointer",onClick:()=>Pn(es)},os.getInstanceSettings(Ra.datasource)?.name||Ra.datasource?.uid),t.createElement("td",{role:"gridcell",style:{width:"1%"}},es!==0&&t.createElement(b.K,{name:"arrow-up",onClick:()=>kn(es,-1),tooltip:"Move up"})),t.createElement("td",{role:"gridcell",style:{width:"1%"}},Pt.annotations.list.length>1&&es!==Pt.annotations.list.length-1?t.createElement(b.K,{name:"arrow-down",onClick:()=>kn(es,1),tooltip:"Move down"}):null),t.createElement("td",{role:"gridcell",style:{width:"1%"}},!Ra.builtIn&&t.createElement(rn.e,{size:"sm",onConfirm:()=>xa(es),"aria-label":`Delete query with title "${Ra.name}"`}))))))),ua&&t.createElement(i.B,{direction:"column"},t.createElement(Ae.p,{variant:"call-to-action",button:t.createElement(m.$n,{"data-testid":r.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:Gt,size:"lg"},t.createElement(c.x6,{i18nKey:"annotations.empty-state.button-title"},"Add annotation query")),message:(0,c.t)("annotations.empty-state.title","There are no custom annotation queries added yet")},t.createElement(c.x6,{i18nKey:"annotations.empty-state.info-box-content"},t.createElement("p",null,"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database.")),t.createElement(c.x6,{i18nKey:"annotations.empty-state.info-box-content-2"},"Checkout the"," ",t.createElement(re.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/"},"Annotations documentation")," ","for more information."))),!ua&&t.createElement(mn.d,{"data-testid":r.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:Gt},"New query"))},wt=()=>({table:(0,g.css)({width:"100%",overflowX:"scroll"})});function en({dashboard:Pt,editIndex:Gt,sectionNav:Pn}){const hn=()=>{const kn={name:nn,enable:!0,datasource:(0,gn.p$)((0,ut.l)().getInstanceSettings(null)),iconColor:"red"};Pt.annotations.list=[...Pt.annotations.list,{...kn}],o.Ny.partial({editIndex:Pt.annotations.list.length-1})},Ln=kn=>{o.Ny.partial({editIndex:kn})},Hn=Gt!=null&&Gt<Pt.annotations.list.length;return t.createElement(p.Y,{navModel:Pn,pageNav:En(Pt,Gt,Pn.node)},!Hn&&t.createElement(dt,{dashboard:Pt,onNew:hn,onEdit:Ln}),Hn&&t.createElement(cn,{dashboard:Pt,editIdx:Gt}))}function En(Pt,Gt,Pn){const hn=Pn.parentItem;if(Gt==null)return hn;const Ln=Pt.annotations.list[Gt];if(Ln)return{text:Ln.name,parentItem:hn&&{...hn,url:Pn.url}}}var yt=e(32264),At=e(90613),Kt=e(60029),Jt=e(21744),Mt=e(79924),Je=e(94354),Nn=e(36607),xn=e(3673),Fn=e(71678),wn=e(14792),Wn=e(5805),da=e(11230);const oa={cleanUpDashboardAndVariables:xn.Bz},_n=(0,a.connect)(null,oa),Wa=({hideModal:Pt,cleanUpDashboardAndVariables:Gt,dashboard:Pn})=>{const hn=Pn.meta.provisioned,[,Ln]=(0,Wn.default)(async()=>{await(0,da.A_)(Pn.uid,!0),Gt(),Pt(),o.Ny.replace("/")},[Pt]);return hn?t.createElement(za,{hideModal:Pt,provisionedId:Pn.meta.provisionedExternalId}):t.createElement(ae.u,{isOpen:!0,body:t.createElement(t.Fragment,null,t.createElement("p",null,"Do you want to delete this dashboard?"),t.createElement("p",null,Pn.title)),onConfirm:Ln,onDismiss:Pt,title:"Delete",icon:"trash-alt",confirmText:"Delete"})},za=({hideModal:Pt,provisionedId:Gt})=>t.createElement(M.a,{isOpen:!0,title:"Cannot delete provisioned dashboard",icon:"trash-alt",onDismiss:Pt,className:(0,g.css)({width:"500px"})},t.createElement("p",null,"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."),t.createElement("p",null,t.createElement("i",null,"See"," ",t.createElement("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer"},"documentation")," ","for more information about provisioning."),t.createElement("br",null),"File path: ",Gt),t.createElement(M.a.ButtonRow,null,t.createElement(m.$n,{variant:"primary",onClick:Pt},"OK"))),_a=_n(Wa),Xa=()=>{const Pt=(0,wn.UA)().getCurrent();return t.createElement(Fn.$s,null,({showModal:Gt,hideModal:Pn})=>t.createElement(m.$n,{variant:"destructive",onClick:()=>{Gt(_a,{dashboard:Pt,hideModal:Pn})},"data-testid":r.Tp.pages.Dashboard.Settings.General.deleteDashBoard},t.createElement(c.x6,{i18nKey:"dashboard-settings.dashboard-delete-button"},"Delete dashboard")))};var Va=e(81394),Cs=e(27966),ns=e(75590);const Is=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];function ls({dashboard:Pt,updateTimeZone:Gt,updateWeekStart:Pn,sectionNav:hn}){const[Ln,Hn]=(0,t.useState)(0),[kn,xa]=(0,t.useState)(Pt.title),[ua,ra]=(0,t.useState)(Pt.description),os=hn.node.parentItem,Ra=(ds,Zr)=>{Pt.meta.folderUid=ds,Pt.meta.folderTitle=Zr,Pt.meta.hasUnsavedFolderChange=!0,Hn(Ln+1)},es=t.useCallback(ds=>{Pt.title=ds,xa(ds)},[xa,Pt]),zs=t.useCallback(ds=>{Pt.description=ds,ra(ds)},[ra,Pt]),Ws=ds=>{Pt.graphTooltip=ds,Hn(Ln+1)},Rs=ds=>{Pt.timepicker.refresh_intervals=ds.filter(Zr=>Zr.trim()!=="")},xr=ds=>{Pt.timepicker.nowDelay=ds},dr=ds=>{Pt.timepicker.hidden=ds,Hn(Ln+1)},Us=ds=>{Pt.liveNow=ds,Hn(Ln+1)},$r=ds=>{Pt.timezone=ds,Hn(Ln+1),Gt(ds)},ks=ds=>{Pt.weekStart=ds,Hn(Ln+1),Pn(ds)},Ka=ds=>{Pt.tags=ds,Hn(Ln+1)},ys=ds=>{Pt.editable=ds,Hn(Ln+1)},Er=[{label:"Editable",value:!0},{label:"Read-only",value:!1}];return t.createElement(p.Y,{navModel:hn,pageNav:os},t.createElement("div",{style:{maxWidth:"600px"}},t.createElement(At.a,{marginBottom:5},t.createElement(ht.D,{label:t.createElement(i.B,{justifyContent:"space-between"},t.createElement(Kt.J,{htmlFor:"title-input"},t.createElement(c.x6,{i18nKey:"dashboard-settings.general.title-label"},"Title")),yt.$.featureToggles.dashgpt&&t.createElement(Cs.Z,{onGenerate:es}))},t.createElement(Rt.p,{id:"title-input",name:"title",value:kn,onChange:ds=>es(ds.target.value)})),t.createElement(ht.D,{label:t.createElement(i.B,{justifyContent:"space-between"},t.createElement(Kt.J,{htmlFor:"description-input"},(0,c.t)("dashboard-settings.general.description-label","Description")),yt.$.featureToggles.dashgpt&&t.createElement(Va.V,{onGenerate:zs}))},t.createElement(Jt.f,{id:"description-input",name:"description",value:ua,onChange:ds=>zs(ds.target.value)})),t.createElement(ht.D,{label:(0,c.t)("dashboard-settings.general.tags-label","Tags")},t.createElement(Mt.u,{id:"tags-input",tags:Pt.tags,onChange:Ka,width:40})),t.createElement(ht.D,{label:(0,c.t)("dashboard-settings.general.folder-label","Folder")},t.createElement(Nn.d,{value:Pt.meta.folderUid,onChange:Ra,initialTitle:Pt.meta.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,dashboardId:Pt.id,skipInitialLoad:!0})),t.createElement(ht.D,{label:(0,c.t)("dashboard-settings.general.editable-label","Editable"),description:(0,c.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect")},t.createElement(Je.z,{value:Pt.editable,options:Er,onChange:ys}))),t.createElement(ns.p,{onTimeZoneChange:$r,onWeekStartChange:ks,onRefreshIntervalChange:Rs,onNowDelayChange:xr,onHideTimePickerChange:dr,onLiveNowChange:Us,refreshIntervals:Pt.timepicker.refresh_intervals,timePickerHidden:Pt.timepicker.hidden,nowDelay:Pt.timepicker.nowDelay,timezone:Pt.timezone,weekStart:Pt.weekStart,liveNow:Pt.liveNow}),t.createElement(C.M,{label:(0,c.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0},t.createElement(ht.D,{label:(0,c.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,c.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect")},t.createElement(Je.z,{onChange:Ws,options:Is,value:Pt.graphTooltip}))),t.createElement(At.a,{marginTop:3},Pt.meta.canDelete&&t.createElement(Xa,null))))}const ss={updateTimeZone:xn.lC,updateWeekStart:xn.Ss},Ts=(0,a.connect)(null,ss)(ls);var Es=e(32372),gs=e(6473);function ps({dashboard:Pt,sectionNav:Gt}){const Pn=Pt.getSaveModelClone(),[hn,Ln]=(0,t.useState)(JSON.stringify(Pn,null,2)),Hn=Gt.node.parentItem,kn=async()=>{await(0,wn.UA)().saveJSONDashboard(hn),gs.t.reloadPage()},xa=(0,v.of)(js);return t.createElement(p.Y,{navModel:Gt,pageNav:Hn},t.createElement("div",{className:xa.wrapper},t.createElement(c.x6,{i18nKey:"dashboard-settings.json-editor.subtitle"},"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."),t.createElement(Es.B,{value:hn,language:"json",showMiniMap:!0,showLineNumbers:!0,onBlur:Ln,containerStyles:xa.codeEditor}),Pt.meta.canSave&&t.createElement("div",null,t.createElement(m.$n,{type:"submit",onClick:kn},t.createElement(c.x6,{i18nKey:"dashboard-settings.json-editor.save-button"},"Save changes")))))}const js=Pt=>({wrapper:(0,g.css)({display:"flex",height:"100%",flexDirection:"column",gap:Pt.spacing(2)}),codeEditor:(0,g.css)({flexGrow:1})});var As=e(4588),Qr=e(65857);const nr=({editLinkIdx:Pt,dashboard:Gt,onGoBack:Pn})=>{const[hn,Ln]=(0,t.useState)(Pt!==null?Gt.links[Pt]:As.q),Hn=kn=>{const xa=[...Gt.links];xa.splice(Pt,1,kn),Gt.links=xa,Ln(kn)};return t.createElement(Qr.d,{link:hn,onUpdate:Hn,onGoBack:Pn})};var hr=e(6199);const ar=({dashboard:Pt,onNew:Gt,onEdit:Pn})=>{const[hn,Ln]=(0,t.useState)(Pt.links),Hn=(ua,ra)=>{Pt.links=zt.moveItemImmutably(hn,ua,ua+ra),Ln(Pt.links)},kn=ua=>{Pt.links=[...hn,{...ua}],Ln(Pt.links)},xa=ua=>{Pt.links=[...hn.slice(0,ua),...hn.slice(ua+1)],Ln(Pt.links)};return t.createElement(hr.X,{links:hn,onNew:Gt,onEdit:Pn,onDuplicate:kn,onDelete:xa,onOrderChange:Hn})};function Yr({dashboard:Pt,sectionNav:Gt,editIndex:Pn}){const[hn,Ln]=(0,t.useState)(!1),Hn=()=>{Ln(!1),o.Ny.partial({editIndex:void 0})},kn=()=>{Pt.links=[...Pt.links,{...As.q}],Ln(!0),o.Ny.partial({editIndex:Pt.links.length-1})},xa=os=>{Ln(!1),o.Ny.partial({editIndex:os})},ua=Pn!==void 0;let ra=Gt.node.parentItem;if(ua){ra={text:hn?"New link":"Edit link",subTitle:hn?"Create a new link on your dashboard":"Edit a specific link of your dashboard"};const es=Gt.node.url;ra.parentItem=Gt.node.parentItem&&{...Gt.node.parentItem,url:es}}return t.createElement(p.Y,{navModel:Gt,pageNav:ra},!ua&&t.createElement(ar,{dashboard:Pt,onNew:kn,onEdit:xa}),ua&&t.createElement(nr,{dashboard:Pt,editLinkIdx:Pn,onGoBack:Hn}))}var Qs=e(57714),cs=e(19626),_s=e(22764),Ys=e(56596),sr=e(41053),Kr=e(3169);const io=async(Pt,Gt)=>(gs.t.ignoreNextSave(),await Qs.wL.restoreDashboard(Gt.uid,Pt)),Mo=Pt=>{const Gt=(0,f.useSelector)(Hn=>Hn.dashboard.getModel()),[Pn,hn]=(0,sr.A)(async()=>await io(Pt,Gt),[]),Ln=(0,Kr._2)();return(0,t.useEffect)(()=>{if(Pn.value){const Hn=o.Ny.getLocation(),kn=s.I.stripBaseFromUrl(Pn.value.url),xa=Hn.state?.routeReloadCounter;o.Ny.replace({...Hn,pathname:kn,state:{routeReloadCounter:xa?xa+1:1}}),Ln.success("Dashboard restored",`Restored from version ${Pt}`)}},[Pn,Pt,Ln]),{state:Pn,onRestoreDashboard:hn}},cr=({hideModal:Pt,version:Gt})=>{const{state:Pn,onRestoreDashboard:hn}=Mo(Gt);return(0,t.useEffect)(()=>{!Pn.loading&&Pn.value&&Pt()},[Pn,Pt]),t.createElement(ae.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:Pt,onConfirm:hn,body:t.createElement("p",null,"Are you sure you want to restore the dashboard to version ",Gt,"? All unsaved changes will be lost."),confirmText:`Yes, restore to version ${Gt}`})},lo=({baseInfo:Pt,newInfo:Gt,diffData:Pn,isNewLatest:hn})=>{const Ln=(0,Ys.G4)(Pn.lhs,Pn.rhs),Hn=(0,v.of)(Jr);return t.createElement(i.B,{direction:"column",gap:1},t.createElement(i.B,{justifyContent:"space-between",alignItems:"center"},t.createElement(i.B,{alignItems:"center"},t.createElement("span",{className:(0,g.cx)(Hn.versionInfo,Hn.noMarginBottom)},t.createElement("strong",null,"Version ",Pt.version)," updated by ",Pt.createdBy," ",Pt.ageString,Pt.message),t.createElement(x.I,{name:"arrow-right",size:"sm"}),t.createElement("span",{className:Hn.versionInfo},t.createElement("strong",null,"Version ",Gt.version)," updated by ",Gt.createdBy," ",Gt.ageString,Gt.message)),hn&&t.createElement(Fn.$s,null,({showModal:kn,hideModal:xa})=>t.createElement(m.$n,{variant:"destructive",icon:"history",onClick:()=>{kn(cr,{version:Pt.version,hideModal:xa})}},"Restore to version ",Pt.version))),Object.entries(Ln).map(([kn,xa])=>t.createElement(cs.D,{diffs:xa,key:kn,title:kn})),t.createElement(At.a,{paddingTop:2},t.createElement(C.M,{isOpen:!1,label:"View JSON Diff"},t.createElement(_s.M,{oldValue:JSON.stringify(Pn.lhs,null,2),newValue:JSON.stringify(Pn.rhs,null,2)}))))},Jr=Pt=>({versionInfo:(0,g.css)({color:Pt.colors.text.secondary,fontSize:Pt.typography.bodySmall.fontSize}),noMarginBottom:(0,g.css)({marginBottom:0})});var co=e(78369);const Rr=({versions:Pt,canCompare:Gt,onCheck:Pn})=>{const hn=(0,v.of)(Ho);return t.createElement("div",{className:hn.margin},t.createElement("table",{className:"filter-table"},t.createElement("thead",null,t.createElement("tr",null,t.createElement("th",{className:"width-4"}),t.createElement("th",{className:"width-4"},"Version"),t.createElement("th",{className:"width-14"},"Date"),t.createElement("th",{className:"width-10"},"Updated by"),t.createElement("th",null,"Notes"),t.createElement("th",null))),t.createElement("tbody",null,Pt.map((Ln,Hn)=>t.createElement("tr",{key:Ln.id},t.createElement("td",null,t.createElement(_t.S,{"aria-label":`Toggle selection of version ${Ln.version}`,className:(0,g.css)({display:"inline"}),checked:Ln.checked,onChange:kn=>Pn(kn,Ln.id),disabled:!Ln.checked&&Gt})),t.createElement("td",null,Ln.version),t.createElement("td",null,Ln.createdDateString),t.createElement("td",null,Ln.createdBy),t.createElement("td",null,Ln.message),t.createElement("td",{className:"text-right"},Hn===0?t.createElement(co.v,{name:"Latest",colorIndex:17}):t.createElement(Fn.$s,null,({showModal:kn,hideModal:xa})=>t.createElement(m.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{kn(cr,{version:Ln.version,hideModal:xa})}},"Restore"))))))))};function Ho(Pt){return{margin:(0,g.css)({marginBottom:Pt.spacing(4)})}}const Xr=10;class xo extends t.PureComponent{constructor(Gt){super(Gt),this.getVersions=(Pn=!1)=>{this.setState({isAppending:Pn}),Qs.wL.getHistoryList(this.props.dashboard.uid,{limit:this.limit,start:this.start}).then(hn=>{this.setState({isLoading:!1,versions:[...this.state.versions,...this.decorateVersions(hn)]}),this.start+=this.limit}).catch(hn=>console.log(hn)).finally(()=>this.setState({isAppending:!1}))},this.getDiff=async()=>{const Pn=this.state.versions.filter(ua=>ua.checked),[hn,Ln]=Pn,Hn=hn.version===this.props.dashboard.version;this.setState({isLoading:!0});const kn=await Qs.wL.getDashboardVersion(this.props.dashboard.uid,Ln.version),xa=await Qs.wL.getDashboardVersion(this.props.dashboard.uid,hn.version);this.setState({baseInfo:Ln,isLoading:!1,isNewLatest:Hn,newInfo:hn,viewMode:"compare",diffData:{lhs:kn.data,rhs:xa.data}})},this.decorateVersions=Pn=>Pn.map(hn=>({...hn,createdDateString:this.props.dashboard.formatDate(hn.created),ageString:this.props.dashboard.getRelativeTime(hn.created),checked:!1})),this.onCheck=(Pn,hn)=>{this.setState({versions:this.state.versions.map(Ln=>Ln.id===hn?{...Ln,checked:Pn.currentTarget.checked}:Ln)})},this.reset=()=>{this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.state.versions.map(Pn=>({...Pn,checked:!1})),viewMode:"list"})},this.limit=Xr,this.start=0,this.state={isAppending:!0,isLoading:!0,versions:[],viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}}componentDidMount(){this.getVersions()}isLastPage(){return this.state.versions.find(Gt=>Gt.version===1)}render(){const{versions:Gt,viewMode:Pn,baseInfo:hn,newInfo:Ln,isNewLatest:Hn,isLoading:kn,diffData:xa}=this.state,ua=Gt.filter(es=>es.checked).length===2,ra=Gt.length>1,os=Gt.length>=this.limit,Ra=this.props.sectionNav.node.parentItem;return Pn==="compare"?t.createElement(p.Y,{navModel:this.props.sectionNav,pageNav:Ra},t.createElement(Qs.me,{onClick:this.reset,baseVersion:hn?.version,newVersion:Ln?.version,isNewLatest:Hn}),kn?t.createElement(Ur,{msg:"Fetching changes\u2026"}):t.createElement(lo,{newInfo:Ln,baseInfo:hn,isNewLatest:Hn,diffData:xa})):t.createElement(p.Y,{navModel:this.props.sectionNav,pageNav:Ra},kn?t.createElement(Ur,{msg:"Fetching history list\u2026"}):t.createElement(Rr,{versions:Gt,onCheck:this.onCheck,canCompare:ua}),this.state.isAppending&&t.createElement(Ur,{msg:"Fetching more entries\u2026"}),ra&&t.createElement(Qs.rJ,{hasMore:os,canCompare:ua,getVersions:this.getVersions,getDiff:this.getDiff,isLastPage:!!this.isLastPage()}))}}const Ur=({msg:Pt})=>t.createElement(T.Gy,null,t.createElement(S.y,null),t.createElement("em",null,Pt)),Js=()=>o.Ny.partial({editview:null,editIndex:null});function uo({dashboard:Pt,editview:Gt,pageNav:Pn,sectionNav:hn}){const[Ln,Hn]=(0,t.useState)(0);(0,t.useEffect)(()=>{Pt.events.subscribe(P.Cf,()=>Hn(xr=>xr+1))},[Pt]);const kn=(0,t.useMemo)(()=>mo(Pt),[Pt,Ln]),xa=()=>{Pt.meta.hasUnsavedFolderChange=!1},ua=kn.find(xr=>xr.id===Gt)??kn[0],ra=y.TP.hasEditPermissionInFolders,os=Pt.meta.canSave,Ra=(0,n.zy)(),es=vr(Ra),zs=Vr(Pn,hn,kn,ua,Ra,Pt.uid),Ws="sm",Rs=[t.createElement(m.$n,{"data-testid":r.Tp.pages.Dashboard.Settings.Actions.close,variant:"secondary",key:"close",fill:"outline",size:Ws,onClick:Js},"Close"),ra&&t.createElement(an.m,{dashboard:Pt,onSaveSuccess:xa,variant:"secondary",key:"save as",size:Ws}),os&&t.createElement(an.C,{dashboard:Pt,onSaveSuccess:xa,key:"Save",size:Ws})];return t.createElement(t.Fragment,null,t.createElement(d.H,{actions:t.createElement(l.U,{alignment:"right"},Rs)}),t.createElement(ua.component,{sectionNav:zs,dashboard:Pt,editIndex:es}))}function mo(Pt){const Gt=[],Pn=(0,c.t)("dashboard-settings.general.title","General");Pt.meta.canEdit&&(Gt.push({title:Pn,id:"settings",icon:"sliders-v-alt",component:Ts}),Gt.push({title:(0,c.t)("dashboard-settings.annotations.title","Annotations"),id:"annotations",icon:"comment-alt",component:en,subTitle:"Annotation queries return events that can be visualized as event markers in graphs across the dashboard."}),Gt.push({title:(0,c.t)("dashboard-settings.variables.title","Variables"),id:"templating",icon:"calculator-alt",component:Ft,subTitle:"Variables can make your dashboard more dynamic and act as global filters."}),Gt.push({title:(0,c.t)("dashboard-settings.links.title","Links"),id:"links",icon:"link",component:Yr})),Pt.meta.canMakeEditable&&Gt.push({title:Pn,icon:"sliders-v-alt",id:"settings",component:Oo}),Pt.id&&Pt.meta.canSave&&Gt.push({title:(0,c.t)("dashboard-settings.versions.title","Versions"),id:"versions",icon:"history",component:xo});const hn=(0,c.t)("dashboard-settings.permissions.title","Permissions");return Pt.id&&Pt.meta.canAdmin&&y.TP.hasPermission(f.AccessControlAction.DashboardsPermissionsRead)&&Gt.push({title:hn,id:"permissions",icon:"lock",component:Qt}),Gt.push({title:(0,c.t)("dashboard-settings.json-editor.title","JSON Model"),id:"dashboard_json",icon:"arrow",component:ps}),Gt}function fo(Pt,Gt){return{...Pt,parentItem:Pt.parentItem?fo(Pt.parentItem,Gt):Gt}}function Vr(Pt,Gt,Pn,hn,Ln,Hn){const kn={text:(0,c.t)("dashboard-settings.settings.title","Settings"),children:[],icon:"apps",hideFromBreadcrumbs:!1,url:s.I.getUrlForPartial(Ln,{editview:"settings",editIndex:null})};kn.children=Pn.map(ua=>({text:ua.title,icon:ua.icon,id:`${Hn}/${ua.id}`,url:s.I.getUrlForPartial(Ln,{editview:ua.id,editIndex:null}),active:ua===hn,parentItem:kn,subTitle:ua.subTitle}));const xa=fo(Pt,Gt.node);return kn.parentItem=xa,{main:kn,node:kn.children.find(ua=>ua.active)}}function Oo({dashboard:Pt,sectionNav:Gt}){return t.createElement(p.Y,{navModel:Gt},t.createElement(i.B,{direction:"column",gap:2,alignItems:"flex-start"},t.createElement(u.E,{variant:"h3"},"Dashboard not editable"),t.createElement(m.$n,{type:"submit",onClick:()=>Pt.makeEditable()},"Make editable")))}function vr(Pt){const Gt=new URLSearchParams(Pt.search).get("editIndex");if(Gt!=null)return parseInt(Gt,10)}},10740:(G,I,e)=>{"use strict";e.d(I,{n:()=>w,C:()=>N});var t=e(32196),n=e(96540),s=e(40845),r=e(55852),o=e(94753),m=e(60782),l=e(62930),i=e(56034),u=e(42418),d=e(67061),p=e(10354),c=e(14578),y=e(72109),f=e(29158);const P=({currentPage:V,numberOfPages:K,onNavigate:k,hideWhenSinglePage:j,className:H})=>{const J=(0,s.of)(a);return j&&K<=1?null:n.createElement("div",{className:(0,t.cx)(J.wrapper,H)},n.createElement(f.K,{name:"angle-left",size:"md",tooltip:"Previous",onClick:()=>k(V-1),disabled:V===1}),V," of ",K,n.createElement(f.K,{name:"angle-right",size:"md",tooltip:"Next",onClick:()=>k(V+1),disabled:V===K}))},a=V=>({wrapper:(0,t.css)({display:"flex",flexDirection:"row",gap:16,userSelect:"none"})});var E=e(16817),g=e(65418),h=e(34867),D=e(3169),v=e(3363);const C=(0,h.DW)("features.dashboards.genai");var T=(V=>(V.IDLE="idle",V.GENERATING="generating",V.COMPLETED="completed",V))(T||{});const S=1e4;function O(V=v.C4,K=1){const[k,j]=(0,n.useState)([]),[H,J]=(0,n.useState)(!1),[X,se]=(0,n.useState)(""),[ae,ne]=(0,n.useState)("idle"),[q,ee]=(0,n.useState)(),{error:z}=(0,D._2)();let te="";const ie=(0,n.useCallback)(he=>{ne("idle"),j([]),J(!1),ee(he),z("Failed to generate content using OpenAI","Please try again or if the problem persists, contact your organization admin."),console.error(he),C.logError(he,{messages:JSON.stringify(k),model:V,temperature:String(K)})},[k,V,K,z]);(0,n.useEffect)(()=>{k.length>0&&se("")},[k]);const{error:ce,value:ue}=(0,E.A)(async()=>await(0,v.QX)(),[v.QX]),{error:fe,value:Te}=(0,E.A)(async()=>{if(!ue||!k.length)return{enabled:ue};ne("generating"),ee(void 0);const he=g.qH({model:V,temperature:K,messages:k}).pipe(g.qA());return{enabled:ue,stream:he.subscribe({next:de=>{te=de},error:ie,complete:()=>{se(te),ne("completed"),setTimeout(()=>{ne("idle")}),j([]),J(!1),ee(void 0)}})}},[k,ue]);return(0,n.useEffect)(()=>()=>{Te?.stream&&Te.stream.unsubscribe()},[Te]),(0,n.useEffect)(()=>{H&&(Te?.stream?.unsubscribe(),ne("idle"),J(!1),ee(void 0),j([]))},[H,Te?.stream]),(0,n.useEffect)(()=>{let he;return ae==="generating"&&X===""&&(he=setTimeout(()=>{ie(new Error(`OpenAI stream timed out after ${S}ms`))},S)),()=>{he&&clearTimeout(he)}},[ae,X,ie]),(fe||ce)&&ee(fe||ce),{setMessages:j,setStopGeneration:J,messages:k,reply:X,streamStatus:ae,error:q,value:Te}}const x=({history:V,index:K,reply:k,streamStatus:j,onNavigate:H})=>{const J=(0,s.of)(b),X=V.length,se=()=>k&&j!==T.IDLE?k:V[K-1];return n.createElement(n.Fragment,null,n.createElement("div",{className:J.contentWrapper},n.createElement(o.E,{element:"p",color:"secondary"},se())),n.createElement(P,{currentPage:K,numberOfPages:X,onNavigate:H,hideWhenSinglePage:!1,className:J.paginationWrapper}))},b=V=>({paginationWrapper:(0,t.css)({display:"flex",flexDirection:"row",justifyContent:"flex-end",marginTop:15}),contentWrapper:(0,t.css)({display:"flex",flexBasis:"100%",flexGrow:3,whiteSpace:"pre-wrap",maxHeight:110,overflowY:"scroll",backgroundColor:V.colors.background.secondary,border:`1px solid ${V.colors.border.weak}`,padding:V.spacing(1),minHeight:60})}),M=({onSuggestionClick:V,isGenerating:K})=>{const k=(0,s.of)(A);return n.createElement("div",{className:k.quickSuggestionsWrapper},n.createElement(r.$n,{onClick:()=>V(v.HG.Shorter),size:"sm",variant:"secondary",icon:"paragraph",disabled:K},v.HG.Shorter),n.createElement(r.$n,{onClick:()=>V(v.HG.MoreDescriptive),size:"sm",variant:"secondary",icon:"document-layout-left",disabled:K},v.HG.MoreDescriptive),n.createElement(r.$n,{onClick:()=>V(v.HG.Regenerate),icon:"sync",size:"sm",variant:"secondary",disabled:K},v.HG.Regenerate))},A=V=>({quickSuggestionsWrapper:(0,t.css)({display:"flex",flexDirection:"row",gap:8})});var R=e(57725);const B=.5,U=({eventTrackingSrc:V,history:K,messages:k,onApplySuggestion:j,updateHistory:H})=>{const J=(0,s.of)(W),[X,se]=(0,n.useState)(1),[ae,ne]=(0,n.useState)(!1),[q,ee]=(0,n.useState)(""),{setMessages:z,setStopGeneration:te,reply:ie,streamStatus:ce,error:ue}=O(v.C4,B),fe=ce===T.GENERATING,Te=(Ue,we)=>(0,R.XX)(V,Ue,we);(0,n.useEffect)(()=>{!fe&&ie!==""&&se(1)},[fe,ie]),(0,n.useEffect)(()=>{ce===T.COMPLETED&&H((0,v.Kb)(ie))},[ce,ie,H]),(0,n.useEffect)(()=>{ue&&ne(!0),ce===T.GENERATING&&ne(!1)},[ue,ce]);const he=Ue=>{pe(Ue),Te(R.KR.customFeedback,{customFeedback:Ue})},de=()=>{fe?(te(!0),ie!==""&&H((0,v.Kb)(ie))):j(K[X-1])},le=Ue=>{se(Ue),Te(Ue>X?R.KR.backHistoryItem:R.KR.forwardHistoryItem)},pe=Ue=>{Ue!==v.HG.Regenerate?k=[...k,...(0,v.To)(K[X-1],Ue)]:k=[...k,...(0,v.To)(K[X-1],"Please, regenerate")],z(k),Ue in v.HG&&Te(R.KR.quickFeedback,{quickFeedbackItem:Ue})},ve=Ue=>Ue.key==="Enter"&&he(q),be=Ue=>ee(Ue.currentTarget.value),Oe=()=>he(q),Me=()=>Te(R.KR.linkToDocs);return n.createElement("div",{className:J.container},ae&&n.createElement(u.F,{title:""},n.createElement(d.B,{direction:"column"},n.createElement("p",null,"Sorry, I was unable to complete your request. Please try again."))),n.createElement(x,{history:K,index:X,onNavigate:le,reply:(0,v.Kb)(ie),streamStatus:ce}),n.createElement("div",{className:J.actionButtons},n.createElement(M,{onSuggestionClick:pe,isGenerating:fe})),n.createElement(p.p,{placeholder:"Tell AI what to do next...",suffix:n.createElement(r.$n,{icon:"enter",variant:"secondary",fill:"text","aria-label":"Send custom feedback",onClick:Oe,disabled:q===""},"Send"),value:q,onChange:be,onKeyDown:ve}),n.createElement("div",{className:J.applySuggestion},n.createElement(d.B,{justifyContent:"flex-end",direction:"row"},n.createElement(r.$n,{icon:fe?"fa fa-spinner":"check",onClick:de},fe?N:"Apply"))),n.createElement("div",{className:J.footer},n.createElement(c.I,{name:"exclamation-circle","aria-label":"exclamation-circle",className:J.infoColor}),n.createElement(o.E,{variant:"bodySmall",color:"secondary"},"This content is AI-generated using the"," ",n.createElement(y.Y,{variant:"bodySmall",inline:!0,href:"https://grafana.com/docs/grafana-cloud/alerting-and-irm/machine-learning/llm-plugin/",external:!0,onClick:Me},"Grafana LLM plugin"))))},W=V=>({container:(0,t.css)({display:"flex",flexDirection:"column",width:520,maxHeight:350,paddingBottom:25}),applySuggestion:(0,t.css)({paddingTop:V.spacing(2)}),actions:(0,t.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),footer:(0,t.css)({position:"absolute",bottom:0,left:0,width:"100%",display:"flex",flexDirection:"row",margin:0,padding:V.spacing(1),paddingLeft:V.spacing(2),alignItems:"center",gap:V.spacing(1),borderTop:`1px solid ${V.colors.border.weak}`,marginTop:V.spacing(2)}),infoColor:(0,t.css)({color:V.colors.info.main}),actionButtons:(0,t.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",padding:"24px 0 8px 0"})}),N="Stop generating",w=({text:V="Auto-generate",toggleTipTitle:K="",onClick:k,model:j=v.C4,messages:H,onGenerate:J,temperature:X=1,eventTrackingSrc:se,disabled:ae})=>{const ne=(0,s.of)(L),{setMessages:q,setStopGeneration:ee,reply:z,value:te,error:ie,streamStatus:ce}=O(j,X),[ue,fe]=(0,n.useState)([]),[Te,he]=(0,n.useState)(!1),de=ue.length>0,le=ce===T.GENERATING,pe=!de,ve=ae||te&&!te.enabled&&!ie,be=$e=>(0,R.XX)(se,$e),Oe=$e=>{ce===T.GENERATING?ee(!0):de?he(!0):(k?.($e),q(xe()));const Xe=ie?R.KR.erroredRetryButton:le?R.KR.stopGenerationButton:pe?R.KR.autoGenerateButton:R.KR.improveButton;be(Xe)},Me=(0,n.useCallback)($e=>{ue.indexOf($e)===-1&&fe([$e,...ue])},[ue]);if((0,n.useEffect)(()=>{ce===T.COMPLETED&&z&&J((0,v.Kb)(z))},[ce,z,J]),(0,n.useEffect)(()=>{ce===T.COMPLETED&&Me((0,v.Kb)(z))},[ue,ce,z,Me]),!te?.enabled)return null;const Ue=$e=>{be(R.KR.applySuggestion),J($e),he(!1)},we=()=>{if(!le)return ie||te&&!te?.enabled?"exclamation-circle":"ai"},Re=()=>{let $e=V;return ie&&($e="Retry"),le&&($e=N),de&&($e="Improve"),$e},Fe=n.createElement(r.$n,{icon:we(),onClick:Oe,fill:"text",size:"sm",disabled:ve,variant:ie?"destructive":"primary"},Re()),xe=()=>typeof H=="function"?H():H,Ve=()=>{if(de){const $e=n.createElement(o.E,{element:"p"},K);return n.createElement(m.G,{title:$e,content:n.createElement(U,{history:ue,messages:xe(),onApplySuggestion:Ue,updateHistory:Me,eventTrackingSrc:se}),placement:"left-start",fitContent:!0,show:Te,onClose:()=>he(!1),onOpen:()=>he(!0)},Fe)}return Fe};return n.createElement("div",{className:ne.wrapper},le&&n.createElement(l.y,{size:"sm",className:ne.spinner}),pe?n.createElement(i.m,{show:ie?void 0:!1,interactive:!0,content:"Failed to generate content using OpenAI. Please try again or if the problem persist, contact your organization admin."},Fe):Ve())},L=V=>({wrapper:(0,t.css)({display:"flex"}),spinner:(0,t.css)({color:V.colors.text.link})})},81394:(G,I,e)=>{"use strict";e.d(I,{V:()=>i});var t=e(96540),n=e(14792),s=e(10740),r=e(57725),o=e(3363);const l=`You are an expert in creating Grafana Dashboards.
Your goal is to write a descriptive and concise dashboard description.
You will be given the title and description of the dashboard's panels.
The dashboard description is meant to explain the purpose of the dashboard and what its panels show.
If the dashboard has no panels, the description should be "Empty dashboard"
There should be no numbers in the description except where they are important.
The dashboard description should not have the dashboard title or any quotation marks in it.
The description should be, at most, 300 characters.
Respond with only the description of the dashboard.`,i=({onGenerate:d})=>t.createElement(s.n,{messages:u,onGenerate:d,eventTrackingSrc:r.ec.dashboardDescription,toggleTipTitle:"Improve your dashboard description"});function u(){const d=(0,n.UA)().getCurrent(),p=(0,o.BB)(d);return[{content:l,role:o.Xh.system},{content:`The title of the dashboard is "${d.title}"
${p}`,role:o.Xh.user}]}},27966:(G,I,e)=>{"use strict";e.d(I,{Z:()=>i});var t=e(96540),n=e(14792),s=e(10740),r=e(57725),o=e(3363);const l=`You are an expert in creating Grafana Dashboards.
Your goal is to write a concise dashboard title.
You will be given the title and description of the dashboard's panels.
The dashboard title is meant to say what it shows on one line for users to navigate to it.
If the dashboard has no panels, the title should be "Empty dashboard"
There should be no numbers in the title.
The dashboard title should not have quotation marks in it.
The title should be, at most, 50 characters.
Respond with only the title of the dashboard.`,i=({onGenerate:d})=>t.createElement(s.n,{messages:u,onGenerate:d,eventTrackingSrc:r.ec.dashboardTitle,toggleTipTitle:"Improve your dashboard title"});function u(){const d=(0,n.UA)().getCurrent();return[{content:l,role:o.Xh.system},{content:`The panels in the dashboard are: ${(0,o.BB)(d)}`,role:o.Xh.user}]}},20214:(G,I,e)=>{"use strict";e.d(I,{t:()=>i});var t=e(96540),n=e(14792),s=e(10740),r=e(57725),o=e(3363);const l=`You are an expert in creating Grafana Panels.
You will be given the title and description of the dashboard the panel is in as well as the JSON for the panel.
Your goal is to write a descriptive and concise panel description.
The panel description is meant to explain the purpose of the panel, not just its attributes.
Do not refer to the panel; simply describe its purpose.
There should be no numbers in the description except for thresholds.
The description should be, at most, 200 characters.`,i=({onGenerate:d,panel:p})=>t.createElement(s.n,{messages:()=>u(p),onGenerate:d,eventTrackingSrc:r.ec.panelDescription,toggleTipTitle:"Improve your panel description"});function u(d){const p=(0,n.UA)().getCurrent(),c=(0,o.hn)(d);return[{content:l,role:o.Xh.system},{content:`The panel is part of a dashboard with the title: ${p.title}
The panel is part of a dashboard with the description: ${p.description}
This is the JSON which defines the panel: ${c}`,role:o.Xh.user}]}},74410:(G,I,e)=>{"use strict";e.d(I,{h:()=>l});var t=e(96540),n=e(10740),s=e(57725),r=e(3363);const m="You are an expert in creating Grafana Panels.Your goal is to write short, descriptive, and concise panel title.The title should be shorter than 50 characters.",l=({onGenerate:u,panel:d,dashboard:p})=>t.createElement(n.n,{messages:()=>i(d,p),onGenerate:u,eventTrackingSrc:s.ec.panelTitle,toggleTipTitle:"Improve your panel title"});function i(u,d){const p=(0,r.hn)(u);return[{content:m,role:r.Xh.system},{content:`The panel is part of a dashboard with the title: ${d.title}
The panel is part of a dashboard with the description: ${d.description}
Use this JSON object which defines the panel: ${p}`,role:r.Xh.user}]}},57725:(G,I,e)=>{"use strict";e.d(I,{KR:()=>r,XX:()=>o,ec:()=>s});var t=e(14110);const n="dashboards_autogenerate_clicked";var s=(m=>(m.panelDescription="panel-description",m.panelTitle="panel-title",m.dashboardChanges="dashboard-changes",m.dashboardTitle="dashboard-title",m.dashboardDescription="dashboard-description",m.unknown="unknown",m))(s||{}),r=(m=>(m.autoGenerateButton="auto-generate-button",m.erroredRetryButton="errored-retry-button",m.stopGenerationButton="stop-generating-button",m.improveButton="improve-button",m.backHistoryItem="back-history-item",m.forwardHistoryItem="forward-history-item",m.quickFeedback="quick-feedback",m.linkToDocs="link-to-docs",m.customFeedback="custom-feedback",m.applySuggestion="apply-suggestion",m))(r||{});function o(m,l,i){(0,t.rR)(n,{src:m,item:l,...i})}},3363:(G,I,e)=>{"use strict";e.d(I,{C4:()=>E,HG:()=>a,Xh:()=>P,Yy:()=>h,BB:()=>T,To:()=>C,hn:()=>S,QX:()=>v,Kb:()=>g});var t=e(2543),n=e(65418),s=e(32264),r=e(90254),o=e(34214);function m(O,x){return O===x?x:Array.isArray(O)&&Array.isArray(x)?u(O,x):l(O)&&l(x)?i(O,x):x}function l(O){return typeof O=="object"&&!Array.isArray(O)&&O!==null}function i(O,x){const b=Object.keys(O),M={};for(const A of b)x.hasOwnProperty(A)&&(Array.isArray(O[A])&&Array.isArray(x[A])||typeof O[A]=="object"&&typeof x[A]=="object"?M[A]=m(O[A],x[A]):M[A]=x[A]);return M}function u(O,x){const b=new Array(O.length).fill(void 0),M=new Set([...Array(O.length).keys()]),A=new Set([...Array(x.length).keys()]);for(let R=0;R<O.length&&A.size!==0;R++){let B=O[R];for(let U=0;U<x.length;U++){if(!A.has(U))continue;let W=x[U];W=m(B,W),JSON.stringify(B)===JSON.stringify(W)&&(M.delete(R),A.delete(U),b[R]=W)}}return d(O,x,b,M,A),b.filter(R=>R!==void 0)}function d(O,x,b,M,A){let R={};A.forEach(U=>{let W=x[U];if(typeof W!="object"||Array.isArray(W)){b.push(W),A.delete(U);return}M.forEach(N=>{let w=O[N];if(typeof w!="object"||Array.isArray(w)){M.delete(N);return}let L=0;for(const V in w){let K=w[V];if(!W.hasOwnProperty(V))continue;let k=W[V];typeof K!="string"&&typeof K!="number"||typeof K!=typeof k||K===k&&(V==="id"&&(L+=1e3),L++)}L!==0&&(R[L]===void 0&&(R[L]=[]),R[L].push([N,U]))})});const B=Object.keys(R).map(Number);B.sort((U,W)=>W-U);for(const U of B){let W=R[U];for(const N of W){const[w,L]=N;M.has(w)&&A.has(L)&&(b[w]=x[L],M.delete(w),A.delete(L))}}for(const U of A)b.push(x[U])}function p(O){const x=O.split(`
`);let b=O[0].startsWith("Index")?4:3,M=x.slice(0,b);const A=/("title"|Title|\{|\}|\[|\])/i;for(let R=b;R<x.length;R++){let B=x[R];(A.test(B)||B.startsWith("+")||B.startsWith("-"))&&M.push(B)}return M.join(`
`)+`
`}function c(O){if(O===null||O==="")return null;if(Array.isArray(O)){const b=O.map(M=>c(M)).filter(M=>M!==null);return b.length>0?b:null}if(typeof O!="object")return O;const x={};for(const b in O){const M=c(O[b]);if(M!==null){if(Array.isArray(M)&&M.length===0||typeof M=="object"&&Object.keys(M).length===0)continue;x[b]=M}}return Object.keys(x).length>0?x:null}function y(O){return JSON.parse(JSON.stringify(O,null,2))}function f(O){let x=y(O.getOriginalDashboard()),b=y(new o.G(x).getSaveModelClone()),M=y(O.getSaveModelClone());b=c(m(x,b)),M=c(m(b,M)),x=c(x);let A=(0,r.ss)("Before migration changes","After migration changes",JSON.stringify(x,null,2),JSON.stringify(b,null,2),"","",{context:20}),R=(0,r.ss)("Before user changes","After user changes",JSON.stringify(b,null,2),JSON.stringify(M,null,2),"","",{context:20});return A=p(A),R=p(R),{migrationDiff:A,userDiff:R}}var P=(O=>(O.system="system",O.user="user",O))(P||{}),a=(O=>(O.Shorter="Even shorter",O.MoreDescriptive="More descriptive",O.Regenerate="Regenerate",O))(a||{});const E="gpt-4",g=O=>O.replace(/^"|"$/g,"");function h(O){const{migrationDiff:x,userDiff:b}=f(O);return{userChanges:b,migrationChanges:x}}let D;async function v(){return s.$.apps["grafana-llm-app"]?D||(D=new Promise(O=>{n.vK().then(x=>{x.ok||(D=void 0),O(x.ok)})}),D):!1}const C=(O,x)=>[{role:"system",content:`Your previous response was: ${O}. The user has provided the following feedback: ${x}. Re-generate your response according to the provided feedback.`}];function T(O){const x=(A,R)=>`- Panel ${R}
- Title: ${A.title}${A.description?`
- Description: ${A.description}`:""}`,b=O.panels.map(x);let M;if(b.length<=10)M=`The panels in the dashboard are:
${b.join(`
`)}`;else{const A=O.panels.filter(U=>U.description),R=O.panels.filter(U=>!U.description);let B;A.length>=10?B=A.slice(10).map(x).join(`
`):(B=A.map(x).join(`
`),B+=`
`,B+=R.slice(10-A.length).map(x).join("n")),M=`There are ${b.length} panels.
Due to space constraints, only the information for ten of them is presented.
These ten are not necessarily the first ten, but prioritized to those with descriptions.
The panels in the dashboard are:
${B}`}return M}function S(O){const x=["datasource","title","description","targets","type"],b={...(0,t.pick)(O,x),options:(0,t.pick)(O.options,["content"])};return JSON.stringify(b,null,2)}},18803:(G,I,e)=>{"use strict";e.d(I,{B6:()=>p,E_:()=>y,jD:()=>c});var t=e(2543),n=e.n(t),s=e(72985),r=e(89667),o=e(52622),m=e(72724),l=e(39070),i=e(32264),u=e(41524),d=e(68706);function p(g){const h=[];if(g?.series)for(const D of g.series)h.push((0,r.Nw)(D));if(g?.annotations)for(const D of g.annotations){const v=(0,r.Nw)(D);v.schema?.meta||(v.schema.meta={}),v.schema.meta.dataTopic=o.QR.Annotations,h.push(v)}return h}function c(g,h){const D=g.getSaveModel(),v={panelType:D.type,datasource:"??"},C=i.$.buildInfo.versionString;let T=`| Key | Value |
|--|--|
| Panel | ${v.panelType} @ ${D.pluginVersion??C} |
| Grafana | ${C} // ${i.$.buildInfo.edition} |
`;return h&&(T+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+h+"\n```\n</details>"),T}async function y(g,h,D){const v=g.getSaveModel(),C=(0,t.cloneDeep)(E),T={panelType:v.type,datasource:"??"},S=await(0,s._)(g.getQueryRunner().getData({withFieldConfig:!1,withTransforms:!1})),O=g.datasource,x=(0,u.W)(p(S),h),b=i.$.buildInfo.versionString,M=v?.targets??[],A=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${T.panelType} @ ${v.pluginVersion??b}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${M.map(R=>{const B=R.datasource??O;return`${R.refId}[${B?.type}]`}).join(", ")}</td>
    </tr>
    ${f(v)}
    ${P(S,x)}
    ${a(S)}
    <tr>
      <th>Grafana</th>
      <td>${b} // ${i.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(C.panels[0]={...v,...C.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:d.nj.Snapshot,snapshot:x}]},v.transformations?.length){const R=C.panels[C.panels.length-1];R.title=R.title+" (after transformations)";const B=(0,t.cloneDeep)(R);B.id=100,B.title="Data (before transformations)",B.gridPos.w=24,B.targets[0].withTransforms=!1,C.panels.push(B)}return S.annotations?.length&&C.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:o.QR.Annotations,refId:"A"}]}),C.panels[1].options.content=A,C.panels[2].options.content=JSON.stringify(v,null,2),C.title=`Debug: ${v.title} // ${(0,m.LE)(new Date)}`,C.tags=["debug",`debug-${T.panelType}`],C.time={from:D.from.toISOString(),to:D.to.toISOString()},C}function f(g){return g.transformations?`<tr>
      <th>Transform</th>
      <td>${g.transformations.map(h=>h.id).join(", ")}</td>
  </tr>`:""}function P(g,h){let D=g.series.length??0,v=0,C=0;for(const T of g.series)v+=T.fields.length,C+=T.length;return`<tr><th>Data</th><td>${g.state!==l.Gu.Done?g.state:""} ${D} frames, ${v} fields, ${C} rows </td></tr>`}function a(g){return g.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${g.annotations.map((h,D)=>`<span>${h.length}</span>`)}</td>
</tr>`:""}const E={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37}},65123:(G,I,e)=>{"use strict";e.d(I,{BN:()=>i,kx:()=>u,sd:()=>l});var t=e(96540),n=e(24705),s=e(19347),r=e(8484),o=e(16560),m=e(54612);const l=d=>(0,n.A)(async()=>i(d),[d]).value;async function i(d){const p=d?.request?.targets||[];if(d&&d.series&&p.length){for(const c of d.series)if(c.meta&&c.meta.custom){const y=await(0,s.l)().get(p[0].datasource);if(y&&y.components?.MetadataInspector)return y}}}const u=(d,p,c,y,f)=>(0,t.useMemo)(()=>{const P=[];return(0,m.$)(c)&&(P.push({label:(0,r.t)("dashboard.inspect.data-tab","Data"),value:o.q.Data}),P.push({label:(0,r.t)("dashboard.inspect.stats-tab","Stats"),value:o.q.Stats})),f&&P.push({label:(0,r.t)("dashboard.inspect.meta-tab","Meta data"),value:o.q.Meta}),P.push({label:(0,r.t)("dashboard.inspect.json-tab","JSON"),value:o.q.JSON}),y&&P.push({label:(0,r.t)("dashboard.inspect.error-tab","Error"),value:o.q.Error}),p.meta.canEdit&&(0,m.$)(c)&&P.push({label:(0,r.t)("dashboard.inspect.query-tab","Query"),value:o.q.Query}),P},[c,f,p,y])},57755:(G,I,e)=>{"use strict";e.d(I,{D:()=>p});var t=e(32196),n=e(96540),s=e(78685),r=e(13544),o=e(53402),m=e(40845),l=e(55852),i=e(83277),u=e(53466);const d="showCategory",p=n.memo(({id:f,title:P,children:a,forceOpen:E,isOpenDefault:g=!0,renderTitle:h,className:D,itemsCount:v,isNested:C=!1,sandboxId:T})=>{const[S,O]=(0,s.A)(y(f),{isExpanded:g}),[x,b]=(0,n.useState)(S?.isExpanded??g),M=(0,n.useRef)(0),A=(0,n.useRef)(null),[R,B]=(0,i.s)(),U=R[d]===f;(0,n.useEffect)(()=>{M.current&&Date.now()-M.current<200||(U||E)&&(x||b(!0),U&&A.current?.scrollIntoView())},[E,x,U]);const W=(0,n.useCallback)(()=>{M.current=Date.now(),B({[d]:x?void 0:f},!0),O({isExpanded:!x}),b(!x)},[O,b,B,x,f]);h||(h=function(k){return k||v===void 0||v===0?P:n.createElement("span",null,P," ",n.createElement(o.p,{value:v}))});const N=(0,m.of)(c),w=(0,t.cx)({[N.box]:!0,[N.boxNestedExpanded]:C&&x},D),L=(0,t.cx)(N.header,{[N.headerExpanded]:x,[N.headerNested]:C}),V=(0,t.cx)(N.body,{[N.bodyNested]:C});return n.createElement("div",{className:w,"data-plugin-sandbox":T,"data-testid":r.Tp.components.OptionsGroup.group(f),ref:A},n.createElement("div",{className:L,onClick:W},n.createElement(l.$n,{"data-testid":r.Tp.components.OptionsGroup.toggle(f),type:"button",fill:"text",size:"sm",variant:"secondary","aria-expanded":x,className:N.toggleButton,icon:x?"angle-down":"angle-right",onClick:W}),n.createElement("h6",{id:`button-${f}`,className:N.title},h(x))),x&&n.createElement("div",{className:V,id:f,"aria-labelledby":`button-${f}`},a))});p.displayName="OptionsPaneCategory";const c=f=>({box:(0,t.css)({borderTop:`1px solid ${f.colors.border.weak}`}),boxNestedExpanded:(0,t.css)({marginBottom:f.spacing(2)}),title:(0,t.css)({flexGrow:1,overflow:"hidden",lineHeight:1.5,fontSize:"1rem",paddingLeft:"6px",fontWeight:f.typography.fontWeightMedium,margin:0}),header:(0,t.css)({display:"flex",cursor:"pointer",alignItems:"center",padding:f.spacing(.5),color:f.colors.text.primary,fontWeight:f.typography.fontWeightMedium,"&:hover":{background:f.colors.emphasize(f.colors.background.primary,.03)}}),toggleButton:(0,t.css)({alignSelf:"baseline"}),headerExpanded:(0,t.css)({color:f.colors.text.primary}),headerNested:(0,t.css)({padding:f.spacing(.5,0,.5,0)}),body:(0,t.css)({padding:f.spacing(1,2,1,4)}),bodyNested:(0,t.css)({position:"relative",paddingRight:0,"&:before":{content:"''",position:"absolute",top:0,left:"8px",width:"1px",height:"100%",background:f.colors.border.weak}})}),y=f=>`${u.wi}.optionGroup[${f}]`},48192:(G,I,e)=>{"use strict";e.d(I,{C:()=>s});var t=e(96540),n=e(57755);class s{constructor(o){this.props=o,this.items=[],this.categories=[]}addItem(o){return o.parent=this,this.items.push(o),this}addCategory(o){return o.props.isNested=!0,o.parent=this,this.categories.push(o),this}getCategory(o){let m=this.categories.find(l=>l.props.id===o);return m||(m=new s({title:o,id:o}),this.addCategory(m)),m}render(o){return this.props.customRender?this.props.customRender():t.createElement(n.D,{key:this.props.title,...this.props},this.items.map(m=>m.render(o)),this.categories.map(m=>m.render(o)))}}},74097:(G,I,e)=>{"use strict";e.d(I,{v:()=>c});var t=e(32196),n=e(96540),s=e(23257),r=e.n(s),o=e(13544),m=e(60029),l=e(88575),i=e(40845),u=e(56034);function d({overrides:P}){const a=(0,i.of)(p);return n.createElement("div",{className:a.wrapper},P.map((E,g)=>n.createElement(u.m,{content:E.tooltip,key:g.toString(),placement:"top"},n.createElement("div",{"aria-label":E.description,className:a[E.type]}))))}const p=P=>{const a={width:8,height:8,borderRadius:P.shape.radius.circle,marginLeft:P.spacing(1),top:"-1px"};return{wrapper:(0,t.css)({display:"flex"}),rule:(0,t.css)({...a,position:"relative",backgroundColor:P.colors.primary.main}),data:(0,t.css)({...a,position:"relative",backgroundColor:P.colors.warning.main})}};class c{constructor(a){this.props=a}getLabel(a){const{title:E,description:g,overrides:h,addon:D}=this.props;if(!a)return this.parent.props.title===E&&!h?.length?null:n.createElement(y,{title:E,description:g,overrides:h,addon:D});const v=[];return this.parent.parent&&v.push(this.highlightWord(this.parent.parent.props.title,a)),this.parent.props.title!==E&&v.push(this.highlightWord(this.parent.props.title,a)),n.createElement(m.J,{description:g&&this.highlightWord(g,a),category:v},this.highlightWord(E,a),h&&h.length>0&&n.createElement(d,{overrides:h}))}highlightWord(a,E){return n.createElement(r(),{textToHighlight:a,searchWords:[E],highlightClassName:"search-fragment-highlight"})}renderOverrides(){const{overrides:a}=this.props;!a||a.length}render(a){const{title:E,description:g,render:h,showIf:D,skipField:v}=this.props,C=`${this.parent.props.id} ${E}`;return D&&!D()?null:v?h():n.createElement(l.D,{label:this.getLabel(a),description:g,key:C,"aria-label":o.Tp.components.PanelEditor.OptionsPane.fieldLabel(C)},h())}}function y({title:P,description:a,overrides:E,addon:g}){const h=(0,i.of)(f);return n.createElement("div",{className:h.container},n.createElement(m.J,{description:a},P,E&&E.length>0&&n.createElement(d,{overrides:E})),g)}function f(P){return{container:(0,t.css)({display:"flex",justifyContent:"space-between"})}}},26443:(G,I,e)=>{"use strict";e.d(I,{gs:()=>ne,Ff:()=>se,Po:()=>q});var t=e(32196),n=e(96540),s=e(32264),r=e(40845),o=e(67647),m=e(94354),l=e(40276),i=e(74106),u=e(82792),d=e(71468),p=e(7376),c=e(79971),y=e(40334),f=e(33390);function P(z,te){f.A.set(`panel-edit-section-${z}`,te?"true":"false")}function a(z,te){return f.A.getBool(`panel-edit-section-${z}`,te)}const E=(z,te)=>({angularPanelComponent:(0,y.U)(z,te.panel)?.angularComponent}),g={changePanelPlugin:c.gW},h=(0,d.connect)(E,g);class D extends n.PureComponent{constructor(te){super(te)}componentDidMount(){this.loadAngularOptions()}componentDidUpdate(te){(this.props.plugin!==te.plugin||this.props.angularPanelComponent!==te.angularPanelComponent)&&this.cleanUpAngularOptions(),this.loadAngularOptions()}componentWillUnmount(){this.cleanUpAngularOptions()}cleanUpAngularOptions(){this.angularOptions&&(this.angularOptions.destroy(),this.angularOptions=null)}loadAngularOptions(){const{panel:te,angularPanelComponent:ie,changePanelPlugin:ce}=this.props;if(!this.element||!ie||this.angularOptions)return;const ue=ie.getScope();if(!ue.$$childHead){setTimeout(()=>{this.forceUpdate()});return}const fe=ue.$$childHead.ctrl;fe.initEditMode(),fe.onPluginTypeChange=le=>{ce({panel:te,pluginId:le.id})};let Te="";for(let le=0;le<fe.editorTabs.length;le++){const pe=fe.editorTabs[le];pe.isOpen=a(pe.title,le===0),Te+=`
      <div class="panel-options-group" ng-cloak>
        <div class="panel-options-group__header" ng-click="toggleOptionGroup(${le})" aria-label="${pe.title} section">
          <div class="panel-options-group__icon">
            <icon name="ctrl.editorTabs[${le}].isOpen ? 'angle-down' : 'angle-right'"></icon>
          </div>
          <div class="panel-options-group__title">${pe.title}</div>
        </div>
        <div class="panel-options-group__body" ng-if="ctrl.editorTabs[${le}].isOpen">
          <panel-editor-tab editor-tab="ctrl.editorTabs[${le}]" ctrl="ctrl"></panel-editor-tab>
        </div>
      </div>
      `}const he=(0,p.E)(),de={ctrl:fe,toggleOptionGroup:le=>{const pe=fe.editorTabs[le];pe.isOpen=!pe.isOpen,P(pe.title,!!pe.isOpen)}};this.angularOptions=he.load(this.element,de,Te),this.angularOptions.digest()}render(){return n.createElement("div",{ref:te=>this.element=te})}}const v=(0,d.connect)(E,g)(D);var C=e(57755),T=e(22290),S=e(10354);const O=({panel:z,formatDate:te})=>{const ie=(0,r.of)(x),ce=z.libraryPanel?.meta;return ce?n.createElement("div",{className:ie.info},n.createElement("div",{className:ie.libraryPanelInfo},`Used on ${ce.connectedDashboards} `,ce.connectedDashboards===1?"dashboard":"dashboards"),n.createElement("div",{className:ie.libraryPanelInfo},"Last edited on ",te?.(ce.updated,"L")??ce.updated," by",ce.updatedBy.avatarUrl&&n.createElement("img",{width:"22",height:"22",className:ie.userAvatar,src:ce.updatedBy.avatarUrl,alt:`Avatar for ${ce.updatedBy.name}`}),ce.updatedBy.name)):null},x=z=>({info:(0,t.css)`
      line-height: 1;
    `,libraryPanelInfo:(0,t.css)`
      color: ${z.colors.text.secondary};
      font-size: ${z.typography.bodySmall.fontSize};
    `,userAvatar:(0,t.css)`
      border-radius: ${z.shape.radius.circle};
      box-sizing: content-box;
      width: 22px;
      height: 22px;
      padding-left: ${z.spacing(1)};
      padding-right: ${z.spacing(1)};
    `});var b=e(48192),M=e(74097);function A(z){const{panel:te,onPanelConfigChange:ie,dashboard:ce}=z,ue=new b.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return(0,u.X)(te)&&ue.addItem(new M.v({title:"Name",value:te.libraryPanel.name,popularRank:1,render:function(){return n.createElement(S.p,{id:"LibraryPanelFrameName",defaultValue:te.libraryPanel.name,onBlur:Te=>ie("libraryPanel",{...te.libraryPanel,name:Te.currentTarget.value})})}})).addItem(new M.v({title:"Information",render:function(){return n.createElement(O,{panel:te,formatDate:ce.formatDate})}})),ue}var R=e(13544),B=e(21744),U=e(15292),W=e(64919),N=e(21594),w=e(6923),L=e(20214),V=e(74410),K=e(92378);function k(z){const{dashboard:te,panel:ie,onPanelConfigChange:ce}=z,ue=new b.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),fe=he=>{const de=document.getElementById("PanelFrameTitle");de instanceof HTMLInputElement&&(de.value=he,ce("title",he))},Te=he=>{const de=document.getElementById("description-text-area");de instanceof HTMLTextAreaElement&&(de.value=he,ce("description",he))};return ue.addItem(new M.v({title:"Title",value:ie.title,popularRank:1,render:function(){return n.createElement(S.p,{"data-testid":R.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),id:"PanelFrameTitle",defaultValue:ie.title,onBlur:de=>ce("title",de.currentTarget.value)})},addon:s.$.featureToggles.dashgpt&&n.createElement(V.h,{onGenerate:fe,panel:ie.getSaveModel(),dashboard:te.getSaveModelClone()})})).addItem(new M.v({title:"Description",description:ie.description,value:ie.description,render:function(){return n.createElement(B.f,{"data-testid":R.Tp.components.PanelEditor.OptionsPane.fieldInput("Description"),id:"description-text-area",defaultValue:ie.description,onBlur:de=>ce("description",de.currentTarget.value)})},addon:s.$.featureToggles.dashgpt&&n.createElement(L.t,{onGenerate:Te,panel:ie.getSaveModel()})})).addItem(new M.v({title:"Transparent background",render:function(){return n.createElement(U.d,{"data-testid":R.Tp.components.PanelEditor.OptionsPane.fieldInput("Transparent background"),value:ie.transparent,id:"transparent-background",onChange:de=>ce("transparent",de.currentTarget.checked)})}})).addCategory(new b.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:ie.links?.length}).addItem(new M.v({title:"Panel links",render:function(){return n.createElement(W.e,{links:ie.links,onChange:de=>ce("links",de),getSuggestions:w.Fq,data:[]})}}))).addCategory(new b.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new M.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return n.createElement(K.G,{id:"repeat-by-variable-select",repeat:ie.repeat,onChange:de=>{ce("repeat",de)}})}})).addItem(new M.v({title:"Repeat direction",showIf:()=>!!ie.repeat,render:function(){const de=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return n.createElement(m.z,{options:de,value:ie.repeatDirection||"h",onChange:le=>ce("repeatDirection",le)})}})).addItem(new M.v({title:"Max per row",showIf:()=>!!(ie.repeat&&ie.repeatDirection==="h"),render:function(){const de=[2,3,4,6,8,12].map(le=>({label:le.toString(),value:le}));return n.createElement(N.l6,{options:de,value:ie.maxPerRow,onChange:le=>ce("maxPerRow",le.value)})}})))}var j=e(66211);class H{constructor(te,ie){this.categories=te,this.overrides=ie}search(te){const ie=new RegExp(te,"i"),ue=this.collectHits(this.categories,ie,[]).sort(J).map(he=>he.item),Te=this.collectHits(this.overrides,ie,[]).sort(J).map(he=>he.item);return{optionHits:ue,overrideHits:this.buildOverrideHitCategories(Te),totalCount:this.getAllOptionsCount(this.categories)}}collectHits(te,ie,ce){for(const ue of te){const fe=ie.test(ue.props.title);for(const Te of ue.items){if(ie.test(Te.props.title)){ce.push({item:Te,rank:1});continue}if(Te.props.description&&ie.test(Te.props.description)){ce.push({item:Te,rank:2});continue}fe&&ce.push({item:Te,rank:3})}ue.categories.length>0&&this.collectHits(ue.categories,ie,ce)}return ce}getAllOptionsCount(te){let ie=0;for(const ce of te)ie+=ce.items.length,ce.categories.length>0&&(ie+=this.getAllOptionsCount(ce.categories));return ie}buildOverrideHitCategories(te){const ie={};for(const ce of te){let ue=ie[ce.parent.props.title];ue||(ue=ie[ce.parent.props.title]=new b.C(ce.parent.props),ue.addItem(ce.parent.items[0])),ue.items[0].props.title!==ce.props.title&&ue.addItem(ce)}return Object.values(ie)}}function J(z,te){return z.rank-te.rank}function X(z){const te=[];for(const ie of z)for(const ce of ie.items)ce.props.title==="Unit"&&(ce.props.popularRank=2),ce.props.title==="Min"&&(ce.props.popularRank=3),ce.props.title==="Max"&&(ce.props.popularRank=4),ce.props.title==="Display name"&&(ce.props.popularRank=5),ce.props.popularRank&&te.push(ce);return te.sort((ie,ce)=>ie.props.popularRank-ce.props.popularRank)}const se=z=>{const{plugin:te,dashboard:ie,panel:ce}=z,[ue,fe]=(0,n.useState)(""),[Te,he]=(0,n.useState)("All"),de=(0,r.of)(ee),[le,pe,ve]=(0,n.useMemo)(()=>[k(z),(0,j.Zm)(z),A(z)],[ce.configRev,z.data,z.instanceState,ue]),be=(0,n.useMemo)(()=>(0,T.v)(z.panel.fieldConfig,z.plugin.fieldConfigRegistry,z.data?.series??[],ue,z.onFieldConfigsChange),[ce.configRev,z.data,z.instanceState,ue]),Oe=[],Me=ue.length>0,Ue=(0,n.useMemo)(ae,[]),we=(0,u.X)(ce)?[ve,le,...pe]:[le,...pe];if(Me)Oe.push(q(we,be,ue)),z.plugin.angularPanelCtrl&&Oe.push(n.createElement("div",{className:de.searchNotice,key:"Search notice"},"This is an old visualization type that does not support searching all options."));else switch(Te){case"All":(0,u.X)(ce)&&Oe.push(ve.render()),Oe.push(le.render()),z.plugin.angularPanelCtrl&&Oe.push(n.createElement(v,{plugin:te,dashboard:ie,panel:ce,key:"AngularOptions"}));for(const Fe of pe)Oe.push(Fe.render());for(const Fe of be)Oe.push(Fe.render());break;case"Overrides":for(const Fe of be)Oe.push(Fe.render());break;case"Recent":Oe.push(n.createElement(C.D,{id:"Recent options",title:"Recent options",key:"Recent options",forceOpen:1},X(we).map(Fe=>Fe.render())));break}const Re=!Me&&!te.fieldConfigRegistry.isEmpty();return n.createElement("div",{className:de.wrapper},n.createElement("div",{className:de.formBox},ce.isAngularPlugin()&&!te.meta.angular?.hideDeprecation&&n.createElement(i.c,{className:de.angularDeprecationWrapper,showPluginDetailsLink:!0,pluginId:te.meta.id,pluginType:te.meta.type,angularSupportEnabled:s.$?.angularSupportEnabled,interactionElementId:"panel-options"}),n.createElement("div",{className:de.formRow},n.createElement(o.Z,{width:0,value:ue,onChange:fe,placeholder:"Search options"})),Re&&n.createElement("div",{className:de.formRow},n.createElement(m.z,{options:Ue,value:Te,fullWidth:!0,onChange:he}))),n.createElement("div",{className:de.scrollWrapper},n.createElement(l.E,{autoHeightMin:"100%"},n.createElement("div",{className:de.mainBox},Oe))))};function ae(){return[{label:"All",value:"All"},{label:"Overrides",value:"Overrides"}]}var ne=(z=>(z.All="All",z.Overrides="Overrides",z.Recent="Recent",z))(ne||{});function q(z,te,ie){const ce=new H(z,te),{optionHits:ue,totalCount:fe,overrideHits:Te}=ce.search(ie);return n.createElement("div",{key:"search results"},n.createElement(C.D,{id:"Found options",title:`Matched ${ue.length}/${fe} options`,key:"Normal options",forceOpen:1},ue.map(he=>he.render(ie))),Te.map(he=>he.render(ie)))}const ee=z=>({wrapper:(0,t.css)({height:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",".search-fragment-highlight":{color:z.colors.warning.text,background:"transparent"}}),searchBox:(0,t.css)({display:"flex",flexDirection:"column",minHeight:0}),formRow:(0,t.css)({marginBottom:z.spacing(1)}),formBox:(0,t.css)({padding:z.spacing(1),background:z.colors.background.primary,border:`1px solid ${z.components.panel.borderColor}`,borderTopLeftRadius:z.shape.borderRadius(1.5),borderBottom:"none"}),closeButton:(0,t.css)({marginLeft:z.spacing(1)}),searchHits:(0,t.css)({padding:z.spacing(1,1,0,1)}),scrollWrapper:(0,t.css)({flexGrow:1,minHeight:0}),searchNotice:(0,t.css)({fontSize:z.typography.size.sm,color:z.colors.text.secondary,padding:z.spacing(1),textAlign:"center"}),mainBox:(0,t.css)({background:z.colors.background.primary,border:`1px solid ${z.components.panel.borderColor}`,borderTop:"none",flexGrow:1}),angularDeprecationWrapper:(0,t.css)({padding:z.spacing(1)})})},22290:(G,I,e)=>{"use strict";e.d(I,{v:()=>O});var t=e(32196),n=e(2543),s=e(96540),r=e(85200),o=e(37055),m=e(84349),l=e(51986),i=e(40845),u=e(6923),d=e(23257),p=e.n(d),c=e(66864),y=e(60029),f=e(53402),P=e(29158),a=e(88575),E=e(57755);const g=({property:A,context:R,registry:B,onChange:U,onRemove:W,isSystemOverride:N,searchQuery:w})=>{const L=(0,i.of)(h),V=B?.getIfExists(A.id),K=(0,s.useId)();if(!V)return null;const k=Array.isArray(A.value)||A.id===o.uo.Thresholds||A.id===o.uo.Links||A.id===o.uo.Mappings,j=V.category?.filter(X=>X!==V.name);let H;const J=(X=!0,se=!1)=>(ae=!1)=>s.createElement(c.Gy,{justify:"space-between"},s.createElement(y.J,{category:j,description:X?V.description:void 0,htmlFor:K},s.createElement(p(),{textToHighlight:V.name,searchWords:[w],highlightClassName:"search-fragment-highlight"}),!ae&&se&&V.getItemsCount&&s.createElement(f.p,{value:V.getItemsCount(A.value)})),!N&&s.createElement("div",null,s.createElement(P.K,{name:"times",onClick:W,tooltip:"Remove label"})));return k?H=s.createElement(E.D,{id:V.name,renderTitle:J(!1,!0),className:(0,t.css)({paddingLeft:0,paddingRight:0}),isNested:!0,isOpenDefault:A.value!==void 0},s.createElement(V.override,{value:A.value,onChange:X=>{U(X)},item:V,context:R})):H=s.createElement("div",null,s.createElement(a.D,{label:J()(),description:V.description},s.createElement(V.override,{value:A.value,onChange:X=>{U(X)},item:V,context:R,id:K}))),s.createElement("div",{className:(0,t.cx)(k&&L.collapsibleOverrideEditor,!k&&"dynamicConfigValueEditor--nonCollapsible")},H)},h=A=>({collapsibleOverrideEditor:(0,t.css)({label:"collapsibleOverrideEditor","& + .dynamicConfigValueEditor--nonCollapsible":{marginTop:A.spacing(1)}})});var D=e(48192),v=e(74097),C=e(14578);const T=({isExpanded:A,registry:R,matcherUi:B,overrideName:U,override:W,onOverrideRemove:N})=>{const w=(0,i.of)(S),V=W.properties.map(k=>R.getIfExists(k.id)).filter(k=>!!k).map(k=>k?.name).join(", "),K=B.optionsToLabel(W.matcher.options);return s.createElement("div",null,s.createElement(c.Gy,{justify:"space-between"},s.createElement("div",null,U),s.createElement(P.K,{name:"trash-alt",onClick:N,tooltip:"Remove override"})),!A&&s.createElement("div",{className:w.overrideDetails},s.createElement("div",{className:w.options,title:K},K," ",s.createElement(C.I,{name:"angle-right"})," ",V)))};T.displayName="OverrideTitle";const S=A=>({matcherUi:(0,t.css)({padding:A.spacing(1)}),propertyPickerWrapper:(0,t.css)({marginTop:A.spacing(2)}),overrideDetails:(0,t.css)({fontSize:A.typography.bodySmall.fontSize,color:A.colors.text.secondary,fontWeight:A.typography.fontWeightRegular}),options:(0,t.css)({overflow:"hidden",paddingRight:A.spacing(4)}),unknownLabel:(0,t.css)({marginBottom:0})});function O(A,R,B,U,W){const N=[],w=A;if(!R||R.isEmpty())return[];const L=(j,H)=>{let J=(0,n.cloneDeep)(w.overrides);J[j]=H,W({...w,overrides:J})},V=j=>{let H=(0,n.cloneDeep)(w.overrides);H.splice(j,1),W({...w,overrides:H})},K=j=>{const H=r.sJ.get(j.value);H&&W({...w,overrides:[...w.overrides,{matcher:{id:H.id,options:H.defaultOptions},properties:[]}]})},k={data:B,getSuggestions:j=>(0,u.Hf)(B,j),isOverride:!0};for(let j=0;j<w.overrides.length;j++){const H=w.overrides[j],J=`Override ${j+1}`,X=m.g.get(H.matcher.id),se=x(R),ae=(0,o.Ow)(H),ne=H.properties.length===0?1:0,q=new D.C({title:J,id:J,forceOpen:ne,renderTitle:function(ie){return s.createElement(T,{override:H,isExpanded:ie,registry:R,overrideName:J,matcherUi:X,onOverrideRemove:()=>V(j)})}}),ee=te=>{H.matcher.options=te,L(j,H)},z=(te,ie)=>{const ce=R.get(ie.value),ue={id:ce.id,value:ce.defaultValue};H.properties?te.properties.push(ue):te.properties=[ue],L(j,te)};q.addItem(new v.v({title:X.name,render:function(){return s.createElement(X.component,{id:`${X.matcher.id}-${j}`,matcher:X.matcher,data:B??[],options:H.matcher.options,onChange:ee})}}));for(let te=0;te<H.properties.length;te++){const ie=H.properties[te],ce=R.getIfExists(ie.id);if(!ce)continue;const ue=Te=>{H.properties[te].value=Te,L(j,H)},fe=()=>{H.properties.splice(te,1),L(j,H)};q.addItem(new v.v({title:ce.name,skipField:!0,render:function(){return s.createElement(g,{key:`${ie.id}/${te}`,isSystemOverride:ae,onChange:ue,onRemove:fe,property:ie,registry:R,context:k,searchQuery:U})}}))}!ae&&H.matcher.options&&q.addItem(new v.v({title:"----------",skipField:!0,render:function(){return s.createElement(l.i,{key:"Add override property",label:"Add override property",variant:"secondary",isFullWidth:!0,icon:"plus",menuPlacement:"auto",options:se,onChange:ie=>z(H,ie)})}})),N.push(q)}return N.push(new D.C({title:"add button",id:"add button",customRender:function(){return s.createElement(b,{key:"Add override"},s.createElement(l.i,{icon:"plus",label:"Add field override",variant:"secondary",menuPlacement:"auto",isFullWidth:!0,size:"md",options:m.g.list().filter(H=>!H.excludeFromPicker).map(H=>({label:H.name,value:H.id,description:H.description})),onChange:H=>K(H)}))}})),N}function x(A){return A.list().filter(R=>!R.hideFromOverrides).map(R=>{let B=R.name;return R.category&&(B=[...R.category,R.name].join(" > ")),{label:B,value:R.id,description:R.description}})}function b({children:A}){const R=(0,i.of)(M);return s.createElement("div",{className:R},A)}function M(A){return(0,t.css)({borderTop:`1px solid ${A.colors.border.weak}`,padding:`${A.spacing(2)}`,display:"flex"})}},66211:(G,I,e)=>{"use strict";e.d(I,{g5:()=>v,tN:()=>h,Zm:()=>g,Z4:()=>D});var t=e(2543),n=e(96540),s=e(60264),r=e(10354),o=e(32196),m=e(72724),l=e(40845);const i=({libraryPanel:C})=>{const T=(0,l.of)(u),S=C.useState(),O=S.$timeRange?.getTimeZone(),x=S._loadedPanel?.meta;return x?n.createElement("div",{className:T.info},n.createElement("div",{className:T.libraryPanelInfo},`Used on ${x.connectedDashboards} `,x.connectedDashboards===1?"dashboard":"dashboards"),n.createElement("div",{className:T.libraryPanelInfo},(0,m.LE)(x.updated,{format:"L",timeZone:O})," by",x.updatedBy.avatarUrl&&n.createElement("img",{className:T.userAvatar,src:x.updatedBy.avatarUrl,alt:`Avatar for ${x.updatedBy.name}`}),x.updatedBy.name)):null},u=C=>({info:(0,o.css)({lineHeight:1}),libraryPanelInfo:(0,o.css)({color:C.colors.text.secondary,fontSize:C.typography.bodySmall.fontSize}),userAvatar:(0,o.css)({borderRadius:C.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:C.spacing(1),paddingRight:C.spacing(1)})});var d=e(6923),p=e(48192),c=e(74097);const y="Some data fields have this option pre-configured. Add a field override rule to override the pre-configured value.",f="An override rule exists for this property";function P(C,T,S){const O=[];if(S){for(const b of S)for(const M of b.fields)if((0,t.get)(M.config,C.path)!=null){O.push({type:"data",description:y,tooltip:y});break}}return T.overrides.some(b=>b.properties.some(M=>M.id===C.id))&&O.push({type:"rule",description:f,tooltip:f}),O}var a=e(54612);function E({data:C,replaceVariables:T,options:S,eventBus:O,instanceState:x}){const b=C?.series??[];return{data:b,replaceVariables:T,options:S,eventBus:O,getSuggestions:A=>(0,d.Hf)(b,A),instanceState:x}}function g(C){const{plugin:T,panel:S,onPanelOptionsChanged:O,onFieldConfigsChange:x,data:b,dashboard:M,instanceState:A}=C,R=S.getOptions(),B=S.fieldConfig,U={},W=E({data:b,replaceVariables:S.replaceVariables,options:R,eventBus:M.events,instanceState:A}),N=L=>{const V=(L&&L[0])??`${T.meta.name}`,K=U[V];return K||(U[V]=new p.C({title:V,id:V,sandboxId:T.meta.id}))},w={getValue:L=>(0,t.get)(R,L),onChange:(L,V)=>{const K=(0,a.Sf)(R,L,V);O(K)}};v(T.getPanelOptionsSupplier(),w,N,W);for(const L of T.fieldConfigRegistry.list()){if(L.isCustom){if(L.showIf&&!L.showIf(B.defaults.custom,b?.series))continue}else if(L.showIf&&!L.showIf(B.defaults,b?.series))continue;if(L.hideFromDefaults)continue;const V=N(L.category),K=L.editor,k=B.defaults,j=L.isCustom?k.custom?(0,t.get)(k.custom,L.path):void 0:(0,t.get)(k,L.path);L.getItemsCount&&(V.props.itemsCount=L.getItemsCount(j)),V.addItem(new c.v({title:L.name,description:L.description,overrides:P(L,B,b?.series),render:function(){const J=X=>{x((0,a.EQ)(B,L.path,X,L.isCustom))};return n.createElement(K,{value:j,onChange:J,item:L,context:W,id:L.id})}}))}return Object.values(U)}function h(C){const T=new p.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return T.addItem(new c.v({title:"Name",value:C,popularRank:1,render:function(){return n.createElement(r.p,{id:"LibraryPanelFrameName","data-testid":"library panel name input",defaultValue:C.state.name,onBlur:O=>C.setState({name:O.currentTarget.value})})}})).addItem(new c.v({title:"Information",render:function(){return n.createElement(i,{libraryPanel:C})}})),T}function D(C){const{plugin:T,panel:S,data:O,eventBus:x,instanceState:b}=C,M={},A=N=>{const w=N?.[0]??T.meta.name,L=M[w];return L||(M[w]=new p.C({title:w,id:w,sandboxId:T.meta.id}))},R=S.state.options,B={getValue:N=>(0,t.get)(R,N),onChange:(N,w)=>{const L=(0,a.Sf)(R,N,w);S.onOptionsChange(L)}},U=E({data:O,replaceVariables:S.interpolate,options:R,eventBus:x,instanceState:b});v(T.getPanelOptionsSupplier(),B,A,U);const W=S.state.fieldConfig;for(const N of T.fieldConfigRegistry.list()){const w=N.showIf&&(N.isCustom?!N.showIf(W.defaults.custom,O?.series):!N.showIf(W.defaults,O?.series));if(N.hideFromDefaults||w)continue;const L=A(N.category),V=N.editor,K=W.defaults,k=N.isCustom?K.custom?(0,t.get)(K.custom,N.path):void 0:(0,t.get)(K,N.path);N.getItemsCount&&(L.props.itemsCount=N.getItemsCount(k)),L.addItem(new c.v({title:N.name,description:N.description,overrides:P(N,W,O?.series),render:function(){const H=J=>{S.onFieldConfigChange((0,a.EQ)(W,N.path,J,N.isCustom),!0)};return n.createElement(V,{value:k,onChange:H,item:N,context:U,id:N.id})}}))}return Object.values(M)}function v(C,T,S,O,x){const b=new s.pv;C(b,O);for(const M of b.getItems()){if(M.showIf&&!M.showIf(O.options,O.data))continue;let A=x;if(A?M.category?.[0]?.length&&(A=A.getCategory(M.category[0])):A=S(M.category),(0,s.iF)(M)){const B=M.getNestedValueAccess(T),U=B.getContext?B.getContext(O):{...O,options:T.getValue(M.path)};v(M.getBuilder(),B,S,U,A);continue}const R=M.editor;A.addItem(new c.v({title:M.name,description:M.description,render:function(){return n.createElement(R,{value:T.getValue(M.path),onChange:U=>{T.onChange(M.path,U)},item:M,context:O,id:M.id})}}))}}},53466:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>h,GU:()=>p,MJ:()=>y,Ox:()=>f,eK:()=>a,fR:()=>P,kw:()=>E,wi:()=>l});var t=e(65307),n=e(39070),s=e(43127),r=e(33390),o=e(84423),m=e(32696);const l="grafana.dashboard.editor.ui",i={isPanelOptionsVisible:!0,rightPaneSize:400,topPaneSize:.45,mode:m.q5.Fill},u=()=>{const D=r.A.getObject(l,i);let v={...D};return typeof D.topPaneSize=="string"&&(v={...D,topPaneSize:parseFloat(D.topPaneSize)/100}),{getPanel:()=>new o.a9({}),getSourcePanel:()=>new o.a9({}),getData:()=>({state:n.Gu.NotStarted,series:[],timeRange:(0,s.E2)()}),initDone:!1,shouldDiscardChanges:!1,isOpen:!1,isVizPickerOpen:!1,tableViewEnabled:!1,ui:{...i,...v}}},d=(0,t.Z0)({name:"panelEditor",initialState:u(),reducers:{updateEditorInitState:(D,v)=>{D.getPanel=()=>v.payload.panel,D.getSourcePanel=()=>v.payload.sourcePanel,D.initDone=!0,D.isOpen=!0,D.shouldDiscardChanges=!1},setEditorPanelData:(D,v)=>{D.getData=()=>v.payload},setDiscardChanges:(D,v)=>{D.shouldDiscardChanges=v.payload},setPanelEditorUIState:(D,v)=>{D.ui={...D.ui,...v.payload},!D.ui.isPanelOptionsVisible&&D.isVizPickerOpen&&(D.isVizPickerOpen=!1)},toggleVizPicker:(D,v)=>{D.isVizPickerOpen=v.payload,D.isVizPickerOpen&&(D.ui.isPanelOptionsVisible=!0)},toggleTableView(D){D.tableViewEnabled=!D.tableViewEnabled},closeEditor:D=>{D.getPanel=()=>new o.a9({}),D.getSourcePanel=()=>new o.a9({}),D.isOpen=!1,D.initDone=!1,D.isVizPickerOpen=!1,D.tableViewEnabled=!1}}}),{updateEditorInitState:p,setEditorPanelData:c,setDiscardChanges:y,closeEditor:f,setPanelEditorUIState:P,toggleVizPicker:a,toggleTableView:E}=d.actions,h={panelEditor:d.reducer}},95689:(G,I,e)=>{"use strict";e.d(I,{a:()=>l,e:()=>i});var t=e(41811),n=e(2913),s=e(16233),r=e(75471),o=e(57220),m=e(32696);const l=(0,t.A)((u,d)=>{const p=[];if(!d)return p;let c=m.M8.Visualize;if(d.meta.skipDataQuery)return[];d.meta.skipDataQuery||(c=m.M8.Query,p.push({id:m.M8.Query,text:"Query",icon:"database",active:!1}),p.push({id:m.M8.Transform,text:"Transform data",icon:"process",active:!1})),i(d)&&p.push({id:m.M8.Alert,text:"Alert",icon:"bell",active:!1});const y=p.find(f=>f.id===(u||c))??p[0];return y.active=!0,p});function i(u){const{unifiedAlertingEnabled:d=!1}=(0,n.zj)(),p=s.TP.hasPermission((0,r.Wd)(o.hY).read);if(!(d&&p))return!1;const y=u.meta.id==="graph",f=u.meta.id==="timeseries";return y||f}},32696:(G,I,e)=>{"use strict";e.d(I,{M8:()=>t,Nt:()=>r,__:()=>m,q5:()=>n});var t=(l=>(l.Query="query",l.Transform="transform",l.Visualize="visualize",l.Alert="alert",l))(t||{}),n=(l=>(l[l.Fill=0]="Fill",l[l.Fit=1]="Fit",l[l.Exact=2]="Exact",l))(n||{}),s=(l=>(l[l.Off=0]="Off",l[l.Table=1]="Table",l))(s||{});const r=[{value:0,label:"Fill",description:"Use all available space"},{value:2,label:"Actual",description:"Make same size as on the dashboard"}],o=[{value:0,label:"Visualization",description:"Show using selected visualization"},{value:1,label:"Table",description:"Show raw data in table form"}];var m=(l=>(l[l.Visualizations=0]="Visualizations",l[l.LibraryPanels=1]="LibraryPanels",l[l.Suggestions=2]="Suggestions",l[l.Widgets=3]="Widgets",l))(m||{})},54612:(G,I,e)=>{"use strict";e.d(I,{$:()=>m,A:()=>o,EQ:()=>l,Sf:()=>i});var t=e(2543),n=e.n(t),s=e(15054),r=e(32696);function o(u,d,p,c){if(u===r.q5.Fill)return{width:d,height:p};const y=8*6,a=(window.innerWidth-60-s.dU*4)/s.cV*c.gridPos.w,E=s.sD*c.gridPos.h+y,g=Math.min(d/a,p/E);return a<=d&&E<=p?{width:a,height:E}:{width:a*g,height:E*g}}function m(u){return u?.meta.skipDataQuery===!1}const l=(u,d,p,c)=>{let y={...u.defaults};const f=p==null||p==="";return c?y.custom?f?y.custom=(0,t.omit)(y.custom,d):y.custom=i(y.custom,d,p):f||(y.custom=i(y.custom,d,p)):f?y=(0,t.omit)(y,d):y=i(y,d,p),{...u,defaults:y}};function i(u,d,p){const c=Array.isArray(d)?d:d.split("."),y=c.shift();if(y.endsWith("]")){const P=y.lastIndexOf("["),a=+y.substring(P+1,y.length-1),E=y.substring(0,P);let g=u[E];const h=Array.isArray(g)?[...g]:[];return c.length&&(g=h[a],(g==null||typeof g!="object")&&(g={}),p=i(g,c,p)),h[a]=p,{...u,[E]:h}}if(!c.length)return{...u,[y]:p};let f=u[y];return(f==null||typeof f!="object")&&(f={}),{...u,[y]:i(f,c,p)}}},92378:(G,I,e)=>{"use strict";e.d(I,{G:()=>m,U:()=>l});var t=e(96540),n=e(16401),s=e(21594),r=e(31678),o=e(87421);const m=({repeat:i,onChange:u,id:d})=>{const p=(0,r.useSelector)(f=>(0,o.SS)((0,o.y7)(f),f)),c=(0,t.useMemo)(()=>{const f=p.map(P=>({label:P.name,value:P.name}));return f.length===0&&f.unshift({label:"No template variables found",value:null}),f.unshift({label:"Disable repeating",value:null}),f},[p]),y=(0,t.useCallback)(f=>u(f.value),[u]);return t.createElement(s.l6,{inputId:d,value:i,onChange:y,options:c})},l=({parent:i,repeat:u,id:d,onChange:p})=>{const y=(0,t.useMemo)(()=>n.jh.getVariables(i),[i]).useState().variables,f=(0,t.useMemo)(()=>{const a=y.map(E=>({label:E.state.name,value:E.state.name}));return a.length===0&&a.unshift({label:"No template variables found",value:null}),a.unshift({label:"Disable repeating",value:null}),a},[y]),P=(0,t.useCallback)(a=>p(a.value),[p]);return t.createElement(s.l6,{inputId:d,value:u,onChange:P,options:f})}},78050:(G,I,e)=>{"use strict";e.d(I,{C:()=>l,m:()=>i});var t=e(96540),n=e(13544),s=e(14110),r=e(71678),o=e(55852),m=e(70497);const l=({dashboard:u,onSaveSuccess:d,size:p})=>t.createElement(r.$s,null,({showModal:c,hideModal:y})=>t.createElement(o.$n,{size:p,onClick:()=>{c(m.$,{dashboard:u,onSaveSuccess:d,onDismiss:y})},"aria-label":n.Tp.pages.Dashboard.Settings.General.saveDashBoard},"Save dashboard")),i=({dashboard:u,onClick:d,onSaveSuccess:p,variant:c,size:y})=>t.createElement(r.$s,null,({showModal:f,hideModal:P})=>t.createElement(o.$n,{size:y,onClick:()=>{(0,s.rR)("grafana_dashboard_save_as_clicked"),d?.(),f(m.$,{dashboard:u,onSaveSuccess:p,onDismiss:P,isCopy:!0})},variant:c,"aria-label":n.Tp.pages.Dashboard.Settings.General.saveAsDashBoard},"Save as"))},54943:(G,I,e)=>{"use strict";e.d(I,{l:()=>i});var t=e(96540),n=e(16817),s=e(67061),r=e(62930),o=e(90613),m=e(19626),l=e(22764);const i=({diff:u,oldValue:d,newValue:p,hasFolderChanges:c,oldFolder:y,newFolder:f})=>{const P=(0,n.A)(async()=>{const E=JSON.stringify(d??{},null,2),g=JSON.stringify(p??{},null,2);let h;const D=[];let v=0;if(u)for(const[C,T]of Object.entries(u)){const S=t.createElement(m.D,{diffs:T,key:C,title:C});C==="schemaVersion"?h=S:D.push(S),v+=T.length}return{schemaChange:h,diffs:D,count:v,showDiffs:v<15,jsonView:t.createElement(l.M,{oldValue:E,newValue:g})}},[u,d,p]),{value:a}=P;return t.createElement(s.B,{direction:"column",gap:1},c&&t.createElement(m.D,{diffs:[{op:"replace",value:f,originalValue:y,path:[],startLineNumber:0,endLineNumber:0}],key:"folder",title:"folder"}),(!a||!d)&&t.createElement(r.y,null),a&&a.count>=1?t.createElement(t.Fragment,null,a&&a.schemaChange&&a.schemaChange,a&&a.showDiffs&&a.diffs,t.createElement(o.a,{paddingTop:1},t.createElement("h4",null,"Full JSON diff"),a.jsonView)):t.createElement(o.a,{paddingTop:1},"No changes in the dashboard JSON"))}},70497:(G,I,e)=>{"use strict";e.d(I,{$:()=>xe});var t=e(96540),n=e(17172),s=e(32264),r=e(87978),o=e(63021),m=e(40675),l=e(56596),i=e(32196),u=e(16817),d=e(40845),p=e(42418),c=e(27677);function y({dashboard:Ve}){const $e=(0,d.of)(f),{loading:Xe,value:gt,error:Dt}=(0,u.A)(async()=>{const at=Ve.getSaveModelCloneOld();return c.IB.validateDashboard(at).catch(re=>{if(re.status>=500)throw re;return re.data})},[Ve]);let nt;if(Xe)nt=t.createElement(p.F,{severity:"info",title:"Checking dashboard validity"});else if(gt)gt.isValid||(nt=t.createElement(p.F,{severity:"warning",title:"Dashboard failed schema validation"},t.createElement("p",null,"Validation is provided for development purposes and should be safe to ignore. If you are a Grafana developer, consider checking and updating the dashboard schema"),t.createElement("div",{className:$e.error},gt.message)));else{const at=Dt?.message??"Unknown error";nt=t.createElement(p.F,{severity:"info",title:"Error checking dashboard validity"},t.createElement("p",{className:$e.error},at))}return nt?t.createElement("div",{className:$e.root},nt):null}const f=Ve=>({root:(0,i.css)({marginTop:Ve.spacing(1)}),error:(0,i.css)({fontFamily:Ve.typography.fontFamilyMonospace,whiteSpace:"pre-wrap",overflowX:"auto",maxWidth:"100%"})}),P=y;var a=e(54943),E=e(96374),g=e(37390),h=e(55852),D=e(78050),v=e(41053),C=e(71733),T=e(14110),S=e(12131),O=e(28138),x=e(3169),b=e(91219),M=e(55314),A=e(31678),R=e(28444),B=e(36974);const U=async(Ve,$e,Xe,gt)=>{const Dt=await gt({dashboard:Ve,folderUid:$e.folderUid??Xe.meta.folderUid??Ve.meta?.folderUid,message:$e.message,overwrite:$e.overwrite});if("error"in Dt)throw Dt.error;return Dt.data},W=(Ve=!1)=>{const $e=(0,A.useDispatch)(),Xe=(0,x._2)(),[gt]=(0,M.e8)(),[Dt,nt]=(0,v.A)(async(at,Ae,re)=>{try{const Z=await U(at,Ae,re,gt);re.version=Z.version,at.version=Z.version,re.clearUnsavedChanges(at,Ae),O.A.publish(new R.Eu),Xe.success("Dashboard saved"),(0,B.ko)(Z.uid),Ve?(0,T.rR)("grafana_dashboard_copied",{name:re.title,url:Z.url}):(0,T.rR)(`grafana_dashboard_${re.id?"saved":"created"}`,{name:re.title,url:Z.url});const oe=S.Ny.getLocation().pathname,Ee=C.I.stripBaseFromUrl(Z.url);return Ee!==oe&&setTimeout(()=>S.Ny.replace(Ee)),re.meta.isStarred&&$e((0,b.TU)({id:re.uid,title:re.title,url:Ee})),Z}catch(Z){throw Z instanceof Error&&Xe.error(Z.message??"Error saving dashboard"),Z}},[$e,Xe]);return{state:Dt,onDashboardSave:nt}},N=({dashboard:Ve,dashboardSaveModel:$e,error:Xe,onDismiss:gt,setErrorIsHandled:Dt})=>{const{onDashboardSave:nt}=W();return t.createElement(t.Fragment,null,Xe.data&&Xe.data.status==="version-mismatch"&&t.createElement(E.u,{isOpen:!0,title:"Conflict",body:t.createElement("div",null,"Someone else has updated this dashboard ",t.createElement("br",null)," ",t.createElement("small",null,"Would you still like to save this dashboard?")),confirmText:"Save and overwrite",onConfirm:async()=>{await nt($e,{overwrite:!0},Ve),gt()},onDismiss:gt}),Xe.data&&Xe.data.status==="name-exists"&&t.createElement(E.u,{isOpen:!0,title:"Conflict",body:t.createElement("div",null,"A dashboard with the same name in selected folder already exists. ",t.createElement("br",null),t.createElement("small",null,"Would you still like to save this dashboard?")),confirmText:"Save and overwrite",onConfirm:async()=>{await nt($e,{overwrite:!0},Ve),gt()},onDismiss:gt}),Xe.data&&Xe.data.status==="plugin-dashboard"&&t.createElement(w,{dashboard:Ve,onDismiss:()=>{Dt(!0),gt()}}))},w=({onDismiss:Ve,dashboard:$e})=>{const{onDashboardSave:Xe}=W(),gt=(0,d.of)(V);return t.createElement(g.a,{className:gt.modal,title:"Plugin dashboard",icon:"copy",isOpen:!0,onDismiss:Ve},t.createElement("div",{className:gt.modalText},"Your changes will be lost when you update the plugin.",t.createElement("br",null),t.createElement("small",null,"Use ",t.createElement("strong",null,"Save As")," to create custom version.")),t.createElement(g.a.ButtonRow,null,t.createElement(h.$n,{variant:"secondary",onClick:Ve,fill:"outline"},"Cancel"),t.createElement(D.m,{onClick:Ve,dashboard:$e,onSaveSuccess:Ve}),t.createElement(h.$n,{variant:"destructive",onClick:async()=>{await Xe($e.getSaveModelClone(),{overwrite:!0},$e),Ve()}},"Overwrite")))},L=Ve=>{switch(Ve){case"version-mismatch":case"name-exists":case"plugin-dashboard":return!0;default:return!1}},V=Ve=>({modal:(0,i.css)({width:"500px"}),modalText:(0,i.css)({fontSize:Ve.typography.h4.fontSize,color:Ve.colors.text.primary,marginBottom:Ve.spacing(4),paddingTop:Ve.spacing(2)}),modalButtonRow:(0,i.css)({marginBottom:"14px","a, button":{marginRight:Ve.spacing(2)}})});var K=e(51253),k=e(16504),j=e(88575),H=e(67061),J=e(60029),X=e(10354),se=e(21744),ae=e(15292),ne=e(36607),q=e(71500),ee=e(81394),z=e(27966);const te=Ve=>{const $e=Ve.getSaveModelClone();return $e.id=null,$e.uid="",$e.title+=" Copy",$e.editable=!0,Ve.id>0&&$e.panels&&$e.panels.forEach(Xe=>{Xe.type==="graph"&&Xe.alert&&delete Xe.thresholds,delete Xe.alert}),$e},ie=({dashboard:Ve,isLoading:$e,isNew:Xe,onSubmit:gt,onCancel:Dt,onSuccess:nt})=>{const at={title:Xe?Ve.title:`${Ve.title} Copy`,description:Ve.description,$folder:{uid:Ve.meta.folderUid,title:Ve.meta.folderTitle},copyTags:!1},Ae=re=>async Z=>{if(Z&&Z===re().$folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await q.P.validateNewDashboardName(re().$folder.uid??"general",Z),!0}catch(oe){return oe instanceof Error?oe.message:"Dashboard name is invalid"}};return t.createElement(K.l,{defaultValues:at,onSubmit:async re=>{if(!gt)return;const Z=te(Ve);Z.title=re.title,Z.description=re.description,!Xe&&!re.copyTags&&(Z.tags=[]),(await gt(Z,{folderUid:re.$folder.uid},Ve)).status==="success"&&nt()}},({register:re,control:Z,errors:oe,getValues:Ee})=>t.createElement(t.Fragment,null,t.createElement(k.e,{render:({field:{ref:ye,...Se}})=>t.createElement(j.D,{label:t.createElement(H.B,{justifyContent:"space-between"},t.createElement(J.J,{htmlFor:"title"},"Title"),s.$.featureToggles.dashgpt&&Xe&&t.createElement(z.Z,{onGenerate:Be=>Se.onChange(Be)})),invalid:!!oe.title,error:oe.title?.message},t.createElement(X.p,{...Se,onChange:Be=>Se.onChange(Be.target.value),"aria-label":"Save dashboard title field",autoFocus:!0})),control:Z,name:"title",rules:{validate:Ae(Ee)}}),t.createElement(k.e,{render:({field:{ref:ye,...Se}})=>t.createElement(j.D,{label:t.createElement(H.B,{justifyContent:"space-between"},t.createElement(J.J,{htmlFor:"description"},"Description"),s.$.featureToggles.dashgpt&&Xe&&t.createElement(ee.V,{onGenerate:Be=>Se.onChange(Be)})),invalid:!!oe.description,error:oe.description?.message},t.createElement(se.f,{...Se,onChange:Be=>Se.onChange(Be.target.value),"aria-label":"Save dashboard description field",autoFocus:!0})),control:Z,name:"description"}),t.createElement(j.D,{label:"Folder"},t.createElement(k.e,{render:({field:{ref:ye,...Se}})=>t.createElement(ne.d,{...Se,onChange:(Be,We)=>Se.onChange({uid:Be,title:We}),value:Se.value?.uid,initialTitle:Ve.meta.folderTitle,dashboardId:Ve.id,enableCreateNew:!0}),control:Z,name:"$folder"})),!Xe&&t.createElement(j.D,{label:"Copy tags"},t.createElement(ae.d,{...re("copyTags")})),t.createElement(H.B,null,t.createElement(h.$n,{type:"button",variant:"secondary",onClick:Dt,fill:"outline"},"Cancel"),t.createElement(h.$n,{disabled:$e,type:"submit","aria-label":"Save dashboard button"},$e?"Saving...":"Save"))))};var ce=e(13544),ue=e(10880),fe=e(10740),Te=e(57725),he=e(3363);const de=["You are an expert in Grafana Dashboards","Your goal is to write a description of the changes for a dashboard to display to the user","You will be given human-readable diffs with most irrelevant lines filtered out"].join(`.
`),le=["Respond only with the diff description, which is meant to be loaded directly into the application for the user.",'If there are no substantial user or migration changes, the correct description is "Minor changes only"',`If there are too many changes of either kind, and those changes have a message saying 'too long', the correct response for that section is "Too many changes to auto-summarize"`,"In a diff, lines beginning with - are removed, and lines beginning with + are added.","Lines with neither + nor - are included for context. Be careful not to mark them as added or removed if they do not start with + or -.","If a line is changed, it will show a previous version removed and a new version added","When referring to panel changes, use the panel title","When using panel title, wrap it with double quotes","When the panel changes position, just mention that the panel has changed position","When an entire panel is added or removed, use the panel title and only say it was added or removed and disregard the rest of the changes for that panel","Group together similar changes into one line when multiple panels are affected","Refer to templating elements as variables","Try to make the response as short as possible"].join(`.
`),pe=({dashboard:Ve,onGenerate:$e,disabled:Xe})=>{const gt=(0,t.useCallback)(()=>ve(Ve),[Ve]);return t.createElement(fe.n,{messages:gt,onGenerate:$e,temperature:0,model:"gpt-3.5-turbo-16k",eventTrackingSrc:Te.ec.dashboardChanges,toggleTipTitle:"Improve your dashboard changes summary",disabled:Xe})};function ve(Ve){let{userChanges:$e,migrationChanges:Xe}=(0,he.Yy)(Ve);return $e.length>8e3&&($e="User changes were too long, fill in the user changes section with 'User changes too long to auto-summarize'"),Xe.split(`
`).length<10?Xe="No significant migration changes":Xe.length>8e3&&(Xe="Migration changes were too long, fill in the migration changes section with 'Migration changes too long to auto-summarize'"),[{content:de,role:he.Xh.system},{content:`Summarize the following user changes diff under "User changes":
${$e}`,role:he.Xh.system},{content:`Be sure to only include substantial user changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Do not include "User Changes" section if there are no substantial user changes to report.`,role:he.Xh.system},{content:`Summarize the following migration changes diff under "Migration changes":
${Xe}`,role:he.Xh.system},{content:`Be sure to only include substantial migration changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Ignore any threshold step changes or templating list changes.
Ignore other changes and do not include them in the summary. Do not include "Migration Changes" section if there are no substantial migration changes to report.
If there are substantial migration changes, add "Some autogenerated changes are included to update the dashboard to the latest valid schema version" at the end.`,role:he.Xh.system},{content:le,role:he.Xh.system}]}const be=({dashboard:Ve,isLoading:$e,saveModel:Xe,options:gt,onSubmit:Dt,onCancel:nt,onSuccess:at,onOptionsChange:Ae})=>{const re=(0,t.useMemo)(()=>Ve.hasTimeChanged(),[Ve]),Z=(0,t.useMemo)(()=>Ve.hasVariablesChanged(),[Ve]),[oe,Ee]=(0,t.useState)(!1),[ye,Se]=(0,t.useState)(gt.message),Be=(0,d.of)(Oe);return t.createElement("form",{onSubmit:async We=>{if(We.preventDefault(),!Dt)return;Ee(!0),gt={...gt,message:ye},(await Dt(Xe.clone,gt,Ve)).status==="success"?at():Ee(!1)},style:{maxWidth:600}},t.createElement(H.B,{gap:2,direction:"column",alignItems:"flex-start"},re&&t.createElement(ue.S,{checked:!!gt.saveTimerange,onChange:()=>Ae({...gt,saveTimerange:!gt.saveTimerange}),label:"Save current time range as dashboard default","aria-label":ce.Tp.pages.SaveDashboardModal.saveTimerange}),Z&&t.createElement(ue.S,{checked:!!gt.saveVariables,onChange:()=>Ae({...gt,saveVariables:!gt.saveVariables}),label:"Save current variable values as dashboard default","aria-label":ce.Tp.pages.SaveDashboardModal.saveVariables}),t.createElement("div",{className:Be.message},s.$.featureToggles.aiGeneratedDashboardChanges&&t.createElement(pe,{dashboard:Ve,onGenerate:We=>{Ae({...gt,message:We}),Se(We)},disabled:!Xe.hasChanges}),t.createElement(se.f,{"aria-label":"message",value:ye,onChange:We=>{Ae({...gt,message:We.currentTarget.value}),Se(We.currentTarget.value)},placeholder:"Add a note to describe your changes.",autoFocus:!0,rows:5})),t.createElement(H.B,{alignItems:"center"},t.createElement(h.$n,{variant:"secondary",onClick:nt,fill:"outline"},"Cancel"),t.createElement(h.$n,{type:"submit",disabled:!Xe.hasChanges||$e,icon:oe?"spinner":void 0,"aria-label":ce.Tp.pages.SaveDashboardModal.save},$e?"Saving...":"Save"),!Xe.hasChanges&&t.createElement("div",null,"No changes to save"))))};function Oe(Ve){return{message:(0,i.css)({display:"flex",alignItems:"end",flexDirection:"column",width:"100%"})}}var Me=e(4213),Ue=e(66864),we=e(10534);const Re=({dashboard:Ve,onCancel:$e})=>{const[Xe,gt]=(0,t.useState)(()=>{const nt=Ve.getSaveModelClone();return delete nt.id,JSON.stringify(nt,null,2)}),Dt=(0,t.useCallback)(()=>{const nt=new Blob([Xe],{type:"application/json;charset=utf-8"});(0,Me.saveAs)(nt,Ve.title+"-"+new Date().getTime()+".json")},[Ve.title,Xe]);return t.createElement(t.Fragment,null,t.createElement(H.B,{direction:"column",gap:2},t.createElement("div",null,"This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",t.createElement("br",null),t.createElement("i",null,"See"," ",t.createElement("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer"},"documentation")," ","for more information about provisioning."),t.createElement("br",null)," ",t.createElement("br",null),t.createElement("strong",null,"File path: ")," ",Ve.meta.provisionedExternalId),t.createElement(se.f,{spellCheck:!1,value:Xe,onChange:nt=>{gt(nt.currentTarget.value)},className:Fe.json}),t.createElement(Ue.Gy,null,t.createElement(h.$n,{variant:"secondary",onClick:$e,fill:"outline"},"Cancel"),t.createElement(we.b,{icon:"copy",getText:()=>Xe},"Copy JSON to clipboard"),t.createElement(h.$n,{type:"submit",onClick:Dt},"Save JSON to file"))))},Fe={json:(0,i.css)({height:"400px",width:"100%",overflow:"auto",resize:"none",fontFamily:"monospace"})},xe=({dashboard:Ve,onDismiss:$e,onSaveSuccess:Xe,isCopy:gt})=>{const[Dt,nt]=(0,t.useState)({}),at=Ve.getOriginalDashboard(),Ae=Ve.meta.provisioned,re=Ve.version===0,Z=!!Ve.meta.hasUnsavedFolderChange,[oe,Ee]=(0,t.useState)(!1),ye=(0,t.useMemo)(()=>{const pt=Ve.getSaveModelClone({saveTimerange:!!Dt.saveTimerange,saveVariables:!!Dt.saveVariables});if(!at)return{clone:pt,diff:{},diffCount:0,hasChanges:!1};const Ge=(0,l.G4)(at,pt);let qe=0;for(const bt of Object.values(Ge))qe+=bt.length;return{clone:pt,diff:Ge,diffCount:qe,hasChanges:(qe>0||Z)&&!re}},[Ve,at,Dt,re,Z]),[Se,Be]=(0,t.useState)(!1),{state:We,onDashboardSave:Ke}=W(gt),it=Xe?()=>{$e(),Xe()}:$e,rt=()=>Se?t.createElement(a.l,{diff:ye.diff,oldValue:at,newValue:ye.clone}):re||gt?t.createElement(ie,{dashboard:Ve,isLoading:We.loading,onCancel:$e,onSuccess:it,onSubmit:Ke,isNew:re}):Ae?t.createElement(Re,{dashboard:Ve,onCancel:$e,onSuccess:it}):t.createElement(be,{dashboard:Ve,isLoading:We.loading,saveModel:ye,onCancel:$e,onSuccess:it,onSubmit:Ke,options:Dt,onOptionsChange:nt});if(We.error&&!oe&&(0,n.NF)(We.error)&&L(We.error.data.status))return t.createElement(N,{error:We.error,dashboard:Ve,dashboardSaveModel:ye.clone,onDismiss:$e,setErrorIsHandled:Ee});let ft="Save dashboard";return gt?ft="Save dashboard copy":Ae&&(ft="Provisioned dashboard"),t.createElement(r._,{title:ft,onClose:$e,subtitle:Ve.title,tabs:t.createElement(o.U,null,t.createElement(m.o,{label:"Details",active:!Se,onChangeTab:()=>Be(!1)}),ye.hasChanges&&t.createElement(m.o,{label:"Changes",active:Se,onChangeTab:()=>Be(!0),counter:ye.diffCount}))},rt(),s.$.featureToggles.showDashboardValidationWarnings&&t.createElement(P,{dashboard:Ve}))}},35280:(G,I,e)=>{"use strict";e.d(I,{D:()=>y});var t=e(96540),n=e(94701),s=e(14110),r=e(88575),o=e(15292),m=e(21744),l=e(37390),i=e(10534),u=e(8484),d=e(7758),p=e(87895),c=e(22699);function y({panel:f,dashboard:P,range:a,buildIframe:E=c.CF}){const[g,h]=(0,t.useState)(!0),[D,v]=(0,t.useState)("current"),[C,T]=(0,t.useState)("");(0,n.A)(()=>{(0,s.rR)("grafana_dashboards_embed_share_viewed",{shareResource:(0,c.hD)(f)})}),(0,t.useEffect)(()=>{const A=E(g,P.uid,D,f,a);T(A)},[D,g,P,f,a,E]);const S=A=>{T(A.currentTarget.value)},O=()=>{h(A=>!A)},x=A=>{v(A)},M=P.time.to==="now"?(0,u.t)("share-modal.embed.time-range-description","Transforms the current relative time range to an absolute time range"):"";return t.createElement(t.Fragment,null,t.createElement("p",{className:"share-modal-info-text"},t.createElement(u.x6,{i18nKey:"share-modal.embed.info"},"Generate HTML for embedding an iframe with this panel.")),t.createElement(r.D,{label:(0,u.t)("share-modal.embed.time-range","Current time range"),description:M},t.createElement(o.d,{id:"share-current-time-range",value:g,onChange:O})),t.createElement(p.w,{selectedTheme:D,onChange:x}),t.createElement(r.D,{label:(0,u.t)("share-modal.embed.html","Embed HTML"),description:(0,u.t)("share-modal.embed.html-description","The HTML code below can be pasted and included in another web page. Unless anonymous access is enabled, the user viewing that page need to be signed into Grafana for the graph to load.")},t.createElement(m.f,{"data-testid":"share-embed-html",id:"share-panel-embed-embed-html-textarea",rows:5,value:C,onChange:S})),t.createElement(l.a.ButtonRow,null,t.createElement(i.b,{icon:"copy",variant:"primary",getText:()=>C,onClipboardCopy:()=>{d.c.embedSnippetCopy({currentTimeRange:g,theme:D,shareResource:(0,c.hD)(f)})}},t.createElement(u.x6,{i18nKey:"share-modal.embed.copy"},"Copy to clipboard"))))}},86394:(G,I,e)=>{"use strict";e.d(I,{j:()=>m});var t=e(96540),n=e(14110),s=e(8484),r=e(96227),o=e(22699);const m=({panel:l,initialFolderUid:i,onCreateLibraryPanel:u,onDismiss:d})=>((0,t.useEffect)(()=>{(0,n.rR)("grafana_dashboards_library_panel_share_viewed",{shareResource:(0,o.hD)(l)})},[l]),l?t.createElement(t.Fragment,null,t.createElement("p",{className:"share-modal-info-text"},t.createElement(s.x6,{i18nKey:"share-modal.library.info"},"Create library panel.")),t.createElement(r.b,{panel:l,initialFolderUid:i,onCreateLibraryPanel:u,onDismiss:d})):null)},7686:(G,I,e)=>{"use strict";e.d(I,{Zy:()=>z});var t=e(96540),n=e(25897),s=e(37390),r=e(40980),o=e(40845),m=e(2913),l=e(10096),i=e(8484),u=e(4785),d=e(72254),p=e(7758),c=e(82792),y=e(35280),f=e(4213),P=e(88575),a=e(15292),E=e(55852),g=e(15858),h=e(28444),D=e(70713),v=e(32372),C=e(10534);function T({json:te,onDismiss:ie}){const ce=(0,t.useCallback)(()=>te,[te]);return t.createElement(s.a,{title:"JSON",onDismiss:ie,onClickBackdrop:ie,isOpen:!0},t.createElement(D.Ay,{disableHeight:!0},({width:ue})=>t.createElement(v.B,{value:te,language:"json",showMiniMap:!1,height:"500px",width:ue})),t.createElement(s.a.ButtonRow,null,t.createElement(C.b,{icon:"copy",getText:ce,onClipboardCopy:()=>{p.c.exportCopyJsonClicked()}},t.createElement(i.x6,{i18nKey:"share-modal.view-json.copy-button"},"Copy to Clipboard"))))}var S=e(22699);class O extends t.PureComponent{constructor(ie){super(ie),this.onShareExternallyChange=()=>{this.setState({shareExternally:!this.state.shareExternally})},this.onSaveAsFile=()=>{const{dashboard:ce}=this.props,{shareExternally:ue}=this.state;p.c.exportSaveJsonClicked({externally:ue,shareResource:(0,S.hD)(this.props.panel)}),ue?this.exporter.makeExportable(ce).then(fe=>{this.openSaveAsDialog(fe)}):this.openSaveAsDialog(ce.getSaveModelClone())},this.onViewJson=()=>{const{dashboard:ce}=this.props,{shareExternally:ue}=this.state;p.c.exportViewJsonClicked({externally:ue,shareResource:(0,S.hD)(this.props.panel)}),ue?this.exporter.makeExportable(ce).then(fe=>{this.openJsonModal(fe)}):this.openJsonModal(ce.getSaveModelClone())},this.openSaveAsDialog=ce=>{const ue=JSON.stringify(ce,null,2),fe=new Blob([ue],{type:"application/json;charset=utf-8"}),Te=new Date().getTime();(0,f.saveAs)(fe,`${ce.title}-${Te}.json`)},this.openJsonModal=ce=>{l.lE.publish(new h.S8({props:{json:JSON.stringify(ce,null,2)},component:T})),this.props.onDismiss?.()},this.state={shareExternally:!1},this.exporter=new g.M}render(){const{onDismiss:ie}=this.props,{shareExternally:ce}=this.state,ue=(0,i.t)("share-modal.export.share-externally-label","Export for sharing externally");return t.createElement(t.Fragment,null,t.createElement("p",{className:"share-modal-info-text"},t.createElement(i.x6,{i18nKey:"share-modal.export.info-text"},"Export this dashboard.")),t.createElement(P.D,{label:ue},t.createElement(a.d,{id:"share-externally-toggle",value:ce,onChange:this.onShareExternallyChange})),t.createElement(s.a.ButtonRow,null,t.createElement(E.$n,{variant:"secondary",onClick:ie,fill:"outline"},t.createElement(i.x6,{i18nKey:"share-modal.export.cancel-button"},"Cancel")),t.createElement(E.$n,{variant:"secondary",onClick:this.onViewJson},t.createElement(i.x6,{i18nKey:"share-modal.export.view-button"},"View JSON")),t.createElement(E.$n,{variant:"primary",onClick:this.onSaveAsFile},t.createElement(i.x6,{i18nKey:"share-modal.export.save-button"},"Save to file"))))}}var x=e(86394),b=e(13544),M=e(84167),A=e(10354),R=e(72109),B=e(42418),U=e(87895);class W extends t.PureComponent{constructor(ie){super(ie),this.buildUrl=async()=>{const{panel:ce,dashboard:ue}=this.props,{useCurrentTimeRange:fe,useShortUrl:Te,selectedTheme:he}=this.state,de=await(0,S.Xe)(fe,he,ce,Te),le=(0,S.Lb)(fe,ue.uid,he,ce);this.setState({shareUrl:de,imageUrl:le})},this.onUseCurrentTimeRangeChange=()=>{this.setState({useCurrentTimeRange:!this.state.useCurrentTimeRange})},this.onUrlShorten=()=>{this.setState({useShortUrl:!this.state.useShortUrl})},this.onThemeChange=ce=>{this.setState({selectedTheme:ce})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{p.c.shareLinkCopied({currentTimeRange:this.state.useCurrentTimeRange,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,S.hD)(this.props.panel)})},this.state={useCurrentTimeRange:!0,useShortUrl:!1,selectedTheme:"current",shareUrl:"",imageUrl:""}}componentDidMount(){this.buildUrl()}componentDidUpdate(ie,ce){const{useCurrentTimeRange:ue,useShortUrl:fe,selectedTheme:Te}=this.state;(ce.useCurrentTimeRange!==ue||ce.selectedTheme!==Te||ce.useShortUrl!==fe)&&this.buildUrl()}render(){const{panel:ie,dashboard:ce}=this.props,ue=ce?ce.time.to==="now":!1,{useCurrentTimeRange:fe,useShortUrl:Te,selectedTheme:he,shareUrl:de,imageUrl:le}=this.state,pe=b.Tp.pages.SharePanelModal,ve=!!ce.id,be=(0,i.t)("share-modal.link.time-range-label","Lock time range"),Oe=(0,i.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),Me=(0,i.t)("share-modal.link.shorten-url","Shorten URL"),Ue=(0,i.t)("share-modal.link.link-url","Link URL");return t.createElement(t.Fragment,null,t.createElement("p",{className:"share-modal-info-text"},t.createElement(i.x6,{i18nKey:"share-modal.link.info-text"},"Create a direct link to this dashboard or panel, customized with the options below.")),t.createElement(M.n,null,t.createElement(P.D,{label:be,description:ue?Oe:""},t.createElement(a.d,{id:"share-current-time-range",value:fe,onChange:this.onUseCurrentTimeRangeChange})),t.createElement(U.w,{selectedTheme:he,onChange:this.onThemeChange}),t.createElement(P.D,{label:Me},t.createElement(a.d,{id:"share-shorten-url",value:Te,onChange:this.onUrlShorten})),t.createElement(P.D,{label:Ue},t.createElement(A.p,{id:"link-url-input",value:de,readOnly:!0,addonAfter:t.createElement(C.b,{icon:"copy",variant:"primary",getText:this.getShareUrl,onClipboardCopy:this.onCopy},t.createElement(i.x6,{i18nKey:"share-modal.link.copy-link-button"},"Copy"))}))),ie&&m.Ay.rendererAvailable&&t.createElement(t.Fragment,null,ve&&t.createElement(R.Y,{href:le,external:!0,icon:"camera","aria-label":pe.linkToRenderedImage},(0,i.t)("share-modal.link.rendered-image","Direct link rendered image")),!ve&&t.createElement(B.F,{severity:"info",title:(0,i.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0},t.createElement(i.x6,{i18nKey:"share-modal.link.save-dashboard"},"To render a panel image, you must save the dashboard first."))),ie&&!m.Ay.rendererAvailable&&t.createElement(B.F,{severity:"info",title:(0,i.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0},t.createElement(i.x6,{i18nKey:"share-modal.link.render-instructions"},"To render a panel image, you must install the"," ",t.createElement(R.Y,{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",external:!0},"Grafana image renderer plugin"),". Please contact your Grafana administrator to install the plugin.")))}}var N=e(92041),w=e(12470),L=e(17172),V=e(21594),K=e(62930),k=e(74856),j=e(69064);class H extends t.PureComponent{constructor(ie){super(ie),this.createSnapshot=ce=>()=>{const{timeoutSeconds:ue}=this.state;this.dashboard.snapshot={timestamp:new Date},this.setState({isLoading:!0}),this.dashboard.startRefresh(),setTimeout(()=>{this.saveSnapshot(this.dashboard,ce)},ue*1e3)},this.saveSnapshot=async(ce,ue)=>{const{snapshotExpires:fe,timeoutSeconds:Te}=this.state,he=this.dashboard.getSaveModelCloneOld();this.scrubDashboard(he);const de={dashboard:he,name:he.title,expires:fe,external:ue};try{const le=await(0,j.s)().create(de);this.setState({deleteUrl:le.deleteUrl,snapshotUrl:le.url,step:2})}finally{ue?p.c.publishSnapshotClicked({expires:fe,timeout:Te,shareResource:(0,S.hD)(this.props.panel)}):p.c.publishSnapshotLocalClicked({expires:fe,timeout:Te,shareResource:(0,S.hD)(this.props.panel)}),this.setState({isLoading:!1})}},this.scrubDashboard=ce=>{const{panel:ue}=this.props,{snapshotName:fe}=this.state;ce.title=fe,ce.time=(0,k.jG)().timeRange(),ce.links=[],ce.panels.forEach(he=>{he.targets=[],he.links=[],he.datasource=null});const Te=ce.annotations.list.filter(he=>he.enable);if(ce.annotations.list=Te.map(he=>({name:he.name,enable:he.enable,iconColor:he.iconColor,snapshotData:he.snapshotData,type:he.type,builtIn:he.builtIn,hide:he.hide})),ce.getVariables().forEach(he=>{"query"in he&&(he.query=""),"options"in he&&(he.options=he.current&&!(0,N.R)(he.current)?[he.current]:[]),"refresh"in he&&(he.refresh=w.CO.never)}),ue){const he=ue.getSaveModel();he.gridPos.w=24,he.gridPos.x=0,he.gridPos.y=0,he.gridPos.h=20,ce.panels=[he]}delete this.dashboard.snapshot,this.dashboard.forEachPanel(he=>{delete he.snapshotData}),this.dashboard.annotations.list.forEach(he=>{delete he.snapshotData})},this.deleteSnapshot=async()=>{const{deleteUrl:ce}=this.state;await(0,L.AI)().get(ce),this.setState({step:3})},this.getSnapshotUrl=()=>this.state.snapshotUrl,this.onSnapshotNameChange=ce=>{this.setState({snapshotName:ce.target.value})},this.onTimeoutChange=ce=>{this.setState({timeoutSeconds:Number(ce.target.value)})},this.onExpireChange=ce=>{this.setState({selectedExpireOption:ce,snapshotExpires:ce.value})},this.dashboard=ie.dashboard,this.expireOptions=[{label:(0,i.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,i.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},{label:(0,i.t)("share-modal.snapshot.expire-week","1 Week"),value:60*60*24*7},{label:(0,i.t)("share-modal.snapshot.expire-never","Never"),value:0}],this.state={isLoading:!1,step:1,selectedExpireOption:this.expireOptions[2],snapshotExpires:this.expireOptions[2].value,snapshotName:ie.dashboard.title,timeoutSeconds:4,snapshotUrl:"",deleteUrl:"",externalEnabled:!1,sharingButtonText:""}}componentDidMount(){this.getSnaphotShareOptions()}async getSnaphotShareOptions(){const ie=await(0,j.s)().getSharingOptions();this.setState({sharingButtonText:ie.externalSnapshotName,externalEnabled:ie.externalEnabled})}renderStep1(){const{onDismiss:ie}=this.props,{snapshotName:ce,selectedExpireOption:ue,timeoutSeconds:fe,isLoading:Te,sharingButtonText:he,externalEnabled:de}=this.state,le=(0,i.t)("share-modal.snapshot.name","Snapshot name"),pe=(0,i.t)("share-modal.snapshot.expire","Expire"),ve=(0,i.t)("share-modal.snapshot.timeout","Timeout (seconds)"),be=(0,i.t)("share-modal.snapshot.timeout-description","You might need to configure the timeout value if it takes a long time to collect your dashboard metrics.");return t.createElement(t.Fragment,null,t.createElement("div",null,t.createElement("p",{className:"share-modal-info-text"},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.info-text-1"},"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard.")),t.createElement("p",{className:"share-modal-info-text"},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.info-text-2"},"Keep in mind, your snapshot ",t.createElement("em",null,"can be viewed by anyone")," that has the link and can access the URL. Share wisely."))),t.createElement(P.D,{label:le},t.createElement(A.p,{id:"snapshot-name-input",width:30,value:ce,onChange:this.onSnapshotNameChange})),t.createElement(P.D,{label:pe},t.createElement(V.l6,{inputId:"expire-select-input",width:30,options:this.expireOptions,value:ue,onChange:this.onExpireChange})),t.createElement(P.D,{label:ve,description:be},t.createElement(A.p,{id:"timeout-input",type:"number",width:21,value:fe,onChange:this.onTimeoutChange})),t.createElement(s.a.ButtonRow,null,t.createElement(E.$n,{variant:"secondary",onClick:ie,fill:"outline"},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.cancel-button"},"Cancel")),de&&t.createElement(E.$n,{variant:"secondary",disabled:Te,onClick:this.createSnapshot(!0)},he),t.createElement(E.$n,{variant:"primary",disabled:Te,onClick:this.createSnapshot()},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.local-button"},"Publish Snapshot"))))}renderStep2(){const{snapshotUrl:ie}=this.state;return t.createElement(t.Fragment,null,t.createElement(P.D,{label:(0,i.t)("share-modal.snapshot.url-label","Snapshot URL")},t.createElement(A.p,{id:"snapshot-url-input",value:ie,readOnly:!0,addonAfter:t.createElement(C.b,{icon:"copy",variant:"primary",getText:this.getSnapshotUrl},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.copy-link-button"},"Copy"))})),t.createElement("div",{className:"pull-right",style:{padding:"5px"}},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.mistake-message"},"Did you make a mistake? "),"\xA0",t.createElement(E.z9,{fill:"text",target:"_blank",onClick:this.deleteSnapshot},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.delete-button"},"Delete snapshot."))))}renderStep3(){return t.createElement("div",{className:"share-modal-header"},t.createElement("p",{className:"share-modal-info-text"},t.createElement(i.x6,{i18nKey:"share-modal.snapshot.deleted-message"},"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches.")))}render(){const{isLoading:ie,step:ce}=this.state;return t.createElement(t.Fragment,null,ce===1&&this.renderStep1(),ce===2&&this.renderStep2(),ce===3&&this.renderStep3(),ie&&t.createElement(K.y,{inline:!0}))}}const J=[],X=[];function se(te){J.push(te)}function ae(te){X.push(te)}function ne(te,ie,ce){const fe=[{label:(0,i.t)("share-modal.tab-title.link","Link"),value:S.wr.link,component:W}];if(l.TP.isSignedIn&&m.config.snapshotEnabled&&te){const he=(0,i.t)("share-modal.tab-title.snapshot","Snapshot");fe.push({label:he,value:S.wr.snapshot,component:H})}if(ie){const he=(0,i.t)("share-modal.tab-title.embed","Embed");if(fe.push({label:he,value:S.wr.embed,component:y.D}),!(0,c.X)(ie)){const de=(0,i.t)("share-modal.tab-title.library-panel","Library panel");fe.push({label:de,value:S.wr.libraryPanel,component:x.j})}fe.push(...X)}else{const he=(0,i.t)("share-modal.tab-title.export","Export");fe.push({label:he,value:S.wr.export,component:O}),fe.push(...J),(0,d.iR)()&&fe.push({label:(0,i.t)("share-modal.tab-title.public-dashboard-title","Public dashboard"),value:S.wr.publicDashboard,component:u.b})}const Te=fe.find(he=>he.value===ce);return{tabs:fe,activeTab:Te?.value??fe[0].value}}function q(te){const{tabs:ie,activeTab:ce}=ne(te.dashboard.canEditDashboard(),te.panel,te.activeTab);return{tabs:ie,activeTab:ce}}class ee extends t.Component{constructor(ie){super(ie),this.onSelectTab=ce=>{this.setState(ue=>({...ue,activeTab:ce.value})),p.c.sharingTabChanged({item:ce.value,shareResource:(0,S.hD)(this.props.panel)})},this.state=q(ie)}getActiveTab(){const{tabs:ie,activeTab:ce}=this.state;return ie.find(ue=>ue.value===ce)}renderTitle(){const{panel:ie}=this.props,{activeTab:ce}=this.state,ue=ie?(0,i.t)("share-modal.panel.title","Share Panel"):(0,i.t)("share-modal.dashboard.title","Share"),fe=this.props.dashboard.canEditDashboard(),Te=ne(fe,this.props.panel,this.state.activeTab).tabs;return t.createElement(n.J,{title:ue,icon:"share-alt",tabs:Te,activeTab:ce,onChangeTab:this.onSelectTab})}render(){const{dashboard:ie,panel:ce}=this.props,fe=this.getActiveTab().component;return t.createElement(s.a,{isOpen:!0,title:this.renderTitle(),onDismiss:this.props.onDismiss},t.createElement(r.J,null,t.createElement(fe,{dashboard:ie,panel:ce,onDismiss:this.props.onDismiss})))}}const z=(0,o.cV)(ee)},59037:(G,I,e)=>{"use strict";e.d(I,{K:()=>he,b:()=>Te});var t=e(32196),n=e(96540),s=e(49785),r=e(13544),o=e(32264),m=e(33378),l=e(40845),i=e(88575),u=e(10354),d=e(10534),p=e(15292),c=e(60029),y=e(66864),f=e(55852),P=e(71678),a=e(8484),E=e(72686),g=e(21380),h=e(7758),D=e(90591),v=e(16233),C=e(31678),T=e(52908);const S=()=>{const{width:le}=(0,T.A)();return le>1024};var O=e(7686),x=e(22699),b=e(29304),M=e(42418);const A=()=>n.createElement(M.F,{title:(0,a.t)("public-dashboard.modal-alerts.save-dashboard-changes-alert-title","Please save your dashboard changes before updating the public configuration"),severity:"warning",bottomSpacing:0});var R=e(12257),B=e(10872),U=e(72254),W=e(84167),N=e(54230);const w=r.Tp.pages.ShareDashboardModal.PublicDashboard,L=({disabled:le,onChange:pe,register:ve,timeRange:be})=>n.createElement(n.Fragment,null,n.createElement(W.n,{disabled:le},n.createElement(y.gW,{spacing:"md"},n.createElement(y.PE,{orientation:1,spacing:"xs",justify:"space-between"},n.createElement(c.J,{description:(0,a.t)("public-dashboard.settings-configuration.default-time-range-label-desc","The public dashboard uses the default time range settings of the dashboard")},n.createElement(a.x6,{i18nKey:"public-dashboard.settings-configuration.default-time-range-label"},"Default time range")),n.createElement(N.b,{value:be,disabled:!0,onChange:()=>{}})),n.createElement(y.PE,{orientation:0,spacing:"sm"},n.createElement(p.d,{...ve("isTimeSelectionEnabled"),"data-testid":w.EnableTimeRangeSwitch,onChange:Oe=>{pe("isTimeSelectionEnabled",Oe.currentTarget.checked),h.c.publicDashboardTimeSelectionChanged({enabled:Oe.currentTarget.checked})}}),n.createElement(c.J,{description:(0,a.t)("public-dashboard.settings-configuration.time-range-picker-label-desc","Allow viewers to change time range")},n.createElement(a.x6,{i18nKey:"public-dashboard.settings-configuration.time-range-picker-label"},"Time range picker enabled"))),n.createElement(y.PE,{orientation:0,spacing:"sm"},n.createElement(p.d,{...ve("isAnnotationsEnabled"),onChange:Oe=>{pe("isAnnotationsEnabled",Oe.currentTarget.checked),h.c.publicDashboardAnnotationsSelectionChanged({enabled:Oe.currentTarget.checked})},"data-testid":w.EnableAnnotationsSwitch}),n.createElement(c.J,{description:(0,a.t)("public-dashboard.settings-configuration.show-annotations-label-desc","Show annotations on public dashboard")},n.createElement(a.x6,{i18nKey:"public-dashboard.settings-configuration.show-annotations-label"},"Show annotations"))))));var V=e(19727),K=e(94354),k=e(62930),j=e(24283);const H=r.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,J=({recipients:le,dashboardUid:pe,publicDashboardUid:ve})=>{const be=(0,l.of)(se),[Oe,{isLoading:Me}]=(0,E.$L)(),[Ue,{isLoading:we}]=(0,E.NA)(),Re=Me||we,Fe=(Ve,$e)=>{h.c.revokePublicDashboardEmailClicked(),Oe({recipientUid:Ve,recipientEmail:$e,dashboardUid:pe,uid:ve})},xe=Ve=>{h.c.resendPublicDashboardEmailClicked(),Ue({recipientUid:Ve,uid:ve})};return n.createElement("table",{className:be.table,"data-testid":H.EmailSharingList},n.createElement("tbody",null,le.map((Ve,$e)=>n.createElement("tr",{key:Ve.uid},n.createElement("td",null,Ve.recipient),n.createElement("td",null,n.createElement(V.e,{className:be.tableButtonsContainer},n.createElement(f.$n,{type:"button",variant:"destructive",fill:"text",title:(0,a.t)("public-dashboard.email-sharing.revoke-button-title","Revoke"),size:"sm",disabled:Re,onClick:()=>Fe(Ve.uid,Ve.recipient),"data-testid":`${H.DeleteEmail}-${$e}`},n.createElement(a.x6,{i18nKey:"public-dashboard.email-sharing.revoke-button"},"Revoke")),n.createElement(f.$n,{type:"button",variant:"primary",fill:"text",title:(0,a.t)("public-dashboard.email-sharing.resend-button-title","Resend"),size:"sm",disabled:Re,onClick:()=>xe(Ve.uid),"data-testid":`${H.ReshareLink}-${$e}`},n.createElement(a.x6,{i18nKey:"public-dashboard.email-sharing.resend-button"},"Resend"))))))))},X=({dashboard:le})=>{const{width:pe}=(0,T.A)(),ve=(0,l.of)(se),be=le instanceof j.H$?le.state.uid:le.uid,{data:Oe}=(0,E.Bs)(be),[Me]=(0,E.T2)(),[Ue,{isLoading:we}]=(0,E.NY)(),Re=v.TP.hasPermission(C.AccessControlAction.DashboardsPublicWrite),{register:Fe,setValue:xe,control:Ve,watch:$e,handleSubmit:Xe,formState:{errors:gt},reset:Dt}=(0,s.mN)({defaultValues:{shareType:Oe?.share||U.Xo.PUBLIC,email:""},mode:"onSubmit"}),nt=Ae=>{const re={dashboard:le,payload:{...Oe,share:Ae}};Me(re)},at=async Ae=>{h.c.publicDashboardEmailInviteClicked(),await Ue({recipient:Ae.email,uid:Oe.uid,dashboardUid:be}).unwrap(),Dt({email:"",shareType:U.Xo.EMAIL})};return n.createElement("form",{onSubmit:Xe(at)},n.createElement(W.n,{disabled:!Re,"data-testid":H.Container,className:ve.container},n.createElement(i.D,{label:(0,a.t)("public-dashboard.config.can-view-dashboard-radio-button-label","Can view dashboard"),className:ve.field},n.createElement(s.xI,{name:"shareType",control:Ve,render:({field:Ae})=>{const{ref:re,...Z}=Ae,oe=[{label:(0,a.t)("public-dashboard.config.public-share-type-option-label","Anyone with a link"),value:U.Xo.PUBLIC},{label:(0,a.t)("public-dashboard.config.email-share-type-option-label","Only specified people"),value:U.Xo.EMAIL}];return n.createElement(K.z,{...Z,size:pe<480?"sm":"md",options:oe,onChange:Ee=>{h.c.publicDashboardShareTypeChange({shareType:Ee===U.Xo.EMAIL?"email":"public"}),xe("shareType",Ee),nt(Ee)}})}})),$e("shareType")===U.Xo.EMAIL&&n.createElement(n.Fragment,null,n.createElement(i.D,{label:(0,a.t)("public-dashboard.email-sharing.invite-field-label","Invite"),description:(0,a.t)("public-dashboard.email-sharing.invite-field-desc","Invite people by email"),error:gt.email?.message,invalid:!!gt.email?.message||void 0,className:ve.field},n.createElement("div",{className:ve.emailContainer},n.createElement(u.p,{className:ve.emailInput,placeholder:"email",autoCapitalize:"none",...Fe("email",{required:(0,a.t)("public-dashboard.email-sharing.input-required-email-text","Email is required"),pattern:{value:U._l,message:(0,a.t)("public-dashboard.email-sharing.input-invalid-email-text","Invalid email")}}),"data-testid":H.EmailSharingInput}),n.createElement(f.$n,{type:"submit",variant:"primary",disabled:we,"data-testid":H.EmailSharingInviteButton},n.createElement(a.x6,{i18nKey:"public-dashboard.email-sharing.invite-button"},"Invite"),we&&n.createElement(k.y,null)))),!!Oe?.recipients?.length&&n.createElement(J,{recipients:Oe.recipients,dashboardUid:be,publicDashboardUid:Oe.uid}))))},se=le=>({container:(0,t.css)({label:"emailConfigContainer",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:le.spacing(3)}),field:(0,t.css)({label:"field-noMargin",marginBottom:0}),emailContainer:(0,t.css)({label:"emailContainer",display:"flex",gap:le.spacing(1)}),emailInput:(0,t.css)({label:"emailInput",flexGrow:1}),table:(0,t.css)({label:"table",display:"flex",maxHeight:"220px",overflowY:"scroll","& tbody":{display:"flex",flexDirection:"column",flexGrow:1},"& tr":{minHeight:"40px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:le.spacing(.5,1),":nth-child(odd)":{background:le.colors.background.secondary}}}),tableButtonsContainer:(0,t.css)({display:"flex",justifyContent:"end"})});var ae=e(67892),ne=e(29158);function q({headerElement:le,isContentVisible:pe=!1,onRowToggle:ve,title:be,...Oe}){const Me=(0,l.of)(ee),Ue=le&&ae.renderOrCallToRender(le,{className:Me.summaryWrapper});return n.createElement("div",{className:Me.wrapper},n.createElement("div",{className:Me.header},n.createElement(ne.K,{name:pe?"angle-down":"angle-right",tooltip:pe?(0,a.t)("public-dashboard.settings-bar-header.collapse-settings-tooltip","Collapse settings"):(0,a.t)("public-dashboard.settings-bar-header.expand-settings-tooltip","Expand settings"),className:Me.collapseIcon,onClick:ve,"aria-expanded":pe,...Oe}),be&&n.createElement("div",{className:Me.titleWrapper,onClick:ve},n.createElement("span",{className:Me.title},be)),Ue))}q.displayName="SettingsBarHeader";function ee(le){return{wrapper:(0,t.css)({label:"header",padding:le.spacing(.5,.5),borderRadius:le.shape.radius.default,background:le.colors.background.secondary,minHeight:le.spacing(4),"&:focus":{outline:"none"}}),header:(0,t.css)({label:"column",display:"flex",alignItems:"center",whiteSpace:"nowrap"}),collapseIcon:(0,t.css)({marginLeft:le.spacing(.5),color:le.colors.text.disabled}),titleWrapper:(0,t.css)({display:"flex",alignItems:"center",cursor:"pointer",overflow:"hidden",marginRight:`${le.spacing(.5)}`,[le.breakpoints.down("sm")]:{flex:"1 1"}}),title:(0,t.css)({fontWeight:le.typography.fontWeightBold,marginLeft:le.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),summaryWrapper:(0,t.css)({display:"flex",flexWrap:"wrap",[le.breakpoints.down("sm")]:{flex:"2 2"}})}}function z({children:le,title:pe,headerElement:ve,...be}){const Oe=(0,l.of)(te),[Me,Ue]=(0,n.useState)(!1);function we(){Ue(Re=>!Re)}return n.createElement(n.Fragment,null,n.createElement(q,{onRowToggle:we,isContentVisible:Me,title:pe,headerElement:ve,...be}),Me&&n.createElement("div",{className:Oe.content},le))}z.displayName="SettingsBar";const te=le=>({content:(0,t.css)({marginTop:le.spacing(1),marginLeft:le.spacing(4)})});var ie=e(3799);function ce({className:le,isDataLoading:pe=!1,timeRange:ve,timeSelectionEnabled:be,annotationsEnabled:Oe}){const Me=(0,l.of)(ue),Ue=(0,a.t)("public-dashboard.settings-summary.time-range-picker-enabled-text","Time range picker = enabled"),we=(0,a.t)("public-dashboard.settings-summary.time-range-picker-disabled-text","Time range picker = disabled"),Re=(0,a.t)("public-dashboard.settings-summary.annotations-show-text","Annotations = show"),Fe=(0,a.t)("public-dashboard.settings-summary.annotations-hide-text","Annotations = hide");return pe?n.createElement("div",{className:(0,t.cx)(Me.summaryWrapper,le)},n.createElement(k.y,{className:Me.summary,inline:!0,size:"sm"})):n.createElement("div",{className:(0,t.cx)(Me.summaryWrapper,le)},n.createElement("span",{className:Me.summary},n.createElement(a.x6,{i18nKey:"public-dashboard.settings-summary.time-range-text"},"Time range = "),n.createElement(ie.f,{className:Me.timeRange,value:ve})),n.createElement("span",{className:Me.summary},be?Ue:we),n.createElement("span",{className:Me.summary},Oe?Re:Fe))}ce.displayName="SettingsSummary";const ue=le=>({summaryWrapper:(0,t.css)({display:"flex"}),summary:(0,t.css)({label:"collapsedText",marginLeft:`${le.spacing.gridSize*2}px`,fontSize:le.typography.bodySmall.fontSize,color:le.colors.text.secondary}),timeRange:(0,t.css)({display:"inline-block"})}),fe=r.Tp.pages.ShareDashboardModal.PublicDashboard;function Te({onRevoke:le,timeRange:pe,hasTemplateVariables:ve=!1,showSaveChangesAlert:be=!1,unsupportedDatasources:Oe=[],publicDashboard:Me,dashboard:Ue}){const we=(0,l.of)(de),Re=S(),[Fe,{isLoading:xe}]=(0,E.T2)(),Ve=v.TP.hasPermission(C.AccessControlAction.DashboardsPublicWrite),$e=!Ve||xe,Xe=!!o.$.featureToggles.publicDashboardsEmailSharing&&(0,m.a)("publicDashboardsEmailSharing"),{handleSubmit:gt,setValue:Dt,register:nt}=(0,s.mN)({defaultValues:{isAnnotationsEnabled:Me?.annotationsEnabled,isTimeSelectionEnabled:Me?.timeSelectionEnabled,isPaused:!Me?.isEnabled}}),at=async Z=>{const{isAnnotationsEnabled:oe,isTimeSelectionEnabled:Ee,isPaused:ye}=Z;Fe({dashboard:Ue,payload:{...Me,annotationsEnabled:oe,timeSelectionEnabled:Ee,isEnabled:!ye}})},Ae=async(Z,oe)=>{Dt(Z,oe),await gt(Ee=>at(Ee))()};function re(){h.c.publicDashboardUrlCopied()}return n.createElement("div",{className:we.configContainer},be&&n.createElement(A,null),!Ve&&n.createElement(b.t,{mode:"edit"}),ve&&n.createElement(B.D,null),Oe.length>0&&n.createElement(R.s,{unsupportedDataSources:Oe.join(", ")}),Xe&&n.createElement(X,{dashboard:Ue}),n.createElement(i.D,{label:(0,a.t)("public-dashboard.config.dashboard-url-field-label","Dashboard URL"),className:we.fieldSpace},n.createElement(u.p,{value:(0,U.mL)(Me.accessToken),readOnly:!0,disabled:!Me?.isEnabled,"data-testid":fe.CopyUrlInput,addonAfter:n.createElement(d.b,{"data-testid":fe.CopyUrlButton,variant:"primary",disabled:!Me?.isEnabled,getText:()=>(0,U.mL)(Me.accessToken),onClipboardCopy:re},n.createElement(a.x6,{i18nKey:"public-dashboard.config.copy-button"},"Copy"))})),n.createElement(i.D,{className:we.fieldSpace},n.createElement(y.PE,null,n.createElement(p.d,{...nt("isPaused"),disabled:$e,onChange:Z=>{h.c.publicDashboardPauseSharingClicked({paused:Z.currentTarget.checked}),Ae("isPaused",Z.currentTarget.checked)},"data-testid":fe.PauseSwitch}),n.createElement(c.J,{className:(0,t.css)({marginBottom:0})},n.createElement(a.x6,{i18nKey:"public-dashboard.config.pause-sharing-dashboard-label"},"Pause sharing dashboard")))),n.createElement(i.D,{className:we.fieldSpace},n.createElement(z,{title:(0,a.t)("public-dashboard.config.settings-title","Settings"),headerElement:({className:Z})=>n.createElement(ce,{className:Z,isDataLoading:xe,timeRange:pe,timeSelectionEnabled:Me?.timeSelectionEnabled,annotationsEnabled:Me?.annotationsEnabled}),"data-testid":fe.SettingsDropdown},n.createElement(L,{disabled:$e,onChange:Ae,register:nt,timeRange:pe}))),n.createElement(y.PE,{orientation:Re?0:1,justify:Re?"flex-end":"flex-start",align:Re?"center":"normal"},n.createElement(y.Gy,{justify:"flex-end"},n.createElement(f.$n,{title:(0,a.t)("public-dashboard.config.revoke-public-URL-button-title","Revoke public URL"),onClick:le,type:"button",disabled:$e,"data-testid":fe.DeleteButton,variant:"destructive",fill:"outline"},n.createElement(a.x6,{i18nKey:"public-dashboard.config.revoke-public-URL-button"},"Revoke public URL")))))}function he({publicDashboard:le,unsupportedDatasources:pe}){const be=(0,C.useSelector)(Fe=>Fe.dashboard).getModel(),Oe=(0,g.z)(be.getDefaultTime(),be),Me=v.TP.hasPermission(C.AccessControlAction.DashboardsPublicWrite),Ue=(0,U.kD)(be.getVariables()),[we]=(0,E.bN)(),Re=Fe=>{we({dashboard:be,uid:le.uid,dashboardUid:be.uid}),Fe()};return n.createElement(P.$s,null,({showModal:Fe,hideModal:xe})=>n.createElement(Te,{publicDashboard:le,dashboard:be,unsupportedDatasources:pe,timeRange:Oe,showSaveChangesAlert:Me&&be.hasUnsavedChanges(),hasTemplateVariables:Ue,onRevoke:()=>{h.c.revokePublicDashboardClicked(),Fe(D.m,{dashboardTitle:be.title,onConfirm:()=>Re(xe),onDismiss:()=>{Fe(O.Zy,{dashboard:be,onDismiss:xe,activeTab:x.wr.publicDashboard})}})}}))}const de=le=>({configContainer:(0,t.css)({label:"config container",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:le.spacing(3)}),fieldSpace:(0,t.css)({label:"field space",width:"100%",marginBottom:0}),timeRange:(0,t.css)({display:"inline-block"})})},22234:(G,I,e)=>{"use strict";e.d(I,{M:()=>x,D:()=>O});var t=e(32196),n=e(96540),s=e(49785),r=e(13544),o=e(40845),m=e(55852),l=e(62930),i=e(8484),u=e(16233),d=e(72686),p=e(7758),c=e(31678),y=e(29304),f=e(12257),P=e(10872),a=e(72254),E=e(71415),g=e(84167),h=e(66864),D=e(10880);const v=r.Tp.pages.ShareDashboardModal.PublicDashboard,C=({disabled:M,register:A})=>{const R=(0,o.of)(T),B=[{type:"publicAcknowledgment",description:(0,i.t)("public-dashboard.acknowledgment-checkboxes.public-ack-desc","Your entire dashboard will be public*"),testId:v.WillBePublicCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",tooltip:(0,i.t)("public-dashboard.acknowledgment-checkboxes.public-ack-tooltip","Learn more about public dashboards")}},{type:"dataSourcesAcknowledgment",description:(0,i.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-desc","Publishing currently only works with a subset of data sources*"),testId:v.LimitedDSCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/datasources/",tooltip:(0,i.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-tooltip","Learn more about public datasources")}},{type:"usageAcknowledgment",description:(0,i.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc","Making a dashboard public will cause queries to run each time it is viewed, which may increase costs*"),testId:v.CostIncreaseCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",tooltip:(0,i.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc-tooltip","Learn more about query caching")}}];return n.createElement(n.Fragment,null,n.createElement("p",{className:R.title},n.createElement(i.x6,{i18nKey:"public-dashboard.acknowledgment-checkboxes.ack-title"},"Before you make the dashboard public, acknowledge the following:")),n.createElement(g.n,{disabled:M},n.createElement(h.gW,{spacing:"md"},B.map(U=>n.createElement(h.Gy,{key:U.type,spacing:"none",align:"center"},n.createElement(D.S,{...A(U.type,{required:!0}),label:U.description,"data-testid":U.testId}),n.createElement(m.z9,{variant:"primary",href:U.info.href,target:"_blank",fill:"text",icon:"info-circle",rel:"noopener noreferrer",tooltip:U.info.tooltip}))))))},T=M=>({title:(0,t.css)({fontWeight:M.typography.fontWeightBold})}),S=r.Tp.pages.ShareDashboardModal.PublicDashboard,O=({unsupportedDatasources:M=[],unsupportedTemplateVariables:A=!1,dashboard:R,hasError:B=!1})=>{const U=(0,o.of)(b),W=u.TP.hasPermission(c.AccessControlAction.DashboardsPublicWrite),[N,{isLoading:w,isError:L}]=(0,d.U9)(),V=()=>{N({dashboard:R,payload:{isEnabled:!0}}),p.c.generatePublicDashboardUrlClicked({})},{handleSubmit:K,register:k,formState:{isValid:j}}=(0,s.mN)({mode:"onChange"}),H=!W||w||L||B;return n.createElement("div",{className:U.container},n.createElement("div",null,n.createElement("p",{className:U.title},n.createElement(i.x6,{i18nKey:"public-dashboard.create-page.welcome-title"},"Welcome to public dashboards!")),n.createElement("p",{className:U.description},n.createElement(i.x6,{i18nKey:"public-dashboard.create-page.unsupported-features-desc"},"Currently, we don\u2019t support template variables or frontend data sources"))),!W&&n.createElement(y.t,{mode:"create"}),A&&n.createElement(P.D,null),M.length>0&&n.createElement(f.s,{unsupportedDataSources:M.join(", ")}),n.createElement("form",{onSubmit:K(V)},n.createElement("div",{className:U.checkboxes},n.createElement(C,{disabled:H,register:k})),n.createElement("div",{className:U.buttonContainer},n.createElement(m.$n,{type:"submit",disabled:H||!j,"data-testid":S.CreateButton},n.createElement(i.x6,{i18nKey:"public-dashboard.create-page.generate-public-url-button"},"Generate public URL"),w&&n.createElement(l.y,{className:U.loadingSpinner})))))};function x({hasError:M}){const R=(0,c.useSelector)(W=>W.dashboard).getModel(),{unsupportedDataSources:B}=(0,E.Z)(R),U=(0,a.kD)(R.getVariables());return n.createElement(O,{dashboard:R,unsupportedDatasources:B,unsupportedTemplateVariables:U,hasError:M})}const b=M=>({container:(0,t.css)({display:"flex",flexDirection:"column",gap:M.spacing(4)}),title:(0,t.css)({fontSize:M.typography.h4.fontSize,margin:M.spacing(0,0,2)}),description:(0,t.css)({color:M.colors.text.secondary,marginBottom:M.spacing(0)}),checkboxes:(0,t.css)({margin:M.spacing(0,0,4)}),buttonContainer:(0,t.css)({display:"flex",justifyContent:"end"}),loadingSpinner:(0,t.css)({marginLeft:M.spacing(1)})})},29304:(G,I,e)=>{"use strict";e.d(I,{t:()=>m});var t=e(96540),n=e(13544),s=e(42418),r=e(8484);const o=n.Tp.pages.ShareDashboardModal.PublicDashboard,m=({mode:l})=>t.createElement(s.F,{severity:"info",title:(0,r.t)("public-dashboard.modal-alerts.no-upsert-perm-alert-title","You don\u2019t have permission to {{ mode }} a public dashboard",{mode:l}),"data-testid":o.NoUpsertPermissionsWarningAlert,bottomSpacing:0},t.createElement(r.x6,{i18nKey:"public-dashboard.modal-alerts.no-upsert-perm-alert-desc"},"Contact your admin to get permission to ",{mode:l}," public dashboards"))},12257:(G,I,e)=>{"use strict";e.d(I,{s:()=>d});var t=e(32196),n=e(46942),s=e.n(n),r=e(96540),o=e(13544),m=e(40845),l=e(42418),i=e(8484);const u=o.Tp.pages.ShareDashboardModal.PublicDashboard,d=({unsupportedDataSources:c})=>{const y=(0,m.of)(p);return r.createElement(l.F,{severity:"warning",title:(0,i.t)("public-dashboard.modal-alerts.unsupported-data-source-alert-title","Unsupported data sources"),"data-testid":u.UnsupportedDataSourcesWarningAlert,bottomSpacing:0},r.createElement("p",{className:y.unsupportedDataSourceDescription},r.createElement(i.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-data-source-alert-desc"},"There are data sources in this dashboard that are unsupported for public dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:c},".")),r.createElement("a",{href:"https://grafana.com/docs/grafana/next/dashboards/dashboard-public/",className:s()("text-link",y.unsupportedDataSourceDescription)},r.createElement(i.x6,{i18nKey:"public-dashboard.modal-alerts.unsupport-data-source-alert-readmore-link"},"Read more about supported data sources")))},p=c=>({unsupportedDataSourceDescription:(0,t.css)({color:c.colors.text.secondary,marginBottom:c.spacing(1)})})},10872:(G,I,e)=>{"use strict";e.d(I,{D:()=>m});var t=e(96540),n=e(13544),s=e(42418),r=e(8484);const o=n.Tp.pages.ShareDashboardModal.PublicDashboard,m=()=>t.createElement(s.F,{severity:"warning",title:(0,r.t)("public-dashboard.modal-alerts.unsupported-template-variable-alert-title","Template variables are not supported"),"data-testid":o.TemplateVariablesWarningAlert,bottomSpacing:0},t.createElement(r.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-template-variable-alert-desc"},"This public dashboard may not work since it uses template variables"))},4785:(G,I,e)=>{"use strict";e.d(I,{a:()=>c,b:()=>y});var t=e(32196),n=e(96540),s=e(40845),r=e(62930),o=e(72686),m=e(72254),l=e(31678),i=e(42930),u=e(59037),d=e(22234),p=e(71415);const c=()=>{const P=(0,s.of)(f);return n.createElement(i.G,{className:P.loadingContainer},n.createElement(n.Fragment,null,"Loading configuration",n.createElement(r.y,{size:"lg",className:P.spinner})))},y=P=>{const{data:a,isLoading:E,isError:g}=(0,o.Bs)(P.dashboard.uid),D=(0,l.useSelector)(C=>C.dashboard).getModel(),{unsupportedDataSources:v}=(0,p.Z)(D);return n.createElement(n.Fragment,null,E?n.createElement(c,null):(0,m.lI)(a)?n.createElement(u.K,{publicDashboard:a,unsupportedDatasources:v}):n.createElement(d.M,{hasError:g}))},f=P=>({loadingContainer:(0,t.css)({height:"280px",alignItems:"center",justifyContent:"center",gap:P.spacing(1)}),spinner:(0,t.css)({marginBottom:P.spacing(0)})})},72254:(G,I,e)=>{"use strict";e.d(I,{Xo:()=>l,_A:()=>d,_l:()=>y,gN:()=>c,iR:()=>f,kD:()=>i,lI:()=>u,mL:()=>p});var t=e(26657),n=e(32264),s=e(2913),r=e(31193),o=e(22699),m=e(31204),l=(P=>(P.PUBLIC="public",P.EMAIL="email",P))(l||{});const i=P=>P.length>0,u=P=>P?.uid!==""&&P?.uid!==void 0,d=async P=>{let a=new Set;for(const E of P)for(const g of E.targets){const h=g?.datasource?.type;h&&(m.z.has(h)&&await(0,r.tR)().get(g.datasource)instanceof t.iy||a.add(h))}return Array.from(a).sort()},p=P=>`${(0,s.zj)().appUrl}public-dashboards/${P}`,c=(P,a)=>`/d/${P}/${a}?shareView=${o.wr.publicDashboard}`,y=/^[A-Z\d._%+-]+@[A-Z\d.-]+\.[A-Z]{2,}$/i,f=()=>!!n.$.featureToggles.publicDashboards&&n.$.publicDashboardsEnabled},31204:(G,I,e)=>{"use strict";e.d(I,{z:()=>t});const t=new Set(["__expr__","aggregations-io-datasource","apache-iotdb-datasource","aquaqanalytics-kdbbackend-datasource","axiomhq-axiom-datasource","cloudwatch","cnos-cnosdb-datasource","datasource","dlopes7-appdynamics-datasource","dvelop-odata-datasource","elasticsearch","frser-sqlite-datasource","grafadruid-druid-datasource","grafana-athena-datasource","grafana-azure-data-explorer-datasource","grafana-azure-monitor-datasource","grafana-bigquery-datasource","grafana-clickhouse-datasource","grafana-databricks-datasource","grafana-datadog-datasource","grafana-dynatrace-datasource","grafana-es-open-distro-datasource","grafana-falconlogscale-datasource","grafana-github-datasource","grafana-gitlab-datasource","grafana-honeycomb-datasource","grafana-iot-sitewise-datasource","grafana-jira-datasource","grafana-looker-datasource","grafana-mock-datasource","grafana-mongodb-datasource","grafana-newrelic-datasource","grafana-odbc-datasource","grafana-opcua-datasource","grafana-opensearch-datasource","grafana-oracle-datasource","grafana-orbit-datasource","grafana-redshift-datasource","grafana-salesforce-datasource","grafana-saphana-datasource","grafana-sentry-datasource","grafana-servicenow-datasource","grafana-snowflake-datasource","grafana-splunk-datasource","grafana-splunk-monitoring-datasource","grafana-sumologic-datasource","grafana-testdata-datasource","grafana-timestream-datasource","grafana-wavefront-datasource","grafana-x-ray-datasource","graphite","hadesarchitect-cassandra-datasource","influxdata-flightsql-datasource","influxdb","innius-grpc-datasource","kniepdennis-neo4j-datasource","loki","manassehzhou-maxcompute-datasource","marcusolsson-csv-datasource","mssql","mysql","nagasudhirpulla-api-datasource","needleinajaystack-haystack-datasource","opentsdb","postgres","prometheus","quickwit-quickwit-datasource","redis-datasource","sentinelone-dataset-datasource","sneller-sneller-datasource","spiceai-spicexyz-datasource","stackdriver","tdengine-datasource","trino-datasource","vertamedia-clickhouse-datasource","vertica-grafana-datasource","ydbtech-ydb-datasource","yesoreyeram-infinity-datasource"])},71415:(G,I,e)=>{"use strict";e.d(I,{Z:()=>s});var t=e(96540),n=e(72254);const s=r=>{const[o,m]=(0,t.useState)([]);return(0,t.useEffect)(()=>{(async()=>await(0,n._A)(r.panels))().then(i=>{m(i)})},[r.panels]),{unsupportedDataSources:o}}},87895:(G,I,e)=>{"use strict";e.d(I,{w:()=>o});var t=e(96540),n=e(88575),s=e(94354),r=e(8484);const o=({selectedTheme:m="current",onChange:l})=>{const i=[{label:(0,r.t)("share-modal.theme-picker.current","Current"),value:"current"},{label:(0,r.t)("share-modal.theme-picker.dark","Dark"),value:"dark"},{label:(0,r.t)("share-modal.theme-picker.light","Light"),value:"light"}];return t.createElement(n.D,{label:(0,r.t)("share-modal.theme-picker.field-name","Theme")},t.createElement(s.z,{options:i,value:m,onChange:l}))}},1702:(G,I,e)=>{"use strict";e.d(I,{ShareModal:()=>t.Zy});var t=e(7686)},22699:(G,I,e)=>{"use strict";e.d(I,{CF:()=>y,Lb:()=>c,P_:()=>u,XV:()=>i,Xe:()=>d,hD:()=>P,wr:()=>a});var t=e(65879),n=e(76885),s=e(71733),r=e(47232),o=e(32264),m=e(7030),l=e(74856);function i({useCurrentTimeRange:E,selectedTheme:g,panel:h,search:D=window.location.search,range:v=(0,l.jG)().timeRange(),orgId:C=o.$.bootData.user.orgId}){const T=new URLSearchParams(D),S=h?.timeFrom;if(S){const{from:O,to:x}=t.describeTextRange(S);T.set("from",O),T.set("to",x)}else T.set("from",String(v.from.valueOf())),T.set("to",String(v.to.valueOf()));return T.set("orgId",String(C)),E||(T.delete("from"),T.delete("to")),g!=="current"&&T.set("theme",g),h&&!T.has("editPanel")&&T.set("viewPanel",String(h.id)),T.delete("auth_token"),T.delete("shareView"),T}function u(){let E=window.location.href;const g=E.indexOf("?");return g!==-1&&(E=E.substring(0,g)),E}async function d(E,g,h,D){const v=u(),C=i({useCurrentTimeRange:E,selectedTheme:g,panel:h}),T=n.kM.appendQueryToUrl(v,C.toString());return D?await(0,m.fn)(T):T}function p(E,g,h,D,v){const C=u(),T=i({useCurrentTimeRange:E,selectedTheme:h,panel:D,range:v});let S=C.replace(o.$.appSubUrl+"/dashboard/",o.$.appSubUrl+"/dashboard-solo/");S=S.replace(o.$.appSubUrl+"/d/",o.$.appSubUrl+"/d-solo/"),s.I.stripBaseFromUrl(C)==="/"&&(S=`${o.$.appUrl}d-solo/${g}`);const x=T.get("editPanel")??T.get("viewPanel")??"";return T.set("panelId",x),T.delete("editPanel"),T.delete("viewPanel"),n.kM.appendQueryToUrl(S,T.toString())}function c(E,g,h,D){let C=p(E,g,h,D).replace(o.$.appSubUrl+"/dashboard-solo/",o.$.appSubUrl+"/render/dashboard-solo/");return C=C.replace(o.$.appSubUrl+"/d-solo/",o.$.appSubUrl+"/render/d-solo/"),C+=`&width=${o.$.rendererDefaultImageWidth}&height=${o.$.rendererDefaultImageHeight}&scale=${o.$.rendererDefaultImageScale}`+f(),C}function y(E,g,h,D,v){return`<iframe src="${p(E,g,h,D,v)}" width="450" height="200" frameborder="0"></iframe>`}function f(){const E="&tz=UTC"+encodeURIComponent((0,r.KQ)().format("Z"));if(!window.Intl)return E;const g=window.Intl.DateTimeFormat();if(!g.resolvedOptions)return E;const h=g.resolvedOptions();return h.timeZone?"&tz="+encodeURIComponent(h.timeZone):E}const P=E=>E?"panel":"dashboard",a={link:"link",snapshot:"snapshot",export:"export",embed:"embed",libraryPanel:"library_panel",pdf:"pdf",report:"report",publicDashboard:"public_dashboard"}},52424:(G,I,e)=>{"use strict";e.d(I,{Zx:()=>D,aK:()=>P});var t=e(32196),n=e(96540),s=e(16817),r=e(80997),o=e(13544),m=e(40845),l=e(38138),i=e(40276),u=e(83122),d=e(14578),p=e(55852),c=e(27677),y=e(6923);function f({dashboardUID:v,link:C}){const T=(0,m.of)(h),S=a({dashboardUID:v,link:C});return!S||g.length===0?null:n.createElement(l.W,null,n.createElement("div",{className:T.dropdown},n.createElement(i.E,null,S.map((O,x)=>n.createElement(l.W.Item,{url:O.url,target:C.targetBlank?"_blank":void 0,key:`dashlinks-dropdown-item-${O.uid}-${x}`,label:O.title,testId:o.Tp.components.DashboardLinks.link,"aria-label":`${O.title} dashboard`})))))}const P=v=>{const{link:C,linkInfo:T,dashboardUID:S}=v,O=a(v),x=(0,m.of)(h);return C.asDropdown?n.createElement(u.m,{overlay:n.createElement(f,{link:C,dashboardUID:S})},n.createElement(D,{"data-placement":"bottom","data-toggle":"dropdown","aria-controls":"dropdown-list","aria-haspopup":"menu",fill:"outline",variant:"secondary","data-testid":o.Tp.components.DashboardLinks.dropDown},n.createElement(d.I,{"aria-hidden":!0,name:"bars",className:x.iconMargin}),n.createElement("span",null,T.title))):n.createElement(n.Fragment,null,O.length>0&&O.map((b,M)=>n.createElement(D,{key:`dashlinks-list-item-${b.uid}-${M}`,icon:"apps",variant:"secondary",fill:"outline",href:b.url,target:C.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":o.Tp.components.DashboardLinks.link},b.title)))},a=({link:v,dashboardUID:C})=>{const{tags:T}=v,S=(0,s.A)(()=>E(T),[T]);return S.value?g(C,v,S.value):[]};async function E(v,C={getBackendSrv:c.AI}){return await C.getBackendSrv().search({tag:v,limit:100})}function g(v,C,T,S={getLinkSrv:y.mQ,sanitize:r.aj,sanitizeUrl:r.Jf}){return T.filter(O=>O.uid!==v).map(O=>{const x=O.uid,b=S.sanitize(O.title),M=S.getLinkSrv().getLinkUrl({...C,url:O.url}),A=S.sanitizeUrl(M);return{uid:x,title:b,url:A}})}function h(v){return{iconMargin:(0,t.css)({marginRight:v.spacing(.5)}),dropdown:(0,t.css)({maxWidth:"max(30vw, 300px)",maxHeight:"70vh",overflowY:"auto"}),button:(0,t.css)({color:v.colors.text.primary}),dashButton:(0,t.css)({fontSize:v.typography.bodySmall.fontSize,paddingLeft:v.spacing(1),paddingRight:v.spacing(1)})}}const D=n.forwardRef(({className:v,...C},T)=>{const S=(0,m.of)(h),O=C.href?p.z9:p.$n;return n.createElement(O,{...C,variant:"secondary",fill:"outline",className:(0,t.cx)(v,S.dashButton),ref:T})});D.displayName="DashboardLinkButton"},57650:(G,I,e)=>{"use strict";e.d(I,{A:()=>W});var t=e(96540),n=e(97497),s=e(42941),r=e(1173),o=e(52622),m=e(13544),l=e(14110),i=e(96374),u=e(10343),d=e(7788),p=e(2913),c=e(10803),y=e(32196),f=e(69862),P=e(85200),a=e(2514),E=e(72574),g=e(40845),h=e(87978),D=e(24022),v=e(14578);const C=({debugMode:N,index:w,data:L,uiConfig:V,configs:K,onChange:k,toggleShowDebug:j})=>{const H=(0,g.of)(T),[J,X]=(0,t.useState)([]),[se,ae]=(0,t.useState)([]),ne=(0,t.useMemo)(()=>K[w],[K,w]);(0,t.useEffect)(()=>{const ee=K[w].transformation,z=ee.filter?.options?(0,P.Dq)(ee.filter):void 0,te=K.slice(0,w).map(Te=>Te.transformation),ie=K.slice(w,w+1).map(Te=>Te.transformation),ce={interpolate:Te=>(0,E.w)().replace(Te)},ue=(0,a.m)(te,L,ce).subscribe(Te=>{z&&(Te=L.filter(he=>z(he))),X(Te)}),fe=(0,a.m)(te,L,ce).pipe((0,f.Z)(Te=>(0,a.m)(ie,Te,ce))).subscribe(ae);return function(){ue.unsubscribe(),fe.unsubscribe()}},[w,L,K]);const q=(0,t.useMemo)(()=>t.createElement(V.editor,{options:{...V.transformation.defaultOptions,...ne.transformation.options},input:J,onChange:ee=>{k(w,{...ne.transformation,options:ee})}}),[V.editor,V.transformation.defaultOptions,ne.transformation,J,k,w]);return t.createElement("div",{"data-testid":m.Tp.components.TransformTab.transformationEditor(V.name)},q,N&&t.createElement(h._,{title:"Debug transformation",subtitle:V.name,onClose:j},t.createElement("div",{className:H.debugWrapper,"data-testid":m.Tp.components.TransformTab.transformationEditorDebugger(V.name)},t.createElement("div",{className:H.debug},t.createElement("div",{className:H.debugTitle},"Input data"),t.createElement("div",{className:H.debugJson},t.createElement(D.B,{json:J}))),t.createElement("div",{className:H.debugSeparator},t.createElement(v.I,{name:"arrow-right"})),t.createElement("div",{className:H.debug},t.createElement("div",{className:H.debugTitle},"Output data"),t.createElement("div",{className:H.debugJson},se&&t.createElement(D.B,{json:se}))))))},T=N=>({title:(0,y.css)({display:"flex",padding:"4px 8px 4px 8px",position:"relative",height:"35px",borderRadius:"4px 4px 0 0",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"}),name:(0,y.css)({fontWeight:N.typography.fontWeightMedium,color:N.colors.primary.text}),iconRow:(0,y.css)({display:"flex"}),icon:(0,y.css)({background:"transparent",border:"none",boxShadow:"none",cursor:"pointer",color:N.colors.text.secondary,marginLeft:N.spacing(1),"&:hover":{color:N.colors.text.primary}}),debugWrapper:(0,y.css)({display:"flex",flexDirection:"row"}),debugSeparator:(0,y.css)({width:"48px",minHeight:"300px",display:"flex",alignItems:"center",alignSelf:"stretch",justifyContent:"center",margin:`0 ${N.spacing(.5)}`,color:N.colors.primary.text}),debugTitle:(0,y.css)({padding:`${N.spacing(1)} ${N.spacing(.25)}`,fontFamily:N.typography.fontFamilyMonospace,fontSize:N.typography.bodySmall.fontSize,color:N.colors.text.primary,borderBottom:`1px solid ${N.colors.border.weak}`,flexGrow:0,flexShrink:1}),debug:(0,y.css)({marginTop:N.spacing(1),padding:`0 ${N.spacing(1,1,1)}`,border:`1px solid ${N.colors.border.weak}`,background:`${N.isLight?N.v1.palette.white:N.v1.palette.gray05}`,borderRadius:N.shape.radius.default,width:"100%",minHeight:"300px",display:"flex",flexDirection:"column",alignSelf:"stretch"}),debugJson:(0,y.css)({flexGrow:1,height:"100%",overflow:"hidden",padding:N.spacing(.5)})});var S=e(22214),O=e(91847);const x=({isOpen:N,onCloseClick:w,transformer:L})=>{const{transformation:{name:V},help:K}=L,k=K||(0,O.$n)(),j=t.createElement(h._,{title:V,subtitle:"Transformation help",onClose:()=>w(!1)},t.createElement(S.j,{markdown:k,styleOverrides:{borderTop:"2px solid"}}));return N?j:null};var b=e(88575),M=e(21594),A=e(19743);const R=({index:N,data:w,config:L,onChange:V})=>{const K=(0,g.of)(B),k=(0,t.useMemo)(()=>({context:{data:w.series},showTopic:!0,showFilter:L.topic!==o.QR.Annotations,source:[{value:o.QR.Series,label:"Query results"},{value:o.QR.Annotations,label:"Annotation data"}]}),[w,L.topic]);return t.createElement("div",{className:K.wrapper},t.createElement(b.D,{label:"Apply transformation to"},t.createElement(t.Fragment,null,k.showTopic&&t.createElement(M.l6,{isClearable:!0,options:k.source,value:k.source.find(j=>j.value===L.topic),placeholder:k.source[0].label,className:K.padded,onChange:j=>{V(N,{...L,topic:j?.value})}}),k.showFilter&&t.createElement(A.x,{value:L.filter,context:k.context,item:{},onChange:j=>V(N,{...L,filter:j})}))))},B=N=>{const w=N.shape.radius.default;return{wrapper:(0,y.css)({padding:N.spacing(2),border:`2px solid ${N.colors.background.secondary}`,borderTop:"none",borderRadius:`0 0 ${w} ${w}`,position:"relative",top:"-4px"}),padded:(0,y.css)({marginBottom:N.spacing(1)})}},U=({onRemove:N,index:w,id:L,data:V,configs:K,uiConfig:k,onChange:j})=>{const[H,J]=(0,s.A)(!1),[X,se]=(0,s.A)(!1),[ae,ne]=(0,s.A)(!1),q=!!K[w].transformation.disabled,ee=K[w].transformation.topic,z=K[w].transformation.filter!=null||ee!=null,te=z||V.series.length>1||(V.annotations?.length??0)>0,ie=(0,t.useCallback)(Te=>{const he=K[Te].transformation;j(Te,{...he,disabled:he.disabled?void 0:!0})},[j,K]),ce=(0,t.useCallback)(()=>{let Te={...K[w].transformation};Te.filter?delete Te.filter:Te.filter={id:r.jR.byRefId,options:""},j(w,Te)},[j,w,K]),ue=(0,t.useCallback)((Te,he,de)=>le=>{let pe="panel_editor_tabs_transformations_toggle";p.Ay.featureToggles.transformationsRedesign&&(pe="transformations_redesign_"+pe),(0,l.rR)(pe,{action:de?"off":"on",toggleId:he,transformationId:K[w].transformation.id}),Te(le)},[K,w]),fe=()=>t.createElement(t.Fragment,null,k.state&&t.createElement(c.p,{state:k.state}),t.createElement(u.A,{title:"Show transform help",icon:"info-circle",onClick:ue(ne,"help",ae),active:ae}),te&&t.createElement(u.A,{title:"Filter",icon:"filter",onClick:ue(ce,"filter",z),active:z}),t.createElement(u.A,{title:"Debug",icon:"bug",onClick:ue(se,"debug",X),active:X}),t.createElement(u.A,{title:"Disable transformation",icon:q?"eye-slash":"eye",onClick:ue(()=>ie(w),"disabled",q),active:q,dataTestId:m.Tp.components.Transforms.disableTransformationButton}),t.createElement(u.q,{title:"Remove",icon:"trash-alt",onClick:()=>p.Ay.featureToggles.transformationsRedesign?J(!0):N(w)}),p.Ay.featureToggles.transformationsRedesign&&t.createElement(i.u,{isOpen:H,title:`Delete ${k.name}?`,body:"Note that removing one transformation may break others. If there is only a single transformation, you will go back to the main selection screen.",confirmText:"Delete",onConfirm:()=>{J(!1),N(w)},onDismiss:()=>J(!1)}));return t.createElement(t.Fragment,null,t.createElement(d.u,{id:L,index:w,title:`${w+1} - ${k.name}`,draggable:!0,actions:fe,disabled:q,expanderMessages:{close:"Collapse transformation row",open:"Expand transformation row"}},z&&t.createElement(R,{index:w,config:K[w].transformation,data:V,onChange:j}),t.createElement(C,{debugMode:X,index:w,data:ee===o.QR.Annotations?V.annotations??[]:V.series,configs:K,uiConfig:k,onChange:j,toggleShowDebug:se})),t.createElement(x,{transformer:k,isOpen:ae,onCloseClick:ne}))},W=({data:N,onChange:w,onRemove:L,configs:V})=>t.createElement(t.Fragment,null,V.map((K,k)=>{const j=n.h.getIfExists(K.transformation.id);return j?t.createElement(U,{index:k,id:`${K.id}`,key:`${K.id}`,data:N,configs:V,uiConfig:j,onRemove:L,onChange:w}):null}))},21427:(G,I,e)=>{"use strict";e.d(I,{R:()=>D});var t=e(32196),n=e(96540),s=e(81010),r=e(18282),o=e(97497),m=e(13544),l=e(40845),i=e(87978),u=e(10354),d=e(15292),p=e(92174),c=e(10860),y=e(29158),f=e(2913),P=e(10803),a=e(94397);const h=[["viewAll","View all"],...Object.entries(a.eJ)];function D(b){const M=(0,l.of)(v),{suffix:A,xforms:R,search:B,onSearchChange:U,onSearchKeyDown:W,showIllustrations:N,onTransformationAdd:w,selectedFilter:L,data:V,onClose:K,onShowIllustrationsChange:k,onSelectedFilterChange:j}=b,H=(0,n.useCallback)(J=>{J?.click()},[]);return n.createElement(i._,{size:"md",onClose:()=>{K&&K()},title:"Add another transformation"},n.createElement("div",{className:M.searchWrapper},n.createElement(u.p,{"data-testid":m.Tp.components.Transforms.searchInput,className:M.searchInput,value:B??"",placeholder:"Search for transformation",onChange:U,onKeyDown:W,suffix:A,ref:H}),n.createElement("div",{className:M.showImages},n.createElement("span",{className:M.illustationSwitchLabel},"Show images")," ",n.createElement(d.d,{value:N,onChange:()=>k&&k(!N)}))),n.createElement("div",{className:M.filterWrapper},h.map(([J,X])=>n.createElement(p.m,{key:J,onClick:()=>j&&j(J),label:X,selected:L===J}))),n.createElement(C,{showIllustrations:N,transformations:R,data:V,onClick:J=>{w({value:J})}}))}function v(b){return{showImages:(0,t.css)({flexBasis:"0",display:"flex",gap:"8px",alignItems:"center"}),pickerInformationLine:(0,t.css)({fontSize:"16px",marginBottom:`${b.spacing(2)}`}),pickerInformationLineHighlight:(0,t.css)({verticalAlign:"middle"}),searchWrapper:(0,t.css)({display:"flex",flexWrap:"wrap",columnGap:"27px",rowGap:"16px",width:"100%"}),searchInput:(0,t.css)({flexGrow:"1",width:"initial"}),illustationSwitchLabel:(0,t.css)({whiteSpace:"nowrap"}),filterWrapper:(0,t.css)({padding:`${b.spacing(1)} 0`,display:"flex",flexWrap:"wrap",rowGap:`${b.spacing(1)}`,columnGap:`${b.spacing(.5)}`})}}function C({showIllustrations:b,transformations:M,onClick:A,data:R}){const B=(0,l.of)(T);return n.createElement("div",{className:B.grid},M.map(U=>{let W=s.M.Applicable;U.transformation.isApplicable!==void 0&&(W=U.transformation.isApplicable(R));const N=W>0;let w=null;U.transformation.isApplicableDescription!==void 0&&(typeof U.transformation.isApplicableDescription=="function"?w=U.transformation.isApplicableDescription(R):w=U.transformation.isApplicableDescription);let L=B.newCard;return N||(L=(0,t.cx)(B.newCard,B.cardDisabled)),n.createElement(c.Z,{className:L,"data-testid":m.Tp.components.TransformTab.newTransform(U.name),onClick:()=>A(U.id),key:U.id},n.createElement(c.Z.Heading,{className:B.heading},n.createElement("span",null,U.name),n.createElement("span",{className:B.pluginStateInfoWrapper},n.createElement(P.p,{state:U.state}))),n.createElement(c.Z.Description,{className:B.description},n.createElement("span",null,x(U.id)),b&&n.createElement("span",null,n.createElement("img",{className:B.image,src:S(U.id,!N),alt:U.name})),!N&&w!==null&&n.createElement(y.K,{className:B.cardApplicableInfo,name:"info-circle",tooltip:w})))}))}function T(b){return{heading:(0,t.css)({fontWeight:400,"> button":{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"nowrap"}}),description:(0,t.css)({fontSize:"12px",display:"flex",flexDirection:"column",justifyContent:"space-between"}),image:(0,t.css)({display:"block",maxEidth:"100%`",marginTop:`${b.spacing(2)}`}),grid:(0,t.css)({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gridAutoRows:"1fr",gap:`${b.spacing(2)} ${b.spacing(1)}`,width:"100%"}),cardDisabled:(0,t.css)({backgroundColor:"rgb(204, 204, 220, 0.045)",color:`${b.colors.text.disabled} !important`,img:{filter:"grayscale(100%)",opacity:.33}}),cardApplicableInfo:(0,t.css)({position:"absolute",bottom:`${b.spacing(1)}`,right:`${b.spacing(1)}`}),newCard:(0,t.css)({gridTemplateRows:"min-content 0 1fr 0"}),pluginStateInfoWrapper:(0,t.css)({marginLeft:"5px"})}}const S=(b,M)=>`public/img/transformations/${f.Ay.theme2.isDark?"dark":"light"}/${b}.svg`,O={[r.F.concatenate]:"Combine all fields into a single frame.",[r.F.configFromData]:"Set unit, min, max and more.",[r.F.fieldLookup]:"Use a field value to lookup countries, states, or airports.",[r.F.filterFieldsByName]:"Remove parts of the query results using a regex pattern.",[r.F.filterByRefId]:"Remove rows from the data based on origin query",[r.F.filterByValue]:"Remove rows from the query results using user-defined filters.",[r.F.groupBy]:"Group data by a field value and create aggregate data.",[r.F.groupingToMatrix]:"Summarize and reorganize data based on three fields.",[r.F.joinByField]:"Combine rows from 2+ tables, based on a related field.",[r.F.labelsToFields]:"Group series by time and return labels or tags as fields.",[r.F.merge]:"Merge multiple series. Values will be combined into one row.",[r.F.organize]:"Re-order, hide, or rename fields.",[r.F.partitionByValues]:"Split a one-frame dataset into multiple series.",[r.F.prepareTimeSeries]:"Stretch data frames from the wide format into the long format.",[r.F.reduce]:"Reduce all rows or data points to a single value (ex. max, mean).",[r.F.renameByRegex]:"Rename parts of the query results using a regular expression and replacement pattern.",[r.F.seriesToRows]:"Merge multiple series. Return time, metric and values as a row."},x=b=>O[b]||o.h.getIfExists(b)?.description||""},66879:(G,I,e)=>{"use strict";e.d(I,{o:()=>w,e:()=>W});var t=e(96540),n=e(75494),s=e(97497),r=e(13544),o=e(14110),m=e(29158),l=e(55852),i=e(96374),u=e(19727),d=e(40276),p=e(66864),c=e(40845),y=e(2913),f=e(79280),P=e(12131),a=e(32696);function E({message:L}){const V=(0,t.useCallback)(()=>{P.Ny.partial({tab:a.M8.Query})},[]);return t.createElement(p.PE,{justify:"center",style:{marginTop:"100px"}},t.createElement(p.gW,{spacing:"md"},t.createElement("h2",null,L),t.createElement("div",null,t.createElement(l.$n,{size:"md",variant:"secondary",icon:"arrow-left",onClick:V},"Go back to Queries"))))}var g=e(57650),h=e(32196),D=e(87885),v=e(42418),C=e(10354),T=e(10860),S=e(61680);const O={[D.f.Transformations]:"https://grafana.com/docs/grafana/latest/panels/transformations",[D.f.FieldConfig]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/",[D.f.FieldConfigOverrides]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/#override-a-field"},x=L=>O[L];var b=e(10803);const M="dashboard.components.TransformationEditor.featureInfoBox.isDismissed";function A(L){const{noTransforms:V,search:K,xforms:k,onSearchChange:j,onSearchKeyDown:H,onTransformationAdd:J,suffix:X}=L;return t.createElement(p.gW,null,V&&t.createElement(p.mc,{grow:1},t.createElement(S.b,{storageKey:M,defaultValue:!1},(se,ae)=>se?null:t.createElement(v.F,{title:"Transformations",severity:"info",onRemove:()=>{ae(!0)}},t.createElement("p",null,"Transformations allow you to join, calculate, re-order, hide, and rename your query results before they are visualized. ",t.createElement("br",null),"Many transforms are not suitable if you're using the Graph visualization, as it currently only supports time series data. ",t.createElement("br",null),"It can help to switch to the Table visualization to understand what a transformation is doing."," "),t.createElement("a",{href:x(D.f.Transformations),className:"external-link",target:"_blank",rel:"noreferrer"},"Read more")))),t.createElement(C.p,{"data-testid":r.Tp.components.Transforms.searchInput,value:K??"",autoFocus:!V,placeholder:"Search for transformation",onChange:j,onKeyDown:H,suffix:X}),k.map(se=>t.createElement(R,{key:se.name,transform:se,onClick:()=>{J({value:se.id})}})))}function R({transform:L,onClick:V}){const K=(0,c.of)(B);return t.createElement(T.Z,{className:K.card,"data-testid":r.Tp.components.TransformTab.newTransform(L.name),onClick:V},t.createElement(T.Z.Heading,null,L.name),t.createElement(T.Z.Description,null,L.description),L.state&&t.createElement(T.Z.Tags,null,t.createElement(b.p,{state:L.state})))}function B(L){return{card:(0,h.css)({margin:"0",padding:`${L.spacing(1)}`})}}var U=e(21427);const W="viewAll";class N extends t.PureComponent{constructor(V){super(V),this.onSearchChange=j=>{this.setState({search:j.target.value})},this.onSearchKeyDown=j=>{if(j.key==="Enter"){const{search:H}=this.state;if(H){const J=H.toLowerCase(),X=s.h.list().filter(se=>(se.name+se.description).toLowerCase().indexOf(J)>=0);X.length>0&&this.onTransformationAdd({value:X[0].id})}}else j.keyCode===27&&(this.setState({search:"",showPicker:!1}),j.stopPropagation())},this.getTransformationNextId=j=>{const{transformations:H}=this.state;let J=0;const X=H.filter(se=>se.id.startsWith(j)).map(se=>se.id);return X.length!==0&&(J=Math.max(...X.map(se=>parseInt(se.match(/\d+/)[0],10)))+1),`${j}-${J}`},this.onTransformationAdd=j=>{let H="panel_editor_tabs_transformations_management";y.Ay.featureToggles.transformationsRedesign&&(H="transformations_redesign_"+H),(0,o.rR)(H,{action:"add",transformationId:j.value});const{transformations:J}=this.state,X=this.getTransformationNextId(j.value);this.setState({search:"",showPicker:!1}),this.onChange([...J,{id:X,transformation:{id:j.value,options:{}}}])},this.onTransformationChange=(j,H)=>{const{transformations:J}=this.state,X=Array.from(J);let se="panel_editor_tabs_transformations_management";y.Ay.featureToggles.transformationsRedesign&&(se="transformations_redesign_"+se),(0,o.rR)(se,{action:"change",transformationId:X[j].transformation.id}),X[j].transformation=H,this.onChange(X)},this.onTransformationRemove=j=>{const{transformations:H}=this.state,J=Array.from(H);let X="panel_editor_tabs_transformations_management";y.Ay.featureToggles.transformationsRedesign&&(X="transformations_redesign_"+X),(0,o.rR)(X,{action:"remove",transformationId:J[j].transformation.id}),J.splice(j,1),this.onChange(J)},this.onTransformationRemoveAll=()=>{this.onChange([]),this.setState({showRemoveAllModal:!1})},this.onDragEnd=j=>{const{transformations:H}=this.state;if(!j||!j.destination)return;const J=j.source.index,X=j.destination.index;if(J===X)return;const se=Array.from(H),[ae]=se.splice(J,1);se.splice(X,0,ae),this.onChange(se)},this.renderEmptyMessage=()=>t.createElement(f.p,{onShowPicker:()=>{this.setState({showPicker:!0})}}),this.renderTransformationEditors=()=>{const{data:j,transformations:H}=this.state;return t.createElement(n.JY,{onDragEnd:this.onDragEnd},t.createElement(n.gL,{droppableId:"transformations-list",direction:"vertical"},J=>t.createElement("div",{ref:J.innerRef,...J.droppableProps},t.createElement(g.A,{configs:H,data:j,onRemove:this.onTransformationRemove,onChange:this.onTransformationChange}),J.placeholder)))};const K=V.panel.transformations||[],k=this.buildTransformationIds(K);this.state={transformations:K.map((j,H)=>({transformation:j,id:k[H]})),data:{series:[]},search:"",selectedFilter:W,showIllustrations:!0}}buildTransformationIds(V){const K={},k=[];for(let j=0;j<V.length;j++){const H=V[j];K[H.id]===void 0?K[H.id]=0:K[H.id]+=1,k.push(`${V[j].id}-${K[V[j].id]}`)}return k}componentDidMount(){this.subscription=this.props.panel.getQueryRunner().getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:V=>this.setState({data:V})})}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(V,K){if(y.Ay.featureToggles.transformationsRedesign){const j=!(K.transformations.length>0)||K.showPicker,J=!(this.state.transformations.length>0)||this.state.showPicker;if(j!==J){const X=Math.random()/2;this.setState({scrollTop:J?X:Number.MAX_SAFE_INTEGER})}}}onChange(V){this.setState({transformations:V}),this.props.panel.setTransformations(V.map(K=>K.transformation))}renderTransformsPicker(){let{showPicker:V}=this.state;const{transformations:K,search:k}=this.state,{transformationsRedesign:j}=y.Ay.featureToggles,H=!K?.length,J=K.length>0;let X=null,se=s.h.list().sort((ee,z)=>ee.name>z.name?1:z.name>ee.name?-1:0);if(!j&&H&&(V=!0),this.state.selectedFilter!==W&&(se=se.filter(ee=>ee.categories&&this.state.selectedFilter&&ee.categories.has(this.state.selectedFilter))),k){const ee=k.toLowerCase(),z=se.filter(te=>(te.name+te.description).toLowerCase().indexOf(ee)>=0);X=t.createElement(t.Fragment,null,z.length," / ",se.length," \xA0\xA0",t.createElement(m.K,{name:"times",onClick:()=>{this.setState({search:""})},tooltip:"Clear search"})),se=z}!X&&V&&!H&&(X=t.createElement(m.K,{name:"times",onClick:()=>{this.setState({showPicker:!1})},tooltip:"Close picker"}));let ae=null,ne=null;j?(ae=t.createElement(U.R,{noTransforms:H,search:k,suffix:X,xforms:se,onClose:()=>this.setState({showPicker:!1}),onSelectedFilterChange:ee=>this.setState({selectedFilter:ee}),onShowIllustrationsChange:ee=>this.setState({showIllustrations:ee}),onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd,data:this.state.data.series,selectedFilter:this.state.selectedFilter,showIllustrations:this.state.showIllustrations}),ne=t.createElement(t.Fragment,null,t.createElement(l.$n,{icon:"times",variant:"secondary",onClick:()=>this.setState({showRemoveAllModal:!0}),style:{marginLeft:this.props.theme.spacing.md}},"Delete all transformations"),t.createElement(i.u,{isOpen:!!this.state.showRemoveAllModal,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>this.onTransformationRemoveAll(),onDismiss:()=>this.setState({showRemoveAllModal:!1})}))):ae=t.createElement(A,{noTransforms:H,search:k,suffix:X,xforms:se,onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd});const q=t.createElement(u.e,null,t.createElement(l.$n,{icon:"plus",variant:"secondary",onClick:()=>{this.setState({showPicker:!0})},"data-testid":r.Tp.components.Transforms.addTransformationButton},"Add another transformation"),ne);return t.createElement(t.Fragment,null,V&&ae,j&&J&&q||!j&&!V&&J&&q)}render(){const{panel:{alert:V}}=this.props,{transformations:K}=this.state,k=K.length>0;if(V){const j=k?"Transformations can't be used on a panel with alerts":"Transformations can't be used on a panel with existing alerts";return t.createElement(E,{message:j})}return t.createElement(d.E,{scrollTop:this.state.scrollTop,autoHeightMin:"100%"},t.createElement(p.mc,{padding:"lg"},t.createElement("div",{"data-testid":r.Tp.components.TransformTab.content},!k&&y.Ay.featureToggles.transformationsRedesign&&this.renderEmptyMessage(),k&&this.renderTransformationEditors(),this.renderTransformsPicker())))}}const w=(0,c.SL)(N)},68064:(G,I,e)=>{"use strict";e.d(I,{A:()=>h});var t=e(32196),n=e(96540),s=e(13544),r=e(12131),o=e(32264),m=e(40845),l=e(67061),i=e(90613),u=e(94753),d=e(55852),p=e(8484),c=e(36974),y=e(19293),f=e(24283),P=e(7758),a=e(31678),E=e(28601);const h=({dashboard:v,canCreate:C})=>{const T=(0,m.of)(D),S=(0,a.useDispatch)(),O=(0,a.useSelector)(M=>M.dashboard.initialDatasource),x=()=>{let M;if(v instanceof f.H$){const A=v.onCreateNewPanel();v.setState({editPanel:(0,y.L)(A,!0)}),r.Ny.partial({firstPanel:!0})}else M=(0,c.OK)(v,O),S((0,E.Ub)(void 0)),r.Ny.partial({editPanel:M,firstPanel:!0});P.c.emptyDashboardButtonClicked({item:"add_visualization"})},b=()=>{P.c.emptyDashboardButtonClicked({item:"import_from_library"}),v instanceof f.H$?v.onShowAddLibraryPanelDrawer():(0,c.s3)(v)};return n.createElement(l.B,{alignItems:"center",justifyContent:"center"},n.createElement("div",{className:T.wrapper},n.createElement(l.B,{alignItems:"stretch",justifyContent:"center",gap:4,direction:"column"},n.createElement(i.a,{borderColor:"strong",borderStyle:"dashed",padding:4},n.createElement(l.B,{direction:"column",alignItems:"center",gap:2},n.createElement(u.E,{element:"h1",textAlignment:"center",weight:"medium"},n.createElement(p.x6,{i18nKey:"dashboard.empty.add-visualization-header"},"Start your new dashboard by adding a visualization")),n.createElement(i.a,{marginBottom:2,paddingX:4},n.createElement(u.E,{element:"p",textAlignment:"center",color:"secondary"},n.createElement(p.x6,{i18nKey:"dashboard.empty.add-visualization-body"},"Select a data source and then query and visualize your data with charts, stats and tables or create lists, markdowns and other widgets."))),n.createElement(d.$n,{size:"lg",icon:"plus","data-testid":s.Tp.pages.AddDashboard.itemButton("Create new panel button"),onClick:x,disabled:!C},n.createElement(p.x6,{i18nKey:"dashboard.empty.add-visualization-button"},"Add visualization")))),n.createElement(l.B,{direction:{xs:"column",md:"row"},wrap:"wrap",gap:4},o.$.featureToggles.vizAndWidgetSplit&&n.createElement(i.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1},n.createElement(l.B,{direction:"column",alignItems:"center",gap:1},n.createElement(u.E,{element:"h3",textAlignment:"center",weight:"medium"},n.createElement(p.x6,{i18nKey:"dashboard.empty.add-widget-header"},"Add a widget")),n.createElement(i.a,{marginBottom:2},n.createElement(u.E,{element:"p",textAlignment:"center",color:"secondary"},n.createElement(p.x6,{i18nKey:"dashboard.empty.add-widget-body"},"Create lists, markdowns and other widgets"))),n.createElement(d.$n,{icon:"plus",fill:"outline","data-testid":s.Tp.pages.AddDashboard.itemButton("Create new widget button"),onClick:()=>{P.c.emptyDashboardButtonClicked({item:"add_widget"}),r.Ny.partial({addWidget:!0})},disabled:!C},n.createElement(p.x6,{i18nKey:"dashboard.empty.add-widget-button"},"Add widget")))),n.createElement(i.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1},n.createElement(l.B,{direction:"column",alignItems:"center",gap:1},n.createElement(u.E,{element:"h3",textAlignment:"center",weight:"medium"},n.createElement(p.x6,{i18nKey:"dashboard.empty.add-library-panel-header"},"Import panel")),n.createElement(i.a,{marginBottom:2},n.createElement(u.E,{element:"p",textAlignment:"center",color:"secondary"},n.createElement(p.x6,{i18nKey:"dashboard.empty.add-library-panel-body"},"Add visualizations that are shared with other dashboards."))),n.createElement(d.$n,{icon:"plus",fill:"outline","data-testid":s.Tp.pages.AddDashboard.itemButton("Add a panel from the panel library button"),onClick:b,disabled:!C},n.createElement(p.x6,{i18nKey:"dashboard.empty.add-library-panel-button"},"Add library panel")))),n.createElement(i.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1},n.createElement(l.B,{direction:"column",alignItems:"center",gap:1},n.createElement(u.E,{element:"h3",textAlignment:"center",weight:"medium"},n.createElement(p.x6,{i18nKey:"dashboard.empty.import-a-dashboard-header"},"Import a dashboard")),n.createElement(i.a,{marginBottom:2},n.createElement(u.E,{element:"p",textAlignment:"center",color:"secondary"},n.createElement(p.x6,{i18nKey:"dashboard.empty.import-a-dashboard-body"},"Import dashboards from files or ",n.createElement("a",{href:"https://grafana.com/grafana/dashboards/"},"grafana.com"),"."))),n.createElement(d.$n,{icon:"upload",fill:"outline","data-testid":s.Tp.pages.AddDashboard.itemButton("Import dashboard button"),onClick:()=>{P.c.emptyDashboardButtonClicked({item:"import_dashboard"}),(0,c.VF)()},disabled:!C},n.createElement(p.x6,{i18nKey:"dashboard.empty.import-dashboard-button"},"Import dashboard"))))))))};function D(v){return{wrapper:(0,t.css)({label:"dashboard-empty-wrapper",flexDirection:"column",maxWidth:"890px",gap:v.spacing.gridSize*4,paddingTop:v.spacing(2),[v.breakpoints.up("sm")]:{paddingTop:v.spacing(12)}})}}},2038:(G,I,e)=>{"use strict";e.d(I,{Z:()=>p});var t=e(96540),n=e(12131),s=e(32196),r=e(40845),o=e(27746),m=e(14578),l=e(56034),i=e(16797);const u=({notice:c,onClick:y})=>{const f=(0,r.of)(d),P=c.severity==="error"||c.severity==="warning"?"exclamation-triangle":"file-landscape-alt";return c.inspect&&y?t.createElement(o.I,{className:f.notice,icon:P,iconSize:"md",key:c.severity,tooltip:c.text,onClick:a=>y(a,c.inspect)}):c.link?t.createElement("a",{className:f.notice,"aria-label":c.text,href:c.link,target:"_blank",rel:"noreferrer"},t.createElement(m.I,{name:P,style:{marginRight:"8px"},size:"md"})):t.createElement(l.m,{key:c.severity,content:c.text},t.createElement("span",{className:f.iconTooltip},t.createElement(m.I,{name:P,size:"md"})))},d=c=>({notice:(0,s.css)({background:"inherit",border:"none",borderRadius:c.shape.radius.default}),iconTooltip:(0,s.css)({color:`${c.colors.text.secondary}`,backgroundColor:"inherit",cursor:"auto",border:"none",borderRadius:`${c.shape.radius.default}`,padding:`${c.spacing(0,1)}`,height:` ${c.spacing(c.components.height.md)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,i.getFocusStyles)(c),zIndex:1},"&: focus:not(:focus-visible)":(0,i.getMouseFocusStyles)(c),"&:hover ":{boxShadow:`${c.shadows.z1}`,color:`${c.colors.text.primary}`,background:`${c.colors.background.secondary}`}})}),p=({frames:c,panelId:y})=>{const f=(0,t.useCallback)((a,E)=>{a.stopPropagation(),n.Ny.partial({inspect:y,inspectTab:E})},[y]),P={};for(const a of c)if(!(!a.meta||!a.meta.notices))for(const E of a.meta.notices)P[E.severity]=E;return t.createElement(t.Fragment,null,Object.values(P).map(a=>t.createElement(u,{notice:a,onClick:f,key:a.severity})))}},91126:(G,I,e)=>{"use strict";e.d(I,{M:()=>d});var t=e(37055),n=e(58972),s=e(1173),r=e(11261),o=e(28240),m=e(85200),l=e(88895);const i="hideSeriesFrom",u=(0,t.ZW)(i);function d(E,g,h,D){const{overrides:v}=h,C=E,T=v.findIndex(u);if(T<0){if(g===l.B.ToggleSelection){const A=p([C,...a(v,D)]);return{...h,overrides:[...h.overrides,A]}}const b=P(D,C),M=p(b);return{...h,overrides:[...h.overrides,M]}}const S=Array.from(v),[O]=S.splice(T,1);if(g===l.B.ToggleSelection){let b=y(O);const M=a(S,D);if(M.length>0&&(b=b.filter(R=>M.indexOf(R)<0)),b[0]===C&&b.length===1)return{...h,overrides:S};const A=p([C,...M]);return{...h,overrides:[...S,A]}}const x=c(O,C);return f(x,D)?{...h,overrides:S}:{...h,overrides:[...S,x]}}function p(E,g=n.PP.exclude,h){return h=h??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:i,matcher:{id:s.Ct.byNames,options:{mode:g,names:E,prefix:g===n.PP.exclude?"All except:":void 0,readOnly:!0}},properties:[{...h,value:{viz:!0,legend:!1,tooltip:!1}}]}}const c=(E,g,h=n.PP.exclude)=>{const D=E.properties.find(T=>T.id==="custom.hideFrom"),v=y(E),C=v.findIndex(T=>T===g);return C<0?v.push(g):v.splice(C,1),p(v,h,D)},y=E=>{const g=E.matcher.options?.names;return Array.isArray(g)?[...g]:[]},f=(E,g)=>y(E).length===P(g).length,P=(E,g)=>{const h=new Set;for(const D of E)for(const v of D.fields){if(v.type!==r.PU.number)continue;const C=(0,o.Ct)(v,D,E);C!==g&&h.add(C)}return Array.from(h)},a=(E,g)=>{let h=[];for(const D of E){const v=D.properties.find(C=>C.id==="custom.hideFrom");if(v!==void 0&&v.value?.legend===!0){const T=m.sJ.get(D.matcher.id).get(D.matcher.options);for(const S of g)for(const O of S.fields){if(O.type!==r.PU.number)continue;const x=(0,o.Ct)(O,S,g);T(O,S,g)&&h.push(x)}}}return h}},61582:(G,I,e)=>{"use strict";e.d(I,{a:()=>i});var t=e(49426),n=e(47232),s=e(85858);const r=100;class o{constructor(){this.listeners=[],this.budget=1,this.threshold=1.5,this.ok=new t.t(!0),this.lastUpdate=Date.now(),this.isLive=!1,this.liveTimeOffset=0,this.measure=()=>{const d=Date.now();this.budget=(d-this.lastUpdate)/r;const p=this.ok.getValue(),c=this.budget<=this.threshold;if(p!==c&&this.ok.next(c),this.lastUpdate=d,this.isLive&&this.ok.getValue()&&this.timeRange){let y;for(const f of this.listeners){if(!f.panel.props.isInView)continue;if(d-f.last>=f.intervalMs){if(!y){const{raw:a}=this.timeRange;y={raw:a,from:(0,n.KQ)(d-this.liveTimeOffset),to:(0,n.KQ)(d)}}f.panel.liveTimeChanged(y),f.last=d}}}}}setLiveTimeRange(d){if(this.timeRange=d,this.isLive=d?.raw?.to==="now",this.isLive){const p=s.parse(d.raw.from,!1)?.valueOf(),c=s.parse(d.raw.to,!0)?.valueOf();this.liveTimeOffset=c-p;for(const y of this.listeners)y.intervalMs=l(this.liveTimeOffset,y.panel.props.width)}}listen(d){this.listeners.push({last:this.lastUpdate,panel:d,intervalMs:l(6e4,d.props.width)})}remove(d){this.listeners=this.listeners.filter(p=>p.panel!==d)}updateInterval(d){if(!(!this.timeRange||!this.isLive)){for(const p of this.listeners)if(p.panel===d){p.intervalMs=l(this.liveTimeOffset,p.panel.props.width);return}}}}const m=5*60*1e3;function l(u,d){const p=Math.ceil(u/d/100)*100;return p>m?m:p}const i=new o;setInterval(i.measure,r)},17493:(G,I,e)=>{"use strict";e.d(I,{Fu:()=>D,np:()=>v});var t=e(34796),n=e.n(t),s=e(2543),r=e.n(s),o=e(95093),m=e.n(o),l=e(26272),i=e(85858),u=e(17172),d=e(12131),p=e(27677),c=e(62301),y=e(68576),f=e(72255),P=e(31193),a=e(10096),E=e(28676),g=e(14792),h=e(69064);class D{constructor(){}_dashboardLoadFailed(S,O){return O=O||!1,{meta:{canStar:!1,isSnapshot:O,canDelete:!1,canSave:!1,canEdit:!1,canShare:!1,dashboardNotFound:!0},dashboard:{title:S,uid:S,schemaVersion:0}}}loadDashboard(S,O,x){const b=(0,f.sP)();let M;if(S==="script"&&O)M=this._loadScriptedDashboard(O);else if(S==="snapshot"&&O)M=(0,h.s)().getSnapshot(O).catch(()=>this._dashboardLoadFailed("Snapshot not found",!0));else if(S==="ds"&&O)M=this._loadFromDatasource(O);else if(S==="public"&&x)M=p.IB.getPublicDashboardByUid(x).then(A=>A).catch(A=>{const R=A.data.statusCode===403&&A.data.messageId==="publicdashboards.notEnabled",B=A.data.statusCode===404&&A.data.messageId==="publicdashboards.notFound",U=A.data.statusCode===404&&A.data.messageId==="publicdashboards.dashboardNotFound",W=this._dashboardLoadFailed(R?"Public Dashboard paused":"Public Dashboard Not found",!0);return{...W,meta:{...W.meta,publicDashboardEnabled:B?void 0:!R,dashboardNotFound:B||U}}});else if(x){const A=b.getFromCache(x);if(A)return Promise.resolve(A);M=(0,E.n)().getDashboardDTO(x).then(R=>{if(R.meta.isFolder)throw a.lE.emit(l.r1.alertError,["Dashboard not found"]),new Error("Dashboard not found");return R}).catch(()=>this._dashboardLoadFailed("Not found",!0))}else throw new Error("Dashboard uid or slug required");return M.then(A=>(A.meta.dashboardNotFound!==!0&&c.A.addDashboardImpression(A.dashboard.uid),A)),M}_loadScriptedDashboard(S){const O="public/dashboards/"+S.replace(/\.(?!js)/,"/")+"?"+new Date().getTime();return(0,u.AI)().get(O).then(this._executeScript.bind(this)).then(x=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:x.data}),x=>(console.error("Script dashboard error "+x),a.lE.emit(l.r1.alertError,["Script Error","Please make sure it exists and returns a valid dashboard"]),this._dashboardLoadFailed("Scripted dashboard")))}async _loadFromDatasource(S){const O=await(0,P.tR)().get(S);if(!O)return Promise.reject("can not find datasource: "+S);const x=new URLSearchParams(window.location.search),b=x.get("path");if(!b)return Promise.reject("expecting path parameter");const M={};return x.forEach((A,R)=>{M[R]=A}),(0,u.AI)().get(`/api/datasources/uid/${O.uid}/resources/${b}`,M).then(A=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:A}))}_executeScript(S){const O={dashboardSrv:(0,g.UA)(),datasourceSrv:(0,P.tR)()},b=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",S)(d.Ny.getSearchObject(),y.A,i,r(),m(),window,document,n(),n(),O);return(0,s.isFunction)(b)?new Promise(M=>{b(A=>{M({data:A})})}):{data:b}}}let v=new D;const C=T=>{throw new Error("dashboardLoaderSrv can be only overriden in test environment")}},14792:(G,I,e)=>{"use strict";e.d(I,{UA:()=>y});var t=e(75505),n=e(26272),s=e(28138),r=e(8484),o=e(27677),m=e(28676),l=e(28444),i=e(98365),u=e(19752);class d{constructor(){this.onRemovePanel=P=>{const a=this.getCurrent();a&&(0,u.FC)(a,a.getPanelById(P),!0)},s.l.subscribe(l.Vz,P=>this.onRemovePanel(P.payload))}create(P,a){return new i.G(P,a)}setCurrent(P){this.dashboard=P}getCurrent(){return this.dashboard}saveJSONDashboard(P){const a=JSON.parse(P);return(0,m.n)().saveDashboard({dashboard:a,folderUid:this.dashboard?.meta.folderUid||a.folderUid})}saveDashboard(P,a){return(0,t.s)((0,o.AI)().fetch({url:"/api/dashboards/db/",method:"POST",data:{...P,dashboard:P.dashboard.getSaveModelClone()},...a}))}starDashboard(P,a){const E=(0,o.AI)(),g={showSuccessAlert:!1,url:"/api/user/stars/dashboard/uid/"+P,method:a?"DELETE":"POST"};return E.request(g).then(()=>{const h=!a;this.dashboard?.uid===P&&(this.dashboard.meta.isStarred=h);const D=h?(0,r.t)("notifications.starred-dashboard","Dashboard starred"):(0,r.t)("notifications.unstarred-dashboard","Dashboard unstarred");return s.l.emit(n.r1.alertSuccess,[D]),h})}}let p;function c(f){p=f}function y(){return p||(p=new d),p}},69064:(G,I,e)=>{"use strict";e.d(I,{s:()=>i});var t=e(75505),n=e(81160),s=e(17172),r=e(32264),o=e(10096);const m={create:u=>(0,s.AI)().post("/api/snapshots",u),getSnapshots:()=>(0,s.AI)().get("/api/dashboard/snapshots"),getSharingOptions:()=>(0,s.AI)().get("/api/snapshot/shared-options"),deleteSnapshot:u=>(0,s.AI)().delete("/api/snapshots/"+u),getSnapshot:async u=>{const d=await(0,s.AI)().get("/api/snapshots/"+u);return d.meta.canShare=!1,d}};class l{constructor(){this.apiVersion="dashboardsnapshot.grafana.app/v0alpha1",this.url=`/apis/${this.apiVersion}/namespaces/${r.$.namespace}/dashboardsnapshots`}async create(d){return(0,s.AI)().post(this.url+"/create",d)}async getSnapshots(){return(await(0,s.AI)().get(this.url)).items.map(p=>({key:p.metadata.name,name:p.spec.title,external:p.spec.externalUrl!=null,externalUrl:p.spec.externalUrl}))}deleteSnapshot(d){return(0,s.AI)().delete(this.url+"/"+d)}async getSharingOptions(){return(0,s.AI)().get("/api/snapshot/shared-options")}async getSnapshot(d){const p={};if(!o.TP.isSignedIn){alert("TODO... need a barer token for anonymous use case");const c=`??? TODO, get anon token for snapshots (${o.TP.user?.name}) ???`;p.Authorization=`Bearer ${c}`}return(0,t.s)((0,s.AI)().fetch({url:this.url+"/"+d+"/body",method:"GET",headers:p}).pipe((0,n.T)(c=>({dashboard:c.data.dashboard,meta:{isSnapshot:!0,canSave:!1,canEdit:!1,canAdmin:!1,canStar:!1,canShare:!1,canDelete:!1,isFolder:!1,provisioned:!1}}))))}}function i(){return r.$.featureToggles.kubernetesSnapshots?new l:m}},74856:(G,I,e)=>{"use strict";e.d(I,{jG:()=>v});var t=e(2543),n=e(47232),s=e(43127),r=e(65879),o=e(26272),m=e(85858),l=e(12131),i=e(16401),u=e(76412),d=e(28138),p=e(2913),c=e(16233),y=e(80582),f=e(21380),P=e(28444),a=e(11134);function E({urlRefresh:C,currentRefresh:T,isAllowedIntervalFn:S,minRefreshInterval:O,refreshIntervals:x=a.cb}){if(!C)return T;const b=S(C),M=x.find(A=>A===C);if(!b||!M){const A=O?x.find(B=>B===O):void 0,R=x?.length?x[0]:void 0;return A??R??T}return C||T}class g{constructor(T){this.contextSrv=T,this.timeRangeForUrl=()=>{const S=this.timeRange().raw;return(0,n.Ar)(S.from)&&(S.from=S.from.valueOf().toString()),(0,n.Ar)(S.to)&&(S.to=S.to.valueOf().toString()),S},this.time=(0,s.E2)().raw,this.timeAtLoad=(0,s.E2)().raw,this.refreshTimeModel=this.refreshTimeModel.bind(this),d.A.subscribe(P.U0,S=>{this.zoomOut(S.payload.scale,S.payload.updateUrl)}),d.A.subscribe(P.Io,S=>{this.shiftTime(S.payload.direction,S.payload.updateUrl)}),d.A.subscribe(P.Rh,S=>{this.makeAbsoluteTime(S.payload.updateUrl)}),d.A.subscribe(P.Bt,()=>{this.copyTimeRangeToClipboard()}),d.A.subscribe(P.VZ,S=>{this.pasteTimeRangeFromClipboard(S.payload.updateUrl)}),document.addEventListener("visibilitychange",()=>{this.autoRefreshBlocked&&document.visibilityState==="visible"&&(this.autoRefreshBlocked=!1,this.refreshTimeModel())})}init(T){this.timeModel=T,this.time=T.time,this.refresh=T.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=(0,t.cloneDeep)(this.time),this.refresh&&this.setAutoRefresh(this.refresh)}getValidIntervals(T){return this.contextSrv.getValidIntervals(T)}parseTime(){(0,t.isString)(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=(0,n.KQ)(this.time.from).utc()),(0,t.isString)(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=(0,n.KQ)(this.time.to).utc())}parseUrlParam(T){if(T.indexOf("now")!==-1)return T;if(T.length===8){const S=(0,n.yT)(T,"YYYYMMDD");if(S.isValid())return S}else if(T.length===15){const S=(0,n.yT)(T,"YYYYMMDDTHHmmss");if(S.isValid())return S}if(!isNaN(Number(T))){const S=parseInt(T,10);return(0,n.yT)(S)}return null}getTimeWindow(T,S){const O=parseInt(T,10);let x;return S.match(/^\d+$/)&&parseInt(S,10)?x=parseInt(S,10):x=r.intervalToMs(S),{from:(0,n.yT)(O-x/2),to:(0,n.yT)(O+x/2)}}initTimeFromUrl(){if(p.config.publicDashboardAccessToken&&this.timeModel?.timepicker?.hidden)return;const T=l.Ny.getSearch();T.get("time")&&T.get("time.window")&&(this.time=this.getTimeWindow(T.get("time"),T.get("time.window"))),T.get("from")&&(this.time.from=this.parseUrlParam(T.get("from"))||this.time.from),T.get("to")&&(this.time.to=this.parseUrlParam(T.get("to"))||this.time.to),T.get("to")&&T.get("to").indexOf("now")===-1&&(this.refresh=!1,this.timeModel&&(this.timeModel.refresh=void 0)),this.refresh=E({urlRefresh:T.get("refresh"),currentRefresh:this.refresh,refreshIntervals:Array.isArray(this.timeModel?.timepicker?.refresh_intervals)?this.timeModel?.timepicker?.refresh_intervals:void 0,isAllowedIntervalFn:this.contextSrv.isAllowedInterval,minRefreshInterval:p.config.minRefreshInterval})}updateTimeRangeFromUrl(){const T=l.Ny.getSearch();if(T.get("left"))return;const S=this.timeRangeForUrl(),O=T.get("from"),x=T.get("to");O&&x?(O!==S.from||x!==S.to)&&(this.initTimeFromUrl(),this.setTime(this.time,!1)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)}timeHasChangedSinceLoad(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)}setAutoRefresh(T){this.timeModel&&(this.timeModel.refresh=T),this.stopAutoRefresh();const S=l.Ny.getSearchObject();if(!T){S.refresh&&l.Ny.partial({refresh:null},!0);return}let O=T,x=60*1e3;T===c.SM?x=this.getAutoRefreshInteval().intervalMs:(O=this.contextSrv.getValidInterval(T),x=r.intervalToMs(O)),this.refreshMS=x,this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(x),this.refreshTimeModel()},x),S.refresh!==O&&l.Ny.partial({refresh:O},!0)}getAutoRefreshInteval(){const T=window?.innerWidth??2e3;return r.calculateInterval(this.timeRange(),T,p.config.minRefreshInterval)}refreshTimeModel(){this.timeModel?.timeRangeUpdated(this.timeRange())}startNextRefreshTimer(T){this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(T),this.contextSrv.isGrafanaVisible()?this.refreshTimeModel():this.autoRefreshBlocked=!0},T)}stopAutoRefresh(){clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.refreshMS=void 0}resumeAutoRefresh(){this.timeModel?.refresh&&this.setAutoRefresh(this.timeModel.refresh)}setTime(T,S=!0){if((0,t.extend)(this.time,T),(0,n.Ar)(T.to)?(this.oldRefresh=this.timeModel?.refresh||this.oldRefresh,this.setAutoRefresh("")):this.oldRefresh&&this.oldRefresh!==this.timeModel?.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=void 0),S===!0){const O=this.timeRangeForUrl(),x=l.Ny.getSearchObject();if(x.from===O.from.toString()&&x.to===O.to.toString())return;x.from=O.from.toString(),x.to=O.to.toString(),l.Ny.partial(x)}this.timeModel?.refresh===c.SM&&this.getAutoRefreshInteval().intervalMs!==this.refreshMS&&this.setAutoRefresh(c.SM),this.refreshTimeModel()}timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?i.jh.getTimeRange(window.__grafanaSceneContext).state.value:(0,f.z)(this.time,this.timeModel)}zoomOut(T,S=!0){const O=this.timeRange(),{from:x,to:b}=(0,y.Zk)(O,T);this.setTime({from:(0,n.yT)(x),to:(0,n.yT)(b)},S)}shiftTime(T,S=!0){const O=this.timeRange(),{from:x,to:b}=(0,y.Wb)(T,O);this.setTime({from:(0,n.yT)(x),to:(0,n.yT)(b)},S)}makeAbsoluteTime(T){const{from:S,to:O}=this.timeRange();this.setTime({from:S,to:O},T)}copyTimeRangeToClipboard(){const{raw:T}=this.timeRange();navigator.clipboard.writeText(JSON.stringify({from:T.from,to:T.to})),d.A.emit(o.r1.alertSuccess,[(0,u.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}async pasteTimeRangeFromClipboard(T=!0){const{range:S,isError:O}=await(0,y.zG)();if(O===!0){d.A.emit(o.r1.alertError,[(0,u.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,u.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:S})]);return}const{from:x,to:b}=S;this.setTime({from:x,to:b},T)}isRefreshOutsideThreshold(T,S=.05){const O=this.timeRange();if(m.isMathString(O.raw.from)){const x=O.to.diff(O.from),b=Date.now()-T,M=x*S;return b>=M}return!1}}let h;function D(C){h=C}function v(){return h||(h=new g(c.TP)),h}},79056:(G,I,e)=>{"use strict";e.d(I,{O2:()=>N,SW:()=>w,og:()=>H});var t=e(2543),n=e(69550),s=e(92041),r=e(12470),o=e(22391),m=e(76885),l=e(6709),i=e(25019),u=e(47737),d=e(1173),p=e(11261),c=e(6829),y=e(58140),f=e(19347),P=e(52622),a=e(57021),E=e(33919),g=e(2913),h=e(15054);function D(z){return Array.from(new Array(z+1),(te,ie)=>ie).filter(te=>z%te===0)}var v=e(68576),C=e(31193),T=e(24240),S=e(86886),O=e(14678),x=e(14738),b=e(36373),M=e(77789),A=e(25640);function R(z,te){const ie=[];if(z?.statistics&&z?.statistics.length){z.statistic=z.statistics[0];for(const ce of z.statistics.splice(1))ie.push({...z,statistic:ce})}for(const ce of ie)ce.refId=(0,M.M)(te),delete ce.statistics,te.push(ce);return delete z.statistics,ie}function B(z){const te=[];if(z&&"statistics"in z&&z?.statistics?.length){for(const ie of z.statistics.splice(1)){const{statistics:ce,name:ue,...fe}=z;te.push({...fe,statistic:ie,name:`${ue} - ${ie}`})}z.statistic=z.statistics[0],te.length!==0&&(z.name=`${z.name} - ${z.statistic}`),delete z.statistics}return te}function U(z){z.hasOwnProperty("metricQueryType")||(z.metricQueryType=A.d$.Search),z.hasOwnProperty("metricEditorMode")||(z.metricQueryType===A.d$.Query?z.metricEditorMode=A.Rx.Code:z.metricEditorMode=z.expression?A.Rx.Code:A.Rx.Builder)}var W=e(84423);n.D.setInit(E.H),n.G.setInit(E.u);const N=39;class w{constructor(te){this.dashboard=te,(0,f.l)()||(0,f.h)(new C.xq)}updateSchema(te){let ie,ce,ue,fe;const Te=this.dashboard.schemaVersion,he=[];if(this.dashboard.schemaVersion=N,Te!==this.dashboard.schemaVersion){if(Te<2&&(te.services&&te.services.filter&&(this.dashboard.time=te.services.filter.time,this.dashboard.templating.list=te.services.filter.list||[]),he.push(de=>(de.type==="graphite"&&(de.type="graph"),de.type!=="graph"||((0,t.isBoolean)(de.legend)&&(de.legend={show:de.legend}),de.grid&&(de.grid.min&&(de.grid.leftMin=de.grid.min,delete de.grid.min),de.grid.max&&(de.grid.leftMax=de.grid.max,delete de.grid.max)),de.y_format&&(de.y_formats||(de.y_formats=[]),de.y_formats[0]=de.y_format,delete de.y_format),de.y2_format&&(de.y_formats||(de.y_formats=[]),de.y_formats[1]=de.y2_format,delete de.y2_format)),de))),Te<3){let de=this.dashboard.getNextPanelId();he.push(le=>(le.id||(le.id=de,de+=1),le))}if(Te<4&&he.push(de=>(de.type!=="graph"||((0,t.each)(de.aliasYAxis,(le,pe)=>{de.seriesOverrides=[{alias:pe,yaxis:le}]}),delete de.aliasYAxis),de)),Te<6){const de=(0,t.find)(te.pulldowns,{type:"annotations"});for(de&&(this.dashboard.annotations={list:de.annotations||[]}),ie=0;ie<this.dashboard.templating.list.length;ie++){const le=this.dashboard.templating.list[ie];le.datasource===void 0&&(le.datasource=null),le.type==="filter"&&(le.type="query"),le.type===void 0&&(le.type="query"),le.allFormat===void 0&&delete le.allFormat}}if(Te<7&&(te.nav&&te.nav.length&&(this.dashboard.timepicker=te.nav[0]),he.push(de=>((0,t.each)(de.targets,le=>{le.refId||(le.refId=de.getNextQueryLetter&&de.getNextQueryLetter())}),de))),Te<8&&he.push(de=>((0,t.each)(de.targets,le=>{le.fields&&le.tags&&le.groupBy&&(le.rawQuery?(delete le.fields,delete le.fill):(le.select=(0,t.map)(le.fields,pe=>{const ve=[];return ve.push({type:"field",params:[pe.name]}),ve.push({type:pe.func,params:[]}),pe.mathExpr&&ve.push({type:"math",params:[pe.mathExpr]}),pe.asExpr&&ve.push({type:"alias",params:[pe.asExpr]}),ve}),delete le.fields,(0,t.each)(le.groupBy,pe=>{pe.type==="time"&&pe.interval&&(pe.params=[pe.interval],delete pe.interval),pe.type==="tag"&&pe.key&&(pe.params=[pe.key],delete pe.key)}),le.fill&&(le.groupBy.push({type:"fill",params:[le.fill]}),delete le.fill)))}),de)),Te<9&&he.push(de=>{if(de.type!=="singlestat"&&de.thresholds!=="")return de;if(de.thresholds){const le=de.thresholds.split(",");le.length>=3&&(le.shift(),de.thresholds=le.join(","))}return de}),Te<10&&he.push(de=>(de.type!=="table"||(0,t.each)(de.styles,le=>{if(le.thresholds&&le.thresholds.length>=3){const pe=le.thresholds;pe.shift(),le.thresholds=pe}}),de)),Te<12&&(0,t.each)(this.dashboard.getVariables(),de=>{"refresh"in de&&(de.refresh&&(de.refresh=1),de.refresh||(de.refresh=0)),"hideVariable"in de&&de.hideVariable?de.hide=2:"hideLabel"in de&&de.hideLabel&&(de.hide=1)}),Te<12&&he.push(de=>(de.type!=="graph"||!de.grid||de.yaxes||(de.yaxes=[{show:de["y-axis"],min:de.grid.leftMin,max:de.grid.leftMax,logBase:de.grid.leftLogBase,format:de.y_formats[0],label:de.leftYAxisLabel},{show:de["y-axis"],min:de.grid.rightMin,max:de.grid.rightMax,logBase:de.grid.rightLogBase,format:de.y_formats[1],label:de.rightYAxisLabel}],de.xaxis={show:de["x-axis"]},delete de.grid.leftMin,delete de.grid.leftMax,delete de.grid.leftLogBase,delete de.grid.rightMin,delete de.grid.rightMax,delete de.grid.rightLogBase,delete de.y_formats,delete de.leftYAxisLabel,delete de.rightYAxisLabel,delete de["y-axis"],delete de["x-axis"]),de)),Te<13&&he.push(de=>{if(de.type!=="graph"||!de.grid)return de;de.thresholds||(de.thresholds=[]);const le={},pe={};return de.grid.threshold1!==null&&(le.value=de.grid.threshold1,de.grid.thresholdLine?(le.line=!0,le.lineColor=de.grid.threshold1Color,le.colorMode="custom"):(le.fill=!0,le.fillColor=de.grid.threshold1Color,le.colorMode="custom")),de.grid.threshold2!==null&&(pe.value=de.grid.threshold2,de.grid.thresholdLine?(pe.line=!0,pe.lineColor=de.grid.threshold2Color,pe.colorMode="custom"):(pe.fill=!0,pe.fillColor=de.grid.threshold2Color,pe.colorMode="custom")),(0,t.isNumber)(le.value)&&((0,t.isNumber)(pe.value)?le.value>pe.value?(le.op=pe.op="lt",de.thresholds.push(le),de.thresholds.push(pe)):(le.op=pe.op="gt",de.thresholds.push(le),de.thresholds.push(pe)):(le.op="gt",de.thresholds.push(le))),delete de.grid.threshold1,delete de.grid.threshold1Color,delete de.grid.threshold2,delete de.grid.threshold2Color,delete de.grid.thresholdLine,de}),Te<14&&(this.dashboard.graphTooltip=te.sharedCrosshair?1:0),Te<16&&this.upgradeToGridLayout(te),Te<17&&he.push(de=>{if(de.minSpan){const le=h.cV/de.minSpan,pe=D(h.cV);de.maxPerRow=pe[(0,t.findIndex)(pe,ve=>ve>le)-1]}return delete de.minSpan,de}),Te<18&&he.push(de=>(de["options-gauge"]&&(de.options=de["options-gauge"],de.options.valueOptions={unit:de.options.unit,stat:de.options.stat,decimals:de.options.decimals,prefix:de.options.prefix,suffix:de.options.suffix},de.options.thresholds&&de.options.thresholds.reverse(),delete de.options.options,delete de.options.unit,delete de.options.stat,delete de.options.decimals,delete de.options.prefix,delete de.options.suffix,delete de["options-gauge"]),de)),Te<19&&he.push(de=>(de.links&&(0,t.isArray)(de.links)&&(de.links=de.links.map(K)),de)),Te<20){const de=le=>({...le,url:k(le.url)});he.push(le=>(le.options&&le.options.dataLinks&&(0,t.isArray)(le.options.dataLinks)&&(le.options.dataLinks=le.options.dataLinks.map(de)),le.options&&le.options.fieldOptions&&le.options.fieldOptions.defaults&&(le.options.fieldOptions.defaults.links&&(0,t.isArray)(le.options.fieldOptions.defaults.links)&&(le.options.fieldOptions.defaults.links=le.options.fieldOptions.defaults.links.map(de)),le.options.fieldOptions.defaults.title&&(le.options.fieldOptions.defaults.title=k(le.options.fieldOptions.defaults.title))),le))}if(Te<21){const de=le=>({...le,url:le.url.replace(/__series.labels/g,"__field.labels")});he.push(le=>(le.options&&le.options.dataLinks&&(0,t.isArray)(le.options.dataLinks)&&(le.options.dataLinks=le.options.dataLinks.map(de)),le.options&&le.options.fieldOptions&&le.options.fieldOptions.defaults&&le.options.fieldOptions.defaults.links&&(0,t.isArray)(le.options.fieldOptions.defaults.links)&&(le.options.fieldOptions.defaults.links=le.options.fieldOptions.defaults.links.map(de)),le))}if(Te<22&&he.push(de=>(de.type!=="table"||(0,t.each)(de.styles,le=>{le.align="auto"}),de)),Te<23)for(const de of this.dashboard.templating.list){if(!(0,T.iv)(de))continue;const{multi:le,current:pe}=de;(0,s.R)(pe)||(de.current=(0,S.C)(pe,le))}if(Te<24&&he.push(de=>{const le=de.type==="table";if(le&&!de.styles)return de;const pe=de.table==="table2";return!le||pe||(de.type=le?"table-old":"table"),de}),Te<25,Te<26&&he.push(de=>(de.type==="text2"&&(de.type="text",delete de.options.angular),de)),Te<27&&(this.removeRepeatedPanels(),this.dashboard.templating.list=this.dashboard.templating.list.map(de=>{if(!(0,T.VO)(de))return de;const le={...de};return le.current={selected:!0,text:le.query??"",value:le.query??""},le.options=[le.current],le.hide===r.zL.dontHide||le.hide===r.zL.hideLabel?{...le,type:"textbox"}:le})),Te<28){he.push(de=>de.type==="singlestat"?j(de):de);for(const de of this.dashboard.templating.list)de.tags&&delete de.tags,de.tagsQuery&&delete de.tagsQuery,de.tagValuesQuery&&delete de.tagValuesQuery,de.useTags&&delete de.useTags}if(Te<29)for(const de of this.dashboard.templating.list)de.type==="query"&&(de.refresh!==1&&de.refresh!==2&&(de.refresh=1),de.options?.length&&(de.options=[]));if(Te<30&&(he.push(X),he.push(q)),Te<31&&he.push(de=>{if(de.transformations){for(const le of de.transformations)if(le.id===c.V.id)return J(de,c.V.id,{id:y.o.id,options:{}})}return de}),Te<32,Te<33&&he.push(de=>{if(de.datasource=H(de.datasource,{returnDefaultAsNull:!0}),!de.targets)return de;for(const le of de.targets){const pe=H(le.datasource,{returnDefaultAsNull:!0});pe!=null&&(le.datasource=pe)}return de}),Te<34&&(he.push(de=>(this.migrateCloudWatchQueries(de),de)),this.migrateCloudWatchAnnotationQuery()),Te<35&&he.push(ee),Te<36){for(const le of this.dashboard.annotations.list)le.datasource=H(le.datasource,{returnDefaultAsNull:!1});const de=(0,f.l)().getInstanceSettings(null);if(de){for(const le of this.dashboard.templating.list)le.type==="query"&&le.datasource===null&&(le.datasource=(0,o.p$)(de));he.push(le=>{if(le.targets){let pe=!1;le.datasource==null&&le.targets.length>0&&(le.datasource=(0,o.p$)(de),pe=!0);for(const ve of le.targets)(ve.datasource==null||ve.datasource.uid==null)&&(le.datasource?.uid!==O.uv?ve.datasource={...le.datasource}:ve.datasource=H(ve.datasource,{returnDefaultAsNull:!1})),pe&&ve.datasource?.uid!=="__expr__"&&(le.datasource=ve.datasource)}return le})}}if(Te<37&&he.push(de=>(de.options?.legend&&(de.options.legend.displayMode==="hidden"||de.options.legend.showLegend===!1)?(de.options.legend.displayMode="list",de.options.legend.showLegend=!1):de.options?.legend&&(de.options.legend={...de.options?.legend,showLegend:!0}),de)),Te<38&&he.push(de=>{if(de.type==="table"&&de.fieldConfig!==void 0){const le=de.fieldConfig.defaults?.custom?.displayMode;if(le!==void 0&&(de.fieldConfig.defaults.custom.cellOptions=(0,a.o7)(le),delete de.fieldConfig.defaults.custom.displayMode),de.fieldConfig?.overrides)for(const pe of de.fieldConfig.overrides)for(let ve=0;ve<pe.properties?.length;ve++){let be=pe.properties[ve].value;pe.properties[ve].id==="custom.displayMode"&&(pe.properties[ve].id="custom.cellOptions",pe.properties[ve].value=(0,a.o7)(be))}}return de}),Te<39&&he.push(de=>(de.transformations?.forEach(le=>{if(le.id==="timeSeriesTable"&&le.options!==void 0&&le.options.refIdToStat!==void 0){let pe={};for(const[ve,be]of Object.entries(le.options.refIdToStat)){let Oe={};Oe.stat=be,pe[ve]=Oe}le.options=pe}}),de)),he.length!==0)for(ce=0;ce<this.dashboard.panels.length;ce++)for(ue=0;ue<he.length;ue++){this.dashboard.panels[ce]=he[ue].call(this,this.dashboard.panels[ce]);const de=this.dashboard.panels[ce].panels;if(de)for(fe=0;fe<de.length;fe++)de[fe]=he[ue].call(this,de[fe])}}}removeRepeatedPanels(){const te=[];for(const ie of this.dashboard.panels)ie.repeatPanelId||ie.repeatByRow||(ie.type==="row"&&Array.isArray(ie.panels)&&(ie.panels=ie.panels.filter(ce=>!ce.repeatPanelId)),te.push(ie));this.dashboard.panels=te}migrateCloudWatchQueries(te){for(const ie of te.targets||[])if(se(ie)&&(U(ie),ie.hasOwnProperty("statistics"))){const ce=R(ie,[...te.targets]);for(const ue of ce)te.targets.push(ue)}}migrateCloudWatchAnnotationQuery(){for(const te of this.dashboard.annotations.list)if(ae(te)){const ie=B(te);for(const ce of ie)this.dashboard.annotations.list.push(ce)}}upgradeToGridLayout(te){let ie=0;const ce=h.cV/12;let fe=(0,t.max)((0,t.flattenDeep)((0,t.map)(te.rows,he=>(0,t.map)(he.panels,"id"))))+1;if(!te.rows)return;const Te=(0,t.some)(te.rows,he=>he.collapse||he.showTitle||he.repeat);for(const he of te.rows){if(he.repeatIteration)continue;const de=he.height||h.bJ,le=L(de),pe={};let ve;Te&&(pe.id=fe,pe.type="row",pe.title=he.title,pe.collapsed=he.collapse,pe.repeat=he.repeat,pe.panels=[],pe.gridPos={x:0,y:ie,w:h.cV,h:le},ve=new W.a9(pe),fe++,ie++);const be=new V(le,h.cV,ie);for(const Oe of he.panels){Oe.span=Oe.span||h.o9,Oe.minSpan&&(Oe.minSpan=Math.min(h.cV,h.cV/12*Oe.minSpan));const Me=Math.floor(Oe.span)*ce,Ue=Oe.height?L(Oe.height):le,we=be.getPanelPosition(Ue,Me);ie=be.yPos,Oe.gridPos={x:we.x,y:ie+we.y,w:Me,h:Ue},be.addPanel(Oe.gridPos),delete Oe.span,ve&&pe.collapsed?ve.panels?.push(Oe):this.dashboard.panels.push(new W.a9(Oe))}ve&&this.dashboard.panels.push(ve),ve&&pe.collapsed||(ie+=le)}}}function L(z){return(0,t.isString)(z)&&(z=parseInt(z.replace("px",""),10)),z<h.cx&&(z=h.cx),Math.ceil(z/(h.sD+h.dU))}class V{constructor(te,ie=h.cV,ce=0){this.area=new Array(ie).fill(0),this.yPos=ce,this.height=te}reset(){this.area.fill(0)}addPanel(te){for(let ie=te.x;ie<te.x+te.w;ie++)(!this.area[ie]||te.y+te.h-this.yPos>this.area[ie])&&(this.area[ie]=te.y+te.h-this.yPos);return this.area}getPanelPosition(te,ie,ce=!1){let ue,fe,Te;for(let he=this.area.length-1;he>=0&&this.height-this.area[he]>0;he--)if(fe===void 0)fe=he;else if(he<this.area.length-1&&this.area[he]<=this.area[he+1])ue=he;else break;if(ue!==void 0&&fe!==void 0&&fe-ue>=ie-1){const he=(0,t.max)(this.area.slice(ue));Te={x:ue,y:he}}else return ce?null:(this.yPos+=this.height,this.reset(),this.getPanelPosition(te,ie,!0));return Te}}function K(z){let te=z.url;return!te&&z.dashboard&&(te=`dashboard/db/${v.A.slugifyForUrl(z.dashboard)}`),!te&&z.dashUri&&(te=`dashboard/${z.dashUri}`),te||(te="/"),z.keepTime&&(te=m.kM.appendQueryToUrl(te,`$${l.c.keepTime}`)),z.includeVars&&(te=m.kM.appendQueryToUrl(te,`$${l.c.includeVars}`)),z.params&&(te=m.kM.appendQueryToUrl(te,z.params)),{url:te,title:z.title,targetBlank:z.targetBlank}}function k(z){const te=/(__series_name)|(\$__series_name)|(__value_time)|(__field_name)|(\$__field_name)/g;return z.replace(te,(ie,ce,ue,fe,Te,he)=>ce?"__series.name":ue?"${__series.name}":fe?"__value.time":Te?"__field.name":he?"${__field.name}":ie)}function j(z){if(g.config.panels["grafana-singlestat-panel"])return z.type="grafana-singlestat-panel",z;let te=!1;return z.changePlugin||(te=!0,z=new W.a9(z)),z.plugin={angularPanelCtrl:{}},z.gauge?.show?(x.plugin.meta=g.config.panels.gauge,z.changePlugin(x.plugin)):(b.plugin.meta=g.config.panels.stat,z.changePlugin(b.plugin)),te?z.getSaveModel():z}function H(z,te){if(te.returnDefaultAsNull&&(z==null||z==="default"))return null;if((0,o.fN)(z))return z;const ie=(0,f.l)().getInstanceSettings(z);return ie?(0,o.p$)(ie):{uid:z||void 0}}function J(z,te,ie){if(z.transformations){const ce=[];for(const ue of z.transformations)ce.push(ue),ue.id===te&&ce.push({...ie});z.transformations=ce}return z}function X(z){const te=z.fieldConfig;if(!te)return z;if(te.defaults&&te.defaults.mappings&&(te.defaults.mappings=ne(te.defaults.mappings,te.defaults.thresholds)),Array.isArray(te.overrides))for(const ie of te.overrides)for(const ce of ie.properties)ce.id==="mappings"&&(ce.value=ne(ce.value));return z}function se(z){return z.hasOwnProperty("dimensions")&&z.hasOwnProperty("namespace")&&z.hasOwnProperty("region")&&z.hasOwnProperty("metricName")}function ae(z){return z.hasOwnProperty("dimensions")&&z.hasOwnProperty("namespace")&&z.hasOwnProperty("region")&&z.hasOwnProperty("prefixMatching")&&z.hasOwnProperty("statistics")}function ne(z,te){if(!z)return;const ie={type:i.d.ValueToText,options:{}},ce=[];for(const ue of z){if(ue.type&&ue.options){ue.type===i.d.ValueToText?ie.options={...ie.options,...ue.options}:ce.push(ue);continue}let fe;const Te=parseFloat(ue.text);if(te&&!isNaN(Te)){const he=(0,u.yQ)(Te,te.steps);he&&he.color&&(fe=he.color)}switch(ue.type){case 1:ue.value!=null&&(ue.value==="null"?ce.push({type:i.d.SpecialValue,options:{match:i.W.Null,result:{text:ue.text,color:fe}}}):ie.options[String(ue.value)]={text:ue.text,color:fe});break;case 2:ce.push({type:i.d.RangeToText,options:{from:+ue.from,to:+ue.to,result:{text:ue.text,color:fe}}});break}}return Object.keys(ie.options).length>0&&ce.unshift(ie),ce}function q(z){return(z.type==="timeseries"||z.type==="xychart"||z.type==="xychart2")&&z.options.tooltipOptions&&(z.options={...z.options,tooltip:z.options.tooltipOptions},delete z.options.tooltipOptions),z}function ee(z){return z.type==="timeseries"&&z.fieldConfig?.defaults.custom?.axisPlacement===P.vM.Hidden&&(z.fieldConfig={...z.fieldConfig,overrides:[...z.fieldConfig.overrides,{matcher:{id:d.Ct.byType,options:p.PU.time},properties:[{id:"custom.axisPlacement",value:P.vM.Auto}]}]}),z}},98365:(G,I,e)=>{"use strict";e.d(I,{G:()=>U});var t=e(2543),n=e(64423),s=e(18226),r=e(72724),o=e(47232),m=e(3591),l=e(32264),i=e(24284),u=e(15054),d=e(16233),p=e(28874),c=e(8480),y=e(20601),f=e(72401),P=e(87421),a=e(31678),E=e(28444),g=e(10096),h=e(99140),D=e(80484),v=e(75096),C=e(74856),T=e(34214);const S=new Set(["gridPos","title","description","transparent"]);function O(w,L){const V=[],K={changed:!1,actions:{add:[],remove:[],replace:[],update:[],noop:[]},panels:V};let k=0;const j=new Map;for(let H of L){let{id:J}=H;J||(k||(k=b([w,L])),J=k++,H={...H,id:J}),j.set(J,H)}for(const H of w){const J=j.get(H.id);if(!J){K.changed=!0,K.actions.remove.push(H.id),H.destroy();continue}if(j.delete(H.id),J===H){V.push(H),K.actions.noop.push(H.id);continue}if(H.type===J.type){const se=H.getSaveModel();let ae=!0,ne=!1;for(const[q,ee]of Object.entries(J))if(!(0,t.isEqualWith)(ee,se[q],x))if(K.changed=!0,ae=!1,S.has(q))H[q]=ee,ne=!0;else{ne=!1;break}if(ae){V.push(H),K.actions.noop.push(H.id);continue}if(ne){V.push(H),K.actions.update.push(H.id);continue}}H.destroy();const X=new T.a(J);X.key=`${X.id}-update-${Date.now()}`,V.push(X),K.changed=!0,K.actions.replace.push(H.id)}for(const H of j.values())V.push(new T.a(H)),K.changed=!0,K.actions.add.push(H.id);return K}function x(w,L){if(w==null&&(L===1/0||L===-1/0||L==null)||L==null&&(w===1/0||w===-1/0||w==null))return!0}function b(w){let L=0;for(const V of w)for(const K of V)K.id>L&&(L=K.id);return L+1}var M=e(79056),A=e(84423);function R(w,L){return w.repeatDirection===u.HG?!1:L.gridPos.x>=w.gridPos.x+w.gridPos.w&&L.gridPos.y===w.gridPos.y}function B(w){for(const L of w)if(delete L.scopedVars,L.panels?.length)for(const V of L.panels)delete V.scopedVars}class U{constructor(L,V,K){this.timeRangeUpdatedDuringEditOrView=!1,this.originalDashboard=null,this.getVariablesFromState=K?.getVariablesFromState??P.SS,this.events=new s.o,this.id=L.id||null,this.uid=L.uid||null,this.revision=L.revision??void 0,this.title=L.title??"No Title",this.description=L.description,this.tags=L.tags??[],this.timezone=L.timezone??"",this.weekStart=L.weekStart??"",this.editable=L.editable!==!1,this.graphTooltip=L.graphTooltip||0,this.time=L.time??{from:"now-6h",to:"now"},this.timepicker=L.timepicker??{},this.liveNow=L.liveNow,this.templating=this.ensureListExist(L.templating),this.annotations=this.ensureListExist(L.annotations),this.refresh=L.refresh,this.snapshot=L.snapshot,this.schemaVersion=L.schemaVersion??0,this.fiscalYearStartMonth=L.fiscalYearStartMonth??0,this.version=L.version??0,this.links=L.links??[],this.gnetId=L.gnetId||null,this.panels=(0,t.map)(L.panels??[],k=>new A.a9(k)),this.originalDashboard=(0,t.cloneDeep)(L),this.originalTemplating=(0,t.cloneDeep)(this.templating),this.originalTime=(0,t.cloneDeep)(this.time),this.ensurePanelsHaveUniqueIds(),this.formatDate=this.formatDate.bind(this),this.initMeta(V),this.updateSchema(L),this.addBuiltInAnnotationQuery(),this.sortPanelsByGridPos(),this.panelsAffectedByVariableChange=null,this.appEventsSubscription=new n.yU,this.lastRefresh=Date.now(),this.appEventsSubscription.add(g.lE.subscribe(D.og,this.variablesChangedHandler.bind(this))),this.appEventsSubscription.add(g.lE.subscribe(D.BS,this.variablesTimeRangeProcessDoneHandler.bind(this))),this.appEventsSubscription.add(g.lE.subscribe(D.eF,this.variablesChangedInUrlHandler.bind(this)))}static{this.nonPersistedProperties={events:!0,meta:!0,panels:!0,templating:!0,originalTime:!0,originalTemplating:!0,originalLibraryPanels:!0,panelInEdit:!0,panelInView:!0,getVariablesFromState:!0,formatDate:!0,appEventsSubscription:!0,panelsAffectedByVariableChange:!0,lastRefresh:!0,timeRangeUpdatedDuringEditOrView:!0,originalDashboard:!0}}addBuiltInAnnotationQuery(){this.annotations.list.some(V=>V.builtIn===1)||this.annotations.list.unshift({datasource:{uid:"-- Grafana --",type:"grafana"},name:"Annotations & Alerts",type:"dashboard",iconColor:i.Mk,enable:!0,hide:!0,builtIn:1})}initMeta(L){L=L||{},L.canShare=L.canShare!==!1,L.canSave=L.canSave!==!1,L.canStar=L.canStar!==!1,L.canEdit=L.canEdit!==!1,L.canDelete=L.canDelete!==!1,L.showSettings=L.canEdit,L.canMakeEditable=L.canSave&&!this.editable,L.hasUnsavedFolderChange=!1,this.editable||(L.canEdit=!1,L.canDelete=!1,L.canSave=!1),this.meta=L}getSaveModelCloneOld(L){const V=(0,t.defaults)(L||{},{saveVariables:!0,saveTimerange:!0});let K={};for(const k in this)U.nonPersistedProperties[k]||!this.hasOwnProperty(k)||(K[k]=(0,t.cloneDeep)(this[k]));return K.templating=this.getTemplatingSaveModel(V),V.saveTimerange||(K.time=this.originalTime),K.panels=this.getPanelSaveModels(),K=(0,p.v)(K),K.getVariables=()=>K.templating.list,K}getSaveModelClone(L){const V=this.getSaveModelCloneOld(L),K=JSON.stringify(V);return JSON.parse(K)}updatePanels(L){const V=O(this.panels,L??[]);return V.changed&&(this.panels=V.panels??[],this.sortPanelsByGridPos(),this.events.publish(new E.Q$)),V}getPanelSaveModels(){return this.panels.filter(L=>this.isSnapshotTruthy()||!(L.repeatPanelId||L.repeatedByRow)).map(L=>{if(L.libraryPanel){const{id:V,title:K,libraryPanel:k,gridPos:j}=L;return{id:V,title:K,gridPos:j,libraryPanel:{uid:k.uid,name:k.name}}}return this.panelInEdit&&this.panelInEdit.id===L.id?this.panelInEdit.getSaveModel():L.getSaveModel()}).map(L=>(this.isSnapshotTruthy()||(delete L.scopedVars,L.type==="row"&&L.panels&&L.panels.length>0&&(L.panels=L.panels.filter(V=>!V.repeatPanelId).map(V=>(delete V.scopedVars,V)))),L))}getTemplatingSaveModel(L){const V=this.originalTemplating?.list??[],k=this.getVariablesFromState(this.uid).map(H=>{const J=y.B.get(H.type).getSaveModel(H,L.saveVariables);if(!L.saveVariables){const X=V.find(({name:se,type:ae})=>se===H.name&&ae===H.type);if(!X)return J;H.type==="adhoc"?J.filters=X.filters:(J.current=X.current,J.options=X.options)}return J});return{list:(0,p.v)(k)}}timeRangeUpdated(L){this.events.publish(new m.sR(L)),(0,h.JD)((0,f.RK)(this.uid,L)),(this.panelInEdit||this.panelInView)&&(this.timeRangeUpdatedDuringEditOrView=!0)}startRefresh(L={refreshAll:!0,panelIds:[]}){if(this.events.publish(new m._),this.lastRefresh=Date.now(),this.panelInEdit&&(L.refreshAll||L.panelIds.includes(this.panelInEdit.id))){this.panelInEdit.refresh();return}const V=this.panels.filter(K=>!this.otherPanelInFullscreen(K)&&(L.refreshAll||L.panelIds.includes(K.id)));if(!this.isSnapshot())for(const K of V)K.refreshWhenInView=!0;for(const K of V)K.refresh()}render(){this.events.publish(new E.XM);for(const L of this.panels)L.render()}panelInitialized(L){const V=L.getQueryRunner().getLastResult();!this.otherPanelInFullscreen(L)&&!V&&L.refresh()}otherPanelInFullscreen(L){return(this.panelInEdit||this.panelInView)&&!(L.isViewing||L.isEditing)}initEditPanel(L){return(0,C.jG)().stopAutoRefresh(),this.panelInEdit=L.getEditClone(),this.timeRangeUpdatedDuringEditOrView=!1,this.panelInEdit}exitPanelEditor(){this.panelInEdit.destroy(),this.panelInEdit=void 0,(0,C.jG)().resumeAutoRefresh(),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}initViewPanel(L){this.panelInView=L,this.timeRangeUpdatedDuringEditOrView=!1,L.setIsViewing(!0)}exitViewPanel(L){this.panelInView=void 0,L.setIsViewing(!1),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged(){(this.panelsAffectedByVariableChange||this.timeRangeUpdatedDuringEditOrView)&&(this.startRefresh({panelIds:this.panelsAffectedByVariableChange??[],refreshAll:this.timeRangeUpdatedDuringEditOrView}),this.panelsAffectedByVariableChange=null,this.timeRangeUpdatedDuringEditOrView=!1)}ensurePanelsHaveUniqueIds(){const L=new Set;let V=this.getNextPanelId();for(const K of this.panelIterator())(!K.id||L.has(K.id))&&(K.id=V++),L.add(K.id)}ensureListExist(L={}){return L.list??=[],L}getNextPanelId(){let L=0;for(const V of this.panelIterator())V.id>L&&(L=V.id);return L+1}*panelIterator(){for(const L of this.panels){yield L;const V=L.panels??[];for(const K of V)yield K}}forEachPanel(L){for(let V=0;V<this.panels.length;V++)L(this.panels[V],V)}getPanelById(L,V=!1){if(this.panelInEdit&&this.panelInEdit.id===L)return this.panelInEdit;if(V){for(const K of this.panelIterator())if(K.id===L)return K;return null}else return this.panels.find(K=>K.id===L)??null}canEditPanel(L){return!!(this.meta.canEdit&&L&&!L.repeatPanelId&&L.type!=="row")}canEditPanelById(L){return this.canEditPanel(this.getPanelById(L))}addPanel(L){L.id=this.getNextPanelId(),this.panels.unshift(new A.a9(L)),this.sortPanelsByGridPos(),this.events.publish(new E.Q$)}updateMeta(L){this.meta={...this.meta,...L},this.events.publish(new E.Cf)}makeEditable(){this.editable=!0,this.updateMeta({canMakeEditable:!1,canEdit:!0,canSave:!0})}sortPanelsByGridPos(){this.panels.sort((L,V)=>L.gridPos.y===V.gridPos.y?L.gridPos.x-V.gridPos.x:L.gridPos.y-V.gridPos.y)}clearUnsavedChanges(L,V){for(const K of this.panels)K.configRev=0;this.panelInEdit&&(this.panelInEdit.hasSavedPanelEditChange=this.panelInEdit.configRev>0,this.panelInEdit.configRev=0),this.originalDashboard=L,this.originalTemplating=L.templating,V.saveTimerange&&(this.originalTime=L.time)}hasUnsavedChanges(){return!!this.panels.find(V=>V.hasChanged)}cleanUpRepeats(){if(this.isSnapshotTruthy()||!this.hasVariables())return;B(this.panels);const L=this.panels.filter(V=>(!V.repeat||V.repeatedByRow)&&V.repeatPanelId);(0,t.pull)(this.panels,...L),L.map(V=>V.destroy()),this.sortPanelsByGridPos()}processRepeats(){if(!(this.isSnapshotTruthy()||!this.hasVariables()||this.panelInView)){this.cleanUpRepeats();for(let L=0;L<this.panels.length;L++){const V=this.panels[L];V.repeat&&this.repeatPanel(V,L)}this.sortPanelsByGridPos(),this.events.publish(new E.Q$)}}cleanUpRowRepeats(L){const V=L.map(k=>k.id),K=L.filter(k=>!k.repeat&&k.repeatPanelId&&V.includes(k.repeatPanelId));(0,t.pull)(L,...K),(0,t.pull)(this.panels,...K)}processRowRepeats(L){if(this.isSnapshotTruthy()||!this.hasVariables())return;let V=L.panels??[];if(!L.collapsed){const K=this.panels.findIndex(k=>k.id===L.id);V=this.getRowPanels(K)}this.cleanUpRowRepeats(V);for(const K of V)if(K.repeat){const k=this.panels.findIndex(j=>j.id===K.id);this.repeatPanel(K,k)}}getPanelRepeatClone(L,V,K){if(V===0)return L;const k=L.getSaveModel();k.id=this.getNextPanelId();const j=new A.a9(k);return this.panels.splice(K+V,0,j),j.repeatPanelId=L.id,j.repeat=void 0,this.panelInView?.id===j.id&&(j.setIsViewing(!0),this.panelInView=j),j}getRowRepeatClone(L,V,K){if(V===0){if(!L.collapsed){const J=this.getRowPanels(K);L.panels=J}return L}const k=new A.a9(L.getSaveModel());let j,H;return L.collapsed?(j=(0,t.cloneDeep)(L.panels)??[],k.panels=j,H=K+V):(j=this.getRowPanels(K),k.panels=j.map(J=>J.getSaveModel()),H=K+(j.length+1)*V),this.panels.splice(H,0,k),this.updateRepeatedPanelIds(k),k}repeatPanel(L,V){const K=this.getPanelRepeatVariable(L);if(!K)return;if(L.type==="row"){this.repeatRow(L,V,K);return}const k=this.getSelectedVariableOptions(K),j=L.maxPerRow||4;let H=0,J=L.gridPos.y;for(let se=0;se<k.length;se++){const ae=k[se];let ne;ne=this.getPanelRepeatClone(L,se,V),ne.scopedVars??={},ne.scopedVars[K.name]=ae,L.repeatDirection===u.Pz?(se>0&&(J+=ne.gridPos.h),ne.gridPos.y=J):(ne.gridPos.w=Math.max(u.cV/k.length,u.cV/j),ne.gridPos.x=H,ne.gridPos.y=J,H+=ne.gridPos.w,H+ne.gridPos.w>u.cV&&(H=0,J+=ne.gridPos.h))}const X=J-L.gridPos.y;if(X>0){const se=V+k.length;for(const ae of this.panels.slice(se))R(L,ae)||(ae.gridPos.y+=X)}}repeatRow(L,V,K){const k=this.getSelectedVariableOptions(K);for(let j=0;j<k.length;j++){const H=k[j],J=this.getRowRepeatClone(L,j,V);N(J,K,H);const X=this.getRowHeight(J),se=J.panels||[];let ae;if(L.collapsed){for(const ne of se)N(ne,K,H),j>0&&this.updateRepeatedPanelIds(ne,!0);J.gridPos.y+=j,ae=V+j+1}else{const ne=V+(se.length+1)*j+1;se.forEach((q,ee)=>{if(N(q,K,H),j>0){const z=new A.a9(q);this.updateRepeatedPanelIds(z,!0),z.gridPos.y+=X*j,this.panels.splice(ne+ee,0,z)}}),J.panels=[],J.gridPos.y+=X*j,ae=ne+se.length}if(k.length>1)for(const ne of this.panels.slice(ae))ne.gridPos.y+=X}}updateRepeatedPanelIds(L,V){return L.repeatPanelId=L.id,L.id=this.getNextPanelId(),V?L.repeatedByRow=!0:L.repeat=void 0,L}getSelectedVariableOptions(L){let V;return(0,v.ML)(L)?V=L.options.slice(1,L.options.length):V=(0,t.filter)(L.options,{selected:!0}),V}getRowHeight(L){if(!L.panels||L.panels.length===0)return 0;if(L.collapsed)return 1;const V=(0,t.maxBy)(L.panels,({gridPos:K})=>K.y+K.h).gridPos;return V.y+V.h-L.gridPos.y}removePanel(L){this.panels=this.panels.filter(V=>V!==L),L.destroy(),this.events.publish(new E.Q$)}removeRow(L,V){(!V&&L.collapsed||V&&!L.collapsed)&&this.toggleRow(L),this.removePanel(L)}expandRows(){const L=this.panels.filter(V=>V.type==="row"&&V.collapsed);for(const V of L)this.toggleRow(V)}collapseRows(){const L=this.panels.filter(V=>V.type==="row"&&!V.collapsed);for(const V of L)this.toggleRow(V)}isSubMenuVisible(){return this.links.length>0||this.getVariables().some(L=>L.hide!==2)||this.annotations.list.some(L=>!L.hide)}getPanelInfoById(L){const V=this.panels.findIndex(K=>K.id===L);return V>=0?{panel:this.panels[V],index:V}:null}duplicatePanel(L){const V=L.getSaveModel();return V.id=this.getNextPanelId(),delete V.repeat,delete V.repeatIteration,delete V.repeatPanelId,delete V.scopedVars,V.alert&&delete V.thresholds,delete V.alert,L.gridPos.x+L.gridPos.w*2<=u.cV?V.gridPos.x+=L.gridPos.w:V.gridPos.y+=L.gridPos.h,this.addPanel(V),V}formatDate(L,V){return(0,r.LE)(L,{format:V,timeZone:this.getTimezone()})}destroy(){this.appEventsSubscription.unsubscribe(),this.events.removeAllListeners();for(const L of this.panels)L.destroy()}toggleRow(L){const V=(0,t.indexOf)(this.panels,L);if(!L.collapsed){const H=this.getRowPanels(V);(0,t.pull)(this.panels,...H),L.panels=H.map(J=>J.getSaveModel()),L.collapsed=!0,H.some(J=>J.hasChanged)&&L.configRev++,this.events.publish(new E.Q$);return}L.collapsed=!1;const K=L.panels??[],k=K.some(H=>H.repeat),j=L.repeat;if(K.length>0){const J=(K[0].gridPos.y??L.gridPos.y)-(L.gridPos.y+L.gridPos.h);let X=V+1,se=L.gridPos.y;for(const ne of K){if(j){const q=this.getPanelRepeatVariable(L);if(ne.scopedVars??={},q){const ee=this.getSelectedVariableOptions(q);ne.scopedVars={...ne.scopedVars,[q.name]:ee[0]}}}ne.gridPos.y??(ne.gridPos.y=L.gridPos.y),ne.gridPos.y-=J,this.panels.splice(X,0,new A.a9(ne)),X+=1,se=Math.max(se,ne.gridPos.y+ne.gridPos.h)}const ae=se-L.gridPos.y-1;for(const ne of this.panels.slice(X))ne.gridPos.y+=ae;L.panels=[],k&&this.processRowRepeats(L)}this.sortPanelsByGridPos(),this.events.publish(new E.Q$)}getRowPanels(L){const V=this.panels.slice(L+1),K=V.findIndex(j=>j.type==="row");return V.slice(0,K>=0?K:this.panels.length)}on(L,V){console.log("DashboardModel.on is deprecated use events.subscribe"),this.events.on(L,V)}off(L,V){console.log("DashboardModel.off is deprecated"),this.events.off(L,V)}cycleGraphTooltip(){this.graphTooltip=(this.graphTooltip+1)%3}sharedTooltipModeEnabled(){return this.graphTooltip>0}sharedCrosshairModeOnly(){return this.graphTooltip===1}getRelativeTime(L){return(0,r.fq)(L,{timeZone:this.getTimezone()})}isSnapshot(){return this.snapshot!==void 0}getTimezone(){return this.timezone?this.timezone:d.TP?.user?.timezone}updateSchema(L){new M.SW(this).updateSchema(L)}hasTimeChanged(){const{time:L,originalTime:V}=this;return!((0,t.isEqual)(L,V)||(0,t.isEqual)((0,o.KQ)(L?.from),(0,o.KQ)(V?.from))&&(0,t.isEqual)((0,o.KQ)(L?.to),(0,o.KQ)(V?.to)))}autoFitPanels(L,V){const K=Math.max(...this.panels.map(se=>se.gridPos.h+se.gridPos.y)),k=55;let H=L-k-20;V&&V!==a.KioskMode.TV&&(H+=k);const J=Math.floor(H/(u.sD+u.dU)),X=K/J;for(const se of this.panels)se.gridPos.y=Math.round(se.gridPos.y/X)||1,se.gridPos.h=Math.round(se.gridPos.h/X)||1}templateVariableValueUpdated(){this.processRepeats(),this.events.emit(a.CoreEvents.bG)}getPanelByUrlId(L){const V=parseInt(L??"0",10),K=this.panels.filter(k=>k.collapsed);for(const k of K)k.panels?.some(H=>H.id===V)&&this.toggleRow(k);return this.getPanelById(V)}toggleLegendsForAll(){const L=this.panels.filter(W),V=L.filter(j=>j.legend.show).length,K=L.length-V,k=V>=K;for(const j of L)j.legend.show=!k,j.render()}toggleExemplarsForAll(){for(const L of this.panels)for(const V of L.targets){if(!(V.datasource&&V.datasource.type==="prometheus"))continue;const K=V;K.exemplar=!K.exemplar}this.startRefresh()}getVariables(){return this.getVariablesFromState(this.uid)}canEditAnnotations(L){let V=!0;return L?V=!!this.meta.annotationsPermissions?.dashboard.canEdit:V=!!this.meta.annotationsPermissions?.organization.canEdit,(l.$.featureToggles.annotationPermissionUpdate||this.canEditDashboard())&&V}canDeleteAnnotations(L){let V=!0;return L?V=!!this.meta.annotationsPermissions?.dashboard.canDelete:V=!!this.meta.annotationsPermissions?.organization.canDelete,l.$.featureToggles.annotationPermissionUpdate?V:V&&this.canEditDashboard()}canAddAnnotations(){return this.annotations.list.find(V=>V.builtIn===1)?.enable===!1?!1:l.$.featureToggles.annotationPermissionUpdate?!!this.meta.annotationsPermissions?.dashboard.canAdd:!!this.meta.annotationsPermissions?.dashboard.canAdd&&this.canEditDashboard()}canEditDashboard(){return!!(this.meta.canEdit||this.meta.canMakeEditable)}shouldUpdateDashboardPanelFromJSON(L,V){!(0,t.isEqual)(L?.gridPos,V?.gridPos)&&this.events.publish(new E.Q$)}getDefaultTime(){return this.originalTime}getPanelRepeatVariable(L){return this.getVariablesFromState(this.uid).find(V=>V.name===L.repeat)}isSnapshotTruthy(){return this.snapshot}hasVariables(){return this.getVariablesFromState(this.uid).length>0}hasVariablesChanged(){const L=this.originalTemplating?.list??[],V=this.getTemplatingSaveModel({saveVariables:!0}).list;return L.length!==V.length?!1:!(0,t.isEqual)(V,L)}variablesTimeRangeProcessDoneHandler(L){const V=L.payload.variableIds.length>0;this.variablesChangedHandler(new D.og({panelIds:[],refreshAll:!0}),V)}variablesChangedHandler(L,V=!0){if(V&&this.processRepeats(),L.payload.refreshAll||(0,C.jG)().isRefreshOutsideThreshold(this.lastRefresh)){this.startRefresh({refreshAll:!0,panelIds:[]});return}(this.panelInEdit||this.panelInView)&&(this.panelsAffectedByVariableChange=L.payload.panelIds.filter(K=>K!==(this.panelInEdit?.id??this.panelInView?.id))),this.startRefresh(L.payload)}variablesChangedInUrlHandler(L){this.templateVariableValueUpdated(),this.startRefresh(L.payload)}getOriginalDashboard(){return this.originalDashboard}hasAngularPlugins(){return this.panels.some(L=>{const V=(l.$.panels[L.type]?.angular?.detected||A.vI.includes(L.type))&&!l.$.panels[L.type]?.angular?.hideDeprecation;let K=!1;return L.datasource?.uid&&(K=(0,c.Hv)(L.datasource?.uid)),V||K})}}function W(w){return!!w.legend}function N(w,L,V){w.scopedVars??={},w.scopedVars[L.name]=V}},84423:(G,I,e)=>{"use strict";e.d(I,{Ar:()=>C,NB:()=>h,a9:()=>v,tD:()=>D,tw:()=>T,vI:()=>g});var t=e(2543),n=e.n(t),s=e(62938),r=e(18226),o=e(77789),m=e(41987),l=e(581),i=e(3591),u=e(72574),d=e(2913),p=e(87490),c=e(28444),y=e(80924),f=e(96382);const P={events:!0,isViewing:!0,isEditing:!0,isInView:!0,hasRefreshed:!0,cachedPluginOptions:!0,plugin:!0,queryRunner:!0,replaceVariables:!0,configRev:!0,hasSavedPanelEditChange:!0,getDisplayTitle:!0,dataSupport:!0,key:!0,isNew:!0,refreshWhenInView:!0},a={id:!0,gridPos:!0,type:!0,title:!0,scopedVars:!0,repeat:!0,repeatPanelId:!0,repeatDirection:!0,repeatedByRow:!0,minSpan:!0,collapsed:!0,panels:!0,targets:!0,datasource:!0,timeFrom:!0,timeShift:!0,hideTimeOverride:!0,description:!0,links:!0,fullscreen:!0,isEditing:!0,isViewing:!0,hasRefreshed:!0,events:!0,cacheTimeout:!0,queryCachingTTL:!0,cachedPluginOptions:!0,transparent:!0,pluginVersion:!0,queryRunner:!0,transformations:!0,fieldConfig:!0,maxDataPoints:!0,interval:!0,replaceVariables:!0,libraryPanel:!0,getDisplayTitle:!0,configRev:!0,key:!0},E={gridPos:{x:0,y:0,h:3,w:6},targets:[{refId:"A"}],cachedPluginOptions:{},transparent:!1,options:{},links:[],transformations:[],fieldConfig:{defaults:{},overrides:[]},title:""},g=["graph","table-old","grafana-piechart-panel","grafana-worldmap-panel","singlestat","grafana-singlestat-panel"],h={graph:"timeseries","table-old":"table",singlestat:"stat","grafana-singlestat-panel":"stat","grafana-piechart-panel":"piechart","grafana-worldmap-panel":"geomap"},D={"heatmap-new":"heatmap"};class v{constructor(O){this.datasource=null,this.isViewing=!1,this.isEditing=!1,this.isInView=!1,this.configRev=0,this.refreshWhenInView=!0,this.cachedPluginOptions={},this.events=new r.o,this.restoreModel(O),this.replaceVariables=this.replaceVariables.bind(this),this.key=(0,s.A)()}restoreModel(O){for(const b in this)P[b]||!this.hasOwnProperty(b)||O[b]||typeof this[b]!="function"&&typeof this[b]!="symbol"&&delete this[b];for(const b in O)this[b]=O[b];const x=(0,f.p)(this);x&&(this.autoMigrateFrom=this.type,this.type=x),(0,t.defaultsDeep)(this,(0,t.cloneDeep)(E)),this.ensureQueryIds()}generateNewKey(){this.key=(0,s.A)()}ensureQueryIds(){if(this.targets&&(0,t.isArray)(this.targets))for(const O of this.targets)O.refId||(O.refId=(0,o.M)(this.targets))}getOptions(){return this.options}get hasChanged(){return this.configRev>0}updateOptions(O){this.options=O,this.configRev++,this.events.publish(new c.PR),this.render()}updateFieldConfig(O){this.fieldConfig=O,this.configRev++,this.events.publish(new c.PR),this.resendLastResult(),this.render()}getSaveModel(){const O={};for(const x in this)P[x]||!this.hasOwnProperty(x)||(0,t.isEqual)(this[x],E[x])||(O[x]=(0,t.cloneDeep)(this[x]));return this.type==="row"&&this.panels&&this.panels.length>0&&(O.panels=this.panels.map(x=>{if(x.libraryPanel){const{id:b,title:M,libraryPanel:A,gridPos:R}=x;return{id:b,title:M,gridPos:R,libraryPanel:{uid:A.uid,name:A.name}}}return x})),O}setIsViewing(O){this.isViewing=O}updateGridPos(O,x=!0){O.x===this.gridPos.x&&O.y===this.gridPos.y&&O.h===this.gridPos.h&&O.w===this.gridPos.w||(this.gridPos.x=O.x,this.gridPos.y=O.y,this.gridPos.w=O.w,this.gridPos.h=O.h,x&&this.configRev++,this.render())}runAllPanelQueries({dashboardUID:O,dashboardTimezone:x,timeData:b,width:M}){this.getQueryRunner().run({datasource:this.datasource,queries:this.targets,panelId:this.id,panelPluginId:this.type,dashboardUID:O,timezone:x,timeRange:b.timeRange,timeInfo:b.timeInfo,maxDataPoints:this.maxDataPoints||Math.floor(M),minInterval:this.interval,scopedVars:this.scopedVars,cacheTimeout:this.cacheTimeout,queryCachingTTL:this.queryCachingTTL,transformations:this.transformations,app:this.isEditing?m.Jk.PanelEditor:this.isViewing?m.Jk.PanelViewer:m.Jk.Dashboard})}refresh(){this.hasRefreshed=!0,this.events.publish(new i._)}render(){this.hasRefreshed?this.events.publish(new c.XM):this.refresh()}getOptionsToRemember(){return Object.keys(this).reduce((O,x)=>P[x]||a[x]?O:{...O,[x]:this[x]},{})}restorePanelOptions(O){const x=this.cachedPluginOptions[O];x&&(Object.keys(x.properties).map(b=>{this[b]=x.properties[b]}),this.fieldConfig=(0,l.H9)(this.fieldConfig,x.fieldConfig))}applyPluginOptionDefaults(O,x){const b=(0,l.F)({plugin:O,currentOptions:this.options,currentFieldConfig:this.fieldConfig,isAfterPluginChange:x});this.fieldConfig=b.fieldConfig,this.options=b.options}async pluginLoaded(O){this.plugin=O;const x=C(O);if(this.autoMigrateFrom){const b=h[this.autoMigrateFrom]!=null,M=this.getOptionsToRemember(),A=this.autoMigrateFrom,R=this.type;this.clearPropertiesBeforePluginChange(),this.type=R,this.plugin=O,this.callPanelTypeChangeHandler(O,A,M,b)}if(O.onPanelMigration&&x!==this.pluginVersion){const b=O.onPanelMigration(this);this.options=await b,this.pluginVersion=x}this.applyPluginOptionDefaults(O,!1),this.resendLastResult()}clearPropertiesBeforePluginChange(){for(const O in this)a[O]||delete this[O];this.options={},this.fieldConfig={defaults:{...this.fieldConfig.defaults,custom:{}},overrides:(0,l.aW)(this.fieldConfig.overrides,l.nx)}}callPanelTypeChangeHandler(O,x,b,M){if(O.onPanelTypeChanged){const A=M?{angular:b}:b.options;Object.assign(this.options,O.onPanelTypeChanged(this,x,A,this.fieldConfig))}}changePlugin(O){const x=O.meta.id,b=this.getOptionsToRemember(),M=this.fieldConfig,A=this.type,R=this.isAngularPlugin()||!!h[A];this.cachedPluginOptions[A]={properties:b,fieldConfig:M},this.clearPropertiesBeforePluginChange(),this.restorePanelOptions(x),this.callPanelTypeChangeHandler(O,A,b,R),this.type=x,this.plugin=O,this.configRev++,this.applyPluginOptionDefaults(O,!0),O.onPanelMigration&&(this.pluginVersion=C(O))}updateQueries(O){const{dataSource:x}=O;this.datasource={uid:x.uid,type:x.type},this.cacheTimeout=O.cacheTimeout,this.queryCachingTTL=O.queryCachingTTL,this.timeFrom=O.timeRange?.from,this.timeShift=O.timeRange?.shift,this.hideTimeOverride=O.timeRange?.hide,this.interval=O.minInterval,this.maxDataPoints=O.maxDataPoints,this.targets=O.queries,this.configRev++,this.events.publish(new c.zq)}addQuery(O){O=O||{refId:"A"},O.refId=(0,o.M)(this.targets),this.targets.push(O),this.configRev++}changeQuery(O,x){O.refId=this.targets[x].refId,this.configRev++,this.targets=this.targets.map((b,M)=>M===x?O:b)}getEditClone(){const O=this.getSaveModel(),x=new v(O);x.isEditing=!0,x.plugin=this.plugin;const b=this.getQueryRunner();return x.getQueryRunner().useLastResultFrom(b),x}getTransformations(){return this.transformations}getFieldOverrideOptions(){if(this.plugin)return{fieldConfig:this.fieldConfig,replaceVariables:this.replaceVariables,fieldConfigRegistry:this.plugin.fieldConfigRegistry,theme:d.Ay.theme2}}getDataSupport(){return this.plugin?.dataSupport??{annotations:!1,alertStates:!1}}getQueryRunner(){return this.queryRunner||(this.queryRunner=new y.Z(this)),this.queryRunner}hasTitle(){return this.title&&this.title.length>0}isAngularPlugin(){return(this.plugin&&this.plugin.angularPanelCtrl)!==void 0||(this.plugin?.meta?.angular?.detected??!1)}destroy(){this.events.removeAllListeners(),this.queryRunner&&this.queryRunner.destroy()}setTransformations(O){this.transformations=O,this.resendLastResult(),this.configRev++,this.events.publish(new c.JI)}setProperty(O,x){this[O]=x,this.configRev++,O==="repeat"&&(this.repeat&&!this.repeatDirection?this.repeatDirection="h":this.repeat||(delete this.repeatDirection,delete this.maxPerRow))}replaceVariables(O,x,b){const M=this.getQueryRunner().getLastRequest(),A=Object.assign({},this.scopedVars,M?.scopedVars,x);return(0,u.w)().replace(O,A,b)}resendLastResult(){this.plugin&&this.getQueryRunner().resendLastResult()}getDisplayTitle(){return this.replaceVariables(this.title,void 0,"text")}initLibraryPanel(O){for(const[x,b]of Object.entries(O.model)){switch(x){case"id":case"gridPos":case"libraryPanel":continue}this[x]=b}this.libraryPanel=O}unlinkLibraryPanel(){delete this.libraryPanel,this.configRev++,this.render()}}function C(S){return S&&S.meta.info.version?S.meta.info.version:d.Ay.buildInfo.version}function T(S){const O={};return Object.entries(S).filter(([x,b])=>!P[x]&&S.hasOwnProperty(x)&&!(0,t.isEqual)(b,E[x])).forEach(([x,b])=>{O[x]=b}),(0,p.MA)(O)}},3673:(G,I,e)=>{"use strict";e.d(I,{Bz:()=>P,Q9:()=>y,Ss:()=>E,TA:()=>f,lC:()=>a});var t=e(17172),n=e(82467),s=e(3169),r=e(28676),o=e(6473),m=e(80095),l=e(81862),i=e(20701),u=e(72401),d=e(14792),p=e(74856),c=e(28601);function y(g,h){return async D=>{await(0,t.AI)().post("/api/dashboards/import",g),D((0,n.dx)((0,s.tZ)("Dashboard Imported",h))),D((0,i.h9)())}}function f(g){return async h=>{await(0,r.n)().deleteDashboard(g,!1),h((0,i.h9)())}}const P=()=>(g,h)=>{const v=h().dashboard.getModel();v&&(v.destroy(),g((0,u.Y7)(v.uid))),(0,p.jG)().stopAutoRefresh(),g((0,c.p0)()),g((0,m.rG)()),o.t.leave(),(0,d.UA)().setCurrent(void 0)},a=g=>h=>{h((0,l.Cj)(g)),(0,p.jG)().refreshTimeModel()},E=g=>h=>{h((0,l.xu)(g)),(0,p.jG)().refreshTimeModel()}},96382:(G,I,e)=>{"use strict";e.d(I,{p:()=>s});var t=e(2913),n=e(84423);function s(r,o){if(n.tD[r.type])return n.tD[r.type];const m=i=>{const u="__feature."+i,p=new URLSearchParams(window.location.search).get(u);return p==="true"||p===""},l=o||!t.Ay.angularSupportEnabled||t.Ay.featureToggles.autoMigrateOldPanels||m("autoMigrateOldPanels")||m("disableAngular");if(r.type==="graph"&&(l||t.Ay.featureToggles.autoMigrateGraphPanel||m("autoMigrateGraphPanel")))return r.xaxis?.mode==="series"?"barchart":r.xaxis?.mode==="histogram"?"histogram":"timeseries";if(l)return n.NB[r.type];if(r.type==="table-old"&&(t.Ay.featureToggles.autoMigrateTablePanel||m("autoMigrateTablePanel")))return"table";if(r.type==="grafana-piechart-panel"&&(t.Ay.featureToggles.autoMigratePiechartPanel||m("autoMigratePiechartPanel")))return"piechart";if(r.type==="grafana-worldmap-panel"&&(t.Ay.featureToggles.autoMigrateWorldmapPanel||m("autoMigrateWorldmapPanel")))return"geomap";if((r.type==="singlestat"||r.type==="grafana-singlestat-panel")&&t.Ay.featureToggles.autoMigrateStatPanel||m("autoMigrateStatPanel"))return"stat"}},34214:(G,I,e)=>{"use strict";e.d(I,{G:()=>t.G,a:()=>n.a9});var t=e(98365),n=e(84423)},79999:(G,I,e)=>{"use strict";e.d(I,{us:()=>K,vR:()=>V,yZ:()=>j,OI:()=>k});var t=e(71733),n=e(47232),s=e(69129),r=e(12131),o=e(17172),m=e(32264),l=e(82467),i=e(28138),u=e(3169),d=e(27677),p=e(33390),c=e(78160),y=e(17493),f=e(14792),P=e(74856),a=e(72255),E=e(71176),g=e(71101),h=e(54650);function D(H){return async J=>{const X=await d.IB.getFolderByUid(H);return J((0,h.jl)(X)),J((0,l.Vz)((0,g.R4)(X))),X}}var v=e(6473),C=e(2609),T=e(75096),S=e(31678),O=e(42972),x=e(72401),b=e(87421),M=e(16833),A=e(98365),R=e(61298),B=e(14110);function U(H){const J={dashboardId:H.id,dashboardName:H.title,dashboardUid:H.uid,folderName:H.meta.folderTitle,eventName:R.n_.DashboardView};(0,B.G$)(J)}var W=e(28601);const N="initDashboard";async function w(H,J,X){const se=p.A.getObject(K);if(se)return j(),se;try{switch(H.routeName){case S.DashboardRoutes.Home:{const ne=(0,a.sP)().getFromCache(a.m6);if(ne)return ne;const q=await d.IB.get("/api/dashboards/home");if(q.redirectUri){const ee=t.I.stripBaseFromUrl(q.redirectUri);return r.Ny.replace(ee),null}return q.meta.canSave=!1,q.meta.canShare=!1,q.meta.canStar=!1,q}case S.DashboardRoutes.Public:return await y.np.loadDashboard("public",H.urlSlug,H.accessToken);case S.DashboardRoutes.Normal:{const ae=await y.np.loadDashboard(H.urlType,H.urlSlug,H.urlUid);if(ae.meta.folderUid)try{await J(D(ae.meta.folderUid))}catch(ne){console.warn("Error fetching parent folder",ae.meta.folderUid,"for dashboard",ne)}if(H.fixUrl&&ae.meta.url&&!C._o.state.isPlaying){const ne=t.I.stripBaseFromUrl(ae.meta.url),q=r.Ny.getLocation().pathname;ne!==q&&(r.Ny.replace({...r.Ny.getLocation(),pathname:ne}),console.log("not correct url correcting",ne,q))}return ae}case S.DashboardRoutes.New:return H.urlFolderUid&&await J(D(H.urlFolderUid)),await(0,E.X)(H.urlFolderUid);case S.DashboardRoutes.Path:{const ae=H.urlSlug??"";return await y.np.loadDashboard(S.DashboardRoutes.Path,ae,ae)}default:throw{message:"Unknown route "+H.routeName}}}catch(ae){return(0,o.NF)(ae)&&ae.cancelled||(J((0,W.ig)({message:"Failed to fetch dashboard",error:ae})),console.error(ae)),null}}const L=(H,J={})=>(H.forEach(X=>{X.panels?L(X.panels,J):X.targets&&X.targets.forEach(se=>{se.datasource?.type&&(J[se.datasource.type]?J[se.datasource.type].push(se):J[se.datasource.type]=[se])})}),J);function V(H){return async(J,X)=>{(0,c.j)(N),J((0,W.xS)());const se=await w(H,J,X),ae=se?.dashboard?.version;if(!se)return;J((0,W.X1)());let ne;try{ne=new A.G(se.dashboard,se.meta)}catch(fe){J((0,W.ig)({message:"Failed create dashboard model",error:fe})),console.error(fe);return}const q=X(),ee=r.Ny.getSearchObject();ee.orgId||r.Ny.partial({orgId:q.user.orgId},!0);const z=(0,P.jG)();(0,f.UA)().setCurrent(ne),z.init(ne);const ie=(0,T.q4)(H.urlUid??ne.uid);if(await J((0,x._q)(ie,ne)),(0,O.nm)({dashboard:ne,timeSrv:z}).run({dashboard:ne,range:z.timeRange()}),(0,b.Tk)(X())!==ie||X().dashboard.initPhase!==S.DashboardInitPhase.Services)return;try{ne.processRepeats(),ee.autofitpanels&&ne.autoFitPanels(window.innerHeight,ee.kiosk),m.$.publicDashboardAccessToken||H.keybindingSrv.setupDashboardBindings(ne)}catch(fe){fe instanceof Error&&J((0,l.dx)((0,u.gi)("Dashboard init failed",fe))),console.error(fe)}H.routeName!==S.DashboardRoutes.New?(U(ne),v.t.watch(ne.uid)):v.t.leave(),ne.weekStart!==""?(0,n.$D)(ne.weekStart):(0,n.$D)(m.$.bootData.user.weekStart),i.A.publish(new s.gc({dashboardId:ne.uid,orgId:q.user.orgId,userId:q.user.user?.id,grafanaVersion:m.$.buildInfo.version,queries:L(ne.panels)}));const ue=(0,c.z)(N);(0,M.d)(ne,ue?.duration,ae),J((0,W.O9)(ne))}}const K="DASHBOARD_FROM_LS_KEY";function k(H){p.A.setObject(K,H)}function j(){p.A.delete(K)}},28601:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>P,O9:()=>u,Ub:()=>y,X1:()=>d,ig:()=>i,p0:()=>p,xS:()=>l});var t=e(65307),n=e(79422),s=e(31678),r=e(98365);const o={initPhase:s.DashboardInitPhase.NotStarted,getModel:()=>null,initError:null,initialDatasource:void 0},m=(0,t.Z0)({name:"dashboard",initialState:o,reducers:{dashboardInitFetching:a=>{a.initPhase=s.DashboardInitPhase.Fetching},dashboardInitServices:a=>{a.initPhase=s.DashboardInitPhase.Services},dashboardInitCompleted:(a,E)=>{a.getModel=()=>E.payload,a.initPhase=s.DashboardInitPhase.Completed},dashboardInitFailed:(a,E)=>{a.initPhase=s.DashboardInitPhase.Failed,a.initError=E.payload,a.getModel=()=>new r.G({...n.Ye,title:"Dashboard init failed"},{canSave:!1,canEdit:!1})},cleanUpDashboard:a=>{a.initPhase=s.DashboardInitPhase.NotStarted,a.initError=null,a.getModel=()=>null},addPanel:(a,E)=>{},setInitialDatasource:(a,E)=>{a.initialDatasource=E.payload}}}),{dashboardInitFetching:l,dashboardInitFailed:i,dashboardInitCompleted:u,dashboardInitServices:d,cleanUpDashboard:p,addPanel:c,setInitialDatasource:y}=m.actions,P={dashboard:m.reducer}},36974:(G,I,e)=>{"use strict";e.d(I,{B1:()=>g,CW:()=>a,OK:()=>i,SD:()=>d,VF:()=>p,_u:()=>f,dH:()=>h,ko:()=>E,no:()=>y,ob:()=>u,s3:()=>c});var t=e(2543),n=e.n(t),s=e(12131),r=e(2913),o=e(15054),m=e(33390),l=e(19752);function i(v,C){const T={type:"timeseries",title:"Panel Title",gridPos:(0,l.Ft)(v),datasource:C?{uid:C}:null,isNew:!0};return v.addPanel(T),T.id}function u(v,C){const T={type:C,title:"Widget title",gridPos:(0,l.Ft)(v),datasource:null,isNew:!0};return v.addPanel(T),T.id}function d(v){const C={type:"row",title:"Row title",gridPos:{x:0,y:0}};v.addPanel(C)}function p(){s.Ny.push("/dashboard/import")}function c(v){const C={type:"add-library-panel",gridPos:(0,l.Ft)(v)};v.addPanel(C)}function y(v,C){if(!C)return;const T=(0,l.Ft)(v),S={type:C.id,title:"Panel Title",gridPos:{x:T.x,y:T.y,w:C.defaults.gridPos.w,h:C.defaults.gridPos.h}};C.defaults&&((0,t.defaults)(S,C.defaults),S.title=C.defaults.title,m.A.delete(o.tH)),v.addPanel(S)}function f(){const v=(0,t.chain)(r.Ay.panels).filter({hideFromList:!1}).map(T=>T).value(),C=m.A.get(o.tH);if(C){const T=JSON.parse(C),S=(0,t.find)(v,{id:T.type});if(S){const O=(0,t.cloneDeep)(S);return O.name=T.title,O.sort=-1,{...O,defaults:{...T}}}}}const P="grafana.dashboards.panelEdit.lastUsedDatasource";function a(v){if(m.A.exists(P)){const C=m.A.getObject(P);if(C?.dashboardUid===v)return C}}function E(v){if(!m.A.exists(P))return;const T=m.A.getObject(P)?.datasourceUid??"";D(v,T)}function g(v){m.A.setObject(P,{dashboardUid:v,datasourceUid:""})}function h(v,C){const T=a(v);if(!T)D(v,C);else{const S=T?.dashboardUid??"";D(S,C)}}function D(v,C){m.A.setObject(P,{dashboardUid:v,datasourceUid:C})}},19752:(G,I,e)=>{"use strict";e.d(I,{ET:()=>x,FC:()=>h,Ft:()=>R,KJ:()=>v,Mc:()=>C,ZY:()=>S,d7:()=>T,iU:()=>D,nk:()=>b});var t=e(2543),n=e.n(t),s=e(26272),r=e(65879),o=e(47232),m=e(85858),l=e(72574),i=e(28138),u=e(2913),d=e(15054),p=e(33390),c=e(1702),y=e(84423),f=e(54174),P=e(96227),a=e(79971),E=e(99140),g=e(28444);const h=(B,U,W)=>{if(W!==!1){const N=U.alert?"YES":void 0;i.A.publish(new g.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",confirmText:N,yesText:"Remove",onConfirm:()=>h(B,U,!1)}));return}B.removePanel(U),(0,E.JD)((0,a.O6)(U.key))},D=(B,U)=>{B.duplicatePanel(U)},v=B=>{let U=B;B instanceof y.a9&&(U=B.getSaveModel()),p.A.set(d.tH,JSON.stringify(U)),i.A.emit(s.r1.alertSuccess,["Panel copied. Click **Add panel** icon to paste."])},C=(B,U)=>{i.A.publish(new g.S8({component:c.ShareModal,props:{dashboard:B,panel:U}}))},T=(B,U)=>{i.A.publish(new g.S8({component:P.o,props:{panel:U,initialFolderUid:B.meta.folderUid,isOpen:!0}}))},S=B=>{i.A.publish(new g.S8({component:f.l,props:{onConfirm:()=>B.unlinkLibraryPanel(),isOpen:!0}}))},O=B=>{B.refresh()},x=B=>{const U={...B.options};U.legend.showLegend===!0?U.legend.showLegend=!1:U.legend.showLegend=!0,B.updateOptions(U)};function b(B,U){const W={timeInfo:"",timeRange:U};if(B.timeFrom){const N=(0,l.w)().replace(B.timeFrom,B.scopedVars),w=r.describeTextRange(N);if(w.invalid)return W.timeInfo="invalid time override",W;if((0,t.isString)(U.raw.from)){const L=(0,o.AN)(U.from).tz(),V=(0,o.AN)(U.to).tz(),K=m.parse(w.from,void 0,L);W.timeInfo=w.display,W.timeRange={from:K,to:m.parse(w.to,void 0,V),raw:{from:w.from,to:w.to}}}}if(B.timeShift){const N=(0,l.w)().replace(B.timeShift,B.scopedVars);if(r.describeTextRange(N).invalid)return W.timeInfo="invalid timeshift",W;const L="-"+N;W.timeInfo+=" timeshift "+L;const V=m.parseDateMath(L,W.timeRange.from,!1),K=m.parseDateMath(L,W.timeRange.to,!0);W.timeRange={from:V,to:K,raw:{from:V,to:K}}}return B.hideTimeOverride&&(W.timeInfo=""),W}function M(B){const W=document.getElementsByTagName("html")[0].getBoundingClientRect().width;return B.maxDataPoints?B.maxDataPoints:Math.ceil(W*(B.gridPos.w/24))}function A(B,U){const W=B.plugin&&B.plugin.noPadding?0:config.theme.panelPadding*2,N=B.hasTitle()?config.theme.panelHeaderHeight:0;return U-N-W-PANEL_BORDER}function R(B){for(const W of B.panelIterator())W.gridPos.y+=8;return{x:0,y:0,w:12,h:8}}},21380:(G,I,e)=>{"use strict";e.d(I,{z:()=>s});var t=e(47232),n=e(85858);const s=(r,o)=>{const m={from:(0,t.Ar)(r.from)?(0,t.KQ)(r.from):r.from,to:(0,t.Ar)(r.to)?(0,t.KQ)(r.to):r.to},l=o?o.getTimezone():void 0;return{from:n.parse(m.from,!1,l,o?.fiscalYearStartMonth),to:n.parse(m.to,!0,l,o?.fiscalYearStartMonth),raw:m}}},16833:(G,I,e)=>{"use strict";e.d(I,{D:()=>s,d:()=>n});var t=e(7758);function n(i,u,d){const p=o(i.templating.list),c=r(i.panels);t.c.dashboardInitialized({uid:i.uid,title:i.title,theme:i.style,schemaVersion:i.schemaVersion,version_before_migration:d,panels_count:i.panels.length,...c,...p,settings_nowdelay:i.timepicker.nowDelay,settings_livenow:!!i.liveNow,duration:u,isScene:!1})}function s(i,u){const d=i.getInitialSaveModel();if(d){const p=r(d.panels||[]),c=o(d.templating?.list||[]);t.c.dashboardInitialized({uid:d.uid,title:d.title,theme:void 0,schemaVersion:d.schemaVersion,version_before_migration:d.version,panels_count:d.panels?.length||0,...p,...c,settings_nowdelay:void 0,settings_livenow:!!d.liveNow,duration:u,isScene:!0})}}function r(i){return i.map(u=>u.type).reduce((u,d)=>(u[l(d)]=1+u[l(d)]||1,u),{})}function o(i){return i.map(u=>u.type).reduce((u,d)=>(u[m(d)]=1+u[m(d)]||1,u),{})}const m=i=>`variable_type_${i}_count`,l=i=>`panel_type_${i}_count`},40489:(G,I,e)=>{"use strict";e.d(I,{ZF:()=>m,vI:()=>o,o2:()=>l});var t=e(88483),n=e(14236);function s(i){const u=new Set;return Object.keys(i).forEach(d=>{i[d].forEach(p=>{u.add(p)})}),u}function r(i){const u=Array.from(s(i));return u.length===1?u[0]:`${u.slice(0,-1).join(", ")} or ${u.slice(-1)}`}function o(i){return new t.c(u=>{let d=0;Promise.all([e.e(2136),e.e(3686)]).then(e.bind(e,22136)).then(p=>{i.forEach(c=>{const y=new FileReader;y.readAsArrayBuffer(c),y.onload=()=>{const f=y.result;if(f&&f instanceof ArrayBuffer){if(c.type==="application/json"){const P=new TextDecoder("utf-8"),a=JSON.parse(P.decode(f));u.next({dataFrames:[(0,n.Vc)(a)],file:c})}else u.next({dataFrames:p.readSpreadsheet(f),file:c});++d>=i.length&&u.complete()}}})}).catch(()=>{throw"Failed to load sheets module"})})}const m={"text/plain":[".csv",".txt"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"],"application/vnd.apple.numbers":[".numbers"],"application/vnd.oasis.opendocument.spreadsheet":[".ods"],"application/json":[".json"]},l=5e5},32738:(G,I,e)=>{"use strict";e.d(I,{r:()=>l});var t=e(96540),n=e(55852),s=e(10096),r=e(8484),o=e(6320),m=e(31678);function l({variant:i,onClick:u}){const d=s.TP.hasPermission(m.AccessControlAction.DataSourcesCreate),p=o.b.DataSourcesNew;return t.createElement(n.z9,{variant:i||"primary",href:p,disabled:!d,tooltip:d?void 0:"You do not have permission to configure new data sources",onClick:u,target:"_blank"},t.createElement(r.x6,{i18nKey:"data-source-picker.add-new-data-source"},"Configure a new data source"))}},2221:(G,I,e)=>{"use strict";e.d(I,{A:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(10860),o=e(64149);function m({ds:i,onClick:u,selected:d,description:p,...c}){const y=(0,s.$j)(),f=l(y,i.meta.builtIn);return n.createElement(r.Z,{key:i.uid,onClick:u,className:(0,t.cx)(f.card,d?f.selected:void 0),...c},n.createElement(r.Z.Heading,{className:f.heading},n.createElement("div",{className:f.headingContent},n.createElement("span",{className:f.name},i.name," ",i.isDefault?n.createElement(o.L,{tags:["default"]}):null),n.createElement("small",{className:f.type},p||i.meta.name))),n.createElement(r.Z.Figure,{className:f.logo},n.createElement("img",{src:i.meta.info.logos.small,alt:`${i.meta.name} Logo`})))}function l(i,u=!1){return{card:(0,t.css)`
      cursor: pointer;
      background-color: ${i.colors.background.primary};
      border-bottom: 1px solid ${i.colors.border.weak};
      // Move to list component
      margin-bottom: 0;
      border-radius: 0;
      padding: ${i.spacing(1)};
    `,heading:(0,t.css)`
      width: 100%;
      overflow: hidden;
      // This is needed to enable ellipsis when text overlfows
      > button {
        width: 100%;
      }
    `,headingContent:(0,t.css)`
      color: ${i.colors.text.secondary};
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      justify-content: space-between;
    `,logo:(0,t.css)`
      width: 32px;
      height: 32px;
      padding: ${i.spacing(0,1)};
      display: flex;
      align-items: center;

      > img {
        max-height: 100%;
        min-width: 24px;
        filter: invert(${u&&i.isLight?1:0});
      }
    `,name:(0,t.css)`
      color: ${i.colors.text.primary};
      display: flex;
      gap: ${i.spacing(2)};
    `,type:(0,t.css)`
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      align-items: center;
    `,separator:(0,t.css)`
      margin: 0 ${i.spacing(1)};
      color: ${i.colors.border.weak};
    `,selected:(0,t.css)`
      background-color: ${i.colors.background.secondary};
    `,meta:(0,t.css)`
      display: block;
      overflow-wrap: unset;
      white-space: nowrap;
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
    `}}},11219:(G,I,e)=>{"use strict";e.d(I,{S:()=>p});var t=e(32196),n=e(96540),s=e(13544),r=e(72574),o=e(40845),m=e(8484),l=e(87282),i=e(32738),u=e(2221),d=e(47311);function p(a){const E=(0,n.useRef)(null),[g,h]=(0,l.dR)({keyboardEvents:a.keyboardEvents,containerRef:E}),D=(0,o.$j)(),v=P(D,h),{className:C,current:T,onChange:S,enableKeyboardNavigation:O,onClickEmptyStateCTA:x}=a,b=(0,l.Kr)({alerting:a.alerting,annotations:a.annotations,dashboard:a.dashboard,logs:a.logs,metrics:a.metrics,mixed:a.mixed,pluginId:a.pluginId,tracing:a.tracing,type:a.type,variables:a.variables}),[M,A]=(0,l.TX)(),R=a.filter?b.filter(a.filter):b;return n.createElement("div",{ref:E,className:(0,t.cx)(C,v.container),"data-testid":s.Tp.components.DataSourcePicker.dataSourceList},R.length===0&&n.createElement(c,{className:v.emptyState,onClickCTA:x}),R.sort((0,d.Tj)(T,M,f())).map(B=>n.createElement(u.A,{"data-testid":"data-source-card",key:B.uid,ds:B,onClick:()=>{A(B),S(B)},selected:(0,d.Df)(B,T),...O?g:{}})))}function c({className:a,onClickCTA:E}){const g=(0,o.of)(y);return n.createElement("div",{className:(0,t.cx)(a,g.container)},n.createElement("p",{className:g.message},n.createElement(m.x6,{i18nKey:"data-source-picker.list.no-data-source-message"},"No data sources found")),n.createElement(i.r,{onClick:E}))}function y(a){return{container:(0,t.css)`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    `,message:(0,t.css)`
      margin-bottom: ${a.spacing(3)};
    `}}function f(){return(0,r.w)().getVariables().filter(E=>E.type==="datasource").map(E=>`\${${E.id}}`)}function P(a,E){return{container:(0,t.css)`
      display: flex;
      flex-direction: column;
      ${E} {
        background-color: ${a.colors.background.secondary};
      }
    `,emptyState:(0,t.css)`
      height: 100%;
      flex: 1;
    `}}},50481:(G,I,e)=>{"use strict";e.d(I,{p:()=>O});var t=e(32196),n=e(2543),s=e(96540),r=e(14110),o=e(32264),m=e(40845),l=e(37390),i=e(10354),u=e(14578),d=e(40276),p=e(37270),c=e(8484),y=e(40489),f=e(90478),P=e(87282),a=e(32738),E=e(13544),g=e(2221),h=e(47311);function D(b){switch(b){case"grafana":return(0,c.t)("data-source-picker.built-in-list.description-grafana","Discover visualizations using mock data");case"-- Mixed --":return(0,c.t)("data-source-picker.built-in-list.description-mixed","Use multiple data sources");case"-- Dashboard --":return(0,c.t)("data-source-picker.built-in-list.description-dashboard","Reuse query results from other visualizations");default:return""}}function v({className:b,current:M,onChange:A,tracing:R,dashboard:B,mixed:U,metrics:W,type:N,annotations:w,variables:L,alerting:V,pluginId:K,logs:k,filter:j}){const J=(0,P.Kr)({tracing:R,dashboard:B,mixed:U,metrics:W,type:N,annotations:w,variables:L,alerting:V,pluginId:K,logs:k}).filter(X=>(j?j?.(X):!0)&&!!X.meta.builtIn);return s.createElement("div",{className:b,"data-testid":E.Tp.components.DataSourcePicker.advancedModal.builtInDataSourceList},J.map(X=>s.createElement(g.A,{key:X.uid,ds:X,description:D(X.uid),selected:(0,h.Df)(X,M),onClick:()=>A(X)})))}var C=e(11219);const T="dashboards_dspickermodal_clicked",S={SELECT_DS:"select_ds",UPLOAD_FILE:"upload_file",CONFIG_NEW_DS:"config_new_ds",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state",SEARCH:"search",DISMISS:"dismiss"};function O({tracing:b,dashboard:M,mixed:A,metrics:R,type:B,annotations:U,variables:W,alerting:N,pluginId:w,logs:L,uploadFile:V,filter:K,onChange:k,current:j,onDismiss:H,reportedInteractionFrom:J}){const X=(0,m.of)(x),[se,ae]=(0,s.useState)(""),ne=J||"modal",q=()=>{H(),(0,r.rR)(T,{item:S.DISMISS,src:ne})},ee=ue=>{k(ue),(0,r.rR)(T,{item:S.SELECT_DS,ds_type:ue.type,src:ne})},z=s.useMemo(()=>(0,n.once)(()=>{(0,r.rR)(T,{item:"search",src:ne})}),[ne]),te=(0,P.ps)("-- Grafana --"),ie=(0,f.j)((ue,fe)=>{te&&(k(te,[ue]),(0,r.rR)(T,{item:S.UPLOAD_FILE,src:ne}),fe.length<1&&H())}),ce=({className:ue})=>s.createElement(v,{className:ue,onChange:ee,current:j,filter:K,variables:W,tracing:b,metrics:R,type:B,annotations:U,alerting:N,pluginId:w,logs:L,dashboard:M,mixed:A});return s.createElement(l.a,{title:(0,c.t)("data-source-picker.modal.title","Select data source"),closeOnEscape:!0,closeOnBackdropClick:!0,isOpen:!0,className:X.modal,contentClassName:X.modalContent,onClickBackdrop:q,onDismiss:q},s.createElement("div",{className:X.leftColumn},s.createElement(i.p,{type:"search",autoFocus:!0,className:X.searchInput,value:se,prefix:s.createElement(u.I,{name:"search"}),placeholder:(0,c.t)("data-source-picker.modal.input-placeholder","Select data source"),onChange:ue=>{ae(ue.currentTarget.value),z()}}),s.createElement(d.E,null,s.createElement(C.S,{onChange:ee,current:j,onClickEmptyStateCTA:()=>(0,r.rR)(T,{item:S.CONFIG_NEW_DS_EMPTY_STATE,src:ne}),filter:ue=>(K?K?.(ue):!0)&&(0,h.Zn)(ue,se)&&!ue.meta.builtIn,variables:W,tracing:b,metrics:R,type:B,annotations:U,alerting:N,pluginId:w,logs:L,dashboard:M,mixed:A}),s.createElement(ce,{className:X.appendBuiltInDataSourcesList}))),s.createElement("div",{className:X.rightColumn},s.createElement("div",{className:X.builtInDataSources},s.createElement(d.E,{className:X.builtInDataSourcesList},s.createElement(ce,null)),V&&o.$.featureToggles.editPanelCSVDragAndDrop&&s.createElement(p.gH,{readAs:"readAsArrayBuffer",fileListRenderer:()=>{},options:{maxSize:y.o2,multiple:!1,accept:y.ZF,onDrop:ie}},s.createElement(p.wI,null))),s.createElement("div",{className:X.newDSSection},s.createElement("span",{className:X.newDSDescription},s.createElement(c.x6,{i18nKey:"data-source-picker.modal.configure-new-data-source"},"Open a new tab and configure a data source")),s.createElement(a.r,{variant:"secondary",onClick:()=>{(0,r.rR)(T,{item:S.CONFIG_NEW_DS,src:ne}),H()}}))))}function x(b){return{modal:(0,t.css)`
      width: 80%;
      height: 80%;
      max-width: 1200px;
      max-height: 900px;

      ${b.breakpoints.down("md")} {
        width: 100%;
      }
    `,modalContent:(0,t.css)`
      display: flex;
      flex-direction: row;
      height: 100%;

      ${b.breakpoints.down("md")} {
        flex-direction: column;
      }
    `,leftColumn:(0,t.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      padding-right: ${b.spacing(4)};
      border-right: 1px solid ${b.colors.border.weak};

      ${b.breakpoints.down("md")} {
        width: 100%;
        border-right: 0;
        padding-right: 0;
        flex: 1;
        overflow-y: auto;
      }
    `,rightColumn:(0,t.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      justify-items: space-evenly;
      align-items: stretch;
      padding-left: ${b.spacing(4)};

      ${b.breakpoints.down("md")} {
        width: 100%;
        padding-left: 0;
        flex: 0;
      }
    `,builtInDataSources:(0,t.css)`
      flex: 1 1;
      margin-bottom: ${b.spacing(4)};

      ${b.breakpoints.down("md")} {
        flex: 0;
      }
    `,builtInDataSourcesList:(0,t.css)`
      ${b.breakpoints.down("md")} {
        display: none;
        margin-bottom: 0;
      }

      margin-bottom: ${b.spacing(4)};
    `,appendBuiltInDataSourcesList:(0,t.css)`
      ${b.breakpoints.up("md")} {
        display: none;
      }
    `,newDSSection:(0,t.css)`
      display: flex;
      flex-direction: row;
      width: 100%;
      justify-content: space-between;
      align-items: center;
    `,newDSDescription:(0,t.css)`
      flex: 1 0;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      color: ${b.colors.text.secondary};
    `,searchInput:(0,t.css)`
      width: 100%;
      min-height: 32px;
      margin-bottom: ${b.spacing(1)};
    `}}},51612:(G,I,e)=>{"use strict";e.d(I,{s:()=>B});var t=e(32196),n=e(34743),s=e(36376),r=e(7315),o=e(18828),m=e(85690),l=e(93225),i=e(96540),u=e(13544),d=e(14110),p=e(40845),c=e(10354),y=e(14578),f=e(17464),P=e(40276),a=e(71678),E=e(55852),g=e(2913),h=e(8484),D=e(97427),v=e(68706),C=e(87282),T=e(11219);function S(V){const{dataSource:K}=V,k=(0,p.$j)(),j=x(k,K?.meta.builtIn);return K?i.createElement("img",{className:j.pickerDSLogo,alt:`${K.meta.name} logo`,src:K.meta.info.logos.small}):O()}function O(){const V=(0,p.of)(x);return i.createElement("div",{className:V.pickerDSLogo})}function x(V,K=!1){return{pickerDSLogo:(0,t.css)`
      height: 20px;
      width: 20px;
      filter: invert(${K&&V.isLight?1:0});
    `}}var b=e(50481),M=e(47311);const A="dashboards_dspicker_clicked",R={OPEN_DROPDOWN:"open_dspicker",SELECT_DS:"select_ds",ADD_FILE:"add_file",OPEN_ADVANCED_DS_PICKER:"open_advanced_ds_picker",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state"};function B(V){const{current:K,onChange:k,hideTextValue:j=!1,width:H,inputId:J,noDefault:X=!1,disabled:se=!1,placeholder:ae="Select data source",...ne}=V,q=(0,p.of)(U,V),[ee,z]=(0,i.useState)(!1),[te,ie]=(0,i.useState)(!1),[ce,ue]=(0,i.useState)(""),{onKeyDown:fe,keyboardEvents:Te}=(0,D.d)(),he=(0,i.useRef)(null),[de,le]=(0,i.useState)(),[pe,ve]=(0,i.useState)(),be=(0,C.ps)(K),Oe=(0,C.ps)("-- Grafana --"),Me=!K&&X?void 0:be,Ue=ce&&ee?i.createElement(O,null):i.createElement(S,{dataSource:Me}),we=[(0,n.cY)(4),(0,n.Ej)({apply({availableHeight:re,elements:Z}){Z.floating.style.maxHeight=`${Math.max(200,re-20)}px`,Z.floating.style.minHeight="200px"}}),(0,n.UU)({fallbackStrategy:"initialPlacement",crossAxis:!1,boundary:document.body}),(0,n.BN)()],{refs:Re,floatingStyles:Fe}=(0,s.we)({open:ee,placement:"bottom-start",onOpenChange:z,middleware:we,whileElementsMounted:r.ll,strategy:"fixed"}),xe=(0,i.useCallback)(re=>{Re.setReference(re),le(re)},[Re]),Ve=(0,i.useCallback)(()=>{ue(""),z(!1),de?.focus()},[z,de]),{overlayProps:$e,underlayProps:Xe}=(0,l.e)({onClose:Ve,isDismissable:!0,isOpen:ee,shouldCloseOnInteractOutside:re=>de?!de.isSameNode(re):!1},he),{dialogProps:gt}=(0,o.s)({"aria-label":"Opened data source picker list"},he);function Dt(){(0,d.rR)(A,{item:R.OPEN_DROPDOWN}),z(!0),de?.focus()}function nt(){Oe&&k(Oe,[v.dx])}function at(re){re.key==="Tab"&&!re.shiftKey&&ee&&(re.preventDefault(),pe?.focus()),re.key==="Tab"&&re.shiftKey&&ee&&Ve(),fe(re)}function Ae(re){re.shiftKey?(re.preventDefault(),de?.focus()):Ve()}return(0,i.useEffect)(()=>{const re=Te.subscribe({next:Z=>{switch(Z?.code){case"ArrowDown":Dt(),Z.preventDefault();break;case"ArrowUp":Dt(),Z.preventDefault();break;case"Escape":Ve(),Z.preventDefault();break}}});return()=>re.unsubscribe()}),i.createElement("div",{className:q.container,"data-testid":u.Tp.components.DataSourcePicker.container},i.createElement("div",{className:q.trigger,onClick:Dt},i.createElement(c.p,{id:J||"data-source-picker",className:te?void 0:q.input,"data-testid":u.Tp.components.DataSourcePicker.inputV2,"aria-label":"Select a data source",autoComplete:"off",prefix:Me?Ue:void 0,suffix:i.createElement(y.I,{name:ee?"search":"angle-down"}),placeholder:j?"":(0,M.q7)(Me)||ae,onFocus:()=>{ie(!0)},onBlur:()=>{ie(!1)},onKeyDown:at,value:ce,onChange:re=>{Dt(),ue(re.currentTarget.value)},ref:xe,disabled:se})),ee?i.createElement(f.ZL,null,i.createElement("div",{...Xe}),i.createElement("div",{ref:he,...$e,...gt},i.createElement(W,{...ne,style:Fe,ref:Re.setFloating,footerRef:ve,current:Me,filterTerm:ce,keyboardEvents:Te,onChange:(re,Z)=>{Ve(),re.uid!==Me?.uid&&(k(re,Z),(0,d.rR)(A,{item:R.SELECT_DS,ds_type:re.type}))},onClose:Ve,onClickAddCSV:nt,onDismiss:Ve,onNavigateOutsiteFooter:Ae}))):null)}function U(V,K){return{container:(0,t.css)({position:"relative",cursor:K.disabled?"not-allowed":"pointer",width:V.spacing(K.width||"auto")}),trigger:(0,t.css)({cursor:"pointer",pointerEvents:K.disabled?"none":"auto"}),input:(0,t.css)({"input::placeholder":{color:K.disabled?V.colors.action.disabledText:V.colors.text.primary}})}}const W=i.forwardRef((V,K)=>{const{filterTerm:k,onChange:j,onClose:H,onClickAddCSV:J,current:X,filter:se}=V,ae=(0,i.useCallback)(ee=>{j(ee)},[j]),ne=(0,i.useCallback)(()=>{J?.(),H(),(0,d.rR)(A,{item:R.ADD_FILE})},[J,H]),q=(0,p.of)(N);return i.createElement("div",{style:V.style,ref:K,className:q.container},i.createElement(P.E,null,i.createElement(T.S,{...V,enableKeyboardNavigation:!0,className:q.dataSourceList,current:X,onChange:ae,filter:ee=>(se?se?.(ee):!0)&&(0,M.Zn)(ee,k),onClickEmptyStateCTA:()=>(0,d.rR)(A,{item:R.CONFIG_NEW_DS_EMPTY_STATE})})),i.createElement(m.n1,null,i.createElement(w,{...V,onClickAddCSV:ne,onChange:ae,onNavigateOutsiteFooter:V.onNavigateOutsiteFooter})))});W.displayName="PickerContent";function N(V){return{container:(0,t.css)({display:"flex",flexDirection:"column",background:V.colors.background.primary,boxShadow:V.shadows.z3}),picker:(0,t.css)({background:V.colors.background.secondary}),dataSourceList:(0,t.css)({flex:1}),footer:(0,t.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:V.spacing(1.5),borderTop:`1px solid ${V.colors.border.weak}`,backgroundColor:V.colors.background.secondary})}}function w({onClose:V,onChange:K,onClickAddCSV:k,...j}){const H=(0,p.of)(L),J=j.uploadFile&&g.Ay.featureToggles.editPanelCSVDragAndDrop,X=ae=>{ae.key==="Tab"&&j.onNavigateOutsiteFooter(ae)},se=ae=>{ae.key==="Tab"&&ae.shiftKey&&j.onNavigateOutsiteFooter(ae)};return i.createElement("div",{className:H.footer},i.createElement(a.$s,null,({showModal:ae,hideModal:ne})=>i.createElement(E.$n,{size:"sm",variant:"secondary",fill:"text",onClick:()=>{V(),ae(b.p,{reportedInteractionFrom:"ds_picker",tracing:j.tracing,dashboard:j.dashboard,mixed:j.mixed,metrics:j.metrics,type:j.type,annotations:j.annotations,variables:j.variables,alerting:j.alerting,pluginId:j.pluginId,logs:j.logs,filter:j.filter,uploadFile:j.uploadFile,current:j.current,onDismiss:ne,onChange:(q,ee)=>{K(q,ee),ne()}}),(0,d.rR)(A,{item:R.OPEN_ADVANCED_DS_PICKER})},ref:j.footerRef,onKeyDown:J?se:X},i.createElement(h.x6,{i18nKey:"data-source-picker.open-advanced-button"},"Open advanced data source picker"),i.createElement(y.I,{name:"arrow-right"}))),J&&i.createElement(E.$n,{variant:"secondary",size:"sm",onClick:k,onKeyDown:X},"Add csv or spreadsheet"))}function L(V){return{footer:(0,t.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:V.spacing(1.5),borderTop:`1px solid ${V.colors.border.weak}`,backgroundColor:V.colors.background.secondary})}}},47311:(G,I,e)=>{"use strict";e.d(I,{Df:()=>r,Tj:()=>m,Zn:()=>l,q7:()=>o,tw:()=>i});var t=e(14792),n=e(36974),s=e(14678);function r(u,d){return!u||!d?!1:typeof d=="string"?u.uid===d:u.uid===d.uid}function o(u){if(u){if(typeof u=="string")return`${u} - not found`;if("name"in u)return u.name;if(u.uid)return`${u.uid} - not found`}}function m(u,d,p){return(y,f)=>{const P=y.name.toUpperCase(),a=f.name.toUpperCase();if(u&&r(y,u))return-1;if(u&&r(f,u))return 1;const E=d.indexOf(y.uid),g=d.indexOf(f.uid);if(E>-1&&E>g)return-1;if(g>-1&&g>E)return 1;const h=p.includes(y.uid),D=p.includes(f.uid);return h&&!D?-1:D&&!h||y.meta.builtIn&&!f.meta.builtIn?1:f.meta.builtIn&&!y.meta.builtIn||P<a?-1:1}}function l(u,d=""){return u.name.toLowerCase().includes(d.toLowerCase())}function i(u){if(!u.uid)return;const d=(0,t.UA)().getCurrent()?.uid??"";if(u.uid===s.uv)return(0,n.B1)(d);(0,n.dH)(d,u.uid)}},83883:(G,I,e)=>{"use strict";e.d(I,{I:()=>t});const t={List:"/datasources",Edit:"/datasources/edit/:uid",Dashboards:"/datasources/edit/:uid/dashboards",New:"/datasources/new"}},87282:(G,I,e)=>{"use strict";e.d(I,{Kr:()=>m,TX:()=>o,dR:()=>i,ps:()=>l});var t=e(96540),n=e(78685),s=e(19347);const r="grafana.features.datasources.components.picker.DataSourceDropDown.history";function o(){const[u=[],d]=(0,n.A)(r,[]),p=(0,t.useCallback)(c=>{c.meta.builtIn||(u.includes(c.uid)?(u.splice(u.findIndex(y=>c.uid===y),1),d([...u,c.uid])):d([...u,c.uid].slice(1,6)))},[u,d]);return[u,p]}function m(u){return(0,s.l)().getList(u)}function l(u){const d=(0,s.l)();return d.getInstanceSettings(u)}function i(u){const{keyboardEvents:d,containerRef:p}=u,c=(0,t.useRef)(0),y="data-role",f="keyboardSelectableItem",P={[y]:f},a=`[${y}="${f}"`,E="data-selectedItem",g=`[${E}="true"]`,h=(0,t.useCallback)(v=>{const C=p?.current?.querySelectorAll(a),T=C?.item(v%C?.length);C?.forEach(S=>S.setAttribute(E,"false")),T&&(T.scrollIntoView({block:"center"}),T.setAttribute(E,"true"))},[p,a]),D=(0,t.useCallback)(()=>{p?.current?.querySelector(g)?.querySelector("button")?.click()},[p,g]);return(0,t.useEffect)(()=>{if(!d)return;const v=d.subscribe({next:C=>{switch(C?.code){case"ArrowDown":{h(++c.current),C.preventDefault();break}case"ArrowUp":c.current=c.current>0?c.current-1:c.current,h(c.current),C.preventDefault();break;case"Enter":D();break}}});return()=>v.unsubscribe()},[d,h,D]),(0,t.useEffect)(()=>{const v=new MutationObserver(C=>{C.some(S=>S.addedNodes&&S.addedNodes.length>0||S.removedNodes&&S.removedNodes.length>0)&&h(0)});return p.current&&v.observe(p.current,{childList:!0}),()=>{v.disconnect()}},[p,a,h]),[P,g]}},36227:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>S,Bs:()=>d,C_:()=>f,E1:()=>m,Gc:()=>i,IJ:()=>E,Ks:()=>g,QZ:()=>D,TN:()=>o,Tk:()=>P,UP:()=>C,eB:()=>c,f$:()=>u,gZ:()=>l,jz:()=>r,lg:()=>v,qR:()=>h,rb:()=>y});var t=e(65307),n=e(19484);const s={dataSources:[],plugins:[],categories:[],dataSource:{},layoutMode:n.R.List,searchQuery:"",dataSourcesCount:0,dataSourceTypeSearchQuery:"",isLoadingDataSources:!1,isLoadingDataSourcePlugins:!1,dataSourceMeta:{},isSortAscending:!0},r=(0,t.VP)("dataSources/dataSourceLoaded"),o=(0,t.VP)("dataSources/dataSourcesLoad"),m=(0,t.VP)("dataSources/dataSourcesLoaded"),l=(0,t.VP)("dataSources/dataSourceMetaLoaded"),i=(0,t.VP)("dataSources/dataSourcePluginsLoad"),u=(0,t.VP)("dataSources/dataSourcePluginsLoaded"),d=(0,t.VP)("dataSources/setDataSourcesSearchQuery"),p=(0,t.VP)("dataSources/setDataSourcesLayoutMode"),c=(0,t.VP)("dataSources/setDataSourceTypeSearchQuery"),y=(0,t.VP)("dataSources/setDataSourceName"),f=(0,t.VP)("dataSources/setIsDefault"),P=(0,t.VP)("dataSources/setIsSortAscending"),a=(O=s,x)=>o.match(x)?{...O,isLoadingDataSources:!0}:m.match(x)?{...O,isLoadingDataSources:!1,dataSources:x.payload,dataSourcesCount:x.payload.length}:r.match(x)?{...O,dataSource:x.payload}:d.match(x)?{...O,searchQuery:x.payload}:p.match(x)?{...O,layoutMode:x.payload}:i.match(x)?{...O,plugins:[],isLoadingDataSourcePlugins:!0}:u.match(x)?{...O,plugins:x.payload.plugins,categories:x.payload.categories,isLoadingDataSourcePlugins:!1}:c.match(x)?{...O,dataSourceTypeSearchQuery:x.payload}:l.match(x)?{...O,dataSourceMeta:x.payload}:y.match(x)?{...O,dataSource:{...O.dataSource,name:x.payload}}:f.match(x)?{...O,dataSource:{...O.dataSource,isDefault:x.payload}}:P.match(x)?{...O,isSortAscending:x.payload}:O,E={testingStatus:{},loadError:null,loading:!0,plugin:null},g=(0,t.VP)("dataSourceSettings/initDataSourceSettingsSucceeded"),h=(0,t.VP)("dataSourceSettings/initDataSourceSettingsFailed"),D=(0,t.VP)("dataSourceSettings/testDataSourceStarting"),v=(0,t.VP)("dataSourceSettings/testDataSourceSucceeded"),C=(0,t.VP)("dataSourceSettings/testDataSourceFailed"),S={dataSources:a,dataSourceSettings:(O=E,x)=>g.match(x)?{...O,plugin:x.payload,loadError:null,loading:!1}:h.match(x)?{...O,plugin:null,loadError:x.payload.message,loading:!1}:D.match(x)?{...O,testingStatus:{message:"Testing... this could take up to a couple of minutes",status:"info"}}:v.match(x)?{...O,testingStatus:{status:x.payload?.status,message:x.payload?.message,details:x.payload?.details}}:C.match(x)?{...O,testingStatus:{status:"error",message:x.payload?.message,details:x.payload?.details}}:O}},38074:()=>{"use strict"},25148:(G,I,e)=>{"use strict";e.d(I,{n:()=>P});var t=e(32196),n=e(96540),s=e(40845),r=e(55852),o=e(39268),m=e(14186),l=e(10354),i=e(95868),u=e(13840),d=e(40321),p=e(47694),c=e(21813),y=e(80744),f=e(19448);const P=g=>{const{value:h,src:D,name:v,placeholder:C,onChange:T,onClear:S,mediaType:O,folderName:x,size:b,color:M,maxFiles:A}=g,R=(0,s.of)(E),B=(0,s.$j)(),U=(0,n.createRef)(),W=n.createElement(f.i,{onChange:T,value:h,mediaType:O,folderName:x,maxFiles:A});let N=D;!N&&h&&(N=(0,c.D)(h));const w=M&&{fill:B.visualization.getColorByName(M)},L=()=>h&&N?n.createElement(p.y,{src:N,className:R.icon,style:{...w}}):n.createElement(r.z9,{variant:"primary",fill:"text",size:"sm"},"Set icon"),V=()=>n.createElement(o.C,null,n.createElement(m.I,{label:null,grow:!0},n.createElement(l.p,{value:a(D,v),placeholder:C,readOnly:!0,prefix:N&&n.createElement(p.y,{src:N,className:R.icon,style:{...w}}),suffix:n.createElement(r.$n,{icon:"times",variant:"secondary",fill:"text",size:"sm",onClick:S})})));return n.createElement(i.I,{content:W},(K,k,j)=>n.createElement(n.Fragment,null,U.current&&n.createElement(u.A,{...j,referenceElement:U.current,onMouseEnter:K,onKeyDown:H=>{(0,d.Q)(H,k)}}),n.createElement("div",{ref:U,className:R.pointer,onClick:K,onKeyDown:H=>{H.key==="Enter"&&K()},role:"button",tabIndex:0},b===y.Iy.SMALL&&L(),b===y.Iy.NORMAL&&V())))};function a(g,h){if(g?.startsWith("public/img/icons")){const D=h?.lastIndexOf(".svg")??0;if(D>0)return h.substring(0,D)}return h}const E=g=>({pointer:(0,t.css)`
    cursor: pointer;
    input[readonly] {
      cursor: pointer;
    }
  `,icon:(0,t.css)`
    vertical-align: middle;
    display: inline-block;
    fill: currentColor;
    width: 25px;
  `})},19448:(G,I,e)=>{"use strict";e.d(I,{i:()=>N});var t=e(32196),n=e(18828),s=e(85690),r=e(93225),o=e(96540),m=e(17172),l=e(40845),i=e(55852),u=e(2913),d=e(80744),p=e(88575),c=e(37270),y=e(47694);function f({secondaryText:L="Drag and drop here or browse"}){const V=(0,l.of)(a);return o.createElement("div",{className:V.iconWrapper},o.createElement("small",{className:V.small},L),o.createElement(i.$n,{type:"button",icon:"upload"},"Upload"))}const P=({mediaType:L,setFormData:V,setUpload:K,error:k})=>{const j=(0,l.of)(a),[H,J]=(0,o.useState)(!1),[X,se]=(0,o.useState)(""),ae=()=>o.createElement(p.D,{label:"Preview"},o.createElement("div",{className:j.iconPreview},L===d.zu.Icon&&o.createElement(y.y,{src:X,className:j.img}),L===d.zu.Image&&o.createElement("img",{src:X,alt:"Preview of the uploaded file",className:j.img}))),ne=ee=>{fetch(`/api/storage/delete/upload/${ee.file.name}`,{method:"DELETE"}).catch(z=>console.error("cannot delete file",z))},q=L==="icon"?{"image/*":[".svg",".xml"]}:{"image/*":[".jpeg",".png",".gif",".webp"]};return o.createElement(c.gH,{readAs:"readAsBinaryString",onFileRemove:ne,options:{accept:q,multiple:!1,onDrop:ee=>{let z=new FormData;z.append("file",ee[0]),se(URL.createObjectURL(ee[0])),J(!0),V(z),K(!0)}}},k.message!==""&&H?o.createElement("p",null,k.message):H?o.createElement(ae,null):o.createElement(f,null))};function a(L,V){return{container:(0,t.css)`
      display: flex;
      flex-direction: column;
      width: 100%;
    `,dropzone:(0,t.css)`
      display: flex;
      flex: 1;
      flex-direction: column;
      align-items: center;
      padding: ${L.spacing(6)};
      border-radius: 2px;
      border: 2px dashed ${L.colors.border.medium};
      background-color: ${V?L.colors.background.secondary:L.colors.background.primary};
      cursor: pointer;
    `,iconWrapper:(0,t.css)`
      display: flex;
      flex-direction: column;
      align-items: center;
    `,acceptMargin:(0,t.css)`
      margin: ${L.spacing(2,0,1)};
    `,small:(0,t.css)`
      color: ${L.colors.text.secondary};
      margin-bottom: ${L.spacing(2)};
    `,iconContainer:(0,t.css)`
      display: flex;
      flex-direction: column;
      width: 80%;
      align-items: center;
      align-self: center;
    `,iconPreview:(0,t.css)`
      width: 238px;
      height: 198px;
      border: 1px solid ${L.colors.border.medium};
      display: flex;
      align-items: center;
      justify-content: center;
    `,img:(0,t.css)`
      width: 147px;
      height: 147px;
      fill: ${L.colors.text.primary};
    `}}var E=e(21594),g=e(67647),h=e(31193),D=e(70713),v=e(91793);const C=(0,o.memo)(function(V){const{columnIndex:K,rowIndex:k,style:j,data:H}=V,{cards:J,columnCount:X,onChange:se,selected:ae}=H,ne=K+k*X,q=J[ne],ee=(0,l.of)(S);return o.createElement("div",{style:j},q&&o.createElement("div",{key:q.value,className:ae===q.value?(0,t.cx)(ee.card,ee.selected):ee.card,onClick:()=>se(q.value),onKeyDown:z=>{z.key==="Enter"&&se(q.value)},role:"button",tabIndex:0},q.imgUrl.endsWith(".svg")?o.createElement(y.y,{src:q.imgUrl,className:ee.img}):o.createElement("img",{src:q.imgUrl,alt:"",className:ee.img}),o.createElement("h6",{className:ee.text},q.label.slice(0,-4))))},v.t7),T=L=>{const{onChange:V,cards:K,value:k}=L,j=(0,l.of)(S);return o.createElement(D.Ay,{defaultWidth:680},({width:H,height:J})=>{const ae=Math.floor(H/90),ne=Math.ceil(K.length/ae);return o.createElement(v.yi,{width:H,height:J,columnCount:ae,columnWidth:90,rowCount:ne,rowHeight:90,itemData:{cards:K,columnCount:ae,onChange:V,selected:k},className:j.grid},C)})},S=L=>({card:(0,t.css)`
    display: inline-block;
    width: 90px;
    height: 90px;
    margin: 0.75rem;
    margin-left: 15px;
    text-align: center;
    cursor: pointer;
    position: relative;
    background-color: transparent;
    border: 1px solid transparent;
    border-radius: 8px;
    padding-top: 6px;
    :hover {
      border-color: ${L.colors.action.hover};
      box-shadow: ${L.shadows.z2};
    }
  `,selected:(0,t.css)`
    border: 2px solid ${L.colors.primary.main};
    :hover {
      border-color: ${L.colors.primary.main};
    }
  `,img:(0,t.css)`
    width: 40px;
    height: 40px;
    object-fit: cover;
    vertical-align: middle;
    fill: ${L.colors.text.primary};
  `,text:(0,t.css)`
    color: ${L.colors.text.primary};
    white-space: nowrap;
    font-size: 12px;
    text-overflow: ellipsis;
    display: block;
    overflow: hidden;
  `,grid:(0,t.css)`
    border: 1px solid ${L.colors.border.medium};
  `}),O=L=>L===d.zu.Icon?[d.Iu.Icon,d.Iu.IOT,d.Iu.Marker]:[d.Iu.BG],x=(L,V)=>L.find(K=>V.startsWith(K.value))??L[0],b=L=>{const{value:V,mediaType:K,folderName:k,newValue:j,setNewValue:H,maxFiles:J}=L,X=(0,l.of)(M),se=O(K).map(fe=>({label:fe,value:fe})),[ae,ne]=(0,o.useState)(),[q,ee]=(0,o.useState)(x(se,V?.length?V:k)),[z,te]=(0,o.useState)([]),[ie,ce]=(0,o.useState)([]),ue=fe=>{fe?(fe=fe.toLowerCase(),ce(z.filter(Te=>Te.search.includes(fe)))):ce(z)};return(0,o.useEffect)(()=>{const fe=q?.value;if(fe){const Te=K===d.zu.Icon?he=>he.name.endsWith(".svg"):he=>he.name.endsWith(".png")||he.name.endsWith(".gif");(0,h.tR)().get("-- Grafana --").then(he=>{he.listFiles(fe,J).subscribe({next:de=>{const le=[];de.forEach(pe=>{if(Te(pe)){const ve=pe.name.lastIndexOf(".");le.push({value:`${fe}/${pe.name}`,label:pe.name,search:(ve?pe.name.substring(0,ve):pe.name).toLowerCase(),imgUrl:`public/${fe}/${pe.name}`})}}),te(le),ce(le)}})})}},[K,q,J]),o.createElement(o.Fragment,null,o.createElement(p.D,null,o.createElement(E.l6,{options:se,onChange:ee,value:q,menuShouldPortal:!1})),o.createElement(p.D,null,o.createElement(g.Z,{value:ae??"",placeholder:"Search",onChange:fe=>{ue(fe),ne(fe)}})),ie&&o.createElement("div",{className:X.cardsWrapper},o.createElement(T,{cards:ie,onChange:fe=>H(fe),value:j})))},M=L=>({cardsWrapper:(0,t.css)`
    height: 30vh;
    min-height: 50px;
    margin-top: 5px;
    max-width: 680px;
  `});var A=e(10354),R=e(60029),B=e(21813);const U=L=>{const{newValue:V,setNewValue:K,mediaType:k}=L,j=(0,l.of)(W),H=(0,B.D)(V);let J=V?.substring(V.lastIndexOf("/")+1,V.lastIndexOf("."));return J.length>20&&(J=J.substring(0,20)+"..."),o.createElement(o.Fragment,null,o.createElement(p.D,null,o.createElement(A.p,{onChange:X=>K(X.currentTarget.value),value:V})),o.createElement("div",{className:j.iconContainer},o.createElement(p.D,{label:"Preview"},o.createElement("div",{className:j.iconPreview},k===d.zu.Icon&&o.createElement(y.y,{src:H,className:j.img}),k===d.zu.Image&&V&&o.createElement("img",{src:H,alt:"Preview of the selected URL",className:j.img}))),o.createElement(R.J,null,J)))},W=L=>({iconContainer:(0,t.css)`
    display: flex;
    flex-direction: column;
    width: 80%;
    align-items: center;
    align-self: center;
  `,iconPreview:(0,t.css)`
    width: 238px;
    height: 198px;
    border: 1px solid ${L.colors.border.medium};
    display: flex;
    align-items: center;
    justify-content: center;
  `,img:(0,t.css)`
    width: 147px;
    height: 147px;
    fill: ${L.colors.text.primary};
  `}),N=L=>{const{value:V,onChange:K,mediaType:k,folderName:j,maxFiles:H}=L,J=(0,l.of)(w),X=()=>{K(V)},se=(0,o.createRef)(),{dialogProps:ae}=(0,n.s)({},se),{overlayProps:ne}=(0,r.e)({onClose:X,isDismissable:!0,isOpen:!0},se),q=V&&V.includes("://"),[ee,z]=(0,o.useState)(V??""),[te,ie]=(0,o.useState)(q?d.QC.URL:d.QC.Folder),[ce,ue]=(0,o.useState)(new FormData),[fe,Te]=(0,o.useState)(!1),[he,de]=(0,o.useState)({message:""}),le=Me=>`${J.resourcePickerPopoverTab} ${te===Me&&J.resourcePickerPopoverActiveTab}`,pe=()=>o.createElement(b,{value:V,mediaType:k,folderName:j,newValue:ee,setNewValue:z,maxFiles:H}),ve=()=>o.createElement(U,{newValue:ee,setNewValue:z,mediaType:k}),be=()=>o.createElement(P,{mediaType:k,setFormData:ue,setUpload:Te,newValue:ee,error:he}),Oe=()=>{switch(te){case d.QC.Folder:return pe();case d.QC.URL:return ve();case d.QC.Upload:return be();default:return pe()}};return o.createElement(s.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},o.createElement("section",{ref:se,...ne,...ae},o.createElement("div",{className:J.resourcePickerPopover},o.createElement("div",{className:J.resourcePickerPopoverTabs},o.createElement("button",{className:le(d.QC.Folder),onClick:()=>ie(d.QC.Folder)},"Folder"),o.createElement("button",{className:le(d.QC.URL),onClick:()=>ie(d.QC.URL)},"URL")),o.createElement("div",{className:J.resourcePickerPopoverContent},Oe(),o.createElement("div",{className:J.buttonRow},o.createElement(i.$n,{variant:"secondary",onClick:()=>X(),fill:"outline"},"Cancel"),o.createElement(i.$n,{variant:ee&&ee!==V?"primary":"secondary",onClick:()=>{fe?fetch("/api/storage/upload",{method:"POST",body:ce}).then(Me=>{if(Me.status>=400){Me.json().then(Ue=>de(Ue));return}else return Me.json()}).then(Me=>{(0,m.AI)().get(`api/storage/read/${Me.path}`).then(()=>z(`${u.config.appUrl}api/storage/read/${Me.path}`)).then(()=>K(`${u.config.appUrl}api/storage/read/${Me.path}`))}).catch(Me=>console.error(Me)):K(ee)}},"Select"))))))},w=L=>({resourcePickerPopover:(0,t.css)`
    border-radius: ${L.shape.radius.default};
    box-shadow: ${L.shadows.z3};
    background: ${L.colors.background.primary};
    border: 1px solid ${L.colors.border.weak};
  `,resourcePickerPopoverTab:(0,t.css)`
    width: 50%;
    text-align: center;
    padding: ${L.spacing(1,0)};
    background: ${L.colors.background.secondary};
    color: ${L.colors.text.secondary};
    font-size: ${L.typography.bodySmall.fontSize};
    cursor: pointer;
    border: none;

    &:focus:not(:focus-visible) {
      outline: none;
      box-shadow: none;
    }

    :focus-visible {
      position: relative;
    }
  `,resourcePickerPopoverActiveTab:(0,t.css)`
    color: ${L.colors.text.primary};
    font-weight: ${L.typography.fontWeightMedium};
    background: ${L.colors.background.primary};
  `,resourcePickerPopoverContent:(0,t.css)`
    width: 315px;
    font-size: ${L.typography.bodySmall.fontSize};
    min-height: 184px;
    padding: ${L.spacing(1)};
    display: flex;
    flex-direction: column;
  `,resourcePickerPopoverTabs:(0,t.css)`
    display: flex;
    width: 100%;
    border-radius: ${L.shape.radius.default} ${L.shape.radius.default} 0 0;
  `,buttonRow:(0,t.css)({display:"flex",justifyContent:"center",gap:L.spacing(2),padding:L.spacing(1)})})},63577:(G,I,e)=>{"use strict";e.d(I,{MediaType:()=>t.zu,ResourceFolderName:()=>t.Iu,findField:()=>o.UI,findFieldIndex:()=>o.gG,getColorDimension:()=>m,getPublicOrAbsoluteUrl:()=>f.D,getResourceDimension:()=>f.$,getScalarDimension:()=>a.H,getScaledDimension:()=>i.hX,getScaledDimensionForField:()=>i.qx,getTextDimension:()=>c});var t=e(80744),n=e(8066),s=e(58563),r=e(57875),o=e(33924);function m(E,g,h){return l((0,o.UI)(E,g.field),g,h)}function l(E,g,h){if(!E){const C=h.visualization.getColorByName(g.fixed??"grey");return{isAssumed:!!g.field?.length||!g.fixed,fixed:C,value:()=>C,get:T=>C}}const D=(0,n.Qi)(E);if(D.isByValue||E.config.mappings?.length){const C=(0,s.xg)(E,!0);C!==E.config&&(E={...E,config:C},E.state=void 0);const T=(0,r.J)({field:E,theme:h}),S=O=>T(O).color??"#ccc";return{field:E,get:O=>S(E.values[O]),value:()=>S((0,o.sB)(E))}}const v=D.getCalculator(E,h)(0,0);return{fixed:v,value:()=>v,get:C=>v,field:E}}var i=e(18379),u=e(11261),d=e(83195),p=e(52622);function c(E,g){const h=g.field?(0,o.UI)(E,g.field):E?.fields.find(D=>D.type===u.PU.string);return y(h,g)}function y(E,g){let h=g.fixed;const D=g.mode??p.RU.Fixed;if(D===p.RU.Fixed)return{isAssumed:!h,fixed:h,value:()=>h,get:C=>h};if(D===p.RU.Template){const C=T=>`TEMPLATE[${g.fixed} // ${T}]`;return E?{field:E,get:T=>C(E.values[T]),value:()=>C((0,o.sB)(E))}:(h=C(""),{isAssumed:!0,fixed:h,value:()=>h,get:T=>h})}if(!E)return{isAssumed:!0,fixed:h,value:()=>h,get:C=>h};let v=C=>(0,d.cN)(E.display(C));return{field:E,get:C=>v(E.values[C]),value:()=>v((0,o.sB)(E))}}var f=e(21813),P=e(38074),a=e(26781)},21813:(G,I,e)=>{"use strict";e.d(I,{$:()=>r,D:()=>s});var t=e(52622),n=e(33924);function s(o){return o?o.indexOf(":/")>0?o:window.__grafana_public_path__+o:""}function r(o,m){const l=m.mode??t.q_.Fixed;if(l===t.q_.Fixed){const d=s(m.fixed);return{isAssumed:!d,fixed:d,value:()=>d,get:p=>d}}const i=(0,n.UI)(o,m.field);if(!i){const d="";return{isAssumed:!0,fixed:d,value:()=>d,get:p=>d}}if(l===t.q_.Mapping){const d=p=>s(`${p}`);return{field:i,get:p=>d(i.values[p]),value:()=>d((0,n.sB)(i))}}const u=d=>{if(i&&i.display){const p=i.display(d).icon;return s(p??"")}return""};return{field:i,get:d=>u(i.values[d]),value:()=>u((0,n.sB)(i))}}},26781:(G,I,e)=>{"use strict";e.d(I,{H:()=>s});var t=e(52622),n=e(33924);function s(o,m){return r((0,n.UI)(o,m?.field),m)}function r(o,m){if(!o){const u=m.fixed??0;return{isAssumed:!!m.field?.length||!m.fixed,fixed:u,value:()=>u,get:()=>u}}let l=u=>u%m.max;return m.mode===t.WQ.Clamped&&(l=u=>u<m.min?m.min:u>m.max?m.max:u),{field:o,get:u=>{const d=o.values[u];return d===null||typeof d!="number"?0:l(d)},value:()=>(0,n.sB)(o)}}},18379:(G,I,e)=>{"use strict";e.d(I,{Nn:()=>m,Ru:()=>l,hX:()=>r,qx:()=>o});var t=e(58563),n=e(52622),s=e(33924);function r(i,u){return o((0,s.UI)(i,u?.field),u)}function o(i,u,d){if(!i){const a=u.fixed??0;return{isAssumed:!!u.field?.length||!u.fixed,fixed:a,value:()=>a,get:()=>a}}const p=(0,t.AP)(i),c=u.max-u.min;if(i.values.length<1||c<=0||p.delta<=0)return{fixed:u.min,value:()=>u.min,get:()=>u.min};let f=a=>u.min+a*c;if(d===n.QH.Quad){const a=Math.PI*(u.max/2)**2,E=Math.PI*(u.min/2)**2,g=a-E;f=h=>{let D=E+g*h;return Math.sqrt(D/Math.PI)*2}}const P=a=>{const E=i.values[a];let g=0;return E!==-1/0&&(g=(E-p.min)/p.delta),g>1?g=1:g<0&&(g=0),f(g)};return{get:P,value:()=>P((0,s.sB)(i)),field:i}}function m(i){return i||(i={min:0,max:1}),i.min==null&&(i.min=0),i.max==null&&(i.max=1),i}function l(i,u){let{min:d,max:p}=m(u);if(i||(i={}),i.max==null&&(i.max=p),i.min==null&&(i.min=d),i.min>i.max){const c=i.max;i.max=i.min,i.min=c}return i.min<d&&(i.min=d),i.max>p&&(i.max=p),i.fixed==null&&(i.fixed=i.min+(i.max-i.min)/2),i.field||(i.fixed>p?i.fixed=p:i.fixed<d&&(i.fixed=d)),i}},80744:(G,I,e)=>{"use strict";e.d(I,{Iu:()=>s,Iy:()=>m,QC:()=>o,nG:()=>n,zu:()=>r});var t=e(52622);const n=Object.freeze({fixed:"",mode:t.RU.Field,field:""});var s=(l=>(l.Icon="img/icons/unicons",l.IOT="img/icons/iot",l.Marker="img/icons/marker",l.BG="img/bg",l))(s||{}),r=(l=>(l.Icon="icon",l.Image="image",l))(r||{}),o=(l=>(l.Folder="folder",l.URL="url",l.Upload="upload",l))(o||{}),m=(l=>(l.SMALL="small",l.NORMAL="normal",l))(m||{})},33924:(G,I,e)=>{"use strict";e.d(I,{B_:()=>u,UI:()=>p,Wb:()=>m,XV:()=>l,b5:()=>i,gG:()=>c,sB:()=>y,wv:()=>d});var t=e(28240),n=e(75059),s=e(32264),r=e(63577),o=e(26781);function m(f,P){if(f?.series&&P.field)for(const a of f.series){const E=(0,r.getColorDimension)(a,P,s.$.theme2);if(!E.isAssumed||f.series.length===1)return E}return(0,r.getColorDimension)(void 0,P,s.$.theme2)}function l(f,P){if(f?.series&&P.field)for(const a of f.series){const E=(0,r.getScaledDimension)(a,P);if(!E.isAssumed||f.series.length===1)return E}return(0,r.getScaledDimension)(void 0,P)}function i(f,P){if(f?.series&&P.field)for(const a of f.series){const E=(0,o.H)(a,P);if(!E.isAssumed||f.series.length===1)return E}return(0,o.H)(void 0,P)}function u(f,P){if(f?.series&&P.field)for(const a of f.series){const E=(0,r.getResourceDimension)(a,P);if(!E.isAssumed||f.series.length===1)return E}return(0,r.getResourceDimension)(void 0,P)}function d(f,P){if(f?.series&&P.field)for(const a of f.series){const E=(0,r.getTextDimension)(a,P);if(!E.isAssumed||f.series.length===1)return E}return(0,r.getTextDimension)(void 0,P)}function p(f,P){const a=c(P,f);return a==null?void 0:f.fields[a]}function c(f,P,a){if(!(!P||!f?.length))for(let E=0;E<P.fields.length;E++){const g=P.fields[E];if(f===g.name)return E;const h=(0,t.Ct)(g,P,a);if(f===h)return E}}function y(f){const P=f.state?.calcs;if(P){const g=P[n.gy.lastNotNull];if(g!=null)return g}const a=f.values;let E=a.length-1;for(;E>=0;){const g=a[E--];if(g!=null)return g}}},9791:(G,I,e)=>{"use strict";e.d(I,{k:()=>S});var t=e(2543),n=e(96540),s=e(84596),r=e(39070),o=e(47232),m=e(28528),l=e(24293),i=e(90708),u=e(28240),d=e(94624),p=e(24308),c=e(52622),y=e(40845),f=e(79041),P=e(41706),a=e(91126),E=e(33368),g=e(1932);function h(O,x,b){return(0,g.jM)(O,M=>{M.defaults.custom===void 0&&(M.defaults.custom={}),M.defaults.max=b;const{custom:A}=M.defaults;switch(A.stacking===void 0&&(A.stacking={group:"A"}),x){case"lines":A.drawStyle=c.GR.Line,A.stacking.mode=c.gs.None,A.fillOpacity=0;break;case"bars":A.drawStyle=c.GR.Bars,A.stacking.mode=c.gs.None,A.fillOpacity=100;break;case"points":A.drawStyle=c.GR.Points,A.stacking.mode=c.gs.None,A.fillOpacity=0;break;case"stacked_lines":A.drawStyle=c.GR.Line,A.stacking.mode=c.gs.Normal,A.fillOpacity=100,A.axisSoftMin=0;break;case"stacked_bars":A.drawStyle=c.GR.Bars,A.stacking.mode=c.gs.Normal,A.fillOpacity=100,A.axisSoftMin=0;break;default:{const R=x;throw new Error(`Invalid graph-style: ${R}`)}}})}function D(O,x,b){return(0,g.jM)(O,M=>{M.defaults.thresholds=b,M.defaults.custom=M.defaults.custom??{},M.defaults.custom.thresholdsStyle=x})}var v=e(56737),C=e(21423);function T(O){const[x,{inc:b}]=(0,v.A)(1),M=(0,s.A)(O);return(0,n.useMemo)(()=>{M&&!(0,C.J3)(O,M,C.bW)&&b()},[O,M,b]),x}function S({data:O,height:x,width:b,timeZone:M,absoluteRange:A,onChangeTime:R,loadingState:B,annotations:U,onHiddenSeriesChanged:W,splitOpenFn:N,graphStyle:w,tooltipDisplayMode:L=c.$N.Single,anchorToZero:V=!1,yAxisMaximum:K,thresholdsConfig:k,thresholdsStyle:j,eventBus:H,vizLegendOverrides:J,toggleLegendRef:X}){const se=(0,y.$j)(),ae=(0,s.A)(A),ne=B===r.Gu.Loading&&ae?ae:A,q=(0,n.useMemo)(()=>({from:(0,o.KQ)(ne.from),to:(0,o.KQ)(ne.to),raw:{from:(0,o.KQ)(ne.from),to:(0,o.KQ)(ne.to)}}),[ne.from,ne.to]),ee=(0,n.useMemo)(()=>(0,m.O)((0,P.V)(P.S),"Explore"),[]),[z,te]=(0,n.useState)({defaults:{min:V?0:void 0,max:K||void 0,unit:"short",color:{mode:l.Y.PaletteClassic},custom:{drawStyle:c.GR.Line,fillOpacity:0,pointSize:5}},overrides:[]}),ie=(0,n.useMemo)(()=>{const pe=h(z,w,K);return D(pe,j,k)},[z,w,K,k,j]),ce=(0,E.h)(N,q),ue=(0,n.useMemo)(()=>(0,i.we)({fieldConfig:ie,data:O,timeZone:M,replaceVariables:pe=>pe,theme:se,fieldConfigRegistry:ee,dataLinkPostProcessor:ce}),[ee,O,M,se,ie,ce]),fe=(0,n.useMemo)(()=>(0,i.we)({fieldConfig:{defaults:{},overrides:[]},data:U,timeZone:M,replaceVariables:pe=>pe,theme:se,dataLinkPostProcessor:ce}),[U,M,se,ce]),Te=T(ue);(0,n.useEffect)(()=>{if(W){const pe=[];ue.forEach(ve=>{ve.fields.map(Oe=>Oe.config?.custom?.hideFrom?.viz).every(t.identity)&&pe.push((0,u.Ri)(ve))}),W(pe)}},[ue,W]);const he={eventsScope:"explore",eventBus:H,sync:()=>d.y.Off,onToggleSeriesVisibility(pe,ve){te((0,a.M)(pe,ve,z,O))},dataLinkPostProcessor:ce};function de(pe,ve){te((0,a.M)(pe,ve,z,O))}X&&(X.current=de);const le=(0,n.useMemo)(()=>({tooltip:{mode:L,sort:c.xB.None},legend:{displayMode:c.lm.List,showLegend:!0,placement:"bottom",calcs:[],...J}}),[L,J]);return n.createElement(f.XF,{value:he},n.createElement(p.m,{data:{series:ue,timeRange:q,state:B,annotations:fe,structureRev:Te},pluginId:"timeseries",title:"",width:b,height:x,onChangeTimeRange:R,timeZone:M,options:le}))}},72519:(G,I,e)=>{"use strict";e.d(I,{y:()=>T});var t=e(32196),n=e(96540),s=e(42941),r=e(40845),o=e(91052),m=e(14578),l=e(56034),i=e(55852),u=e(8484),d=e(34028),p=e(9791),c=e(94354),y=e(31678);const f=y.EXPLORE_GRAPH_STYLES.map(O=>({value:O,label:O[0].toUpperCase()+O.slice(1).replace(/_/," ")}));function P(O){const{graphStyle:x,onChangeGraphStyle:b}=O;return n.createElement(c.z,{size:"sm",options:f,value:x,onChange:b})}var a=e(33390);const E="grafana.explore.style.graph",g=O=>{store.set(E,O)},h=()=>v(a.A.get(E)),D="lines",v=O=>y.EXPLORE_GRAPH_STYLES.find(b=>b===O)??D,C=20,T=({data:O,eventBus:x,height:b,width:M,absoluteRange:A,timeZone:R,annotations:B,onChangeTime:U,splitOpenFn:W,thresholdsConfig:N,thresholdsStyle:w,loadingState:L,statusMessage:V})=>{const[K,k]=(0,s.A)(!1),[j,H]=(0,n.useState)(h),J=(0,r.of)(S),X=(0,n.useCallback)(ae=>{(0,d.ng)(ae),H(ae)},[]),se=(0,n.useMemo)(()=>K?O:O.slice(0,C),[O,K]);return n.createElement(o.NR,{title:(0,u.t)("graph.container.title","Graph"),titleItems:[!K&&C<O.length&&n.createElement("div",{key:"disclaimer",className:J.timeSeriesDisclaimer},n.createElement("span",{className:J.warningMessage},n.createElement(m.I,{name:"exclamation-triangle","aria-hidden":"true"}),n.createElement(u.x6,{i18nKey:"graph.container.show-only-series"},"Showing only ",{MAX_NUMBER_OF_TIME_SERIES:C}," series")),n.createElement(l.m,{content:(0,u.t)("graph.container.content","Rendering too many series in a single panel may impact performance and make data harder to read. Consider refining your queries.")},n.createElement(i.$n,{variant:"secondary",size:"sm",onClick:k},n.createElement(u.x6,{i18nKey:"graph.container.show-all-series"},"Show all ",{length:O.length}))))].filter(Boolean),width:M,height:b,loadingState:L,statusMessage:V,actions:n.createElement(P,{graphStyle:j,onChangeGraphStyle:X})},(ae,ne)=>n.createElement(p.k,{graphStyle:j,data:se,height:ne,width:ae,absoluteRange:A,onChangeTime:U,timeZone:R,annotations:B,splitOpenFn:W,loadingState:L,thresholdsConfig:N,thresholdsStyle:w,eventBus:x}))},S=O=>({timeSeriesDisclaimer:(0,t.css)({label:"time-series-disclaimer",display:"flex",alignItems:"center",gap:O.spacing(1)}),warningMessage:(0,t.css)({display:"flex",alignItems:"center",gap:O.spacing(.5),color:O.colors.warning.main,fontSize:O.typography.bodySmall.fontSize})})},97186:(G,I,e)=>{"use strict";e.d(I,{$:()=>t,r:()=>n});const t={showLabels:"grafana.explore.logs.showLabels",showTime:"grafana.explore.logs.showTime",wrapLogMessage:"grafana.explore.logs.wrapLogMessage",prettifyLogMessage:"grafana.explore.logs.prettifyLogMessage",logsSortOrder:"grafana.explore.logs.sortOrder",logContextWrapLogMessage:"grafana.explore.logs.logContext.wrapLogMessage"},n="grafana.explore.logs.visualisationType"},9651:(G,I,e)=>{"use strict";e.d(I,{a:()=>l,d:()=>i});var t=e(32196),n=e(96540),s=e(75212),r=e(40845),o=e(9663);const m=(u,d)=>({valueNavigation:(0,t.css)`
      width: ${o.QH};
      font-weight: bold;
    `,valueNavigationWrapper:(0,t.css)`
      display: flex;
      justify-content: flex-end;
    `,itemLabelsWrap:(0,t.css)`
      ${d?"":`border-bottom: 1px solid ${u.colors.border.medium}`};
    `}),l=u=>u.includes(s.gs)?u.replace(s.gs,""):u,i=({valueLabels:u,expanded:d})=>{const p=(0,r.of)(m,d);return n.createElement("div",{className:p.itemLabelsWrap},n.createElement("div",{className:p.valueNavigationWrapper},u.map((c,y)=>n.createElement("span",{className:p.valueNavigation,key:c.name},l(c.name)))))}},9663:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>D,QH:()=>P,Jd:()=>a});var t=e(32196),n=e(96540),s=e(73287),r=e(14110),o=e(40845),m=e(29158),l=e(9651),i=e(57408);const u=(v,C)=>({rowWrapper:(0,t.css)`
    position: relative;
    min-width: ${P};
    padding-right: 5px;
  `,rowValue:(0,t.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    display: block;
    padding-right: 10px;

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:before {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(to right, transparent calc(100% - 25px), ${v.colors.background.primary});
    }
  `,rowValuesWrap:(0,t.css)`
    padding-left: ${a};
    width: calc(${C} * ${P});
    display: flex;
  `}),d=({totalNumberOfValues:v,values:C,hideFieldsWithoutValues:T})=>{const S=(0,o.of)(u,v);return n.createElement("div",{role:"cell",className:S.rowValuesWrap},C?.map(O=>T&&(O.value===void 0||O.value===i.M)?null:n.createElement("span",{key:O.key,className:S.rowWrapper},n.createElement("span",{className:S.rowValue},O.value))))},p=v=>{const C=v.isDark?"#ce9178":"#a31515",T=v.isDark?"#73bf69":"#56a64b";return{metricName:(0,t.css)`
      color: ${T};
    `,metricValue:(0,t.css)`
      color: ${C};
    `,expanded:(0,t.css)`
      display: block;
      text-indent: 1em;
    `}},y=({value:v,index:C,length:T,isExpandedView:S})=>{const O=(0,o.of)(p),x=v.key,b=v.value;return n.createElement("span",{className:S?O.expanded:"",key:C},n.createElement("span",{className:O.metricName},x),n.createElement("span",null,"="),n.createElement("span",null,'"'),n.createElement("span",{className:O.metricValue},b),n.createElement("span",null,'"'),C<T-1&&n.createElement("span",null,", "))},f="20px",P="80px",a="25px",E=(v,C,T)=>({rowWrapper:(0,t.css)`
    border-bottom: 1px solid ${v.colors.border.medium};
    display: flex;
    position: relative;
    padding-left: 22px;
    ${T?"":"align-items: center;"}
    ${T?"":"height: 100%;"}
  `,copyToClipboardWrapper:(0,t.css)`
    position: absolute;
    left: 0;
    ${T?"":"bottom: 0;"}
    ${T?"top: 4px;":"top: 0;"}
    margin: auto;
    z-index: 1;
    height: 16px;
    width: 16px;
  `,rowLabelWrapWrap:(0,t.css)`
    position: relative;
    width: calc(100% - (${C} * ${P}) - ${a});
  `,rowLabelWrap:(0,t.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    padding-right: ${f};

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:after {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(
        to right,
        transparent calc(100% - ${f}),
        ${v.colors.background.primary}
      );
    }
  `});function g(v){let C=[],T=[];for(const S in v)S in v&&v[S]&&!S.includes("Value")?C.push({key:S,value:v[S]}):S in v&&v[S]&&S.includes("Value")&&T.push({key:S,value:v[S]});return{values:T,attributeValues:C}}const D=({listItemData:v,listKey:C,totalNumberOfValues:T,valueLabels:S,isExpandedView:O})=>{const{__name__:x,...b}=v,[M,A]=(0,s.A)(),R=S?.length??T,B=(0,o.of)(E,R,O),{values:U,attributeValues:W}=g(b),N=V=>V==="\u221E"||V==="Infinity"?"+Inf":V,w=`${x}{${W.map(V=>`${V.key}="${N(V.value)}"`)}}`,L=!!(S&&S?.length);return n.createElement(n.Fragment,null,S!==void 0&&O&&n.createElement(l.d,{valueLabels:S,expanded:O}),n.createElement("div",{key:C,className:B.rowWrapper},n.createElement("span",{className:B.copyToClipboardWrapper},n.createElement(m.K,{tooltip:"Copy to clipboard",onClick:()=>{(0,r.rR)("grafana_explore_prometheus_instant_query_ui_raw_toggle_expand"),A(w)},name:"copy"})),n.createElement("span",{role:"cell",className:B.rowLabelWrapWrap},n.createElement("div",{className:B.rowLabelWrap},n.createElement("span",null,x),n.createElement("span",null,"{"),n.createElement("span",null,W.map((V,K)=>n.createElement(y,{isExpandedView:O,value:V,key:K,index:K,length:W.length}))),n.createElement("span",null,"}"))),n.createElement(d,{hideFieldsWithoutValues:L,totalNumberOfValues:R,values:U})))}},57408:(G,I,e)=>{"use strict";e.d(I,{E:()=>s,M:()=>n});var t=e(83195);const n=" ",s=r=>{const o={},m=[],l=r.fields.filter(d=>!["Time"].includes(d.name));let i=l.find(d=>d.name==="__name__")?.values??[];!i.length&&l.length&&l[0].values.length&&(i=Array(l[0].values.length).fill(""));const u=r.fields.filter(d=>!["__name__"].includes(d.name));return i.forEach(function(d,p){o[d]={};const c=o[d][p]??{};for(const y of u){const f=y.name;if(f!=="Time")if(typeof y?.display=="function"){const P=y?.display(y.values[p]);if(!isNaN(P.numeric))c[f]=P.numeric.toString(10);else{const a=(0,t.cN)(P);a?c[f]=a:f.includes("Value #")&&(c[f]=n)}}else console.warn("Field display method is missing!")}m.push({...c,__name__:d})}),m}},97814:(G,I,e)=>{"use strict";e.d(I,{g:()=>s});var t=e(96540),n=e(47232);const s=({timeInMs:o,className:m,humanize:l})=>t.createElement("span",{className:m},r(o,l)),r=(o,m=!1)=>{const l=o/1e3;if(!m)return`${l.toFixed(1)}s`;const i=(0,n.Ah)(l,"seconds"),u=i.hours(),d=i.minutes(),p=i.seconds();return u?`${u}h ${d}m ${p}s`:d?`${d}m ${p}s`:`${p}s`}},92599:(G,I,e)=>{"use strict";e.d(I,{V:()=>Ae});var t=e(32196),n=e(96540),s=e(42941),r=e(41987),o=e(6709);function m(Z){if(Z?.tracesToLogsV2)return Z.tracesToLogsV2;if(!Z?.tracesToLogs)return;const oe={customQuery:!1};return oe.datasourceUid=Z.tracesToLogs.datasourceUid,oe.tags=Z.tracesToLogs.mapTagNamesEnabled?Z.tracesToLogs.mappedTags:Z.tracesToLogs.tags?.map(Ee=>({key:Ee})),oe.filterByTraceID=Z.tracesToLogs.filterByTraceID,oe.filterBySpanID=Z.tracesToLogs.filterBySpanID,oe.spanStartTimeShift=Z.tracesToLogs.spanStartTimeShift,oe.spanEndTimeShift=Z.tracesToLogs.spanEndTimeShift,oe}function l({options:Z,onOptionsChange:oe}){const Ee=["loki","elasticsearch","grafana-splunk-datasource","grafana-opensearch-datasource","grafana-falconlogscale-datasource","googlecloud-logging-datasource"],ye=useMemo(()=>m(Z.jsonData)||{customQuery:!1},[Z.jsonData]),{query:Se="",tags:Be,customQuery:We}=ye,Ke=useCallback(it=>{oe({...Z,jsonData:{...Z.jsonData,tracesToLogsV2:{...ye,...it},tracesToLogs:void 0}})},[oe,Z,ye]);return React.createElement("div",{className:css({width:"100%"})},React.createElement(InlineFieldRow,null,React.createElement(InlineField,{tooltip:"The logs data source the trace is going to navigate to",label:"Data source",labelWidth:26},React.createElement(DataSourcePicker,{inputId:"trace-to-logs-data-source-picker",filter:it=>Ee.includes(it.type),current:ye.datasourceUid,noDefault:!0,width:40,onChange:it=>Ke({datasourceUid:it.uid})}))),React.createElement(InlineFieldRow,null,React.createElement(IntervalInput,{label:u("start"),tooltip:d("start","0"),value:ye.spanStartTimeShift||"",onChange:it=>{Ke({spanStartTimeShift:it})},isInvalidError:p})),React.createElement(InlineFieldRow,null,React.createElement(IntervalInput,{label:u("end"),tooltip:d("end","0"),value:ye.spanEndTimeShift||"",onChange:it=>{Ke({spanEndTimeShift:it})},isInvalidError:p})),React.createElement(InlineFieldRow,null,React.createElement(InlineField,{tooltip:"Tags that will be used in the query. Default tags: 'cluster', 'hostname', 'namespace', 'pod', 'service.name', 'service.namespace'",label:"Tags",labelWidth:26},React.createElement(TagMappingInput,{values:Be??[],onChange:it=>Ke({tags:it})}))),React.createElement(i,{disabled:We,type:"trace",id:"filterByTraceID",value:!!ye.filterByTraceID,onChange:it=>Ke({filterByTraceID:it})}),React.createElement(i,{disabled:We,type:"span",id:"filterBySpanID",value:!!ye.filterBySpanID,onChange:it=>Ke({filterBySpanID:it})}),React.createElement(InlineFieldRow,null,React.createElement(InlineField,{tooltip:"Use a custom query with the possibility to interpolate variables from the trace or span",label:"Use custom query",labelWidth:26},React.createElement(InlineSwitch,{id:"customQuerySwitch",value:We,onChange:it=>Ke({customQuery:it.currentTarget.checked})}))),We&&React.createElement(InlineField,{label:"Query",labelWidth:26,tooltip:"The query that will run when navigating from a trace to logs data source. Interpolate tags using the `$__tags` keyword",grow:!0},React.createElement(Input,{label:"Query",type:"text",allowFullScreen:!0,value:Se,onChange:it=>Ke({query:it.currentTarget.value})})))}function i(Z){return React.createElement(InlineFieldRow,null,React.createElement(InlineField,{disabled:Z.disabled,label:`Filter by ${Z.type} ID`,labelWidth:26,grow:!0,tooltip:`Filters logs by ${Z.type} ID, where the ${Z.type} ID should be part of the log line`},React.createElement(InlineSwitch,{id:Z.id,value:Z.value,onChange:oe=>Z.onChange(oe.currentTarget.checked)})))}const u=Z=>`Span ${Z} time shift`,d=(Z,oe)=>`Shifts the ${Z} time of the span. Default: ${oe} (Time units can be used here, for example: 5s, -1m, 3h)`,p="Invalid time shift. See tooltip for examples.",c=({options:Z,onOptionsChange:oe})=>{let Ee=Z.type;return Ee+=Z.type==="tempo"?"/configure-tempo-data-source/#trace-to-logs":"/#trace-to-logs",React.createElement(ConfigSection,{title:"Trace to logs",description:React.createElement(ConfigDescriptionLink,{description:"Navigate from a trace span to the selected data source's logs.",suffix:Ee,feature:"trace to logs"}),isCollapsible:!0,isInitiallyOpen:!0},React.createElement(l,{options:Z,onOptionsChange:oe}))};var y=e(72574),f=e(40845),P=e(31193),a=e(32901),E=e(31678),g=e(62256),h=e(56271),D=e(41811);const C=(Z,oe,Ee)=>{let ye;return Ee?ye=oe?.childSpanIds.find(Se=>Z.has(Se)&&Z.get(Se).startTime+Z.get(Se).duration<Ee):ye=oe.childSpanIds[0],ye?Z.get(ye):void 0},S=Z=>{const oe=[],Ee=[];Z.forEach(Be=>{if(Be.references[0]?.refType==="FOLLOWS_FROM"){oe.push(Be.spanID);const We=Z.get(Be.references[0].spanID);We.childSpanIds=We.childSpanIds.filter(Ke=>Ke!==Be.spanID),Z.set(We.spanID,{...We})}});const ye=Be=>{Be.forEach(We=>{const Ke=Z.get(We);Ke.hasChildren&&(Ee.push(...Ke.childSpanIds),ye(Ke.childSpanIds))})};return ye(oe),[...oe,...Ee].forEach(Be=>Z.delete(Be)),Z},x=Z=>{let oe=[...Z.keys()];return oe.forEach(Ee=>{const ye=Z.get(Ee);if(!(ye&&ye.references.length&&ye.depth))return;const Se=Z.get(ye.references[0].spanID);if(!Se){Z.delete(ye.spanID);return}const Be=ye.startTime+ye.duration,We=Se.startTime+Se.duration;if(ye.startTime>=Se.startTime){if(ye.startTime>=We){Z.delete(ye.spanID),Se.childSpanIds=Se.childSpanIds.filter(Ke=>Ke!==ye.spanID);return}if(Be>We){Z.set(ye.spanID,{...ye,duration:We-ye.startTime});return}return}Be<=Se.startTime?(Z.delete(ye.spanID),Se.childSpanIds=Se.childSpanIds.filter(Ke=>Ke!==ye.spanID)):Be<=We?Z.set(ye.spanID,{...ye,startTime:Se.startTime,duration:Be-Se.startTime}):Z.set(ye.spanID,{...ye,startTime:Se.startTime,duration:We-Se.startTime})}),oe=[...Z.keys()],oe.forEach(Ee=>{const ye=Z.get(Ee);if(ye.references.length){const Se=Z.get(ye.references[0].spanID);ye.references[0].span=Se,Z.set(Ee,{...ye})}}),Z},b=(Z,oe,Ee,ye)=>{const Se=Z.get(oe);if(!Se)return Ee;const Be=C(Z,Se,ye);let We;if(Be)We={spanId:Se.spanID,section_start:Be.startTime+Be.duration,section_end:ye||Se.startTime+Se.duration},We.section_start!==We.section_end&&Ee.push(We),b(Z,Be.spanID,Ee);else if(We={spanId:Se.spanID,section_start:Se.startTime,section_end:ye||Se.startTime+Se.duration},We.section_start!==We.section_end&&Ee.push(We),Se.references.length){const Ke=Se.references.filter(it=>it.refType==="CHILD_OF")[0].spanID;b(Z,Ke,Ee,Se.startTime)}return Ee};function M(Z){let oe=[];const Ee=Z?.spans[0].spanID;if(Ee){const ye=Z.spans.reduce((Se,Be)=>(Se.set(Be.spanID,Be),Se),new Map);try{const Se=S(ye),Be=x(Se);oe=b(Be,Ee,oe)}catch(Se){console.log("error while computing critical path for a trace",Se)}}return oe}const R=(0,D.A)(M);var B=e(3911),U=e(71656),W=e(30700);const N=.8,w=2,L=200,V=10,K=60,k=6;function j(Z,oe,Ee,ye,Se){const Be=new Map,We=oe.length<K?K:Math.min(oe.length,L),Ke=window.innerWidth*2;Z.width=Ke,Z.height=We;const it=Math.min(k,Math.max(w,We/oe.length)),rt=We/oe.length,ft=Z.getContext("2d",{alpha:!1});if(ft){ft.fillStyle=Se,ft.fillRect(0,0,Ke,We);for(let pt=0;pt<oe.length;pt++){const{valueWidth:Ge,valueOffset:qe,serviceName:bt}=oe[pt],Ft=qe/Ee*Ke;let Xt=Ge/Ee*Ke;Xt<V&&(Xt=V);let Lt=Be.get(bt);Lt||(Lt=`rgba(${ye(bt).concat(N).join()})`,Be.set(bt,Lt)),ft.fillStyle=Lt,ft.fillRect(Ft,pt*rt,Xt,it)}}}const H=(0,B.N)(Z=>({CanvasSpanGraph:(0,t.css)`
      label: CanvasSpanGraph;
      background: ${(0,U.R)(Z,"#fafafa")};
      height: 60px;
      position: absolute;
      width: 100%;
    `}));class J extends n.PureComponent{constructor(oe){super(oe),this.getColor=Ee=>(0,W.rY)(Ee,this.props.theme),this._setCanvasRef=Ee=>{this._canvasElm=Ee},this._canvasElm=void 0}componentDidMount(){this._draw()}componentDidUpdate(){this._draw()}_draw(){if(this._canvasElm){const{valueWidth:oe,items:Ee}=this.props;j(this._canvasElm,Ee,oe,this.getColor,(0,U.R)(this.props.theme,"#fff"))}}render(){return n.createElement("canvas",{className:H(this.props.theme).CanvasSpanGraph,ref:this._setCanvasRef,"data-testid":"CanvasSpanGraph"})}}const X=(0,f.cV)(J);var se=e(6389);const ae=()=>({TickLabels:(0,t.css)`
      label: TickLabels;
      height: 1rem;
      position: relative;
    `,TickLabelsLabel:(0,t.css)`
      label: TickLabelsLabel;
      color: #717171;
      font-size: 0.7rem;
      position: absolute;
      user-select: none;
    `});function ne(Z){const{numTicks:oe,duration:Ee}=Z,ye=(0,f.of)(ae),Se=[];for(let Be=0;Be<oe+1;Be++){const We=Be/oe,Ke=We===1?{right:"0%"}:{left:`${We*100}%`};Se.push(n.createElement("div",{key:We,className:ye.TickLabelsLabel,style:Ke,"data-testid":"tick"},(0,se.a3)(Ee*We)))}return n.createElement("div",{className:ye.TickLabels,"data-testid":"TickLabels"},Se)}var q=e(46942),ee=e.n(q),z=e(55852),te=e(92151);const ie=()=>({GraphTick:(0,t.css)`
      label: GraphTick;
      stroke: #aaa;
      stroke-width: 1px;
    `});function ce(Z){const{numTicks:oe}=Z,Ee=(0,f.of)(ie),ye=[];for(let Se=1;Se<oe;Se++){const Be=`${Se/oe*100}%`;ye.push(n.createElement("line",{className:Ee.GraphTick,x1:Be,y1:"0%",x2:Be,y2:"100%",key:Se/oe}))}return n.createElement("g",{"data-testid":"ticks","aria-hidden":"true"},ye)}const ue=()=>({ScrubberHandleExpansion:ee()((0,t.css)`
        label: ScrubberHandleExpansion;
        cursor: col-resize;
        fill-opacity: 0;
        fill: #44f;
      `,"scrubber-handle-expansion"),ScrubberHandle:ee()((0,t.css)`
        label: ScrubberHandle;
        cursor: col-resize;
        fill: #555;
      `,"scrubber-handle"),ScrubberLine:ee()((0,t.css)`
        label: ScrubberLine;
        pointer-events: none;
        stroke: #555;
      `,"scrubber-line"),ScrubberDragging:(0,t.css)`
      label: ScrubberDragging;
      & .scrubber-handle-expansion {
        fill-opacity: 1;
      }
      & .scrubber-handle {
        fill: #44f;
      }
      & > .scrubber-line {
        stroke: #44f;
      }
    `,ScrubberHandles:(0,t.css)`
      label: ScrubberHandles;
      &:hover > .scrubber-handle-expansion {
        fill-opacity: 1;
      }
      &:hover > .scrubber-handle {
        fill: #44f;
      }
      &:hover + .scrubber.line {
        stroke: #44f;
      }
    `});function fe({isDragging:Z,onMouseDown:oe,onMouseEnter:Ee,onMouseLeave:ye,position:Se}){const Be=`${Se*100}%`,We=(0,f.of)(ue),Ke=ee()({[We.ScrubberDragging]:Z});return n.createElement("g",{className:Ke,"data-testid":"scrubber-component"},n.createElement("g",{"data-testid":"scrubber-component-g",className:We.ScrubberHandles,onMouseDown:oe,onMouseEnter:Ee,onMouseLeave:ye},n.createElement("rect",{"data-testid":"scrubber-component-rect-1",x:Be,className:We.ScrubberHandleExpansion,style:{transform:"translate(-4.5px)"},width:"9",height:"20"}),n.createElement("rect",{"data-testid":"scrubber-component-rect-2",x:Be,className:We.ScrubberHandle,style:{transform:"translate(-1.5px)"},width:"3",height:"20"})),n.createElement("line",{className:We.ScrubberLine,y2:"100%",x1:Be,x2:Be,"data-testid":"scrubber-component-line"}))}const Te=(0,B.N)(Z=>{const oe="JaegerUiComponents__ViewingLayerResetZoomHoverClassName",Ee=(0,t.css)`
    label: ViewingLayerResetZoom;
    display: none;
    position: absolute;
    right: 1%;
    top: 10%;
    z-index: 1;
  `;return{ViewingLayer:(0,t.css)`
      label: ViewingLayer;
      cursor: vertical-text;
      position: relative;
      z-index: 1;
      &:hover > .${oe} {
        display: unset;
      }
    `,ViewingLayerGraph:(0,t.css)`
      label: ViewingLayerGraph;
      border: 1px solid ${(0,U.R)(Z,"#999")};
      /* need !important here to overcome something from semantic UI */
      overflow: visible !important;
      position: relative;
      transform-origin: 0 0;
      width: 100%;
    `,ViewingLayerInactive:(0,t.css)`
      label: ViewingLayerInactive;
      fill: ${(0,U.R)(Z,"rgba(214, 214, 214, 0.5)")};
    `,ViewingLayerCursorGuide:(0,t.css)`
      label: ViewingLayerCursorGuide;
      stroke: ${(0,U.R)(Z,"#f44")};
      stroke-width: 1;
    `,ViewingLayerDraggedShift:(0,t.css)`
      label: ViewingLayerDraggedShift;
      fill-opacity: 0.2;
    `,ViewingLayerDrag:(0,t.css)`
      label: ViewingLayerDrag;
      fill: ${(0,U.R)(Z,"#44f")};
    `,ViewingLayerFullOverlay:(0,t.css)`
      label: ViewingLayerFullOverlay;
      bottom: 0;
      cursor: col-resize;
      left: 0;
      position: fixed;
      right: 0;
      top: 0;
      user-select: none;
    `,ViewingLayerResetZoom:Ee,ViewingLayerResetZoomHoverClassName:oe}}),he={SHIFT_END:"SHIFT_END",SHIFT_START:"SHIFT_START",REFRAME:"REFRAME"};function de(Z,oe){const[Ee,ye]=Z<oe?[Z,oe]:[oe,Z];return{x:`${Ee*100}%`,width:`${(ye-Ee)*100}%`,leadingX:`${oe*100}%`}}class le extends n.PureComponent{constructor(oe){super(oe),this._setRoot=Ee=>{this._root=Ee},this._getDraggingBounds=Ee=>{if(!this._root)throw new Error("invalid state");const{left:ye,width:Se}=this._root.getBoundingClientRect(),[Be,We]=this.props.viewRange.time.current;let Ke=1,it=0;return Ee===he.SHIFT_START?Ke=We:Ee===he.SHIFT_END&&(it=Be),{clientXLeft:ye,maxValue:Ke,minValue:it,width:Se}},this._handleReframeMouseMove=({value:Ee})=>{this.props.updateNextViewRangeTime({cursor:Ee})},this._handleReframeMouseLeave=()=>{this._draggerReframe.resetBounds(),this.props.updateNextViewRangeTime({cursor:null})},this._handleReframeDragUpdate=({value:Ee})=>{const ye=Ee,{time:Se}=this.props.viewRange,We={reframe:{anchor:Se.reframe?Se.reframe.anchor:ye,shift:ye}};this.props.updateNextViewRangeTime(We)},this._handleReframeDragEnd=({manager:Ee,value:ye})=>{const{time:Se}=this.props.viewRange,Be=Se.reframe?Se.reframe.anchor:ye,[We,Ke]=ye<Be?[ye,Be]:[Be,ye];Ee.resetBounds(),this.props.updateViewRangeTime(We,Ke,"minimap")},this._handleScrubberEnterLeave=({type:Ee})=>{const ye=Ee===te.EUpdateTypes.MouseEnter;this.setState({preventCursorLine:ye})},this._handleScrubberDragUpdate=({event:Ee,tag:ye,type:Se,value:Be})=>{Se===te.EUpdateTypes.DragStart&&Ee.stopPropagation(),ye===he.SHIFT_START?this.props.updateNextViewRangeTime({shiftStart:Be}):ye===he.SHIFT_END&&this.props.updateNextViewRangeTime({shiftEnd:Be})},this._handleScrubberDragEnd=({manager:Ee,tag:ye,value:Se})=>{const[Be,We]=this.props.viewRange.time.current;let Ke;if(ye===he.SHIFT_START)Ke=[Se,We];else if(ye===he.SHIFT_END)Ke=[Be,Se];else throw new Error("bad state");Ee.resetBounds(),this.setState({preventCursorLine:!1}),this.props.updateViewRangeTime(Ke[0],Ke[1],"minimap")},this._resetTimeZoomClickHandler=()=>{this.props.updateViewRangeTime(0,1)},this._draggerReframe=new te.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleReframeDragEnd,onDragMove:this._handleReframeDragUpdate,onDragStart:this._handleReframeDragUpdate,onMouseMove:this._handleReframeMouseMove,onMouseLeave:this._handleReframeMouseLeave,tag:he.REFRAME}),this._draggerStart=new te.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleScrubberDragEnd,onDragMove:this._handleScrubberDragUpdate,onDragStart:this._handleScrubberDragUpdate,onMouseEnter:this._handleScrubberEnterLeave,onMouseLeave:this._handleScrubberEnterLeave,tag:he.SHIFT_START}),this._draggerEnd=new te.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleScrubberDragEnd,onDragMove:this._handleScrubberDragUpdate,onDragStart:this._handleScrubberDragUpdate,onMouseEnter:this._handleScrubberEnterLeave,onMouseLeave:this._handleScrubberEnterLeave,tag:he.SHIFT_END}),this._root=void 0,this.state={preventCursorLine:!1}}componentWillUnmount(){this._draggerReframe.dispose(),this._draggerEnd.dispose(),this._draggerStart.dispose()}_getMarkers(oe,Ee){const ye=Te(this.props.theme),Se=de(oe,Ee);return[n.createElement("rect",{key:"fill",className:ee()(ye.ViewingLayerDraggedShift,ye.ViewingLayerDrag),x:Se.x,y:"0",width:Se.width,height:this.props.height-2}),n.createElement("rect",{key:"edge",className:ee()(ye.ViewingLayerDrag),x:Se.leadingX,y:"0",width:"1",height:this.props.height-2})]}render(){const{height:oe,viewRange:Ee,numTicks:ye,theme:Se}=this.props,{preventCursorLine:Be}=this.state,{current:We,cursor:Ke,shiftStart:it,shiftEnd:rt,reframe:ft}=Ee.time,pt=it!=null||rt!=null||ft!=null,[Ge,qe]=We;let bt=0;Ge&&(bt=Ge*100);let Ft=100;qe&&(Ft=100-qe*100);let Xt;!pt&&Ke!=null&&!Be&&(Xt=`${Ke*100}%`);const Lt=Te(Se);return n.createElement("div",{"aria-hidden":!0,className:Lt.ViewingLayer,style:{height:oe}},(Ge!==0||qe!==1)&&n.createElement(z.$n,{onClick:this._resetTimeZoomClickHandler,className:ee()(Lt.ViewingLayerResetZoom,Lt.ViewingLayerResetZoomHoverClassName),type:"button",variant:"secondary"},"Reset Selection"),n.createElement("svg",{height:oe,className:Lt.ViewingLayerGraph,ref:this._setRoot,onMouseDown:this._draggerReframe.handleMouseDown,onMouseLeave:this._draggerReframe.handleMouseLeave,onMouseMove:this._draggerReframe.handleMouseMove},bt>0&&n.createElement("rect",{x:0,y:0,height:"100%",width:`${bt}%`,className:Lt.ViewingLayerInactive,"data-testid":"left-ViewingLayerInactive"}),Ft>0&&n.createElement("rect",{x:`${100-Ft}%`,y:0,height:"100%",width:`${Ft}%`,className:Lt.ViewingLayerInactive,"data-testid":"right-ViewingLayerInactive"}),n.createElement(ce,{numTicks:ye}),Xt&&n.createElement("line",{className:Lt.ViewingLayerCursorGuide,x1:Xt,y1:"0",x2:Xt,y2:oe-2,strokeWidth:"1","data-testid":"ViewingLayerCursorGuide"}),it!=null&&this._getMarkers(Ge,it),rt!=null&&this._getMarkers(qe,rt),n.createElement(fe,{isDragging:it!=null,onMouseDown:this._draggerStart.handleMouseDown,onMouseEnter:this._draggerStart.handleMouseEnter,onMouseLeave:this._draggerStart.handleMouseLeave,position:Ge||0}),n.createElement(fe,{isDragging:rt!=null,position:qe||1,onMouseDown:this._draggerEnd.handleMouseDown,onMouseEnter:this._draggerEnd.handleMouseEnter,onMouseLeave:this._draggerEnd.handleMouseLeave}),ft!=null&&this._getMarkers(ft.anchor,ft.shift)),pt&&n.createElement("div",{className:Lt.ViewingLayerFullOverlay}))}}const pe=(0,f.cV)(le),ve=()=>({container:(0,t.css)({padding:"0 0.5rem 0.5rem 0.5rem"}),canvasContainer:(0,t.css)({position:"relative"})}),be=60,Oe=4;function Me(Z){return{valueOffset:Z.relativeStartTime,valueWidth:Z.duration,serviceName:Z.process.serviceName}}function Ue(Z){return Z.spans.map(Me)}const we=(0,D.A)(Ue);class Re extends n.PureComponent{static{this.defaultProps={height:be}}render(){const{height:oe,trace:Ee,viewRange:ye,updateNextViewRangeTime:Se,updateViewRangeTime:Be}=this.props,We=ve();if(!Ee)return n.createElement("div",null);const Ke=we(Ee);return n.createElement("div",{className:We.container},n.createElement(ne,{numTicks:Oe,duration:Ee.duration}),n.createElement("div",{className:We.canvasContainer},n.createElement(X,{valueWidth:Ee.duration,items:Ke}),n.createElement(pe,{viewRange:ye,numTicks:Oe,height:oe||be,updateViewRangeTime:Be,updateNextViewRangeTime:Se})))}}var Fe=e(28114);function xe(){const[Z,oe]=(0,n.useState)(new Set),Ee=(0,n.useCallback)(function(it){if(Z.size===0)return;let rt=-1,ft=!0;const pt=it.reduce((Ge,qe)=>(qe.depth<=rt&&(ft=!0),ft&&Ge.has(qe.spanID)&&(Ge.delete(qe.spanID),ft=!1,rt=qe.depth),Ge),new Set(Z));oe(pt)},[Z]),ye=(0,n.useCallback)(function(it){if(Ve(it,Z))return;let rt;const ft=it.reduce((pt,Ge)=>(rt&&Ge.depth<=rt.depth?(pt.add(rt.spanID),Ge.hasChildren&&(rt=Ge)):Ge.hasChildren&&!pt.has(Ge.spanID)&&(rt=Ge),pt),new Set(Z));rt&&ft.add(rt.spanID),oe(ft)},[Z]),Se=(0,n.useCallback)(function(){oe(new Set)},[]),Be=(0,n.useCallback)(function(it){if(Ve(it,Z))return;const rt=it.reduce((ft,pt)=>(pt.hasChildren&&ft.add(pt.spanID),ft),new Set);oe(rt)},[Z]),We=(0,n.useCallback)(function(it){const rt=new Set(Z);Z.has(it)?rt.delete(it):rt.add(it),oe(rt)},[Z]);return{childrenHiddenIDs:Z,expandOne:Ee,collapseOne:ye,expandAll:Se,collapseAll:Be,childrenToggle:We}}function Ve(Z,oe){return Z.filter(ye=>ye.hasChildren).length===oe.size}function $e(Z){const[oe,Ee]=(0,n.useState)(new Map);(0,n.useEffect)(()=>{Ee(new Map)},[Z,Ee]);const ye=(0,n.useCallback)(function(Ke){const it=new Map(oe);it.has(Ke)?it.delete(Ke):it.set(Ke,new h.DetailState),Ee(it)},[oe]),Se=(0,n.useCallback)(function(Ke,it){const rt=oe.get(Ke);if(!rt)return;const ft=rt.toggleLogItem(it),pt=new Map(oe);return pt.set(Ke,ft),Ee(pt)},[oe]),Be=(0,n.useCallback)(function(Ke,it){const rt=oe.get(Ke);if(!rt)return;const ft=rt.toggleReferenceItem(it),pt=new Map(oe);return pt.set(Ke,ft),Ee(pt)},[oe]);return{detailStates:oe,toggleDetail:ye,detailLogItemToggle:Se,detailLogsToggle:(0,n.useCallback)(We=>Xe("logs",oe,Ee)(We),[oe]),detailWarningsToggle:(0,n.useCallback)(We=>Xe("warnings",oe,Ee)(We),[oe]),detailStackTracesToggle:(0,n.useCallback)(We=>Xe("stackTraces",oe,Ee)(We),[oe]),detailReferenceItemToggle:Be,detailReferencesToggle:(0,n.useCallback)(We=>Xe("references",oe,Ee)(We),[oe]),detailProcessToggle:(0,n.useCallback)(We=>Xe("process",oe,Ee)(We),[oe]),detailTagsToggle:(0,n.useCallback)(We=>Xe("tags",oe,Ee)(We),[oe])}}function Xe(Z,oe,Ee){return ye=>{const Se=oe.get(ye);if(!Se)return;let Be;Z==="tags"?Be=Se.toggleTags():Z==="process"?Be=Se.toggleProcess():Z==="warnings"?Be=Se.toggleWarnings():Z==="references"?Be=Se.toggleReferences():Z==="stackTraces"?Be=Se.toggleStackTraces():Be=Se.toggleLogs();const We=new Map(oe);We.set(ye,Be),Ee(We)}}function gt(){const[Z,oe]=(0,n.useState)(new Set),Ee=(0,n.useCallback)(function(Be){oe(We=>{const Ke=new Set(We);return Ke.add(Be),Ke})},[]),ye=(0,n.useCallback)(function(Be){oe(We=>{const Ke=new Set(We);return Ke.delete(Be),Ke})},[]);return{hoverIndentGuideIds:Z,addHoverIndentGuideId:Ee,removeHoverIndentGuideId:ye}}var Dt=e(15583);function nt(){const[Z,oe]=(0,n.useState)({time:{current:[0,1]}}),Ee=(0,n.useCallback)(function(Be){oe(We=>{const Ke={...We.time,...Be};return{...We,time:Ke}})},[]),ye=(0,n.useCallback)(function(Be,We){const it={current:[Be,We]};oe(rt=>({...rt,time:it}))},[]);return{viewRange:Z,updateViewRangeTime:ye,updateNextViewRangeTime:Ee}}const at=Z=>({noDataMsg:(0,t.css)`
    height: 100%;
    width: 100%;
    display: grid;
    place-items: center;
    font-size: ${Z.typography.h4.fontSize};
    color: ${Z.colors.text.secondary};
  `});function Ae(Z){const{traceProp:oe,datasource:Ee,topOfViewRef:ye,exploreId:Se,createSpanLink:Be,focusedSpanId:We,createFocusSpanLink:Ke}=Z,{detailStates:it,toggleDetail:rt,detailLogItemToggle:ft,detailLogsToggle:pt,detailProcessToggle:Ge,detailReferencesToggle:qe,detailReferenceItemToggle:bt,detailTagsToggle:Ft,detailWarningsToggle:Xt,detailStackTracesToggle:Lt}=$e(Z.dataFrames[0]),{removeHoverIndentGuideId:Qt,addHoverIndentGuideId:an,hoverIndentGuideIds:gn}=gt(),{viewRange:ut,updateViewRangeTime:Nt,updateNextViewRangeTime:ht}=nt(),{expandOne:Rt,collapseOne:_t,childrenToggle:on,collapseAll:ln,childrenHiddenIDs:bn,expandAll:In}=xe(),{search:Mn,setSearch:vt,spanFilterMatches:nn}=(0,Dt.SQ)(oe?.spans),[cn,mt]=(0,n.useState)(""),[lt,Tt]=(0,s.A)(!1),[Vt,zt]=(0,n.useState)(!1),[rn,mn]=(0,n.useState)(!1),[dt,wt]=(0,n.useState)(100),[en,En]=(0,n.useState)({}),[yt,At]=(0,n.useState)({}),Kt=(0,f.of)(at),[Jt,Mt]=(0,n.useState)(.4),[Je,Nn]=re({refId:Z.dataFrames[0]?.refId,exploreId:Z.exploreId,datasource:Ee,splitOpenFn:Z.splitOpenFn}),xn=We??Je,Fn=Ke??Nn,wn=(0,n.useMemo)(()=>({childrenHiddenIDs:bn,detailStates:it,hoverIndentGuideIds:gn,spanNameColumnWidth:Jt,traceID:Z.traceProp?.traceID}),[bn,it,gn,Jt,Z.traceProp?.traceID]),Wn=(0,P.tR)().getInstanceSettings(Ee?.name),da=m(Wn?.jsonData),_n=Wn?.jsonData?.tracesToMetrics,za=Wn?.jsonData?.tracesToProfiles,_a=Wn?.jsonData,Xa=(0,n.useMemo)(()=>Be??(0,Fe.lU)({splitOpenFn:Z.splitOpenFn,traceToLogsOptions:da,traceToMetricsOptions:_n,traceToProfilesOptions:za,dataFrame:Z.dataFrames[0],createFocusSpanLink:Fn,trace:oe}),[Z.splitOpenFn,da,_n,za,Z.dataFrames,Fn,oe,Be]),Va=(0,E.useSelector)(ls=>(0,a.O)(ls.user)),Cs=Ee?Ee?.type:"unknown",ns=Z.scrollElement?Z.scrollElement:document.getElementsByClassName(Z.scrollElementClass??"")[0],Is=R(oe);return n.createElement(n.Fragment,null,Z.dataFrames?.length&&oe?n.createElement(n.Fragment,null,n.createElement(h.TracePageHeader,{trace:oe,data:Z.dataFrames[0],timeZone:Va,search:Mn,setSearch:vt,showSpanFilters:lt,setShowSpanFilters:Tt,showSpanFilterMatchesOnly:Vt,setShowSpanFilterMatchesOnly:zt,showCriticalPathSpansOnly:rn,setShowCriticalPathSpansOnly:mn,setFocusedSpanIdForSearch:mt,spanFilterMatches:nn,datasourceType:Cs,setHeaderHeight:wt,app:Se?r.Jk.Explore:r.Jk.Unknown}),n.createElement(Re,{trace:oe,viewRange:ut,updateNextViewRangeTime:ht,updateViewRangeTime:Nt}),n.createElement(h.TraceTimelineViewer,{findMatchesIDs:nn,trace:oe,traceToProfilesOptions:za,datasourceType:Cs,spanBarOptions:_a?.spanBar,traceTimeline:wn,updateNextViewRangeTime:ht,updateViewRangeTime:Nt,viewRange:ut,timeZone:Va,setSpanNameColumnWidth:Mt,collapseAll:ln,collapseOne:_t,expandAll:In,expandOne:Rt,childrenToggle:on,detailLogItemToggle:ft,detailLogsToggle:pt,detailWarningsToggle:Xt,detailStackTracesToggle:Lt,detailReferencesToggle:qe,detailReferenceItemToggle:bt,detailProcessToggle:Ge,detailTagsToggle:Ft,detailToggle:rt,addHoverIndentGuideId:an,removeHoverIndentGuideId:Qt,linksGetter:()=>[],createSpanLink:Xa,scrollElement:ns,focusedSpanId:xn,focusedSpanIdForSearch:cn,showSpanFilterMatchesOnly:Vt,showCriticalPathSpansOnly:rn,createFocusSpanLink:Fn,topOfViewRef:ye,headerHeight:dt,criticalPath:Is,traceFlameGraphs:en,setTraceFlameGraphs:En,redrawListView:yt,setRedrawListView:At})):n.createElement("div",{className:Kt.noDataMsg},"No data"))}function re(Z){const oe=(0,E.useSelector)(Ke=>Ke.explore.panes[Z.exploreId]?.panelsState.trace),Ee=oe?.spanId,ye=(0,E.useDispatch)(),Se=Ke=>ye((0,g.EA)(Z.exploreId,"trace",{...oe,spanId:Ke})),Be=(0,E.useSelector)(Ke=>Ke.explore.panes[Z.exploreId]?.queries.find(it=>it.refId===Z.refId));return[Ee,(Ke,it)=>{const rt={title:"Deep link to this span",url:"",internal:{datasourceUid:Z.datasource?.uid,datasourceName:Z.datasource?.name,query:{...Be,query:Ke},panelsState:{trace:{spanId:it}}}},ft=Be?.queryType==="traceql"&&Be.query===Ke;return(0,o.u)({link:rt,internalLink:rt.internal,scopedVars:{},field:{},onClickFn:ft?()=>Se(Ee===it?void 0:it):Z.splitOpenFn?()=>Z.splitOpenFn({datasourceUid:Z.datasource?.uid,queries:[{...Be,query:Ke}],panelsState:{trace:{spanId:it}}}):void 0,replaceVariables:(0,y.w)().replace.bind((0,y.w)())})}]}},71656:(G,I,e)=>{"use strict";e.d(I,{R:()=>n});var t=e(84140);function n(s,r,o){if(s.isLight)return r;{if(o){const i=(0,t.A)(r);return t.A.mostReadable(o,[i.clone().lighten(25),i.clone().lighten(10),i,i.clone().darken(10),i.clone().darken(25)],{includeFallbackColors:!1}).toHex8String()}const m=(0,t.A)(r).toHsl();m.l=1-m.l;const l=(0,t.A)(m);return l.isLight()?l.darken(5).toHex8String():l.lighten(5).toHex8String()}}},56271:(G,I,e)=>{"use strict";e.d(I,{DetailState:()=>mr,TracePageHeader:()=>eo,TraceTimelineViewer:()=>uo,filterSpans:()=>Mi,transformTraceData:()=>Ii});var t=e(32196),n=e(96540),s=e(14110),r=e(32264),o=e(3911),m=e(40845),l=e(71656),i=e(75888),u=e.n(i);const p={scrollPageDown:{binding:"s",label:"Scroll down"},scrollPageUp:{binding:"w",label:"Scroll up"},scrollToNextVisibleSpan:{binding:"f",label:"Scroll to the next visible span"},scrollToPrevVisibleSpan:{binding:"b",label:"Scroll to the previous visible span"},panLeft:{binding:["a","left"],label:"Pan left"},panLeftFast:{binding:["shift+a","shift+left"],label:"Pan left \u2014 Large"},panRight:{binding:["d","right"],label:"Pan right"},panRightFast:{binding:["shift+d","shift+right"],label:"Pan right \u2014 Large"},zoomIn:{binding:"up",label:"Zoom in"},zoomInFast:{binding:"shift+up",label:"Zoom in \u2014 Large"},zoomOut:{binding:"down",label:"Zoom out"},zoomOutFast:{binding:"shift+down",label:"Zoom out \u2014 Large"},collapseAll:{binding:"]",label:"Collapse All"},expandAll:{binding:"[",label:"Expand All"},collapseOne:{binding:"p",label:"Collapse One Level"},expandOne:{binding:"o",label:"Expand One Level"},searchSpans:{binding:"ctrl+b",label:"Search Spans"},clearSearch:{binding:"escape",label:"Clear Search"}};let c;function y(){if(c)return c;const ke=new(u())(document.body);return c=ke,ke}function f(ke){const Ye=y();Object.keys(ke).forEach(Ze=>{const ct=ke[Ze];ct&&Ye.bind(p[Ze].binding,ct)})}function P(){y().reset()}var a=e(46942),E=e.n(a),g=e(6389);function h(ke){const{min:Ye,max:Ze,viewStart:ct,viewEnd:It}=ke,Ht=Ze-Ye,tn=Ye+ct*Ht,yn=Ze-(1-It)*Ht-tn;return(Rn,Yn)=>({start:(Rn-tn)/yn,end:(Yn-tn)/yn})}function D(ke,Ye,Ze){return!Array.isArray(Ze.tags)||!Ze.tags.length?!1:Ze.tags.some(ct=>ct.key===ke&&ct.value===Ye)}const v=ke=>ke.kind==="client",C=D.bind(null,"span.kind","client"),T=ke=>v(ke)||C(ke),S=ke=>ke.kind==="server",O=D.bind(null,"span.kind","server"),x=ke=>S(ke)||O(ke),b=ke=>ke.statusCode===2,M=D.bind(null,"error",!0),A=D.bind(null,"error","true"),R=ke=>b(ke)||M(ke)||A(ke);function B(ke,Ye){const{depth:Ze}=ke[Ye];let ct=Ye+1;for(;ct<ke.length&&ke[ct].depth>Ze;ct++)if(R(ke[ct]))return!0;return!1}function U(ke){if(ke.length<=1||!T(ke[0]))return!1;const Ze=ke[0].depth+1;let ct=1;for(;ct<ke.length&&ke[ct].depth===Ze;){if(x(ke[ct]))return ke[ct];ct++}return null}const W=ke=>ke.kind?ke.kind==="client":ke.tags.some(({key:Ye,value:Ze})=>Ye==="span.kind"&&Ze==="client"),N=ke=>({Ticks:(0,t.css)`
      label: Ticks;
      pointer-events: none;
    `,TicksTick:(0,t.css)`
      label: TicksTick;
      position: absolute;
      height: 100%;
      width: 1px;
      background: ${(0,l.R)(ke,"#d8d8d8")};
      &:last-child {
        width: 0;
      }
    `,TicksTickLabel:(0,t.css)`
      label: TicksTickLabel;
      left: 0.25rem;
      position: absolute;
    `,TicksTickLabelEndAnchor:(0,t.css)`
      label: TicksTickLabelEndAnchor;
      left: initial;
      right: 0.25rem;
    `});function w({endTime:ke=null,numTicks:Ye,showLabels:Ze=null,startTime:ct=null}){let It;if(Ze){It=[];const dn=(ke||0)-(ct||0);for(let yn=0;yn<Ye;yn++){const Rn=(ct||0)+yn/(Ye-1)*dn;It.push((0,g.a3)(Rn))}}const Ht=(0,m.of)(N),tn=[];for(let dn=0;dn<Ye;dn++){const yn=dn/(Ye-1);tn.push(n.createElement("div",{"data-testid":"TicksID",key:yn,className:Ht.TicksTick,style:{left:`${yn*100}%`}},It&&n.createElement("span",{className:E()(Ht.TicksTickLabel,{[Ht.TicksTickLabelEndAnchor]:yn>=1})},It[dn])))}return n.createElement("div",{className:Ht.Ticks},tn)}const L=()=>({row:(0,t.css)({display:"flex",flex:"0 1 auto",flexDirection:"row"}),rowCell:(0,t.css)({position:"relative"})});function V({children:ke,className:Ye="",...Ze}){const ct=(0,m.of)(L);return n.createElement("div",{className:E()(ct.row,Ye),...Ze},ke)}function K({children:ke,className:Ye="",width:Ze,style:ct={},...It}){const Ht=`${Ze*100}%`,tn={...ct,flexBasis:Ht,maxWidth:Ht},dn=(0,m.of)(L);return n.createElement("div",{className:E()(dn.rowCell,Ye),style:tn,"data-testid":"TimelineRowCell",...It},ke)}V.Cell=K;var k=e(29158);const j=()=>({TimelineCollapser:(0,t.css)`
      align-items: center;
      display: flex;
      flex: none;
      justify-content: center;
      margin-right: 0.5rem;
    `});function H(ke){const{onExpandAll:Ye,onExpandOne:Ze,onCollapseAll:ct,onCollapseOne:It}=ke,Ht=(0,m.of)(j);return n.createElement("div",{className:Ht.TimelineCollapser,"data-testid":"TimelineCollapser"},n.createElement(k.K,{tooltip:"Expand +1",size:"xl",tooltipPlacement:"top",name:"angle-down",onClick:Ze}),n.createElement(k.K,{tooltip:"Collapse +1",size:"xl",tooltipPlacement:"top",name:"angle-right",onClick:It}),n.createElement(k.K,{tooltip:"Expand All",size:"xl",tooltipPlacement:"top",name:"angle-double-down",onClick:Ye}),n.createElement(k.K,{tooltip:"Collapse All",size:"xl",tooltipPlacement:"top",name:"angle-double-right",onClick:ct}))}var J=e(92151);const X=()=>({TimelineColumnResizer:(0,t.css)`
      left: 0;
      position: absolute;
      right: 0;
      top: 0;
    `,wrapper:(0,t.css)`
      bottom: 0;
      position: absolute;
      top: 0;
    `,dragger:(0,t.css)`
      border-left: 2px solid transparent;
      cursor: col-resize;
      height: 5000px;
      margin-left: -1px;
      position: absolute;
      top: 0;
      width: 1px;
      z-index: 10;
      &:hover {
        border-left: 2px solid rgba(0, 0, 0, 0.3);
      }
      &::before {
        position: absolute;
        top: 0;
        bottom: 0;
        left: -8px;
        right: 0;
        content: ' ';
      }
    `,draggerDragging:(0,t.css)`
      background: rgba(136, 0, 136, 0.05);
      width: unset;
      &::before {
        left: -2000px;
        right: -2000px;
      }
    `,draggerDraggingLeft:(0,t.css)`
      border-left: 2px solid #808;
      border-right: 1px solid #999;
    `,draggerDraggingRight:(0,t.css)`
      border-left: 1px solid #999;
      border-right: 2px solid #808;
    `,gripIcon:(0,t.css)`
      position: absolute;
      top: 0;
      bottom: 0;
      &::before,
      &::after {
        border-right: 1px solid #ccc;
        content: ' ';
        height: 9px;
        position: absolute;
        right: 9px;
        top: 25px;
      }
      &::after {
        right: 5px;
      }
    `,gripIconDragging:(0,t.css)`
      &::before,
      &::after {
        border-right: 1px solid rgba(136, 0, 136, 0.5);
      }
    `});class se extends n.PureComponent{constructor(Ye){super(Ye),this._setRootElm=Ze=>{this._rootElm=Ze},this._getDraggingBounds=()=>{if(!this._rootElm)throw new Error("invalid state");const{left:Ze,width:ct}=this._rootElm.getBoundingClientRect(),{min:It,max:Ht}=this.props;return{clientXLeft:Ze,width:ct,maxValue:Ht,minValue:It}},this._handleDragUpdate=({value:Ze})=>{this.setState({dragPosition:Ze})},this._handleDragEnd=({manager:Ze,value:ct})=>{Ze.resetBounds(),this.setState({dragPosition:null}),this.props.onChange(ct)},this._dragManager=new J.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleDragEnd,onDragMove:this._handleDragUpdate,onDragStart:this._handleDragUpdate}),this._rootElm=void 0,this.state={dragPosition:null}}componentWillUnmount(){this._dragManager.dispose()}render(){let Ye,Ze;const{position:ct,columnResizeHandleHeight:It}=this.props,{dragPosition:Ht}=this.state;Ye=`${ct*100}%`;const tn={left:Ye};let dn=!1,yn=!1;const Rn=X();if(this._dragManager.isDragging()&&this._rootElm&&Ht!=null){dn=Ht<ct,yn=Ht>ct;const qn=`${Math.min(ct,Ht)*100}%`,Jn=`calc(${(1-Math.max(ct,Ht))*100}% - 1px)`;Ze={left:qn,right:Jn}}else Ze=tn;Ze.height=It;const Yn=dn||yn;return n.createElement("div",{className:Rn.TimelineColumnResizer,ref:this._setRootElm,"data-testid":"TimelineColumnResizer"},n.createElement("div",{className:E()(Rn.gripIcon,Yn&&Rn.gripIconDragging),style:tn,"data-testid":"TimelineColumnResizer--gripIcon"}),n.createElement("div",{"aria-hidden":!0,className:E()(Rn.dragger,Yn&&Rn.draggerDragging,yn&&Rn.draggerDraggingRight,dn&&Rn.draggerDraggingLeft),onMouseDown:this._dragManager.handleMouseDown,style:Ze,"data-testid":"TimelineColumnResizer--dragger"}))}}const ae=(0,o.N)(()=>({TimelineViewingLayer:(0,t.css)`
      label: TimelineViewingLayer;
      bottom: 0;
      cursor: vertical-text;
      left: 0;
      position: absolute;
      right: 0;
      top: 0;
    `,TimelineViewingLayerCursorGuide:(0,t.css)`
      label: TimelineViewingLayerCursorGuide;
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      width: 1px;
      background-color: red;
    `,TimelineViewingLayerDragged:(0,t.css)`
      label: TimelineViewingLayerDragged;
      position: absolute;
      top: 0;
      bottom: 0;
    `,TimelineViewingLayerDraggedDraggingLeft:(0,t.css)`
      label: TimelineViewingLayerDraggedDraggingLeft;
      border-left: 1px solid;
    `,TimelineViewingLayerDraggedDraggingRight:(0,t.css)`
      label: TimelineViewingLayerDraggedDraggingRight;
      border-right: 1px solid;
    `,TimelineViewingLayerDraggedShiftDrag:(0,t.css)`
      label: TimelineViewingLayerDraggedShiftDrag;
      background-color: rgba(68, 68, 255, 0.2);
      border-color: #44f;
    `,TimelineViewingLayerDraggedReframeDrag:(0,t.css)`
      label: TimelineViewingLayerDraggedReframeDrag;
      background-color: rgba(255, 68, 68, 0.2);
      border-color: #f44;
    `,TimelineViewingLayerFullOverlay:(0,t.css)`
      label: TimelineViewingLayerFullOverlay;
      bottom: 0;
      cursor: col-resize;
      left: 0;
      position: fixed;
      right: 0;
      top: 0;
      user-select: none;
    `}));function ne(ke){return Reflect.has(ke,"isOutOfView")}function q(ke,Ye,Ze){return ke+Ze*(Ye-ke)}function ee(ke,Ye,Ze){return(Ze-ke)/(Ye-ke)}function z(ke,Ye){let[Ze,ct]=ke<Ye?[ke,Ye]:[Ye,ke];return Ze>=1||ct<=0?{isOutOfView:!0}:(Ze<0&&(Ze=0),ct>1&&(ct=1),{isDraggingLeft:ke>Ye,left:`${Ze*100}%`,width:`${(ct-Ze)*100}%`})}function te(ke,Ye,Ze,ct,It){const Ht=ee(ke,Ye,Ze),tn=ee(ke,Ye,ct),dn=z(Ht,tn);if(ne(dn))return null;const{isDraggingLeft:yn,left:Rn,width:Yn}=dn,qn=ae(),Jn=(0,t.cx)({[qn.TimelineViewingLayerDraggedDraggingRight]:!yn,[qn.TimelineViewingLayerDraggedReframeDrag]:!It,[qn.TimelineViewingLayerDraggedShiftDrag]:It});return n.createElement("div",{className:(0,t.cx)(qn.TimelineViewingLayerDragged,qn.TimelineViewingLayerDraggedDraggingLeft,Jn),style:{left:Rn,width:Yn},"data-testid":"Dragged"})}class ie extends n.PureComponent{constructor(Ye){super(Ye),this._setRoot=Ze=>{this._root=Ze},this._getDraggingBounds=()=>{if(!this._root)throw new Error("invalid state");const{left:Ze,width:ct}=this._root.getBoundingClientRect();return{clientXLeft:Ze,width:ct}},this._handleReframeMouseMove=({value:Ze})=>{const[ct,It]=this.props.viewRangeTime.current,Ht=q(ct,It,Ze);this.props.updateNextViewRangeTime({cursor:Ht})},this._handleReframeMouseLeave=()=>{this.props.updateNextViewRangeTime({cursor:void 0})},this._handleReframeDragUpdate=({value:Ze})=>{const{current:ct,reframe:It}=this.props.viewRangeTime,[Ht,tn]=ct,dn=q(Ht,tn,Ze),Rn={reframe:{anchor:It?It.anchor:dn,shift:dn}};this.props.updateNextViewRangeTime(Rn)},this._handleReframeDragEnd=({manager:Ze,value:ct})=>{const{current:It,reframe:Ht}=this.props.viewRangeTime,[tn,dn]=It,yn=q(tn,dn,ct),Rn=Ht?Ht.anchor:yn,[Yn,qn]=yn<Rn?[yn,Rn]:[Rn,yn];Ze.resetBounds(),this.props.updateViewRangeTime(Yn,qn,"timeline-header")},this._draggerReframe=new J.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleReframeDragEnd,onDragMove:this._handleReframeDragUpdate,onDragStart:this._handleReframeDragUpdate,onMouseLeave:this._handleReframeMouseLeave,onMouseMove:this._handleReframeMouseMove}),this._root=void 0}UNSAFE_componentWillReceiveProps(Ye){const{boundsInvalidator:Ze}=this.props;Ze!==Ye.boundsInvalidator&&this._draggerReframe.resetBounds()}componentWillUnmount(){this._draggerReframe.dispose()}render(){const{viewRangeTime:Ye}=this.props,{current:Ze,cursor:ct,reframe:It,shiftEnd:Ht,shiftStart:tn}=Ye,[dn,yn]=Ze,Rn=It!=null||Ht!=null||tn!=null;let Yn;!Rn&&ct!=null&&ct>=dn&&ct<=yn&&(Yn=`${ee(dn,yn,ct)*100}%`);const qn=ae();return n.createElement("div",{"aria-hidden":!0,className:qn.TimelineViewingLayer,ref:this._setRoot,onMouseDown:this._draggerReframe.handleMouseDown,onMouseLeave:this._draggerReframe.handleMouseLeave,onMouseMove:this._draggerReframe.handleMouseMove,"data-testid":"TimelineViewingLayer"},Yn!=null&&n.createElement("div",{className:qn.TimelineViewingLayerCursorGuide,style:{left:Yn},"data-testid":"TimelineViewingLayer--cursorGuide"}),It!=null&&te(dn,yn,It.anchor,It.shift,!1),Ht!=null&&te(dn,yn,yn,Ht,!0),tn!=null&&te(dn,yn,dn,tn,!0))}}const ce=ke=>({TimelineHeaderRow:(0,t.css)`
      label: TimelineHeaderRow;
      background: ${(0,l.R)(ke,"#ececec")};
      border-bottom: 1px solid ${(0,l.R)(ke,"#ccc")};
      height: 38px;
      line-height: 38px;
      width: 100%;
      z-index: 4;
      position: relative;
    `,TimelineHeaderRowTitle:(0,t.css)`
      label: TimelineHeaderRowTitle;
      flex: 1;
      overflow: hidden;
      margin: 0;
      text-overflow: ellipsis;
      white-space: nowrap;
    `,TimelineHeaderWrapper:(0,t.css)`
      label: TimelineHeaderWrapper;
      align-items: center;
      display: flex;
      padding-left: ${ke.spacing(1)};
      padding-right: ${ke.spacing(1)};
    `});function ue(ke){const{duration:Ye,nameColumnWidth:Ze,numTicks:ct,onCollapseAll:It,onCollapseOne:Ht,onColummWidthChange:tn,onExpandAll:dn,onExpandOne:yn,updateViewRangeTime:Rn,updateNextViewRangeTime:Yn,viewRangeTime:qn,columnResizeHandleHeight:Jn}=ke,[ca,Oa]=qn.current,ma=(0,m.of)(ce);return n.createElement(V,{className:ma.TimelineHeaderRow,"data-testid":"TimelineHeaderRow"},n.createElement(V.Cell,{className:ma.TimelineHeaderWrapper,width:Ze},n.createElement("h4",{className:ma.TimelineHeaderRowTitle},"Service & Operation"),n.createElement(H,{onCollapseAll:It,onExpandAll:dn,onCollapseOne:Ht,onExpandOne:yn})),n.createElement(V.Cell,{width:1-Ze},n.createElement(ie,{boundsInvalidator:Ze,updateNextViewRangeTime:Yn,updateViewRangeTime:Rn,viewRangeTime:qn}),n.createElement(w,{numTicks:ct,startTime:ca*Ye,endTime:Oa*Ye,showLabels:!0})),n.createElement(se,{columnResizeHandleHeight:Jn,position:Ze,onChange:tn,min:.2,max:.85}))}var fe=e(2543),Te=e(41811),he=e(27746);const de="peer.service";var le=e(30700);class pe{constructor(Ye){this.ys=[],this.heights=[],this.bufferLen=Ye,this.dataLen=-1,this.lastI=-1}profileData(Ye){Ye!==this.dataLen&&(this.dataLen=Ye,this.ys.length=Ye,this.heights.length=Ye,this.lastI>=Ye&&(this.lastI=Ye-1))}calcHeights(Ye,Ze,ct){ct!=null&&(this.lastI=ct);let It=Ye+this.bufferLen;if(It<=this.lastI)return;It>=this.heights.length&&(It=this.heights.length-1);let Ht=this.lastI;for(this.lastI===-1&&(Ht=0,this.ys[0]=0);Ht<=It;){const tn=this.heights[Ht]=Ze(Ht);this.ys[Ht+1]=this.ys[Ht]+tn,Ht++}this.lastI=It}calcYs(Ye,Ze){for(;(this.ys[this.lastI]==null||Ye>this.ys[this.lastI])&&this.lastI<this.dataLen-1;)this.calcHeights(this.lastI,Ze)}confirmHeight(Ye,Ze){let ct=Ye;if(ct>this.lastI){this.calcHeights(ct,Ze);return}const It=Ze(ct);if(It===this.heights[ct])return;const Ht=It-this.heights[ct];for(this.heights[ct]=It;++ct<=this.lastI;)this.ys[ct]+=Ht;this.ys[this.lastI+1]!=null&&(this.ys[this.lastI+1]+=Ht)}findFloorIndex(Ye,Ze){this.calcYs(Ye,Ze);let ct=0,It=this.lastI;if(this.ys.length<2||Ye<this.ys[1])return 0;if(Ye>this.ys[It])return It;let Ht;for(;ct<It;)if(Ht=ct+.5*(It-ct)|0,Ye>this.ys[Ht]){if(Ye<=this.ys[Ht+1])return Ht;ct=Ht}else if(Ye<this.ys[Ht]){if(Ye>=this.ys[Ht-1])return Ht-1;It=Ht}else return Ht;throw new Error(`unable to find floor index for y=${Ye}`)}getRowPosition(Ye,Ze){return this.confirmHeight(Ye,Ze),{height:this.heights[Ye],y:this.ys[Ye]}}getEstimatedHeight(){const Ye=this.ys[this.lastI]+this.heights[this.lastI];return this.lastI>=this.dataLen-1?Ye|0:Ye/(this.lastI+1)*this.heights.length|0}}const ve=100;class be extends n.Component{constructor(Ye){super(Ye),this.getViewHeight=()=>this._viewHeight,this.getBottomVisibleIndex=()=>{const Ze=this._scrollTop+this._viewHeight;return this._yPositions.findFloorIndex(Ze,this._getHeight)},this.getTopVisibleIndex=()=>this._yPositions.findFloorIndex(this._scrollTop,this._getHeight),this.getRowPosition=Ze=>this._yPositions.getRowPosition(Ze,this._getHeight),this.scrollToIndex=(Ze,ct)=>{const{scrollElement:It}=this.props,Ht=It?.getBoundingClientRect().top||0,dn=(It?.scrollTop||0)+(this._itemHolderElm?.getBoundingClientRect().top||0)-Ht,yn=this.getRowPosition(Ze).y;this.props.scrollElement?.scrollTo({top:yn+dn-ct-80})},this._onScroll=()=>{this._isScrolledOrResized||(this._isScrolledOrResized=!0,window.requestAnimationFrame(this._positionList))},this._positionList=()=>{if(this._isScrolledOrResized=!1,!this._wrapperElm)return;this._calcViewIndexes();const Ze=this.props.viewBufferMin>this._startIndex?0:this._startIndex-this.props.viewBufferMin,ct=this.props.viewBufferMin<this.props.dataLength-this._endIndex?this._endIndex+this.props.viewBufferMin:this.props.dataLength-1;(Ze<this._startIndexDrawn||ct>this._endIndexDrawn)&&this.forceUpdate()},this._initWrapper=Ze=>{this.props.windowScroller&&(this._wrapperElm=Ze,Ze&&(this._viewHeight=Ze.clientHeight))},this._initItemHolder=Ze=>{this._itemHolderElm=Ze,this._scanItemHeights()},this._scanItemHeights=()=>{const Ze=this.props.getIndexFromKey;if(!this._itemHolderElm)return;let ct=null,It=null,Ht=!1;const tn=this._itemHolderElm.childNodes,dn=tn.length;for(let yn=0;yn<dn;yn++){const Rn=tn[yn];if(Rn instanceof HTMLElement){const Yn=Rn.getAttribute("data-item-key");if(!Yn){console.warn("itemKey not found");continue}const Jn=(Rn.firstElementChild||Rn).clientHeight,ca=this._knownHeights.get(Yn);Jn!==ca&&(this._knownHeights.set(Yn,Jn),Ht?It=Yn:(Ht=!0,ct=It=Yn))}}if(ct!=null&&It!=null){const yn=Ze(ct),Rn=It===ct?yn:Ze(It);this._yPositions.calcHeights(Rn,this._getHeight,yn),this.forceUpdate()}},this._getHeight=Ze=>{const ct=this.props.getKeyFromIndex(Ze),It=this._knownHeights.get(ct);return It!=null&&It===It?It:this.props.itemHeightGetter(Ze,ct)},this._yPositions=new pe(200),this._knownHeights=new Map,this._startIndexDrawn=2**20,this._endIndexDrawn=-(2**20),this._startIndex=0,this._endIndex=0,this._viewHeight=-1,this._scrollTop=-1,this._isScrolledOrResized=!1,this._htmlTopOffset=-1,this._windowScrollListenerAdded=!1,this._htmlElm=document.documentElement,this._wrapperElm=void 0,this._itemHolderElm=void 0}static{this.defaultProps={initialDraw:ve,itemsWrapperClassName:"",windowScroller:!1}}componentDidMount(){if(this.props.windowScroller){if(this._wrapperElm){const{top:Ye}=this._wrapperElm.getBoundingClientRect();this._htmlTopOffset=Ye+this._htmlElm.scrollTop}window.addEventListener("scroll",this._onScroll),this._windowScrollListenerAdded=!0}else this._wrapperElm=this.props.scrollElement,this._wrapperElm?.addEventListener("scroll",this._onScroll)}componentDidUpdate(Ye){this._itemHolderElm&&this._scanItemHeights(),!this.props.windowScroller&&Ye.scrollElement!==this.props.scrollElement&&(Ye.scrollElement?.removeEventListener("scroll",this._onScroll),this._wrapperElm=this.props.scrollElement,this._wrapperElm?.addEventListener("scroll",this._onScroll))}componentWillUnmount(){this._windowScrollListenerAdded?window.removeEventListener("scroll",this._onScroll):this._wrapperElm?.removeEventListener("scroll",this._onScroll)}_isViewChanged(){if(!this._wrapperElm)return!1;const Ye=this.props.windowScroller,Ze=Ye?this._htmlElm.clientHeight:this._wrapperElm.clientHeight,ct=Ye?this._htmlElm.scrollTop:this._wrapperElm.scrollTop;return Ze!==this._viewHeight||ct!==this._scrollTop}_calcViewIndexes(){if(this.props.windowScroller)this._viewHeight=window.innerHeight-this._htmlTopOffset,this._scrollTop=window.scrollY;else{if(!this._wrapperElm){this._viewHeight=-1,this._startIndex=0,this._endIndex=0;return}this._viewHeight=this._wrapperElm.clientHeight,this._scrollTop=this._wrapperElm.scrollTop}const Ze=this._scrollTop,ct=this._scrollTop+this._viewHeight;this._startIndex=this._yPositions.findFloorIndex(Ze,this._getHeight),this._endIndex=this._yPositions.findFloorIndex(ct,this._getHeight)}render(){const{dataLength:Ye,getKeyFromIndex:Ze,initialDraw:ct=ve,itemRenderer:It,viewBuffer:Ht,viewBufferMin:tn}=this.props,dn=this._getHeight,yn=[];let Rn,Yn;if(this._yPositions.profileData(Ye),!this._wrapperElm)Rn=0,Yn=(ct<Ye?ct:Ye)-1;else{this._isViewChanged()&&this._calcViewIndexes();const ca=tn>this._startIndex?0:this._startIndex-tn,Oa=tn<Ye-this._endIndex?this._endIndex+tn:Ye-1;ca<this._startIndexDrawn||Oa>this._endIndexDrawn?(Rn=Ht>this._startIndex?0:this._startIndex-Ht,Yn=this._endIndex+Ht,Yn>=Ye&&(Yn=Ye-1)):(Rn=this._startIndexDrawn>Ye-1?0:this._startIndexDrawn,Yn=this._endIndexDrawn>Ye-1?Ye-1:this._endIndexDrawn)}this._yPositions.calcHeights(Yn,dn,Rn||-1),this._startIndexDrawn=Rn,this._endIndexDrawn=Yn,yn.length=Yn-Rn+1;for(let ca=Rn;ca<=Yn;ca++){const{y:Oa,height:ma}=this._yPositions.getRowPosition(ca,dn),$a={height:ma,top:Oa,position:"absolute"},He=Ze(ca),Ie={"data-item-key":He};yn.push(It(He,$a,ca,Ie))}const qn={style:{position:"relative"},ref:this._initWrapper};this.props.windowScroller||(qn.onScroll=this._onScroll,qn.style.height="100%",qn.style.overflowY="auto");const Jn={position:"relative",height:this._yPositions.getEstimatedHeight()};return n.createElement("div",{...qn,"data-testid":"ListView"},n.createElement("div",{style:Jn},n.createElement("div",{style:{position:"absolute",top:0,margin:0,padding:0},className:this.props.itemsWrapperClassName,ref:this._initItemHolder},yn)))}}const Oe="None",Me="Duration",Ue="Tag";function we({options:ke,onOptionsChange:Ye}){const Ze=useStyles2(Fe),ct=[Oe,Me,Ue].map(toOption);return React.createElement("div",{className:css({width:"100%"})},React.createElement(InlineFieldRow,{className:Ze.row},React.createElement(InlineField,{label:"Label",labelWidth:26,tooltip:"Default: duration",grow:!0},React.createElement(Select,{inputId:"label",options:ct,value:ke.jsonData.spanBar?.type||"",onChange:It=>{updateDatasourcePluginJsonDataOption({onOptionsChange:Ye,options:ke},"spanBar",{...ke.jsonData.spanBar,type:It?.value??""})},placeholder:"Duration",isClearable:!0,"aria-label":"select-label-name",width:40}))),ke.jsonData.spanBar?.type===Ue&&React.createElement(InlineFieldRow,{className:Ze.row},React.createElement(InlineField,{label:"Tag key",labelWidth:26,tooltip:"Tag key which will be used to get the tag value. A span's attributes and resources will be searched for the tag key"},React.createElement(Input,{type:"text",placeholder:"Enter tag key",onChange:It=>updateDatasourcePluginJsonDataOption({onOptionsChange:Ye,options:ke},"spanBar",{...ke.jsonData.spanBar,tag:It.currentTarget.value}),value:ke.jsonData.spanBar?.tag||"",width:40}))))}const Re=({options:ke,onOptionsChange:Ye})=>{let Ze=ke.type;return Ze+=ke.type==="tempo"?"/configure-tempo-data-source/#span-bar":"/#span-bar",React.createElement(ConfigSubSection,{title:"Span bar",description:React.createElement(ConfigDescriptionLink,{description:"Add additional info next to the service and operation on a span bar row in the trace view.",suffix:Ze,feature:"the span bar"})},React.createElement(we,{options:ke,onOptionsChange:Ye}))},Fe=ke=>({infoText:css({label:"infoText",paddingBottom:ke.spacing(2),color:ke.colors.text.secondary}),row:css({label:"row",alignItems:"baseline"})});var xe=e(14578),Ve=e(13544),$e=e(56034),Xe=e(95868),gt=e(13840);function Dt({children:ke,content:Ye,overlayClassName:Ze}){const ct=(0,n.useRef)(null);return n.createElement(Xe.I,{content:Ye,hideAfter:300},(It,Ht,tn)=>n.createElement(n.Fragment,null,ct.current&&n.createElement(gt.A,{...tn,referenceElement:ct.current,wrapperClassName:Ze,onMouseLeave:Ht,onMouseEnter:It}),n.cloneElement(ke,{ref:ct,onMouseEnter:It,onMouseLeave:Ht})))}const nt="label";var at=e(55852);const Ae=()=>({CopyIcon:(0,t.css)`
      background-color: transparent;
      border: none;
      color: inherit;
      height: 100%;
      overflow: hidden;
      &:focus {
        background-color: rgba(255, 255, 255, 0.25);
        color: inherit;
      }
    `});function re({copyText:ke,icon:Ye="copy",tooltipTitle:Ze}){const ct=(0,m.of)(Ae),[It,Ht]=(0,n.useState)(!1),tn=()=>{navigator.clipboard.writeText(ke),Ht(!0)};return n.createElement($e.m,{content:It?"Copied":Ze},n.createElement(at.$n,{className:E()(ct.CopyIcon),type:"button",icon:Ye,onClick:tn}))}var Z=e(72834),oe=e.n(Z);const Ee="copyIcon",ye=ke=>({KeyValueTable:(0,t.css)`
      label: KeyValueTable;
      background: ${(0,l.R)(ke,"#fff")};
      border: 1px solid ${(0,l.R)(ke,"#ddd")};
      margin-bottom: 0.5rem;
      max-height: 450px;
      overflow: auto;
    `,table:(0,t.css)({width:"100%"}),body:(0,t.css)`
      label: body;
      vertical-align: baseline;
    `,row:(0,t.css)`
      label: row;
      & > td {
        padding: 0rem 0.5rem;
        height: 30px;
      }
      &:nth-child(2n) > td {
        background: ${(0,l.R)(ke,"#f5f5f5")};
      }
      &:not(:hover) .${Ee} {
        visibility: hidden;
      }
    `,keyColumn:(0,t.css)`
      label: keyColumn;
      color: ${(0,l.R)(ke,"#888")};
      white-space: pre;
      width: 125px;
    `,copyColumn:(0,t.css)`
      label: copyColumn;
      text-align: right;
    `,linkIcon:(0,t.css)`
      label: linkIcon;
      vertical-align: middle;
      font-weight: bold;
    `,jsonTable:(0,t.css)({display:"inline-block"})}),Se=/^(\[|\{)/;function Be(ke){if(typeof ke=="string"&&Se.test(ke))try{return JSON.parse(ke)}catch{}return ke}const We=({href:ke,title:Ye="",children:Ze})=>n.createElement("a",{href:ke,title:Ye,target:"_blank",rel:"noopener noreferrer"},Ze," ",n.createElement(xe.I,{name:"external-link-alt"}));function Ke(ke){const{data:Ye,linksGetter:Ze}=ke,ct=(0,m.of)(ye);return n.createElement("div",{className:E()(ct.KeyValueTable),"data-testid":"KeyValueTable"},n.createElement("table",{className:ct.table},n.createElement("tbody",{className:ct.body},Ye.map((It,Ht)=>{const tn={__html:oe()(Be(It.value))},dn=n.createElement("div",{className:ct.jsonTable,dangerouslySetInnerHTML:tn}),yn=Ze?Ze(Ye,Ht):null;let Rn;return yn&&yn.length?Rn=n.createElement("div",null,n.createElement(We,{href:yn[0].url,title:yn[0].text},dn)):Rn=dn,n.createElement("tr",{className:ct.row,key:`${It.key}-${Ht}`},n.createElement("td",{className:ct.keyColumn,"data-testid":"KeyValueTable--keyColumn"},It.key),n.createElement("td",null,Rn),n.createElement("td",{className:ct.copyColumn},n.createElement(re,{className:Ee,copyText:JSON.stringify(It,null,2),tooltipTitle:"Copy JSON"})))}))))}var it=e(11908),rt=e(72724),ft=e(12131),pt=e(14689),Ge=e(25994),qe=e(21744),bt=e(19071),Ft=e(28114);const Xt=ke=>Ye=>({LabeledList:(0,t.css)`
      label: LabeledList;
      list-style: none;
      margin: 0;
      padding: 0;
      ${ke&&`
        margin-right: -8px;
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-end;
      `}
    `,LabeledListItem:(0,t.css)`
      label: LabeledListItem;
      display: inline-block;
      ${ke&&`
        border-right: 1px solid ${(0,l.R)(Ye,"#ddd")};
        padding: 0 8px;
      `}
    `,LabeledListLabel:(0,t.css)`
      label: LabeledListLabel;
      color: ${Ye.isLight?"#999":"#666"};
      margin-right: 0.25rem;
    `,LabeledListValue:(0,t.css)`
      label: LabeledListValue;
      ${!ke&&"margin-right: 0.55rem;"}
    `});function Lt(ke){const{className:Ye,divider:Ze=!1,items:ct}=ke,It=(0,m.of)(Xt(Ze));return n.createElement("ul",{className:E()(It.LabeledList,Ye)},ct.map(({key:Ht,label:tn,value:dn})=>n.createElement("li",{className:It.LabeledListItem,key:`${Ht}`},n.createElement("span",{className:It.LabeledListLabel},tn),n.createElement("strong",{className:It.LabeledListValue},dn))))}const Qt="kind",an="status",gn="status.message",ut="library.name",Nt="library.version",ht="trace.state",Rt="id";var _t=e(92102);function on(ke){const{reference:Ye,children:Ze,createFocusSpanLink:ct}=ke,It=ct(Ye.traceID,Ye.spanID);return n.createElement("a",{href:It.href,target:It.target,rel:"noopener noreferrer",onClick:It.onClick?Ht=>{Ht.preventDefault(),It.onClick(Ht)}:void 0},Ze)}const ln=ke=>({AccordianReferenceItem:(0,t.css)`
      border-bottom: 1px solid ${(0,l.R)(ke,"#d8d8d8")};
    `,AccordianKeyValues:(0,t.css)`
      margin-left: 10px;
    `,AccordianReferences:(0,t.css)`
      label: AccordianReferences;
      border: 1px solid ${(0,l.R)(ke,"#d8d8d8")};
      position: relative;
      margin-bottom: 0.25rem;
    `,AccordianReferencesHeader:(0,t.css)`
      label: AccordianReferencesHeader;
      background: ${(0,l.R)(ke,"#e4e4e4")};
      color: inherit;
      display: block;
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,l.R)(ke,"#dadada")};
      }
    `,AccordianReferencesContent:(0,t.css)`
      label: AccordianReferencesContent;
      background: ${(0,l.R)(ke,"#f0f0f0")};
      border-top: 1px solid ${(0,l.R)(ke,"#d8d8d8")};
      padding: 0.5rem 0.5rem 0.25rem 0.5rem;
    `,AccordianReferencesFooter:(0,t.css)`
      label: AccordianReferencesFooter;
      color: ${(0,l.R)(ke,"#999")};
    `,AccordianKeyValuesItem:(0,t.css)({marginBottom:ke.spacing(.5)}),ReferencesList:(0,t.css)`
      background: #fff;
      border: 1px solid #ddd;
      margin-bottom: 0.7em;
      max-height: 450px;
      overflow: auto;
    `,list:(0,t.css)`
      width: 100%;
      list-style: none;
      padding: 0;
      margin: 0;
      background: #fff;
    `,itemContent:(0,t.css)`
      padding: 0.25rem 0.5rem;
      display: flex;
      width: 100%;
      justify-content: space-between;
    `,item:(0,t.css)`
      &:nth-child(2n) {
        background: #f5f5f5;
      }
    `,debugInfo:(0,t.css)`
      letter-spacing: 0.25px;
      margin: 0.5em 0 0;
      flex-wrap: wrap;
      display: flex;
      justify-content: flex-end;
    `,debugLabel:(0,t.css)`
      margin: 0 5px 0 5px;
      &::before {
        color: #bbb;
        content: attr(data-label);
      }
    `,serviceName:(0,t.css)`
      margin-right: 8px;
    `,title:(0,t.css)`
      display: flex;
      align-items: center;
      gap: 4px;
    `});function bn(ke){const{data:Ye,createFocusSpanLink:Ze,openedItems:ct,onItemToggle:It,interactive:Ht}=ke,tn=(0,m.of)(ln);return n.createElement("div",{className:tn.AccordianReferencesContent},Ye.map((dn,yn)=>n.createElement("div",{className:yn<Ye.length-1?tn.AccordianReferenceItem:void 0,key:yn},n.createElement("div",{className:tn.item,key:`${dn.spanID}`},n.createElement(on,{reference:dn,createFocusSpanLink:Ze},n.createElement("span",{className:tn.itemContent},dn.span?n.createElement("span",null,n.createElement("span",{className:(0,t.cx)("span-svc-name",tn.serviceName)},dn.span.process.serviceName),n.createElement("small",{className:"endpoint-name"},dn.span.operationName)):n.createElement("span",{className:(0,t.cx)("span-svc-name",tn.title)},"View Linked Span ",n.createElement(xe.I,{name:"external-link-alt"})),n.createElement("small",{className:tn.debugInfo},n.createElement("span",{className:tn.debugLabel,"data-label":"TraceID:"},dn.traceID),n.createElement("span",{className:tn.debugLabel,"data-label":"SpanID:"},dn.spanID))))),!!dn.tags?.length&&n.createElement("div",{className:tn.AccordianKeyValues},n.createElement(xn,{className:yn<Ye.length-1?tn.AccordianKeyValuesItem:null,data:dn.tags||[],highContrast:!0,interactive:Ht,isOpen:ct?ct.has(dn):!1,label:"attributes",linksGetter:null,onToggle:Ht&&It?()=>It(dn):null})))))}const In=({data:ke,interactive:Ye=!0,isOpen:Ze,onToggle:ct,onItemToggle:It,openedItems:Ht,createFocusSpanLink:tn})=>{const dn=!Array.isArray(ke)||!ke.length;let yn=null,Rn="span",Yn=null;Ye&&(yn=Ze?n.createElement(xe.I,{name:"angle-down",className:Kt}):n.createElement(xe.I,{name:"angle-right",className:Kt}),Rn="a",Yn={"aria-checked":Ze,onClick:dn?null:ct,role:"switch"});const qn=(0,m.of)(ln);return n.createElement("div",{className:qn.AccordianReferences},n.createElement(Rn,{className:qn.AccordianReferencesHeader,...Yn},yn,n.createElement("strong",null,n.createElement("span",null,"References"))," ","(",ke.length,")"),Ze&&n.createElement(bn,{data:ke,openedItems:Ht,createFocusSpanLink:tn,onItemToggle:It,interactive:Ye}))},Mn=n.memo(In),vt=()=>({TextList:(0,t.css)`
      max-height: 450px;
      overflow: auto;
    `,List:(0,t.css)`
      width: 100%;
      list-style: none;
      padding: 0;
      margin: 0;
    `,item:(0,t.css)`
      padding: 0.25rem 0.5rem;
      vertical-align: top;
      &:nth-child(2n) {
        background: #f5f5f5;
      }
    `});function nn(ke){const{data:Ye}=ke,Ze=(0,m.of)(vt);return n.createElement("div",{className:E()(Ze.TextList),"data-testid":"TextList"},n.createElement("ul",{className:Ze.List},Ye.map((ct,It)=>n.createElement("li",{className:Ze.item,key:`${It}`},ct))))}const cn=ke=>({header:(0,t.css)`
      cursor: pointer;
      overflow: hidden;
      padding: 0.25em 0.1em;
      text-overflow: ellipsis;
      white-space: nowrap;
      &:hover {
        background: ${(0,l.R)(ke,"#e8e8e8")};
      }
    `});function mt({data:ke}){return n.createElement(nn,{data:ke})}function lt({className:ke=null,data:Ye,headerClassName:Ze,highContrast:ct=!1,interactive:It=!0,isOpen:Ht,label:tn,onToggle:dn=null,TextComponent:yn=mt}){const Rn=!Array.isArray(Ye)||!Ye.length,Yn=(0,m.of)(Je),qn=E()(Kt,{[Yn.emptyIcon]:Rn});let Jn=null,ca=null;It&&(Jn=Ht?n.createElement(xe.I,{name:"angle-down",className:qn}):n.createElement(xe.I,{name:"angle-right",className:qn}),ca={"aria-checked":Ht,onClick:Rn?null:dn,role:"switch"});const Oa=(0,m.of)(cn);return n.createElement("div",{className:ke||""},n.createElement("div",{className:E()(Oa.header,Ze),...ca,"data-testid":"AccordianText--header"},Jn,n.createElement("strong",null,tn)," (",Ye.length,")"),Ht&&n.createElement(yn,{data:Ye}))}var Tt=e(49185),Vt=e(75505),zt=e(47232),rn=e(41987),mn=e(85194),dt=e(26657),wt=e(72574),en=e(31193);function En(ke){const{span:Ye,traceToProfilesOptions:Ze,timeZone:ct,traceFlameGraphs:It,setTraceFlameGraphs:Ht,setRedrawListView:tn,traceDuration:dn,traceName:yn}=ke,[Rn,{height:Yn}]=(0,Tt.A)(),qn=(0,m.of)(yt),Jn=Ye.tags.filter(He=>He.key===Ft.QW),ca=Jn.length>0?Jn[0].value:void 0,Oa=(0,n.useCallback)(()=>{const He=Math.floor(Ye.startTime/1e3)-3e4,Ie=(Ye.startTime+Ye.duration)/1e3+3e4,je=(0,zt.KQ)(Ie),tt=(0,zt.KQ)(He);return{from:tt,to:je,raw:{from:tt,to:je}}},[Ye.duration,Ye.startTime]),ma=async(He,Ie)=>{const je=await(0,en.tR)().get(Ie);if(je instanceof dt.iy){const St=(await(0,Vt.s)(je.query(He))).data.find($t=>$t.name==="response");if(St&&St.length>1)return St}},$a=(0,n.useCallback)(async(He,Ie,je)=>{let tt="{}";if(Ie.customQuery&&Ie.query){const Yt={...(0,Ft.gt)(dn,yn,je.traceID),...(0,Ft.hv)(je),...(0,Ft.Cr)(je,Ie)};tt=(0,wt.w)().replace(Ie.query,Yt)}else{const Yt=Ie.tags&&Ie.tags.length>0?Ie.tags:Ft.i0;tt=`{${(0,Ft._o)(je,Yt)}}`}const St={requestId:"span-flamegraph-requestId",interval:"2s",intervalMs:2e3,range:Oa(),scopedVars:{},app:rn.Jk.Unknown,timezone:ct,startTime:je.startTime,targets:[{labelSelector:tt,groupBy:[],profileTypeId:Ie.profileTypeId??"",queryType:"profile",spanSelector:[ca],refId:"span-flamegraph-refId",datasource:{type:He.type,uid:He.uid}}]},$t=await ma(St,He.uid);$t&&$t.length>0&&Ht({...It,[ca]:$t})},[Oa,ca,Ht,ct,dn,It,yn]);return(0,n.useEffect)(()=>{if(!Object.keys(It).includes(ca)){let He;Ze&&Ze?.datasourceUid&&(He=(0,en.tR)().getInstanceSettings(Ze.datasourceUid)),Ze&&He&&$a(He,Ze,Ye)}},[Ht,Ye,It,Ze,Oa,ct,$a,ca]),(0,n.useEffect)(()=>{tn({})},[Yn,tn]),It[ca]?n.createElement("div",{className:qn.flameGraph,ref:Rn},n.createElement("div",{className:qn.flameGraphTitle},"Flame graph"),n.createElement(mn.A,{data:It[ca],getTheme:()=>r.$.theme2,showFlameGraphOnly:!0,disableCollapsing:!0})):n.createElement(n.Fragment,null)}const yt=()=>({flameGraph:(0,t.css)({label:"flameGraphInSpan",margin:"5px"}),flameGraphTitle:(0,t.css)({label:"flameGraphTitleInSpan",marginBottom:"5px",fontWeight:"bold"})}),At=ke=>({header:(0,t.css)`
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 0 1rem;
      margin-bottom: 0.25rem;
    `,listWrapper:(0,t.css)`
      overflow: hidden;
    `,list:(0,t.css)({textAlign:"right"}),operationName:(0,t.css)({margin:0}),debugInfo:(0,t.css)`
      label: debugInfo;
      display: block;
      letter-spacing: 0.25px;
      margin: 0.5em 0 -0.75em;
      text-align: right;
    `,debugLabel:(0,t.css)`
      label: debugLabel;
      &::before {
        color: ${(0,l.R)(ke,"#bbb")};
        content: attr(data-label);
      }
    `,debugValue:(0,t.css)`
      label: debugValue;
      background-color: inherit;
      border: none;
      color: ${(0,l.R)(ke,"#888")};
      cursor: pointer;
      &:hover {
        color: ${(0,l.R)(ke,"#333")};
      }
    `,AccordianWarnings:(0,t.css)`
      label: AccordianWarnings;
      background: ${(0,l.R)(ke,"#fafafa")};
      border: 1px solid ${(0,l.R)(ke,"#e4e4e4")};
      margin-bottom: 0.25rem;
    `,AccordianWarningsHeader:(0,t.css)`
      label: AccordianWarningsHeader;
      background: ${(0,l.R)(ke,"#fff7e6")};
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,l.R)(ke,"#ffe7ba")};
      }
    `,AccordianWarningsHeaderOpen:(0,t.css)`
      label: AccordianWarningsHeaderOpen;
      border-bottom: 1px solid ${(0,l.R)(ke,"#e8e8e8")};
    `,AccordianWarningsLabel:(0,t.css)`
      label: AccordianWarningsLabel;
      color: ${(0,l.R)(ke,"#d36c08")};
    `,AccordianKeyValuesItem:(0,t.css)({marginBottom:ke.spacing(.5)}),Textarea:(0,t.css)`
      word-break: break-all;
      white-space: pre;
    `,LinkIcon:(0,t.css)`
      font-size: 1.5em;
    `}),Kt=(0,t.css)({margin:"-0.2rem 0.25rem 0 0"});function Jt(ke){const{detailState:Ye,linksGetter:Ze,logItemToggle:ct,logsToggle:It,processToggle:Ht,span:tn,tagsToggle:dn,traceStartTime:yn,traceDuration:Rn,traceName:Yn,warningsToggle:qn,stackTracesToggle:Jn,referencesToggle:ca,referenceItemToggle:Oa,createSpanLink:ma,createFocusSpanLink:$a,datasourceType:He,traceFlameGraphs:Ie,setTraceFlameGraphs:je,traceToProfilesOptions:tt,setRedrawListView:St}=ke,{isTagsOpen:$t,isProcessOpen:Yt,logs:pn,isWarningsOpen:Bn,references:Cn,isStackTracesOpen:Xn}=Ye,{operationName:na,process:va,duration:ba,relativeStartTime:fa,startTime:Ga,traceID:Ta,spanID:Fa,logs:$n,tags:ta,warnings:Zn,references:La,stackTraces:us}=tn,{timeZone:ts}=ke;let Hs=[{key:"svc",label:"Service:",value:va.serviceName},{key:"duration",label:"Duration:",value:(0,g.a3)(ba)},{key:"start",label:"Start Time:",value:(0,g.a3)(fa)+Mt(Ga,ts)},...tn.childSpanCount>0?[{key:"child_count",label:"Child Count:",value:tn.childSpanCount}]:[]];const Da=(0,m.of)(At);tn.kind&&Hs.push({key:Qt,label:"Kind:",value:tn.kind}),tn.statusCode!==void 0&&Hs.push({key:an,label:"Status:",value:it.s[tn.statusCode].toLowerCase()}),tn.statusMessage&&Hs.push({key:gn,label:"Status Message:",value:tn.statusMessage}),tn.instrumentationLibraryName&&Hs.push({key:ut,label:"Library Name:",value:tn.instrumentationLibraryName}),tn.instrumentationLibraryVersion&&Hs.push({key:Nt,label:"Library Version:",value:tn.instrumentationLibraryVersion}),tn.traceState&&Hs.push({key:ht,label:"Trace State:",value:tn.traceState});const fr=(Ds,no,Wr,yo)=>n.createElement(pt.R,{link:{...Ds,title:Wr,target:"_blank",origin:Ds.field,onClick:jl=>{(0,s.rR)("grafana_traces_trace_view_span_link_clicked",{datasourceType:He,grafana_version:r.$.buildInfo.version,type:no,location:"spanDetails"}),Ds.onClick?Ds.onClick?.(jl):ft.Ny.push(Ds.href)}},buttonProps:{icon:yo}});let zr=null,qi=null;if(ma){const Ds=ma(tn),no=Ds?.filter(yo=>yo.type===_t.N.Logs);Ds&&no&&no.length>0&&(zr=fr(no[0],_t.N.Logs,"Logs for this span","gf-logs"));const Wr=Ds?.filter(yo=>yo.type===_t.N.Profiles&&yo.title===bt.cd);Ds&&Wr&&Wr.length>0&&(qi=fr(Wr[0],_t.N.Profiles,"Profiles for this span","link"))}const yr=$a(Ta,Fa);return n.createElement("div",{"data-testid":"span-detail-component"},n.createElement("div",{className:Da.header},n.createElement("h2",{className:Da.operationName},na),n.createElement("div",{className:Da.listWrapper},n.createElement(Lt,{className:Da.list,divider:!0,items:Hs}))),n.createElement("span",{style:{marginRight:"10px"}},zr),qi,n.createElement(Ge.c,{spacing:1}),n.createElement("div",null,n.createElement("div",null,n.createElement(xn,{data:ta,label:"Span Attributes",linksGetter:Ze,isOpen:$t,onToggle:()=>dn(Fa)}),va.tags&&n.createElement(xn,{className:Da.AccordianKeyValuesItem,data:va.tags,label:"Resource Attributes",linksGetter:Ze,isOpen:Yt,onToggle:()=>Ht(Fa)})),$n&&$n.length>0&&n.createElement(wn,{linksGetter:Ze,logs:$n,isOpen:pn.isOpen,openedItems:pn.openedItems,onToggle:()=>It(Fa),onItemToggle:Ds=>ct(Fa,Ds),timestamp:yn}),Zn&&Zn.length>0&&n.createElement(lt,{className:Da.AccordianWarnings,headerClassName:Da.AccordianWarningsHeader,label:n.createElement("span",{className:Da.AccordianWarningsLabel},"Warnings"),data:Zn,isOpen:Bn,onToggle:()=>qn(Fa)}),us?.length?n.createElement(lt,{label:"Stack trace",data:us,isOpen:Xn,TextComponent:Ds=>{let no;return Ds.data?.length>1?no=Ds.data.map((Wr,yo)=>`StackTrace ${yo+1}:
${Wr}`).join(`
`):no=Ds.data?.[0],n.createElement(qe.f,{className:Da.Textarea,style:{cursor:"unset"},readOnly:!0,cols:10,rows:10,value:no})},onToggle:()=>Jn(Fa)}):null,La&&La.length>0&&(La.length>1||La[0].refType!=="CHILD_OF")&&n.createElement(Mn,{data:La,isOpen:Cn.isOpen,openedItems:Cn.openedItems,onToggle:()=>ca(Fa),onItemToggle:Ds=>Oa(Fa,Ds),createFocusSpanLink:$a}),tn.tags.some(Ds=>Ds.key===Ft.QW)&&n.createElement(En,{span:tn,timeZone:ts,traceFlameGraphs:Ie,setTraceFlameGraphs:je,traceToProfilesOptions:tt,setRedrawListView:St,traceDuration:Rn,traceName:Yn}),n.createElement("small",{className:Da.debugInfo},n.createElement("a",{...yr,onClick:Ds=>{yr.onClick&&Ds.button===0&&(!Ds.currentTarget.target||Ds.currentTarget.target==="_self")&&!(Ds.metaKey||Ds.altKey||Ds.ctrlKey||Ds.shiftKey)&&(Ds.preventDefault(),yr.onClick(Ds))}},n.createElement(xe.I,{name:"link",className:E()(Kt,Da.LinkIcon)})),n.createElement("span",{className:Da.debugLabel,"data-label":"SpanID:"})," ",Fa)))}const Mt=(ke,Ye)=>{const Ze=(0,rt.LE)(ke/1e3,{timeZone:Ye,defaultWithMS:!0}),ct=Ze.split(" ");return` (${ct[1]?ct[1]:Ze})`},Je=ke=>({container:(0,t.css)({textOverflow:"ellipsis"}),header:(0,t.css)`
      label: header;
      cursor: pointer;
      overflow: hidden;
      padding: 0.25em 0.1em;
      text-overflow: ellipsis;
      white-space: nowrap;
      &:hover {
        background: ${(0,l.R)(ke,"#e8e8e8")};
      }
    `,headerEmpty:(0,t.css)`
      label: headerEmpty;
      background: none;
      cursor: initial;
    `,headerHighContrast:(0,t.css)`
      label: headerHighContrast;
      &:hover {
        background: ${(0,l.R)(ke,"#ddd")};
      }
    `,emptyIcon:(0,t.css)`
      label: emptyIcon;
      color: ${(0,l.R)(ke,"#aaa")};
    `,summary:(0,t.css)`
      label: summary;
      display: inline;
      list-style: none;
      padding: 0;
    `,summaryItem:(0,t.css)`
      label: summaryItem;
      display: inline;
      margin-left: 0.7em;
      padding-right: 0.5rem;
      border-right: 1px solid ${(0,l.R)(ke,"#ddd")};
      &:last-child {
        padding-right: 0;
        border-right: none;
      }
    `,summaryLabel:(0,t.css)`
      label: summaryLabel;
      color: ${(0,l.R)(ke,"#777")};
    `,summaryDelim:(0,t.css)`
      label: summaryDelim;
      color: ${(0,l.R)(ke,"#bbb")};
      padding: 0 0.2em;
    `});function Nn({data:ke=null}){const Ye=(0,m.of)(Je);return!Array.isArray(ke)||!ke.length?null:n.createElement("ul",{className:Ye.summary},ke.map((Ze,ct)=>n.createElement("li",{className:Ye.summaryItem,key:`${Ze.key}-${ct}`},n.createElement("span",{className:Ye.summaryLabel},Ze.key),n.createElement("span",{className:Ye.summaryDelim},"="),String(Ze.value))))}function xn({className:ke=null,data:Ye,highContrast:Ze=!1,interactive:ct=!0,isOpen:It,label:Ht,linksGetter:tn,onToggle:dn=null}){const yn=!Array.isArray(Ye)||!Ye.length,Rn=(0,m.of)(Je),Yn=E()(Kt,{[Rn.emptyIcon]:yn});let qn=null,Jn=null;return ct&&(qn=It?n.createElement(xe.I,{name:"angle-down",className:Yn}):n.createElement(xe.I,{name:"angle-right",className:Yn}),Jn={"aria-checked":It,onClick:yn?null:dn,role:"switch"}),n.createElement("div",{className:E()(ke,Rn.container)},n.createElement("div",{className:E()(Rn.header,{[Rn.headerEmpty]:yn,[Rn.headerHighContrast]:Ze&&!yn}),...Jn,"data-testid":"AccordianKeyValues--header"},qn,n.createElement("strong",{"data-test":nt},Ht,It||":"),!It&&n.createElement(Nn,{data:Ye})),It&&n.createElement(Ke,{data:Ye,linksGetter:tn}))}const Fn=ke=>({AccordianLogs:(0,t.css)`
      label: AccordianLogs;
      border: 1px solid ${(0,l.R)(ke,"#d8d8d8")};
      position: relative;
      margin-bottom: 0.25rem;
    `,AccordianLogsHeader:(0,t.css)`
      label: AccordianLogsHeader;
      background: ${(0,l.R)(ke,"#e4e4e4")};
      color: inherit;
      display: block;
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,l.R)(ke,"#dadada")};
      }
    `,AccordianLogsContent:(0,t.css)`
      label: AccordianLogsContent;
      background: ${(0,l.R)(ke,"#f0f0f0")};
      border-top: 1px solid ${(0,l.R)(ke,"#d8d8d8")};
      padding: 0.5rem 0.5rem 0.25rem 0.5rem;
    `,AccordianLogsFooter:(0,t.css)`
      label: AccordianLogsFooter;
      color: ${(0,l.R)(ke,"#999")};
    `,AccordianKeyValuesItem:(0,t.css)({marginBottom:ke.spacing(.5)})});function wn({interactive:ke=!0,isOpen:Ye,linksGetter:Ze,logs:ct,openedItems:It,onItemToggle:Ht,onToggle:tn,timestamp:dn}){let yn=null,Rn="span",Yn=null;ke&&(yn=Ye?n.createElement(xe.I,{name:"angle-down",className:Kt}):n.createElement(xe.I,{name:"angle-right",className:"u-align-icon"}),Rn="a",Yn={"aria-checked":Ye,onClick:tn,role:"switch"});const qn=(0,m.of)(Fn);return n.createElement("div",{className:qn.AccordianLogs},n.createElement(Rn,{className:qn.AccordianLogsHeader,...Yn},yn," ",n.createElement("strong",null,"Events")," (",ct.length,")"),Ye&&n.createElement("div",{className:qn.AccordianLogsContent},(0,fe.sortBy)(ct,"timestamp").map((Jn,ca)=>n.createElement(xn,{key:`${Jn.timestamp}-${ca}`,className:ca<ct.length-1?qn.AccordianKeyValuesItem:null,data:Jn.fields||[],highContrast:!0,interactive:ke,isOpen:It?It.has(Jn):!1,label:`${(0,g.a3)(Jn.timestamp-dn)}`,linksGetter:Ze,onToggle:ke&&Ht?()=>Ht(Jn):null})),n.createElement("small",{className:qn.AccordianLogsFooter},"Log timestamps are relative to the start time of the full trace.")))}const Wn=ke=>({wrapper:(0,t.css)({label:"wrapper",bottom:0,left:0,position:"absolute",right:0,top:0,overflow:"hidden",zIndex:0}),bar:(0,t.css)({label:"bar",borderRadius:ke.shape.radius.default,minWidth:"2px",position:"absolute",height:"36%",top:"32%"}),rpc:(0,t.css)({label:"rpc",position:"absolute",top:"35%",bottom:"35%",zIndex:1}),label:(0,t.css)({label:"label",color:"#aaa",fontSize:"12px",fontFamily:"'Helvetica Neue', Helvetica, Arial, sans - serif",lineHeight:"1em",whiteSpace:"nowrap",padding:"0 0.5em",position:"absolute"}),logMarker:(0,t.css)({label:"logMarker",backgroundColor:(0,l.R)(ke,"#2c3235"),cursor:"pointer",height:"60%",minWidth:"1px",position:"absolute",top:"20%","&:hover":{backgroundColor:(0,l.R)(ke,"#464c54")},"&::before, &::after":{content:"''",position:"absolute",top:0,bottom:0,right:0,border:"1px solid transparent"},"&::after":{left:0}}),criticalPath:(0,t.css)({position:"absolute",top:"45%",height:"11%",zIndex:2,overflow:"hidden",background:(0,l.R)(ke,"#f1f1f1"),borderLeft:`1px solid ${(0,l.R)(ke,"#2c3235")}`,borderRight:`1px solid ${(0,l.R)(ke,"#2c3235")}`})});function da(ke){return`${(ke*100).toFixed(1)}%`}function oa(ke){return`${ke*100}%`}function _n({criticalPath:ke,viewEnd:Ye,viewStart:Ze,getViewedBounds:ct,color:It,shortLabel:Ht,longLabel:tn,onClick:dn,rpc:yn,traceStartTime:Rn,span:Yn,className:qn,labelClassName:Jn}){const[ca,Oa]=(0,n.useState)(Ht),ma=()=>Oa(Ht),$a=()=>Oa(tn),He=(0,fe.groupBy)(Yn.logs,je=>{const tt=ct(je.timestamp,je.timestamp).start;return da(Math.round(tt*500)/500)}),Ie=(0,m.of)(Wn);return n.createElement("div",{className:E()(Ie.wrapper,qn),onBlur:ma,onClick:dn,onFocus:$a,onMouseOut:ma,onMouseOver:$a,"aria-hidden":!0,"data-testid":Ve.Tp.components.TraceViewer.spanBar},n.createElement("div",{"aria-label":ca,className:E()(Ie.bar),style:{background:It,left:da(Ze),width:da(Ye-Ze)}},n.createElement("div",{className:E()(Ie.label,Jn),"data-testid":"SpanBar--label"},ca)),n.createElement("div",null,Object.keys(He).map(je=>n.createElement(Dt,{key:je,content:n.createElement(wn,{interactive:!1,isOpen:!0,logs:He[je],timestamp:Rn})},n.createElement("div",{"data-testid":"SpanBar--logMarker",className:E()(Ie.logMarker),style:{left:je}})))),yn&&n.createElement("div",{className:E()(Ie.rpc),style:{background:yn.color,left:da(yn.viewStart),width:da(yn.viewEnd-yn.viewStart)}}),ke?.map((je,tt)=>{const St=ct(je.section_start,je.section_end),$t=St.start,Yt=St.end,pn=`${je.spanId}-${tt}`;return n.createElement($e.m,{key:pn,placement:"top",content:n.createElement("div",null,"A segment on the ",n.createElement("em",null,"critical path")," of the overall trace / request / workflow.")},n.createElement("div",{"data-testid":"SpanBar--criticalPath",className:Ie.criticalPath,style:{left:oa($t),width:oa(Yt-$t)}}))}))}const Wa=n.memo(_n);var za=e(64539),_a=e(28122);const Xa=(ke,Ye,Ze,ct)=>(ke.sort(function(It,Ht){return(It.title||"link").toLowerCase().localeCompare((Ht.title||"link").toLowerCase())}),ke.map((It,Ht)=>n.createElement(za.D,{key:Ht,label:It.title||"Link",onClick:It.onClick?tn=>{(0,s.rR)("grafana_traces_trace_view_span_link_clicked",{datasourceType:ct,grafana_version:r.$.buildInfo.version,type:It.type,location:"menu"}),tn?.preventDefault(),It.onClick(tn),Ze()}:void 0,url:It.href,className:Ye.menuItem}))),Va=({links:ke,datasourceType:Ye,color:Ze})=>{const ct=(0,m.of)(()=>Cs(Ze)),[It,Ht]=(0,n.useState)(!1),[tn,dn]=(0,n.useState)({x:0,y:0}),yn=()=>Ht(!1);return n.createElement("div",{"data-testid":"SpanLinksMenu",className:ct.wrapper},n.createElement("button",{onClick:Rn=>{Ht(!0),dn({x:Rn.pageX,y:Rn.pageY})},className:ct.button},n.createElement(xe.I,{name:"link",className:ct.icon})),It?n.createElement(_a.t,{onClose:()=>Ht(!1),renderMenuItems:()=>Xa(ke,ct,yn,Ye),focusOnOpen:!1,x:tn.x,y:tn.y}):null)},Cs=ke=>({wrapper:(0,t.css)`
      border: none;
      background: ${ke}10;
      border-bottom: 1px solid ${ke}CF;
      padding-right: 4px;
    `,button:(0,t.css)`
      background: transparent;
      border: none;
      padding: 0;
    `,icon:(0,t.css)`
      background: transparent;
      border: none;
      padding: 0;
    `,menuItem:(0,t.css)`
      max-width: 60ch;
      overflow: hidden;
    `});function ns(ke){return(0,fe.get)((0,fe.find)(ke.references,({span:Ye,refType:Ze})=>Ye&&Ye.spanID&&(Ze==="CHILD_OF"||Ze==="FOLLOWS_FROM")),"span")}function Is(ke){const Ye=[];if(!ke)return Ye;let Ze=ns(ke);for(;Ze;)Ye.push(Ze.spanID),Ze=ns(Ze);return Ye}const ls=(0,o.N)(ke=>({SpanTreeOffset:(0,t.css)`
      label: SpanTreeOffset;
      color: ${(0,l.R)(ke,"#000")};
      position: relative;
    `,SpanTreeOffsetParent:(0,t.css)`
      label: SpanTreeOffsetParent;
      &:hover {
        cursor: pointer;
      }
    `,indentGuide:(0,t.css)`
      label: indentGuide;
      /* The size of the indentGuide is based off of the iconWrapper */
      padding-right: 1rem;
      height: 100%;
      display: inline-flex;
      transition: padding 300ms ease-out;
      &::before {
        content: '';
        padding-left: 1px;
        background-color: ${(0,l.R)(ke,"lightgrey")};
      }
    `,indentGuideActive:(0,t.css)`
      label: indentGuideActive;
      &::before {
        background-color: ${(0,l.R)(ke,"#777")};
      }
    `,indentGuideThin:(0,t.css)`
      padding-right: 0.3rem;
    `,iconWrapper:(0,t.css)`
      label: iconWrapper;
      position: absolute;
      right: 0;
    `}));class ss extends n.PureComponent{constructor(Ye){super(Ye),this.handleMouseLeave=(Ze,ct)=>{(!(Ze.relatedTarget instanceof HTMLSpanElement)||(0,fe.get)(Ze,"relatedTarget.dataset.ancestorId")!==ct)&&this.props.removeHoverIndentGuideId(ct)},this.handleMouseEnter=(Ze,ct)=>{(!(Ze.relatedTarget instanceof HTMLSpanElement)||(0,fe.get)(Ze,"relatedTarget.dataset.ancestorId")!==ct)&&this.props.addHoverIndentGuideId(ct)},this.ancestorIds=Is(Ye.span),this.ancestorIds.push("root"),this.ancestorIds.reverse()}static{this.displayName="UnthemedSpanTreeOffset"}static{this.defaultProps={childrenVisible:!1,showChildrenIcon:!0}}render(){const{childrenVisible:Ye,onClick:Ze,showChildrenIcon:ct,span:It,theme:Ht,visibleSpanIds:tn}=this.props,{hasChildren:dn,spanID:yn}=It,Rn=dn?{onClick:Ze,role:"switch","aria-checked":Ye}:null,Yn=ct&&dn&&(Ye?n.createElement(xe.I,{name:"angle-down","data-testid":"icon-arrow-down",size:"sm"}):n.createElement(xe.I,{name:"angle-right","data-testid":"icon-arrow-right",size:"sm"})),qn=ls(Ht);return n.createElement("span",{className:E()(qn.SpanTreeOffset,{[qn.SpanTreeOffsetParent]:dn}),...Rn},this.ancestorIds.map((Jn,ca)=>n.createElement("span",{key:Jn,className:E()(qn.indentGuide,{[qn.indentGuideActive]:this.props.hoverIndentGuideIds.has(Jn),[qn.indentGuideThin]:ca!==this.ancestorIds.length-1&&Jn!=="root"&&!tn.includes(Jn)}),"data-ancestor-id":Jn,"data-testid":"SpanTreeOffset--indentGuide",onMouseEnter:Oa=>this.handleMouseEnter(Oa,Jn),onMouseLeave:Oa=>this.handleMouseLeave(Oa,Jn)})),Yn&&n.createElement("span",{className:qn.iconWrapper,onMouseEnter:Jn=>this.handleMouseEnter(Jn,yn),onMouseLeave:Jn=>this.handleMouseLeave(Jn,yn),"data-testid":"icon-wrapper"},Yn))}}const Fs=(0,m.cV)(ss),Ts="spanBar",Es="spanBarLabel",gs="nameWrapper",ps="nameWrapperMatchingFilter",js="jaegerView",As="nameColumn",Qr=(0,o.N)((ke,Ye)=>{const Ze={label:"flash",flash:(0,t.keyframes)`
    from {
      background-color: ${(0,l.R)(ke,"#68b9ff")};
    }
    to {
      background-color: 'default';
    }
  `},ct=Ye?"":(0,l.R)(ke,"#fffce4");return{nameWrapper:(0,t.css)`
      label: nameWrapper;
      line-height: 27px;
      overflow: hidden;
      display: flex;
    `,nameWrapperMatchingFilter:(0,t.css)`
      label: nameWrapperMatchingFilter;
      background-color: ${ct};
    `,nameColumn:(0,t.css)`
      label: nameColumn;
      position: relative;
      white-space: nowrap;
      z-index: 1;
      &:hover {
        z-index: 1;
      }
    `,endpointName:(0,t.css)`
      label: endpointName;
      color: ${(0,l.R)(ke,"#484848")};
      font-size: 0.9em;
    `,view:(0,t.css)`
      label: view;
      position: relative;
    `,viewExpanded:(0,t.css)`
      label: viewExpanded;
      background: ${(0,l.R)(ke,"#f8f8f8")};
      outline: 1px solid ${(0,l.R)(ke,"#ddd")};
    `,viewExpandedAndMatchingFilter:(0,t.css)`
      label: viewExpandedAndMatchingFilter;
      background: ${(0,l.R)(ke,"#fff3d7")};
      outline: 1px solid ${(0,l.R)(ke,"#ddd")};
    `,row:(0,t.css)`
      label: row;
      font-size: 0.9em;
      &:hover .${Ts} {
        opacity: 1;
      }
      &:hover .${Es} {
        color: ${(0,l.R)(ke,"#000")};
      }
      &:hover .${gs} {
        background: #f8f8f8;
        background: linear-gradient(
          90deg,
          ${(0,l.R)(ke,"#fafafa")},
          ${(0,l.R)(ke,"#f8f8f8")} 75%,
          ${(0,l.R)(ke,"#eee")}
        );
      }
      &:hover .${js} {
        background-color: ${(0,l.R)(ke,"#f5f5f5")};
        outline: 1px solid ${(0,l.R)(ke,"#ddd")};
      }
    `,rowClippingLeft:(0,t.css)`
      label: rowClippingLeft;
      & .${As}::before {
        content: ' ';
        height: 100%;
        position: absolute;
        width: 6px;
        background-image: linear-gradient(
          to right,
          ${(0,l.R)(ke,"rgba(25, 25, 25, 0.25)")},
          ${(0,l.R)(ke,"rgba(32, 32, 32, 0)")}
        );
        left: 100%;
        z-index: -1;
      }
    `,rowClippingRight:(0,t.css)`
      label: rowClippingRight;
      & .${js}::before {
        content: ' ';
        height: 100%;
        position: absolute;
        width: 6px;
        background-image: linear-gradient(
          to left,
          ${(0,l.R)(ke,"rgba(25, 25, 25, 0.25)")},
          ${(0,l.R)(ke,"rgba(25, 25, 25, 0.25)")}
        );
        right: 0%;
        z-index: 1;
      }
    `,rowExpanded:(0,t.css)`
      label: rowExpanded;
      & .${Ts} {
        opacity: 1;
      }
      & .${Es} {
        color: ${(0,l.R)(ke,"#000")};
      }
      & .${gs}, &:hover .${gs} {
        background: ${(0,l.R)(ke,"#f0f0f0")};
        box-shadow: 0 1px 0 ${(0,l.R)(ke,"#ddd")};
      }
      & .${ps} {
        background: ${(0,l.R)(ke,"#fff3d7")};
      }
      &:hover .${js} {
        background: ${(0,l.R)(ke,"#eee")};
      }
    `,rowMatchingFilter:(0,t.css)`
      label: rowMatchingFilter;
      // background-color: ${(0,l.R)(ke,"#fffbde")};
      &:hover .${gs} {
        background: linear-gradient(
          90deg,
          ${(0,l.R)(ke,"#fffbde")},
          ${(0,l.R)(ke,"#fffbde")} 75%,
          ${(0,l.R)(ke,"#f7f1c6")}
        );
      }
      &:hover .${js} {
        background-color: ${(0,l.R)(ke,"#f7f1c6")};
        outline: 1px solid ${(0,l.R)(ke,"#ddd")};
      }
    `,rowFocused:(0,t.css)`
      label: rowFocused;
      background-color: ${(0,l.R)(ke,"#cbe7ff")};
      animation: ${Ze.flash} 1s cubic-bezier(0.12, 0, 0.39, 0);
      & .${gs}, .${js}, .${ps} {
        background-color: ${(0,l.R)(ke,"#cbe7ff")};
        animation: ${Ze.flash} 1s cubic-bezier(0.12, 0, 0.39, 0);
      }
      & .${Ts} {
        opacity: 1;
      }
      & .${Es} {
        color: ${(0,l.R)(ke,"#000")};
      }
      &:hover .${gs}, :hover .${js} {
        background: ${(0,l.R)(ke,"#d5ebff")};
        box-shadow: 0 1px 0 ${(0,l.R)(ke,"#ddd")};
      }
    `,rowExpandedAndMatchingFilter:(0,t.css)`
      label: rowExpandedAndMatchingFilter;
      &:hover .${js} {
        background: ${(0,l.R)(ke,"#ffeccf")};
      }
    `,name:(0,t.css)`
      label: name;
      color: ${(0,l.R)(ke,"#000")};
      cursor: pointer;
      flex: 1 1 auto;
      outline: none;
      overflow-y: hidden;
      overflow-x: auto;
      padding-left: 4px;
      padding-right: 0.25em;
      position: relative;
      -ms-overflow-style: none;
      scrollbar-width: none;
      &::-webkit-scrollbar {
        display: none;
      }
      &:focus {
        text-decoration: none;
      }
      &:hover > span {
        color: ${(0,l.R)(ke,"#000")};
      }
      text-align: left;
      background: transparent;
      border: none;
      border-bottom-width: 1px;
      border-bottom-style: solid;
    `,nameDetailExpanded:(0,t.css)`
      label: nameDetailExpanded;
      &::before {
        bottom: 0;
      }
    `,svcName:(0,t.css)`
      label: svcName;
      font-size: 0.9em;
      font-weight: bold;
      margin-right: 0.25rem;
    `,svcNameChildrenCollapsed:(0,t.css)`
      label: svcNameChildrenCollapsed;
      font-weight: bold;
      font-style: italic;
    `,errorIcon:(0,t.css)`
      label: errorIcon;
      border-radius: 6.5px;
      color: ${(0,l.R)(ke,"#fff")};
      font-size: 0.85em;
      margin-right: 0.25rem;
      padding: 1px;
    `,rpcColorMarker:(0,t.css)`
      label: rpcColorMarker;
      border-radius: 6.5px;
      display: inline-block;
      font-size: 0.85em;
      height: 1em;
      margin-right: 0.25rem;
      padding: 1px;
      width: 1em;
      vertical-align: middle;
    `,labelRight:(0,t.css)`
      label: labelRight;
      left: 100%;
    `,labelLeft:(0,t.css)`
      label: labelLeft;
      right: 100%;
    `}});class nr extends n.PureComponent{constructor(){super(...arguments),this._detailToggle=()=>{this.props.onDetailToggled(this.props.span.spanID)},this._childrenToggle=()=>{this.props.onChildrenToggled(this.props.span.spanID)},this.getSpanBarLabel=(Ye,Ze,ct)=>{const It=Ze?.type??"";if(It===Oe)return"";if(It===""||It===Me)return`(${ct})`;if(It===Ue){const Ht=Ze?.tag?.trim()??"";if(Ht!==""&&Ye.tags){const tn=Ye.tags?.find(yn=>yn.key===Ht);if(tn)return`(${tn.value})`;const dn=Ye.process?.tags?.find(yn=>yn.key===Ht);if(dn)return`(${dn.value})`}}return""}}static{this.displayName="UnthemedSpanBarRow"}static{this.defaultProps={className:"",rpc:null}}render(){const{className:Ye,color:Ze,spanBarOptions:ct,columnDivision:It,isChildrenExpanded:Ht,isDetailExpanded:tn,isMatchingFilter:dn,showSpanFilterMatchesOnly:yn,isFocused:Rn,numTicks:Yn,rpc:qn,noInstrumentedServer:Jn,showErrorIcon:ca,getViewedBounds:Oa,traceStartTime:ma,span:$a,hoverIndentGuideIds:He,addHoverIndentGuideId:Ie,removeHoverIndentGuideId:je,clippingLeft:tt,clippingRight:St,theme:$t,createSpanLink:Yt,datasourceType:pn,showServiceName:Bn,visibleSpanIds:Cn,criticalPath:Xn}=this.props,{duration:na,hasChildren:va,operationName:ba,process:{serviceName:fa}}=$a,Ga=(0,g.a3)(na),Ta=Oa($a.startTime,$a.startTime+$a.duration),Fa=Ta.start,$n=Ta.end,ta=Qr($t,yn),Zn=`${fa}::${ba}`;let La,us;return Fa>1-$n?(La=`${Zn} | ${Ga}`,us=ta.labelLeft):(La=`${Ga} | ${Zn}`,us=ta.labelRight),n.createElement(V,{className:E()(ta.row,{[ta.rowExpanded]:tn,[ta.rowMatchingFilter]:dn,[ta.rowExpandedAndMatchingFilter]:dn&&tn,[ta.rowFocused]:Rn,[ta.rowClippingLeft]:tt,[ta.rowClippingRight]:St},Ye)},n.createElement(V.Cell,{className:E()(ta.nameColumn,As),width:It},n.createElement("div",{className:E()(ta.nameWrapper,gs,{[ta.nameWrapperMatchingFilter]:dn,nameWrapperMatchingFilter:dn})},n.createElement(Fs,{onClick:va?this._childrenToggle:void 0,childrenVisible:Ht,span:$a,hoverIndentGuideIds:He,addHoverIndentGuideId:Ie,removeHoverIndentGuideId:je,visibleSpanIds:Cn}),n.createElement("button",{type:"button",className:E()(ta.name,{[ta.nameDetailExpanded]:tn}),"aria-checked":tn,title:Zn,onClick:this._detailToggle,role:"switch",style:{background:`${Ze}10`,borderBottomColor:`${Ze}CF`},tabIndex:0},ca&&n.createElement(xe.I,{name:"exclamation-circle",style:{backgroundColor:$a.errorIconColor?(0,l.R)($t,$a.errorIconColor):(0,l.R)($t,"#db2828")},className:ta.errorIcon}),Bn&&n.createElement("span",{className:E()(ta.svcName,{[ta.svcNameChildrenCollapsed]:va&&!Ht})},`${fa} `),qn&&n.createElement("span",null,n.createElement(xe.I,{name:"arrow-right"})," ",n.createElement("i",{className:ta.rpcColorMarker,style:{background:qn.color}}),qn.serviceName),Jn&&n.createElement("span",null,n.createElement(xe.I,{name:"arrow-right"})," ",n.createElement("i",{className:ta.rpcColorMarker,style:{background:Jn.color}}),Jn.serviceName),n.createElement("span",{className:ta.endpointName},qn?qn.operationName:ba),n.createElement("span",{className:ta.endpointName}," ",this.getSpanBarLabel($a,ct,Ga))),Yt&&(()=>{const ts=Yt($a),Hs=ts?.length||0;return ts&&Hs===1?ts[0]?n.createElement("a",{href:ts[0].href,target:"_blank",style:{background:`${Ze}10`,borderBottom:`1px solid ${Ze}CF`,paddingRight:"4px"},rel:"noopener noreferrer",onClick:ts[0].onClick?Da=>{!(Da.ctrlKey||Da.metaKey||Da.shiftKey)&&ts[0].onClick&&(Da.preventDefault(),ts[0].onClick(Da))}:void 0},ts[0].content):null:ts&&Hs>1?n.createElement(Va,{links:ts,datasourceType:pn,color:Ze}):null})())),n.createElement(V.Cell,{className:E()(ta.view,js,{[ta.viewExpanded]:tn,[ta.viewExpandedAndMatchingFilter]:dn&&tn}),"data-testid":"span-view",style:{cursor:"pointer"},width:1-It,onClick:this._detailToggle},n.createElement(w,{numTicks:Yn}),n.createElement(Wa,{criticalPath:Xn,rpc:qn,viewStart:Fa,viewEnd:$n,getViewedBounds:Oa,color:Ze,shortLabel:Ga,longLabel:La,traceStartTime:ma,span:$a,labelClassName:`${Es} ${us}`,className:Ts})))}}const hr=(0,m.cV)(nr),ar=(0,o.N)(ke=>({expandedAccent:(0,t.css)`
      cursor: pointer;
      height: 100%;
      overflow: hidden;
      position: absolute;
      width: 100%;
      &::before {
        border-left: 1px solid;
        pointer-events: none;
        width: 1000px;
      }
      &::after {
        border-right: 1000px solid;
        border-color: inherit;
        cursor: pointer;
        opacity: 0.2;
      }

      /* border-color inherit must come AFTER other border declarations for accent */
      &::before,
      &::after {
        border-color: inherit;
        content: ' ';
        position: absolute;
        height: 100%;
      }

      &:hover::after {
        opacity: 0.35;
      }
    `,infoWrapper:(0,t.css)`
      label: infoWrapper;
      border: 1px solid ${(0,l.R)(ke,"#d3d3d3")};
      border-top: 3px solid;
      padding: 0.75rem;
    `}));class Yr extends n.PureComponent{constructor(){super(...arguments),this._detailToggle=()=>{this.props.onDetailToggled(this.props.span.spanID)},this._linksGetter=(Ye,Ze)=>{const{linksGetter:ct,span:It}=this.props;return ct(It,Ye,Ze)}}render(){const{color:Ye,columnDivision:Ze,detailState:ct,logItemToggle:It,logsToggle:Ht,processToggle:tn,referenceItemToggle:dn,referencesToggle:yn,warningsToggle:Rn,stackTracesToggle:Yn,span:qn,traceToProfilesOptions:Jn,timeZone:ca,tagsToggle:Oa,traceStartTime:ma,traceDuration:$a,traceName:He,hoverIndentGuideIds:Ie,addHoverIndentGuideId:je,removeHoverIndentGuideId:tt,theme:St,createSpanLink:$t,focusedSpanId:Yt,createFocusSpanLink:pn,datasourceType:Bn,visibleSpanIds:Cn,traceFlameGraphs:Xn,setTraceFlameGraphs:na,setRedrawListView:va}=this.props,ba=ar(St);return n.createElement(V,null,n.createElement(V.Cell,{width:Ze,style:{overflow:"hidden"}},n.createElement(Fs,{span:qn,showChildrenIcon:!1,hoverIndentGuideIds:Ie,addHoverIndentGuideId:je,removeHoverIndentGuideId:tt,visibleSpanIds:Cn}),n.createElement(at.$n,{fill:"text",onClick:this._detailToggle,className:E()(ba.expandedAccent,(0,at.my)(St)),style:{borderColor:Ye},"data-testid":"detail-row-expanded-accent"})),n.createElement(V.Cell,{width:1-Ze},n.createElement("div",{className:ba.infoWrapper,style:{borderTopColor:Ye}},n.createElement(Jt,{detailState:ct,linksGetter:this._linksGetter,logItemToggle:It,logsToggle:Ht,processToggle:tn,referenceItemToggle:dn,referencesToggle:yn,warningsToggle:Rn,stackTracesToggle:Yn,span:qn,traceToProfilesOptions:Jn,timeZone:ca,tagsToggle:Oa,traceStartTime:ma,traceDuration:$a,traceName:He,createSpanLink:$t,focusedSpanId:Yt,createFocusSpanLink:pn,datasourceType:Bn,traceFlameGraphs:Xn,setTraceFlameGraphs:na,setRedrawListView:va}))))}}const Qs=(0,m.cV)(Yr),cs=(0,o.N)(()=>({rowsWrapper:(0,t.css)`
      width: 100%;
    `,row:(0,t.css)`
      width: 100%;
    `,scrollToTopButton:(0,t.css)`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 40px;
      height: 40px;
      position: absolute;
      bottom: 30px;
      right: 30px;
      z-index: 1;
    `})),_s={bar:28,detail:161,detailWithLogs:197},Ys=5,sr=33;function Kr(ke,Ye,Ze,ct,It,Ht,tn){if(!ke)return[];It&&ct&&(ke=ke.filter(Rn=>ct.has(Rn.spanID))),Ht&&tn&&(ke=ke.filter(Rn=>tn.find(Yn=>Yn.spanId===Rn.spanID)));let dn=null;const yn=[];for(let Rn=0;Rn<ke.length;Rn++){const Yn=ke[Rn],{spanID:qn,depth:Jn}=Yn;let ca=!1;dn!=null&&(Jn>=dn?ca=!0:dn=null),!ca&&(Ye.has(qn)&&(dn=Jn+1),yn.push({span:Yn,isDetail:!1,spanIndex:Rn}),Ze.has(qn)&&yn.push({span:Yn,isDetail:!0,spanIndex:Rn}))}return yn}function io(ke){const[Ye,Ze]=ke;return{left:Ye>0,right:Ze<1}}function Mo(ke,Ye,Ze,ct,It,Ht,tn){return ke?Kr(ke.spans,Ye,Ze,ct,It,Ht,tn):[]}function cr(ke){const Ye=new Map;return ke&&ke.spans.forEach(Ze=>{Ze.childSpanIds.length&&Ye.set(Ze.spanID,Ze.childSpanIds)}),Ye}const lo=(0,Te.A)(Mo),Jr=(0,Te.A)(h,fe.isEqual),co=(0,Te.A)(io,fe.isEqual),Rr=(0,Te.A)(cr);class Ho extends n.Component{constructor(){super(...arguments),this.hasScrolledToSpan=!1,this.getViewRange=()=>this.props.currentViewRangeTime,this.getSearchedSpanIDs=()=>this.props.findMatchesIDs,this.getCollapsedChildren=()=>this.props.childrenHiddenIDs,this.mapRowIndexToSpanIndex=Ye=>this.getRowStates()[Ye].spanIndex,this.mapSpanIndexToRowIndex=Ye=>{const Ze=this.getRowStates().length;for(let ct=0;ct<Ze;ct++){const{spanIndex:It}=this.getRowStates()[ct];if(It===Ye)return ct}throw new Error(`unable to find row for span index: ${Ye}`)},this.setListView=Ye=>{this.listView=Ye},this.getKeyFromIndex=Ye=>{const{isDetail:Ze,span:ct}=this.getRowStates()[Ye];return`${ct.traceID}--${ct.spanID}--${Ze?"detail":"bar"}`},this.getIndexFromKey=Ye=>{const Ze=Ye.split("--"),ct=Ze[0],It=Ze[1],Ht=Ze[2]==="detail",tn=this.getRowStates().length;for(let dn=0;dn<tn;dn++){const{span:yn,isDetail:Rn}=this.getRowStates()[dn];if(yn.spanID===It&&yn.traceID===ct&&Rn===Ht)return dn}return-1},this.getRowHeight=Ye=>{const{span:Ze,isDetail:ct}=this.getRowStates()[Ye];return ct?Array.isArray(Ze.logs)&&Ze.logs.length?_s.detailWithLogs:_s.detail:_s.bar},this.renderRow=(Ye,Ze,ct,It)=>{const{isDetail:Ht,span:tn,spanIndex:dn}=this.getRowStates()[ct],yn=Math.max((this.listView?.getTopVisibleIndex()||0)-sr,0),Rn=(this.listView?.getBottomVisibleIndex()||0)+sr,Yn=this.getVisibleSpanIds(yn,Rn);return Ht?this.renderSpanDetailRow(tn,Ye,Ze,It,Yn):this.renderSpanBarRow(tn,dn,Ye,Ze,It,Yn)},this.scrollToSpan=(Ye,Ze)=>{if(Ze==null)return;const ct=this.getRowStates().findIndex(It=>It.span.spanID===Ze);ct>=0&&this.listView?.scrollToIndex(ct,Ye)},this.scrollToTop=()=>{const{topOfViewRef:Ye,datasourceType:Ze,trace:ct}=this.props;Ye?.current?.scrollIntoView({behavior:"smooth"}),(0,s.rR)("grafana_traces_trace_view_scroll_to_top_clicked",{datasourceType:Ze,grafana_version:r.$.buildInfo.version,numServices:ct.services.length,numSpans:ct.spans.length})},this.getVisibleSpanIds=(0,Te.A)((Ye,Ze)=>{const ct=[];for(let It=Ye;It<Ze;It++){const Ht=this.getRowStates()[It];Ht?.span&&ct.push(Ht.span.spanID)}return ct})}componentDidMount(){this.scrollToSpan(this.props.headerHeight,this.props.focusedSpanId)}shouldComponentUpdate(Ye){let Ze;for(Ze in Ye)if(Ye[Ze]!==this.props[Ze])return!0;return!1}componentDidUpdate(Ye){const{headerHeight:Ze,focusedSpanId:ct,focusedSpanIdForSearch:It}=this.props;this.hasScrolledToSpan||(this.scrollToSpan(Ze,ct),this.hasScrolledToSpan=!0),ct!==Ye.focusedSpanId&&this.scrollToSpan(Ze,ct),It!==Ye.focusedSpanIdForSearch&&this.scrollToSpan(Ze,It)}getRowStates(){const{childrenHiddenIDs:Ye,detailStates:Ze,trace:ct,findMatchesIDs:It,showSpanFilterMatchesOnly:Ht,showCriticalPathSpansOnly:tn,criticalPath:dn}=this.props;return lo(ct,Ye,Ze,It,Ht,tn,dn)}getClipping(){const{currentViewRangeTime:Ye}=this.props;return co(Ye)}getViewedBounds(){const{currentViewRangeTime:Ye,trace:Ze}=this.props,[ct,It]=Ye;return Jr({min:Ze.startTime,max:Ze.endTime,viewStart:ct,viewEnd:It})}getChildSpansMap(){return Rr(this.props.trace)}getAccessors(){const Ye=this.listView;if(!Ye)throw new Error("ListView unavailable");return{getViewRange:this.getViewRange,getSearchedSpanIDs:this.getSearchedSpanIDs,getCollapsedChildren:this.getCollapsedChildren,getViewHeight:Ye.getViewHeight,getBottomRowIndexVisible:Ye.getBottomVisibleIndex,getTopRowIndexVisible:Ye.getTopVisibleIndex,getRowPosition:Ye.getRowPosition,mapRowIndexToSpanIndex:this.mapRowIndexToSpanIndex,mapSpanIndexToRowIndex:this.mapSpanIndexToRowIndex}}renderSpanBarRow(Ye,Ze,ct,It,Ht,tn){const{spanID:dn,childSpanIds:yn}=Ye,{serviceName:Rn}=Ye.process,{childrenHiddenIDs:Yn,childrenToggle:qn,detailStates:Jn,detailToggle:ca,findMatchesIDs:Oa,spanNameColumnWidth:ma,trace:$a,spanBarOptions:He,hoverIndentGuideIds:Ie,addHoverIndentGuideId:je,removeHoverIndentGuideId:tt,createSpanLink:St,focusedSpanId:$t,focusedSpanIdForSearch:Yt,showSpanFilterMatchesOnly:pn,theme:Bn,datasourceType:Cn,criticalPath:Xn}=this.props;if(!$a)return null;const na=(0,le.Kv)(Rn,Bn),va=Yn.has(dn),ba=Jn.has(dn),fa=Oa?Oa.has(dn):!1,Ga=dn===$t||dn===Yt,Ta=R(Ye)||va&&B($a.spans,Ze);let Fa=null;if(va){const Da=U($a.spans.slice(Ze));if(Da){const fr=this.getViewedBounds()(Da.startTime,Da.startTime+Da.duration);Fa={color:(0,le.Kv)(Da.process.serviceName,Bn),operationName:Da.operationName,serviceName:Da.process.serviceName,viewEnd:fr.end,viewStart:fr.start}}}const $n=Ye.tags.find(Da=>Da.key===de);let ta=null;!Ye.hasChildren&&$n&&W(Ye)&&(ta={serviceName:$n.value,color:(0,le.Kv)($n.value,Bn)});const Zn=Ze>0?$a.spans[Ze-1]:null,La=[dn,...yn],us=Da=>{Da.forEach(fr=>{const zr=this.getChildSpansMap().get(fr);zr?.length&&(La.push(...zr),us(zr))})};us(yn);const ts=Xn?.filter(Da=>va?La.includes(Da.spanId):Da.spanId===dn),Hs=cs();return n.createElement("div",{className:Hs.row,key:ct,style:It,...Ht},n.createElement(hr,{clippingLeft:this.getClipping().left,clippingRight:this.getClipping().right,color:na,spanBarOptions:He,columnDivision:ma,isChildrenExpanded:!va,isDetailExpanded:ba,isMatchingFilter:fa,isFocused:Ga,showSpanFilterMatchesOnly:pn,numTicks:Ys,onDetailToggled:ca,onChildrenToggled:qn,rpc:Fa,noInstrumentedServer:ta,showErrorIcon:Ta,getViewedBounds:this.getViewedBounds(),traceStartTime:$a.startTime,span:Ye,hoverIndentGuideIds:Ie,addHoverIndentGuideId:je,removeHoverIndentGuideId:tt,createSpanLink:St,datasourceType:Cn,showServiceName:Zn===null||Zn.process.serviceName!==Ye.process.serviceName,visibleSpanIds:tn,criticalPath:ts}))}renderSpanDetailRow(Ye,Ze,ct,It,Ht){const{spanID:tn}=Ye,{serviceName:dn}=Ye.process,{detailLogItemToggle:yn,detailLogsToggle:Rn,detailProcessToggle:Yn,detailReferencesToggle:qn,detailReferenceItemToggle:Jn,detailWarningsToggle:ca,detailStackTracesToggle:Oa,detailStates:ma,detailTagsToggle:$a,detailToggle:He,spanNameColumnWidth:Ie,trace:je,traceToProfilesOptions:tt,timeZone:St,hoverIndentGuideIds:$t,addHoverIndentGuideId:Yt,removeHoverIndentGuideId:pn,linksGetter:Bn,createSpanLink:Cn,focusedSpanId:Xn,createFocusSpanLink:na,theme:va,datasourceType:ba,traceFlameGraphs:fa,setTraceFlameGraphs:Ga,setRedrawListView:Ta}=this.props,Fa=ma.get(tn);if(!je||!Fa)return null;const $n=(0,le.Kv)(dn,va),ta=cs();return n.createElement("div",{className:ta.row,key:Ze,style:{...ct,zIndex:1},...It},n.createElement(Qs,{color:$n,columnDivision:Ie,onDetailToggled:He,detailState:Fa,linksGetter:Bn,logItemToggle:yn,logsToggle:Rn,processToggle:Yn,referenceItemToggle:Jn,referencesToggle:qn,warningsToggle:ca,stackTracesToggle:Oa,span:Ye,traceToProfilesOptions:tt,timeZone:St,tagsToggle:$a,traceStartTime:je.startTime,traceDuration:je.duration,traceName:je.traceName,hoverIndentGuideIds:$t,addHoverIndentGuideId:Yt,removeHoverIndentGuideId:pn,createSpanLink:Cn,focusedSpanId:Xn,createFocusSpanLink:na,datasourceType:ba,visibleSpanIds:Ht,traceFlameGraphs:fa,setTraceFlameGraphs:Ga,setRedrawListView:Ta}))}render(){const Ye=cs(),{scrollElement:Ze,redrawListView:ct}=this.props;return n.createElement(n.Fragment,null,n.createElement(be,{ref:this.setListView,dataLength:this.getRowStates().length,itemHeightGetter:this.getRowHeight,itemRenderer:this.renderRow,viewBuffer:sr,viewBufferMin:sr,itemsWrapperClassName:Ye.rowsWrapper,getKeyFromIndex:this.getKeyFromIndex,getIndexFromKey:this.getIndexFromKey,windowScroller:!1,scrollElement:Ze,redraw:ct}),this.props.topOfViewRef&&n.createElement(he.I,{className:Ye.scrollToTopButton,onClick:this.scrollToTop,title:"Scroll to top",icon:"arrow-up"}))}}const Xr=(0,m.cV)(Ho),xo=(0,o.N)(ke=>({TraceTimelineViewer:(0,t.css)`
      label: TraceTimelineViewer;
      border-bottom: 1px solid ${(0,l.R)(ke,"#bbb")};

      & .json-markup {
        line-height: 17px;
        font-size: 13px;
        font-family: monospace;
        white-space: pre-wrap;
      }

      & .json-markup-key {
        font-weight: bold;
      }

      & .json-markup-bool {
        color: ${(0,l.R)(ke,"firebrick")};
      }

      & .json-markup-string {
        color: ${(0,l.R)(ke,"teal")};
      }

      & .json-markup-null {
        color: ${(0,l.R)(ke,"teal")};
      }

      & .json-markup-number {
        color: ${(0,l.R)(ke,"blue","black")};
      }
    `})),Ur=5;class Js extends n.PureComponent{constructor(Ye){super(Ye),this.collapseAll=()=>{this.props.collapseAll(this.props.trace.spans),(0,s.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"collapseAll"})},this.collapseOne=()=>{this.props.collapseOne(this.props.trace.spans),(0,s.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"collapseOne"})},this.expandAll=()=>{this.props.expandAll(),(0,s.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"expandAll"})},this.expandOne=()=>{this.props.expandOne(this.props.trace.spans),(0,s.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"expandOne"})},this.state={height:0}}componentDidMount(){f({collapseAll:this.collapseAll,expandAll:this.expandAll,collapseOne:this.collapseOne,expandOne:this.expandOne})}render(){const{setSpanNameColumnWidth:Ye,updateNextViewRangeTime:Ze,updateViewRangeTime:ct,viewRange:It,traceTimeline:Ht,theme:tn,topOfViewRef:dn,focusedSpanIdForSearch:yn,...Rn}=this.props,{trace:Yn}=Rn,qn=xo(tn);return n.createElement("div",{className:qn.TraceTimelineViewer,ref:Jn=>Jn&&this.setState({height:Jn.getBoundingClientRect().height})},n.createElement(ue,{duration:Yn.duration,nameColumnWidth:Ht.spanNameColumnWidth,numTicks:Ur,onCollapseAll:this.collapseAll,onCollapseOne:this.collapseOne,onColummWidthChange:Ye,onExpandAll:this.expandAll,onExpandOne:this.expandOne,viewRangeTime:It.time,updateNextViewRangeTime:Ze,updateViewRangeTime:ct,columnResizeHandleHeight:this.state.height}),n.createElement(Xr,{...Rn,...Ht,setSpanNameColumnWidth:Ye,currentViewRangeTime:It.time.current,topOfViewRef:dn,focusedSpanIdForSearch:yn,datasourceType:this.props.datasourceType}))}}const uo=(0,m.cV)(Js);var mo=e(39938);const fo=()=>({NewWindowIconLarge:(0,t.css)`
      label: NewWindowIconLarge;
      font-size: 1.5em;
    `});function Vr({isLarge:ke=!1,className:Ye}){const Ze=(0,m.of)(fo),ct=E()({[Ze.NewWindowIconLarge]:ke},Ye);return n.createElement(xe.I,{className:ct,name:"anchor"})}const Oo=ke=>n.createElement("a",{href:ke.href,title:ke.title,target:"_blank",rel:"noopener noreferrer",className:ke.className},ke.children," ",n.createElement(Vr,null));function vr(ke){const{links:Ye}=ke;return n.createElement(Oo,{href:Ye[0].url,title:Ye[0].text,className:ke.className})}const Pt=100,Gt="<trace-without-root-span>",Pn=()=>({BreakableText:(0,t.css)`
      label: BreakableText;
      display: inline-block;
      white-space: pre;
    `}),hn=/\W*\w+\W*/g;function Ln({text:ke,className:Ye,wordRegexp:Ze=hn}){const ct=(0,m.of)(Pn);if(!ke)return null;const It=[];Ze.exec("");let Ht=Ze.exec(ke)||[ke];for(;Ht;)It.push(n.createElement("span",{key:`${ke}-${It.length}`,className:Ye||ct.BreakableText},Ht[0])),Ht=Ze.exec(ke);return n.createElement(n.Fragment,null,It)}const Hn=ke=>({TraceName:(0,t.css)`
      label: TraceName;
      font-size: ${ke.typography.size.lg};
    `});function kn(ke){const{className:Ye,traceName:Ze}=ke,ct=(0,m.of)(Hn),It=String(Ze||Gt),Ht=n.createElement(Ln,{text:It});return n.createElement("span",{className:E()(ct.TraceName,Ye)},Ht)}var xa=e(40784);const ua=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:Pt,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function ra(){return ua}function os(ke){return(0,fe.get)(ra(),ke)}const Ra=/#\{([^{}]*)\}/g;function es(ke){const Ye=new Set;return ke.replace(Ra,(Ze,ct)=>(Ye.add(ct),Ze)),Array.from(Ye)}function zs(ke,Ye,Ze){return ke.replace(Ra,(ct,It)=>{const Ht=Ze[It];return Ht==null?"":Ye(Ht)})}function Ws(ke,Ye){if(typeof ke!="string")throw new Error("Invalid template");return{parameters:es(ke),template:zs.bind(null,ke,Ye)}}function Rs(ke){if(typeof ke=="string")return Ye=>Ye===ke;if(Array.isArray(ke))return Ye=>ke.indexOf(Ye)>-1;if(ke==null)return()=>!0;throw new Error(`Invalid value: ${ke}`)}const xr=ke=>ke;function dr(ke){try{const Ye=Ws(ke.url,encodeURIComponent),Ze=Ws(ke.text,xr);return{object:ke,type:Rs(ke.type),key:Rs(ke.key),value:Rs(ke.value),url:Ye,text:Ze,parameters:(0,fe.uniq)(Ye.parameters.concat(Ze.parameters))}}catch(Ye){return console.error(`Ignoring invalid link pattern: ${Ye}`,ke),null}}function Us(ke,Ye){return ke.template(Ye)}function $r(ke,Ye){const Ze=[],ct=Object.keys(Ye).filter(It=>typeof Ye[It]=="string"||Ye[It]==="number");return ke?.filter(It=>It?.type("traces")).forEach(It=>{const Ht={};It?.parameters.every(dn=>{const yn=dn;return ct.includes(yn)?(Ht[dn]=Ye[yn],!0):!1})&&Ze.push({url:Us(It.url,Ht),text:Us(It.text,Ht)})}),Ze}const ks=(os("linkPatterns")||[]).map(dr).filter(ke=>!!ke),Ka=(0,xa.A)(10)(ke=>{const Ye=[];return ke?$r(ks,ke):Ye});function ys(ke){let Ye;const Ze=new Set(ke.map(({spanID:ct})=>ct));for(let ct=0;ct<ke.length;ct++){if(ke[ct].references&&ke[ct].references.some(({traceID:dn,spanID:yn})=>dn===ke[ct].traceID&&Ze.has(yn)))continue;if(!Ye){Ye=ke[ct];continue}const Ht=ke[ct].references&&ke[ct].references.length||0,tn=Ye.references&&Ye.references.length||0;(Ht<tn||Ht===tn&&ke[ct].startTime<Ye.startTime)&&(Ye=ke[ct])}return Ye?`${Ye.process.serviceName}: ${Ye.operationName}`:""}const Er=(0,fe.memoize)(ys,ke=>ke.length?ke[0].traceID:0);function ds(ke){for(let Ye=0;Ye<ke.length;Ye++){const Ze=ke[Ye].tags.filter(Ht=>Ht.key==="http.request.method"),ct=ke[Ye].tags.filter(Ht=>Ht.key==="http.response.status_code"),It=ke[Ye].tags.filter(Ht=>Ht.key==="http.route");if(Ze.length>0||ct.length>0||It.length>0)return{method:Ze,status:ct,url:It}}for(let Ye=0;Ye<ke.length;Ye++){const Ze=ke[Ye].tags.filter(Ht=>Ht.key==="http.method"),ct=ke[Ye].tags.filter(Ht=>Ht.key==="http.status_code"),It=ke[Ye].tags.filter(Ht=>Ht.key==="http.url"||Ht.key==="http.target"||Ht.key==="http.path");if(Ze.length>0||ct.length>0||It.length>0)return{method:Ze,status:ct,url:It}}return{}}const Zr=(0,fe.memoize)(ds,ke=>ke.length?ke[0].traceID:0);var go=e(2913),Io=e(18358);const Ao=ke=>({ActionButton:(0,t.css)`
      label: ActionButton;
      overflow: hidden;
      position: relative;
      &:after {
        content: '';
        background: ${ke.colors.primary.main};
        display: block;
        position: absolute;
        right: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: all 0.8s;
      }
      &:active:after {
        margin: 0;
        opacity: 0.3;
        transition: 0s;
      }
    `});function Go(ke){const{onClick:Ye,ariaLabel:Ze,label:ct,icon:It}=ke,Ht=(0,m.of)(Ao);return n.createElement(at.$n,{className:Ht.ActionButton,size:"sm",variant:"secondary",fill:"outline",type:"button",icon:It,"aria-label":Ze,onClick:Ye},ct)}const _i=ke=>({TracePageActions:(0,t.css)({label:"TracePageActions",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",marginBottom:"10px"}),feedback:(0,t.css)({margin:"6px 6px 6px 0",color:ke.colors.text.secondary,fontSize:ke.typography.bodySmall.fontSize,"&:hover":{color:ke.colors.text.link}})});function bi(ke){const{traceId:Ye,data:Ze,app:ct}=ke,It=(0,m.$j)(),Ht=_i(It),[tn,dn]=(0,n.useState)(!1),yn=()=>{navigator.clipboard.writeText(Ye),dn(!0),setTimeout(()=>{dn(!1)},5e3)},Rn=()=>{const Yn=(0,Io.ek)(Ze,"Trace-"+Ye.substring(Ye.length-6));(0,s.rR)("grafana_traces_download_traces_clicked",{app:ct,grafana_version:go.config.buildInfo.version,trace_format:Yn,location:"trace-view"})};return n.createElement("div",{className:Ht.TracePageActions},n.createElement("a",{href:"https://forms.gle/RZDEx8ScyZNguDoC8",className:Ht.feedback,title:"Share your thoughts about tracing in Grafana.",target:"_blank",rel:"noreferrer noopener"},n.createElement(xe.I,{name:"comment-alt-message"})," Give feedback"),n.createElement(Go,{onClick:yn,ariaLabel:"Copy Trace ID",label:tn?"Copied!":"Trace ID",icon:"copy"}),n.createElement(Go,{onClick:Rn,ariaLabel:"Export Trace",label:"Export",icon:"save"}))}var ur=e(50877),ri=e(3721),zi=e(40996),Ss=e(14186),po=e(10354);const Ro=/^(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])$/,Ci=(ke,Ye)=>!(ke.match(Ye)||!ke),Lo=ke=>{const Ye=ke.validationRegex||Ro,[Ze,ct]=(0,n.useState)(()=>ke.value?Ci(ke.value,Ye):!1);(0,zi.A)(()=>{ct(Ci(ke.value,Ye))},500,[ke.value]);const It={labelWidth:26,disabled:ke.disabled??!1,invalid:Ze,error:ke.isInvalidError};return ke.label&&(It.label=ke.label,It.tooltip=ke.tooltip||""),n.createElement(Ss.I,{...It},n.createElement(po.p,{type:"text",placeholder:ke.placeholder||"0",width:ke.width||40,onChange:Ht=>{ke.onChange(Ht.currentTarget.value)},value:ke.value,"aria-label":ke.ariaLabel||"interval input"}))};var Bo=e(82762),jo=e(39268),Nr=e(66864),Ns=e(21594),oi=e(15583);class ki extends n.PureComponent{constructor(){super(...arguments),this.clearUiFind=()=>{this.props.onChange("")}}static{this.defaultProps={value:void 0}}render(){const{value:Ye}=this.props,Ze=n.createElement(n.Fragment,null,Ye&&Ye.length&&n.createElement(k.K,{name:"times",onClick:this.clearUiFind,tooltip:"Clear input"}));return n.createElement("div",{style:{width:"200px"}},n.createElement(po.p,{placeholder:"Find...",onChange:ct=>this.props.onChange(ct.currentTarget.value),suffix:Ze,value:Ye}))}}const Ti=(0,n.memo)(function(Ye){const{trace:Ze,spanFilterMatches:ct,setFocusedSpanIdForSearch:It,focusedSpanIndexForSearch:Ht,setFocusedSpanIndexForSearch:tn,datasourceType:dn,showSpanFilters:yn}=Ye,Rn=Hi((0,m.$j)(),yn);(0,n.useEffect)(()=>{if(ct&&Ht!==-1){const tt=Array.from(ct);It(tt[Ht])}},[Ht,It,ct]);const Yn=(tt,St)=>{if(tt.preventDefault(),tt.stopPropagation(),St){if((0,s.rR)("grafana_traces_trace_view_find_next_prev_clicked",{datasourceType:dn,grafana_version:r.$.buildInfo.version,direction:"next"}),Ht===-1||ct&&Ht===ct.size-1){tn(0);return}tn(Ht+1)}},qn=(tt,St)=>{if(tt.preventDefault(),tt.stopPropagation(),St){if((0,s.rR)("grafana_traces_trace_view_find_next_prev_clicked",{datasourceType:dn,grafana_version:r.$.buildInfo.version,direction:"prev"}),ct&&(Ht===-1||Ht===0)){tn(ct.size-1);return}tn(Ht-1)}},Jn=(tt,St)=>{tt.key==="Enter"&&Yn(tt,St)},ca=(tt,St)=>{tt.key==="Enter"&&qn(tt,St)},Oa=(ct&&ct?.size>0)??!1,ma=Oa?Rn.button:(0,t.cx)(Rn.button,Rn.buttonDisabled),$a=(0,n.useCallback)(tt=>n.createElement($e.m,{content:tt,placement:"top"},n.createElement("span",{className:Rn.tooltip},n.createElement(xe.I,{name:"info-circle",size:"md"}))),[Rn.tooltip]),He=(0,n.useCallback)((tt,St)=>{let $t=n.createElement(n.Fragment,null,n.createElement("span",null,`${Ze.spans.length} spans`),$a(n.createElement(n.Fragment,null,n.createElement("div",null,"Services: ",St),n.createElement("div",null,"Depth: ",tt))));if(ct)if(ct.size===0)$t=n.createElement(n.Fragment,null,n.createElement("span",null,"0 matches"),$a("There are 0 span matches for the filters selected. Please try removing some of the selected filters."));else{const Yt=ct.size===1?"match":"matches",pn=Ht!==-1?`${Ht+1}/${ct.size} ${Yt}`:`${ct.size} ${Yt}`,Bn=[];ct.forEach(Cn=>{Ze.processes[Cn]&&Bn.push(Ze.processes[Cn].serviceName)}),$t=n.createElement(n.Fragment,null,n.createElement("span",null,pn),$a(n.createElement(n.Fragment,null,n.createElement("div",null,"Services: ",new Set(Bn).size,"/",St),n.createElement("div",null,"Depth: ",tt))))}return $t},[Ht,$a,ct,Ze.processes,Ze.spans]),Ie=new Set((0,fe.values)(Ze.processes).map(tt=>tt.serviceName)).size,je=(0,fe.get)((0,fe.maxBy)(Ze.spans,"depth"),"depth",0)+1;return n.createElement(n.Fragment,null,n.createElement("span",{className:Rn.matches},He(je,Ie)),n.createElement("div",{className:Oa?Rn.buttons:(0,t.cx)(Rn.buttons,Rn.buttonsDisabled)},n.createElement("div",{"aria-label":"Prev result button",className:ma,onClick:tt=>qn(tt,Oa),onKeyDown:tt=>ca(tt,Oa),role:"button",tabIndex:Oa?0:-1},"Prev"),n.createElement("div",{"aria-label":"Next result button",className:ma,onClick:tt=>Yn(tt,Oa),onKeyDown:tt=>Jn(tt,Oa),role:"button",tabIndex:Oa?0:-1},"Next")))}),Hi=(ke,Ye)=>{const Ze=(0,at.hs)({theme:ke,variant:"secondary",size:Ye?"md":"sm",iconOnly:!1,fill:"outline"});return{buttons:(0,t.css)`
      display: inline-flex;
      gap: 4px;
    `,buttonsDisabled:(0,t.css)`
      cursor: not-allowed;
    `,button:(0,t.css)`
      ${Ze.button};
    `,buttonDisabled:(0,t.css)`
      ${Ze.disabled};
      pointer-events: none;
    `,matches:(0,t.css)`
      margin-right: ${ke.spacing(2)};
      text-wrap: nowrap;
    `,tooltip:(0,t.css)`
      color: #aaa;
      margin: 0 0 0 5px;
    `}};var Si=e(15292);function Mi(ke,Ye){if(!Ye)return;let Ze=!1;ke.serviceName&&(Ye=Qo(Ye,ke),Ze=!0),ke.spanName&&(Ye=qr(Ye,ke),Ze=!0),(ke.from||ke.to)&&(Ye=ji(Ye,ke),Ze=!0);const ct=ii(Ye,ke.tags);if(ct&&(Ye=ct,Ze=!0),ke.query){const It=Gi(ke.query,Ye);It&&(Ye=It,Ze=!0)}return Ze?new Set(Ye.map(It=>It.spanID)):void 0}function Gi(ke,Ye){if(!Ye)return;const Ze=[];ke.split(/\s+/).filter(Boolean).forEach(tn=>{Ze.push(tn.toLowerCase())});const ct=(tn,dn)=>tn.some(yn=>dn.toLowerCase().includes(yn)),It=tn=>tn?tn.some(dn=>ct(Ze,dn.key)||ct(Ze,dn.value.toString())):!1,Ht=tn=>ct(Ze,tn.operationName)||ct(Ze,tn.process.serviceName)||It(tn.tags)||tn.kind&&ct(Ze,tn.kind)||tn.statusCode!==void 0&&ct(Ze,it.s[tn.statusCode])||tn.statusMessage&&ct(Ze,tn.statusMessage)||tn.instrumentationLibraryName&&ct(Ze,tn.instrumentationLibraryName)||tn.instrumentationLibraryVersion&&ct(Ze,tn.instrumentationLibraryVersion)||tn.traceState&&ct(Ze,tn.traceState)||tn.logs!==null&&tn.logs.some(dn=>It(dn.fields))||It(tn.process.tags)||Ze.some(dn=>dn===tn.spanID);return Ye.filter(Ht)}const ii=(ke,Ye)=>{if(Ye=Ye.filter(Ze=>Ze.key&&Ze.key!==""||Ze.value),Ye.length>0)return ke.filter(Ze=>Ye.every(ct=>{if(ct.key&&ct.value){if(Ze.tags.some(It=>ho(ct,It))||Ze.process.tags.some(It=>ho(ct,It))||Ze.logs&&Ze.logs.some(It=>It.fields.some(Ht=>ho(ct,Ht)))||Ze.kind&&ct.key===Qt&&ct.value===Ze.kind||Ze.statusCode!==void 0&&ct.key===an&&ct.value===it.s[Ze.statusCode].toLowerCase()||Ze.statusMessage&&ct.key===gn&&ct.value===Ze.statusMessage||Ze.instrumentationLibraryName&&ct.key===ut&&ct.value===Ze.instrumentationLibraryName||Ze.instrumentationLibraryVersion&&ct.key===Nt&&ct.value===Ze.instrumentationLibraryVersion||Ze.traceState&&ct.key===ht&&ct.value===Ze.traceState||ct.key===Rt&&ct.value===Ze.spanID)return Uo(ct.operator,!0)}else if(ct.key&&(Ze.tags.some(It=>wr(ct.key,It.key))||Ze.process.tags.some(It=>wr(ct.key,It.key))||Ze.logs&&Ze.logs.some(It=>It.fields.some(Ht=>wr(ct.key,Ht.key)))||Ze.kind&&ct.key===Qt||Ze.statusCode!==void 0&&ct.key===an||Ze.statusMessage&&ct.key===gn||Ze.instrumentationLibraryName&&ct.key===ut||Ze.instrumentationLibraryVersion&&ct.key===Nt||Ze.traceState&&ct.key===ht||ct.key===Rt))return Uo(ct.operator,!0);return Uo(ct.operator,!1)}))},wr=(ke,Ye)=>ke===Ye.toString(),ho=(ke,Ye)=>ke.key===Ye.key.toString()&&ke.value===Ye.value.toString(),Uo=(ke,Ye)=>ke==="="?Ye:!Ye,Qo=(ke,Ye)=>ke.filter(Ze=>Ye.serviceNameOperator==="="?Ze.process.serviceName===Ye.serviceName:Ze.process.serviceName!==Ye.serviceName),qr=(ke,Ye)=>ke.filter(Ze=>Ye.spanNameOperator==="="?Ze.operationName===Ye.spanName:Ze.operationName!==Ye.spanName),ji=(ke,Ye)=>{const Ze=No(Ye?.from||""),ct=No(Ye?.to||"");let It=[];if(Ze&&(It=ke.filter(Ht=>Ye.fromOperator===">"?Ht.duration>Ze:Ht.duration>=Ze)),ct){const Ht=tn=>Ye.toOperator==="<"?tn.duration<ct:tn.duration<=ct;It=It.length>0?It.filter(tn=>Ht(tn)):ke.filter(tn=>Ht(tn))}return It},No=ke=>{if(ke.includes("ns"))return parseFloat(ke.split("ns")[0])/1e3;if(ke.includes("us"))return parseFloat(ke.split("us")[0]);if(ke.includes("\xB5s"))return parseFloat(ke.split("\xB5s")[0]);if(ke.includes("ms"))return parseFloat(ke.split("ms")[0])*1e3;if(ke.includes("s"))return parseFloat(ke.split("s")[0])*1e3*1e3;if(ke.includes("m"))return parseFloat(ke.split("m")[0])*1e3*1e3*60;if(ke.includes("h"))return parseFloat(ke.split("h")[0])*1e3*1e3*60*60},xi=(0,n.memo)(function(Ye){const{trace:Ze,search:ct,spanFilterMatches:It,showSpanFilterMatchesOnly:Ht,setShowSpanFilterMatchesOnly:tn,showCriticalPathSpansOnly:dn,setShowCriticalPathSpansOnly:yn,focusedSpanIndexForSearch:Rn,setFocusedSpanIndexForSearch:Yn,setFocusedSpanIdForSearch:qn,datasourceType:Jn,clear:ca,showSpanFilters:Oa}=Ye,ma=(0,m.of)(Yo),$a=(0,n.useMemo)(()=>ct.serviceName&&ct.serviceName!==""||ct.spanName&&ct.spanName!==""||No(ct.from||"")||No(ct.to||"")||ct.tags.length>1||ct.tags.some(He=>He.key)||ct.query&&ct.query!==""||Ht,[ct.serviceName,ct.spanName,ct.from,ct.to,ct.tags,ct.query,Ht]);return n.createElement("div",{className:ma.container},n.createElement("div",{className:ma.controls},n.createElement(n.Fragment,null,n.createElement("div",null,n.createElement(at.$n,{variant:"destructive",disabled:!$a,type:"button",fill:"outline","aria-label":"Clear filters button",onClick:ca},"Clear"),n.createElement("div",{className:ma.matchesOnly},n.createElement(Si.d,{value:Ht,onChange:He=>tn(He.currentTarget.checked??!1),label:"Show matches only switch",disabled:!It?.size}),n.createElement(at.$n,{onClick:()=>tn(!Ht),className:ma.clearMatchesButton,variant:"secondary",fill:"text",disabled:!It?.size},"Show matches only")),n.createElement("div",{className:ma.matchesOnly},n.createElement(Si.d,{value:dn,onChange:He=>yn(He.currentTarget.checked??!1),label:"Show critical path only switch"}),n.createElement(at.$n,{onClick:()=>yn(!dn),className:ma.clearMatchesButton,variant:"secondary",fill:"text"},"Show critical path only"))),n.createElement("div",{className:ma.nextPrevResult},n.createElement(Ti,{trace:Ze,spanFilterMatches:It,setFocusedSpanIdForSearch:qn,focusedSpanIndexForSearch:Rn,setFocusedSpanIndexForSearch:Yn,datasourceType:Jn,showSpanFilters:Oa})))))}),Yo=ke=>{const Ye=(0,at.hs)({theme:ke,variant:"secondary",size:"md",iconOnly:!1,fill:"outline"});return{button:(0,t.css)(Ye.button),buttonDisabled:(0,t.css)(Ye.disabled,{pointerEvents:"none",cursor:"not-allowed"}),container:(0,t.css)`
      display: inline;
    `,controls:(0,t.css)`
      display: flex;
      justify-content: flex-end;
      margin: 5px 0 0 0;
    `,matchesOnly:(0,t.css)`
      display: inline-flex;
      margin: 0 0 0 25px;
      vertical-align: middle;
      align-items: center;
    `,clearMatchesButton:(0,t.css)`
      color: ${ke.colors.text.primary};

      &:hover {
        background: inherit;
      }
    `,nextPrevResult:(0,t.css)`
      margin-left: auto;
      display: flex;
      align-items: center;
    `}},li=(0,n.memo)(ke=>{const{trace:Ye,search:Ze,setSearch:ct,showSpanFilters:It,setShowSpanFilters:Ht,showSpanFilterMatchesOnly:tn,setShowSpanFilterMatchesOnly:dn,showCriticalPathSpansOnly:yn,setShowCriticalPathSpansOnly:Rn,setFocusedSpanIdForSearch:Yn,spanFilterMatches:qn,datasourceType:Jn}=ke,ca={...(0,m.of)(rr)},[Oa,ma]=(0,n.useState)(),[$a,He]=(0,n.useState)(),[Ie,je]=(0,n.useState)(),[tt,St]=(0,n.useState)({}),[$t,Yt]=(0,n.useState)(-1),pn=/^\d+(?:\.\d)?\d*(?:ns|us|µs|ms|s|m|h)$/,Bn=(0,n.useCallback)(()=>{ma(void 0),He(void 0),je(void 0),St({}),ct(oi.Ji),dn(!1)},[ct,dn]);if((0,n.useEffect)(()=>{Bn()},[Bn,Ye]),!Ye)return null;const Cn=$n=>{Yt(-1),Yn(""),ct($n)},Xn=()=>{if(!Oa){const $n=Ye.spans.map(ta=>ta.process.serviceName);ma((0,fe.uniq)($n).sort().map(ur.z))}},na=()=>{if(!$a){const $n=Ye.spans.map(ta=>ta.operationName);He((0,fe.uniq)($n).sort().map(ur.z))}},va=()=>{if(!Ie){let $n=[],ta=[];Ye.spans.forEach(Zn=>{Zn.tags.forEach(La=>{$n.push(La.key)}),Zn.process.tags.forEach(La=>{$n.push(La.key)}),Zn.logs!==null&&Zn.logs.forEach(La=>{La.fields.forEach(us=>{ta.push(us.key)})}),Zn.kind&&$n.push(Qt),Zn.statusCode!==void 0&&$n.push(an),Zn.statusMessage&&$n.push(gn),Zn.instrumentationLibraryName&&$n.push(ut),Zn.instrumentationLibraryVersion&&$n.push(Nt),Zn.traceState&&$n.push(ht),$n.push(Rt)}),$n=(0,fe.uniq)($n).sort(),ta=(0,fe.uniq)(ta).sort(),je([...$n,...ta].map(ur.z))}},ba=async $n=>{const ta=[];return Ye.spans.forEach(Zn=>{const La=Zn.tags.find(ts=>ts.key===$n)?.value;La&&ta.push(La.toString());const us=Zn.process.tags.find(ts=>ts.key===$n)?.value;switch(us&&ta.push(us.toString()),Zn.logs!==null&&Zn.logs.forEach(ts=>{const Hs=ts.fields.find(Da=>Da.key===$n)?.value;Hs&&ta.push(Hs.toString())}),$n){case Qt:Zn.kind&&ta.push(Zn.kind);break;case an:Zn.statusCode!==void 0&&ta.push(it.s[Zn.statusCode].toLowerCase());break;case gn:Zn.statusMessage&&ta.push(Zn.statusMessage);break;case ut:Zn.instrumentationLibraryName&&ta.push(Zn.instrumentationLibraryName);break;case Nt:Zn.instrumentationLibraryVersion&&ta.push(Zn.instrumentationLibraryVersion);break;case ht:Zn.traceState&&ta.push(Zn.traceState);break;case Rt:ta.push(Zn.spanID);break;default:break}}),(0,fe.uniq)(ta).sort().map(ur.z)},fa=($n,ta)=>{ct({...Ze,tags:Ze.tags?.map(La=>La.id===$n.id?{...La,key:ta?.value||"",value:void 0}:La)}),(async()=>{if(ta?.value)St({...tt,[$n.id]:await ba(ta.value)});else{const La={...tt};La[$n.id]&&delete La[$n.id],St(La)}})()},Ga=()=>{const $n={id:(0,oi.zE)(),operator:"="};ct({...Ze,tags:[...Ze.tags,$n]})},Ta=$n=>{let ta=Ze.tags.filter(Zn=>Zn.id!==$n);ta.length===0&&(ta=[{id:(0,oi.zE)(),operator:"="}]),ct({...Ze,tags:ta})},Fa=n.createElement(n.Fragment,null,n.createElement($e.m,{content:"Filter your spans below. You can continue to apply filters until you have narrowed down your resulting spans to the select few you are most interested in.",placement:"right"},n.createElement("span",{className:ca.collapseLabel},"Span Filters",n.createElement(xe.I,{size:"md",name:"info-circle"}))),!It&&n.createElement("div",{className:ca.nextPrevResult},n.createElement(Ti,{trace:Ye,spanFilterMatches:qn,setFocusedSpanIdForSearch:Yn,focusedSpanIndexForSearch:$t,setFocusedSpanIndexForSearch:Yt,datasourceType:Jn,showSpanFilters:It})));return n.createElement("div",{className:ca.container},n.createElement(Bo.S,{label:Fa,collapsible:!0,isOpen:It,onToggle:Ht},n.createElement(jo.C,{className:ca.flexContainer},n.createElement(Ss.I,{label:"Service Name",labelWidth:16},n.createElement(Nr.Gy,{spacing:"xs"},n.createElement(Ns.l6,{"aria-label":"Select service name operator",onChange:$n=>Cn({...Ze,serviceNameOperator:$n.value}),options:[(0,ur.z)("="),(0,ur.z)("!=")],value:Ze.serviceNameOperator}),n.createElement(Ns.l6,{"aria-label":"Select service name",isClearable:!0,onChange:$n=>Cn({...Ze,serviceName:$n?.value||""}),onOpenMenu:Xn,options:Oa,placeholder:"All service names",value:Ze.serviceName||null}))),n.createElement(ki,{onChange:$n=>{Cn({...Ze,query:$n}),$n===""&&dn(!1)},value:Ze.query||""})),n.createElement(jo.C,null,n.createElement(Ss.I,{label:"Span Name",labelWidth:16},n.createElement(Nr.Gy,{spacing:"xs"},n.createElement(Ns.l6,{"aria-label":"Select span name operator",onChange:$n=>Cn({...Ze,spanNameOperator:$n.value}),options:[(0,ur.z)("="),(0,ur.z)("!=")],value:Ze.spanNameOperator}),n.createElement(Ns.l6,{"aria-label":"Select span name",isClearable:!0,onChange:$n=>Cn({...Ze,spanName:$n?.value||""}),onOpenMenu:na,options:$a,placeholder:"All span names",value:Ze.spanName||null})))),n.createElement(jo.C,null,n.createElement(Ss.I,{label:"Duration",labelWidth:16,tooltip:"Filter by duration. Accepted units are ns, us, ms, s, m, h"},n.createElement(Nr.Gy,{spacing:"xs",align:"flex-start"},n.createElement(Ns.l6,{"aria-label":"Select min span operator",onChange:$n=>Cn({...Ze,fromOperator:$n.value}),options:[(0,ur.z)(">"),(0,ur.z)(">=")],value:Ze.fromOperator}),n.createElement("div",{className:ca.intervalInput},n.createElement(Lo,{ariaLabel:"Select min span duration",onChange:$n=>Cn({...Ze,from:$n}),isInvalidError:"Invalid duration",placeholder:"e.g. 100ms, 1.2s",width:18,value:Ze.from||"",validationRegex:pn})),n.createElement(Ns.l6,{"aria-label":"Select max span operator",onChange:$n=>Cn({...Ze,toOperator:$n.value}),options:[(0,ur.z)("<"),(0,ur.z)("<=")],value:Ze.toOperator}),n.createElement(Lo,{ariaLabel:"Select max span duration",onChange:$n=>Cn({...Ze,to:$n}),isInvalidError:"Invalid duration",placeholder:"e.g. 100ms, 1.2s",width:18,value:Ze.to||"",validationRegex:pn})))),n.createElement(jo.C,{className:ca.tagsRow},n.createElement(Ss.I,{label:"Tags",labelWidth:16,tooltip:"Filter by tags, process tags or log fields in your spans."},n.createElement("div",null,Ze.tags.map(($n,ta)=>n.createElement("div",{key:ta},n.createElement(Nr.Gy,{spacing:"xs",width:"auto"},n.createElement(Ns.l6,{"aria-label":"Select tag key",isClearable:!0,key:$n.key,onChange:Zn=>fa($n,Zn),onOpenMenu:va,options:Ie,placeholder:"Select tag",value:$n.key||null}),n.createElement(Ns.l6,{"aria-label":"Select tag operator",onChange:Zn=>{Cn({...Ze,tags:Ze.tags?.map(La=>La.id===$n.id?{...La,operator:Zn.value}:La)})},options:[(0,ur.z)("="),(0,ur.z)("!=")],value:$n.operator}),n.createElement("span",{className:ca.tagValues},n.createElement(Ns.l6,{"aria-label":"Select tag value",isClearable:!0,key:$n.value,onChange:Zn=>{Cn({...Ze,tags:Ze.tags?.map(La=>La.id===$n.id?{...La,value:Zn?.value||""}:La)})},options:tt[$n.id]?tt[$n.id]:[],placeholder:"Select value",value:$n.value})),($n.key||$n.value||Ze.tags.length>1)&&n.createElement(ri.Z,{"aria-label":"Remove tag",variant:"secondary",icon:"times",onClick:()=>Ta($n.id),tooltip:"Remove tag"}),($n.key||$n.value)&&ta===Ze.tags.length-1&&n.createElement("span",{className:ca.addTag},n.createElement(ri.Z,{"aria-label":"Add tag",variant:"secondary",icon:"plus",onClick:Ga,tooltip:"Add tag"})))))))),n.createElement(xi,{trace:Ye,search:Ze,spanFilterMatches:qn,showSpanFilterMatchesOnly:tn,setShowSpanFilterMatchesOnly:dn,showCriticalPathSpansOnly:yn,setShowCriticalPathSpansOnly:Rn,setFocusedSpanIdForSearch:Yn,focusedSpanIndexForSearch:$t,setFocusedSpanIndexForSearch:Yt,datasourceType:Jn,clear:Bn,showSpanFilters:It})))});li.displayName="SpanFilters";const rr=ke=>({container:(0,t.css)`
      label: SpanFilters;
      margin: 0.5em 0 -${ke.spacing(1)} 0;
      z-index: 5;

      & > div {
        border-left: none;
        border-right: none;
      }
    `,collapseLabel:(0,t.css)`
      svg {
        color: #aaa;
        margin: -2px 0 0 10px;
      }
    `,flexContainer:(0,t.css)({display:"flex",justifyContent:"space-between"}),addTag:(0,t.css)({marginLeft:ke.spacing(1)}),intervalInput:(0,t.css)`
      margin: 0 -4px 0 0;
    `,tagsRow:(0,t.css)`
      margin: -4px 0 0 0;
    `,tagValues:(0,t.css)`
      max-width: 200px;
    `,nextPrevResult:(0,t.css)`
      flex: 1;
      align-items: center;
      display: flex;
      justify-content: flex-end;
      margin-right: ${ke.spacing(1)};
    `}),eo=(0,n.memo)(ke=>{const{trace:Ye,data:Ze,app:ct,timeZone:It,search:Ht,setSearch:tn,showSpanFilters:dn,setShowSpanFilters:yn,showSpanFilterMatchesOnly:Rn,setShowSpanFilterMatchesOnly:Yn,showCriticalPathSpansOnly:qn,setShowCriticalPathSpansOnly:Jn,setFocusedSpanIdForSearch:ca,spanFilterMatches:Oa,datasourceType:ma,setHeaderHeight:$a}=ke,He=(0,m.of)(Lr);(0,n.useEffect)(()=>{$a(document.querySelector("."+He.header)?.scrollHeight??0)},[$a,dn,He.header]);const Ie=(0,n.useMemo)(()=>Ye?Ka(Ye):[],[Ye]);if(!Ye)return null;const je=(Cn,Xn)=>{const na=(0,rt.LE)(Cn.startTime/1e3,{timeZone:Xn,defaultWithMS:!0}),va=na.match(/^(.+)(:\d\d\.\d+)$/);return va?n.createElement("span",{className:He.TracePageHeaderOverviewItemValue},va[1],n.createElement("span",{className:He.TracePageHeaderOverviewItemValueDetail},va[2])):na},tt=n.createElement("h1",{className:E()(He.title)},n.createElement(kn,{traceName:Er(Ye.spans)}),n.createElement("small",{className:He.duration},(0,g.a3)(Ye.duration))),{method:St,status:$t,url:Yt}=Zr(Ye.spans);let pn="green";$t&&$t.length>0&&($t[0].value.toString().charAt(0)==="4"?pn="orange":$t[0].value.toString().charAt(0)==="5"&&(pn="red"));const Bn=Cn=>n.createElement(n.Fragment,null,n.createElement("div",null,"http.url or http.target or http.path"),n.createElement("div",null,"(",Cn,")"));return n.createElement("header",{className:He.header},n.createElement("div",{className:He.titleRow},Ie&&Ie.length>0&&n.createElement(vr,{links:Ie,className:He.TracePageHeaderBack}),tt,n.createElement(bi,{traceId:Ye.traceID,data:Ze,app:ct})),n.createElement("div",{className:He.subtitle},n.createElement("span",{className:He.timestamp},je(Ye,It)),n.createElement("span",{className:He.tagMeta},St&&St.length>0&&n.createElement($e.m,{content:"http.method",interactive:!0},n.createElement("span",{className:He.tag},n.createElement(mo.E,{text:St[0].value,color:"blue"}))),$t&&$t.length>0&&n.createElement($e.m,{content:"http.status_code",interactive:!0},n.createElement("span",{className:He.tag},n.createElement(mo.E,{text:$t[0].value,color:pn}))),Yt&&Yt.length>0&&n.createElement($e.m,{content:Bn(Yt[0].value),interactive:!0},n.createElement("span",{className:He.url},Yt[0].value)))),n.createElement(li,{trace:Ye,showSpanFilters:dn,setShowSpanFilters:yn,showSpanFilterMatchesOnly:Rn,setShowSpanFilterMatchesOnly:Yn,showCriticalPathSpansOnly:qn,setShowCriticalPathSpansOnly:Jn,search:Ht,setSearch:tn,spanFilterMatches:Oa,setFocusedSpanIdForSearch:ca,datasourceType:ma}))});eo.displayName="TracePageHeader";const Lr=ke=>({TracePageHeaderBack:(0,t.css)`
      label: TracePageHeaderBack;
      align-items: center;
      align-self: stretch;
      background-color: #fafafa;
      border-bottom: 1px solid #ddd;
      border-right: 1px solid #ddd;
      color: inherit;
      display: flex;
      font-size: 1.4rem;
      padding: 0 1rem;
      margin-bottom: -1px;
      &:hover {
        background-color: #f0f0f0;
        border-color: #ccc;
      }
    `,TracePageHeaderOverviewItemValueDetail:E()((0,t.css)`
        label: TracePageHeaderOverviewItemValueDetail;
        color: #aaa;
      `,"trace-item-value-detail"),TracePageHeaderOverviewItemValue:(0,t.css)`
      label: TracePageHeaderOverviewItemValue;
      &:hover > .trace-item-value-detail {
        color: unset;
      }
    `,header:(0,t.css)({label:"TracePageHeader",backgroundColor:ke.colors.background.primary,padding:"0.5em 0 0 0",position:"sticky",top:0,zIndex:5,textAlign:"left"}),titleRow:(0,t.css)({alignItems:"flex-start",display:"flex",padding:"0 8px",flexWrap:"wrap"}),title:(0,t.css)({color:"inherit",flex:1,fontSize:"1.7em",lineHeight:"1em",marginBottom:0,minWidth:"200px"}),subtitle:(0,t.css)({flex:1,lineHeight:"1em",margin:"-0.5em 0.5em 0.75em 0.5em"}),tag:(0,t.css)({margin:"0 0.5em 0 0"}),duration:(0,t.css)({color:"#aaa",margin:"0 0.75em"}),timestamp:(0,t.css)({verticalAlign:"middle"}),tagMeta:(0,t.css)({margin:"0 0.75em",verticalAlign:"text-top"}),url:(0,t.css)({margin:"-2.5px 0.3em",height:"15px",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"700px",display:"inline-block"}),TracePageHeaderTraceId:(0,t.css)({label:"TracePageHeaderTraceId",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"30%",display:"inline-block"})}),wo="None",Qi="Duration",_r="Tag";function Fr({options:ke,onOptionsChange:Ye}){const Ze=useStyles2(vo),ct=[wo,Qi,_r].map(toOption);return React.createElement("div",{className:css({width:"100%"})},React.createElement(InlineFieldRow,{className:Ze.row},React.createElement(InlineField,{label:"Label",labelWidth:26,tooltip:"Default: duration",grow:!0},React.createElement(Select,{inputId:"label",options:ct,value:ke.jsonData.spanBar?.type||"",onChange:It=>{updateDatasourcePluginJsonDataOption({onOptionsChange:Ye,options:ke},"spanBar",{...ke.jsonData.spanBar,type:It?.value??""})},placeholder:"Duration",isClearable:!0,"aria-label":"select-label-name",width:40}))),ke.jsonData.spanBar?.type===_r&&React.createElement(InlineFieldRow,{className:Ze.row},React.createElement(InlineField,{label:"Tag key",labelWidth:26,tooltip:"Tag key which will be used to get the tag value. A span's attributes and resources will be searched for the tag key"},React.createElement(Input,{type:"text",placeholder:"Enter tag key",onChange:It=>updateDatasourcePluginJsonDataOption({onOptionsChange:Ye,options:ke},"spanBar",{...ke.jsonData.spanBar,tag:It.currentTarget.value}),value:ke.jsonData.spanBar?.tag||"",width:40}))))}const Fo=({options:ke,onOptionsChange:Ye})=>{let Ze=ke.type;return Ze+=ke.type==="tempo"?"/configure-tempo-data-source/#span-bar":"/#span-bar",React.createElement(ConfigSubSection,{title:"Span bar",description:React.createElement(ConfigDescriptionLink,{description:"Add additional info next to the service and operation on a span bar row in the trace view.",suffix:Ze,feature:"the span bar"})},React.createElement(Fr,{options:ke,onOptionsChange:Ye}))},vo=ke=>({infoText:css`
    label: infoText;
    padding-bottom: ${ke.spacing(2)};
    color: ${ke.colors.text.secondary};
  `,row:css`
    label: row;
    align-items: baseline;
  `});class mr{constructor(Ye){const{isTagsOpen:Ze,isProcessOpen:ct,isReferencesOpen:It,isWarningsOpen:Ht,isStackTracesOpen:tn,logs:dn,references:yn}=Ye||{};this.isTagsOpen=!!Ze,this.isProcessOpen=!!ct,this.isReferencesOpen=!!It,this.isWarningsOpen=!!Ht,this.isStackTracesOpen=!!tn,this.logs={isOpen:!!(dn&&dn.isOpen),openedItems:dn&&dn.openedItems?new Set(dn.openedItems):new Set},this.references={isOpen:!!(yn&&yn.isOpen),openedItems:yn&&yn.openedItems?new Set(yn.openedItems):new Set}}toggleTags(){const Ye=new mr(this);return Ye.isTagsOpen=!this.isTagsOpen,Ye}toggleProcess(){const Ye=new mr(this);return Ye.isProcessOpen=!this.isProcessOpen,Ye}toggleReferences(){const Ye=new mr(this);return Ye.references.isOpen=!this.references.isOpen,Ye}toggleReferenceItem(Ye){const Ze=new mr(this);return Ze.references.openedItems.has(Ye)?Ze.references.openedItems.delete(Ye):Ze.references.openedItems.add(Ye),Ze}toggleWarnings(){const Ye=new mr(this);return Ye.isWarningsOpen=!this.isWarningsOpen,Ye}toggleStackTraces(){const Ye=new mr(this);return Ye.isStackTracesOpen=!this.isStackTracesOpen,Ye}toggleLogs(){const Ye=new mr(this);return Ye.logs.isOpen=!this.logs.isOpen,Ye}toggleLogItem(Ye){const Ze=new mr(this);return Ze.logs.openedItems.has(Ye)?Ze.logs.openedItems.delete(Ye):Ze.logs.openedItems.add(Ye),Ze}}var Jo=e(25508);class Or{static iterFunction(Ye,Ze=0){return ct=>Ye(ct.value,ct,Ze)}static searchFunction(Ye){return typeof Ye=="function"?Ye:(Ze,ct)=>Ye instanceof Or?ct===Ye:Ze===Ye}constructor(Ye,Ze=[]){this.value=Ye,this.children=Ze}get depth(){return this.children.reduce((Ye,Ze)=>Math.max(Ze.depth+1,Ye),1)}get size(){let Ye=0;return this.walk(()=>Ye++),Ye}addChild(Ye){return this.children.push(Ye instanceof Or?Ye:new Or(Ye)),this}find(Ye){if(Or.iterFunction(Or.searchFunction(Ye))(this))return this;for(let ct=0;ct<this.children.length;ct++){const It=this.children[ct].find(Ye);if(It)return It}return null}getPath(Ye){const Ze=Or.iterFunction(Or.searchFunction(Ye)),ct=(It,Ht)=>{const tn=Ht.concat([It]);if(Ze(It))return tn;for(let dn=0;dn<It.children.length;dn++){const yn=It.children[dn],Rn=ct(yn,tn);if(Rn)return Rn}return null};return ct(this,[])}walk(Ye,Ze=0){const ct=[];let It=Ze;for(ct.push({node:this,depth:It});ct.length;){const Ht=ct[ct.length-1];ct.pop();const{node:tn,depth:dn}=Ht;Ye(tn.value,tn,dn),It=dn+1;let yn=tn.children.length-1;for(;yn>=0;)ct.push({node:tn.children[yn],depth:It}),yn--}}paths(Ye){const Ze=[];Ze.push({node:this,childIndex:0});const ct=[];for(;Ze.length;){const{node:It,childIndex:Ht}=Ze[Ze.length-1];if(It.children.length>=Ht+1)Ze[Ze.length-1].childIndex++,Ze.push({node:It.children[Ht],childIndex:0});else{if(It.children.length===0){const tn=Ze.map(dn=>dn.node.value);Ye(tn)}Ze.pop()}}return ct}}const Yi=ke=>ke.spanID,Wo=ke=>ke.references||[],to=(0,Jo.Mz)((0,Jo.Mz)(({span:ke})=>ke,Wo),({type:ke})=>ke,(ke,Ye)=>ke.find(Ze=>Ze.refType===Ye)),Ji=(0,Jo.Mz)(ke=>to({span:ke,type:"CHILD_OF"}),ke=>ke?ke.spanID:null),Oi=ke=>ke.spans,Eo=(0,Jo.Mz)(Oi,ke=>ke.reduce((Ye,Ze)=>Ye.set(Yi(Ze),Ze),new Map)),Xi="__root__";function Zi(ke,Ye=null){const Ze=new Map(ke.spans.map(tn=>[tn.spanID,new Or(tn.spanID)])),ct=Ye??new Map(ke.spans.map(tn=>[tn.spanID,tn])),It=new Or(Xi);ke.spans.forEach(tn=>{const dn=Ze.get(tn.spanID);if(Array.isArray(tn.references)&&tn.references.length){const{refType:yn,spanID:Rn}=tn.references[0];if(yn==="CHILD_OF"||yn==="FOLLOWS_FROM")(Ze.get(Rn)||It).children?.push(dn);else throw new Error(`Unrecognized ref type: ${yn}`)}else It.children.push(dn)});const Ht=(tn,dn)=>{const yn=tn?.value?ct.get(tn.value.toString()):void 0,Rn=dn?.value?ct.get(dn.value.toString()):void 0;return+(yn?.startTime>Rn?.startTime)||+(yn?.startTime===Rn?.startTime)-1};return ke.spans.forEach(tn=>{const dn=Ze.get(tn.spanID);dn.children.length>1&&dn?.children.sort(Ht)}),It.children.sort(Ht),It}function ci(ke){const Ye=new Map,Ze=ke.reduce((It,Ht)=>(It.some(tn=>tn.key===Ht.key&&tn.value===Ht.value)?Ye.set(`${Ht.key}:${Ht.value}`,`Duplicate tag "${Ht.key}:${Ht.value}"`):It.push(Ht),It),[]),ct=Array.from(Ye.values());return{dedupedTags:Ze,warnings:ct}}function di(ke,Ye){const Ze=ke?.slice()??[],ct=(Ye||[]).map(It=>It.toLowerCase());return Ze.sort((It,Ht)=>{const tn=It.key.toLowerCase(),dn=Ht.key.toLowerCase();for(let yn=0;yn<ct.length;yn++){const Rn=ct[yn];if(tn.startsWith(Rn)&&!dn.startsWith(Rn))return-1;if(!tn.startsWith(Rn)&&dn.startsWith(Rn))return 1}return tn>dn?1:tn<dn?-1:0}),Ze}function Ii(ke){if(!ke?.traceID)return null;const Ye=ke.traceID.toLowerCase();let Ze=0,ct=Number.MAX_SAFE_INTEGER;const It=new Map,Ht=new Map;ke.spans=ke.spans.filter(Jn=>!!Jn.startTime),ke.processes=Object.entries(ke.processes).reduce((Jn,[ca,Oa])=>(Jn[ca]={...Oa,tags:di(Oa.tags)},Jn),{});const tn=ke.spans.length;for(let Jn=0;Jn<tn;Jn++){const ca=ke.spans[Jn],{startTime:Oa,duration:ma,processID:$a}=ca;let He=ca.spanID;Oa<ct&&(ct=Oa),Oa+ma>Ze&&(Ze=Oa+ma);const Ie=It.get(He);Ie!=null?(console.warn(`Dupe spanID, ${Ie+1} x ${He}`,ca,Ht.get(He)),(0,fe.isEqual)(ca,Ht.get(He))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),It.set(He,Ie+1),He=`${He}_${Ie}`,ca.spanID=He):It.set(He,1),ca.process=ke.processes[$a],Ht.set(He,ca)}const dn=Zi(ke,Ht),yn=[],Rn={};dn.walk((Jn,ca,Oa=0)=>{if(Jn==="__root__"||typeof Jn!="string")return;const ma=Ht.get(Jn);if(!ma)return;const{serviceName:$a}=ma.process;Rn[$a]=(Rn[$a]||0)+1,ma.relativeStartTime=ma.startTime-ct,ma.depth=Oa-1,ma.hasChildren=ca.children.length>0,ma.childSpanCount=ca.children.length,ma.warnings=ma.warnings||[],ma.tags=ma.tags||[],ma.references=ma.references||[],ma.childSpanIds=ca.children.slice().sort((Ie,je)=>{const tt=Ht.get(Ie.value),St=Ht.get(je.value);return St.startTime+St.duration-(tt.startTime+tt.duration)}).map(Ie=>Ie.value);const He=ci(ma.tags);ma.tags=di(He.dedupedTags,os("topTagPrefixes")),ma.warnings=ma.warnings.concat(He.warnings),ma.references.forEach((Ie,je)=>{const tt=Ht.get(Ie.spanID);tt&&(Ie.span=tt,je>0&&(tt.subsidiarilyReferencedBy=tt.subsidiarilyReferencedBy||[],tt.subsidiarilyReferencedBy.push({spanID:Jn,traceID:Ye,span:ma,refType:Ie.refType})))}),yn.push(ma)});const Yn=Er(yn);return{services:Object.keys(Rn).map(Jn=>({name:Jn,numberOfSpans:Rn[Jn]})),spans:yn,traceID:Ye,traceName:Yn,processes:ke.processes,duration:Ze-ct,startTime:ct,endTime:Ze}}},92102:(G,I,e)=>{"use strict";e.d(I,{N:()=>t});var t=(n=>(n.Logs="log",n.Traces="trace",n.Metrics="metric",n.Profiles="profile",n.Unknown="unknown",n))(t||{})},92151:(G,I,e)=>{"use strict";e.d(I,{EUpdateTypes:()=>n,default:()=>o});var t=(m=>(m.DragEnd="DragEnd",m.DragMove="DragMove",m.DragStart="DragStart",m.MouseEnter="MouseEnter",m.MouseLeave="MouseLeave",m.MouseMove="MouseMove",m))(t||{});const n=t;var s=e(2543);const r=0;class o{constructor({getBounds:l,tag:i,resetBoundsOnResize:u=!0,...d}){this.resetBounds=()=>{this._bounds=void 0},this._handleMinorMouseEvent=p=>{const{button:c,clientX:y,type:f}=p;if(this._isDragging||c!==r)return;let P=null,a;if(f==="mouseenter")P=n.MouseEnter,a=this._onMouseEnter;else if(f==="mouseleave")P=n.MouseLeave,a=this._onMouseLeave;else if(f==="mousemove")P=n.MouseMove,a=this._onMouseMove;else throw new Error(`invalid event type: ${f}`);if(!a)return;const{value:E,x:g}=this._getPosition(y);a({event:p,type:P,value:E,x:g,manager:this,tag:this.tag})},this._handleDragEvent=p=>{const{button:c,clientX:y,type:f}=p;let P=null,a;if(f==="mousedown"){if(this._isDragging||c!==r)return;window.addEventListener("mousemove",this._handleDragEvent),window.addEventListener("mouseup",this._handleDragEvent);const h=(0,s.get)(document,"body.style");h&&(h.userSelect="none"),this._isDragging=!0,P=n.DragStart,a=this._onDragStart}else if(f==="mousemove"){if(!this._isDragging)return;P=n.DragMove,a=this._onDragMove}else if(f==="mouseup"){if(!this._isDragging)return;this._stopDragging(),P=n.DragEnd,a=this._onDragEnd}else throw new Error(`invalid event type: ${f}`);if(!a)return;const{value:E,x:g}=this._getPosition(y);a({event:p,type:P,value:E,x:g,manager:this,tag:this.tag})},this.handleMouseDown=this._handleDragEvent,this.handleMouseEnter=this._handleMinorMouseEvent,this.handleMouseMove=this._handleMinorMouseEvent,this.handleMouseLeave=this._handleMinorMouseEvent,this.getBounds=l,this.tag=i,this._isDragging=!1,this._bounds=void 0,this._resetBoundsOnResize=!!u,this._resetBoundsOnResize&&window.addEventListener("resize",this.resetBounds),this._onMouseEnter=d.onMouseEnter,this._onMouseLeave=d.onMouseLeave,this._onMouseMove=d.onMouseMove,this._onDragStart=d.onDragStart,this._onDragMove=d.onDragMove,this._onDragEnd=d.onDragEnd}_getBounds(){return this._bounds||(this._bounds=this.getBounds(this.tag)),this._bounds}_getPosition(l){const{clientXLeft:i,maxValue:u,minValue:d,width:p}=this._getBounds();let c=l-i,y=c/p;return d!=null&&y<d?(y=d,c=d*p):u!=null&&y>u&&(y=u,c=u*p),{value:y,x:c}}_stopDragging(){window.removeEventListener("mousemove",this._handleDragEvent),window.removeEventListener("mouseup",this._handleDragEvent);const l=(0,s.get)(document,"body.style");l&&(l.userSelect="auto"),this._isDragging=!1}isDragging(){return this._isDragging}dispose(){this._isDragging&&this._stopDragging(),this._resetBoundsOnResize&&window.removeEventListener("resize",this.resetBounds),this._bounds=void 0,this._onMouseEnter=void 0,this._onMouseLeave=void 0,this._onMouseMove=void 0,this._onDragStart=void 0,this._onDragMove=void 0,this._onDragEnd=void 0}}},30700:(G,I,e)=>{"use strict";e.d(I,{Kv:()=>i,rY:()=>u});var t=e(41811),n=e(84140),s=e(24284);function r(p){if(p.length!==7)return[0,0,0];const c=p.slice(1,3),y=p.slice(3,5),f=p.slice(5);return[parseInt(c,16),parseInt(y,16),parseInt(f,16)]}class o{constructor(c,y){const f=d(c,y);this.colorsHex=f,this.colorsRgb=f.map(r),this.cache=new Map,this.prevColorIndex=void 0}_getColorIndex(c){let y=this.cache.get(c);if(y==null){const f=this.hashCode(c?c.toLowerCase():"");if(y=Math.abs(f%this.colorsHex.length),this.prevColorIndex!==void 0){this.prevColorIndex===y&&(y=this.getNextIndex(y));const P=this.colorsHex[this.prevColorIndex];if(n.A.readability(P,this.colorsHex[y])<1.5){let a=y;for(let E=0;E<this.colorsHex.length;E++)if(a=this.getNextIndex(a),n.A.readability(P,this.colorsHex[a])>1.5){y=a;break}}}this.cache.set(c,y),this.prevColorIndex=y}return y}getNextIndex(c){return c+1<this.colorsHex.length?c+1:0}hashCode(c){let y=0,f,P;for(f=0;f<c.length;f++)P=c.charCodeAt(f),y=(y<<5)-y+P;return y}getColorByKey(c){const y=this._getColorIndex(c);return this.colorsHex[y]}getRgbColorByKey(c){const y=this._getColorIndex(c);return this.colorsRgb[y]}clear(){this.cache.clear()}}const m=(0,t.A)((p,c)=>new o(p,c));function l(p){m([],p)}function i(p,c){return m(s.Tj,c).getColorByKey(p)}function u(p,c){return m(s.Tj,c).getRgbColorByKey(p)}function d(p,c){const y=[...p],f=y.indexOf("#E24D42");f>-1&&y.splice(f,1);const P=p.indexOf("#BF1B00");P>-1&&y.splice(P,1);let a=[];for(const E of y)n.A.readability(c.colors.background.primary,E)>=3&&a.push(E);return a}},6389:(G,I,e)=>{"use strict";e.d(I,{a3:()=>h});var t=e(2543),n=e.n(t),s=e(84743),r=e.n(s);const o="YYYY-MM-DD",m="HH:mm",l=1e3,i=1e3*l,u=60*i,d=60*u,p=24*d,c=Math.log10(l),y=[{unit:"d",microseconds:p,ofPrevious:24},{unit:"h",microseconds:d,ofPrevious:60},{unit:"m",microseconds:u,ofPrevious:60},{unit:"s",microseconds:i,ofPrevious:1e3},{unit:"ms",microseconds:l,ofPrevious:1e3},{unit:"\u03BCs",microseconds:1,ofPrevious:1e3}],f=(D,v,C)=>toFloatPrecision(D/C,v)*C;function P(D){return moment(D/l).format(o)}function a(D){return moment(D/l).format(m)}function E(D){const v=f(D,c,l);return`${moment.duration(v/l).asMilliseconds()}ms`}function g(D){const v=f(D,c,i);return`${moment.duration(v/l).asSeconds()}s`}function h(D){const[v,C]=(0,t.dropWhile)(y,({microseconds:b},M)=>M<y.length-1&&b>D);if(v.ofPrevious===1e3)return`${(0,t.round)(D/v.microseconds,2)}${v.unit}`;const S=`${Math.floor(D/v.microseconds)}${v.unit}`,O=Math.round(D/C.microseconds%v.ofPrevious),x=`${O}${C.unit}`;return O===0?S:`${S} ${x}`}},28114:(G,I,e)=>{"use strict";e.d(I,{Cr:()=>O,QW:()=>f,_o:()=>v,gt:()=>T,hv:()=>S,i0:()=>y,lU:()=>d});var t=e(96540),n=e(6709),s=e(65879),r=e(47232),o=e(72574),m=e(14578),l=e(31193),i=e(96192),u=e(92102);function d({splitOpenFn:x,traceToLogsOptions:b,traceToMetricsOptions:M,traceToProfilesOptions:A,dataFrame:R,createFocusSpanLink:B,trace:U}){if(!R)return;let W=T(U.duration,U.traceName,U.traceID);const N=R.fields.some(L=>!!L.config.links?.length),w=P(x,R.fields[0],b,M,B,W);return function(V){let K=w(V);if(N){W={...W,...S(V),...O(V,A)};const k=R.fields.filter(j=>!!j.config.links?.length);try{let j;A?.datasourceUid&&(j=(0,l.tR)().getInstanceSettings(A.datasourceUid));const H=j?.type==="grafana-pyroscope-datasource",J=V.tags.some(ne=>ne.key===f),X=H&&J;let se=[];k.forEach(ne=>{const q=(0,i.QL)({field:ne,rowIndex:V.dataFrameRowIndex,splitOpenFn:x,range:C(V,void 0,void 0,X),dataFrame:R,vars:W});se=se.concat(q)});const ae=se.map(ne=>({title:ne.title,href:ne.href,onClick:ne.onClick,content:t.createElement(m.I,{name:"link",title:ne.title||"Link"}),field:ne.origin,type:X?u.N.Profiles:u.N.Unknown}));K.push.apply(K,ae)}catch(j){return console.error(j),K}}return K}}const p=x=>x.map(b=>({key:b,value:b.includes(".")?b.replace(".","_"):void 0})),c=p(["cluster","hostname","namespace","pod","service.name","service.namespace"]),y=p(["service.name","service.namespace"]),f="pyroscope.profile.id";function P(x,b,M,A,R,B){let U;M?.datasourceUid&&(U=(0,l.tR)().getInstanceSettings(M.datasourceUid));const W=U?.type==="grafana-splunk-datasource";let N;return A?.datasourceUid&&(N=(0,l.tR)().getInstanceSettings(A.datasourceUid)),function(L){B={...B,...S(L)};const V=[];let K,k="";if(U&&M){const j=M.customQuery?M.query:void 0,H=M.tags&&M.tags.length>0?M.tags:c;switch(U?.type){case"loki":k=v(L,H),K=a(L,M,k,j);break;case"grafana-splunk-datasource":k=v(L,H,{joinBy:" "}),K=g(L,M,k,j);break;case"elasticsearch":case"grafana-opensearch-datasource":k=v(L,H,{labelValueSign:":",joinBy:" AND "}),K=E(L,M,k,j);break;case"grafana-falconlogscale-datasource":k=v(L,H,{joinBy:" OR "}),K=D(L,M,k,j);break;case"googlecloud-logging-datasource":k=v(L,H,{joinBy:" AND "}),K=h(L,M,k,j)}if(K){const J={title:U.name,url:"",internal:{datasourceUid:U.uid,datasourceName:U.name,query:K}};if(B={...B,__tags:{text:"Tags",value:k}},(0,i.O1)(J.internal.query,B).allVariablesDefined){const X=(0,n.u)({link:J,internalLink:J.internal,scopedVars:B,range:C(L,{startMs:M.spanStartTimeShift?s.intervalToMs(M.spanStartTimeShift):0,endMs:M.spanEndTimeShift?s.intervalToMs(M.spanEndTimeShift):0},W),field:{},onClickFn:x,replaceVariables:(0,o.w)().replace.bind((0,o.w)())});V.push({href:X.href,title:"Related logs",onClick:X.onClick,content:t.createElement(m.I,{name:"gf-logs",title:"Explore the logs for this in split view"}),field:b,type:u.N.Logs})}}}if(N&&A?.queries)for(const j of A.queries){const H=j.query||`histogram_quantile(0.5, sum(rate(traces_spanmetrics_latency_bucket{service="${L.process.serviceName}"}[5m])) by (le))`,J={title:N.name,url:"",internal:{datasourceUid:N.uid,datasourceName:N.name,query:{expr:H,refId:"A"}}},X=A.tags&&A.tags.length>0?A.tags:c;B={...B,__tags:{text:"Tags",value:v(L,X)}};const se=(0,n.u)({link:J,internalLink:J.internal,scopedVars:B,range:C(L,{startMs:A.spanStartTimeShift?s.intervalToMs(A.spanStartTimeShift):-12e4,endMs:A.spanEndTimeShift?s.intervalToMs(A.spanEndTimeShift):12e4}),field:{},onClickFn:x,replaceVariables:(0,o.w)().replace.bind((0,o.w)())});V.push({title:j?.name,href:se.href,onClick:se.onClick,content:t.createElement(m.I,{name:"chart-line",title:"Explore metrics for this span"}),field:b,type:u.N.Metrics})}if(L.references&&R)for(const j of L.references){if(j.refType==="CHILD_OF")continue;const H=R(j.traceID,j.spanID);V.push({href:H.href,title:j.span?j.span.operationName:"View linked span",content:t.createElement(m.I,{name:"link",title:"View linked span"}),onClick:H.onClick,field:H.origin,type:u.N.Traces})}if(L.subsidiarilyReferencedBy&&R)for(const j of L.subsidiarilyReferencedBy){const H=R(j.traceID,j.spanID);V.push({href:H.href,title:j.span?j.span.operationName:"View linked span",content:t.createElement(m.I,{name:"link",title:"View linked span"}),onClick:H.onClick,field:H.origin,type:u.N.Traces})}return V}}function a(x,b,M,A){const{filterByTraceID:R,filterBySpanID:B}=b;if(A)return{expr:A,refId:""};if(!M)return;let U="{${__tags}}";return R&&x.traceID&&(U+=' |="${__span.traceId}"'),B&&x.spanID&&(U+=' |="${__span.spanId}"'),{expr:U,refId:""}}function E(x,b,M,A){const{filterByTraceID:R,filterBySpanID:B}=b;if(A)return{query:A,refId:"",metrics:[{id:"1",type:"logs"}]};let U=[];return B&&x.spanID&&U.push('"${__span.spanId}"'),R&&x.traceID&&U.push('"${__span.traceId}"'),M&&U.push("${__tags}"),{query:U.join(" AND "),refId:"",metrics:[{id:"1",type:"logs"}]}}function g(x,b,M,A){const{filterByTraceID:R,filterBySpanID:B}=b;if(A)return{query:A,refId:""};let U="";return M&&(U+="${__tags}"),R&&x.traceID&&(U+=' "${__span.traceId}"'),B&&x.spanID&&(U+=' "${__span.spanId}"'),{query:U,refId:""}}function h(x,b,M,A){const{filterByTraceID:R,filterBySpanID:B}=b;if(A)return{query:A,refId:""};let U=[];return B&&x.spanID&&U.push('"${__span.spanId}"'),R&&x.traceID&&U.push('"${__span.traceId}"'),M&&U.push("${__tags}"),{query:U.join(" AND "),refId:""}}function D(x,b,M,A){const{filterByTraceID:R,filterBySpanID:B}=b;if(A)return{lsql:A,refId:""};if(!M)return;let U="${__tags}";return R&&x.traceID&&(U+=' or "${__span.traceId}"'),B&&x.spanID&&(U+=' or "${__span.spanId}"'),{lsql:U,refId:""}}function v(x,b,{labelValueSign:M="=",joinBy:A=", "}={}){return[...x.process.tags,...x.tags,{key:"spanId",value:x.spanID},{key:"traceId",value:x.traceID},{key:"name",value:x.operationName},{key:"duration",value:x.duration}].map(R=>{const B=b.find(U=>U.key===R.key);if(B)return`${B.value?B.value:B.key}${M}"${R.value}"`}).filter(R=>!!R).join(A)}function C(x,b={startMs:0,endMs:0},M=!1,A=!1){let R=Math.floor(x.startTime/1e3+b.startMs);const B=(x.startTime+x.duration)/1e3;let U=Math.floor(B+b.endMs);M&&U-R<1e3?U=R+1e3:A?(R=R-6e4,U=U+6e4):R===U&&U++;const W=(0,r.KQ)(U),N=(0,r.KQ)(R);return{from:N,to:W,raw:{from:N,to:W}}}function T(x,b,M){return{__trace:{text:"Trace",value:{duration:x,name:b,traceId:M}}}}function S(x){const b={};for(const M of x.process.tags)b[M.key]=M.value;for(const M of x.tags)b[M.key]=M.value;return{__span:{text:"Span",value:{spanId:x.spanID,traceId:x.traceID,duration:x.duration,name:x.operationName,tags:b}}}}function O(x,b){let M={};if(b){const A=b.tags&&b.tags.length>0?b.tags:y;M={__tags:{text:"Tags",value:v(x,A)}}}return M}},15583:(G,I,e)=>{"use strict";e.d(I,{Ji:()=>m,SQ:()=>l,zE:()=>r});var t=e(96540),n=e(62938),s=e(56271);const r=()=>(0,n.A)().slice(0,12),m={spanNameOperator:"=",serviceNameOperator:"=",fromOperator:">",toOperator:"<",tags:[{id:r(),operator:"="}]};function l(i){const[u,d]=(0,t.useState)(m),p=(0,t.useMemo)(()=>i&&(0,s.filterSpans)(u,i),[u,i]);return{search:u,setSearch:d,spanFilterMatches:p}}},35090:(G,I,e)=>{"use strict";e.d(I,{L:()=>s});var t=e(78368),n=e(56271);function s(o){if(!o)return null;let m=o.fields.length===1?o.fields[0].values[0]:r(o);return m?(0,n.transformTraceData)(m):null}function r(o){const m=new t.R(o),l={};for(let i=0;i<m.length;i++){const u=m.get(i);if(!u.spanID)return null;l[u.spanID]||(l[u.spanID]={serviceName:u.serviceName,tags:u.serviceTags})}return{traceID:m.get(0).traceID,processes:l,spans:m.toArray().map((i,u)=>{const d=[];return i.parentSpanID&&d.push({refType:"CHILD_OF",spanID:i.parentSpanID,traceID:i.traceID}),i.references&&d.push(...i.references.map(p=>({refType:"FOLLOWS_FROM",...p}))),{...i,duration:i.duration*1e3,startTime:i.startTime*1e3,processID:i.spanID,flags:0,references:d,logs:i.logs?.map(p=>({...p,timestamp:p.timestamp*1e3}))||[],dataFrameRowIndex:u}})}}},11140:(G,I,e)=>{"use strict";e.d(I,{v:()=>R});var t=e(2543),n=e(96540),s=e(49785),r=e(71733),o=e(14110),m=e(12131),l=e(32264),i=e(88575),u=e(94354),d=e(42418),p=e(37390),c=e(55852),y=e(59429),f=e(16233),P=e(79999),a=e(31678),E=e(9955),g=e(28676),h=e(71176),D=(B=>(B.FETCH_DASHBOARD="fetch-dashboard",B.SET_DASHBOARD_LS="set-dashboard-ls-error",B))(D||{});function v(B,U){let W=[];return B==="table"&&U.panelState?.logs?.columns&&(U.panelState.logs?.labelFieldName&&W.push({id:"extractFields",options:{source:U.panelState.logs.labelFieldName}}),W.push({id:"organize",options:{indexByName:Object.values(U.panelState.logs.columns).reduce((N,w,L)=>({...N,[w]:L}),{}),includeByName:Object.values(U.panelState.logs.columns).reduce((N,w)=>({...N,[w]:!0}),{})}})),W}async function C(B){const U=O(B.queries,B.queryResponse,B?.panelState),W={targets:B.queries,type:U,title:"New Panel",gridPos:{x:0,y:0,w:12,h:8},datasource:B.datasource,transformations:v(U,B)};let N;if(B.dashboardUid)try{N=await(0,g.n)().getDashboardDTO(B.dashboardUid)}catch{throw"fetch-dashboard"}else N=await(0,h.X)();N.dashboard.panels=[W,...N.dashboard.panels??[]],N.dashboard.time=B.time;try{(0,P.OI)(N)}catch{throw"set-dashboard-ls-error"}}const T=B=>!B.hide,S=B=>U=>U.refId===B;function O(B,U,W){for(const{refId:N}of B.filter(T)){const w=S(N);if(U.flameGraphFrames.some(w))return"flamegraph";if(U.graphFrames.some(w))return"timeseries";if(U.logsFrames.some(w))return W?.logs?.visualisationType?W.logs.visualisationType:"logs";if(U.nodeGraphFrames.some(w))return"nodeGraph";if(U.traceFrames.some(w))return"traces";if(U.customFrames.some(w))return U.customFrames.find(w)?.meta?.preferredVisualisationPluginId??"table"}return"table"}var x=(B=>(B.NewDashboard="new-dashboard",B.ExistingDashboard="existing-dashboard",B))(x||{});function b(B){}function M(B){return B?`d/${B}`:"dashboard/new"}var A=(B=>(B.UNKNOWN="unknown-error",B.NAVIGATION="navigation-error",B))(A||{});function R(B){const{exploreId:U,onClose:W}=B,N=(0,a.useSelector)((0,E.qq)(U)),[w,L]=(0,n.useState)(),{handleSubmit:V,control:K,formState:{errors:k},watch:j}=(0,s.mN)({defaultValues:{saveTarget:"new-dashboard"}}),H=f.TP.hasPermission(a.AccessControlAction.DashboardsCreate),J=f.TP.hasPermission(a.AccessControlAction.DashboardsWrite),X=[];H&&X.push({label:"New dashboard",value:"new-dashboard"}),J&&X.push({label:"Existing dashboard",value:"existing-dashboard"});const se=X.length>1?j("saveTarget"):X[0].value,ae=async(ne,q)=>{L(void 0);const ee=q.saveTarget==="existing-dashboard"?q.dashboardUid:void 0;(0,o.rR)("e_2_d_submit",{newTab:ne,saveTarget:q.saveTarget,queries:N.queries.length});const{from:z,to:te}=N.range.raw;try{await C({dashboardUid:ee,datasource:N.datasourceInstance?.getRef(),queries:N.queries,queryResponse:N.queryResponse,panelState:N?.panelsState,time:{from:typeof z=="string"?z:z.toISOString(),to:typeof te=="string"?te:te.toISOString()}})}catch(ue){switch(ue){case D.FETCH_DASHBOARD:L({error:ue,message:"Could not fetch dashboard information. Please try again."});break;case D.SET_DASHBOARD_LS:L({error:ue,message:"Could not add panel to dashboard. Please try again."});break;default:L({error:"unknown-error",message:"Something went wrong. Please try again."})}return}const ie=M(ee);if(!ne){W(),m.Ny.push(r.I.stripBaseFromUrl(ie));return}if(!!!e.g.open(l.$.appUrl+ie,"_blank")){L({error:"navigation-error",message:"Could not navigate to the selected dashboard. Please try again."}),(0,P.yZ)();return}W()};return(0,n.useEffect)(()=>{(0,o.rR)("e_2_d_open")},[]),n.createElement("form",null,X.length>1&&n.createElement(s.xI,{control:K,render:({field:{ref:ne,...q}})=>n.createElement(i.D,{label:"Target dashboard",description:"Choose where to add the panel."},n.createElement(u.z,{options:X,...q,id:"e2d-save-target"})),name:"saveTarget"}),se==="existing-dashboard"&&n.createElement(s.xI,{render:({field:{ref:ne,value:q,onChange:ee,...z}})=>n.createElement(i.D,{label:"Dashboard",description:"Select in which dashboard the panel will be created.",error:k.dashboardUid?.message,invalid:!!k.dashboardUid},n.createElement(y.b,{...z,inputId:"e2d-dashboard-picker",defaultOptions:!0,onChange:te=>ee(te?.uid)})),control:K,name:"dashboardUid",shouldUnregister:!0,rules:{required:{value:!0,message:"This field is required."}}}),w&&n.createElement(d.F,{severity:"error",title:"Error adding the panel"},w.message),n.createElement(p.a.ButtonRow,null,n.createElement(c.$n,{type:"reset",onClick:W,fill:"outline",variant:"secondary"},"Cancel"),n.createElement(c.$n,{type:"submit",variant:"secondary",onClick:V((0,t.partial)(ae,!0)),icon:"external-link-alt"},"Open in new tab"),n.createElement(c.$n,{type:"submit",variant:"primary",onClick:V((0,t.partial)(ae,!1)),icon:"apps"},"Open dashboard")))}},12881:(G,I,e)=>{"use strict";e.d(I,{t:()=>s});var t=e(16233),n=e(31678);function s(){const r=t.TP.hasPermission(n.AccessControlAction.DashboardsCreate),o=t.TP.hasPermission(n.AccessControlAction.DashboardsWrite);return r&&!o?"Add panel to new dashboard":o&&!r?"Add panel to existing dashboard":"Add panel to dashboard"}},24401:(G,I,e)=>{"use strict";e.d(I,{s:()=>l});var t=e(96540),n=e(71733),s=e(12131),r=e(37390),o=e(67061),m=e(55852);function l(i){const{onDismiss:u,path:d,title:p}=i,c=()=>{e.g.open(n.I.assureBaseUrl(d),"_blank"),u()},y=()=>s.Ny.push(d);return t.createElement(r.a,{title:p,isOpen:!0,onDismiss:u},t.createElement(o.B,{direction:"column",gap:1},t.createElement("p",null,"Do you want to proceed in the current tab or open a new tab?")),t.createElement(r.a.ButtonRow,null,t.createElement(m.$n,{onClick:u,fill:"outline",variant:"secondary"},"Cancel"),t.createElement(m.$n,{type:"submit",variant:"secondary",onClick:c,icon:"external-link-alt"},"Open in new tab"),t.createElement(m.$n,{type:"submit",variant:"primary",onClick:y,icon:"apps"},"Open")))}},30973:(G,I,e)=>{"use strict";e.d(I,{w:()=>r});var t=e(96540),n=e(38138),s=e(75462);function r({extensions:l,onSelect:i}){const{categorised:u,uncategorised:d}=m(l),p=d.length>0&&Object.keys(u).length>0;return t.createElement(n.W,null,t.createElement(t.Fragment,null,Object.keys(u).map(c=>t.createElement(n.W.Group,{key:c,label:(0,s.pL)(c,25)},o(u[c],i))),p&&t.createElement(n.W.Divider,{key:"divider"}),o(d,i)))}function o(l,i){return l.map(u=>t.createElement(n.W.Item,{ariaLabel:u.title,icon:u?.icon||"plug",key:u.id,label:(0,s.pL)(u.title,25),onClick:d=>{if(u.path)return i(u);u.onClick?.(d)}}))}function m(l){return(0,t.useMemo)(()=>{const i=[],u={};for(const d of l){if(!d.category){i.push(d);continue}Array.isArray(u[d.category])||(u[d.category]=[]),u[d.category].push(d)}return{uncategorised:i,categorised:u}},[l])}},33368:(G,I,e)=>{"use strict";e.d(I,{h:()=>s});var t=e(96540),n=e(96192);const s=(r,o)=>(0,t.useMemo)(()=>(0,n.YV)(r,o),[r,o])},39590:(G,I,e)=>{"use strict";e.d(I,{m:()=>se,s:()=>ne});var t=e(96540),n=e(76888),s=e(3169),r=e(31678),o=e(9955),m=e(34028);const l={parse:q=>{if(!q.left&&!q.right)return{to:{left:{datasource:null,queries:[],range:{from:m.kn.from,to:m.kn.to}},schemaVersion:0},error:!1};let ee,z,te,ie;return typeof q.left=="string"&&([ee,te]=p(q.left)),typeof q.right=="string"?[z,ie]=p(q.right):q.right&&(z=d,ie=!0),ee||(ee=d),{to:{schemaVersion:0,left:ee,...z&&{right:z}},error:!!te||!!ie}}},i=(q,...ee)=>ee.some(z=>q.hasOwnProperty(z));var u=(q=>(q[q.RangeFrom=0]="RangeFrom",q[q.RangeTo=1]="RangeTo",q[q.Datasource=2]="Datasource",q[q.SegmentsStart=3]="SegmentsStart",q))(u||{});const d={datasource:null,queries:[],range:m.kn};function p(q){let ee;try{ee=JSON.parse(q)}catch{return[d,!0]}if(!Array.isArray(ee))return[{queries:[],range:m.kn,...ee},!1];if(ee.length<=3)return[d,!0];const z={from:ee[0],to:ee[1]},te=ee[2],ie=ee.slice(3),ce=ie.filter(fe=>!i(fe,"ui","mode","__panelsState")),ue=ie.find(fe=>i(fe,"__panelsState"))?.__panelsState;return[{datasource:te,queries:ce,range:z,panelsState:ue},!1]}var c=e(87490),y=e(15961);const f={parse:q=>{if(!q||!q.panes||typeof q.panes!="string")return{to:{schemaVersion:1,panes:{[(0,c.o$)()]:P}},error:!1};let ee;try{ee=JSON.parse(q.panes)}catch{}if(ee==null||typeof ee!="object")return{to:{schemaVersion:1,panes:{[(0,c.o$)()]:P}},error:!0};const z=Object.entries(ee).map(([te,ie])=>[te,a(ie)]).reduce((te,[ie,ce])=>{let ue=ie;return(ue.length!==3||/^\d+$/.test(ue)||ue.split("").some(fe=>c.WP.indexOf(fe)===-1))&&(ue=(0,c.o$)()),{...te,[ue]:ce}},{});return Object.keys(z).length||(z[(0,c.o$)()]=P),{to:{schemaVersion:1,panes:z},error:!1}},migrate:q=>({schemaVersion:1,panes:{[(0,c.o$)()]:q.left,...q.right&&{[(0,c.o$)()]:q.right}}})},P={datasource:null,queries:[],range:m.kn};function a(q){return!q||typeof q!="object"?P:{...P,...(0,y.C)("queries",q)&&Array.isArray(q.queries)&&{queries:q.queries},...(0,y.C)("datasource",q)&&typeof q.datasource=="string"&&{datasource:q.datasource},...(0,y.C)("panelsState",q)&&!!q.panelsState&&typeof q.panelsState=="object"&&{panelsState:q.panelsState},...(0,y.C)("range",q)&&!!q.range&&typeof q.range=="object"&&(0,y.C)("from",q.range)&&(0,y.C)("to",q.range)&&typeof q.range.from=="string"&&typeof q.range.to=="string"&&{range:{from:q.range.from,to:q.range.to}}}}const E=q=>h(q),g=[l,f],h=q=>{const ee=D(q),[z,...te]=g.slice(ee),{error:ie,to:ce}=z.parse(q);return[te.reduce((fe,Te)=>Te.migrate?Te.migrate(fe):fe,ce),ie]};function D(q){return!q||!("schemaVersion"in q)||!q.schemaVersion?0:typeof q.schemaVersion=="number"?q.schemaVersion:typeof q.schemaVersion=="string"?Number.parseInt(q.schemaVersion,10):0}var v=e(2543),C=e(18226),T=e(62860),S=e(62256),O=e(29436),x=e(23994),b=e(89224),M=e(27649),A=e(39070),R=e(41987),B=e(31193),U=e(14678);const W=(q,ee)=>{const z=!(0,v.isEqual)(ee?.datasource,q?.datasource),te=!(0,v.isEqual)(ee?.queries,q?.queries),ie=!(0,v.isEqual)(ee?.range||m.kn,q?.range||m.kn),ce=!(0,v.isEqual)(ee?.panelsState,q?.panelsState);return{datasource:z,queries:te,range:ie,panelsState:ce}};async function N(q,ee,z){if(q)try{return await(0,B.tR)().get(q)}catch{}const te=[...new Set(ee.map(ie=>ie.datasource).filter(A.zz).map(ie=>typeof ie=="string"?ie:ie.uid))];try{if(te.length>=1){const ie=(await Promise.allSettled(te.map(ce=>(0,B.tR)().get(ce)))).filter(y.s);if(ie.length>1)return await(0,B.tR)().get(U.uv);if(ie.length===1)return await(0,B.tR)().get(te[0])}}catch{}return(0,B.tR)().get((0,c.HQ)(z)).catch(()=>(0,B.tR)().get()).catch(()=>{})}function w(q){return{...q.getDefaultQuery?.(R.Jk.Explore),refId:"A",datasource:q.getRef()}}function L(q){return q.name===U.uv}function V(q){return q&&L(q)?ee=>!!ee.datasource:ee=>ee.datasource?typeof ee.datasource=="string"?ee.datasource===q?.uid||ee.datasource===q?.name:ee.datasource.uid===q?.uid:!0}async function K(q){return(await Promise.allSettled(q.map(z=>(0,B.tR)().get(z.datasource).then(te=>({query:z,ds:te}))))).filter(y.s).map(({value:z})=>z.query)}function k(q,ee,z){const te=Object.values(q.panes);if(te.length>1){const ie=te.some(({range:ce},ue,[{range:fe}])=>!(0,v.isEqual)(ce,fe));z((0,O.qz)({syncedTimes:!ie}))}Object.entries(q.panes).forEach(async([ie,ce],ue)=>{const{datasource:fe,queries:Te,range:he,panelsState:de}=ce,le=ee[ie];if(le!==void 0){const pe=W(ce,se(le));Promise.resolve().then(async()=>{pe.datasource&&fe&&await z((0,T.wh)({exploreId:ie,datasource:fe}))}).then(async()=>{pe.range&&z((0,b.JA)({exploreId:ie,rawRange:(0,m.Z9)(he)})),pe.queries&&z((0,x.h9)({exploreId:ie,queries:(0,M.v)(Te)})),(pe.queries||pe.range)&&(await z((0,x.hS)(ie)),z((0,x.Od)({exploreId:ie}))),pe.panelsState&&de&&z((0,S.fx)({exploreId:ie,panelsState:de}))})}else z((0,S.Gd)({exploreId:ie,datasource:fe||"",queries:(0,M.v)(Te),range:(0,m.Z9)(he),panelsState:de,position:ue,eventBridge:new C.o}))}),Object.keys(ee).filter(ie=>!Object.keys(q.panes).includes(ie)).forEach(ie=>z((0,O.J8)(ie)))}function j(q,ee,z,te,ie){te((0,O.Ve)()),Promise.all(Object.entries(q.panes).map(([ce,{datasource:ue,queries:fe,range:Te,panelsState:he}])=>N(ue,fe,z).then(de=>Promise.resolve(de?fe.length?(0,M.v)(fe).filter(V(de)).map(L(de)?v.identity:le=>({...le,datasource:de.getRef()})):(0,B.tR)().get(L(de)?void 0:de.getRef()).then(le=>[w(le)]):[]).then(async le=>{let pe=await K(le);return!pe.length&&de&&(pe=[w(L(de)?await(0,B.tR)().get():de)]),{exploreId:ce,range:Te,panelsState:he,queries:pe,datasource:de}})))).then(async ce=>{const ue=await Promise.all(ce.map(({exploreId:le,range:pe,panelsState:ve,queries:be,datasource:Oe})=>te((0,S.Gd)({exploreId:le,datasource:Oe,queries:be,range:(0,m.Z9)(pe),panelsState:ve,eventBridge:new C.o})).unwrap()));if(ue.length>1){const le=ue.some(({state:pe},ve,[{state:be}])=>!(0,v.isEqual)(pe.range.raw,be.range.raw));te((0,O.qz)({syncedTimes:!le}))}const fe=ue.reduce((le,{exploreId:pe,state:ve})=>({...le,[pe]:se(ve)}),{}),Te=ie.getSearchObject();let he={};for(const[le,pe]of Object.entries(Te).filter(([ve])=>!["schemaVersion","panes","orgId","left","right"].includes(ve)))he[le]=pe;const de=new URLSearchParams({schemaVersion:`${q.schemaVersion}`,panes:JSON.stringify(fe),orgId:`${z}`,...he});ie.replace({pathname:ie.getLocation().pathname,search:de.toString()}),ee.current="done"})}function H(q,ee){return q.current=T.wh.pending.type===ee.type,[O.J8.type,O.ve.fulfilled.type,x.Od.pending.type,b.eM.type,S.fx.type,T.wh.fulfilled.type].includes(ee.type)&&!q.current}function J(q,ee,z,te){const ie=Object.entries(q.panes).reduce((ce,[ue,fe])=>fe?{...ce,[ue]:se(fe)}:ce,{});if(!(0,v.isEqual)(ee.current.panes,JSON.stringify(ie))){const ce=!!ee.current.panes&&Object.values(ee.current.panes).filter(Boolean).length===0||z.current==="pending";ee.current={panes:JSON.stringify(ie)},te.partial({panes:ee.current.panes},ce)}}var X=e(76885);function se(q){return{datasource:q.datasourceInstance?.uid||"",queries:q.queries.map(c.w4),range:(0,X.sQ)(q.range.raw),panelsState:ae(q.panelsState)}}function ae(q){let ee=(0,v.mapValues)(q,z=>(0,v.isObject)(z)?ae(z):z);if(ee=(0,v.omitBy)(ee,v.isEmpty),!(0,v.isEmpty)(ee))return ee}function ne(q){const{location:ee}=(0,n.Il)(),z=(0,r.useDispatch)(),te=(0,r.useSelector)(o.Qb),ie=(0,r.useSelector)(he=>he.user.orgId),ce=(0,t.useRef)(q),ue=(0,t.useRef)("notstarted"),fe=(0,t.useRef)(!1),{warning:Te}=(0,s._2)();(0,t.useEffect)(()=>{q.panes||(ue.current="notstarted",ce.current=q)},[q]),(0,t.useEffect)(()=>{const he=z((0,r.addListener)({predicate:de=>H(fe,de),effect:async(de,{cancelActiveListeners:le,delay:pe,getState:ve})=>{le(),await pe(200),J(ve().explore,ce,ue,ee)}}));return()=>he()},[z,ee]),(0,t.useEffect)(()=>{const he=ce.current?.panes!==q.panes,[de,le]=E(q);le&&Te("Could not parse Explore URL","The requested URL contains invalid parameters, a default Explore state has been loaded."),!he&&ue.current==="notstarted"&&(ue.current="pending",j(de,ue,ie,z,ee)),ce.current=q,he&&ue.current==="done"&&k(de,te,z)},[z,te,ie,ee,q,Te])}},15961:(G,I,e)=>{"use strict";e.d(I,{C:()=>n,s:()=>t});const t=s=>s.status==="fulfilled";function n(s,r){return s in r}},324:(G,I,e)=>{"use strict";e.d(I,{M:()=>p,v:()=>y});var t=e(88483),n=e(19347),s=e(14110),r=e(82467),o=e(3169),m=e(18380),l=e(99140),i=e(62256),u=e(29436),d=e(23994);const p=f=>new t.c(P=>{const a=l.M_.getState().explore.panes[f]?.correlations;if(a)P.next(a),P.complete();else{const E=l.M_.subscribe(()=>{const g=l.M_.getState().explore.panes[f]?.correlations;g&&(E(),P.next(g),P.complete())})}});function c(f){return async(P,a)=>{const E=a().explore.panes[f];if(E.datasourceInstance?.uid!==void 0){let g=E.datasourceInstance.meta.mixed?E.queries.map(D=>D.datasource?.uid).filter(D=>D!==null):[E.datasourceInstance.uid];const h=await(0,m.J6)(g);P((0,i.Fb)({exploreId:f,correlations:h.correlations||[]}))}}}function y(f,P,a){return async(E,g)=>{const h=Object.keys(g().explore?.panes),D=g().explore?.panes[h[0]],v=g().explore?.panes[h[1]];if(!D||!v)return;const C=D.datasourceInstance?.meta.mixed?D.queries[0].datasource:D.datasourceInstance?.getRef(),T=v.datasourceInstance?.meta.mixed?v.queries[0].datasource:v.datasourceInstance?.getRef(),[S,O]=await Promise.all([(0,n.l)().get(C),(0,n.l)().get(T)]);if(S?.uid&&O?.uid&&v.correlationEditorHelperData?.resultField){const x={sourceUID:S.uid,targetUID:O.uid,label:f||await(0,m.tZ)(D,v),description:P,config:{field:v.correlationEditorHelperData.resultField,target:v.queries[0],type:"query",transformations:a}};await(0,m.$q)(S.uid,x).then(async()=>{E((0,u.J8)(h[1])),await E(c(h[0])),await E((0,d.Od)({exploreId:h[0]})),(0,s.rR)("grafana_explore_correlation_editor_saved",{sourceDatasourceType:S.type,targetDataSourceType:O.type})}).catch(b=>{E((0,r.dx)((0,o.gi)("Error creating correlation",b))),console.error(b)})}}}},62860:(G,I,e)=>{"use strict";e.d(I,{YR:()=>f,wh:()=>y});var t=e(65307),n=e(14110),s=e(11134),r=e(87490),o=e(18380),m=e(31678),l=e(57288),i=e(62256),u=e(23994),d=e(89224),p=e(34028);const c=(0,t.VP)("explore/updateDatasourceInstance"),y=(0,m.createAsyncThunk)("explore/changeDatasource",async({datasource:P,exploreId:a,options:E},{getState:g,dispatch:h})=>{const D=g().user.orgId,{history:v,instance:C}=await(0,p.BE)(D,P),T=g().explore.panes[a].datasourceInstance;(0,n.rR)("explore_change_ds",{from:(T?.meta?.mixed?"mixed":T?.type)||"unknown",to:C.meta.mixed?"mixed":C.type,exploreId:a}),h(c({exploreId:a,datasourceInstance:C,history:v}));const S=g().explore.panes[a].queries,O=(0,p.dq)(C.uid,S),x=await(0,o.J6)(O);h((0,i.Fb)({exploreId:a,correlations:x.correlations||[]})),E?.importQueries&&await h((0,u.y2)(a,S,T,C)),g().explore.panes[a].isLive&&h((0,d.hO)({exploreId:a,refreshInterval:s.cC.offOption.value})),E?.importQueries&&h((0,u.Od)({exploreId:a}))}),f=(P,a)=>{if(c.match(a)){const{datasourceInstance:E,history:g}=a.payload;return(0,r._u)(P.querySubscription),{...P,datasourceInstance:E,graphResult:null,tableResult:null,logsResult:null,supplementaryQueries:(0,l.Ez)(),queryResponse:(0,p.RA)(),queryKeys:[],history:g}}return P}},62256:(G,I,e)=>{"use strict";e.d(I,{EA:()=>c,Fb:()=>a,Gd:()=>g,LJ:()=>h,QZ:()=>E,fx:()=>p,nE:()=>y});var t=e(65307),n=e(87490),s=e(18380),r=e(32901),o=e(31678),m=e(62860),l=e(23994),i=e(89224),u=e(34028);const d=(0,t.VP)("explore/changeSize"),p=(0,t.VP)("explore/changePanels");function c(D,v,C){return async(T,S)=>{const O=S().explore.panes[D];if(O===void 0)return;const{panelsState:x}=O;T(p({exploreId:D,panelsState:{...x,[v]:C}}))}}const y=(0,t.VP)("explore/changeCorrelationHelperData"),f=(0,t.VP)("explore/initializeExploreAction"),P=(0,t.VP)("explore/setUrlReplaced"),a=(0,t.VP)("explore/saveCorrelationsAction");function E(D,{width:v}){return d({exploreId:D,width:v})}const g=(0,o.createAsyncThunk)("explore/initializeExplore",async({exploreId:D,datasource:v,queries:C,range:T,panelsState:S,correlationHelperData:O,eventBridge:x},{dispatch:b,getState:M,fulfillWithValue:A})=>{let R,B=[];if(v){const U=M().user.orgId,W=await(0,u.BE)(U,v);R=W.instance,B=W.history}if(b(f({exploreId:D,queries:C,range:(0,u.eO)(T,(0,r.O)(M().user)),datasourceInstance:R,history:B,eventBridge:x})),S!==void 0&&b(p({exploreId:D,panelsState:S})),b((0,i.JA)({exploreId:D})),R){const U=(0,u.dq)(R.uid,C),W=await(0,s.J6)(U);b(a({exploreId:D,correlations:W.correlations||[]})),b((0,l.Od)({exploreId:D}))}return O!==void 0&&M().explore.correlationEditorDetails?.editorMode&&b(y({exploreId:D,correlationEditorHelperData:O})),A({exploreId:D,state:M().explore.panes[D]})}),h=(D=(0,u.HZ)(),v)=>{if(D=(0,l.JQ)(D,v),D=(0,m.YR)(D,v),D=(0,i.QP)(D,v),d.match(v)){const C=v.payload.width;return{...D,containerWidth:C}}if(p.match(v)){const{panelsState:C}=v.payload;return{...D,panelsState:C}}if(y.match(v)){const{correlationEditorHelperData:C}=v.payload;return{...D,correlationEditorHelperData:C}}if(a.match(v))return{...D,correlations:v.payload.correlations};if(f.match(v)){const{queries:C,range:T,datasourceInstance:S,history:O,eventBridge:x}=v.payload;return{...D,range:T,queries:C,initialized:!0,eventBridge:x,queryKeys:(0,n.dY)(C),datasourceInstance:S,history:O,queryResponse:(0,u.RA)(),cache:[],correlations:[]}}return D}},72433:(G,I,e)=>{"use strict";e.d(I,{Bj:()=>E,H9:()=>u,PA:()=>P,Uu:()=>y,VM:()=>d,fP:()=>a,jX:()=>c,ri:()=>l,s1:()=>p,sh:()=>i,wk:()=>f});var t=e(65307),n=e(81523),s=e(11401),r=e(29436);const o=(0,t.VP)("explore/historyUpdated"),m=({updatedQuery:g,deletedId:h})=>async(D,v)=>{const C=v().explore.richHistory,T=C.map(O=>O.id===g?.id?g:O).filter(O=>O.id!==h),S=C.length-T.length;D((0,r.U2)({richHistoryResults:{richHistory:T,total:v().explore.richHistoryTotal-S}}))},l=(g,h,D,v,C)=>async(T,S)=>{const O=C?{quotaExceededError:!1,limitExceededWarning:!1,otherErrors:!1}:{quotaExceededError:!S().explore.richHistoryStorageFull,limitExceededWarning:!S().explore.richHistoryLimitExceededWarningShown},{richHistoryStorageFull:x,limitExceeded:b}=await(0,n.l0)({localOverride:g,datasource:{uid:h,name:D},queries:v,starred:!1,showNotif:O});C||(x&&T((0,r.fj)()),b&&T((0,r.D)()))},i=(g,h)=>async(D,v)=>{const C=await(0,n.oU)(g,h);D(m({updatedQuery:C}))},u=(g,h)=>async D=>{const v=await(0,n.cX)(g,h);D(m({updatedQuery:v}))},d=g=>async h=>{const D=await(0,n.NC)(g);h(m({deletedId:D}))},p=()=>async g=>{await(0,n.X1)(),g((0,r.U2)({richHistoryResults:{richHistory:[],total:0}})),g((0,r.U2)({richHistoryResults:{richHistory:[],total:0}}))},c=()=>async(g,h)=>{const D=h().explore.richHistorySearchFilters;if(D){const v=await(0,n.DI)(D);g((0,r.U2)({richHistoryResults:v}))}},y=()=>async(g,h)=>{const D=h().explore.richHistorySearchFilters,v=h().explore.richHistory;if(D&&v){const C={...D,page:(D?.page||1)+1},T=await(0,n.DI)(C),S=[...v,...T.richHistory];g((0,r.Ju)({filters:C})),g((0,r.U2)({richHistoryResults:{richHistory:S,total:T.total}}))}},f=()=>async g=>{g((0,r.Ju)({filters:void 0})),g((0,r.U2)({richHistoryResults:{richHistory:[],total:0}}))},P=()=>async(g,h)=>{let D=h().explore.richHistorySettings;D||(D=await(0,n.Gx)(),g((0,r.bZ)(D)))},a=g=>async h=>{h((0,r.bZ)(g)),await(0,n.rs)(g)},E=g=>async(h,D)=>{await h((0,r.Ju)({filters:{...g}}));const v=D().explore.richHistorySettings;(0,s.gQ)().lastUsedDataSourcesAvailable&&await h(a({...v,lastUsedDatasourceFilters:g.datasourceFilters}))}},29436:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>B,D:()=>P,J8:()=>v,JA:()=>D,Ju:()=>E,U2:()=>y,Ve:()=>T,am:()=>x,bZ:()=>a,fj:()=>f,nD:()=>g,ow:()=>b,qz:()=>c,tP:()=>h,ve:()=>S});var t=e(65307),n=e(2543),s=e.n(n),r=e(18226),o=e(12131),m=e(87490),l=e(23989),i=e(31678),u=e(27649),d=e(62256),p=e(34028);const c=(0,t.VP)("explore/syncTimes"),y=(0,t.VP)("explore/richHistoryUpdated"),f=(0,t.VP)("explore/richHistoryStorageFullAction"),P=(0,t.VP)("explore/richHistoryLimitExceededAction"),a=(0,t.VP)("explore/richHistorySettingsUpdated"),E=(0,t.VP)("explore/richHistorySearchFiltersUpdatedAction"),g=(0,t.VP)("explore/splitSizeUpdateAction"),h=(0,t.VP)("explore/maximizePaneAction"),D=(0,t.VP)("explore/evenPaneResizeAction"),v=(0,t.VP)("explore/splitClose"),C=(0,t.VP)("explore/setPaneState"),T=(0,t.VP)("explore/clearPanes"),S=(0,i.createAsyncThunk)("explore/splitOpen",async(U,{getState:W,dispatch:N})=>{const w=Object.values(W().explore.panes)[0],L=U?.queries??w?.queries??[];Object.keys(W().explore.panes).forEach((k,j)=>{j>=1&&N(v(k))});const V=U?.range||w?.range.raw||p.kn;let K=(0,m.o$)();for(;W().explore.panes[K];)K=(0,m.o$)();await N(O({exploreId:K,datasource:U?.datasourceUid||w?.datasourceInstance?.getRef(),queries:(0,u.v)(L),range:V,panelsState:U?.panelsState||w?.panelsState,correlationHelperData:U?.correlationHelperData,eventBridge:new r.o})),w?.range&&await N(c({syncedTimes:(0,n.isEqual)(w.range.raw,V)}))}),O=(0,i.createAsyncThunk)("explore/createNewSplitOpen",async(U,{dispatch:W})=>{await W((0,d.Gd)(U))}),x=(0,t.VP)("explore/changeCorrelationEditorDetails"),b=(U,W)=>async N=>{const{timeRange:w,getExploreUrl:L,openInNewWindow:V}=W,K=await L({queries:U.targets,dsRef:U.datasource,scopedVars:U.scopedVars,timeRange:w,adhocFilters:(0,l.w)().getAdhocFilters(U.datasource?.uid??"",!0)});if(V&&K){V(K);return}o.Ny.push(K)},M=(0,p.HZ)(),A={syncedTimes:!1,panes:{},correlationEditorDetails:{editorMode:!1,correlationDirty:!1,queryEditorDirty:!1,isExiting:!1},richHistoryStorageFull:!1,richHistoryLimitExceededWarningShown:!1,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,richHistory:[]},B={explore:(U=A,W)=>{if(v.match(W)){const{[W.payload]:w,...L}={...U.panes};return{...U,panes:L,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,syncedTimes:!1}}if(g.match(W)){const{largerExploreId:w}=W.payload;return{...U,largerExploreId:w,maxedExploreId:void 0,evenSplitPanes:w===void 0}}if(h.match(W)){const{exploreId:w}=W.payload;return{...U,largerExploreId:w,maxedExploreId:w,evenSplitPanes:!1}}if(D.match(W))return{...U,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0};if(c.match(W))return{...U,syncedTimes:W.payload.syncedTimes};if(f.match(W))return{...U,richHistoryStorageFull:!0};if(P.match(W))return{...U,richHistoryLimitExceededWarningShown:!0};if(a.match(W)){const w=W.payload;return{...U,richHistorySettings:w}}if(y.match(W)){const{richHistory:w,total:L}=W.payload.richHistoryResults;return{...U,richHistory:w,richHistoryTotal:L}}if(E.match(W)){const w=W.payload.filters;return{...U,richHistorySearchFilters:w}}if(O.pending.match(W))return{...U,panes:{...U.panes,[W.meta.arg.exploreId]:M}};if(d.Gd.pending.match(W)){const w=Object.entries(U.panes),L=w.slice(0,W.meta.arg.position),V=w.slice(L.length),K=[...L,[W.meta.arg.exploreId,M],...V].reduce((k,[j,H])=>({...k,[j]:H}),{});return{...U,panes:K}}if(T.match(W))return{...U,panes:{}};if(x.match(W)){const{editorMode:w,label:L,description:V,canSave:K,correlationDirty:k,queryEditorDirty:j,isExiting:H,postConfirmAction:J,transformations:X}=W.payload;return{...U,correlationEditorDetails:{editorMode:!!(w??U.correlationEditorDetails?.editorMode),canSave:!!(K??U.correlationEditorDetails?.canSave),label:L??U.correlationEditorDetails?.label,description:V??U.correlationEditorDetails?.description,transformations:X??U.correlationEditorDetails?.transformations,correlationDirty:!!(k??U.correlationEditorDetails?.correlationDirty),queryEditorDirty:!!(j??U.correlationEditorDetails?.queryEditorDirty),isExiting:!!(H??U.correlationEditorDetails?.isExiting),postConfirmAction:J}}}const N=W.payload?.exploreId;return typeof N=="string"?{...U,panes:Object.entries(U.panes).reduce((w,[L,V])=>({...w,[L]:L===N?(0,d.LJ)(V,W):V}),{})}:U}}},23994:(G,I,e)=>{"use strict";e.d(I,{_0:()=>oe,He:()=>Lt,hS:()=>Ee,bO:()=>Be,IL:()=>Qt,rR:()=>nt,y2:()=>We,Az:()=>an,PD:()=>Ke,JQ:()=>ut,S6:()=>pt,Od:()=>ft,GI:()=>Xt,q9:()=>Ae,h1:()=>le,qk:()=>Dt,Rk:()=>Ft,h9:()=>Xe,TO:()=>gn});var t=e(65307),n=e(32017),s=e.n(n),r=e(2543),o=e(49510),m=e(62467),l=e(58307),i=e(69862),u=e(99165),d=e(39070),p=e(73372),c=e(47232),y=e(9557),f=e(40187),P=e(26272),a=e(14236),E=e(80822),g=e(19347),h=e(32264),D=e(14110),v=e(33390),C=e(87490),T=e(80582),S=e(18380),O=e(31193),x=e(32901),b=e(65650),M=e(14678),A=e(31678),R=e(82467),B=e(3169),U=e(39374),W=e(97186),N=e(81160),w=e(57875),L=e(91890),V=e(57934),K=e(11261),k=e(69147),j=e(91002),H=e(15162);const J=ht=>{const Rt=[],_t=[],on=[],ln=[],bn=[],In=[],Mn=[],vt=[];for(const nn of ht.series){if(te(nn)){vt.push(nn);continue}switch(nn.meta?.preferredVisualisationType){case"logs":ln.push(nn);break;case"graph":Rt.push(nn);break;case"trace":bn.push(nn);break;case"table":_t.push(nn);break;case"rawPrometheus":on.push(nn);break;case"nodeGraph":In.push(nn);break;case"flamegraph":Mn.push(nn);break;default:z(nn)&&Rt.push(nn),_t.push(nn)}}return{...ht,graphFrames:Rt,tableFrames:_t,logsFrames:ln,traceFrames:bn,nodeGraphFrames:In,customFrames:vt,flameGraphFrames:Mn,rawPrometheusFrames:on,graphResult:null,tableResult:null,logsResult:null,rawPrometheusResult:null}},X=({showCorrelationEditorLinks:ht,queries:Rt,correlations:_t,defaultTargetDatasource:on})=>ln=>{if(ht&&on)for(const bn of ln.series)for(const In of bn.fields){In.config.links=[],In.display=In.display||(0,w.H)();const Mn={};bn.fields.map(vt=>{Mn[`${vt.name}`]=`\${__data.fields.['${vt.name}']}`}),In.config.links.push({url:"",origin:L.x0.ExploreCorrelationsEditor,title:`Correlate with ${In.name}`,internal:{datasourceUid:on.uid,datasourceName:on.name,query:{datasource:{uid:on.uid}},meta:{correlationData:{resultField:In.name,vars:Mn,origVars:Mn}}}})}else if(Rt?.length&&_t?.length){const bn=(0,r.mapValues)((0,r.groupBy)(Rt,"refId"),"0.datasource.uid");(0,S.cA)(ln.series,_t,bn)}return ln},se=ht=>ht.graphFrames.length?{...ht,graphResult:ht.graphFrames}:{...ht,graphResult:null},ae=ht=>{if(ht.tableFrames.length===0)return(0,m.of)({...ht,tableResult:null});ht.tableFrames.sort((ln,bn)=>{const In=ln.refId,Mn=bn.refId;return In>Mn?1:In<Mn?-1:0});const Rt=ht.tableFrames.every(ln=>z(ln)),_t={interpolate:ln=>ln};return(Rt?(0,m.of)(ht.tableFrames).pipe(V.c.joinByFieldTransformer.operator({},_t)):(0,m.of)(ht.tableFrames).pipe(V.c.mergeTransformer.operator({},_t))).pipe((0,N.T)(ln=>{for(const bn of ln)for(const In of bn.fields)In.display=In.display??(0,w.J)({field:In,theme:h.$.theme2,timeZone:ht.request?.timezone??"browser"});return{...ht,tableResult:ln}}))},ne=ht=>{const Rt=ht.rawPrometheusFrames;if(!Rt||Rt.length===0)return(0,m.of)({...ht,tableResult:null});Rt.sort((bn,In)=>{const Mn=bn.refId,vt=In.refId;return Mn>vt?1:Mn<vt?-1:0});const _t=Rt.every(bn=>z(bn)),on={interpolate:bn=>bn};return(_t?(0,m.of)(Rt).pipe(V.c.joinByFieldTransformer.operator({},on)):(0,m.of)(Rt).pipe(V.c.mergeTransformer.operator({},on))).pipe((0,N.T)(bn=>{const In=bn[0];for(const Mn of In.fields)Mn.display=Mn.display??(0,w.J)({field:Mn,theme:h.$.theme2,timeZone:ht.request?.timezone??"browser"});return{...ht,rawPrometheusResult:In}}))},q=(ht={})=>Rt=>{if(Rt.logsFrames.length===0)return{...Rt,logsResult:null};const _t=Rt.request?.intervalMs,on=(0,k.HT)(Rt.logsFrames,_t,ht.absoluteRange,ht.queries,ht.deduplicate),ln=(0,C.uE)(ht.refreshInterval),bn=(0,j.zy)(on,ln),In=bn.rows,Mn=bn.series,vt={...bn,rows:In,series:Mn};return{...Rt,logsResult:vt}};function ee(ht,Rt,_t,on,ln,bn,In){return(0,m.of)(ht).pipe((0,N.T)(Mn=>(0,a.N$)(Mn,Rt)),(0,N.T)(X({defaultTargetDatasource:In,showCorrelationEditorLinks:bn,queries:on,correlations:ln})),(0,N.T)(J),(0,N.T)(se),(0,N.T)(_t),(0,i.Z)(ne),(0,i.Z)(ae))}function z(ht){const Rt=(0,r.groupBy)(ht.fields,_t=>_t.type);return!!(Object.keys(Rt).length===2&&Rt[K.PU.time]?.length===1&&Rt[K.PU.number])}function te(ht){return ht.meta?.preferredVisualisationPluginId?(0,H.oZ)(ht.meta?.preferredVisualisationPluginId):!1}var ie=e(57288),ce=e(324),ue=e(62256),fe=e(72433),Te=e(29436),he=e(89224),de=e(34028);const le=ht=>Rt=>{const _t=Rt.explore.panes[ht];return _t&&_t.queryResponse?_t.queryResponse.state===d.Gu.Loading||_t.queryResponse.state===d.Gu.Streaming:!1},pe=(0,t.VP)("explore/addQueryRow"),ve=(0,t.VP)("explore/changeQueries"),be=(0,t.VP)("explore/cancelQueries"),Oe=(0,t.VP)("explore/queriesImported"),Me=(0,t.VP)("explore/queryStoreSubscription"),Ue=(0,t.VP)("explore/setSupplementaryQueryEnabledAction"),we=(0,t.VP)("explore/storeSupplementaryQueryDataProviderAction"),Re=(0,t.VP)("explore/cleanSupplementaryQueryDataProviderAction"),Fe=(0,t.VP)("explore/cleanSupplementaryQueryAction"),xe=(0,t.VP)("explore/storeSupplementaryQueryDataSubscriptionAction"),Ve=(0,t.VP)("explore/updateSupplementaryQueryDataAction"),$e=(0,t.VP)("explore/queryStreamUpdated"),Xe=(0,t.VP)("explore/setQueries"),gt=(0,t.VP)("changeLoadingState"),Dt=(0,t.VP)("explore/setPausedState"),nt=(0,t.VP)("explore/clearLogs"),at=(0,t.VP)("explore/scanStart"),Ae=(0,t.VP)("explore/scanStop"),re=(0,t.VP)("explore/addResultsToCache"),Z=(0,t.VP)("explore/clearCache");function oe(ht,Rt){return async(_t,on)=>{const ln=on().explore.panes[ht];let bn;ln.datasourceInstance?.meta.mixed?bn=(0,r.findLast)(ln.queries,Mn=>!!Mn.datasource)?.datasource||void 0:bn=ln.datasourceInstance?.getRef();const In=await(0,C.Ll)(ln.queries,Rt,bn);_t(pe({exploreId:ht,index:Rt,query:In}))}}function Ee(ht){return(Rt,_t)=>{Rt(Ae({exploreId:ht})),Rt(be({exploreId:ht}));const on=_t().explore.panes[ht].supplementaryQueries;for(const ln of ie.VW)Rt(Re({exploreId:ht,type:ln})),on[ln]?.data?.state!==d.Gu.Done&&Rt(Fe({exploreId:ht,type:ln}))}}const ye=(ht,Rt)=>{const _t=ht.getRef();return Rt.map(on=>({...on,datasource:_t}))},Se=async(ht,Rt,_t)=>{let on=[];if(Rt.meta?.id===ht.meta?.id)on=_t;else if((0,p.Ee)(Rt)&&(0,p.FL)(ht)){const ln=await Rt.exportToAbstractQueries(_t);on=await ht.importFromAbstractQueries(ln)}else ht.importQueries&&(on=await ht.importQueries(_t,Rt));return ye(ht,on)},Be=(0,A.createAsyncThunk)("explore/changeQueries",async({queries:ht,exploreId:Rt},{getState:_t,dispatch:on})=>{let ln=!1;const bn=_t().explore.panes[Rt].queries,In=_t().explore.panes[Rt].datasourceInstance?.uid,Mn=_t().explore.correlationEditorDetails,vt=Mn?.editorMode||!1;!(Object.keys(_t().explore.panes)[0]===Rt)&&vt&&!Mn?.queryEditorDirty&&on((0,Te.am)({queryEditorDirty:!0}));for(const cn of ht)for(const mt of bn){if(cn.refId===mt.refId&&cn.datasource?.type!==mt.datasource?.type){const lt=await(0,g.l)().get(mt.datasource),Tt=await(0,g.l)().get({uid:cn.datasource?.uid});await on(We(Rt,bn,lt,Tt,cn.refId)),ln=!0}if(In===M.uv&&cn.refId===mt.refId&&cn.datasource?.uid!==mt.datasource?.uid){const lt=(0,de.dq)(M.uv,ht),Tt=await(0,S.J6)(lt);on((0,ue.Fb)({exploreId:Rt,correlations:Tt.correlations||[]}))}}ln||on(ve({queries:ht,exploreId:Rt})),ht.length<bn.length&&on(ft({exploreId:Rt}))}),We=(ht,Rt,_t,on,ln)=>async bn=>{if(!_t){bn(Oe({exploreId:ht,queries:Rt}));return}let In=Rt;if(on.uid===M.uv)In=Rt.map(vt=>({...vt,datasource:_t.getRef()}));else if(_t.uid===M.uv){const vt=(0,r.groupBy)(Rt,cn=>cn.datasource?.uid),nn=await Promise.all(Object.keys(vt).map(async cn=>{const mt=await(0,g.l)().get({uid:cn});return await Se(on,mt,vt[cn])}));In=(0,r.flatten)(nn.filter(cn=>cn.length>0))}else{let vt=Rt;if(ln!==void 0){const nn=Rt.find(cn=>cn.refId===ln);nn&&(vt=[nn])}In=await Se(on,_t,vt)}let Mn=await(0,C.di)(In,on.getRef());if(ln!==void 0){In.length===0&&(In=[await(0,C.Ll)([],void 0,on.getRef())]);const vt=Rt.findIndex(cn=>cn.refId===ln),nn={...Mn[0],refId:Rt[vt].refId};Mn=[...Rt],Mn[vt]=nn}return bn(Oe({exploreId:ht,queries:Mn})),Mn};function Ke(ht,Rt,_t){return async(on,ln)=>{const bn=ln().explore.panes[ht],{queries:In}=bn,vt=(await Promise.all(In.map(nn=>_t({...nn},Rt)))).map((nn,cn)=>(0,C.eF)(nn,In,cn));on(Xe({exploreId:ht,queries:vt})),Rt.preventSubmit||on(ft({exploreId:ht}))}}function it(ht,Rt){if(!(ht.filterQuery&&!ht.filterQuery(Rt)))return Rt}async function rt(ht,Rt,_t,on){const bn=(await Promise.all(on.map(async In=>{if(In.datasource?.uid===_t.uid)return it(_t,In);{const Mn=await(0,O.tR)().get(In.datasource);return it(Mn,In)}}))).filter(In=>!!In);bn.length>0&&(ht((0,fe.ri)(!0,_t.uid,_t.name,bn,h.$.queryHistoryEnabled)),h.$.queryHistoryEnabled&&ht((0,fe.ri)(!1,_t.uid,_t.name,bn,!1)),await ht((0,fe.jX)()))}const ft=(0,A.createAsyncThunk)("explore/runQueries",async({exploreId:ht,preserveCache:Rt},{dispatch:_t,getState:on})=>{_t(Ee(ht));const{defaultCorrelationEditorDatasource:ln,scopedVars:bn,showCorrelationEditorLinks:In}=await(0,de.aj)(on(),ht),Mn=(0,ce.M)(ht);_t((0,he.JA)({exploreId:ht})),Rt!==!0&&_t(Qt(ht));const nn=on().explore.panes[ht],{datasourceInstance:cn,containerWidth:mt,isLive:lt,range:Tt,scanning:Vt,queryResponse:zt,querySubscription:rn,refreshInterval:mn,absoluteRange:dt,cache:wt,supplementaryQueries:en}=nn;let En,yt;const At=nn.queries.map(Jt=>({...Jt,datasource:Jt.datasource||cn?.getRef()}));cn!=null&&rt(_t,on().explore,cn,At);const Kt=(0,de.rk)(wt,dt);if(Kt)En=(0,o.z)([(0,m.of)(Kt),Mn]).pipe((0,i.Z)(([Jt,Mt])=>ee(Jt,zt,q({absoluteRange:dt,refreshInterval:mn,queries:At}),At,Mt,In,ln))),yt=En.subscribe(Jt=>{_t($e({exploreId:ht,response:Jt}))});else{if(!(0,C.zT)(At)||!cn)return;const Jt=cn?.interval;(0,C._u)(rn);const Mt={minInterval:Jt,maxDataPoints:mt,liveStreaming:lt},Je=(0,x.O)(on().user),Nn=(0,C.bI)(ht,At,Mt,Tt,Vt,Je,bn);if(_t(gt({exploreId:ht,loadingState:d.Gu.Loading})),En=(0,o.z)([(0,U.BN)(cn,Nn.request).pipe(lt?(0,u.c)(500):l.D),Mn]).pipe((0,i.Z)(([xn,Fn])=>ee(xn,zt,q({absoluteRange:dt,refreshInterval:mn,queries:At}),At,Fn,In,ln))),yt=En.subscribe({next(xn){const Fn=on().explore.panes[ht];if(xn.logsResult!==null&&xn.state===d.Gu.Done&&(0,D.rR)("grafana_explore_logs_result_displayed",{datasourceType:cn.type,visualisationType:Fn?.panelsState?.logs?.visualisationType??v.A.get(W.r)??"N/A",length:xn.logsResult.rows.length,defaultVisualisationType:h.$.featureToggles.logsExploreTableDefaultVisualization?"table":"logs"}),_t($e({exploreId:ht,response:xn})),Fn.scanning)if(xn.state===d.Gu.Done&&xn.series.length===0){const wn=(0,T.Wb)(-1,Fn.range);_t((0,he.JA)({exploreId:ht,absoluteRange:wn})),_t(ft({exploreId:ht}))}else _t(Ae({exploreId:ht}))},error(xn){_t((0,R.dx)((0,B.gi)("Query processing error",xn))),_t(gt({exploreId:ht,loadingState:d.Gu.Error})),console.error(xn)},complete(){on().explore.panes[ht].queryResponse.state===d.Gu.Loading&&_t(gt({exploreId:ht,loadingState:d.Gu.Done}))}}),lt)for(const xn of ie.VW)_t(Re({exploreId:ht,type:xn})),_t(Fe({exploreId:ht,type:xn}));else _t(qe({exploreId:ht,datasourceInstance:cn,transaction:Nn,newQuerySource:En,supplementaryQueries:en,queries:At,absoluteRange:dt}))}_t(Me({exploreId:ht,querySubscription:yt}))}),pt=(0,A.createAsyncThunk)("explore/runLoadMoreQueries",async({exploreId:ht,absoluteRange:Rt},{dispatch:_t,getState:on})=>{_t(Ee(ht));const{datasourceInstance:ln,containerWidth:bn,queryResponse:In}=on().explore.panes[ht],{defaultCorrelationEditorDatasource:Mn,scopedVars:vt,showCorrelationEditorLinks:nn}=await(0,de.aj)(on(),ht),cn=(0,ce.M)(ht);let mt;const lt=In.logsResult?.queries||[],Tt=In.logsFrames.map(wt=>wt.refId),Vt=lt.filter(wt=>Tt.includes(wt.refId)).map(wt=>({...wt,datasource:wt.datasource||ln?.getRef(),refId:wt.refId,supportingQueryType:b.Q$.InfiniteScroll}));if(!(0,C.zT)(Vt)||!ln)return;const zt={minInterval:ln?.interval,maxDataPoints:bn},rn=(0,x.O)(on().user),mn=(0,C.zq)(rn,{from:(0,c.oZ)(rn,Rt.from),to:(0,c.oZ)(rn,Rt.to)},(0,x.q)(on().user)),dt=(0,C.bI)(ht,Vt,zt,mn,!1,rn,vt);_t(gt({exploreId:ht,loadingState:d.Gu.Loading})),mt=(0,o.z)([(0,U.BN)(ln,dt.request),cn]).pipe((0,i.Z)(([wt,en])=>wt.state!==d.Gu.Done?(0,m.of)({...In,state:d.Gu.Loading}):ee((0,E._k)(In,wt),In,q({absoluteRange:Rt,queries:lt,deduplicate:!0}),Vt,en,nn,Mn))),mt.subscribe({next(wt){_t($e({exploreId:ht,response:wt}))},error(wt){_t((0,R.dx)((0,B.gi)("Query processing error",wt))),_t(gt({exploreId:ht,loadingState:d.Gu.Error})),console.error(wt)},complete(){_t(gt({exploreId:ht,loadingState:d.Gu.Done}))}})}),Ge=async(ht,Rt)=>{const _t=ht.filter(ln=>ln.datasource?.uid!==M.uv),on=(0,r.groupBy)(_t,"datasource.uid");return await Promise.all(Object.values(on).map(async ln=>({datasource:await(0,g.l)().get(ln[0].datasource,Rt),targets:ln})))},qe=(0,A.createAsyncThunk)("explore/handleSupplementaryQueries",async({datasourceInstance:ht,exploreId:Rt,transaction:_t,newQuerySource:on,supplementaryQueries:ln,queries:bn,absoluteRange:In},{dispatch:Mn})=>{let vt;ht.meta.mixed?vt=await Ge(_t.request.targets,_t.request.scopedVars):vt=[{datasource:ht,targets:_t.request.targets}];for(const nn of ie.VW){const cn=(0,ie.Pm)(vt,nn,{..._t.request,requestId:`${_t.request.requestId}_${(0,r.snakeCase)(nn)}`},on);cn?(Mn(we({exploreId:Rt,type:nn,dataProvider:cn})),bt(ln[nn].data,bn,In)||(Mn(Fe({exploreId:Rt,type:nn})),ln[nn].enabled&&Mn(an(Rt,nn)))):Mn(Re({exploreId:Rt,type:nn}))}});function bt(ht,Rt,_t){if(!ht)return!1;const on=(0,r.zipObject)((0,r.map)(Rt,"refId"),Rt),ln=(0,r.mapValues)((0,r.groupBy)(ht.data.map(vt=>vt.meta?.custom?.sourceQuery),"refId"),r.head),bn=ht.data.every(vt=>vt.meta?.custom?.logsVolumeType===y.Aj.FullRange),In=s()(on,ln),Mn=ht.data.every(vt=>{const nn=vt.meta?.custom?.absoluteRange;return nn?nn&&nn.from<=_t.from&&_t.to<=nn.to:!0});return bn&&In&&Mn}function Ft(ht,Rt){return(_t,on)=>{const ln=on().explore.panes[ht].queries,bn=Rt.map((In,Mn)=>(0,C.eF)(In,ln,Mn));_t(Xe({exploreId:ht,queries:bn})),_t(ft({exploreId:ht}))}}function Xt(ht){return(Rt,_t)=>{Rt(at({exploreId:ht}));const on=(0,T.Wb)(-1,_t().explore.panes[ht].range);Rt((0,he.JA)({exploreId:ht,absoluteRange:on})),Rt(ft({exploreId:ht}))}}function Lt(ht){return(Rt,_t)=>{const on=_t().explore.panes[ht].queryResponse,ln=_t().explore.panes[ht].absoluteRange,bn=(0,de.O2)(ln);on.state===d.Gu.Done&&Rt(re({exploreId:ht,cacheKey:bn,queryResponse:on}))}}function Qt(ht){return(Rt,_t)=>{Rt(Z({exploreId:ht}))}}function an(ht,Rt){return(_t,on)=>{const{supplementaryQueries:ln}=on().explore.panes[ht],bn=ln[Rt].dataProvider;if(bn){const In=bn.subscribe({next:Mn=>{_t(Ve({exploreId:ht,type:Rt,data:Mn}))}});_t(xe({exploreId:ht,type:Rt,dataSubscription:In}))}}}function gn(ht,Rt,_t){return(on,ln)=>{on(Ue({exploreId:ht,enabled:Rt,type:_t})),(0,ie.Oi)(Rt,_t),Rt&&on(an(ht,_t))}}const ut=(ht,Rt)=>{if(pe.match(Rt)){const{queries:_t}=ht,{index:on,query:ln}=Rt.payload,bn=[..._t.slice(0,on+1),{...ln},..._t.slice(on+1)];return{...ht,queries:bn,queryKeys:(0,C.dY)(bn)}}if(ve.match(Rt)){const{queries:_t}=Rt.payload;return{...ht,queries:_t}}if(be.match(Rt))return(0,C._u)(ht.querySubscription),{...ht,...ht.queryResponse?{queryResponse:{...ht.queryResponse,state:d.Gu.Done}}:{}};if(Xe.match(Rt)){const{queries:_t}=Rt.payload;return{...ht,queries:_t.slice(),queryKeys:(0,C.dY)(_t)}}if(Me.match(Rt)){const{querySubscription:_t}=Rt.payload;return{...ht,querySubscription:_t}}if(Ue.match(Rt)){const{enabled:_t,type:on}=Rt.payload,{supplementaryQueries:ln}=ht,bn=ln[on].dataSubscription;!_t&&bn&&bn.unsubscribe();const In={...ln,[on]:{...ln[on],enabled:_t,data:void 0}};return{...ht,supplementaryQueries:In}}if(we.match(Rt)){const{dataProvider:_t,type:on}=Rt.payload,{supplementaryQueries:ln}=ht,bn=ln[on];bn?.dataSubscription&&bn.dataSubscription.unsubscribe();const In={...ln,[on]:{...bn,dataProvider:_t,dataSubscription:void 0}};return{...ht,supplementaryQueries:In}}if(Re.match(Rt)){const{type:_t}=Rt.payload,{supplementaryQueries:on}=ht,ln=on[_t];ln?.dataSubscription&&ln.dataSubscription.unsubscribe();const bn={...on,[_t]:{...ln,dataProvider:void 0,dataSubscription:void 0}};return{...ht,supplementaryQueries:bn}}if(Fe.match(Rt)){const{type:_t}=Rt.payload,{supplementaryQueries:on}=ht,ln={...on,[_t]:{...on[_t],data:void 0}};return{...ht,supplementaryQueries:ln}}if(xe.match(Rt)){const{dataSubscription:_t,type:on}=Rt.payload,{supplementaryQueries:ln}=ht,bn={...ln,[on]:{...ln[on],dataSubscription:_t}};return{...ht,supplementaryQueries:bn}}if(Ve.match(Rt)){let{data:_t,type:on}=Rt.payload;const{supplementaryQueries:ln}=ht,bn={...ln,[on]:{...ln[on],data:_t}};return{...ht,supplementaryQueries:bn}}if($e.match(Rt))return Nt(ht,Rt);if(Oe.match(Rt)){const{queries:_t}=Rt.payload;return{...ht,queries:_t,queryKeys:(0,C.dY)(_t)}}if(gt.match(Rt)){const{loadingState:_t}=Rt.payload;return{...ht,queryResponse:{...ht.queryResponse,state:_t}}}if(Dt.match(Rt)){const{isPaused:_t}=Rt.payload;return{...ht,isPaused:_t}}if(at.match(Rt))return{...ht,scanning:!0};if(Ae.match(Rt))return{...ht,scanning:!1,scanRange:void 0};if(re.match(Rt)){const{cache:on}=ht,{queryResponse:ln,cacheKey:bn}=Rt.payload;let In=[...on];return In.some(vt=>vt.key===bn)||(In=[{key:bn,value:ln},...In].slice(0,5)),{...ht,cache:In}}if(Z.match(Rt))return{...ht,cache:[]};if(nt.match(Rt)){if(!ht.logsResult)return{...ht,clearedAtIndex:null};if(ht.queryResponse.state===d.Gu.Loading)return{...ht,clearedAtIndex:null,logsResult:{...ht.logsResult,rows:[]}};const _t=ht.clearedAtIndex?ht.clearedAtIndex+ht.logsResult.rows.length:ht.logsResult.rows.length-1;return{...ht,clearedAtIndex:_t,logsResult:{...ht.logsResult,rows:[]}}}return ht},Nt=(ht,Rt)=>{const{response:_t}=Rt.payload,{request:on,series:ln,error:bn,graphResult:In,logsResult:Mn,tableResult:vt,rawPrometheusResult:nn,traceFrames:cn,nodeGraphFrames:mt,flameGraphFrames:lt,rawPrometheusFrames:Tt,customFrames:Vt}=_t;if(bn){if(bn.type===f.v2.Timeout||bn.type===f.v2.Cancelled)return{...ht};h.$.angularSupportEnabled&&ht.datasourceInstance?.components?.QueryCtrl&&ht.eventBridge.emit(P.ee.dataError,bn)}if(!on)return{...ht};if(h.$.angularSupportEnabled&&ht.datasourceInstance?.components?.QueryCtrl){const zt=ln.map(rn=>(0,a.w3)(rn));ht.eventBridge.emit(P.ee.dataReceived,zt)}return{...ht,queryResponse:_t,graphResult:In,tableResult:vt,rawPrometheusResult:nn,logsResult:ht.isLive&&Mn?{...Mn,rows:(0,de.pg)(ht.clearedAtIndex,Mn.rows)}:Mn,showLogs:!!Mn,showMetrics:!!In,showTable:!!vt?.length,showTrace:!!cn.length,showNodeGraph:!!mt.length,showRawPrometheus:!!Tt.length,showFlameGraph:!!lt.length,showCustom:!!Vt?.length,clearedAtIndex:ht.isLive?ht.clearedAtIndex:null}}},9955:(G,I,e)=>{"use strict";e.d(I,{Jr:()=>d,K6:()=>l,Kl:()=>y,Qb:()=>r,i6:()=>m,pF:()=>i,qq:()=>p,st:()=>u,vC:()=>c});var t=e(25508),n=e(2543),s=e.n(n);const r=f=>f.explore.panes,o=f=>f.explore,m=f=>f.explore.richHistorySettings,l=(0,t.Mz)(r,Object.entries),i=(0,t.Mz)(l,f=>f.length>1),u=(0,t.Mz)(l,f=>f.some(P=>P[1].correlationEditorHelperData!==void 0)),d=f=>(0,t.Mz)(r,P=>Object.keys(P)[0]===f),p=f=>(0,t.Mz)(r,P=>P[f]),c=(0,t.Mz)(o,f=>f.correlationEditorDetails),y=(0,t.Mz)(l,f=>{const P=f.map(([g,h])=>{const D=[h?.datasourceInstance?.getRef()],v=h?.queries.map(T=>T.datasource)||[],C=[...D,...v].filter(T=>!!T);if(!(C===void 0||C.length===0))return{exploreId:g,datasources:(0,n.uniqBy)(C,T=>T.uid)}}).filter(g=>!!g),E=(0,n.uniqBy)((0,n.flatten)(P.map(g=>g.datasources)),g=>g.uid).map(g=>{let h=[];return P.forEach(D=>{D.datasources.some(v=>v.uid===g.uid)&&h.push(D.exploreId)}),{datasource:g,exploreIds:h}});return{exploreToDS:P,dsToExplore:E}})},89224:(G,I,e)=>{"use strict";e.d(I,{$_:()=>T,GA:()=>b,GH:()=>g,Iy:()=>S,JA:()=>D,QP:()=>M,Xk:()=>x,eM:()=>a,hO:()=>E,iO:()=>v,ke:()=>O,zY:()=>h});var t=e(65307),n=e(47232),s=e(26272),r=e(39070),o=e(72574),m=e(11134),l=e(76412),i=e(28138),u=e(87490),d=e(80582),p=e(74856),c=e(91002),y=e(32901),f=e(29436),P=e(23994);const a=(0,t.VP)("explore/changeRange"),E=(0,t.VP)("explore/changeRefreshInterval"),g=A=>(R,B)=>{const{syncedTimes:U}=B().explore;U?Object.keys(B().explore.panes).forEach(W=>{R(D({...A,exploreId:W})),R((0,P.Od)({exploreId:W,preserveCache:!0}))}):(R(D({...A})),R((0,P.Od)({exploreId:A.exploreId,preserveCache:!0})))},h=A=>R=>{R((0,P.S6)({...A}))},D=A=>(R,B)=>{const{exploreId:U,absoluteRange:W,rawRange:N}=A,w=B().explore.panes[U],L=(0,y.O)(B().user),V=(0,y.q)(B().user),{range:K}=w;let k=K.raw;W&&(k={from:(0,n.oZ)(L,W.from),to:(0,n.oZ)(L,W.to)}),N&&(k=N);const j=(0,u.zq)(L,k,V),H={from:j.from.valueOf(),to:j.to.valueOf()};(0,p.jG)().init({timepicker:{},getTimezone:()=>L,timeRangeUpdated(J){},time:j.raw}),(0,o.w)().updateTimeRange(j),R(a({exploreId:U,range:j,absoluteRange:H}))};function v(A){return(R,B)=>{const U=B().explore.panes[A].range.raw;Object.keys(B().explore.panes).filter(N=>N!==A).forEach(N=>{R(g({exploreId:N,rawRange:U}))});const W=B().explore.syncedTimes;R((0,f.qz)({syncedTimes:!W}))}}function C(A){return(R,B)=>{const U=(0,y.O)(B().user),W=(0,y.q)(B().user);Object.entries(B().explore.panes).forEach(([N,w])=>{const L=(0,u.zq)(U,w.range.raw,W);A(N,w,L,R)})}}function T(){return C((A,R,B,U)=>{const W={from:B.from.valueOf(),to:B.to.valueOf()};U(g({exploreId:A,absoluteRange:W}))})}function S(A){return C((R,B,U,W)=>{const N=(0,d.Wb)(A,U);W(g({exploreId:R,absoluteRange:N}))})}function O(A){return C((R,B,U,W)=>{const N=(0,d.Zk)(U,A);W(g({exploreId:R,absoluteRange:N}))})}function x(){return(A,R)=>{const B=R().explore.panes[Object.keys(R().explore.panes)[0]].range.raw;navigator.clipboard.writeText(JSON.stringify(B)),i.A.emit(s.r1.alertSuccess,[(0,l.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}}function b(){return async(A,R)=>{const{range:B,isError:U}=await(0,d.zG)();if(U===!0){i.A.emit(s.r1.alertError,[(0,l.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,l.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:B})]);return}if(R().explore.syncedTimes){A(g({exploreId:Object.keys(R().explore.panes)[0],rawRange:B})),A(g({exploreId:Object.keys(R().explore.panes)[1],rawRange:B}));return}A(g({exploreId:Object.keys(R().explore.panes)[0],rawRange:B}))}}const M=(A,R)=>{if(E.match(R)){const{refreshInterval:B}=R.payload,U=m.cC.isLive(B),W=(0,u.uE)(B),N=(0,c.zy)(A.logsResult,W);return m.cC.isLive(A.refreshInterval)&&!U&&(0,u._u)(A.querySubscription),{...A,refreshInterval:B,queryResponse:{...A.queryResponse,state:U?r.Gu.Streaming:r.Gu.Done},isLive:U,isPaused:U?!1:A.isPaused,logsResult:N}}if(a.match(R)){const{range:B,absoluteRange:U}=R.payload;return{...A,range:B,absoluteRange:U}}return A}},34028:(G,I,e)=>{"use strict";e.d(I,{BE:()=>v,HZ:()=>h,O2:()=>C,RA:()=>D,Z9:()=>O,aj:()=>A,dq:()=>M,eO:()=>S,kn:()=>a,ng:()=>g,pg:()=>b,rk:()=>T});var t=e(2543),n=e.n(t),s=e(39070),r=e(43127),o=e(85858),m=e(47232),l=e(19347),i=e(11401),u=e(81523),d=e(14678),p=e(33390),c=e(87490),y=e(31193),f=e(57288);const P=100,a={from:"now-1h",to:"now"},E="grafana.explore.style.graph",g=R=>{p.A.set(E,R)},h=R=>({containerWidth:0,datasourceInstance:null,history:[],queries:[],initialized:!1,range:{from:null,to:null,raw:a},absoluteRange:{from:null,to:null},scanning:!1,queryKeys:[],isLive:!1,isPaused:!1,queryResponse:D(),tableResult:null,graphResult:null,logsResult:null,clearedAtIndex:null,rawPrometheusResult:null,eventBridge:null,cache:[],supplementaryQueries:(0,f.Ez)(),panelsState:{},correlations:void 0,...R}),D=()=>({state:s.Gu.NotStarted,series:[],timeRange:(0,r.E2)(),graphFrames:[],logsFrames:[],traceFrames:[],nodeGraphFrames:[],flameGraphFrames:[],customFrames:[],tableFrames:[],rawPrometheusFrames:[],rawPrometheusResult:null,graphResult:null,logsResult:null,tableResult:null});async function v(R,B){let U;try{U=await(0,y.tR)().get(B)}catch{U=await(0,y.tR)().get()}if(U.init)try{U.init()}catch(L){console.error(L)}let W=[];const N=(0,i.tU)(),w=await N.getRichHistory({search:"",sortOrder:u.xB.Ascending,datasourceFilters:[U.name],starred:!1});if((w.total||0)>0&&w.richHistory.forEach(L=>{L.queries.forEach(V=>{W.push({ts:parseInt(L.id,10),query:V})})}),W.length<P){const L=await N.getRichHistory({search:"",sortOrder:u.xB.Ascending,datasourceFilters:[d.uv],starred:!1});(L.total||0)>0&&L.richHistory.forEach(V=>{V.queries.forEach(K=>{K?.datasource?.uid===U.uid&&W.push({ts:parseInt(V.id,10),query:K})})})}if(W.length<P){const L=`grafana.explore.history.${U.meta?.id}`;W=[...W,...p.A.getObject(L,[])]}return W.length>P&&(W.length=P),(0,c.dr)(R,U.uid),{history:W,instance:U}}function C(R){const B={from:R.from,to:R.to};return Object.entries(B).map(([W,N])=>`${encodeURIComponent(W)}=${encodeURIComponent(N.toString())}`).join("&")}function T(R,B){const U=C(B),W=R.findIndex(w=>w.key===U);return W>=0?R[W].value:void 0}function S(R,B){return{from:o.parse(R.from,!1,B),to:o.parse(R.to,!0,B),raw:R}}function O(R){let B=a,U={from:x(R.from),to:x(R.to)};return U.from!==null&&U.to!==null&&(B={from:U.from,to:U.to}),B}function x(R){if(R===null)return null;if((0,m.Ar)(R))return R;if(typeof R!="string")return null;const B=R;if(B.indexOf("now")!==-1)return B;if(B.length===8)return(0,m.yT)(B,"YYYYMMDD");if(B.length===15)return(0,m.yT)(B,"YYYYMMDDTHHmmss");if(B.length===19)return(0,m.yT)(B,"YYYY-MM-DD HH:mm:ss");if(B.match(/^\d+$/)){const W=parseInt(B,10);return(0,m.yT)(W)}const U=(0,m.yT)(B);return U.isValid()?U:null}const b=(R,B)=>B?R?B.slice(R+1):B:[],M=(R,B)=>R===d.uv?(0,t.uniq)(B.map(U=>U.datasource?.uid).filter(U=>!!U)):[R];async function A(R,B){const U=R.explore.panes[B].correlationEditorHelperData,W=R.explore.correlationEditorDetails?.editorMode||!1,N=Object.keys(R.explore.panes)[0]===B,w=W&&N,L=w?await(0,l.l)().get():void 0,V=W&&!N&&U!==void 0;let K={};return V&&U!==void 0&&Object.entries(U?.vars).forEach(k=>{K[k[0]]={value:k[1]}}),{defaultCorrelationEditorDatasource:L,scopedVars:K,showCorrelationEditorLinks:w}}},96192:(G,I,e)=>{"use strict";e.d(I,{JQ:()=>v,O1:()=>T,QL:()=>h,YV:()=>g,_O:()=>x});var t=e(2543),n=e.n(t),s=e(96540),r=e(92461),o=e(91890),m=e(41987),l=e(6709),i=e(76885),u=e(72574),d=e(14110),p=e(16233),c=e(67023),y=e(6923),f=e(39590);const a=[b=>!b.internal||p.TP.hasAccessToExplore()],E="grafana_data_link_clicked",g=(b,M)=>R=>{const{field:B,dataLinkScopedVars:U,frame:W,link:N,linkModel:w}=R,{valueRowIndex:L}=R.config;if(!N.internal||L===void 0)return w;const V=h({field:B,rowIndex:L,splitOpenFn:b,range:M,vars:U,dataFrame:W,linksToProcess:[N]});return V.length?(0,t.first)(V):void 0},h=b=>{const{field:M,vars:A,splitOpenFn:R,range:B,rowIndex:U,dataFrame:W}=b,N={...A||{}};N.__value={value:{raw:M.values[U]},text:"Raw value"};let w;W&&(w=(0,r.F)({frame:W,rowIndex:U}),N.__data={value:{name:W.name,refId:W.refId,fields:w},text:"Data"},W.fields.forEach(V=>{w&&w[V.name]&&(N[V.name]={value:w[V.name]})}),N.__targetField={value:w[M.name]});const L=b.linksToProcess||M.config.links;return L?L.filter(k=>a.every(j=>j(k,N))).map(k=>{if(k.internal){let j={};k.internal?.transformations&&k.internal?.transformations.forEach(ae=>{let ne;ae.field?ne=W?.fields.find(ee=>ee.name===ae.field)?.values[U]:ne=M.values[U],j={...j,...(0,c.k)(ae,ne,M.name)}});const H={...N,...j},J=T(k,H);let X=[];if(J.variables.length===0){const ae=M.name.toString();X.push({variableName:ae,value:"",match:""})}else X=J.variables;const se=ae=>{(0,d.rR)(E,{origin:k.origin||o.x0.Datasource,app:m.Jk.Explore,internal:!0}),R?.(ae)};return J.allVariablesDefined?{...(0,l.u)({link:k,internalLink:k.internal,scopedVars:H,range:B,field:M,onClickFn:b.splitOpenFn?ne=>se(ne):void 0,replaceVariables:(0,u.w)().replace.bind((0,u.w)())}),variables:X}:void 0}else{const j=(J,X)=>(0,u.w)().replace(J,{...X,...N}),H=(0,y.mQ)().getDataLinkUIModel(k,j,M);return H.title||(H.title=D(H.href)),H}}).filter(k=>!!k):[]};function D(b){b.indexOf("://")<0&&(b=`http://${b}`);let M;try{M=new URL(b).hostname}catch{M=b}return M}function v(b,M){return(0,s.useCallback)((A,R)=>A.fields.flatMap(B=>B.config?.links&&B.config?.links.length?h({field:B,rowIndex:R,range:b,dataFrame:A,splitOpenFn:M}):[]),[b,M])}const C=["__from","__to","__interval","__interval_ms","__org","__user","__range","__rate_interval","__timeFilter","timeFilter"];function T(b,M){let A=[];return(0,u.w)().replace.bind((0,u.w)())(S(b),M,void 0,A),A=(0,t.uniqBy)(A,"variableName"),{variables:A,allVariablesDefined:A.filter(B=>!C.includes(B.variableName)).every(B=>B.found)}}function S(b){let M="",A;for(A in b)typeof b[A]=="string"?M+=" "+b[A]:typeof b[A]=="object"&&(M+=" "+S(b[A]));return M}const O=b=>b[1]!==void 0,x=b=>{const M=Object.entries(b).filter(O).map(([A,R])=>{const B=(0,f.m)(R);return B.range={to:R.range.to.valueOf().toString(),from:R.range.from.valueOf().toString()},[A,B]}).reduce((A,[R,B])=>({...A,[R]:B}),{});return i.kM.renderUrl("/explore",{schemaVersion:1,panes:JSON.stringify(M)})}},27649:(G,I,e)=>{"use strict";e.d(I,{v:()=>n});var t=e(77789);function n(s){const r=new Set(s.map(o=>o.refId).filter(Boolean));return r.size===s.length?s:(r.clear(),s.map(o=>{if(o.refId&&!r.has(o.refId))return r.add(o.refId),o;const m=(0,t.M)(s);return r.add(m),{...o,refId:m}}))}},57288:(G,I,e)=>{"use strict";e.d(I,{Ez:()=>f,Oi:()=>y,Pm:()=>E,VW:()=>p});var t=e(2543),n=e.n(t),s=e(88483),r=e(44240),o=e(6276),m=e(29405),l=e(9557),i=e(39070),u=e(33390),d=e(69147);const p=[l.cF.LogsVolume,l.cF.LogsSample],c=g=>`grafana.explore.logs.enable${g}`,y=(g,h)=>{u.A.set(c(h),g?"true":"false")},f=()=>{let g={[l.cF.LogsVolume]:{enabled:!0},[l.cF.LogsSample]:{enabled:!1}};for(const h of p){if(h===l.cF.LogsSample)continue;u.A.get(c(h))==="false"&&(g[h]={enabled:!1})}return g},P=(g,h,D)=>new s.c(v=>g.subscribe(C=>{if(C.logsResult&&C.logsResult.rows&&C.logsResult.visibleRange&&C.logsResult.bucketSize!==void 0&&C.state===i.Gu.Done){const T=C.logsResult.bucketSize,S=h.map(b=>b.refId),O=(0,t.groupBy)(C.logsResult.rows,"dataFrame.refId");let x=[];S.forEach(b=>{if(O[b]?.length){const M=(0,d.J9)(O[b],T);x=[...x,...M];const A={logsVolumeType:l.Aj.Limited,absoluteRange:C.logsResult?.visibleRange,datasourceName:D,sourceQuery:h.find(R=>R.refId===b)};v.next({data:x.map(R=>{const B=R.meta?.custom||{};return{...R,meta:{custom:{...B,...A}}}}),state:C.state})}}),v.complete()}})),a=(g,h,D,v)=>{if(g===l.cF.LogsVolume)return P(h,D,v)},E=(g,h,D,v)=>{const T=g.map(({datasource:S,targets:O},x)=>{const b=(0,t.cloneDeep)(D);if(b.requestId=`${b.requestId||""}_${x}`,b.targets=O,(0,l.Nc)(S,h)){if(S.getDataProvider)return S.getDataProvider(h,b);if(S.getSupplementaryRequest){const M=S.getSupplementaryRequest(h,b);return M?h===l.cF.LogsVolume?(0,d.sg)(S,M,{targets:b.targets}):(0,d.Wr)(S,M):void 0}else return}else return a(h,v,O,S.name)}).filter(i.zz);if(T.length!==0)return T.length===1?T[0]:(0,r.h)(...T).pipe((0,m.S)((S,O)=>S.errors&&S.errors.length||O.state===i.Gu.NotStarted?S:O.state===i.Gu.Loading&&S.state===i.Gu.NotStarted?{...S,state:i.Gu.Loading}:O.state&&O.state!==i.Gu.Done?S:{...S,data:[...S.data,...O.data],state:i.Gu.Done},{data:[],state:i.Gu.NotStarted}),(0,o.d)())}},53478:(G,I,e)=>{"use strict";e.d(I,{Ex:()=>T,$i:()=>C});var t=e(65474),n=e(69862),s=e(43429),r=e(26657),o=e(72574),m=e(19347),l=e(96540),i=e(14186),u=e(21594),d=e(98808),p=e(71680),c=e(1712),y=e(34263),f=e(18225),P=e(76658),a=e(66718),E=e(76942);const g=15;function h(){const S=(0,l.useRef)({}),O=(0,l.useCallback)(b=>{switch(b){case a.Tz.math:case a.Tz.reduce:case a.Tz.resample:case a.Tz.threshold:case a.Tz.sql:return S.current[b];case a.Tz.classic:return}},[]),x=(0,l.useCallback)((b,M)=>{switch(b){case a.Tz.math:S.current.math=M;break;case a.Tz.reduce:case a.Tz.resample:case a.Tz.resample:S.current.reduce=M,S.current.resample=M,S.current.threshold=M;break;case a.Tz.sql:S.current.sql=M}},[]);return{getCachedExpression:O,setCachedExpression:x}}function D(S){const{query:O,queries:x,onRunQuery:b,onChange:M}=S,{getCachedExpression:A,setCachedExpression:R}=h();(0,l.useEffect)(()=>{R(O.type,O.expression)},[O.expression,O.type,R]);const B=(0,l.useCallback)(N=>{const w=A(N.value),L=(0,E.r)({...O,type:N.value});M({...L,expression:w??L.expression})},[O,M,A]),U=()=>{const N=x.filter(w=>O.refId!==w.refId).map(w=>({value:w.refId,label:w.refId}));switch(O.type){case a.Tz.math:return l.createElement(p.z,{onChange:M,query:O,labelWidth:g,onRunQuery:b});case a.Tz.reduce:return l.createElement(c.Z,{refIds:N,onChange:M,labelWidth:g,query:O});case a.Tz.resample:return l.createElement(y.C,{query:O,labelWidth:g,onChange:M,refIds:N});case a.Tz.classic:return l.createElement(d.z,{onChange:M,query:O,refIds:N});case a.Tz.threshold:return l.createElement(P.O,{onChange:M,query:O,labelWidth:g,refIds:N});case a.Tz.sql:return l.createElement(f.k,{onChange:M,query:O,refIds:N})}},W=a.uQ.find(N=>N.value===O.type);return l.createElement("div",null,l.createElement(i.I,{label:"Operation",labelWidth:g},l.createElement(u.l6,{options:a.uQ,value:W,onChange:B,width:25})),U())}class v extends r.iy{constructor(O){super(O),this.instanceSettings=O}applyTemplateVariables(O,x){const b=(0,o.w)();return{...O,expression:b.replace(O.expression,x),window:b.replace(O.window,x)}}getCollapsedText(O){return`Expression: ${O.type}`}query(O){let x=O.targets.map(async M=>{const A=await(0,m.l)().get(M.datasource);return A.interpolateVariablesInQueries?A?.interpolateVariablesInQueries([M],O.scopedVars,O.filters)[0]:M});return(0,t.H)(Promise.all(x)).pipe((0,n.Z)(M=>super.query({...O,targets:M})))}newQuery(O){return{refId:"--",datasource:r.dR,type:O?.type??a.Tz.math,...O}}}const C={id:-100,uid:a.Uj,name:r.dR.name,type:r.dR.type,access:"proxy",meta:{baseUrl:"",module:"",type:s.QE.datasource,name:r.dR.type,id:r.dR.type,info:{author:{name:"Grafana Labs"},logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"},description:"Adds expression support to Grafana",screenshots:[],links:[],updated:"",version:""}},jsonData:{},readOnly:!0},T=new v(C);T.meta={id:r.dR.type,info:{logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"}}},T.components={QueryEditor:D}},98808:(G,I,e)=>{"use strict";e.d(I,{z:()=>h});var t=e(96540),n=e(39268),s=e(14186),r=e(55852),o=e(14578),m=e(76942),l=e(32196),i=e(40845),u=e(67061),d=e(9261),p=e(21594),c=e(10354),y=e(55907);const f=y.A.reducerTypes.map(D=>({label:D.text,value:D.value})),P=y.A.evalOperators.map(D=>({label:D.text,value:D.value})),a=y.A.evalFunctions.map(D=>({label:D.text,value:D.value})),E=({condition:D,index:v,onChange:C,onRemoveCondition:T,refIds:S})=>{const O=(0,i.of)(g),x=W=>{C({...D,operator:{type:W.value}})},b=W=>{C({...D,reducer:{type:W.value,params:[]}})},M=W=>{C({...D,query:{params:[W.value]}})},A=W=>{C({...D,evaluator:{params:D.evaluator.params,type:W.value}})},R=(W,N)=>{const w=parseFloat(W.currentTarget.value),L=[...D.evaluator.params];L[N]=w,C({...D,evaluator:{...D.evaluator,params:L}})},B=(0,l.css)`
    width: 60px;
  `,U=D.evaluator.type===y.p.IsWithinRange||D.evaluator.type===y.p.IsOutsideRange;return t.createElement(u.B,null,t.createElement("div",{style:{flex:1}},t.createElement(n.C,null,v===0?t.createElement("div",{className:(0,l.cx)(O.button,B)},"WHEN"):t.createElement(d.f,{className:(0,l.cx)(O.buttonSelectText,B),options:P,onChange:x,value:P.find(W=>W.value===D.operator.type)}),t.createElement(p.l6,{options:f,onChange:b,width:20,value:f.find(W=>W.value===D.reducer.type)}),t.createElement("div",{className:O.button},"OF"),t.createElement(p.l6,{onChange:M,options:S,width:"auto",value:S.find(W=>W.value===D.query.params[0])})),t.createElement(n.C,null,t.createElement(d.f,{className:O.buttonSelectText,options:a,onChange:A,value:a.find(W=>W.value===D.evaluator.type)}),U?t.createElement(t.Fragment,null,t.createElement(c.p,{type:"number",width:10,onChange:W=>R(W,0),value:D.evaluator.params[0]}),t.createElement("div",{className:O.button},"TO"),t.createElement(c.p,{type:"number",width:10,onChange:W=>R(W,1),value:D.evaluator.params[1]})):D.evaluator.type!==y.p.HasNoValue?t.createElement(c.p,{type:"number",width:10,onChange:W=>R(W,0),value:D.evaluator.params[0]}):null)),t.createElement(r.$n,{variant:"secondary",type:"button",onClick:()=>T(v)},t.createElement(o.I,{name:"trash-alt"})))},g=D=>{const v=(0,l.css)`
    color: ${D.colors.primary.text};
    font-size: ${D.typography.bodySmall.fontSize};
  `;return{buttonSelectText:v,button:(0,l.cx)((0,l.css)`
        display: flex;
        align-items: center;
        border-radius: ${D.shape.radius.default};
        font-weight: ${D.typography.fontWeightMedium};
        border: 1px solid ${D.colors.border.weak};
        white-space: nowrap;
        padding: 0 ${D.spacing(1)};
        background-color: ${D.colors.background.canvas};
      `,v)}},h=({onChange:D,query:v,refIds:C})=>{const T=(x,b)=>{v.conditions&&D({...v,conditions:[...v.conditions.slice(0,b),x,...v.conditions.slice(b+1)]})},S=()=>{if(v.conditions){const x=v.conditions.at(-1)?.query?.params??[],b={...m.P,query:{params:x}};D({...v,conditions:v.conditions.length>0?[...v.conditions,b]:[b]})}},O=x=>{if(v.conditions){const b=v.conditions[x],M=v.conditions.filter(A=>A!==b).map((A,R)=>R===0?{...A,operator:{type:"when"}}:A);D({...v,conditions:M})}};return t.createElement("div",null,t.createElement(n.C,null,t.createElement(s.I,{label:"Conditions",labelWidth:14},t.createElement("div",null,v.conditions?.map((x,b)=>{if(x)return t.createElement(E,{key:b,index:b,condition:x,onChange:M=>T(M,b),onRemoveCondition:O,refIds:C})})))),t.createElement(r.$n,{variant:"secondary",type:"button",onClick:S},t.createElement(o.I,{name:"plus-circle"})))}},71680:(G,I,e)=>{"use strict";e.d(I,{z:()=>p});var t=e(32196),n=e(96540),s=e(40845),r=e(67061),o=e(14186),m=e(76892),l=e(60782),i=e(14578),u=e(21744);const d="Math operations on one or more queries. You reference the query by ${refId} ie. $A, $B, $C etc\nThe sum of two scalar values: $A + $B > 10",p=({labelWidth:P,onChange:a,query:E,onRunQuery:g})=>{const h=C=>{a({...E,expression:C.target.value})},D=(0,s.of)(y),v=()=>{E.expression&&g()};return n.createElement(r.B,null,n.createElement(o.I,{label:n.createElement(m.c,{width:"auto"},n.createElement(l.G,{fitContent:!0,content:n.createElement("div",{className:D.documentationContainer},n.createElement("div",null,"Run math operations on one or more queries. You reference the query by ","${refId}"," ie. $A, $B, $C etc.",n.createElement("br",null),"Example: ",n.createElement("code",null,"$A + $B")),n.createElement("header",{className:D.documentationHeader},"Available Math functions"),n.createElement("div",{className:D.documentationFunctions},n.createElement(c,{name:"abs",description:"returns the absolute value of its argument which can be a number or a series"}),n.createElement(c,{name:"is_inf",description:"returns 1 for Inf values (negative or positive) and 0 for other values. It's able to operate on series or scalar values."}),n.createElement(c,{name:"is_nan",description:"returns 1 for NaN values and 0 for other values. It's able to operate on series or scalar values."}),n.createElement(c,{name:"is_null",description:"returns 1 for null values and 0 for other values. It's able to operate on series or scalar values."}),n.createElement(c,{name:"is_number",description:"returns 1 for all real number values and 0 for non-number. It's able to operate on series or scalar values."}),n.createElement(c,{name:"log",description:"returns the natural logarithm of its argument, which can be a number or a series"}),n.createElement(c,{name:"inf, infn, nan, and null",description:"The inf for infinity positive, infn for infinity negative, nan, and null functions all return a single scalar value that matches its name."}),n.createElement(c,{name:"round",description:"returns a rounded integer value. It's able to operate on series or escalar values."}),n.createElement(c,{name:"ceil",description:"rounds the number up to the nearest integer value. It's able to operate on series or escalar values."}),n.createElement(c,{name:"floor",description:"rounds the number down to the nearest integer value. It's able to operate on series or escalar values."}))),title:n.createElement(r.B,{gap:1,direction:"row"},n.createElement(i.I,{name:"book-open"})," Math operator"),footer:n.createElement("div",null,"See our additional documentation on"," ",n.createElement("a",{className:D.documentationLink,target:"_blank",href:"https://grafana.com/docs/grafana/latest/panels/query-a-data-source/use-expressions-to-manipulate-data/about-expressions/#math",rel:"noreferrer"},n.createElement(i.I,{size:"xs",name:"external-link-alt"})," Math expressions"),"."),closeButton:!0,placement:"bottom-start"},n.createElement("div",{className:D.info},"Expression ",n.createElement(i.I,{name:"info-circle"})))),labelWidth:P,grow:!0,shrink:!0},n.createElement(u.f,{value:E.expression,onChange:h,rows:1,placeholder:d,onBlur:v,style:{minWidth:250,lineHeight:"26px",minHeight:32}})))},c=({name:P,description:a})=>{const E=(0,s.of)(f);return n.createElement(n.Fragment,null,n.createElement("span",{className:E.name},P),n.createElement("span",{className:E.description},a))},y=P=>({documentationHeader:(0,t.css)`
    font-size: ${P.typography.h5.fontSize};
    font-weight: ${P.typography.h5.fontWeight};
  `,documentationLink:(0,t.css)`
    color: ${P.colors.text.link};
  `,documentationContainer:(0,t.css)`
    display: flex;
    flex: 1;
    flex-direction: column;
    gap: ${P.spacing(2)};

    padding: ${P.spacing(1)} ${P.spacing(2)};
  `,documentationFunctions:(0,t.css)`
    display: grid;
    grid-template-columns: max-content auto;
    column-gap: ${P.spacing(2)};
  `,info:(0,t.css)`
    display: flex;
    flex-direction: row;
    align-items: center;
    cursor: pointer;
    gap: ${P.spacing(1)};
  `}),f=P=>({name:(0,t.css)`
    font-weight: ${P.typography.fontWeightBold};
  `,description:(0,t.css)`
    font-size: ${P.typography.bodySmall.fontSize};
    color: ${P.colors.text.disabled};
  `})},1712:(G,I,e)=>{"use strict";e.d(I,{Z:()=>l});var t=e(96540),n=e(14186),s=e(10354),r=e(39268),o=e(21594),m=e(66718);const l=({labelWidth:i="auto",onChange:u,refIds:d,query:p})=>{const c=m.Cu.find(D=>D.value===p.reducer),y=D=>{u({...p,expression:D.value})},f=D=>{u({...p,reducer:D.value})},P=D=>{u({...p,settings:D})},a=D=>{let v;switch(D.value){case m.Mt.ReplaceNonNumbers:let C=0;p.settings?.mode===m.Mt.ReplaceNonNumbers&&(C=p.settings?.replaceWithValue??0),v={mode:m.Mt.ReplaceNonNumbers,replaceWithValue:C};break;default:v={mode:D.value}}P(v)},E=D=>{const v=D.currentTarget.valueAsNumber;P({mode:m.Mt.ReplaceNonNumbers,replaceWithValue:v??0})},g=p.settings?.mode??m.Mt.Strict,h=()=>{if(g===m.Mt.ReplaceNonNumbers)return t.createElement(n.I,{label:"Replace With",labelWidth:i},t.createElement(s.p,{type:"number",width:10,onChange:E,value:p.settings?.replaceWithValue??0}))};return t.createElement(t.Fragment,null,t.createElement(r.C,null,t.createElement(n.I,{label:"Input",labelWidth:i},t.createElement(o.l6,{onChange:y,options:d,value:p.expression,width:"auto"}))),t.createElement(r.C,null,t.createElement(n.I,{label:"Function",labelWidth:i},t.createElement(o.l6,{options:m.Cu,value:c,onChange:f,width:20})),t.createElement(n.I,{label:"Mode",labelWidth:i},t.createElement(o.l6,{onChange:a,options:m.HZ,value:g,width:25})),h()))}},34263:(G,I,e)=>{"use strict";e.d(I,{C:()=>l});var t=e(96540),n=e(39268),s=e(14186),r=e(21594),o=e(10354),m=e(66718);const l=({labelWidth:i="auto",onChange:u,refIds:d,query:p})=>{const c=m.PN.find(g=>g.value===p.downsampler),y=m.iX.find(g=>g.value===p.upsampler),f=g=>{u({...p,window:g.target.value})},P=g=>{u({...p,expression:g.value})},a=g=>{u({...p,downsampler:g.value})},E=g=>{u({...p,upsampler:g.value})};return t.createElement(t.Fragment,null,t.createElement(n.C,null,t.createElement(s.I,{label:"Input",labelWidth:i},t.createElement(r.l6,{onChange:P,options:d,value:p.expression,width:20}))),t.createElement(n.C,null,t.createElement(s.I,{label:"Resample to",labelWidth:i,tooltip:"10s, 1m, 30m, 1h"},t.createElement(o.p,{onChange:f,value:p.window,width:15})),t.createElement(s.I,{label:"Downsample"},t.createElement(r.l6,{options:m.PN,value:c,onChange:a,width:25})),t.createElement(s.I,{label:"Upsample"},t.createElement(r.l6,{options:m.iX,value:y,onChange:E,width:25}))))}},18225:(G,I,e)=>{"use strict";e.d(I,{k:()=>s});var t=e(96540),n=e(6867);const s=({onChange:r,refIds:o,query:m})=>{const i=`select * from ${(0,t.useMemo)(()=>o.map(d=>d.value),[o])[0]} limit 1`,u=d=>{r({...m,expression:d})};return t.createElement(n.Y,{query:m.expression||i,onChange:u})}},76658:(G,I,e)=>{"use strict";e.d(I,{O:()=>O});var t=e(32196),n=e(96540),s=e(46819),r=e(40845),o=e(39268),m=e(14186),l=e(21594),i=e(9261),u=e(10354),d=e(15292),p=e(2913),c=e(55907),y=e(66718),f=e(65307);const P=(0,f.VP)("thresold/updateRefId"),a=(0,f.VP)("thresold/updateThresholdType"),E=(0,f.VP)("thresold/updateThresholdParams"),g=(0,f.VP)("thresold/updateHysteresis"),h=(0,f.VP)("thresold/updateUnloadParams"),D=(0,f.vy)({type:y.Tz.threshold,refId:"",conditions:[]},M=>{M.addCase(P,(A,R)=>{A.expression=R.payload}),M.addCase(a,(A,R)=>{const B=R.payload.evalFunction,U=R.payload.onError;if(A.conditions[0].evaluator.type=B,!!A.conditions[0].unloadEvaluator){const N=v(A.conditions[0].evaluator.type);U&&U(void 0),A.conditions[0].evaluator.type=B;const w={type:N,params:A.conditions[0].evaluator?.params??[0,0]};A.conditions[0].unloadEvaluator=w}}),M.addCase(E,(A,R)=>{const{param:B,index:U}=R.payload;A.conditions[0].evaluator.params[U]=B}),M.addCase(g,(A,R)=>{const{hysteresisChecked:B,onError:U}=R.payload;B?A.conditions[0].unloadEvaluator={type:v(A.conditions[0].evaluator.type),params:A.conditions[0].evaluator?.params??[0,0]}:(A.conditions[0].unloadEvaluator=void 0,U&&U(void 0))}),M.addCase(h,(A,R)=>{const{param:B,index:U,onError:W}=R.payload;A.conditions[0].unloadEvaluator?A.conditions[0].unloadEvaluator.params[U]=B:A.conditions[0].unloadEvaluator={type:v(A.conditions[0].evaluator.type),params:A.conditions[0].evaluator?.params??[0,0]};const N=C(A.conditions[0]),{errorMsg:w,errorMsgFrom:L,errorMsgTo:V}=N??{};W&&W(w||L||V)})});function v(M){return M===c.p.IsAbove?c.p.IsBelow:M===c.p.IsBelow?c.p.IsAbove:M===c.p.IsWithinRange?c.p.IsOutsideRange:M===c.p.IsOutsideRange?c.p.IsWithinRange:c.p.IsBelow}function C(M){const{unloadEvaluator:A,evaluator:R}=M;if(!R)return;if(A?.params[0]===void 0||Number.isNaN(A?.params[0]))return{errorMsg:"This value cannot be empty"};const{type:B,params:U}=R,{params:W}=A;if(B===c.p.IsWithinRange||B===c.p.IsOutsideRange){if(W[0]===void 0||Number.isNaN(W[0]))return{errorMsgFrom:"This value cannot be empty"};if(W[1]===void 0||Number.isNaN(W[1]))return{errorMsgTo:"This value cannot be empty"}}const[N,w]=A.params,[L,V]=U;switch(B){case c.p.IsAbove:if(N>L)return{errorMsg:`Enter a number less than or equal to ${L}`};break;case c.p.IsBelow:if(N<L)return{errorMsg:`Enter a number more than or equal to ${L}`};break;case c.p.IsOutsideRange:if(N<L)return{errorMsgFrom:`Enter a number more than or equal to ${L}`};if(w>V)return{errorMsgTo:`Enter a number less than or equal to ${V}`};break;case c.p.IsWithinRange:if(N>L)return{errorMsgFrom:`Enter a number less than or equal to ${L}`};if(w<V)return{errorMsgTo:`Enter a number be more than or equal to ${V}`};break;default:throw new Error(`evaluator function type ${B} not supported.`)}}const T=c.p.IsAbove,S={type:"query",evaluator:{type:T,params:[0,0]},query:{params:[]},reducer:{params:[],type:"last"}},O=({labelWidth:M,onChange:A,refIds:R,query:B,onError:U,useHysteresis:W=!1})=>{const N=(0,r.of)(b),w={...B,conditions:B.conditions?.length?B.conditions:[S]},[L,V]=(0,n.useReducer)(D,w),K=L.conditions[0],k=y.zd.find(ne=>ne.value===L.conditions[0].evaluator?.type),j=ne=>{V(P(ne.value))};(0,n.useEffect)(()=>{L&&A(L)},[L]);const H=ne=>{V(a({evalFunction:ne.value??T,onError:U}))},J=(ne,q)=>{V(E({param:parseFloat(ne.currentTarget.value),index:q}))},X=K.evaluator.type===c.p.IsWithinRange||K.evaluator.type===c.p.IsOutsideRange,se=!!p.config.featureToggles?.recoveryThreshold&&W;return n.createElement(n.Fragment,null,n.createElement(o.C,null,n.createElement(m.I,{label:"Input",labelWidth:M},n.createElement(l.l6,{onChange:j,options:R,value:B.expression,width:20}))),n.createElement(o.C,null,n.createElement(i.f,{className:N.buttonSelectText,options:y.zd,onChange:H,value:k}),X?n.createElement(n.Fragment,null,n.createElement(u.p,{type:"number",width:10,onChange:ne=>J(ne,0),defaultValue:K.evaluator.params[0]}),n.createElement("div",{className:N.button},"TO"),n.createElement(u.p,{type:"number",width:10,onChange:ne=>J(ne,1),defaultValue:K.evaluator.params[1]})):n.createElement(u.p,{type:"number",width:10,onChange:ne=>J(ne,0),defaultValue:K.evaluator.params[0]||0})),se&&n.createElement(ae,{isRange:X,onError:U}));function ae({isRange:ne,onError:q}){const ee=!!K.unloadEvaluator,z=ce=>{V(g({hysteresisChecked:ce.currentTarget.checked,onError:q})),te.current=!0},te=n.useRef(!0),ie=()=>{te.current=!1};return n.createElement("div",{className:N.hysteresis},n.createElement("div",{onMouseDown:ie},n.createElement(d.K,{showLabel:!0,label:"Custom recovery threshold",value:ee,onChange:z,className:N.switch})),ee&&n.createElement(x,{isRange:ne,condition:K,onError:q,dispatch:V,allowOnblur:te}))}};function x({isRange:M,condition:A,onError:R,dispatch:B,allowOnblur:U}){const W=(0,r.of)(b),N=(H,J)=>{const X=parseFloat(H.currentTarget.value);B(h({param:X,index:J,onError:R}))},w=C(A),{errorMsg:L,errorMsgFrom:V,errorMsgTo:K}=w??{};if(M)return n.createElement(k,{allowOnblur:U});return n.createElement(j,{allowOnblur:U});function k({allowOnblur:H}){return A.evaluator.type===c.p.IsWithinRange?n.createElement(o.C,{className:W.hysteresis},n.createElement(m.I,{label:"Stop alerting when outside range",labelWidth:"auto"},n.createElement(s.B,{direction:"row",gap:0},n.createElement("div",{className:W.range},n.createElement(m.I,{invalid:!!V,error:V,className:W.noMargin},n.createElement(u.p,{type:"number",width:10,onBlur:J=>H.current&&N(J,0),defaultValue:A.unloadEvaluator?.params[0]}))),n.createElement("div",{className:W.button},"TO"),n.createElement("div",{className:W.range},n.createElement(m.I,{invalid:!!K,error:K},n.createElement(u.p,{type:"number",width:10,onBlur:J=>H.current&&N(J,1),defaultValue:A.unloadEvaluator?.params[1]})))))):n.createElement(o.C,{className:W.hysteresis},n.createElement(m.I,{label:"Stop alerting when inside range",labelWidth:"auto"},n.createElement(s.B,{direction:"row",gap:0},n.createElement("div",{className:W.range},n.createElement(m.I,{invalid:!!V,error:V},n.createElement(u.p,{type:"number",width:10,onBlur:J=>H.current&&N(J,0),defaultValue:A.unloadEvaluator?.params[0]}))),n.createElement("div",{className:W.button},"TO"),n.createElement("div",{className:W.range},n.createElement(m.I,{invalid:!!K,error:K},n.createElement(u.p,{type:"number",width:10,onBlur:J=>H.current&&N(J,1),defaultValue:A.unloadEvaluator?.params[1]}))))))}function j({allowOnblur:H}){return A.evaluator.type===c.p.IsAbove?n.createElement(o.C,{className:W.hysteresis},n.createElement(m.I,{label:"Stop alerting when below",labelWidth:"auto",invalid:!!L,error:L},n.createElement(u.p,{type:"number",width:10,onBlur:J=>{H.current&&N(J,0)},defaultValue:A.unloadEvaluator?.params[0]}))):n.createElement(o.C,{className:W.hysteresis},n.createElement(m.I,{label:"Stop alerting when above",labelWidth:"auto",invalid:!!L,error:L},n.createElement(u.p,{type:"number",width:10,onBlur:J=>{H.current&&N(J,0)},defaultValue:A.unloadEvaluator?.params[0]})))}}const b=M=>({buttonSelectText:(0,t.css)({color:M.colors.primary.text,fontSize:M.typography.bodySmall.fontSize,textTransform:"uppercase",padding:`0 ${M.spacing(1)}`}),button:(0,t.css)({height:"32px",color:M.colors.primary.text,fontSize:M.typography.bodySmall.fontSize,textTransform:"uppercase",display:"flex",alignItems:"center",borderRadius:M.shape.radius.default,fontWeight:M.typography.fontWeightBold,border:`1px solid ${M.colors.border.medium}`,whiteSpace:"nowrap",padding:`0 ${M.spacing(1)}`,backgroundColor:M.colors.background.primary}),range:(0,t.css)({width:"min-content"}),hysteresis:(0,t.css)({marginTop:M.spacing(2)}),switch:(0,t.css)({paddingLeft:M.spacing(1)}),noMargin:(0,t.css)({margin:0})})},69437:(G,I,e)=>{"use strict";e.d(I,{f:()=>s});var t=e(26657),n=e(66718);const s=r=>{if(!r)return!1;if((0,t.s9)(r.datasource))return!0;const o=r;return typeof o.type!="string"?!1:Object.values(n.Tz).includes(o.type)}},66718:(G,I,e)=>{"use strict";e.d(I,{Cu:()=>i,HZ:()=>d,Mt:()=>u,NI:()=>m,PN:()=>p,Tz:()=>o,Uj:()=>r,iX:()=>c,uQ:()=>l,zd:()=>y});var t=e(75059),n=e(2913),s=e(55907);const r="__expr__";var o=(f=>(f.math="math",f.reduce="reduce",f.resample="resample",f.classic="classic_conditions",f.threshold="threshold",f.sql="sql",f))(o||{});const m=f=>{switch(f){case"math":return"Math";case"reduce":return"Reduce";case"resample":return"Resample";case"classic_conditions":return"Classic condition (legacy)";case"threshold":return"Threshold";case"sql":return"SQL"}},l=[{value:"math",label:"Math",description:"Free-form math formulas on time series or number data."},{value:"reduce",label:"Reduce",description:"Takes one or more time series returned from a query or an expression and turns each series into a single number."},{value:"resample",label:"Resample",description:"Changes the time stamps in each time series to have a consistent time interval."},{value:"classic_conditions",label:"Classic condition (legacy)",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the condition. Disables multi-dimensional alerts for this rule."},{value:"threshold",label:"Threshold",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the threshold condition."},{value:"sql",label:"SQL",description:"Transform data using SQL. Supports Aggregate/Analytics functions from DuckDB"}].filter(f=>f.value==="sql"?n.config.featureToggles?.sqlExpressions:!0),i=[{value:t.gy.min,label:"Min",description:"Get the minimum value"},{value:t.gy.max,label:"Max",description:"Get the maximum value"},{value:t.gy.mean,label:"Mean",description:"Get the average value"},{value:t.gy.sum,label:"Sum",description:"Get the sum of all values"},{value:t.gy.count,label:"Count",description:"Get the number of values"},{value:t.gy.last,label:"Last",description:"Get the last value"}];var u=(f=>(f.Strict="",f.ReplaceNonNumbers="replaceNN",f.DropNonNumbers="dropNN",f))(u||{});const d=[{value:"",label:"Strict",description:"Result can be NaN if series contains non-numeric data"},{value:"dropNN",label:"Drop Non-numeric Values",description:"Drop NaN, +/-Inf and null from input series before reducing"},{value:"replaceNN",label:"Replace Non-numeric Values",description:"Replace NaN, +/-Inf and null with a constant value before reducing"}],p=[{value:t.gy.last,label:"Last",description:"Fill with the last value"},{value:t.gy.min,label:"Min",description:"Fill with the minimum value"},{value:t.gy.max,label:"Max",description:"Fill with the maximum value"},{value:t.gy.mean,label:"Mean",description:"Fill with the average value"},{value:t.gy.sum,label:"Sum",description:"Fill with the sum of all values"}],c=[{value:"pad",label:"pad",description:"fill with the last known value"},{value:"backfilling",label:"backfilling",description:"fill with the next known value"},{value:"fillna",label:"fillna",description:"Fill with NaNs"}],y=[{value:s.p.IsAbove,label:"Is above"},{value:s.p.IsBelow,label:"Is below"},{value:s.p.IsWithinRange,label:"Is within range"},{value:s.p.IsOutsideRange,label:"Is outside range"}]},76942:(G,I,e)=>{"use strict";e.d(I,{P:()=>o,r:()=>r});var t=e(75059),n=e(55907),s=e(66718);const r=m=>{switch(m.type){case s.Tz.reduce:m.reducer||(m.reducer=t.gy.mean);break;case s.Tz.resample:m.downsampler||(m.downsampler=t.gy.mean),m.upsampler||(m.upsampler="fillna"),m.reducer=void 0;break;case s.Tz.math:m.expression=void 0;break;case s.Tz.classic:m.conditions||(m.conditions=[o]);break;default:m.reducer=void 0}return m},o={type:"query",reducer:{params:[],type:"avg"},operator:{type:"and"},query:{params:[]},evaluator:{params:[0,0],type:n.p.IsAbove}}},71101:(G,I,e)=>{"use strict";e.d(I,{Cg:()=>l,Fk:()=>u,R4:()=>c,Rj:()=>m,pq:()=>i});var t=e(32264),n=e(8484),s=e(16233),r=e(36689),o=e(31678);const m="manage-folder",l=f=>`folder-dashboards-${f}`,i=f=>`folder-library-panels-${f}`,u=f=>`folder-alerting-${f}`,d=f=>`folder-permissions-${f}`,p=f=>`folder-settings-${f}`;function c(f,P=f.parents){const a={icon:"folder",id:m,subTitle:(0,r.o)("manage-folder"),url:f.url,text:f.title,children:[{active:!1,icon:"apps",id:l(f.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.dashboards","Dashboards"),url:f.url}]};if(P&&P.length>0){const E=P[P.length-1],g=P.slice(0,P.length-1);a.parentItem=c(E,g)}return a.children.push({active:!1,icon:"library-panel",id:i(f.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.panels","Panels"),url:`${f.url}/library-panels`}),s.TP.hasPermission(o.AccessControlAction.AlertingRuleRead)&&t.$.unifiedAlertingEnabled&&a.children.push({active:!1,icon:"bell",id:u(f.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.alert-rules","Alert rules"),url:`${f.url}/alerting`}),a}function y(f){const P=c({created:"",createdBy:"",hasAcl:!1,updated:"",updatedBy:"",id:1,uid:"loading",title:"Loading",url:"url",canSave:!0,canEdit:!0,canAdmin:!0,canDelete:!0,version:0});return P.children[f].active=!0,{main:P,node:P.children[f]}}},54650:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>u,jl:()=>m});var t=e(65307),n=e(55314);const s={id:0,uid:"loading",title:"loading",url:"",canSave:!1,canDelete:!1,hasChanged:!1,version:1},r=(d,p)=>({...d,...p.payload,hasChanged:!1}),o=(0,t.Z0)({name:"folder",initialState:s,reducers:{loadFolder:r,setFolderTitle:(d,p)=>({...d,title:p.payload,hasChanged:p.payload.trim().length>0})},extraReducers:d=>{d.addMatcher(n.vZ.getFolder.matchFulfilled,r)}}),{loadFolder:m,setFolderTitle:l}=o.actions,u={folder:o.reducer}},84350:(G,I,e)=>{"use strict";e.d(I,{G:()=>i});var t=e(32196),n=e(96540),s=e(40845),r=e(21594),o=e(42418),m=e(67140);const l=[{label:"Countries",description:"Lookup countries by name, two letter code, or three letter code",value:m.fx},{label:"USA States",description:"Lookup states by name or 2 ",value:"public/gazetteer/usa-states.json"},{label:"Airports",description:"Lookup airports by id or code",value:"public/gazetteer/airports.geojson"}],i=({value:d,onChange:p,context:c,item:y})=>{const f=(0,s.of)(u),[P,a]=(0,n.useState)(),E=y.settings;(0,n.useEffect)(()=>{async function D(){const v=await(0,m.q3)(d);a(v)}D()},[d,a]);const{current:g,options:h}=(0,n.useMemo)(()=>{let D=E?.options?[...E.options]:[...l],v=D?.find(C=>C.value===P?.path);return!v&&P&&(v={label:P.path,value:P.path},D.push(v)),{options:D,current:v}},[P,E?.options]);return n.createElement(n.Fragment,null,n.createElement(r.l6,{value:g,options:h,onChange:D=>p(D.value),allowCustomValue:!0,formatCreateLabel:D=>`Load from URL: ${D}`}),P&&n.createElement(n.Fragment,null,P.error&&n.createElement(o.F,{title:P.error,severity:"warning"}),P.count&&n.createElement("div",{className:f.keys},n.createElement("b",null,"(",P.count,")"),P.examples(10).map(D=>n.createElement("span",{key:D},D,",")),P.count>10&&" ...")))},u=()=>({keys:(0,t.css)`
    margin-top: 4px;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;

    > span {
      margin-left: 4px;
    }
  `})},61983:(G,I,e)=>{"use strict";e.d(I,{G:()=>E});var t=e(11261),n=e(52622),s=e(84350),r=e(32196),o=e(96540),m=e(13544),l=e(40845),i=e(42418),u=e(14578),d=e(21594),p=e(66864),c=e(31484);const y=[{value:n.aG.Auto,label:"Auto",ariaLabel:m.Tp.components.Transforms.SpatialOperations.location.autoOption,description:"Automatically identify location data based on default field names"},{value:n.aG.Coords,label:"Coords",ariaLabel:m.Tp.components.Transforms.SpatialOperations.location.coords.option,description:"Specify latitude and longitude fields"},{value:n.aG.Geohash,label:"Geohash",ariaLabel:m.Tp.components.Transforms.SpatialOperations.location.geohash.option,description:"Specify geohash field"},{value:n.aG.Lookup,label:"Lookup",ariaLabel:m.Tp.components.Transforms.SpatialOperations.location.lookup.option,description:"Specify Gazetteer and lookup field"}],f="https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/geomap/#location",P=({value:g,onChange:h,context:D,item:v})=>{const[C,T]=(0,o.useState)();(0,o.useEffect)(()=>{v.settings?.source&&v.settings?.data?.length&&v.settings.data[0]&&(0,c.nE)(v.settings.source).then(x=>{v.settings&&v.settings.data&&T((0,c.FM)(v.settings.data[0],x))})},[v.settings]);const S=(0,l.of)(a),O=()=>{if(C){if(C.warning)return o.createElement(i.F,{title:C.warning,severity:"warning",buttonContent:o.createElement(u.I,{name:"question-circle",size:"xl"}),className:S.alert,onRemove:()=>{const x=window.open(f,"_blank","noopener,noreferrer");x&&(x.opener=null)}});if(g===n.aG.Auto&&C.description)return o.createElement("span",null,C.description)}return null};return o.createElement(o.Fragment,null,o.createElement(d.l6,{options:y,value:g,onChange:x=>{h(x.value)}}),o.createElement(p.Gy,{className:S.hGroup},O()))},a=g=>({alert:(0,r.css)`
      & div {
        padding: 4px;
      }
      margin-bottom: 0px;
      margin-top: 5px;
      padding: 2px;
    `,hGroup:(0,r.css)`
      & div {
        width: 100%;
      }
    `});function E(g,h,D,v,C){switch(D.addCustomEditor({id:"modeEditor",path:`${h}mode`,name:"Location Mode",editor:P,settings:{data:C,source:v}}),v?.mode){case n.aG.Coords:D.addFieldNamePicker({path:`${h}latitude`,name:"Latitude field",settings:{filter:T=>T.type===t.PU.number,noFieldsMessage:"No numeric fields found"}}).addFieldNamePicker({path:`${h}longitude`,name:"Longitude field",settings:{filter:T=>T.type===t.PU.number,noFieldsMessage:"No numeric fields found"}});break;case n.aG.Geohash:D.addFieldNamePicker({path:`${h}geohash`,name:"Geohash field",settings:{filter:T=>T.type===t.PU.string,noFieldsMessage:"No strings fields found"}});break;case n.aG.Lookup:D.addFieldNamePicker({path:`${h}lookup`,name:"Lookup field",settings:{filter:T=>T.type===t.PU.string,noFieldsMessage:"No strings fields found"}}).addCustomEditor({id:"gazetteer",path:`${h}gazetteer`,name:"Gazetteer",editor:s.G})}}},96606:(G,I,e)=>{"use strict";e.d(I,{RA:()=>c,XR:()=>y,Dc:()=>p,qy:()=>u,Pz:()=>d});var t=e(44294),n=e(34338),s=e(11217),r=e(22796),o=e(11261),m=e(78134);function l(P){if(!P?.length)return;const a=[16,8,4,2,1],E="0123456789bcdefghjkmnpqrstuvwxyz";let g=!0;const h=[],D=[];h[0]=-90,h[1]=90,D[0]=-180,D[1]=180;let v;P.split("").forEach(S=>{v=E.indexOf(S),a.forEach(O=>{i(g?D:h,v,O),g=!g})});const C=(h[0]+h[1])/2;return[(D[0]+D[1])/2,C]}function i(P,a,E){a&E?P[0]=(P[0]+P[1])/2:P[1]=(P[0]+P[1])/2}function u(P){return{name:P.name??"Point",type:o.PU.geo,values:P.values.map(a=>{const E=l(a);if(E)return new t.A((0,r.Rb)(E))}),config:f}}function d(P,a){const E=new Array(P.values.length);for(let g=0;g<P.values.length;g++){const h=P.values[g],D=a.values[g];h===null||D===null||(E[g]=new t.A((0,r.Rb)([h,D])))}return{name:"Point",type:o.PU.geo,values:E,config:f}}function p(P,a){const E=a.values.length,g=new Array(E);for(let h=0;h<E;h++)g[h]=P.find(a.values[h])?.geometry();return{name:"Geometry",type:o.PU.geo,values:g,config:f}}function c(P,a){const E=P.values,g=a.values;if(!E||!g)throw"missing src/dest";if(E.length!==g.length)throw"Source and destination field lengths do not match";const h=P.values.length,D=new Array(h);for(let v=0;v<h;v++){const C=E[v],T=g[v];C&&T?D[v]=new n.A([C,T]):C?D[v]=C:T&&(D[v]=T)}return{name:"Geometry",type:o.PU.geo,values:D,config:f}}function y(P,a){const E=P.values,g=a.values;if(!E||!g)throw"missing src/dest";if(E.length!==g.length)throw"Source and destination field lengths do not match";const h=P.values.length,D=new Array(h);for(let v=0;v<h;v++){const C=E[v],T=g[v];C&&T&&(D[v]=new s.A([(0,m.EX)(C),(0,m.EX)(T)]))}return{name:"Geometry",type:o.PU.geo,values:D,config:f}}const f=Object.freeze({custom:{hideFrom:{tooltip:!0}}})},67140:(G,I,e)=>{"use strict";e.d(I,{fx:()=>P,q3:()=>a});var t=e(70915),n=e(44294),s=e(14236),r=e(11261),o=e(17172),m=e(11365);function l(E){const g=new m.A().readFeatures(E,{featureProjection:"EPSG:3857"}),h=g.length,D=new Array(h).fill(null),v=[],C=new Map,T=b=>{let M=C.get(b);return M||(M={types:new Set,values:new Array(h).fill(null),count:0},v.push(b),C.set(b,M)),M},S=(...b)=>{for(const M of b)if(!C.has(M))return M;return"___"+b[0]},O={types:new Set,values:new Array(h).fill(null),count:0};for(let b=0;b<h;b++){const M=g[b];D[b]=M.getGeometry();const A=M.getId();A!=null&&(O.values[b]=A,O.types.add((0,s.oE)(A)),O.count++);for(const R of M.getKeys()){const B=M.get(R);if(B===D[b]||B==null)continue;const U=T(R);U.values[b]=B,U.types.add((0,s.oE)(B)),U.count++}}const x=[];if(O.count>0){const b=i(O);x.push({name:S("id","_id","__id"),type:b,values:O.values,config:{}})}x.push({name:S("geo","geometry"),type:r.PU.geo,values:D,config:{}});for(const b of v){const M=C.get(b);if(!M)continue;const A=i(M);x.push({name:b,type:A,values:M.values,config:{}})}return{fields:x,length:h}}function i(E){return E.count<1?r.PU.other:E.types.size>1?(E.values=E.values.map(g=>g!=null?`${g}`:g),r.PU.string):E.types.values().next().value}var u=e(96606),d=e(22796);function p(E,g){let h=0;const D=new Map;for(const v of g){const C=new n.A((0,d.Rb)([v.longitude,v.latitude])),T={point:()=>C,geometry:()=>C};if(v.name&&(D.set(v.name,T),D.set(v.name.toUpperCase(),T)),v.key&&(D.set(v.key,T),D.set(v.key.toUpperCase(),T)),v.keys)for(const S of v.keys)D.set(S,T),D.set(S.toUpperCase(),T);h++}return{path:E,find:v=>{let C=D.get(v);return!C&&typeof v=="string"&&(C=D.get(v.toUpperCase())),C},count:h,examples:v=>{const C=[];if(D.size<1)C.push("no values found");else for(const T of D.keys())if(C.push(T),C.length>=v)break;return C}}}function c(E,g){let h;if(Array.isArray(g)){const D=g[0];if(D.latitude&&D.longitude&&(D.key||D.keys))return p(E,g)}else Array.isArray(g?.features)&&g?.type==="FeatureCollection"&&(h=l(g));if(!h)try{h=(0,s.Vc)(g)}catch(D){return{path:E,error:`${D}`,find:v=>{},examples:v=>[]}}return y(h,{path:E})}function y(E,g){const h=[];let D,v,C,T,S;for(const b of E.fields)if(b.type===r.PU.geo&&(D=b),!S&&b.type===r.PU.string&&(S=b),b.name){g.keys&&g.keys.includes(b.name)&&h.push(b);const M=b.name.toUpperCase();switch(M){case"LAT":case"LATITUTE":v=b;break;case"LON":case"LNG":case"LONG":case"LONGITUE":C=b;break;case"GEOHASH":T=b;break;case"ID":case"UID":case"KEY":case"CODE":g.keys||h.push(b);break;default:g.keys||(M.endsWith("_ID")||M.endsWith("_CODE"))&&h.push(b)}}!h.length&&S&&h.push(S);let O=!1;D?O=D.values[0]?.getType()==="Point":T?(D=(0,u.qy)(T),O=!0):v&&C&&(D=(0,u.Pz)(C,v),O=!0);const x=new Map;return h.forEach(b=>{b.values.forEach((M,A)=>{const R=`${M}`;x.set(R.toUpperCase(),A),x.set(R,A)})}),{path:g.path,find:b=>{const M=x.get(b);if(M!=null){const A=D?.values[M];return{frame:E,index:M,point:()=>!A||O?A:new n.A((0,t.q1)(A.getExtent())),geometry:()=>A}}},examples:b=>{const M=[];for(let A of x.keys())if(M.push(A),M.length>b)break;return M},frame:()=>E,count:E.length}}const f={},P="public/gazetteer/countries.json";async function a(E){E||(E=P);let g=f[E];if(!g){try{const h=await(0,o.AI)().get(E);g=c(E,h)}catch(h){console.warn("Error loading placename lookup",E,h),g={path:E,error:"Error loading URL",find:D=>{},examples:D=>[]}}f[E]=g}return g}},31484:(G,I,e)=>{"use strict";e.d(I,{FM:()=>y,nE:()=>p});var t=e(28240),n=e(11261),s=e(85200),r=e(1173),o=e(52622),m=e(96606),l=e(67140);function i(f){return P=>{for(const a of P.fields)if(f(a,P,[]))return a}}function u(f){return P=>{for(const a of P.fields){if(f.has(a.name.toLowerCase()))return a;const E=(0,t.Ct)(a,P);if(f.has(E))return a}}}const d={mode:o.aG.Auto,geohash:u(new Set(["geohash"])),latitude:u(new Set(["latitude","lat"])),longitude:u(new Set(["longitude","lon","lng"])),h3:u(new Set(["h3"])),wkt:u(new Set(["wkt"])),lookup:u(new Set(["lookup"])),geo:f=>f.fields.find(P=>P.type===n.PU.geo)};async function p(f){const P={...d,mode:f?.mode??o.aG.Auto};switch(P.gazetteer=await(0,l.q3)(f?.gazetteer),P.mode){case o.aG.Geohash:f?.geohash?P.geohash=i((0,s.NS)({id:r.Ct.byName,options:f.geohash})):P.geohash=()=>{};break;case o.aG.Lookup:const a=f?.lookup?.length?(0,s.NS)({id:r.Ct.byName,options:f.lookup}):(0,s.NS)({id:r.Ct.byType,options:n.PU.string});P.lookup=i(a);break;case o.aG.Coords:f?.latitude?P.latitude=i((0,s.NS)({id:r.Ct.byName,options:f.latitude})):P.latitude=()=>{},f?.longitude?P.longitude=i((0,s.NS)({id:r.Ct.byName,options:f.longitude})):P.longitude=()=>{};break}return P}function c(f,P){const a={mode:P.mode??o.aG.Auto};if(a.mode===o.aG.Auto){if(a.geo=P.geo(f),a.geo)return a;if(a.latitude=P.latitude(f),a.longitude=P.longitude(f),a.latitude&&a.longitude)return a.mode=o.aG.Coords,a;if(a.geohash=P.geohash(f),a.geohash)return a.mode=o.aG.Geohash,a;if(a.lookup=P.lookup(f),a.lookup)return a.mode=o.aG.Lookup,a}switch(a.mode){case o.aG.Coords:a.latitude=P.latitude(f),a.longitude=P.longitude(f);break;case o.aG.Geohash:a.geohash=P.geohash(f);break;case o.aG.Lookup:a.lookup=P.lookup(f);break}return a}function y(f,P){const a=c(f,P);switch(a.mode){case o.aG.Auto:return a.geo?{field:a.geo}:{warning:"Unable to find location fields"};case o.aG.Coords:return a.latitude&&a.longitude?{field:(0,m.Pz)(a.longitude,a.latitude),derived:!0,description:`${a.mode}: ${a.latitude.name}, ${a.longitude.name}`}:{warning:"Select latitude/longitude fields"};case o.aG.Geohash:return a.geohash?{field:(0,m.qy)(a.geohash),derived:!0,description:`${a.mode}`}:{warning:"Select geohash field"};case o.aG.Lookup:return a.lookup?P.gazetteer?{field:(0,m.Dc)(P.gazetteer,a.lookup),derived:!0,description:`${a.mode}: ${P.gazetteer.path}`}:{warning:"Gazetteer not found"}:{warning:"Select lookup field"}}return{warning:"unable to find geometry"}}},61453:(G,I,e)=>{"use strict";e.d(I,{q:()=>A});var t=e(2543),n=e(96540),s=e(70713),r=e(18282),o=e(2514),m=e(90708),l=e(13544),i=e(14110),u=e(72574),d=e(55852),p=e(62930),c=e(77093),y=e(2913),f=e(8484),P=e(69147),a=e(28240),E=e(40845),g=e(66864),h=e(88575),D=e(21594),v=e(15292),C=e(7788),T=e(32196);const S=B=>(0,T.css)`
  padding: ${B.spacing(0,2)};
  font-size: ${B.typography.bodySmall.fontSize};
  color: ${B.colors.text.secondary};
  overflow: hidden;
  text-overflow: ellipsis;
`,O=({children:B})=>{const U=(0,E.of)(S);return n.createElement("div",{className:U},B)};var x=e(26323);const b=({options:B,actions:U,formattedDataDescription:W,onOptionsChange:N,hasTransformations:w,data:L,dataFrames:V,transformationOptions:K,selectedDataFrame:k,onDataFrameChange:j,downloadForExcel:H,toggleDownloadForExcel:J})=>{const X=(0,E.of)(x.A);let se=V;k===r.F.joinByField&&(se=L);const ae=se.map((ee,z)=>({value:z,label:`${(0,a.Ri)(ee)} (${z})`})),ne=[...K,...ae];function q(){let ee="";if(!L)return ee;const z=[];return k===r.F.joinByField?z.push((0,f.t)("dashboard.inspect-data.series-to-columns","Series joined by time")):L.length>1&&z.push((0,a.Ri)(L[k])),(B.withTransforms||B.withFieldConfig)&&(B.withTransforms&&z.push((0,f.t)("dashboard.inspect-data.panel-transforms","Panel transforms")),B.withTransforms&&B.withFieldConfig,B.withFieldConfig&&z.push((0,f.t)("dashboard.inspect-data.formatted","Formatted data"))),H&&z.push((0,f.t)("dashboard.inspect-data.excel-header","Excel header")),z.join(", ")}return n.createElement("div",{className:X.dataDisplayOptions},n.createElement(C.u,{id:"Data options",index:0,title:(0,f.t)("dashboard.inspect-data.data-options","Data options"),headerElement:n.createElement(O,null,q()),isOpen:!1,actions:U},n.createElement("div",{className:X.options,"data-testid":"dataOptions"},n.createElement(g.gW,{spacing:"none"},L.length>1&&n.createElement(h.D,{label:(0,f.t)("dashboard.inspect-data.dataframe-label","Show data frame")},n.createElement(D.l6,{options:ne,value:k,onChange:j,width:30,"aria-label":(0,f.t)("dashboard.inspect-data.dataframe-aria-label","Select dataframe")})),n.createElement(g.Gy,null,w&&N&&n.createElement(h.D,{label:(0,f.t)("dashboard.inspect-data.transformations-label","Apply panel transformations"),description:(0,f.t)("dashboard.inspect-data.transformations-description","Table data is displayed with transformations defined in the panel Transform tab.")},n.createElement(v.d,{value:!!B.withTransforms,onChange:()=>N({...B,withTransforms:!B.withTransforms})})),N&&n.createElement(h.D,{label:(0,f.t)("dashboard.inspect-data.formatted-data-label","Formatted data"),description:W||(0,f.t)("dashboard.inspect-data.formatted-data-description","Table data is formatted with options defined in the Field and Override tabs.")},n.createElement(v.d,{id:"formatted-data-toggle",value:!!B.withFieldConfig,onChange:()=>N({...B,withFieldConfig:!B.withFieldConfig})})),n.createElement(h.D,{label:(0,f.t)("dashboard.inspect-data.download-excel-label","Download for Excel"),description:(0,f.t)("dashboard.inspect-data.download-excel-description","Adds header to CSV for use with Excel")},n.createElement(v.d,{id:"excel-toggle",value:H,onChange:J})))))))};var M=e(18358);class A extends n.PureComponent{constructor(U){super(U),this.onExportLogsAsTxt=()=>{const{data:W,dataName:N,app:w}=this.props;(0,i.rR)("grafana_logs_download_logs_clicked",{app:w,format:"logs",area:"inspector"});const L=(0,P.HT)(W||[]);(0,M.Zy)(L,N)},this.onExportTracesAsJson=()=>{const{data:W,dataName:N,app:w}=this.props;if(W)for(const L of W){if(L.meta?.preferredVisualisationType!=="trace")continue;const V=(0,M.ek)(L,N+"-traces");(0,i.rR)("grafana_traces_download_traces_clicked",{app:w,grafana_version:y.config.buildInfo.version,trace_format:V,location:"inspector"})}},this.onExportServiceGraph=()=>{const{data:W,dataName:N,app:w}=this.props;(0,i.rR)("grafana_traces_download_service_graph_clicked",{app:w,grafana_version:y.config.buildInfo.version,location:"inspector"}),W&&(0,M.ny)(W,N)},this.onDataFrameChange=W=>{this.setState({transformId:W.value===r.F.joinByField?r.F.joinByField:r.F.noop,dataFrameIndex:typeof W.value=="number"?W.value:0,selectedDataFrame:W.value})},this.onToggleDownloadForExcel=()=>{this.setState(W=>({downloadForExcel:!W.downloadForExcel}))},this.state={selectedDataFrame:0,dataFrameIndex:0,transformId:r.F.noop,transformationOptions:R(),transformedData:U.data??[],downloadForExcel:!1}}componentDidUpdate(U,W){if(!this.props.data){this.setState({transformedData:[]});return}if(this.props.options.withTransforms){this.setState({transformedData:this.props.data});return}if(U.data!==this.props.data||W.transformId!==this.state.transformId){const N=this.state.transformationOptions.find(w=>w.value===this.state.transformId);if(N&&N.transformer.id!==r.F.noop){const w=this.state.selectedDataFrame,L=this.state.dataFrameIndex,V=(0,o.m)([N.transformer],this.props.data).subscribe(K=>{this.setState({transformedData:K,selectedDataFrame:w,dataFrameIndex:L},()=>V.unsubscribe())});return}this.setState({transformedData:this.props.data});return}}exportCsv(U,W){const{dataName:N}=this.props,{transformId:w}=this.state,L=U[this.state.dataFrameIndex];W&&(0,i.rR)("grafana_logs_download_clicked",{app:this.props.app,format:"csv"}),(0,M.EM)(L,N,{useExcelHeader:this.state.downloadForExcel},w)}getProcessedData(){const{options:U,panelPluginId:W,fieldConfig:N,timeZone:w}=this.props,L=this.state.transformedData;if(!U.withFieldConfig)return(0,m.K3)(L);let V=N??{defaults:{},overrides:[]};return W==="table"&&N&&(V=this.cleanTableConfigFromFieldConfig(N)),(0,m.we)({data:L,theme:y.config.theme2,fieldConfig:V,timeZone:w,replaceVariables:(K,k,j)=>(0,u.w)().replace(K,k,j)})}cleanTableConfigFromFieldConfig(U){U=(0,t.cloneDeep)(U),U.defaults.custom={};for(const W of U.overrides)for(const N of W.properties)if(N.id.startsWith("custom.")){const w=W.properties.indexOf(N);W.properties.slice(w,1)}return U}renderActions(U,W,N,w){return n.createElement(n.Fragment,null,n.createElement(d.$n,{variant:"primary",onClick:()=>this.exportCsv(U,W),size:"sm"},n.createElement(f.x6,{i18nKey:"dashboard.inspect-data.download-csv"},"Download CSV")),W&&n.createElement(d.$n,{variant:"primary",onClick:this.onExportLogsAsTxt,size:"sm"},n.createElement(f.x6,{i18nKey:"dashboard.inspect-data.download-logs"},"Download logs")),N&&n.createElement(d.$n,{variant:"primary",onClick:this.onExportTracesAsJson,size:"sm"},n.createElement(f.x6,{i18nKey:"dashboard.inspect-data.download-traces"},"Download traces")),w&&n.createElement(d.$n,{variant:"primary",onClick:this.onExportServiceGraph,size:"sm"},n.createElement(f.x6,{i18nKey:"dashboard.inspect-data.download-service"},"Download service graph")))}render(){const{isLoading:U,options:W,data:N,formattedDataDescription:w,onOptionsChange:L,hasTransformations:V}=this.props,{dataFrameIndex:K,transformationOptions:k,selectedDataFrame:j,downloadForExcel:H}=this.state,J=(0,x.c)();if(U)return n.createElement("div",null,n.createElement(p.y,{inline:!0})," Loading");const X=this.getProcessedData();if(!X||!X.length)return n.createElement("div",null,"No Data");const se=X[K]?K:0,ae=X[se],ne=X.some(z=>z?.meta?.preferredVisualisationType==="logs"),q=X.some(z=>z?.meta?.preferredVisualisationType==="trace"),ee=X.some(z=>z?.meta?.preferredVisualisationType==="nodeGraph");return n.createElement("div",{className:J.wrap,"aria-label":l.Tp.components.PanelInspector.Data.content},n.createElement("div",{className:J.toolbar},n.createElement(b,{data:N,hasTransformations:V,options:W,dataFrames:X,transformationOptions:k,selectedDataFrame:j,downloadForExcel:H,formattedDataDescription:w,onOptionsChange:L,onDataFrameChange:this.onDataFrameChange,toggleDownloadForExcel:this.onToggleDownloadForExcel,actions:this.renderActions(X,ne,q,ee)})),n.createElement("div",{className:J.content},n.createElement(s.Ay,null,({width:z,height:te})=>z===0?null:n.createElement(c.X,{width:z,height:te,data:ae,showTypeIcons:!0}))))}}function R(){return[{value:r.F.joinByField,label:(0,f.t)("dashboard.inspect-data.transformation","Series joined by time"),transformer:{id:r.F.joinByField,options:{byField:void 0}}}]}},32067:(G,I,e)=>{"use strict";e.d(I,{N:()=>f});var t=e(32196),n=e(96540),s=e(13544),r=e(8484),o=e(57875),m=e(11261),l=e(83195),i=e(40845);const u=({timeZone:a,name:E,stats:g})=>{const h=(0,i.$j)(),D=(0,i.of)(p);return!g||!g.length?null:n.createElement("div",{className:D.wrapper},n.createElement("div",{className:"section-heading"},E),n.createElement("table",{className:"filter-table width-30"},n.createElement("tbody",null,g.map((v,C)=>n.createElement("tr",{key:`${v.displayName}-${C}`},n.createElement("td",null,v.displayName),n.createElement("td",{className:D.cell},d(v,a,h)))))))};function d(a,E,g){const h=(0,o.J)({field:{type:m.PU.number,config:a},theme:g,timeZone:E});return(0,l.cN)(h(a.value))}const p=a=>({wrapper:(0,t.css)`
    padding-bottom: ${a.spacing(2)};
  `,cell:(0,t.css)`
    text-align: right;
  `}),c=({name:a,traceIds:E})=>{const g=(0,i.of)(y);return E.length===0?null:n.createElement("div",{className:g.wrapper},n.createElement("div",{className:"section-heading"},a),n.createElement("table",{className:"filter-table width-30"},n.createElement("tbody",null,E.map((h,D)=>n.createElement("tr",{key:`${h}-${D}`},n.createElement("td",null,h))))))},y=a=>({wrapper:(0,t.css)`
    padding-bottom: ${a.spacing(2)};
  `,cell:(0,t.css)`
    text-align: right;
  `}),f=({data:a,timeZone:E})=>{if(!a.request)return null;let g=[];const h=a.request.endTime?a.request.endTime-a.request.startTime:-1,D=a.timings?.dataProcessingTime||-1;let v=0;for(const x of a.series)v+=x.length;h>0&&g.push({displayName:(0,r.t)("dashboard.inspect-stats.request-time","Total request time"),value:h,unit:"ms"}),D>0&&g.push({displayName:(0,r.t)("dashboard.inspect-stats.processing-time","Data processing time"),value:D,unit:"ms"}),g.push({displayName:(0,r.t)("dashboard.inspect-stats.queries","Number of queries"),value:a.request.targets?.length??0}),g.push({displayName:(0,r.t)("dashboard.inspect-stats.rows","Total number rows"),value:v});let C=[];for(const x of a.series)x.meta&&x.meta.stats&&(C=C.concat(x.meta.stats));const T=(0,r.t)("dashboard.inspect-stats.table-title","Stats"),S=(0,r.t)("dashboard.inspect-stats.data-title","Data source stats"),O=(0,r.t)("dashboard.inspect-stats.data-traceids","Trace IDs");return n.createElement("div",{"aria-label":s.Tp.components.PanelInspector.Stats.content,className:P},n.createElement(u,{timeZone:E,name:T,stats:g}),n.createElement(u,{timeZone:E,name:S,stats:C}),n.createElement(c,{name:O,traceIds:a.traceIds??[]}))},P=(0,t.css)`
  height: 100%;
  overflow-y: scroll;
`},90820:(G,I,e)=>{"use strict";e.d(I,{e:()=>P});var t=e(32196),n=e(96540),s=e(64423),r=e(39070),o=e(13544),m=e(32264),l=e(67061),i=e(55852),u=e(10534),d=e(39558),p=e(24022),c=e(8484),y=e(27677),f=e(26323);class P extends n.PureComponent{constructor(E){super(E),this.subs=new s.yU,this.setFormattedJson=g=>{this.formattedJson=g},this.getTextForClipboard=()=>JSON.stringify(this.formattedJson,null,2),this.onToggleExpand=()=>{this.setState(g=>({...g,allNodesExpanded:!this.state.allNodesExpanded}))},this.onToggleMocking=()=>{this.setState(g=>({...g,isMocking:!this.state.isMocking}))},this.getNrOfOpenNodes=()=>this.state.allNodesExpanded===null?3:this.state.allNodesExpanded?20:1,this.state={executedQueries:[],allNodesExpanded:null,isMocking:!1,mockedResponse:"",response:{}}}componentDidMount(){this.subs.add(y.IB.getInspectorStream().subscribe({next:E=>{let g=!0;if(this.props.instanceId&&E?.requestId&&(g=E.requestId.startsWith(this.props.instanceId)),g)return this.onDataSourceResponse(E.response)}}))}componentDidUpdate(E){this.props.data!==E.data&&this.updateQueryList()}updateQueryList(){const{data:E}=this.props,g=E.series,h=[];if(g?.length){let D;g.forEach((v,C)=>{const T=v.meta?.executedQueryString;if(T){const S=v.refId||"?";D?.refId===S?(D.frames++,D.rows+=v.length):(D={refId:S,frames:0,rows:v.length,query:T},h.push(D))}})}this.setState({executedQueries:h})}componentWillUnmount(){this.subs.unsubscribe()}onDataSourceResponse(E){E.config?.hideFromInspector||(E={...E},E.headers&&delete E.headers,E.config&&(E.request=E.config,delete E.config,delete E.request.transformRequest,delete E.request.transformResponse,delete E.request.paramSerializer,delete E.request.jsonpCallbackParam,delete E.request.headers,delete E.request.requestId,delete E.request.inspect,delete E.request.retry,delete E.request.timeout),E.data&&(E.response=E.data,delete E.config,delete E.data,delete E.status,delete E.statusText,delete E.ok,delete E.url,delete E.redirected,delete E.type,delete E.$$config),this.setState({response:E}))}renderExecutedQueries(E){if(!E.length)return null;const g={refId:(0,t.css)`
        font-weight: ${m.$.theme.typography.weight.semibold};
        color: ${m.$.theme.colors.textBlue};
        margin-right: 8px;
      `};return n.createElement("div",null,E.map(h=>n.createElement(l.B,{key:h.refId,gap:1,direction:"column"},n.createElement("div",null,n.createElement("span",{className:g.refId},h.refId,":"),h.frames>1&&n.createElement("span",null,h.frames," frames, "),n.createElement("span",null,h.rows," rows")),n.createElement("pre",null,h.query))))}render(){const{allNodesExpanded:E,executedQueries:g,response:h}=this.state,{onRefreshQuery:D,data:v}=this.props,C=this.getNrOfOpenNodes(),T=(0,f.A)(m.$.theme2),S=Object.keys(h).length>0,O=v.state===r.Gu.Loading;return n.createElement("div",{className:T.wrap},n.createElement("div",{"aria-label":o.Tp.components.PanelInspector.Query.content},n.createElement("h3",{className:"section-heading"},"Query inspector"),n.createElement("p",{className:"small muted"},n.createElement(c.x6,{i18nKey:"inspector.query.description"},"Query inspector allows you to view raw request and response. To collect this data Grafana needs to issue a new query. Click refresh button below to trigger a new query."))),this.renderExecutedQueries(g),n.createElement("div",{className:T.toolbar},n.createElement(i.$n,{icon:"sync",onClick:D,"aria-label":o.Tp.components.PanelInspector.Query.refreshButton},n.createElement(c.x6,{i18nKey:"inspector.query.refresh"},"Refresh")),S&&E&&n.createElement(i.$n,{icon:"minus",variant:"secondary",className:T.toolbarItem,onClick:this.onToggleExpand},n.createElement(c.x6,{i18nKey:"inspector.query.collapse-all"},"Collapse all")),S&&!E&&n.createElement(i.$n,{icon:"plus",variant:"secondary",className:T.toolbarItem,onClick:this.onToggleExpand},n.createElement(c.x6,{i18nKey:"inspector.query.expand-all"},"Expand all")),S&&n.createElement(u.b,{getText:this.getTextForClipboard,className:T.toolbarItem,icon:"copy",variant:"secondary"},n.createElement(c.x6,{i18nKey:"inspector.query.copy-to-clipboard"},"Copy to clipboard")),n.createElement("div",{className:"flex-grow-1"})),n.createElement("div",{className:T.content},O&&n.createElement(d._,{text:"Loading query inspector..."}),!O&&S&&n.createElement(p.B,{json:h,open:C,onDidRender:this.setFormattedJson}),!O&&!S&&n.createElement("p",{className:"muted"},n.createElement(c.x6,{i18nKey:"inspector.query.no-data"},"No request and response collected yet. Hit refresh button"))))}}},26323:(G,I,e)=>{"use strict";e.d(I,{A:()=>o,c:()=>r});var t=e(32196),n=e(3911),s=e(2913);const r=(0,n.N)(()=>o(s.config.theme2)),o=m=>({wrap:(0,t.css)`
      display: flex;
      flex-direction: column;
      height: 100%;
      width: 100%;
      flex: 1 1 0;
      min-height: 0;
    `,toolbar:(0,t.css)`
      display: flex;
      width: 100%;
      flex-grow: 0;
      align-items: center;
      justify-content: flex-end;
      margin-bottom: ${m.v1.spacing.sm};
    `,toolbarItem:(0,t.css)`
      margin-left: ${m.v1.spacing.md};
    `,content:(0,t.css)`
      flex-grow: 1;
      height: 100%;
    `,editor:(0,t.css)`
      font-family: monospace;
      height: 100%;
      flex-grow: 1;
    `,viewer:(0,t.css)`
      overflow: scroll;
    `,dataFrameSelect:(0,t.css)`
      flex-grow: 2;
    `,leftActions:(0,t.css)`
      display: flex;
      flex-grow: 1;

      max-width: 85%;
      @media (max-width: 1345px) {
        max-width: 75%;
      }
    `,options:(0,t.css)`
      padding-top: ${m.v1.spacing.sm};
    `,dataDisplayOptions:(0,t.css)`
      flex-grow: 1;
      min-width: 300px;
      margin-right: ${m.v1.spacing.sm};
    `,selects:(0,t.css)`
      display: flex;
      > * {
        margin-right: ${m.v1.spacing.sm};
      }
    `})},16560:(G,I,e)=>{"use strict";e.d(I,{q:()=>t});var t=(n=>(n.Data="data",n.Meta="meta",n.Error="error",n.Stats="stats",n.JSON="json",n.Query="query",n.Help="help",n))(t||{})},18358:(G,I,e)=>{"use strict";e.d(I,{ny:()=>U,EM:()=>B,Zy:()=>R,ek:()=>W});var t=e(4213),n=e.n(t),s=e(72724),r=e(18282),o=e(72436),m=e(37471),l=e(19071),i=e(2543);const d=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:100,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function p(){return defaultConfig}function c(N){return _get(p(),N)}function y(N){let w;const L=new Set(N.map(({spanID:V})=>V));for(let V=0;V<N.length;V++){if(N[V].references&&N[V].references.some(({traceID:H,spanID:J})=>H===N[V].traceID&&L.has(J)))continue;if(!w){w=N[V];continue}const k=N[V].references&&N[V].references.length||0,j=w.references&&w.references.length||0;(k<j||k===j&&N[V].startTime<w.startTime)&&(w=N[V])}return w?`${w.process.serviceName}: ${w.operationName}`:""}const f=(0,i.memoize)(y,N=>N.length?N[0].traceID:0);function P(N){const w=new Map,L=N.reduce((K,k)=>(K.some(j=>j.key===k.key&&j.value===k.value)?w.set(`${k.key}:${k.value}`,`Duplicate tag "${k.key}:${k.value}"`):K.push(k),K),[]),V=Array.from(w.values());return{dedupedTags:L,warnings:V}}function a(N,w){const L=N?.slice()??[],V=(w||[]).map(K=>K.toLowerCase());return L.sort((K,k)=>{const j=K.key.toLowerCase(),H=k.key.toLowerCase();for(let J=0;J<V.length;J++){const X=V[J];if(j.startsWith(X)&&!H.startsWith(X))return-1;if(!j.startsWith(X)&&H.startsWith(X))return 1}return j>H?1:j<H?-1:0}),L}function E(N){if(!N?.traceID)return null;const w=N.traceID.toLowerCase();let L=0,V=Number.MAX_SAFE_INTEGER;const K=new Map,k=new Map;N.spans=N.spans.filter(ne=>!!ne.startTime),N.processes=Object.entries(N.processes).reduce((ne,[q,ee])=>(ne[q]={...ee,tags:a(ee.tags)},ne),{});const j=N.spans.length;for(let ne=0;ne<j;ne++){const q=N.spans[ne],{startTime:ee,duration:z,processID:te}=q;let ie=q.spanID;ee<V&&(V=ee),ee+z>L&&(L=ee+z);const ce=K.get(ie);ce!=null?(console.warn(`Dupe spanID, ${ce+1} x ${ie}`,q,k.get(ie)),_isEqual(q,k.get(ie))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),K.set(ie,ce+1),ie=`${ie}_${ce}`,q.spanID=ie):K.set(ie,1),q.process=N.processes[te],k.set(ie,q)}const H=getTraceSpanIdsAsTree(N,k),J=[],X={};H.walk((ne,q,ee=0)=>{if(ne==="__root__"||typeof ne!="string")return;const z=k.get(ne);if(!z)return;const{serviceName:te}=z.process;X[te]=(X[te]||0)+1,z.relativeStartTime=z.startTime-V,z.depth=ee-1,z.hasChildren=q.children.length>0,z.childSpanCount=q.children.length,z.warnings=z.warnings||[],z.tags=z.tags||[],z.references=z.references||[],z.childSpanIds=q.children.slice().sort((ce,ue)=>{const fe=k.get(ce.value),Te=k.get(ue.value);return Te.startTime+Te.duration-(fe.startTime+fe.duration)}).map(ce=>ce.value);const ie=P(z.tags);z.tags=a(ie.dedupedTags,getConfigValue("topTagPrefixes")),z.warnings=z.warnings.concat(ie.warnings),z.references.forEach((ce,ue)=>{const fe=k.get(ce.spanID);fe&&(ce.span=fe,ue>0&&(fe.subsidiarilyReferencedBy=fe.subsidiarilyReferencedBy||[],fe.subsidiarilyReferencedBy.push({spanID:ne,traceID:w,span:z,refType:ce.refType})))}),J.push(z)});const se=getTraceName(J);return{services:Object.keys(X).map(ne=>({name:ne,numberOfSpans:X[ne]})),spans:J,traceID:w,traceName:se,processes:N.processes,duration:L-V,startTime:V,endTime:L}}function g(N){const w=N.spans.map(V=>h(V,N.processes)),L=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string},{name:"spanID",type:FieldType.string},{name:"parentSpanID",type:FieldType.string},{name:"operationName",type:FieldType.string},{name:"serviceName",type:FieldType.string},{name:"serviceTags",type:FieldType.other},{name:"startTime",type:FieldType.number},{name:"duration",type:FieldType.number},{name:"logs",type:FieldType.other},{name:"tags",type:FieldType.other},{name:"warnings",type:FieldType.other},{name:"stackTraces",type:FieldType.other}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"jaeger"}}});for(const V of w)L.add(V);return L}function h(N,w){return{spanID:N.spanID,traceID:N.traceID,parentSpanID:N.references?.find(L=>L.refType==="CHILD_OF")?.spanID,operationName:N.operationName,startTime:N.startTime/1e3,duration:N.duration/1e3,logs:N.logs.map(L=>({...L,timestamp:L.timestamp/1e3})),tags:N.tags,warnings:N.warnings??void 0,stackTraces:N.stackTraces,serviceName:w[N.processID].serviceName,serviceTags:w[N.processID].tags}}function D(N,w){const L=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:w.uid,datasourceName:w.name,query:{query:"${__value.raw}"}}}]}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace name"}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"\xB5s"}}],meta:{preferredVisualisationType:"table"}}),V=N.map(v).sort((K,k)=>k?.startTime-K?.startTime);for(const K of V)L.add(K);return L}function v(N){const w=transformTraceData(N);if(w)return{traceID:w.traceID,startTime:w.startTime/1e3,duration:w.duration,traceName:w.traceName}}function C(N){let w={traceID:"",spans:[],processes:{},warnings:null},L=[];for(let V=0;V<N.length;V++){const K=N.get(V);w.traceID||(w.traceID=K.traceID),L.find(k=>k===K.serviceName)||(L.push(K.serviceName),w.processes[`p${L.length}`]={serviceName:K.serviceName,tags:K.serviceTags}),w.spans.push({traceID:K.traceID,spanID:K.spanID,duration:K.duration*1e3,references:K.parentSpanID?[{refType:"CHILD_OF",spanID:K.parentSpanID,traceID:K.traceID}]:[],flags:0,logs:K.logs.map(k=>({...k,timestamp:k.timestamp*1e3})),operationName:K.operationName,processID:Object.keys(w.processes).find(k=>w.processes[k].serviceName===K.serviceName)||"",startTime:K.startTime*1e3,tags:K.tags,warnings:K.warnings?K.warnings:null})}return{data:[w],total:0,limit:0,offset:0,errors:null}}function T(N){const w=N.map(S),L=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"zipkin"}}});for(const V of w)L.add(V);return L}function S(N){const w={traceID:N.traceId,spanID:N.id,parentSpanID:N.parentId,operationName:N.name,serviceName:N.localEndpoint?.serviceName||N.remoteEndpoint?.serviceName||"unknown",serviceTags:x(N),startTime:N.timestamp/1e3,duration:N.duration/1e3,logs:N.annotations?.map(O)??[],tags:Object.keys(N.tags||{}).reduce((L,V)=>V==="error"?(L.push({key:"error",value:!0}),L.push({key:"errorValue",value:N.tags.error}),L):(L.push({key:V,value:N.tags[V]}),L),[])};return N.kind&&(w.tags=[{key:"kind",value:N.kind},...w.tags??[]]),N.shared&&(w.tags=[{key:"shared",value:N.shared},...w.tags??[]]),w}function O(N){return{timestamp:N.timestamp,fields:[{key:"annotation",value:N.value}]}}function x(N){const w=N.localEndpoint||N.remoteEndpoint;return w?[b("ipv4",w.ipv4),b("ipv6",w.ipv6),b("port",w.port),b("endpointType",N.localEndpoint?"local":"remote")].filter(L=>!!L):[]}function b(N,w){if(w)return{key:N,value:w}}const M=N=>{let w=[];for(let L=0;L<N.length;L++){const V=N.get(L);w.push({traceId:V.traceID,parentId:V.parentSpanID,name:V.operationName,id:V.spanID,timestamp:V.startTime*1e3,duration:V.duration*1e3,...A(V),annotations:V.logs.length?V.logs.map(K=>({timestamp:K.timestamp,value:K.fields[0].value})):void 0,tags:V.tags.length?V.tags.filter(K=>K.key!=="kind"&&K.key!=="endpointType"&&K.key!=="shared").reduce((K,k)=>k.key==="error"?{...K,[k.key]:V.tags.find(j=>j.key==="errorValue").value||""}:{...K,[k.key]:k.value},{}):void 0,kind:V.tags.find(K=>K.key==="kind")?.value,shared:V.tags.find(K=>K.key==="shared")?.value})}return w},A=N=>{const w=N.serviceTags.find(L=>L.key==="endpointType")?.value==="local"?"localEndpoint":"remoteEndpoint";return N.serviceName!=="unknown"?{[w]:{serviceName:N.serviceName,ipv4:N.serviceTags.find(L=>L.key==="ipv4")?.value,ipv6:N.serviceTags.find(L=>L.key==="ipv6")?.value,port:N.serviceTags.find(L=>L.key==="port")?.value}}:void 0};function R(N,w){let L="";N.meta?.forEach(k=>{const j=`${k.label}: ${JSON.stringify(k.value)}
`;L=L+j}),L=L+`

`,N.rows.forEach(k=>{const j=(0,s.LE)(k.timeEpochMs,{defaultWithMS:!0})+"	"+k.entry+`
`;L=L+j});const V=new Blob([L],{type:"text/plain;charset=utf-8"}),K=`${w}-logs-${(0,s.LE)(new Date)}.txt`;n()(V,K)}function B(N,w,L,V=r.F.noop){const K=(0,o._O)([N],L),k=new Blob(["\uFEFF",K],{type:"text/csv;charset=utf-8"}),j=V!==r.F.noop?"-as-"+V.toLocaleLowerCase():"",H=`${w}-data${j}-${(0,s.LE)(new Date)}.csv`;n()(k,H)}function U(N,w){const L=new Blob([JSON.stringify(N)],{type:"application/json"}),V=`${w}-${(0,s.LE)(new Date)}.json`;n()(L,V)}function W(N,w){let L="otlp";switch(N.meta?.custom?.traceFormat){case"jaeger":{let V=C(new m.k(N));U(V,w),L="jaeger";break}case"zipkin":{let V=M(new m.k(N));U(V,w),L="zipkin";break}case"otlp":default:{let V=(0,l.xw)(new m.k(N));U(V,w);break}}return L}},77938:(G,I,e)=>{"use strict";e.d(I,{p:()=>s});var t=e(26272),n=e(28138);function s(o){let m="";try{m=JSON.stringify(o,r(),2)}catch(l){l instanceof Error&&(l.toString().includes("RangeError")||l.toString().includes("allocation size overflow"))?n.A.emit(t.r1.alertError,[l.toString(),"Cannot display JSON, the object is too big."]):n.A.emit(t.r1.alertError,[l instanceof Error?l.toString():l])}return m}function r(){const o=new WeakSet;return(m,l)=>{if(m==="__dataContext"||m==="__sceneObject")return"Filtered out in JSON serialization";if(typeof l=="object"&&l!==null){if(o.has(l))return;o.add(l)}return l}}},47259:(G,I,e)=>{"use strict";e.d(I,{G7:()=>r,KU:()=>o,eb:()=>m});var t=e(17172),n=e(10096),s=e(31678);const r=(0,s.createAsyncThunk)("users/fetchInvitees",async()=>n.TP.hasPermission(s.AccessControlAction.OrgUsersAdd)?await(0,t.AI)().get("/api/org/invites"):[]),o=(0,s.createAsyncThunk)("users/addInvitee",async(l,{dispatch:i})=>{await(0,t.AI)().post("/api/org/invites",l),await i(r())}),m=(0,s.createAsyncThunk)("users/revokeInvite",async l=>(await(0,t.AI)().patch(`/api/org/invites/${l}/revoke`,{}),l))},40823:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>i,Tp:()=>r});var t=e(65307),n=e(47259);const s=(0,t.pU)({selectId:u=>u.code}),r=s.getSelectors(),o=s.getInitialState({status:"idle"}),i={invites:(0,t.Z0)({name:"invites",initialState:o,reducers:{},extraReducers:u=>{u.addCase(n.G7.pending,d=>{d.status="loading"}).addCase(n.G7.fulfilled,(d,{payload:p})=>{s.setAll(d,p),d.status="succeeded"}).addCase(n.G7.rejected,d=>{d.status="failed"}).addCase(n.eb.fulfilled,(d,{payload:p})=>{s.removeOne(d,p),d.status="succeeded"})}}).reducer}},96227:(G,I,e)=>{"use strict";e.d(I,{b:()=>y,o:()=>f});var t=e(96540),n=e(40996),s=e(16817),r=e(17172),o=e(88575),m=e(10354),l=e(37390),i=e(55852),u=e(85242),d=e(8484),p=e(57767),c=e(88861);const y=({panel:P,initialFolderUid:a,onCreateLibraryPanel:E,onDismiss:g})=>{const[h,D]=(0,t.useState)(a),[v,C]=(0,t.useState)(P.title),[T,S]=(0,t.useState)(P.title),[O,x]=(0,t.useState)(!1);(0,t.useEffect)(()=>x(!0),[v]),(0,n.A)(()=>S(v),350,[v]);const{saveLibraryPanel:b}=(0,c.b)(),M=(0,t.useCallback)(()=>{P.libraryPanel={uid:"",name:v},b(P,h).then(B=>{(0,r.NF)(B)?P.libraryPanel=void 0:(g?.(),E?.(B))})},[P,v,b,h,g,E]),A=(0,s.A)(async()=>{try{return!(await(0,p.e9)(v)).some(B=>B.folderUid===h)}catch(B){return(0,r.NF)(B)&&(B.isHandled=!0),!0}finally{x(!1)}},[T,h]);console.log("isValidName:",A);const R=!A?.value&&A.value!==void 0&&v===T&&!O;return t.createElement(t.Fragment,null,t.createElement(o.D,{label:(0,d.t)("library-panel.add-modal.name","Library panel name"),invalid:R,error:R?(0,d.t)("library-panel.add-modal.error","Library panel with this name already exists"):""},t.createElement(m.p,{id:"share-panel-library-panel-name-input",name:"name",value:v,onChange:B=>C(B.currentTarget.value)})),t.createElement(o.D,{label:(0,d.t)("library-panel.add-modal.folder","Save in folder"),description:(0,d.t)("library-panel.add-modal.folder-description","Library panel permissions are derived from the folder permissions")},t.createElement(u.sR,{onChange:({uid:B})=>D(B),initialFolderUid:a,inputId:"share-panel-library-panel-folder-picker"})),t.createElement(l.a.ButtonRow,null,t.createElement(i.$n,{variant:"secondary",onClick:g,fill:"outline"},t.createElement(d.x6,{i18nKey:"library-panel.add-modal.cancel"},"Cancel")),t.createElement(i.$n,{onClick:M,disabled:R},t.createElement(d.x6,{i18nKey:"library-panel.add-modal.create"},"Create library panel"))))},f=({isOpen:P=!1,panel:a,initialFolderUid:E,...g})=>t.createElement(l.a,{title:"Create library panel",isOpen:P,onDismiss:g.onDismiss},t.createElement(y,{panel:a,initialFolderUid:E,onDismiss:g.onDismiss}))},86474:(G,I,e)=>{"use strict";e.d(I,{E:()=>M});var t=e(32196),n=e(96540),s=e(70255),r=e(32264),o=e(40845),m=e(14578),l=e(50720),i=e(72129),u=e(41394),d=e(25701),p=e(39070),c=e(37390),y=e(55852),f=e(43535),P=e(16547),a=e(57767),E=e(65307);const g={loadingState:p.Gu.Loading,dashboardTitles:[]},h=(0,E.VP)("libraryPanels/delete/searchCompleted"),D=(B=g,U)=>h.match(U)?{...B,dashboardTitles:U.payload.dashboards.map(W=>W.title),loadingState:p.Gu.Done}:B;function v(B){return async function(U){const W=await(0,a.xV)(B.uid);U(h({dashboards:W}))}}const C=({libraryPanel:B,onDismiss:U,onConfirm:W})=>{const N=(0,o.of)(f.o),[{dashboardTitles:w,loadingState:L},V]=(0,n.useReducer)(D,g),K=(0,n.useMemo)(()=>(0,P.QC)(V),[V]);(0,n.useEffect)(()=>{K(v(B))},[K,B]);const k=!!w.length,j=L===p.Gu.Done;return n.createElement(c.a,{className:N.modal,title:"Delete library panel",icon:"trash-alt",onDismiss:U,isOpen:!0},j?null:n.createElement(T,null),j?n.createElement("div",null,k?n.createElement(O,{dashboardTitles:w}):null,k?null:n.createElement(S,null),n.createElement(c.a.ButtonRow,null,n.createElement(y.$n,{variant:"secondary",onClick:U,fill:"outline"},"Cancel"),n.createElement(y.$n,{variant:"destructive",onClick:W,disabled:k},"Delete"))):null)},T=()=>n.createElement("span",null,"Loading library panel..."),S=()=>{const B=(0,o.of)(f.o);return n.createElement("div",{className:B.modalText},"Do you want to delete this panel?")},O=({dashboardTitles:B})=>{const U=(0,o.of)(f.o),W=B.length===1?"dashboard.":"dashboards.",N=`${B.length} ${W}`;return B.length===0?null:n.createElement("div",null,n.createElement("p",{className:U.textInfo},"This library panel can not be deleted because it is connected to ",n.createElement("strong",null,N)," Remove the library panel from the dashboards listed below and retry."),n.createElement("table",{className:U.myTable},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Dashboard name"))),n.createElement("tbody",null,B.map((w,L)=>n.createElement("tr",{key:`dash-title-${L}`},n.createElement("td",null,w))))))},x=({libraryPanel:B,onClick:U,onDelete:W,showSecondaryActions:N})=>{const[w,L]=(0,n.useState)(!1),V=()=>{W?.(B),L(!1)},K=r.$.panels[B.model.type]??(0,u.$)(B.model.type).meta;return n.createElement(n.Fragment,null,n.createElement(d.b,{isCurrent:!1,title:B.name,description:B.description,plugin:K,onClick:()=>U?.(B),onDelete:N?()=>L(!0):void 0},n.createElement(A,{libraryPanel:B})),w&&n.createElement(C,{libraryPanel:B,onConfirm:V,onDismiss:()=>L(!1)}))},b=({showSecondaryActions:B,rootProps:U})=>{const W=(0,o.of)(R);return n.createElement(d.b.Skeleton,{hasDelete:B,...U},n.createElement(s.A,{containerClassName:W.metaContainer,width:80}))},M=(0,i.j)(x,b);function A({libraryPanel:B}){const U=(0,o.of)(R);return!B.meta?.folderUid&&!B.meta?.folderName?null:B.meta.folderUid?n.createElement("span",{className:U.metaContainer},n.createElement(l.N,{href:`/dashboards/f/${B.meta.folderUid}`},n.createElement(m.I,{name:"folder-upload",size:"sm"}),n.createElement("span",null,B.meta.folderName))):n.createElement("span",{className:U.metaContainer},n.createElement(m.I,{name:"folder",size:"sm"}),n.createElement("span",null,B.meta.folderName))}function R(B){return{metaContainer:(0,t.css)({display:"flex",alignItems:"center",color:B.colors.text.secondary,fontSize:B.typography.bodySmall.fontSize,paddingTop:B.spacing(.5),svg:{marginRight:B.spacing(.5),marginBottom:3}})}}},16678:(G,I,e)=>{"use strict";e.d(I,{j:()=>T,s:()=>C});var t=e(32196),n=e(96540),s=e(40996),r=e(40845),o=e(66864),m=e(67647),l=e(76459),i=e.n(l),u=e(55852),d=e(21594),p=e(14578),c=e(27677),y=e(64161),f=e(31678);function P({onChange:b,maxMenuHeight:M}){const A=(0,r.of)(E),[R,B]=(0,n.useState)(!1),U=(0,n.useCallback)(V=>a(V,B),[]),W=(0,n.useMemo)(()=>i()(U,300),[U]),[N,w]=(0,n.useState)([]),L=(0,n.useCallback)(V=>{const K=V.filter(k=>!!k.value).map(k=>k.value);b(K),w(V)},[b]);return n.createElement("div",{className:A.container},N.length>0&&n.createElement(u.$n,{size:"xs",icon:"trash-alt",fill:"text",className:A.clear,onClick:()=>b([]),"aria-label":"Clear folders"},"Clear folders"),n.createElement(d.Iv,{value:N,onChange:L,isLoading:R,loadOptions:W,maxMenuHeight:M,placeholder:"Filter by folder",noOptionsMessage:"No folders found",prefix:n.createElement(p.I,{name:"filter"}),"aria-label":"Folder filter",defaultOptions:!0}))}async function a(b,M){M(!0);const A={query:b,type:y.G.DashFolder,permission:f.PermissionLevelString.View},B=(await(0,c.AI)().search(A)).map(U=>({label:U.title,value:{uid:U.uid,title:U.title}}));return(!b||"general".includes(b.toLowerCase()))&&B.unshift({label:"General",value:{uid:"general",title:"General"}}),M(!1),B}function E(b){return{container:(0,t.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,t.css)({label:"clear",fontSize:b.spacing(1.5),position:"absolute",top:-b.spacing(4.5),right:0})}}var g=e(68313),h=e(73725),D=e(15054),v=e(83791),C=(b=>(b.Tight="tight",b.Spacious="spacious",b))(C||{});const T=({onClick:b,variant:M="spacious",currentPanelId:A,currentFolderUID:R,perPage:B=D.FG,showPanelFilter:U=!1,showFolderFilter:W=!1,showSort:N=!1,showSecondaryActions:w=!1})=>{const L=(0,r.of)(S,M),[V,K]=(0,n.useState)(""),[k,j]=(0,n.useState)("");(0,s.A)(()=>j(V),200,[V]);const[H,J]=(0,n.useState)({}),[X,se]=(0,n.useState)(R?[R]:[]),[ae,ne]=(0,n.useState)([]),q=N||U||W,ee=M==="tight"?"lg":"xs";return n.createElement("div",{className:L.container},n.createElement(o.gW,{spacing:ee},n.createElement("div",{className:(0,t.cx)(L.gridContainer,{[L.tightLayout]:M==="tight"})},n.createElement("div",{className:L.filterInputWrapper},n.createElement(m.Z,{value:V,onChange:K,placeholder:"Search by name or description",width:0,escapeRegex:!1})),q&&n.createElement(O,{showSort:N,showPanelFilter:U,showFolderFilter:W,onSortChange:J,onFolderFilterChange:se,onPanelFilterChange:ne,sortDirection:H.value,variant:M})),n.createElement("div",{className:L.libraryPanelsView},n.createElement(v.y,{onClickCard:b,searchString:k,sortDirection:H.value,panelFilter:ae,folderFilter:X,currentPanelId:A,showSecondaryActions:w,perPage:B}))))};function S(b,M){return{filterInputWrapper:(0,t.css)({flexGrow:M==="tight"?1:"initial"}),container:(0,t.css)({width:"100%",overflowY:"auto",padding:b.spacing(1)}),libraryPanelsView:(0,t.css)({width:"100%"}),gridContainer:(0,t.css)({display:"flex",flexDirection:"column",width:"100%",columnGap:b.spacing(1),rowGap:b.spacing(1),paddingBottom:b.spacing(2)}),tightLayout:(0,t.css)({flexDirection:"row",rowGap:b.spacing(1)})}}const O=n.memo(({variant:b="spacious",showSort:M,showPanelFilter:A,showFolderFilter:R,sortDirection:B,onSortChange:U,onFolderFilterChange:W,onPanelFilterChange:N})=>{const w=(0,r.of)(x),L=(0,n.useCallback)(K=>N(K.map(k=>k.id)),[N]),V=(0,n.useCallback)(K=>W(K.map(k=>k.uid??"")),[W]);return n.createElement("div",{className:(0,t.cx)(w.container,{[w.containerTight]:b==="tight"})},M&&n.createElement(h.r,{value:B,onChange:U,filter:["alpha-asc","alpha-desc"]}),(R||A)&&n.createElement("div",{className:(0,t.cx)(w.filterContainer,{[w.filterContainerTight]:b==="tight"})},R&&n.createElement(P,{onChange:V}),A&&n.createElement(g.$,{onChange:L})))});O.displayName="SearchControls";function x(b){return{container:(0,t.css)({display:"flex",gap:b.spacing(1),flexGrow:1,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),containerTight:(0,t.css)({flexGrow:"initial",flexDirection:"column",justifyContent:"normal"}),filterContainer:(0,t.css)({display:"flex",flexDirection:"row",gap:b.spacing(1)}),filterContainerTight:(0,t.css)({flexDirection:"column",marginLeft:"initial"})}}},83791:(G,I,e)=>{"use strict";e.d(I,{y:()=>f});var t=e(32196),n=e(96540),s=e(40996),r=e(39070),o=e(40845),m=e(69529),l=e(72109),i=e(67061),u=e(19384),d=e(8484),p=e(86474),c=e(16547),y=e(8184);const f=({onClickCard:a,searchString:E,sortDirection:g,panelFilter:h,folderFilter:D,showSecondaryActions:v,currentPanelId:C,perPage:T=40,isWidget:S})=>{const O=(0,o.of)(P),[{libraryPanels:x,page:b,perPage:M,numberOfPages:A,loadingState:R,currentPanelId:B},U]=(0,n.useReducer)(y.w_,{...y.Xb,currentPanelId:C,perPage:T}),W=(0,n.useMemo)(()=>(0,c.QC)(U),[U]);(0,s.A)(()=>W((0,c.IF)({searchString:E,sortDirection:g,panelFilter:h,folderFilterUIDs:D,page:b,perPage:M,currentPanelId:B,isWidget:S})),300,[E,g,h,D,b,W]);const N=({uid:V})=>W((0,c.h4)(V,{searchString:E,sortDirection:g,panelFilter:h,folderFilterUIDs:D,page:b,perPage:M})),w=V=>W((0,y.yd)({page:V}));return!(E||h?.length||D?.length)&&R===r.Gu.Done&&x.length<1?n.createElement(m.p,{variant:"call-to-action",message:(0,d.t)("library-panel.empty-state.message","You haven't created any library panels yet")},n.createElement(d.x6,{i18nKey:"library-panel.empty-state.more-info"},"Create a library panel from any existing dashboard panel through the panel context menu."," ",n.createElement(l.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-library-panels/#create-a-library-panel"},"Learn more"))):n.createElement(i.B,{direction:"column",wrap:"nowrap"},R===r.Gu.Loading?n.createElement(n.Fragment,null,n.createElement(p.E.Skeleton,{showSecondaryActions:v}),n.createElement(p.E.Skeleton,{showSecondaryActions:v}),n.createElement(p.E.Skeleton,{showSecondaryActions:v})):x.length<1?n.createElement(m.p,{variant:"not-found",message:(0,d.t)("library-panels.empty-state.message","No library panels found")}):x?.map((V,K)=>n.createElement(p.E,{key:`library-panel=${K}`,libraryPanel:V,onDelete:N,onClick:a,showSecondaryActions:v})),x.length?n.createElement("div",{className:O.pagination},n.createElement(u.d,{currentPage:b,numberOfPages:A,onNavigate:w,hideWhenSinglePage:!0})):null)},P=a=>({pagination:(0,t.css)({alignSelf:"center",marginTop:a.spacing(1)})})},16547:(G,I,e)=>{"use strict";e.d(I,{IF:()=>a,QC:()=>g,h4:()=>E});var t=e(64423),n=e(65474),s=e(62467),r=e(44240),o=e(39697),m=e(69862),l=e(66847),i=e(69850),u=e(1005),d=e(65961),p=e(67791),c=e(32264),y=e(17706),f=e(57767),P=e(8184);function a(h){const D=(C,T)=>C.id===T.type,v=(C,T)=>{const S=(0,y.A4)();return C.filter(O=>{const x=S.find(b=>D(b,O));return T?!!x?.skipDataQuery:!x?.skipDataQuery})};return function(C){const T=new t.yU,S=(0,n.H)((0,f.dq)({searchString:h.searchString,perPage:h.perPage,page:h.page,excludeUid:h.currentPanelId,sortDirection:h.sortDirection,typeFilter:h.panelFilter,folderFilterUIDs:h.folderFilterUIDs})).pipe((0,m.Z)(O=>{const{elements:x}=O;if(c.$.featureToggles.vizAndWidgetSplit&&h.isWidget!==void 0){const b=v(x,h.isWidget);return(0,s.of)({...O,elements:b})}return(0,s.of)({...O,elements:x})}),(0,m.Z)(({perPage:O,elements:x,page:b,totalCount:M})=>(0,s.of)((0,P.c4)({libraryPanels:x,page:b,perPage:O,totalCount:M}))),(0,l.W)(O=>(console.error(O),(0,s.of)((0,P.c4)({...P.Xb,page:h.page,perPage:h.perPage})))),(0,i.j)(()=>T.unsubscribe()),(0,u.u)());T.add((0,r.h)((0,o.O)(50).pipe((0,d.u)((0,P.d9)()),(0,p.Q)(S)),S).subscribe(C))}}function E(h,D){return async function(v){try{await(0,f.h4)(h),a(D)(v)}catch(C){console.error(C)}}}function g(h){return function(D){return D instanceof Function?D(h):h(D)}}},8184:(G,I,e)=>{"use strict";e.d(I,{Xb:()=>s,c4:()=>o,d9:()=>r,w_:()=>l,yd:()=>m});var t=e(65307),n=e(39070);const s={loadingState:n.Gu.Loading,libraryPanels:[],totalCount:0,perPage:40,page:1,numberOfPages:0,currentPanelId:void 0},r=(0,t.VP)("libraryPanels/view/initSearch"),o=(0,t.VP)("libraryPanels/view/searchCompleted"),m=(0,t.VP)("libraryPanels/view/changePage"),l=(i,u)=>{if(r.match(u))return{...i,loadingState:n.Gu.Loading};if(o.match(u)){const{libraryPanels:d,page:p,perPage:c,totalCount:y}=u.payload,f=Math.ceil(y/c);return{...i,libraryPanels:d,perPage:c,totalCount:y,loadingState:n.Gu.Done,numberOfPages:f,page:p>f?p-1:p}}return m.match(u)?{...i,page:u.payload.page}:i}},82792:(G,I,e)=>{"use strict";e.d(I,{X:()=>t});function t(n){return!!n.libraryPanel?.uid}},57767:(G,I,e)=>{"use strict";e.d(I,{GN:()=>f,GX:()=>E,Yr:()=>u,d7:()=>p,dq:()=>i,e9:()=>d,h4:()=>y,jc:()=>c,xV:()=>P});var t=e(75505),n=e(79422),s=e(34214),r=e(41507),o=e(20455),m=e(27677),l=e(98796);async function i({searchString:g="",perPage:h=100,page:D=1,excludeUid:v="",sortDirection:C="",typeFilter:T=[],folderFilterUIDs:S=[]}={}){const O=new URLSearchParams;O.append("searchString",g),O.append("sortDirection",C),O.append("typeFilter",T.join(",")),O.append("folderFilterUIDs",S.join(",")),O.append("excludeUid",v),O.append("perPage",h.toString(10)),O.append("page",D.toString(10)),O.append("kind",l.i.Panel.toString(10));const{result:x}=await(0,m.AI)().get(`/api/library-elements?${O.toString()}`);return x}async function u(g,h=!1){const D=await(0,t.s)((0,m.AI)().fetch({method:"GET",url:`/api/library-elements/${g}`,showSuccessAlert:!h,showErrorAlert:!h})),{result:v}=D.data,C=new s.G({...n.Ye,schemaVersion:35,panels:[v.model]}),{scopedVars:T,...S}=C.panels[0].getSaveModel();return delete S.gridPos,delete S.id,delete S.libraryPanel,C.destroy(),{...v,model:S}}async function d(g){const{result:h}=await(0,m.AI)().get(`/api/library-elements/name/${g}`);return h}async function p(g,h){const{result:D}=await(0,m.AI)().post("/api/library-elements",{folderUid:h,name:g.libraryPanel.name,model:g,kind:l.i.Panel});return D}async function c(g){const{libraryPanel:h,...D}=g,{uid:v,name:C,version:T,folderUid:S}=h,O=l.i.Panel,{result:x}=await(0,m.AI)().patch(`/api/library-elements/${v}`,{folderUid:S,name:C,model:D,version:T,kind:O});return x}function y(g){return(0,m.AI)().delete(`/api/library-elements/${g}`)}async function f(g){const{result:h}=await(0,m.AI)().get(`/api/library-elements/${g}/connections`);return h}async function P(g){const h=await f(g);return h.length===0?[]:await(0,m.AI)().search({dashboardUIDs:h.map(v=>v.connectionUid)})}function a(g){const{panel:h,uid:D,name:v,_loadedPanel:C}=g.state,T=g.parent;if(!T||!(T instanceof r.U))throw new Error("LibraryVizPanel must be a child of DashboardGridItem");return{uid:D,folderUID:C?.folderUid,name:v,version:C?.version||0,model:(0,o.Z6)(h,{x:T.state.x??0,y:T.state.y??0,w:T.state.width??0,h:T.state.height??0},!1,T),kind:l.i.Panel}}async function E(g){const{uid:h,folderUID:D,name:v,model:C,version:T,kind:S}=a(g);console.log("updateLibraryVizPanel",C);const{result:O}=await(0,m.AI)().patch(`/api/library-elements/${h}`,{folderUID:D,name:v,model:C,version:T,kind:S});return O}},43535:(G,I,e)=>{"use strict";e.d(I,{o:()=>n});var t=e(32196);function n(s){return{myTable:(0,t.css)`
      max-height: 204px;
      overflow-y: auto;
      margin-top: 11px;
      margin-bottom: 28px;
      border-radius: ${s.shape.radius.default};
      border: 1px solid ${s.colors.action.hover};
      background: ${s.colors.background.primary};
      color: ${s.colors.text.secondary};
      font-size: ${s.typography.h6.fontSize};
      width: 100%;

      thead {
        color: #538ade;
        font-size: ${s.typography.bodySmall.fontSize};
      }

      th,
      td {
        padding: 6px 13px;
        height: ${s.spacing(4)};
      }

      tbody > tr:nth-child(odd) {
        background: ${s.colors.background.secondary};
      }
    `,noteTextbox:(0,t.css)`
      margin-bottom: ${s.spacing(4)};
    `,textInfo:(0,t.css)`
      color: ${s.colors.text.secondary};
      font-size: ${s.typography.size.sm};
    `,dashboardSearch:(0,t.css)`
      margin-top: ${s.spacing(2)};
    `,modal:(0,t.css)`
      width: 500px;
    `,modalText:(0,t.css)`
      font-size: ${s.typography.h4.fontSize};
      color: ${s.colors.text.primary};
      margin-bottom: ${s.spacing(4)};
      padding-top: ${s.spacing(2)};
    `}}},98796:(G,I,e)=>{"use strict";e.d(I,{i:()=>t});var t=(s=>(s[s.Panel=1]="Panel",s))(t||{}),n=(s=>(s[s.Dashboard=1]="Dashboard",s))(n||{})},88861:(G,I,e)=>{"use strict";e.d(I,{b:()=>d});var t=e(5805),n=e(17172),s=e(3169),r=e(8484),o=e(57767);async function m(p,c){const y=l(p),f=await u(y,c);return i(p,f),f}function l(p){let{scopedVars:c,...y}=p.getSaveModel();return y={libraryPanel:{name:p.title,uid:void 0},...y},y}function i(p,c){p.restoreModel({...c.model,configRev:0,libraryPanel:c,title:p.title}),p.hasSavedPanelEditChange=!0,p.refresh()}function u(p,c){return p.libraryPanel?p.libraryPanel&&p.libraryPanel.uid===""?(0,o.d7)(p,c):(0,o.jc)(p):Promise.reject()}const d=()=>{const p=(0,s._2)(),[c,y]=(0,t.default)(async(f,P)=>{try{const a=await m(f,P);return p.success((0,r.t)("library-panels.save.success","Library panel saved")),a}catch(a){throw(0,n.NF)(a)&&(a.isHandled=!0,p.error((0,r.t)("library-panels.save.error",'Error saving library panel: "{{errorMsg}}"',{errorMsg:a.message??a.data.message}))),a}},[]);return{state:c,saveLibraryPanel:y}}},6473:(G,I,e)=>{"use strict";e.d(I,{t:()=>h});var t=e(62938),n=e(55004),s=e(26272),r=e(78731),o=e(12131),m=e(10096),l=e(28444),i=e(14792),u=e(32196),d=e(96540),p=e(40845),c=e(37390),y=e(55852),f=(D=>(D.Saved="saved",D.EditingStarted="editing-started",D.EditingCanceled="editing-cancelled",D.Deleted="deleted",D))(f||{});function P({onDismiss:D,event:v}){const C=(0,p.of)(a),T=()=>{if(v?.action===f.Deleted){o.Ny.push("/");return}h.reloadPage(),D()};return d.createElement(c.a,{isOpen:!0,title:"Dashboard changed",icon:"copy",onDismiss:D,onClickBackdrop:()=>{},className:C.modal},d.createElement("div",{className:C.description},"The dashboad has been updated by another session. Do you want to continue editing or discard your local changes?"),d.createElement(c.a.ButtonRow,null,d.createElement(y.$n,{onClick:D,variant:"secondary",fill:"outline"},"Continue editing"),d.createElement(y.$n,{onClick:T,variant:"destructive"},"Discard local changes")))}const a=D=>({modal:(0,u.css)({width:"600px"}),description:(0,u.css)({color:D.colors.text.secondary,paddingBottom:D.spacing(1)})}),E=(0,t.A)();class g{constructor(){this.editing=!1,this.observer={next:v=>{if((0,n.ew)(v)&&this.editing&&v.state===n.ZF.Connected&&this.sendEditingState(),(0,n.Z7)(v)){if(v.message.sessionId===E)return;const{action:C}=v.message;switch(C){case f.EditingStarted:case f.Saved:{if(this.ignoreSave){this.ignoreSave=!1;return}const T=(0,i.UA)().getCurrent();if(T?.uid!==v.message.uid){console.log("dashboard event for different dashboard?",v,T);return}const S=this.editing||T.hasUnsavedChanges();if(C===f.Saved)S?m.lE.publish(new l.S8({component:P,props:{event:v}})):(m.lE.emit(s.r1.alertSuccess,["Dashboard updated"]),this.reloadPage());else if(S&&C===f.EditingStarted&&!this.hasSeenNotice){const O=v.message,x=this.getRecentEditingEvent();(!x||x.message!==O.message)&&(this.hasSeenNotice=!0,m.lE.emit(s.r1.alertWarning,["Another session is editing this dashboard",O.message])),this.lastEditing=O}return}}}}}}setEditingState(v){const C=this.editing=v;this.editing=v,this.hasSeenNotice=!1,C&&m.TP.isEditor&&this.sendEditingState()}sendEditingState(){const{channel:v,uid:C}=this;v&&C&&(0,r.oF)().publish(v,{sessionId:E,uid:C,action:this.editing?f.EditingStarted:f.EditingCanceled,timestamp:Date.now()})}watch(v){const C=(0,r.oF)();C&&v!==this.uid&&(this.channel={scope:n.qD.Grafana,namespace:"dashboard",path:`uid/${v}`},this.leave(),v&&(this.subscription=C.getStream(this.channel).subscribe(this.observer)),this.uid=v)}leave(){this.subscription&&this.subscription.unsubscribe(),this.subscription=void 0,this.uid=void 0}ignoreNextSave(){this.ignoreSave=!0}getRecentEditingEvent(){return this.lastEditing&&this.lastEditing.timestamp&&Date.now()-this.lastEditing.timestamp>5e3&&(this.lastEditing=void 0),this.lastEditing}reloadPage(){o.Ny.reload()}}const h=new g},47118:(G,I,e)=>{"use strict";e.d(I,{_w:()=>n,o$:()=>m,ot:()=>s});var t=e(14236),n=(l=>(l.NewValuesSameSchema="NewValuesSameSchema",l.FullFrame="FullFrame",l))(n||{});const s=(l,i)=>"type"in l&&l.type===i,r=Object.values(n),o=l=>"type"in l&&r.includes(l.type),m=l=>(0,t.ci)(l)&&"packetInfo"in l},39408:(G,I,e)=>{"use strict";e.d(I,{l:()=>s});var t=e(89667),n=e(17172);async function s(){return(0,n.AI)().get("api/live/list").then(r=>{const o=r.channels??[],m={},l=o.map(i=>{if(i.data){const u=new Set,d=(0,t.or)(i.data);for(const p of d.fields)u.add(p.name);m[i.channel]=Array.from(u).map(p=>({value:p,label:p}))}return{value:i.channel,label:i.channel+" ["+i.minute_rate+" msg/min]"}});return{channelFields:m,channels:l}})}},81073:(G,I,e)=>{"use strict";e.d(I,{I:()=>r});var t=e(32196),n=e(96540),s=e(62930);const r=({adjective:m="newer"})=>{const l=`Loading ${m} logs...`;return n.createElement("div",{className:o},n.createElement("div",null,l," ",n.createElement(s.y,{inline:!0})))},o=(0,t.css)`
  display: flex;
  justify-content: center;
`},93463:(G,I,e)=>{"use strict";e.d(I,{A:()=>l,h:()=>m});var t=e(32196),n=e(96540),s=e(40845),r=e(56034);const o=["level","lvl","filename"],m=n.memo(({labels:d,emptyMessage:p})=>{const c=(0,s.of)(u),y=(0,n.useMemo)(()=>Object.keys(d).filter(f=>!f.startsWith("_")&&!o.includes(f)).sort(),[d]);return y.length===0&&p?n.createElement("span",{className:(0,t.cx)([c.logsLabels])},n.createElement("span",{className:(0,t.cx)([c.logsLabel])},p)):n.createElement("span",{className:(0,t.cx)([c.logsLabels])},y.map(f=>{const P=d[f];if(!P)return;const a=`${f}=${P}`;return n.createElement(r.m,{content:a,key:f,placement:"top"},n.createElement(i,{styles:c},a))}))});m.displayName="LogLabels";const l=n.memo(({labels:d})=>{const p=(0,s.of)(u);return n.createElement("span",{className:(0,t.cx)([p.logsLabels])},d.map(c=>n.createElement(i,{key:c,styles:p,tooltip:c},c)))});l.displayName="LogLabelsList";const i=n.forwardRef(({styles:d,tooltip:p,children:c},y)=>n.createElement("span",{className:(0,t.cx)([d.logsLabel]),ref:y},n.createElement("span",{className:(0,t.cx)([d.logsLabelValue]),title:p},c)));i.displayName="LogLabel";const u=d=>({logsLabels:(0,t.css)`
      display: flex;
      flex-wrap: wrap;
      font-size: ${d.typography.size.xs};
    `,logsLabel:(0,t.css)`
      label: logs-label;
      display: flex;
      padding: ${d.spacing(0,.25)};
      background-color: ${d.colors.background.secondary};
      border-radius: ${d.shape.radius.default};
      margin: ${d.spacing(.125,.5,0,0)};
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    `,logsLabelValue:(0,t.css)`
      label: logs-label__value;
      display: inline-block;
      max-width: ${d.spacing(25)};
      text-overflow: ellipsis;
      overflow: hidden;
    `})},85492:(G,I,e)=>{"use strict";e.d(I,{$:()=>u});var t=e(88838),n=e(96540),s=e(23257),r=e.n(s),o=e(21),m=e(40845);function l(d,p){return p.split(/;\s*/).reduce((c,y)=>{if(y==="color:rgba(0,0,0,0.5)")return{color:d.colors.text.secondary};const f=y.match(/([^:\s]+)\s*:\s*(.+)/);if(f&&f[1]&&f[2]){const P=f[1].replace(/-([a-z])/g,(a,E)=>E.toUpperCase());c[P]=f[2]}return c},{})}class i extends n.PureComponent{constructor(){super(...arguments),this.state={chunks:[],prevValue:""}}static getDerivedStateFromProps(p,c){return p.value===c.prevValue?null:{chunks:t.Ay.parse(p.value).spans.map(f=>f.css?{style:l(p.theme,f.css),text:f.text}:{text:f.text}),prevValue:p.value}}render(){const{chunks:p}=this.state;return p.map((c,y)=>{const f=this.props.highlight?.searchWords?n.createElement(r(),{key:y,textToHighlight:c.text,searchWords:this.props.highlight.searchWords,findChunks:o.Oq,highlightClassName:this.props.highlight.highlightClassName}):c.text;return c.style?n.createElement("span",{key:y,style:c.style,"data-testid":"ansiLogLine"},f):f})}}const u=(0,m.cV)(i);u.displayName="LogMessageAnsi"},42785:(G,I,e)=>{"use strict";e.d(I,{Q:()=>i});var t=e(96540),n=e(76885),s=e(71733),r=e(43127),o=e(29158),m=e(10534),l=e(2913);const i=t.memo(({logText:u,onOpenContext:d,onPermalinkClick:p,onPinLine:c,onUnpinLine:y,pinned:f,row:P,showContextToggle:a,styles:E,mouseIsOver:g,onBlur:h,getRowContextQuery:D})=>{const v=a?a(P):!1,C=(0,t.useCallback)(x=>{x.stopPropagation()},[]),T=(0,t.useCallback)(async x=>{if(x.stopPropagation(),D&&(x.nativeEvent.ctrlKey||x.nativeEvent.metaKey||x.nativeEvent.shiftKey)){const b=window.open("about:blank"),M=await D(P,void 0,!1);if(M&&b){const A=n.kM.renderUrl(s.I.assureBaseUrl(`${(0,l.zj)().appSubUrl}explore`),{left:JSON.stringify({datasource:M.datasource,queries:[M],range:(0,r.E2)()})});b.location=A;return}b?.close()}d(P)},[d,D,P]),S=(0,t.useCallback)(x=>{!x.currentTarget.contains(x.relatedTarget)&&h&&h()},[h]),O=(0,t.useCallback)(()=>u,[u]);return t.createElement("span",{className:`log-row-menu ${E.rowMenu}`,onClick:C,onBlur:S},f&&!g&&t.createElement(o.K,{className:E.unPinButton,size:"md",name:"gf-pin",onClick:()=>y&&y(P),tooltip:"Unpin line",tooltipPlacement:"top","aria-label":"Unpin line",tabIndex:0}),g&&t.createElement(t.Fragment,null,v&&t.createElement(o.K,{size:"md",name:"gf-show-context",onClick:T,tooltip:"Show context",tooltipPlacement:"top","aria-label":"Show context",tabIndex:0}),t.createElement(m.b,{className:E.copyLogButton,icon:"copy",variant:"secondary",fill:"text",size:"md",getText:O,tooltip:"Copy to clipboard",tooltipPlacement:"top",tabIndex:0}),f&&y&&t.createElement(o.K,{className:E.unPinButton,size:"md",name:"gf-pin",onClick:()=>y&&y(P),tooltip:"Unpin line",tooltipPlacement:"top","aria-label":"Unpin line",tabIndex:0}),!f&&c&&t.createElement(o.K,{className:E.unPinButton,size:"md",name:"gf-pin",onClick:()=>c&&c(P),tooltip:"Pin line",tooltipPlacement:"top","aria-label":"Pin line",tabIndex:0}),p&&P.rowId!==void 0&&P.uid&&t.createElement(o.K,{tooltip:"Copy shortlink","aria-label":"Copy shortlink",tooltipPlacement:"top",size:"md",name:"share-alt",onClick:()=>p(P),tabIndex:0})))});i.displayName="LogRowMenuCell"},40455:(G,I,e)=>{"use strict";e.d(I,{S:()=>l,a:()=>d});var t=e(96540),n=e(23257),s=e.n(n),r=e(21),o=e(85492),m=e(42785);const l=1e5,i=({hasAnsi:p,entry:c,highlights:y,styles:f})=>{const P=y&&y.length>0&&y[0]&&y[0].length>0&&c.length<l,a=y??[];if(p){const E=P?{searchWords:a,highlightClassName:f.logsRowMatchHighLight}:void 0;return t.createElement(o.$,{value:c,highlight:E})}else if(P)return t.createElement(s(),{textToHighlight:c,searchWords:a,findChunks:r.Oq,highlightClassName:f.logsRowMatchHighLight});return t.createElement(t.Fragment,null,c)},u=(p,c,y,f)=>{if(c)try{return JSON.stringify(JSON.parse(p),void 0,2)}catch{}return!y&&!f&&(p=p.replace(/(\r\n|\n|\r)/g,"")),p},d=t.memo(p=>{const{row:c,wrapLogMessage:y,prettifyLogMessage:f,showContextToggle:P,styles:a,onOpenContext:E,onPermalinkClick:g,onUnpinLine:h,onPinLine:D,pinned:v,mouseIsOver:C,onBlur:T,getRowContextQuery:S,expanded:O}=p,{hasAnsi:x,raw:b}=c,M=(0,t.useMemo)(()=>u(b,f,y,!!O),[b,f,y,O]),A=(0,t.useMemo)(()=>C||v,[C,v]);return t.createElement(t.Fragment,null,t.createElement("td",{className:a.logsRowMessage},t.createElement("div",{className:y?a.positionRelative:a.horizontalScroll},t.createElement("button",{className:`${a.logLine} ${a.positionRelative}`},t.createElement(i,{hasAnsi:x,entry:M,highlights:c.searchWords,styles:a})))),t.createElement("td",{className:`log-row-menu-cell ${a.logRowMenuCell}`},A&&t.createElement(m.Q,{logText:M,row:c,showContextToggle:P,getRowContextQuery:S,onOpenContext:E,onPermalinkClick:g,onPinLine:D,onUnpinLine:h,pinned:v,styles:a,mouseIsOver:C,onBlur:T})))});d.displayName="LogRowMessage"},14647:(G,I,e)=>{"use strict";e.d(I,{k:()=>ee});var t=e(32196),n=e(41811),s=e(96540),r=e(41987),o=e(52622),m=e(32264),l=e(40845),i=e(14110),u=e(38138),d=e(91002);const p=({x:z,y:te,onClickFilterValue:ie,onClickFilterOutValue:ce,selection:ue,row:fe,close:Te})=>{const he=(0,s.useRef)(null),de=(0,l.of)(y);return(0,s.useEffect)(()=>{function pe(ve){ve.key==="Escape"&&Te()}return document.addEventListener("keyup",pe),()=>{document.removeEventListener("keyup",pe)}},[Te]),ie||ce?s.createElement("div",{className:de.menu,style:{top:te,left:z}},s.createElement(u.W,{ref:he},s.createElement(u.W.Item,{label:"Copy selection",onClick:()=>{(0,d.Dk)(ue,he),Te(),c("copy",ue.length,fe.datasourceType)}}),ie&&s.createElement(u.W.Item,{label:"Add as line contains filter",onClick:()=>{ie(ue,fe.dataFrame.refId),Te(),c("line_contains",ue.length,fe.datasourceType)}}),ce&&s.createElement(u.W.Item,{label:"Add as line does not contain filter",onClick:()=>{ce(ue,fe.dataFrame.refId),Te(),c("line_does_not_contain",ue.length,fe.datasourceType)}}))):null};function c(z,te,ie){(0,i.rR)("grafana_explore_logs_popover_menu",{action:z,selectionLength:te,datasourceType:ie||"unknown"})}const y=z=>({menu:(0,t.css)({position:"fixed",zIndex:z.zIndex.modal})});class f{constructor(){this.seen=new Set,this.count=0}getKey(te){this.count+=1;const ie=`k_${te}`;return this.seen.has(ie)?`i_${this.count}`:(this.seen.add(ie),ie)}}var P=e(2543),a=e(72724),E=e(56034),g=e(14578),h=e(41260),D=e(10534),v=e(29158),C=e(14689),T=e(69147),S=e(3911);const O=z=>({logsStatsRow:(0,t.css)`
    label: logs-stats-row;
    margin: ${parseInt(z.spacing(2),10)/1.75}px 0;
  `,logsStatsRowActive:(0,t.css)`
    label: logs-stats-row--active;
    color: ${z.colors.primary.text};
    position: relative;
  `,logsStatsRowLabel:(0,t.css)`
    label: logs-stats-row__label;
    display: flex;
    margin-bottom: 1px;
  `,logsStatsRowValue:(0,t.css)`
    label: logs-stats-row__value;
    flex: 1;
    text-overflow: ellipsis;
    overflow: hidden;
  `,logsStatsRowCount:(0,t.css)`
    label: logs-stats-row__count;
    text-align: right;
    margin-left: ${z.spacing(.75)};
  `,logsStatsRowPercent:(0,t.css)`
    label: logs-stats-row__percent;
    text-align: right;
    margin-left: ${z.spacing(.75)};
    width: ${z.spacing(4.5)};
  `,logsStatsRowBar:(0,t.css)`
    label: logs-stats-row__bar;
    height: ${z.spacing(.5)};
    overflow: hidden;
    background: ${z.colors.text.disabled};
  `,logsStatsRowInnerBar:(0,t.css)`
    label: logs-stats-row__innerbar;
    height: ${z.spacing(.5)};
    overflow: hidden;
    background: ${z.colors.primary.main};
  `}),x=({active:z,count:te,proportion:ie,value:ce})=>{const ue=(0,l.of)(O),fe=`${Math.round(ie*100)}%`,Te={width:fe},he=z?(0,t.cx)([ue.logsStatsRow,ue.logsStatsRowActive]):(0,t.cx)([ue.logsStatsRow]);return s.createElement("div",{className:he},s.createElement("div",{className:(0,t.cx)([ue.logsStatsRowLabel])},s.createElement("div",{className:(0,t.cx)([ue.logsStatsRowValue]),title:ce},ce),s.createElement("div",{className:(0,t.cx)([ue.logsStatsRowCount])},te),s.createElement("div",{className:(0,t.cx)([ue.logsStatsRowPercent])},fe)),s.createElement("div",{className:(0,t.cx)([ue.logsStatsRowBar])},s.createElement("div",{className:(0,t.cx)([ue.logsStatsRowInnerBar]),style:Te})))};x.displayName="LogLabelStatsRow";const b=5,M=(0,S.N)(z=>({logsStats:(0,t.css)`
      label: logs-stats;
      background: inherit;
      color: ${z.colors.text.primary};
      word-break: break-all;
      width: fit-content;
      max-width: 100%;
    `,logsStatsHeader:(0,t.css)`
      label: logs-stats__header;
      border-bottom: 1px solid ${z.colors.border.medium};
      display: flex;
    `,logsStatsTitle:(0,t.css)`
      label: logs-stats__title;
      font-weight: ${z.typography.fontWeightMedium};
      padding-right: ${z.spacing(2)};
      display: inline-block;
      white-space: nowrap;
      text-overflow: ellipsis;
      flex-grow: 1;
    `,logsStatsClose:(0,t.css)`
      label: logs-stats__close;
      cursor: pointer;
    `,logsStatsBody:(0,t.css)`
      label: logs-stats__body;
      padding: 5px 0px;
    `}));class A extends s.PureComponent{render(){const{label:te,rowCount:ie,stats:ce,value:ue,theme:fe,isLabel:Te}=this.props,he=M(fe),de=ce.slice(0,b);let le=de.find(we=>we.value===ue),pe=ce.slice(b);const ve=!le;ve&&(le=pe.find(we=>we.value===ue),pe=pe.filter(we=>we.value!==ue));const be=pe.reduce((we,Re)=>we+Re.count,0),Me=de.reduce((we,Re)=>we+Re.count,0)+be,Ue=be/Me;return s.createElement("div",{className:he.logsStats,"data-testid":"logLabelStats"},s.createElement("div",{className:he.logsStatsHeader},s.createElement("div",{className:he.logsStatsTitle},te,": ",Me," of ",ie," rows have that ",Te?"label":"field")),s.createElement("div",{className:he.logsStatsBody},de.map(we=>s.createElement(x,{key:we.value,...we,active:we.value===ue})),ve&&le&&s.createElement(x,{key:le.value,...le,active:!0}),be>0&&s.createElement(x,{key:"__OTHERS__",count:be,value:"Other",proportion:Ue})))}}const R=(0,l.cV)(A);R.displayName="LogLabelStats";var B=e(77020);const U=(0,n.A)(z=>({wordBreakAll:(0,t.css)`
      label: wordBreakAll;
      word-break: break-all;
    `,copyButton:(0,t.css)`
      & > button {
        color: ${z.colors.text.secondary};
        padding: 0;
        justify-content: center;
        border-radius: ${z.shape.radius.circle};
        height: ${z.spacing(z.components.height.sm)};
        width: ${z.spacing(z.components.height.sm)};
        svg {
          margin: 0;
        }

        span > div {
          top: -5px;
          & button {
            color: ${z.colors.success.main};
          }
        }
      }
    `,adjoiningLinkButton:(0,t.css)`
      margin-left: ${z.spacing(1)};
    `,wrapLine:(0,t.css)`
      label: wrapLine;
      white-space: pre-wrap;
    `,logDetailsStats:(0,t.css)`
      padding: 0 ${z.spacing(1)};
    `,logDetailsValue:(0,t.css)`
      display: flex;
      align-items: center;
      line-height: 22px;

      .log-details-value-copy {
        visibility: hidden;
      }
      &:hover {
        .log-details-value-copy {
          visibility: visible;
        }
      }
    `,buttonRow:(0,t.css)`
      display: flex;
      flex-direction: row;
      gap: ${z.spacing(.5)};
      margin-left: ${z.spacing(.5)};
    `}));class W extends s.PureComponent{constructor(){super(...arguments),this.state={showFieldsStats:!1,fieldCount:0,fieldStats:null},this.showField=()=>{const{onClickShowField:te,parsedKeys:ie,row:ce}=this.props;te&&te(ie[0]),(0,i.rR)("grafana_explore_logs_log_details_replace_line_clicked",{datasourceType:ce.datasourceType,logRowUid:ce.uid,type:"enable"})},this.hideField=()=>{const{onClickHideField:te,parsedKeys:ie,row:ce}=this.props;te&&te(ie[0]),(0,i.rR)("grafana_explore_logs_log_details_replace_line_clicked",{datasourceType:ce.datasourceType,logRowUid:ce.uid,type:"disable"})},this.isFilterLabelActive=async()=>{const{isFilterLabelActive:te,parsedKeys:ie,parsedValues:ce,row:ue}=this.props;return te?await te(ie[0],ce[0],ue.dataFrame?.refId):!1},this.filterLabel=()=>{const{onClickFilterLabel:te,parsedKeys:ie,parsedValues:ce,row:ue}=this.props;te&&te(ie[0],ce[0],(0,T.f8)(ue)||void 0),(0,i.rR)("grafana_explore_logs_log_details_filter_clicked",{datasourceType:ue.datasourceType,filterType:"include",logRowUid:ue.uid})},this.filterOutLabel=()=>{const{onClickFilterOutLabel:te,parsedKeys:ie,parsedValues:ce,row:ue}=this.props;te&&te(ie[0],ce[0],(0,T.f8)(ue)||void 0),(0,i.rR)("grafana_explore_logs_log_details_filter_clicked",{datasourceType:ue.datasourceType,filterType:"exclude",logRowUid:ue.uid})},this.updateStats=()=>{const{getStats:te}=this.props,ie=te(),ce=ie?ie.reduce((ue,fe)=>ue+fe.count,0):0;(!(0,P.isEqual)(this.state.fieldStats,ie)||ce!==this.state.fieldCount)&&this.setState({fieldStats:ie,fieldCount:ce})},this.showStats=()=>{const{isLabel:te,row:ie,app:ce}=this.props,{showFieldsStats:ue}=this.state;ue||this.updateStats(),this.toggleFieldsStats(),(0,i.rR)("grafana_explore_logs_log_details_stats_clicked",{dataSourceType:ie.datasourceType,fieldType:te?"label":"detectedField",type:ue?"close":"open",logRowUid:ie.uid,app:ce})}}componentDidUpdate(){this.state.showFieldsStats&&this.updateStats()}toggleFieldsStats(){this.setState(te=>({showFieldsStats:!te.showFieldsStats}))}generateClipboardButton(te){const{theme:ie}=this.props,ce=U(ie);return s.createElement("div",{className:`log-details-value-copy ${ce.copyButton}`},s.createElement(D.b,{getText:()=>te,title:"Copy value to clipboard",fill:"text",variant:"secondary",icon:"copy",size:"md"}))}generateMultiVal(te,ie){return s.createElement("table",null,s.createElement("tbody",null,te?.map((ce,ue)=>s.createElement("tr",{key:`${ce}-${ue}`},s.createElement("td",null,ce,ie&&ce!==""&&this.generateClipboardButton(ce))))))}render(){const{theme:te,parsedKeys:ie,parsedValues:ce,isLabel:ue,links:fe,displayedFields:Te,wrapLogMessage:he,onClickFilterLabel:de,onClickFilterOutLabel:le,disableActions:pe,row:ve}=this.props,{showFieldsStats:be,fieldStats:Oe,fieldCount:Me}=this.state,Ue=U(te),we=(0,B.D)(te),Re=ie==null?!1:ie.length===1,Fe=ce==null?!1:ce.length===1,xe=!pe&&de&&le,Ve=ve.dataFrame?.refId?` in query ${ve.dataFrame?.refId}`:"",$e=!Fe&&ce!=null&&!ce.every(gt=>gt===""),Xe=Te&&ie!=null&&Te.includes(ie[0])?s.createElement(v.K,{variant:"primary",tooltip:"Hide this field",name:"eye",onClick:this.hideField}):s.createElement(v.K,{tooltip:"Show this field instead of the message",name:"eye",onClick:this.showField});return s.createElement(s.Fragment,null,s.createElement("tr",{className:we.logDetailsValue},s.createElement("td",{className:we.logsDetailsIcon},s.createElement("div",{className:Ue.buttonRow},xe&&s.createElement(s.Fragment,null,s.createElement(N,{name:"search-plus",onClick:this.filterLabel,isActive:()=>this.isFilterLabelActive(),tooltipSuffix:Ve}),s.createElement(v.K,{name:"search-minus",tooltip:`Filter out value${Ve}`,onClick:this.filterOutLabel})),!pe&&Te&&Xe,!pe&&s.createElement(v.K,{variant:be?"primary":"secondary",name:"signal",tooltip:"Ad-hoc statistics",className:"stats-button",disabled:!Re,onClick:this.showStats}))),s.createElement("td",{className:we.logDetailsLabel},Re?ie[0]:this.generateMultiVal(ie)),s.createElement("td",{className:(0,t.cx)(Ue.wordBreakAll,he&&Ue.wrapLine)},s.createElement("div",{className:Ue.logDetailsValue},Fe?ce[0]:this.generateMultiVal(ce,!0),Fe&&this.generateClipboardButton(ce[0]),s.createElement("div",{className:(0,t.cx)((Fe||$e)&&Ue.adjoiningLinkButton)},fe?.map((gt,Dt)=>s.createElement("span",{key:`${gt.title}-${Dt}`},s.createElement(C.R,{link:gt}))))))),be&&Re&&Fe&&s.createElement("tr",null,s.createElement("td",null,s.createElement(v.K,{variant:be?"primary":"secondary",name:"signal",tooltip:"Hide ad-hoc statistics",onClick:this.showStats})),s.createElement("td",{colSpan:2},s.createElement("div",{className:Ue.logDetailsStats},s.createElement(R,{stats:Oe,label:ie[0],value:ce[0],rowCount:Me,isLabel:ue})))))}}const N=({isActive:z,tooltipSuffix:te,...ie})=>{const[ce,ue]=(0,s.useState)(!1),fe=ce?"Remove filter":"Filter for value";return(0,s.useEffect)(()=>{z().then(ue)},[z]),s.createElement(v.K,{...ie,variant:ce?"primary":void 0,tooltip:fe+te})},w=(0,l.cV)(W);w.displayName="LogDetailsRow";var L=e(70377);class V extends s.PureComponent{render(){const{app:te,row:ie,theme:ce,hasError:ue,onClickFilterOutLabel:fe,onClickFilterLabel:Te,getRows:he,showDuplicates:de,className:le,onClickShowField:pe,onClickHideField:ve,displayedFields:be,getFieldLinks:Oe,wrapLogMessage:Me,styles:Ue}=this.props,we=(0,B.L)(ce,ie.logLevel),Re=ie.labels?ie.labels:{},Fe=Object.keys(Re).length>0,xe=(0,L.jE)(ie,Oe);let Ve=xe.filter(re=>re.links?.length);const $e=Ve.filter(re=>re.fieldIndex!==ie.entryFieldIndex).sort(),Xe=Ve.filter(re=>re.fieldIndex===ie.entryFieldIndex).sort(),gt=(0,L.qE)(Xe),Dt=$e&&$e.length>0||gt&&gt.length>0,nt=ie.dataFrame.meta?.type===h.m.LogLines?[]:xe.filter(re=>re.links?.length===0&&re.fieldIndex!==ie.entryFieldIndex).sort(),at=nt&&nt.length>0,Ae=ue?"":`${we.logsRowLevelColor} ${Ue.logsRowLevel} ${Ue.logsRowLevelDetails}`;return s.createElement("tr",{className:(0,t.cx)(le,Ue.logDetails)},de&&s.createElement("td",null),s.createElement("td",{className:Ae,"aria-label":"Log level"}),s.createElement("td",{colSpan:4},s.createElement("div",{className:Ue.logDetailsContainer},s.createElement("table",{className:Ue.logDetailsTable},s.createElement("tbody",null,(Fe||at)&&s.createElement("tr",null,s.createElement("td",{colSpan:100,className:Ue.logDetailsHeading,"aria-label":"Fields"},"Fields")),Object.keys(Re).sort().map((re,Z)=>{const oe=Re[re];return s.createElement(w,{key:`${re}=${oe}-${Z}`,parsedKeys:[re],parsedValues:[oe],isLabel:!0,getStats:()=>(0,d.Tj)(he(),re),onClickFilterOutLabel:fe,onClickFilterLabel:Te,onClickShowField:pe,onClickHideField:ve,row:ie,app:te,wrapLogMessage:Me,displayedFields:be,disableActions:!1,isFilterLabelActive:this.props.isFilterLabelActive})}),nt.map((re,Z)=>{const{keys:oe,values:Ee,fieldIndex:ye}=re;return s.createElement(w,{key:`${oe[0]}=${Ee[0]}-${Z}`,parsedKeys:oe,parsedValues:Ee,onClickShowField:pe,onClickHideField:ve,onClickFilterOutLabel:fe,onClickFilterLabel:Te,getStats:()=>(0,d.s2)(ie.dataFrame.fields[ye].values),displayedFields:be,wrapLogMessage:Me,row:ie,app:te,disableActions:!1,isFilterLabelActive:this.props.isFilterLabelActive})}),Dt&&s.createElement("tr",null,s.createElement("td",{colSpan:100,className:Ue.logDetailsHeading,"aria-label":"Data Links"},"Links")),$e.map((re,Z)=>{const{keys:oe,values:Ee,links:ye,fieldIndex:Se}=re;return s.createElement(w,{key:`${oe[0]}=${Ee[0]}-${Z}`,parsedKeys:oe,parsedValues:Ee,links:ye,onClickShowField:pe,onClickHideField:ve,getStats:()=>(0,d.s2)(ie.dataFrame.fields[Se].values),displayedFields:be,wrapLogMessage:Me,row:ie,app:te,disableActions:!1})}),gt?.map((re,Z)=>{const{keys:oe,values:Ee,links:ye,fieldIndex:Se}=re;return s.createElement(w,{key:`${oe[0]}=${Ee[0]}-${Z}`,parsedKeys:oe,parsedValues:Ee,links:ye,onClickShowField:pe,onClickHideField:ve,getStats:()=>(0,d.s2)(ie.dataFrame.fields[Se].values),displayedFields:be,wrapLogMessage:Me,row:ie,app:te,disableActions:!0})}),!at&&!Fe&&!Dt&&s.createElement("tr",null,s.createElement("td",{colSpan:100,"aria-label":"No details"},"No details available")))))))}}const K=(0,l.cV)(V);K.displayName="LogDetails";var k=e(93463),j=e(40455),H=e(42785);const J=s.memo(z=>{const{row:te,detectedFields:ie,getFieldLinks:ce,wrapLogMessage:ue,styles:fe,mouseIsOver:Te,pinned:he,...de}=z,le=ue?"":X.noWrap,pe=(0,s.useMemo)(()=>(0,L.jE)(te,ce),[ce,te]),ve=(0,s.useMemo)(()=>{let Oe="";for(let Me=0;Me<ie.length;Me++){const Ue=ie[Me],we=pe.find(Re=>{const{keys:Fe}=Re;return Fe[0]===Ue});we&&(Oe+=` ${Ue}=${we.values}`),te.labels[Ue]!==void 0&&te.labels[Ue]!==null&&(Oe+=` ${Ue}=${te.labels[Ue]}`)}return Oe.trimStart()},[ie,pe,te.labels]),be=(0,s.useMemo)(()=>Te||he,[Te,he]);return s.createElement(s.Fragment,null,s.createElement("td",{className:fe.logsRowMessage},s.createElement("div",{className:le},ve)),s.createElement("td",{className:`log-row-menu-cell ${fe.logRowMenuCell}`},be&&s.createElement(H.Q,{logText:ve,row:te,styles:fe,pinned:he,mouseIsOver:Te,...de})))}),X={noWrap:(0,t.css)`
    white-space: nowrap;
  `};J.displayName="LogRowMessageDisplayedFields";class se extends s.PureComponent{constructor(te){super(te),this.state={permalinked:!1,showingContext:!1,showDetails:!1,mouseIsOver:!1},this.debouncedContextClose=(0,P.debounce)(()=>{this.setState({showingContext:!1})},3e3),this.onOpenContext=ie=>{this.setState({showingContext:!0}),this.props.onOpenContext(ie,this.debouncedContextClose)},this.onRowClick=ie=>{this.props.handleTextSelection?.(ie,this.props.row)||this.props.enableLogDetails&&((0,i.rR)("grafana_explore_logs_log_details_clicked",{datasourceType:this.props.row.datasourceType,type:this.state.showDetails?"close":"open",logRowUid:this.props.row.uid,app:this.props.app}),this.setState(ce=>({showDetails:!ce.showDetails})))},this.onMouseEnter=()=>{this.setState({mouseIsOver:!0}),this.props.onLogRowHover&&this.props.onLogRowHover(this.props.row)},this.onMouseMove=ie=>{this.props.handleTextSelection&&document.getSelection()?.toString()&&ie.buttons>0&&this.setState({mouseIsOver:!1})},this.onMouseLeave=()=>{this.setState({mouseIsOver:!1}),this.props.onLogRowHover&&this.props.onLogRowHover(void 0)},this.scrollToLogRow=(ie,ce=!1)=>{const{row:ue,permalinkedRowId:fe,scrollIntoView:Te,containerRendered:he}=this.props;if(fe!==ue.uid){(ie.permalinked||ce)&&this.setState({permalinked:!1});return}!this.state.permalinked&&he&&this.logLineRef.current&&Te&&(Te(this.logLineRef.current),(0,i.rR)("grafana_explore_logs_permalink_opened",{datasourceType:ue.datasourceType??"unknown",logRowUid:ue.uid}),this.setState({permalinked:!0}))},this.escapeRow=(0,n.A)((ie,ce)=>ie.hasUnescapedContent&&ce?{...ie,entry:(0,d.Hw)(ie.entry),raw:(0,d.Hw)(ie.raw)}:ie),this.logLineRef=s.createRef()}renderTimeStamp(te){return(0,a.LE)(te,{timeZone:this.props.timeZone,defaultWithMS:!0})}componentDidMount(){this.scrollToLogRow(this.state,!0)}componentDidUpdate(te,ie){this.scrollToLogRow(ie)}render(){const{getRows:te,onClickFilterLabel:ie,onClickFilterOutLabel:ce,onClickShowField:ue,onClickHideField:fe,enableLogDetails:Te,row:he,showDuplicates:de,showContextToggle:le,showLabels:pe,showTime:ve,displayedFields:be,wrapLogMessage:Oe,prettifyLogMessage:Me,theme:Ue,getFieldLinks:we,forceEscape:Re,app:Fe,styles:xe,getRowContextQuery:Ve}=this.props,{showDetails:$e,showingContext:Xe,permalinked:gt}=this.state,Dt=(0,B.L)(Ue,he.logLevel),{errorMessage:nt,hasError:at}=(0,d.Ei)(he),Ae=(0,t.cx)(xe.logsRow,{[xe.errorLogRow]:at,[xe.highlightBackground]:Xe||gt}),re=(0,t.cx)(xe.logsRow,{[xe.errorLogRow]:at,[xe.highlightBackground]:gt&&!this.state.showDetails}),Z=this.escapeRow(he,Re);return s.createElement(s.Fragment,null,s.createElement("tr",{ref:this.logLineRef,className:Ae,onClick:this.onRowClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onMouseMove:this.onMouseMove,onFocus:this.onMouseEnter},de&&s.createElement("td",{className:xe.logsRowDuplicates},Z.duplicates&&Z.duplicates>0?`${Z.duplicates+1}x`:null),s.createElement("td",{className:at?xe.logsRowWithError:`${Dt.logsRowLevelColor} ${xe.logsRowLevel}`},at&&s.createElement(E.m,{content:`Error: ${nt}`,placement:"right",theme:"error"},s.createElement(g.I,{className:xe.logIconError,name:"exclamation-triangle",size:"xs"}))),s.createElement("td",{title:Te?$e?"Hide log details":"See log details":"",className:Te?xe.logsRowToggleDetails:""},Te&&s.createElement(g.I,{className:xe.topVerticalAlign,name:$e?"angle-down":"angle-right"})),ve&&s.createElement("td",{className:xe.logsRowLocalTime},this.renderTimeStamp(he.timeEpochMs)),pe&&Z.uniqueLabels&&s.createElement("td",{className:xe.logsRowLabels},s.createElement(k.h,{labels:Z.uniqueLabels})),be&&be.length>0?s.createElement(J,{row:Z,showContextToggle:le,detectedFields:be,getFieldLinks:we,wrapLogMessage:Oe,onOpenContext:this.onOpenContext,onPermalinkClick:this.props.onPermalinkClick,styles:xe,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinned:this.props.pinned,mouseIsOver:this.state.mouseIsOver,onBlur:this.onMouseLeave}):s.createElement(j.a,{row:Z,showContextToggle:le,getRowContextQuery:Ve,wrapLogMessage:Oe,prettifyLogMessage:Me,onOpenContext:this.onOpenContext,onPermalinkClick:this.props.onPermalinkClick,app:Fe,styles:xe,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinned:this.props.pinned,mouseIsOver:this.state.mouseIsOver,onBlur:this.onMouseLeave,expanded:this.state.showDetails})),this.state.showDetails&&s.createElement(K,{className:re,showDuplicates:de,getFieldLinks:we,onClickFilterLabel:ie,onClickFilterOutLabel:ce,onClickShowField:ue,onClickHideField:fe,getRows:te,row:Z,wrapLogMessage:Oe,hasError:at,displayedFields:be,app:Fe,styles:xe,isFilterLabelActive:this.props.isFilterLabelActive}))}}const ae=(0,l.cV)(se);ae.displayName="LogRow";const ne=100;class q extends s.PureComponent{constructor(){super(...arguments),this.renderAllTimer=null,this.logRowsRef=(0,s.createRef)(),this.state={renderAll:!1,selection:"",selectedRow:null,popoverMenuCoordinates:{x:0,y:0}},this.openContext=(te,ie)=>{this.props.onOpenContext&&this.props.onOpenContext(te,ie)},this.handleSelection=(te,ie)=>{if(this.popoverMenuSupported()===!1)return!1;const ce=document.getSelection()?.toString();if(!ce||!this.logRowsRef.current)return!1;const ue=270,fe=105,Te=te.clientX+ue>window.innerWidth?window.innerWidth-ue:te.clientX,he=te.clientY+fe>window.innerHeight?window.innerHeight-fe:te.clientY;return this.setState({selection:ce,popoverMenuCoordinates:{x:Te,y:he},selectedRow:ie}),document.addEventListener("click",this.handleDeselection),document.addEventListener("contextmenu",this.handleDeselection),!0},this.handleDeselection=te=>{if((0,d.a8)(te.target)&&!this.logRowsRef.current?.contains(te.target)){this.closePopoverMenu();return}document.getSelection()?.toString()},this.closePopoverMenu=()=>{document.removeEventListener("click",this.handleDeselection),document.removeEventListener("contextmenu",this.handleDeselection),this.setState({selection:"",popoverMenuCoordinates:{x:0,y:0},selectedRow:null})},this.makeGetRows=(0,n.A)(te=>()=>te),this.sortLogs=(0,n.A)((te,ie)=>(0,d.oR)(te,ie))}static{this.defaultProps={previewLimit:ne}}popoverMenuSupported(){return!m.$.featureToggles.logRowsPopoverMenu||this.props.app!==r.Jk.Explore?!1:!!(this.props.onClickFilterOutValue||this.props.onClickFilterValue)}componentDidMount(){const{logRows:te,previewLimit:ie}=this.props,ue=(te?te.length:0)<=ie*2;ue?this.setState({renderAll:ue}):this.renderAllTimer=window.setTimeout(()=>this.setState({renderAll:!0}),2e3)}componentWillUnmount(){document.removeEventListener("click",this.handleDeselection),document.removeEventListener("contextmenu",this.handleDeselection),document.removeEventListener("selectionchange",this.handleDeselection),this.renderAllTimer&&clearTimeout(this.renderAllTimer)}render(){const{deduplicatedRows:te,logRows:ie,dedupStrategy:ce,theme:ue,logsSortOrder:fe,previewLimit:Te,...he}=this.props,{renderAll:de}=this.state,le=(0,B.D)(ue),pe=te||ie,ve=ie&&ie.length>0,be=pe?pe.reduce((Ve,$e)=>$e.duplicates?Ve+$e.duplicates:Ve,0):0,Oe=ce!==o.fY.none&&be>0,Me=pe||[],Ue=fe?this.sortLogs(Me,fe):Me,we=Ue.slice(0,Te),Re=Ue.slice(Te,Ue.length),Fe=this.makeGetRows(Ue),xe=new f;return s.createElement("div",{className:le.logRows,ref:this.logRowsRef},this.state.selection&&this.state.selectedRow&&s.createElement(p,{close:this.closePopoverMenu,row:this.state.selectedRow,selection:this.state.selection,...this.state.popoverMenuCoordinates,onClickFilterValue:he.onClickFilterValue,onClickFilterOutValue:he.onClickFilterOutValue}),s.createElement("table",{className:(0,t.cx)(le.logsRowsTable,this.props.overflowingContent?"":le.logsRowsTableContain)},s.createElement("tbody",null,ve&&we.map(Ve=>s.createElement(ae,{key:xe.getKey(Ve.uid),getRows:Fe,row:Ve,showDuplicates:Oe,logsSortOrder:fe,onOpenContext:this.openContext,styles:le,onPermalinkClick:this.props.onPermalinkClick,scrollIntoView:this.props.scrollIntoView,permalinkedRowId:this.props.permalinkedRowId,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinned:this.props.pinnedRowId===Ve.uid,isFilterLabelActive:this.props.isFilterLabelActive,handleTextSelection:this.popoverMenuSupported()?this.handleSelection:void 0,...he})),ve&&de&&Re.map(Ve=>s.createElement(ae,{key:xe.getKey(Ve.uid),getRows:Fe,row:Ve,showDuplicates:Oe,logsSortOrder:fe,onOpenContext:this.openContext,styles:le,onPermalinkClick:this.props.onPermalinkClick,scrollIntoView:this.props.scrollIntoView,permalinkedRowId:this.props.permalinkedRowId,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinned:this.props.pinnedRowId===Ve.uid,isFilterLabelActive:this.props.isFilterLabelActive,handleTextSelection:this.popoverMenuSupported()?this.handleSelection:void 0,...he})),ve&&!de&&s.createElement("tr",null,s.createElement("td",{colSpan:5},"Rendering ",Ue.length-Te," rows...")))))}}const ee=(0,l.cV)(q);ee.displayName="LogsRows"},77020:(G,I,e)=>{"use strict";e.d(I,{D:()=>i,L:()=>l});var t=e(32196),n=e(41811),s=e(84140),r=e(9557),o=e(23596),m=e(16797);const l=(u,d)=>{let p=u.isLight?u.v1.palette.gray5:u.v1.palette.gray2;switch(d){case r.$b.crit:case r.$b.critical:p="#705da0";break;case r.$b.error:case r.$b.err:p="#e24d42";break;case r.$b.warning:case r.$b.warn:p=u.colors.warning.main;break;case r.$b.info:p="#7eb26d";break;case r.$b.debug:p="#1f78c1";break;case r.$b.trace:p="#6ed0e0";break}return{logsRowLevelColor:(0,t.css)`
      &::after {
        background-color: ${p};
      }
    `}},i=(0,n.A)(u=>{const d=m.hoverColor(u.colors.background.secondary,u),p=(0,s.A)(u.components.dashboard.background).setAlpha(.7).toRgbString();return{logsRowLevel:(0,t.css)`
      label: logs-row__level;
      max-width: ${u.spacing(1.25)};
      cursor: default;
      &::after {
        content: '';
        display: block;
        position: absolute;
        top: 1px;
        bottom: 1px;
        width: 3px;
        left: ${u.spacing(.5)};
      }
    `,logsRowWithError:(0,t.css)({maxWidth:`${u.spacing(1.5)}`}),logsRowMatchHighLight:(0,t.css)`
      label: logs-row__match-highlight;
      background: inherit;
      padding: inherit;
      color: ${u.components.textHighlight.text}
      background-color: ${u.components.textHighlight};
    `,logRows:(0,t.css)({position:"relative"}),logsRowsTable:(0,t.css)`
      label: logs-rows;
      font-family: ${u.typography.fontFamilyMonospace};
      font-size: ${u.typography.bodySmall.fontSize};
      width: 100%;
      position: relative;
    `,logsRowsTableContain:(0,t.css)`
      contain: strict;
    `,highlightBackground:(0,t.css)`
      background-color: ${(0,s.A)(u.colors.info.transparent).setAlpha(.25).toString()};
    `,logsRow:(0,t.css)`
      label: logs-row;
      width: 100%;
      cursor: pointer;
      vertical-align: top;

      &:hover {
        .log-row-menu {
          z-index: 1;
        }

        background: ${d};
      }

      td:not(.log-row-menu-cell):last-child {
        width: 100%;
      }

      > td:not(.log-row-menu-cell) {
        position: relative;
        padding-right: ${u.spacing(1)};
        border-top: 1px solid transparent;
        border-bottom: 1px solid transparent;
        height: 100%;
      }
    `,logsRowDuplicates:(0,t.css)`
      label: logs-row__duplicates;
      text-align: right;
      width: 4em;
      cursor: default;
    `,logIconError:(0,t.css)`
      color: ${u.colors.warning.main};
    `,logsRowToggleDetails:(0,t.css)`
      label: logs-row-toggle-details__level;
      font-size: 9px;
      padding-top: 5px;
      max-width: 15px;
    `,logsRowLocalTime:(0,t.css)`
      label: logs-row__localtime;
      white-space: nowrap;
    `,logsRowLabels:(0,t.css)`
      label: logs-row__labels;
      white-space: nowrap;
      max-width: 22em;

      /* This is to make the labels vertical align */
      > span {
        margin-top: 0.75px;
      }
    `,logsRowMessage:(0,t.css)`
      label: logs-row__message;
      white-space: pre-wrap;
      word-break: break-all;
      overflow-wrap: anywhere;
      width: 100%;
      text-align: left;
    `,copyLogButton:(0,t.css)`
      padding: 0 0 0 ${u.spacing(.5)};
      height: ${u.spacing(3)};
      width: ${u.spacing(3.25)};
      line-height: ${u.spacing(2.5)};
      overflow: hidden;
      &:hover {
          background-color: ${o.alpha(u.colors.text.primary,.12)};
        }
      }
    `,logDetailsContainer:(0,t.css)`
      label: logs-row-details-table;
      border: 1px solid ${u.colors.border.medium};
      padding: 0 ${u.spacing(1)} ${u.spacing(1)};
      border-radius: ${u.shape.radius.default};
      margin: ${u.spacing(2.5)} ${u.spacing(1)} ${u.spacing(2.5)} ${u.spacing(2)};
      cursor: default;
    `,logDetailsTable:(0,t.css)`
      label: logs-row-details-table;
      line-height: 18px;
      width: 100%;
      td:last-child {
        width: 100%;
      }
    `,logsDetailsIcon:(0,t.css)`
      label: logs-row-details__icon;
      position: relative;
      color: ${u.v1.palette.gray3};
      padding-top: 1px;
      padding-bottom: 1px;
      padding-right: ${u.spacing(.75)};
    `,logDetailsLabel:(0,t.css)`
      label: logs-row-details__label;
      max-width: 30em;
      min-width: 20em;
      padding: 0 ${u.spacing(1)};
      overflow-wrap: break-word;
    `,logDetailsHeading:(0,t.css)`
      label: logs-row-details__heading;
      font-weight: ${u.typography.fontWeightBold};
      padding: ${u.spacing(1)} 0 ${u.spacing(.5)};
    `,logDetailsValue:(0,t.css)`
      label: logs-row-details__row;
      position: relative;
      vertical-align: middle;
      cursor: default;

      &:hover {
        background-color: ${d};
      }
    `,topVerticalAlign:(0,t.css)`
      label: topVerticalAlign;
      margin-top: -${u.spacing(.9)};
      margin-left: -${u.spacing(.25)};
    `,detailsOpen:(0,t.css)`
      &:hover {
        background-color: ${m.hoverColor(u.colors.background.primary,u)};
      }
    `,errorLogRow:(0,t.css)`
      label: erroredLogRow;
      color: ${u.colors.text.secondary};
    `,positionRelative:(0,t.css)`
      label: positionRelative;
      position: relative;
    `,rowWithContext:(0,t.css)`
      label: rowWithContext;
      z-index: 1;
      outline: 9999px solid ${p};
      display: inherit;
    `,horizontalScroll:(0,t.css)`
      label: horizontalScroll;
      white-space: pre;
    `,contextNewline:(0,t.css)`
      display: block;
      margin-left: 0px;
    `,rowMenu:(0,t.css)`
      label: rowMenu;
      display: flex;
      flex-wrap: nowrap;
      flex-direction: row;
      align-content: flex-end;
      justify-content: space-evenly;
      align-items: center;
      position: absolute;
      top: 0;
      bottom: auto;
      background: ${u.colors.background.primary};
      box-shadow: ${u.shadows.z3};
      padding: ${u.spacing(.5,1,.5,1)};
      z-index: 100;
      gap: ${u.spacing(.5)};

      & > button {
        margin: 0;
      }
    `,logRowMenuCell:(0,t.css)`
      position: sticky;
      z-index: ${u.zIndex.dropdown};
      margin-top: -${u.spacing(.125)};
      right: 0px;

      & > span {
        transform: translateX(-100%);
      }
    `,logLine:(0,t.css)`
      background-color: transparent;
      border: none;
      diplay: inline;
      font-family: ${u.typography.fontFamilyMonospace};
      font-size: ${u.typography.bodySmall.fontSize};
      letter-spacing: ${u.typography.bodySmall.letterSpacing};
      text-align: left;
      padding: 0;
      user-select: text;
    `,logsRowLevelDetails:(0,t.css)`
      label: logs-row__level_details;
      &::after {
        top: -3px;
      }
    `,logDetails:(0,t.css)`
      label: logDetailsDefaultCursor;
      cursor: default;

      &:hover {
        background-color: ${u.colors.background.primary};
      }
    `,visibleRowMenu:(0,t.css)`
      label: visibleRowMenu;
      aspect-ratio: 1/1;
      z-index: 90;
    `,linkButton:(0,t.css)`
      label: linkButton;
      > button {
        padding-top: ${u.spacing(.5)};
      }
    `,hidden:(0,t.css)`
      label: hidden;
      visibility: hidden;
    `,unPinButton:(0,t.css)`
      height: ${u.spacing(3)};
      line-height: ${u.spacing(2.5)};
    `}})},81166:(G,I,e)=>{"use strict";e.d(I,{V:()=>B});var t=e(32196),n=e(2543),s=e(96540),r=e(16817),o=e(39070),m=e(52622),l=e(9557),i=e(47232),u=e(14110),d=e(32264),p=e(40845),c=e(37390),y=e(55852),f=e(33390),P=e(97186),a=e(29436),E=e(31678),g=e(69147),h=e(91002),D=e(81073),v=e(14647),C=e(15292);function T(U){return{buttons:(0,t.css)({display:"flex",gap:U.spacing(1)})}}const S=U=>{const W=(0,p.of)(T),{wrapLines:N,onChangeWrapLines:w,onScrollCenterClick:L}=U,V=(0,s.useCallback)(K=>{const k=K.currentTarget.checked;(0,u.rR)("grafana_explore_logs_log_context_toggle_lines_clicked",{state:k}),w(k)},[w]);return s.createElement("div",{className:W.buttons},s.createElement(C.K,{showLabel:!0,value:N,onChange:V,label:"Wrap lines"}),s.createElement(y.$n,{variant:"secondary",onClick:L},"Center matched line"))},O=U=>({modal:(0,t.css)`
      width: 85vw;
      ${U.breakpoints.down("md")} {
        width: 100%;
      }
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    `,sticky:(0,t.css)`
      position: sticky;
      z-index: 1;
      top: -1px;
      bottom: -1px;
    `,entry:(0,t.css)`
      & > td {
        padding: ${U.spacing(1)} 0 ${U.spacing(1)} 0;
      }
      background: ${U.colors.emphasize(U.colors.background.secondary)};

      & > table {
        margin-bottom: 0;
      }

      & .log-row-menu {
        margin-top: -6px;
      }
    `,datasourceUi:(0,t.css)`
      padding-bottom: ${U.spacing(1.25)};
      display: flex;
      align-items: center;
    `,logRowGroups:(0,t.css)`
      overflow: auto;
      max-height: 75%;
      align-self: stretch;
      display: inline-block;
      border: 1px solid ${U.colors.border.weak};
      border-radius: ${U.shape.radius.default};
      & > table {
        min-width: 100%;
      }
    `,flexColumn:(0,t.css)`
      display: flex;
      flex-direction: column;
      padding: 0 ${U.spacing(3)} ${U.spacing(3)} ${U.spacing(3)};
    `,flexRow:(0,t.css)`
      display: flex;
      flex-direction: row;
      align-items: center;
      & > div:last-child {
        margin-left: auto;
      }
    `,noMarginBottom:(0,t.css)`
      & > table {
        margin-bottom: 0;
      }
    `,hidden:(0,t.css)`
      display: none;
    `,paddingTop:(0,t.css)`
      padding-top: ${U.spacing(1)};
    `,paddingBottom:(0,t.css)`
      padding-bottom: ${U.spacing(1)};
    `,link:(0,t.css)`
      color: ${U.colors.text.secondary};
      font-size: ${U.typography.bodySmall.fontSize};
      :hover {
        color: ${U.colors.text.link};
      }
    `,loadingCell:(0,t.css)`
      position: sticky;
      left: 50%;
      display: inline-block;
      transform: translateX(-50%);
    `}),x=()=>({above:{loadingState:o.Gu.NotStarted,rows:[]},below:{loadingState:o.Gu.NotStarted,rows:[]}}),b=(U,W)=>U==="above"&&W===m.uH.Descending||U==="below"&&W===m.uH.Ascending?l.ZF.Forward:l.ZF.Backward,M=(U,W)=>({...U,dataFrame:{...U.dataFrame,refId:`context_${W.above}_${W.below}`}}),A=(U,W)=>U.some(N=>N.entry===W.entry&&N.timeEpochNs===W.timeEpochNs),R=100,B=({row:U,open:W,logsSortOrder:N,timeZone:w,getLogRowContextUi:L,getRowContextQuery:V,onClose:K,getRowContext:k})=>{const j=(0,s.useRef)(null),H=(0,s.useRef)(null),J=(0,s.useRef)(null),X=(0,s.useRef)(null),se=(0,s.useRef)(null),ae=(0,s.useRef)(null),ne=(0,s.useRef)(null),q=(0,s.useRef)({above:0,below:0}),ee=(0,E.useDispatch)(),z=(0,p.$j)(),te=O(z),[ie,ce]=(0,s.useState)(!0),[ue,fe]=(0,s.useState)(x()),Te=(nt,at)=>{fe(Ae=>{const re={...Ae};return re[nt]=at(Ae[nt]),re})},he=(0,s.useRef)(1),[de,le]=(0,s.useState)(null),[pe,ve]=(0,s.useState)(f.A.getBool(P.$.logContextWrapLogMessage,f.A.getBool(P.$.wrapLogMessage,!0))),be=(0,s.useCallback)(()=>{const{below:nt,above:at}=ue,Ae=(0,h.oR)([...nt.rows,U,...at.rows],m.uH.Ascending),re=Ae[0].timeEpochMs;let Z=Ae[Ae.length-1].timeEpochMs;re===Z&&(Z+=1);const oe=(0,i.KQ)(re),Ee=(0,i.KQ)(Z);return{from:oe,to:Ee,raw:{from:oe,to:Ee}}},[ue,U]),Oe=(0,s.useCallback)(async()=>{const nt=V?await V(U):null;le(nt)},[U,V]),Me=async()=>{await Oe(),fe(x()),q.current={above:0,below:0},he.current+=1},Ue=async(nt,at)=>{q.current[nt]+=1;const Ae=at.at(nt==="above"?0:-1);if(Ae==null)throw new Error("should never happen. the array always contains at least 1 item (the middle row)");(0,u.rR)("grafana_explore_logs_log_context_load_more_called",{datasourceType:Ae.datasourceType,above:q.current.above,below:q.current.below});const re=b(nt,N),Z=await k(M(Ae,q.current),{limit:R,direction:re}),oe=(0,g.HT)(Z.data).rows;return N===m.uH.Ascending&&oe.reverse(),oe.filter(ye=>!A(at,ye))};(0,s.useEffect)(()=>{W&&Oe()},[Oe,W]);const[we,Re]=(0,s.useState)([]),Fe=nt=>{we.indexOf(nt)===-1&&Re([...we,nt])},xe=nt=>{const at=we.indexOf(nt);at>-1&&(we.splice(at,1),Re([...we]))},Ve=async nt=>{const{below:at,above:Ae}=ue;if(ue[nt].loadingState===o.Gu.Loading)return;Te(nt,oe=>({...oe,loadingState:o.Gu.Loading}));const Z=he.current;try{const oe=[...Ae.rows,U,...at.rows],Ee=(await Ue(nt,oe)).map(Ke=>!Ke.searchWords||!Ke.searchWords?.length?{...Ke,searchWords:U.searchWords}:Ke),[ye,Se]=(0,n.partition)(Ee,Ke=>Ke.timeEpochNs>U.timeEpochNs),Be=N===m.uH.Ascending?Se:ye,We=N===m.uH.Ascending?ye:Se;Z===he.current&&fe(Ke=>{const it=Be.length>0?(0,h.oR)([...Be,...Ke.above.rows],N):Ke.above.rows,rt=We.length>0?(0,h.oR)([...Ke.below.rows,...We],N):Ke.below.rows;return{above:{rows:it,loadingState:nt==="above"?Ee.length===0?o.Gu.Done:o.Gu.NotStarted:Ke.above.loadingState},below:{rows:rt,loadingState:nt==="below"?Ee.length===0?o.Gu.Done:o.Gu.NotStarted:Ke.below.loadingState}}})}catch{Te(nt,oe=>({rows:oe.rows,loadingState:o.Gu.Error}))}},$e=async(nt,at)=>{for(const Ae of nt){if(!Ae.isIntersecting)continue;const re=Ae.target;re===ae.current?Ve("above"):re===ne.current&&Ve("below")}};(0,s.useEffect)(()=>{const nt=j.current,at=ae.current,Ae=ne.current;if(nt==null)return;const re=new IntersectionObserver($e,{root:nt});return at!=null&&re.observe(at),Ae!=null&&re.observe(Ae),()=>{re.disconnect()}});const Xe=(0,s.useCallback)(()=>{J.current?.scrollIntoView({block:"center"}),H.current?.scrollIntoView({block:"center"})},[J,H]);(0,s.useLayoutEffect)(()=>{const nt=j.current;if(nt==null)return;const at=se.current,Ae=nt.clientHeight;if(se.current=Ae,at!==Ae){Xe();return}if(q.current.above<=1&&q.current.below<=1){Xe();return}const re=X.current,Z=nt.scrollHeight;if(X.current=Z,re!=null){const oe=nt.scrollTop+(Z-re);nt.scrollTop=oe}},[ue.above.rows,Xe]),(0,r.A)(Oe,[V,U]);const gt=ue.above.loadingState,Dt=ue.below.loadingState;return s.createElement(c.a,{isOpen:W,title:"Log context",contentClassName:te.flexColumn,className:te.modal,onDismiss:K},d.$.featureToggles.logsContextDatasourceUi&&L&&s.createElement("div",{className:te.datasourceUi},L(U,Me)),s.createElement("div",{className:(0,t.cx)(te.flexRow,te.paddingBottom)},s.createElement("div",null,s.createElement(S,{wrapLines:pe,onChangeWrapLines:ve,onScrollCenterClick:Xe}))),s.createElement("div",{ref:j,className:te.logRowGroups},s.createElement("table",null,s.createElement("tbody",null,s.createElement("tr",null,s.createElement("td",{className:te.loadingCell},gt!==o.Gu.Done&&gt!==o.Gu.Error&&s.createElement("div",{ref:ae},s.createElement(D.I,{adjective:"newer"})),gt===o.Gu.Error&&s.createElement("div",null,"Error loading log more logs."),gt===o.Gu.Done&&s.createElement("div",null,"No more logs available."))),s.createElement("tr",null,s.createElement("td",{className:te.noMarginBottom},s.createElement(v.k,{logRows:ue.above.rows,dedupStrategy:m.fY.none,showLabels:f.A.getBool(P.$.showLabels,!1),showTime:f.A.getBool(P.$.showTime,!0),wrapLogMessage:pe,prettifyLogMessage:f.A.getBool(P.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:w,displayedFields:we,onClickShowField:Fe,onClickHideField:xe}))),s.createElement("tr",{ref:J}),s.createElement("tr",{ref:H,className:(0,t.cx)(te.entry,ie?te.sticky:null),"data-testid":"entry-row"},s.createElement("td",{className:te.noMarginBottom},s.createElement(v.k,{logRows:[U],dedupStrategy:m.fY.none,showLabels:f.A.getBool(P.$.showLabels,!1),showTime:f.A.getBool(P.$.showTime,!0),wrapLogMessage:pe,prettifyLogMessage:f.A.getBool(P.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:w,displayedFields:we,onClickShowField:Fe,onClickHideField:xe,onUnpinLine:()=>ce(!1),onPinLine:()=>ce(!0),pinnedRowId:ie?U.uid:void 0,overflowingContent:!0}))),s.createElement("tr",null,s.createElement("td",null,s.createElement(s.Fragment,null,s.createElement(v.k,{logRows:ue.below.rows,dedupStrategy:m.fY.none,showLabels:f.A.getBool(P.$.showLabels,!1),showTime:f.A.getBool(P.$.showTime,!0),wrapLogMessage:pe,prettifyLogMessage:f.A.getBool(P.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:w,displayedFields:we,onClickShowField:Fe,onClickHideField:xe})))),s.createElement("tr",null,s.createElement("td",{className:te.loadingCell},Dt!==o.Gu.Done&&Dt!==o.Gu.Error&&s.createElement("div",{ref:ne},s.createElement(D.I,{adjective:"older"})),Dt===o.Gu.Error&&s.createElement("div",null,"Error loading log more logs."),Dt===o.Gu.Done&&s.createElement("div",null,"No more logs available.")))))),s.createElement(c.a.ButtonRow,null,de?.datasource?.uid&&s.createElement(y.$n,{variant:"secondary",onClick:async()=>{let nt=U.uid;U.dataFrame.refId&&(nt=U.uid.replace(U.dataFrame.refId,de.refId)),ee((0,a.ve)({queries:[de],range:be(),datasourceUid:de.datasource.uid,panelsState:{logs:{id:nt}}})),K(),(0,u.rR)("grafana_explore_logs_log_context_open_split_view_clicked",{datasourceType:U.datasourceType,logRowUid:U.uid})}},"Open in split view")))}},70377:(G,I,e)=>{"use strict";e.d(I,{FE:()=>l,jE:()=>o,qE:()=>m});var t=e(2543),n=e.n(t),s=e(87490),r=e(98101);const o=(p,c)=>l(p,c),m=p=>{let c=[];return p.forEach(y=>{y.links?.forEach(f=>{if(f.variables){const P=f.variables.map(E=>{const g=E.variableName,h=E.fieldPath?`.${E.fieldPath}`:"";return`${g}${h}`}),a=f.variables.map(E=>E.found?E.value:"");c.push({keys:P,values:a,links:[f],fieldIndex:y.fieldIndex})}})}),c},l=(p,c)=>d(p).map(f=>{const P=c?c(f,p.rowIndex,p.dataFrame):[],a=f.values[p.rowIndex],E=typeof a=="string"||typeof a=="number"?a.toString():(0,s.MA)(a);return{keys:[f.name],values:[E],links:P,fieldIndex:f.index}});function i(p,c){const y=(0,r.O)(p);if(y===null)return new Set;const f=new Set(y.extraFields.map(P=>P.index));return y.severityField!==null&&f.add(y.severityField.index),c.keepBody&&f.add(y.bodyField.index),c.keepTimestamp&&f.add(y.timeField.index),f}function u(p,c){const y=p.fields.map((E,g)=>({...E,index:g})),f=i(p,c??{}),[P,a]=partition(y,E=>E.config.custom?.hidden?!1:(E.config.links??[]).length>0?!0:f.has(E.index));return{visible:P,hidden:a}}function d(p,c){const y=p.dataFrame,f=i(y,c??{}),P=[];for(let a=0;a<y.fields.length;a++){const E=y.fields[a];E.values[p.rowIndex]!=null&&(E.config.custom?.hidden||(E.config.links&&E.config.links.length>0||f.has(a))&&P.push({...E,index:a}))}return P}},98101:(G,I,e)=>{"use strict";e.d(I,{n:()=>y,O:()=>P});var t=e(85404),n=e(11261),s=e(41260);function r(a,E){const g=a.labels;if(g!==void 0){const h=new Array(E);return h.fill(g),h}else return null}function o(a,E,g){const h=a.getFieldByName("labels");if(h!==void 0&&h.type===n.PU.other){const D=h.values.map(y);return[h,()=>D]}else return[null,()=>r(E,g.length)]}function m(a){const E=new t.L(a),g=E.getFirstFieldOfType(n.PU.time),h=E.getFirstFieldOfType(n.PU.string);if(g===void 0||h===void 0)return null;const D=E.getFieldByName("tsNs")??null,v=E.getFieldByName("level")??null,C=E.getFieldByName("id")??null,[T,S]=o(E,h,a),O=E.fields.filter((x,b)=>b!==g.index&&b!==h.index&&b!==D?.index&&b!==v?.index&&b!==C?.index&&b!==T?.index);return{timeField:g,bodyField:h,timeNanosecondField:D,severityField:v,idField:C,getLogFrameLabels:S,getLogFrameLabelsAsLabels:S,getLabelFieldName:()=>T?.name??null,extraFields:O}}function l(a,E,g){const h=a.getFieldByName(E);if(h!==void 0)return h.type===g?h:void 0}const i="timestamp",u="body",d="severity",p="id",c="labels";function y(a){const E={};return Object.entries(a).forEach(([g,h])=>{E[g]=typeof h=="string"?h:JSON.stringify(h)}),E}function f(a){const E=new t.L(a),g=l(E,i,n.PU.time),h=l(E,u,n.PU.string);if(g===void 0||h===void 0)return null;const D=l(E,d,n.PU.string)??null,v=l(E,p,n.PU.string)??null,C=l(E,c,n.PU.other)??null,T=C===null?null:C.values,S=E.fields.filter((O,x)=>x!==g.index&&x!==h.index&&x!==D?.index&&x!==v?.index&&x!==C?.index);return{timeField:g,bodyField:h,severityField:D,idField:v,getLogFrameLabels:()=>T,timeNanosecondField:null,getLogFrameLabelsAsLabels:()=>T!==null?T.map(y):null,getLabelFieldName:()=>C!==null?C.name:null,extraFields:S}}function P(a){return a.meta?.type===s.m.LogLines?f(a):m(a)}},69147:(G,I,e)=>{"use strict";e.d(I,{yR:()=>x,cZ:()=>b,HT:()=>k,M0:()=>w,ct:()=>L,f8:()=>ce,J9:()=>V,Wr:()=>te,sg:()=>z});var t=e(2543),n=e(88483),s=e(50832),r=e(65474),o=e(9557),m=e(52622),l=e(14236),i=e(85404),u=e(11261),d=e(24293),p=e(47232),c=e(8249),y=e(40672),f=e(72724),P=e(65879),a=e(39070),E=e(26517),g=e(32264),h=e(24284),D=e(88838),v=e(2913);function C(ue,fe){return v.Ay.bootData?.user?.lightTheme?fe:ue}var T=e(98101),S=e(91002);const O="Line limit",x="Common labels",b={[o.$b.critical]:h.Tj[7],[o.$b.error]:h.Tj[4],[o.$b.warning]:h.Tj[1],[o.$b.info]:h.Tj[0],[o.$b.debug]:h.Tj[5],[o.$b.trace]:h.Tj[2],[o.$b.unknown]:C("#8e8e8e","#bdc4cd")},M=1,A=1e3*M,R=60*A,B=60*R,U=24*B,W=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-6]\d[,\.]\d+([+-][0-2]\d:[0-5]\d|Z)/g;function N(ue,fe,Te){switch(Te){case m.fY.exact:return ue.entry.replace(W,"")===fe.entry.replace(W,"");case m.fY.numbers:return ue.entry.replace(/\d/g,"")===fe.entry.replace(/\d/g,"");case m.fY.signature:return ue.entry.replace(/\w/g,"")===fe.entry.replace(/\w/g,"");default:return!1}}function w(ue,fe){return fe===m.fY.none?ue:ue.reduce((Te,he,de)=>{const le={...he},pe=Te[Te.length-1];return de>0&&N(he,pe,fe)?pe.duplicates++:(le.duplicates=0,Te.push(le)),Te},[])}function L(ue,fe){return fe.size===0?ue:ue.filter(Te=>!fe.has(Te.logLevel))}function V(ue,fe){const Te={},he=[];for(const de of ue){let le=Te[de.logLevel];le||(Te[de.logLevel]=le={lastTs:null,datapoints:[],target:de.logLevel,color:b[de.logLevel]},he.push(le));const pe=Math.floor(de.timeEpochMs/fe)*fe;pe===le.lastTs?le.datapoints[le.datapoints.length-1][0]++:(le.datapoints.push([1,pe]),le.lastTs=pe);for(const ve of he)ve!==le&&ve.lastTs!==pe&&(ve.datapoints.push([0,pe]),ve.lastTs=pe)}return he.map((de,le)=>{de.datapoints.sort((Oe,Me)=>Oe[1]-Me[1]);const pe=(0,l.Vc)(de),be=new i.L(pe).getFirstFieldOfType(u.PU.number);return pe.fields[be.index].config.min=0,pe.fields[be.index].config.decimals=0,pe.fields[be.index].config.color={mode:d.Y.Fixed,fixedColor:de.color},pe.fields[be.index].config.custom={drawStyle:m.GR.Bars,barAlignment:m.Nj.Center,barWidthFactor:.9,barMaxWidth:5,lineColor:de.color,pointColor:de.color,fillColor:de.color,lineWidth:0,fillOpacity:100,stacking:{mode:m.gs.Normal,group:"A"}},pe})}function K(ue){return ue.fields.some(fe=>fe.type===u.PU.time)&&ue.fields.some(fe=>fe.type===u.PU.string)}function k(ue,fe,Te,he,de){const{logSeries:le}=H(ue),pe=X(le,he,!!de);if(pe){if(fe&&pe.rows.length>0){const ve=pe.rows.sort(S.M1),{visibleRange:be,bucketSize:Oe,visibleRangeMs:Me,requestedRangeMs:Ue}=j(ve,fe,Te);pe.visibleRange=be,pe.bucketSize=Oe,pe.series=V(ve,Oe),pe.meta&&(pe.meta=se(pe,Me,Ue))}else pe.series=[];return pe.queries=he,pe}return{hasUniqueLabels:!1,rows:[],meta:[],series:[],queries:he}}function j(ue,fe,Te,he=20,de=1e3){let le=Te,pe=fe,ve=Math.max(pe*he,de),be,Oe;if(Te){const Me=ue[0].timeEpochMs;if(Oe=Te.to-Te.from,be=Te.to-Me,be>0){const Ue=be/Oe;pe*=Ue,ve=Math.max(Math.ceil(pe*he),de),le={from:Math.floor(Me/ve)*ve,to:Te.to}}else be=1}return{bucketSize:ve,visibleRange:le,visibleRangeMs:be,requestedRangeMs:Oe}}function H(ue){const fe=[],Te=[];for(const he of ue){if(K(he)||!he.fields.length){Te.push(he);continue}he.length>0&&fe.push(he)}return{logSeries:Te,metricSeries:fe}}function J(ue,fe,Te){const he=ue.values[Te],le=(0,p.yT)(he).valueOf();if(fe)return{ts:he,timeEpochMs:le,timeEpochNs:fe.values[Te]};if(ue.nanos!==void 0){const pe=ue.nanos[Te].toString().padStart(6,"0"),ve=`${le}${pe}`;return{ts:he,timeEpochMs:le,timeEpochNs:ve}}return{ts:he,timeEpochMs:le,timeEpochNs:le+"000000"}}function X(ue,fe=[],Te=!1){if(ue.length===0)return;const he=[];let de=[];const le=ue.filter(Xe=>Xe.fields.length);le.length&&le.forEach(Xe=>{const gt=(0,T.O)(Xe);if(gt!=null){const Dt=gt.getLogFrameLabelsAsLabels()??void 0,nt={rawFrame:Xe,logsFrame:gt,frameLabels:Dt};de.push(nt),Dt&&Dt.length>0&&he.push(Dt)}});const pe=he.flat(),ve=pe.length>0?(0,c.yO)(pe):{};let be=[],Oe=!1;const Me=(0,S.kA)();for(const Xe of de){const{logsFrame:gt,rawFrame:Dt,frameLabels:nt}=Xe,{timeField:at,timeNanosecondField:Ae,bodyField:re,severityField:Z,idField:oe}=gt;for(let Ee=0;Ee<Dt.length;Ee++){const{ts:ye,timeEpochMs:Se,timeEpochNs:Be}=J(at,Ae??void 0,Ee),We=re.values[Ee]??"",Ke=typeof We=="string"?We:JSON.stringify(We),it=y.sQ.hasAnsiCodes(Ke),rt=!!Ke.match(/\\n|\\t|\\r/),ft=Dt.meta?.custom?.searchWords??Dt.meta?.searchWords??[],pt=it?D.DB.strip(Ke):Ke,Ge=nt?.[Ee],qe=(0,c.s6)(Ge,ve);Object.keys(qe).length>0&&(Oe=!0);let bt=o.$b.unknown;const Ft=Z&&Z.values[Ee]||Ge&&Ge.level;typeof Ft=="number"||typeof Ft=="string"?bt=(0,S.EK)(Ft):bt=(0,S.XM)(pt);const Xt=fe.find(Qt=>Qt.refId===Dt.refId)?.datasource?.type,Lt={entryFieldIndex:re.index,rowIndex:Ee,dataFrame:Dt,logLevel:bt,timeFromNow:(0,f.fq)(ye),timeEpochMs:Se,timeEpochNs:Be,timeLocal:(0,f.LE)(ye,{timeZone:"browser"}),timeUtc:(0,f.LE)(ye,{timeZone:"utc"}),uniqueLabels:qe,hasAnsi:it,hasUnescapedContent:rt,searchWords:ft,entry:pt,raw:Ke,labels:Ge||{},uid:`${Dt.refId}_${oe?oe.values[Ee]:Ee.toString()}`,datasourceType:Xt};oe!==null&&(Lt.rowId=oe.values[Ee]),!(Te&&Me(Lt))&&be.push(Lt)}}const Ue=[];(0,t.size)(ve)>0&&Ue.push({label:x,value:ve,kind:o.tG.LabelsMap});const Re=ue.filter(Xe=>Xe?.meta?.custom?.limit??Xe?.meta?.limit).reduce((Xe,gt)=>(Xe[gt.refId??""]=gt.meta?.custom?.limit??gt.meta?.limit??0,Xe),{}),Fe=Object.values(Re).reduce((Xe,gt)=>Xe+=gt,0);Fe>0&&Ue.push({label:O,value:Fe,kind:o.tG.Number});let xe=0;const Ve={};let $e=!1;for(const Xe of ue){const gt=Xe.meta?.custom?.lokiQueryStatKey,{refId:Dt}=Xe;if(!$e&&Xe.meta?.custom?.error&&(Ue.push({label:"",value:Xe.meta?.custom.error,kind:o.tG.Error}),$e=!0),Dt&&!Ve[Dt]){if(gt&&Xe.meta?.stats){const nt=Xe.meta.stats.find(at=>at.displayName===gt);nt&&(xe+=nt.value)}Ve[Dt]=!0}}if(xe>0){const{text:Xe,suffix:gt}=(0,E.rT)("B")(xe);Ue.push({label:"Total bytes processed",value:`${Xe} ${gt}`,kind:o.tG.String})}return{hasUniqueLabels:Oe,meta:Ue,rows:be}}function se(ue,fe,Te){if(!ue.meta)return[];let he=[...ue.meta];const de=he.findIndex(pe=>pe.label===O),le=de>=0&&he[de]?.value;if(le&&typeof le=="number"&&le>0){let pe;if(le===ue.rows.length&&fe&&Te){const ve=(fe/Te*100).toFixed(2);pe=`${le} reached, received logs cover ${ve}% (${P.msRangeToTimeString(fe)}) of your selected time range (${P.msRangeToTimeString(Te)})`}else{const ve=g.$.featureToggles.logsInfiniteScrolling?"displayed":"returned";pe=`${le} (${ue.rows.length} ${ve})`}he[de]={label:O,value:pe,kind:o.tG.String}}return he}function ae(ue,fe){const Te=fe&&ue===o.$b.unknown?"logs":ue,he=b[ue];return{displayNameFromDS:Te,color:{mode:d.Y.Fixed,fixedColor:he},custom:{drawStyle:m.GR.Bars,barAlignment:m.Nj.Center,lineColor:he,pointColor:he,fillColor:he,lineWidth:1,fillOpacity:100,stacking:{mode:m.gs.Normal,group:"A"}}}}const ne=(ue,fe,Te)=>(ue.fields=ue.fields.map(he=>(he.type===u.PU.number&&(he.config={...he.config,...ae(fe(ue),Te)}),he)),ue);function q(ue){let fe;try{fe=new i.L(ue).getFirstFieldOfType(u.PU.number)}catch{}return fe?.labels?ee(fe.labels):o.$b.unknown}function ee(ue){const fe=ue.level??ue.lvl??ue.loglevel??"";return fe?(0,S.EK)(fe):o.$b.unknown}function z(ue,fe,Te){const he=fe.range,de=Te.targets,le=q,pe=he.to.valueOf()-he.from.valueOf(),ve=ie(fe.scopedVars,pe);return fe.interval=ve.interval,fe.scopedVars.__interval={value:ve.interval,text:ve.interval},ve.intervalMs!==void 0&&(fe.intervalMs=ve.intervalMs,fe.scopedVars.__interval_ms={value:ve.intervalMs,text:ve.intervalMs}),fe.hideFromInspector=!0,new n.c(be=>{let Oe=[];be.next({state:a.Gu.Loading,error:void 0,data:[]});const Me=ue.query(fe),we=((0,s.A)(Me)?Me:(0,r.H)(Me)).subscribe({complete:()=>{be.complete()},next:Re=>{const{error:Fe}=Re;if(Fe!==void 0)be.next({state:a.Gu.Error,error:Fe,data:[]}),be.error(Fe);else{const xe=(0,t.groupBy)(Re.data,"refId");Oe=Re.data.map(Ve=>{if(Ve.meta?.dataTopic===m.QR.Annotations)return Ve;let $e=Ve.refId||"";$e.startsWith("log-volume-")&&($e=$e.substr(11));const Xe={logsVolumeType:o.Aj.FullRange,absoluteRange:{from:he.from.valueOf(),to:he.to.valueOf()},datasourceName:ue.name,sourceQuery:de.find(gt=>gt.refId===$e)};return Ve.meta={...Ve.meta,custom:{...Ve.meta?.custom,...Xe}},ne(Ve,le,xe[Ve.refId].length===1)}),be.next({state:Re.state,error:void 0,data:Oe})}},error:Re=>{be.next({state:a.Gu.Error,error:Re,data:[]}),be.error(Re)}});return()=>{we?.unsubscribe()}})}function te(ue,fe){return fe.hideFromInspector=!0,new n.c(Te=>{let he=[];Te.next({state:a.Gu.Loading,error:void 0,data:[]});const de=ue.query(fe),pe=((0,s.A)(de)?de:(0,r.H)(de)).subscribe({complete:()=>{Te.next({state:a.Gu.Done,error:void 0,data:he}),Te.complete()},next:ve=>{const{error:be}=ve;be!==void 0?(Te.next({state:a.Gu.Error,error:be,data:[]}),Te.error(be)):he=ve.data.map(Oe=>{const Me=(0,l.Vc)(Oe),{timeIndex:Ue}=(0,l.KR)(Me);return(0,l.ES)(Me,Ue)})},error:ve=>{Te.next({state:a.Gu.Error,error:ve,data:[]}),Te.error(ve)}});return()=>{pe?.unsubscribe()}})}function ie(ue,fe){if(ue.__interval_ms){let Te=ue.__interval_ms.value,he="";return fe<A*5?(Te=M,he="1ms"):Te>B?(Te=U,he="1d"):Te>R?(Te=B,he="1h"):Te>A?(Te=R,he="1m"):(Te=A,he="1s"),{interval:he,intervalMs:Te}}else return{interval:"$__interval"}}function ce(ue){const fe=ue.dataFrame;return fe.length===0||fe.length<=ue.rowIndex?null:(0,l.EI)({fields:fe.fields.map(he=>({...he,values:[he.values[ue.rowIndex]]})),refId:fe.refId})}},91002:(G,I,e)=>{"use strict";e.d(I,{Dg:()=>D,Dk:()=>O,Dm:()=>T,Dx:()=>v,EK:()=>d,Ei:()=>g,Hw:()=>h,M1:()=>f,Tj:()=>p,XM:()=>u,a8:()=>b,e3:()=>S,kA:()=>M,oR:()=>E,oT:()=>C,s2:()=>c,tX:()=>x,zy:()=>a});var t=e(2543),n=e.n(t),s=e(9557),r=e(52622),o=e(37471),m=e(11261),l=e(85404),i=e(70377);function u(A){if(!A)return s.$b.unknown;let R=s.$b.unknown,B;for(const[U,W]of Object.entries(s.$b)){const w=new RegExp(`\\b${U}\\b`,"i").exec(A);w&&(B===void 0||w.index<B)&&(R=W,B=w.index)}return R}function d(A){const R=s.$b[A.toString().toLowerCase()];if(R)return R;if(typeof A=="string"){const B=parseInt(A,10);if(A.length===B.toString().length)return s.s5[A]||s.$b.unknown}else if(typeof A=="number")return s.s5[A]||s.$b.unknown;return s.$b.unknown}function p(A,R){const B=A.filter(N=>N.labels[R]!==void 0),U=B.length,W=(0,t.countBy)(B,N=>N.labels[R]);return y(W,U)}function c(A){const R=A.filter(U=>U!=null),B=(0,t.countBy)(R);return y(B,R.length)}const y=(A,R)=>(0,t.chain)(A).map((B,U)=>({count:B,value:U,proportion:B/R})).sortBy("count").reverse().value(),f=(A,R)=>A.timeEpochMs<R.timeEpochMs?-1:A.timeEpochMs>R.timeEpochMs?1:A.timeEpochNs<R.timeEpochNs?-1:A.timeEpochNs>R.timeEpochNs?1:0,P=(A,R)=>A.timeEpochMs>R.timeEpochMs?-1:A.timeEpochMs<R.timeEpochMs?1:A.timeEpochNs>R.timeEpochNs?-1:A.timeEpochNs<R.timeEpochNs?1:0,a=(A,R)=>{const B=A?E(A.rows,R):[];return A?{...A,rows:B}:{hasUniqueLabels:!1,rows:B}},E=(A,R)=>R===r.uH.Ascending?A.sort(f):A.sort(P),g=A=>A.labels.__error__?{hasError:!0,errorMessage:A.labels.__error__}:{hasError:!1},h=A=>A.replace(/\\r\\n|\\n|\\t|\\r/g,R=>R.slice(1)==="t"?"	":`
`);function D(A){return A.map(R=>{const B=(0,i.FE)(R).reduce((U,W)=>{const N=W.keys[0];return U[N]=W.values[0],U},{});return{line:R.entry,timestamp:R.timeEpochNs,fields:{...B,...R.labels}}})}const v=A=>{let R={from:1/0,to:-1/0};return A.forEach(B=>{const U=B.meta?.custom||{};U.absoluteRange?.from&&U.absoluteRange?.to&&(R={from:Math.min(R.from,U.absoluteRange.from),to:Math.max(R.to,U.absoluteRange.to)})}),R},C=A=>{if(A.length===0)throw new Error("Cannot aggregate data frames: there must be at least one data frame to aggregate");const R={},B={};let U=-1/0;const W={};let N=[];return A.forEach(w=>{const{level:L,valueField:V,timeField:K,length:k}=x(w);W[L]={meta:w.meta,valueFieldConfig:V.config,timeFieldConfig:K.config};for(let j=0;j<k;j++){const H=K.values[j],J=V.values[j];R[L]??={},R[L][H]=(R[L][H]||0)+J,B[H]=(B[H]||0)+J,U=Math.max(B[H],U)}}),Object.keys(R).forEach(w=>{const L=new o.k,{meta:V,timeFieldConfig:K,valueFieldConfig:k}=W[w];L.name=w,L.meta=V,L.addField({name:"Time",type:m.PU.time,config:K}),L.addField({name:"Value",type:m.PU.number,config:k}),Object.entries(R[w]).sort((j,H)=>Number(j[0])-Number(H[0])).forEach(([j,H])=>{L.add({Time:Number(j),Value:H})}),N.push(L)}),{dataFrames:N,maximum:U}},T=A=>{const R=A[0]?.meta?.custom;return R&&R.datasourceName?{name:R.datasourceName}:null},S=A=>A[0]?.meta?.custom?.logsVolumeType===s.Aj.Limited,O=async(A,R)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(A);{const B=document.createElement("textarea");R.current?.appendChild(B),B.value=A,B.focus(),B.select(),document.execCommand("copy"),B.remove()}};function x(A){const R=new l.L(A),B=R.getFirstFieldOfType(m.PU.time),U=R.getFirstFieldOfType(m.PU.number);if(!B)throw new Error("Missing time field");if(!U)throw new Error("Missing value field");const W=U.config.displayNameFromDS||A.name||"logs",N=U.values.length;return{level:W,valueField:U,timeField:B,length:N}}function b(A){return A instanceof Element}function M(){const A=new Set;return function(R){let B=`${R.dataFrame.refId}_${R.rowId?R.rowId:`${R.timeEpochNs}_${R.entry}`}`;return A.has(B)?!0:(A.add(B),!1)}}},90591:(G,I,e)=>{"use strict";e.d(I,{m:()=>l});var t=e(32196),n=e(96540),s=e(40845),r=e(96374),o=e(8484);const m=({title:u})=>{const d=(0,s.of)(i);return n.createElement("p",{className:d.description},u?(0,o.t)("public-dashboard.delete-modal.revoke-nonorphaned-body-text","Are you sure you want to revoke this URL? The dashboard will no longer be public."):(0,o.t)("public-dashboard.delete-modal.revoke-orphaned-body-text","Orphaned public dashboard will no longer be public."))},l=({dashboardTitle:u,onConfirm:d,onDismiss:p})=>{const c=(0,o.t)("public-dashboard.delete-modal.revoke-title","Revoke public URL");return n.createElement(r.u,{isOpen:!0,body:n.createElement(m,{title:u}),onConfirm:d,onDismiss:p,title:c,icon:"trash-alt",confirmText:c})},i=u=>({title:(0,t.css)`
    margin-bottom: ${u.spacing(1)};
  `,description:(0,t.css)`
    font-size: ${u.typography.body.fontSize};
  `})},71500:(G,I,e)=>{"use strict";e.d(I,{P:()=>r});var t=e(24439);class n extends Error{constructor(m,l){super(l),this.type=m}}class s{constructor(){this.rootName="general"}validateNewDashboardName(m,l){return this.validate(m,l,"A dashboard or a folder with the same name already exists")}validateNewFolderName(m){return this.validate(this.rootName,m,"A folder or dashboard in the general folder with the same name already exists")}async validate(m,l,i){l=(l||"").trim();const u=l.toLowerCase();if(l.length===0)throw new n("REQUIRED","Name is required");if(u===this.rootName)throw new n("EXISTING","This is a reserved name and cannot be used for a folder.");const p=await(0,t.getGrafanaSearcher)().search({kind:["dashboard"],query:l,location:m||"general"});for(const c of p.view)if(u===c.name.toLowerCase())throw new n("EXISTING",i)}}const r=new s},11230:(G,I,e)=>{"use strict";e.d(I,{A_:()=>N,FG:()=>D,Q9:()=>v,Ql:()=>U,c0:()=>B,iP:()=>c,rw:()=>p,vV:()=>M});var t=e(17172),n=e(19347),s=e(82467),r=e(3169),o=e(55314),m=e(28676),l=e(31678),i=e(57767),u=e(98796),d=e(88264);function p(L){return async V=>{try{V((0,d.f7)());const K=await(0,t.AI)().get(`/api/gnet/dashboards/${L}`);await V(g(K.json)),await V(P(K)),V(E())}catch(K){V((0,d.oQ)()),(0,t.NF)(K)&&V((0,s.dx)((0,r.gi)(K.data.message||K)))}}}function c(L){return async V=>{await V(g(L)),await V(a(L)),V(E())}}const y=(L,V)=>L?.usage?.libraryPanels?.filter(K=>V.inputs.libraryPanels.some(k=>k.state!==d.J7.Exists&&k.model.uid===K.uid));function f(L,V){let K=L.__inputs;if(V.inputs.libraryPanels?.length){const k=[];L.__inputs?.forEach(j=>{if(!j?.usage?.libraryPanels){k.push(j);return}const H=y(j,V);j.usage={libraryPanels:H},!!H?.length&&k.push(j)}),K=k}return{...L,__inputs:K}}function P(L){return(V,K)=>{const k=K().importDashboard,j=f(L.json,k);V((0,d.Rp)({...L,json:j}))}}function a(L){return(V,K)=>{const k=K().importDashboard,j=f(L,k);V((0,d.dd)(j))}}function E(){return(L,V)=>{const K=V().importDashboard.dashboard;if(K&&K.__inputs){const k=[];K.__inputs.forEach(j=>{const H={name:j.name,label:j.label,info:j.description,value:j.value,type:j.type,pluginId:j.pluginId,options:[]};H.description=T(j),j.type===d.NZ.DataSource?C(j,H):H.info||(H.info="Specify a string constant"),k.push(H)}),L((0,d.y3)(k))}}}function g(L){return async function(V){const K=await h(L);V((0,d.dW)(K))}}async function h(L){if(!L||!L.__elements)return[];const V=[];for(const K of Object.values(L.__elements)){if(K.kind!==u.i.Panel)continue;const k=K.model,{type:j,description:H}=k,{uid:J,name:X}=K,se={model:{model:k,uid:J,name:X,version:0,type:j,kind:u.i.Panel,description:H},state:d.J7.New};try{const ae=await(0,i.Yr)(J,!0);se.state=d.J7.Exists,se.model=ae}catch(ae){if(ae.status!==404)throw ae}V.push(se)}return V}function D(){return L=>{L((0,d.SN)())}}function v(L){return async(V,K)=>{const k=K().importDashboard.dashboard,j=K().importDashboard.inputs,H=[];L.dataSources?.forEach((J,X)=>{const se=j.dataSources[X];H.push({name:se.name,type:se.type,pluginId:se.pluginId,value:J.uid})}),L.constants?.forEach((J,X)=>{const se=j.constants[X];H.push({value:J,name:se.name,type:se.type})}),V(o.cU.endpoints.importDashboard.initiate({dashboard:{...k,title:L.title,uid:L.uid||k.uid},overwrite:!0,inputs:H,folderUid:L.folder.uid}))}}const C=(L,V)=>{(0,n.l)().getList({pluginId:L.pluginId}).length===0?V.info="No data sources of type "+L.pluginName+" found":V.info||(V.info="Select a "+L.pluginName+" data source")},T=L=>{if(L.usage&&L.usage.libraryPanels)return`List of affected library panels: ${L.usage.libraryPanels.reduce((K,k,j)=>j===0?k.name:`${K}, ${k.name}`,"")}`};async function S(L,V){const K={totalCount:L.length,successCount:0};for(const k of L)try{await A(k,V)!==null&&(K.successCount+=1)}catch(j){console.error("Failed to move a folder",j)}return K}function O(L,V,...K){return async k=>{try{const j=await L(...K);return Array.prototype.concat(k,[j])}catch(j){if(V)return k;throw j}}}function x(L,V){const K=[];for(const k of L)K.push(O(b,!0,k,!0));for(const k of V)K.push(O(N,!0,k,!0));return w(K)}function b(L,V){return getBackendSrv().delete(`/api/folders/${L}?forceDeleteRules=false`,void 0,{showSuccessAlert:V})}function M(L){return(0,t.AI)().post("/api/folders",L)}function A(L,V){const K={parentUid:V.uid};return getBackendSrv().post(`/api/folders/${L}/move`,K,{showErrorAlert:!1})}const R=1e3;function B(L,V,K=l.SearchQueryType.Folder){return(0,t.AI)().get("/api/search",{query:L,type:K,permission:V,limit:R})}function U(L){return(0,t.AI)().get(`/api/folders/${L}`)}function W(L){return getBackendSrv().get(`/api/folders/id/${L}`)}function N(L,V){return(0,m.n)().deleteDashboard(L,V)}function w(L){return L.reduce((V,K)=>Promise.resolve(V).then(K),[])}},88264:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>a,J7:()=>o,NZ:()=>r,Rp:()=>d,SN:()=>i,V9:()=>m,dW:()=>c,dd:()=>p,f7:()=>f,oQ:()=>y,qx:()=>s,y3:()=>u});var t=e(65307),n=e(39070),s=(E=>(E[E.Gcom=0]="Gcom",E[E.Json=1]="Json",E))(s||{}),r=(E=>(E.DataSource="datasource",E.Constant="constant",E.LibraryPanel="libraryPanel",E))(r||{}),o=(E=>(E.New="new",E.Exists="exists",E.Different="different",E))(o||{});const m={meta:{updatedAt:"",orgName:""},dashboard:{},source:1,inputs:{},state:n.Gu.NotStarted},l=(0,t.Z0)({name:"manageDashboards",initialState:m,reducers:{setGcomDashboard:(E,g)=>{E.dashboard={...g.payload.json,id:null},E.meta={updatedAt:g.payload.updatedAt,orgName:g.payload.orgName},E.source=0,E.state=n.Gu.Done},setJsonDashboard:(E,g)=>{E.dashboard={...g.payload,id:null},E.meta=m.meta,E.source=1,E.state=n.Gu.Done},clearDashboard:E=>{E.dashboard={},E.state=n.Gu.NotStarted},setInputs:(E,g)=>{E.inputs={dataSources:g.payload.filter(h=>h.type==="datasource"),constants:g.payload.filter(h=>h.type==="constant"),libraryPanels:E.inputs.libraryPanels||[]}},setLibraryPanelInputs:(E,g)=>{E.inputs.libraryPanels=g.payload},fetchFailed:E=>{E.dashboard={},E.state=n.Gu.Error},fetchDashboard:E=>{E.state=n.Gu.Loading}}}),{clearDashboard:i,setInputs:u,setGcomDashboard:d,setJsonDashboard:p,setLibraryPanelInputs:c,fetchFailed:y,fetchDashboard:f}=l.actions,a={importDashboard:l.reducer}},59120:(G,I,e)=>{"use strict";e.d(I,{O5:()=>a,dX:()=>f,Z1:()=>i,Zd:()=>d,Yl:()=>c,QZ:()=>u,bM:()=>P,Wu:()=>l,TH:()=>y});var t=e(75816),n=e(75505),s=e(17172);function r({baseURL:g}){async function h(D){try{const{data:v,...C}=await(0,n.s)((0,s.AI)().fetch({...D,url:g+D.url,showErrorAlert:D.showErrorAlert,data:D.body}));return{data:v,meta:C}}catch(v){return D.manageError?D.manageError(v):{error:v}}}return h}const m=(0,t.xP)({reducerPath:"migrateToCloudGeneratedAPI",baseQuery:r({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:g=>({getMigrationList:g.query({query:()=>({url:"/cloudmigration/migration"})}),createMigration:g.mutation({query:h=>({url:"/cloudmigration/migration",method:"POST",body:h.cloudMigrationRequest})}),getCloudMigrationRun:g.query({query:h=>({url:`/cloudmigration/migration/run/${h.runUid}`})}),deleteCloudMigration:g.mutation({query:h=>({url:`/cloudmigration/migration/${h.uid}`,method:"DELETE"})}),getCloudMigration:g.query({query:h=>({url:`/cloudmigration/migration/${h.uid}`})}),getCloudMigrationRunList:g.query({query:h=>({url:`/cloudmigration/migration/${h.uid}/run`})}),runCloudMigration:g.mutation({query:h=>({url:`/cloudmigration/migration/${h.uid}/run`,method:"POST"})}),createCloudMigrationToken:g.mutation({query:()=>({url:"/cloudmigration/token",method:"POST"})}),getDashboardByUid:g.query({query:h=>({url:`/dashboards/uid/${h.uid}`})})}),overrideExisting:!1}),{useGetMigrationListQuery:l,useCreateMigrationMutation:i,useGetCloudMigrationRunQuery:u,useDeleteCloudMigrationMutation:d,useGetCloudMigrationQuery:p,useGetCloudMigrationRunListQuery:c,useRunCloudMigrationMutation:y,useCreateCloudMigrationTokenMutation:f,useGetDashboardByUidQuery:P}=m,a=m.enhanceEndpoints({addTagTypes:["cloud-migration-config","cloud-migration-run","cloud-migration-run-list"],endpoints:{createCloudMigrationToken:E,getMigrationList:{providesTags:["cloud-migration-config"]},createMigration(g){E(g),g.invalidatesTags=["cloud-migration-config"]},getCloudMigration:{providesTags:["cloud-migration-config"]},deleteCloudMigration:{invalidatesTags:["cloud-migration-config"]},getCloudMigrationRunList:{providesTags:["cloud-migration-run-list"]},getCloudMigrationRun:{providesTags:["cloud-migration-run"]},runCloudMigration:{invalidatesTags:["cloud-migration-run-list"]},getDashboardByUid:E}});function E(g){if(!g.query)return;const h=g.query;g.query=(...D)=>{const v=h(...D);return v.showErrorAlert=!1,v}}},32931:(G,I,e)=>{"use strict";e.d(I,{EC:()=>l,L_:()=>o,YS:()=>r,bA:()=>m,wV:()=>i});var t=e(17172),n=e(82467),s=e(10943);function r(u={getBackendSrv:t.AI}){return async d=>{const p=await u.getBackendSrv().get("/api/org");return d((0,s.bK)(p)),p}}function o(u={getBackendSrv:t.AI}){return async(d,p)=>{const c=p().organization.organization;await u.getBackendSrv().put("/api/org",{name:c.name}),d((0,n.YA)(c.name)),d(r(u))}}function m(u,d={getBackendSrv:t.AI}){return async p=>{const c=await d.getBackendSrv().post("/api/user/using/"+u);p((0,n.YA)(c.name))}}function l(u,d={getBackendSrv:t.AI}){return async p=>{const c=await d.getBackendSrv().post("/api/orgs/",u);p(m(c.orgId))}}function i(u={getBackendSrv:t.AI}){return async d=>{const p=await u.getBackendSrv().get("/api/user/orgs");return d((0,s.Bz)(p)),p}}},10943:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>i,Bz:()=>m,bK:()=>o,n:()=>r});var t=e(65307);const n={organization:{},userOrgs:[]},s=(0,t.Z0)({name:"organization",initialState:n,reducers:{organizationLoaded:(u,d)=>({...u,organization:d.payload}),setOrganizationName:(u,d)=>({...u,organization:{...u.organization,name:d.payload}}),userOrganizationsLoaded:(u,d)=>({...u,userOrgs:d.payload})}}),{setOrganizationName:r,organizationLoaded:o,userOrganizationsLoaded:m}=s.actions,i={organization:s.reducer}},17888:(G,I,e)=>{"use strict";e.d(I,{a:()=>h});var t=e(32196),n=e(96540),s=e(47070),r=e(41987),o=e(13544),m=e(12131),l=e(40845),i=e(79041),u=e(14578);const d=n.forwardRef(({icon:C,children:T,onClick:S,...O},x)=>{const b=(0,l.of)(p);return n.createElement("button",{...O,className:b.action,onClick:S},n.createElement(u.I,{name:C,size:"xl"}),T)});d.displayName="CardButton";const p=C=>({action:(0,t.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",cursor:"pointer",background:C.colors.background.secondary,borderRadius:C.shape.radius.default,color:C.colors.text.primary,border:"unset",width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center","&:hover":{background:C.colors.emphasize(C.colors.background.secondary)}})});var c=e(15054),y=e(33390),f=e(53466),P=e(32696),a=e(14792),E=e(31678),g=e(79971);function h(C){const T=(0,l.of)(v),S=(0,i.d2)(),O=new s.v2(C.data),{dataSummary:x}=O,b=D(C,x),M=(0,E.useDispatch)(),A=(0,a.UA)().getCurrent()?.getPanelById(C.panelId),R=()=>{y.A.setObject(c.wV,P.__.Suggestions),M((0,f.eK)(!0))},B=()=>{A&&M((0,g.gW)({panel:A,pluginId:"table"}))},U=W=>{A&&(M((0,g.gW)({...W,panel:A})),W.transformations&&setTimeout(()=>{m.Ny.partial({tab:"transform"})},100))};return n.createElement("div",{className:T.wrapper},n.createElement("div",{className:T.message,"data-testid":o.Tp.components.Panels.Panel.PanelDataErrorMessage},b),S.app===r.Jk.PanelEditor&&x.hasData&&A&&n.createElement("div",{className:T.actions},C.suggestions&&n.createElement(n.Fragment,null,C.suggestions.map(W=>n.createElement(d,{key:W.name,icon:"process",onClick:()=>U(W)},W.name))),n.createElement(d,{icon:"table",onClick:B},"Switch to table"),n.createElement(d,{icon:"chart-line",onClick:R},"Open visualization suggestions")))}function D({data:C,fieldConfig:T,message:S,needsNumberField:O,needsTimeField:x,needsStringField:b},M){return S||(!C.series||C.series.length===0||C.series.every(A=>A.length===0)?T?.defaults.noValue??"No data":b&&!M.hasStringField?"Data is missing a string field":O&&!M.hasNumberField?"Data is missing a number field":x&&!M.hasTimeField?"Data is missing a time field":"Cannot visualize data")}const v=C=>({wrapper:(0,t.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"}),message:(0,t.css)({textAlign:"center",color:C.colors.text.secondary,fontSize:C.typography.size.lg,width:"100%"}),actions:(0,t.css)({marginTop:C.spacing(2),display:"flex",height:"50%",maxHeight:"150px",columnGap:C.spacing(1),rowGap:C.spacing(1),width:"100%",maxWidth:"600px"})})},41394:(G,I,e)=>{"use strict";e.d(I,{$:()=>i,W:()=>l});var t=e(96540),n=e(65158),s=e(43429),r=e(42418),o=e(31678);class m extends t.PureComponent{constructor(d){super(d)}render(){const d={display:"flex",alignItems:"center",justifyContent:"center",height:"100%"};return t.createElement("div",{style:d},t.createElement(r.F,{severity:o.AppNotificationSeverity.Error,...this.props}))}}function l(u,d){const p=class extends t.PureComponent{render(){const f=t.createElement(t.Fragment,null,"Check the server startup logs for more information. ",t.createElement("br",null),"If this plugin was loaded from Git, then make sure it was compiled.");return t.createElement(m,{title:`Error loading: ${u.id}`,text:f})}},c=new n.m(p);return c.meta=u,c.loadError=!0,c}function i(u,d){const p=class extends t.PureComponent{render(){return t.createElement(m,{title:`Panel plugin not found: ${u}`})}},c=new n.m(d?()=>null:p);return c.meta={id:u,name:u,sort:100,type:s.QE.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:"public/img/grafana_icon.svg"},screenshots:[],updated:"",version:""}},c}},20726:(G,I,e)=>{"use strict";e.d(I,{m:()=>y});var t=e(96540),n=e(1933),s=e(90708),r=e(13834),o=e(581),m=e(72574),l=e(40845),i=e(79041),u=e(66602),d=e(10096),p=e(15162);const c={defaults:{},overrides:[]};function y(P){const{pluginId:a,data:E,timeZone:g=(0,n.O)(),options:h={},width:D,height:v,title:C,onOptionsChange:T=()=>{},onChangeTimeRange:S=()=>{},onFieldConfigChange:O=()=>{},fieldConfig:x=c}=P,b=(0,l.$j)(),M=(0,m.w)(),A=(0,t.useMemo)(()=>M.replace.bind(M),[M]),[R,B]=(0,t.useState)((0,p.PY)(a)),[U,W]=(0,t.useState)(),N=f(R,h,x),{dataLinkPostProcessor:w}=(0,i.d2)(),L=(0,s.rJ)(R,N?.fieldConfig,E,g,b,A,w);if((0,t.useEffect)(()=>{R&&R.hasPluginId(a)||(0,p.TV)(a).then(K=>B(K)).catch(K=>{W(K.message)})},[a,R]),U)return t.createElement("div",null,"Failed to load plugin: ",U);if(!R||!R.hasPluginId(a))return t.createElement("div",null,"Loading plugin panel...");if(!R.panel)return t.createElement("div",null,"Seems like the plugin you are trying to load does not have a panel component.");if(!L)return t.createElement("div",null,"No panel data");const V=R.panel;return t.createElement(u.Xw,{dependencies:[R,E]},t.createElement(r.a,{meta:R.meta},t.createElement(V,{id:1,data:L,title:C,timeRange:L.timeRange,timeZone:g,options:N.options,fieldConfig:x,transparent:!1,width:D,height:v,renderCounter:0,replaceVariables:K=>K,onOptionsChange:T,onFieldConfigChange:O,onChangeTimeRange:S,eventBus:d.lE})))}function f(P,a,E){return(0,t.useMemo)(()=>{if(P)return(0,o.F)({plugin:P,currentOptions:a,currentFieldConfig:E,isAfterPluginChange:!1})},[P,E,a])}},25701:(G,I,e)=>{"use strict";e.d(I,{b:()=>P});var t=e(32196),n=e(96540),s=e(70255),r=e(43429),o=e(51527),m=e(13544),l=e(40845),i=e(29158),u=e(98624),d=e(72129),p=e(10803);const c=38,y=({isCurrent:h,title:D,plugin:v,onClick:C,onDelete:T,disabled:S,showBadge:O,description:x,children:b})=>{const M=(0,l.of)(E),A=S||v.state===r.pn.deprecated,R=(0,t.cx)({[M.item]:!0,[M.itemDisabled]:A,[M.current]:h});return n.createElement("div",{className:R,"aria-label":m.Tp.components.PluginVisualization.item(v.name),"data-testid":m.Tp.components.PluginVisualization.item(v.name),onClick:A?void 0:C,title:h?"Click again to close this section":v.name},n.createElement("img",{className:(0,t.cx)(M.img,{[M.disabled]:A}),src:v.info.logos.small,alt:""}),n.createElement("div",{className:(0,t.cx)(M.itemContent,{[M.disabled]:A})},n.createElement("div",{className:M.name},D),x?n.createElement("span",{className:M.description},x):null,b),O&&n.createElement("div",{className:(0,t.cx)(M.badge,{[M.disabled]:A})},n.createElement(g,{plugin:v})),T&&n.createElement(i.K,{name:"trash-alt",onClick:B=>{B.stopPropagation(),T()},className:M.deleteButton,"aria-label":"Delete button on panel type card",tooltip:"Delete"}))};y.displayName="PanelTypeCard";const f=({children:h,hasDescription:D,hasDelete:v,rootProps:C})=>{const T=(0,l.of)(E),S=(0,l.of)(a);return n.createElement("div",{className:T.item,...C},n.createElement(s.A,{className:(0,t.cx)(T.img,S.image),width:c,height:c}),n.createElement("div",{className:T.itemContent},n.createElement("div",{className:T.name},n.createElement(s.A,{width:160})),D?n.createElement(s.A,{containerClassName:T.description,width:80}):null,h),v&&n.createElement(s.A,{containerClassName:(0,t.cx)(T.deleteButton,S.deleteButton),width:16,height:16}))},P=(0,d.j)(y,f),a=()=>({deleteButton:(0,t.css)({lineHeight:1}),image:(0,t.css)({lineHeight:1})}),E=h=>({item:(0,t.css)({position:"relative",display:"flex",flexShrink:0,cursor:"pointer",background:h.colors.background.secondary,borderRadius:h.shape.radius.default,boxShadow:h.shadows.z1,border:`1px solid ${h.colors.background.secondary}`,alignItems:"center",padding:h.spacing(1),width:"100%",overflow:"hidden",[h.transitions.handleMotion("no-preference","reduce")]:{transition:h.transitions.create(["background"],{duration:h.transitions.duration.short})},"&:hover":{background:h.colors.emphasize(h.colors.background.secondary,.03)}}),itemContent:(0,t.css)({overflow:"hidden",position:"relative",padding:h.spacing(0,1)}),itemDisabled:(0,t.css)({cursor:"default","&, &:hover":{background:h.colors.action.disabledBackground}}),current:(0,t.css)({label:"currentVisualizationItem",border:`1px solid ${h.colors.primary.border}`,background:h.colors.action.selected}),disabled:(0,t.css)({opacity:.6,filter:"grayscale(1)",cursor:"default",pointerEvents:"none"}),name:(0,t.css)({textOverflow:"ellipsis",overflow:"hidden",fontSize:h.typography.size.sm,fontWeight:h.typography.fontWeightMedium,width:"100%"}),description:(0,t.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",color:h.colors.text.secondary,fontSize:h.typography.bodySmall.fontSize,fontWeight:h.typography.fontWeightLight,width:"100%",maxHeight:"4.5em"}),img:(0,t.css)({maxHeight:c,width:c,display:"flex",alignItems:"center"}),badge:(0,t.css)({background:h.colors.background.primary}),deleteButton:(0,t.css)({cursor:"pointer",marginLeft:"auto"})}),g=({plugin:h})=>(0,o.x)(h.signature)?n.createElement(u.B,{status:h.signature}):n.createElement(p.p,{state:h.state});g.displayName="PanelPluginBadge"},56707:(G,I,e)=>{"use strict";e.d(I,{a:()=>g});var t=e(32196),n=e(96540),s=e(16817),r=e(70713),o=e(40845),m=e(47070),l=e(32264),i=e(15162);const u=["timeseries","barchart","gauge","stat","piechart","bargauge","table","state-timeline","status-history","logs","candlestick","flamegraph","traces","nodeGraph"];async function d(v,C){const T=new m.v2(v,C);for(const O of u){const b=(await(0,i.TV)(O)).getSuggestionsSupplier();b&&b.getSuggestionsForData(T)}const S=T.getList();if(!l.$.featureToggles.vizAndWidgetSplit&&T.dataSummary.fieldCount===0)for(const O of Object.values(l.$.panels))!O.skipDataQuery||O.hideFromList||S.push({name:O.name,pluginId:O.id,description:O.info.description,cardOptions:{imgSrc:O.info.logos.small}});return S.sort((O,x)=>{if(T.dataSummary.preferredVisualisationType){if(O.pluginId===T.dataSummary.preferredVisualisationType)return-1;if(x.pluginId===T.dataSummary.preferredVisualisationType)return 1}return(x.score??m.nQ.OK)-(O.score??m.nQ.OK)})}var p=e(2543),c=e(13544),y=e(56034),f=e(20726);function P({data:v,suggestion:C,onChange:T,width:S}){const O=(0,o.of)(a),{innerStyles:x,outerStyles:b,renderWidth:M,renderHeight:A}=E(S),R=C.cardOptions??{},B={"aria-label":C.name,className:O.vizBox,"data-testid":c.Tp.components.VisualizationPreview.card(C.name),style:b,onClick:()=>{T({pluginId:C.pluginId,options:C.options,fieldConfig:C.fieldConfig})}};if(R.imgSrc)return n.createElement(y.m,{content:C.description??C.name},n.createElement("button",{...B,className:(0,t.cx)(O.vizBox,O.imgBox)},n.createElement("div",{className:O.name},C.name),n.createElement("img",{className:O.img,src:R.imgSrc,alt:C.name})));let U=C;return C.cardOptions?.previewModifier&&(U=(0,p.cloneDeep)(C),C.cardOptions.previewModifier(U)),n.createElement("button",{...B},n.createElement(y.m,{content:C.name},n.createElement("div",{style:x,className:O.renderContainer},n.createElement(f.m,{title:"",data:v,pluginId:C.pluginId,width:M,height:A,options:U.options,fieldConfig:U.fieldConfig}),n.createElement("div",{className:O.hoverPane}))))}const a=v=>({hoverPane:(0,t.css)({position:"absolute",top:0,right:0,left:0,borderRadius:v.spacing(2),bottom:0}),vizBox:(0,t.css)`
      position: relative;
      background: none;
      border-radius: ${v.shape.radius.default};
      cursor: pointer;
      border: 1px solid ${v.colors.border.medium};

      transition: ${v.transitions.create(["background"],{duration:v.transitions.duration.short})};

      &:hover {
        background: ${v.colors.background.secondary};
      }
    `,imgBox:(0,t.css)`
      display: flex;
      flex-direction: column;
      height: 100%;

      justify-self: center;
      color: ${v.colors.text.primary};
      width: 100%;
      display: flex;

      justify-content: center;
      align-items: center;
      text-align: center;
    `,name:(0,t.css)`
      padding-bottom: ${v.spacing(.5)};
      margin-top: ${v.spacing(-1)};
      font-size: ${v.typography.bodySmall.fontSize};
      white-space: nowrap;
      overflow: hidden;
      color: ${v.colors.text.secondary};
      font-weight: ${v.typography.fontWeightMedium};
      text-overflow: ellipsis;
    `,img:(0,t.css)`
      max-width: ${v.spacing(8)};
      max-height: ${v.spacing(8)};
    `,renderContainer:(0,t.css)`
      position: absolute;
      transform-origin: left top;
      top: 6px;
      left: 6px;
    `});function E(v){const T=v,S=v*(1/1.6),O=350,x=O*(1/1.6),b=6,M=(T-b*2)/O,A=(S-b*2)/x;return{renderHeight:x,renderWidth:O,outerStyles:{width:T,height:S},innerStyles:{width:O,height:x,transform:`scale(${M}, ${A})`}}}function g({searchQuery:v,onChange:C,data:T,panel:S}){const O=(0,o.of)(D),{value:x}=(0,s.A)(()=>d(T,S),[T,S]),b=h(v,x);return n.createElement("div",null,n.createElement(r.Ay,{disableHeight:!0,style:{width:"100%",height:"100%"}},({width:M})=>{if(!M)return null;M=M-1;const A=Math.floor(M/200),R=8*(A-1),B=Math.floor((M-R)/A);return n.createElement("div",null,n.createElement("div",{className:O.filterRow},n.createElement("div",{className:O.infoText},"Based on current data")),n.createElement("div",{className:O.grid,style:{gridTemplateColumns:`repeat(auto-fill, ${B}px)`}},b.map((U,W)=>n.createElement(P,{key:W,data:T,suggestion:U,onChange:C,width:B-1})),v&&b.length===0&&n.createElement("div",{className:O.infoText},"No results matched your query")))}))}function h(v,C){if(!v||!C)return C||[];const T=new RegExp(v,"i");return C.filter(S=>T.test(S.name)||T.test(S.pluginId))}const D=v=>({heading:(0,t.css)({...v.typography.h5,margin:v.spacing(0,.5,1)}),filterRow:(0,t.css)({display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",paddingBottom:"8px"}),infoText:(0,t.css)({fontSize:v.typography.bodySmall.fontSize,color:v.colors.text.secondary,fontStyle:"italic"}),grid:(0,t.css)({display:"grid",gridGap:v.spacing(1),gridTemplateColumns:"repeat(auto-fill, 144px)",marginBottom:v.spacing(1),justifyContent:"space-evenly"})})},86292:(G,I,e)=>{"use strict";e.d(I,{G:()=>i});var t=e(32196),n=e(96540),s=e(32264),r=e(40845),o=e(41670),m=e(17706),l=e(48889);function i({pluginId:d,searchQuery:p,onChange:c,isWidget:y=!1}){const f=(0,r.of)(u),P=(0,n.useMemo)(()=>s.$.featureToggles.vizAndWidgetSplit?y?(0,m.nr)():(0,m.if)():(0,m.A4)(),[y]),a=(0,n.useMemo)(()=>(0,m.CO)(P,p,d),[P,p,d]);return a.length===0?n.createElement(o.Z,null,"Could not find anything matching your query"):n.createElement("div",{className:f.grid},a.map(E=>n.createElement(l.f,{disabled:!1,key:E.id,isCurrent:E.id===d,plugin:E,onClick:g=>c({pluginId:E.id,withModKey:g.metaKey||g.ctrlKey||g.altKey})})))}const u=d=>({grid:(0,t.css)({maxWidth:"100%",display:"grid",gridGap:d.spacing(.5)}),heading:(0,t.css)({...d.typography.h5,margin:d.spacing(0,.5,1)})})},48889:(G,I,e)=>{"use strict";e.d(I,{f:()=>s});var t=e(96540),n=e(25701);const s=({isCurrent:r,plugin:o,onClick:m,disabled:l})=>t.createElement(n.b,{title:o.name,plugin:o,description:o.info.description,onClick:m,isCurrent:r,disabled:l,showBadge:!0});s.displayName="VizTypePickerPlugin"},32349:(G,I,e)=>{"use strict";e.d(I,{CH:()=>i,E7:()=>l,EO:()=>m});var t=e(14236),n=e(83195),s=e(92461),r=e(32023),o=e(6923);const m=u=>{const d=u.field.links;if(!(!d||d.length===0))return{getLinks:p=>{const c={};if(u.view){const{dataFrame:f}=u.view;c.__series={value:{name:f.name,refId:f.refId},text:"Series"};const P=u.colIndex!==void 0?f.fields[u.colIndex]:void 0;if(P){if(c.__field={value:{name:P.name,labels:P.labels},text:"Field"},u.rowIndex!==void 0&&u.rowIndex>=0){const{timeField:a}=(0,t.KR)(f);c.__value={value:{raw:P.values[u.rowIndex],numeric:u.display.numeric,text:(0,n.cN)(u.display),time:a?a.values[u.rowIndex]:void 0},text:"Value"}}u.view&&(c.__data={value:{name:f.name,refId:f.refId,fields:(0,s.F)({frame:f,rowIndex:u.rowIndex})},text:"Data"})}else c.__value={value:{raw:u.display.numeric,numeric:u.display.numeric,text:(0,n.cN)(u.display),calc:u.name},text:"Value"}}else console.log("VALUE",u);const y=(f,P,a)=>{const E={...c,...P};return p(f,E,a)};return d.map(f=>(0,o.mQ)().getDataLinkUIModel(f,y,u))}}},l=(u,d)=>{const p=u.links;if(!(!p||p.length===0))return{getLinks:()=>p.map(c=>(0,o.mQ)().getDataLinkUIModel(c,d||u.replaceVariables,u))}},i=(u,d)=>{const p=r.b4.getPanelLinks(u)?.state.rawLinks;if(!(!p||p.length===0))return{getLinks:()=>p.map(c=>(0,o.mQ)().getDataLinkUIModel(c,d,u))}}},6923:(G,I,e)=>{"use strict";e.d(I,{Fq:()=>g,Hf:()=>v,mQ:()=>x});var t=e(2543),n=e.n(t),s=e(6709),r=e(91890),o=e(28240),m=e(11261),l=e(71733),i=e(40672),u=e(76885),d=e(95344),p=e(72574),c=e(52622),y=e(2913);const f=[{value:`${s.c.keepTime}`,label:"Time range",documentation:"Adds current time range",origin:r.$0.BuiltIn},{value:`${s.c.timeRangeFrom}`,label:"Time range: from",documentation:"Adds current time range's from value",origin:r.$0.BuiltIn},{value:`${s.c.timeRangeTo}`,label:"Time range: to",documentation:"Adds current time range's to value",origin:r.$0.BuiltIn}],P=[{value:`${s.c.seriesName}`,label:"Name",documentation:"Name of the series",origin:r.$0.Series}],a=[{value:`${s.c.valueNumeric}`,label:"Numeric",documentation:"Numeric representation of selected value",origin:r.$0.Value},{value:`${s.c.valueText}`,label:"Text",documentation:"Text representation of selected value",origin:r.$0.Value},{value:`${s.c.valueRaw}`,label:"Raw",documentation:"Raw value",origin:r.$0.Value}],E=b=>b.includes(".")||b.trim().includes(" ")?`["${b}"]`:`.${b}`,g=()=>[...(0,p.w)().getVariables().map(b=>({value:b.name,label:b.name,origin:r.$0.Template})),{value:`${s.c.includeVars}`,label:"All variables",documentation:"Adds current variables",origin:r.$0.Template},...f],h=b=>{const M=[];for(const R of b)for(const B of R.fields)if(B.labels)for(const U of Object.keys(B.labels))M.push(U);const A=(0,t.chain)(M).flatten().uniq().value();return[{value:`${s.c.fieldName}`,label:"Name",documentation:"Field name of the clicked datapoint (in ms epoch)",origin:r.$0.Field},...A.map(R=>({value:`__field.labels${E(R)}`,label:`labels.${R}`,documentation:`${R} label value`,origin:r.$0.Field}))]},D=b=>{let M,A;const R=[],B={};if(b.length!==1)return[];const U=b[0];for(const W of U.fields){const N=(0,o.Ct)(W,U,b);B[N]||(R.push({value:`__data.fields${E(N)}`,label:`${N}`,documentation:`Formatted value for ${N} on the same row`,origin:r.$0.Fields}),B[N]=!0,!M&&W.type===m.PU.number&&(M={...W,name:N}),!A&&W.config.displayName&&W.config.displayName!==W.name&&(A={...W,name:N}))}return R.length&&R.push({value:"__data.fields[0]",label:"Select by index",documentation:"Enter the field order",origin:r.$0.Fields}),M&&(R.push({value:`__data.fields${E(M.name)}.numeric`,label:"Show numeric value",documentation:"the numeric field value",origin:r.$0.Fields}),R.push({value:`__data.fields${E(M.name)}.text`,label:"Show text value",documentation:"the text value",origin:r.$0.Fields})),A&&R.push({value:`__data.fields${E(A.name)}`,label:"Select by title",documentation:"Use the title to pick the field",origin:r.$0.Fields}),R},v=(b,M)=>{const A={value:`${s.c.valueTime}`,label:"Time",documentation:"Time value of the clicked datapoint (in ms epoch)",origin:r.$0.Value};return M===r.uP.Values?[...P,...h(b),...a,A,...D(b),...g()]:[...P,...h(b),...D(b),...g()]},C=b=>{const M=h(b),A={value:`${DataLinkBuiltInVars.valueCalc}`,label:"Calculation name",documentation:"Name of the calculation the value is a result of",origin:VariableOrigin.Value};return[...P,...M,...a,A,...g()]};class T{constructor(){this.getDataLinkUIModel=(M,A,R)=>{let B=M.url;M.onBuildUrl&&(B=M.onBuildUrl({origin:R,replaceVariables:A}));const U={href:l.I.assureBaseUrl(B.replace(/\n/g,"")),title:M.title??"",target:M.targetBlank?"_blank":void 0,origin:R};return A&&(U.href=A(U.href,void 0,c.$m.UriEncode),U.title=A(M.title)),M.onClick&&(U.onClick=W=>{M.onClick({origin:R,replaceVariables:A,e:W})}),U.href=(0,y.zj)().disableSanitizeHtml?U.href:i.sQ.sanitizeUrl(U.href),U}}getLinkUrl(M){let A={};M.keepTime&&(A[`$${s.c.keepTime}`]=!0),M.includeVars&&(A[`$${s.c.includeVars}`]=!0);let R=l.I.assureBaseUrl(u.kM.appendQueryToUrl(M.url||"",u.kM.toUrlParams(A)));return R=(0,p.w)().replace(R),(0,y.zj)().disableSanitizeHtml?R:i.sQ.sanitizeUrl(R)}getAnchorInfo(M){const A=(0,p.w)();return{href:this.getLinkUrl(M),title:A.replace(M.title||""),tooltip:A.replace(M.tooltip||"")}}getPanelLinkAnchorInfo(M,A){(0,d.l)("link_srv.ts","getPanelLinkAnchorInfo","getDataLinkUIModel");const R=(B,U,W)=>(0,p.w)().replace(B,{...A,...U},W);return this.getDataLinkUIModel(M,R,{})}}let S;function O(b){S=b}function x(){return S||(S=new T),S}},79971:(G,I,e)=>{"use strict";e.d(I,{Ap:()=>l,O6:()=>i,Xk:()=>d,gW:()=>u});var t=e(581),n=e(57767),s=e(41394),r=e(20701),o=e(28444),m=e(80095);function l(c){return async(y,f)=>{if(c.libraryPanel?.uid&&!("model"in c.libraryPanel)){y(p(c));return}c.maxDataPoints&&(c.maxDataPoints=Number(c.maxDataPoints));let P=c.type,a=f().plugins.panels[P];if(!a)try{a=await y((0,r.y7)(P))}catch{a=(0,s.$)(P,P==="row")}c.plugin||await c.pluginLoaded(a),y((0,m.XM)({key:c.key,plugin:a}))}}function i(c){return y=>{y((0,m.FC)({key:c}))}}function u({panel:c,pluginId:y,options:f,fieldConfig:P,transformations:a}){return async(E,g)=>{if(c.type===y&&!f&&!P&&!a)return;let D=g().plugins.panels[y];if(D||(D=await E((0,r.y7)(y))),c.type!==y&&c.changePlugin(D),f||P||a){const v=(0,t.F)({plugin:D,currentOptions:f||c.options,currentFieldConfig:P||c.fieldConfig,isAfterPluginChange:!1});c.options=v.options,c.fieldConfig=v.fieldConfig,c.transformations=a||c.transformations,c.configRev++}c.generateNewKey(),E((0,m.XM)({key:c.key,plugin:D}))}}function d(c,y){return async(f,P)=>{const a=y.model.type,E=c.type;if(c.restoreModel({...y.model,gridPos:c.gridPos,id:c.id,libraryPanel:y}),c.getQueryRunner().clearLastResult(),E!==a){let h=P().plugins.panels[a];h||(h=await f((0,r.y7)(a))),await c.pluginLoaded(h),c.generateNewKey(),await f((0,m.XM)({key:c.key,plugin:h}))}else{const g=c.key;c.generateNewKey(),f((0,m.io)({oldKey:g,newKey:c.key}))}c.configRev=0,c.hasSavedPanelEditChange=!0,c.refresh(),c.events.publish(o.zq),c.events.publish(o.PR)}}function p(c){return async(y,f)=>{const P=c.libraryPanel.uid;try{const a=await(0,n.Yr)(P,!0);c.initLibraryPanel(a);const E=f().dashboard.getModel();if(c.repeat&&E){const g=E.panels.findIndex(h=>h.id===c.id);E.repeatPanel(c,g),E.sortPanelsByGridPos(),E.events.publish(new o.Q$)}await y(l(c))}catch(a){console.log("ERROR: ",a),y((0,m.XM)({key:c.key,plugin:(0,s.$)("Unable to load library panel: "+P,!1)}))}}}},80095:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>p,FC:()=>i,S3:()=>o,XM:()=>r,io:()=>l,nF:()=>m,rG:()=>u});var t=e(65307);const n={},s=(0,t.Z0)({name:"panels",initialState:n,reducers:{panelModelAndPluginReady:(c,y)=>{c[y.payload.key]={plugin:y.payload.plugin}},changePanelKey:(c,y)=>{c[y.payload.newKey]=c[y.payload.oldKey],delete c[y.payload.oldKey]},removePanel:(c,y)=>{delete c[y.payload.key]},removeAllPanels:c=>{Object.keys(c).forEach(y=>delete c[y])},setPanelInstanceState:(c,y)=>{c[y.payload.key].instanceState=y.payload.value},setPanelAngularComponent:(c,y)=>{const f=c[y.payload.key];f.angularComponent=y.payload.angularComponent}}}),{panelModelAndPluginReady:r,setPanelAngularComponent:o,setPanelInstanceState:m,changePanelKey:l,removePanel:i,removeAllPanels:u}=s.actions,p={panels:s.reducer}},40334:(G,I,e)=>{"use strict";e.d(I,{U:()=>t});function t(n,s){return n.panels[s.key]}},17706:(G,I,e)=>{"use strict";e.d(I,{A4:()=>r,CO:()=>l,if:()=>m,nr:()=>o});var t=e(43429),n=e(54479),s=e(2913);function r(){const i=s.config.panels;return Object.keys(i).filter(u=>i[u].hideFromList===!1).map(u=>i[u]).sort((u,d)=>u.sort-d.sort)}function o(){return r().filter(i=>!!i.skipDataQuery)}function m(){return r().filter(i=>!i.skipDataQuery)}function l(i,u,d){if(!u.length)return i.filter(P=>P.state===t.pn.deprecated?d===P.id:!0);const p=(0,n.xb)(u).toLowerCase(),c=[],y=[],f="graph".startsWith(p);for(const P of i){if(P.state===t.pn.deprecated&&d!==P.id)continue;const E=P.name.toLowerCase().indexOf(p);E===0?c.push(P):E>0?y.push(P):f&&P.id==="timeseries"&&c.push(P)}return c.concat(y)}},2609:(G,I,e)=>{"use strict";e.d(I,{_o:()=>p});var t=e(2543),n=e.n(t),s=e(71733),r=e(76885),o=e(65879),m=e(12131),l=e(2619),i=e(86022);const u={kiosk:!0,autofitpanels:!0,orgId:!0};class d extends l.Q{constructor(){super({isPlaying:!1}),this.urls=[],this.index=0,this.numberOfLoops=0,this.locationUpdated=this.locationUpdated.bind(this),this.api=(0,i.NF)()}next(){if(clearTimeout(this.nextTimeoutId),this.index>this.urls.length-1){if(this.numberOfLoops++,this.numberOfLoops>=3){window.location.href=this.startUrl;return}this.index=0}const f=this.urls[this.index],P=m.Ny.getSearchObject(),a=(0,t.pickBy)(P,(g,h)=>u[h]),E=s.I.stripBaseFromUrl(f);this.index++,this.validPlaylistUrl=E,this.nextTimeoutId=setTimeout(()=>this.next(),this.interval),m.Ny.push(E+"?"+r.kM.toUrlParams(a))}prev(){this.index=Math.max(this.index-2,0),this.next()}locationUpdated(y){y.pathname!==this.validPlaylistUrl&&this.stop()}async start(y){this.stop(),this.startUrl=window.location.href,this.index=0,this.setState({isPlaying:!0}),this.locationListenerUnsub=m.Ny.getHistory().listen(this.locationUpdated);const f=[];let P=await this.api.getPlaylist(y);if(!P.items?.length)return;this.interval=o.intervalToMs(P.interval);const a=await(0,i.qY)(P.items);for(const E of a)if(E.dashboards)for(const g of E.dashboards)f.push(g.url);f.length&&(this.urls=f,this.setState({isPlaying:!0}),this.next())}stop(){this.state.isPlaying&&(this.index=0,this.setState({isPlaying:!1}),this.locationListenerUnsub&&this.locationListenerUnsub(),this.nextTimeoutId&&clearTimeout(this.nextTimeoutId),m.Ny.getSearchObject().kiosk&&m.Ny.partial({kiosk:null}))}}const p=new d},86022:(G,I,e)=>{"use strict";e.d(I,{GM:()=>h,NF:()=>D,aV:()=>g,qY:()=>E});var t=e(75505),n=e(78368),s=e(17172),r=e(32264),o=e(82467),m=e(3169),l=e(90183),i=e(68706),u=e(99140),d=e(2468),p=e(24439);class c{async getAllPlaylist(){return(0,s.AI)().get("/api/playlists/")}async getPlaylist(C){const T=await(0,s.AI)().get(`/api/playlists/${C}`);return await P(T),T}async createPlaylist(C){await a(()=>(0,s.AI)().post("/api/playlists",C))}async updatePlaylist(C){await a(()=>(0,s.AI)().put(`/api/playlists/${C.uid}`,C))}async deletePlaylist(C){await a(()=>(0,s.AI)().delete(`/api/playlists/${C}`),"Playlist deleted")}}class y{constructor(){this.playlistAsK8sResource=C=>({metadata:{name:C.uid},spec:{title:C.name,interval:C.interval,items:C.items??[]}}),this.server=new d.w({group:"playlist.grafana.app",version:"v0alpha1",resource:"playlists"})}async getAllPlaylist(){return(await this.server.list()).items.map(f)}async getPlaylist(C){const T=await this.server.get(C),S=f(T);return await P(S),S}async createPlaylist(C){const T=this.playlistAsK8sResource(C);await a(()=>this.server.create(T))}async updatePlaylist(C){const T=this.playlistAsK8sResource(C);await a(()=>this.server.update(T).then(()=>{}))}async deletePlaylist(C){await a(()=>this.server.delete(C).then(()=>{}),"Playlist deleted")}}function f(v){const{spec:C,metadata:T}=v;return{uid:T.name,name:C.title,interval:C.interval,items:C.items}}async function P(v){if(v?.items){for(const C of v.items)if(C.type==="dashboard_by_id"){C.type="dashboard_by_uid";const T=await(0,s.AI)().get(`/api/dashboards/ids/${C.value}`);T?.length&&(C.value=T[0])}}}async function a(v,C="Playlist saved"){try{await v(),(0,u.JD)((0,o.dx)((0,m.tZ)(C)))}catch(T){T instanceof Error&&(0,u.JD)((0,o.dx)((0,m.gi)("Unable to save playlist",T)))}}async function E(v){let C=0;if(!v?.length)return[];const T=[];for(const x of v){const b={query:"*",kind:["dashboard"],limit:1e3};switch(x.type){case"dashboard_by_id":throw new Error("invalid item (with id)");case"dashboard_by_uid":b.uid=[x.value];break;case"dashboard_by_tag":b.tags=[x.value];break}T.push({refId:`${C++}`,queryType:i.nj.Search,search:b})}if(!r.$.featureToggles.panelTitleSearch){const x=(0,p.getGrafanaSearcher)(),b=[];for(let M=0;M<T.length;M++){const A=(await x.search(T[M].search)).view;b.push({...v[M],dashboards:A.map(R=>({...R}))})}return b}const S=await(0,l.o)(),O=await(0,t.s)(S.query({targets:T}));if(O.data.length!==v.length)throw new Error("unexpected result size");return v.map((x,b)=>{const M=new n.R(O.data[b]);return{...x,dashboards:M.map(A=>({...A}))}})}function g(){return{items:[],interval:"5m",name:"",uid:""}}function h(v,C){return C?.length?(C=C.toLowerCase(),v.filter(T=>T.name.toLowerCase().includes(C))):v}function D(){return r.$.featureToggles.kubernetesPlaylists?new y:new c}},84684:(G,I,e)=>{"use strict";e.d(I,{Ap:()=>y,Bj:()=>i,CB:()=>m,Gd:()=>c,T_:()=>l,XP:()=>f,cu:()=>a,ij:()=>E,xZ:()=>P});var t=e(36663),n=e(17172),s=e(80714),r=e(6745),o=e(5129);async function m(h){const D=await u(h),v=!!D,[C,T,S]=await Promise.all([c(),d(h,v),p(h)]),O=C.find(b=>b.id===h),x=O?.dependencies||D?.json?.dependencies;return{grafanaDependency:x?.grafanaDependency??x?.grafanaVersion??"",pluginDependencies:x?.plugins||[],links:O?.info.links||D?.json?.info.links||[],readme:S||D?.readme,versions:T,statusContext:D?.statusContext??"",iam:D?.json?.iam}}async function l(){try{const{items:h}=await(0,n.AI)().get(`${r.P5}/plugins`,{includeDeprecated:!0});return h.filter(o.hY)}catch(h){if((0,n.NF)(h))return h.isHandled=!0,console.error("Failed to fetch plugins from catalog (default https://grafana.com/api/plugins)"),[];throw h}}async function i(){try{return await(0,n.AI)().get(`${r.Sw}/errors`)}catch{return[]}}async function u(h){try{return await(0,n.AI)().get(`${r.P5}/plugins/${h}`,{})}catch(D){(0,n.NF)(D)&&(D.isHandled=!0);return}}async function d(h,D){try{return D?((await(0,n.AI)().get(`${r.P5}/plugins/${h}/versions`)).items||[]).map(C=>({version:C.version,createdAt:C.createdAt,isCompatible:C.isCompatible,grafanaDependency:C.grafanaDependency})):[]}catch(v){return(0,n.NF)(v)&&(v.isHandled=!0),[]}}async function p(h){try{const D=await(0,n.AI)().get(`${r.Sw}/${h}/markdown/README`);return D?(0,t.G)(D):""}catch(D){return(0,n.NF)(D)&&(D.isHandled=!0),""}}async function c(){return(await(0,n.AI)().get(`${r.Sw}`,(0,s.F)({embedded:0}))).filter(o.Sq)}async function y(){const{items:h}=await(0,n.AI)().get(`${r.Mi}/plugins`);return h}async function f(){const{items:h}=await(0,n.AI)().get(`${r.Mi}/provisioned-plugins`);return h.map(D=>({slug:D.type}))}async function P(h){return await(0,n.AI)().post(`${r.Sw}/${h}/install`,void 0,{showErrorAlert:!1})}async function a(h){return await(0,n.AI)().post(`${r.Sw}/${h}/uninstall`)}async function E(h,D){return(await(0,n.AI)().datasourceRequest({url:`/api/plugins/${h}/settings`,method:"POST",data:D}))?.data}const g={getRemotePlugins:l,getInstalledPlugins:c,installPlugin:P,uninstallPlugin:a}},42930:(G,I,e)=>{"use strict";e.d(I,{G:()=>r});var t=e(32196),n=e(96540),s=e(40845);const r=({children:m,wrap:l,className:i})=>{const u=(0,s.$j)(),d=o(u,l);return n.createElement("div",{className:(0,t.cx)(d.container,i)},m)},o=(m,l)=>({container:(0,t.css)`
    display: flex;
    flex-direction: row;
    flex-wrap: ${l?"wrap":"no-wrap"};
    & > * {
      margin-bottom: ${m.spacing()};
      margin-right: ${m.spacing()};
    }
    & > *:last-child {
      margin-right: 0;
    }
  `})},6745:(G,I,e)=>{"use strict";e.d(I,{Mi:()=>n,P5:()=>s,Sw:()=>t,fu:()=>r});const t="/api/plugins",n="/api/instance",s="/api/gnet",r="plugins"},5129:(G,I,e)=>{"use strict";e.d(I,{Gl:()=>C,H2:()=>a,N6:()=>S,Sq:()=>O,TD:()=>U,Xc:()=>g,by:()=>E,hY:()=>x,j_:()=>T,kH:()=>f,td:()=>p,tr:()=>v});var t=e(53076),n=e(43429),s=e(53531),r=e(32264),o=e(33378),m=e(2913),l=e(10096),i=e(27677),u=e(31678),d=e(66253);function p({local:W=[],remote:N=[],instance:w=[],provisioned:L=[],pluginErrors:V}){const K=[],k=h(V),j=w.reduce((J,X)=>(J.set(X.pluginSlug,X),J),new Map),H=L.reduce((J,X)=>(J.add(X.slug),J),new Set);return W.forEach(J=>{const X=N.find(ae=>ae.slug===J.id),se=k[J.id];X||K.push(c(J,void 0,se))}),N.forEach(J=>{const X=W.find(ne=>ne.id===J.slug),se=k[J.slug];if(!(J.status===d.Uy.Deprecated&&!X)){const ne=c(X,J,se);if(m.Ay.featureToggles.managedPluginsInstall&&r.$.pluginAdminExternalManageEnabled){ne.isFullyInstalled=ne.isCore?!0:(j.has(J.slug)||H.has(J.slug))&&ne.isInstalled,ne.isInstalled=j.has(J.slug)||ne.isInstalled;const q=j.get(J.slug);ne.isUpdatingFromInstance=j.has(J.slug)&&ne.hasUpdate&&ne.installedVersion!==q?.version,q?.version&&q?.version!==J.version&&(ne.hasUpdate=!0),ne.isUninstallingFromInstance=!!X&&!j.has(J.slug)}K.push(ne)}}),K}function c(W,N,w){return!W&&N?y(N,w):W&&!N?f(W,w):P(W,N,w)}function y(W,N){const{name:w,slug:L,description:V,version:K,orgName:k,popularity:j,downloads:H,typeCode:J,updatedAt:X,createdAt:se,status:ae,angularDetected:ne,keywords:q}=W,ee=!!N||M(J);return{description:V,downloads:H,id:L,info:{logos:{small:`${r.$.appSubUrl}/api/gnet/plugins/${L}/versions/${K}/logos/small`,large:`${r.$.appSubUrl}/api/gnet/plugins/${L}/versions/${K}/logos/large`},keywords:q},name:w,orgName:k,popularity:j,publishedAt:se,signature:D({remote:W,error:N}),updatedAt:X,hasUpdate:!1,isPublished:!0,isInstalled:ee,isDisabled:ee,isDeprecated:ae===d.Uy.Deprecated,isCore:W.internal,isDev:!1,isEnterprise:ae===d.Uy.Enterprise,type:J,error:N?.errorCode,angularDetected:ne,isFullyInstalled:ee}}function f(W,N){const{name:w,info:{description:L,version:V,logos:K,updated:k,author:j,keywords:H},id:J,dev:X,type:se,signature:ae,signatureOrg:ne,signatureType:q,hasUpdate:ee,accessControl:z,angularDetected:te}=W,ie=!!N||M(se);return{description:L,downloads:0,id:J,info:{logos:K,keywords:H},name:w,orgName:j.name,popularity:0,publishedAt:"",signature:D({local:W,error:N}),signatureOrg:ne,signatureType:q,updatedAt:k,installedVersion:V,hasUpdate:ee,isInstalled:!0,isDisabled:ie,isCore:ae==="internal",isPublished:!1,isDeprecated:!1,isDev:!!X,isEnterprise:!1,type:se,error:N?.errorCode,accessControl:z,angularDetected:te,isFullyInstalled:!0,iam:W.iam}}function P(W,N,w){const L=W?.info.version,V=N?.slug||W?.id||"",K=W?.type||N?.typeCode,k=!!w||M(K),j=N?.keywords||W?.info.keywords||[];let H={small:`/public/img/icn-${K}.svg`,large:`/public/img/icn-${K}.svg`};return N?H={small:`${r.$.appSubUrl}/api/gnet/plugins/${V}/versions/${N.version}/logos/small`,large:`${r.$.appSubUrl}/api/gnet/plugins/${V}/versions/${N.version}/logos/large`}:W&&W.info.logos&&(H=W.info.logos),{description:W?.info.description||N?.description||"",downloads:N?.downloads||0,hasUpdate:W?.hasUpdate||!1,id:V,info:{logos:H,keywords:j},isCore:!!(N?.internal||W?.signature===n.Ac.internal),isDev:!!W?.dev,isEnterprise:N?.status===d.Uy.Enterprise,isInstalled:!!W||k,isDisabled:k,isDeprecated:N?.status===d.Uy.Deprecated,isPublished:!0,name:N?.name||W?.name||"",orgName:N?.orgName||W?.info.author.name||"",popularity:N?.popularity||0,publishedAt:N?.createdAt||"",type:K,signature:D({local:W,remote:N,error:w}),signatureOrg:W?.signatureOrg||N?.versionSignedByOrgName,signatureType:W?.signatureType||N?.versionSignatureType||N?.signatureType||void 0,updatedAt:N?.updatedAt||W?.info.updated||"",installedVersion:L,error:w?.errorCode,accessControl:W?.accessControl,angularDetected:W?.angularDetected??N?.angularDetected,isFullyInstalled:!!W||k,iam:W?.iam}}const a=W=>`${r.$.pluginCatalogURL}${W}`;var E=(W=>(W.nameAsc="nameAsc",W.nameDesc="nameDesc",W.updated="updated",W.published="published",W.downloads="downloads",W))(E||{});const g=(W,N)=>{const w={nameAsc:(L,V)=>L.name.localeCompare(V.name),nameDesc:(L,V)=>V.name.localeCompare(L.name),updated:(L,V)=>(0,s.b)(V.updatedAt).valueOf()-(0,s.b)(L.updatedAt).valueOf(),published:(L,V)=>(0,s.b)(V.publishedAt).valueOf()-(0,s.b)(L.publishedAt).valueOf(),downloads:(L,V)=>V.downloads-L.downloads};return w[N]?W.sort(w[N]):W};function h(W=[]){return W.reduce((N,w)=>(N[w.pluginId]=w,N),{})}function D(W){const{error:N,local:w,remote:L}=W;if(N)switch(N.errorCode){case n.ZK.invalidSignature:return n.Ac.invalid;case n.ZK.missingSignature:return n.Ac.missing;case n.ZK.modifiedSignature:return n.Ac.modified}return w?.signature?w.signature:L?.signatureType&&L?.versionSignatureType?n.Ac.valid:n.Ac.missing}const v=()=>(0,i.AI)().get("/api/frontend/settings").then(W=>{r.$.panels=W.panels});function C(W){if(!W)return;const[N]=W.filter(w=>!!w.isCompatible);return N}const T=()=>r.$.pluginAdminEnabled,S=(W,N,w)=>{const L=r.$.pluginAdminExternalManageEnabled,V=l.TP.hasPermission(u.AccessControlAction.PluginsInstall),K=!!w;return W.type===n.QE.renderer||W.type===n.QE.secretsmanager||W.isEnterprise&&!(0,o.a)("enterprise.plugins")||W.isDev||!V&&!L||!W.isPublished||!K||!N},O=W=>b(W.id),x=W=>b(W.slug);function b(W){const{pluginCatalogHiddenPlugins:N}=r.$;return!N.includes(W)}function M(W){return W===n.QE.secretsmanager&&!r.$.secretsManagerPluginEnabled}function A(W){return W?.signature==="internal"}function R(W){return W.split(" - ")[0]}function B(W){return W.reduce((N,{id:w,name:L,type:V,orgName:K,info:k})=>{const j=k.keywords?.join(" ").toLowerCase(),H=`${w} - ${L} - ${V} - ${K} - ${j}`;return N.push(H),N},[])}function U(W,N){const w=B(W);let V=new t.A({intraMode:1,intraSub:0}).filter(w,N);return V===null?null:V.map(K=>R(w[K]))}},20701:(G,I,e)=>{"use strict";e.d(I,{JC:()=>x,JJ:()=>g,LR:()=>E,NJ:()=>M,aU:()=>D,ai:()=>S,h9:()=>b,mj:()=>a,nT:()=>O,t5:()=>h,y7:()=>A});var t=e(65307),n=e(65474),s=e(62467),r=e(66847),o=e(45650),m=e(90593),l=e(75505),i=e(32264),u=e(17172),d=e(2913),p=e(15162),c=e(81900),y=e(84684),f=e(6745),P=e(5129);const a=(0,t.zD)(`${f.fu}/fetchAll`,async(R,B)=>{try{B.dispatch({type:`${f.fu}/fetchLocal/pending`}),B.dispatch({type:`${f.fu}/fetchRemote/pending`});const U=i.$.pluginAdminExternalManageEnabled&&d.Ay.featureToggles.managedPluginsInstall?(0,n.H)((0,y.Ap)()):(0,s.of)(void 0),W=i.$.pluginAdminExternalManageEnabled&&d.Ay.featureToggles.managedPluginsInstall?(0,n.H)((0,y.XP)()):(0,s.of)(void 0),N=500,w=(0,n.H)((0,y.Bj)()),L=(0,n.H)((0,y.Gd)()),V=(0,n.H)((0,y.T_)()).pipe((0,r.W)(K=>(B.dispatch({type:`${f.fu}/fetchRemote/rejected`}),console.error(K),(0,s.of)([]))));return(0,o.p)({local:L,remote:V,instance:U,provisioned:W,pluginErrors:w}).pipe((0,m.w)({each:N,with:()=>(V.subscribe(async K=>{if(B.dispatch({type:`${f.fu}/fetchRemote/fulfilled`}),K.length>0){const k=await(0,l.s)(L),j=await(0,l.s)(U),H=await(0,l.s)(W),J=await(0,l.s)(w);B.dispatch(D((0,P.td)({local:k,remote:K,instance:j,provisioned:H,pluginErrors:J})))}}),(0,o.p)({local:L,instance:U,provisioned:W,pluginErrors:w}))})).subscribe(({local:K,remote:k,instance:j,provisioned:H,pluginErrors:J})=>{K&&k?(B.dispatch({type:`${f.fu}/fetchLocal/fulfilled`}),B.dispatch({type:`${f.fu}/fetchRemote/fulfilled`}),B.dispatch(D((0,P.td)({local:K,remote:k,instance:j,provisioned:H,pluginErrors:J})))):K&&(B.dispatch({type:`${f.fu}/fetchLocal/fulfilled`}),B.dispatch(D((0,P.td)({local:K,pluginErrors:J}))))},K=>(console.log(K),B.dispatch({type:`${f.fu}/fetchLocal/rejected`}),B.dispatch({type:`${f.fu}/fetchRemote/rejected`}),B.rejectWithValue("Unknown error."))),null}catch{return B.rejectWithValue("Unknown error.")}}),E=(0,t.zD)(`${f.fu}/fetchAllLocal`,async(R,B)=>{try{return(await(0,y.Gd)()).map(W=>(0,P.kH)(W))}catch{return B.rejectWithValue("Unknown error.")}}),g=(0,t.zD)(`${f.fu}/fetchRemotePlugins`,async(R,B)=>{try{return await(0,y.T_)()}catch(U){return(0,u.NF)(U)&&(U.isHandled=!0),B.rejectWithValue([])}}),h=(0,t.zD)(`${f.fu}/fetchDetails`,async(R,B)=>{try{const U=await(0,y.CB)(R);return{id:R,changes:{details:U}}}catch{return B.rejectWithValue("Unknown error.")}}),D=(0,t.VP)(`${f.fu}/addPlugins`),v=(0,t.VP)(`${f.fu}/addLocalPlugins`),C=(0,t.VP)(`${f.fu}/addLocalPlugins`),T=(0,t.VP)(`${f.fu}/addLocalPlugins`),S=(0,t.zD)(`${f.fu}/install`,async({id:R,version:B,isUpdating:U=!1},W)=>{const N=U?{isInstalled:!0,installedVersion:B,hasUpdate:!1}:{isInstalled:!0,installedVersion:B};try{return await(0,y.xZ)(R),await(0,P.tr)(),U&&(0,c.sk)(R),{id:R,changes:N}}catch(w){return console.error(w),(0,u.NF)(w)?W.rejectWithValue(w.data):W.rejectWithValue("Unknown error.")}}),O=(0,t.zD)(`${f.fu}/install`,async()=>({})),x=(0,t.zD)(`${f.fu}/uninstall`,async(R,B)=>{try{return await(0,y.cu)(R),await(0,P.tr)(),(0,c.sk)(R),{id:R,changes:{isInstalled:!1,installedVersion:void 0}}}catch(U){return console.error(U),B.rejectWithValue("Unknown error.")}}),b=(0,t.zD)(`${f.fu}/loadPluginDashboards`,async(R,B)=>{const N=`api/plugins/${B.getState().dataSources.dataSource.type}/dashboards`;return(0,u.AI)().get(N)}),M=(0,t.VP)(`${f.fu}/panelPluginLoaded`),A=R=>async(B,U)=>{let W=U().plugins.panels[R];return W||(W=await(0,p.TV)(R),U().plugins.panels[R]||B(M(W))),W}},31326:(G,I,e)=>{"use strict";e.d(I,{AI:()=>o,Ff:()=>y,qo:()=>c});var t=e(65307),n=e(6745),s=e(66253),r=e(20701);const o=(0,t.pU)(),m=f=>new RegExp(`${n.fu}/(.*)/pending`).test(f.type),l=f=>new RegExp(`${n.fu}/(.*)/fulfilled`).test(f.type),i=f=>new RegExp(`${n.fu}/(.*)/rejected`).test(f.type),u=f=>{const P=f.lastIndexOf("/");return f.substring(0,P)},d={items:o.getInitialState(),requests:{},settings:{displayMode:s.fy.Grid},plugins:[],errors:[],searchQuery:"",hasFetched:!1,dashboards:[],isLoadingPluginDashboards:!1,panels:{}},p=(0,t.Z0)({name:"plugins",initialState:d,reducers:{setDisplayMode(f,P){f.settings.displayMode=P.payload}},extraReducers:f=>f.addCase(r.aU,(P,a)=>{o.upsertMany(P.items,a.payload)}).addCase(r.LR.fulfilled,(P,a)=>{o.upsertMany(P.items,a.payload)}).addCase(r.t5.fulfilled,(P,a)=>{o.updateOne(P.items,a.payload)}).addCase(r.ai.fulfilled,(P,a)=>{o.updateOne(P.items,a.payload)}).addCase(r.JC.fulfilled,(P,a)=>{o.updateOne(P.items,a.payload)}).addCase(r.NJ,(P,a)=>{P.panels[a.payload.meta.id]=a.payload}).addCase(r.h9.pending,(P,a)=>{P.isLoadingPluginDashboards=!0,P.dashboards=[]}).addCase(r.h9.fulfilled,(P,a)=>{P.isLoadingPluginDashboards=!1,P.dashboards=a.payload}).addMatcher(m,(P,a)=>{P.requests[u(a.type)]={status:s.IZ.Pending}}).addMatcher(l,(P,a)=>{P.requests[u(a.type)]={status:s.IZ.Fulfilled}}).addMatcher(i,(P,a)=>{P.requests[u(a.type)]={status:s.IZ.Rejected,error:a.payload}})}),{setDisplayMode:c}=p.actions,y=p.reducer},66253:(G,I,e)=>{"use strict";e.d(I,{IZ:()=>i,Ip:()=>s,LZ:()=>l,Uy:()=>r,fy:()=>t,og:()=>m,u8:()=>o,vk:()=>n});var t=(u=>(u.Grid="grid",u.List="list",u))(t||{}),n=(u=>(u.Home="plugins-home",u.Browse="plugins-browse",u.Details="plugins-details",u))(n||{}),s=(u=>(u.app="apps",u.datasource="database",u.panel="credit-card",u.renderer="capture",u.secretsmanager="key-skeleton-alt",u))(s||{}),r=(u=>(u.Deleted="deleted",u.Active="active",u.Pending="pending",u.Deprecated="deprecated",u.Enterprise="enterprise",u))(r||{}),o=(u=>(u.INSTALL="INSTALL",u.UNINSTALL="UNINSTALL",u.UPDATE="UPDATE",u.REINSTALL="REINSTALL",u))(o||{}),m=(u=>(u.OVERVIEW="Overview",u.VERSIONS="Version history",u.CONFIG="Config",u.DASHBOARDS="Dashboards",u.USAGE="Usage",u.IAM="IAM",u))(m||{}),l=(u=>(u.OVERVIEW="overview",u.VERSIONS="version-history",u.CONFIG="config",u.DASHBOARDS="dashboards",u.USAGE="usage",u.IAM="iam",u))(l||{}),i=(u=>(u.Pending="Pending",u.Fulfilled="Fulfilled",u.Rejected="Rejected",u))(i||{})},74106:(G,I,e)=>{"use strict";e.d(I,{c:()=>m});var t=e(96540),n=e(43429),s=e(14110),r=e(42418);function o(l,i){let u;switch(l){case n.QE.app:u="app plugin";break;case n.QE.panel:u="panel plugin";break;case n.QE.datasource:u="data source plugin";break;default:u="plugin"}let d=`This ${u} uses a deprecated, legacy platform based on AngularJS and `;return i===void 0?d+" may be incompatible depending on your Grafana configuration.":i?d+" will stop working in future releases of Grafana.":d+" is incompatible with your current Grafana configuration."}function m(l){const{className:i,angularSupportEnabled:u,pluginId:d,pluginType:p,showPluginDetailsLink:c,interactionElementId:y}=l,[f,P]=(0,t.useState)(!1),a={};return d&&(a.pluginId=d),y&&(a.elementId=y),f?null:t.createElement(r.F,{severity:"warning",title:"Angular plugin",className:i,onRemove:()=>P(!0)},t.createElement("p",null,o(p,u)),t.createElement("div",{className:"markdown-html"},t.createElement("ul",null,t.createElement("li",null,t.createElement("a",{href:"https://grafana.com/docs/grafana/latest/developers/angular_deprecation/",className:"external-link",target:"_blank",rel:"noreferrer",onClick:()=>{(0,s.rR)("angular_deprecation_docs_clicked",a)}},"Read our deprecation notice and migration advice.")),c&&d?t.createElement("li",null,t.createElement("a",{href:`plugins/${encodeURIComponent(d)}`,className:"external-link",target:"_blank",rel:"noreferrer"},"View plugin details")):null)))}},8480:(G,I,e)=>{"use strict";e.d(I,{Hv:()=>r,mz:()=>o});var t=e(32264);function n(m){return Object.values(t.$.datasources).find(l=>l.uid===m)??null}function s(m){return n(m)?.meta.angular?.detected??!1}function r(m){const l=n(m);return(l?.meta.angular?.detected&&!l?.meta.angular.hideDeprecation)??!1}const o=new Set(["autoMigrateOldPanels","autoMigrateGraphPanel","autoMigrateTablePanel","autoMigratePiechartPanel","autoMigrateWorldmapPanel","autoMigrateStatPanel","disableAngular"])},10803:(G,I,e)=>{"use strict";e.d(I,{p:()=>r});var t=e(96540),n=e(43429),s=e(39938);const r=m=>{const l=o(m.state);return l?t.createElement(s.E,{className:m.className,color:l.color,title:l.tooltip,text:l.text,icon:l.icon}):null};function o(m){switch(m){case n.pn.deprecated:return{text:"Deprecated",color:"red",tooltip:"This feature is deprecated and will be removed in a future release"};case n.pn.alpha:return{text:"Alpha",color:"blue",tooltip:"This feature is experimental and future updates might not be backward compatible"};case n.pn.beta:return{text:"Beta",color:"blue",tooltip:"This feature is close to complete but not fully tested"};default:return null}}},31193:(G,I,e)=>{"use strict";e.d(I,{tR:()=>E,xq:()=>f});var t=e(40187),n=e(26272),s=e(80147),r=e(72574),o=e(81634),m=e(17172),l=e(19347),i=e(26657),u=e(28138),d=e(2913),p=e(53478),c=e(66718),y=e(54427);class f{constructor(h=(0,r.w)()){this.templateSrv=h,this.datasources={},this.settingsMapByName={},this.settingsMapByUid={},this.settingsMapById={},this.defaultName=""}init(h,D){this.datasources={},this.settingsMapByUid={},this.settingsMapByName=h,this.defaultName=D;for(const v of Object.values(h))v.uid||(v.uid=v.name),this.settingsMapByUid[v.uid]=v,this.settingsMapById[v.id]=v;this.datasources[i.dR.type]=p.Ex,this.datasources[c.Uj]=p.Ex,this.settingsMapByUid[i.dR.uid]=p.$i,this.settingsMapByUid[c.Uj]=p.$i}getDataSourceSettingsByUid(h){return this.settingsMapByUid[h]}getInstanceSettings(h,D){let v=P(h);if((0,i.s9)(v))return p.$i;if(v==="default"||v==null)return this.settingsMapByUid[this.defaultName]??this.settingsMapByName[this.defaultName];if(v[0]==="$"){const C=this.templateSrv.replace(v,D,a);let T;return C==="default"?T=this.settingsMapByName[this.defaultName]:T=this.settingsMapByUid[C]??this.settingsMapByName[C],T?{...T,isDefault:!1,name:v,uid:v,rawRef:{type:T.type,uid:T.uid}}:void 0}return this.settingsMapByUid[v]??this.settingsMapByName[v]??this.settingsMapById[v]}get(h,D){let v=P(h);if(!v)return this.get(this.defaultName);if((0,i.s9)(h))return Promise.resolve(this.datasources[c.Uj]);const C=this.settingsMapByName[v];return C&&(v=C.uid),this.datasources[v]?Promise.resolve(this.datasources[v]):(v=this.templateSrv.replace(v,D,a),v==="default"&&this.defaultName!=="default"?this.get(this.defaultName):this.datasources[v]?Promise.resolve(this.datasources[v]):this.loadDatasource(v))}async loadDatasource(h){if(this.datasources[h])return Promise.resolve(this.datasources[h]);const D=this.getInstanceSettings(h);if(!D)return Promise.reject({message:`Datasource ${h} was not found`});try{const v=await(0,y.cS)(D.meta);if(this.datasources[h])return this.datasources[h];const C=v.DataSourceClass.length!==1;let T;if(C?T=(0,o.C)().instantiate(v.DataSourceClass,{instanceSettings:D}):T=new v.DataSourceClass(D),T.components=v.components,!(T instanceof t.mA)){const S=T;S.name=D.name,S.id=D.id,S.type=D.type,S.meta=D.meta,S.uid=D.uid,T.getRef=t.mA.prototype.getRef}return this.datasources[h]=T,this.datasources[T.uid]=T,T}catch(v){return v instanceof Error&&u.A.emit(n.r1.alertError,[D.name+" plugin failed",v.toString()]),Promise.reject({message:`Datasource: ${h} was not found`})}}getAll(){return Object.values(this.settingsMapByName)}getList(h={}){const D=Object.values(this.settingsMapByName).filter(C=>!(C.meta.id==="grafana"||C.meta.id==="mixed"||C.meta.id==="dashboard"||h.metrics&&!C.meta.metrics||h.tracing&&!C.meta.tracing||h.logs&&C.meta.category!=="logging"&&!C.meta.logs||h.annotations&&!C.meta.annotations||h.alerting&&!C.meta.alerting||h.pluginId&&!(0,s._)(h.pluginId,C.meta)||h.filter&&!h.filter(C)||h.type&&(Array.isArray(h.type)?!h.type.includes(C.type):h.type!==C.type)||!h.all&&C.meta.metrics!==!0&&C.meta.annotations!==!0&&C.meta.tracing!==!0&&C.meta.logs!==!0&&C.meta.alerting!==!0));if(h.variables)for(const C of this.templateSrv.getVariables()){if(C.type!=="datasource")continue;let T=C.current.value==="default"?this.defaultName:C.current.value;Array.isArray(T)&&(T=T[0]);const S=!Array.isArray(T)&&(this.settingsMapByName[T]||this.settingsMapByUid[T]);if(S){const O=`\${${C.name}}`;D.push({...S,isDefault:!1,name:O,uid:O})}}const v=D.sort((C,T)=>C.name.toLowerCase()>T.name.toLowerCase()?1:C.name.toLowerCase()<T.name.toLowerCase()?-1:0);if(!h.pluginId&&!h.alerting){if(h.mixed){const C=this.getInstanceSettings("-- Mixed --");C&&D.push(C)}if(h.dashboard){const C=this.getInstanceSettings("-- Dashboard --");C&&D.push(C)}if(!h.tracing){const C=this.getInstanceSettings("-- Grafana --");C&&D.push(C)}}return v}getExternal(){return this.getList()}getAnnotationSources(){return this.getList({annotations:!0,variables:!0}).map(h=>({name:h.name,value:h.name,meta:h.meta}))}getMetricSources(h){return this.getList({metrics:!0,variables:!h?.skipVariables}).map(D=>({name:D.name,value:D.name,meta:D.meta}))}async reload(){const h=await(0,m.AI)().get("/api/frontend/settings");d.Ay.datasources=h.datasources,d.Ay.defaultDatasource=h.defaultDatasource,this.init(h.datasources,h.defaultDatasource)}}function P(g){return(0,i.s9)(g)?i.dR.uid:typeof g=="string"?g:g?.uid}function a(g){return Array.isArray(g)?g[0]:g}const E=()=>(0,l.l)()},75462:(G,I,e)=>{"use strict";e.d(I,{$Y:()=>S,FF:()=>y,N9:()=>R,WW:()=>a,io:()=>b,nv:()=>h,ol:()=>v,pL:()=>A,yS:()=>P,yb:()=>g,yt:()=>C,z1:()=>f});var t=e(32196),n=e(2543),s=e.n(n),r=e(96540),o=e(16817),m=e(74135),l=e(13834),i=e(47232),u=e(37390),d=e(28138),p=e(27716),c=e(28444);function y(B){console.warn(`[Plugin Extensions] ${B}`)}function f(B){return typeof B=="object"&&"type"in B&&B.type===m.u.link}function P(B){return typeof B=="object"&&"type"in B&&B.type===m.u.component}function a(B){return typeof B=="object"&&"type"in B&&B.type===m.u.component&&B.extensionPointId.startsWith("capabilities/")}function E(B,U=""){return(...W)=>{try{return B(...W)}catch(N){N instanceof Error&&console.warn(`${U}${N.message}`)}}}function g(B,U){return{openModal:async N=>{const{title:w,body:L,width:V,height:K}=N;d.A.publish(new c.S8({component:h(B,D({title:w,body:L,width:V,height:K}))}))},context:U}}const h=(B,U)=>N=>{const{error:w,loading:L,value:V}=(0,o.A)(()=>(0,p.x)(B,{showErrorAlert:!1}));return L?null:w?(y(`Could not fetch plugin meta information for "${B}", aborting. (${w.message})`),null):V?r.createElement(l.a,{meta:V},r.createElement(U,{...N})):(y(`Fetched plugin meta information is empty for "${B}", aborting.`),null)},D=({title:B,body:U,width:W,height:N})=>{const w=(0,t.css)({width:W,height:N});return({onDismiss:V})=>r.createElement(u.a,{title:B,className:w,isOpen:!0,onDismiss:V,onClickBackdrop:V},r.createElement(U,{onDismiss:V}))};function v(B,U=new Map){if(!B||typeof B!="object"||Object.isFrozen(B))return B;const W=Array.isArray(B)?[...B]:{...B};if(U.has(B))return U.get(B);U.set(B,W);const N=Reflect.ownKeys(W);for(const w of N){const L=Array.isArray(W)?W[Number(w)]:W[w];L&&(typeof L=="object"||typeof L=="function")&&(Array.isArray(W)?W[Number(w)]=v(L,U):W[w]=v(L,U))}return Object.freeze(W)}function C(B,U){const W=`${B}${U.extensionPointId}${U.title}`;return Array.from(W).reduce((N,w)=>Math.imul(31,N)+w.charCodeAt(0)|0,0).toString()}const T=Symbol("isReadOnlyProxy");function S(B){if(!B||typeof B!="object"||x(B))return B;const U=new WeakMap;return new Proxy(B,{defineProperty:()=>!1,deleteProperty:()=>!1,isExtensible:()=>!1,set:()=>!1,get(W,N,w){if(N===T)return!0;const L=Reflect.get(W,N,w);return(0,i.Ar)(L)?(0,i.KQ)(L):(0,n.isObject)(L)||(0,n.isArray)(L)?(U.has(L)||U.set(L,S(L)),U.get(L)):L}})}function O(B){return typeof B=="object"&&B!==null}function x(B){return O(B)&&B[T]===!0}function b(B){const U={type:m.u.link,...B};return M(U),U}function M(B){if(B.type!==m.u.link)throw Error("config is not a extension link")}function A(B,U){return B.length<U?B:`${B.slice(0,U-3).trimEnd()}...`}function R(B){const U={},W=[];for(const w of B){const L=w.category;if(!L){W.push({text:A(w.title,25),href:w.path,onClick:w.onClick});continue}Array.isArray(U[L])||(U[L]=[]),U[L].push({text:A(w.title,25),href:w.path,onClick:w.onClick})}const N=Object.keys(U).reduce((w,L)=>(w.push({text:A(L,25),type:"group",subMenu:U[L]}),w),[]);return W.length>0&&(N.length>0&&N.push({text:"divider",type:"divider"}),Array.prototype.push.apply(N,W)),N}},15162:(G,I,e)=>{"use strict";e.d(I,{Kk:()=>d,PY:()=>p,TV:()=>l,d4:()=>u,f7:()=>f,oZ:()=>i});var t=e(65158),n=e(2913),s=e(41394),r=e(54427);const o={},m={};function l(P){const a=o[P];if(a)return a;const E=u(P);if(!E)throw new Error(`Plugin ${P} not found`);return o[P]=c(E),P!==E.type&&(o[E.type]=o[P]),o[P]}function i(P){return!!u(P)}function u(P){const a=n.Ay.panels[P];if(!a){for(const E of Object.values(n.Ay.panels))if(E.aliasIDs?.includes(P))return E}return a}function d(P){return c(P)}function p(P){return m[P]}function c(P){return(0,r.j4)({path:P.module,version:P.info?.version,isAngular:P.angular?.detected,pluginId:P.id}).then(a=>{if(a.plugin)return a.plugin;if(a.PanelCtrl){const E=new t.m(null);return E.angularPanelCtrl=a.PanelCtrl,E}throw new Error("missing export: plugin or PanelCtrl")}).then(a=>(a.meta=P,m[P.id]=a,!a.panel&&a.angularPanelCtrl&&(a.panel=y(a)),a)).catch(a=>(console.warn("Error loading panel plugin: "+P.id,a),(0,s.W)(P,a)))}let y=P=>null;function f(P){y=P}},81900:(G,I,e)=>{"use strict";e.d(I,{GD:()=>r,QO:()=>l,ni:()=>m,sk:()=>o});var t=e(27716),n=e(45179);const s={};function r({pluginId:u,version:d,isAngular:p}){const c=u;c&&!s[c]&&(s[c]={version:encodeURI(d),isAngular:p,pluginId:u})}function o(u){const d=u;s[d]&&delete s[d],(0,t.o)(u)}function m(u,d=n.x8){const p=i(u);if(!p)return`${u}?_cache=${d}`;const y=s[p]?.version||d;return`${u}?_cache=${y}`}function l(u){const d=i(u);if(d)return s[d]}function i(u){const d=Object.keys(s).find(p=>u.includes(p));if(d)return d}},45179:(G,I,e)=>{"use strict";e.d(I,{$b:()=>n,Bu:()=>s,XV:()=>t,x8:()=>r});const t="package",n=/^plugins.+\.css$/i,s=/^(text|application)\/(x-)?javascript(;|$)/,r=Date.now()},63770:(G,I,e)=>{"use strict";e.d(I,{z:()=>l});var t=e(59511),n=e.n(t),s=e(65024),r=e.n(s),o=e(35135),m=e.n(o);const l=window.System},94429:(G,I,e)=>{"use strict";e.d(I,{kB:()=>p,OD:()=>c,Av:()=>y});var t=e(32264),n=e(66161),s=e(45179),r=e(34867);const o=new WeakMap,m={};function l(f,P,a){const E={get(g,h){if(document.currentScript===null&&typeof h!="symbol"&&h.toString()!=="__useDefault"){const v=`${P}.${String(h)}`,C=`${v}`;m[C]||(m[C]=!0,(0,r.fH)(`Plugin using ${v}`,{key:String(h),parent:P,packageName:a}))}let D=Reflect.get(g,h);return D!==null&&typeof D=="object"&&!(D instanceof RegExp)?(o.has(D)||o.set(D,l(D,`${P}.${String(h)}`,a)),o.get(D)):(typeof D=="function"&&(D=D.bind(g)),D)}};return typeof f=="object"&&f!==null?new Proxy(f,E):f}const i=/^(@grafana|app\/)/;function u(f,P){return i.test(P)?l(f,P,P):f}var d=e(63770);function p(f){return Object.keys(f).reduce((P,a)=>{const E=`${s.XV}:${a}`,g=t.$.featureToggles.pluginsAPIMetrics?u(f[a],a):f[a];return d.z.set(E,g),n.s.set(a,f[a]),P[a]=E,P},{})}function c(f){return!!t.$.pluginsCDNBaseURL&&f.startsWith(t.$.pluginsCDNBaseURL)}function y(f){return f.startsWith("http")||f.startsWith("/")?f:`${t.$.appSubUrl??""}/${f}`}},27716:(G,I,e)=>{"use strict";e.d(I,{o:()=>r,x:()=>s});var t=e(17172);const n={};function s(o,m){const l=n[o];return l?Promise.resolve(l):(0,t.AI)().get(`/api/plugins/${o}/settings`,void 0,void 0,m).then(i=>(n[o]=i,i)).catch(i=>typeof i=="object"&&i!==null&&"status"in i&&i.status===403?(i.isHandled=!0,Promise.reject(i)):Promise.reject(new Error("Unknown Plugin")))}const r=o=>o?delete n[o]:Object.keys(n).forEach(m=>delete n[m])},54427:(G,I,e)=>{"use strict";e.d(I,{ui:()=>jg,cS:()=>Gg,j4:()=>Nc});var t={};e.r(t),e.d(t,{plugin:()=>ut});var n={};e.r(n),e.d(n,{plugin:()=>En});var s={};e.r(s),e.d(s,{plugin:()=>Ra});var r={};e.r(r),e.d(r,{plugin:()=>$r});var o={};e.r(o),e.d(o,{plugin:()=>Xi});var m={};e.r(m),e.d(m,{plugin:()=>$a});var l={};e.r(l),e.d(l,{plugin:()=>or});var i={};e.r(i),e.d(i,{plugin:()=>Ql});var u={};e.r(u),e.d(u,{plugin:()=>xu});var d={};e.r(d),e.d(d,{plugin:()=>Ml});var p={};e.r(p),e.d(p,{plugin:()=>zu});var c={};e.r(c),e.d(c,{plugin:()=>nm});var y={};e.r(y),e.d(y,{plugin:()=>im});var f={};e.r(f),e.d(f,{plugin:()=>dm});var P={};e.r(P),e.d(P,{plugin:()=>cc});var a={};e.r(a),e.d(a,{plugin:()=>Td});var E={};e.r(E),e.d(E,{plugin:()=>Wm});var g={};e.r(g),e.d(g,{plugin:()=>Jm});var h={};e.r(h),e.d(h,{plugin:()=>rf});var D={};e.r(D),e.d(D,{plugin:()=>vf});var v={};e.r(v),e.d(v,{plugin:()=>Pf});var C={};e.r(C),e.d(C,{plugin:()=>Sf});var T={};e.r(T),e.d(T,{plugin:()=>_d});var S=e(40187),O=e(41987),x=e(32264),b=e(96540),M=e(65158),A=e(67061),R=e(55852),B=e(85242),U=e(51612),W=e(31678),N=e(57220),w=e(2543),L=e.n(w),V=e(21594),K=e(14578),k=e(61410),j=e(23770),H=e(88467),J=e(94822),X=e(75214);const se=Y=>{const{onChange:ge,id:Pe,defaultValue:Le,dataSource:ze}=Y,et=(0,W.useDispatch)();(0,b.useEffect)(()=>{ze?ze&&et((0,j.mB)({rulesSourceName:ze})):et((0,j.nV)())},[et,ze]);const ot=(0,k.$)(qt=>qt.promRules),xt=(0,H.p0)(ot),Bt=(0,H.Vf)(ot),jt=(0,b.useMemo)(()=>{if((0,w.isEmpty)(ot))return[];if(!xt)return[];const qt=Object.keys(ot).flatMap(sn=>ot[sn].result??[]).flatMap(sn=>sn.groups).flatMap(sn=>sn.rules.filter(un=>un.type===J.JS.Alerting)).flatMap(sn=>sn.alerts??[]).map(sn=>Object.keys(sn.labels??{})).flatMap(sn=>sn.filter(un=>!(0,X.F2)(un)));return(0,w.uniq)(qt)},[xt,ot]);return b.createElement(V.KF,{id:Pe,isLoading:Bt,defaultValue:Le,"aria-label":"group by label keys",placeholder:"Group by",prefix:b.createElement(K.I,{name:"tag-alt"}),onChange:qt=>{ge(qt.map(sn=>sn.value??""))},options:jt.map(qt=>({label:qt,value:qt}))})};var ae=e(32196),ne=e(42941),q=e(94701),ee=e(3591),z=e(40845),te=e(40276),ie=e(37494),ce=e(39558),ue=e(42418),fe=e(2913),Te=e(55907),he=e(79938),de=e(75648),le=e(9518),pe=e(98164),ve=e(55740),be=e(23662),Oe=e(14792),Me=e(19073),Ue=e(64861),we=e(15458),Re=e(55127),Fe=e.n(Re),xe=e(2426),Ve=e(56361),$e=e(15054),Xe=e(54317);function gt(Y,ge){const Pe=(0,pe.J$)(Y);return(0,pe.Av)(ge,Pe)}function Dt(Y,ge){const{stateFilter:Pe,alertInstanceLabelFilter:Le}=Y;return(0,w.isEmpty)(Pe)?ge:ge.filter(ze=>(Pe.firing&&((0,Xe.S)(ze,J.Gi.Alerting)||(0,Xe.S)(ze,J.cF.Firing))||Pe.pending&&((0,Xe.S)(ze,J.Gi.Pending)||(0,Xe.S)(ze,J.cF.Pending))||Pe.noData&&(0,Xe.S)(ze,J.Gi.NoData)||Pe.normal&&(0,Xe.S)(ze,J.Gi.Normal)||Pe.error&&(0,Xe.S)(ze,J.Gi.Error)||Pe.inactive&&(0,Xe.S)(ze,J.cF.Inactive))&&(Le?gt(Y.alertInstanceLabelFilter,ze.labels):!0))}const nt=({rule:Y,alerts:ge,options:Pe,grafanaTotalInstances:Le,handleInstancesLimit:ze,limitInstances:et,grafanaFilteredInstancesTotal:ot})=>{const xt=Pe.groupMode===Ue.r6.Custom?!0:Pe.showInstances,[Bt,jt]=(0,b.useState)(xt),qt=(0,z.of)(at),sn=(0,z.of)(R.my),un=(0,b.useCallback)(()=>{jt(Qa=>!Qa)},[]),Zt=(0,b.useMemo)(()=>Dt(Pe,(0,Ve.Cp)(Pe.sortOrder,ge))??[],[ge,Pe]),vn=Le!==void 0,zn=Le&&ot?Le-ot:0,Un=ge.length-Zt.length,Kn=vn?zn:Un,Tn=Zt.length>0,Dn=Tn?un:w.noop;(0,b.useEffect)(()=>{Zt.length===0&&jt(!1)},[Zt]);const On=async()=>{ze&&(ze(!1),jt(!0))},ga=async()=>{ze&&(ze(!0),jt(!0))},ea=et?ot:Zt.length,aa=Zt.length,Gn=vn?ea:aa,An=et?`Showing ${de.Ys} of ${Le} instances`:`Showing all ${Le} instances`,ia=et?"View all instances":`Limit the result to ${de.Ys} instances`,Qn=Le&&de.Ys===Zt.length&&Le>Zt.length,jn=Le&&de.Ys<Zt.length&&!et,ka=Qn||jn?b.createElement("div",{className:qt.footerRow},b.createElement("div",null,An),b.createElement(R.$n,{size:"sm",variant:"secondary",onClick:et?On:ga},ia)):void 0;return b.createElement("div",null,Pe.groupMode===Ue.r6.Default&&b.createElement("button",{className:(0,ae.cx)(sn,Tn?qt.clickable:""),onClick:()=>Dn()},Tn&&b.createElement(K.I,{name:Bt?"angle-down":"angle-right",size:"md"}),b.createElement("span",null,`${Gn} ${Fe()("instance",Gn)}`),Kn>0&&b.createElement("span",null,", ",`${Kn} hidden by filters`)),Bt&&b.createElement(xe.D,{rule:Y,instances:Zt,pagination:{itemsPerPage:2*$e.FG},footerRow:ka}))},at=Y=>({clickable:(0,ae.css)`
    cursor: pointer;
  `,footerRow:(0,ae.css)`
    display: flex;
    flex-direction: column;
    gap: ${Y.spacing(1)};
    justify-content: space-between;
    align-items: center;
    width: 100%;
  `}),Ae="__ungrouped__",re=({rules:Y,options:ge})=>{const Pe=(0,z.of)(Qt),Le=ge.groupBy,ze=(0,b.useMemo)(()=>{const et=new Map,ot=jt=>Le?Ee(jt,Le):!0;Y.forEach(jt=>{const qt=(0,be.TU)(jt),sn=ot(jt);(qt?.alerts??[]).forEach(un=>{const Zt=sn?Z(Le,un.labels):Ae,vn=et.get(Zt)?.alerts??[];et.set(Zt,{rule:jt,alerts:[...vn,un]})})});const xt=et.get(Ae)?.alerts??[];return et.delete(Ae),et.set(Ae,{alerts:xt}),Array.from(et.entries()).reduce((jt,[qt,{rule:sn,alerts:un}])=>{const Zt=Dt(ge,un);return Zt.length>0&&jt.set(qt,{rule:sn,alerts:Zt}),jt},new Map)},[Le,Y,ge]);return b.createElement(b.Fragment,null,Array.from(ze).map(([et,{rule:ot,alerts:xt}])=>b.createElement("li",{className:Pe.alertRuleItem,key:et,"data-testid":et},b.createElement("div",null,b.createElement("div",{className:Pe.customGroupDetails},b.createElement("div",{className:Pe.alertLabels},et!==Ae&&oe(et).map(([Bt,jt])=>b.createElement(we.R,{key:Bt,labelKey:Bt,value:jt})),et===Ae&&"No grouping")),b.createElement(nt,{rule:ot,alerts:xt,options:ge})))))};function Z(Y,ge){return new URLSearchParams(Y.map(Pe=>[Pe,ge[Pe]])).toString()}function oe(Y){return[...new URLSearchParams(Y)]}function Ee(Y,ge){const Pe=(0,be.TU)(Y);return ge.every(Le=>(Pe?.alerts??[]).some(ze=>ze.labels[Le]))}const ye=re;var Se=e(87586),Be=e(70416),We=e(26058),Ke=e(18461),it=e(3704);function rt(Y){return Object.values(Y).filter(ge=>ge!==void 0).reduce((ge,Pe)=>ge+Pe,0)}const ft=({rules:Y,options:ge,handleInstancesLimit:Pe,limitInstances:Le,hideViewRuleLinkText:ze})=>{const et=(0,z.of)(Qt),ot=(0,z.of)(pt),{href:xt}=(0,Se.A)(),Bt=Y.length<=ge.maxItems?Y:Y.slice(0,ge.maxItems);return b.createElement(b.Fragment,null,b.createElement("ol",{className:et.alertRuleList},Bt.map((jt,qt)=>{const{namespaceName:sn,groupName:un,dataSourceName:Zt}=jt,vn=(0,be.Z8)(jt.promRule)?jt.promRule:void 0,zn=(0,be.Om)(vn),Un=(0,Ke.UP)(jt.dataSourceName,jt),Kn=(0,Ke.$9)(Un),Tn=jt.dataSourceName===N.hY?rt(jt.instanceTotals):void 0,Dn=jt.dataSourceName===N.hY?rt(jt.filteredInstanceTotals):void 0,On=(0,it.c)(`/alerting/${encodeURIComponent(Zt)}/${encodeURIComponent(Kn)}/view`,{returnTo:xt??""});return vn?b.createElement("li",{className:et.alertRuleItem,key:`alert-${sn}-${un}-${jt.name}-${qt}`},b.createElement("div",{className:ot.icon},b.createElement(K.I,{name:Te.A.getStateDisplayModel(vn.state).iconClass,className:ot[(0,be.Wy)(vn.state)],size:"lg"})),b.createElement("div",{className:et.alertNameWrapper},b.createElement("div",{className:et.instanceDetails},b.createElement(A.B,{direction:"row",gap:1},b.createElement("div",{className:et.alertName,title:jt.name},jt.name),b.createElement(We.h,null),On&&b.createElement("a",{href:On,target:"__blank",className:et.link,rel:"noopener","aria-label":"View alert rule"},b.createElement("span",{className:(0,ae.cx)({[et.hidden]:ze})},"View alert rule"),b.createElement(K.I,{name:"external-link-alt",size:"sm"}))),b.createElement("div",{className:et.alertDuration},b.createElement("span",{className:ot[(0,be.Wy)(vn.state)]},(0,be.XI)(vn.state))," ",zn&&vn.state!==J.cF.Inactive&&b.createElement(b.Fragment,null,"for"," ",b.createElement("span",null,(0,Be.dU)({start:zn,end:Date.now()}))))),b.createElement(nt,{rule:jt,alerts:vn.alerts??[],options:ge,grafanaTotalInstances:Tn,grafanaFilteredInstancesTotal:Dn,handleInstancesLimit:Pe,limitInstances:Le}))):null})))},pt=Y=>({common:(0,ae.css)`
    width: 70px;
    text-align: center;
    align-self: stretch;

    display: inline-block;
    color: white;
    border-radius: ${Y.shape.radius.default};
    font-size: ${Y.typography.bodySmall.fontSize};
    text-transform: capitalize;
    line-height: 1.2;
    flex-shrink: 0;

    display: flex;
    flex-direction: column;
    justify-content: center;
  `,icon:(0,ae.css)`
    margin-top: ${Y.spacing(2.5)};
    align-self: flex-start;
  `,good:(0,ae.css)`
    color: ${Y.colors.success.main};
  `,bad:(0,ae.css)`
    color: ${Y.colors.error.main};
  `,warning:(0,ae.css)`
    color: ${Y.colors.warning.main};
  `,neutral:(0,ae.css)`
    color: ${Y.colors.secondary.main};
  `,info:(0,ae.css)`
    color: ${Y.colors.primary.main};
  `}),Ge=ft;function qe(Y){const ge=(Pe,[Le,ze])=>ze?[...Pe,Le]:Pe;return Object.entries(Y).reduce(ge,[])}const bt=({dispatch:Y,limitInstances:ge,matcherList:Pe,dataSourceName:Le,stateList:ze})=>{Y(Le?(0,j.Lc)({rulesSourceName:Le,limitAlerts:ge?de.Ys:void 0,matcher:Pe,state:ze}):(0,j.yo)(!1,{limitAlerts:ge?de.Ys:void 0,matcher:Pe,state:ze}))};function Ft(Y){const ge=(0,W.useDispatch)(),[Pe,Le]=(0,ne.A)(!0),[,ze]=(0,Me.Ej)(Me.RY.ViewAlertRule),{usePrometheusRulesByNamespaceQuery:et}=he.hK,ot=(0,k.$)(Ea=>Ea.promRules),xt=(0,k.$)(Ea=>Ea.rulerRules),Bt=(0,H.t4)(ot),jt=Y.width<320;(0,b.useEffect)(()=>{Y.options.stateFilter.inactive===!0&&(Y.options.stateFilter.normal=!0),Y.options.stateFilter.inactive=void 0},[Y.options.stateFilter]);let qt;(0,q.A)(()=>{qt=(0,Oe.UA)().getCurrent()});const sn=(0,b.useMemo)(()=>qe(Y.options.stateFilter),[Y.options.stateFilter]),{options:un,replaceVariables:Zt}=Y,vn=un.datasource===N.vv?N.hY:un.datasource,zn={...Y.options,alertName:Zt(un.alertName),alertInstanceLabelFilter:Zt(un.alertInstanceLabelFilter)},Un=(0,b.useMemo)(()=>(0,pe.J$)(zn.alertInstanceLabelFilter),[zn.alertInstanceLabelFilter]),Kn=(!vn||vn===N.hY)&&ze,{currentData:Tn=[],isLoading:Dn,refetch:On}=et({limitAlerts:Pe?de.Ys:void 0,matcher:Un,state:sn},{skip:!Kn});(0,b.useEffect)(()=>{ot.loading||bt({dispatch:ge,limitInstances:Pe,matcherList:Un,dataSourceName:vn,stateList:sn});const Ea=qt?.events.subscribe(ee.sR,()=>{Kn&&On(),(!vn||vn!==N.hY)&&bt({dispatch:ge,limitInstances:Pe,matcherList:Un,dataSourceName:vn,stateList:sn})});return()=>{Ea?.unsubscribe()}},[ge,qt,Un,sn,Pe,vn,On,Kn,ot.loading]);const ga=Ea=>{Ea?(bt({dispatch:ge,limitInstances:Pe,matcherList:Un,dataSourceName:vn,stateList:sn}),Le(!0)):(bt({dispatch:ge,limitInstances:!1,matcherList:Un,dataSourceName:vn,stateList:sn}),Le(!1))},ea=(0,le.dy)(void 0,Tn),aa=(0,H.t4)(xt),Gn=(0,H.BU)(ot),An=Bt||aa,ia=(0,H.Vf)(ot),Qn=(0,z.of)(Qt),jn=(0,be.dS)(ea),ka=Y.options.sortOrder,Qa=(0,b.useMemo)(()=>Lt(Y,Xt(ka,jn)),[jn,ka,Y]),Ya=Qa.length===0?"No alerts matching filters":void 0,Ba=Dn||An&&ia&&!Gn,Ia=Object.values(ot).some(Ea=>Ea.result);return b.createElement(te.E,{autoHeightMin:"100%",autoHeightMax:"100%"},b.createElement("div",{className:Qn.container},Ia&&Ya&&b.createElement("div",{className:Qn.noAlertsMessage},Ya),Ia&&b.createElement("section",null,Y.options.viewMode===Ue.nE.Stat&&b.createElement(ie.yV,{width:Y.width,height:Y.height,graphMode:ie.$p.None,textMode:ie.SV.Auto,justifyMode:ie.F8.Auto,theme:fe.config.theme2,value:{text:`${Qa.length}`,numeric:Qa.length}}),Y.options.viewMode===Ue.nE.List&&Y.options.groupMode===Ue.r6.Custom&&b.createElement(ye,{rules:Qa,options:zn}),Y.options.viewMode===Ue.nE.List&&Y.options.groupMode===Ue.r6.Default&&b.createElement(Ge,{rules:Qa,options:zn,handleInstancesLimit:ga,limitInstances:Pe,hideViewRuleLinkText:jt})),Ba&&b.createElement(ce._,{text:"Loading..."})))}function Xt(Y,ge){if(Y===Ue.xB.Importance)return(0,w.sortBy)(ge,Le=>Te.A.alertStateSortScore[Le.state]);if(Y===Ue.xB.TimeAsc)return(0,w.sortBy)(ge,Le=>{const ze=(0,be.TU)(Le)??void 0;return(0,be.Om)(ze)||new Date});if(Y===Ue.xB.TimeDesc)return(0,w.sortBy)(ge,Le=>{const ze=(0,be.TU)(Le)??void 0;return(0,be.Om)(ze)||new Date}).reverse();const Pe=(0,w.sortBy)(ge,Le=>Le.name.toLowerCase());return Y===Ue.xB.AlphaDesc&&Pe.reverse(),Pe}function Lt(Y,ge){const{options:Pe,replaceVariables:Le}=Y;let ze=[...ge];if(Pe.dashboardAlerts){const et=(0,Oe.UA)().getCurrent()?.uid;ze=ze.filter(({annotations:ot={}})=>Object.entries(ot).some(([xt,Bt])=>xt===ve.YH.dashboardUID&&Bt===et))}if(Pe.alertName){const et=Le(Pe.alertName);ze=ze.filter(({name:ot})=>ot.toLocaleLowerCase().includes(et.toLocaleLowerCase()))}if(ze=ze.filter(et=>{const ot=(0,be.TU)(et);return ot?Pe.stateFilter.firing&&ot.state===J.cF.Firing||Pe.stateFilter.pending&&ot.state===J.cF.Pending||Pe.stateFilter.normal&&ot.state===J.cF.Inactive:!1}),Pe.folder&&(ze=ze.filter(et=>et.namespaceName===Pe.folder.title)),Pe.datasource){const et=Pe.datasource===N.vv;ze=ze.filter(et?({dataSourceName:ot})=>ot===N.hY:({dataSourceName:ot})=>ot===Pe.datasource)}return ze=ze.reduce((et,ot)=>{const xt=(0,be.TU)(ot);return(xt?Dt({stateFilter:Pe.stateFilter,alertInstanceLabelFilter:Le(Pe.alertInstanceLabelFilter)},xt.alerts??[]):[]).length&&et.push(ot),et},[]),ze}const Qt=Y=>({cardContainer:(0,ae.css)`
    padding: ${Y.spacing(.5)} 0 ${Y.spacing(.25)} 0;
    line-height: ${Y.typography.body.lineHeight};
    margin-bottom: 0px;
  `,container:(0,ae.css)`
    overflow-y: auto;
    height: 100%;
  `,alertRuleList:(0,ae.css)`
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    list-style-type: none;
  `,alertRuleItem:(0,ae.css)`
    display: flex;
    align-items: center;
    width: 100%;
    height: 100%;
    background: ${Y.colors.background.secondary};
    padding: ${Y.spacing(.5)} ${Y.spacing(1)};
    border-radius: ${Y.shape.radius.default};
    margin-bottom: ${Y.spacing(.5)};

    gap: ${Y.spacing(2)};
  `,alertName:(0,ae.css)`
    font-size: ${Y.typography.h6.fontSize};
    font-weight: ${Y.typography.fontWeightBold};

    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `,alertNameWrapper:(0,ae.css)`
    display: flex;
    flex: 1;
    flex-wrap: nowrap;
    flex-direction: column;

    min-width: 100px;
  `,alertLabels:(0,ae.css)`
    > * {
      margin-right: ${Y.spacing(.5)};
    }
  `,alertDuration:(0,ae.css)`
    font-size: ${Y.typography.bodySmall.fontSize};
  `,alertRuleItemText:(0,ae.css)`
    font-weight: ${Y.typography.fontWeightBold};
    font-size: ${Y.typography.bodySmall.fontSize};
    margin: 0;
  `,alertRuleItemTime:(0,ae.css)`
    color: ${Y.colors.text.secondary};
    font-weight: normal;
    white-space: nowrap;
  `,alertRuleItemInfo:(0,ae.css)`
    font-weight: normal;
    flex-grow: 2;
    display: flex;
    align-items: flex-end;
  `,noAlertsMessage:(0,ae.css)`
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
  `,alertIcon:(0,ae.css)`
    margin-right: ${Y.spacing(.5)};
  `,instanceDetails:(0,ae.css)`
    min-width: 1px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `,customGroupDetails:(0,ae.css)`
    margin-bottom: ${Y.spacing(.5)};
  `,link:(0,ae.css)`
    word-break: break-all;
    color: ${Y.colors.primary.text};
    display: flex;
    align-items: center;
    gap: ${Y.spacing(1)};
  `,hidden:(0,ae.css)`
    display: none;
  `});function an(Y){const[,ge]=(0,Me.Ej)(Me.RY.ViewAlertRule),[,Pe]=(0,Me.Ej)(Me.RY.ViewExternalAlertRule);return!ge&&!Pe?b.createElement(ue.F,{title:"Permission required"},"Sorry, you do not have the required permissions to read alert rules"):b.createElement(Ft,{...Y})}const ut=new M.m(an).setPanelOptions(Y=>{Y.addRadio({path:"viewMode",name:"View mode",description:"Toggle between list view and stat view",defaultValue:Ue.nE.List,settings:{options:[{label:"List",value:Ue.nE.List},{label:"Stat",value:Ue.nE.Stat}]},category:["Options"]}).addRadio({path:"groupMode",name:"Group mode",description:"How alert instances should be grouped",defaultValue:Ue.r6.Default,settings:{options:[{value:Ue.r6.Default,label:"Default grouping"},{value:Ue.r6.Custom,label:"Custom grouping"}]},category:["Options"]}).addCustomEditor({path:"groupBy",name:"Group by",description:"Filter alerts using label querying",id:"groupBy",defaultValue:[],showIf:ge=>ge.groupMode===Ue.r6.Custom,category:["Options"],editor:ge=>b.createElement(se,{id:ge.id??"groupBy",defaultValue:ge.value.map(Pe=>({label:Pe,value:Pe})),onChange:ge.onChange,dataSource:ge.context.options.datasource})}).addNumberInput({name:"Max items",path:"maxItems",description:"Maximum alerts to display",defaultValue:20,category:["Options"]}).addSelect({name:"Sort order",path:"sortOrder",description:"Sort order of alerts and alert instances",settings:{options:[{label:"Alphabetical (asc)",value:Ue.xB.AlphaAsc},{label:"Alphabetical (desc)",value:Ue.xB.AlphaDesc},{label:"Importance",value:Ue.xB.Importance},{label:"Time (asc)",value:Ue.xB.TimeAsc},{label:"Time (desc)",value:Ue.xB.TimeDesc}]},defaultValue:Ue.xB.AlphaAsc,category:["Options"]}).addBooleanSwitch({path:"dashboardAlerts",name:"Alerts linked to this dashboard",description:"Only show alerts linked to this dashboard",defaultValue:!1,category:["Options"]}).addTextInput({path:"alertName",name:"Alert name",description:"Filter for alerts containing this text",defaultValue:"",category:["Filter"]}).addTextInput({path:"alertInstanceLabelFilter",name:"Alert instance label",description:'Filter alert instances using label querying, ex: {severity="critical", instance=~"cluster-us-.+"}',defaultValue:"",category:["Filter"]}).addCustomEditor({path:"datasource",name:"Datasource",description:"Filter from alert source",id:"datasource",defaultValue:null,editor:function(Pe){return b.createElement(A.B,{gap:1},b.createElement(U.s,{...Pe,type:["prometheus","loki","grafana"],noDefault:!0,current:Pe.value,onChange:Le=>Pe.onChange(Le.name)}),b.createElement(R.$n,{variant:"secondary",onClick:()=>Pe.onChange(null)},"Clear"))},category:["Filter"]}).addCustomEditor({showIf:ge=>ge.datasource===N.vv||!ge.datasource,path:"folder",name:"Folder",description:"Filter for alerts in the selected folder (only for Grafana alerts)",id:"folder",defaultValue:null,editor:function(Pe){return b.createElement(B.sR,{enableReset:!0,showRoot:!1,allowEmpty:!0,initialTitle:Pe.value?.title,initialFolderUid:Pe.value?.uid,permissionLevel:W.PermissionLevelString.View,onClear:()=>Pe.onChange(""),...Pe})},category:["Filter"]}).addBooleanSwitch({path:"stateFilter.firing",name:"Alerting / Firing",defaultValue:!0,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.pending",name:"Pending",defaultValue:!0,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.noData",name:"No Data",defaultValue:!1,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.normal",name:"Normal",defaultValue:!1,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.error",name:"Error",defaultValue:!0,category:["Alert state filter"]})});var Nt=e(79924),ht=e(64423),Rt=e(71733),_t=e(26272),on=e(69129),ln=e(47232),bn=e(12131),In=e(17172),Mn=e(64149),vt=e(3911),nn=e(85918),cn=e(28138),mt=e(10860),lt=e(44522),Tt=e(56034);const Vt=({options:Y,annotation:ge,formatDate:Pe,onClick:Le,onAvatarClick:ze,onTagClick:et})=>{const ot=(0,z.of)(mn),{showUser:xt,showTags:Bt,showTime:jt}=Y,{text:qt="",login:sn,email:un,avatarUrl:Zt,tags:vn,time:zn,timeEnd:Un}=ge,Kn=()=>{Le(ge)},Tn=()=>{ze(ge)},Dn=sn&&xt,On=zn&&jt,ga=Un&&Un!==zn&&jt;return b.createElement(mt.Z,{className:ot.card,onClick:Kn},b.createElement(mt.Z.Heading,null,b.createElement(lt.I,{className:ot.heading,onClick:ea=>{ea.stopPropagation()},content:qt})),On&&b.createElement(mt.Z.Description,{className:ot.timestamp},b.createElement(rn,{formatDate:Pe,time:zn}),ga&&b.createElement(b.Fragment,null,b.createElement("span",{className:ot.time},"-"),b.createElement(rn,{formatDate:Pe,time:Un})," ")),Dn&&b.createElement(mt.Z.Meta,{className:ot.meta},b.createElement(zt,{email:un,login:sn,avatarUrl:Zt,onClick:Tn})),Bt&&vn&&b.createElement(mt.Z.Tags,null,b.createElement(Mn.L,{tags:vn,onClick:ea=>et(ea,!1)})))},zt=({onClick:Y,avatarUrl:ge,login:Pe,email:Le})=>{const ze=(0,z.of)(mn),et=xt=>{xt.stopPropagation(),Y()},ot=b.createElement("span",null,"Created by:",b.createElement("br",null)," ",Le);return b.createElement(Tt.m,{content:ot,theme:"info",placement:"top"},b.createElement("button",{onClick:et,className:ze.avatar},b.createElement("img",{src:ge,alt:"avatar icon"})))},rn=({time:Y,formatDate:ge})=>{const Pe=(0,z.of)(mn);return b.createElement("span",{className:Pe.time},b.createElement("span",null,ge(Y)))};function mn(Y){return{card:(0,ae.css)({gridTemplateAreas:'"Heading Description Meta Tags"',gridTemplateColumns:"auto 1fr auto auto",padding:Y.spacing(1),margin:Y.spacing(.5),width:"inherit"}),heading:(0,ae.css)({a:{zIndex:1,position:"relative",color:Y.colors.text.link,"&:hover":{textDecoration:"underline"}}}),meta:(0,ae.css)({margin:0,position:"relative",justifyContent:"end"}),timestamp:(0,ae.css)({margin:0,alignSelf:"center"}),time:(0,ae.css)({marginLeft:Y.spacing(1),marginRight:Y.spacing(1),fontSize:Y.typography.bodySmall.fontSize,color:Y.colors.text.secondary}),avatar:(0,ae.css)({border:"none",background:"inherit",margin:0,padding:Y.spacing(.5),img:{borderRadius:Y.shape.radius.circle,width:Y.spacing(2),height:Y.spacing(2)}})}}class dt extends b.PureComponent{constructor(ge){super(ge),this.style=wt(x.$.theme2),this.subs=new ht.yU,this.tagListRef=b.createRef(),this.onAnnoClick=async Pe=>{if(!Pe.time)return;const{options:Le}=this.props,et=(0,Oe.UA)().getCurrent(),ot={from:this._timeOffset(Pe.time,Le.navigateBefore,!0),to:this._timeOffset(Pe.timeEnd??Pe.time,Le.navigateAfter,!1),viewPanel:Le.navigateToPanel&&Pe.panelId?Pe.panelId:void 0};if(!Pe.dashboardUID||et?.uid===Pe.dashboardUID){bn.Ny.partial(ot);return}const xt=await(0,In.AI)().get("/api/search",{dashboardUIDs:Pe.dashboardUID});if(xt&&xt.length&&xt[0].uid===Pe.dashboardUID){const Bt=xt[0],jt=new URL(Bt.url,window.location.origin);jt.searchParams.set("from",String(ot.from)),jt.searchParams.set("to",String(ot.to)),bn.Ny.push(Rt.I.stripBaseFromUrl(jt.toString()));return}cn.A.emit(_t.r1.alertWarning,["Unknown Dashboard: "+Pe.dashboardUID])},this.onTagClick=(Pe,Le)=>{if(!Le&&this.state.queryTags.includes(Pe))return;const ze=Le?this.state.queryTags.filter(ot=>ot!==Pe):[...this.state.queryTags,Pe];let et;if(Le){const ot=document.activeElement,xt=ot?.getAttribute("data-tag-id");if(this.tagListRef.current?.contains(ot)&&xt){const Bt=Number.parseInt(xt,10),jt=this.tagListRef.current.querySelector(`[data-tag-id="${Bt+1}"]`)??this.tagListRef.current.querySelector(`[data-tag-id="${Bt-1}"]`);jt instanceof HTMLElement&&(et=jt)}}this.setState({queryTags:ze},()=>et?.focus())},this.onUserClick=Pe=>{this.setState({queryUser:{id:Pe.userId,login:Pe.login,email:Pe.email}})},this.onClearUser=()=>{this.setState({queryUser:void 0})},this.renderItem=(Pe,Le)=>{const{options:ze}=this.props,et=(0,Oe.UA)().getCurrent();return et?b.createElement(Vt,{annotation:Pe,formatDate:et.formatDate,onClick:this.onAnnoClick,onAvatarClick:this.onUserClick,onTagClick:this.onTagClick,options:ze}):b.createElement(b.Fragment,null)},this.state={annotations:[],timeInfo:"",loaded:!1,queryTags:[]}}componentDidMount(){this.doSearch(),this.subs.add(this.props.eventBus.getStream(on.We).subscribe({next:()=>{this.doSearch()}}))}componentWillUnmount(){this.subs.unsubscribe()}componentDidUpdate(ge,Pe){const{options:Le,timeRange:ze}=this.props;(Le!==ge.options||this.state.queryTags!==Pe.queryTags||this.state.queryUser!==Pe.queryUser||ge.renderCounter!==this.props.renderCounter||Le.onlyInTimeRange&&ze!==ge.timeRange)&&this.doSearch()}async doSearch(){const{options:ge}=this.props,{queryUser:Pe,queryTags:Le}=this.state,ze={tags:ge.tags,limit:ge.limit,type:"annotation"};ge.onlyFromThisDashboard&&(ze.dashboardUID=(0,Oe.UA)().getCurrent()?.uid);let et="";if(ge.onlyInTimeRange){const{timeRange:xt}=this.props;ze.from=xt.from.valueOf(),ze.to=xt.to.valueOf()}else et="All Time";Pe&&(ze.userId=Pe.id),ge.tags&&ge.tags.length&&(ze.tags=ge.tags.map(xt=>this.props.replaceVariables(xt))),Le.length&&(ze.tags=ze.tags?[...ze.tags,...Le]:Le);const ot=await(0,In.AI)().get("/api/annotations",ze,`anno-list-panel-${this.props.id}`);this.setState({annotations:ot,timeInfo:et,loaded:!0})}_timeOffset(ge,Pe,Le=!1){let ze=5,et="m";const ot=/^(\d+)(\w)/.exec(Pe);ot&&ot.length===3&&(ze=parseInt(ot[1],10),et=ot[2]);const xt=(0,ln.KQ)(ge);return Le&&(ze*=-1),xt.add(ze,et).valueOf()}render(){const{loaded:ge,annotations:Pe,queryUser:Le,queryTags:ze}=this.state;if(!ge)return b.createElement("div",null,"loading...");const et=Le||ze.length>0;return b.createElement(te.E,{autoHeightMin:"100%"},et&&b.createElement("div",{className:this.style.filter},b.createElement("b",null,"Filter:"),Le&&b.createElement(R.$n,{size:"sm",variant:"secondary",fill:"text",onClick:this.onClearUser,"aria-label":`Remove filter: ${Le.email}`},Le.email),ze.length>0&&b.createElement(Mn.L,{icon:"times",tags:ze,onClick:ot=>this.onTagClick(ot,!0),getAriaLabel:ot=>`Remove ${ot} tag`,className:this.style.tagList,ref:this.tagListRef})),Pe.length<1&&b.createElement("div",{className:this.style.noneFound},"No Annotations Found"),b.createElement(nn.p,{items:Pe,renderItem:this.renderItem,getItemKey:ot=>`${ot.id}`}))}}const wt=(0,vt.N)(Y=>({noneFound:(0,ae.css)({display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"calc(100% - 30px)"}),filter:(0,ae.css)({alignItems:"center",display:"flex",flexWrap:"wrap",gap:Y.spacing(.5),padding:Y.spacing(.5)}),tagList:(0,ae.css)({justifyContent:"flex-start","li > button":{paddingLeft:"3px"}})})),en={limit:10,navigateAfter:"10m",navigateBefore:"10m",navigateToPanel:!0,onlyFromThisDashboard:!1,onlyInTimeRange:!1,showTags:!0,showTime:!0,showUser:!0,tags:[]},En=new M.m(dt).setPanelOptions(Y=>{Y.addRadio({category:["Annotation query"],path:"onlyFromThisDashboard",name:"Query filter",defaultValue:en.onlyFromThisDashboard,settings:{options:[{value:!1,label:"All dashboards"},{value:!0,label:"This dashboard"}]}}).addRadio({category:["Annotation query"],path:"onlyInTimeRange",name:"Time range",defaultValue:en.onlyInTimeRange,settings:{options:[{value:!1,label:"None"},{value:!0,label:"This dashboard"}]}}).addCustomEditor({category:["Annotation query"],id:"tags",path:"tags",name:"Tags",description:"Match annotation tags",editor(ge){return b.createElement(Nt.u,{tags:ge.value,onChange:ge.onChange})}}).addNumberInput({category:["Annotation query"],path:"limit",name:"Limit",defaultValue:en.limit}).addBooleanSwitch({category:["Display"],path:"showUser",name:"Show user",defaultValue:en.showUser}).addBooleanSwitch({category:["Display"],path:"showTime",name:"Show time",defaultValue:en.showTime}).addBooleanSwitch({category:["Display"],path:"showTags",name:"Show tags",defaultValue:en.showTags}).addRadio({category:["Link behavior"],path:"navigateToPanel",name:"Link target",defaultValue:en.navigateToPanel,settings:{options:[{value:!0,label:"Panel"},{value:!1,label:"Dashboard"}]}}).addTextInput({category:["Link behavior"],path:"navigateBefore",name:"Time before",defaultValue:en.navigateBefore,description:""}).addTextInput({category:["Link behavior"],path:"navigateAfter",name:"Time after",defaultValue:en.navigateAfter,description:""})}).setPanelChangeHandler((Y,ge,Pe)=>ge==="ryantxu-annolist-panel"?Pe:Y.options);var yt=e(37055),At=e(24293),Kt=e(27310),Jt=e(47070),Mt=e(11261),Je=e(52622),Nn=e(52198),xn=e(38248),Fn=e(11404),wn=e(89654),Wn=e(22680),da=e(71242),oa=e(24882),_n=e(97152),Wa=e(29413),za=e(30501),_a=e(67266),Xa=e(81297),Va=e(77455),Cs=e(22731),ns=e(8066),Is=e(96516),ls=e(16895),ss=e(28895);function Fs(Y,ge){return ge[0].fields.slice(1).some(Pe=>!Pe.config.custom?.hideFrom?.legend)}const Ts=b.memo(({data:Y,placement:ge,calcs:Pe,displayMode:Le,colorField:ze,...et})=>{const ot=(0,z.$j)();if(ze!=null){const Bt=(0,ss.jY)([ze],ot);if(Bt?.length)return b.createElement(_a.KU.Legend,{placement:ge},b.createElement(Is.t,{placement:ge,items:Bt,displayMode:Le}))}const xt=Y[0].fields.slice(1).map((Bt,jt)=>{const sn=jt+1;if(!Bt||Bt.config.custom?.hideFrom?.legend)return;const un=Bt.state?.displayName??Bt.name,Zt=(0,ns.lz)(Bt,ot).color;return{disabled:Bt.state?.hideFrom?.viz,color:Zt,label:un,yAxis:Bt.config.custom?.axisPlacement===Je.vM.Right?2:1,getDisplayValues:()=>(0,ls.UO)(Pe,Bt,ot),getItemKey:()=>`${un}-0-${sn}`}}).filter(Bt=>Bt!==void 0);return b.createElement(_a.KU.Legend,{placement:ge,...et},b.createElement(Is.t,{placement:ge,items:xt,displayMode:Le,sortBy:et.sortBy,sortDesc:et.sortDesc,isSortable:!0}))});Ts.displayName="BarChartLegend";var Es=e(36613),gs=e(28240),ps=e(73060),js=e(57875),As=e(83195),Qr=e(73134),nr=e(51336),hr=e(52811),ar=e(82915),Yr=e(42994),Qs=e(72724),cs=e(23596),_s=e(39758),Ys=e(4134);const sr=Yr.WC.interval,Kr=_s.ur,io=_s.ur,Mo=8,cr=30,lo=.65,Jr=.1,co=.15,Rr=5,Ho=10,Xr=.1;function xo(Y,ge,Pe,Le,ze){const et=(0,Wa.kD)(Y,14),ot=ge/(et.width+2)*14,xt=Pe/Le,Bt=Math.min(xt,ot);return{fontSize:Math.min(Bt,ze??Bt),textMetrics:et}}function Ur(Y,ge){const{xOri:Pe,xDir:Le,rawValue:ze,getColor:et,formatValue:ot,formatShortValue:xt,fillOpacity:Bt=1,showValue:jt,xSpacing:qt=0,hoverMulti:sn=!1,timeZone:un="browser"}=Y,Zt=Pe===Je.Lt.Horizontal,vn=!Y.text?.valueSize,zn=Y.stacking!==Je.gs.None,Un=Y.stacking===Je.gs.Percent;let{groupWidth:Kn,barWidth:Tn,barRadius:Dn=0}=Y;zn&&([Kn,Tn]=[Tn,Kn]);let On;const ea=Array(30).fill(null);let aa;const Gn=la=>Array.from(la.data[0].map((sa,Ca)=>Ca)),An=qt===0?void 0:(la,sa)=>{const Ca=la.bbox.width,Ja=Le*(Zt?1:-1);let Ha=sa.length,qa=Ha-1,ms=0,Gs=Ca/Es.A.pxRatio,Br=Math.abs(Math.floor(Gs/qt));ms=Ha<Br?0:Math.ceil(Ha/Br);let Ei=sa.map((jr,yi)=>ms!==0&&(qt>0?yi:qa-yi)%ms>0?null:jr);return Ja===1?Ei:Ei.reverse()},ia=(la,sa,Ca,Ja,Ha)=>{if(Y.xTimeAuto){let qa=sr.year;return Ha<za.Zj.second?qa=sr.millisecond:Ha<za.Zj.minute?qa=sr.second:Ha<za.Zj.hour?qa=sr.minute:Ha<za.Zj.day?qa=sr.hour:Ha<za.Zj.month?qa=sr.day:Ha<za.Zj.year?qa=sr.month:qa=sr.year,sa.map(ms=>ms==null?"":(0,Qs.LE)(ms,{format:qa,timeZone:un}))}return sa.map(qa=>Zt?xt(0,qa):ot(0,qa))},Qn=(la,sa,Ca)=>{sa=0,Ca=Math.max(1,la.data[0].length-1);let Ja=0;(0,_s.mn)(la.data[0].length,Kn,Kr,0,(qa,ms,Gs)=>{Ja=ms+Gs/2});let Ha=Ca-sa;if(Ja===.5)sa-=Ha;else{let ms=(1/(1-Ja*2)*Ha-Ha)/2;sa-=ms,Ca+=ms}return[sa,Ca]};let jn=(la,sa)=>{let Ca=Array.from({length:sa},()=>({offs:Array(la).fill(0),size:Array(la).fill(0)}));return(0,_s.mn)(la,Kn,Kr,null,(Ja,Ha,qa)=>{(0,_s.mn)(sa,Tn,io,null,(ms,Gs,Br)=>{Ca[ms].offs[Ja]=Ha+qa*Gs,Ca[ms].size[Ja]=qa*Br})}),Ca},ka=(la,sa)=>{let Ca=Array.from({length:sa},()=>({offs:Array(la).fill(0),size:Array(la).fill(0)}));return(0,_s.mn)(la,Kn,Kr,null,(Ja,Ha,qa)=>{(0,_s.mn)(sa,Tn,io,null,(ms,Gs,Br)=>{Ca[ms].offs[Ja]=Ha,Ca[ms].size[Ja]=qa})}),Ca};const Qa=Zt?Jr:co,Ya=Zt?Rr:Ho;let Ba=[],Ia=[],Ea=1,ja,fs=Y.text?.valueSize??cr,Bs=Ya,Sa=1/0,ya=1/0,pa=et!=null,Ma=pa?{fill:{unit:3,values:(la,sa)=>Ia[sa].fill},stroke:{unit:3,values:(la,sa)=>Ia[sa].stroke}}:{},Za=Es.A.paths.bars({radius:Un?0:zn?(la,sa)=>sa===la.data.length-1?[Dn,0]:[0,0]:Dn,disp:{x0:{unit:2,values:(la,sa)=>Ba[sa].offs},size:{unit:2,values:(la,sa)=>Ba[sa].size},...Ma},each:(la,sa,Ca,Ja,Ha,qa,ms)=>{Ja-=la.bbox.left,Ha-=la.bbox.top;let Gs=la.data[sa][Ca];Zt?(Sa=Math.min(Sa,Gs<0?la.bbox.height-(Ha+ms):Ha),ya=qa):(Sa=ms,ya=Math.min(ya,Gs<0?Ja:la.bbox.width-(Ja+qa)));let Br={x:Ja,y:Ha,w:qa,h:ms,sidx:sa,didx:Ca};if(!zn&&Y.fullHighlight&&(Y.xOri===Je.Lt.Horizontal?(Br.y=0,Br.h=la.bbox.height):(Br.x=0,Br.w=la.bbox.width)),On.add(Br),jt!==Je.yL.Never){const Ei=ze(sa,Ca);let jr=1;Un&&xs[sa][Ca]&&(jr=xs[sa][Ca]);const yi=jr===0?0:Ei/jr,Dl=ot(sa,yi);if(Bs=Math.min(Bs,Math.round(Qa*(Zt?qa:ms))),ja[Ca]===void 0&&(ja[Ca]={}),ja[Ca][sa]={text:Dl,value:ze(sa,Ca),hidden:!1},vn){const{fontSize:Di,textMetrics:Ki}=xo(ja[Ca][sa].text,ya*(Zt?lo:1)-(Zt?0:Bs),Sa*(Zt?1:lo)-(Zt?Bs:0),1);ja[Ca][sa].textMetrics=Ki;let Sr=Math.round(Math.min(fs,cr,Di));Ea=Sr/fs*(Sr/14),fs=Sr}else ja[Ca][sa].textMetrics=(0,Wa.kD)(ja[Ca][sa].text,fs);let kl=Zt?0:-Math.round(Xr*fs),oo=ze(sa,Ca);if(Y.negY?.[sa]&&oo!=null&&(oo*=-1),oo!=null){const Di=la.bbox.left+(Zt?Ja+qa/2:oo<0?Ja-Bs:Ja+qa+Bs),Ki=la.bbox.top+(Zt?oo<0?Ha+ms+Bs:Ha-Bs:Ha+ms/2-kl),{textMetrics:Sr={width:1,actualBoundingBoxAscent:1,actualBoundingBoxDescent:1}}=ja[Ca][sa];let Pl=0,wc=0;Zt?(Pl=Sr.width*Ea/2,wc=oo>0?(Sr.actualBoundingBoxAscent+Sr.actualBoundingBoxDescent)*Ea:0):(wc=(Sr.actualBoundingBoxAscent+Sr.actualBoundingBoxDescent)*Ea/2,Pl=oo<0?Sr.width*Ea:0),ja[Ca][sa].x=Di,ja[Ca][sa].y=Ki,ja[Ca][sa].bbox={x:Di-Pl,y:Ki-wc,w:Sr.width*Ea,h:(Sr.actualBoundingBoxAscent+Sr.actualBoundingBoxDescent)*Ea}}}}});const rs=la=>{la.root.querySelectorAll(".u-cursor-pt").forEach(sa=>{sa.style.borderRadius="0",Y.fullHighlight&&(sa.style.zIndex="-1")})},vs={x:!1,y:!1,drag:{x:!1,y:!1},dataIdx:(la,sa)=>{if(sa===0){ea.fill(null),aa=null;let Ca=la.cursor.left*Es.A.pxRatio,Ja=la.cursor.top*Es.A.pxRatio;On.get(Ca,Ja,1,1,Ha=>{(0,Ys.ur)(Ca,Ja,Ha.x,Ha.y,Ha.x+Ha.w,Ha.y+Ha.h)&&(aa=ea[0]=Ha,ea[aa.sidx]=aa,sn&&(0,Ys.Tr)(On,void 0,aa.didx).forEach(qa=>{ea[qa.sidx]=qa}))})}return ea[sa]?.didx},points:{fill:"rgba(255,255,255,0.4)",bbox:(la,sa)=>{let Ca=ea[sa],Ja=Ca!=null;return{left:Ja?Ca.x/Es.A.pxRatio:-10,top:Ja?Ca.y/Es.A.pxRatio:-10,width:Ja?Ca.w/Es.A.pxRatio:0,height:Ja?Ca.h/Es.A.pxRatio:0}}},focus:{prox:1e3,dist:(la,sa)=>aa?.sidx===sa?0:1/0}},is=la=>{if(On=On||new Ys.C$(0,0,la.bbox.width,la.bbox.height),On.clear(),la.series.forEach(sa=>{sa._paths=null}),zn?Ba=[null,...ka(la.data[0].length,la.data.length-1)]:Ba=[null,...jn(la.data[0].length,la.data.length-1)],pa){Ia=[null];for(let sa=1;sa<la.data.length;sa++){let Ca=la.data[sa].map((Ja,Ha)=>Ja!=null?et(sa,Ha,Ja):null);Ia.push({fill:Bt<1?Ca.map(Ja=>Ja!=null?(0,cs.alpha)(Ja,Bt):null):Ca,stroke:Ca})}}ja={},fs=Y.text?.valueSize??cr,Bs=Ya,Sa=ya=1/0},Ms=la=>{if(jt===Je.yL.Never||fs<Mo)return;la.ctx.save(),la.ctx.fillStyle=ge.colors.text.primary,la.ctx.font=`${fs}px ${ge.typography.fontFamily}`;let sa,Ca;for(const Ja in ja){let Ha=!0;for(const qa in ja[Ja]){const ms=ja[Ja][qa],{text:Gs,x:Br=0,y:Ei=0}=ms;let{value:jr}=ms;Y.negY?.[qa]&&jr!=null&&(jr*=-1);let yi=Zt?"center":jr!==null&&jr<0?"right":"left",Dl=Zt?jr!==null&&jr<0?"top":"alphabetic":"middle";if(yi!==sa&&(la.ctx.textAlign=sa=yi),Dl!==Ca&&(la.ctx.textBaseline=Ca=Dl),jt===Je.yL.Always)la.ctx.fillText(Gs,Br,Ei);else if(jt===Je.yL.Auto){let{bbox:kl}=ms,oo=!1;if(kl==null)oo=!0,ms.hidden=!0;else if(!Ha)for(const Di in ja[Ja]){if(Di===qa)continue;const Ki=ja[Ja][Di],{bbox:Sr,hidden:Pl}=Ki;if(!Pl&&Sr&&(0,Ys.HY)(kl,Sr)){oo=!0,ms.hidden=!0;break}}Ha=!1,!oo&&la.ctx.fillText(Gs,Br,Ei)}}}la.ctx.restore()};let xs=null;function $s(la,sa){return xs=null,(0,ls.bq)(la[0],sa,({totals:Ca})=>{xs=Ca})}return{cursor:vs,xRange:Qn,xValues:ia,xSplits:Gn,hFilter:An,barsBuilder:Za,init:rs,drawClear:is,draw:Ms,prepData:$s}}const Js={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:Je.wV.Auto,showValue:Je.yL.Auto,stacking:Je.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},uo={fillOpacity:80,gradientMode:Je.on.None,lineWidth:1};function mo(Y,ge,Pe,Le,ze,et){if(Y.length===0||Y.every(jt=>jt.length===0))return{series:[],_rest:[],warn:"No data in response"};(0,gs.Fm)(Y),(0,gs.j2)(Y,ge);let ot={...Y[0]};const xt=ot.fields.findIndex(jt=>jt.type===Mt.PU.time);xt>=0&&Y.length>1&&(ot=(0,ps.Fd)({frames:Y,keepDisplayNames:!0})??ot);const Bt=ot.fields.find(jt=>jt.state?.displayName===ze||jt.name===ze)??ot.fields.find(jt=>jt.type===Mt.PU.string)??ot.fields[xt];if(Bt!=null){const jt=[Bt],qt=[],sn=et==null?void 0:ot.fields.find(vn=>vn.state?.displayName===et||vn.name===et);ot.fields.forEach(vn=>{if(vn!==Bt)if(vn.type===Mt.PU.number&&!vn.config.custom?.hideFrom?.viz){const zn={...vn,values:vn.values.map(Un=>Number.isFinite(Un)?Un:null),config:{...vn.config,custom:{...vn.config.custom,stacking:{group:"_",mode:Pe}}}};jt.push(zn)}else qt.push(vn)});let un=null;jt.length===1&&(un="No numeric fields found"),ot.fields=jt;const Zt=[ot];return(0,ar.O2)(Zt,Le,0),{series:Zt,_rest:qt,color:sn,warn:un}}return{series:[],_rest:[],color:null,warn:"Bar charts requires a string or time field"}}const fo=({series:Y,color:ge,orientation:Pe,options:Le,timeZone:ze,theme:et})=>{let{showValue:ot,groupWidth:xt,barWidth:Bt,barRadius:jt=0,stacking:qt,text:sn,tooltip:un,xTickLabelRotation:Zt,xTickLabelMaxLength:vn,xTickLabelSpacing:zn=0,legend:Un,fullHighlight:Kn}=Le,Tn=Y[0];const Dn=new nr.e,On=Tn.fields.map((Ba,Ia)=>qt===Je.gs.Percent?(0,js.J)({field:{...Ba,config:{...Ba.config,unit:"percentunit"}},theme:et}):Ba.display),ga=(Ba,Ia)=>(0,As.cN)(On[Ba](Ia)),ea=(Ba,Ia)=>Vr(ga(Ba,Ia),vn),aa=vr(Pe);Tn.fields.length===2&&(xt=Bt,Bt=1);const Gn=(Ba,Ia)=>Tn.fields[Ba].values[Ia];let An,ia=1;if(ge!=null){const Ba=ge.display;ia=(ge.config.custom.fillOpacity??100)/100,An=(Ia,Ea)=>Ba(ge.values[Ea]).color}else Tn.fields.some(Ia=>Ia.config.custom?.gradientMode===Je.on.Scheme&&Ia.config.color?.mode===Qr.Yb.Thresholds||Ia.config.mappings?.some(ja=>ja.type==="value"?Object.values(ja.options).some(fs=>fs.color!=null):ja.options.result.color!=null))&&(ia=(Tn.fields.find(Ea=>Ea.type===Mt.PU.number).config.custom.fillOpacity??100)/100,An=(Ea,ja)=>{let fs=Tn.fields[Ea];return fs.display(fs.values[ja]).color});const Qn={xOri:aa.xOri,xDir:aa.xDir,groupWidth:xt,barWidth:Bt,barRadius:jt,stacking:qt,rawValue:Gn,getColor:An,fillOpacity:ia,formatValue:ga,formatShortValue:ea,timeZone:ze,text:sn,showValue:ot,legend:Un,xSpacing:zn,xTimeAuto:Tn.fields[0]?.type===Mt.PU.time&&!Tn.fields[0].config.unit?.startsWith("time:"),negY:Tn.fields.map(Ba=>Ba.config.custom?.transform===Je.NU.NegativeY),fullHighlight:Kn,hoverMulti:un.mode===Je.$N.Multi},jn=Ur(Qn,et);if(Dn.setCursor(jn.cursor),Dn.addHook("init",jn.init),Dn.addHook("drawClear",jn.drawClear),Dn.addHook("draw",jn.draw),Zt!==0){let Ba=50,Ia=aa.xOri===Je.Lt.Horizontal?14:5;Dn.setPadding(Oo(Tn,Zt,vn,Ba,Ia))}Dn.setPrepData(jn.prepData),Dn.addScale({scaleKey:"x",isTime:!1,range:jn.xRange,distribution:Je.L4.Ordinal,orientation:aa.xOri,direction:aa.xDir});const ka=Tn.fields[0]?.config.custom?.axisPlacement!==Je.vM.Hidden?aa.xOri===Je.Lt.Horizontal?Je.vM.Bottom:Je.vM.Left:Je.vM.Hidden,Qa=Tn.fields[0]?.config.custom?.axisPlacement!==Je.vM.Hidden;Dn.addAxis({scaleKey:"x",isTime:!1,placement:ka,label:Tn.fields[0]?.config.custom?.axisLabel,splits:jn.xSplits,filter:aa.xOri===0?jn.hFilter:void 0,values:jn.xValues,timeZone:ze,grid:{show:!1},ticks:{show:!1},gap:15,tickLabelRotation:aa.xOri===0?Zt*-1:0,theme:et,show:Qa});for(let Ba=1;Ba<Tn.fields.length;Ba++){const Ia=Tn.fields[Ba],Ea={...uo,...Ia.config.custom},ja=Ia.config.unit||hr.s,fs=(0,ns.Qi)(Ia),Sa=(0,ns.lz)(Ia,et).color;let ya=Ea.axisSoftMin,pa=Ea.axisSoftMax;if(ya==null&&Ia.config.min==null&&(ya=0),pa==null&&Ia.config.max==null&&(pa=0),Ea.thresholdsStyle&&Ia.config.thresholds&&(Ea.thresholdsStyle.mode??Je.Ly.Off)!==Je.Ly.Off&&Dn.addThresholds({config:Ea.thresholdsStyle,thresholds:Ia.config.thresholds,scaleKey:ja,theme:et,hardMin:Ia.config.min,hardMax:Ia.config.max,softMin:Ea.axisSoftMin,softMax:Ea.axisSoftMax}),Dn.addSeries({scaleKey:ja,pxAlign:!0,lineWidth:Ea.lineWidth,lineColor:Sa,fillOpacity:Ea.fillOpacity,theme:et,colorMode:fs,pathBuilder:jn.barsBuilder,show:!Ea.hideFrom?.viz,gradientMode:Ea.gradientMode,thresholds:Ia.config.thresholds,hardMin:Ia.config.min,hardMax:Ia.config.max,softMin:Ea.axisSoftMin,softMax:Ea.axisSoftMax}),Dn.addScale({scaleKey:ja,min:Ia.config.min,max:Ia.config.max,softMin:ya,softMax:pa,centeredZero:Ea.axisCenteredZero,orientation:aa.yOri,direction:aa.yDir,distribution:Ea.scaleDistribution?.type,log:Ea.scaleDistribution?.log}),Ea.axisPlacement!==Je.vM.Hidden){let Ma=Ea.axisPlacement;(!Ma||Ma===Je.vM.Auto)&&(Ma=Je.vM.Left),aa.xOri===1&&(Ma===Je.vM.Left&&(Ma=Je.vM.Bottom),Ma===Je.vM.Right&&(Ma=Je.vM.Top));let Za={scaleKey:ja,label:Ea.axisLabel,size:Ea.axisWidth,placement:Ma,formatValue:(rs,vs)=>(0,As.cN)(Ia.display(rs,vs)),filter:aa.yOri===0?jn.hFilter:void 0,tickLabelRotation:aa.xOri===1?Zt*-1:0,theme:et,grid:{show:Ea.axisGridShow}};Ea.axisBorderShow&&(Za.border={show:!0}),Ea.axisColorMode===Je.Y$.Series&&(Za.color=Sa),Dn.addAxis(Za)}}let Ya=(0,ls.ro)(Tn);return Dn.setStackingGroups(Ya),{builder:Dn,prepData:(Ba,Ia)=>(Y=Ba,Tn=Y[0],ge=Ia,Dn.prepData(Y))}};function Vr(Y,ge){return Y.length>ge?Y.substring(0,ge).concat("..."):Y}function Oo(Y,ge,Pe,Le=0,ze=0){const et=Y.fields[0].values,ot=za.pi,xt=Y.fields[0].display,Bt=Zt=>xt?xt(et[Zt]):et[Zt];let jt=0;for(let Zt=0;Zt<et.length;Zt++){let vn=(0,Wa.kD)(Vr((0,As.cN)(Bt(Zt)),Pe),ot);jt=vn.width>jt?vn.width:jt}const qt=ge>0?Math.cos(ge*Math.PI/180)*(0,Wa.kD)(Vr((0,As.cN)(Bt(et.length-1)),Pe),ot).width:0,sn=ge<0?Math.cos(ge*-1*Math.PI/180)*(0,Wa.kD)(Vr((0,As.cN)(Bt(0)),Pe),ot).width:0,un=Math.sin((ge>=0?ge:ge*-1)*Math.PI/180)*jt-ze;return[Math.round(za.pi*Es.A.pxRatio),qt,un,Math.max(0,sn-Le)]}function vr(Y){return Y===Je.wV.Vertical?{xOri:Je.Lt.Horizontal,xDir:Je.ON.Right,yOri:Je.Lt.Vertical,yDir:Je.ON.Up}:{xOri:Je.Lt.Vertical,xDir:Je.ON.Down,yOri:Je.Lt.Horizontal,yDir:Je.ON.Right}}const Pt=(0,Wa.kD)("M",za.pi).width,Gt=Math.PI/180,Pn=Y=>{const{data:ge,options:Pe,fieldConfig:Le,width:ze,height:et,timeZone:ot,id:xt}=Y,Bt=(0,z.$j)(),{barWidth:jt,barRadius:qt=0,showValue:sn,groupWidth:un,stacking:Zt,legend:vn,tooltip:zn,text:Un,xTickLabelRotation:Kn,xTickLabelSpacing:Tn,fullHighlight:Dn,xField:On,colorByField:ga}=Pe;let{orientation:ea,xTickLabelMaxLength:aa=0}=Pe;ea=ea===Jt.wV.Auto?ze<et?Jt.wV.Horizontal:Jt.wV.Vertical:ea,aa=Kn===0?1/0:aa||Math.floor(et/2/Math.sin(Math.abs(Kn*Gt))/Pt-3);const Gn=(0,b.useMemo)(()=>mo(ge.series,Le,Zt,Bt,On,ga),[ge.series,Le,Zt,Bt,On,ga]),An=(0,b.useMemo)(()=>Gn.series.map(Ba=>({...Ba,fields:Ba.fields.filter((Ia,Ea)=>Ea===0||!Ia.state?.hideFrom?.viz)})),[Gn.series]),ia=An[0]?.length??0,Qn=An[0]?.fields.length??0;let{builder:jn,prepData:ka}=(0,b.useMemo)(()=>ia===0?{builder:null,prepData:null}:fo({series:An,color:Gn.color,orientation:ea,options:Pe,timeZone:ot,theme:Bt}),[ea,ot,Y.data.structureRev,Qn,ia,jt,qt,sn,un,Zt,vn,zn,Un?.valueSize,Kn,Tn,Dn,On,ga,aa]);const Qa=(0,b.useMemo)(()=>ka==null?[]:ka(An,Gn.color),[ka,An,Gn.color]);if(Gn.warn!=null||jn==null)return b.createElement(_n.a,{panelId:xt,fieldConfig:Le,data:ge,message:Gn.warn??"",needsNumberField:!0});const Ya=vn.showLegend&&Fs(jn,Gn.series)?b.createElement(Ts,{data:Gn.series,colorField:Gn.color,...vn}):null;return b.createElement(_a.KU,{width:Y.width,height:Y.height,legend:Ya},(Ba,Ia)=>b.createElement(Xa.Z,{config:jn,data:Qa,width:Ba,height:Ia},Y.options.tooltip.mode!==Je.$N.None&&b.createElement(Va.xl,{config:jn,maxWidth:Pe.tooltip.maxWidth,hoverMode:Pe.tooltip.mode===Je.$N.Single?Va.b3.xOne:Va.b3.xAll,render:(Ea,ja,fs,Bs,Sa,ya)=>b.createElement(Cs.k,{series:An[0],_rest:Gn._rest,dataIdxs:ja,seriesIdx:fs,mode:Pe.tooltip.mode,sortOrder:Pe.tooltip.sort,isPinned:Bs,maxHeight:Pe.tooltip.maxHeight})})))};var hn=e(66864),Ln=e(94354),Hn=e(10880);const kn=[{label:"None",value:0,description:"Show all tick marks"},{label:"Small",value:100,description:"Require 100px spacing"},{label:"Medium",value:200,description:"Require 200px spacing"},{label:"Large",value:300,description:"Require 300px spacing"}],xa=Y=>{let ge=Y.value??0;const Pe=ge<0;Pe&&(ge*=-1);let Le=kn[0];for(const ot of kn)if(Le=ot,ge<=Le.value)break;const ze=ot=>{Y.onChange(ot*(Pe?-1:1))},et=()=>{Y.onChange(Y.value*-1)};return b.createElement(hn.Gy,null,b.createElement(Ln.z,{value:Le.value,options:kn,onChange:ze}),ge!==0&&b.createElement(Tt.m,{content:"Require space from the right side",placement:"top"},b.createElement("div",null,b.createElement(Hn.S,{value:Pe,onChange:et,label:"RTL"}))))},ua=(Y,ge,Pe,Le)=>{if(ge==="graph"){const ze=Pe.angular;if(ze.xaxis?.mode==="series"){const et=Y.transformations||[];et.push({id:"reduce",options:{reducers:ze.xaxis?.values??["sum"]}}),Y.transformations=et}}return{}};var ra=e(38824);class os{getListWithDefaults(ge){return ge.getListAppender({name:ra.m.BarChart,pluginId:"barchart",options:{showValue:Je.yL.Never,legend:{calcs:[],displayMode:Je.lm.List,showLegend:!0,placement:"right"}},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:Pe=>{Pe.options.barWidth=.8}}})}getSuggestionsForData(ge){const Pe=this.getListWithDefaults(ge),{dataSummary:Le}=ge;Le.frameCount===1&&(!Le.hasNumberField||!Le.hasStringField||Le.rowCountTotal>50||(Pe.append({name:ra.m.BarChart}),Le.numberFieldCount>1&&(Pe.append({name:ra.m.BarChartStacked,options:{stacking:Je.gs.Normal}}),Pe.append({name:ra.m.BarChartStackedPercent,options:{stacking:Je.gs.Percent}})),Pe.append({name:ra.m.BarChartHorizontal,options:{orientation:Jt.wV.Horizontal}}),Le.numberFieldCount>1&&(Pe.append({name:ra.m.BarChartHorizontalStacked,options:{stacking:Je.gs.Normal,orientation:Jt.wV.Horizontal}}),Pe.append({name:ra.m.BarChartHorizontalStackedPercent,options:{orientation:Jt.wV.Horizontal,stacking:Je.gs.Percent}}))))}}const Ra=new M.m(Pn).setPanelChangeHandler(ua).useFieldConfig({standardOptions:{[yt.uo.Color]:{settings:{byValueSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:At.Y.PaletteClassic}}},useCustomConfig:Y=>{const ge=uo;Y.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:ge.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:ge.fillOpacity,settings:{min:0,max:100,step:1}}).addRadio({path:"gradientMode",name:"Gradient mode",defaultValue:Nn.t.fillGradient[0].value,settings:{options:Nn.t.fillGradient}}),Y.addSelect({category:["Graph styles"],name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:Je.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:Je.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),Y.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:Je.Ly.Off},settings:{options:Nn.t.thresholdsDisplayModes},editor:oa.D,override:oa.D,process:Kt.hS,shouldApply:()=>!0}),xn.r(Y,ge,!1),Fn.e(Y)}}).setPanelOptions(Y=>{Y.addFieldNamePicker({path:"xField",name:"X Axis",settings:{placeholderText:"First string or time field"}}).addRadio({path:"orientation",name:"Orientation",settings:{options:[{value:Jt.wV.Auto,label:"Auto"},{value:Jt.wV.Horizontal,label:"Horizontal"},{value:Jt.wV.Vertical,label:"Vertical"}]},defaultValue:Js.orientation}).addSliderInput({path:"xTickLabelRotation",name:"Rotate x-axis tick labels",defaultValue:Js.xTickLabelRotation,settings:{min:-90,max:90,step:15,marks:{"-90":"-90\xB0","-45":"-45\xB0",0:"0\xB0",45:"45\xB0",90:"90\xB0"},included:!1}}).addNumberInput({path:"xTickLabelMaxLength",name:"X-axis tick label max length",description:"X-axis labels will be truncated to the length provided",settings:{placeholder:"None",min:0},showIf:ge=>ge.xTickLabelRotation!==0}).addCustomEditor({id:"xTickLabelSpacing",path:"xTickLabelSpacing",name:"X-axis labels minimum spacing",defaultValue:Js.xTickLabelSpacing,editor:xa}).addRadio({path:"showValue",name:"Show values",settings:{options:[{value:Je.yL.Auto,label:"Auto"},{value:Je.yL.Always,label:"Always"},{value:Je.yL.Never,label:"Never"}]},defaultValue:Js.showValue}).addRadio({path:"stacking",name:"Stacking",settings:{options:Nn.t.stacking},defaultValue:Js.stacking}).addSliderInput({path:"groupWidth",name:"Group width",defaultValue:Js.groupWidth,settings:{min:0,max:1,step:.01},showIf:(ge,Pe)=>ge.stacking&&ge.stacking!==Je.gs.None?!1:es(Pe)!==1}).addSliderInput({path:"barWidth",name:"Bar width",defaultValue:Js.barWidth,settings:{min:0,max:1,step:.01}}).addSliderInput({path:"barRadius",name:"Bar radius",defaultValue:Js.barRadius,settings:{min:0,max:.5,step:.05}}).addBooleanSwitch({path:"fullHighlight",name:"Highlight full area on hover",defaultValue:Js.fullHighlight,showIf:ge=>ge.stacking===Je.gs.None}),Y.addFieldNamePicker({path:"colorByField",name:"Color by field",description:"Use the color value for a sibling field to color each bar value."}),wn.D(Y),Wn.H(Y),da.I(Y,!1)}).setSuggestionsSupplier(new os);function es(Y){let ge=0;if(Y)for(const Pe of Y)for(const Le of Pe.fields)Le.type===Mt.PU.number&&ge++;return ge}var zs=e(63250),Ws=e(23799);const Rs=Y=>(0,zs._$)(Y);var xr=e(58384),dr=e(17516);class Us{getSuggestionsForData(ge){const{dataSummary:Pe}=ge;if(!Pe.hasData||!Pe.hasNumberField)return;const Le=ge.getListAppender({name:"",pluginId:"bargauge",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}});Pe.numberFieldCount>50||(Pe.hasStringField&&Pe.frameCount===1&&Pe.rowCountTotal<30?(Le.append({name:ra.m.BarGaugeBasic,options:{reduceOptions:{values:!0,calcs:[]},displayMode:Je.eX.Basic,orientation:Jt.wV.Horizontal},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}}),Le.append({name:ra.m.BarGaugeLCD,options:{reduceOptions:{values:!0,calcs:[]},displayMode:Je.eX.Lcd,orientation:Jt.wV.Horizontal},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}})):(Le.append({name:ra.m.BarGaugeBasic,options:{displayMode:Je.eX.Basic,orientation:Jt.wV.Horizontal,reduceOptions:{values:!1,calcs:["lastNotNull"]}},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}}),Le.append({name:ra.m.BarGaugeLCD,options:{displayMode:Je.eX.Lcd,orientation:Jt.wV.Horizontal,reduceOptions:{values:!1,calcs:["lastNotNull"]}},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}})))}}const $r=new M.m(xr.d).useFieldConfig().setPanelOptions(Y=>{(0,Ws.L)(Y),(0,Ws.h)(Y),da.I(Y),Y.addRadio({path:"displayMode",name:"Display mode",settings:{options:[{value:Je.eX.Gradient,label:"Gradient"},{value:Je.eX.Lcd,label:"Retro LCD"},{value:Je.eX.Basic,label:"Basic"}]},defaultValue:dr.K.displayMode}).addRadio({path:"valueMode",name:"Value display",settings:{options:[{value:Je.$l.Color,label:"Value color"},{value:Je.$l.Text,label:"Text color"},{value:Je.$l.Hidden,label:"Hidden"}]},defaultValue:dr.K.valueMode}).addRadio({path:"namePlacement",name:"Name placement",settings:{options:[{value:Je.TZ.Auto,label:"Auto"},{value:Je.TZ.Top,label:"Top"},{value:Je.TZ.Left,label:"Left"}]},defaultValue:dr.K.namePlacement,showIf:ge=>ge.orientation!==Jt.wV.Vertical}).addBooleanSwitch({path:"showUnfilled",name:"Show unfilled area",description:"When enabled renders the unfilled region as gray",defaultValue:dr.K.showUnfilled,showIf:ge=>ge.displayMode!=="lcd"}).addRadio({path:"sizing",name:"Bar size",settings:{options:[{value:Je.T6.Auto,label:"Auto"},{value:Je.T6.Manual,label:"Manual"}]},defaultValue:dr.K.sizing}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:dr.K.minVizWidth,settings:{min:0,max:300,step:1},showIf:ge=>ge.sizing===Je.T6.Manual&&(ge.orientation===Jt.wV.Auto||ge.orientation===Jt.wV.Vertical)}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:dr.K.minVizHeight,settings:{min:0,max:300,step:1},showIf:ge=>ge.sizing===Je.T6.Manual&&(ge.orientation===Jt.wV.Auto||ge.orientation===Jt.wV.Horizontal)}).addSliderInput({path:"maxVizHeight",name:"Max height",description:"Maximum row height (horizontal orientation)",defaultValue:dr.K.maxVizHeight,settings:{min:0,max:300,step:1},showIf:ge=>ge.sizing===Je.T6.Manual&&(ge.orientation===Jt.wV.Auto||ge.orientation===Jt.wV.Horizontal)})}).setPanelChangeHandler(zs.gl).setMigrationHandler(Rs).setSuggestionsSupplier(new Us);var ks=e(41706),Ka=e(79041),ys=e(23117),Er=e(68268),ds=e(24182),Zr=e(30249),go=e(74863),Io=e(55129);const Ao=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),Go=Array(53);for(let Y=0;Y<Go.length;Y++)Go[Y]=2**Y;const _i=(Y,ge=1)=>Y==null?"-":Y.toFixed(ge),bi={drawStyle:Je.GR.Line,showPoints:Je.yL.Auto,axisPlacement:Je.vM.Auto},ur=({frame:Y,theme:ge,timeZones:Pe,getTimeRange:Le,allFrames:ze,renderers:et,tweakScale:ot=qt=>qt,tweakAxis:xt=qt=>qt,hoverProximity:Bt,orientation:jt=Je.wV.Horizontal})=>{const qt=jt!==Je.wV.Vertical,sn=new nr.e(Pe[0]);let un;sn.setPrepData(Gn=>(un=Gn[0],(0,ls.bq)(Gn[0],sn.getStackingGroups())));const Zt=Y.fields[0];if(!Zt)return sn;const vn="x";let zn="";const Un=Zt.config.custom?.axisPlacement===Je.vM.Hidden?Je.vM.Hidden:qt?Je.vM.Bottom:Je.vM.Left,Kn=Zt.config.custom?.axisPlacement!==Je.vM.Hidden;if(Zt.type===Mt.PU.time){sn.addScale({scaleKey:vn,orientation:qt?Je.Lt.Horizontal:Je.Lt.Vertical,direction:qt?Je.ON.Right:Je.ON.Up,isTime:!0,range:()=>{const An=Le();return[An.from.valueOf(),An.to.valueOf()]}});const Gn=Pe.length>1?(An,ia)=>qt?ia.map((Qn,jn)=>jn<2?null:Qn):ia:void 0;for(let An=0;An<Pe.length;An++){const ia=Pe[An];sn.addAxis({scaleKey:vn,isTime:!0,placement:Un,show:Kn,label:Zt.config.custom?.axisLabel,timeZone:ia,theme:ge,grid:{show:An===0&&Zt.config.custom?.axisGridShow},filter:Gn})}Pe.length>1&&sn.addHook("drawAxes",An=>{An.ctx.save();let ia=0;An.axes.forEach(Qn=>{if(qt&&Qn.side===2){An.ctx.fillStyle=ge.colors.text.primary,An.ctx.textAlign="left",An.ctx.textBaseline="bottom";let jn=Qn._pos+Qn._size;An.ctx.fillText(Pe[ia],An.bbox.left,jn*Es.A.pxRatio),ia++}}),An.ctx.restore()})}else sn.addScale({scaleKey:vn,orientation:qt?Je.Lt.Horizontal:Je.Lt.Vertical,direction:qt?Je.ON.Right:Je.ON.Up,range:(Gn,An,ia)=>[Zt.config.min??An,Zt.config.max??ia]}),sn.addAxis({scaleKey:vn,placement:Un,show:Kn,label:Zt.config.custom?.axisLabel,theme:ge,grid:{show:Zt.config.custom?.axisGridShow},formatValue:(Gn,An)=>(0,As.cN)(Zt.display(Gn,An))});let Tn=et?.flatMap(Gn=>Object.values(Gn.fieldMap).filter(An=>Gn.indicesOnly.indexOf(An)===-1))??[],Dn;for(let Gn=1;Gn<Y.fields.length;Gn++){const An=Y.fields[Gn],ia={...An.config,custom:{...bi,...An.config.custom}},Qn=ia.custom;if(An===Zt||An.type!==Mt.PU.number&&An.type!==Mt.PU.enum)continue;let jn=An.display??_i;An.config.custom?.stacking?.mode===Je.gs.Percent&&(jn=(0,js.J)({field:{...An,config:{...An.config,unit:"percentunit"}},theme:ge}));const ka=(0,Io.M)(ia,An.type),Qa=(0,ns.Qi)(An),Ba=(0,ns.lz)(An,ge).color;if(sn.addScale(ot({scaleKey:ka,orientation:qt?Je.Lt.Vertical:Je.Lt.Horizontal,direction:qt?Je.ON.Up:Je.ON.Right,distribution:Qn.scaleDistribution?.type,log:Qn.scaleDistribution?.log,linearThreshold:Qn.scaleDistribution?.linearThreshold,min:An.config.min,max:An.config.max,softMin:Qn.axisSoftMin,softMax:Qn.axisSoftMax,centeredZero:Qn.axisCenteredZero,range:Qn.stacking?.mode===Je.gs.Percent?(ya,pa,Ma)=>(pa=pa<0?-1:0,Ma=Ma>0?1:0,[pa,Ma]):An.type===Mt.PU.enum?(ya,pa,Ma)=>[-1,An.config.type.enum.text.length]:void 0,decimals:An.config.decimals},An)),zn||(zn=ka),Qn.axisPlacement!==Je.vM.Hidden){let ya;Qn.axisColorMode===Je.Y$.Series&&(Qa.isByValue&&An.config.custom?.gradientMode===Je.on.Scheme&&Qa.id===At.Y.Thresholds?ya=(0,go.pl)(1,ge,Qa,An.config.thresholds):ya=Ba);const pa={border:{show:Qn.axisBorderShow||!1,width:1/devicePixelRatio,stroke:ya||ge.colors.text.primary},ticks:{show:Qn.axisBorderShow||!1,stroke:ya||ge.colors.text.primary},color:ya||ge.colors.text.primary};let Ma,Za,rs;if(Ao.has(ia.unit))Ma=Go;else if(An.type===Mt.PU.enum){let vs=An.config.type.enum.text;rs=vs.map((is,Ms)=>Ms),Za=vs}sn.addAxis(xt({scaleKey:ka,label:Qn.axisLabel,size:Qn.axisWidth,placement:qt?Qn.axisPlacement??Je.vM.Auto:Je.vM.Bottom,formatValue:(vs,is)=>(0,As.cN)(jn(vs,is)),theme:ge,grid:{show:Qn.axisGridShow},decimals:An.config.decimals,distr:Qn.scaleDistribution?.type,splits:rs,values:Za,incrs:Ma,...pa},An))}const Ia=Qn.drawStyle===Je.GR.Points?Je.yL.Always:Qn.showPoints;let Ea=()=>null;Qn.spanNulls!==!0&&(Ea=(ya,pa,Ma,Za)=>{let rs=[],vs=ya.series[pa];if(!Ma&&Za&&Za.length){const[is,Ms]=vs.idxs,xs=ya.data[0],$s=ya.data[pa],la=Math.round(ya.valToPos(xs[is],"x",!0)),sa=Math.round(ya.valToPos(xs[Ms],"x",!0));Za[0][0]===la&&rs.push(is);for(let Ca=0;Ca<Za.length;Ca++){let Ja=Za[Ca],Ha=Za[Ca+1];if(Ha&&Ja[1]===Ha[0]){let qa=ya.posToIdx(Ja[1],!0);if($s[qa]==null)for(let ms=1;ms<100;ms++){if($s[qa+ms]!=null){qa+=ms;break}if($s[qa-ms]!=null){qa-=ms;break}}rs.push(qa)}}Za[Za.length-1][1]===sa&&rs.push(Ms)}return rs.length?rs:null});let{fillOpacity:ja}=Qn,fs=null,Bs=null;if(An.state?.origin){Dn||(Dn=ri(Y,ze));const ya=ze[An.state.origin.frameIndex],pa=ya?.fields[An.state.origin.fieldIndex],Ma=(0,gs.Ct)(pa??An,ya,ze);if(Tn.indexOf(Ma)>=0)fs=()=>null,Bs=()=>{};else if(Qn.transform===Je.NU.Constant){const Za=Es.A.paths.linear();fs=(rs,vs)=>{const is=rs._data,Ms=Le();let xs=[Ms.from.valueOf(),Ms.to.valueOf()],$s=is[vs].find(Ca=>Ca!=null),la=[$s,$s],sa=is.slice();return sa[0]=xs,sa[vs]=la,Za({...rs,_data:sa},vs,0,1)}}if(Qn.fillBelowTo){const Za=Y.fields.find(Ms=>Qn.fillBelowTo===Ms.name||Qn.fillBelowTo===Ms.config?.displayNameFromDS||Qn.fillBelowTo===(0,gs.Ct)(Ms,Y,ze)),rs=Za?(0,gs.Ct)(Za,Y,ze):Qn.fillBelowTo,vs=Dn.get(Ma),is=Dn.get(rs);(0,w.isNumber)(is)&&(0,w.isNumber)(vs)?(sn.addBand({series:[vs,is],fill:void 0}),ja||(ja=35)):ja=0}}let Sa;Qa.id===At.Y.Thresholds&&(Sa=ya=>(0,ns.lz)(un.fields[ya],ge).color),sn.addSeries({pathBuilder:fs,pointsBuilder:Bs,scaleKey:ka,showPoints:Ia,pointsFilter:Ea,colorMode:Qa,fillOpacity:ja,theme:ge,dynamicSeriesColor:Sa,drawStyle:Qn.drawStyle,lineColor:Qn.lineColor??Ba,lineWidth:Qn.lineWidth,lineInterpolation:Qn.lineInterpolation,lineStyle:Qn.lineStyle,barAlignment:Qn.barAlignment,barWidthFactor:Qn.barWidthFactor,barMaxWidth:Qn.barMaxWidth,pointSize:Qn.pointSize,spanNulls:Qn.spanNulls||!1,show:!Qn.hideFrom?.viz,gradientMode:Qn.gradientMode,thresholds:ia.thresholds,hardMin:An.config.min,hardMax:An.config.max,softMin:Qn.axisSoftMin,softMax:Qn.axisSoftMax,dataFrameFieldIndex:An.state?.origin}),Qn.thresholdsStyle&&ia.thresholds&&(Qn.thresholdsStyle.mode??Je.Ly.Off)!==Je.Ly.Off&&sn.addThresholds({config:Qn.thresholdsStyle,thresholds:ia.thresholds,scaleKey:ka,theme:ge,hardMin:An.config.min,hardMax:An.config.max,softMin:Qn.axisSoftMin,softMax:Qn.axisSoftMax})}let On=(0,ls.ro)(Y);sn.setStackingGroups(On),et?.forEach(Gn=>{Dn||(Dn=ri(Y,ze));let An={};for(let ia in Gn.fieldMap){let Qn=Gn.fieldMap[ia];An[ia]=Dn.get(Qn)}Gn.init(sn,An)});const ga=15;let aa={hover:{prox:(Gn,An,ia)=>Bt??(Gn.data[An][ia]===null?ga:null),skip:[null]},focus:{prox:Bt??30}};return sn.setCursor(aa),sn};function ri(Y,ge){const Pe=new Map;return Y.fields.forEach((Le,ze)=>{const et=Le.state?.origin;if(et){const ot=ge[et.frameIndex]?.fields[et.fieldIndex];ot&&Pe.set((0,gs.Ct)(ot,ge[et.frameIndex],ge),ze)}}),Pe}const zi=["legend","options","theme"];class Ss extends b.Component{constructor(){super(...arguments),this.prepConfig=(ge,Pe,Le)=>{const{theme:ze,timeZone:et,options:ot,renderers:xt,tweakAxis:Bt,tweakScale:jt}=this.props;return ur({frame:ge,theme:ze,timeZones:Array.isArray(et)?et:[et],getTimeRange:Le,allFrames:Pe,renderers:xt,tweakScale:jt,tweakAxis:Bt,hoverProximity:ot?.tooltip?.hoverProximity,orientation:ot?.orientation})},this.renderLegend=ge=>{const{legend:Pe,frames:Le}=this.props;return!ge||Pe&&!Pe.showLegend||!(0,ds.t)(ge,Le)?null:b.createElement(ds.$,{data:Le,config:ge,...Pe})}}render(){return b.createElement(Zr.o,{...this.props,prepConfig:this.prepConfig,propsToDiff:zi,renderLegend:this.renderLegend})}}const po=(0,z.cV)(Ss);po.displayName="TimeSeries";var Ro=e(62567),Ci=e(78226),Lo=e(34743),Bo=e(36376),jo=e(7315),Nr=e(13544),Ns=e(17464),oi=e(74007),ki=e(25469);function Ti(Y){const ge={position:"relative",top:"auto",right:"auto",marginRight:0};return b.createElement("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",paddingBottom:"6px"}},b.createElement(ki.J,{onClick:Y.onClick,style:Y.style??ge}))}const Hi=({timeZone:Y,dataFrame:ge,dataFrameFieldIndex:Pe,config:Le,exemplarColor:ze,clickedExemplarFieldIndex:et,setClickedExemplarFieldIndex:ot})=>{const xt=(0,z.of)(Si),[Bt,jt]=(0,b.useState)(!1),[qt,sn]=(0,b.useState)(!1),un=[(0,Lo.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,Lo.BN)()],{context:Zt,refs:vn,floatingStyles:zn}=(0,Bo.we)({open:Bt,placement:"bottom",onOpenChange:jt,middleware:un,whileElementsMounted:jo.ll,strategy:"fixed"}),Un=(0,Bo.s9)(Zt),Kn=(0,Bo.Mk)(Zt,{handleClose:(0,Bo.iB)(),enabled:et===void 0}),{getReferenceProps:Tn,getFloatingProps:Dn}=(0,Bo.bv)([Un,Kn]);(0,b.useEffect)(()=>{et?.fieldIndex===Pe.fieldIndex&&et?.frameIndex===Pe.frameIndex||sn(!1)},[et,Pe]);const On=()=>{const An=[b.createElement("rect",{fill:ze,key:"diamond",x:"3.38672",width:"4.78985",height:"4.78985",transform:"rotate(45 3.38672 0)"}),b.createElement("path",{fill:ze,key:"x",d:"M1.94444 3.49988L0 5.44432L1.55552 6.99984L3.49996 5.05539L5.4444 6.99983L6.99992 5.44431L5.05548 3.49988L6.99983 1.55552L5.44431 0L3.49996 1.94436L1.5556 0L8.42584e-05 1.55552L1.94444 3.49988Z"}),b.createElement("path",{fill:ze,key:"triangle",d:"M4 0L7.4641 6H0.535898L4 0Z"}),b.createElement("rect",{fill:ze,key:"rectangle",width:"5",height:"5"}),b.createElement("path",{fill:ze,key:"pentagon",d:"M3 0.5L5.85317 2.57295L4.76336 5.92705H1.23664L0.146831 2.57295L3 0.5Z"}),b.createElement("path",{fill:ze,key:"plus",d:"m2.35672,4.2425l0,2.357l1.88558,0l0,-2.357l2.3572,0l0,-1.88558l-2.3572,0l0,-2.35692l-1.88558,0l0,2.35692l-2.35672,0l0,1.88558l2.35672,0z"})];return An[Pe.frameIndex%An.length]},ga=()=>{sn(!0)},ea=(0,b.useCallback)(()=>{const An=ge.fields.filter(Ya=>Ya.config.links?.length&&Ya.config.links?.length>0)||[],ia=[...An,...ge.fields.filter(Ya=>!An.includes(Ya))],Qn=()=>{sn(!1),jt(!1),ot(void 0)};let jn=[],ka=[];ia.map((Ya,Ba)=>{const Ia=Ya.values[Pe.fieldIndex];Ya.config.links?.length&&ka?.push(...Ya.getLinks?.({valueRowIndex:Pe.fieldIndex})||[]);const Ea=Ya.display?Ya.display(Ia):{text:`${Ia}`,numeric:+Ia};jn.push({name:Ya.name,value:Ia,valueString:(0,As.cN)(Ea),highlight:!1})});const Qa={position:"relative",top:"35px",right:"5px",marginRight:0};return b.createElement("div",{className:xt.tooltip,ref:vn.setFloating,style:zn,...Dn()},qt&&b.createElement(Ti,{onClick:Qn,style:Qa}),b.createElement(oi.i,{displayValues:jn,links:ka}))},[ge.fields,Pe,xt,qt,ot,zn,Dn,vn.setFloating]),aa=Le.getSeries().find(An=>An.props.dataFrameFieldIndex?.frameIndex===Pe.frameIndex)?.props.lineColor,Gn=()=>{ot(Pe),ga()};return b.createElement(b.Fragment,null,b.createElement("div",{ref:vn.setReference,className:xt.markerWrapper,"data-testid":Nr.Tp.components.DataSource.Prometheus.exemplarMarker,role:"button",tabIndex:0,...Tn(),onClick:Gn,onKeyDown:An=>{An.key==="Enter"&&Gn()}},b.createElement("svg",{viewBox:"0 0 7 7",width:"7",height:"7",style:{fill:aa},className:(0,ae.cx)(xt.marble,(Bt||qt)&&xt.activeMarble)},On())),(Bt||qt)&&b.createElement(Ns.ZL,null,ea()))},Si=Y=>{const ge=Y.isDark?Y.v1.palette.dark2:Y.v1.palette.white,Pe=Y.isDark?Y.v1.palette.dark9:Y.v1.palette.gray5,Le=Y.isDark?Y.v1.palette.black:Y.v1.palette.white,ze=Y.isDark?Y.v1.palette.dark3:Y.v1.palette.gray6;return{markerWrapper:(0,ae.css)({padding:"0 4px 4px 4px",width:"8px",height:"8px",boxSizing:"content-box",transform:"translate3d(-50%, 0, 0)","&:hover":{"> svg":{transform:"scale(1.3)",opacity:1,filter:"drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))"}}}),marker:(0,ae.css)({width:0,height:0,borderLeft:"4px solid transparent",borderRight:"4px solid transparent",borderBottom:`4px solid ${Y.v1.palette.red}`,pointerEvents:"none"}),wrapper:(0,ae.css)({background:ge,border:`1px solid ${Pe}`,borderRadius:Y.shape.borderRadius(2),boxShadow:`0 0 20px ${Le}`,padding:Y.spacing(1)}),exemplarsTable:(0,ae.css)({width:"100%","tr td":{padding:"5px 10px",whiteSpace:"nowrap",borderBottom:`4px solid ${Y.components.panel.background}`},tr:{backgroundColor:Y.colors.background.primary,"&:nth-child(even)":{backgroundColor:ze}}}),valueWrapper:(0,ae.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",columnGap:Y.spacing(1),"> span":{flexGrow:0},"> *":{flex:"1 1",alignSelf:"center"}}),tooltip:(0,ae.css)({background:"none",padding:0,overflowY:"auto",maxHeight:"95vh"}),header:(0,ae.css)({background:Pe,padding:"6px 10px",display:"flex"}),title:(0,ae.css)({fontWeight:Y.typography.fontWeightMedium,paddingRight:Y.spacing(2),overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),body:(0,ae.css)({fontWeight:Y.typography.fontWeightMedium,borderRadius:Y.shape.borderRadius(2),overflow:"hidden"}),marble:(0,ae.css)({display:"block",opacity:.5,[Y.transitions.handleMotion("no-preference")]:{transition:"transform 0.15s ease-out"}}),activeMarble:(0,ae.css)({transform:"scale(1.3)",opacity:1,filter:"drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))"})}},Mi=({exemplars:Y,timeZone:ge,config:Pe,visibleSeries:Le})=>{const ze=(0,b.useRef)(),[et,ot]=(0,b.useState)();(0,b.useLayoutEffect)(()=>{Pe.addHook("init",jt=>{ze.current=jt})},[Pe]);const xt=(0,b.useCallback)((jt,qt)=>{const sn=jt.fields.find(Kn=>Kn.name===Mt.LE),un=jt.fields.find(Kn=>Kn.name===Mt.Bc);if(!sn||!un||!ze.current)return;const Zt=Object.keys(ze.current.scales).find(Kn=>!["x","y"].some(Tn=>Tn===Kn))??hr.s,vn=ze.current.scales[Zt].min,zn=ze.current.scales[Zt].max;let Un=un.values[qt.fieldIndex];return vn!=null&&Un<vn&&(Un=vn),zn!=null&&Un>zn&&(Un=zn),{x:ze.current.valToPos(sn.values[qt.fieldIndex],"x"),y:ze.current.valToPos(Un,Zt)}},[]),Bt=(0,b.useCallback)((jt,qt)=>{const sn=Le!==void 0?wr(Le,jt,qt):!0,un=Le!==void 0?ii(jt,qt,Le):void 0;return sn?b.createElement(Hi,{setClickedExemplarFieldIndex:ot,clickedExemplarFieldIndex:et,timeZone:ge,dataFrame:jt,dataFrameFieldIndex:qt,config:Pe,exemplarColor:un}):b.createElement(b.Fragment,null)},[Pe,ge,Le,ot,et]);return b.createElement(Ci.a,{config:Pe,id:"exemplars",events:Y,renderEventMarker:Bt,mapEventToXYCoords:xt})},Gi=(Y,ge)=>{const Pe=Y.series.filter(ze=>ze.props.show),Le=[];return ge?.length&&Pe.forEach(ze=>{const et=ze.props?.dataFrameFieldIndex?.frameIndex,ot=ze.props?.dataFrameFieldIndex?.fieldIndex;if(et!==void 0&&ot!==void 0){const xt=ge[et]?.fields[ot];xt?.labels&&Le.push({labels:xt.labels,color:ze.props?.lineColor??""})}}),{labels:Le,totalSeriesCount:Y.series.length}},ii=(Y,ge,Pe)=>{let Le;return Pe.labels.some(ze=>{const et=Object.keys(ze.labels),ot=Y.fields.filter(xt=>et.find(Bt=>Bt===xt.name));return ot.length&&ot.every((Bt,jt,qt)=>{const sn=Bt.values[ge.fieldIndex];return ze.labels[Bt.name]===sn})?(Le=ze.color,!0):!1}),Le},wr=(Y,ge,Pe)=>{let Le=!1;return Y.labels.length===Y.totalSeriesCount?Le=!0:Y.labels.some(ze=>{const et=Object.keys(ze.labels);if(Object.keys(ze.labels).length===0)Le=!0;else{const ot=ge.fields.filter(xt=>et.find(Bt=>Bt===xt.name));ot.length&&(Le=Y.labels.some(xt=>Object.keys(xt.labels).every(Bt=>{const jt=xt.labels[Bt];return ot.find(qt=>qt.values[Pe.fieldIndex]===jt)})))}return Le}),Le};var ho=e(7874),Uo=e(55794),Qo=e.n(Uo);const qr=({step:Y,y:ge,dragBounds:Pe,mapPositionToValue:Le,formatValue:ze,onChange:et})=>{const ot=(0,z.$j)();let xt=ge,Bt="none";ge<(Pe.top??0)&&(Bt="top"),ge>(Pe.bottom??0)+22&&(Bt="bottom"),Bt==="bottom"&&(xt=Pe.bottom??ge),Bt==="top"&&(xt=Pe.top??ge);const jt=typeof et!="function",qt=(0,z.of)(ji,Y,Bt,jt),[sn,un]=(0,b.useState)(Y.value),Zt=(0,b.useMemo)(()=>ot.colors.getContrastText(ot.visualization.getColorByName(Y.color)),[Y.color,ot]);return b.createElement(Qo(),{axis:"y",grid:[1,1],disabled:jt,onStop:jt?w.noop:(vn,zn)=>(et(Le(zn.lastY)),!1),onDrag:(vn,zn)=>un(Le(zn.lastY)),position:{x:0,y:xt},bounds:Pe},b.createElement("div",{className:qt.handle,style:{color:Zt}},b.createElement("span",{className:qt.handleText},ze(sn))))};qr.displayName="ThresholdDragHandle";const ji=(Y,ge,Pe,Le)=>{const ze=Y.visualization.getColorByName(ge.color),et=No(Pe),ot=Pe!=="none";return{handle:(0,ae.css)`
      display: flex;
      align-items: center;
      position: absolute;
      left: 0;
      width: calc(100% - 9px);
      height: 18px;
      margin-top: -9px;
      border-color: ${ze};
      cursor: ${Le?"initial":"grab"};
      border-top-right-radius: ${Y.shape.radius.default};
      border-bottom-right-radius: ${Y.shape.radius.default};
      ${ot&&(0,ae.css)`
        margin-top: 0;
        border-radius: ${Y.shape.radius.default};
      `}
      background: ${ze};
      font-size: ${Y.typography.bodySmall.fontSize};
      &:before {
        ${et};
      }
    `,handleText:(0,ae.css)`
      text-align: center;
      width: 100%;
      display: block;
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    `}};function No(Y){const ge=Y==="none",Pe=Le=>(0,ae.css)`
    content: '';
    position: absolute;

    bottom: 0;
    top: 0;
    width: 0;
    height: 0;
    left: 0;

    border-right-style: solid;
    border-right-width: ${Le}px;
    border-right-color: inherit;
    border-top: ${Le}px solid transparent;
    border-bottom: ${Le}px solid transparent;
  `;return ge?(0,ae.css)`
      ${Pe(9)};
      left: -9px;
    `:Y==="top"?(0,ae.css)`
      ${Pe(5)};
      left: calc(50% - 2.5px);
      top: -7px;
      transform: rotate(90deg);
    `:Y==="bottom"?(0,ae.css)`
      ${Pe(5)};
      left: calc(50% - 2.5px);
      top: calc(100% - 2.5px);
      transform: rotate(-90deg);
    `:""}const xi=60,Yo=({config:Y,fieldConfig:ge,onThresholdsChange:Pe})=>{const Le=(0,b.useRef)(),[ze,et]=(0,b.useState)(0);(0,b.useLayoutEffect)(()=>{Y.setPadding([0,xi,0,0]),Y.addHook("init",xt=>{Le.current=xt}),Y.addHook("draw",()=>{et(xt=>xt+1)})},[Y]);const ot=(0,b.useMemo)(()=>{const xt=Le.current;if(!xt)return null;const Bt=ge.defaults.thresholds;if(!Bt)return null;const jt=(0,Io.M)(ge.defaults,Mt.PU.number),qt=ge.defaults.decimals,sn=[];for(let un=0;un<Bt.steps.length;un++){const Zt=Bt.steps[un],vn=xt.valToPos(Zt.value,jt);if(Number.isNaN(vn)||!Number.isFinite(vn))continue;const zn=xt.bbox.height/window.devicePixelRatio,Kn=typeof Pe=="function"?Dn=>{const On=[...Bt.steps.slice(0,un),...Bt.steps.slice(un+1),{...Bt.steps[un],value:Dn}].sort((ga,ea)=>ga.value-ea.value);Pe({...Bt,steps:On})}:void 0,Tn=b.createElement(qr,{key:`${Zt.value}-${un}`,step:Zt,y:vn,dragBounds:{top:0,bottom:zn},mapPositionToValue:Dn=>xt.posToVal(Dn,jt),formatValue:Dn=>(0,As.j_)(jt)(Dn,qt).text,onChange:Kn});sn.push(Tn)}return sn},[ze,ge,Pe]);return Le.current?b.createElement("div",{style:{position:"absolute",overflow:"visible",left:`${(Le.current.bbox.left+Le.current.bbox.width)/window.devicePixelRatio}px`,top:`${Le.current.bbox.top/window.devicePixelRatio}px`,width:`${xi}px`,height:`${Le.current.bbox.height/window.devicePixelRatio}px`}},ot):null};Yo.displayName="ThresholdControlsPlugin";var li=e(63577),rr=(Y=>(Y.Candles="candles",Y.CandlesVolume="candles+volume",Y.Volume="volume",Y))(rr||{}),eo=(Y=>(Y.Candles="candles",Y.OHLCBars="ohlcbars",Y))(eo||{}),Lr=(Y=>(Y.CloseClose="close-close",Y.OpenClose="open-close",Y))(Lr||{});const wo={down:"red",flat:"gray",up:"green"},_r={...{candleStyle:"candles",colorStrategy:"open-close",colors:{down:"red",up:"green",flat:"gray"},fields:{},includeAllFields:!1,mode:"candles+volume"},legend:{displayMode:Je.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:Je.$N.Multi,sort:Je.xB.None}},Fr={open:{key:"open",name:"Open",defaults:["open","o"],description:"Value at the start of the period"},high:{key:"high",name:"High",defaults:["high","h","max"],description:"Maximum value within the period"},low:{key:"low",name:"Low",defaults:["low","l","min"],description:"Minimum value within the period"},close:{key:"close",name:"Close",defaults:["close","c"],description:"Value at the end of the period"},volume:{key:"volume",name:"Volume",defaults:["volume","v"],description:"Sample count within the period"}};function Fo(Y,ge,Pe){const Le=(0,li.findField)(Y,Pe[ge.key]);if(!Le)for(const ze of Y.fields){const et=(0,gs.Ct)(ze,Y).toLowerCase();if(ge.defaults.includes(et)||ge.defaults.includes(ze.name))return ze}return Le}function vo(Y,ge,Pe,Le){if(!Y?.length)return null;const ze=ge.fields??{},et=Y.length===1?(0,ps.Yj)(Y[0],Y[0].fields.findIndex(Zt=>Zt.type===Mt.PU.time)):(0,ps.Fd)({frames:Y});if(!et?.length)return null;const ot={aligned:et,frame:et,names:{}},xt=(0,ar.B_)([et],Pe,Le);if(!xt)return null;const Bt=ot.frame=xt[0],jt=Bt.fields.findIndex(Zt=>Zt.type===Mt.PU.time);if(jt<0)return null;const qt=new Set;for(const Zt of Object.values(Fr)){const vn=Fo(Bt,Zt,ze);vn&&(ot[Zt.key]=vn,qt.add(vn))}if(!ot.open&&!ot.close&&(ot.open=Bt.fields.find(Zt=>Zt.type===Mt.PU.number),ot.open&&qt.add(ot.open)),ot.open&&!ot.close&&!ze.close){const Zt=ot.open.values.slice(1);Zt.push(Zt[Zt.length-1]),ot.close={...ot.open,values:Zt,name:"Next open",state:void 0},qt.add(ot.close),Bt.fields.push(ot.close),ot.autoOpenClose=!0}if(ot.close&&!ot.open&&!ze.open){const Zt=ot.close.values.slice();Zt.unshift(Zt[0]),Zt.length=Bt.length,ot.open={...ot.close,values:Zt,name:"Previous close",state:void 0},qt.add(ot.open),Bt.fields.push(ot.open),ot.autoOpenClose=!0}!ot.high&&!ze.high&&(ot.high=ot.open),!ot.low&&!ze.low&&(ot.low=ot.open),ge.mode===rr.Volume?(ot.high&&(ot.high!==ot.open&&qt.delete(ot.high),ot.high=void 0),ot.low&&(ot.low!==ot.open&&qt.delete(ot.low),ot.low=void 0)):ge.mode===rr.Candles&&ot.volume&&(qt.delete(ot.volume),ot.volume=void 0);for(const Zt of Object.values(Fr)){const vn=ot[Zt.key];vn&&(ot.names[Zt.key]=(0,gs.Ct)(vn,ot.frame))}const sn=Bt.fields[jt],un=[sn];ge.includeAllFields?un.push(...Bt.fields.filter(Zt=>Zt!==sn)):un.push(...qt),ot.frame={...ot.frame,fields:un};for(let Zt=0;Zt<ot.frame.fields.length;Zt++){const vn=ot.frame.fields[Zt];vn.state={...vn.state,seriesIndex:Zt-1,origin:{fieldIndex:Zt,frameIndex:0}}}return ot}const{alpha:mr}=cs;function Jo(Y){let{mode:ge,candleStyle:Pe,fields:Le,colorStrategy:ze,upColor:et,downColor:ot,flatColor:xt,volumeAlpha:Bt,flatAsUp:jt=!0}=Y;const qt=ge!==rr.Volume&&Le.high!=null&&Le.low!=null,sn=qt&&Pe===eo.Candles,un=ge!==rr.Candles&&Le.volume!=null;function Zt(On,ga,ea,aa,Gn){return On>0?ea:On<0?aa:Gn?ea:ga}let vn=0,zn=Le.open,Un=Le.high,Kn=Le.low,Tn=Le.close,Dn=Le.volume;return On=>{let ga,ea,aa,Gn,An,ia;qt&&(aa=new Path2D,ea=new Path2D,ga=new Path2D),un&&(Gn=new Path2D,An=new Path2D,ia=new Path2D);let Qn=new Path2D,jn=On.ctx,ka=On.data[vn],Qa=On.data[zn],Ya=On.data[Tn],Ba=qt?On.data[Un]:null,Ia=qt?On.data[Kn]:null,Ea=un?On.data[Dn]:null,ja=Dn!=null?Math.round(On.valToPos(0,On.series[Dn].scale,!0)):null,[fs,Bs]=On.series[0].idxs,Sa=On.data[0],ya=Qa,pa=On.bbox.width;if(Sa.length>1){let is=null;for(let Ms=0,xs=1/0;Ms<Sa.length;Ms++)if(ya[Ms]!==void 0){if(is!=null){let $s=Math.abs(Sa[Ms]-Sa[is]);$s<xs&&(xs=$s,pa=Math.abs(On.valToPos(Sa[Ms],"x",!0)-On.valToPos(Sa[is],"x",!0)))}is=Ms}}let Ma=Math.round(.6*pa),Za=2,rs=2;Ma<=12&&(Za=rs=1);let vs=Math.floor(Ma/2);for(let is=fs;is<=Bs;is++){let Ms=Math.round(On.valToPos(ka[is],"x",!0)),xs=is===fs?0:Math.sign(Ya[is]-Ya[is-1]),$s=Math.sign(Ya[is]-Qa[is]);if(un&&ia&&An&&Gn){let la=Zt(ze===Lr.CloseClose?xs:$s,ia,An,Gn,is===fs&&Lr.CloseClose?!1:jt),sa=Math.round(On.valToPos(Ea[is],On.series[Dn].scale,!0));la.rect(Ms-vs,sa,Ma,ja-sa)}if(qt&&aa&&ea&&ga){let la=Zt(ze===Lr.CloseClose?xs:$s,aa,ea,ga,is===fs&&Lr.CloseClose?!1:jt),sa=Math.round(On.valToPos(Ba[is],On.series[Un].scale,!0)),Ca=Math.round(On.valToPos(Ia[is],On.series[Kn].scale,!0));la.rect(Ms-Math.floor(Za/2),sa,Za,Ca-sa);let Ja=Math.round(On.valToPos(Qa[is],On.series[zn].scale,!0)),Ha=Math.round(On.valToPos(Ya[is],On.series[Tn].scale,!0));if(sn){let qa=Math.min(Ja,Ha),ms=Math.max(Ja,Ha),Gs=Math.max(1,ms-qa);la.rect(Ms-vs,qa,Ma,Gs),ze===Lr.CloseClose&&$s>=0&&Gs>rs*2&&Qn.rect(Ms-vs+rs,qa+rs,Ma-rs*2,Gs-rs*2)}else la.rect(Ms-vs,Ja,vs,Za),la.rect(Ms,Ha,vs,Za)}}jn.save(),jn.rect(On.bbox.left,On.bbox.top,On.bbox.width,On.bbox.height),jn.clip(),un&&ia&&An&&Gn&&(jn.fillStyle=mr(et,Bt),jn.fill(An),jn.fillStyle=mr(ot,Bt),jn.fill(Gn),jn.fillStyle=mr(xt,Bt),jn.fill(ia)),qt&&aa&&ea&&ga&&(jn.fillStyle=et,jn.fill(ea),jn.fillStyle=ot,jn.fill(ga),jn.fillStyle=xt,jn.fill(aa),jn.globalCompositeOperation="destination-out",jn.fill(Qn)),jn.restore()}}const Or=({data:Y,id:ge,timeRange:Pe,timeZone:Le,width:ze,height:et,options:ot,fieldConfig:xt,onChangeTimeRange:Bt,replaceVariables:jt})=>{const{sync:qt,eventsScope:sn,canAddAnnotations:un,onThresholdsChange:Zt,canEditThresholds:vn,showThresholds:zn,dataLinkPostProcessor:Un,eventBus:Kn}=(0,Ka.d2)(),Tn=(0,z.$j)(),Dn=(0,b.useMemo)(()=>vo(Y.series,ot,Tn,Pe),[Y.series,ot,Tn,Pe]),[On,ga]=(0,b.useState)(null),ea=qt?.()??Qr.yV.Off,{renderers:aa,tweakScale:Gn,tweakAxis:An,shouldRenderPrice:ia}=(0,b.useMemo)(()=>{let jn=(xs,$s)=>xs,ka=(xs,$s)=>xs,Qa={renderers:[],tweakScale:jn,tweakAxis:ka,shouldRenderPrice:!1};if(!Dn)return Qa;const Ya=Dn.names;if(!Object.keys(Ya).length)return Qa;const{mode:Ba,candleStyle:Ia,colorStrategy:Ea}=ot,ja={...wo,...ot.colors};let{open:fs,high:Bs,low:Sa,close:ya,volume:pa}=Ya;if(fs==null||ya==null)return Qa;let Ma=.5,Za=-1,rs=!1;if(pa!=null&&Ba!==rr.Candles){let xs=Dn.volume;if(xs!=null){rs=!0;let{fillOpacity:$s}=xs.config.custom;$s&&(Ma=$s/100),Ba!==rr.Volume&&(xs.config={...xs.config},xs.config.unit="short",xs.display=(0,js.J)({field:xs,theme:fe.config.theme2}),ka=(la,sa)=>{if(sa.name===Dn.volume?.name){let Ca=(Ja,Ha)=>{let qa=[],ms=Ja.series[Za].max;for(let Gs=0;Gs<Ha.length&&(qa.push(Ha[Gs]),!(ms&&Ha[Gs]>ms));Gs++);return qa};la.space=20,la.filter=Ca,la.ticks={...la.ticks,filter:Ca}}return la},jn=(la,sa)=>(sa.name===Dn.volume?.name&&(la.range=(Ca,Ja,Ha)=>[0,Ha*7]),la))}}let vs=Ba!==rr.Volume&&Bs!=null&&Sa!=null;if(!vs&&!rs)return Qa;let is={},Ms=[];return vs?is={open:fs,high:Bs,low:Sa,close:ya}:Ms.push(fs,ya),rs&&(is.volume=pa,is.open=fs,is.close=ya),{shouldRenderPrice:vs,renderers:[{fieldMap:is,indicesOnly:Ms,init:(xs,$s)=>{Za=$s.volume,xs.addHook("drawAxes",Jo({mode:Ba,fields:$s,upColor:fe.config.theme2.visualization.getColorByName(ja.up),downColor:fe.config.theme2.visualization.getColorByName(ja.down),flatColor:fe.config.theme2.visualization.getColorByName(ja.flat),volumeAlpha:Ma,colorStrategy:Ea,candleStyle:Ia,flatAsUp:!0}))}}],tweakScale:jn,tweakAxis:ka}},[ot,Y.structureRev,Y.series.length]);if(!Dn)return b.createElement(_n.a,{panelId:ge,fieldConfig:xt,data:Y,needsTimeField:!0,needsNumberField:!0});if(ia)for(let jn in aa[0].fieldMap){let ka=Dn[jn];ka.config={...ka.config,custom:{...ka.config.custom,hideFrom:{legend:!0,tooltip:!1,viz:!1}}}}const Qn=!!un?.();return b.createElement(po,{frames:[Dn.frame],structureRev:Y.structureRev,timeRange:Pe,timeZone:Le,width:ze,height:et,legend:ot.legend,renderers:aa,tweakAxis:An,tweakScale:Gn,options:ot,replaceVariables:jt,dataLinkPostProcessor:Un,cursorSync:ea},(jn,ka)=>b.createElement(b.Fragment,null,b.createElement(ys.Z,{config:jn}),ea!==Qr.yV.Off&&b.createElement(Er.K,{config:jn,eventBus:Kn,frame:ka}),ot.tooltip.mode!==Je.$N.None&&b.createElement(Va.xl,{config:jn,hoverMode:ot.tooltip.mode===Je.$N.Single?Va.b3.xOne:Va.b3.xAll,queryZoom:Bt,clientZoom:!0,syncMode:ea,syncScope:sn,render:(Qa,Ya,Ba,Ia=!1,Ea,ja,fs)=>{if(Qn&&ja!=null){ga(ja),Ea();return}const Bs=()=>{let Sa=Qa.posToVal(Qa.cursor.left,"x");ga({from:Sa,to:Sa}),Ea()};return b.createElement(Cs.k,{series:ka,dataIdxs:Ya,seriesIdx:Ba,mode:fs?Je.$N.Multi:ot.tooltip.mode,sortOrder:ot.tooltip.sort,isPinned:Ia,annotate:Qn?Bs:void 0,maxHeight:ot.tooltip.maxHeight})},maxWidth:ot.tooltip.maxWidth}),b.createElement(Ro.W,{annotations:Y.annotations??[],config:jn,timeZone:Le,newRange:On,setNewRange:ga}),b.createElement(ho.U,{config:jn,onChangeTimeRange:Bt}),Y.annotations&&b.createElement(Mi,{config:jn,exemplars:Y.annotations,timeZone:Le}),(vn&&Zt||zn)&&b.createElement(Yo,{config:jn,fieldConfig:xt,onThresholdsChange:vn?Zt:void 0})))};class Yi{getSuggestionsForData(ge){const{dataSummary:Pe}=ge;if(!ge.data?.series||!Pe.hasData||Pe.timeFieldCount<1||Pe.numberFieldCount<2||Pe.numberFieldCount>10)return;const Le=vo(ge.data.series,_r,x.$.theme2);if(!Le||Le.open===Le.high&&Le.open===Le.low)return;ge.getListAppender({name:"",pluginId:"candlestick",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}).append({name:ra.m.Candlestick,options:_r,fieldConfig:{defaults:{},overrides:[]},score:Le.autoOpenClose?Jt.nQ.Good:Jt.nQ.Best})}}const Wo=[{label:"Candles",value:rr.Candles},{label:"Volume",value:rr.Volume},{label:"Both",value:rr.CandlesVolume}],to=[{label:"Candles",value:eo.Candles},{label:"OHLC Bars",value:eo.OHLCBars}],Ji=[{label:"Since Open",value:Lr.OpenClose},{label:"Since Prior Close",value:Lr.CloseClose}],Oi=Y=>Y.type===Mt.PU.number;function Eo(Y,ge,Pe){let Le="Auto ";if(Pe){const ze=Pe[ge.key];ze?.config?(Le+="= "+(0,gs.Ct)(ze),ze===Pe?.open&&ge.key!=="open"&&(Le+=` (${ge.defaults.join(",")})`)):Le+=`(${ge.defaults.join(",")})`}Y.addFieldNamePicker({path:`fields.${ge.key}`,name:ge.name,description:ge.description,settings:{filter:Oi,placeholderText:Le}})}const Xi=new M.m(Or).useFieldConfig((0,ks.V)(ks.S)).setPanelOptions((Y,ge)=>{const Pe=ge.options??_r,Le=vo(ge.data,Pe,x.$.theme2);Y.addRadio({path:"mode",name:"Mode",description:"",defaultValue:_r.mode,settings:{options:Wo}}).addRadio({path:"candleStyle",name:"Candle style",description:"",defaultValue:_r.candleStyle,settings:{options:to},showIf:ze=>ze.mode!==rr.Volume}).addRadio({path:"colorStrategy",name:"Color strategy",description:"",defaultValue:_r.colorStrategy,settings:{options:Ji}}).addColorPicker({path:"colors.up",name:"Up color",defaultValue:wo.up}).addColorPicker({path:"colors.down",name:"Down color",defaultValue:wo.down}),Eo(Y,Fr.open,Le),Pe.mode!==rr.Volume&&(Eo(Y,Fr.high,Le),Eo(Y,Fr.low,Le)),Eo(Y,Fr.close,Le),Pe.mode!==rr.Candles&&Eo(Y,Fr.volume,Le),Y.addRadio({path:"includeAllFields",name:"Additional fields",description:"Use standard timeseries options to configure any fields not mapped above",defaultValue:_r.includeAllFields,settings:{options:[{label:"Ignore",value:!1},{label:"Include",value:!0}]}}),wn.D(Y,!1,!0,Pe),Wn.H(Y)}).setDataSupport({annotations:!0,alertStates:!0}).setSuggestionsSupplier(new Yi);var Zi=e(36607),ci=e(76885),di=e(40672),Ii=e(6709),ke=e(29158),Ye=e(82467),Ze=e(10096),ct=e(16021),It=e(91219),Ht=e(28215),tn=e(27677),dn=e(62301),yn=e(80484);const Rn=Y=>({dashlistSectionHeader:(0,ae.css)`
    padding: ${Y.spacing(.25,1)};
    margin-right: ${Y.spacing(1)};
  `,dashlistSection:(0,ae.css)`
    margin-bottom: ${Y.spacing(2)};
    padding-top: 3px;
  `,dashlistLink:(0,ae.css)`
    display: flex;
    cursor: pointer;
    border-bottom: 1px solid ${Y.colors.border.weak};
    margin-right: ${Y.spacing(1)};
    padding: ${Y.spacing(1)};
    align-items: center;

    &:hover {
      a {
        color: ${Y.colors.text.link};
        text-decoration: underline;
      }
    }
  `,dashlistFolder:(0,ae.css)`
    color: ${Y.colors.text.secondary};
    font-size: ${Y.typography.bodySmall.fontSize};
    line-height: ${Y.typography.body.lineHeight};
  `,dashlistTitle:(0,ae.css)`
    &::after {
      position: absolute;
      content: '';
      left: 0;
      top: 0;
      bottom: 0;
      right: 0;
    }
  `,dashlistLinkBody:(0,ae.css)`
    flex-grow: 1;
    overflow: hidden;
    text-overflow: ellipsis;
  `,dashlistItem:(0,ae.css)`
    position: relative;
    list-style: none;
  `});async function Yn(Y,ge){let Pe=Promise.resolve([]);if(Y.showStarred){const qt={limit:Y.maxItems,starred:"true"};Pe=(0,tn.AI)().search(qt)}let Le=Promise.resolve([]),ze=[];if(Y.showRecentlyViewed){let qt=await dn.A.getDashboardOpened();ze=(0,w.take)(qt,Y.maxItems),Le=(0,tn.AI)().search({dashboardUIDs:ze,limit:Y.maxItems})}let et=Promise.resolve([]);if(Y.showSearch){const qt=Y.folderUID===""?"general":Y.folderUID,sn={limit:Y.maxItems,query:ge(Y.query,{},"text"),folderUIDs:qt,tag:Y.tags.map(un=>ge(un,{},"text")),type:"dash-db"};et=(0,tn.AI)().search(sn)}const[ot,xt,Bt]=await Promise.all([Pe,et,Le]);let jt=new Map;for(const qt of ze){const sn=Bt.find(un=>un.uid===qt);sn&&jt.set(qt,{...sn,isRecent:!0})}return xt.forEach(qt=>{qt.uid&&(jt.has(qt.uid)?jt.get(qt.uid).isSearchResult=!0:jt.set(qt.uid,{...qt,isSearchResult:!0}))}),ot.forEach(qt=>{qt.uid&&(jt.has(qt.uid)?jt.get(qt.uid).isStarred=!0:jt.set(qt.uid,{...qt,isStarred:!0}))}),jt}function qn(Y){const[ge,Pe]=(0,b.useState)(new Map),Le=(0,W.useDispatch)(),ze=(0,W.useSelector)(Tn=>Tn.navIndex);(0,b.useEffect)(()=>{Yn(Y.options,Y.replaceVariables).then(Tn=>{Pe(Tn)})},[Y.options,Y.replaceVariables,Y.renderCounter]);const et=async(Tn,Dn)=>{const{uid:On,title:ga,url:ea}=Dn;Tn.preventDefault(),Tn.stopPropagation();const aa=await(0,Oe.UA)().starDashboard(Dn.uid,Dn.isStarred),Gn=new Map(ge);Gn.set(Dn?.uid??"",{...Dn,isStarred:aa}),Pe(Gn),Le((0,It.ci)({id:On??"",title:ga,url:ea,isStarred:aa}));const An=ze.starred;if(aa)An.children?.push({id:It.L1+On,text:ga,url:ea??"",parentItem:An});else{Le((0,Ht.Im)(It.L1+On));const ia=An.children?.findIndex(Qn=>Qn.id===It.L1+On);ia&&An.children?.splice(ia,1)}Le((0,Ye.Vz)(An))},[ot,xt,Bt]=(0,b.useMemo)(()=>{const Tn=[...ge.values()];return[Tn.filter(Dn=>Dn.isStarred).sort((Dn,On)=>Dn.title.localeCompare(On.title)),Tn.filter(Dn=>Dn.isRecent),Tn.filter(Dn=>Dn.isSearchResult).sort((Dn,On)=>Dn.title.localeCompare(On.title))]},[ge]),{showStarred:jt,showRecentlyViewed:qt,showHeadings:sn,showFolderNames:un,showSearch:Zt}=Y.options,vn=[{header:"Starred dashboards",dashboards:ot,show:jt},{header:"Recently viewed dashboards",dashboards:xt,show:qt},{header:"Search",dashboards:Bt,show:Zt}],zn=(0,z.of)(Rn),Un=Jn(Y),Kn=Tn=>b.createElement("ul",null,Tn.map(Dn=>{let On=Dn.url;return On=ci.kM.appendQueryToUrl(On,Un),On=(0,fe.zj)().disableSanitizeHtml?On:di.sQ.sanitizeUrl(On),b.createElement("li",{className:zn.dashlistItem,key:`dash-${Dn.uid}`},b.createElement("div",{className:zn.dashlistLink},b.createElement("div",{className:zn.dashlistLinkBody},b.createElement("a",{className:zn.dashlistTitle,href:On},Dn.title),un&&Dn.folderTitle&&b.createElement("div",{className:zn.dashlistFolder},Dn.folderTitle)),b.createElement(ke.K,{tooltip:Dn.isStarred?`Unmark "${Dn.title}" as favorite`:`Mark "${Dn.title}" as favorite`,name:Dn.isStarred?"favorite":"star",iconType:Dn.isStarred?"mono":"default",onClick:ga=>et(ga,Dn)})))}));return b.createElement(te.E,{autoHeightMin:"100%",autoHeightMax:"100%"},vn.map(({show:Tn,header:Dn,dashboards:On},ga)=>Tn&&b.createElement("div",{className:zn.dashlistSection,key:`dash-group-${ga}`},sn&&b.createElement("h6",{className:zn.dashlistSectionHeader},Dn),Kn(On))))}function Jn(Y){(0,ct.u)(Ze.lE,yn.og);let ge={};return Y.options.keepTime&&(ge[`$${Ii.c.keepTime}`]=!0),Y.options.includeVars&&(ge[`$${Ii.c.includeVars}`]=!0),Y.replaceVariables(ci.kM.toUrlParams(ge))}async function ca(Y){return Y===0?"":(await(0,In.AI)().get(`/api/folders/id/${Y}`,void 0,void 0,{showErrorAlert:!1})).uid}async function Oa(Y){const ge={...Y.options,showStarred:Y.options.showStarred??Y.starred,showRecentlyViewed:Y.options.showRecentlyViewed??Y.recent,showSearch:Y.options.showSearch??Y.search,showHeadings:Y.options.showHeadings??Y.headings,maxItems:Y.options.maxItems??Y.limit,query:Y.options.query??Y.query,folderId:Y.options.folderId??Y.folderId,tags:Y.options.tags??Y.tags};if(parseFloat(Y.pluginVersion||"6.1")<6.3&&["starred","recent","search","headings","limit","query","folderId"].forEach(ze=>delete Y[ze]),ge.folderId!==void 0){const Le=ge.folderId;try{const ze=await ca(Le);ge.folderUID=ze,delete ge.folderId}catch(ze){console.warn("Dashlist: Error migrating folder ID to UID",ze)}}return ge}const ma={includeVars:!1,keepTime:!1,maxItems:10,query:"",showFolderNames:!0,showHeadings:!0,showRecentlyViewed:!1,showSearch:!1,showStarred:!0,tags:[]},$a=new M.m(qn).setPanelOptions(Y=>{Y.addBooleanSwitch({path:"keepTime",name:"Include current time range",defaultValue:ma.keepTime}).addBooleanSwitch({path:"includeVars",name:"Include current template variable values",defaultValue:ma.includeVars}).addBooleanSwitch({path:"showStarred",name:"Starred",defaultValue:ma.showStarred}).addBooleanSwitch({path:"showRecentlyViewed",name:"Recently viewed",defaultValue:ma.showRecentlyViewed}).addBooleanSwitch({path:"showSearch",name:"Search",defaultValue:ma.showSearch}).addBooleanSwitch({path:"showHeadings",name:"Show headings",defaultValue:ma.showHeadings}).addBooleanSwitch({path:"showFolderNames",name:"Show folder names",defaultValue:ma.showFolderNames}).addNumberInput({path:"maxItems",name:"Max items",defaultValue:ma.maxItems}).addTextInput({path:"query",name:"Query",defaultValue:ma.query}).addCustomEditor({path:"folderUID",name:"Folder",id:"folderUID",defaultValue:void 0,editor:function({value:Pe,onChange:Le}){return b.createElement(Zi.d,{clearable:!0,permission:W.PermissionLevelString.View,value:Pe,onChange:ze=>Le(ze)})}}).addCustomEditor({id:"tags",path:"tags",name:"Tags",description:"",defaultValue:ma.tags,editor(ge){return b.createElement(Nt.u,{tags:ge.value,onChange:ge.onChange})}})}).setMigrationHandler(Oa);var He=e(47187),Ie=e(14110),je=e(11503);const tt=({onBlur:Y,placeholder:ge})=>{const Pe=(0,b.useRef)(null);(0,b.useEffect)(()=>{Pe.current&&Pe.current.focus()});const Le=ze=>{ze.key==="Enter"&&ze.currentTarget.blur()};return b.createElement("input",{type:"text",placeholder:ge,onBlur:Y,ref:Pe,onKeyDown:Le,"data-testid":"column-input"})},St=({divStyle:Y,onColumnInputBlur:ge})=>{const[Pe,Le]=(0,b.useState)(!1),ze=()=>{Le(!0)},et=ot=>{const xt=ot.target.value;xt&&ge(xt),Le(!1)};return b.createElement("div",{className:Y},Pe?b.createElement(tt,{placeholder:"Column Name",onBlur:et}):b.createElement("button",{onClick:ze},"+"))};var $t=e(50311),Yt=e(64539),pn=e(59093),Bn=e(28122),Cn=e(27183),Xn=e(69321);const na=()=>x.$.featureToggles.enableDatagridEditing,va="600 13px Inter",ba="400 13px Inter",fa=document.createElement("canvas"),Ga=20,Ta=300,Fa=65,$n="both",ta="number",Zn={isContextMenuOpen:!1},La={isInputOpen:!1},us="datagrid_panel",ts={EDIT_CELL:"edit_cell",GRID_SELECTED:"grid_selected",APPEND_ROW:"append_row",APPEND_COLUMN:"append_column",DELETE_BTN_PRESSED:"delete_btn_pressed",COLUMN_RESIZE:"column_resize",COLUMN_REORDER:"column_reorder",ROW_REORDER:"row_reorder",CONTEXT_MENU_ACTION:"context_menu_action",HEADER_MENU_ACTION:"header_menu_action"},Hs={name:"A",fields:[],length:0},Da={kind:Xn.dd.Text,data:"",allowOverlay:!0,readonly:!1,displayData:""},fr={columns:Xn.I1.empty(),rows:Xn.I1.empty()},zr={sticky:!1,tint:!0},qi={fill:!0,sticky:!1};async function yr(Y,ge){if(ge&&na()){for(let Pe=0;Pe<Y.fields.length;Pe++)delete Y.fields[Pe].config.displayName,delete Y.fields[Pe].config.displayNameFromDS;return await ge([Y])}return!1}const Ds=(Y,ge=!1)=>{const Pe=fa.getContext("2d");return Pe.font=ge?va:ba,Pe.measureText(Y).width},no=Y=>Math.max(Ds(Y.name,!0)+Fa,Math.min(Ta,Y.values.toArray().reduce((ge,Pe)=>{const Le=Ds(Pe?.toString()??"");return Le>ge?Le:ge},0)+Ga)),Wr=(Y,ge,Pe=!1)=>{const Le={...Y,fields:Y.fields.map(ze=>({...ze,values:ze.values.slice()}))};for(const ze of Le.fields){const et=ze.values.toArray();for(let ot=ge.length-1;ot>=0;ot--)Pe?et.splice(ge[ot],1):et.splice(ge[ot],1,null);ze.values=[...et]}return{...Le,length:Le.fields[0]?.values.length??0}},yo=(Y,ge)=>{const Pe=ge.x,Le=ge.y,ze=ge.x+ge.width-1,et={...Y,fields:Y.fields.map(ot=>({...ot,values:ot.values.slice()}))};for(let ot=Pe;ot<=ze;ot++){const xt=et.fields[ot],Bt=xt.values.toArray();Bt.splice(Le,ge.height,...new Array(ge.height).fill(null)),xt.values=[...Bt]}return{...et,length:et.fields[0]?.values.length??0}},jl=Y=>{const ge=Y.values.toArray();Y.values=ge.map(Pe=>Pe==="undefined"||Pe==="null"?null:Pe)};function hu(Y){return{accentColor:Y.colors.primary.main,accentFg:Y.colors.secondary.main,textDark:Y.colors.text.primary,textMedium:Y.colors.text.secondary,textLight:Y.colors.text.secondary,textBubble:Y.colors.text.primary,textHeader:Y.colors.text.primary,bgCell:Y.colors.background.primary,bgCellMedium:Y.colors.background.primary,bgHeader:Y.colors.background.primary,bgHeaderHasFocus:Y.colors.background.secondary,bgHeaderHovered:Y.colors.background.secondary,linkColor:Y.colors.text.link,fontFamily:Y.typography.fontFamily,headerFontStyle:`${Y.typography.fontWeightMedium} ${Y.typography.fontSize}px`,fgIconHeader:Y.colors.secondary.contrastText,bgIconHeader:Y.colors.secondary.main}}const Cl=(Y,ge,Pe=!1)=>{const Le=Y.values.get(ge);switch(Y.type){case Mt.PU.boolean:return{kind:Xn.dd.Boolean,data:Le||!1,allowOverlay:!1,readonly:!1};case Mt.PU.number:return{kind:Xn.dd.Number,data:Le||0,allowOverlay:na()&&!Pe,readonly:!1,displayData:Le!=null?Le.toString():""};case Mt.PU.string:return{kind:Xn.dd.Text,data:Le||"",allowOverlay:na()&&!Pe,readonly:!1,displayData:Le!=null?Le.toString():""};default:return{kind:Xn.dd.Text,data:Le||"",allowOverlay:na()&&!Pe,readonly:!1,displayData:Le!=null?Le.toString():""}}},el=(Y,ge)=>({dataEditor:(0,ae.css)`
      .dvn-scroll-inner > div:nth-child(2) {
        pointer-events: none !important;
      }
      scrollbar-color: ${Y.colors.background.secondary} ${Y.colors.background.primary};
      ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }
      ::-webkit-scrollbar-track {
        background: ${Y.colors.background.primary};
      }
      ::-webkit-scrollbar-thumb {
        border-radius: 10px;
      }
      ::-webkit-scrollbar-corner {
        display: none;
      }
    `,addColumnDiv:(0,ae.css)`
      width: 120px;
      display: flex;
      flex-direction: column;
      background-color: ${Y.colors.background.primary};
      button {
        pointer-events: ${ge?"none":"auto"};
        border: none;
        outline: none;
        height: 37px;
        font-size: 20px;
        background-color: ${Y.colors.background.primary};
        color: ${Y.colors.text.primary};
        border-right: 1px solid ${Y.components.panel.borderColor};
        border-bottom: 1px solid ${Y.components.panel.borderColor};
        transition: background-color 200ms;
        cursor: pointer;
        :hover {
          background-color: ${Y.colors.background.secondary};
        }
      }
      input {
        height: 37px;
        border: 1px solid ${Y.colors.primary.main};
        :focus {
          outline: none;
        }
      }
    `,renameColumnInput:(0,ae.css)`
      height: 37px;
      border: 1px solid ${Y.colors.primary.main};
      :focus {
        outline: none;
      }
    `}),Hc=Y=>Y.rows.length||Y.columns.length?!0:Y.current===void 0?!1:Y.current.range&&!(Y.current.range.height===1&&Y.current.range.width===1);var Xs=(Y=>(Y.columnResizeStart="columnResizeStart",Y.columnResizeEnd="columnResizeEnd",Y.columnMove="columnMove",Y.updateColumns="updateColumns",Y.showColumnRenameInput="showColumnRenameInput",Y.hideColumnRenameInput="hideColumnRenameInput",Y.openCellContextMenu="openCellContextMenu",Y.openHeaderContextMenu="openHeaderContextMenu",Y.openHeaderDropdownMenu="openHeaderDropdownMenu",Y.closeContextMenu="closeContextMenu",Y.multipleCellsSelected="multipleCellsSelected",Y.gridSelectionCleared="gridSelectionCleared",Y.columnFreezeReset="columnFreezeReset",Y.columnFreezeChanged="columnFreezeChanged",Y.openSearch="openSearch",Y.closeSearch="closeSearch",Y))(Xs||{});const Gc={columns:[],contextMenuData:Zn,renameColumnInputData:La,gridSelection:fr,columnFreezeIndex:0,toggleSearch:!1,isResizeInProgress:!1},vu=new Map([[Mt.PU.number,Xn.Gf.HeaderNumber],[Mt.PU.string,Xn.Gf.HeaderTextTemplate],[Mt.PU.boolean,Xn.Gf.HeaderBoolean],[Mt.PU.time,Xn.Gf.HeaderDate],[Mt.PU.other,Xn.Gf.HeaderReference]]),Eu=(Y,ge)=>{let Pe=[];switch(ge.type){case"columnResizeStart":Pe=[...Y.columns];const Le=ge.payload;return Pe[Le.columnIndex]={...Y.columns[Le.columnIndex],width:Le.width},{...Y,columns:Pe,isResizeInProgress:!0};case"columnMove":Pe=[...Y.columns];const ze=ge.payload,et=Y.columns[ze.from].width;let ot=Pe.splice(ze.from,1)[0];return ot={...ot,width:et},Pe.splice(ze.to,0,ot),{...Y,columns:Pe};case"columnResizeEnd":return{...Y,isResizeInProgress:!1};case"updateColumns":const xt=ge.payload;return Pe=[...xt.frame.fields.map((Kn,Tn)=>{const Dn=Y.columns.find(ga=>ga.title===Kn.name)?.width;return{title:(0,gs.Ct)(Kn,xt.frame),width:Dn??no(Kn),icon:vu.get(Kn.type),hasMenu:na(),trailingRowOptions:{targetColumn:--Tn}}})],{...Y,columns:Pe};case"showColumnRenameInput":return{...Y,renameColumnInputData:{...Y.renameColumnInputData,isInputOpen:!0}};case"hideColumnRenameInput":return{...Y,renameColumnInputData:{...Y.renameColumnInputData,isInputOpen:!1}};case"openCellContextMenu":const Bt=ge.payload,jt=Bt.event,qt=Bt.cell;return{...Y,contextMenuData:{x:jt.bounds.x+jt.localEventX,y:jt.bounds.y+jt.localEventY,column:qt[0]===-1?void 0:qt[0],row:qt[1],isContextMenuOpen:!0,isHeaderMenu:!1}};case"openHeaderContextMenu":const sn=ge.payload,un=sn.event;return{...Y,contextMenuData:{x:un.bounds.x+un.localEventX,y:un.bounds.y+un.localEventY,column:sn.columnIndex,row:void 0,isContextMenuOpen:!0,isHeaderMenu:!1}};case"openHeaderDropdownMenu":const Zt=ge.payload,vn=Zt.screenPosition;return{...Y,contextMenuData:{x:vn.x+vn.width,y:vn.y+vn.height,column:Zt.columnIndex,row:void 0,isContextMenuOpen:!0,isHeaderMenu:!0},renameColumnInputData:{x:vn.x,y:vn.y,width:vn.width,height:vn.height,columnIdx:Zt.columnIndex,isInputOpen:!1,inputValue:Zt.value}};case"closeContextMenu":return{...Y,contextMenuData:{isContextMenuOpen:!1}};case"closeSearch":return{...Y,toggleSearch:!1};case"openSearch":return{...Y,toggleSearch:!0};case"multipleCellsSelected":const zn=ge.payload;return{...Y,gridSelection:zn.selection};case"gridSelectionCleared":return{...Y,gridSelection:fr};case"columnFreezeReset":return{...Y,columnFreezeIndex:0};case"columnFreezeChanged":const Un=ge.payload;return{...Y,columnFreezeIndex:Un.columnIndex};default:return Y}},yu=({menuData:Y,data:ge,saveData:Pe,closeContextMenu:Le,dispatch:ze,gridSelection:et,columnFreezeIndex:ot,renameColumnClicked:xt})=>{let Bt=[],jt=[];const{row:qt,column:sn,x:un,y:Zt,isHeaderMenu:vn}=Y;et.rows&&(Bt=et.rows.toArray()),et.columns&&(jt=et.columns.toArray());let zn="Delete row";Bt.length&&Bt.length>1&&(zn=`Delete ${Bt.length} rows`);let Un="Delete column";jt.length&&jt.length>1&&(Un=`Delete ${jt.length} columns`);const Kn=qt!==void 0&&qt>=0||Bt.length,Tn=sn!==void 0&&sn>=0&&qt!==void 0||jt.length,Dn=qt!==void 0&&qt>=0&&!Bt.length,On=sn!==void 0&&sn>=0&&qt!==void 0&&!jt.length,ga=()=>b.createElement(b.Fragment,null,Kn?b.createElement(Yt.D,{label:zn,onClick:()=>{if(Bt.length){Pe(Wr(ge,Bt,!0)),ze({type:Xs.gridSelectionCleared});return}qt!==void 0&&qt>=0&&((0,Ie.rR)(us,{item:ts.CONTEXT_MENU_ACTION,menu_action:"row_delete"}),Pe(Wr(ge,[qt],!0)))}}):null,Tn?b.createElement(Yt.D,{label:Un,onClick:()=>{if(jt.length){Pe({...ge,fields:ge.fields.filter((aa,Gn)=>!jt.includes(Gn))}),ze({type:Xs.gridSelectionCleared});return}sn!==void 0&&sn>=0&&((0,Ie.rR)(us,{item:ts.CONTEXT_MENU_ACTION,menu_action:"column_delete"}),Pe({...ge,fields:ge.fields.filter((aa,Gn)=>Gn!==sn)}))}}):null,Tn||Kn?b.createElement(Cn.N,null):null,Dn?b.createElement(Yt.D,{label:"Clear row",onClick:()=>{(0,Ie.rR)(us,{item:ts.CONTEXT_MENU_ACTION,menu_action:"row_clear"}),Pe(Wr(ge,[qt]))}}):null,On?b.createElement(Yt.D,{label:"Clear column",onClick:()=>{const aa=ge.fields[sn];aa.values=aa.values.map(()=>null),(0,Ie.rR)(us,{item:ts.CONTEXT_MENU_ACTION,menu_action:"column_clear"}),Pe({...ge})}}):null,Dn||On?b.createElement(Cn.N,null):null,b.createElement(Yt.D,{label:"Remove all data",onClick:()=>{(0,Ie.rR)(us,{item:ts.CONTEXT_MENU_ACTION,menu_action:"remove_all"}),Pe(Hs)}}),b.createElement(Yt.D,{label:"Search...",onClick:()=>{(0,Ie.rR)(us,{item:ts.CONTEXT_MENU_ACTION,menu_action:"open_search"}),ze({type:Xs.openSearch})}})),ea=()=>{if(sn==null)return null;const aa=ge.fields[sn].type,Gn=[],An=jn=>{Gn.push({label:(0,w.capitalize)(jn),options:{targetField:ge.fields[sn].name,destinationType:jn}})};aa===Mt.PU.string?(An(Mt.PU.number),An(Mt.PU.boolean)):aa===Mt.PU.number?(An(Mt.PU.string),An(Mt.PU.boolean)):aa===Mt.PU.boolean?(An(Mt.PU.number),An(Mt.PU.string)):(An(Mt.PU.string),An(Mt.PU.number),An(Mt.PU.boolean));let ia="Set column freeze position";const Qn=sn+1;return ot===Qn&&(ia="Unset column freeze"),b.createElement(b.Fragment,null,Gn.length?b.createElement(pn.r,{label:"Set field type"},Gn.map((jn,ka)=>b.createElement(Yt.D,{key:ka,label:jn.label,onClick:()=>{const Qa=(0,$t.s7)(ge.fields[sn],jn.options);jn.options.destinationType===Mt.PU.string&&jl(Qa);const Ya={name:ge.name,fields:[...ge.fields],length:ge.length};Ya.fields[sn]=Qa,(0,Ie.rR)(us,{item:ts.HEADER_MENU_ACTION,menu_action:"convert_field"}),Pe(Ya)}}))):null,b.createElement(Cn.N,null),b.createElement(Yt.D,{label:ia,onClick:()=>{(0,Ie.rR)(us,{item:ts.HEADER_MENU_ACTION,menu_action:"column_freeze"}),ze(ot===Qn?{type:Xs.columnFreezeReset}:{type:Xs.columnFreezeChanged,payload:{columnIndex:Qn}})}}),b.createElement(Yt.D,{label:"Rename column",onClick:xt}),b.createElement(Cn.N,null),b.createElement(Yt.D,{label:"Delete column",onClick:()=>{(0,Ie.rR)(us,{item:ts.HEADER_MENU_ACTION,menu_action:"delete_column"}),Pe({...ge,fields:ge.fields.filter((jn,ka)=>ka!==sn)}),ze({type:Xs.gridSelectionCleared})}}),b.createElement(Yt.D,{label:"Clear column",onClick:()=>{const jn=ge.fields[sn];jn.values=jn.values.map(()=>null),(0,Ie.rR)(us,{item:ts.HEADER_MENU_ACTION,menu_action:"clear_column"}),Pe({...ge})}}))};return b.createElement(Bn.t,{renderMenuItems:vn?ea:ga,x:un,y:Zt,onClose:Le})},ui=({renameColumnData:Y,onColumnInputBlur:ge,classStyle:Pe})=>{const{x:Le,y:ze,width:et,height:ot,inputValue:xt,columnIdx:Bt}=Y,[jt,qt]=(0,b.useState)({}),[sn,un]=(0,b.useState)(xt),Zt=(0,b.useRef)(null);(0,b.useLayoutEffect)(()=>{Zt.current?.focus();const Kn=Zt.current?.getBoundingClientRect();if(Kn){const Tn={right:window.innerWidth<Le+Kn.width,bottom:window.innerHeight<ze+Kn.height};qt({position:"fixed",left:Tn.right?Le-Kn.width:Le,top:Tn.bottom?ze-Kn.height:ze,width:et,height:ot})}},[ot,et,Le,ze]);const vn=Kn=>{const Tn=Kn.target.value;Tn&&ge(Tn,Bt)},zn=Kn=>{un(Kn.target.value)},Un=Kn=>{Kn.key==="Enter"&&Kn.currentTarget.blur()};return b.createElement(Ns.ZL,null,b.createElement("input",{type:"text",className:Pe,value:sn,onBlur:vn,ref:Zt,style:jt,onChange:zn,onKeyDown:Un}))};function Du({options:Y,data:ge,id:Pe,fieldConfig:Le,width:ze,height:et}){const[ot,xt]=(0,b.useReducer)(Eu,Gc),{onUpdateData:Bt}=(0,Ka.d2)(),{columns:jt,contextMenuData:qt,renameColumnInputData:sn,gridSelection:un,columnFreezeIndex:Zt,toggleSearch:vn,isResizeInProgress:zn}=ot,Un=ge.series[Y.selectedSeries??0],Kn=(0,z.$j)(),Tn=hu(Kn);(0,b.useEffect)(()=>{Un&&xt({type:Xs.updateColumns,payload:{frame:Un}})},[Un]);const Dn=([Sa,ya])=>{const pa=Un.fields[Sa];return!pa||ya>Un.length?Da:Cl(pa,ya,Hc(un))},On=(Sa,ya)=>{if(Hc(un))return;const[pa,Ma]=Sa,Za={...Un,fields:Un.fields.map(is=>({...is,values:[...is.values]}))},rs=Za.fields[pa];if(!rs)return;const vs=rs.values.toArray();vs[Ma]=ya.data,rs.values=[...vs],(0,Ie.rR)(us,{item:ts.EDIT_CELL}),yr(Za,Bt)},ga=Sa=>{const ya=Un.length??0;(0,Ie.rR)(us,{item:ts.APPEND_COLUMN}),yr({...Un,fields:[...Un.fields,{name:Sa,type:Mt.PU.string,config:{},values:new Array(ya).fill("")}]},Bt)},ea=()=>{const Sa=Un.fields.map(ya=>{const pa=ya.values.slice();return pa.push(null),{...ya,values:pa}});(0,Ie.rR)(us,{item:ts.APPEND_ROW}),yr({...Un,fields:Sa,length:Un.length+1},Bt)},aa=(Sa,ya,pa,Ma)=>{(0,Ie.rR)(us,{item:ts.COLUMN_RESIZE}),xt({type:Xs.columnResizeStart,payload:{columnIndex:pa,width:ya}})},Gn=(Sa,ya,pa,Ma)=>{xt({type:Xs.columnResizeEnd})},An=()=>{xt({type:Xs.closeContextMenu})},ia=Sa=>{if(Sa.current&&Sa.current.range)return(0,Ie.rR)(us,{item:ts.DELETE_BTN_PRESSED,selection:"grid-cell"}),yr(yo(Un,Sa.current.range),Bt),!0;const ya=Sa.rows.toArray(),pa=Sa.columns.toArray();if(ya.length)return(0,Ie.rR)(us,{item:ts.DELETE_BTN_PRESSED,selection:"rows"}),yr(Wr(Un,ya),Bt),!0;if(pa.length){const Ma={...Un,fields:Un.fields.map((Za,rs)=>pa.includes(rs)?{...Za,values:new Array(Un.length).fill(null)}:Za)};return(0,Ie.rR)(us,{item:ts.DELETE_BTN_PRESSED,selection:"columns"}),yr(Ma,Bt),!0}return!1},Qn=(Sa,ya)=>{ya.preventDefault(),xt({type:Xs.openCellContextMenu,payload:{event:ya,cell:Sa}})},jn=(Sa,ya)=>{ya.preventDefault(),xt({type:Xs.openHeaderContextMenu,payload:{event:ya,columnIndex:Sa}})},ka=(Sa,ya)=>{xt({type:Xs.openHeaderDropdownMenu,payload:{screenPosition:ya,columnIndex:Sa,value:ot.columns[Sa].title}})},Qa=async(Sa,ya)=>{const pa=Un.fields.map(rs=>rs),Ma=pa[Sa];pa.splice(Sa,1),pa.splice(ya,0,Ma),await yr({...Un,fields:pa},Bt)&&((0,Ie.rR)(us,{item:ts.COLUMN_REORDER}),xt({type:Xs.columnMove,payload:{from:Sa,to:ya}}))},Ya=(Sa,ya)=>{const pa=Un.fields.map(Ma=>({...Ma,values:Ma.values.slice()}));for(const Ma of pa){const Za=Ma.values[Sa];Ma.values.splice(Sa,1),Ma.values.splice(ya,0,Za)}(0,Ie.rR)(us,{item:ts.ROW_REORDER}),yr({...Un,fields:pa},Bt)},Ba=()=>{(0,Ie.rR)(us,{item:ts.HEADER_MENU_ACTION,menu_action:"rename_column"}),xt({type:Xs.showColumnRenameInput})},Ia=(Sa,ya)=>{const pa=Un.fields.map(Ma=>Ma);pa[ya].name=Sa,xt({type:Xs.hideColumnRenameInput}),yr({...Un,fields:pa},Bt)},Ea=()=>{xt({type:Xs.closeSearch})},ja=Sa=>{(0,Ie.rR)(us,{item:ts.GRID_SELECTED}),xt({type:Xs.multipleCellsSelected,payload:{selection:Sa}})},fs=Sa=>{yr(Sa,Bt)};if(!Un)return b.createElement(_n.a,{panelId:Pe,fieldConfig:Le,data:ge});if(!na())return b.createElement(_n.a,{panelId:Pe,message:"Datagrid is not enabled",fieldConfig:Le,data:ge});if(!document.getElementById("portal")){const Sa=document.createElement("div");Sa.id="portal",document.body.appendChild(Sa)}const Bs=el(Kn,zn);return b.createElement(b.Fragment,null,b.createElement(He.D,{className:Bs.dataEditor,getCellContent:Dn,columns:jt,rows:Un.length,width:ze,height:et,initialSize:[ze,et],theme:Tn,smoothScrollX:!0,smoothScrollY:!0,overscrollY:50,onCellEdited:na()?On:void 0,getCellsForSelection:na()?!0:void 0,showSearch:na()?vn:!1,onSearchClose:Ea,gridSelection:un,onGridSelectionChange:na()?ja:void 0,onRowAppended:na()?ea:void 0,onDelete:na()?ia:void 0,rowMarkers:na()?$n:ta,onColumnResize:aa,onColumnResizeEnd:Gn,onCellContextMenu:na()?Qn:void 0,onHeaderContextMenu:na()?jn:void 0,onHeaderMenuClick:na()?ka:void 0,trailingRowOptions:zr,rightElement:na()?b.createElement(St,{onColumnInputBlur:ga,divStyle:Bs.addColumnDiv}):null,rightElementProps:qi,freezeColumns:Zt,onRowMoved:na()?Ya:void 0,onColumnMoved:na()?Qa:void 0}),qt.isContextMenuOpen&&b.createElement(yu,{menuData:qt,data:Un,saveData:fs,closeContextMenu:An,dispatch:xt,gridSelection:un,columnFreezeIndex:Zt,renameColumnClicked:Ba}),sn.isInputOpen?b.createElement(ui,{onColumnInputBlur:Ia,renameColumnData:sn,classStyle:Bs.renameColumnInput}):null)}const jc={selectedSeries:0},or=new M.m(Du).setPanelOptions((Y,ge)=>{const Pe=ge.data.map((Le,ze)=>({value:ze,label:Le.refId}));return ge.options&&!Pe.map(Le=>Le.value).includes(ge.options.selectedSeries??0)&&(ge.options.selectedSeries=jc.selectedSeries),Y.addSelect({path:"selectedSeries",name:"Select series",defaultValue:jc.selectedSeries,settings:{options:Pe}})});var Ko=e(1819);class Zs extends b.Component{constructor(){super(...arguments),this.subscription=new ht.yU,this.state={}}componentDidMount(){const{eventBus:ge}=this.props;this.subscription.add(ge.subscribe(on.b_,Pe=>{this.setState({event:Pe})})),this.subscription.add(ge.subscribe(on.ql,Pe=>{this.setState({event:Pe})})),this.subscription.add(ge.subscribe(_t.kb,Pe=>{this.setState({event:Pe})})),this.subscription.add(ge.subscribe(_t.Tq,Pe=>{this.setState({event:Pe})}))}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{event:ge}=this.state;if(!ge)return b.createElement("div",null,"no events yet");const{type:Pe,payload:Le,origin:ze}=ge;return b.createElement(te.E,{autoHeightMin:"100%",autoHeightMax:"100%"},b.createElement("h3",null,"Origin: ",ze?.path),b.createElement("span",null,"Type: ",Pe),!!Le&&b.createElement(b.Fragment,null,b.createElement("pre",null,JSON.stringify(Le.point,null,"  ")),Le.data&&b.createElement(Ko.e,{data:Le.data,rowIndex:Le.rowIndex,columnIndex:Le.columnIndex})))}}var Qc=e(36120);let gr=100;class Yc extends b.PureComponent{constructor(ge){super(ge),this.history=new Qc.$({capacity:40,append:"head"}),this.eventObserver={next:Le=>{const ze=Le.origin;this.history.add({key:gr++,type:Le.type,path:ze?.path,payload:Le.payload}),this.setState({counter:gr})}},this.state={counter:gr};const Pe=[];Pe.push(ge.eventBus.getStream(on.b_).subscribe(this.eventObserver)),Pe.push(ge.eventBus.getStream(on.ql).subscribe(this.eventObserver)),Pe.push(ge.eventBus.getStream(on.LO).subscribe(this.eventObserver)),this.subs=Pe}componentWillUnmount(){for(const ge of this.subs)ge.unsubscribe()}render(){return b.createElement(te.E,{autoHeightMin:"100%",autoHeightMax:"100%"},this.history.map((ge,Pe)=>b.createElement("div",{key:ge.key},JSON.stringify(ge.path)," ",ge.type," / X:",JSON.stringify(ge.payload.x)," / Y:",JSON.stringify(ge.payload.y))))}}var Jc=e(21423),Xo=e(75059);class Pu extends b.Component{constructor(){super(...arguments),this.lastRender=Date.now(),this.counters={render:0,dataChanged:0,schemaChanged:0},this.resetCounters=()=>{this.counters={render:0,dataChanged:0,schemaChanged:0},this.forceUpdate()}}shouldComponentUpdate(ge){const{data:Pe,options:Le}=this.props;if(ge.data!==Pe&&(this.counters.dataChanged++,Le.counters?.schemaChanged)){const ze=ge.data?.series,et=Pe.series;et&&ze&&((0,Jc.J3)(et,ze,Jc.bW)||this.counters.schemaChanged++)}return!0}render(){const{data:ge,options:Pe}=this.props,Le=Pe.counters??{render:!1,dataChanged:!1,schemaChanged:!1};this.counters.render++;const ze=Date.now(),et=ze-this.lastRender;this.lastRender=ze;const ot=Xo.AS.get(Xo.gy.lastNotNull);return b.createElement("div",null,b.createElement("div",null,b.createElement(ke.K,{name:"step-backward",title:"reset counters",onClick:this.resetCounters,tooltip:"Step back"}),b.createElement("span",null,Le.render&&b.createElement("span",null,"Render: ",this.counters.render,"\xA0"),Le.dataChanged&&b.createElement("span",null,"Data: ",this.counters.dataChanged,"\xA0"),Le.schemaChanged&&b.createElement("span",null,"Schema: ",this.counters.schemaChanged,"\xA0"),b.createElement("span",null,"TIME: ",et,"ms"))),ge.series&&ge.series.map((xt,Bt)=>b.createElement("div",{key:`${Bt}/${xt.refId}`},b.createElement("h4",null,(0,gs.Ri)(xt,Bt)," (",xt.length,")"),b.createElement("table",{className:"filter-table"},b.createElement("thead",null,b.createElement("tr",null,b.createElement("td",null,"Field"),b.createElement("td",null,"Type"),b.createElement("td",null,"Last"))),b.createElement("tbody",null,xt.fields.map((jt,qt)=>{const sn=ot.reduce(jt,!1,!1)[ot.id];return b.createElement("tr",{key:`${qt}/${jt.name}`},b.createElement("td",null,(0,gs.Ct)(jt,xt,ge.series)),b.createElement("td",null,jt.type),b.createElement("td",null,`${sn}`))}))))))}}var ws=e(88575),Xc=e(10354);function as(Y){const ge=(0,Ka.d2)(),Pe=Le=>{ge.onInstanceStateChange({name:Le.currentTarget.value})};return b.createElement(b.Fragment,null,b.createElement(ws.D,{label:"State name"},b.createElement(Xc.p,{value:ge.instanceState?.name??"",onChange:Pe})))}function bu({value:Y,context:ge,onChange:Pe,item:Le}){return b.createElement("div",null,"Current value: ",ge.instanceState?.name," ")}var Dr=(Y=>(Y.Cursor="cursor",Y.Events="events",Y.Render="render",Y.State="State",Y.ThrowError="ThrowError",Y))(Dr||{});class Cu extends b.Component{render(){const{options:ge}=this.props;switch(ge.mode){case Dr.Events:return b.createElement(Yc,{eventBus:this.props.eventBus});case Dr.Cursor:return b.createElement(Zs,{eventBus:this.props.eventBus});case Dr.State:return b.createElement(as,{...this.props});case Dr.ThrowError:throw new Error("I failed you and for that i am deeply sorry");default:return b.createElement(Pu,{...this.props})}}}const Ql=new M.m(Cu).useFieldConfig().setPanelOptions(Y=>{Y.addSelect({path:"mode",name:"Mode",defaultValue:Dr.Render,settings:{options:[{label:"Render",value:Dr.Render},{label:"Events",value:Dr.Events},{label:"Cursor",value:Dr.Cursor},{label:"Cursor",value:Dr.Cursor},{label:"Share state",value:Dr.State},{label:"Throw error",value:Dr.ThrowError}]}}).addCustomEditor({id:"stateView",path:"stateView",name:"State view",defaultValue:"",showIf:({mode:ge})=>ge===Dr.State,editor:bu}).addBooleanSwitch({path:"counters.render",name:"Render Count",defaultValue:!0,showIf:({mode:ge})=>ge===Dr.Render}).addBooleanSwitch({path:"counters.dataChanged",name:"Data Changed Count",defaultValue:!0,showIf:({mode:ge})=>ge===Dr.Render}).addBooleanSwitch({path:"counters.schemaChanged",name:"Schema Changed Count",defaultValue:!0,showIf:({mode:ge})=>ge===Dr.Render}).addDashboardPicker({path:"dashboardUID",name:"Dashboard",settings:{placeholder:"Select dashboard",isClearable:!0}})});var Yl=e(76365),Tu=e(85194);function tl(Y,ge={}){(0,Ie.rR)(`grafana_flamegraph_${Y}`,{app:O.Jk.Unknown,grafana_version:x.$.buildInfo.version,...ge})}const Su=Y=>{const ge=(0,Yl.oA)(Y.data.series[0]);return ge?b.createElement(_n.a,{panelId:Y.id,data:Y.data,message:(0,Yl.Ik)(ge)}):b.createElement(Tu.A,{data:Y.data.series[0],stickyHeader:!1,getTheme:()=>x.$.theme2,showFlameGraphOnly:Y.options?.showFlameGraphOnly??!1,onTableSymbolClick:()=>tl("table_item_selected"),onViewSelected:Pe=>tl("view_selected",{view:Pe}),onTextAlignSelected:Pe=>tl("text_align_selected",{align:Pe}),onTableSort:Pe=>tl("table_sort_selected",{sort:Pe}),disableCollapsing:!x.$.featureToggles.flameGraphItemCollapsing})};class Mu{getListWithDefaults(ge){return ge.getListAppender({name:ra.m.FlameGraph,pluginId:"flamegraph"})}getSuggestionsForData(ge){if(!ge.data)return;const Pe=ge.data.series[0];!Pe||(0,Yl.oA)(Pe)||this.getListWithDefaults(ge).append({name:ra.m.FlameGraph})}}const xu=new M.m(Su).setSuggestionsSupplier(new Mu);var Ou=e(14738),Iu=e(62930);const Zc=(Y,ge)=>{const Pe="linear-gradient(to right, #5182CC 0%, #245BAF 100%)",Le=ge?Pe:"linear-gradient(to right, #f05a28 0%, #fbca0a 100%)",ze=ge?Pe:"linear-gradient(to right, #FBCA0A 0%, #F05A28 100%)",et=Y.isDark?Le:ze;return`
      background-color: ${Y.colors.background.secondary};
      margin-right: ${Y.spacing(4)};
      border: 1px solid ${Y.colors.border.weak};
      border-bottom-left-radius: ${Y.shape.borderRadius(2)};
      border-bottom-right-radius: ${Y.shape.borderRadius(2)};
      position: relative;
      max-height: 230px;

      ${Y.breakpoints.down("xxl")} {
        margin-right: ${Y.spacing(2)};
      }
      &::before {
        display: block;
        content: ' ';
        position: absolute;
        left: 0;
        right: 0;
        height: 2px;
        top: 0;
        background-image: ${et};
      }
`},Pr=(0,ae.css)`
  padding: 16px;
`,Au=({card:Y})=>{const ge=(0,z.of)(Jl,Y.done);return b.createElement("div",{className:ge.card},b.createElement("div",{className:Pr},b.createElement("a",{href:`${Y.href}?utm_source=grafana_gettingstarted`,className:ge.url,onClick:()=>(0,Ie.rR)("grafana_getting_started_docs",{title:Y.title,link:Y.href})},b.createElement("div",{className:ge.heading},Y.done?"complete":Y.heading),b.createElement("h4",{className:ge.title},Y.title))),b.createElement("a",{href:`${Y.learnHref}?utm_source=grafana_gettingstarted`,className:ge.learnUrl,target:"_blank",rel:"noreferrer",onClick:()=>(0,Ie.rR)("grafana_getting_started_docs",{title:Y.title,link:Y.learnHref})},"Learn how in the docs ",b.createElement(K.I,{name:"external-link-alt"})))},Jl=(Y,ge)=>({card:(0,ae.css)`
      ${Zc(Y,ge)}

      min-width: 230px;

      ${Y.breakpoints.down("md")} {
        min-width: 192px;
      }
    `,heading:(0,ae.css)`
      text-transform: uppercase;
      color: ${ge?Y.v1.palette.blue95:"#FFB357"};
      margin-bottom: ${Y.spacing(2)};
    `,title:(0,ae.css)`
      margin-bottom: ${Y.spacing(2)};
    `,url:(0,ae.css)`
      display: inline-block;
    `,learnUrl:(0,ae.css)`
      border-top: 1px solid ${Y.colors.border.weak};
      position: absolute;
      bottom: 0;
      padding: 8px 16px;
      width: 100%;
    `});var Tl=e(33390);const Ru=({card:Y})=>{const ge=(0,z.of)(Lu,Y.done);return b.createElement("a",{className:ge.card,target:"_blank",rel:"noreferrer",href:`${Y.href}?utm_source=grafana_gettingstarted`,onClick:Pe=>Do(Pe,Y)},b.createElement("div",{className:Pr},b.createElement("div",{className:ge.type},Y.type),b.createElement("div",{className:ge.heading},Y.done?"complete":Y.heading),b.createElement("h4",{className:ge.cardTitle},Y.title),b.createElement("div",{className:ge.info},Y.info)))},Do=(Y,ge)=>{Y.preventDefault(),Tl.A.get(ge.key)||Tl.A.set(ge.key,!0),(0,Ie.rR)("grafana_getting_started_tutorial",{title:ge.title})},Lu=(Y,ge)=>({card:(0,ae.css)`
      ${Zc(Y,ge)}
      width: 460px;
      min-width: 460px;

      ${Y.breakpoints.down("xl")} {
        min-width: 368px;
      }

      ${Y.breakpoints.down("lg")} {
        min-width: 272px;
      }
    `,type:(0,ae.css)`
      color: ${Y.colors.primary.text};
      text-transform: uppercase;
    `,heading:(0,ae.css)`
      text-transform: uppercase;
      color: ${Y.colors.primary.text};
      margin-bottom: ${Y.spacing(1)};
    `,cardTitle:(0,ae.css)`
      margin-bottom: ${Y.spacing(2)};
    `,info:(0,ae.css)`
      margin-bottom: ${Y.spacing(2)};
    `,status:(0,ae.css)`
      display: flex;
      justify-content: flex-end;
    `}),Sl=({step:Y})=>{const ge=(0,z.of)(qc);return b.createElement("div",{className:ge.setup},b.createElement("div",{className:ge.info},b.createElement("h2",{className:ge.title},Y.title),b.createElement("p",null,Y.info)),b.createElement("div",{className:ge.cards},Y.cards.map((Pe,Le)=>{const ze=`${Pe.title}-${Le}`;return Pe.type==="tutorial"?b.createElement(Ru,{key:ze,card:Pe}):b.createElement(Au,{key:ze,card:Pe})})))},qc=Y=>({setup:(0,ae.css)({display:"flex",width:"95%"}),info:(0,ae.css)({width:"172px",marginRight:"5%",[Y.breakpoints.down("xxl")]:{marginRight:Y.spacing(4)},[Y.breakpoints.down("sm")]:{display:"none"}}),title:(0,ae.css)({color:Y.v1.palette.blue95}),cards:(0,ae.css)({overflowX:"auto",overflowY:"hidden",width:"100%",display:"flex",justifyContent:"flex-start"})});var Bu=e(31193);const Ls="Grafana fundamentals",ed="Create users and teams",hs="getting.started.",Vn=`${hs}${Ls.replace(" ","-").trim().toLowerCase()}`,Xl=`${hs}${ed.replace(" ","-").trim().toLowerCase()}`,Uu=()=>[{heading:"Welcome to Grafana",subheading:"The steps below will guide you to quickly finish setting up your Grafana installation.",title:"Basic",info:"The steps below will guide you to quickly finish setting up your Grafana installation.",done:!1,cards:[{type:"tutorial",heading:"Data source and dashboards",title:Ls,info:"Set up and understand Grafana if you have no prior experience. This tutorial guides you through the entire process and covers the \u201CData source\u201D and \u201CDashboards\u201D steps to the right.",href:"https://grafana.com/tutorials/grafana-fundamentals",icon:"grafana",check:()=>Promise.resolve(Tl.A.get(Vn)),key:Vn,done:!1},{type:"docs",title:"Add your first data source",heading:"data sources",icon:"database",learnHref:"https://grafana.com/docs/grafana/latest/features/datasources/add-a-data-source",href:"datasources/new",check:()=>new Promise(Y=>{Y((0,Bu.tR)().getMetricSources().filter(ge=>ge.meta.builtIn!==!0).length>0)}),done:!1},{type:"docs",heading:"dashboards",title:"Create your first dashboard",icon:"apps",href:"dashboard/new",learnHref:"https://grafana.com/docs/grafana/latest/guides/getting_started/#create-a-dashboard",check:async()=>(await(0,tn.AI)().search({limit:1})).length>0,done:!1}]},{heading:"Setup complete!",subheading:"All necessary steps to use Grafana are done. Now tackle advanced steps or make the best use of this home dashboard \u2013 it is, after all, a fully customizable dashboard \u2013 and remove this panel.",title:"Advanced",info:" Manage your users and teams and add plugins. These steps are optional",done:!1,cards:[{type:"tutorial",heading:"Users",title:"Create users and teams",info:"Learn to organize your users in teams and manage resource access and roles.",href:"https://grafana.com/tutorials/create-users-and-teams",icon:"users-alt",key:Xl,check:()=>Promise.resolve(Tl.A.get(Xl)),done:!1},{type:"docs",heading:"plugins",title:"Find and install plugins",learnHref:"https://grafana.com/docs/grafana/latest/plugins/installation",href:"plugins",icon:"plug",check:async()=>{const Y=await(0,tn.AI)().get("/api/plugins",{embedded:0,core:0});return Promise.resolve(Y.length>0)},done:!1}]}];class Nu extends b.PureComponent{constructor(){super(...arguments),this.state={checksDone:!1,currentStep:0,steps:Uu()},this.onForwardClick=()=>{(0,Ie.rR)("grafana_getting_started_button_to_advanced_tutorials"),this.setState(ge=>({currentStep:ge.currentStep+1}))},this.onPreviousClick=()=>{(0,Ie.rR)("grafana_getting_started_button_to_basic_tutorials"),this.setState(ge=>({currentStep:ge.currentStep-1}))},this.dismiss=()=>{const{id:ge}=this.props,Pe=(0,Oe.UA)().getCurrent(),Le=Pe?.getPanelById(ge);(0,Ie.rR)("grafana_getting_started_remove_panel"),Pe?.removePanel(Le),tn.IB.put("/api/user/helpflags/1",void 0,{showSuccessAlert:!1}).then(ze=>{Ze.TP.user.helpFlags1=ze.helpFlags1})}}async componentDidMount(){const{steps:ge}=this.state,Pe=ge.map(async ze=>{const et=ze.cards.map(async xt=>xt.check().then(Bt=>({...xt,done:Bt}))),ot=await Promise.all(et);return{...ze,done:ot.every(xt=>xt.done),cards:ot}}),Le=await Promise.all(Pe);this.setState({currentStep:Le[0].done?1:0,steps:Le,checksDone:!0})}render(){const{checksDone:ge,currentStep:Pe,steps:Le}=this.state,ze=wu(),et=Le[Pe];return b.createElement("div",{className:ze.container},ge?b.createElement(b.Fragment,null,b.createElement(R.$n,{variant:"secondary",fill:"text",className:ze.dismiss,onClick:this.dismiss},"Remove this panel"),Pe===Le.length-1&&b.createElement(R.$n,{className:(0,ae.cx)(ze.backForwardButtons,ze.previous),onClick:this.onPreviousClick,"aria-label":"To basic tutorials",icon:"angle-left",variant:"secondary"}),b.createElement("div",{className:ze.content},b.createElement(Sl,{step:et})),Pe<Le.length-1&&b.createElement(R.$n,{className:(0,ae.cx)(ze.backForwardButtons,ze.forward),onClick:this.onForwardClick,"aria-label":"To advanced tutorials",icon:"angle-right",variant:"secondary"})):b.createElement("div",{className:ze.loading},b.createElement("div",{className:ze.loadingText},"Checking completed setup steps"),b.createElement(Iu.y,{size:"xl",inline:!0})))}}const wu=(0,vt.N)(()=>{const Y=x.$.theme2;return{container:(0,ae.css)({display:"flex",flexDirection:"column",height:"100%",backgroundSize:"cover",padding:`${Y.spacing(4)} ${Y.spacing(2)} 0`}),content:(0,ae.css)({label:"content",display:"flex",justifyContent:"center",[Y.breakpoints.down("xxl")]:{marginLeft:Y.spacing(3),justifyContent:"flex-start"}}),header:(0,ae.css)({label:"header",marginBottom:Y.spacing(3),display:"flex",flexDirection:"column",[Y.breakpoints.down("lg")]:{flexDirection:"row"}}),headerLogo:(0,ae.css)({height:"58px",paddingRight:Y.spacing(2),display:"none",[Y.breakpoints.up("md")]:{display:"block"}}),heading:(0,ae.css)({label:"heading",marginRight:Y.spacing(3),marginBottom:Y.spacing(3),flexGrow:1,display:"flex",[Y.breakpoints.up("md")]:{marginBottom:0}}),backForwardButtons:(0,ae.css)({position:"absolute",top:"50%",transform:"translateY(-50%)"}),previous:(0,ae.css)({left:"10px",[Y.breakpoints.down("md")]:{left:0}}),forward:(0,ae.css)({right:"10px",[Y.breakpoints.down("md")]:{right:0}}),dismiss:(0,ae.css)({alignSelf:"flex-end",textDecoration:"underline",marginBottom:Y.spacing(1)}),loading:(0,ae.css)({display:"flex",justifyContent:"center",alignItems:"center",height:"100%"}),loadingText:(0,ae.css)({marginRight:Y.spacing(1)})}}),Ml=new M.m(Nu).setNoPadding();var qs=e(77678),Zl=e(56675),Zo=e(97706);const nl={bucketCount:30,bucketOffset:0},xl={fillOpacity:80,gradientMode:Je.on.None,lineWidth:1};function td(Y,ge){return Math.floor(Y/ge)*ge}function nd(Y,ge){return Math.ceil(Y/ge)*ge}function ad(Y){return Y.fields[0].type===Mt.PU.string?1:(0,Zo.h)(Y.fields[1].values[0]-Y.fields[0].values[0],9)}function Fu(Y){return Y.fields[0].type===Mt.PU.string?1:(0,Zo.h)(Y.fields[1].values[1]-Y.fields[0].values[1],9)}const Wu=(Y,ge)=>{let{min:Pe,max:Le}=Y.fields[2].config,ze=new nr.e,et=Y.fields[0].type===Mt.PU.string,ot=ad(Y),xt=Fu(Y),Bt=xt/ot,jt=xt!==ot,qt=(Tn,Dn,On,ga,ea,aa)=>{let Gn=Tn.axes[Dn]._space,An=Tn.valToPos(Tn.data[0][0]+ot,"x")-Tn.valToPos(Tn.data[0][0],"x"),ia=td(Pe??Tn.data[0][0],ot),Qn=nd(Le??Tn.data[0][Tn.data[0].length-1]+ot,ot),jn=[],ka=Math.ceil(Gn/An);for(let Qa=0,Ya=ia;Ya<=Qn;Qa++,Ya+=ot)!(Qa%ka)&&jn.push(Ya);return jn};ze.addScale({scaleKey:"x",isTime:!1,distribution:et?Je.L4.Ordinal:jt?Je.L4.Log:Je.L4.Linear,log:2,orientation:Je.Lt.Horizontal,direction:Je.ON.Right,range:jt?(Tn,Dn,On)=>Es.A.rangeLog(Dn,On*Bt,2,!0):(Tn,Dn,On)=>{Pe!=null&&(Dn=Pe),Le!=null&&(On=Le);let ga=Tn.data[0][Tn.data[0].length-1];return Dn=nd(Dn,ot),On=!et&&On===ga?On+ot:td(On,ot),[Dn,On]}}),ze.addScale({scaleKey:"y",isTime:!1,distribution:Je.L4.Linear,orientation:Je.Lt.Vertical,direction:Je.ON.Up,softMin:0});const sn=Y.fields[0].display,un=Tn=>(0,As.cN)(sn(Tn));ze.addAxis({scaleKey:"x",isTime:!1,placement:Je.vM.Bottom,incrs:et?[1]:jt?void 0:qs.rW,splits:jt||et?void 0:qt,values:et?(Tn,Dn)=>Dn:(Tn,Dn)=>{const On=Dn.map(un),ga=On.reduce((An,ia)=>Math.max((0,Wa.kD)(ia,za.pi).width,An),0),aa=Tn.bbox.width/((ga+10)*devicePixelRatio),Gn=Math.ceil(On.length/aa);return On.map((An,ia)=>ia%Gn===0?An:null)},theme:ge});let vn=Y.fields[2].display;ze.addAxis({scaleKey:"y",isTime:!1,placement:Je.vM.Left,formatValue:(Tn,Dn)=>(0,As.cN)(vn(Tn,Dn)),theme:ge}),ze.setCursor({points:{show:!1},drag:{x:!0,y:!1,setScale:!0}});let zn=(0,ls.ro)(sd(Y));ze.setStackingGroups(zn);let Un=Es.A.paths.bars({align:1,size:[1,1/0]}),Kn=0;for(let Tn=2;Tn<Y.fields.length;Tn++){const Dn=Y.fields[Tn];Dn.state=Dn.state??{},Dn.state.seriesIndex=Kn++;const On={...xl,...Dn.config.custom},ga="y",ea=(0,ns.Qi)(Dn),Gn=(0,ns.lz)(Dn,ge).color;ze.addSeries({scaleKey:ga,lineWidth:On.lineWidth,lineColor:Gn,fillOpacity:On.fillOpacity,theme:ge,colorMode:ea,pathBuilder:Un,show:!On.hideFrom?.viz,gradientMode:On.gradientMode,thresholds:Dn.config.thresholds,hardMin:Dn.config.min,hardMax:Dn.config.max,softMin:On.axisSoftMin,softMax:On.axisSoftMax,dataFrameFieldIndex:Dn.state.origin})}return ze},sd=Y=>({...Y,fields:Y.fields.filter(ge=>ge.name!==qs.dA)}),Ku=(Y,ge)=>{for(let Pe=1;Pe<ge.fields.length;Pe++){let Le=ge.fields[Pe].values;for(let ze=0;ze<Le.length;ze++)Le[ze]===0&&(Le[ze]=null)}return(0,ls.bq)(ge,Y.getStackingGroups())};class Vu extends b.Component{constructor(ge){super(ge),this.state=this.prepState(ge)}prepState(ge,Pe=!0){const{alignedFrame:Le}=ge,ze=Pe?Wu(Le,this.props.theme):this.state.config,et=Ku(ze,sd(Le));return{alignedFrame:Le,alignedData:et,config:ze}}renderLegend(ge){const{legend:Pe}=this.props;if(!ge||Pe.showLegend===!1)return null;const Le=this.props.options.combine?[this.props.alignedFrame]:this.props.rawSeries;return b.createElement(ds.$,{data:Le,config:ge,maxHeight:"35%",maxWidth:"60%",...Pe})}componentDidUpdate(ge){const{structureRev:Pe,alignedFrame:Le,bucketSize:ze,bucketCount:et}=this.props;if(Le!==ge.alignedFrame){const ot=this.state.config==null||et!==ge.bucketCount||ze!==ge.bucketSize||this.props.options!==ge.options||this.state.config===void 0||Pe!==ge.structureRev||!Pe,xt=this.prepState(this.props,ot);this.setState(xt)}}render(){const{width:ge,height:Pe,children:Le,alignedFrame:ze}=this.props,{config:et}=this.state;return et?b.createElement(_a.KU,{width:ge,height:Pe,legend:this.renderLegend(et)},(ot,xt)=>b.createElement(Xa.Z,{config:this.state.config,data:this.state.alignedData,width:ot,height:xt},Le?Le(et,ze):null)):null}}const $u=({data:Y,options:ge,width:Pe,height:Le})=>{const ze=(0,z.$j)(),et=(0,b.useMemo)(()=>{if(!Y.series.length)return;if(Y.series.forEach((Bt,jt)=>{Bt.fields.forEach((qt,sn)=>{qt.state={...qt.state,origin:{frameIndex:jt,fieldIndex:sn}}})}),Y.series.length===1){const Bt=(0,qs.ix)(Y.series[0]);if(Bt)return(0,qs.cg)(Bt)}const xt=(0,qs.p3)(Y.series,ge);if(xt)return(0,qs.cg)(xt,ze)},[Y.series,ge,ze]);if(!et||!et.fields.length)return b.createElement("div",{className:"panel-empty"},b.createElement("p",null,"No histogram found in response"));const ot=ad(et);return b.createElement(Vu,{options:ge,theme:ze,legend:ge.legend,rawSeries:Y.series,structureRev:Y.structureRev,width:Pe,height:Le,alignedFrame:et,bucketSize:ot,bucketCount:ge.bucketCount},(xt,Bt)=>null)},rd={stacking:{mode:Je.gs.None,group:"A"}},_u=(Y,ge,Pe,Le)=>{if(ge==="graph"&&Pe.angular.xaxis?.mode==="histogram"){const{fieldConfig:et,options:ot}=od({...Pe.angular,fieldConfig:Le});return Y.fieldConfig=et,ot}return{}};function od(Y){const ge=Y;let Pe={};const Le={legend:{displayMode:Je.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:Je.$N.Single,sort:Je.xB.None},combine:!1};return ge.stack&&(Pe.stacking={mode:ge.percentage?Je.gs.Percent:Je.gs.Normal,group:rd.stacking.group},Le.combine=!1),{fieldConfig:{defaults:(0,w.omitBy)({custom:Pe},w.isNil),overrides:[]},options:Le}}function Ai(Y){if(Y?.length!==1)return!1;const ge=Y[0];if(ge.fields.length<3||!(0,qs.NX)(ge.fields[0].name)||!(0,qs.H1)(ge.fields[1].name))return!1;for(const Pe of ge.fields)if(Pe.type!==Mt.PU.number)return!1;return!0}const zu=new M.m($u).setPanelChangeHandler(_u).setPanelOptions(Y=>{Y.addCustomEditor({id:"__calc__",path:"__calc__",name:"Values",description:"Showing frequencies that are calculated in the query",editor:()=>null,showIf:(ge,Pe)=>Ai(Pe)}).addNumberInput({path:"bucketCount",name:qs.Rt.bucketCount.name,description:qs.Rt.bucketCount.description,settings:{placeholder:`Default: ${nl.bucketCount}`,min:0},showIf:(ge,Pe)=>!Ai(Pe)}).addNumberInput({path:"bucketSize",name:qs.Rt.bucketSize.name,description:qs.Rt.bucketSize.description,settings:{placeholder:"Auto",min:0},defaultValue:nl.bucketSize,showIf:(ge,Pe)=>!Ai(Pe)}).addNumberInput({path:"bucketOffset",name:qs.Rt.bucketOffset.name,description:qs.Rt.bucketOffset.description,settings:{placeholder:`Default: ${nl.bucketOffset}`,min:0},showIf:(ge,Pe)=>!Ai(Pe)}).addBooleanSwitch({path:"combine",name:qs.Rt.combine.name,description:qs.Rt.combine.description,defaultValue:nl.combine,showIf:(ge,Pe)=>!Ai(Pe)}),Wn.H(Y)}).useFieldConfig({standardOptions:{[yt.uo.Color]:{settings:{byValueSupport:!1,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:At.Y.PaletteClassic}}},useCustomConfig:Y=>{const ge=xl;Y.addCustomEditor({id:"stacking",path:"stacking",name:"Stacking",category:["Histogram"],defaultValue:rd.stacking,editor:Zl.m,override:Zl.m,settings:{options:Nn.t.stacking},process:Kt.hS,shouldApply:Pe=>Pe.type===Mt.PU.number,showIf:(Pe,Le)=>!Ai(Le)}).addSliderInput({path:"lineWidth",name:"Line width",defaultValue:ge.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:ge.fillOpacity,settings:{min:0,max:100,step:1}}).addRadio({path:"gradientMode",name:"Gradient mode",defaultValue:Nn.t.fillGradient[0].value,settings:{options:Nn.t.fillGradient}}),Fn.e(Y)}});var br=e(55004),al=e(60029),Ol=e(39408);const ql=[{label:"Grafana",value:br.qD.Grafana,description:"Core grafana live features"},{label:"Data Sources",value:br.qD.DataSource,description:"Data sources with live support"},{label:"Plugins",value:br.qD.Plugin,description:"Plugins with live support"},{label:"Stream",value:br.qD.Stream,description:"data streams (eg, influx style)"}];function ku(Y){const[ge,Pe]=(0,b.useState)([]),[Le,ze]=(0,b.useMemo)(()=>{const un=[],Zt=[],vn=Y.value.scope,zn=Y.value.namespace;if(!vn?.length)return[un,Zt];const Un={};for(let Kn of ge){const Tn=(0,br.DG)(Kn.value);!Tn||Tn.scope!==vn||(Un[Tn.namespace]||(un.push({value:Tn.namespace,label:Tn.namespace}),Un[Tn.namespace]=!0),zn?.length&&zn===Tn.namespace&&Zt.push({...Kn,value:Tn.path}))}return[un,Zt]},[ge,Y.value.scope,Y.value.namespace]);(0,b.useEffect)(()=>{(0,Ol.l)().then(un=>{Pe(un.channels)})},[Y.value.scope]);const et=un=>{un.value&&Y.onChange({scope:un.value,namespace:void 0,path:void 0})},ot=un=>{Y.onChange({scope:Y.value?.scope,namespace:un?.value,path:void 0})},xt=un=>{const{value:Zt,onChange:vn}=Y;vn({scope:Zt.scope,namespace:Zt.namespace,path:un?.value})},{scope:Bt,namespace:jt,path:qt}=Y.value,sn=Hu(fe.config.theme2);return b.createElement(b.Fragment,null,b.createElement(ue.F,{title:"Grafana Live",severity:"info"},"This supports real-time event streams in grafana core. This feature is under heavy development. Expect the intefaces and structures to change as this becomes more production ready."),b.createElement("div",null,b.createElement("div",{className:sn.dropWrap},b.createElement(al.J,null,"Scope"),b.createElement(V.l6,{options:ql,value:ql.find(un=>un.value===Bt),onChange:et})),Bt&&b.createElement("div",{className:sn.dropWrap},b.createElement(al.J,null,"Namespace"),b.createElement(V.l6,{options:Le,value:Le.find(un=>un.value===jt)??(jt?{label:jt,value:jt}:void 0),onChange:ot,allowCustomValue:!0,backspaceRemovesValue:!0,isClearable:!0})),Bt&&jt&&b.createElement("div",{className:sn.dropWrap},b.createElement(al.J,null,"Path"),b.createElement(V.l6,{options:ze,value:Il(ze,qt),onChange:xt,allowCustomValue:!0,backspaceRemovesValue:!0,isClearable:!0}))))}function Il(Y,ge){const Pe=Y.find(Le=>Le.value===ge);if(Pe)return Pe;if(ge)return{label:ge,value:ge}}const Hu=(0,vt.N)(Y=>({dropWrap:(0,ae.css)`
    margin-bottom: ${Y.spacing(1)};
  `}));var id=e(9631),Gu=e(90708),ir=e(39070),ec=e(78731),ju=e(24022),mi=e(94624),fi=e(1173),Qu=e(77093),Al=e(65885);function gi(Y){const{data:ge,height:Pe,width:Le,options:ze,fieldConfig:et,id:ot,timeRange:xt}=Y,Bt=(0,z.$j)(),jt=(0,Ka.d2)(),qt=(0,Al.gy)(ge.series)?(0,Al.S5)(ge.series):ge.series,sn=qt?.length,un=qt[0]?.fields.length,Zt=Yu(qt,ze),vn=qt[Zt];let zn=Pe;if(!sn||!un)return b.createElement(_n.a,{panelId:ot,fieldConfig:et,data:ge});if(sn>1){const Dn=Bt.spacing.gridSize*Bt.components.height.md,On=Bt.spacing.gridSize;zn=Pe-Dn-On}const Un=jt.sync&&jt.sync()!==mi.y.Off,Kn=b.createElement(Qu.X,{height:zn,width:Le,data:vn,noHeader:!ze.showHeader,showTypeIcons:ze.showTypeIcons,resizable:!0,initialSortBy:ze.sortBy,onSortByChange:Dn=>Xu(Dn,Y),onColumnResize:(Dn,On)=>Ju(Dn,On,Y),onCellFilterAdded:jt.onAddAdHocFilter,footerOptions:ze.footer,enablePagination:ze.footer?.enablePagination,cellHeight:ze.cellHeight,timeRange:xt,enableSharedCrosshair:x.$.featureToggles.tableSharedCrosshair&&Un,fieldConfig:et});if(sn===1)return Kn;const Tn=qt.map((Dn,On)=>({label:(0,gs.Ri)(Dn),value:On}));return b.createElement("div",{className:ld.wrapper},Kn,b.createElement("div",{className:ld.selectWrapper},b.createElement(V.l6,{options:Tn,value:Tn[Zt],onChange:Dn=>Zu(Dn,Y)})))}function Yu(Y,ge){return ge.frameIndex>0&&ge.frameIndex<Y.length?ge.frameIndex:0}function Ju(Y,ge,Pe){const{fieldConfig:Le}=Pe,{overrides:ze}=Le,et=fi.Ct.byName,ot="custom.width",xt=ze.find(Bt=>Bt.matcher.id===et&&Bt.matcher.options===Y);if(xt){const Bt=xt.properties.find(jt=>jt.id===ot);Bt?Bt.value=ge:xt.properties.push({id:ot,value:ge})}else ze.push({matcher:{id:et,options:Y},properties:[{id:ot,value:ge}]});Pe.onFieldConfigChange({...Le,overrides:ze})}function Xu(Y,ge){ge.onOptionsChange({...ge.options,sortBy:Y})}function Zu(Y,ge){ge.onOptionsChange({...ge.options,frameIndex:Y.value||0})}const ld={wrapper:(0,ae.css)`
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100%;
  `,selectWrapper:(0,ae.css)`
    padding: 8px 8px 0px 8px;
  `};var tc=e(32372),Po=(Y=>(Y.Raw="raw",Y.JSON="json",Y.Auto="auto",Y.None="none",Y))(Po||{}),kr=(Y=>(Y.None="none",Y.JSON="json",Y.Influx="influx",Y))(kr||{});function qu({height:Y,mode:ge,body:Pe,addr:Le,onSave:ze}){const et=(0,b.useMemo)(()=>ge===kr.JSON?Pe?JSON.stringify(Pe,null,2):"{ }":Pe==null?"":`${Pe}`,[ge,Pe]),ot=Bt=>{ge===kr.JSON?ze(JSON.parse(Bt)):ze(Bt)},xt=async()=>{if(ge===kr.Influx){if(Le?.scope!=="stream"){alert("expected stream scope!");return}return(0,In.AI)().post(`api/live/push/${Le.namespace}`,Pe)}if(!(0,br.aj)(Le)){alert("invalid address");return}const Bt=await(0,ec.oF)().publish(Le,Pe);console.log("onPublishClicked (response from publish)",Bt)};return b.createElement(b.Fragment,null,b.createElement(tc.B,{height:Y-32,language:ge===kr.JSON?"json":"text",value:et,onBlur:ot,onSave:ot,showMiniMap:!1,showLineNumbers:!0}),b.createElement("div",{style:{height:32}},b.createElement(R.$n,{onClick:xt},"Publish")))}class em extends b.PureComponent{constructor(ge){super(ge),this.styles=tm(x.$.theme2),this.streamObserver={next:Pe=>{(0,br.ew)(Pe)?this.setState({status:Pe,changed:Date.now()}):(0,br.Z7)(Pe)?this.setState({message:Pe.message,changed:Date.now()}):console.log("ignore",Pe)}},this.unsubscribe=()=>{this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0)},this.isValid=!!(0,ec.oF)(),this.state={changed:0}}async componentDidMount(){this.loadChannel()}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(ge){this.props.options?.channel!==ge.options?.channel&&this.loadChannel()}async loadChannel(){const ge=this.props.options?.channel;if(!(0,br.aj)(ge)){console.log("INVALID",ge),this.unsubscribe(),this.setState({addr:void 0});return}if((0,w.isEqual)(ge,this.state.addr)){console.log("Same channel",this.state.addr);return}const Pe=(0,ec.oF)();if(!Pe){console.log("INVALID",ge),this.unsubscribe(),this.setState({addr:void 0});return}this.unsubscribe(),console.log("LOAD",ge);try{this.subscription=Pe.getStream(ge).subscribe(this.streamObserver),this.setState({addr:ge,error:void 0})}catch(Le){this.setState({addr:void 0,error:Le})}}renderNotEnabled(){return b.createElement(ue.F,{title:"Grafana Live",severity:"info"},b.createElement("p",null,"Grafana live requires a feature flag to run"),b.createElement("b",null,"custom.ini:"),b.createElement("pre",null,`[feature_toggles]
    enable = live`))}renderMessage(ge){const{options:Pe}=this.props,{message:Le}=this.state;if(!Le)return b.createElement("div",null,b.createElement("h4",null,"Waiting for data:"),Pe.channel?.scope,"/",Pe.channel?.namespace,"/",Pe.channel?.path);if(Pe.display===Po.JSON)return b.createElement(ju.B,{json:Le,open:5});if(Pe.display===Po.Auto&&Le instanceof id.k9){const ze={series:(0,Gu.we)({data:[Le],theme:x.$.theme2,replaceVariables:ot=>ot,fieldConfig:{defaults:{},overrides:[]}}),state:ir.Gu.Streaming},et={...this.props,options:{frameIndex:0,showHeader:!0}};return b.createElement(gi,{...et,data:ze,height:ge})}return b.createElement("pre",null,JSON.stringify(Le))}renderPublish(ge){const{options:Pe}=this.props;return b.createElement(qu,{height:ge,body:Pe.message,mode:Pe.publish??kr.JSON,onSave:Le=>this.props.onOptionsChange({...Pe,message:Le}),addr:this.state.addr})}renderStatus(){const{status:ge}=this.state;if(ge?.state===br.ZF.Connected)return;let Pe="";return ge&&(Pe=this.styles.status[ge.state]),b.createElement("div",{className:(0,ae.cx)(Pe,this.styles.statusWrap)},ge?.state)}renderBody(){const{status:ge}=this.state,{options:Pe,height:Le}=this.props;if(Pe.publish===kr.JSON||Pe.publish===kr.Influx){if(Pe.display===Po.None)return this.renderPublish(Le);const et=Le/2;return b.createElement("div",null,b.createElement("div",{style:{height:et,overflow:"hidden"}},b.createElement(te.E,{autoHeightMin:"100%",autoHeightMax:"100%"},this.renderMessage(et))),b.createElement("div",null,this.renderPublish(et)))}return Pe.display===Po.None?b.createElement("pre",null,JSON.stringify(ge)):b.createElement("div",{style:{overflow:"hidden",height:Le}},b.createElement(te.E,{autoHeightMin:"100%",autoHeightMax:"100%"},this.renderMessage(Le)))}render(){if(!this.isValid)return this.renderNotEnabled();const{addr:ge,error:Pe}=this.state;return ge?Pe?b.createElement("div",null,b.createElement("h2",null,"ERROR"),b.createElement("div",null,JSON.stringify(Pe))):b.createElement(b.Fragment,null,this.renderStatus(),this.renderBody()):b.createElement(ue.F,{title:"Grafana Live",severity:"info"},"Use the panel editor to pick a channel")}}const tm=(0,vt.N)(Y=>({statusWrap:(0,ae.css)`
    margin: auto;
    position: absolute;
    top: 0;
    right: 0;
    background: ${Y.components.panel.background};
    padding: 10px;
    z-index: ${Y.zIndex.modal};
  `,status:{[br.ZF.Pending]:(0,ae.css)`
      border: 1px solid ${Y.v1.palette.orange};
    `,[br.ZF.Connected]:(0,ae.css)`
      border: 1px solid ${Y.colors.success.main};
    `,[br.ZF.Connecting]:(0,ae.css)`
      border: 1px solid ${Y.v1.palette.brandWarning};
    `,[br.ZF.Disconnected]:(0,ae.css)`
      border: 1px solid ${Y.colors.warning.main};
    `,[br.ZF.Shutdown]:(0,ae.css)`
      border: 1px solid ${Y.colors.error.main};
    `,[br.ZF.Invalid]:(0,ae.css)`
      border: 1px solid red;
    `}})),nm=new M.m(em).setPanelOptions(Y=>{Y.addCustomEditor({category:["Channel"],id:"channel",path:"channel",name:"Channel",editor:ku,defaultValue:{}}),Y.addRadio({path:"display",name:"Show Message",description:"Display the last message received on this channel",settings:{options:[{value:Po.Raw,label:"Raw Text"},{value:Po.JSON,label:"JSON"},{value:Po.Auto,label:"Auto"},{value:Po.None,label:"None"}]},defaultValue:Po.JSON}).addRadio({path:"publish",name:"Publish",description:"Display a form to publish values",settings:{options:[{value:kr.None,label:"None"},{value:kr.JSON,label:"JSON"},{value:kr.Influx,label:"Influx"}]},defaultValue:kr.None})});var pi=e(9557),dp=e(96192),am=e(81166),Pa=e(17888),er=e(7030),sm=e(93463),Vs=e(14647),sl=e(69147),hi=e(16817),cd=e(19347);const rm=Y=>{const[ge,Pe]=(0,b.useState)(new Map);return(0,hi.A)(async()=>{if(!Y){Pe(new Map);return}const Le=await Promise.all(Y.filter(ze=>!!ze.datasource?.uid).map(ze=>(0,cd.l)().get(ze.datasource?.uid).then(et=>({key:ze.refId,ds:et}))));Pe(new Map(Le.map(({key:ze,ds:et})=>[ze,et])))},[Y]),ge},om={},Ri=({data:Y,timeZone:ge,fieldConfig:Pe,options:{showLabels:Le,showTime:ze,wrapLogMessage:et,showCommonLabels:ot,prettifyLogMessage:xt,sortOrder:Bt,dedupStrategy:jt,enableLogDetails:qt,showLogContextToggle:sn},id:un})=>{const Zt=Bt===Je.uH.Ascending,vn=(0,z.of)(rl),[zn,Un]=(0,b.useState)(0),Kn=(0,b.useRef)(null),[Tn,Dn]=(0,b.useState)(null),On=Y.timeRange,ga=rm(Y.request?.targets),[ea,aa]=(0,b.useState)(null);let Gn=(0,b.useRef)();const{eventBus:An}=(0,Ka.d2)(),ia=(0,b.useCallback)(pa=>{pa?An.publish(new on.b_({point:{time:pa.timeEpochMs}})):An.publish(new on.ql)},[An]),Qn=(0,b.useCallback)(()=>{Dn(null),Gn.current&&Gn.current()},[Gn]),jn=(0,b.useCallback)((pa,Ma)=>{Dn(pa),Gn.current=Ma},[Gn]),ka=(0,b.useCallback)(async pa=>await Rl(pa,On),[On]),Qa=(0,b.useCallback)(pa=>{if(!pa.dataFrame.refId||!ga||!sn&&Y.request?.app!==O.Jk.Dashboard&&Y.request?.app!==O.Jk.PanelEditor&&Y.request?.app!==O.Jk.PanelViewer)return!1;const Ma=ga.get(pa.dataFrame.refId);return(0,pi.Ol)(Ma)},[ga,sn,Y.request?.app]),Ya=(0,b.useCallback)(()=>!(Y.request?.app!==O.Jk.Dashboard&&Y.request?.app!==O.Jk.PanelEditor&&Y.request?.app!==O.Jk.PanelViewer),[Y.request?.app]),Ba=(0,b.useCallback)(async(pa,Ma,Za)=>{if(!Ma.dataFrame.refId||!ga)return Promise.resolve({data:[]});const rs=Y.request?.targets[0];if(!rs)return Promise.resolve({data:[]});const vs=ga.get(Ma.dataFrame.refId);return(0,pi.Ol)(vs)?vs.getLogRowContext(pa,Za,rs):Promise.resolve({data:[]})},[Y.request?.targets,ga]),Ia=(0,b.useCallback)((pa,Ma)=>{if(!pa.dataFrame.refId||!ga)return b.createElement(b.Fragment,null);const Za=Y.request?.targets[0];if(!Za)return b.createElement(b.Fragment,null);const rs=ga.get(pa.dataFrame.refId);return!(0,pi.wj)(rs)||!rs.getLogRowContextUi?b.createElement(b.Fragment,null):rs.getLogRowContextUi(pa,Ma,Za)},[Y.request?.targets,ga]),[Ea,ja,fs]=(0,b.useMemo)(()=>{const pa=Y?(0,sl.HT)(Y.series,Y.request?.intervalMs,void 0,Y.request?.targets):null,Ma=pa?.rows||[],Za=pa?.meta?.find(vs=>vs.label===sl.yR),rs=(0,sl.M0)(Ma,jt);return[Ma,rs,Za]},[Y,jt]);(0,b.useLayoutEffect)(()=>{Zt&&Kn.current?Un(Kn.current.offsetHeight):Un(0)},[Zt,Ea]);const Bs=(0,b.useCallback)((pa,Ma)=>(0,dp.QL)({field:pa,rowIndex:Ma,range:Y.timeRange}),[Y]),Sa=(0,b.useCallback)(pa=>{ea?.scrollTo({top:pa.offsetTop,behavior:"smooth"})},[ea]);if(!Y||Ea.length===0)return b.createElement(Pa.a,{fieldConfig:Pe,panelId:un,data:Y,needsStringField:!0});const ya=()=>b.createElement("div",{className:(0,ae.cx)(vn.labelContainer,Zt&&vn.labelContainerAscending)},b.createElement("span",{className:vn.label},"Common labels:"),b.createElement(sm.h,{labels:typeof fs?.value=="object"?fs?.value:om,emptyMessage:"(no common labels)"}));return b.createElement(b.Fragment,null,Tn&&b.createElement(am.V,{open:Tn!==null,row:Tn,onClose:Qn,getRowContext:(pa,Ma)=>Ba(pa,Tn,Ma),logsSortOrder:Bt,timeZone:ge,getLogRowContextUi:Ia}),b.createElement(te.E,{autoHide:!0,scrollTop:zn,scrollRefCallback:pa=>aa(pa)},b.createElement("div",{className:vn.container,ref:Kn},ot&&!Zt&&ya(),b.createElement(Vs.k,{containerRendered:Kn.current!==null,scrollIntoView:Sa,permalinkedRowId:ol()?.logs?.id??void 0,onPermalinkClick:Ya()?ka:void 0,logRows:Ea,showContextToggle:Qa,deduplicatedRows:ja,dedupStrategy:jt,showLabels:Le,showTime:ze,wrapLogMessage:et,prettifyLogMessage:xt,timeZone:ge,getFieldLinks:Bs,logsSortOrder:Bt,enableLogDetails:qt,previewLimit:Zt?Ea.length:void 0,onLogRowHover:ia,app:O.Jk.Dashboard,onOpenContext:jn}),ot&&Zt&&ya())))},rl=Y=>({container:(0,ae.css)({marginBottom:Y.spacing(1.5)}),labelContainer:(0,ae.css)({margin:Y.spacing(0,0,.5,.5),display:"flex",alignItems:"center"}),labelContainerAscending:(0,ae.css)({margin:Y.spacing(.5,0,.5,0)}),label:(0,ae.css)({marginRight:Y.spacing(.5),fontSize:Y.typography.bodySmall.fontSize,fontWeight:Y.typography.fontWeightMedium})});function ol(){const ge=ci.kM.getUrlSearchParams()?.panelState;if(ge&&Array.isArray(ge)&&ge?.length>0&&typeof ge[0]=="string")try{return JSON.parse(ge[0])}catch(Pe){console.error("error parsing logsPanelState",Pe)}}async function Rl(Y,ge){if(Y.rowId===void 0||!Y.dataFrame.refId)return;const Pe={logs:{id:Y.uid}},Le=new URL(window.location.href);return Le.searchParams.set("panelState",JSON.stringify(Pe)),Le.searchParams.set("from",(0,ln.yT)(ge.from).valueOf().toString(10)),Le.searchParams.set("to",(0,ln.yT)(ge.to).valueOf().toString(10)),await(0,er.VP)(Le.toString()),Promise.resolve()}class nc{getSuggestionsForData(ge){const Pe=ge.getListAppender({name:"",pluginId:"logs",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}),{dataSummary:Le}=ge;!Le.hasData||!Le.hasTimeField||!Le.hasStringField||(Le.preferredVisualisationType==="logs"?Pe.append({name:ra.m.Logs,score:Jt.nQ.Best}):Pe.append({name:ra.m.Logs}))}}const im=new M.m(Ri).setPanelOptions(Y=>{Y.addBooleanSwitch({path:"showTime",name:"Time",description:"",defaultValue:!1}).addBooleanSwitch({path:"showLabels",name:"Unique labels",description:"",defaultValue:!1}).addBooleanSwitch({path:"showCommonLabels",name:"Common labels",description:"",defaultValue:!1}).addBooleanSwitch({path:"wrapLogMessage",name:"Wrap lines",description:"",defaultValue:!1}).addBooleanSwitch({path:"prettifyLogMessage",name:"Prettify JSON",description:"",defaultValue:!1}).addBooleanSwitch({path:"enableLogDetails",name:"Enable log details",description:"",defaultValue:!0}).addRadio({path:"dedupStrategy",name:"Deduplication",description:"",settings:{options:[{value:Je.fY.none,label:"None",description:pi._C[Je.fY.none]},{value:Je.fY.exact,label:"Exact",description:pi._C[Je.fY.exact]},{value:Je.fY.numbers,label:"Numbers",description:pi._C[Je.fY.numbers]},{value:Je.fY.signature,label:"Signature",description:pi._C[Je.fY.signature]}]},defaultValue:Je.fY.none}).addRadio({path:"sortOrder",name:"Order",description:"",settings:{options:[{value:Je.uH.Descending,label:"Newest first"},{value:Je.uH.Ascending,label:"Oldest first"}]},defaultValue:Je.uH.Descending})}).setSuggestionsSupplier(new nc);var dd=e(69386),ud=e(62372),lm=e(4172);function cm(Y){const{width:ge,options:{feedUrl:Pe=ud.$,showImage:Le}}=Y,{state:ze,getNews:et}=(0,lm.n)(Pe);return(0,b.useEffect)(()=>{const ot=Y.eventBus.subscribe(ee._,et);return()=>{ot.unsubscribe()}},[et,Y.eventBus]),(0,b.useEffect)(()=>{et()},[et]),ze.error?b.createElement(ue.F,{title:"Error loading RSS feed"},"Make sure that the feed URL is correct and that CORS is configured correctly on the server. See"," ",b.createElement("a",{style:{textDecoration:"underline"},href:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/news/"},"News panel documentation. ",b.createElement(K.I,{name:"external-link-alt"}))):ze.loading?b.createElement("div",null,"Loading..."):ze.value?b.createElement(te.E,{autoHeightMin:"100%",autoHeightMax:"100%"},ze.value.map((ot,xt)=>b.createElement(dd.K,{key:xt,index:xt,width:ge,showImage:Le,data:ze.value}))):null}const md={showImage:!0},dm=new M.m(cm).setPanelOptions(Y=>{Y.addTextInput({path:"feedUrl",name:"URL",description:"Supports RSS and Atom feeds",settings:{placeholder:ud.$},defaultValue:md.feedUrl}).addBooleanSwitch({path:"showImage",name:"Show image",description:"Controls if the news item social (og:image) image is shown above text content",defaultValue:md.showImage})});var um=e(56323),mm=e(29995),fm=e(89227),ac=e(98361),Ll=e(33434),gm=e(44916),pm=e(4118),fd=e(35472),sc=e(84140),gd=e(59796),hm=e(3139),vm=e(16797);let Em=0;const ym=()=>Em++;function Dm(Y){const ge=(0,b.useRef)(null);return ge.current===null&&(ge.current=Y+ym()),ge.current.toString()}var Vo=(Y=>(Y.Donut="donut",Y.Pie="pie",Y))(Vo||{}),Hr=(Y=>(Y.Name="name",Y.Percent="percent",Y.Value="value",Y))(Hr||{}),qo=(Y=>(Y.Percent="percent",Y.Value="value",Y))(qo||{});const Pm={values:[]},bm={displayLabels:[]};function pd(Y){return!Y.field.custom?.hideFrom?.viz&&!isNaN(Y.display.numeric)}function hd(Y,ge){return ge.display.numeric+Y}const Cm=({fieldDisplayValues:Y,pieType:ge,width:Pe,height:Le,highlightedTitle:ze,displayLabels:et=[],tooltipOptions:ot})=>{const xt=(0,z.$j)(),Bt=Dm("PieChart"),jt=(0,z.of)(oc),qt=(0,pm.A)(),{containerRef:sn,TooltipInPortal:un}=(0,fd.A)({detectBounds:!0,scroll:!0}),Zt=Y.filter(pd),vn=ea=>ea.display.numeric,zn=ea=>`${Bt}-${(0,sc.A)(ea).toHex()}`,Un=ea=>`url(#${zn(ea)})`,Kn=et.length>0,Tn=ot.mode!=="none"&&qt.tooltipOpen,Dn=Zt.reduce(hd,0),On=xm(Pe,Le,ge),ga=[...new Set(Zt.map(ea=>ea.display.color??At.F))];return b.createElement("div",{className:jt.container},b.createElement("svg",{width:On.size,height:On.size,ref:sn,style:{overflow:"visible"}},b.createElement(Ll.A,{top:On.position,left:On.position},ga.map(ea=>b.createElement(ac.A,{key:ea,id:zn(ea),from:Sm(ea,xt),to:Mm(ea,xt),fromOffset:On.gradientFromOffset,toOffset:"1",gradientUnits:"userSpaceOnUse",cx:0,cy:0,radius:On.outerRadius})),b.createElement(gm.A,{data:Zt,pieValue:vn,outerRadius:On.outerRadius,innerRadius:On.innerRadius,cornerRadius:3,padAngle:.005},ea=>b.createElement(b.Fragment,null,ea.arcs.map(aa=>{const Gn=aa.data.display.color??At.F,An=vd(ze,aa);return aa.data.hasLinks&&aa.data.getLinks?b.createElement(gd.e,{key:aa.index,links:aa.data.getLinks},ia=>b.createElement(rc,{tooltip:qt,highlightState:An,arc:aa,pie:ea,fill:Un(Gn),openMenu:ia.openMenu,tooltipOptions:ot})):b.createElement(rc,{key:aa.index,highlightState:An,tooltip:qt,arc:aa,pie:ea,fill:Un(Gn),tooltipOptions:ot})}),Kn&&ea.arcs.map(aa=>{const Gn=vd(ze,aa);return b.createElement(Bl,{arc:aa,key:aa.index,highlightState:Gn,outerRadius:On.outerRadius,innerRadius:On.innerRadius,displayLabels:et,total:Dn,color:xt.colors.text.primary})}))))),Tn?b.createElement(un,{key:Math.random(),top:qt.tooltipTop,className:jt.tooltipPortal,left:qt.tooltipLeft,unstyled:!0,applyPositionStyle:!0},b.createElement(hm.o,{series:qt.tooltipData})):null)};function rc({arc:Y,pie:ge,highlightState:Pe,openMenu:Le,fill:ze,tooltip:et,tooltipOptions:ot}){const xt=(0,z.$j)(),Bt=(0,z.of)(oc),{eventBus:jt}=(0,Ka.d2)(),qt=(0,b.useCallback)(Zt=>{jt?.publish({type:on.ql.type,payload:{raw:Zt,x:0,y:0,dataId:Y.data.display.title}}),et.hideTooltip()},[jt,Y,et]),sn=(0,b.useCallback)(Zt=>{jt?.publish({type:on.b_.type,payload:{raw:Zt,x:0,y:0,dataId:Y.data.display.title}});const vn=Zt.currentTarget.ownerSVGElement;if(vn){const zn=(0,fm.A)(vn,Zt);et.showTooltip({tooltipLeft:zn.x,tooltipTop:zn.y,tooltipData:il(ge,Y,ot)})}},[jt,Y,et,ge,ot]),un=Ed(Pe,Bt);return b.createElement("g",{key:Y.data.display.title,className:un,onMouseMove:ot.mode!=="none"?sn:void 0,onMouseOut:qt,onClick:Le,"data-testid":Nr.Tp.components.Panels.Visualization.PieChart.svgSlice},b.createElement("path",{d:ge.path({...Y}),fill:ze,stroke:xt.colors.background.primary,strokeWidth:1}))}function Bl({arc:Y,outerRadius:ge,innerRadius:Pe,displayLabels:Le,total:ze,color:et,highlightState:ot}){const xt=(0,z.of)(oc),Bt=Pe===0?ge/6:Pe,[jt,qt]=Tm(Y,ge,Bt);if(!(Y.endAngle-Y.startAngle>=.3))return null;let un=Le.includes(Hr.Name)?Math.min(Math.max(ge/150*14,12),30):Math.min(Math.max(ge/100*14,12),36);return b.createElement("g",{className:Ed(ot,xt)},b.createElement("text",{fill:et,x:jt,y:qt,dy:".33em",fontSize:un,fontWeight:500,textAnchor:"middle",pointerEvents:"none"},Le.includes(Hr.Name)&&b.createElement("tspan",{x:jt,dy:"1.2em"},Y.data.display.title),Le.includes(Hr.Value)&&b.createElement("tspan",{x:jt,dy:"1.2em"},(0,As.cN)(Y.data.display)),Le.includes(Hr.Percent)&&b.createElement("tspan",{x:jt,dy:"1.2em"},(Y.data.display.numeric/ze*100).toFixed(Y.data.field.decimals??0)+"%")))}function il(Y,ge,Pe){return Pe.mode==="multi"?Y.arcs.filter(Le=>{const ze=Le.data.field;return ze&&!ze.custom?.hideFrom?.tooltip&&!ze.custom?.hideFrom?.viz}).map(Le=>({color:Le.data.display.color??At.F,label:Le.data.display.title,value:(0,As.cN)(Le.data.display),isActive:Le.index===ge.index})):[{color:ge.data.display.color??At.F,label:ge.data.display.title,value:(0,As.cN)(ge.data.display)}]}function Tm(Y,ge,Pe){const Le=(ge+Pe)/2,ze=(+Y.startAngle+ +Y.endAngle)/2-Math.PI/2;return[Math.cos(ze)*Le,Math.sin(ze)*Le]}function Sm(Y,ge){return(0,sc.A)(Y).darken(20*(ge.isDark?1:-.7)).spin(4).toRgbString()}function Mm(Y,ge){return(0,sc.A)(Y).darken(10*(ge.isDark?1:-.7)).spin(-4).toRgbString()}function xm(Y,ge,Pe,Le=16){const ze=Math.min(ge,Y),et=(ze-Le*2)/2,ot=Pe===Vo.Pie?et:Math.max(et/3,20),xt=et-ot,Bt=(ze-Le*2)/2,jt=1-(et-xt)/et;return{position:Bt+Le,size:ze,outerRadius:et,innerRadius:xt,gradientFromOffset:jt}}var Om=(Y=>(Y[Y.Highlighted=0]="Highlighted",Y[Y.Deemphasized=1]="Deemphasized",Y[Y.Normal=2]="Normal",Y))(Om||{});function vd(Y,ge){return Y?Y===ge.data.display.title?0:1:2}function Ed(Y,ge){switch(Y){case 0:return ge.svgArg.highlighted;case 1:return ge.svgArg.deemphasized;case 2:default:return ge.svgArg.normal}}const oc=Y=>({container:(0,ae.css)`
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    `,svgArg:{normal:(0,ae.css)`
        transition: all 200ms ease-in-out;
      `,highlighted:(0,ae.css)`
        transition: all 200ms ease-in-out;
        transform: scale3d(1.03, 1.03, 1);
      `,deemphasized:(0,ae.css)`
        transition: all 200ms ease-in-out;
        fill-opacity: 0.5;
      `},tooltipPortal:(0,ae.css)`
      ${(0,vm.getTooltipContainerStyles)(Y)}
    `}),Im={displayMode:Je.lm.List,showLegend:!0,placement:"right",calcs:[],values:[qo.Percent]};function ic(Y){const{data:ge,timeZone:Pe,fieldConfig:Le,replaceVariables:ze,width:et,height:ot,options:xt,id:Bt}=Y,jt=(0,z.$j)(),qt=Lm(),sn=(0,um.PI)({fieldConfig:Le,reduceOptions:xt.reduceOptions,data:ge.series,theme:jt,replaceVariables:ze,timeZone:Pe});return Rm(sn)?b.createElement(_a.KU,{width:et,height:ot,legend:Am(Y,sn)},(un,Zt)=>b.createElement(Cm,{width:un,height:Zt,highlightedTitle:qt,fieldDisplayValues:sn,tooltipOptions:xt.tooltip,pieType:xt.pieType,displayLabels:xt.displayLabels})):b.createElement(_n.a,{panelId:Bt,fieldConfig:Le,data:ge})}function Am(Y,ge){const Pe=Y.options.legend??Im;if(Pe.showLegend===!1)return;const Le=ge.filter(pd).reduce(hd,0),ze=ge.sort((et,ot)=>isNaN(et.display.numeric)?1:isNaN(ot.display.numeric)?-1:ot.display.numeric-et.display.numeric).map((et,ot)=>{const xt=et.field.custom?.hideFrom??{};if(xt.legend)return;const Bt=!!xt.viz,jt=et.display;return{label:jt.title??"",color:jt.color??At.F,yAxis:1,disabled:Bt,getItemKey:()=>(jt.title??"")+ot,getDisplayValues:()=>{const qt=Pe.values??[];let sn=[];if(qt.includes(qo.Value)&&sn.push({numeric:jt.numeric,text:(0,As.cN)(jt),title:"Value"}),qt.includes(qo.Percent)){const un=Bt?0:jt.numeric/Le,Zt=un*100;sn.push({numeric:un,percent:Zt,text:Bt||isNaN(un)?Y.fieldConfig.defaults.noValue??"-":Zt.toFixed(et.field.decimals??0)+"%",title:qt.length>1?"Percent":""})}return sn}}}).filter(et=>!!et);return b.createElement(_a.KU.Legend,{placement:Pe.placement,width:Pe.width},b.createElement(Is.t,{items:ze,seriesVisibilityChangeBehavior:mm.K.Hide,placement:Pe.placement,displayMode:Pe.displayMode}))}function Rm(Y){return Y.some(ge=>ge.view?.dataFrame.length)}function Lm(){const[Y,ge]=(0,b.useState)(),{eventBus:Pe}=(0,Ka.d2)();return(0,b.useEffect)(()=>{const Le=ot=>{ge(ot.payload.dataId)},ze=ot=>{ge(void 0)},et=new ht.yU;return et.add(Pe.getStream(on.b_).subscribe({next:Le})),et.add(Pe.getStream(on.ql).subscribe({next:ze})),()=>{et.unsubscribe()}},[ge,Pe]),Y}const lc=(Y,ge,Pe)=>{if(ge==="grafana-piechart-panel"&&Pe.angular){const Le=Pe.angular,ze=[];let et=Y.options;if(Le.aliasColors)for(const ot of Object.keys(Le.aliasColors)){const xt=Le.aliasColors[ot];xt&&ze.push({matcher:{id:fi.Ct.byName,options:ot},properties:[{id:yt.uo.Color,value:{mode:At.Y.Fixed,fixedColor:xt}}]})}if(Y.fieldConfig={overrides:ze,defaults:{unit:Le.format,decimals:Le.decimals?Le.decimals:0}},et.legend={placement:"right",values:[],displayMode:Je.lm.Table,showLegend:!0,calcs:[]},Le.valueName)switch(et.reduceOptions={calcs:[]},Le.valueName){case"current":et.reduceOptions.calcs=["lastNotNull"];break;case"min":et.reduceOptions.calcs=["min"];break;case"max":et.reduceOptions.calcs=["max"];break;case"avg":et.reduceOptions.calcs=["mean"];break;case"total":et.reduceOptions.calcs=["sum"];break}switch(Le.legendType){case"Under graph":et.legend.placement="bottom";break;case"Right side":et.legend.placement="right";break}switch(Le.pieType){case"pie":et.pieType=Vo.Pie;break;case"donut":et.pieType=Vo.Donut;break}return Le.legend&&(Le.legend.show||(et.legend.showLegend=!1),Le.legend.values&&et.legend.values.push(qo.Value),Le.legend.percentage&&et.legend.values.push(qo.Percent)),Le.legendType==="On graph"&&(et.legend.showLegend=!1,et.displayLabels=[Hr.Name],Le.legend.values&&et.displayLabels.push(Hr.Value),Le.legend.percentage&&et.displayLabels.push(Hr.Percent)),et}return{}};class Bm{getSuggestionsForData(ge){const Pe=ge.getListAppender({name:ra.m.PieChart,pluginId:"piechart",options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},displayLabels:[Hr.Percent],legend:{calcs:[],displayMode:Je.lm.Hidden,placement:"right",values:[],showLegend:!1}}}),{dataSummary:Le}=ge;if(Le.hasNumberField){if(Le.hasStringField&&Le.frameCount===1){if(Le.rowCountTotal>30||Le.rowCountTotal<2)return;Pe.append({name:ra.m.PieChart,options:{reduceOptions:{values:!0,calcs:[]}}}),Pe.append({name:ra.m.PieChartDonut,options:{reduceOptions:{values:!0,calcs:[]},pieType:Vo.Donut}});return}Le.numberFieldCount>30||Le.numberFieldCount<2||(Pe.append({name:ra.m.PieChart}),Pe.append({name:ra.m.PieChartDonut,options:{pieType:Vo.Donut}}))}}}const cc=new M.m(ic).setPanelChangeHandler(lc).useFieldConfig({disableStandardOptions:[yt.uo.Thresholds],standardOptions:{[yt.uo.Color]:{settings:{byValueSupport:!1,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:At.Y.PaletteClassic}}},useCustomConfig:Y=>{Fn.e(Y)}}).setPanelOptions(Y=>{(0,Ws.L)(Y),Y.addRadio({name:"Piechart type",description:"How the piechart should be rendered",path:"pieType",settings:{options:[{value:Vo.Pie,label:"Pie"},{value:Vo.Donut,label:"Donut"}]},defaultValue:Vo.Pie}).addMultiSelect({name:"Labels",path:"displayLabels",description:"Select the labels to be displayed in the pie chart",settings:{options:[{value:Hr.Percent,label:"Percent"},{value:Hr.Name,label:"Name"},{value:Hr.Value,label:"Value"}]}}),wn.D(Y),Wn.H(Y,!1),Y.addMultiSelect({name:"Legend values",path:"legend.values",category:["Legend"],settings:{options:[{value:qo.Percent,label:"Percent"},{value:qo.Value,label:"Value"}]},showIf:ge=>ge.legend.showLegend!==!1})}).setSuggestionsSupplier(new Bm);var Um=e(36373),yd=e(11082),ao=e(34163),Dd=e(82389),dc=e(11389),Li=e(58749),Nm=e(52415),bo=e(10875),up=e(21164);const Pd=({series:Y,dataIdxs:ge,seriesIdx:Pe,mode:Le=Je.$N.Single,sortOrder:ze=Je.xB.None,isPinned:et,annotate:ot,timeRange:xt,withDuration:Bt,maxHeight:jt})=>{const qt=(0,z.of)(Cs.$),sn=Y.fields[0],un=Pe!=null?ge[Pe]:ge.find(Kn=>Kn!=null),Zt=sn.display(sn.values[un]).text;Le=et?Je.$N.Single:Le;const vn=(0,bo.cp)(Y.fields,sn,ge,Pe,Le,ze);if(Bt&&Le===Je.$N.Single){const Kn=Y.fields[Pe],Tn=(0,ss.GY)(Kn,un);let Dn;Tn&&(Dn=sn.values[Tn]);const On=sn.values[un];let ga;if(Dn)ga=Dn&&(0,ss.c5)(Dn-On);else{const ea=xt.to.valueOf();ga=(0,ss.c5)(ea-On)}vn.push({label:"Duration",value:ga})}let zn;if(et&&Pe!=null){const Kn=Y.fields[Pe],Tn=ge[Pe],Dn=(0,up.u)(Kn,Tn);zn=b.createElement(Li.S,{dataLinks:Dn,annotate:ot})}const Un={label:sn.type===Mt.PU.time?"":sn.state?.displayName??sn.name,value:Zt};return b.createElement("div",{className:qt.wrapper},b.createElement(Nm.A,{item:Un,isPinned:et}),b.createElement(dc.o,{items:vn,isPinned:et,scrollable:(0,ar.T5)({mode:Le,maxHeight:jt}),maxHeight:jt}),zn)},Ul=({data:Y,timeRange:ge,timeZone:Pe,options:Le,width:ze,height:et,replaceVariables:ot,onChangeTimeRange:xt})=>{const Bt=(0,z.$j)(),[jt,qt]=(0,b.useState)(null),{sync:sn,eventsScope:un,canAddAnnotations:Zt,dataLinkPostProcessor:vn,eventBus:zn}=(0,Ka.d2)(),Un=sn?.()??mi.y.Off,{frames:Kn,warn:Tn}=(0,b.useMemo)(()=>(0,ss.Qe)(Y.series,Le.mergeValues??!0,ge,Bt),[Y.series,Le.mergeValues,ge,Bt]),Dn=(0,b.useMemo)(()=>(0,ss.Or)(Kn,Le.legend,Bt),[Kn,Le.legend,Bt]),On=(0,b.useMemo)(()=>(0,ar.Fg)(Le.timezone,Pe),[Le.timezone,Pe]);if(!Kn||Tn)return b.createElement("div",{className:"panel-empty"},b.createElement("p",null,Tn??"No data found in response"));if(Kn.length===1){const ea=(0,id.wC)(Kn[0])}const ga=!!(Zt&&Zt());return b.createElement(Dd.I,{theme:Bt,frames:Kn,structureRev:Y.structureRev,timeRange:ge,timeZone:On,width:ze,height:et,legendItems:Dn,...Le,mode:ss.pm.Changes,replaceVariables:ot,dataLinkPostProcessor:vn,cursorSync:Un},(ea,aa)=>b.createElement(b.Fragment,null,Un!==mi.y.Off&&b.createElement(Er.K,{config:ea,eventBus:zn,frame:aa}),Le.tooltip.mode!==Je.$N.None&&b.createElement(Va.xl,{config:ea,hoverMode:Le.tooltip.mode===Je.$N.Multi?Va.b3.xAll:Va.b3.xOne,queryZoom:xt,syncMode:Un,syncScope:un,render:(Gn,An,ia,Qn,jn,ka,Qa)=>{if(ga&&ka!=null){qt(ka),jn();return}const Ya=()=>{let Ba=Gn.posToVal(Gn.cursor.left,"x");qt({from:Ba,to:Ba}),jn()};return b.createElement(Pd,{series:aa,dataIdxs:An,seriesIdx:ia,mode:Qa?Je.$N.Multi:Le.tooltip.mode,sortOrder:Le.tooltip.sort,isPinned:Qn,timeRange:ge,annotate:ga?Ya:void 0,withDuration:!0,maxHeight:Le.tooltip.maxHeight})},maxWidth:Le.tooltip.maxWidth}),b.createElement(Ro.W,{annotations:Y.annotations??[],config:ea,timeZone:Pe,newRange:jt,setNewRange:qt,canvasRegionRendering:!1}),b.createElement(ho.U,{config:ea,onChangeTimeRange:xt})))};var bd=e(25019);const Cd=(Y,ge,Pe)=>{let Le=Y.options??{};if(ge==="natel-discrete-panel"&&Pe.angular){const ze=Pe.angular,et=Y.fieldConfig??{defaults:{},overrides:[]};ze.units&&(et.defaults.unit=ze.units);const ot={fillOpacity:100,lineWidth:0};et.defaults.custom=ot,Le.mergeValues=!0;const xt={type:bd.d.ValueToText,options:{}};if(et.defaults.mappings=[xt],(0,w.isArray)(ze.colorMaps))for(const Bt of ze.colorMaps){const jt=Bt.color;jt&&(xt.options[Bt.text]={color:jt})}if((0,w.isArray)(ze.valueMaps))for(const Bt of ze.valueMaps){const jt=Bt.text,qt=Bt.value;if(jt&&qt){let sn=xt.options[qt];sn?sn.text=jt:xt.options[qt]={text:jt}}}if((0,w.isArray)(ze.rangeMaps))for(const Bt of ze.rangeMaps){let jt=+Bt.from,qt=+Bt.to;const sn=Bt.text;sn&&et.defaults.mappings.push({type:bd.d.RangeToText,options:{from:jt,to:qt,result:{text:sn}}})}Y.fieldConfig=et}return Le},ll={alignValue:"left",mergeValues:!0,rowHeight:.9,showValue:Je.yL.Auto},uc={fillOpacity:70,lineWidth:0};class mc{getSuggestionsForData(ge){const{dataSummary:Pe}=ge;if(!Pe.hasData||!Pe.hasTimeField||!Pe.hasStringField&&!Pe.hasNumberField||Pe.numberFieldCount>=30||Pe.preferredVisualisationType==="logs")return;ge.getListAppender({name:"",pluginId:"state-timeline",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}).append({name:ra.m.StateTimeline})}}const Td=new M.m(Ul).setPanelChangeHandler(Cd).useFieldConfig({standardOptions:{[yt.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:At.Y.ContinuousGrYlRd}}},useCustomConfig:Y=>{Y.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:uc.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:uc.fillOpacity,settings:{min:0,max:100,step:1}}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",defaultValue:!1,editor:ao.e,override:ao.e,shouldApply:ge=>ge.type!==Mt.PU.time,process:Kt.hS,settings:{isTime:!0}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",defaultValue:!1,editor:yd.Z,override:yd.Z,shouldApply:ge=>ge.type!==Mt.PU.time,process:Kt.hS,settings:{isTime:!0}}),Fn.e(Y)}}).setPanelOptions(Y=>{Y.addBooleanSwitch({path:"mergeValues",name:"Merge equal consecutive values",defaultValue:ll.mergeValues}).addRadio({path:"showValue",name:"Show values",settings:{options:[{value:Je.yL.Auto,label:"Auto"},{value:Je.yL.Always,label:"Always"},{value:Je.yL.Never,label:"Never"}]},defaultValue:ll.showValue}).addRadio({path:"alignValue",name:"Align values",settings:{options:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},defaultValue:ll.alignValue}).addSliderInput({path:"rowHeight",name:"Row height",settings:{min:0,max:1,step:.01},defaultValue:ll.rowHeight}),Wn.H(Y,!1),wn.D(Y)}).setSuggestionsSupplier(new mc).setDataSupport({annotations:!0}),wm=({data:Y,timeRange:ge,timeZone:Pe,options:Le,width:ze,height:et,replaceVariables:ot,onChangeTimeRange:xt})=>{const Bt=(0,z.$j)(),[jt,qt]=(0,b.useState)(null),{sync:sn,eventsScope:un,canAddAnnotations:Zt,dataLinkPostProcessor:vn,eventBus:zn}=(0,Ka.d2)(),Un=sn?.()??mi.y.Off,Kn=!!(Zt&&Zt()),{frames:Tn,warn:Dn}=(0,b.useMemo)(()=>(0,ss.Qe)(Y.series,!1,ge,Bt),[Y.series,ge,Bt]),On=(0,b.useMemo)(()=>(0,ss.Or)(Tn,Le.legend,Bt),[Tn,Le.legend,Bt]),ga=(0,b.useMemo)(()=>(0,ar.Fg)(Le.timezone,Pe),[Le.timezone,Pe]);return!Tn||Dn?b.createElement("div",{className:"panel-empty"},b.createElement("p",null,Dn??"No data found in response")):Tn[0].length>ze/2?b.createElement("div",{className:"panel-empty"},b.createElement("p",null,"Too many points to visualize properly. ",b.createElement("br",null),"Update the query to return fewer points. ",b.createElement("br",null),"(",Tn[0].length," points received)")):b.createElement(Dd.I,{theme:Bt,frames:Tn,structureRev:Y.structureRev,timeRange:ge,timeZone:ga,width:ze,height:et,legendItems:On,...Le,mode:ss.pm.Samples,replaceVariables:ot,dataLinkPostProcessor:vn,cursorSync:Un},(ea,aa)=>b.createElement(b.Fragment,null,Un!==mi.y.Off&&b.createElement(Er.K,{config:ea,eventBus:zn,frame:aa}),Le.tooltip.mode!==Je.$N.None&&b.createElement(Va.xl,{config:ea,hoverMode:Le.tooltip.mode===Je.$N.Multi?Va.b3.xAll:Va.b3.xOne,queryZoom:xt,syncMode:Un,syncScope:un,render:(Gn,An,ia,Qn,jn,ka,Qa)=>{if(Kn&&ka!=null){qt(ka),jn();return}const Ya=()=>{let Ba=Gn.posToVal(Gn.cursor.left,"x");qt({from:Ba,to:Ba}),jn()};return b.createElement(Pd,{series:aa,dataIdxs:An,seriesIdx:ia,mode:Qa?Je.$N.Multi:Le.tooltip.mode,sortOrder:Le.tooltip.sort,isPinned:Qn,timeRange:ge,annotate:Kn?Ya:void 0,withDuration:!1,maxHeight:Le.tooltip.maxHeight})},maxWidth:Le.tooltip.maxWidth}),b.createElement(Ro.W,{annotations:Y.annotations??[],config:ea,timeZone:Pe,newRange:jt,setNewRange:qt,canvasRegionRendering:!1}),b.createElement(ho.U,{config:ea,onChangeTimeRange:xt})))},Fm={colWidth:.9,rowHeight:.9,showValue:Je.yL.Auto},Sd={fillOpacity:70,lineWidth:1};class cl{getSuggestionsForData(ge){const{dataSummary:Pe}=ge;if(!Pe.hasData||!Pe.hasTimeField||!Pe.hasStringField&&!Pe.hasNumberField||Pe.numberFieldCount>=30||Pe.rowCountMax>100||Pe.preferredVisualisationType==="logs")return;ge.getListAppender({name:"",pluginId:"status-history",options:{},fieldConfig:{defaults:{color:{mode:At.Y.ContinuousGrYlRd},custom:{}},overrides:[]},cardOptions:{previewModifier:ze=>{ze.options.colWidth=.7}}}).append({name:ra.m.StatusHistory})}}const Wm=new M.m(wm).useFieldConfig({standardOptions:{[yt.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:At.Y.Thresholds}}},useCustomConfig:Y=>{Y.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:Sd.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:Sd.fillOpacity,settings:{min:0,max:100,step:1}}),Fn.e(Y)}}).setPanelOptions(Y=>{Y.addRadio({path:"showValue",name:"Show values",settings:{options:[{value:Je.yL.Auto,label:"Auto"},{value:Je.yL.Always,label:"Always"},{value:Je.yL.Never,label:"Never"}]},defaultValue:Je.yL.Auto}).addSliderInput({path:"rowHeight",name:"Row height",defaultValue:.9,settings:{min:0,max:1,step:.01}}).addSliderInput({path:"colWidth",name:"Column width",defaultValue:.9,settings:{min:0,max:1,step:.01}}),Wn.H(Y,!1),wn.D(Y)}).setSuggestionsSupplier(new cl).setDataSupport({annotations:!0});var Km=e(69550),Bi=e(39651),bs=e(15292);function Vm({onChange:Y,value:ge,context:Pe}){const Le=ze=>{ze?.currentTarget.checked&&(Pe.options.footer.show=!1),Y(ze?.currentTarget.checked)};return b.createElement(bs.d,{value:!!ge,onChange:Le})}var fc=e(39938);const $m=({cellOptions:Y,onChange:ge})=>{const Pe=()=>{Y.wrapText=!Y.wrapText,ge(Y)},Le=b.createElement(al.J,{description:"If selected text will be wrapped to the width of text in the configured column"},"Wrap text ",b.createElement(fc.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}}));return b.createElement(b.Fragment,null,b.createElement(ws.D,{label:Le},b.createElement(bs.d,{value:Y.wrapText,onChange:Pe})))};function _m({cellOptions:Y,onChange:ge}){const Pe=ze=>{Y.mode=ze,ge(Y)},Le=ze=>{Y.valueDisplayMode=ze,ge(Y)};return b.createElement(A.B,{direction:"column",gap:0},b.createElement(ws.D,{label:"Gauge display mode"},b.createElement(Ln.z,{value:Y?.mode??Je.eX.Gradient,onChange:Pe,options:zm})),b.createElement(ws.D,{label:"Value display"},b.createElement(Ln.z,{value:Y?.valueDisplayMode??Je.$l.Text,onChange:Le,options:km})))}const zm=[{value:Je.eX.Basic,label:"Basic"},{value:Je.eX.Gradient,label:"Gradient"},{value:Je.eX.Lcd,label:"Retro LCD"}],km=[{value:Je.$l.Color,label:"Value color"},{value:Je.$l.Text,label:"Text color"},{value:Je.$l.Hidden,label:"Hidden"}],Hm=[{value:Je.Wq.Basic,label:"Basic"},{value:Je.Wq.Gradient,label:"Gradient"}],Md=({cellOptions:Y,onChange:ge})=>{const Pe=ot=>{Y.mode=ot,ge(Y)},Le=()=>{Y.applyToRow=!Y.applyToRow,ge(Y)},ze=()=>{Y.wrapText=!Y.wrapText,ge(Y)},et=b.createElement(al.J,{description:"If selected text will be wrapped to the width of text in the configured column"},"Wrap text ",b.createElement(fc.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}}));return b.createElement(b.Fragment,null,b.createElement(ws.D,{label:"Background display mode"},b.createElement(Ln.z,{value:Y?.mode??Je.Wq.Gradient,onChange:Pe,options:Hm})),b.createElement(ws.D,{label:"Apply to entire row",description:"If selected the entire row will be colored as this cell would be."},b.createElement(bs.d,{value:Y.applyToRow,onChange:Le})),b.createElement(ws.D,{label:et},b.createElement(bs.d,{value:Y.wrapText,onChange:ze})))};var ei=e(28528),xd=e(30355);const Gm=["hideValue","drawStyle","lineInterpolation","barAlignment","lineWidth","fillOpacity","gradientMode","lineStyle","spanNulls","showPoints","pointSize"];function ti(Y){const ge=(0,ks.V)(Y);return{...ge,useCustomConfig:Pe=>{ge.useCustomConfig?.(Pe),Pe.addBooleanSwitch({path:"hideValue",name:"Hide value"})}}}const jm=Y=>{const{cellOptions:ge,onChange:Pe}=Y,Le=(0,b.useMemo)(()=>{const ot=ti(xd.t);return(0,ei.O)(ot,"ChartCell")},[]),ze=(0,z.of)(Ym),et={...xd.t,...ge};return b.createElement(hn.gW,null,Le.list(Gm.map(ot=>`custom.${ot}`)).map(ot=>{if(ot.showIf&&!ot.showIf(et))return null;const xt=ot.editor,Bt=ot.path;return b.createElement(ws.D,{label:ot.name,key:ot.id,className:ze.field},b.createElement(xt,{onChange:jt=>Pe({...ge,[Bt]:jt}),value:(Qm(Bt,et)?et[Bt]:void 0)??ot.defaultValue,item:ot,context:{data:[]}}))}))};function Qm(Y,ge){return Y in ge}const Ym=()=>({field:(0,ae.css)`
    width: 100%;

    // @TODO don't show "scheme" option for custom gradient mode.
    // it needs thresholds to work, which are not supported
    // for area chart cell right now
    [title='Use color scheme to define gradient'] {
      display: none;
    }
  `}),Od=({value:Y,onChange:ge})=>{const Pe=Y.type,Le=(0,z.of)(dl),ze=Id.find(jt=>jt.value.type===Pe);let[et,ot]=(0,b.useState)({});const xt=jt=>{jt.value!==void 0&&(Y=jt.value,et[Y.type]!==void 0&&Object.keys(et[Y.type]).length>1&&(Y=(0,w.merge)(Y,et[Y.type])),ge(Y))},Bt=jt=>{et[Y.type]=(0,w.merge)(Y,jt),ot(et),ge(et[Y.type])};return b.createElement("div",{className:Le.fixBottomMargin},b.createElement(ws.D,null,b.createElement(V.l6,{options:Id,value:ze,onChange:xt})),(Pe===Je.ob.Auto||Pe===Je.ob.ColorText)&&b.createElement($m,{cellOptions:Y,onChange:Bt}),Pe===Je.ob.Gauge&&b.createElement(_m,{cellOptions:Y,onChange:Bt}),Pe===Je.ob.ColorBackground&&b.createElement(Md,{cellOptions:Y,onChange:Bt}),Pe===Je.ob.Sparkline&&b.createElement(jm,{cellOptions:Y,onChange:Bt}))},Id=[{value:{type:Je.ob.Auto},label:"Auto"},{value:{type:Je.ob.Sparkline},label:"Sparkline"},{value:{type:Je.ob.ColorText},label:"Colored text"},{value:{type:Je.ob.ColorBackground},label:"Colored background"},{value:{type:Je.ob.Gauge},label:"Gauge"},{value:{type:Je.ob.DataLinks},label:"Data links"},{value:{type:Je.ob.JSONView},label:"JSON View"},{value:{type:Je.ob.Image},label:"Image"}],dl=Y=>({fixBottomMargin:(0,ae.css)({marginBottom:Y.spacing(-2)})}),so={cellHeight:Je.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]};class Ad{getSuggestionsForData(ge){const Pe=ge.getListAppender({name:ra.m.Table,pluginId:"table",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:Le=>{Le.fieldConfig.defaults.custom.minWidth=50}}});ge.dataSummary.fieldCount===0?Pe.append({cardOptions:{imgSrc:"public/app/plugins/panel/table/img/icn-table-panel.svg"}}):Pe.append({})}}const ul="Table footer",gc=["Cell options"],Jm=new M.m(gi).setPanelChangeHandler(Al.l1).setMigrationHandler(Al.fq).useFieldConfig({useCustomConfig:Y=>{Y.addNumberInput({path:"minWidth",name:"Minimum column width",description:"The minimum width for column auto resizing",settings:{placeholder:"150",min:50,max:500},shouldApply:()=>!0,defaultValue:Bi.gB.minWidth}).addNumberInput({path:"width",name:"Column width",settings:{placeholder:"auto",min:20,max:300},shouldApply:()=>!0,defaultValue:Bi.gB.width}).addRadio({path:"align",name:"Column alignment",settings:{options:[{label:"Auto",value:"auto"},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}]},defaultValue:Bi.gB.align}).addCustomEditor({id:"cellOptions",path:"cellOptions",name:"Cell type",editor:Od,override:Od,defaultValue:Bi.gB.cellOptions,process:Kt.hS,category:gc,shouldApply:()=>!0}).addBooleanSwitch({path:"inspect",name:"Cell value inspect",description:"Enable cell value inspection in a modal window",defaultValue:!1,category:gc,showIf:ge=>ge.cellOptions.type===Je.ob.Auto||ge.cellOptions.type===Je.ob.JSONView||ge.cellOptions.type===Je.ob.ColorText||ge.cellOptions.type===Je.ob.ColorBackground}).addBooleanSwitch({path:"filterable",name:"Column filter",description:"Enables/disables field filters in table",defaultValue:Bi.gB.filterable}).addBooleanSwitch({path:"hidden",name:"Hide in table",defaultValue:void 0,hideFromDefaults:!0})}}).setPanelOptions(Y=>{Y.addBooleanSwitch({path:"showHeader",name:"Show table header",defaultValue:so.showHeader}).addRadio({path:"cellHeight",name:"Cell height",defaultValue:so.cellHeight,settings:{options:[{value:Je.qM.Sm,label:"Small"},{value:Je.qM.Md,label:"Medium"},{value:Je.qM.Lg,label:"Large"}]}}).addBooleanSwitch({path:"footer.show",category:[ul],name:"Show table footer",defaultValue:so.footer?.show}).addCustomEditor({id:"footer.reducer",category:[ul],path:"footer.reducer",name:"Calculation",description:"Choose a reducer function / calculation",editor:Km.D.get("stats-picker").editor,defaultValue:[Xo.gy.sum],showIf:ge=>ge.footer?.show}).addBooleanSwitch({path:"footer.countRows",category:[ul],name:"Count rows",description:"Display a single count for all data rows",defaultValue:so.footer?.countRows,showIf:ge=>ge.footer?.reducer?.length===1&&ge.footer?.reducer[0]===Xo.gy.count}).addMultiSelect({path:"footer.fields",category:[ul],name:"Fields",description:"Select the fields that should be calculated",settings:{allowCustomValue:!1,options:[],placeholder:"All Numeric Fields",getOptions:async ge=>{const Pe=[];if(ge&&ge.data&&ge.data.length>0){const Le=ge.data[0];for(const ze of Le.fields)if(ze.type===Mt.PU.number){const et=(0,gs.Ct)(ze,Le,ge.data),ot=ze.name;Pe.push({value:ot,label:et})}}return Pe}},defaultValue:"",showIf:ge=>ge.footer?.show&&!ge.footer?.countRows}).addCustomEditor({id:"footer.enablePagination",path:"footer.enablePagination",name:"Enable pagination",editor:Vm})}).setSuggestionsSupplier(new Ad);var Xm=e(49880),Rd=e.n(Xm),Zm=e(40996),Nl=e(36663),Cr=(Y=>(Y.Code="code",Y.HTML="html",Y.Markdown="markdown",Y))(Cr||{}),pc=(Y=>(Y.Go="go",Y.Html="html",Y.Json="json",Y.Markdown="markdown",Y.Plaintext="plaintext",Y.Sql="sql",Y.Typescript="typescript",Y.Xml="xml",Y.Yaml="yaml",Y))(pc||{});const mp="plaintext",ml={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},Ld={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"};function qm(Y){const ge=(0,z.of)(ef),[Pe,Le]=(0,b.useState)({mode:Y.options.mode,content:hc(Y.options,Y.replaceVariables,fe.Ay.disableSanitizeHtml)});if((0,Zm.A)(()=>{const{options:ze,replaceVariables:et}=Y,ot=hc(ze,et,fe.Ay.disableSanitizeHtml);(ot!==Pe.content||ze.mode!==Pe.mode)&&Le({mode:ze.mode,content:ot})},100,[Y]),Pe.mode===Cr.Code){const ze=Y.options.code??ml;return b.createElement(tc.B,{key:`${ze.showLineNumbers}/${ze.showMiniMap}`,value:Pe.content,language:ze.language??ml.language,width:Y.width,height:Y.height,containerStyles:ge.codeEditorContainer,showMiniMap:ze.showMiniMap,showLineNumbers:ze.showLineNumbers,readOnly:!0})}return b.createElement(te.E,{autoHeightMin:"100%",className:ge.containStrict},b.createElement(Rd(),{allowRerender:!0,html:Pe.content,className:ge.markdown,"data-testid":"TextPanel-converted-content"}))}function hc(Y,ge,Pe){let{mode:Le,content:ze}=Y;if(!ze)return" ";switch(ze=ge(ze,{},Y.code?.language==="json"?"json":"html"),Le){case Cr.Code:break;case Cr.HTML:Pe||(ze=di.sQ.sanitizeTextPanelContent(ze));break;case Cr.Markdown:default:ze=(0,Nl.P)(ze,{noSanitize:Pe})}return ze}const ef=Y=>({codeEditorContainer:(0,ae.css)`
    .monaco-editor .margin,
    .monaco-editor-background {
      background-color: ${Y.colors.background.primary};
    }
  `,markdown:(0,ae.cx)("markdown-html",(0,ae.css)`
      height: 100%;
    `),containStrict:(0,ae.css)({contain:"strict"})});var tf=e(70713),nf=e(99544);const vc=({value:Y,onChange:ge,context:Pe})=>{const Le=(0,b.useMemo)(()=>Pe.options?.mode??Cr.Markdown,[Pe]),ze=(0,z.of)(af),et=()=>Pe.getSuggestions?Pe.getSuggestions().map(ot=>(0,nf.O)(ot)):[];return b.createElement("div",{className:(0,ae.cx)(ze.editorBox)},b.createElement(tf.Ay,{disableHeight:!0},({width:ot})=>ot===0?null:b.createElement(tc.B,{value:Y,onBlur:ge,onSave:ge,language:Le,width:ot,showMiniMap:!1,showLineNumbers:!1,height:"500px",getSuggestions:et})))},af=Y=>({editorBox:(0,ae.css)`
    label: editorBox;
    border: 1px solid ${Y.colors.border.medium};
    border-radius: ${Y.shape.radius.default};
    margin: ${Y.spacing(.5)} 0;
    width: 100%;
  `}),sf=Y=>{const ge=parseFloat(Y.pluginVersion||"6.1");let Pe=Y.options;if(Y.hasOwnProperty("content")&&Y.hasOwnProperty("mode")){const ze=Y,et=ze.content,ot=ze.mode;delete ze.content,delete ze.mode,ge<7.1&&(Pe={content:et,mode:ot})}return[Cr.Code,Cr.HTML,Cr.Markdown].find(ze=>ze===Pe.mode)||(Pe={...Pe,mode:Cr.Markdown}),Pe},rf=new M.m(qm).setPanelOptions(Y=>{Y.addRadio({path:"mode",name:"Mode",settings:{options:[{value:Cr.Markdown,label:"Markdown"},{value:Cr.HTML,label:"HTML"},{value:Cr.Code,label:"Code"}]},defaultValue:Ld.mode}).addSelect({path:"code.language",name:"Language",settings:{options:Object.values(pc).map(ge=>({value:ge,label:ge}))},defaultValue:ml.language,showIf:ge=>ge.mode===Cr.Code}).addBooleanSwitch({path:"code.showLineNumbers",name:"Show line numbers",defaultValue:ml.showLineNumbers,showIf:ge=>ge.mode===Cr.Code}).addBooleanSwitch({path:"code.showMiniMap",name:"Show mini map",defaultValue:ml.showMiniMap,showIf:ge=>ge.mode===Cr.Code}).addCustomEditor({id:"content",path:"content",name:"Content",editor:vc,defaultValue:Ld.content})}).setMigrationHandler(sf);var Bd=e(41260),of=e(18282);class lf{getSuggestionsForData(ge){const{dataSummary:Pe}=ge;if(!Pe.hasTimeField||!Pe.hasNumberField||Pe.rowCountTotal<2)return;const Le=ge.getListAppender({name:ra.m.LineChart,pluginId:"timeseries",options:{legend:{calcs:[],displayMode:Je.lm.Hidden,placement:"right",showLegend:!1}},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:et=>{et.fieldConfig?.defaults.custom?.drawStyle!==Je.GR.Bars&&(et.fieldConfig.defaults.custom.lineWidth=Math.max(et.fieldConfig.defaults.custom.lineWidth??1,2))}}}),ze=100;if(Le.append({name:ra.m.LineChart}),Pe.rowCountMax<200&&Le.append({name:ra.m.LineChartSmooth,fieldConfig:{defaults:{custom:{lineInterpolation:Je.dx.Smooth}},overrides:[]}}),Pe.numberFieldCount===1){Le.append({name:ra.m.AreaChart,fieldConfig:{defaults:{custom:{fillOpacity:25}},overrides:[]}}),Le.append({name:ra.m.LineChartGradientColorScheme,fieldConfig:{defaults:{color:{mode:At.Y.ContinuousGrYlRd},custom:{gradientMode:Je.on.Scheme,lineInterpolation:Je.dx.Smooth,lineWidth:3,fillOpacity:20}},overrides:[]}}),Pe.rowCountMax<ze&&(Le.append({name:ra.m.BarChart,fieldConfig:{defaults:{custom:{drawStyle:Je.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:Je.on.Hue}},overrides:[]}}),Le.append({name:ra.m.BarChartGradientColorScheme,fieldConfig:{defaults:{color:{mode:At.Y.ContinuousGrYlRd},custom:{drawStyle:Je.GR.Bars,fillOpacity:90,lineWidth:1,gradientMode:Je.on.Scheme}},overrides:[]}}));return}Le.append({name:ra.m.AreaChartStacked,fieldConfig:{defaults:{custom:{fillOpacity:25,stacking:{mode:Je.gs.Normal,group:"A"}}},overrides:[]}}),Le.append({name:ra.m.AreaChartStackedPercent,fieldConfig:{defaults:{custom:{fillOpacity:25,stacking:{mode:Je.gs.Percent,group:"A"}}},overrides:[]}}),Pe.rowCountTotal/Pe.numberFieldCount<ze&&(Le.append({name:ra.m.BarChartStacked,fieldConfig:{defaults:{custom:{drawStyle:Je.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:Je.on.Hue,stacking:{mode:Je.gs.Normal,group:"A"}}},overrides:[]}}),Le.append({name:ra.m.BarChartStackedPercent,fieldConfig:{defaults:{custom:{drawStyle:Je.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:Je.on.Hue,stacking:{mode:Je.gs.Percent,group:"A"}}},overrides:[]}}))}}function cf(Y){const ge=(0,Oe.UA)().getCurrent()?.getPanelById(Y);if(ge){const Pe=ge.transformations?[...ge.transformations]:[];return Pe.push({id:of.F.prepareTimeSeries,options:{format:"wide"}}),{name:"Transform to wide time series format",pluginId:"timeseries",transformations:Pe}}}const df=({data:Y,timeRange:ge,timeZone:Pe,width:Le,height:ze,options:et,fieldConfig:ot,onChangeTimeRange:xt,replaceVariables:Bt,id:jt})=>{const{sync:qt,eventsScope:sn,canAddAnnotations:un,onThresholdsChange:Zt,canEditThresholds:vn,showThresholds:zn,dataLinkPostProcessor:Un,eventBus:Kn}=(0,Ka.d2)(),Tn=et.orientation===Je.wV.Vertical,Dn=(0,b.useMemo)(()=>(0,ar.B_)(Y.series,fe.config.theme2,ge),[Y.series,ge]),On=(0,b.useMemo)(()=>(0,ar.Fg)(et.timezone,Pe),[et.timezone,Pe]),ga=(0,b.useMemo)(()=>{if(Dn?.length&&Dn.every(ia=>ia.meta?.type===Bd.m.TimeSeriesLong)){const ia=cf(jt);return{message:"Long data must be converted to wide",suggestions:ia?[ia]:void 0}}},[Dn,jt]),ea=!!(un&&un()),[aa,Gn]=(0,b.useState)(null),An=qt?.()??mi.y.Off;return!Dn||ga?b.createElement(_n.a,{panelId:jt,message:ga?.message,fieldConfig:ot,data:Y,needsTimeField:!0,needsNumberField:!0,suggestions:ga?.suggestions}):b.createElement(po,{frames:Dn,structureRev:Y.structureRev,timeRange:ge,timeZone:On,width:Le,height:ze,legend:et.legend,options:et,replaceVariables:Bt,dataLinkPostProcessor:Un,cursorSync:An},(ia,Qn)=>b.createElement(b.Fragment,null,b.createElement(ys.Z,{config:ia}),An!==mi.y.Off&&b.createElement(Er.K,{config:ia,eventBus:Kn,frame:Qn}),et.tooltip.mode!==Je.$N.None&&b.createElement(Va.xl,{config:ia,hoverMode:et.tooltip.mode===Je.$N.Single?Va.b3.xOne:Va.b3.xAll,queryZoom:xt,clientZoom:!0,syncMode:An,syncScope:sn,render:(jn,ka,Qa,Ya=!1,Ba,Ia,Ea)=>{if(ea&&Ia!=null){Gn(Ia),Ba();return}const ja=()=>{let fs=jn.posToVal(jn.cursor.left,"x");Gn({from:fs,to:fs}),Ba()};return b.createElement(Cs.k,{series:Qn,dataIdxs:ka,seriesIdx:Qa,mode:Ea?Je.$N.Multi:et.tooltip.mode,sortOrder:et.tooltip.sort,isPinned:Ya,annotate:ea?ja:void 0,maxHeight:et.tooltip.maxHeight})},maxWidth:et.tooltip.maxWidth}),!Tn&&b.createElement(b.Fragment,null,b.createElement(Ro.W,{annotations:Y.annotations??[],config:ia,timeZone:Pe,newRange:aa,setNewRange:Gn}),b.createElement(ho.U,{config:ia,onChangeTimeRange:xt}),Y.annotations&&b.createElement(Mi,{visibleSeries:Gi(ia,Dn),config:ia,exemplars:Y.annotations,timeZone:Pe}),(vn&&Zt||zn)&&b.createElement(Yo,{config:ia,fieldConfig:ot,onThresholdsChange:vn?Zt:void 0}))))};var Ui=e(91410),Tr=e(20333);const tr=({value:Y,onChange:ge})=>{const Pe=(0,z.of)(uf);(!Y||Y.length<1)&&(Y=[""]);const Le=()=>{ge([...Y,Ui.g$.default])},ze=ot=>{const xt=Y.slice();xt.splice(ot,1),ge(xt)},et=(ot,xt)=>{const Bt=Y.slice();Bt[ot]=xt??Ui.g$.default,Bt.length===0||Bt.length===1&&Bt[0]===""?ge(void 0):ge(Bt)};return b.createElement("div",null,Y.map((ot,xt)=>b.createElement("div",{className:Pe.wrapper,key:`${xt}.${ot}`},b.createElement("span",{className:Pe.first},b.createElement(Tr.U,{onChange:Bt=>et(xt,Bt),includeInternal:!0,value:ot??Ui.g$.default})),xt===Y.length-1?b.createElement(ke.K,{name:"plus",onClick:Le,tooltip:"Add timezone"}):b.createElement(ke.K,{name:"times",onClick:()=>ze(xt),tooltip:"Remove timezone"}))))},uf=Y=>({wrapper:(0,ae.css)`
    width: 100%;
    display: flex;
    flex-direction: rows;
    align-items: center;
  `,first:(0,ae.css)`
    margin-right: 8px;
    flex-grow: 2;
  `});var Ud=e(50082),Nd=e(74856),Ec=e(38477),wd=e(24283),yc=e(32023),mf=e(68706);let Ni=null;const Fd=(Y,ge,Pe,Le)=>{if(ge==="graph"&&Pe.angular){const{fieldConfig:ze,options:et,annotations:ot}=Wd({...Pe.angular,fieldConfig:Le,panel:Y});return ot?.length>0&&hf(ot),Y.fieldConfig=ze,Y.alert=Pe.angular.alert,et}return pf(Y),{}};function Wd(Y){let ge=[];const Pe=Y.fieldConfig?.overrides??[],Le=Y.yaxes??[];let ze=wi(Le[0]);Y.fieldConfig?.defaults&&(ze={...Y.fieldConfig?.defaults,...ze});const et={fill:Y.dashes?"dash":"solid",dash:[Y.dashLength??10,Y.spaceLength??10]};if(Y.aliasColors)for(const sn of Object.keys(Y.aliasColors)){const un=Y.aliasColors[sn];un&&Pe.push({matcher:{id:fi.Ct.byName,options:sn},properties:[{id:yt.uo.Color,value:{mode:At.Y.Fixed,fixedColor:un}}]})}let ot=!1;if(Y.seriesOverrides?.length)for(const sn of Y.seriesOverrides){if(!sn.alias)continue;const Zt={matcher:{id:/^([/~@;%#'])(.*?)\1([gimsuy]*)$/.test(sn.alias)?fi.Ct.byRegexp:fi.Ct.byName,options:sn.alias},properties:[]};let vn;for(const zn of Object.keys(sn)){const Un=sn[zn];switch(zn){case"alias":case"$$hashKey":break;case"yaxis":if(Un===2){const Kn=wi(Le[1]);ff(ze,Kn,Zt.properties)}break;case"fill":Zt.properties.push({id:"custom.fillOpacity",value:Un*10});break;case"fillBelowTo":ot=!0,Zt.properties.push({id:"custom.fillBelowTo",value:Un});break;case"fillGradient":Un&&(Zt.properties.push({id:"custom.fillGradient",value:"opacity"}),Zt.properties.push({id:"custom.fillOpacity",value:Un*10}));break;case"points":Zt.properties.push({id:"custom.showPoints",value:Un?Je.yL.Always:Je.yL.Never});break;case"bars":Un?(Zt.properties.push({id:"custom.drawStyle",value:Je.GR.Bars}),Zt.properties.push({id:"custom.fillOpacity",value:100})):Zt.properties.push({id:"custom.drawStyle",value:Je.GR.Line});break;case"lines":Un?Zt.properties.push({id:"custom.drawStyle",value:"line"}):Zt.properties.push({id:"custom.lineWidth",value:0});break;case"linewidth":Zt.properties.push({id:"custom.lineWidth",value:Un});break;case"pointradius":Zt.properties.push({id:"custom.pointSize",value:2+Un*2});break;case"dashLength":case"spaceLength":case"dashes":switch(vn||(vn={fill:et.fill,dash:[...et.dash]}),zn){case"dashLength":vn.dash[0]=Un;break;case"spaceLength":vn.dash[1]=Un;break;case"dashes":vn.fill=Un?"dash":"solid";break}break;case"stack":Zt.properties.push({id:"custom.stacking",value:Cc(Un)});break;case"color":Zt.properties.push({id:"color",value:{fixedColor:Un,mode:At.Y.Fixed}});break;case"transform":Zt.properties.push({id:"custom.transform",value:Un==="negative-Y"?Je.NU.NegativeY:Je.NU.Constant});break;default:console.log("Ignore override migration:",sn.alias,zn,Un)}}vn&&Zt.properties.push({id:"custom.lineStyle",value:vn}),Zt.properties.length&&Pe.push(Zt)}const xt=ze.custom??{};xt.drawStyle=Y.bars?Je.GR.Bars:Y.lines?Je.GR.Line:Je.GR.Points,Y.points?(xt.showPoints=Je.yL.Always,(0,w.isNumber)(Y.pointradius)&&(xt.pointSize=2+Y.pointradius*2)):xt.drawStyle!==Je.GR.Points&&(xt.showPoints=Je.yL.Never),xt.lineWidth=Y.linewidth,et.fill!=="solid"&&(xt.lineStyle=et),ot?xt.fillOpacity=35:(0,w.isNumber)(Y.fill)&&(xt.fillOpacity=Y.fill*10),(0,w.isNumber)(Y.fillGradient)&&Y.fillGradient>0&&(xt.gradientMode=Je.on.Opacity,xt.fillOpacity=Y.fillGradient*10),xt.spanNulls=Y.nullPointMode===ir.UW.Ignore,Y.steppedLine&&(xt.lineInterpolation=Je.dx.StepAfter),xt.drawStyle===Je.GR.Bars&&(xt.fillOpacity=100),Y.stack&&(xt.stacking={mode:Y.percentage?Je.gs.Percent:Je.gs.Normal,group:ks.S.stacking.group},Y.percentage&&Y.yaxis&&(delete ze.min,delete ze.max,ze.decimals===0&&delete ze.decimals)),ze.custom=(0,w.omitBy)(xt,w.isNil),ze.nullValueMode=Y.nullPointMode;const Bt={legend:{displayMode:Je.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:Je.$N.Single,sort:Je.xB.None}},jt=Y.legend;if(jt){if(jt.show?Bt.legend.displayMode=jt.alignAsTable?Je.lm.Table:Je.lm.List:Bt.legend.showLegend=!1,jt.rightSide&&(Bt.legend.placement="right"),Y.legend.values){const sn=(0,w.pickBy)(Y.legend);Bt.legend.calcs=gf(sn)}Y.legend.sideWidth&&(Bt.legend.width=Y.legend.sideWidth),jt.hideZero&&Pe.push(bc(Xo.gy.allIsZero)),jt.hideEmpty&&Pe.push(bc(Xo.gy.allIsNull))}Y.timeRegions?.length&&Y.timeRegions.map((un,Zt)=>({name:`T${Zt}`,color:un.colorMode!=="custom"?un.colorMode:un.fillColor,line:un.line,fill:un.fill,fromDayOfWeek:un.fromDayOfWeek,toDayOfWeek:un.toDayOfWeek,from:un.from,to:un.to})).forEach((un,Zt)=>{const vn={datasource:{type:"datasource",uid:"grafana"},enable:!0,hide:!0,filter:{exclude:!1,ids:[Y.panel.id]},iconColor:un.fillColor??un.color,name:`Time region for panel ${Y.panel.title}${Zt>0?` ${Zt}`:""}`,target:{queryType:mf.nj.TimeRegions,refId:"Anno",timeRegion:{fromDayOfWeek:un.fromDayOfWeek,toDayOfWeek:un.toDayOfWeek,from:un.from,to:un.to,timezone:"utc"}}};un.fill?ge.push(vn):un.line&&(vn.iconColor=un.lineColor??"white",ge.push(vn))});const qt=Y.tooltip;if(qt&&(qt.shared!==void 0&&(Bt.tooltip.mode=qt.shared?Je.$N.Multi:Je.$N.Single),qt.sort!==void 0&&qt.shared))switch(qt.sort){case 1:Bt.tooltip.sort=Je.xB.Ascending;break;case 2:Bt.tooltip.sort=Je.xB.Descending;break;default:Bt.tooltip.sort=Je.xB.None}if(Y.thresholds&&Y.thresholds.length>0){let sn=[],un=!1,Zt=!1;const vn=Y.thresholds.sort((Un,Kn)=>Un.value>Kn.value?1:-1);for(let Un=0;Un<vn.length;Un++){const Kn=vn[Un],Tn=vn.length>Un+1?vn[Un+1]:null;Kn.fill&&(un=!0),Kn.line&&(Zt=!0),Kn.op==="gt"&&sn.push({value:Kn.value,color:Dc(Kn)}),Kn.op==="lt"&&(sn.length===0&&sn.push({value:-1/0,color:Dc(Kn)}),Tn&&Tn.op==="gt"&&Tn.value>Kn.value?sn.push({value:Kn.value,color:"transparent"}):Tn&&Tn.op==="lt"?sn.push({value:Kn.value,color:Dc(Tn)}):sn.push({value:Kn.value,color:"transparent"}))}sn.length>0&&sn[0].value!==-1/0&&sn.unshift({color:"transparent",value:-1/0});let zn=un?Je.Ly.Area:Je.Ly.Line;Zt&&un&&(zn=Je.Ly.LineAndArea),ze.custom.thresholdsStyle={mode:zn},ze.thresholds={mode:Ud.O.Absolute,steps:sn}}return Y.xaxis&&Y.xaxis.show===!1&&Y.xaxis.mode==="time"&&Pe.push({matcher:{id:fi.Ct.byType,options:Mt.PU.time},properties:[{id:"custom.axisPlacement",value:Je.vM.Hidden}]}),{fieldConfig:{defaults:(0,w.omitBy)(ze,w.isNil),overrides:Pe},options:Bt,annotations:ge}}function Dc(Y){return Y.colorMode==="critical"?"red":Y.colorMode==="warning"?"orange":Y.colorMode==="custom"?Y.fillColor||Y.lineColor:"red"}function wi(Y){if(!Y)return{};const ge={axisPlacement:Y.show?Je.vM.Auto:Je.vM.Hidden};if(Y.label&&(ge.axisLabel=Y.label),Y.logBase){const Pe=Y.logBase;(Pe===2||Pe===10)&&(ge.scaleDistribution={type:Je.L4.Log,log:Pe})}return(0,w.omitBy)({unit:Y.format,decimals:Pc(Y.decimals),min:Pc(Y.min),max:Pc(Y.max),custom:ge},w.isNil)}function ff(Y,ge,Pe){for(const[et,ot]of Object.entries(ge))et!=="custom"&&ot!==Y[et]&&Pe.push({id:et,value:ot});Pe.push({id:"custom.axisPlacement",value:Je.vM.Right});const Le=Y.custom??{},ze=ge.custom??{};for(const[et,ot]of Object.entries(ze))ot!==Le[et]&&Pe.push({id:`custom.${et}`,value:ot})}function Pc(Y){if((0,w.isNumber)(Y))return Y;if((0,w.isString)(Y)){const ge=Number(Y);if(!isNaN(ge))return ge}}function gf(Y){const ge=[];for(const Pe in Y){const Le=Xo.AS.getIfExists(Pe);Le&&ge.push(Le.id)}return ge}function pf(Y){Y.fieldConfig?.defaults?.custom?.hideFrom?.graph!==void 0&&(Y.fieldConfig.defaults.custom.hideFrom.viz=Y.fieldConfig.defaults.custom.hideFrom.graph,delete Y.fieldConfig.defaults.custom.hideFrom.graph),Y.fieldConfig?.overrides&&(Y.fieldConfig.overrides=Y.fieldConfig.overrides.map(ge=>(ge.properties=ge.properties.map(Pe=>(Pe.id==="custom.hideFrom"&&Pe.value.graph&&(Pe.value.viz=Pe.value.graph,delete Pe.value.graph),Pe)),ge)))}function bc(Y){return{matcher:{id:fi.Ct.byValue,options:{reducer:Y,op:Je.zT.GTE,value:0}},properties:[{id:"custom.hideFrom",value:{tooltip:!0,viz:!1,legend:!0}}]}}function Cc(Y){const ge=ks.S.stacking?.group;return{mode:Y?Je.gs.Normal:Je.gs.None,group:(0,w.isString)(Y)?Y:ge}}function hf(Y){const ge=window.__grafanaSceneContext;if(ge instanceof wd.H$){const Le=yc.b4.getDataLayers(ge),ze=[...Le.state.annotationLayers];for(let et of Y){const ot=new Ec.g({key:`annotations-${et.name}`,query:et,name:et.name,isEnabled:et.enable,isHidden:et.hide});ze.push(ot)}Le.setState({annotationLayers:ze});return}const Pe=(0,Oe.UA)().getCurrent();Pe&&(Pe.annotations.list=[...Pe.annotations.list,...Y],Ni==null&&(Ni=setTimeout(()=>{Ni=null,(0,Nd.jG)().refreshTimeModel()})))}const vf=new M.m(df).setPanelChangeHandler(Fd).useFieldConfig((0,ks.V)(ks.S)).setPanelOptions(Y=>{wn.D(Y,!1,!0),Wn.H(Y),Y.addCustomEditor({id:"timezone",name:"Time zone",path:"timezone",category:["Axis"],editor:tr,defaultValue:void 0})}).setSuggestionsSupplier(new lf).setDataSupport({annotations:!0,alertStates:!0});var Ef=e(92599),yf=e(35090);const Kd={wrapper:(0,ae.css)`
    height: 100%;
    overflow: scroll;
  `},Df=({data:Y,options:ge})=>{const Pe=(0,b.createRef)(),Le=(0,b.useMemo)(()=>(0,yf.L)(Y.series[0]),[Y.series]),ze=(0,hi.A)(async()=>await(0,cd.l)().get(Y.request?.targets[0].datasource?.uid));return!Y||!Y.series.length||!Le?b.createElement("div",{className:"panel-empty"},b.createElement("p",null,"No data found in response")):b.createElement("div",{className:Kd.wrapper},b.createElement("div",{ref:Pe}),b.createElement(Ef.V,{dataFrames:Y.series,scrollElementClass:Kd.wrapper,traceProp:Le,datasource:ze.value,topOfViewRef:Pe,createSpanLink:ge.createSpanLink,focusedSpanId:ge.focusedSpanId,createFocusSpanLink:ge.createFocusSpanLink}))};class Vd{getListWithDefaults(ge){return ge.getListAppender({name:ra.m.Trace,pluginId:"traces"})}getSuggestionsForData(ge){!ge.data||!ge.data.series[0]||ge.data.series[0].meta?.preferredVisualisationType==="trace"&&this.getListWithDefaults(ge).append({name:ra.m.Trace,score:Jt.nQ.Best})}}const Pf=new M.m(Df).setSuggestionsSupplier(new Vd);var $d=e(85200),bf=e(40458);const Cf=({data:Y,timeRange:ge,timeZone:Pe,width:Le,height:ze,options:et,fieldConfig:ot,replaceVariables:xt,id:Bt})=>{const{dataLinkPostProcessor:jt}=(0,Ka.d2)(),qt=et.xField??Y.series[0].fields.find(Zt=>Zt.type===Mt.PU.number)?.name,sn=(Zt,vn,zn)=>(vn={...vn,x:$d.sJ.get(fi.Ct.byName).get(qt)},(0,bf.m)(Zt,vn)),un=(0,b.useMemo)(()=>{if(Y.series.length>1)return{warning:"Only one frame is supported, consider adding a join transformation",frames:Y.series};let Zt=Y.series,vn;if(et.xField){if(vn=(0,li.findFieldIndex)(et.xField,Zt[0]),vn==null)return{warning:"Unable to find field: "+et.xField,frames:Y.series}}else if(vn=Zt[0].fields.findIndex(zn=>zn.type===Mt.PU.number),vn===-1)return{warning:"No numeric fields found for X axis",frames:Zt};if(vn!=null){const zn=Zt[0].fields[vn];if(zn.type===Mt.PU.number&&!(0,ps.g2)(zn.values))return{warning:"Values must be in ascending order",frames:Zt}}return{frames:(0,ar.B_)(Zt,x.$.theme2,void 0,vn)}},[Y.series,et.xField]);return un.warning||!un.frames?b.createElement(_n.a,{panelId:Bt,fieldConfig:ot,data:Y,message:un.warning,needsNumberField:!0}):b.createElement(po,{frames:un.frames,structureRev:Y.structureRev,timeRange:ge,timeZone:Pe,width:Le,height:ze,legend:et.legend,options:et,preparePlotFrame:sn,replaceVariables:xt,dataLinkPostProcessor:jt},(Zt,vn)=>b.createElement(b.Fragment,null,b.createElement(ys.Z,{config:Zt}),et.tooltip.mode!==Je.$N.None&&b.createElement(Va.xl,{config:Zt,hoverMode:et.tooltip.mode===Je.$N.Single?Va.b3.xOne:Va.b3.xAll,render:(zn,Un,Kn,Tn=!1)=>b.createElement(Cs.k,{series:vn,dataIdxs:Un,seriesIdx:Kn,mode:et.tooltip.mode,sortOrder:et.tooltip.sort,isPinned:Tn,maxHeight:et.tooltip.maxHeight}),maxWidth:et.tooltip.maxWidth})))};class Tf{getSuggestionsForData(ge){const{dataSummary:Pe}=ge;return Pe.numberFieldCount<2||Pe.rowCountTotal<2||Pe.rowCountTotal<2?void 0:ge.getListAppender({name:ra.m.LineChart,pluginId:"trend",options:{legend:{calcs:[],displayMode:Je.lm.Hidden,placement:"right",showLegend:!1}},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:ze=>{ze.fieldConfig?.defaults.custom?.drawStyle!==Je.GR.Bars&&(ze.fieldConfig.defaults.custom.lineWidth=Math.max(ze.fieldConfig.defaults.custom.lineWidth??1,2))}}})}}const Sf=new M.m(Cf).useFieldConfig((0,ks.V)(ks.S,!1)).setPanelOptions(Y=>{const ge=["X Axis"];Y.addFieldNamePicker({path:"xField",name:"X Field",description:"An increasing numeric value",category:ge,defaultValue:void 0,settings:{isClearable:!0,placeholderText:"First numeric value",filter:Pe=>Pe.type===Mt.PU.number}}),wn.D(Y,!1,!0),Wn.H(Y)}).setSuggestionsSupplier(new Tf),Mf=[{value:0,label:"Documentation",href:"https://grafana.com/docs/grafana/latest"},{value:1,label:"Tutorials",href:"https://grafana.com/tutorials"},{value:2,label:"Community",href:"https://community.grafana.com"},{value:3,label:"Public Slack",href:"http://slack.grafana.com"}],xf=()=>{const Y=(0,z.of)(Of);return b.createElement("div",{className:Y.container},b.createElement("h1",{className:Y.title},"Welcome to Grafana"),b.createElement("div",{className:Y.help},b.createElement("h3",{className:Y.helpText},"Need help?"),b.createElement("div",{className:Y.helpLinks},Mf.map((ge,Pe)=>b.createElement("a",{key:`${ge.label}-${Pe}`,className:Y.helpLink,href:`${ge.href}?utm_source=grafana_gettingstarted`},ge.label)))))},Of=Y=>({container:(0,ae.css)`
      display: flex;
      /// background: url(public/img/g8_home_v2.svg) no-repeat;
      background-size: cover;
      height: 100%;
      align-items: center;
      padding: 0 16px;
      justify-content: space-between;
      padding: 0 ${Y.spacing(3)};

      ${Y.breakpoints.down("lg")} {
        background-position: 0px;
        flex-direction: column;
        align-items: flex-start;
        justify-content: center;
      }

      ${Y.breakpoints.down("sm")} {
        padding: 0 ${Y.spacing(1)};
      }
    `,title:(0,ae.css)`
      margin-bottom: 0;

      ${Y.breakpoints.down("lg")} {
        margin-bottom: ${Y.spacing(1)};
      }

      ${Y.breakpoints.down("md")} {
        font-size: ${Y.typography.h2.fontSize};
      }
      ${Y.breakpoints.down("sm")} {
        font-size: ${Y.typography.h3.fontSize};
      }
    `,help:(0,ae.css)`
      display: flex;
      align-items: baseline;
    `,helpText:(0,ae.css)`
      margin-right: ${Y.spacing(2)};
      margin-bottom: 0;

      ${Y.breakpoints.down("md")} {
        font-size: ${Y.typography.h4.fontSize};
      }

      ${Y.breakpoints.down("sm")} {
        display: none;
      }
    `,helpLinks:(0,ae.css)`
      display: flex;
      flex-wrap: wrap;
    `,helpLink:(0,ae.css)`
      margin-right: ${Y.spacing(2)};
      text-decoration: underline;
      text-wrap: no-wrap;

      ${Y.breakpoints.down("sm")} {
        margin-right: 8px;
      }
    `}),_d=new M.m(xf).setNoPadding(),Uf={"core:plugin/graphite":async()=>await e.e(6134).then(e.bind(e,8652)),"core:plugin/cloudwatch":async()=>await Promise.all([e.e(1765),e.e(2651),e.e(3766)]).then(e.bind(e,92651)),"core:plugin/dashboard":async()=>await e.e(2058).then(e.bind(e,92058)),"core:plugin/elasticsearch":async()=>await Promise.all([e.e(1765),e.e(6144),e.e(8747),e.e(1717)]).then(e.bind(e,18747)),"core:plugin/opentsdb":async()=>await e.e(747).then(e.bind(e,24989)),"core:plugin/grafana":async()=>await e.e(3648).then(e.bind(e,62391)),"core:plugin/influxdb":async()=>await Promise.all([e.e(4669),e.e(9404)]).then(e.bind(e,21106)),"core:plugin/loki":async()=>await Promise.all([e.e(6144),e.e(4684),e.e(1477)]).then(e.bind(e,24684)),"core:plugin/mixed":async()=>await e.e(2513).then(e.bind(e,12870)),"core:plugin/mssql":async()=>await Promise.all([e.e(4669),e.e(9040)]).then(e.bind(e,56694)),"core:plugin/prometheus":async()=>await Promise.all([e.e(1765),e.e(6144),e.e(4178),e.e(9546)]).then(e.bind(e,74178)),"core:plugin/alertmanager":async()=>await Promise.all([e.e(1765),e.e(4737)]).then(e.bind(e,27013)),"core:plugin/text":h,"core:plugin/timeseries":D,"core:plugin/trend":C,"core:plugin/state-timeline":a,"core:plugin/status-history":E,"core:plugin/candlestick":o,"core:plugin/graph":async()=>await Promise.all([e.e(9362),e.e(8068)]).then(e.bind(e,229)),"core:plugin/xychart":async()=>x.$.featureToggles.autoMigrateXYChartPanel?await Promise.all([e.e(8891),e.e(3772)]).then(e.bind(e,80983)):await Promise.all([e.e(707),e.e(5594)]).then(e.bind(e,31552)),"core:plugin/geomap":async()=>await Promise.all([e.e(1698),e.e(707),e.e(7734),e.e(190)]).then(e.bind(e,7734)),"core:plugin/canvas":async()=>await Promise.all([e.e(707),e.e(7523)]).then(e.bind(e,68743)),"core:plugin/dashlist":m,"core:plugin/alertlist":t,"core:plugin/annolist":n,"core:plugin/heatmap":async()=>await Promise.all([e.e(8891),e.e(5857)]).then(e.bind(e,26235)),"core:plugin/table":g,"core:plugin/table-old":async()=>await e.e(8777).then(e.bind(e,78491)),"core:plugin/news":f,"core:plugin/live":c,"core:plugin/stat":Um,"core:plugin/datagrid":l,"core:plugin/debug":i,"core:plugin/flamegraph":u,"core:plugin/gettingstarted":d,"core:plugin/gauge":Ou,"core:plugin/piechart":P,"core:plugin/bargauge":r,"core:plugin/barchart":s,"core:plugin/logs":y,"core:plugin/traces":v,"core:plugin/welcome":T,"core:plugin/nodeGraph":async()=>await Promise.all([e.e(1698),e.e(5511),e.e(7317)]).then(e.bind(e,68403)),"core:plugin/histogram":p};var fl=e(81900),wl=e(63770),Nf=e(52762),wf=e(20582),Mc=e(21313),Ff=e(72635),Wf=e(34796),xc=e.n(Wf),Oc=e(95093),Kf=e.n(Oc),Ic=e(28848),kd=e.n(Ic),Hd=e(40961),Vf=e(8867),Gd=e(71468),$f=e(54625),Ac=e(24160),_f=e(14644),zf=e(75091),kf=e(32975),Wi=e(82611),Hf=e(75226),jd=e(29317),Cp=e(54087),Tp=e(80851),Sp=e(32176),Gf=e(31221),Mp=e(91520),xp=e(92275),Op=e(82013),Ip=e(2341),Ap=e(19538),Qd=e(39954),jf=e(85858),Qf=e(13303),Yf=e(8984),Jf=e(91950),Rc=e(31140),Yd=e(78827),Xf=e(68576),Zf=e(92247);const gl=Yf;gl.PanelPlugin=M.m,gl.DataSourcePlugin=S.tD,gl.AppPlugin=O.hX,gl.DataSourceApi=S.mA;const qf=["jquery.flot.crosshair","jquery.flot.events","jquery.flot.fillbelow","jquery.flot.gauge","jquery.flot.pie","jquery.flot.selection","jquery.flot.stack","jquery.flot.stackpercent","jquery.flot.time","jquery.flot"].reduce((Y,ge)=>({...Y,[ge]:{fakeDep:1}}),{}),eg={"@emotion/css":ae,"@emotion/react":Nf,"@grafana/data":Qd,"@grafana/runtime":Qf,"@grafana/slate-react":jd.Ay,"@grafana/ui":gl,"@kusto/monaco-kusto":wf,"app/core/app_events":{default:Ze.lE,__useDefault:!0},"app/core/config":{default:fe.Ay,__useDefault:!0},"app/core/core":{appEvents:Ze.lE,contextSrv:Ze.TP},"app/core/services/backend_srv":{BackendSrv:tn.Mf,getBackendSrv:tn.AI},"app/core/table_model":{default:Jf.A,__useDefault:!0},"app/core/time_series":{default:Rc.A,__useDefault:!0},"app/core/time_series2":{default:Rc.A,__useDefault:!0},"app/core/utils/datemath":jf,"app/core/utils/flatten":Yd,"app/core/utils/kbn":{default:Xf.A,__useDefault:!0},"app/core/utils/ticks":Zf,"app/features/dashboard/impression_store":{impressions:dn.A},d3:Mc,emotion:ae,i18next:Ff,jquery:{default:xc(),__useDefault:!0},...qf,lodash:{default:L(),__useDefault:!0},moment:{default:Kf(),__useDefault:!0},prismjs:kd(),react:b,"react-dom":Hd,"react-inlinesvg":Vf,"react-redux":Gd,"react-router-dom":$f,"react-router":Ac,redux:_f,rxjs:zf,"rxjs/operators":kf,slate:Wi.Ay,"slate-plain-serializer":Hf.A,"slate-react":jd.Ay};function pl({url:Y,source:ge,transformSourceMapURL:Pe=!1,transformAssets:Le=!0}){const ze=Y.split("/public/plugins/"),et=ze[0],ot=ze[1].split("/")[0];let xt=ge;return Le&&(xt=xt.replace(/(\/?)(public\/plugins)/g,`${et}/$2`),xt=xt.replace(/(["|'])(plugins\/.+?.css)(["|'])/g,`$1${et}/public/$2$3`)),Pe&&(xt=xt.replace(/(\/\/#\ssourceMappingURL=)(.+)\.map/g,`$1${et}/public/plugins/${ot}/$2.map`)),xt}var hl=e(45179),ni=e(94429);async function tg(Y,ge,Pe){const Le=await Y(ge,Pe),ze=Le.headers.get("content-type")||"";if(hl.Bu.test(ze)){let ot=await Le.text();if((0,ni.OD)(Le.url)){const xt=pl({url:Le.url,source:ot});return new Response(new Blob([xt],{type:"text/javascript"}))}return new Response(new Blob([ot],{type:"text/javascript"}))}return Le}function ng(Y,ge,Pe){try{const Le=Y.apply(this,[ge,Pe]),ze=sg(Le);return(ze.endsWith(".js")||ze.endsWith(".css"))&&!(0,ni.OD)(ze)?(0,fl.ni)(ze):ze}catch{if(hl.$b.test(ge)){const ze=`${x.$.appSubUrl??""}/public/${ge}`,et=Y.apply(this,[ze,Pe]);return(0,fl.ni)(et)}return console.warn(`SystemJS: failed to resolve '${ge}'`),ge}}function ag(Y,ge){if(new URL(ge,window.location.origin).pathname.endsWith(".css")&&!Y){const ze=wl.z.get(ge)?.default;ze&&(document.adoptedStyleSheets=[...document.adoptedStyleSheets,ze])}}function sg(Y){return Y.startsWith(`${hl.XV}:`)?Y:(Y.endsWith("!")&&(Y=Y.slice(0,-1)),["css","js","json","wasm"].some(Le=>Y.endsWith(Le))?Y:Y+".js")}var Fl=e(22055),Jd=e(6262),Wl=e(35853),vl=e(43429);function rg(Y){const ge=new URL(window.location.href),Pe=new URL(Y);return ge.host===Pe.host}async function og(Y,ge){let Pe="";if(rg(Y)?(Pe=await(await fetch(Y)).text(),Pe=pl({url:Y,source:Pe,transformSourceMapURL:!0,transformAssets:!1})):(0,ni.OD)(Y)&&(Pe=await(await fetch(Y)).text(),Pe=pl({url:Y,source:Pe,transformSourceMapURL:!0,transformAssets:!0})),Pe.length===0)throw new Error("Only same domain scripts are allowed in sandboxed plugins");Pe=Xd(Pe),ge.evaluate(Pe)}async function ig(Y){if((0,ni.OD)(Y.module)){const ge=Y.module;let Le=await(await fetch(ge)).text();return Le=pl({url:ge,source:Le,transformSourceMapURL:!0,transformAssets:!0}),Le}else{let ge=(0,ni.Av)(Y.module);const Pe=(0,fl.ni)(ge);let ze=await(await fetch(Pe)).text();return ze=pl({url:Pe,source:ze,transformSourceMapURL:!0,transformAssets:!1}),ze=Xd(ze),ze}}function Xd(Y){return Y.replace(/window\.location/gi,"window.locationSandbox")}function lg(Y){Y.evaluate(`${Wl.V.toString()};${Wl.V.name}()`)}function cg(Y){for(const ge of Object.values(x.$.datasources))if(ge.type===Y)return ge.meta;for(const ge of Object.values(x.$.panels))if(ge.id===Y)return ge;for(const ge of Object.values(x.$.apps))if(ge.id===Y)return{id:Y,type:vl.QE.app,module:ge.path};throw new Error(`Could not find plugin ${Y}`)}const ai=["iframe"];var Lc=e(7077),Zd=e(29505),dg=e(34867),ug=e(27716);const mg=!!x.$.featureToggles.frontendSandboxMonitorOnly;function fg(Y){return!!Y&&typeof Y=="object"&&Y?.hasOwnProperty("plugin")}function Rp(Y){throw new Error(`Unexpected object: ${Y}. This should never happen.`)}const Bc=(0,dg.DW)("sandbox",{monitorOnly:String(mg)});function gg(Y){return Y instanceof b.Component}function ro(Y,ge){Bc.logWarning(Y,ge)}function El(Y,ge){Bc.logError(Y,ge)}function qd(Y,ge){Bc.logInfo(Y,ge)}async function pg({isAngular:Y,pluginId:ge}){if(!x.$.featureToggles.pluginsFrontendSandbox||Y||location.search.includes("nosandbox")&&x.$.buildInfo.env==="development"||x.$.disableFrontendSandboxForPlugins.includes(ge))return!1;const ze=await(0,ug.x)(ge);return!(ze.type===vl.QE.app&&ze.signatureType===vl.kv.grafana)}function hg(Y){return Y?.constructor?.name==="RegExp"}function Kl(Y){return Y&&(hg(Y)&&(0,Lc.U)(Y)?new RegExp(Y):Array.isArray(Y)?Y.map(Kl):typeof Y=="object"?Object.keys(Y).reduce((ge,Pe)=>(Reflect.set(ge,Pe,Kl(Reflect.get(Y,Pe))),ge),{}):Y)}function Vl(Y){return Y&&((0,Lc.U)(Y)?(0,w.cloneDeep)(Y):Array.isArray(Y)?Y.map(Vl):typeof Y=="object"?Object.keys(Y).reduce((ge,Pe)=>(Reflect.set(ge,Pe,Vl(Reflect.get(Y,Pe))),ge),{}):Y)}const si=Symbol.for("@@SANDBOX_LIVE_VALUE"),$l=!!x.$.featureToggles.frontendSandboxMonitorOnly;function vg(Y,ge){const Pe=Reflect.get(Y,"nodeName");if(Pe==="body"||Y===document.body)return document.body;if(Pe==="head"||Y===document.head||Y===document.documentElement)return Y;if(ai.includes(Pe)&&(ro("<"+Pe+"> is not allowed in sandboxed plugins",{pluginId:ge,param:Pe}),!$l))throw new Error("<"+Pe+"> is not allowed in sandboxed plugins");if(tu(Y,ge)||Y.parentNode===document.body||Y.closest("#reactRoot")===null||$l)return Y;{const Le=document.createElement(Pe);return Le.dataset.grafanaPluginSandboxElement="true",Le}}function Eg(Y){if(typeof Y=="object"&&Y instanceof Element)try{return Y.nodeName!==void 0}catch{return!1}return!1}function eu(Y){const ge=Reflect.get(Y,"style");Object.hasOwn(ge,si)||Reflect.defineProperty(ge,si,{})}function _l(Y){Y&&(Array.isArray(Y)?(Y.forEach(_l),yg(Y)):typeof Y=="object"&&(Object.values(Y).forEach(_l),yg(Y)))}function yg(Y){if(Y)return Object.hasOwn(Y,si)||Reflect.defineProperty(Y,si,{}),Y}function Lp(Y){Y&&(Object.hasOwn(Y,si)||((0,Lc.U)(Y)&&!(Y instanceof Function)&&(gg(Y)||Y instanceof S.mA||Y instanceof Zd.f5)?Reflect.defineProperty(Y,si,{}):Y===kd().languages&&Object.defineProperty(Y,si,{})))}function Dg(Y){return Object.hasOwn(Y,si)}function tu(Y,ge){return!document.contains(Y)||Y.closest(`[data-plugin-sandbox=${ge}]`)!==null}let Gr;function Bp(){return Gr||(Gr=document.createElement("div"),Gr.setAttribute("id","grafana-plugin-sandbox-body"),Gr.setAttribute("data-plugin-sandbox","true"),Gr.dataset.pluginSandbox="sandboxed-plugin",Gr.style.width="100%",Gr.style.height="0%",Gr.style.overflow="hidden",Gr.style.top="0",Gr.style.left="0",document.body.appendChild(Gr)),Gr}let nu=!1;function Pg(){nu||(nu=!0,Cg(),bg())}function bg(){const Y=Worker.prototype.postMessage;Object.defineProperty(Worker.prototype,"postMessage",{value:function(...ge){return Y.apply(this,Vl(ge))}})}function Cg(){const Y=window.history.replaceState;Object.defineProperty(window.history,"replaceState",{value:function(...ge){let Pe=ge;try{Pe=(0,w.cloneDeep)(ge)}catch(Le){ro("Error cloning args in window.history.replaceState",{error:String(Le)})}return Reflect.apply(Y,this,Pe)},writable:!0,configurable:!0,enumerable:!1})}const Ir=new Map,Co=!!x.$.featureToggles.frontendSandboxMonitorOnly,au=Symbol.for("@SANDBOX_LIVE_API_PATCHED");function Tg(){return Ir.size===0&&(Sg(Ir),Mg(Ir),xg(Ir),Rg(Ir),Ag(Ir),Og(Ir),Ig(Ir),Lg(Ir),Bg(Ir),su(Ir),Ug(Ir),wg(Ir)),Ir}function zl(Y,ge){return ro(`Plugin ${ge.id} tried to set a sandboxed property`,{pluginId:ge.id,attrOrMethod:String(Y),entity:"window"}),Co?Y:()=>{throw new Error("Plugins are not allowed to set sandboxed properties")}}function Sg(Y){const ge=["contentDocument","contentWindow","src","srcdoc","srcObject","srcset"];for(const Le of ge){const ze=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,Le);if(ze){let et=function(ot,xt){const Bt=xt.id;return ro(`Plugin ${Bt} tried to access iframe.${Le}`,{pluginId:Bt,attrOrMethod:Le,entity:"iframe"}),Co?ot:()=>{throw new Error("iframe."+Le+" is not allowed in sandboxed plugins")}};var Pe=et;ze.value&&Y.set(ze.value,et),ze.set&&Y.set(ze.set,et),ze.get&&Y.set(ze.get,et)}}}function Mg(Y){const ge=Object.getOwnPropertyDescriptor(window,"console");if(ge?.value){let Le=function(ze,et){const ot=et.id;if(Co)return ze;function xt(...Bt){console.log(`[plugin ${ot}]`,...Bt)}return{log:xt,warn:xt,error:xt,info:xt,debug:xt,table:xt}};var Pe=Le;Y.set(ge.value,Le)}ge?.set&&Y.set(ge.set,zl)}function xg(Y){function ge(Le,ze){const et=ze.id;return ro(`Plugin ${et} accessed window.alert`,{pluginId:et,attrOrMethod:"alert",entity:"window"}),Co?Le:function(...ot){console.log(`[plugin ${et}]`,...ot)}}const Pe=Object.getOwnPropertyDescriptor(window,"alert");Pe?.value&&Y.set(Pe.value,ge),Pe?.set&&Y.set(Pe.set,zl)}function Og(Y){function ge(Le,ze){const et=ze.id;return function(...xt){for(const Bt of xt){const jt=String(Bt||"").toLowerCase();for(const qt of ai)if(jt.includes("<"+qt)){if(ro(`Plugin ${et} tried to set ${qt} in innerHTML`,{pluginId:et,attrOrMethod:"innerHTML",param:qt,entity:"HTMLElement"}),Co)continue;throw new Error("<"+qt+"> is not allowed in sandboxed plugins")}}if((0,w.isFunction)(Le))return Le.apply(this,xt)}}const Pe=[Object.getOwnPropertyDescriptor(Element.prototype,"innerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"outerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentHTML"),Object.getOwnPropertyDescriptor(DOMParser.prototype,"parseFromString")];for(const Le of Pe)Le?.set&&Y.set(Le.set,ge),Le?.value&&Y.set(Le.value,ge)}function Ig(Y){function ge(Le,ze){const et=ze.id;return function(xt,Bt){if(xt&&ai.includes(xt)&&(ro(`Plugin ${et} tried to create ${xt}`,{pluginId:et,attrOrMethod:"createElement",param:xt,entity:"document"}),!Co))return document.createDocumentFragment();if((0,w.isFunction)(Le))return Le.apply(this,[xt,Bt])}}const Pe=Object.getOwnPropertyDescriptor(Document.prototype,"createElement");Pe?.value&&Y.set(Pe.value,ge)}function Ag(Y){function ge(et,ot){const xt=ot.id;return function(jt,qt){const sn=jt?.nodeName?.toLowerCase()||"";if(jt&&ai.includes(sn)&&(ro(`Plugin ${xt} tried to insert ${sn}`,{pluginId:xt,attrOrMethod:"insertChild",param:sn,entity:"HTMLElement"}),!Co))return document.createDocumentFragment();if((0,w.isFunction)(et))return et.call(this,jt,qt)}}function Pe(et,ot){const xt=ot.id;return function(jt,qt){const sn=qt?.nodeName?.toLowerCase()||"";if(qt&&ai.includes(sn)&&(ro(`Plugin ${xt} tried to insert ${sn}`,{pluginId:xt,attrOrMethod:"insertAdjacentElement",param:sn,entity:"HTMLElement"}),!Co))return document.createDocumentFragment();if((0,w.isFunction)(et))return et.call(this,jt,qt)}}const Le=[Object.getOwnPropertyDescriptor(Node.prototype,"insertBefore"),Object.getOwnPropertyDescriptor(Node.prototype,"replaceChild")];for(const et of Le)et?.value&&Y.set(et.set,ge);const ze=Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentElement");ze?.value&&Y.set(ze.set,Pe)}function Rg(Y){function ge(et,ot){const xt=ot.id;return function(...jt){let qt=jt;const sn=jt?.filter(un=>!ai.includes(un.nodeName.toLowerCase()));Co||(qt=sn),qt.length!==sn.length&&ro(`Plugin ${xt} tried to append fobiddenElements`,{pluginId:xt,attrOrMethod:"append",param:jt?.filter(un=>ai.includes(un.nodeName.toLowerCase()))?.join(",")||"",entity:"HTMLElement"}),(0,w.isFunction)(et)&&et.apply(this,qt)}}function Pe(et,ot,xt){const Bt=ot.id;return function(qt){const sn=qt?.nodeName?.toLowerCase()||"";if(qt&&ai.includes(sn)&&(ro(`Plugin ${Bt} tried to append ${sn}`,{pluginId:Bt,attrOrMethod:"appendChild",param:sn,entity:"HTMLElement"}),!Co))return document.createDocumentFragment();if(xt&&qt&&sn==="script"&&qt instanceof HTMLScriptElement){og(qt.src,xt).then(()=>{qt.onload?.call(qt,new Event("load"))}).catch(un=>{qt.onerror?.call(qt,new ErrorEvent("error",{error:un}))});return}if((0,w.isFunction)(et))return et.call(this,qt)}}const Le=[Object.getOwnPropertyDescriptor(Element.prototype,"append"),Object.getOwnPropertyDescriptor(Element.prototype,"prepend"),Object.getOwnPropertyDescriptor(Element.prototype,"after"),Object.getOwnPropertyDescriptor(Element.prototype,"before"),Object.getOwnPropertyDescriptor(Document.prototype,"append"),Object.getOwnPropertyDescriptor(Document.prototype,"prepend")];for(const et of Le)et?.value&&Y.set(et.value,ge);const ze=Object.getOwnPropertyDescriptor(Node.prototype,"appendChild");ze?.value&&Y.set(ze.value,Pe)}function Lg(Y){const ge=Object.getOwnPropertyDescriptor(Worker.prototype,"postMessage");function Pe(Le){return function(...et){try{const ot=(0,w.cloneDeep)(et);(0,w.isFunction)(Le)&&Le.apply(this,ot)}catch{throw new Error("postMessage arguments are invalid objects")}}}ge?.value&&Y.set(ge.value,Pe)}function Bg(Y){const ge=Object.getOwnPropertyDescriptor(Document.prototype,"defaultView");ge?.get&&Y.set(ge.get,()=>()=>window);const Pe=["write"];for(const Le of Pe){const ze=Object.getOwnPropertyDescriptor(Document.prototype,Le);ze?.set&&Y.set(ze.set,zl),ze?.value&&Y.set(ze.value,zl)}}async function su(Y){const ge=Reflect.get(window,"monaco");if(!ge||Object.hasOwn(ge,au))return;const Pe=ge.languages.setMonarchTokensProvider;function Le(){return function(...ze){return ze.length!==2?Pe.apply(ge,ze):Pe.call(ge,ze[0],Kl(ze[1]))}}Y.set(ge.languages.setMonarchTokensProvider,Le),Reflect.set(ge,au,{})}async function Ug(Y){const ge=Object.getOwnPropertyDescriptor(window,"postMessage");function Pe(Le){return function(...et){try{const ot=(0,w.cloneDeep)(et);(0,w.isFunction)(Le)&&Le.apply(this,ot)}catch{throw new Error("postMessage arguments are invalid objects")}}}ge?.value&&Y.set(ge.value,Pe)}function Ng(Y){su(Ir)}function wg(Y){function ge(Pe){return(0,w.isFunction)(Pe)?function(...Le){const ze=Pe.apply(this,Le);return _l(ze),ze}:Pe}Y.set(w.cloneDeep,ge)}var Fg=e(66161);async function Wg(Y,ge){if(!fg(Y))return Y;const Pe=await Promise.resolve(Y.plugin);if(Reflect.has(Pe,"panel")&&Reflect.set(Pe,"panel",yl(Reflect.get(Pe,"panel"),ge)),Reflect.has(Pe,"components")){const Le=Reflect.get(Pe,"components");Object.entries(Le).forEach(([ze,et])=>{Reflect.set(Le,ze,yl(et,ge))}),Reflect.set(Pe,"components",Le)}if(Reflect.has(Pe,"root")&&Reflect.set(Pe,"root",yl(Reflect.get(Pe,"root"),ge)),Reflect.has(Pe,"extensionConfigs")){const Le=Reflect.get(Pe,"extensionConfigs");for(const ze of Le)Reflect.has(ze,"component")&&Reflect.set(ze,"component",yl(Reflect.get(ze,"component"),ge));Reflect.set(Pe,"extensionConfigs",Le)}if(Reflect.has(Pe,"configPages")){const Le=Reflect.get(Pe,"configPages")??[];for(const[ze,et]of Object.entries(Le))!et.body||!(0,w.isFunction)(et.body)||Reflect.set(Le,ze,{...et,body:yl(et.body,ge)});Reflect.set(Pe,"configPages",Le)}return Y}const yl=(Y,ge)=>{const Pe=b.memo(Le=>b.createElement("div",{"data-plugin-sandbox":ge.id,style:{height:ge.type===vl.QE.app||ge.type===vl.QE.panel?"100%":"auto"}},b.createElement(Y,{...Le})));return Pe.displayName=`GrafanaSandbox(${Y.displayName||Y.name||"Component"})`,Pe},Uc=new Map,ru={};async function Kg({pluginId:Y}){Pg();try{const ge=cg(Y);return Uc.has(Y)||Uc.set(Y,Vg(ge)),Uc.get(Y)}catch(ge){const Pe=new Error(`Could not import plugin ${Y} inside sandbox: `+ge);throw El(Pe,{pluginId:Y,error:String(ge)}),Pe}}async function Vg(Y){return qd("Loading with sandbox",{pluginId:Y.id}),new Promise(async(ge,Pe)=>{const Le=Tg();let ze;function et(xt){if(Eg(xt)){const qt=vg(xt,Y.id);return eu(qt),qt}else Lp(xt);const Bt=Le.get(xt);if(Bt)return Bt(xt,Y,ze);const jt=Ng(xt);return jt||xt}ze=(0,Fl.A)(window,{distortionCallback:et,defaultPolicy:Jd.G,liveTargetCallback:Dg,endowments:Object.getOwnPropertyDescriptors({locationSandbox:window.location,setImmediate:function(xt,...Bt){return setTimeout(xt,0,...Bt)},get monaco(){return Reflect.get(window,"monaco")},get Prism(){return Reflect.get(window,"Prism")},get jQuery(){return Reflect.get(window,"jQuery")},get $(){return Reflect.get(window,"jQuery")},get grafanaBootData(){if(ru[Y.id+"-grafanaBootData"]||(ru[Y.id+"-grafanaBootData"]=!0,qd("Plugin using window.grafanaBootData",{sandbox:"true",pluginId:Y.id,guessedPluginName:Y.id,parent:"window",packageName:"window",key:"grafanaBootData"})),x.$.buildInfo.env==="development")throw new Error(`Error in ${Y.id}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`);return console.error(`${Y.id.toUpperCase()}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`),x.$.bootData},async define(xt,Bt,jt){let qt,sn;Array.isArray(xt)?(qt=xt,sn=Bt):(qt=Bt,sn=jt);try{const un=$g(qt,Y.id),Zt=sn.apply(null,un),vn=await Wg(Zt,Y);ge(vn)}catch(un){const Zt=new Error(`Could not execute plugin's define ${Y.id}: `+un);El(Zt,{pluginId:Y.id,error:String(un)}),Pe(Zt)}}})}),lg(ze);let ot="";try{ot=await ig(Y)}catch(xt){const Bt=new Error(`Could not load plugin code ${Y.id}: `+xt);El(Bt,{pluginId:Y.id,error:String(xt)}),Pe(Bt)}try{ze.evaluate(ot)}catch(xt){const Bt=new Error(`Could not run plugin ${Y.id} inside sandbox: `+xt);El(Bt,{pluginId:Y.id,error:String(xt)}),Pe(Bt)}})}function $g(Y,ge){const Pe=[];for(const Le of Y){let ze=Fg.s.get(Le);if(ze?.__useDefault&&(ze=ze.default),!ze){const et=new Error(`[sandbox] Could not resolve dependency ${Le}`);throw El(et,{pluginId:ge,dependency:Le,error:String(et)}),et}Pe.push(ze)}return Pe}const _g=(0,ni.kB)(eg);wl.z.addImportMap({imports:_g});const $o=wl.z.constructor.prototype;$o.shouldFetch=function(Y){const ge=(0,fl.QO)(Y),Pe=/^[^#?]+\.(js)([?#].*)?$/;return(0,ni.OD)(Y)||!!ge?.isAngular||!Pe.test(Y)};const zg=$o.import;$o.import=function(...Y){return zg.apply(this,Y).then(ge=>ge&&ge.__useDefault?ge.default:ge)};const kg=$o.fetch;$o.fetch=function(Y,ge){return tg(kg,Y,ge)};const Hg=$o.resolve;$o.resolve=ng.bind($o,Hg),$o.onload=ag;async function Nc({path:Y,version:ge,isAngular:Pe,pluginId:Le}){ge&&(0,fl.GD)({pluginId:Le,version:ge,isAngular:Pe});const ze=Uf[Y];if(ze)return typeof ze=="function"?await ze():ze;let et=(0,ni.Av)(Y);return await pg({isAngular:Pe,pluginId:Le})?Kg({pluginId:Le}):wl.z.import(et)}function Gg(Y){const ge=Y.angular?.detected??Y.angularDetected;return Nc({path:Y.module,version:Y.info?.version,isAngular:ge,pluginId:Y.id}).then(Pe=>{if(Pe.plugin){const Le=Pe.plugin;return Le.meta=Y,Le}if(Pe.Datasource){const Le=new S.tD(Pe.Datasource);return Le.setComponentsFromLegacyExports(Pe),Le.meta=Y,Le}throw new Error("Plugin module is missing DataSourcePlugin or Datasource constructor export")})}function jg(Y){const ge=Y.angular?.detected??Y.angularDetected;return Nc({path:Y.module,version:Y.info?.version,isAngular:ge,pluginId:Y.id}).then(Pe=>{const Le=Pe.plugin?Pe.plugin:new O.hX;return Le.init(Y),Le.meta=Y,Le.setComponentsFromLegacyExports(Pe),Le})}},66161:(G,I,e)=>{"use strict";e.d(I,{s:()=>t});const t=new Map([])},60677:(G,I,e)=>{"use strict";e.d(I,{W3:()=>m,Wy:()=>l,z4:()=>i});var t=e(43429),n=e(34867),s=e(15162),r=e(27716),o=e(54427);async function m(u){const d=await(0,r.x)(u);let p;if(d.type===t.QE.app&&(p=await(0,o.ui)(d)),d.type===t.QE.datasource&&(p=await(0,o.cS)(d)),d.type===t.QE.panel&&(p=await(0,s.Kk)(d)),d.type===t.QE.renderer&&(p={meta:d}),!p)throw new Error("Unknown Plugin type: "+d.type);return p}function l(u,d,p){let y={...u},f;function P(E,g){return!g.startsWith(E.url??"")||f&&(f.url?.length??0)>(E.url?.length??0)?E:(f&&(f.active=!1),f={...E,active:!0},f)}function a(E,g=0){if(g>10)return E;if(E.children){const h=E.children.map(D=>a(D,g+1));return{...P(E,p),children:h}}return P(E,p)}return y.children=(y?.children??[]).map(a),{main:y,node:f??y}}const i=(0,n.DW)("features.plugins")},81862:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>x,Cj:()=>p,HO:()=>g,Mj:()=>f,Nm:()=>y,Q9:()=>E,RS:()=>v,c1:()=>d,g$:()=>h,ny:()=>P,ri:()=>a,uh:()=>D,xu:()=>c});var t=e(65307),n=e(2543),s=e.n(n),r=e(72724),o=e(47232),m=e(2913),l=e(10096);const i={orgId:m.Ay.bootData.user.orgId,timeZone:m.Ay.bootData.user.timezone,weekStart:m.Ay.bootData.user.weekStart,fiscalYearStartMonth:0,orgsAreLoading:!1,sessionsAreLoading:!1,teamsAreLoading:!1,isUpdating:!1,orgs:[],sessions:[],teams:[],user:null},u=(0,t.Z0)({name:"user/profile",initialState:i,reducers:{updateTimeZone:(b,M)=>{b.timeZone=M.payload.timeZone},updateWeekStart:(b,M)=>{b.weekStart=M.payload.weekStart},updateFiscalYearStartMonth:(b,M)=>{b.fiscalYearStartMonth=M.payload.fiscalYearStartMonth},setUpdating:(b,M)=>{b.isUpdating=M.payload.updating},userLoaded:(b,M)=>{b.user=M.payload.user},initLoadTeams:(b,M)=>{b.teamsAreLoading=!0},teamsLoaded:(b,M)=>{b.teams=M.payload.teams,b.teamsAreLoading=!1},initLoadOrgs:(b,M)=>{b.orgsAreLoading=!0},orgsLoaded:(b,M)=>{b.orgs=M.payload.orgs,b.orgsAreLoading=!1},initLoadSessions:(b,M)=>{b.sessionsAreLoading=!0},sessionsLoaded:(b,M)=>{const A=M.payload.sessions.sort((R,B)=>Number(B.isActive)-Number(R.isActive));b.sessions=A.map(R=>({id:R.id,isActive:R.isActive,seenAt:(0,r.fq)(R.seenAt),createdAt:R.createdAt,clientIp:R.clientIp,browser:R.browser,browserVersion:R.browserVersion,os:R.os,osVersion:R.osVersion,device:R.device})),b.sessionsAreLoading=!1},userSessionRevoked:(b,M)=>{b.sessions=b.sessions.filter(A=>A.id!==M.payload.tokenId),b.isUpdating=!1}}}),d=b=>async M=>{(0,n.set)(l.TP,"user.fiscalYearStartMonth",b),M(S({fiscalYearStartMonth:b}))},p=b=>async M=>{(!(0,n.isString)(b)||(0,n.isEmpty)(b))&&(b=m.Ay?.bootData?.user?.timezone),(0,n.set)(l.TP,"user.timezone",b),M(C({timeZone:b}))},c=b=>async M=>{(!(0,n.isString)(b)||(0,n.isEmpty)(b))&&(b=m.Ay?.bootData?.user?.weekStart),(0,n.set)(l.TP,"user.weekStart",b),M(T({weekStart:b})),(0,o.$D)(b)},{setUpdating:y,initLoadOrgs:f,orgsLoaded:P,initLoadTeams:a,teamsLoaded:E,userLoaded:g,userSessionRevoked:h,initLoadSessions:D,sessionsLoaded:v,updateTimeZone:C,updateWeekStart:T,updateFiscalYearStartMonth:S}=u.actions,O=u.reducer,x={user:u.reducer}},32901:(G,I,e)=>{"use strict";e.d(I,{O:()=>t,q:()=>n});const t=s=>s.timeZone,n=s=>s.fiscalYearStartMonth},82537:(G,I,e)=>{"use strict";e.d(I,{g:()=>o});var t=e(75816),n=e(56389);const s=m=>m.items?m.items.map(l=>({uid:l.metadata.name||"",title:l.spec.title,targets:l.spec.targets.map(i=>i.properties),createdAtTimestamp:new Date(l.metadata.creationTimestamp||"").getTime()})):[],r=m=>{const{title:l,targets:i}=m;return{apiVersion:n.mG,kind:n.GY.QueryTemplate,metadata:{generateName:"A"+l},spec:{title:l,vars:[],targets:i.map(u=>({variables:{},properties:u}))}}},o=(0,t.xP)({baseQuery:n.Su,tagTypes:["QueryTemplatesList"],endpoints:m=>({allQueryTemplates:m.query({query:()=>({}),transformResponse:s,providesTags:["QueryTemplatesList"]}),addQueryTemplate:m.mutation({query:l=>({method:"POST",data:r(l)}),invalidatesTags:["QueryTemplatesList"]})}),reducerPath:"queryLibrary"})},56389:(G,I,e)=>{"use strict";e.d(I,{C1:()=>o,GY:()=>r,Su:()=>m,mG:()=>s});var t=e(75505),n=e(17172);const s="peakq.grafana.app/v0alpha1";var r=(l=>(l.QueryTemplate="QueryTemplate",l))(r||{});const o=`/apis/${s}/namespaces/default/querytemplates/`,m=async l=>{try{const i=(0,n.AI)().fetch({url:o,showErrorAlert:!0,method:l.method||"GET",data:l.data});return await(0,t.s)(i)}catch(i){return(0,n.NF)(i)?{error:new Error(i.data.message)}:i instanceof Error?{error:i}:{error:new Error("Unknown error")}}}},64152:(G,I,e)=>{"use strict";e.d(I,{d:()=>s,m:()=>n});class t{constructor(){this.extraRenderActions=[]}addExtraRenderAction(o){this.extraRenderActions=this.extraRenderActions.concat(o)}getAllExtraRenderAction(){return this.extraRenderActions}}const n=new t,s=new t},65160:(G,I,e)=>{"use strict";e.d(I,{c:()=>V,E:()=>k});var t=e(46942),n=e.n(t),s=e(2543),r=e(55127),o=e.n(r),m=e(96540),l=e(41987),i=e(76287),u=e(18226),d=e(39070),p=e(14236),c=e(26272),y=e(13544),f=e(19347),P=e(7376),a=e(14110),E=e(39938),g=e(66602),h=e(22214),D=e(10343),v=e(7788),C=e(8484),T=e(74856),S=e(84423),O=e(64152),x=e(32196),b=e(40845),M=e(14578),A=e(10354),R=e(72093),B=e(51612);const U=j=>{const{query:H,queries:J,onChange:X,collapsedText:se,renderExtras:ae,hidden:ne}=j,q=(0,b.of)(N),[ee,z]=(0,m.useState)(!1),[te,ie]=(0,m.useState)(null),ce=le=>{z(!0)},ue=le=>{if(z(!1),te){ie(null);return}H.refId!==le&&X({...H,refId:le})},fe=le=>{const pe=le.currentTarget.value.trim();if(pe.length===0){ie("An empty query name is not allowed");return}for(const ve of J)if(ve!==H&&pe===ve.refId){ie("Query name already exists");return}te&&ie(null)},Te=le=>{ue(le.currentTarget.value.trim())},he=le=>{le.key==="Enter"&&ue(le.currentTarget.value)},de=le=>{le.target.select()};return m.createElement(m.Fragment,null,m.createElement("div",{className:q.wrapper},!ee&&m.createElement("button",{className:q.queryNameWrapper,"aria-label":y.Tp.components.QueryEditorRow.title(H.refId),title:"Edit query name",onClick:ce,"data-testid":"query-name-div",type:"button"},m.createElement("span",{className:q.queryName},H.refId),m.createElement(M.I,{name:"pen",className:q.queryEditIcon,size:"sm"})),ee&&m.createElement(m.Fragment,null,m.createElement(A.p,{type:"text",defaultValue:H.refId,onBlur:Te,autoFocus:!0,onKeyDown:he,onFocus:de,invalid:te!==null,onChange:fe,className:q.queryNameInput,"data-testid":"query-name-input"}),te&&m.createElement(R.P,{horizontal:!0},te)),W(j,q),ae&&m.createElement("div",{className:q.itemWrapper},ae()),ne&&m.createElement("em",{className:q.contextInfo},"Hidden")),se&&m.createElement("div",{className:q.collapsedText},se))},W=(j,H)=>{const{alerting:J,dataSource:X,onChangeDataSource:se}=j;return se?m.createElement("div",{className:H.itemWrapper},m.createElement(B.s,{variables:!0,alerting:J,current:X.name,onChange:se})):m.createElement("em",{className:H.contextInfo},"(",X.name,")")},N=j=>({wrapper:(0,x.css)`
      label: Wrapper;
      display: flex;
      align-items: center;
      margin-left: ${j.spacing(.5)};
      overflow: hidden;
    `,queryNameWrapper:(0,x.css)`
      display: flex;
      cursor: pointer;
      border: 1px solid transparent;
      border-radius: ${j.shape.borderRadius(2)};
      align-items: center;
      padding: 0 0 0 ${j.spacing(.5)};
      margin: 0;
      background: transparent;
      overflow: hidden;

      &:hover {
        background: ${j.colors.action.hover};
        border: 1px dashed ${j.colors.border.strong};
      }

      &:focus {
        border: 2px solid ${j.colors.primary.border};
      }

      &:hover,
      &:focus {
        .query-name-edit-icon {
          visibility: visible;
        }
      }
    `,queryName:(0,x.css)`
      font-weight: ${j.typography.fontWeightMedium};
      color: ${j.colors.primary.text};
      cursor: pointer;
      overflow: hidden;
      margin-left: ${j.spacing(.5)};
    `,queryEditIcon:(0,x.cx)((0,x.css)`
        margin-left: ${j.spacing(2)};
        visibility: hidden;
      `,"query-name-edit-icon"),queryNameInput:(0,x.css)`
      max-width: 300px;
      margin: -4px 0;
    `,collapsedText:(0,x.css)`
      font-weight: ${j.typography.fontWeightRegular};
      font-size: ${j.typography.bodySmall.fontSize};
      color: ${j.colors.text.secondary};
      padding-left: ${j.spacing(1)};
      align-items: center;
      overflow: hidden;
      font-style: italic;
      white-space: nowrap;
      text-overflow: ellipsis;
    `,contextInfo:(0,x.css)`
      font-size: ${j.typography.bodySmall.fontSize};
      font-style: italic;
      color: ${j.colors.text.secondary};
      padding-left: 10px;
      padding-right: 10px;
    `,itemWrapper:(0,x.css)`
      display: flex;
      margin-left: 4px;
    `});function w({error:j}){const H=(0,b.of)(L),J=j?.message??j?.data?.message??"Query error";return m.createElement("div",{className:H.wrapper},m.createElement("div",{className:H.icon},m.createElement(M.I,{name:"exclamation-triangle"})),m.createElement("div",{className:H.message},J,j.traceId!=null&&m.createElement(m.Fragment,null,m.createElement("br",null)," ",m.createElement("span",null,"(Trace ID: ",j.traceId,")"))))}const L=j=>({wrapper:(0,x.css)({marginTop:j.spacing(.5),background:j.colors.background.secondary,display:"flex"}),icon:(0,x.css)({background:j.colors.error.main,color:j.colors.error.contrastText,padding:j.spacing(1)}),message:(0,x.css)({fontSize:j.typography.bodySmall.fontSize,fontFamily:j.typography.fontFamilyMonospace,padding:j.spacing(1)})});class V extends m.PureComponent{constructor(){super(...arguments),this.element=null,this.angularScope=null,this.angularQueryEditor=null,this.dataSourceSrv=(0,f.l)(),this.id="",this.state={datasource:null,hasTextEditMode:!1,data:void 0,isOpen:!0,showingHelp:!1},this.renderAngularQueryEditor=()=>{if(!this.element)return;this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null);const H=(0,P.E)(),J='<plugin-component type="query-ctrl" />',X={ctrl:this.getAngularQueryComponentScope()};this.angularQueryEditor=H.load(this.element,X,J),this.angularScope=X.ctrl},this.onOpen=()=>{this.renderAngularQueryEditor()},this.renderPluginEditor=()=>{const{query:H,onChange:J,queries:X,onRunQuery:se,onAddQuery:ae,app:ne=l.Jk.PanelEditor,history:q}=this.props,{datasource:ee,data:z}=this.state;if(this.isWaitingForDatasourceToLoad())return null;if(ee?.components?.QueryCtrl)return m.createElement("div",{ref:te=>this.element=te});if(ee){let te=this.getReactQueryEditor(ee);if(te)return m.createElement(i.p,{instanceSettings:this.props.dataSource},m.createElement(te,{key:ee?.name,query:H,datasource:ee,onChange:J,onRunQuery:se,onAddQuery:ae,data:z,range:(0,T.jG)().timeRange(),queries:X,app:ne,history:q}))}return m.createElement("div",null,m.createElement(C.x6,{i18nKey:"query-operation.query-editor-not-exported"},"Data source plugin does not export any Query Editor component"))},this.onToggleEditMode=(H,J)=>{H.stopPropagation(),this.angularScope&&this.angularScope.toggleEditorMode&&(this.angularScope.toggleEditorMode(),this.angularQueryEditor?.digest(),J.isOpen||J.onOpen())},this.onRemoveQuery=()=>{const{onRemoveQuery:H,query:J,onQueryRemoved:X}=this.props;H(J),X&&X()},this.onCopyQuery=()=>{const{query:H,onAddQuery:J,onQueryCopied:X}=this.props,se=(0,s.cloneDeep)(H);J(se),X&&X()},this.onHideQuery=()=>{const{query:H,onChange:J,onRunQuery:X,onQueryToggled:se}=this.props;J({...H,hide:!H.hide}),X(),se&&se(H.hide),(0,a.rR)("query_editor_row_hide_query_clicked",{hide:!H.hide})},this.onToggleHelp=()=>{this.setState(H=>({showingHelp:!H.showingHelp}))},this.onClickExample=H=>{H.datasource===void 0&&(H.datasource={type:this.props.dataSource.type,uid:this.props.dataSource.uid}),this.props.onChange({...H,refId:this.props.query.refId}),this.onToggleHelp()},this.renderWarnings=()=>{const{data:H,query:J}=this.props,se=(k(H,J.refId)?.series??[]).reduce((ee,z)=>{if(!z.meta?.notices)return ee;const te=(0,s.filter)(z.meta.notices,{severity:"warning"})??[];return ee.concat(te)},[]),ae=(0,s.uniqBy)(se,"text");if(!(ae.length>0))return null;const q=ae.map(ee=>ee.text).join(`
`);return m.createElement(E.E,{key:"query-warning",color:"orange",icon:"exclamation-triangle",text:m.createElement(m.Fragment,null,ae.length," ",o()("warning",ae.length)),tooltip:q})},this.renderExtraActions=()=>{const{query:H,queries:J,data:X,onAddQuery:se,dataSource:ae}=this.props,ne=O.d.getAllExtraRenderAction().map((q,ee)=>q({query:H,queries:J,timeRange:X.timeRange,onAddQuery:se,dataSource:ae,key:ee})).filter(Boolean);return ne.push(this.renderWarnings()),ne},this.renderActions=H=>{const{query:J,hideHideQueryButton:X=!1}=this.props,{hasTextEditMode:se,datasource:ae,showingHelp:ne}=this.state,q=!!J.hide,ee=ae?.components?.QueryEditorHelp;return m.createElement(m.Fragment,null,ee&&m.createElement(D.A,{title:(0,C.t)("query-operation.header.datasource-help","Show data source help"),icon:"question-circle",onClick:this.onToggleHelp,active:ne}),se&&m.createElement(D.q,{title:(0,C.t)("query-operation.header.toggle-edit-mode","Toggle text edit mode"),icon:"pen",onClick:z=>{this.onToggleEditMode(z,H)}}),this.renderExtraActions(),m.createElement(D.q,{title:(0,C.t)("query-operation.header.duplicate-query","Duplicate query"),icon:"copy",onClick:this.onCopyQuery}),X?null:m.createElement(D.A,{dataTestId:y.Tp.components.QueryEditorRow.actionButton("Hide response"),title:J.hide?(0,C.t)("query-operation.header.show-response","Show response"):(0,C.t)("query-operation.header.hide-response","Hide response"),icon:q?"eye-slash":"eye",active:q,onClick:this.onHideQuery}),m.createElement(D.q,{title:(0,C.t)("query-operation.header.remove-query","Remove query"),icon:"trash-alt",onClick:this.onRemoveQuery}))},this.renderHeader=H=>{const{alerting:J,query:X,dataSource:se,onChangeDataSource:ae,onChange:ne,queries:q,renderHeaderExtras:ee}=this.props;return m.createElement(U,{query:X,queries:q,onChangeDataSource:ae,dataSource:se,hidden:X.hide,onClick:z=>this.onToggleEditMode(z,H),onChange:ne,collapsedText:H.isOpen?null:this.renderCollapsedText(),renderExtras:ee,alerting:J})}}componentDidMount(){const{data:H,query:J,id:X}=this.props,se=k(H,J.refId);this.id=(0,s.uniqueId)(X+"_"),this.setState({data:se}),this.loadDatasource()}componentWillUnmount(){this.angularQueryEditor&&this.angularQueryEditor.destroy()}getAngularQueryComponentScope(){const{query:H,queries:J}=this.props,{datasource:X}=this.state,se=new S.a9({targets:J}),ae={},ne=this;return{datasource:X,target:H,panel:se,dashboard:ae,refresh:()=>{H.hide!==ne.props.query.hide&&(H.hide=ne.props.query.hide),this.props.onChange(H),this.props.onRunQuery()},render:()=>()=>console.log("legacy render function called, it does nothing"),events:this.props.eventBus||new u.o,range:(0,T.jG)().timeRange()}}getInterpolatedDataSourceUID(){if(this.props.query.datasource){const H=this.dataSourceSrv.getInstanceSettings(this.props.query.datasource);return H?.rawRef?.uid??H?.uid}return this.props.dataSource.rawRef?.uid??this.props.dataSource.uid}async loadDatasource(){let H;const J=this.getInterpolatedDataSourceUID();try{H=await this.dataSourceSrv.get(J)}catch{H=await this.dataSourceSrv.get()}typeof this.props.onDataSourceLoaded=="function"&&this.props.onDataSourceLoaded(H),this.setState({datasource:H,queriedDataSourceIdentifier:J,hasTextEditMode:(0,s.has)(H,"components.QueryCtrl.prototype.toggleEditorMode")})}componentDidUpdate(H){const{datasource:J,queriedDataSourceIdentifier:X}=this.state,{data:se,query:ae}=this.props;if(H.id!==this.props.id&&(this.id=(0,s.uniqueId)(this.props.id+"_")),se!==H.data){const ne=k(se,ae.refId);this.setState({data:ne}),this.angularScope&&(this.angularScope.range=(0,T.jG)().timeRange()),this.angularQueryEditor&&ne&&K(this.angularScope,ne,this.angularQueryEditor)}if(J&&X!==this.getInterpolatedDataSourceUID()){this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null),this.loadDatasource();return}!this.element||this.angularQueryEditor||this.renderAngularQueryEditor()}getReactQueryEditor(H){if(H)switch(this.props.app){case l.Jk.Explore:return H.components?.ExploreMetricsQueryField||H.components?.ExploreLogsQueryField||H.components?.ExploreQueryField||H.components?.QueryEditor;case l.Jk.PanelEditor:case l.Jk.Dashboard:default:return H.components?.QueryEditor}}isWaitingForDatasourceToLoad(){return this.getInterpolatedDataSourceUID()!==this.state.queriedDataSourceIdentifier}renderCollapsedText(){const{datasource:H}=this.state;return H?.getQueryDisplayText?H.getQueryDisplayText(this.props.query):this.angularScope&&this.angularScope.getCollapsedText?this.angularScope.getCollapsedText():null}render(){const{query:H,index:J,visualization:X,collapsable:se}=this.props,{datasource:ae,showingHelp:ne,data:q}=this.state,ee=H.hide,z=q?.error&&q.error.refId===H.refId?q.error:q?.errors?.find(ue=>ue.refId===H.refId),te=n()("query-editor-row",{"query-editor-row--disabled":ee,"gf-form-disabled":ee});if(!ae)return null;const ie=this.renderPluginEditor(),ce=ae.components?.QueryEditorHelp;return m.createElement("div",{"data-testid":"query-editor-row","aria-label":y.Tp.components.QueryEditorRows.rows},m.createElement(v.u,{id:this.id,draggable:!0,collapsable:se,index:J,headerElement:this.renderHeader,actions:this.renderActions,onOpen:this.onOpen},m.createElement("div",{className:te,id:this.id},m.createElement(g.Xw,null,ne&&ce&&m.createElement(h.j,null,m.createElement(ce,{onClickExample:ue=>this.onClickExample(ue),query:this.props.query,datasource:ae})),ie),z&&m.createElement(w,{error:z}),X)))}}function K(j,H,J){if(H.state===d.Gu.Done){const X=H.series.map(se=>(0,p.w3)(se));j.events.emit(c.ee.dataReceived,X)}else H.state===d.Gu.Error&&j.events.emit(c.ee.dataError,H.error);setTimeout(J.digest)}function k(j,H){const J=j.series.filter(ne=>ne.refId===H);if(j.state!==d.Gu.Loading&&(j.error||j.errors?.length)&&!j.series.length)return{...j,state:d.Gu.Error};let X=j.state,se=j.errors?.find(ne=>ne.refId===H);!se&&j.error&&(se=j.error.refId===H?j.error:void 0),X!==d.Gu.Loading&&(se?X=d.Gu.Error:j.state===d.Gu.Error&&(X=d.Gu.Done));const ae=j.timeRange;return{...j,state:X,series:J,error:se,errors:se?[se]:void 0,timeRange:ae}}},44932:(G,I,e)=>{"use strict";e.d(I,{L:()=>m});var t=e(96540),n=e(75494),s=e(14110),r=e(19347),o=e(65160);class m extends t.PureComponent{constructor(){super(...arguments),this.onRemoveQuery=u=>{this.props.onQueriesChange(this.props.queries.filter(d=>d!==u))},this.onDragStart=u=>{const{queries:d,dsSettings:p}=this.props;(0,s.rR)("query_row_reorder_started",{startIndex:u.source.index,numberOfQueries:d.length,datasourceType:p.type})},this.onDragEnd=u=>{const{queries:d,onQueriesChange:p,dsSettings:c}=this.props;if(!u||!u.destination)return;const y=u.source.index,f=u.destination.index;if(y===f){(0,s.rR)("query_row_reorder_canceled",{startIndex:y,endIndex:f,numberOfQueries:d.length,datasourceType:c.type});return}const P=Array.from(d),[a]=P.splice(y,1);P.splice(f,0,a),p(P),(0,s.rR)("query_row_reorder_ended",{startIndex:y,endIndex:f,numberOfQueries:d.length,datasourceType:c.type})}}onChangeQuery(u,d){const{queries:p,onQueriesChange:c}=this.props;c(p.map((y,f)=>f===d?u:y))}onDataSourceChange(u,d){const{queries:p,onQueriesChange:c}=this.props;c(p.map((y,f)=>{if(f!==d)return y;const P={type:u.type,uid:u.uid};return y.datasource&&(0,r.l)().getInstanceSettings(y.datasource)?.type===u.type?{...y,datasource:P}:{refId:y.refId,hide:y.hide,datasource:P}}))}render(){const{dsSettings:u,data:d,queries:p,app:c,history:y,eventBus:f,onAddQuery:P,onRunQueries:a,onQueryCopied:E,onQueryRemoved:g,onQueryToggled:h,queryRowWrapper:D}=this.props;return t.createElement(n.JY,{onDragStart:this.onDragStart,onDragEnd:this.onDragEnd},t.createElement(n.gL,{droppableId:"transformations-list",direction:"vertical"},v=>t.createElement("div",{"data-testid":"query-editor-rows",ref:v.innerRef,...v.droppableProps},p.map((C,T)=>{const S=l(C,u),O=u.meta.mixed?b=>this.onDataSourceChange(b,T):void 0,x=t.createElement(o.c,{id:C.refId,index:T,key:C.refId,data:d,query:C,dataSource:S,onChangeDataSource:O,onChange:b=>this.onChangeQuery(b,T),onRemoveQuery:this.onRemoveQuery,onAddQuery:P,onRunQuery:a,onQueryCopied:E,onQueryRemoved:g,onQueryToggled:h,queries:p,app:c,history:y,eventBus:f});return D?D(x,C.refId):x}),v.placeholder)))}}const l=(i,u)=>i.datasource&&(0,r.l)().getInstanceSettings(i.datasource)||u},37464:(G,I,e)=>{"use strict";e.d(I,{g:()=>H,K:()=>X});var t=e(32196),n=e(96540),s=e(39070),r=e(43127),o=e(41987),m=e(43429),l=e(13544),i=e(19347),u=e(12131),d=e(66864),p=e(55852),c=e(40276),y=e(37390),f=e(3911),P=e(38894),a=e(16817),E=e(36663),g=e(17172),h=e(39558);function D({pluginId:ae}){const{value:ne,loading:q,error:ee}=(0,a.A)(async()=>(0,g.AI)().get(`/api/plugins/${ae}/markdown/query_help`),[]),z=(0,E.G)(ne);return q?n.createElement(h._,{text:"Loading help..."}):ee?n.createElement("h3",null,"An error occurred when loading help."):ne===""?n.createElement("h3",null,"No query help could be found."):n.createElement("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:z}})}var v=e(2913),C=e(27677),T=e(21969),S=e(50481),O=e(51612),x=e(53478),b=e(74106),M=e(14348),A=e(8480),R=e(93117),B=e(64152),U=e(44932),W=e(65879),N=e(10354),w=e(15292),L=e(7788);class V extends n.PureComponent{constructor(ne){super(ne),this.onRelativeTimeChange=ee=>{this.setState({timeRangeFrom:ee.target.value})},this.onTimeShiftChange=ee=>{this.setState({timeRangeShift:ee.target.value})},this.onOverrideTime=ee=>{const{options:z,onChange:te}=this.props,ie=k(ee.target.value),ce=K(ie);ce&&z.timeRange?.from!==ie&&te({...z,timeRange:{...z.timeRange??{},from:ie}}),this.setState({relativeTimeIsValid:ce})},this.onTimeShift=ee=>{const{options:z,onChange:te}=this.props,ie=k(ee.target.value),ce=K(ie);ce&&z.timeRange?.shift!==ie&&te({...z,timeRange:{...z.timeRange??{},shift:ie}}),this.setState({timeShiftIsValid:ce})},this.onToggleTimeOverride=()=>{const{onChange:ee,options:z}=this.props;this.setState({timeRangeHide:!this.state.timeRangeHide},()=>{ee({...z,timeRange:{...z.timeRange??{},hide:this.state.timeRangeHide}})})},this.onCacheTimeoutBlur=ee=>{const{options:z,onChange:te}=this.props;te({...z,cacheTimeout:k(ee.target.value)})},this.onQueryCachingTTLBlur=ee=>{const{options:z,onChange:te}=this.props;let ie=parseInt(ee.target.value,10);(isNaN(ie)||ie===0)&&(ie=null),te({...z,queryCachingTTL:ie})},this.onMaxDataPointsBlur=ee=>{const{options:z,onChange:te}=this.props;let ie=parseInt(ee.currentTarget.value,10);(isNaN(ie)||ie===0)&&(ie=null),ie!==z.maxDataPoints&&te({...z,maxDataPoints:ie})},this.onMinIntervalBlur=ee=>{const{options:z,onChange:te}=this.props,ie=k(ee.target.value);ie!==z.minInterval&&te({...z,minInterval:ie})},this.onOpenOptions=()=>{this.setState({isOpen:!0})},this.onCloseOptions=()=>{this.setState({isOpen:!1})};const{options:q}=ne;this.state={timeRangeFrom:q.timeRange?.from||"",timeRangeShift:q.timeRange?.shift||"",timeRangeHide:q.timeRange?.hide??!1,isOpen:!1,relativeTimeIsValid:!0,timeShiftIsValid:!0}}renderCacheTimeoutOption(){const{dataSource:ne,options:q}=this.props,ee=`If your time series store has a query cache this option can override the default cache timeout. Specify a
    numeric value in seconds.`;return ne.meta.queryOptions?.cacheTimeout?n.createElement("div",{className:"gf-form-inline"},n.createElement("div",{className:"gf-form"},n.createElement(P.I,{width:9,tooltip:ee},"Cache timeout"),n.createElement(N.p,{type:"text",className:"width-6",placeholder:"60",spellCheck:!1,onBlur:this.onCacheTimeoutBlur,defaultValue:q.cacheTimeout??""}))):null}renderQueryCachingTTLOption(){const{dataSource:ne,options:q}=this.props,ee="Cache time-to-live: How long results from this queries in this panel will be cached, in milliseconds. Defaults to the TTL in the caching configuration for this datasource.";return ne.cachingConfig?.enabled?n.createElement("div",{className:"gf-form-inline"},n.createElement("div",{className:"gf-form"},n.createElement(P.I,{width:9,tooltip:ee},"Cache TTL"),n.createElement(N.p,{type:"number",className:"width-6",placeholder:`${ne.cachingConfig.TTLMs}`,spellCheck:!1,onBlur:this.onQueryCachingTTLBlur,defaultValue:q.queryCachingTTL??void 0}))):null}renderMaxDataPointsOption(){const{data:ne,options:q}=this.props,ee=ne.request?.maxDataPoints,z=q.maxDataPoints??"",te=z==="";return n.createElement("div",{className:"gf-form-inline"},n.createElement("div",{className:"gf-form"},n.createElement(P.I,{width:9,tooltip:n.createElement(n.Fragment,null,"The maximum data points per series. Used directly by some data sources and used in calculation of auto interval. With streaming data this value is used for the rolling buffer.")},"Max data points"),n.createElement(N.p,{type:"number",className:"width-6",placeholder:`${ee}`,spellCheck:!1,onBlur:this.onMaxDataPointsBlur,defaultValue:z}),te&&n.createElement(n.Fragment,null,n.createElement("div",{className:"gf-form-label query-segment-operator"},"="),n.createElement("div",{className:"gf-form-label"},"Width of panel"))))}renderIntervalOption(){const{data:ne,dataSource:q,options:ee}=this.props,z=ne.request?.interval,te=q.interval??"No limit";return n.createElement(n.Fragment,null,n.createElement("div",{className:"gf-form-inline"},n.createElement("div",{className:"gf-form"},n.createElement(P.I,{width:9,tooltip:n.createElement(n.Fragment,null,"A lower limit for the interval. Recommended to be set to write frequency, for example ",n.createElement("code",null,"1m")," ","if your data is written every minute. Default value can be set in data source settings for most data sources.")},"Min interval"),n.createElement(N.p,{type:"text",className:"width-6",placeholder:`${te}`,spellCheck:!1,onBlur:this.onMinIntervalBlur,defaultValue:ee.minInterval??""}))),n.createElement("div",{className:"gf-form-inline"},n.createElement("div",{className:"gf-form"},n.createElement(P.I,{width:9,tooltip:n.createElement(n.Fragment,null,"The evaluated interval that is sent to data source and is used in ",n.createElement("code",null,"$__interval")," and"," ",n.createElement("code",null,"$__interval_ms"),". This value is not exactly equal to"," ",n.createElement("code",null,"Time range / max data points"),", it will approximate a series of magic number.")},"Interval"),n.createElement(P.I,{width:6},z),n.createElement("div",{className:"gf-form-label query-segment-operator"},"="),n.createElement("div",{className:"gf-form-label"},"Time range / max data points"))))}renderCollapsedText(ne){const{data:q,options:ee}=this.props,{isOpen:z}=this.state;if(z)return;let te=ee.maxDataPoints??"";te===""&&q.request&&(te=`auto = ${q.request.maxDataPoints}`);let ie=ee.minInterval;return q.request&&(ie=`${q.request.interval}`),n.createElement(n.Fragment,null,n.createElement("div",{className:ne.collapsedText},"MD = ",te),n.createElement("div",{className:ne.collapsedText},"Interval = ",ie))}render(){const{timeRangeHide:ne,relativeTimeIsValid:q,timeShiftIsValid:ee}=this.state,{timeRangeFrom:z,timeRangeShift:te,isOpen:ie}=this.state,ce=j();return n.createElement(L.u,{id:"Query options",index:0,title:"Query options",headerElement:this.renderCollapsedText(ce),isOpen:ie,onOpen:this.onOpenOptions,onClose:this.onCloseOptions},this.renderMaxDataPointsOption(),this.renderIntervalOption(),this.renderCacheTimeoutOption(),this.renderQueryCachingTTLOption(),n.createElement("div",{className:"gf-form"},n.createElement(P.I,{width:9,tooltip:n.createElement(n.Fragment,null,"Overrides the relative time range for individual panels, which causes them to be different than what is selected in the dashboard time picker in the top-right corner of the dashboard. For example to configure the Last 5 minutes the Relative time should be ",n.createElement("code",null,"now-5m")," and ",n.createElement("code",null,"5m"),", or variables like ",n.createElement("code",null,"$_relativeTime"),".")},"Relative time"),n.createElement(N.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onRelativeTimeChange,onBlur:this.onOverrideTime,invalid:!q,value:z})),n.createElement("div",{className:"gf-form"},n.createElement(P.I,{width:9,tooltip:n.createElement(n.Fragment,null,"Overrides the time range for individual panels by shifting its start and end relative to the time picker. For example to configure the Last 1h the Time shift should be ",n.createElement("code",null,"now-1h")," and"," ",n.createElement("code",null,"1h"),", or variables like ",n.createElement("code",null,"$_timeShift"),".")},"Time shift"),n.createElement(N.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onTimeShiftChange,onBlur:this.onTimeShift,invalid:!ee,value:te})),(te||z)&&n.createElement("div",{className:"gf-form-inline align-items-center"},n.createElement(P.I,{width:9},"Hide time info"),n.createElement(w.d,{value:ne,onChange:this.onToggleTimeOverride})))}}const K=ae=>ae?W.isValidTimeSpan(ae):!0,k=ae=>ae===""?null:ae,j=(0,f.N)(()=>{const{theme:ae}=v.config;return{collapsedText:(0,t.css)`
      margin-left: ${ae.spacing.md};
      font-size: ${ae.typography.size.sm};
      color: ${ae.colors.textWeak};
    `}});class H extends n.PureComponent{constructor(){super(...arguments),this.backendSrv=C.IB,this.dataSourceSrv=(0,i.l)(),this.querySubscription=null,this.state={isDataSourceModalOpen:!!u.Ny.getSearchObject().firstPanel,isLoadingHelp:!1,helpContent:null,isPickerOpen:!1,isHelpOpen:!1,queries:[],data:{state:s.Gu.NotStarted,series:[],timeRange:(0,r.E2)()}},this.onChangeDataSource=async(ne,q)=>{const{dsSettings:ee}=this.state,z=ee?await(0,i.l)().get(ee.uid):void 0,te=await(0,i.l)().get(ne.uid),ie=q||await(0,R.y)(te,ne.uid,this.state.queries,z),ce=await this.dataSourceSrv.get(ne.name);this.onChange({queries:ie,dataSource:{name:ne.name,uid:ne.uid,type:ne.meta.id,default:ne.isDefault}}),this.setState({queries:ie,dataSource:ce,dsSettings:ne}),q&&this.props.onRunQueries()},this.onAddQueryClick=()=>{const{queries:ne}=this.state;this.onQueriesChange((0,T.U7)(ne,this.newQuery())),this.onScrollBottom()},this.onAddExpressionClick=()=>{this.onQueriesChange((0,T.U7)(this.state.queries,x.Ex.newQuery())),this.onScrollBottom()},this.onScrollBottom=()=>{setTimeout(()=>{this.state.scrollElement&&this.state.scrollElement.scrollTo({top:1e4})},20)},this.onUpdateAndRun=ne=>{this.props.onOptionsChange(ne),this.props.onRunQueries()},this.onOpenHelp=()=>{this.setState({isHelpOpen:!0})},this.onCloseHelp=()=>{this.setState({isHelpOpen:!1})},this.onCloseDataSourceModal=()=>{this.setState({isDataSourceModalOpen:!1})},this.onAddQuery=ne=>{const{dsSettings:q,queries:ee}=this.state;this.onQueriesChange((0,T.U7)(ee,ne,{type:q?.type,uid:q?.uid})),this.onScrollBottom()},this.onQueriesChange=ne=>{this.onChange({queries:ne}),this.setState({queries:ne})},this.setScrollRef=ne=>{this.setState({scrollElement:ne})}}async componentDidMount(){const{options:ne,queryRunner:q}=this.props;this.querySubscription=q.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:ee=>this.onPanelDataUpdate(ee)}),this.setNewQueriesAndDatasource(ne)}componentWillUnmount(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}async componentDidUpdate(){const{options:ne}=this.props,q=await(0,i.l)().get(ne.dataSource);this.state.dataSource&&q.uid!==this.state.dataSource?.uid&&this.setNewQueriesAndDatasource(ne)}async setNewQueriesAndDatasource(ne){try{const q=await this.dataSourceSrv.get(ne.dataSource),ee=this.dataSourceSrv.getInstanceSettings(ne.dataSource),z=await this.dataSourceSrv.get(),te=q.getRef(),ie=ne.queries.map(ce=>({...(0,T.Ih)(ce)&&q?.getDefaultQuery?.(o.Jk.PanelEditor),datasource:te,...ce}));this.setState({queries:ie,dataSource:q,dsSettings:ee,defaultDataSource:z})}catch(q){console.error("failed to load data source",q)}}onPanelDataUpdate(ne){this.setState({data:ne})}newQuery(){const{dsSettings:ne,defaultDataSource:q}=this.state,ee=ne?.meta.mixed?q:ne;return{...this.state.dataSource?.getDefaultQuery?.(o.Jk.PanelEditor),datasource:{uid:ee?.uid,type:ee?.type}}}onChange(ne){this.props.onOptionsChange({...this.props.options,...ne})}renderTopSection(ne){const{onOpenQueryInspector:q,options:ee}=this.props,{dataSource:z,data:te,dsSettings:ie}=this.state;return!ie||!z?null:n.createElement(X,{data:te,dataSource:z,options:ee,dsSettings:ie,onOptionsChange:this.onUpdateAndRun,onDataSourceChange:this.onChangeDataSource,onOpenQueryInspector:q})}renderQueries(ne){const{onRunQueries:q}=this.props,{data:ee,queries:z}=this.state;return n.createElement("div",{"aria-label":l.Tp.components.QueryTab.content},n.createElement(U.L,{queries:z,dsSettings:ne,onQueriesChange:this.onQueriesChange,onAddQuery:this.onAddQuery,onRunQueries:q,data:ee}))}isExpressionsSupported(ne){return(ne.meta.alerting||ne.meta.mixed)===!0}renderExtraActions(){return B.m.getAllExtraRenderAction().map((ne,q)=>ne({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:q})).filter(Boolean)}renderAddQueryRow(ne,q){const ee=!(0,M.kN)(ne.name);return n.createElement(d.Gy,{spacing:"md",align:"flex-start"},ee&&n.createElement(p.$n,{icon:"plus",onClick:this.onAddQueryClick,variant:"secondary","data-testid":l.Tp.components.QueryTab.addQuery},"Add query"),v.Ay.expressionsEnabled&&this.isExpressionsSupported(ne)&&n.createElement(p.$n,{icon:"plus",onClick:this.onAddExpressionClick,variant:"secondary",className:q.expressionButton,"data-testid":"query-tab-add-expression"},n.createElement("span",null,"Expression\xA0")),this.renderExtraActions())}render(){const{isHelpOpen:ne,dsSettings:q}=this.state,ee=J();return n.createElement(c.E,{autoHeightMin:"100%",scrollRefCallback:this.setScrollRef},n.createElement("div",{className:ee.innerWrapper},this.renderTopSection(ee),q&&n.createElement(n.Fragment,null,n.createElement("div",{className:ee.queriesWrapper},this.renderQueries(q)),this.renderAddQueryRow(q,ee),ne&&n.createElement(y.a,{title:"Data source help",isOpen:!0,onDismiss:this.onCloseHelp},n.createElement(D,{pluginId:q.meta.id})))))}}const J=(0,f.N)(()=>{const{theme:ae}=v.Ay;return{innerWrapper:(0,t.css)`
      display: flex;
      flex-direction: column;
      padding: ${ae.spacing.md};
    `,dataSourceRow:(0,t.css)`
      display: flex;
      margin-bottom: ${ae.spacing.md};
    `,dataSourceRowItem:(0,t.css)`
      margin-right: ${ae.spacing.inlineFormMargin};
    `,dataSourceRowItemOptions:(0,t.css)`
      flex-grow: 1;
      margin-right: ${ae.spacing.inlineFormMargin};
    `,queriesWrapper:(0,t.css)`
      padding-bottom: 16px;
    `,expressionWrapper:(0,t.css)``,expressionButton:(0,t.css)`
      margin-right: ${ae.spacing.sm};
    `}});function X({dataSource:ae,options:ne,data:q,dsSettings:ee,onDataSourceChange:z,onOptionsChange:te,onOpenQueryInspector:ie}){const ce=J(),[ue,fe]=(0,n.useState)(!1);return n.createElement(n.Fragment,null,n.createElement("div",{"data-testid":l.Tp.components.QueryTab.queryGroupTopSection},n.createElement("div",{className:ce.dataSourceRow},n.createElement(P.I,{htmlFor:"data-source-picker",width:"auto"},"Data source"),n.createElement("div",{className:ce.dataSourceRowItem},n.createElement(se,{options:ne,onChange:async(Te,he)=>await z?.(Te,he),isDataSourceModalOpen:!!u.Ny.getSearchObject().firstPanel})),ae&&n.createElement(n.Fragment,null,n.createElement("div",{className:ce.dataSourceRowItem},n.createElement(p.$n,{variant:"secondary",icon:"question-circle",title:"Open data source help",onClick:()=>fe(!0),"data-testid":"query-tab-help-button"})),n.createElement("div",{className:ce.dataSourceRowItemOptions},n.createElement(V,{options:ne,dataSource:ae,data:q,onChange:Te=>{te?.(Te)}})),ie&&n.createElement("div",{className:ce.dataSourceRowItem},n.createElement(p.$n,{variant:"secondary",onClick:ie,"aria-label":l.Tp.components.QueryTab.queryInspectorButton},"Query inspector")))),ae&&(0,A.Hv)(ae.uid)&&n.createElement(b.c,{pluginId:ae.type,pluginType:m.QE.datasource,angularSupportEnabled:v.Ay?.angularSupportEnabled,showPluginDetailsLink:!0,interactionElementId:"datasource-query"})),ue&&n.createElement(y.a,{title:"Data source help",isOpen:!0,onDismiss:()=>fe(!1)},n.createElement(D,{pluginId:ee.meta.id})))}function se({options:ae,onChange:ne,...q}){const[ee,z]=(0,n.useState)(!!q.isDataSourceModalOpen);(0,n.useEffect)(()=>{u.Ny.getSearchObject().firstPanel&&u.Ny.partial({firstPanel:null},!0)},[]);const te={metrics:!0,mixed:!0,dashboard:!0,variables:!0,current:ae.dataSource,uploadFile:!0,onChange:async(ie,ce)=>{await ne(ie,ce),z(!1)}};return n.createElement(n.Fragment,null,ee&&n.createElement(S.p,{...te,onDismiss:()=>z(!1)}),n.createElement(O.s,{...te}))}},42972:(G,I,e)=>{"use strict";e.d(I,{nm:()=>ie,Dh:()=>ee});var t=e(39741),n=e(13752),s=e(64423),r=e(44240),o=e(39697),m=e(81160),l=e(67791),i=e(93031),u=e(71030),d=e(69850),p=e(1005),c=e(65961),y=e(3591),f=e(2543);function P(ce){let ue=[];const fe=(0,f.partition)(ce,"id"),Te=(0,f.groupBy)(fe[0],"id");return ue=(0,f.map)(Te,he=>he.length>1&&!(0,f.every)(he,a)?(0,f.find)(he,de=>de.eventType!=="panel-alert"):(0,f.head)(he)),ue=(0,f.concat)(ue,fe[1]),ue}function a(ce){return ce.eventType==="panel-alert"}var E=e(74856),g=e(62467),h=e(65474),D=e(66847),v=e(69862),C=e(16126),T=e(32264),S=e(19347),O=e(90569),x=e(28444),b=e(27302),M=e(7436);class A{canRun(ue){return ue?!!(!ue.annotationQuery||ue.annotations):!1}run({annotation:ue,datasource:fe,dashboard:Te,range:he}){if(!this.canRun(fe))return(0,g.of)([]);const de={};return(0,b.b)({dashboard:Te,range:he,panel:de},fe,ue).pipe((0,m.T)(le=>le.events??[]),(0,D.W)(M.SD))}}var R=e(42493);class B{canRun(ue){return ue?(0,R.E7)(ue)?!0:!!(ue.annotationQuery&&!ue.annotations):!1}run({annotation:ue,datasource:fe,dashboard:Te,range:he}){return this.canRun(fe)?(0,h.H)(fe.annotationQuery({range:he,rangeRaw:he.raw,annotation:ue,dashboard:Te})).pipe((0,D.W)(M.SD)):(0,g.of)([])}}class U{constructor(ue=[new B,new A]){this.runners=ue}canWork({dashboard:ue}){return!!ue.annotations.list.find(U.getAnnotationsToProcessFilter)}work(ue){if(!this.canWork(ue))return(0,M.$)();const{dashboard:fe,range:Te}=ue;let he=fe.annotations.list.filter(U.getAnnotationsToProcessFilter);T.$.publicDashboardAccessToken&&he.length>0&&(he=[he[0]]);const de=he.map(le=>{let pe;if(T.$.publicDashboardAccessToken){const ve=new O.X;pe=(0,g.of)(ve).pipe((0,D.W)(M.H0))}else pe=(0,h.H)((0,S.l)().get(le.datasource)).pipe((0,D.W)(M.H0));return pe.pipe((0,v.Z)(ve=>{const be=this.runners.find(Oe=>Oe.canRun(ve));return be?(fe.events.publish(new x.xc(le)),be.run({annotation:le,datasource:ve,dashboard:fe,range:Te}).pipe((0,l.Q)(ee().cancellations().pipe((0,C.p)(Oe=>Oe===le))),(0,m.T)(Oe=>(fe.snapshot&&(le.snapshotData=(0,f.cloneDeep)(Oe)),T.$.publicDashboardAccessToken?Oe:(0,M.G9)(le,Oe))),(0,d.j)(()=>{fe.events.publish(new x.yj(le))}))):(0,g.of)([])}))});return(0,r.h)(de).pipe((0,i.U)(),(0,u.T)((le,pe)=>le.concat(pe)),(0,m.T)(le=>({annotations:le,alertStates:[]})))}static getAnnotationsToProcessFilter(ue){return ue.enable&&!ue.snapshotData}}var W=e(85595),N=e(43585),w=e(16233),L=e(79938),V=e(49498),K=e(55740),k=e(57220),j=e(23662),H=e(91309),J=e(99140),X=e(31678);class se{constructor(){this.hasAlertRules={}}canWork({dashboard:ue,range:fe}){return!(!ue.uid||T.$.publicDashboardAccessToken||fe.raw.to!=="now"||this.hasAlertRules[ue.uid]===!1||!(w.TP.hasPermission(X.AccessControlAction.AlertingRuleRead)&&w.TP.hasPermission(X.AccessControlAction.AlertingRuleExternalRead)))}work(ue){if(!this.canWork(ue))return(0,M.$)();const{dashboard:fe}=ue,Te=async()=>(await(0,J.JD)(L.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:k.hY,dashboardUid:fe.uid}))).data;return(0,h.H)(Te()).pipe((0,m.T)(de=>(0,V.Kw)(de))).pipe((0,m.T)(de=>{this.hasAlertRules[fe.uid]=!1;const le={};return de.forEach(pe=>pe.rules.forEach(ve=>{if((0,j.Z8)(ve)&&ve.annotations&&ve.annotations[K.YH.panelID]){this.hasAlertRules[fe.uid]=!0;const be=Number(ve.annotations[K.YH.panelID]),Oe=(0,H.S)(ve.state);le[be]?Oe===N.O.Alerting&&le[be].state!==N.O.Alerting?le[be].state=N.O.Alerting:Oe===N.O.Pending&&le[be].state!==N.O.Alerting&&le[be].state!==N.O.Pending&&(le[be].state=N.O.Pending):le[be]={state:Oe,id:Object.keys(le).length,panelId:be,dashboardId:fe.id}}})),{alertStates:Object.values(le),annotations:[]}}),(0,D.W)(M.Zr))}}class ae{constructor(ue,fe=(0,E.jG)(),Te=[new se,new W.F,new U]){this.dashboard=ue,this.timeSrv=fe,this.workers=Te,this.run=this.run.bind(this),this.getResult=this.getResult.bind(this),this.cancel=this.cancel.bind(this),this.destroy=this.destroy.bind(this),this.executeRun=this.executeRun.bind(this),this.results=new t.m(1),this.runs=new n.B,this.cancellationStream=new n.B,this.runsSubscription=this.runs.subscribe(he=>this.executeRun(he)),this.eventsSubscription=ue.events.subscribe(y._,he=>{this.run({dashboard:this.dashboard,range:this.timeSrv.timeRange()})})}run(ue){this.runs.next(ue)}getResult(ue){return this.results.asObservable().pipe((0,m.T)(fe=>{const Te=(0,M.FK)(fe.annotations,ue),he=fe.alertStates.find(de=>!!ue&&de.panelId===ue);return{annotations:P(Te),alertState:he}}))}executeRun(ue){const Te=this.workers.filter(ve=>ve.canWork(ue)).map(ve=>ve.work(ue)),he=new s.yU,de=(0,r.h)(Te).pipe((0,l.Q)(this.runs.asObservable()),(0,i.U)(),(0,u.T)((ve,be)=>(ve.annotations=ve.annotations.concat(be.annotations),ve.alertStates=ve.alertStates.concat(be.alertStates),ve)),(0,d.j)(()=>{he.unsubscribe()}),(0,p.u)()),le=new s.yU,pe=(0,o.O)(200).pipe((0,c.u)({annotations:[],alertStates:[]}),(0,l.Q)(de),(0,d.j)(()=>{le.unsubscribe()}));le.add(pe.subscribe(ve=>{this.results.next(ve)})),he.add(de.subscribe(ve=>{this.results.next(ve)}))}cancel(ue){this.cancellationStream.next(ue)}cancellations(){return this.cancellationStream.asObservable().pipe((0,p.u)())}destroy(){this.results.complete(),this.runs.complete(),this.cancellationStream.complete(),this.runsSubscription.unsubscribe(),this.eventsSubscription.unsubscribe()}}let ne;function q(ce){ne&&ne.destroy(),ne=ce}function ee(){if(!ne)throw new Error("getDashboardQueryRunner can only be used after Grafana instance has started.");return ne}let z;function te(ce){z=ce}function ie(ce){z||(z=({dashboard:fe,timeSrv:Te,workers:he})=>new ae(fe,Te,he));const ue=z(ce);return q(ue),ue}},90569:(G,I,e)=>{"use strict";e.d(I,{X:()=>d});var t=e(62467),n=e(65474),s=e(40187),r=e(14236),o=e(17172),m=e(32264),l=e(57220),i=e(68706);const u="-- Public --";class d extends s.mA{constructor(){let c={};super({name:"public-ds",id:0,type:"public-ds",meta:c,uid:u,jsonData:{},access:"proxy",readOnly:!0}),this.annotations={prepareQuery(y){return{...y,queryType:i.nj.Annotations,refId:"anno"}}}}query(c){return c.targets.length?c.targets[0]?.datasource?.uid===l.vv?(0,n.H)(this.getAnnotations(c)):(0,t.of)({data:[]}):(0,t.of)({data:[]})}async getAnnotations(c){const{range:{to:y,from:f}}=c,P={from:f.valueOf(),to:y.valueOf()},a=await(0,o.AI)().get(`/api/public/dashboards/${m.$.publicDashboardAccessToken}/annotations`,P);return{data:[(0,r.Vc)(a)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}},85595:(G,I,e)=>{"use strict";e.d(I,{F:()=>s});var t=e(62467),n=e(7436);class s{canWork({dashboard:o}){return o?.annotations?.list?.some(m=>m.enable&&!!m.snapshotData)}work(o){if(!this.canWork(o))return(0,n.$)();const m=this.getAnnotationsFromSnapshot(o.dashboard);return(0,t.of)({annotations:m,alertStates:[]})}getAnnotationsFromSnapshot(o){return(o?.annotations?.list?.filter(u=>u.enable)).filter(u=>!!u.snapshotData).reduce((u,d)=>u.concat((0,n.G9)(d,d.snapshotData)),[])}getAnnotationsInSnapshot(o,m){const l=this.getAnnotationsFromSnapshot(o);return(0,n.FK)(l,m)}}},7436:(G,I,e)=>{"use strict";e.d(I,{$:()=>c,FK:()=>P,G9:()=>a,H:()=>E,H0:()=>p,SD:()=>d,Zr:()=>y});var t=e(2543),n=e.n(t),s=e(62467),r=e(78368),o=e(12091),m=e(32264),l=e(99140),i=e(3169),u=e(16001);function d(g){return g.cancelled?(0,s.of)([]):(f("AnnotationQueryRunner failed",g),(0,s.of)([]))}function p(g){return f("Failed to retrieve datasource",g),(0,s.of)(void 0)}const c=()=>(0,s.of)({annotations:[],alertStates:[]});function y(g){return g.cancelled||f("DashboardQueryRunner failed",g),c()}function f(g,h){const D=(0,o.u)(h);console.error("handleAnnotationQueryRunnerError",D);const v=(0,i.gi)(g,D.message);(0,l.JD)((0,u.dx)(v))}function P(g,h){return h==null?g:g.filter(D=>{let v;if(v=D.source,!v)return!0;if(v.filter){const C=(v.filter.ids??[]).includes(h);if(v.filter.exclude){if(C)return!1}else if(!C)return!1}return D.panelId&&D.source.type==="dashboard"?D.panelId===h:!0})}function a(g,h){g.snapshotData&&(g=(0,t.cloneDeep)(g),delete g.snapshotData);for(const D of h)switch(D.source=g,D.color=m.$.theme2.visualization.getColorByName(g.iconColor),D.type=g.name,D.isRegion=!!(D.timeEnd&&D.time!==D.timeEnd),D.newState?.toLowerCase()){case"pending":D.color="yellow";break;case"alerting":D.color="red";break;case"ok":D.color="green";break;case"normal":D.color="green";break;case"no_data":D.color="gray";break;case"nodata":D.color="gray";break}return h}function E(g){if(!g||!g.length)return[];const h=[];for(const D of g){const v=new r.R(D);for(let C=0;C<D.length;C++){const T=(0,t.cloneDeep)(v.get(C));h.push(T)}}return h}},80924:(G,I,e)=>{"use strict";e.d(I,{Z:()=>R,S:()=>A});var t=e(2543),n=e(39741),s=e(62467),r=e(69862),o=e(81160),m=e(66847),l=e(39070),i=e(14236),u=e(43127),d=e(90708),p=e(21423),c=e(52622),y=e(2514),f=e(41987),P=e(65879),a=e(12091),E=e(26657),g=e(47118),h=e(31193),D=e(23989),v=e(14348),C=e(42972),T=e(49510),S=e(33948);function O(U=[]){U.forEach(W=>{W.meta={...W.meta,dataTopic:c.QR.Annotations}})}function x(U,W){return(0,T.z)([U,W]).pipe((0,r.Z)(N=>{const[w,L]=N;if(L.annotations?.length||L.alertState){w.annotations||(w.annotations=[]);const V=w.annotations.concat((0,S.I)(L.annotations));O(V);const K=L.alertState;return(0,s.of)({...w,annotations:V,alertState:K})}return O(w.annotations),(0,s.of)(w)}))}var b=e(39374);let M=100;function A(){return"Q"+M++}class R{constructor(W){this.templateSrv=(0,D.w)(),this.resendLastResult=()=>{this.lastResult&&this.subject.next(this.lastResult)},this.subject=new n.m(1),this.dataConfigSource=W}getData(W){const{withFieldConfig:N,withTransforms:w}=W;let L=1,V,K=[],k=[],j,H=!0,J=-1;if(this.dataConfigSource.snapshotData){const X={state:l.Gu.Done,series:this.dataConfigSource.snapshotData.map(se=>(0,i.Vc)(se)),timeRange:(0,u.E2)(),structureRev:L};return(0,s.of)(X)}return this.subject.pipe((0,r.Z)(X=>{let se=this.dataConfigSource.getFieldOverrideOptions(),ae=this.dataConfigSource.getTransformations();if(X.series===k&&V?.fieldConfig===se?.fieldConfig&&j===ae)return(0,s.of)({...X,structureRev:L,series:K});V=se,j=ae,k=X.series;let ne=(0,s.of)(X);return w&&(ne=this.applyTransformations(X)),ne.pipe((0,o.T)(q=>{let ee=q,z=!1;if(N&&q.series?.length){if(J===this.dataConfigSource.configRev){let te;for(const ie of q.series)if((0,g.o$)(ie)){te=ie;break}te&&!te.packetInfo.schemaChanged&&K[0].fields.length===te.fields.length&&(ee={...ee,series:K.map((ie,ce)=>({...ie,length:q.series[ce].length,fields:ie.fields.map((ue,fe)=>({...ue,values:q.series[ce].fields[fe].values,state:{...ue.state,calcs:void 0,range:void 0}}))}))},z=!0)}se!=null&&(H||!z)&&(J=this.dataConfigSource.configRev,ee={...ee,series:(0,d.we)({timeZone:q.request?.timezone??"browser",data:ee.series,...se})},ee.annotations&&(ee.annotations=(0,d.we)({data:ee.annotations,...se,fieldConfig:{defaults:{},overrides:[]}})),H=!1)}return!z&&!(0,p.J3)(K,ee.series,p.bW)&&L++,K=ee.series,{...ee,structureRev:L}}))}))}applyTransformations(W){const N=this.dataConfigSource.getTransformations();if(N&&N.every(H=>H.disabled)||!N||N.length===0)return(0,s.of)(W);const L={interpolate:H=>this.templateSrv.replace(H,W?.request?.scopedVars)};let V=N.filter(H=>H.topic==null||H.topic===c.QR.Series),K=N.filter(H=>H.topic===c.QR.Annotations),k=(0,y.m)(V,W.series,L),j=(0,y.m)(K,W.annotations??[],L);return(0,t.merge)(k,j).pipe((0,o.T)(H=>{let X=H.some(se=>se.meta?.dataTopic===c.QR.Annotations)?{annotations:H}:{series:H};return{...W,...X}}),(0,m.W)(H=>(console.warn("Error running transformation:",H),(0,s.of)({...W,state:l.Gu.Error,errors:[(0,a.u)(H)]}))))}async run(W){const{queries:N,timezone:w,datasource:L,panelId:V,panelPluginId:K,dashboardUID:k,timeRange:j,timeInfo:H,cacheTimeout:J,queryCachingTTL:X,maxDataPoints:se,scopedVars:ae,minInterval:ne,app:q}=W;if((0,v.kN)(L)){this.pipeToSubject((0,v.mw)(W,N[0]),V,!0);return}const ee=this.shouldAddErrorWhenDatasourceVariableIsMultiple(L,ae),z={app:q??f.Jk.Dashboard,requestId:A(),timezone:w,panelId:V,panelPluginId:K,dashboardUID:k,range:j,timeInfo:H,interval:"",intervalMs:0,targets:(0,t.cloneDeep)(N),maxDataPoints:se,scopedVars:ae||{},cacheTimeout:J,queryCachingTTL:X,startTime:Date.now(),rangeRaw:j.raw};try{const te=await B(L,z.scopedVars),ie=te.meta?.mixed;z.targets=z.targets.map(fe=>{const Te=fe.datasource?.type===E.dR.type;return(!fe.datasource||fe.datasource.uid!==te.uid&&!ie&&!Te)&&(fe.datasource=te.getRef()),fe});const ce=ne?this.templateSrv.replace(ne,z.scopedVars):te.interval,ue=P.calculateInterval(j,se,ce);z.scopedVars=Object.assign({},z.scopedVars,{__interval:{text:ue.interval,value:ue.interval},__interval_ms:{text:ue.intervalMs.toString(),value:ue.intervalMs}}),z.interval=ue.interval,z.intervalMs=ue.intervalMs,z.filters=this.templateSrv.getAdhocFilters(te.name,!0),this.lastRequest=z,this.pipeToSubject((0,b.BN)(te,z),V,!1,ee)}catch(te){this.pipeToSubject((0,s.of)({state:l.Gu.Error,error:(0,a.u)(te),series:[],timeRange:z.range}),V)}}pipeToSubject(W,N,w=!1,L=!1){this.subscription&&this.subscription.unsubscribe();let V=W;const K=this.dataConfigSource.getDataSupport();if(K.alertStates||K.annotations){const k=this.dataConfigSource;V=x(W,(0,C.Dh)().getResult(k.id))}this.subscription=V.subscribe({next:k=>{const j=this.lastResult,H=w?k:(0,i.N$)(k,j);if(j!=null&&H.state!==l.Gu.Streaming){let J=(0,p.J3)(j.series??[],H.series??[],(ae,ne)=>ae===ne),X=(0,p.J3)(j.annotations??[],H.annotations??[],(ae,ne)=>ae===ne),se=j.state===H.state;if(J&&(H.series=j.series),X&&(H.annotations=j.annotations),J&&X&&se)return}this.lastResult=H,L&&(H.errors=[{message:"Panel is using a variable datasource with multiple values without repeat option. Please configure the panel to be repeated by the same datasource variable."}],H.state=l.Gu.Error),this.subject.next(H)}})}cancelQuery(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&(this.lastResult.state===l.Gu.Loading||this.lastResult.state===l.Gu.Streaming)&&this.subject.next({...this.lastResult,state:l.Gu.Done}))}clearLastResult(){this.lastResult=void 0,this.subject=new n.m(1)}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}useLastResultFrom(W){this.lastResult=W.getLastResult(),this.lastResult&&this.subject.next(this.lastResult)}setLastResult(W){this.lastResult=W}getLastResult(){return this.lastResult}getLastRequest(){return this.lastRequest}shouldAddErrorWhenDatasourceVariableIsMultiple(W,N){let w=!1;return W?.uid?.startsWith("${")&&this.templateSrv.replace(W.uid,N,L=>(Array.isArray(L)&&L.length>1&&(w=!0),"")),w}}async function B(U,W){return U&&typeof U=="object"&&"query"in U?U:await(0,h.tR)().get(U,W)}},81583:(G,I,e)=>{"use strict";e.d(I,{N:()=>n});var t=e(69850);function n(s,r){return(0,t.j)(()=>{r&&s.resolveCancelerIfExists(r)})}},72955:(G,I,e)=>{"use strict";e.d(I,{B:()=>n});var t=e(21423);const n=(s,r)=>{let o=1;return r?.structureRev&&r.series&&(o=r.structureRev,(0,t.J3)(s.series,r.series,t.bW)||o++),s.structureRev=o,s}},39374:(G,I,e)=>{"use strict";e.d(I,{BN:()=>W});var t=e(2543),n=e(62467),s=e(44240),r=e(39697),o=e(65474),m=e(81160),l=e(66847),i=e(59099),u=e(1005),d=e(65961),p=e(67791),c=e(39070),y=e(52622),f=e(85858),P=e(41987),a=e(12091),E=e(32264),g=e(26657),h=e(27677),D=e(21969),v=e(53478),C=e(34867);const T=(0,C.DW)("features.query");var S=e(81583),O=e(76885),x=e(61298),b=e(14110),M=e(14792);function A(w){let L=!1;return K=>{if(!K.request||L||O.kM.getUrlSearchParams().editPanel!=null||K.state!==c.Gu.Done&&K.state!==c.Gu.Error)return;const j={eventName:x.n_.DataRequest,source:K.request.app,datasourceName:w.name,datasourceId:w.id,datasourceUid:w.uid,datasourceType:w.type,dataSize:0,panelId:0,panelPluginId:K.request?.panelPluginId,duration:K.request.endTime-K.request.startTime};V(j,K),K.request.app!==P.Jk.Explore&&K.request.app!==P.Jk.Correlations&&R(j,K),K.series&&K.series.length>0&&(j.dataSize=K.series.length),(0,b.G$)(j),L=!0};function V(K,k){const j={};for(let J=0;J<k.series.length;J++){const X=k.series[J].refId;X&&!j[X]&&(j[X]=k.series[J].meta?.isCachedResponse??!1)}K.totalQueries=Object.keys(j).length,K.cachedQueries=Object.values(j).filter(J=>J===!0).length,k.request&&Number.isInteger(k.request.panelId)&&(K.panelId=k.request.panelId);const H=(0,M.UA)().getCurrent();H&&(K.dashboardId=H.id,K.dashboardName=H.title,K.dashboardUid=H.uid,K.folderName=H.meta.folderTitle)}}function R(w,L){L.errors?.length?w.error=L.errors.join(", "):L.error&&(w.error=L.error.message)}function B(w,L){const V=L.panelData.request,K={...L.packets},k=w.key??w.data?.[0]?.refId??"A";K[k]=w;let j=w.state||c.Gu.Done,H,J;const X=[],se=[];for(const ee in K){const z=K[ee];if((z.error||z.errors?.length)&&(j=c.Gu.Error,H=z.error,J=z.errors),z.data&&z.data.length)for(const te of z.data){if(te.meta?.dataTopic===y.QR.Annotations){se.push(te);continue}X.push(te)}}const ae=U(V,j),ne={state:j,series:X,annotations:se,error:H,errors:J,request:V,timeRange:ae},q=new Set([...L.panelData.traceIds??[],...w.traceIds??[]]);return q.size>0&&(ne.traceIds=Array.from(q)),{packets:K,panelData:ne}}function U(w,L){const V=w.range;return!(0,t.isString)(V.raw.from)||L!==c.Gu.Streaming?V:{...V,from:f.parse(V.raw.from,!1),to:f.parse(V.raw.to,!0)}}function W(w,L,V){let K={panelData:{state:c.Gu.Loading,series:[],request:L,timeRange:L.range},packets:{}};if(!L.targets.length)return L.endTime=Date.now(),K.panelData.state=c.Gu.Done,(0,n.of)(K.panelData);const k=N(w,L,V).pipe((0,m.T)(j=>{if(!(0,t.map)(j.data))throw new Error(`Expected response data to be array, got ${typeof j.data}.`);const H=L.targets.filter(J=>J.hide);for(const J of H)j.data=j.data.filter(X=>X.refId!==J.refId);return L.endTime=Date.now(),K=B(j,K),K.panelData}),(0,l.W)(j=>(console.error("runRequest.catchError",j),T.logError(j),(0,n.of)({...K.panelData,state:c.Gu.Error,error:(0,a.u)(j)}))),(0,i.M)(A(w)),(0,S.N)(h.IB,L.requestId),(0,u.u)());return(0,s.h)((0,r.O)(200).pipe((0,d.u)(K.panelData),(0,p.Q)(k)),k)}function N(w,L,V){if(L.targets=L.targets.map(k=>(0,D.Ih)(k)?{...w?.getDefaultQuery?.(P.Jk.PanelEditor),...k}:k),E.$.publicDashboardAccessToken)return(0,o.H)(w.query(L));for(const k of L.targets)if((0,g.s9)(k.datasource))return v.Ex.query(L);if(V||(L.targets=L.targets.filter(k=>w.filterQuery?.(k)??!0)),L.targets.length===0)return(0,n.of)({data:[]});const K=V?V(L):w.query(L);return(0,o.H)(K)}},93117:(G,I,e)=>{"use strict";e.d(I,{y:()=>m});var t=e(41987),n=e(73372),s=e(77789),r=e(72574),o=e(26657);async function m(l,i,u,d){let p=u;const c={type:l.type,uid:i},y={...l?.getDefaultQuery?.(t.Jk.PanelEditor),datasource:c,refId:"A"};if(d?.meta.id!==l.meta.id){if(l.meta.mixed)return u;if((0,n.Ee)(d)&&(0,n.FL)(l)){const f=await d.exportToAbstractQueries(u);p=await l.importFromAbstractQueries(f)}else if(d&&l.importQueries)p=await l.importQueries(u,d);else{if(d){const f=(0,r.w)(),P=[];let a=l.uid;const E=f.containsTemplate(i);E&&(a=f.replace(l.uid));const g=u.reduce((h,D)=>{if(D.datasource){let v=D.datasource.uid;const C=f.containsTemplate(v);if(C&&(v=f.replace(D.datasource.uid)),v===a&&C===E)return D.refId=(0,s.M)(h),h.concat([D])}return h},P);if(g.length>0)return g}return[y]}}return p.length===0?[y]:p.map(f=>(!(0,o.s9)(f.datasource)&&!l.meta.mixed&&(f.datasource=c),f))}},53477:(G,I,e)=>{"use strict";e.d(I,{G3:()=>m,TF:()=>u,XJ:()=>f,YU:()=>c,d7:()=>p,if:()=>P,r4:()=>o,w7:()=>y});var t=e(64161);const n=null,s=58,r=8,o={label:"A\u2013Z",value:"alpha-asc"},m="search.sections",l="grafana.search.expanded-folder",i=0,u="general",d="General",p="grafana.search.include.panels",c="grafana.search.layout",y="grafana.search.sort",f={dashboard:t.G.DashDB,folder:t.G.DashFolder,home:t.G.DashHome},P=1e3},97427:(G,I,e)=>{"use strict";e.d(I,{d:()=>o,n:()=>m});var t=e(96540),n=e(13752),s=e(71733),r=e(12131);function o(){const l=(0,t.useRef)(new n.B);return{keyboardEvents:l.current,onKeyDown:i=>{switch(i.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":case"Enter":l.current.next(i);default:}}}}function m(l,i,u){const d=(0,t.useRef)({x:0,y:-1}),[p,c]=(0,t.useState)({x:0,y:-1}),y=(0,t.useRef)();return(0,t.useEffect)(()=>{y.current=u.view.fields.url,d.current.x=0,d.current.y=-1,c({...d.current})},[u]),(0,t.useEffect)(()=>{const f=l.subscribe({next:P=>{switch(P?.code){case"ArrowDown":{d.current.y++,c({...d.current});break}case"ArrowUp":d.current.y=Math.max(0,d.current.y-1),c({...d.current});break;case"ArrowRight":{i>0&&(d.current.x=Math.min(i,d.current.x+1),c({...d.current}));break}case"ArrowLeft":{i>0&&(d.current.x=Math.max(0,d.current.x-1),c({...d.current}));break}case"Enter":if(!y.current)break;const a=d.current.x*i+d.current.y;if(a<0){d.current.x=0,d.current.y=0,c({...d.current});break}const E=y.current.values?.[a];typeof E=="string"&&r.Ny.push(s.I.stripBaseFromUrl(E))}}});return()=>f.unsubscribe()},[l,i]),p}},6204:(G,I,e)=>{"use strict";e.d(I,{B9:()=>m,J$:()=>r,KZ:()=>o,MK:()=>s,Pf:()=>n});var t=e(14110);const n=(i,u)=>{(0,t.rR)(`${i}_viewed`,l(u))},s=(i,u)=>{(0,t.rR)(`${i}_result_clicked`,l(u))},r=(i,u)=>{(0,t.rR)(`${i}_query_submitted`,l(u))},o=(i,{error:u,...d})=>{(0,t.rR)(`${i}_query_failed`,{...l(d),error:u})},m=(i,u,d)=>{(0,t.rR)(`grafana_panel_inspect_${i}_${u}_clicked`,d)},l=i=>({layout:i.layout,starredFilter:i.starred??!1,sort:i.sortValue??"",tagCount:i.tagCount??0,queryLength:i.query?.length??0,includePanels:i.includePanels??!1,deleted:i.deleted??!1})},24439:(G,I,e)=>{"use strict";e.d(I,{getGrafanaSearcher:()=>O});var t=e(32264),n=e(78368),s=e(14236),r=e(57875),o=e(17172),m=e(40957);const l="Loading",i="api/search-v2",u="name_sort";class d{constructor(b){this.fallbackSearcher=b}async search(b){if(b.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(b)}async starred(b){if(b.facet?.length)throw new Error("facets not supported!");const M=await(0,o.AI)().get("api/user/stars");return M?.length?this.doSearchQuery({uid:M,query:b.query??"*"}):{view:new n.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(A,R)=>{},isItemLoaded:A=>!0}}async tags(b){const M={...b,query:b.query??"*",sort:void 0,facet:[{field:"tag"}],limit:1},R=(await(0,o.AI)().post(i,M)).frames.map(B=>(0,s.Vc)(B));if(R[0]?.name===l)return this.fallbackSearcher.tags(b);for(const B of R)if(B.fields[0].name==="tag")return y(B);return[]}getSortOptions(){const b=[{value:u,label:"Alphabetically (A-Z)"},{value:"-name_sort",label:"Alphabetically (Z-A)"}];if(t.$.licenseInfo.enabledFeatures.analytics){for(const M of f)b.push({value:`-${M.name}`,label:`${M.display} (most)`}),b.push({value:`${M.name}`,label:`${M.display} (least)`});for(const M of P)b.push({value:`-${M.name}`,label:`${M.display} (recent)`}),b.push({value:`${M.name}`,label:`${M.display} (oldest)`})}return Promise.resolve(b)}async doSearchQuery(b){b=await(0,m.u4)(b);const M={...b,query:b.query??"*",limit:b.limit??p},R=(await(0,o.AI)().post(i,M)).frames.map(V=>(0,s.Vc)(V)),B=R.length?(0,s.Vc)(R[0]):{fields:[],length:0};if(B.name===l)return this.fallbackSearcher.search(b);for(const V of B.fields)V.display=(0,r.J)({field:V,theme:t.$.theme2});B.meta?.custom||(B.meta={...B.meta,custom:{count:B.length,max_score:1}});const U=B.meta.custom;if(U.locationInfo||(U.locationInfo={}),U.sortBy?.length){const V=B.fields.find(K=>K.name===U.sortBy);if(V){const K=a(V.name);U.sortBy=K,V.name=K}}let W=0,N;const w=async()=>{for(;W>L.dataFrame.length;){const V=L.dataFrame.length;if(V>=U.count)return;const K=await(0,o.AI)().post(i,{...M??{},from:V,limit:c}),k=(0,s.Vc)(K.frames[0]);if(!k){console.log("no results",k);return}if(k.fields.length!==L.dataFrame.fields.length){console.log("invalid shape",k,L.dataFrame);return}const j=k.length+L.dataFrame.length;for(let J=0;J<k.fields.length;J++)L.dataFrame.fields[J].values.push(...k.fields[J].values);L.dataFrame.length=j;const H=k.meta?.custom;if(H?.locationInfo&&U)for(const[J,X]of Object.entries(H.locationInfo))U.locationInfo[J]=X}N=void 0},L=new n.R(B);return{totalRows:U.count??B.length,view:L,loadMoreItems:async(V,K)=>(W=Math.max(W,K),N||(N=w()),N),isItemLoaded:V=>V<L.dataFrame.length}}getFolderViewSort(){return"name_sort"}}const p=50,c=100;function y(x){const b=x.fields[0].values,M=x.fields[1].values,A=[];for(let R=0;R<x.length;R++)A.push({term:b[R],count:M[R]});return A}const f=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}],P=[{name:"created_at",display:"Created time"},{name:"updated_at",display:"Updated time"}];function a(x){for(const b of f)if(b.name===x)return b.display;for(const b of P)if(b.name===x)return b.display;return x}var E=e(53076);class g{constructor(b){this.parent=b,this.cache=new Map,this.sortPlaceholder="Default (Relevance)"}async search(b){if(b.facet?.length)throw new Error("facets not supported!");if(b.sort!=null)throw new Error("custom sorting is not supported yet");if(b.tags?.length||b.ds_uid?.length)return this.parent.search(b);const A=(await this.getCache(b.kind)).search(b.query);return{isItemLoaded:()=>!0,loadMoreItems:async(R,B)=>{},totalRows:A.length,view:A}}async getCache(b){const M=b?b.sort().join(","):"*",A=this.cache.get(M);if(A)try{return await A}catch{return this.cache.delete(M),new h(new n.R({name:"error",fields:[],length:0}))}const R=this.parent.search({kind:b,limit:5e3}).then(B=>new h(B.view));return this.cache.set(M,R),R}async starred(b){return this.parent.starred(b)}async getSortOptions(){return this.parent.getSortOptions()}async tags(b){return this.parent.tags(b)}getFolderViewSort(){return this.parent.getFolderViewSort()}}class h{constructor(b){this.full=b,this.ufuzzy=new E.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),this.names=this.full.fields.name.values,this.empty=new n.R({...this.full.dataFrame,fields:this.full.dataFrame.fields.map(M=>({...M,values:[]})),length:0})}search(b){if(!b?.length||b==="*")return this.full;const M=this.full.dataFrame.fields,A=this.names,R=M.map(N=>[]);let[B,U,W]=this.ufuzzy.search(A,b,5);for(let N=0;N<M.length;N++){let w=M[N].values,L=R[N];if(U&&W)for(let V=0;V<W.length;V++){let K=U.idx[W[V]];L.push(w[K])}else if(B)for(let V=0;V<B.length;V++){let K=B[V];L.push(w[K])}}return this.empty.dataFrame.fields.forEach((N,w)=>{N.values=R[w]}),this.empty.dataFrame.length=this.empty.dataFrame.fields[0].values.length,this.empty}}var D=e(11261),v=e(27677),C=e(53477);class T{constructor(){this.locationInfo={general:{kind:"folder",name:"General",url:"/dashboards"}},this.getFolderViewSort=()=>""}async composeQuery(b,M){const A=await(0,m.u4)(M);return A.query?.length&&A.query!=="*"&&(b.query=A.query),A.kind?.length===1&&C.XJ[A.kind[0]]&&(b.type=C.XJ[A.kind[0]]),A.uid?b.dashboardUID=A.uid:A.location?.length&&(b.folderUIDs=[A.location]),b}async search(b){if(b.facet?.length)throw new Error("facets not supported!");if(b.from!==void 0){if(!b.limit)throw new Error("Must specify non-zero limit parameter when using from");if(b.from/b.limit%1!==0)throw new Error("From parameter must be a multiple of limit")}const M=b.limit??(b.from!==void 0?1:C.if),A=b.from!==void 0?b.from/M+1:void 0,R=await this.composeQuery({limit:M,tag:b.tags,sort:b.sort,permission:b.permission,page:A,deleted:b.deleted},b);return this.doAPIQuery(R)}async starred(b){if(b.facet?.length)throw new Error("facets not supported!");const M=await this.composeQuery({limit:b.limit??C.if,tag:b.tags,sort:b.sort,starred:b.starred},b);return this.doAPIQuery(M)}async getSortOptions(){return(await v.IB.get("/api/search/sorting")).sortOptions.map(M=>({value:M.name,label:M.displayName}))}async tags(b){return(await v.IB.get("/api/dashboards/tags")).sort((A,R)=>R.count-A.count)}async doAPIQuery(b){const M=await v.IB.get("/api/search",b),A=[],R=[],B=[],U=[],W=[],N=[],w=[];let L;for(let k of M){const j=k.type==="dash-folder"?"folder":"dashboard";A.push(j),R.push(k.title),B.push(k.uid),U.push(k.url),W.push(k.tags),w.push(k.sortMeta);let H=k.folderUid;!H&&j==="dashboard"&&(H="general"),N.push(H),k.sortMetaName?.length&&(L=k.sortMetaName),k.folderUid&&k.folderTitle?this.locationInfo[k.folderUid]={kind:"folder",name:k.folderTitle,url:k.folderUrl,folderUid:k.folderUid}:j==="folder"&&(this.locationInfo[k.uid]={kind:j,name:k.title,url:k.url,folderUid:k.folderUid})}const V={fields:[{name:"kind",type:D.PU.string,config:{},values:A},{name:"name",type:D.PU.string,config:{},values:R},{name:"uid",type:D.PU.string,config:{},values:B},{name:"url",type:D.PU.string,config:{},values:U},{name:"tags",type:D.PU.other,config:{},values:W},{name:"location",type:D.PU.string,config:{},values:N}],length:R.length,meta:{custom:{count:R.length,max_score:1,locationInfo:this.locationInfo}}};L?.length&&w.length&&(V.meta.custom.sortBy=L,V.fields.push({name:L,type:D.PU.number,config:{},values:w}));for(const k of V.fields)k.display=(0,r.J)({field:k,theme:t.$.theme2});const K=new n.R(V);return{totalRows:V.length,view:K,loadMoreItems:async(k,j)=>{},isItemLoaded:k=>!0}}}let S;function O(){if(!S){const x=new T,b=t.$.featureToggles.panelTitleSearch;S=b?new d(x):x,b&&location.search.includes("do-frontend-query")&&(S=new g(S))}return S}},40957:(G,I,e)=>{"use strict";e.d(I,{TM:()=>m,cu:()=>l,hI:()=>u,u4:()=>s});var t=e(49952),n=e(14792);async function s(d){return d.query&&d.query.indexOf("folder:current")>=0&&(d={...d,location:await r(),query:d.query.replace("folder:current","").trim()},d.query?.length||(d.query="*")),Promise.resolve(d)}async function r(){try{let d=(0,n.UA)().getCurrent();return d||(await o(500),d=(0,n.UA)().getCurrent()),Promise.resolve(d?.meta?.folderUid)}catch(d){console.error(d)}}function o(d){return new Promise(p=>setTimeout(p,d))}function m(d,p){return d==="dashboard"?"apps":d==="folder"?p?"folder-open":"folder":"question-circle"}function l(d,p){return d&&(0,t.I)(d.uid)?"users-alt":m(d.kind,p)}function i(d){switch(d){case"dashboard":case"folder":case"panel":return d;default:return"dashboard"}}function u(d,p){const c=p?.dataFrame.meta?.custom,y={kind:i(d.kind),uid:d.uid,title:d.name,url:d.url,tags:d.tags??[]},f=c?.sortBy;if(f){const P=d[f];(typeof P=="string"||typeof P=="number")&&(y.sortMetaName=f,y.sortMeta=P)}if(d.location){const P=d.location.split("/"),a=P[P.length-1],E=c?.locationInfo[a];E&&(y.parentTitle=E.name,y.parentKind=E.kind,y.parentUID=a)}return y}},64161:(G,I,e)=>{"use strict";e.d(I,{G:()=>t,P:()=>n});var t=(s=>(s.DashDB="dash-db",s.DashHome="dash-home",s.DashFolder="dash-folder",s))(t||{}),n=(s=>(s.List="list",s.Folders="folders",s))(n||{})},16757:(G,I,e)=>{"use strict";e.d(I,{N1:()=>o,W1:()=>s});var t=e(53477);const n=m=>m?!!(m.query||m.tag?.length>0||m.starred||m.sort):!1,s=()=>{const m=t.G3+".";for(let l=0;l<window.localStorage.length;l++){const i=window.localStorage.key(l);i?.startsWith(m)&&window.localStorage.removeItem(i)}},r=(m="General")=>`${SECTION_STORAGE_KEY}.${m.toLowerCase()}`,o=m=>{const l=Object.entries(m).reduce((i,[u,d])=>{if(d){if(u==="tag"&&!Array.isArray(d))return{...i,tag:[d]}}else return i;return{...i,[u]:d}},{});if(m.folder){const i=`folder:${m.folder}`;return{...l,query:`${i} ${(l.query??"").replace(i,"")}`}}return{...l}}},1936:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>C,EC:()=>h,FW:()=>P,G3:()=>i,L5:()=>v,QM:()=>m,Yh:()=>a,aD:()=>u,c3:()=>D,ch:()=>l,dJ:()=>d,ew:()=>g,jE:()=>p,zh:()=>E});var t=e(65307),n=e(31678);const s={serviceAccount:{},isLoading:!0,tokens:[]},r=(0,t.Z0)({name:"serviceaccount",initialState:s,reducers:{serviceAccountFetchBegin:T=>({...T,isLoading:!0}),serviceAccountFetchEnd:T=>({...T,isLoading:!1}),serviceAccountLoaded:(T,S)=>({...T,serviceAccount:S.payload,isLoading:!1}),serviceAccountTokensLoaded:(T,S)=>({...T,tokens:S.payload,isLoading:!1}),rolesFetchBegin:T=>({...T,rolesLoading:!0}),rolesFetchEnd:T=>({...T,rolesLoading:!1})}}),o=r.reducer,{serviceAccountLoaded:m,serviceAccountTokensLoaded:l,serviceAccountFetchBegin:i,serviceAccountFetchEnd:u,rolesFetchBegin:d,rolesFetchEnd:p}=r.actions,c={serviceAccounts:[],isLoading:!0,roleOptions:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,serviceAccountStateFilter:n.ServiceAccountStateFilter.All},y=(0,t.Z0)({name:"serviceaccounts",initialState:c,reducers:{serviceAccountsFetched:(T,S)=>{const{totalCount:O,perPage:x,...b}=S.payload,M=Math.ceil(O/x);return{...T,...b,totalPages:M,perPage:x,showPaging:M>1,isLoading:!1}},serviceAccountsFetchBegin:T=>({...T,isLoading:!0}),serviceAccountsFetchEnd:T=>({...T,isLoading:!1}),acOptionsLoaded:(T,S)=>({...T,roleOptions:S.payload}),queryChanged:(T,S)=>({...T,query:S.payload,page:0}),pageChanged:(T,S)=>({...T,page:S.payload}),stateFilterChanged:(T,S)=>({...T,serviceAccountStateFilter:S.payload})}}),f=y.reducer,{serviceAccountsFetchBegin:P,serviceAccountsFetchEnd:a,serviceAccountsFetched:E,acOptionsLoaded:g,pageChanged:h,stateFilterChanged:D,queryChanged:v}=y.actions,C={serviceAccountProfile:o,serviceAccounts:f}},8212:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>y,NV:()=>p,Y1:()=>i,j7:()=>l,kH:()=>m,pB:()=>d,s7:()=>u,sF:()=>o,sJ:()=>r});var t=e(65307);const n={supportBundles:[],isLoading:!1,supportBundleCollectors:[],createBundlePageLoading:!1,loadBundlesError:"",createBundleError:""},s=(0,t.Z0)({name:"supportBundles",initialState:n,reducers:{supportBundlesLoaded:(f,P)=>({...f,supportBundles:P.payload,isLoading:!1}),fetchBegin:f=>({...f,isLoading:!0}),fetchEnd:f=>({...f,isLoading:!1}),collectorsFetchBegin:f=>({...f,createBundlePageLoading:!0}),collectorsFetchEnd:f=>({...f,createBundlePageLoading:!1}),supportBundleCollectorsLoaded:(f,P)=>({...f,supportBundleCollectors:P.payload,createBundlePageLoading:!1}),setLoadBundleError:(f,P)=>({...f,loadBundlesError:P.payload,supportBundleCollectors:[]}),setCreateBundleError:(f,P)=>({...f,createBundleError:P.payload})}}),{supportBundlesLoaded:r,fetchBegin:o,fetchEnd:m,supportBundleCollectorsLoaded:l,collectorsFetchBegin:i,collectorsFetchEnd:u,setLoadBundleError:d,setCreateBundleError:p}=s.actions,y={supportBundles:s.reducer}},34655:(G,I,e)=>{"use strict";e.d(I,{$T:()=>y,$u:()=>l,Ay:()=>g,EC:()=>m,L5:()=>o,Q9:()=>r,dJ:()=>i,jE:()=>u,tC:()=>f});var t=e(65307);const n={teams:[],page:1,query:"",perPage:30,totalPages:0,noTeams:!1,hasFetched:!1},s=(0,t.Z0)({name:"teams",initialState:n,reducers:{teamsLoaded:(h,D)=>{const{totalCount:v,perPage:C,...T}=D.payload,S=Math.ceil(v/C);return{...h,...T,totalPages:S,perPage:C,hasFetched:!0}},queryChanged:(h,D)=>({...h,page:1,query:D.payload}),pageChanged:(h,D)=>({...h,page:D.payload}),sortChanged:(h,D)=>({...h,sort:D.payload,page:1}),rolesFetchBegin:h=>({...h,rolesLoading:!0}),rolesFetchEnd:h=>({...h,rolesLoading:!1})}}),{teamsLoaded:r,queryChanged:o,pageChanged:m,sortChanged:l,rolesFetchBegin:i,rolesFetchEnd:u}=s.actions,d=s.reducer,p={team:{},members:[],groups:[],searchMemberQuery:""},c=(0,t.Z0)({name:"team",initialState:p,reducers:{teamLoaded:(h,D)=>({...h,team:D.payload}),teamMembersLoaded:(h,D)=>({...h,members:D.payload}),setSearchMemberQuery:(h,D)=>({...h,searchMemberQuery:D.payload}),teamGroupsLoaded:(h,D)=>({...h,groups:D.payload})}}),{teamLoaded:y,teamGroupsLoaded:f,teamMembersLoaded:P,setSearchMemberQuery:a}=c.actions,E=c.reducer,g={teams:d,team:E}},23989:(G,I,e)=>{"use strict";e.d(I,{w:()=>q});var t=e(2543),n=e(95344),s=e(19347),r=e(72574),o=e(16401),m=e(52622),l=e(73788),i=e(20601),u=e(13344),d=e(24240),p=e(87421),c=e(75096);let y={};function f(ee){const z=y[ee];return z||(y[ee]=(0,t.property)(ee))}class P{constructor(z,te,ie){this.state={name:z.name,value:te,text:ie,type:z.type}}getValue(z){let{value:te}=this.state;return te==="string"||te==="number"||te==="boolean"?te:String(te)}getValueText(){const{value:z,text:te}=this.state;return typeof te=="string"?z===u.To?u.Zm:te:Array.isArray(te)?te.join(" + "):(console.log("value",te),String(te))}}let a;function E(ee,z,te){return a?(a.state.name=ee.name,a.state.type=ee.type,a.state.value=z,a.state.text=te):a=new P(ee,z,te),a}function g(ee,z,te,ie){if(te=te||{},ee==null||(0,d.EW)(te)&&z!==m.$m.QueryParam)return"";if(!Array.isArray(ee)&&typeof ee=="object"&&(ee=`${ee}`),typeof z=="function")return z(ee,te,g);z||(z=m.$m.Glob);let ce=z.split(":");ce.length>1?(z=ce[0],ce=ce.slice(1)):ce=[];let ue=o.vz.getIfExists(z);ue||(console.error(`Variable format ${z} not found. Using glob format as fallback.`),ue=o.vz.get(m.$m.Glob));const fe=E(te,ee,ie??ee);return ue.formatter(ee,ce,fe)}var h=e(84743),D=e.n(h),v=e(6709),C=e(76885),T=e(1933),S=e(74856),O=e(25304),x=e(83195),b=e(11261),M=e(92461),A=e(57875),R=e(28240),B=e(8249);function U(ee,z,te){return new Proxy({},{get:(ie,ce)=>{if(ce==="name")return ee.name;if(ce==="displayName")return(0,R.Ct)(ee,z,te);if(ce==="labels"||ce==="formattedLabels")return ee.labels?{...ee.labels,__values:Object.values(ee.labels).sort().join(", "),toString:()=>(0,B.h6)(ee.labels,"",!0)}:""}})}function W(ee,z,te,ie){const ce=N(ee,z,te);return g(ce,ie)}function N(ee,z,te){const ie=te?.__dataContext;if(!ie)return ee;const{frame:ce,rowIndex:ue,field:fe,calculatedValue:Te}=ie.value;if(Te)switch(z){case"numeric":return Te.numeric.toString();case"raw":return Te.numeric;case"time":return"";case"text":default:return(0,x.cN)(Te)}if(ue===void 0)return ee;if(z==="time"){const pe=ce.fields.find(ve=>ve.type===b.PU.time);return pe?pe.values[ue]:void 0}const he=fe.values[ue];if(z==="raw")return he;const le=(fe.display??V())(he);switch(z){case"numeric":return le.numeric;case"text":return le.text;default:return(0,x.cN)(le)}}function w(ee,z,te,ie){const ce=te?.__dataContext;if(!ce||!z)return ee;const{frame:ue,rowIndex:fe}=ce.value;if(fe===void 0||z===void 0)return ee;const Te={name:ue.name,refId:ue.refId,fields:(0,M.F)({frame:ue,rowIndex:fe})},he=f(z)(Te)??"";return g(he,ie)}let L;function V(){return L||(L=(0,A.J)()),L}function K(ee,z,te,ie){const ce=te?.__dataContext;if(!ce||z!=="name")return ee;const{frame:ue,frameIndex:fe}=ce.value,Te=(0,R.Ri)(ue,fe);return g(Te,ie)}function k(ee,z,te,ie){const ce=te?.__dataContext;if(!ce||z===void 0||z==="")return ee;const{frame:ue,field:fe,data:Te}=ce.value,he=U(fe,ue,Te),de=f(z)(he)??"";return g(de,ie)}const j={__value:W,__data:w,__series:K,__field:k,[v.c.includeVars]:H,[v.c.keepTime]:J,__timezone:X};function H(ee,z,te){const ie=(0,O.z)(te);return C.kM.toUrlParams(ie)}function J(){return C.kM.toUrlParams((0,S.jG)().timeRangeForUrl())}function X(){const ee=(0,T.O)({timeZone:(0,S.jG)().timeModel?.getTimezone()});return ee==="browser"?D().tz.guess():ee}const se={getFilteredVariables:p.bZ,getVariables:p.UN,getVariableWithName:p._2};class ae{constructor(z=se){this.dependencies=z,this.regex=c.SY,this.index={},this.grafanaVariables=new Map,this.timeRange=null,this._adhocFiltersDeprecationWarningLogged=new Map,this._variables=[]}init(z,te){this._variables=z,this.timeRange=te,this.updateIndex()}get variables(){return(0,n.l)("template_srv.ts","variables","getVariables"),this.getVariables()}getVariables(){return window.__grafanaSceneContext?(0,l.E)(window.__grafanaSceneContext):this.dependencies.getVariables()}updateIndex(){const z=te=>te||te==="";if(this.index=this._variables.reduce((te,ie)=>(ie.current&&(ie.current.isNone||z(ie.current.value))&&(te[ie.name]=ie),te),{}),this.timeRange){const te=this.timeRange.from.valueOf().toString(),ie=this.timeRange.to.valueOf().toString();this.index={...this.index,__from:{current:{value:te,text:te}},__to:{current:{value:ie,text:ie}}}}}updateTimeRange(z){this.timeRange=z,this.updateIndex()}variableInitialized(z){this.index[z.name]=z}getAdhocFilters(z,te){let ie=[],ce=(0,s.l)().getInstanceSettings(z);if(!ce)return[];!te&&!this._adhocFiltersDeprecationWarningLogged.get(ce.type)&&((0,n.l)(`DataSource ${ce.type}`,"templateSrv.getAdhocFilters","filters property on the request (DataQueryRequest). Or if this is called from interpolateVariablesInQueries or applyTemplateVariables it is passed as a new argument"),this._adhocFiltersDeprecationWarningLogged.set(ce.type,!0));for(const ue of this.getAdHocVariables()){const fe=ue.datasource?.uid;(fe===ce.uid||fe?.indexOf("$")===0&&this.replace(fe)===ce.uid)&&(ie=ie.concat(ue.filters))}return ie}setGrafanaVariable(z,te){this.grafanaVariables.set(z,te)}setGlobalVariable(z,te){(0,n.l)("template_srv.ts","setGlobalVariable",""),this.index={...this.index,[z]:{current:te}}}getVariableName(z){this.regex.lastIndex=0;const te=this.regex.exec(z);return te?te.slice(1).find(ce=>ce!==void 0):null}containsTemplate(z){if(!z)return!1;const te=this.getVariableName(z),ie=te&&this.getVariableAtIndex(te);return ie!=null}variableExists(z){return(0,n.l)("template_srv.ts","variableExists","containsTemplate"),this.containsTemplate(z)}highlightVariablesAsHtml(z){return!z||!(0,t.isString)(z)?z:(z=(0,t.escape)(z),this._replaceWithVariableRegex(z,void 0,(te,ie)=>this.getVariableAtIndex(ie)?'<span class="template-variable">'+te+"</span>":te))}getAllValue(z){if(z.allValue)return z.allValue;const te=[];for(let ie=1;ie<z.options.length;ie++)te.push(z.options[ie].value);return te}getVariableValue(z,te){return te?f(te)(z.value):z.value}getVariableText(z,te){return z.value===te||typeof te!="string"?z.text:te}replace(z,te,ie,ce){return te&&te.__sceneObject?o.jh.interpolate(te.__sceneObject.value,z,te,ie,ce):window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?o.jh.interpolate(window.__grafanaSceneContext,z,te,ie,ce):z?(this.regex.lastIndex=0,this._replaceWithVariableRegex(z,ie,(ue,fe,Te,he)=>{const de=this._evaluateVariableExpression(ue,fe,Te,he,te);return ce&&ce.push({match:ue,variableName:fe,fieldPath:Te,format:he,value:de,found:de!==ue}),de})):z??""}_evaluateVariableExpression(z,te,ie,ce,ue){const fe=this.getVariableAtIndex(te),Te=ue?.[te];if(Te){const pe=this.getVariableValue(Te,ie),ve=this.getVariableText(Te,pe);if(pe!=null)return g(pe,ce,fe,ve)}if(!fe){const pe=j[te];return pe?pe(z,ie,ue,ce):z}if(ce===m.$m.QueryParam||(0,d.EW)(fe)){const pe=i.B.get(fe.type).getValueForUrl(fe),ve=(0,d.EW)(fe)?fe.id:fe.current.text;return g(pe,ce,fe,ve)}const he=this.grafanaVariables.get(fe.current.value);if(he)return g(he,ce,fe);let de=fe.current.value,le=fe.current.text;if(this.isAllValue(de)&&(de=this.getAllValue(fe),le=u.Zm,fe.allValue&&ce!==m.$m.Text&&ce!==m.$m.PercentEncode))return this.replace(de);if(ie){const pe=this.getVariableValue({value:de,text:le},ie);if(pe!=null)return g(pe,ce,fe,le)}return g(de,ce,fe,le)}_replaceWithVariableRegex(z,te,ie){return this.regex.lastIndex=0,z.replace(this.regex,(ce,ue,fe,Te,he,de,le)=>ie(ce,ue||fe||he,de,Te||le||te))}isAllValue(z){return z===u.To||Array.isArray(z)&&z[0]===u.To}replaceWithText(z,te){return(0,n.l)("template_srv.ts","replaceWithText()","replace(), and specify the :text format"),this.replace(z,te,"text")}getVariableAtIndex(z){if(z)return this.index[z]?this.index[z]:this.dependencies.getVariableWithName(z)}getAdHocVariables(){return this.dependencies.getFilteredVariables(d.EW)}}const ne=new ae;(0,r.d)(ne);const q=()=>ne},3817:(G,I,e)=>{"use strict";e.d(I,{v:()=>w});var t=e(4200),n=e(16401);function s({title:L,unit:V}){return n.d0.timeseries().setTitle(L).setUnit(V).setOption("legend",{showLegend:!1}).setCustomFieldConfig("fillOpacity",9)}function r({description:L,mainQueryExpr:V,breakdownQueryExpr:K,unit:k}){const j={title:`${t.Rp}`,unit:k},H={refId:"A",expr:V,legendFormat:L},J={...j,title:L,queries:[H],variant:"main",vizBuilder:()=>s({...J})},X={...J,title:`${t.Rp}`,queries:[{...H,legendFormat:L}],vizBuilder:()=>s(X),variant:"preview"},se={...j,queries:[{refId:"A",expr:K,legendFormat:`{{${t.aZ}}}`}],vizBuilder:()=>s(se),variant:"breakdown"};return{preview:X,main:J,breakdown:se,variants:[]}}const o=`${t.Rp}${t.ui}`,m=`rate(${o}[$__rate_interval])`;function l(L){return L?m:o}const i={avg:"average",sum:"overall"};function u(L){return i[L]||L}function d({agg:L,rate:V,unit:K}){const k=l(V),j=V?`${u(L)} per-second rate`:`${u(L)}`,H=`${t.Rp} (${j})`,J=`${L}(${k})`,X=`${L}(${k})by(${t.aZ})`;return r({description:H,mainQueryExpr:J,breakdownQueryExpr:X,unit:K})}const p="short";function c(L){return L&&y[L]||p}const y={bytes:"bytes",seconds:"s"},f={bytes:"Bps",seconds:"short"},P="cps";function a(L){return L&&f[L]||P}const E=new Set(["count","total"]),g=new Set(["sum","bucket"]),h={count:"sum",total:"sum"};function D(L){return L==="total"}function v(L){const V=L.at(-1);if(V==null||g.has(V))throw new Error(`This function does not support a metric suffix of "${V}"`);const K=E.has(V),k=h[V]||"avg",j=D(V)?L.at(-2):V,H=K?a(j):c(j);return{agg:k,unit:H,rate:K}}function C(L){const V=v(L);return d(V)}const T={generator:C};var S=e(52995);function O({title:L,unit:V}){return n.d0.heatmap().setTitle(L).setUnit(V).setOption("calculate",!1).setOption("color",{mode:S.P7.Scheme,exponent:.5,scheme:"Spectral",steps:32,reverse:!1})}function x({title:L,unit:V}){return n.d0.timeseries().setTitle(L).setUnit(V).setCustomFieldConfig("fillOpacity",9)}function b(L){const V=`${t.Rp}`,K=L.at(-2),k=c(K),j={title:V,unit:k},H={...j,variant:"p50",queries:[B(50)],vizBuilder:()=>s(H)},J={...j,variant:"p50",queries:[B(50,[t.aZ])],vizBuilder:()=>s(J)},X={...j,variant:"percentiles",queries:[99,90,50].map(ae=>B(ae)),vizBuilder:()=>x(X)},se={...j,variant:"heatmap",queries:[R()],vizBuilder:()=>O(se)};return{preview:H,main:X,variants:[X,se],breakdown:J}}const M=`rate(${t.Rp}${t.ui}[$__rate_interval])`;function A(L=[]){return`sum by(${["le",...L].join(", ")}) (${M})`}function R(L=[]){return{refId:"Heatmap",expr:A(L),format:"heatmap"}}function B(L,V=[]){const K=L/100;let k=`${L}th Percentile`;return V[0]&&(k=`{{${V[0]}}}`),{refId:`Percentile${L}`,expr:`histogram_quantile(${K}, ${A(V)})`,legendFormat:k}}function U(L){if(L.at(-1)!=="sum")throw new Error('createSummaryQueryDefs is only to be used for metrics that end in "_sum"');const K=L.at(-2),k=c(K),H=l(!0),J=L.slice(0,-1).join("_"),X=q(`sum(${H})`),se=q(`sum(${H})by(${t.aZ})`),ne=`${J} (average)`;function q(ee){const z=ee.replace(t.Rp,`${J}_sum`),te=ee.replace(t.Rp,`${J}_count`);return`${z}/${te}`}return r({description:ne,mainQueryExpr:X,breakdownQueryExpr:se,unit:k})}const W={sum:U,bucket:b};function N(L){return L&&W[L]||T.generator}function w(L){const V=L.split("_"),K=V.at(-1),k=N(K);if(!k)throw new Error(`Unable to generate queries for metric "${L}" due to issues with derived suffix "${K}"`);return k(V)}},56833:(G,I,e)=>{"use strict";e.d(I,{b:()=>v,B:()=>C});var t=e(32196),n=e(96540),s=e(76885),r=e(12470),o=e(12131),m=e(16401),l=e(40845),i=e(15292),u=e(83122),d=e(27746),p=e(40588);class c extends m.Bs{constructor(b){super({stickyMainGraph:b.stickyMainGraph??!0,isOpen:b.isOpen??!1}),this.onToggleStickyMainGraph=()=>{const M=!this.state.stickyMainGraph;(0,p.z)("settings_changed",{stickyMainGraph:M}),this.setState({stickyMainGraph:M})},this.onToggleOpen=M=>{this.setState({isOpen:M})}}static{this.Component=({model:b})=>{const{stickyMainGraph:M,isOpen:A}=b.useState(),R=(0,l.of)(y),B=()=>n.createElement("div",{className:R.popover,onClick:U=>U.stopPropagation()},n.createElement("div",{className:R.heading},"Settings"),n.createElement("div",{className:R.options},n.createElement("div",null,"Always keep selected metric graph in-view"),n.createElement(i.d,{value:M,onChange:b.onToggleStickyMainGraph})));return n.createElement(u.m,{overlay:B,placement:"bottom",onVisibleChange:b.onToggleOpen},n.createElement(d.I,{icon:"cog",variant:"canvas",isOpen:A}))}}}function y(x){return{popover:(0,t.css)({display:"flex",padding:x.spacing(2),flexDirection:"column",background:x.colors.background.primary,boxShadow:x.shadows.z3,borderRadius:x.shape.borderRadius(),border:`1px solid ${x.colors.border.weak}`,zIndex:1,marginRight:x.spacing(2)}),heading:(0,t.css)({fontWeight:x.typography.fontWeightMedium,paddingBottom:x.spacing(2)}),options:(0,t.css)({display:"grid",gridTemplateColumns:"1fr 50px",rowGap:x.spacing(1),columnGap:x.spacing(2)})}}var f=e(13054),P=e(75176),a=e(35015),E=e(90623),g=e(74764),h=e(88434),D=e(4200);class v extends m.Bs{constructor(b){super({$timeRange:b.$timeRange??new m.JZ({}),$variables:b.$variables??T(b.initialDS,b.metric,b.initialFilters),controls:b.controls??[new m.K8({layout:"vertical"}),new m.N0,new m.KE({}),new m.WM({})],history:b.history??new f.L({}),settings:b.settings??new c({}),createdAt:b.createdAt??new Date().getTime(),...b}),this._urlSync=new m.So(this,{keys:["metric"]}),this._variableDependency=new m.Sh(this,{variableNames:[D.EY],onReferencedVariableValueChanged:M=>{const{name:A}=M.state;A===D.EY&&this.datasourceHelper.reset()}}),this._addingFilterWithoutReportingInteraction=!1,this.datasourceHelper=new h.q(this),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.topScene||this.setState({topScene:C(this.state.metric)}),this.subscribeToEvent(D.OO,this._handleMetricSelectedEvent.bind(this));const b=m.jh.lookupVariable(D.Ao,this);b instanceof m.H9&&this._subs.add(b?.subscribeToState((R,B)=>{this._addingFilterWithoutReportingInteraction||(0,p.h)(R.filters,B.filters)}));const M=this.state.history.state.steps[this.state.history.state.currentStep]?.trailState;M&&this.restoreFromHistoryStep(M),this.enableUrlSync();const A=()=>(0,g._)().setRecentTrail(this);return window.addEventListener("unload",A),()=>{this.disableUrlSync(),this.state.embedded||A(),window.removeEventListener("unload",A)}}enableUrlSync(){this.state.embedded||(0,m.Is)().initSync(this)}disableUrlSync(){this.state.embedded||(0,m.Is)().cleanUp(this)}addFilterWithoutReportingInteraction(b){const M=m.jh.lookupVariable("filters",this);M instanceof m.H9&&(this._addingFilterWithoutReportingInteraction=!0,M.setState({filters:[...M.state.filters,b]}),this._addingFilterWithoutReportingInteraction=!1)}getMetricMetadata(b){return this.datasourceHelper.getMetricMetadata(b)}getCurrentMetricMetadata(){return this.getMetricMetadata(this.state.metric)}restoreFromHistoryStep(b){this.disableUrlSync(),!b.topScene&&!b.metric&&(b.topScene=new a.t({})),this.setState(m.Go.cloneSceneObjectState(b,{history:this.state.history,metric:b.metric?b.metric:void 0}));const M=(0,m.Is)().getUrlState(this),A=s.kM.renderUrl(o.Ny.getLocation().pathname,M);o.Ny.replace(A),this.enableUrlSync()}_handleMetricSelectedEvent(b){this.setState(this.getSceneUpdatesForNewMetricValue(b.payload));const M=m.jh.lookupVariable(D.Ao,this);M instanceof m.H9&&M.setState({baseFilters:O(b.payload)})}getSceneUpdatesForNewMetricValue(b){const M={};return M.metric=b,M.topScene=C(b),M}getUrlState(){return{metric:this.state.metric}}updateFromUrl(b){const M={};typeof b.metric=="string"?this.state.metric!==b.metric&&Object.assign(M,this.getSceneUpdatesForNewMetricValue(b.metric)):b.metric==null&&(M.metric=void 0,M.topScene=new a.t({})),this.setState(M)}static{this.Component=({model:b})=>{const{controls:M,topScene:A,history:R,settings:B}=b.useState(),U=(0,l.of)(S),W=(0,g._)().recent.length<2;return n.createElement("div",{className:U.container},W&&n.createElement(E.p,null),n.createElement(R.Component,{model:R}),M&&n.createElement("div",{className:U.controls},M.map(N=>n.createElement(N.Component,{key:N.state.key,model:N})),n.createElement(B.Component,{model:B})),n.createElement("div",{className:U.body},A&&n.createElement(A.Component,{model:A})))}}}function C(x){return x?new P.R({metric:x}):new a.t({})}function T(x,b,M){return new m.Pj({variables:[new m.mI({name:D.EY,label:"Data source",description:"Only prometheus data sources are supported",value:x,pluginId:"prometheus"}),new m.H9({name:D.Ao,addFilterButtonText:"Add label",datasource:D.GH,hide:r.zL.hideLabel,layout:"vertical",filters:M??[],baseFilters:O(b)})]})}function S(x){return{container:(0,t.css)({flexGrow:1,display:"flex",gap:x.spacing(1),minHeight:"100%",flexDirection:"column"}),body:(0,t.css)({flexGrow:1,display:"flex",flexDirection:"column"}),controls:(0,t.css)({display:"flex",gap:x.spacing(1),padding:x.spacing(1,0),alignItems:"flex-end",flexWrap:"wrap",position:"sticky",background:x.isDark?x.colors.background.canvas:x.colors.background.primary,zIndex:x.zIndex.navbarFixed,top:0})}}function O(x){return x?[{key:"__name__",operator:"=",value:x}]:[]}},13054:(G,I,e)=>{"use strict";e.d(I,{L:()=>c,h:()=>p});var t=e(32196),n=e(96540),s=e(16401),r=e(67061),o=e(40845),m=e(56034),l=e(56833),i=e(40588),u=e(4200),d=e(51080);function p(a){return"currentStep"in a&&"steps"in a}class c extends s.Bs{constructor(E){super({steps:E.steps??[],currentStep:E.currentStep??0}),this.stepTransitionInProgress=!1,this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const E=(0,d.kj)(this);if(this.state.steps.length===0&&(this.addTrailStep(E,"start"),E.state.metric)){const{metric:g,...h}=E.state;h.topScene=(0,l.B)(void 0),this.state.steps[0].trailState=h,this.addTrailStep(E,"metric")}E.subscribeToState((g,h)=>{g.metric!==h.metric&&(this.state.steps.length===1&&(this.state.steps[0].trailState=s.Go.cloneSceneObjectState(h,{history:this})),(g.metric||h.metric)&&this.addTrailStep(E,"metric"))}),E.subscribeToEvent(s.oh,g=>{g.payload.state.name===u.Ao&&this.addTrailStep(E,"filters")}),E.subscribeToEvent(s.bZ,g=>{if(g.payload.changedObject instanceof s.JZ){const{prevState:h,newState:D}=g.payload;if((0,d.iG)(h)&&(0,d.iG)(D)&&h.from===D.from&&h.to===D.to)return;this.addTrailStep(E,"time")}})}addTrailStep(E,g){if(this.stepTransitionInProgress)return;const h=this.state.steps.length,D=g==="start"?-1:this.state.currentStep;this.setState({currentStep:h,steps:[...this.state.steps,{description:"Test",type:g,trailState:s.Go.cloneSceneObjectState(E.state,{history:this}),parentIndex:D}]})}goBackToStep(E){if(E===this.state.currentStep)return;const g=this.state.steps[E],h=g.type==="metric"&&g.trailState.metric===void 0?"metric-clear":g.type;(0,i.z)("history_step_clicked",{type:h,step:E,numberOfSteps:this.state.steps.length}),this.stepTransitionInProgress=!0,this.setState({currentStep:E}),(0,d.kj)(this).restoreFromHistoryStep(g.trailState),this.stepTransitionInProgress=!1}renderStepTooltip(E){return n.createElement(r.B,{direction:"column"},n.createElement("div",null,E.type),E.type==="metric"&&n.createElement("div",null,E.trailState.metric||"Select new metric"))}static{this.Component=({model:E})=>{const{steps:g,currentStep:h}=E.useState(),D=(0,o.of)(y),{ancestry:v,alternatePredecessorStyle:C}=(0,n.useMemo)(()=>{const T=new Set;let S=h;for(;S>=0;){const x=g[S];if(!x)break;T.add(S),S=x.parentIndex}const O=new Map;return T.forEach(x=>{const b=g[x].parentIndex;b+1!==x&&O.set(x,P(x,b))}),{ancestry:T,alternatePredecessorStyle:O}},[h,g]);return n.createElement("div",{className:D.container},n.createElement("div",{className:D.heading},"History"),g.map((T,S)=>{let O=T.type;return O==="metric"&&T.trailState.metric===void 0&&(O="start"),n.createElement(m.m,{content:()=>E.renderStepTooltip(T),key:S},n.createElement("button",{className:(0,t.cx)(D.step,D.stepTypes[O],h===S?D.stepSelected:"",C.get(S)??"",S!==T.parentIndex+1?D.stepOmitsDirectLeftLink:"",S===0?D.stepOmitsDirectLeftLink:"",v.has(S)?"":D.stepIsNotAncestorOfCurrent),onClick:()=>E.goBackToStep(S)}))}))}}}function y(a){const E=a.visualization;return{container:(0,t.css)({display:"flex",gap:10,alignItems:"center"}),heading:(0,t.css)({}),step:(0,t.css)({flexGrow:0,cursor:"pointer",border:"none",boxShadow:"none",padding:0,margin:0,width:8,height:8,opacity:.7,borderRadius:a.shape.radius.circle,background:a.colors.primary.main,position:"relative","&:hover":{opacity:1},"&:hover:before":{opacity:.7},"&:before":{content:'""',position:"absolute",width:10,height:2,left:-10,top:3,background:a.colors.primary.border,pointerEvents:"none"}}),stepSelected:(0,t.css)({"&:after":{content:'""',borderStyle:"solid",borderWidth:2,borderRadius:"50%",position:"absolute",width:16,height:16,left:-4,top:-4,boxShadow:`0px 0px 0px 2px inset ${a.colors.background.canvas}`}}),stepOmitsDirectLeftLink:(0,t.css)({"&:before":{background:"none"}}),stepIsNotAncestorOfCurrent:(0,t.css)({opacity:.2,"&:hover:before":{opacity:.2}}),stepTypes:{start:f(E.getColorByName("green")),filters:f(E.getColorByName("purple")),metric:f(E.getColorByName("orange")),time:f(a.colors.primary.main)}}}function f(a){return(0,t.css)({background:a,"&:before":{background:a,borderColor:a},"&:after":{borderColor:a}})}function P(a,E){const D=(a-E)*18;return(0,t.css)({"&:before":{content:'""',width:D+2,height:10,borderStyle:"solid",borderWidth:2,borderBottom:"none",borderTopLeftRadius:8,borderTopRightRadius:8,top:-10,left:3-D,background:"none"}})}},75176:(G,I,e)=>{"use strict";e.d(I,{k:()=>Dt,R:()=>Xe});var t=e(32196),n=e(96540),s=e(32264),r=e(16401),o=e(40845),m=e(90613),l=e(67061),i=e(27746),u=e(14578),d=e(55852),p=e(63021),c=e(40675),y=e(56034),f=e(87490),P=e(2543),a=e(11261),E=e(88575),g=e(13344),h=e(3817),D=e(77366),v=e(29413),C=e(94354),T=e(21594);function S({options:Ae,value:re,onChange:Z}){const oe=(0,o.of)(O),Ee=(0,o.$j)(),[ye,Se]=(0,n.useState)(0),[Be,We]=(0,n.useState)(0),Ke=Be>ye,it=(0,n.useRef)(null);return(0,D.w)({ref:it,onResize:()=>{const rt=it.current;rt&&We(rt.clientWidth)}}),(0,n.useEffect)(()=>{const{fontSize:rt}=Ee.typography,ft=Ae.map(qe=>qe.label||qe.value||"").join(" "),pt=(0,v.kD)(ft,rt).width;Se(pt+32*Ae.length)},[Ae,Ee]),n.createElement("div",{ref:it},Ke?n.createElement(C.z,{options:Ae,value:re,onChange:Z}):n.createElement(T.l6,{options:Ae,value:re,onChange:rt=>Z(rt.value),className:oe.select}))}function O(Ae){return{select:(0,t.css)({maxWidth:Ae.spacing(16)})}}var x=e(69096),b=e(40588),M=e(4200),A=e(51080);class R extends r.Bs{constructor(){super(...arguments),this.onClick=()=>{if(!(r.jh.lookupVariable("filters",this)instanceof r.H9))return;const Z=this.state.frame.fields[1]?.labels??{};if(Object.keys(Z).length!==1)return;const oe=Object.keys(Z)[0];(0,b.z)("label_filter_changed",{label:oe,action:"added",cause:"breakdown"});const Ee=(0,A.kj)(this),ye={key:oe,operator:"=",value:Z[oe]};Ee.addFilterWithoutReportingInteraction(ye)}}static{this.Component=({model:re})=>{const oe=re.useState().frame.fields[1]?.labels||{};return Object.keys(oe).length!==0?n.createElement(d.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:re.onClick},"Add to filters"):null}}}var B=e(39070);function U(Ae,re){const Z=r.jh.lookupVariable(M.Ao,Ae),oe=[];if(!(Z instanceof r.H9))return[];const Ee=Z.state.filters;for(const ye of re.getOptionsForSelect()){const Se=Ee.find(Be=>Be.key===ye.value);ye.label!=="le"&&(Se||oe.push({label:ye.label,value:String(ye.value)}))}return oe}function W(Ae,re){const Z=sceneGraph.findObject(Ae,oe=>oe instanceof re);return Z instanceof re?Z:null}function N(Ae,re){function Z(Ee){return Ee instanceof re}return r.jh.findAllObjects(Ae,Z).filter(Z)}class w extends r.Bs{constructor(re){super(re),this.addActivationHandler(()=>{const Z=r.jh.getData(this);this._subs.add(Z.subscribeToState((oe,Ee)=>{if(oe.data===void 0)return;const ye=oe.data;oe.data!==void 0&&oe.data?.state!==Ee.data?.state&&N(this,r.Zv).forEach(Se=>{Se.setState({data:{...Se.state.data,state:ye.state}})}),ye.state===B.Gu.Done&&this.performRepeat(ye)})),Z.state.data&&this.performRepeat(Z.state.data)})}performRepeat(re){const Z=[];for(let oe=0;oe<re.series.length;oe++){const Ee=re.series[oe];if(Ee.length<=1)continue;const ye=this.state.getLayoutChild(re,Ee,oe);Z.push(ye)}this.state.body.setState({children:Z}),this.setState({body:this.state.body})}static{this.Component=({model:re})=>{const{body:Z}=re.useState(),{children:oe}=Z.useState(),Se=r.jh.getData(re).useState()?.data,Be=Se?.state==="Loading"&&oe.length===0,We=Se?.state===B.Gu.Error?"Failed to load data.":void 0,Ke=!Be&&oe.length===0&&!We?"There is no data available. Try adjusting your filters, time range, or selecting a different label.":void 0;return n.createElement(x.O,{blockingMessage:Ke,error:We,isLoading:Be},n.createElement(Z.Component,{model:Z}))}}}class L extends r.Bs{constructor(){super(...arguments),this.onLayoutChange=re=>{(0,b.z)("breakdown_layout_changed",{layout:re}),this.getMetricScene().setState({layout:re})}}getMetricScene(){return r.jh.getAncestor(this,Xe)}Selector({model:re}){const{options:Z}=re.useState(),oe=re.useActiveLayout();return n.createElement(E.D,{label:"View"},n.createElement(C.z,{options:Z,value:oe,onChange:re.onLayoutChange}))}useActiveLayout(){const{options:re}=this.useState(),{layout:Z}=this.getMetricScene().useState();return re.map(Ee=>Ee.value).includes(Z)?Z:re[0].value}static{this.Component=({model:re})=>{const{layouts:Z,options:oe}=re.useState(),Ee=re.useActiveLayout(),ye=oe.findIndex(Be=>Be.value===Ee);if(ye===-1)return null;const Se=Z[ye];return n.createElement(Se.Component,{model:Se})}}}var V=e(52622);const K=r.zd.timeseries().setOption("tooltip",{mode:V.$N.Multi,sort:V.xB.Descending}).setOption("legend",{showLegend:!1}).build();var k=e(65463);class j extends k.x{static{this.type="selected-metric-query-results-event"}}const H=Ae=>{const re=r.jh.getAncestor(Ae,X);N(Ae,r.Eb).forEach(Ee=>{Ee.isActive?Z(Ee.state.$data):Ee.addActivationHandler(()=>{Z(Ee.state.$data)})}),N(Ae,r.Eb).forEach(Ee=>Z(Ee.state.$data));function Z(Ee){Ee&&(Ee.isActive||Ee.addActivationHandler(()=>{Z(Ee)}),Ee.state.data&&re.reportBreakdownPanelData(Ee.state.data),Ee.subscribeToState(({data:ye},Se)=>{re.reportBreakdownPanelData(ye)}))}const oe=re.subscribeToEvent(j,Ee=>{if(!Ae.isActive){oe.unsubscribe();return}const ye=r.No.timeseries().setCustomFieldConfig("axisSoftMin",Ee.payload.min).setCustomFieldConfig("axisSoftMax",Ee.payload.max).build();N(Ae,r.Eb).forEach(Se=>{function Be(){Se.onFieldConfigChange(ye)}Se.isActive?Be():Se.addActivationHandler(Be)})})},J=60;class X extends r.Bs{constructor(re){super({labels:re.labels??[],...re}),this._variableDependency=new r.Sh(this,{variableNames:[M.Ao],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this._triggerAxisChangedEvent=(0,P.throttle)(()=>{const{breakdownPanelMinValue:Z,breakdownPanelMaxValue:oe}=this;Z!==void 0&&oe!==void 0&&this.publishEvent(new j({min:Z,max:oe}))},1e3),this.onChange=Z=>{if(!Z)return;(0,b.z)("label_selected",{label:Z,cause:"selector"}),this.getVariable().changeValueTo(Z)},this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const re=this.getVariable();re.subscribeToState((ye,Se)=>{(ye.options!==Se.options||ye.value!==Se.value||ye.loading!==Se.loading)&&this.updateBody(re)});const Z=r.jh.getAncestor(this,Xe),oe=Z.state.metric;this._query=(0,h.v)(oe).breakdown,(0,A.kj)(this).state.$timeRange?.subscribeToState(()=>{this.clearBreakdownPanelAxisValues()}),Z.subscribeToState(({layout:ye},Se)=>{ye!==Se.layout&&this.clearBreakdownPanelAxisValues()}),this.updateBody(re)}reportBreakdownPanelData(re){if(!re)return;let Z=this.breakdownPanelMinValue,oe=this.breakdownPanelMaxValue;re.series.forEach(Ee=>{Ee.fields.forEach(ye=>{if(ye.type!==a.PU.number)return;const Se=ye.values.filter(P.isNumber),Be=(0,P.max)(Se),We=(0,P.min)(Se);oe=(0,P.max)([oe,Be].filter(P.isNumber)),Z=(0,P.min)([Z,We].filter(P.isNumber))})}),!(oe===void 0||Z===void 0||!Number.isFinite(oe+Z))&&(this.breakdownPanelMaxValue===oe&&this.breakdownPanelMinValue===Z||(this.breakdownPanelMaxValue=oe,this.breakdownPanelMinValue=Z,this._triggerAxisChangedEvent()))}clearBreakdownPanelAxisValues(){this.breakdownPanelMaxValue=void 0,this.breakdownPanelMinValue=void 0}getVariable(){const re=r.jh.lookupVariable(M.yr,this);if(!(re instanceof r.fS))throw new Error("Group by variable not found");return re}onReferencedVariableValueChanged(){const re=this.getVariable();re.changeValueTo(g.To),this.updateBody(re)}updateBody(re){const Z=U(this,re),oe={loading:re.state.loading,value:String(re.state.value),labels:Z,error:re.state.error,blockingMessage:void 0};!re.state.loading&&re.state.options.length?oe.body=re.hasAllValue()?ae(Z,this._query):q(this._query):re.state.loading||(oe.body=void 0,oe.blockingMessage="Unable to retrieve label options for currently selected metric."),this.clearBreakdownPanelAxisValues(),this.setState(oe)}static{this.Component=({model:re})=>{const{labels:Z,body:oe,loading:Ee,value:ye,blockingMessage:Se}=re.useState(),Be=(0,o.of)(se);return n.createElement("div",{className:Be.container},n.createElement(x.O,{isLoading:Ee,blockingMessage:Se},n.createElement("div",{className:Be.controls},!Ee&&Z.length&&n.createElement("div",{className:Be.controlsLeft},n.createElement(E.D,{label:"By label"},n.createElement(S,{options:Z,value:ye,onChange:re.onChange}))),oe instanceof L&&n.createElement("div",{className:Be.controlsRight},n.createElement(oe.Selector,{model:oe}))),n.createElement("div",{className:Be.content},oe&&n.createElement(oe.Component,{model:oe}))))}}}function se(Ae){return{container:(0,t.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column"}),content:(0,t.css)({flexGrow:1,display:"flex",paddingTop:Ae.spacing(0)}),controls:(0,t.css)({flexGrow:0,display:"flex",alignItems:"top",gap:Ae.spacing(2)}),controlsRight:(0,t.css)({flexGrow:0,display:"flex",justifyContent:"flex-end"}),controlsLeft:(0,t.css)({display:"flex",justifyContent:"flex-left",justifyItems:"left",width:"100%",flexDirection:"column"})}}function ae(Ae,re){const Z=[];for(const oe of Ae){if(oe.value===g.To)continue;if(Z.length===J)break;const Ee=re.queries[0].expr.replaceAll(M.aZ,String(oe.value)),ye=re.unit,Se=r.d0.timeseries().setTitle(oe.label).setData(new r.dt({maxDataPoints:250,datasource:M.GH,queries:[{refId:"A",expr:Ee,legendFormat:`{{${oe.label}}}`}]})).setHeaderActions(new te({labelName:String(oe.value)})).setUnit(ye).setBehaviors([ce]).build();Se.addActivationHandler(()=>{Se.onOptionsChange(K)}),Z.push(new r.xK({$behaviors:[H],body:Se}))}return new L({options:[{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],layouts:[new r.gF({templateColumns:ne,autoRows:"200px",children:Z,isLazy:!0}),new r.gF({templateColumns:"1fr",autoRows:"200px",children:Z.map(oe=>oe.clone()),isLazy:!0})]})}const ne="repeat(auto-fit, minmax(400px, 1fr))";function q(Ae){const re=Ae.unit;function Z(oe,Ee,ye){const Se=Ae.vizBuilder().setTitle(ee(Ee)).setData(new r.Zv({data:{...oe,series:[Ee]}})).setColor({mode:"fixed",fixedColor:(0,A.Vy)(ye)}).setHeaderActions(new R({frame:Ee})).setUnit(re).build(),Be=Ee.length<=1,We=new r.xK({$behaviors:[H],body:Se,isHidden:Be});return Se.addActivationHandler(()=>{Se.onOptionsChange(K)}),We}return new L({$data:new r.dt({datasource:M.GH,maxDataPoints:300,queries:Ae.queries}),options:[{value:"single",label:"Single"},{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],layouts:[new r.G1({direction:"column",children:[new r.vA({minHeight:300,body:r.d0.timeseries().setTitle("$metric").build()})]}),new w({body:new r.gF({templateColumns:ne,autoRows:"200px",children:[]}),getLayoutChild:Z}),new w({body:new r.gF({templateColumns:"1fr",autoRows:"200px",children:[]}),getLayoutChild:Z})]})}function ee(Ae){const re=Ae.fields[1]?.labels||{},Z=Object.keys(re);return Z.length===0?"<unspecified>":re[Z[0]]}function z(){return new X({})}class te extends r.Bs{constructor(){super(...arguments),this.onClick=()=>{const re=this.state.labelName;(0,b.z)("label_selected",{label:re,cause:"breakdown_panel"}),ie(this).onChange(re)}}static{this.Component=({model:re})=>n.createElement(d.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:re.onClick},"Select")}}function ie(Ae){if(Ae instanceof X)return Ae;if(Ae.parent)return ie(Ae.parent);throw new Error("Unable to find breakdown scene")}function ce(Ae){Ae.state.$data?.subscribeToState((re,Z)=>{const oe=re.data?.request?.targets[0];if(ue(oe)){const{legendFormat:Ee}=oe,ye=Ee.slice(2,-2);re.data?.series.forEach(Se=>{if(!Se.fields[1].labels?.[ye]){const Be=Se.fields[1].labels;Be&&(Be[ye]=`<unspecified ${ye}>`)}})}})}function ue(Ae){return Ae!==void 0&&"legendFormat"in Ae&&typeof Ae.legendFormat=="string"}var fe=e(94753),Te=e(72109);class he extends r.Bs{constructor(re){super({...re}),this._variableDependency=new r.Sh(this,{variableNames:[M.gR],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this.addActivationHandler(this._onActivate.bind(this))}getVariable(){const re=r.jh.lookupVariable(M.yr,this);if(!(re instanceof r.fS))throw new Error("Group by variable not found");return re}_onActivate(){this.updateMetadata()}onReferencedVariableValueChanged(){this.updateMetadata()}async updateMetadata(){this.setState({metadataLoading:!0,metadata:void 0});const Z=(0,A.aM)(this).state.metric,Ee=await(0,A.kj)(this).getMetricMetadata(Z);this.setState({metadata:Ee,metadataLoading:!1})}static{this.Component=({model:re})=>{const{metadata:Z,metadataLoading:oe}=re.useState(),Ee=re.getVariable(),{loading:ye}=Ee.useState(),Se=U(re,Ee).filter(Be=>Be.value!==g.To);return n.createElement(x.O,{isLoading:ye||oe},n.createElement(l.B,{gap:6},n.createElement(n.Fragment,null,n.createElement(l.B,{direction:"column",gap:.5},n.createElement(fe.E,{weight:"medium"},"Description"),n.createElement("div",{style:{maxWidth:360}},Z?.help?n.createElement("div",null,Z?.help):n.createElement("i",null,"No description available"))),n.createElement(l.B,{direction:"column",gap:.5},n.createElement(fe.E,{weight:"medium"},"Type"),Z?.type?n.createElement("div",null,Z?.type):n.createElement("i",null,"Unknown")),n.createElement(l.B,{direction:"column",gap:.5},n.createElement(fe.E,{weight:"medium"},"Unit"),Z?.unit?n.createElement("div",null,Z?.unit):n.createElement("i",null,"Unknown")),n.createElement(l.B,{direction:"column",gap:.5},n.createElement(fe.E,{weight:"medium"},"Labels"),Se.length===0&&"Unable to fetch labels.",Se.map(Be=>n.createElement(Te.Y,{key:Be.label,href:`#View breakdown for ${Be.label}`,title:`View breakdown for ${Be.label}`,onClick:We=>{We.preventDefault(),We.stopPropagation(),r.jh.getAncestor(re,Xe).setActionView("breakdown");const Ke=r.jh.lookupVariable(M.yr,re);return Ke instanceof r.fS&&Be.label!=null&&((0,b.z)("label_selected",{label:Be.label,cause:"overview_link"}),Ke.setState({value:Be.value})),!1}},Be.label))))))}}}function de(){return new he({})}var le=e(35015);function pe(){return new le.t({})}var ve=e(94624);class be extends r.Bs{constructor(re){super(re),this.onChangeQuery=Z=>{const oe=(0,A.aM)(this),Ee=oe.state.autoQuery.variants.find(ye=>ye.variant===Z);this.setState({panel:this.getVizPanelFor(Ee)}),oe.setState({queryDef:Ee})},this.addActivationHandler(this.onActivate.bind(this))}onActivate(){if(!this.state.panel){const{autoQuery:re}=(0,A.aM)(this).state;this.setState({panel:this.getVizPanelFor(re.main)})}}getQuerySelector(re){const{autoQuery:Z}=(0,A.aM)(this).state;if(Z.variants.length===0)return;const oe=Z.variants.map(Ee=>({label:Ee.variant,value:Ee.variant}));return n.createElement(C.z,{size:"sm",options:oe,value:re.variant,onChange:this.onChangeQuery})}getVizPanelFor(re){return re.vizBuilder().setData(new r.dt({datasource:M.GH,maxDataPoints:500,queries:re.queries})).setHeaderActions(this.getQuerySelector(re)).build()}static{this.Component=({model:re})=>{const{panel:Z}=re.useState();if(Z)return n.createElement(Z.Component,{model:Z})}}}const Oe=280,Me="40%";class Ue extends r.Bs{constructor(re){super({topView:re.topView??Re(),...re})}static{this.Component=({model:re})=>{const{topView:Z,selectedTab:oe}=re.useState(),{stickyMainGraph:Ee}=(0,A.KE)(re).useState(),ye=(0,o.of)(we);return n.createElement("div",{className:ye.container},n.createElement("div",{className:Ee?ye.sticky:ye.nonSticky},n.createElement(Z.Component,{model:Z})),oe&&n.createElement(oe.Component,{model:oe}))}}}function we(Ae){return{container:(0,t.css)({display:"flex",flexDirection:"column",position:"relative"}),sticky:(0,t.css)({display:"flex",flexDirection:"row",background:Ae.isLight?Ae.colors.background.primary:Ae.colors.background.canvas,position:"sticky",top:"70px",zIndex:10}),nonSticky:(0,t.css)({display:"flex",flexDirection:"row"})}}function Re(){return new r.G1({direction:"column",$behaviors:[new r.Gg.K2({key:"metricCrosshairSync",sync:ve.y.Crosshair})],children:[new r.vA({minHeight:Oe,maxHeight:Me,body:new be({})}),new r.vA({ySizing:"content",body:new Dt({})})]})}const Fe=({trail:Ae})=>{const[re,Z]=(0,n.useState)("Copy url"),oe=()=>{if(navigator.clipboard){(0,b.z)("selected_metric_action_clicked",{action:"share_url"});const ye=(s.$.appUrl.endsWith("/")?s.$.appUrl.slice(0,-1):s.$.appUrl)+(0,A.xi)(Ae);navigator.clipboard.writeText(ye),Z("Copied!"),setTimeout(()=>{Z("Copy url")},2e3)}};return n.createElement(i.I,{variant:"canvas",icon:"share-alt",tooltip:re,onClick:oe})};var xe=e(13054),Ve=e(74764);function $e(Ae){const re=()=>(0,Ve._)().getBookmarkIndex(Ae),Z=re(),[oe,Ee]=(0,n.useState)(Z);(0,n.useEffect)(()=>{const We=Ae.subscribeToEvent(r.bZ,({payload:{prevState:Ke,newState:it}})=>{(0,xe.h)(Ke)&&(0,xe.h)(it)&&it.steps.length>Ke.steps.length&&Ee((0,Ve._)().getBookmarkIndex(Ae))});return()=>We.unsubscribe()},[Ae]),Z!==oe&&Ee(Z);const ye=oe!=null;return[ye,()=>{if((0,b.z)("bookmark_changed",{action:ye?"toggled_off":"toggled_on"}),ye){let We=re();for(;We!=null;)(0,Ve._)().removeBookmark(We),We=re()}else(0,Ve._)().addBookmark(Ae);Ee(re())}]}class Xe extends r.Bs{constructor(re){const Z=re.autoQuery??(0,h.v)(re.metric);super({$variables:re.$variables??at(re.metric),body:re.body??new Ue({}),autoQuery:Z,queryDef:re.queryDef??Z.main,layout:re.layout??"grid",...re}),this._urlSync=new r.So(this,{keys:["actionView","layout"]}),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.actionView===void 0&&this.setActionView("overview")}getUrlState(){return{actionView:this.state.actionView,layout:this.state.layout}}updateFromUrl(re){if(typeof re.actionView=="string"){if(this.state.actionView!==re.actionView){const Z=gt.find(oe=>oe.value===re.actionView);Z&&this.setActionView(Z.value)}}else re.actionView===null&&this.setActionView(void 0);if(typeof re.layout=="string"){const Z=re.layout;this.state.layout!==Z&&this.setState({layout:Z})}}setActionView(re){const{body:Z}=this.state,oe=gt.find(Ee=>Ee.value===re);oe&&oe.value!==this.state.actionView?(Z.state.topView.state.children[0].setState({maxHeight:Oe}),Z.setState({selectedTab:oe.getScene()}),this.setState({actionView:oe.value})):(Z.state.topView.state.children[0].setState({maxHeight:Me}),Z.setState({selectedTab:void 0}),this.setState({actionView:void 0}))}static{this.Component=({model:re})=>{const{body:Z}=re.useState();return n.createElement(Z.Component,{model:Z})}}}const gt=[{displayName:"Overview",value:"overview",getScene:de},{displayName:"Breakdown",value:"breakdown",getScene:z},{displayName:"Related metrics",value:"related",getScene:pe,description:"Relevant metrics based on current label filters"}];class Dt extends r.Bs{constructor(){super(...arguments),this.getLinkToExplore=async()=>{const re=r.jh.getAncestor(this,Xe),Z=(0,A.kj)(this),oe=(0,A.U4)(Z),Ee=re.state.queryDef?.queries||[],ye=r.jh.getTimeRange(this);return(0,f.Xe)({queries:Ee,dsRef:{uid:oe},timeRange:ye.state.value,scopedVars:{__sceneObject:{value:re}}})},this.openExploreLink=async()=>{(0,b.z)("selected_metric_action_clicked",{action:"open_in_explore"}),this.getLinkToExplore().then(re=>{const Z=`${s.$.appSubUrl}${re}`;window.open(Z,"_blank")})}}static{this.Component=({model:re})=>{const Z=r.jh.getAncestor(re,Xe),oe=(0,o.of)(nt),Ee=(0,A.kj)(re),[ye,Se]=$e(Ee),{actionView:Be}=Z.useState();return n.createElement(m.a,{paddingY:1},n.createElement("div",{className:oe.actions},n.createElement(l.B,{gap:1},n.createElement(i.I,{variant:"canvas",tooltip:"Remove existing metric and choose a new metric",onClick:()=>{(0,b.z)("selected_metric_action_clicked",{action:"unselect"}),Ee.publishEvent(new M.OO(void 0))}},"Select new metric"),n.createElement(i.I,{variant:"canvas",icon:"compass",tooltip:"Open in explore",onClick:re.openExploreLink}),n.createElement(Fe,{trail:Ee}),n.createElement(i.I,{variant:"canvas",icon:ye?n.createElement(u.I,{name:"favorite",type:"mono",size:"lg"}):n.createElement(u.I,{name:"star",type:"default",size:"lg"}),tooltip:"Bookmark",onClick:Se}),Ee.state.embedded&&n.createElement(d.z9,{href:(0,A.xi)(Ee),variant:"secondary",onClick:()=>(0,b.z)("selected_metric_action_clicked",{action:"open_from_embedded"})},"Open"))),n.createElement(p.U,null,gt.map((We,Ke)=>{const it=n.createElement(c.o,{key:Ke,label:We.displayName,active:Be===We.value,onChangeTab:()=>{(0,b.z)("metric_action_view_changed",{view:We.value}),Z.setActionView(We.value)}});return We.description?n.createElement(y.m,{key:Ke,content:We.description,placement:"bottom-start",theme:"info"},it):it})))}}}function nt(Ae){return{actions:(0,t.css)({[Ae.breakpoints.up(Ae.breakpoints.values.md)]:{position:"absolute",right:0,top:16,zIndex:2}})}}function at(Ae){return new r.Pj({variables:[...(0,M.ym)(Ae),new r.fS({name:M.yr,label:"Group by",datasource:M.GH,includeAll:!0,defaultToAll:!0,query:{query:`label_names(${M.Rp})`,refId:"A"},value:"",text:""})]})}},35015:(G,I,e)=>{"use strict";e.d(I,{t:()=>W});var t=e(32196),n=e(2543),s=e(96540),r=e(12470),o=e(16401),m=e(79422),l=e(40845),i=e(88575),u=e(10354),d=e(14578),p=e(15292),c=e(42418),y=e(75176),f=e(69096),P=e(88434),a=e(40588),E=e(4200),g=e(51080),h=e(55852);class D extends o.Bs{constructor(){super(...arguments),this.onClick=()=>{this.publishEvent(new E.OO(this.state.metric),!0)}}static{this.Component=({model:H})=>{const{title:J}=H.useState();return s.createElement(h.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:H.onClick},J)}}}var v=e(3817),C=e(39070),T=e(11261);function S(j){return H=>{const J=o.jh.getData(H);J&&J.subscribeToState(X=>{if(X.data?.state===C.Gu.Loading||X.data?.state===C.Gu.Error)return;const se=o.jh.getAncestor(H,W);if(!X.data?.series.length){se.updateMetricPanel(j,!0,!0);return}let ae=!1;for(const ne of X.data.series){for(const q of ne.fields)if(q.type===T.PU.number&&(ae=q.values.some(ee=>ee!=null&&!isNaN(ee)&&ee!==0),ae))break;if(ae)break}se.updateMetricPanel(j,!0,!ae)})}}function O(j,H,J,X){const se=(0,v.v)(j),ae=se.preview.vizBuilder().setColor({mode:"fixed",fixedColor:(0,g.Vy)(H)}).setDescription(X).setHeaderActions(new D({metric:j,title:"Select"})).build(),ne=se.preview.queries.map(q=>x(q,J));return new o.xK({$variables:new o.Pj({variables:(0,E.ym)(j)}),$behaviors:[S(j)],$data:new o.dt({datasource:E.GH,maxDataPoints:200,queries:ne}),body:ae})}function x(j,H){const J=H>0?'${filters},__ignore_usage__=""':'__ignore_usage__=""',X=j.expr?.replace("${filters}",J);return{...j,expr:X}}var b=e(51088);function M(j,H){return j.sort((J,X)=>{const se=R(J,H),ae=R(X,H);return se.halfLeven+se.wholeLeven-(ae.halfLeven+ae.wholeLeven)})}const A=new Map;function R(j,H){let J=A.get(j);J||(J=new Map,A.set(j,J));let X=J.get(H);if(!X){const se=j.split("_"),ae=se.slice(0,se.length/2).join("_"),ne=(0,b.A)(ae,H)||0,q=(0,b.A)(j,H)||0;X={halfLeven:ne,wholeLeven:q},J.set(H,X)}return X}const B="175px",U="64px";class W extends o.Bs{constructor(H){super({$variables:H.$variables??N(),body:H.body??new o.gF({children:[],templateColumns:"repeat(auto-fill, minmax(450px, 1fr))",autoRows:B,isLazy:!0}),showPreviews:!0,...H}),this.previewCache={},this.ignoreNextUpdate=!1,this._variableDependency=new o.Sh(this,{variableNames:[E.MN,E.EY],onReferencedVariableValueChanged:J=>{const{name:X}=J.state;X===E.EY?this.state.body.setState({children:[]}):X===E.MN&&(this.onMetricNamesChange(),this.updateMetrics(),this.buildLayout())}}),this.currentMetricNames=new Set,this.updateMetricPanel=(J,X,se)=>{const ae=this.previewCache[J];ae&&(ae.isEmpty=se,ae.loaded=X,this.previewCache[J]=ae,this.buildLayout())},this.onSearchQueryChange=J=>{this.setState({searchQuery:J.currentTarget.value}),this.searchQueryChangedDebounced()},this.searchQueryChangedDebounced=(0,n.debounce)(()=>{this.updateMetrics(),this.buildLayout()},500),this.onTogglePreviews=()=>{this.setState({showPreviews:!this.state.showPreviews}),this.buildLayout()},this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.body.state.children.length===0?this.buildLayout():this.ignoreNextUpdate=!0;const H=(0,g.kj)(this),J=H.subscribeToEvent(E.OO,X=>{const{steps:se,currentStep:ae}=H.state.history.state,ne=se[ae].parentIndex,ee=se[ne].trailState.metric!==void 0,z=this.state.searchQuery?.split(V).filter(te=>te.length>0);X.payload!==void 0&&(0,a.z)("metric_selected",{from:ee?"related_metrics":"metric_list",searchTermCount:z?.length||0})});return()=>{J.unsubscribe()}}sortedPreviewMetrics(){return Object.values(this.previewCache).sort((H,J)=>H.isEmpty&&J.isEmpty?H.index-J.index:H.isEmpty?1:J.isEmpty?-1:H.index-J.index)}onMetricNamesChange(){const H=o.jh.lookupVariable(E.MN,this);if(!(H instanceof o.fS)||H.state.loading)return;const J=H.state.options.map(se=>se.value.toString()),X=new Set(J);Object.values(this.previewCache).forEach(se=>{X.has(se.name)||(se.isEmpty=!0)}),this.currentMetricNames=X,this.buildLayout()}applyMetricSearch(){const H=Array.from(this.currentMetricNames);if(H==null)return;const J=K(this.state.searchQuery);if(!J)this.setState({metricsAfterSearch:H});else{const X=H.filter(se=>!J||J.test(se));this.setState({metricsAfterSearch:X})}}updateMetrics(H=!0){H&&this.applyMetricSearch();const{metricsAfterSearch:J}=this.state,X=J||[],se=(0,g.kj)(this),ae=se.state.metric!==void 0?M(X,se.state.metric):X,ne={},q=120;Object.keys(this.previewCache).forEach(ee=>{this.currentMetricNames.has(ee)||delete this.previewCache[ee]});for(let ee=0;ee<ae.length;ee++){const z=ae[ee];if(Object.keys(ne).length>q)break;const ie=this.previewCache[z]||{name:z,index:ee,loaded:!1};ne[z]=ie}try{const ee=o.jh.getAncestor(this,y.R).state.metric;delete ne[ee]}catch{}this.previewCache=ne}async buildLayout(){if(this.ignoreNextUpdate){this.ignoreNextUpdate=!1;return}const H=o.jh.lookupVariable(E.MN,this);if(!(H instanceof o.fS)||H.state.loading)return;Object.keys(this.previewCache).length||this.updateMetrics();const J=[],X=(0,g.kj)(this),se=this.sortedPreviewMetrics(),ne=(0,g.gA)(this)?.length||0;for(let ee=0;ee<se.length;ee++){const z=se[ee],te=await X.getMetricMetadata(z.name),ie=(0,P.R)(te);if(this.state.showPreviews){if(z.itemRef&&z.isPanel){J.push(z.itemRef.resolve());continue}const ce=O(z.name,ee,ne,ie);z.itemRef=ce.getRef(),z.isPanel=!0,J.push(ce)}else{const ce=new o.xK({$variables:new o.Pj({variables:(0,E.ym)(z.name)}),body:w(z.name,ie)});z.itemRef=ce.getRef(),z.isPanel=!1,J.push(ce)}}const q=this.state.showPreviews?B:U;this.state.body.setState({children:J,autoRows:q})}static{this.Component=({model:H})=>{const{searchQuery:J,showPreviews:X,body:se}=H.useState(),{children:ae}=se.useState(),ne=(0,l.of)(L),q=k(E.MN,H),ee=ae.length===0&&J,z=!q.isLoading&&H.currentMetricNames.size===0,te=q.isLoading&&ae.length===0,ie=te?void 0:z&&"There are no results found. Try a different time range or a different data source."||ee&&"There are no results found. Try adjusting your search or filters."||void 0,ce=q.error||q.isLoading;return s.createElement("div",{className:ne.container},s.createElement("div",{className:ne.header},s.createElement(i.D,{label:"Search metrics",className:ne.searchField},s.createElement(u.p,{placeholder:"Search metrics",prefix:s.createElement(d.I,{name:"search"}),value:J,onChange:H.onSearchQueryChange,disabled:ce})),s.createElement(p.K,{showLabel:!0,label:"Show previews",value:X,onChange:H.onTogglePreviews,disabled:ce})),q.error&&s.createElement(c.F,{title:"Unable to retrieve metric names",severity:"error"},s.createElement("div",null,"We are unable to connect to your data source. Double check your data source URL and credentials."),s.createElement("div",null,"(",q.error,")")),s.createElement(f.O,{isLoading:te,blockingMessage:ie},s.createElement(se.Component,{model:se})))}}}function N(){return new o.Pj({variables:[new o.fS({name:E.MN,datasource:E.GH,hide:m.zL.hideVariable,includeAll:!0,defaultToAll:!0,skipUrlSync:!0,refresh:r.CO.onTimeRangeChanged,query:{query:`label_values(${E.ui},__name__)`,refId:"A"}})]})}function w(j,H){return o.d0.text().setTitle(j).setDescription(H).setHeaderActions(new D({metric:j,title:"Select"})).setOption("content","").build()}function L(j){return{container:(0,t.css)({display:"flex",flexDirection:"column",flexGrow:1}),headingWrapper:(0,t.css)({marginBottom:j.spacing(.5)}),header:(0,t.css)({flexGrow:0,display:"flex",gap:j.spacing(2),marginBottom:j.spacing(2),alignItems:"flex-end"}),searchField:(0,t.css)({flexGrow:1,marginBottom:0})}}const V=/[^a-z0-9_:]+/;function K(j){if(!j)return null;const H=j?.toLowerCase().split(V).filter(X=>X.length>0).map(X=>`(?=(.*${X}.*))`);if(H.length===0)return null;const J=H.join("");return new RegExp(J,"igy")}function k(j,H){const J=o.jh.lookupVariable(j,H),X=(0,s.useCallback)(()=>{if(J)return J.useState()},[J]),{error:se,loading:ae}=X()||{};return{isLoading:!!ae,error:se}}},90623:(G,I,e)=>{"use strict";e.d(I,{p:()=>r});var t=e(96540),n=e(67061),s=e(94753);const r=()=>t.createElement(n.B,{direction:"column",gap:1},t.createElement(s.E,{variant:"h1"},"Metrics"),t.createElement(s.E,{color:"secondary"},"Explore your Prometheus-compatible metrics without writing a query"))},69096:(G,I,e)=>{"use strict";e.d(I,{O:()=>o});var t=e(32196),n=e(96540),s=e(40845),r=e(39558);function o({blockingMessage:l,isLoading:i,children:u}){const d=(0,s.of)(m);return i&&!l&&(l="Loading..."),i?n.createElement(r._,{className:d.statusMessage,text:l}):l?n.createElement("div",{className:d.statusMessage},l):u}function m(l){return{statusMessage:(0,t.css)({fontStyle:"italic",marginTop:l.spacing(7),textAlign:"center",width:"100%"})}}},74764:(G,I,e)=>{"use strict";e.d(I,{_:()=>E});var t=e(2543),n=e(16401),s=e(99140),r=e(16001),o=e(56833),m=e(4200),l=e(96540),i=e(67061),u=e(55852),d=e(3169);function p(){const g=(0,d.tZ)("Bookmark created");return g.component=l.createElement(i.B,{gap:2,direction:"row"},l.createElement("div",null,"You can view bookmarks under ",l.createElement("i",null,"Explore > Metrics")),l.createElement(u.z9,{fill:"solid",variant:"secondary",href:m.QX},"View bookmarks")),g}const c=20;class y{constructor(){this._recent=[],this._bookmarks=[],this._bookmarkIndexMap=new Map,this.load();const h=()=>{const D=this._recent.slice(0,c).map(C=>this._serializeTrail(C.resolve()));localStorage.setItem(m.sQ,JSON.stringify(D));const v=this._bookmarks.map(C=>this._serializeTrail(C.resolve()));localStorage.setItem(m.me,JSON.stringify(v))};this._save=(0,t.debounce)(h,1e3),window.addEventListener("beforeunload",D=>{this._save=h})}_loadFromStorage(h){const D=[],v=localStorage.getItem(h);if(v){const C=JSON.parse(v);for(const T of C){const S=this._deserializeTrail(T);D.push(S.getRef())}}return D}_deserializeTrail(h){const D=new o.b({createdAt:h.createdAt});h.history.map(C=>{this._loadFromUrl(D,C.urlValues);const T=C.parentIndex??D.state.history.state.steps.length-1;D.state.history.setState({currentStep:T}),D.state.history.addTrailStep(D,C.type)});const v=h.currentStep??D.state.history.state.steps.length-1;return D.state.history.setState({currentStep:v}),D.setState(D.state.history.state.steps[v].trailState),D}_serializeTrail(h){return{history:h.state.history.state.steps.map(v=>{const C=new o.b(n.Go.cloneSceneObjectState(v.trailState));return{urlValues:(0,n.Is)().getUrlState(C),type:v.type,description:v.description,parentIndex:v.parentIndex}}),currentStep:h.state.history.state.currentStep,createdAt:h.state.createdAt}}_loadFromUrl(h,D){h.urlSync?.updateFromUrl(D),h.forEachChild(v=>this._loadFromUrl(v,D))}get recent(){return this._recent}load(){this._recent=this._loadFromStorage(m.sQ),this._bookmarks=this._loadFromStorage(m.me),this._refreshBookmarkIndexMap()}setRecentTrail(h){const{steps:D}=h.state.history.state;if(D.length===0||D.length===1&&D[0].type==="start")return;this._recent=this._recent.filter(C=>C!==h.getRef());const v=f(h);this._recent=this._recent.filter(C=>{const T=f(C.resolve());return!(0,t.isEqual)(v,T)}),this._recent.unshift(h.getRef()),this._save()}findMatchingRecentTrail(h){const D=f(h);return this._recent.find(v=>{const C=f(v.resolve());return(0,t.isEqual)(D,C)})}get bookmarks(){return this._bookmarks}addBookmark(h){const D=new o.b(n.Go.cloneSceneObjectState(h.state));this._bookmarks.unshift(D.getRef()),this._refreshBookmarkIndexMap(),this._save(),(0,s.JD)((0,r.dx)(p()))}removeBookmark(h){h<this._bookmarks.length&&(this._bookmarks.splice(h,1),this._refreshBookmarkIndexMap(),this._save())}getBookmarkIndex(h){const D=P(h);return this._bookmarkIndexMap.get(D)}_refreshBookmarkIndexMap(){this._bookmarkIndexMap.clear(),this._bookmarks.forEach((h,D)=>{const v=h.resolve(),C=P(v);this._bookmarkIndexMap.set(C,D)})}}function f(g){const h=(0,n.Is)().getUrlState(g);return delete h.actionView,delete h.layout,h["var-groupby"]===""&&(h["var-groupby"]="$__all"),h}function P(g){return JSON.stringify(f(g))}let a;function E(){return a||(a=new y),a}},88434:(G,I,e)=>{"use strict";e.d(I,{R:()=>o,q:()=>r});var t=e(50556),n=e(19347),s=e(4200);class r{constructor(l){this._trail=l}reset(){this._datasource=void 0,this._metricsMetadata=void 0}async getDatasource(){return this._datasource||(this._datasource=(0,n.l)().get(s.gR,{__sceneObject:{value:this._trail}})),await this._datasource}async _getMetricsMetadata(){const l=await this.getDatasource();if(l.languageProvider instanceof t.Ay)return l.languageProvider.metricsMetadata||await l.languageProvider.loadMetricsMetadata(),l.languageProvider.metricsMetadata}async getMetricMetadata(l){return l?(this._metricsMetadata||(this._metricsMetadata=this._getMetricsMetadata()),(await this._metricsMetadata)?.[l]):void 0}}function o(m){if(!m)return;const{type:l,help:i,unit:u}=m;return[i,l&&`**Type:** *${l}*`,u&&`**Unit:** ${u}`].join(`

`)}},40588:(G,I,e)=>{"use strict";e.d(I,{h:()=>r,z:()=>s});var t=e(14110);const n="grafana_explore_metrics_";function s(o,m){(0,t.rR)(`${n}${o}`,m)}function r(o,m){if(o.length===m.length)for(const l of m)for(const i of o)l.key===i.key&&l.value!==i.value&&s("label_filter_changed",{label:l.key,action:"changed",cause:"adhoc_filter"});else if(o.length<m.length)for(const l of m){let i=!1;for(const u of o)if(l.key===u.key){i=!0;break}i||s("label_filter_changed",{label:l.key,action:"removed",cause:"adhoc_filter"})}else for(const l of o){let i=!1;for(const u of m)if(u.key===l.key){i=!0;break}i||s("label_filter_changed",{label:l.key,action:"added",cause:"adhoc_filter"})}}},4200:(G,I,e)=>{"use strict";e.d(I,{Ao:()=>l,EY:()=>y,GH:()=>h,MN:()=>m,OO:()=>T,QX:()=>o,Rp:()=>d,aZ:()=>c,gR:()=>f,km:()=>r,me:()=>v,sQ:()=>D,td:()=>E,ui:()=>i,ym:()=>C,yr:()=>p});var t=e(65463),n=e(16401),s=e(79422);const r="/explore/metrics/trail",o="/explore/metrics",m="metricNames",l="filters",i="{${filters}}",u="metric",d="${metric}",p="groupby",c="${groupby}",y="ds",f="${ds}",P="logsDs",a="${logsDs}",E="$__logs__",g="sqr-metric-viz-query",h={uid:f},D="grafana.trails.recent",v="grafana.trails.bookmarks";function C(S){return[new n.x0({name:u,value:S,hide:s.zL.hideVariable})]}class T extends t.x{static{this.type="metric-selected-event"}}},51080:(G,I,e)=>{"use strict";e.d(I,{KE:()=>p,U4:()=>a,Vy:()=>D,aM:()=>P,aO:()=>g,ef:()=>c,gA:()=>C,hR:()=>h,iG:()=>v,kj:()=>d,nH:()=>E,xi:()=>y});var t=e(76885),n=e(19347),s=e(32264),r=e(16401),o=e(31193),m=e(56833),l=e(75176),i=e(74764),u=e(4200);function d(T){return r.jh.getAncestor(T,m.b)}function p(T){return r.jh.getAncestor(T,m.b).state.settings}function c(T){return new m.b({initialDS:T,$timeRange:new r.JZ({from:"now-1h",to:"now"}),embedded:!1})}function y(T){const S=(0,r.Is)().getUrlState(T);return f(S)}function f(T){return t.kM.renderUrl(u.km,T)}function P(T){if(T instanceof l.R)return T;if(T.parent)return P(T.parent);throw console.error("Unable to find graph view for",T),new Error("Unable to find trail")}function a(T){return r.jh.interpolate(T,u.gR)}function E(T){return(0,n.l)().getInstanceSettings(T)?.name||T}function g(T){return T?T===u.td?"Logs":T:"Select metric"}function h(){const T=(0,i._)().recent[0];if(T){const O=r.jh.interpolate(T.resolve(),u.gR);if(typeof O=="string"&&O.length>0)return O}const S=(0,o.tR)().getList({type:"prometheus"});if(S.length>0)return S.find(O=>O.uid===s.$.defaultDatasource)?.uid??S[0].uid}function D(T){const S=s.$.theme2.visualization;return S.getColorByName(S.palette[T%8])}function v(T){const S=Object.keys(T);return S.includes("from")&&S.includes("to")}function C(T){const S=r.jh.lookupVariable("filters",T);return S instanceof r.H9?S.state.filters:null}},27825:(G,I,e)=>{"use strict";e.d(I,{J:()=>P});var t=e(52622),n=e(38248),s=e(96540),r=e(91890),o=e(72574),m=e(32264),l=e(66864),i=e(94354),u=e(10354),d=e(88841),p=e(94397);const c=[{label:"Size",value:t.J1.Size,description:"Split the buckets based on size"},{label:"Count",value:t.J1.Count,description:"Split the buckets based on count"}],y=[{label:"Split",value:t.J1.Size,description:"Split the buckets based on size"}],f=({value:a,onChange:E,item:g})=>{const[h,D]=(0,s.useState)(!1),v=S=>{D(!(0,p.N_)(S)),E({...a,value:S})},T=(0,o.w)().getVariables().map(S=>({value:S.name,label:S.label||S.name,origin:r.$0.Template}));return s.createElement(l.Gy,null,s.createElement(i.z,{value:a?.mode||t.J1.Size,options:a?.scale?.type===t.L4.Log?y:c,onChange:S=>{E({...a,mode:S})}}),m.$.featureToggles.transformationsVariableSupport?s.createElement(d.y,{invalid:h,error:"Value needs to be an integer or a variable",value:a?.value??"",placeholder:"Auto",onChange:v,suggestions:T}):s.createElement(u.p,{value:a?.value??"",placeholder:"Auto",onChange:S=>{E({...a,value:S.currentTarget.value})}}))};function P(a,E,g,h){E.addCustomEditor({id:"xBuckets",path:`${a}xBuckets`,name:"X Bucket",editor:f,category:h,defaultValue:{mode:t.J1.Size}}),E.addCustomEditor({id:"yBuckets",path:`${a}yBuckets`,name:"Y Bucket",editor:f,category:h,defaultValue:{mode:t.J1.Size}}),E.addCustomEditor({id:"yBuckets-scale",path:`${a}yBuckets.scale`,name:"Y Bucket scale",category:h,editor:n.W,defaultValue:{type:t.L4.Linear}})}},3290:(G,I,e)=>{"use strict";e.d(I,{VQ:()=>K,wY:()=>B,Nb:()=>w,eE:()=>N,yJ:()=>L});var t=e(81160),n=e(18282),s=e(81010),r=e(11261),o=e(28240),m=e(83195),l=e(41260),i=e(70416),u=e(77678),d=e(73060),p=e(32264),c=e(52622),y=e(97706);const{abs:f,pow:P}=Math,a=new Map;function E(J,X,se,ae){let ne=[],q=ae.map(y.E);for(let ee=X;ee<se;ee++){let z=f(ee),te=(0,y.h)(P(J,ee),z);for(let ie=0;ie<ae.length;ie++){let ce=ae[ie]*te,ue=(ce>=0&&ee>=0?0:z)+(ee>=q[ie]?0:q[ie]),fe=(0,y.h)(ce,ue);ne.push(fe),a.set(fe,ue)}}return ne}const g=J=>J%1===0,h=[1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7,7.5,8,8.5,9,9.5],D=E(10,-16,0,h),v=E(10,0,16,h),C=v.filter(g),T=D.concat(v),S=D.concat(C),O=1*1e3,x=60*O,b=60*x,M=24*b,A=365*M,R=[1,2,4,5,10,20,25,40,50,100,200,250,400,500,O,2*O,4*O,5*O,10*O,15*O,20*O,30*O,x,2*x,4*x,5*x,10*x,15*x,20*x,30*x,b,2*b,4*b,6*b,8*b,12*b,18*b,M,2*M,3*M,4*M,5*M,6*M,7*M,10*M,15*M,30*M,45*M,60*M,90*M,180*M,A,2*A,3*A,4*A,5*A,6*A,7*A,8*A,9*A,10*A],B={id:n.F.heatmap,name:"Create heatmap",description:"Generate heatmap data from source data.",defaultOptions:{},isApplicable:J=>{const{xField:X,yField:se,xs:ae,ys:ne}=k(J);return X||se||!ae.length||!ne.length?s.M.NotPossible:s.M.Applicable},isApplicableDescription:"The Heatmap transformation requires fields with Heatmap compatible data. No fields with Heatmap data could be found.",operator:(J,X)=>se=>se.pipe((0,t.T)(ae=>{if(p.$.featureToggles.transformationsVariableSupport){const ne={...J,xBuckets:{...J.xBuckets},yBuckets:{...J.yBuckets}};return ne.xBuckets?.value&&(ne.xBuckets.value=X.interpolate(ne.xBuckets.value)),ne.yBuckets?.value&&(ne.yBuckets.value=X.interpolate(ne.yBuckets.value)),B.transformer(ne,X)(ae)}else return B.transformer(J,X)(ae)})),transformer:J=>X=>{const se=K(X,J);return J.keepOriginalData?[se,...X]:[se]}};function U(J){return J==="+Inf"?1/0:J==="-Inf"?-1/0:+(J??0)}function W(J,X){return U(J)-U(X)}function N(J){return J?.meta?.custom??{}}function w(J){let X=!1;for(let se of J.fields)switch(se.name){case"y":case"yMin":case"yMax":if(X)return!1;X=!0}return X}function L(J){const X=J.frame.fields[0],se=X.values,ae=J.frame.fields.filter((Te,he)=>Te.type===r.PU.number&&he>0),ne=se.length*ae.length,q=new Array(ne),ee=new Array(ne),z=new Array(ne),te=ae.map(Te=>Te.values.slice());te.forEach((Te,he)=>{for(let de=0;de<Te.length;de++)z[te.length*de+he]=Te[de]});const ie=Array.from({length:ae.length},(Te,he)=>he);for(let Te=0,he=0,de=0;Te<ne;he=++Te%ie.length)ee[Te]=ie[he],he===0&&Te>=ie.length&&de++,q[Te]=se[de];let ce=ae[0].labels?.le!=null?"yMax":"y";switch(J.layout){case c.D7.le:ce="yMax";break;case c.D7.ge:ce="yMin";break;case c.D7.unknown:ce="y";break}const ue={yOrdinalDisplay:ae.map(Te=>(0,o.Ct)(Te,J.frame)),yMatchWithLabel:Object.keys(ae[0].labels??{})[0]};if(ue.yMatchWithLabel&&(ue.yOrdinalLabel=ae.map(Te=>Te.labels?.[ue.yMatchWithLabel]??""),ue.yMatchWithLabel==="le"&&(ue.yMinDisplay="0.0")),J.unit?.length||J.decimals!=null){const Te=(0,m.j_)(J.unit??"short");ue.yMinDisplay&&(ue.yMinDisplay=(0,m.cN)(Te(0,J.decimals))),ue.yOrdinalDisplay=ue.yOrdinalDisplay.map(he=>{let de=+he;return Number.isNaN(de)?he:(0,m.cN)(Te(de,J.decimals))})}const fe={...ae[0].config};return fe.displayNameFromDS&&delete fe.displayNameFromDS,{length:q.length,refId:J.frame.refId,meta:{type:l.m.HeatmapCells,custom:ue},fields:[{name:X.type===r.PU.time?"xMax":"x",type:X.type,values:q,config:X.config},{name:ce,type:r.PU.number,values:ee,config:{unit:"short"}},{name:J.value?.length?J.value:"Value",type:r.PU.number,values:z,config:fe,display:ae[0].display}]}}function V(J){J=J.slice(),J.sort((se,ae)=>W(se.name,ae.name));const X=J.map(se=>se.fields[1].values.slice());return X.reverse(),X.forEach((se,ae)=>{if(ae<X.length-1)for(let ne=0;ne<se.length;ne++)se[ne]-=X[ae+1][ne]}),X.reverse(),J.map((se,ae)=>({...se,fields:[se.fields[0],{...se.fields[1],values:X[ae]}]}))}function K(J,X){const{xField:se,yField:ae,xs:ne,ys:q}=k(J);if(!se||!ae)throw"no heatmap fields found";if(!ne.length||!q.length)throw"no values found";const ee=X.xBuckets??{},z=X.yBuckets??{};if(ee.scale?.type===c.L4.Log)throw"X axis only supports linear buckets";const te=X.yBuckets?.scale??{type:c.L4.Linear},ie=j(ne,q,{xSorted:(0,d.g2)(ne),xTime:se.type===r.PU.time,xMode:ee.mode,xSize:ee.mode===c.J1.Size?(0,i.WT)((0,i.E9)(ee.value??"")):ee.value?+ee.value:void 0,yMode:z.mode,ySize:z.value?+z.value:void 0,yLog:te?.type===c.L4.Log?te?.log:void 0});return{length:ie.x.length,name:(0,o.Ct)(ae),meta:{type:l.m.HeatmapCells},fields:[{name:"xMin",type:se.type,values:ie.x,config:se.config},{name:"yMin",type:r.PU.number,values:ie.y,config:{...ae.config,custom:{scaleDistribution:te}}},{name:"Count",type:r.PU.number,values:ie.count,config:{unit:"short"}}]}}function k(J){let X,se,ae=0;for(let z of J)z.fields.find(ie=>ie.type===r.PU.time)&&(ae+=z.length);let ne=Array(ae),q=Array(ae),ee=0;for(let z of J){const te=z.fields.find(ce=>ce.type===r.PU.time);if(!te)continue;X||(X=te);const ie=te.values;for(let ce of z.fields)if(ce!==te&&ce.type===r.PU.number){const ue=ce.values;for(let fe=0;fe<ie.length;fe++,ee++)ne[ee]=ie[fe],q[ee]=ue[fe];se||(se=ce)}}return{xField:X,yField:se,xs:ne,ys:q}}function j(J,X,se){let ae=J.length,ne=se?.xSorted??!1,q=se?.ySorted??!1,ee=ne?J[0]:1/0,z=q?X[0]:1/0,te=ne?J[ae-1]:-1/0,ie=q?X[ae-1]:-1/0,ce=se?.yLog;for(let xe=0;xe<ae;xe++)ne||(ee=Math.min(ee,J[xe]),te=Math.max(te,J[xe])),q||(!ce||X[xe]>0)&&(z=Math.min(z,X[xe]),ie=Math.max(ie,X[xe]));let ue=se?.xSize??0,fe=se?.ySize??0,Te=se?.xMode,he=se?.yMode;if((!Number.isFinite(ue)||ue<=0)&&(Te=c.J1.Count,ue=20),(!Number.isFinite(fe)||fe<=0)&&(he=c.J1.Count,fe=10),Te===c.J1.Count){let xe=(te-ee)/Math.max(ue-1,1),Ve=se?.xTime?R:S,$e=Ve.findIndex(Xe=>Xe>xe)-1;ue=Ve[Math.max($e,0)]}if(he===c.J1.Count){let xe=(ie-z)/Math.max(fe-1,1),Ve=se?.yTime?R:S,$e=Ve.findIndex(Xe=>Xe>xe)-1;fe=Ve[Math.max($e,0)]}let de=se?.xCeil?xe=>(0,u.Uh)(xe,ue):xe=>(0,u.rs)(xe,ue),le=se?.yCeil?xe=>(0,u.Uh)(xe,fe):xe=>(0,u.rs)(xe,fe);if(ce){fe=1/(se?.ySize??1);let xe=ce===2?Math.log2:Math.log10;le=se?.yCeil?Ve=>(0,u.Uh)(xe(Ve),fe):Ve=>(0,u.rs)(xe(Ve),fe)}let pe=de(ee),ve=de(te),be=le(z),Oe=le(ie),Me=Math.round((ve-pe)/ue)+1,Ue=Math.round((Oe-be)/fe)+1,[we,Re,Fe]=H(Me,Ue,pe,ue,be,fe,ce);for(let xe=0;xe<ae;xe++){if(ce&&X[xe]<=0)continue;const Ve=(de(J[xe])-pe)/ue,$e=(le(X[xe])-be)/fe,Xe=Ve*Ue+$e;Fe[Xe]++}return{x:we,y:Re,count:Fe}}function H(J,X,se,ae,ne,q,ee){const z=J*X,te=new Array(z),ie=new Array(z),ce=new Array(z);for(let ue=0,fe=0,Te=se;ue<z;fe=++ue%X)ce[ue]=0,ee?ie[ue]=ee**(ne+fe*q):ie[ue]=ne+fe*q,fe===0&&ue>=X&&(Te+=ae),te[ue]=Te;return[te,ie,ce]}},91847:(G,I,e)=>{"use strict";e.d(I,{$n:()=>s,g_:()=>t,uk:()=>n});var t=(o=>(o.ShortcodeFigure="shortcodeFigure",o.UIImage="uiImage",o))(t||{});const n={calculateField:{name:"Add field from calculation",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to add a new field calculated from two other fields. Each transformation allows you to add one new field.

- **Mode** - Select a mode:
  - **Reduce row** - Apply selected calculation on each row of selected fields independently.
  - **Binary operation** - Apply basic binary operations (for example, sum or multiply) on values in a single row from two selected fields.
  - **Unary operation** - Apply basic unary operations on values in a single row from a selected field. The available operations are:
    - **Absolute value (abs)** - Returns the absolute value of a given expression. It represents its distance from zero as a positive number.
    - **Natural exponential (exp)** - Returns _e_ raised to the power of a given expression.
    - **Natural logarithm (ln)** - Returns the natural logarithm of a given expression.
    - **Floor (floor)** - Returns the largest integer less than or equal to a given expression.
    - **Ceiling (ceil)** - Returns the smallest integer greater than or equal to a given expression.
  - **Cumulative functions** - Apply functions on the current row and all preceding rows.
    - **Total** - Calculates the cumulative total up to and including the current row.
    - **Mean** - Calculates the mean up to and including the current row.
  - **Window functions** - Apply window functions. The window can either be **trailing** or **centered**.
    With a trailing window the current row will be the last row in the window.
    With a centered window the window will be centered on the current row.
    For even window sizes, the window will be centered between the current row, and the previous row.
    - **Mean** - Calculates the moving mean or running average.
    - **Stddev** - Calculates the moving standard deviation.
    - **Variance** - Calculates the moving variance.
  - **Row index** - Insert a field with the row index.
- **Field name** - Select the names of fields you want to use in the calculation for the new field.
- **Calculation** - If you select **Reduce row** mode, then the **Calculation** field appears. Click in the field to see a list of calculation choices you can use to create the new field. For information about available calculations, refer to [Calculation types][].
- **Operation** - If you select **Binary operation** or **Unary operation** mode, then the **Operation** fields appear. These fields allow you to apply basic math operations on values in a single row from selected fields. You can also use numerical values for binary operations.
- **As percentile** - If you select **Row index** mode, then the **As percentile** switch appears. This switch allows you to transform the row index as a percentage of the total number of rows.
- **Alias** - (Optional) Enter the name of your new field. If you leave this blank, then the field will be named to match the calculation.
- **Replace all fields** - (Optional) Select this option if you want to hide all other fields and display only your calculated field in the visualization.

> **Note:** **Cumulative functions** and **Window functions** modes are currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`addFieldFromCalculationStatFunctions\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.

In the example below, we added two fields together and named them Sum.

${r("/static/img/docs/transformations/add-field-from-calc-stat-example-7-0.png",o,"A stat visualization including one field called Sum")}
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},concatenate:{name:"Concatenate fields",getHelperDocs:function(){return`
Use this transformation to combine all fields from all frames into one result.

For example, if you have separate queries retrieving temperature and uptime data (Query A) and air quality index and error information (Query B), applying the concatenate transformation yields a consolidated data frame with all relevant information in one view.

Consider the following:

**Query A:**

| Temp  | Uptime  |
| ----- | ------- |
| 15.4  | 1230233 |

**Query B:**

| AQI   | Errors |
| ----- | ------ |
| 3.2   | 5      |

After you concatenate the fields, the data frame would be:

| Temp | Uptime  | AQI | Errors |
| ---- | ------- | --- | ------ |
| 15.4 | 1230233 | 3.2 | 5      |

This transformation simplifies the process of merging data from different sources, providing a comprehensive view for analysis and visualization.
  `}},configFromData:{name:"Config from query results",getHelperDocs:function(){return`
Use this transformation to select a query and extract standard options, such as **Min**, **Max**, **Unit**, and **Thresholds**, and apply them to other query results. This feature enables dynamic visualization configuration based on the data returned by a specific query.

#### Options

- **Config query** - Select the query that returns the data you want to use as configuration.
- **Apply to** - Select the fields or series to which the configuration should be applied.
- **Apply to options** - Specify a field type or use a field name regex, depending on your selection in **Apply to**.

#### Field mapping table

Below the configuration options, you'll find the field mapping table. This table lists all fields found in the data returned by the config query, along with **Use as** and **Select** options. It provides control over mapping fields to config properties, and for multiple rows, it allows you to choose which value to select.

#### Example

Input[0] (From query: A, name: ServerA)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 10    |
| 1626178119129 | 30    |

Input[1] (From query: B)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 100   |
| 1626178119129 | 100   |

Output (Same as Input[0] but now with config on the Value field)

| Time          | Value (config: Max=100) |
| ------------- | ----------------------- |
| 1626178119127 | 10                      |
| 1626178119129 | 30                      |

Each row in the source data becomes a separate field. Each field now has a maximum configuration option set. Options such as **Min**, **Max**, **Unit**, and **Thresholds** are part of the field configuration. If set, they are used by the visualization instead of any options manually configured in the panel editor options pane.

#### Value mappings

You can also transform a query result into value mappings. With this option, every row in the configuration query result defines a single value mapping row. See the following example.

Config query result:

| Value | Text   | Color |
| ----- | ------ | ----- |
| L     | Low    | blue  |
| M     | Medium | green |
| H     | High   | red   |

In the field mapping specify:

| Field | Use as                  | Select     |
| ----- | ----------------------- | ---------- |
| Value | Value mappings / Value  | All values |
| Text  | Value mappings / Text   | All values |
| Color | Value mappings / Color | All values |

Grafana builds value mappings from your query result and applies them to the real data query results. You should see values being mapped and colored according to the config query results.
  `}},convertFieldType:{name:"Convert field type",getHelperDocs:function(){return`
Use this transformation to modify the field type of a specified field.

This transformation has the following options:

- **Field** - Select from available fields
- **as** - Select the FieldType to convert to
  - **Numeric** - attempts to make the values numbers
  - **String** - will make the values strings
  - **Time** - attempts to parse the values as time
    - Will show an option to specify a DateFormat as input by a string like yyyy-mm-dd or DD MM YYYY hh:mm:ss
  - **Boolean** - will make the values booleans
  - **Enum** - will make the values enums
    - Will show a table to manage the enums
  - **Other** - attempts to parse the values as JSON

For example, consider the following query that could be modified by selecting the time field as Time and specifying Date Format as YYYY.

#### Sample Query

| Time       | Mark  | Value |
|------------|-------|-------|
| 2017-07-01 | above | 25    |
| 2018-08-02 | below | 22    |
| 2019-09-02 | below | 29    |
| 2020-10-04 | above | 22    |

The result:

#### Transformed Query

| Time                | Mark  | Value |
|---------------------|-------|-------|
| 2017-01-01 00:00:00 | above | 25    |
| 2018-01-01 00:00:00 | below | 22    |
| 2019-01-01 00:00:00 | below | 29    |
| 2020-01-01 00:00:00 | above | 22    |

This transformation allows you to flexibly adapt your data types, ensuring compatibility and consistency in your visualizations.
  `}},extractFields:{name:"Extract fields",getHelperDocs:function(){return`
Use this transformation to select a source of data and extract content from it in different formats. This transformation has the following fields:

- **Source** - Select the field for the source of data.
- **Format** - Choose one of the following:
  - **JSON** - Parse JSON content from the source.
  - **Key+value pairs** - Parse content in the format 'a=b' or 'c:d' from the source.
  - **Auto** - Discover fields automatically.
- **Replace All Fields** - (Optional) Select this option to hide all other fields and display only your calculated field in the visualization.
- **Keep Time** - (Optional) Available only if **Replace All Fields** is true. Keeps the time field in the output.

Consider the following dataset:

#### Dataset Example

| Timestamp           | json_data     |
|---------------------|---------------|
| 1636678740000000000 | {"value": 1}  |
| 1636678680000000000 | {"value": 5}  |
| 1636678620000000000 | {"value": 12} |

You could prepare the data to be used by a [Time series panel][] with this configuration:

- Source: json_data
- Format: JSON
  - Field: value
  - Alias: my_value
- Replace all fields: true
- Keep time: true

This will generate the following output:

#### Transformed Data

| Timestamp           | my_value |
|---------------------|----------|
| 1636678740000000000 | 1        |
| 1636678680000000000 | 5        |
| 1636678620000000000 | 12       |

This transformation allows you to extract and format data in various ways. You can customize the extraction format based on your specific data needs.
  `},links:[{title:"Time series panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/time-series/"}]},fieldLookup:{name:"Lookup fields from resource",getHelperDocs:function(){return`
Use this transformation to enrich a field value by looking up additional fields from an external source. 
  
This transformation has the following fields:

- **Field** - Select a text field from your dataset.
- **Lookup** - Choose from **Countries**, **USA States**, and **Airports**.

This transformation currently supports spatial data.

For example, if you have this data:

#### Dataset Example

| Location  | Values |
|-----------|--------|
| AL        | 0      |
| AK        | 10     |
| Arizona   | 5      |
| Arkansas  | 1      |
| Somewhere | 5      |

With this configuration:

- Field: location
- Lookup: USA States

You'll get the following output:

#### Transformed Data

| Location  | ID | Name     | Lng         | Lat       | Values |
|-----------|----|----------|-------------|-----------|--------|
| AL        | AL | Alabama  | -80.891064  | 12.448457 | 0      |
| AK        | AK | Arkansas | -100.891064 | 24.448457 | 10     |
| Arizona   |    |          |             |           | 5      |
| Arkansas  |    |          |             |           | 1      |
| Somewhere |    |          |             |           | 5      |

This transformation lets you augment your data by fetching additional information from external sources, providing a more comprehensive dataset for analysis and visualization.
  `}},filterByRefId:{name:"Filter data by query refId",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to hide one or more queries in panels that have multiple queries.

Grafana displays the query identification letters in dark gray text. Click a query identifier to toggle filtering. If the query letter is white, then the results are displayed. If the query letter is dark, then the results are hidden.

> **Note:** This transformation is not available for Graphite because this data source does not support correlating returned data with queries.

In the example below, the panel has three queries (A, B, C). We removed the B query from the visualization.

${r("/static/img/docs/transformations/filter-by-query-stat-example-7-0.png",o,"A stat visualization with results from two queries, A and C")}
  `}},filterByValue:{name:"Filter data by values",getHelperDocs:function(){return`
Use this transformation to selectively filter data points directly within your visualization. This transformation provides options to include or exclude data based on one or more conditions applied to a selected field.

This transformation is very useful if your data source does not natively filter by values. You might also use this to narrow values to display if you are using a shared query.

The available conditions for all fields are:

- **Regex** - Match a regex expression.
- **Is Null** - Match if the value is null.
- **Is Not Null** - Match if the value is not null.
- **Equal** - Match if the value is equal to the specified value.
- **Different** - Match if the value is different than the specified value.

The available conditions for string fields are:

- **Contains substring** - Match if the value contains the specified substring (case insensitive).
- **Does not contain substring** - Match if the value doesn't contain the specified substring (case insensitive).

The available conditions for number fields are:

- **Greater** - Match if the value is greater than the specified value.
- **Lower** - Match if the value is lower than the specified value.
- **Greater or equal** - Match if the value is greater or equal.
- **Lower or equal** - Match if the value is lower or equal.
- **Range** - Match a range between a specified minimum and maximum, min and max included.

Consider the following dataset:

#### Dataset Example

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:23 | 32          | 101      |
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:32:24 | 31          | 95       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

If you **Include** the data points that have a temperature below 30\xB0C, the configuration will look as follows:

- Filter Type: 'Include'
- Condition: Rows where 'Temperature' matches 'Lower Than' '30'

And you will get the following result, where only the temperatures below 30\xB0C are included:

#### Transformed Data

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

You can add more than one condition to the filter. For example, you might want to include the data only if the altitude is greater than 100. To do so, add that condition to the following configuration:

- Filter type: 'Include' rows that 'Match All' conditions
- Condition 1: Rows where 'Temperature' matches 'Lower' than '30'
- Condition 2: Rows where 'Altitude' matches 'Greater' than '100'

When you have more than one condition, you can choose if you want the action (include/exclude) to be applied on rows that **Match all** conditions or **Match any** of the conditions you added.

In the example above, we chose **Match all** because we wanted to include the rows that have a temperature lower than 30\xB0C *AND* an altitude higher than 100. If we wanted to include the rows that have a temperature lower than 30\xB0C *OR* an altitude higher than 100 instead, then we would select **Match any**. This would include the first row in the original data, which has a temperature of 32\xB0C (does not match the first condition) but an altitude of 101 (which matches the second condition), so it is included.

Conditions that are invalid or incompletely configured are ignored.

This versatile data filtering transformation lets you to selectively include or exclude data points based on specific conditions. Customize the criteria to tailor your data presentation to meet your unique analytical needs.
  `}},filterFieldsByName:{name:"Filter fields by name",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to selectively remove parts of your query results. There are three ways to filter field names:

- [Using a regular expression](#use-a-regular-expression)
- [Manually selecting included fields](#manually-select-included-fields)
- [Using a dashboard variable](#use-a-dashboard-variable)

#### Use a regular expression

When you filter using a regular expression, field names that match the regular expression are included. 

For example, from the input data:

| Time                | dev-eu-west | dev-eu-north | prod-eu-west | prod-eu-north |
| ------------------- | ----------- | ------------ | ------------ | ------------- |
| 2023-03-04 23:56:23 | 23.5        | 24.5         | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 23.6        | 24.4         | 22.1         | 20.1          |

The result from using the regular expression 'prod.*' would be:

| Time                | prod-eu-west | prod-eu-north |
| ------------------- | ------------ | ------------- |
| 2023-03-04 23:56:23 | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 22.1         | 20.1          |

The regular expression can include an interpolated dashboard variable by using the \${variableName} syntax.

#### Manually select included fields

Click and uncheck the field names to remove them from the result. Fields that are matched by the regular expression are still included, even if they're unchecked.

#### Use a dashboard variable

Enable 'From variable' to let you select a dashboard variable that's used to include fields. By setting up a [dashboard variable][] with multiple choices, the same fields can be displayed across multiple visualizations.

${r("/static/img/docs/transformations/filter-name-table-before-7-0.png",o,"A table visualization with time, value, Min, and Max columns")}

Here's the table after we applied the transformation to remove the Min field.

${r("/static/img/docs/transformations/filter-name-table-after-7-0.png",o,"A table visualization with time, value, and Max columns")}

Here is the same query using a Stat visualization.

${r("/static/img/docs/transformations/filter-name-stat-after-7-0.png",o,"A stat visualization with value and Max fields")}

This transformation provides flexibility in tailoring your query results to focus on the specific fields you need for effective analysis and visualization.
  `}},formatString:{name:"Format string",getHelperDocs:function(){return`
Use this transformation to customize the output of a string field. This transformation has the following fields:

- **Upper case** - Formats the entire string in uppercase characters.
- **Lower case** - Formats the entire string in lowercase characters.
- **Sentence case** - Formats the first character of the string in uppercase.
- **Title case** - Formats the first character of each word in the string in uppercase.
- **Pascal case** - Formats the first character of each word in the string in uppercase and doesn't include spaces between words.
- **Camel case** - Formats the first character of each word in the string in uppercase, except the first word, and doesn't include spaces between words.
- **Snake case** - Formats all characters in the string in lowercase and uses underscores instead of spaces between words.
- **Kebab case** - Formats all characters in the string in lowercase and uses dashes instead of spaces between words.
- **Trim** - Removes all leading and trailing spaces from the string.
- **Substring** - Returns a substring of the string, using the specified start and end positions.

This transformation provides a convenient way to standardize and tailor the presentation of string data for better visualization and analysis.

> **Note:** This transformation is currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`formatString\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.`}},formatTime:{name:"Format time",getHelperDocs:function(){return`
Use this transformation to customize the output of a time field. Output can be formatted using [Moment.js format strings](https://momentjs.com/docs/#/displaying/). For example, if you want to display only the year of a time field, the format string 'YYYY' can be used to show the calendar year (for example, 1999 or 2012).

**Before Transformation:**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 1636678740000000000 | System Start |
| 1636678680000000000 | User Login   |
| 1636678620000000000 | Data Updated |

**After applying 'YYYY-MM-DD HH:mm:ss':**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 2021-11-12 14:25:40 | System Start |
| 2021-11-12 14:24:40 | User Login   |
| 2021-11-12 14:23:40 | Data Updated |

This transformation lets you tailor the time representation in your visualizations, providing flexibility and precision in displaying temporal data.

> **Note:** This transformation is available in Grafana 10.1+ as an alpha feature.
  `}},groupBy:{name:"Group by",getHelperDocs:function(){return`
Use this transformation to group the data by a specified field (column) value and process calculations on each group. Click to see a list of calculation choices. For information about available calculations, refer to [Calculation types][].

Here's an example of original data.

| Time                | Server ID | CPU Temperature | Server Status |
| ------------------- | --------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
| 2020-07-07 11:34:20 | server 3  | 62              | OK            |
| 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
| 2020-07-07 10:31:22 | server 3  | 55              | OK            |
| 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
| 2020-07-07 09:30:05 | server 2  | 88              | OK            |
| 2020-07-07 09:28:06 | server 1  | 80              | OK            |
| 2020-07-07 09:25:05 | server 2  | 88              | OK            |
| 2020-07-07 09:23:07 | server 1  | 86              | OK            |

This transformation goes in two steps. First you specify one or multiple fields to group the data by. This will group all the same values of those fields together, as if you sorted them. For instance if we group by the Server ID field, then it would group the data this way:

| Time                | Server ID      | CPU Temperature | Server Status |
| ------------------- | -------------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | **server 1**   | 80              | Shutdown      |
| 2020-07-07 09:28:06 | **server 1**   | 80              | OK            |
| 2020-07-07 09:23:07 | **server 1**   | 86              | OK            |
| 2020-07-07 10:32:20 | server 2       | 90              | Overload      |
| 2020-07-07 09:30:05 | server 2       | 88              | OK            |
| 2020-07-07 09:25:05 | server 2       | 88              | OK            |
| 2020-07-07 11:34:20 | **_server 3_** | 62              | OK            |
| 2020-07-07 10:31:22 | **_server 3_** | 55              | OK            |
| 2020-07-07 09:30:57 | **_server 3_** | 62              | Rebooting     |

All rows with the same value of Server ID are grouped together.

After choosing which field you want to group your data by, you can add various calculations on the other fields, and apply the calculation to each group of rows. For instance, we could want to calculate the average CPU temperature for each of those servers. So we can add the _mean_ calculation applied on the CPU Temperature field to get the following:

| Server ID | CPU Temperature (mean) |
| --------- | ---------------------- |
| server 1  | 82                     |
| server 2  | 88.6                   |
| server 3  | 59.6                   |

And we can add more than one calculation. For instance:

- For field Time, we can calculate the _Last_ value, to know when the last data point was received for each server
- For field Server Status, we can calculate the _Last_ value to know what is the last state value for each server
- For field Temperature, we can also calculate the _Last_ value to know what is the latest monitored temperature for each server

We would then get:

| Server ID | CPU Temperature (mean) | CPU Temperature (last) | Time (last)         | Server Status (last) |
| --------- | ---------------------- | ---------------------- | ------------------- | -------------------- |
| server 1  | 82                     | 80                     | 2020-07-07 11:34:20 | Shutdown             |
| server 2  | 88.6                   | 90                     | 2020-07-07 10:32:20 | Overload             |
| server 3  | 59.6                   | 62                     | 2020-07-07 11:34:20 | OK                   |

This transformation allows you to extract essential information from your time series and present it conveniently.
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},groupingToMatrix:{name:"Grouping to matrix",getHelperDocs:function(){return`
Use this transformation to combine three fields\u2014which are used as input for the **Column**, **Row**, and **Cell value** fields from the query output\u2014and generate a matrix. The matrix is calculated as follows:

**Original data**

| Server ID | CPU Temperature | Server Status |
| --------- | --------------- | ------------- |
| server 1  | 82              | OK            |
| server 2  | 88.6            | OK            |
| server 3  | 59.6            | Shutdown      |

We can generate a matrix using the values of 'Server Status' as column names, the 'Server ID' values as row names, and the 'CPU Temperature' as content of each cell. The content of each cell will appear for the existing column ('Server Status') and row combination ('Server ID'). For the rest of the cells, you can select which value to display between: **Null**, **True**, **False**, or **Empty**.

**Output**

| Server IDServer Status | OK   | Shutdown |
| ----------------------- | ---- | -------- |
| server 1                | 82   |          |
| server 2                | 88.6 |          |
| server 3                |      | 59.6     |

Use this transformation to construct a matrix by specifying fields from your query results. The matrix output reflects the relationships between the unique values in these fields. This helps you present complex relationships in a clear and structured matrix format.
  `}},groupToNestedTable:{name:"Group to nested table",getHelperDocs:function(o="shortcodeFigure"){return`
  Use this transformation to group the data by a specified field (column) value and process calculations on each group. Records are generated that share the same grouped field value, to be displayed in a nested table.
    
  To calculate a statistic for a field, click the selection box next to it and select the **Calculate** option:

  ${r("/static/img/docs/transformations/nested-table-select-calculation.png",o,"A select box showing the Group and Calculate options for the transformation.")}

  Once **Calculate** has been selected, another selection box will appear next to the respective field which will allow statistics to be selected:

  ${r("/static/img/docs/transformations/nested-table-select-stat.png",o,"A select box showing available statistic calculations once the calculate option for the field has been selected.")}

  For information about available calculations, refer to [Calculation types][].

  Here's an example of original data:

  | Time                | Server ID | CPU Temperature | Server Status |
  | ------------------- | --------- | --------------- | ------------- |
  | 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
  | 2020-07-07 11:34:20 | server 3  | 62              | OK            |
  | 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
  | 2020-07-07 10:31:22 | server 3  | 55              | OK            |
  | 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
  | 2020-07-07 09:30:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:28:06 | server 1  | 80              | OK            |
  | 2020-07-07 09:25:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:23:07 | server 1  | 86              | OK            |

  This transformation has two steps. First, specify one or more fields by which to group the data. This groups all the same values of those fields together, as if you sorted them. For instance, if you group by the Server ID field, Grafana groups the data this way:

  | Server ID      |  |
  | -------------- | ------------- |
  | server 1 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>80</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>80</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>86</td><td>OK</td></tr></tbody></table> |
  | server 2 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>90</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>88</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>88</td><td>OK</td></tr></tbody></table> |
  | server 3 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>62</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>55</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>62</td><td>Rebooting</td></tr></tbody></table> |

  After choosing the field by which you want to group your data, you can add various calculations on the other fields and apply the calculation to each group of rows. For instance, you might want to calculate the average CPU temperature for each of those servers. To do so, add the **mean calculation** applied on the CPU Temperature field to get the following result:

  | Server ID      | CPU Temperatute (mean) | |
  | -------------- | ------------- | ------------- |
  | server 1 | 82 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>OK</td></tr></tbody></table> |
  | server 2 | 88.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>OK</td></tr></tbody></table> |
  | server 3 | 59.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>Rebooting</td></tr></tbody></table> |
      `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},heatmap:{name:"Create heatmap",getHelperDocs:function(){return`
Use this transformation to prepare histogram data for visualizing trends over time. Similar to the heatmap visualization, this transformation converts histogram metrics into temporal buckets.

#### X Bucket

This setting determines how the x-axis is split into buckets.

- **Size** - Specify a time interval in the input field. For example, a time range of '1h' creates cells one hour wide on the x-axis.
- **Count** - For non-time-related series, use this option to define the number of elements in a bucket.

#### Y Bucket

This setting determines how the y-axis is split into buckets.

- **Linear**
- **Logarithmic** - Choose between log base 2 or log base 10.
- **Symlog** - Uses a symmetrical logarithmic scale. Choose between log base 2 or log base 10, allowing for negative values.

Assume you have the following dataset:

| Timestamp           | Value |
|-------------------- |-------|
| 2023-01-01 12:00:00 | 5     |
| 2023-01-01 12:15:00 | 10    |
| 2023-01-01 12:30:00 | 15    |
| 2023-01-01 12:45:00 | 8     |

- With X Bucket set to 'Size: 15m' and Y Bucket as 'Linear', the histogram organizes values into time intervals of 15 minutes on the x-axis and linearly on the y-axis.
- For X Bucket as 'Count: 2' and Y Bucket as 'Logarithmic (base 10)', the histogram groups values into buckets of two on the x-axis and use a logarithmic scale on the y-axis.
  `}},histogram:{name:"Histogram",getHelperDocs:function(){return`
Use this transformation to generate a histogram based on input data, allowing you to visualize the distribution of values.

- **Bucket size** - The range between the lowest and highest items in a bucket (xMin to xMax).
- **Bucket offset** - The offset for non-zero-based buckets.
- **Combine series** - Create a unified histogram using all available series.

**Original data**

Series 1:

| A | B | C |
| - | - | - |
| 1 | 3 | 5 |
| 2 | 4 | 6 |
| 3 | 5 | 7 |
| 4 | 6 | 8 |
| 5 | 7 | 9 |

Series 2:

| C |
| - |
| 5 |
| 6 |
| 7 |
| 8 |
| 9 |

**Output**

| xMin | xMax | A | B | C | C |
| ---- | ---- | --| --| --| --|
| 1    | 2    | 1 | 0 | 0 | 0 |
| 2    | 3    | 1 | 0 | 0 | 0 |
| 3    | 4    | 1 | 1 | 0 | 0 |
| 4    | 5    | 1 | 1 | 0 | 0 |
| 5    | 6    | 1 | 1 | 1 | 1 |
| 6    | 7    | 0 | 1 | 1 | 1 |
| 7    | 8    | 0 | 1 | 1 | 1 |
| 8    | 9    | 0 | 0 | 1 | 1 |
| 9    | 10   | 0 | 0 | 1 | 1 |

Visualize the distribution of values using the generated histogram, providing insights into the data's spread and density.
  `}},joinByField:{name:"Join by field",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to merge multiple results into a single table, enabling the consolidation of data from different queries.

This is especially useful for converting multiple time series results into a single wide table with a shared time field.

#### Inner join (for Time Series or SQL-like data)

An inner join merges data from multiple tables where all tables share the same value from the selected field. This type of join excludes data where values do not match in every result.

Use this transformation to combine the results from multiple queries (combining on a passed join field or the first time column) into one result, and drop rows where a successful join cannot occur. This is not optimized for large Time Series datasets.

In the following example, two queries return Time Series data. It is visualized as two separate tables before applying the inner join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the inner join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

This works in the same way for non-Time Series tabular data as well.

**Students**

| StudentID | Name     | Major            |
| --------- | -------- | ---------------- |
| 1         | John     | Computer Science |
| 2         | Emily    | Mathematics      |
| 3         | Michael  | Physics          |
| 4         | Jennifer | Chemistry        |

**Enrollments**

| StudentID | CourseID | Grade |
|-----------|----------|-------|
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the inner join transformation looks like the following:

| StudentID | Name    | Major            | CourseID | Grade |
| --------- | ------- | ---------------- | -------  | ----- |
| 1         | John    | Computer Science | CS101    | A     |
| 1         | John    | Computer Science | CS102    | B     |
| 2         | Emily   | Mathematics      | MATH201  | A     |
| 3         | Michael | Physics          | PHYS101  | B     |

The inner join only includes rows where there is a match between the "StudentID" in both tables. In this case, the result does not include "Jennifer" from the "Students" table because there are no matching enrollments for her in the "Enrollments" table.

#### Outer join (for Time Series data)

An outer join includes all data from an inner join and rows where values do not match in every input. While the inner join joins Query A and Query B on the time field, the outer join includes all rows that don't match on the time field.

In the following example, two queries return table data. It is visualized as two tables before applying the outer join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the outer join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:04:20 |         |           | server 3 | 10     |
| 2020-07-07 11:14:20 | postgre | 345001233 |          |        |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

In the following example, a template query displays time series data from multiple servers in a table visualization. The results of only one query can be viewed at a time.

${r("/static/img/docs/transformations/join-fields-before-7-0.png",o,"A table visualization showing results for one server")}

I applied a transformation to join the query results using the time field. Now I can run calculations, combine, and organize the results in this new table.

${r("/static/img/docs/transformations/join-fields-after-7-0.png",o,"A table visualization showing results for multiple servers")}

#### Outer join (for SQL-like data)

A tabular outer join combining tables so that the result includes matched and unmatched rows from either or both tables.

| StudentID | Name      | Major            |
| --------- | --------- | ---------------- |
| 1         | John      | Computer Science |
| 2         | Emily     | Mathematics      |
| 3         | Michael   | Physics          |
| 4         | Jennifer  | Chemistry        |

Can now be joined with:

| StudentID | CourseID | Grade |
| --------- | -------- | ----- |
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the outer join transformation looks like the following:

| StudentID | Name     | Major            | CourseID | Grade |
| --------- | -------- | ---------------- | -------- | ----- |
| 1         | John     | Computer Science | CS101    | A     |
| 1         | John     | Computer Science | CS102    | B     |
| 2         | Emily    | Mathematics      | MATH201  | A     |
| 3         | Michael  | Physics          | PHYS101  | B     |
| 4         | Jennifer | Chemistry        | NULL     | NULL  |
| 5         | NULL     | NULL             | HIST101  | B     |

Combine and analyze data from various queries with table joining for a comprehensive view of your information.
  `}},joinByLabels:{name:"Join by labels",getHelperDocs:function(){return`
Use this transformation to join multiple results into a single table.

This is especially useful for converting multiple time series results into a single wide table with a shared **Label** field.

- **Join** - Select the label to join by between the labels available or common across all time series.
- **Value** - The name for the output result.

#### Example

##### Input

series1{what="Temp", cluster="A", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series2{what="Temp", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series3{what="Speed", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 22   | 22    |
| 28   | 77    |

##### Config

value: "what"

##### Output

| cluster | job | Temp | Speed |
| ------- | --- | ---- | ----- |
| A       | J1  | 10   |       |
| A       | J1  | 200  |       |
| B       | J1  | 10   | 22    |
| B       | J1  | 200  | 77    |

Combine and organize time series data effectively with this transformation for comprehensive insights.
  `}},labelsToFields:{name:"Labels to fields",getHelperDocs:function(){return`
Use this transformation to convert time series results with labels or tags into a table, including each label's keys and values in the result. Display labels as either columns or row values for enhanced data visualization.

Given a query result of two time series:

- Series 1: labels Server=Server A, Datacenter=EU
- Series 2: labels Server=Server B, Datacenter=EU

In "Columns" mode, the result looks like this:

| Time                | Server   | Datacenter | Value |
| ------------------- | -------- | ---------- | ----- |
| 2020-07-07 11:34:20 | Server A | EU         | 1     |
| 2020-07-07 11:34:20 | Server B | EU         | 2     |

In "Rows" mode, the result has a table for each series and show each label value like this:

| label      | value    |
| ---------- | -------- |
| Server     | Server A |
| Datacenter | EU       |

| label      | value    |
| ---------- | -------- |
| Server     | Server B |
| Datacenter | EU       |

#### Value field name

If you selected Server as the **Value field name**, then you would get one field for every value of the Server label.

| Time                | Datacenter | Server A | Server B |
| ------------------- | ---------- | -------- | -------- |
| 2020-07-07 11:34:20 | EU         | 1        | 2        |

#### Merging behavior

The labels to fields transformer is internally two separate transformations. The first acts on single series and extracts labels to fields. The second is the [merge](#merge) transformation that joins all the results into a single table. The merge transformation tries to join on all matching fields. This merge step is required and cannot be turned off.

To illustrate this, here is an example where you have two queries that return time series with no overlapping labels.

- Series 1: labels Server=ServerA
- Series 2: labels Datacenter=EU

This will first result in these two tables:

| Time                | Server  | Value |
| ------------------- | ------- | ----- |
| 2020-07-07 11:34:20 | ServerA | 10    |

| Time                | Datacenter | Value |
| ------------------- | ---------- | ----- |
| 2020-07-07 11:34:20 | EU         | 20    |

After merge:

| Time                | Server  | Value | Datacenter |
| ------------------- | ------- | ----- | ---------- |
| 2020-07-07 11:34:20 | ServerA | 10    |            |
| 2020-07-07 11:34:20 |         | 20    | EU         |

Convert your time series data into a structured table format for a clearer and more organized representation.
  `}},limit:{name:"Limit",getHelperDocs:function(){return`
Use this transformation to restrict the number of rows displayed, providing a more focused view of your data. This is particularly useful when dealing with large datasets.

Below is an example illustrating the impact of the **Limit** transformation on a response from a data source:

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

Here is the result after adding a Limit transformation with a value of '3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

This transformation helps you tailor the visual presentation of your data to focus on the most relevant information.
  `}},merge:{name:"Merge series/tables",getHelperDocs:function(){return`
Use this transformation to combine the results from multiple queries into a single result, which is particularly useful when using the table panel visualization. This transformation merges values into the same row if the shared fields contain the same data.

Here's an example illustrating the impact of the **Merge series/tables** transformation on two queries returning table data:

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |

**Query B:**

| Time                | Job     | Errors |
| ------------------- | ------- | ------ |
| 2020-07-07 11:34:20 | node    | 15     |
| 2020-07-07 11:24:20 | postgre | 5      |

Here is the result after applying the Merge transformation.

| Time                | Job     | Errors | Uptime    |
| ------------------- | ------- | ------ | --------- |
| 2020-07-07 11:34:20 | node    | 15     | 25260122  |
| 2020-07-07 11:24:20 | postgre | 5      | 123001233 |

This transformation combines values from Query A and Query B into a unified table, enhancing the presentation of data for better insights.
  `},links:[{title:"Table panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/"}]},organize:{name:"Organize fields by name",getHelperDocs:function(){return`
Use this transformation to provide the flexibility to rename, reorder, or hide fields returned by a single query in your panel. This transformation is applicable only to panels with a single query. If your panel has multiple queries, consider using an "Outer join" transformation or removing extra queries.

#### Transforming fields

Grafana displays a list of fields returned by the query, allowing you to perform the following actions:

- **Change field order** - Hover over a field, and when your cursor turns into a hand, drag the field to its new position.
- **Hide or show a field** - Use the eye icon next to the field name to toggle the visibility of a specific field.
- **Rename fields** - Type a new name in the "Rename <field>" box to customize field names.

#### Example:

##### Original Query Result

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

##### After Applying Field Overrides

| Time                | Sensor      | Reading |
| ------------------- | ----------- | ------- |
| 2020-07-07 11:34:20 | Temperature | 25      |
| 2020-07-07 11:34:20 | Humidity    | 22      |
| 2020-07-07 10:32:20 | Humidity    | 29      |

This transformation lets you to tailor the display of query results, ensuring a clear and insightful representation of your data in Grafana.
  `}},partitionByValues:{name:"Partition by values",getHelperDocs:function(){return`
Use this transformation to streamline the process of graphing multiple series without the need for multiple queries with different 'WHERE' clauses.

This is particularly useful when dealing with a metrics SQL table, as illustrated below:

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | US     | 1327  |
| 2022-10-20 01:00:00 | EU     | 912   |

With the **Partition by values** transformation, you can issue a single query and split the results by unique values in one or more columns (fields) of your choosing. The following example uses 'Region':

'SELECT Time, Region, Value FROM metrics WHERE Time > "2022-10-20"'

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 01:00:00 | US     | 1327  |

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | EU     | 912   |

This transformation simplifies the process and enhances the flexibility of visualizing multiple series within the same time series visualization.
  `}},prepareTimeSeries:{name:"Prepare time series",getHelperDocs:function(){return`
Use this transformation to address issues when a data source returns time series data in a format that isn't compatible with the desired visualization. This transformation allows you to convert time series data between wide and long formats, providing flexibility in data frame structures.

#### Available options

##### Multi-frame time series

Use this option to transform the time series data frame from the wide format to the long format. This is particularly helpful when your data source delivers time series information in a format that needs to be reshaped for optimal compatibility with your visualization.

**Example: Converting from wide to long format**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

**Transformed to:**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |


##### Wide time series

Select this option to transform the time series data frame from the long format to the wide format. If your data source returns time series data in a long format and your visualization requires a wide format, this transformation simplifies the process.

**Example: Converting from long to wide format**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |

**Transformed to:**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

> **Note:** This transformation is available in Grafana 7.5.10+ and Grafana 8.0.6+.
  `},links:[{title:"Data frames",url:"https://grafana.com/docs/grafana/latest/developers/plugins/introduction-to-plugin-development/data-frames/"}]},reduce:{name:"Reduce",getHelperDocs:function(){return`
Use this transformation to apply a calculation to each field in the data frame and return a single value. This transformation is particularly useful for consolidating multiple time series data into a more compact, summarized format. Time fields are removed when applying this transformation.

Consider the input:

**Query A:**

| Time                | Temp | Uptime  |
| ------------------- | ---- | ------- |
| 2020-07-07 11:34:20 | 12.3 | 256122  |
| 2020-07-07 11:24:20 | 15.4 | 1230233 |

**Query B:**

| Time                | AQI | Errors |
| ------------------- | --- | ------ |
| 2020-07-07 11:34:20 | 6.5 | 15     |
| 2020-07-07 11:24:20 | 3.2 | 5      |

The reduce transformer has two modes:

- **Series to rows** - Creates a row for each field and a column for each calculation.
- **Reduce fields** - Keeps the existing frame structure, but collapses each field into a single value.

For example, if you used the **First** and **Last** calculation with a **Series to rows** transformation, then
the result would be:

| Field  | First  | Last    |
| ------ | ------ | ------- |
| Temp   | 12.3   | 15.4    |
| Uptime | 256122 | 1230233 |
| AQI    | 6.5    | 3.2     |
| Errors | 15     | 5       |

The **Reduce fields** with the **Last** calculation,
results in two frames, each with one row:

**Query A:**

| Temp | Uptime  |
| ---- | ------- |
| 15.4 | 1230233 |

**Query B:**

| AQI | Errors |
| --- | ------ |
| 3.2 | 5      |

This flexible transformation simplifies the process of consolidating and summarizing data from multiple time series into a more manageable and organized format.
  `}},renameByRegex:{name:"Rename by regex",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to rename parts of the query results using a regular expression and replacement pattern.

You can specify a regular expression, which is only applied to matches, along with a replacement pattern that support back references. For example, let's imagine you're visualizing CPU usage per host and you want to remove the domain name. You could set the regex to '/^([^.]+).*/' and the replacement pattern to '$1', 'web-01.example.com' would become 'web-01'.

> **Note:** The Rename by regex transformation was improved in Grafana v9.0.0 to allow global patterns of the form '/<stringToReplace>/g'. Depending on the regex match used, this may cause some transformations to behave slightly differently. You can guarantee the same behavior as before by wrapping the match string in forward slashes '(/)', e.g. '(.*)' would become '/(.*)/'.

In the following example, we are stripping the 'A-' prefix from field names. In the before image, you can see everything is prefixed with 'A-':

${r("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-before-v11.0.png",o,"A time series with full series names")}

With the transformation applied, you can see we are left with just the remainder of the string.

${r("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-after-v11.0.png",o,"A time series with shortened series names")}

This transformation lets you to tailor your data to meet your visualization needs, making your dashboards more informative and user-friendly.
  `}},rowsToFields:{name:"Rows to fields",getHelperDocs:function(){return`
Use this transformation to convert rows into separate fields. This can be useful because fields can be styled and configured individually. It can also use additional fields as sources for dynamic field configuration or map them to field labels. The additional labels can then be used to define better display names for the resulting fields.

This transformation includes a field table which lists all fields in the data returned by the configuration query. This table gives you control over what field should be mapped to each configuration property (the **Use as** option). You can also choose which value to select if there are multiple rows in the returned data.

This transformation requires:

- One field to use as the source of field names.

  By default, the transform uses the first string field as the source. You can override this default setting by selecting **Field name** in the **Use as** column for the field you want to use instead.

- One field to use as the source of values.

  By default, the transform uses the first number field as the source. But you can override this default setting by selecting **Field value** in the **Use as** column for the field you want to use instead.

Useful when visualizing data in:

- Gauge
- Stat
- Pie chart

#### Map extra fields to labels

If a field does not map to config property Grafana will automatically use it as source for a label on the output field-

**Example:**

| Name    | DataCenter | Value |
| ------- | ---------- | ----- |
| ServerA | US         | 100   |
| ServerB | EU         | 200   |

**Output:**

| ServerA (labels: DataCenter: US) | ServerB (labels: DataCenter: EU) |
| -------------------------------- | -------------------------------- |
| 10                               | 20                               |

The extra labels can now be used in the field display name provide more complete field names.

If you want to extract config from one query and apply it to another you should use the config from query results transformation.

#### Example

**Input:**

| Name    | Value | Max |
| ------- | ----- | --- |
| ServerA | 10    | 100 |
| ServerB | 20    | 200 |
| ServerC | 30    | 300 |

**Output:**

| ServerA (config: max=100) | ServerB (config: max=200) | ServerC (config: max=300) |
| ------------------------- | ------------------------- | ------------------------- |
| 10                        | 20                        | 30                        |

As you can see each row in the source data becomes a separate field. Each field now also has a max config option set. Options like **Min**, **Max**, **Unit** and **Thresholds** are all part of field configuration and if set like this will be used by the visualization instead of any options manually configured in the panel editor options pane.

This transformation enables the conversion of rows into individual fields, facilitates dynamic field configuration, and maps additional fields to labels.
  `}},seriesToRows:{name:"Series to rows",getHelperDocs:function(){return`
Use this transformation to combine the result from multiple time series data queries into one single result. This is helpful when using the table panel visualization.

The result from this transformation will contain three columns: Time, Metric, and Value. The Metric column is added so you easily can see from which query the metric originates from. Customize this value by defining Label on the source query.

In the example below, we have two queries returning time series data. It is visualized as two separate tables before applying the transformation.

**Query A:**

| Time                | Temperature |
| ------------------- | ----------- |
| 2020-07-07 11:34:20 | 25          |
| 2020-07-07 10:31:22 | 22          |
| 2020-07-07 09:30:05 | 19          |

**Query B:**

| Time                | Humidity |
| ------------------- | -------- |
| 2020-07-07 11:34:20 | 24       |
| 2020-07-07 10:32:20 | 29       |
| 2020-07-07 09:30:57 | 33       |

Here is the result after applying the Series to rows transformation.

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

This transformation facilitates the consolidation of results from multiple time series queries, providing a streamlined and unified dataset for efficient analysis and visualization in a tabular format.

> **Note:** This transformation is available in Grafana 7.1+.
  `}},sortBy:{name:"Sort by",getHelperDocs:function(){return`
Use this transformation to sort each frame within a query result based on a specified field, making your data easier to understand and analyze. By configuring the desired field for sorting, you can control the order in which the data is presented in the table or visualization.

Use the **Reverse** switch to inversely order the values within the specified field. This functionality is particularly useful when you want to quickly toggle between ascending and descending order to suit your analytical needs.

For example, in a scenario where time-series data is retrieved from a data source, the **Sort by** transformation can be applied to arrange the data frames based on the timestamp, either in ascending or descending order, depending on the analytical requirements. This capability ensures that you can easily navigate and interpret time-series data, gaining valuable insights from the organized and visually coherent presentation.
  `}},spatial:{name:"Spatial",getHelperDocs:function(){return`
Use this transformation to apply spatial operations to query results.

- **Action** - Select an action:
  - **Prepare spatial field** - Set a geometry field based on the results of other fields.
    - **Location mode** - Select a location mode (these options are shared by the **Calculate value** and **Transform** modes):
      - **Auto** - Automatically identify location data based on default field names.
      - **Coords** - Specify latitude and longitude fields.
      - **Geohash** - Specify a geohash field.
      - **Lookup** - Specify Gazetteer location fields.
  - **Calculate value** - Use the geometry to define a new field (heading/distance/area).
    - **Function** - Choose a mathematical operation to apply to the geometry:
      - **Heading** - Calculate the heading (direction) between two points.
      - **Area** - Calculate the area enclosed by a polygon defined by the geometry.
      - **Distance** - Calculate the distance between two points.
  - **Transform** - Apply spatial operations to the geometry.
    - **Operation** - Choose an operation to apply to the geometry:
      - **As line** - Create a single line feature with a vertex at each row.
      - **Line builder** - Create a line between two points.

This transformation allows you to manipulate and analyze geospatial data, enabling operations such as creating lines between points, calculating spatial properties, and more.
  `}},timeSeriesTable:{name:"Time series to table transform",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to convert time series results into a table, transforming a time series data frame into a **Trend** field which can then be used with the [sparkline cell type][]. If there are multiple time series queries, each will result in a separate table data frame. These can be joined using join or merge transforms to produce a single table with multiple sparklines per row.

${r("/static/img/docs/transformations/table-sparklines.png",o,"A table panel showing multiple values and their corresponding sparklines.")}

For each generated **Trend** field value, a calculation function can be selected. This value is displayed next to the sparkline and will be used for sorting table rows.

${r("/static/img/docs/transformations/timeseries-table-select-stat.png",o,"A select box showing available statistics that can be calculated.")}


> **Note:** This transformation is available in Grafana 9.5+ as an opt-in beta feature. Modify the Grafana [configuration file][] to use it.
  `},links:[{title:"sparkline cell type",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/#sparkline"},{title:"configuration file",url:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/"}]},regression:{name:"Regression analysis",getHelperDocs:function(o="shortcodeFigure"){return`
Use this transformation to create a new data frame containing values predicted by a statistical model. This is useful for finding a trend in chaotic data. It works by fitting a mathematical function to the data, using either linear or polynomial regression. The data frame can then be used in a visualization to display a trendline.

There are two different models:

- **Linear regression** - Fits a linear function to the data.
${r("/static/img/docs/transformations/linear-regression.png",o,"A time series visualization with a straight line representing the linear function")}
- **Polynomial regression** - Fits a polynomial function to the data.
${r("/static/img/docs/transformations/polynomial-regression.png",o,"A time series visualization with a curved line representing the polynomial function")}

> **Note:** This transformation is currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`regressionTransformation\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.
  `}}};function s(){return`
  Go to the <a href="https://grafana.com/docs/grafana/latest/panels/transformations/?utm_source=grafana" target="_blank" rel="noreferrer">
  transformation documentation
  </a> for more general documentation.
  `}function r(o,m,l){return m==="shortcodeFigure"?`{{< figure src="${o}" class="docs-image--no-shadow" max-width= "1100px" alt="${l}" >}}`:`![${l}](https://grafana.com${o})`}},9581:(G,I,e)=>{"use strict";e.d(I,{YD:()=>r,dy:()=>n,kD:()=>s});var t=e(52622),n=(m=>(m.Prepare="prepare",m.Calculate="calculate",m.Modify="modify",m))(n||{}),s=(m=>(m.Heading="heading",m.Distance="distance",m.Area="area",m))(s||{}),r=(m=>(m.AsLine="asLine",m.LineBuilder="lineBuilder",m))(r||{});const o={action:"prepare",source:{mode:t.aG.Auto}}},78134:(G,I,e)=>{"use strict";e.d(I,{EX:()=>d,pp:()=>c,tt:()=>i});var t=e(70915),n=e(11217),s=e(44294),r=e(22796),o=e(52490),m=e(11261),l=e(9581);function i(y){const f=[];for(const P of y.values)P&&f.push(d(P));return new n.A(f)}function u(y){const f=new Array(y.length);if(y.length>1){let P=p(y[0]);for(let a=1;a<y.length;a++){let E=p(y[a]);if(P&&E){let g=Math.atan2(E[0]-P[0],E[1]-P[1])*180/Math.PI;g<0&&(g+=360),f[a-1]=f[a]=g}}}else f.fill(0);return f}function d(y){return y instanceof s.A?y.getCoordinates():(0,t.q1)(y.getExtent())}function p(y){if(y)return(0,r.WP)(d(y))}function c(y,f){const P=y.values,a=new Array(y.values.length),E=f.calc??l.kD.Heading,g=f.field??E;switch(E){case l.kD.Area:{for(let h=0;h<P.length;h++){const D=P[h];D&&(a[h]=(0,o.UG)(D))}return{name:g,type:m.PU.number,config:{unit:"areaM2"},values:a}}case l.kD.Distance:{for(let h=0;h<P.length;h++){const D=P[h];D&&(a[h]=(0,o.R3)(D))}return{name:g,type:m.PU.number,config:{unit:"lengthm"},values:a}}case l.kD.Heading:default:return{name:g,type:m.PU.number,config:{unit:"degree"},values:u(P)}}}},88841:(G,I,e)=>{"use strict";e.d(I,{y:()=>P});var t=e(32196),n=e(34743),s=e(36376),r=e(7315),o=e(96540),m=e(40845),l=e(17464),i=e(40276),u=e(72093),d=e(10354),p=e(43538);const c=(E,g)=>E-g*Math.floor(E/g),y=8,f=(E,g)=>({suggestionsWrapper:(0,t.css)({boxShadow:E.shadows.z2}),errorTooltip:(0,t.css)({position:"absolute",top:g+y+"px",zIndex:E.zIndex.tooltip}),inputWrapper:(0,t.css)({position:"relative"})}),P=({value:E="",onChange:g,suggestions:h,placeholder:D,error:v,invalid:C})=>{const[T,S]=(0,o.useState)(!1),[O,x]=(0,o.useState)(0),[b,M]=(0,o.useState)(E.toString()),[A,R]=(0,o.useState)(0),[B,U]=(0,o.useState)(0),[W,N]=(0,o.useState)(0),w=(0,m.$j)(),L=f(w,B),V=(0,o.useRef)(),K=[(0,n.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,n.BN)()],{refs:k,floatingStyles:j}=(0,s.we)({open:T,placement:"bottom-start",onOpenChange:S,middleware:K,whileElementsMounted:r.ll,strategy:"fixed"}),H=(0,o.useCallback)(q=>{k.setReference(q),V.current=q},[k]),J=(0,o.useRef)(null);(0,o.useEffect)(()=>{R(a(J.current,O))},[O]);const X=o.useCallback((q,ee=V.current)=>{const z=ee.selectionStart,te=ee.value;te[W-1]==="$"?ee.value=te.slice(0,W)+q.value+te.slice(z):ee.value=te.slice(0,W)+"$"+q.value+te.slice(z),M(ee.value),S(!1),x(0),g(ee.value)},[g,W]),se=o.useCallback(q=>{if(!T){if(q.key==="$"||q.key===" "&&q.ctrlKey){N(V.current.selectionStart||0),S(!0);return}return}switch(q.key){case"Backspace":case"Escape":case"ArrowLeft":case"ArrowRight":return S(!1),x(0);case"Enter":return q.preventDefault(),X(h[O]);case"ArrowDown":case"ArrowUp":q.preventDefault();const ee=q.key==="ArrowDown"?1:-1;return x(z=>c(z+ee,h.length));default:return}},[T,h,O,X]),ae=o.useCallback(q=>{M(q.currentTarget.value)},[]),ne=o.useCallback(q=>{g(q.currentTarget.value)},[g]);return(0,o.useEffect)(()=>{U(V.current.clientHeight)},[]),o.createElement("div",{className:L.inputWrapper},T&&o.createElement(l.ZL,null,o.createElement("div",{ref:k.setFloating,style:j,className:L.suggestionsWrapper},o.createElement(i.E,{scrollTop:A,autoHeightMax:"300px",setScrollTop:({scrollTop:q})=>R(q)},o.createElement(p.k,{activeRef:J,suggestions:h,onSuggestionSelect:X,onClose:()=>S(!1),activeIndex:O})))),C&&v&&o.createElement("div",{className:L.errorTooltip},o.createElement(u.P,null,v)),o.createElement(d.p,{placeholder:D,invalid:C,ref:H,value:b,onChange:ae,onBlur:ne,onKeyDown:se}))};P.displayName="SuggestionsInput";function a(E,g){return(E?.clientHeight??0)*g}},94397:(G,I,e)=>{"use strict";e.d(I,{N_:()=>i,ZI:()=>o,aG:()=>m,eJ:()=>l,qt:()=>u});var t=e(96540),n=e(28240),s=e(91410),r=e(32264);function o(d){return(0,t.useMemo)(()=>Array.isArray(d)?Object.keys(d.reduce((p,c)=>!c||!Array.isArray(c.fields)?p:c.fields.reduce((y,f)=>{const P=(0,n.Ct)(f,c,d);return y[P]=!0,y},p),{})):[],[d])}function m(d){const p=new Set;for(const c of d)for(const y of c.fields)if(y.labels)for(const f of Object.keys(y.labels))p.add(f);return p}const l={combine:"Combine",calculateNewFields:"Calculate new fields",createNewVisualization:"Create new visualization",filter:"Filter",performSpatialOperations:"Perform spatial operations",reformat:"Reformat",reorderAndRename:"Reorder and rename"},i=d=>!!(typeof d=="number"||!Number.isNaN(Number(d))||/^\$[A-Za-z0-9_]+$/.test(d)&&r.$.featureToggles.transformationsVariableSupport);function u(d){const p=[];d&&(p.push({label:"Browser",value:"browser"}),p.push({label:"UTC",value:"utc"}));const c=(0,s.P3)();for(const y of c)p.push({label:y,value:y});return p}},87617:(G,I,e)=>{"use strict";e.d(I,{$u:()=>p,Ay:()=>P,Cj:()=>i,EC:()=>d,Y_:()=>l,dJ:()=>c,g4:()=>u,jE:()=>y,t_:()=>o});var t=e(65307),n=e(2913);const s={users:[],searchQuery:"",page:0,perPage:30,totalPages:1,externalUserMngInfo:n.Ay.externalUserMngInfo,externalUserMngLinkName:n.Ay.externalUserMngLinkName,externalUserMngLinkUrl:n.Ay.externalUserMngLinkUrl,isLoading:!1,rolesLoading:!1},r=(0,t.Z0)({name:"users",initialState:s,reducers:{usersLoaded:(a,E)=>{const{totalCount:g,perPage:h,page:D,orgUsers:v}=E.payload,C=Math.ceil(g/h);return{...a,isLoading:!0,users:v,perPage:h,page:D,totalPages:C}},searchQueryChanged:(a,E)=>({...a,searchQuery:E.payload,page:s.page}),setUsersSearchPage:(a,E)=>({...a,page:E.payload}),pageChanged:(a,E)=>({...a,page:E.payload}),sortChanged:(a,E)=>({...a,sort:E.payload}),usersFetchBegin:a=>({...a,isLoading:!0}),usersFetchEnd:a=>({...a,isLoading:!1}),rolesFetchBegin:a=>({...a,rolesLoading:!0}),rolesFetchEnd:a=>({...a,rolesLoading:!1})}}),{searchQueryChanged:o,setUsersSearchPage:m,usersLoaded:l,usersFetchBegin:i,usersFetchEnd:u,pageChanged:d,sortChanged:p,rolesFetchBegin:c,rolesFetchEnd:y}=r.actions,P={users:r.reducer}},20601:(G,I,e)=>{"use strict";e.d(I,{B:()=>n});var t=e(83077);const n=new t.O},26260:(G,I,e)=>{"use strict";e.d(I,{$u:()=>f,D4:()=>E,Iv:()=>g,U2:()=>a,VT:()=>P,z_:()=>y});var t=e(2543),n=e.n(t),s=e(31193),r=e(3843),o=e(24240),m=e(72401),l=e(48594),i=e(87421),u=e(56968),d=e(75096),p=e(53699);const c="Filters",y=v=>async(C,T)=>{let S=D(v,T());if(!S&&(C(h(v)),S=D(v,T()),!S))return;const O=S.filters.findIndex(b=>b.key===v.key&&b.value===v.value);if(O===-1){const{value:b,key:M,operator:A}=v,R={value:b,key:M,operator:A};return await C(a((0,d.jX)(S),R))}const x={...S.filters[O],operator:v.operator};return await C(f((0,d.jX)(S),{index:O,filter:x}))},f=(v,C)=>async(T,S)=>{const O=(0,i.dn)(v,S());T((0,l.kb)(v.rootStateKey,(0,p.E2)((0,d.qD)(O,C)))),await T((0,m.us)((0,d.jX)(O),!0))},P=(v,C)=>async(T,S)=>{const O=(0,i.dn)(v,S());T((0,l.kb)(v.rootStateKey,(0,p.D$)((0,d.qD)(O,C)))),await T((0,m.us)((0,d.jX)(O),!0))},a=(v,C)=>async(T,S)=>{const O=(0,i.dn)(v,S());T((0,l.kb)(v.rootStateKey,(0,p.xt)((0,d.qD)(O,C)))),await T((0,m.us)((0,d.jX)(O),!0))},E=(v,C)=>async(T,S)=>{const O=(0,i.dn)(v,S());T((0,l.kb)(v.rootStateKey,(0,p.qZ)((0,d.qD)(O,C)))),await T((0,m.us)((0,d.jX)(O),!0))},g=(v,C)=>async(T,S)=>{const O=(0,i.dn)(v,S());T((0,l.kb)(v.rootStateKey,(0,u.QP)((0,d.qD)(O,{propName:"datasource",propValue:C}))));const b=(await(0,s.tR)().get(C))?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.";T((0,l.kb)(v.rootStateKey,(0,r.BC)({infoText:b})))},h=v=>(C,T)=>{const S=(0,i.y7)(T()),O={...(0,t.cloneDeep)(p.MK),datasource:v.datasource,name:c,id:c,rootStateKey:S},x=!1,b=(0,i.hk)(S,T()),M={type:"adhoc",id:O.id,rootStateKey:S};C((0,l.kb)(S,(0,u.QV)((0,d.qD)(M,{global:x,model:O,index:b}))))},D=(v,C)=>{const T=(0,i.y7)(C),S=(0,i.nx)(T,C);let O;for(const x of Object.values(S.variables))if((0,o.EW)(x)&&x.datasource?.uid===v.datasource.uid){O=x;break}return O}},53699:(G,I,e)=>{"use strict";e.d(I,{AA:()=>p,D$:()=>i,E2:()=>u,MK:()=>o,qZ:()=>d,xt:()=>l});var t=e(65307),n=e(80484),s=e(87421),r=e(83370);const o={...n.Vg,type:"adhoc",datasource:null,filters:[]},m=(0,t.Z0)({name:"templating/adhoc",initialState:r.j,reducers:{filterAdded:(c,y)=>{const f=(0,s.Fs)(c,y.payload.id);f.type==="adhoc"&&f.filters.push(y.payload.data)},filterRemoved:(c,y)=>{const f=(0,s.Fs)(c,y.payload.id);if(f.type!=="adhoc")return;const P=y.payload.data;f.filters.splice(P,1)},filterUpdated:(c,y)=>{const f=(0,s.Fs)(c,y.payload.id);if(f.type!=="adhoc")return;const{filter:P,index:a}=y.payload.data;f.filters[a]=P},filtersRestored:(c,y)=>{const f=(0,s.Fs)(c,y.payload.id);f.type==="adhoc"&&(f.filters=y.payload.data)}}}),{filterAdded:l,filterRemoved:i,filterUpdated:u,filtersRestored:d}=m.actions,p=m.reducer},13344:(G,I,e)=>{"use strict";e.d(I,{Ek:()=>o,To:()=>s,Zm:()=>n,ou:()=>r,qF:()=>t,qz:()=>m});const t="00000000-0000-0000-0000-000000000000",n="All",s="$__all",r="None",o="",m="var-"},35589:(G,I,e)=>{"use strict";e.d(I,{c:()=>l,z:()=>i});var t=e(92145),n=e(96540),s=e(13544),r=e(40845),o=e(21744),m=e(85140);const l="Grafana-LegacyVariableQueryEditor",i=({onChange:u,query:d})=>{const p=(0,r.of)(m.$),[c,y]=(0,n.useState)(d),f=E=>{y(E.currentTarget.value)},P=(0,n.useCallback)(E=>{u(E.currentTarget.value,E.currentTarget.value)},[u]),a=(0,t.Bi)();return n.createElement(o.f,{id:a,rows:2,value:c,onChange:f,onBlur:P,placeholder:"Metric name or tags query",required:!0,"data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsQueryInput,cols:52,className:p.textarea})};i.displayName=l},70766:(G,I,e)=>{"use strict";e.d(I,{y:()=>m});var t=e(96540),n=e(72574),s=e(54427),r=e(24240),o=e(35589);async function m(i,u=s.cS){if((0,r.zs)(i))return i.variables.editor;if((0,r.X3)(i)){const d=await u(i.meta);if(!d.components.QueryEditor)throw new Error("Missing QueryEditor in plugin definition.");return d.components.QueryEditor??null}return(0,r.Hf)(i)?l:(0,r.d5)(i)?(await u(i.meta)).components.VariableQueryEditor??o.z:null}function l({datasource:i,query:u,onChange:d}){const p=(0,t.useCallback)(c=>{d({refId:"StandardVariableQuery",query:c})},[d]);return t.createElement(o.z,{query:u.query,onChange:p,datasource:i,templateSrv:(0,n.w)()})}},3843:(G,I,e)=>{"use strict";e.d(I,{BC:()=>u,DW:()=>m,Eo:()=>p,FN:()=>o,NY:()=>d,T7:()=>i,nS:()=>n,sJ:()=>l,wf:()=>r,y8:()=>c});var t=e(65307);const n={id:"",isValid:!0,errors:{},name:"",extended:null},s=(0,t.Z0)({name:"templating/editor",initialState:n,reducers:{variableEditorMounted:(y,f)=>{y.name=f.payload.name,y.id=f.payload.id},variableEditorUnMounted:(y,f)=>n,changeVariableNameSucceeded:(y,f)=>{y.name=f.payload.data.newName,delete y.errors.name,y.isValid=Object.keys(y.errors).length===0},changeVariableNameFailed:(y,f)=>{y.name=f.payload.newName,y.errors.name=f.payload.errorText,y.isValid=Object.keys(y.errors).length===0},addVariableEditorError:(y,f)=>{y.errors[f.payload.errorProp]=f.payload.errorText,y.isValid=Object.keys(y.errors).length===0},removeVariableEditorError:(y,f)=>{delete y.errors[f.payload.errorProp],y.isValid=Object.keys(y.errors).length===0},changeVariableEditorExtended:(y,f)=>{y.extended={...y.extended,...f.payload}},cleanEditorState:()=>n}}),r=s.reducer,{changeVariableNameSucceeded:o,changeVariableNameFailed:m,variableEditorMounted:l,variableEditorUnMounted:i,changeVariableEditorExtended:u,addVariableEditorError:d,removeVariableEditorError:p,cleanEditorState:c}=s.actions},85830:(G,I,e)=>{"use strict";e.d(I,{M:()=>t});var t=(n=>(n[n.MaxSize=50]="MaxSize",n))(t||{})},25304:(G,I,e)=>{"use strict";e.d(I,{z:()=>r});var t=e(72574),n=e(20601),s=e(13344);function r(o){const m={},l=(0,t.w)().getVariables();for(let i=0;i<l.length;i++){const u=l[i],d=o&&o[u.name];u.skipUrlSync||(d?m[s.qz+u.name]=d.value:m[s.qz+u.name]=n.B.get(u.type).getValueForUrl(u))}return m}},24240:(G,I,e)=>{"use strict";e.d(I,{CH:()=>P,EW:()=>r,Hf:()=>p,P4:()=>s,SP:()=>l,VN:()=>f,VO:()=>o,X3:()=>y,d5:()=>d,iv:()=>m,m8:()=>i,zs:()=>c});var t=e(29505),n=e(35589);const s=a=>a.type==="query",r=a=>a.type==="adhoc",o=a=>a.type==="constant",m=a=>"multi"in a,l=a=>"options"in a,i=a=>"current"in a;function u(a){return a===null?!1:typeof a=="string"}const d=a=>!!a.metricFindQuery&&!a.variables,p=a=>{if(!a.variables||a.variables.getType()!==t.Qz.Standard)return!1;const E=a.variables;return"toDataQuery"in E&&!!E.toDataQuery},c=a=>{if(!a.variables||a.variables.getType()!==t.Qz.Custom)return!1;const E=a.variables;return"query"in E&&"editor"in E&&!!E.query&&!!E.editor},y=a=>a.variables?a.variables.getType()===t.Qz.Datasource:!1;function f(a,E){return a?a.displayName===n.c||d(E):!1}function P(a,E){return a?a.displayName!==n.c&&(y(E)||p(E)||c(E)):!1}},27238:(G,I,e)=>{"use strict";e.d(I,{WT:()=>n,bX:()=>o,t4:()=>r});var t=e(65307);const n={usages:[],usagesNetwork:[]},s=(0,t.Z0)({name:"templating/inspect",initialState:n,reducers:{initInspect:(m,l)=>{const{usages:i,usagesNetwork:u}=l.payload;m.usages=i,m.usagesNetwork=u}}}),r=s.reducer,{initInspect:o}=s.actions},12846:(G,I,e)=>{"use strict";e.d(I,{qJ:()=>p,hI:()=>u,hM:()=>a,H7:()=>d,xU:()=>h,P5:()=>x,g0:()=>E,PK:()=>S,Ow:()=>C});var t=e(6709);function n(b,M){const A=new Set;for(const R of b)A.add(M(R));return A}var s=e(84423),r=e(87490),o=e(34214),m=e(20601),l=e(24240),i=e(75096);const u=b=>{const M=[];for(const A of b)M.push({id:A.id,label:`${A.id}`});return M},d=(b,M)=>b.filter(A=>M.some(R=>R.from===A.id||R.to===A.id)),p=b=>{const M=[];for(const A of b)for(const R of b){if(A===R)continue;m.B.get(A.type).dependsOn(A,R)&&M.push({from:A.id,to:R.id})}return M};function c(b){const M=(0,i.t4)(b);if(!M)return;const A=M.slice(1).find(R=>R!==void 0);if(!(A in{}))return A}const y=(b,M)=>{i.SY.lastIndex=0;const A=[],B=(0,r.MA)(M,2).match(i.SY);if(!B)return A;for(const U of B){if(!U||U.indexOf("$__")!==-1||U.indexOf("${__")!==-1||U.indexOf("$hashKey")!==-1)continue;const W=c(U);b.some(N=>N.id===W)||A.find(N=>N===W)||W&&A.push(W)}return A},f={alias:[/^m$/,/^measurement$/,/^col$/,/^tag_(\w+|\d+)$/],query:[/^timeFilter$/]},P=(b,M,A)=>{const R=Object.keys(M.value).reduce((U,W)=>{const N=M.value[W];if(!N||typeof N!="string")return U;const w=f[W]?f[W].find(V=>V.test(b)):void 0;let L=(0,i.wJ)(N,b);return W==="repeat"&&N===b&&(L=!0),!w&&L&&(U={...U,[W]:N}),U},{}),B=Object.keys(M.value).reduce((U,W)=>{const N=M.value[W];if(N&&typeof N=="object"&&Object.keys(N).length){let w=N.title||N.name||N.id||W;Array.isArray(M.value)&&M.key==="panels"&&(w=`${w}[${N.id}]`);const L=P(b,{key:W,value:N},{});Object.keys(L).length&&(U={...U,[w]:L})}return U},{});return(Object.keys(R).length||Object.keys(B).length)&&(A={...A,...R,...B}),A},a=(b,M)=>{if(!M)return{unUsed:[],usages:[]};const A=[];let R=[];const B=M.getSaveModelCloneOld();for(const U of b){const W=U.id,N=P(W,{key:"model",value:B},{});!Object.keys(N).length&&!(0,l.EW)(U)&&A.push(U),Object.keys(N).length&&R.push({variable:U,tree:N})}return{unUsed:A,usages:R}};async function E(b,M){return new Promise((A,R)=>{setTimeout(()=>{try{const B=g(b,M);A(C(B))}catch(B){R(B)}},200)})}function g(b,M){if(!M)return[];let A=[];const R=M.getSaveModelCloneOld(),B=y(b,R);for(const U of B){const W=P(U,{key:"model",value:R},{});if(Object.keys(W).length){const N={id:U,name:U};A.push({variable:N,tree:W})}}return A}function h(b,M,A){const R=n(M.descendants(b),U=>U.name);R.add(t.c.includeVars);for(const U of b)R.add(U);return D([...R],A)}function D(b,M){const A=[];for(const R of b)M[R]&&A.push(...M[R]);return new Set(A)}const v=(b,M)=>{const{id:A,value:R}=M,{nodes:B,edges:U}=b;if(R&&typeof R=="string"){const W=`${M.id}-${R}`;return B.push({id:W,label:R}),U.push({from:W,to:A}),b}if(R&&typeof R=="object"){const W=Object.keys(R);for(const N of W){const w=`${M.id}-${N}`;B.push({id:w,label:N}),U.push({from:w,to:A}),b=v(b,{id:w,value:R[N]})}return b}return b},C=b=>{const M=[];for(const A of b){const{variable:R,tree:B}=A,U={variable:R,nodes:[{id:"dashboard",label:"dashboard"}],edges:[],showGraph:!1};M.push(v(U,{id:"dashboard",value:B}))}return M},T=b=>Object.values(b).reduce((A,R)=>typeof R=="object"?A+T(R):A+1,0),S=(b,M)=>{const A=M.find(R=>R.variable.id===b);return A?T(A.tree):0};function O(b){const M=[];for(const A of b)M.push(A),A.panels?.length&&M.push(...O(A.panels.map(R=>new PanelModel(R))));return M}function x(b){const M={};for(const A of b){const R=(0,s.tw)(A),B=[...R.matchAll(/"repeat":"([^"]+)"/g)].map(N=>N[1]),U=R.match(i.SY)?.map(N=>c(N))??[],W=[...B,...U];for(const N of W)N in M?M[N].add(A.id):M[N]=new Set([A.id])}return M}},81515:(G,I,e)=>{"use strict";e.d(I,{E5:()=>d,Ez:()=>i,mn:()=>p});var t=e(65307),n=e(2543),s=e.n(n),r=e(12470),o=e(87421),m=e(83370),l=e(80484);const i={...l.Vg,type:"interval",auto_count:30,auto_min:"10s",options:[],auto:!1,query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",refresh:r.CO.onTimeRangeChanged,current:{}},u=(0,t.Z0)({name:"templating/interval",initialState:m.j,reducers:{createIntervalOptions:(c,y)=>{const f=(0,o.Fs)(c,y.payload.id);if(f.type!=="interval")return;const P=(0,n.map)(f.query.match(/(["'])(.*?)\1|\w+/g),a=>(a=a.replace(/["']+/g,""),{text:a.trim(),value:a.trim(),selected:!1}));f.auto&&P.length&&P[0].text!=="auto"&&P.unshift({text:"auto",value:"$__auto_interval_"+f.name,selected:!1}),f.options=P}}}),d=u.reducer,{createIntervalOptions:p}=u.actions},24300:(G,I,e)=>{"use strict";e.d(I,{jR:()=>x,Fu:()=>D,$z:()=>i,O$:()=>v,ho:()=>b,MO:()=>h,an:()=>C,U9:()=>g,fx:()=>S,qh:()=>O,S8:()=>T});var t=e(53076),n=e(65307),s=e(2543),r=e(92053);const o=(M,...A)=>A.reduce((R,B)=>B(R),M);var m=e(13344),l=e(24240);const i={id:"",highlightIndex:-1,queryValue:"",selectedValues:[],options:[],multi:!1},u=1e3,d=new t.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),p=M=>Array.isArray(M)?M.reduce((A,R)=>((0,s.isString)(R.value)&&(A[R.value]=R),A),{}):{},c=M=>{if(!Array.isArray(M.options))return M.options=[],M;const A=p(M.selectedValues);return M.selectedValues=Object.values(A),M.options=M.options.map(R=>{if(!(0,s.isString)(R.value))return R;const B=!!A[R.value];return R.selected===B?R:{...R,selected:B}}),M.options=y(M.options),M},y=M=>Array.isArray(M)?M.length<=u?M:M.slice(0,u):[],f=M=>{const{options:A,selectedValues:R}=M;return A.length===0||R.length>0||!A[0]||A[0].value!==m.To||(M.selectedValues=[{...A[0],selected:!0}]),M},P=M=>{const{selectedValues:A}=M;return A.length>1&&(M.selectedValues=A.filter(R=>R.value!==m.To)),M},a=M=>M.filter(A=>A.value!==m.To).map(A=>({...A,selected:!0})),E=(0,n.Z0)({name:"templating/optionsPicker",initialState:i,reducers:{showOptions:(M,A)=>{const{query:R,options:B}=A.payload;if(M.highlightIndex=-1,M.options=(0,s.cloneDeep)(B),M.id=A.payload.id,M.queryValue="",M.multi=!1,(0,l.iv)(A.payload)&&(M.multi=A.payload.multi??!1),(0,l.P4)(A.payload)){const{queryValue:U}=A.payload,W=(0,r.E)(R);M.queryValue=W&&U?U:""}return M.selectedValues=M.options.filter(U=>U.selected),o(M,f,c)},hideOptions:(M,A)=>({...i}),toggleOption:(M,A)=>{const{option:R,clearOthers:B,forceSelect:U}=A.payload,{multi:W,selectedValues:N}=M;if(R){const w=!N.find(L=>L.value===R.value&&L.text===R.text);if(R.value===m.To||!W||B)return w||U?M.selectedValues=[{...R,selected:!0}]:M.selectedValues=[],o(M,f,P,c);if(U||w)return M.selectedValues.push({...R,selected:!0}),o(M,f,P,c);M.selectedValues=N.filter(L=>L.value!==R.value&&L.text!==R.text)}else M.selectedValues=[];return o(M,f,P,c)},moveOptionsHighlight:(M,A)=>{let R=M.highlightIndex+A.payload;return R<0?R=-1:R>=M.options.length&&(R=M.options.length-1),{...M,highlightIndex:R}},toggleAllOptions:(M,A)=>{const R=M.selectedValues.find(U=>U.value===m.To),B=M.options.find(U=>U.value===m.To);return M.selectedValues.length>0&&B&&!R?(M.selectedValues=[],M.selectedValues.push({text:B.text??"All",value:B.value,selected:!0}),o(M,c)):R&&M.selectedValues.length===1?(M.selectedValues=a(M.options),o(M,c)):M.selectedValues.length>0&&!B?(M.selectedValues=[],o(M,c)):(M.selectedValues=a(M.options),o(M,c))},updateSearchQuery:(M,A)=>(M.queryValue=A.payload,M),updateOptionsAndFilter:(M,A)=>{const R=M.queryValue.trim();let B=[];if(R==="")B=A.payload;else{const U=A.payload.map(({text:L})=>Array.isArray(L)?L.toString():L),[W,N,w]=d.search(U,R,5);W?.length&&(N&&w?B=w.map(L=>A.payload[N.idx[L]]):B=W.map(L=>A.payload[L]),B.sort((L,V)=>(L.value===m.To?-1:0)-(V.value===m.To?-1:0)))}if(M.highlightIndex=0,R!==""){let U=B.findIndex(W=>W.value!==m.To);(U===-1||B[U].value!==R)&&(B.unshift({selected:!1,text:"> "+R,value:R}),M.highlightIndex=U===-1?0:U+1)}return M.options=B,o(M,f,c)},updateOptionsFromSearch:(M,A)=>(M.options=A.payload,M.highlightIndex=0,o(M,f,c)),cleanPickerState:()=>i}}),{toggleOption:g,showOptions:h,hideOptions:D,moveOptionsHighlight:v,toggleAllOptions:C,updateSearchQuery:T,updateOptionsAndFilter:S,updateOptionsFromSearch:O,cleanPickerState:x}=E.actions,b=E.reducer},86886:(G,I,e)=>{"use strict";e.d(I,{C:()=>t});const t=(r,o)=>r&&(o&&!Array.isArray(r.value)?{...r,value:s(r.value),text:s(r.text)}:!o&&Array.isArray(r.value)?{...r,value:n(r.value),text:n(r.text)}:r),n=r=>Array.isArray(r)?r.length>0?r[0]:"":r,s=r=>Array.isArray(r)?r:[r]},72401:(G,I,e)=>{"use strict";e.d(I,{Y7:()=>$e,TI:()=>ae,_q:()=>Fe,RK:()=>Oe,t9:()=>Te,x7:()=>ce,Hn:()=>Ue,mZ:()=>Xe,kl:()=>fe,us:()=>de});var t=e(2543),n=e(12470),s=e(92041),r=e(39070),o=e(22391),m=e(12131),l=e(32264),i=e(82467),u=e(16233),d=e(74856),p=e(99140),c=e(3169),y=e(10096),f=e(27677),P=e(34525),a=e(31193),E=e(23989),g=e(20601),h=e(13344),D=e(3843),v=e(24240),C=e(12846),T=e(24300),S=e(86886),O=e(80484),x=e(75096),b=e(73134),M=e(28601),A=e(48594),R=e(84014);const B=(Ae,re=-1,Z=!1,oe=!1)=>{const Ee={};if(oe){const ye={...initialVariableModelState,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"A dashboard title",uid:"An dashboard UID",toString:()=>"A dashboard title"}}},Se={...initialVariableModelState,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"An org name",id:1,toString:()=>"1"}}},Be={...initialVariableModelState,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{login:"admin",id:1,email:"admin@test",toString:()=>"1"}}};Ee[ye.id]=ye,Ee[Se.id]=Se,Ee[Be.id]=Be}for(let ye=0;ye<Ae;ye++)Ee[ye]=createQueryVariable({id:ye.toString(),name:`Name-${ye}`,label:`Label-${ye}`,index:ye});return Z&&(Ee[NEW_VARIABLE_ID]=createQueryVariable({id:NEW_VARIABLE_ID,name:`Name-${NEW_VARIABLE_ID}`,label:`Label-${NEW_VARIABLE_ID}`,index:Ae})),Ee},U=(Ae,re={})=>{const Z={id:"0",rootStateKey:"key",index:0,name:"0"};return{initialState:{0:{...{...Ae.initialState,...Z},...re}}}},W=()=>combineReducers({dashboard:dashboardReducer,templating:keyedVariablesReducer}),N=()=>combineReducers({templating:keyedVariablesReducer});function w(Ae,re){return{templating:{lastKey:Ae,keys:{[Ae]:{...getInitialTemplatingState(),...re}}}}}function L(Ae,re){return Ae.find(oe=>oe.name===re)}function V(Ae){return(Ae.type==="query"||Ae.type==="datasource"||Ae.type==="interval")&&Ae.refresh===b.CO.onTimeRangeChanged}var K=e(87421),k=e(56968),j=e(85675),H=e(15120);const J=(Ae,re)=>(Z,oe)=>{let Ee=0;const ye=re.templating.list;for(let Be=0;Be<ye.length;Be++){const We=X(ye[Be]);We.rootStateKey=Ae,g.B.getIfExists(We.type)&&Z((0,A.kb)(Ae,(0,k.QV)((0,x.qD)(We,{global:!1,index:Ee++,model:We}))))}(0,E.w)().updateTimeRange((0,d.jG)().timeRange());const Se=(0,K.SS)(Ae,oe());for(const Be of Se)Z((0,A.kb)(Ae,(0,k.wB)((0,x.qD)(Be))))};function X(Ae){if(!(0,v.SP)(Ae))return Ae;let re=!1;for(const Z of Ae.options)if(Z.selected=!1,Array.isArray(Ae.current.value))for(const oe of Ae.current.value)Z.value===oe&&(Z.selected=re=!0);else Z.value===Ae.current.value&&(Z.selected=re=!0);return!re&&Ae.options.length&&(Ae.options[0].selected=!0),Ae}const se=(Ae,re)=>Z=>{const oe={...O.Vg,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{name:re.title,uid:re.uid,toString:()=>re.title}}};Z((0,A.kb)(Ae,(0,k.QV)((0,x.qD)(oe,{global:oe.global,index:oe.index,model:oe}))));const Ee={...O.Vg,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{name:u.TP.user.orgName,id:u.TP.user.orgId,toString:()=>u.TP.user.orgId.toString()}}};Z((0,A.kb)(Ae,(0,k.QV)((0,x.qD)(Ee,{global:Ee.global,index:Ee.index,model:Ee}))));const ye={...O.Vg,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{login:u.TP.user.login,id:u.TP.user.id,email:u.TP.user.email,toString:()=>u.TP.user.id.toString()}}};Z((0,A.kb)(Ae,(0,k.QV)((0,x.qD)(ye,{global:ye.global,index:ye.index,model:ye}))))},ae=(Ae,re)=>(Z,oe)=>{const{rootStateKey:Ee}=Ae,ye=(0,K.dn)(Ae,oe());if(!(0,v.iv)(ye)||(0,s.R)(ye.current))return;const Se=(0,S.C)(ye.current,re);Z((0,A.kb)(Ee,(0,k.QP)((0,x.qD)(Ae,{propName:"multi",propValue:re})))),Z((0,A.kb)(Ee,(0,k.QP)((0,x.qD)(Ae,{propName:"current",propValue:Se}))))},ne=async(Ae,re)=>{if(!Ae.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${Ae.id}`);if(q(Ae,re))throw new Error("Circular dependency in dashboard variables detected. Dashboard may not work as expected.");const Z=ee(Ae,re);z(Ae.rootStateKey,Z,re)&&await new Promise(oe=>{const Ee=p.M_.subscribe(()=>{if(!Ae.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${Ae.id}`);z(Ae.rootStateKey,Z,p.M_.getState())||(Ee(),oe())})})},q=(Ae,re,Z=new Set)=>Z.has(Ae.id)?!0:(Z=new Set([...Z,Ae.id]),ee(Ae,re).some(oe=>q(oe,re,Z))),ee=(Ae,re)=>{if(!Ae.rootStateKey)return[];const Z=[];for(const oe of(0,K.SS)(Ae.rootStateKey,re))Ae!==oe&&g.B.getIfExists(Ae.type)&&g.B.get(Ae.type).dependsOn(Ae,oe)&&Z.push(oe);return Z},z=(Ae,re,Z)=>{if(re.length===0)return!1;const oe=(0,K.SS)(Ae,Z);return re.filter(ye=>oe.some(Se=>Se.id===ye.id&&(Se.state===r.Gu.NotStarted||Se.state===r.Gu.Loading))).length>0},te=(Ae,re)=>async(Z,oe)=>{const Ee=(0,K.dn)(Ae,oe());await ne(Ee,oe());const ye=re[h.qz+Ee.name];if(ye!==void 0){const Se=(0,x.QT)(ye);await g.B.get(Ee.type).setValueFromUrl(Ee,Se);return}if(Ee.hasOwnProperty("refresh")){const Se=Ee;if(Se.refresh===n.CO.onDashboardLoad||Se.refresh===n.CO.onTimeRangeChanged){await Z(Xe((0,x.jX)(Se)));return}}if(Ee.type==="custom"){await Z(Xe((0,x.jX)(Ee)));return}Z(Dt(Ae))},ie=Ae=>async(re,Z)=>{const oe=m.Ny.getSearchObject(),Ee=(0,K.SS)(Ae,Z()).map(async ye=>await re(te((0,x.jX)(ye),oe)));await Promise.all(Ee)},ce=(Ae,re)=>async(Z,oe)=>{const Ee=(0,x.QT)(re),ye=(0,K.dn)(Ae,oe());(0,x.q$)(ye)!==n.CO.never&&await Z(Xe((0,x.jX)(ye)));const Se=(0,K.dn)((0,x.jX)(ye),oe());if(!(0,v.SP)(Se))return;if(!Se)throw new Error(`Couldn't find variable with name: ${ye.name}`);let Be=Se.options.find(We=>We.text===Ee||We.value===Ee);if(!Be&&(0,v.iv)(Se)&&Se.allValue&&Ee===Se.allValue&&(Be={text:h.Zm,value:h.To,selected:!1}),!Be){let We=Ee;const Ke=Ee;Array.isArray(Ee)&&(We=Ee.reduce((it,rt)=>{const ft=Se.options.find(pt=>pt.value===rt);return ft?[].concat(it,[ft.text]):[].concat(it,[rt])},[])),Be={text:We,value:Ke,selected:!1}}(0,v.iv)(Se)&&(Be=(0,S.C)({text:(0,t.castArray)(Be.text),value:(0,t.castArray)(Be.value),selected:!1},Se.multi)),await g.B.get(ye.type).setValue(Se,Be)},ue=Ae=>{let re,Z,oe,Ee;const ye=[];for(re=0;re<Ae.options.length;re++)if(Ee={...Ae.options[re]},Ee.selected=!1,Array.isArray(Ae.current.value))for(Z=0;Z<Ae.current.value.length;Z++)oe=Ae.current.value[Z],Ee.value===oe&&(Ee.selected=!0,ye.push(Ee));else Ee.value===Ae.current.value&&(Ee.selected=!0,ye.push(Ee));return ye},fe=(Ae,re)=>(Z,oe)=>{const Ee=(0,K.dn)(Ae,oe());if(!(0,v.SP)(Ee))return Promise.resolve();const ye=Ee.current||{},Se=g.B.get(Ee.type).setValue;if(Array.isArray(ye.value)){const it=ue(Ee);if(it.length===0){const ft=Ee.options[0];return Se(Ee,{value:typeof ft.value=="string"?[ft.value]:ft.value,text:typeof ft.text=="string"?[ft.text]:ft.text,selected:!0})}const rt={value:it.map(ft=>ft.value),text:it.map(ft=>ft.text),selected:!0};return Se(Ee,rt)}let Be=null;const We=(0,x.Nz)(Ee),Ke=(0,x.Lz)(Ee);if(Be=Ee.options?.find(it=>it.text===We||it.value===Ke),Be||re&&(Be=Ee.options?.find(it=>it.text===re||it.value===re),Be))return Se(Ee,Be);if(Ee.options){const it=Ee.options[0];if(it)return Se(Ee,it)}return Promise.resolve()},Te=(Ae,re,Z)=>async oe=>{const{rootStateKey:Ee}=Ae;return oe((0,A.kb)(Ee,(0,k.dE)((0,x.qD)(Ae,{option:re})))),await oe(de(Ae,Z))},he=Ae=>{const re=new P.TS;return Ae.forEach(Z=>{re.createNode(Z.name)}),Ae.forEach(Z=>{Ae.forEach(oe=>{Z!==oe&&g.B.get(Z.type).dependsOn(Z,oe)&&re.link(Z.name,oe.name)})}),re},de=(Ae,re,Z=y.lE)=>async(oe,Ee)=>{const ye=Ee(),{rootStateKey:Se}=Ae,Be=(0,K.dn)(Ae,ye);if((0,K.nx)(Se,ye).transaction.status===O.x8.Fetching)return(0,x.q$)(Be)===n.CO.never&&(await oe(nt((0,x.jX)(Be))),oe(Dt(Ae))),Promise.resolve();const We=(0,K.SS)(Se,ye),Ke=he(We),it=ye.dashboard?.getModel()?.panels??[],rt=(0,C.P5)(it),ft=Be.type==="adhoc"?{refreshAll:!0,panelIds:[]}:{refreshAll:!1,panelIds:Array.from((0,C.xU)([Be.id],Ke,rt)),variable:(0,K.dn)(Ae,ye)},pt=Ke.getNode(Be.name);let Ge=[];return pt&&(Ge=pt.getOptimizedInputEdges().map(qe=>{const bt=We.find(Ft=>Ft.name===qe.inputNode?.name);return bt?oe(Xe((0,x.jX)(bt))):Promise.resolve()})),Promise.all(Ge).then(()=>{re&&(Z.publish(new O.og(ft)),m.Ny.partial(Re(Se,Ee)))})},le=(Ae,re,Z,oe)=>(re.includes(Ae.name)||re.push(Ae.name),Ae.outputEdges.forEach(Ee=>{const ye=Ee.outputNode;if(ye&&!re.includes(ye.name)){const Se=Z.find(Be=>Be.name===ye.name);Se&&Se.refresh===n.CO.onTimeRangeChanged&&oe.indexOf(Se)===-1?(oe.push(Se),re.push(ye.name)):le(ye,re,Z,oe)}}),oe),pe=(Ae,re)=>Ae.outputEdges.every(Z=>{const oe=Z.outputNode;if(oe){const Ee=L(re,oe.name);if(Ee&&Ee.type==="query")return Ee.refresh!==n.CO.onTimeRangeChanged}return!0}),ve=(Ae,re)=>{const Z=(0,K.SS)(Ae,re),oe=he(Z),Ee=[],ye=[];return Z.forEach(Se=>{const Be=oe.getNode(Se.name);if(!Ee.includes(Se.name)&&Be){const We=L(Z,Be.name);if(!We)return;const Ke=V(We);Ke&&Be.outputEdges.length===0&&ye.push(We),Ke&&ye.includes(We)&&Be.outputEdges.length>0&&(ye.push(We),le(Be,Ee,Z,ye)),Ke&&Be.outputEdges.length>0&&pe(Be,Z)&&(ye.includes(We)||ye.push(We)),!Ke&&Be.outputEdges.length>0&&le(Be,Ee,Z,ye)}}),ye},be=(Ae,re)=>(0,K.SS)(Ae,re).filter(Ee=>"refresh"in Ee&&"options"in Ee?Ee.refresh===n.CO.onTimeRangeChanged:!1),Oe=(Ae,re,Z={templateSrv:(0,E.w)(),events:y.lE})=>async(oe,Ee)=>{Z.templateSrv.updateTimeRange(re);let ye=[];l.$.featureToggles.refactorVariablesTimeRange?ye=ve(Ae,Ee()):ye=be(Ae,Ee());const Se=ye.map(We=>We.id),Be=ye.map(We=>oe(Me((0,x.jX)(We))));try{await Promise.all(Be),Z.events.publish(new O.BS({variableIds:Se}))}catch(We){console.error(We),oe((0,i.dx)(gt("Template variable service failed",We)))}},Me=Ae=>async(re,Z)=>{const oe=(0,K.dn)(Ae,Z());if(!(0,v.SP)(oe))return;const Ee=oe.options.slice();await re(Xe((0,x.jX)(oe),!0));const ye=(0,K.dn)(Ae,Z());if(!(0,v.SP)(ye))return;const Se=ye.options;JSON.stringify(Ee)!==JSON.stringify(Se)&&Z().dashboard.getModel()?.templateVariableValueUpdated()},Ue=(Ae,re,Z=y.lE)=>async(oe,Ee)=>{const ye=[],Se=Ee().dashboard.getModel(),Be=(0,K.SS)(Ae,Ee());for(const ft of Be){const pt=h.qz+ft.name;if(!re.hasOwnProperty(pt)||!we(ft,re[pt].value))continue;let Ge=re[pt].value;if(re[pt].removed){const bt=Se?.templating.list.find(Ft=>Ft.name===ft.name);bt&&(0,v.m8)(bt)&&(Ge=bt.current.value),bt&&bt.type==="constant"&&(Ge=bt.query)}const qe=g.B.get(ft.type).setValueFromUrl(ft,Ge);ye.push(qe)}const We=Be.filter(ft=>{const pt=h.qz+ft.name;return re.hasOwnProperty(pt)&&we(ft,re[pt].value)&&ft.type!=="adhoc"}),Ke=he(Be),it=(0,C.P5)(Se?.panels??[]),rt=(0,C.xU)(We.map(ft=>ft.id),Ke,it);ye.length&&(await Promise.all(ye),Z.publish(new O.eF({refreshAll:rt.size===0,panelIds:Array.from(rt)})))};function we(Ae,re){const Z=g.B.get(Ae.type).getValueForUrl(Ae);let oe=(0,x.QT)(re);return Array.isArray(Z)&&!Array.isArray(oe)&&(oe=[oe]),!(0,t.isEqual)(Z,oe)}const Re=(Ae,re)=>{const Z=m.Ny.getSearchObject(),oe=Object.keys(Z).filter(Ee=>Ee.indexOf(h.qz)===-1).reduce((Ee,ye)=>(Ee[ye]=Z[ye],Ee),{});for(const Ee of(0,K.SS)(Ae,re())){if(Ee.skipUrlSync)continue;const ye=g.B.get(Ee.type);oe[h.qz+Ee.name]=ye.getValueForUrl(Ee)}return oe},Fe=(Ae,re)=>async(Z,oe)=>{try{const Ee=(0,x.q4)(Ae),ye=oe(),Se=(0,K.Tk)(ye);Se&&(0,K.nx)(Se,ye).transaction.status===O.x8.Fetching&&Z($e(Se)),Z((0,A.kb)(Ee,(0,j.kH)({uid:Ee}))),Z(se(Ee,re)),Z(J(Ee,re)),Z(xe(Ee)),await Z(ie(Ee)),Z((0,A.kb)(Ee,(0,j.$O)({uid:Ee})))}catch(Ee){Z((0,i.dx)(gt("Templating init failed",Ee))),console.error(Ee)}};function xe(Ae,re=a.tR){return(Z,oe)=>{const Ee=(0,K.SS)(Ae,oe());for(const ye of Ee){if(ye.type!=="adhoc"&&ye.type!=="query")continue;const{datasource:Se}=ye;if((0,o.fN)(Se))continue;const Be=re().getInstanceSettings(Se),We=Be?(0,o.p$)(Be):{uid:Se};Z((0,A.kb)(Ae,(0,k.QP)((0,x.qD)(ye,{propName:"datasource",propValue:We}))))}}}const Ve=Ae=>re=>{re((0,A.kb)(Ae,(0,H.v)())),re((0,A.kb)(Ae,(0,D.y8)())),re((0,A.kb)(Ae,(0,T.jR)())),re((0,A.kb)(Ae,(0,j.pu)()))},$e=(Ae,re={getBackendSrv:f.AI})=>Z=>{re.getBackendSrv().cancelAllInFlightRequests(),Z(Ve(Ae))},Xe=(Ae,re=!1)=>async(Z,oe)=>{const{rootStateKey:Ee}=Ae;try{if(!(0,x.sN)(Ee,oe()))return;const ye=(0,K.dn)(Ae,oe());Z((0,A.kb)(Ee,(0,k.a7)((0,x.qD)(ye)))),await Z(nt((0,x.jX)(ye))),await g.B.get(ye.type).updateOptions(ye),Z(Dt(Ae))}catch(ye){if(Z((0,A.kb)(Ee,(0,k.Te)((0,x.qD)(Ae,{error:ye})))),re||(console.error(ye),Z((0,i.dx)(gt("Error updating options:",ye,Ae)))),re)throw ye}},gt=(Ae,re,Z)=>(0,c.gi)(`${Z?`Templating [${Z.id}]`:"Templating"}`,re instanceof Error?`${Ae} ${re.message}`:`${Ae}`),Dt=Ae=>(re,Z)=>{const{rootStateKey:oe}=Ae;if(!(0,x.sN)(oe,Z()))return;const Ee=(0,K.dn)(Ae,Z());Ee.state!==r.Gu.Done&&re((0,A.kb)(Ae.rootStateKey,(0,k.Pu)((0,x.qD)(Ee))))};function nt(Ae,re=a.tR){return async function(Z,oe){const{id:Ee,rootStateKey:ye}=Ae;if(!(0,x.sN)(ye,oe()))return;const Se=(0,K.dn)(Ae,oe());if(Se.type==="query")try{const Be=await re().get(Se.datasource??"");if((0,v.d5)(Be)||!(0,v.Hf)(Be)||at(Se.query))return;const We={refId:`${Be.name}-${Ee}-Variable-Query`,query:Se.query};Z((0,A.kb)(ye,(0,k.QP)((0,x.qD)(Ae,{propName:"query",propValue:We}))))}catch(Be){Z((0,i.dx)(gt("Failed to upgrade legacy queries",Be))),console.error(Be)}}}function at(Ae){return(0,r.Gv)(Ae)&&"refId"in Ae&&typeof Ae.refId=="string"}},48594:(G,I,e)=>{"use strict";e.d(I,{Ay:()=>u,L1:()=>r,kb:()=>m});var t=e(75096),n=e(84014),s=e(85675);const r={keys:{}},o=d=>({type:`templating/keyed/${d.action.type.replace(/^templating\//,"")}`,payload:d});function m(d,p){const c=(0,t.q4)(d);return o({key:c,action:p})}const l=d=>typeof d.type=="string"&&d.type.startsWith("templating/keyed")&&"payload"in d&&typeof d.payload.key=="string";function i(d=r,p){if(l(p)){const{key:c,action:y}=p.payload,f=(0,t.q4)(c),P=s.kH.match(y)?f:d.lastKey,a=(0,n.H)(),E=d.keys[f],g=a(E,y);return{...d,lastKey:P,keys:{...d.keys,[f]:g}}}return d}const u={templating:i}},84014:(G,I,e)=>{"use strict";e.d(I,{H:()=>u,x:()=>d});var t=e(14644),n=e(3843),s=e(27238),r=e(24300),o=e(85675),m=e(83370),l=e(15120);let i;function u(){return i||(i=(0,t.combineReducers)({editor:n.wf,variables:l.Y,optionsPicker:r.ho,transaction:o.Dd,inspect:s.t4})),i}function d(){return{editor:n.nS,variables:m.j,optionsPicker:r.$z,transaction:o.i3,inspect:s.WT}}},87421:(G,I,e)=>{"use strict";e.d(I,{Fs:()=>D,SS:()=>i,Tk:()=>P,UN:()=>g,_2:()=>h,bZ:()=>E,dn:()=>o,hk:()=>c,nS:()=>p,nx:()=>l,pi:()=>d,wk:()=>y,y7:()=>a});var t=e(41811),n=e(99140),s=e(75096),r=e(84014);function o(v,C=(0,n.Gu)(),T=!0){const{id:S,rootStateKey:O}=v,b=l(O,C).variables[S];if(!b){if(T)throw new Error(`Couldn't find variable with id:${S}`);return}return b}function m(v,C,T=(0,n.Gu)()){return Object.values(l(C,T).variables).filter(v).sort((S,O)=>S.index-O.index)}function l(v,C=(0,n.Gu)()){return C.templating.keys[(0,s.q4)(v)]??(0,r.x)()}function i(v,C=(0,n.Gu)()){return m(u,v,C)}function u(v){return v.type!=="system"}const d=(0,t.A)((v,C)=>i(v,(0,n.Gu)())),p=(v,C)=>i(v,C);function c(v,C=(0,n.Gu)()){return y(Object.values(l(v,C).variables))}function y(v){const C=v.filter(u).sort((T,S)=>T.index-S.index);return C.length>0?C[C.length-1].index+1:0}function f(v,C=getState()){return l(v,C).transaction.isDirty}function P(v=(0,n.Gu)()){return v.templating?.lastKey}function a(v=(0,n.Gu)()){if(!v.templating?.lastKey)throw new Error("Accessing lastKey without initializing it variables");return v.templating.lastKey}function E(v,C=(0,n.Gu)()){const T=P(C);return T?m(v,T,C):[]}function g(v=(0,n.Gu)()){const C=P(v);return C?i(C,v):[]}function h(v,C=(0,n.Gu)()){const T=P(C);if(T)return o({id:v,rootStateKey:T,type:"query"},C,!1)}function D(v,C){return v[C]}},56968:(G,I,e)=>{"use strict";e.d(I,{Hr:()=>y,Pu:()=>C,QP:()=>P,QV:()=>f,Te:()=>T,a7:()=>v,dE:()=>g,hj:()=>a,l_:()=>h,qi:()=>c,ut:()=>E,wB:()=>D});var t=e(65307),n=e(2543),s=e.n(n),r=e(39070),o=e(20601),m=e(3843),l=e(24240),i=e(75096),u=e(87421),d=e(83370);const p=(0,t.Z0)({name:"templating/shared",initialState:d.j,reducers:{addVariable:(S,O)=>{const x=O.payload.id??O.payload.data.model.name,b=o.B.get(O.payload.type),M=(0,n.cloneDeep)(b.initialState),A=b.beforeAdding?b.beforeAdding(O.payload.data.model):(0,n.cloneDeep)(O.payload.data.model),R={...(0,n.defaults)({},A,M),id:x,index:O.payload.data.index,global:O.payload.data.global};S[x]=R},variableStateNotStarted:(S,O)=>{const x=(0,u.Fs)(S,O.payload.id);x.state=r.Gu.NotStarted,x.error=null},variableStateFetching:(S,O)=>{const x=(0,u.Fs)(S,O.payload.id);x.state=r.Gu.Loading,x.error=null},variableStateCompleted:(S,O)=>{const x=(0,u.Fs)(S,O.payload.id);x&&(x.state=r.Gu.Done,x.error=null)},variableStateFailed:(S,O)=>{const x=(0,u.Fs)(S,O.payload.id);x&&(x.state=r.Gu.Error,x.error=O.payload.data.error)},removeVariable:(S,O)=>{if(delete S[O.payload.id],!O.payload.data.reIndex)return;const x=Object.values(S).sort((b,M)=>b.index-M.index);for(let b=0;b<x.length;b++)x[b].index=b},duplicateVariable:(S,O)=>{function x(w){return w.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const b=(0,n.cloneDeep)(S[O.payload.id]),M=new RegExp(`^copy_of_${x(b.name)}(_(\\d+))?$`),A=Object.values(S).map(({name:w})=>w.match(M)).filter(w=>w!=null),R=A.map(w=>w[2]).filter(w=>w!=null),B=A.length===0?null:R.length===0?1:R.map(w=>+w).sort((w,L)=>L-w)[0]+1,U=`copy_of_${b.name}${B?`_${B}`:""}`,W=O.payload.data?.newId??U,N=(0,u.wk)(Object.values(S));S[W]={...(0,n.cloneDeep)(o.B.get(O.payload.type).initialState),...b,id:W,name:U,index:N}},changeVariableOrder:(S,O)=>{const{toIndex:x,fromIndex:b}=O.payload.data,M=Object.values(S);for(let A=0;A<M.length;A++){const R=M[A];R.index===b?R.index=x:R.index>b&&R.index<=x?R.index--:R.index<b&&R.index>=x&&R.index++}},changeVariableType:(S,O)=>{const{id:x}=O.payload,{label:b,name:M,index:A,description:R,rootStateKey:B}=S[x];S[x]={...(0,n.cloneDeep)(o.B.get(O.payload.data.newType).initialState),id:x,rootStateKey:B,label:b,name:M,index:A,description:R}},setCurrentVariableValue:(S,O)=>{if(!O.payload.data.option)return;const x=(0,u.Fs)(S,O.payload.id);if(!(0,l.SP)(x))return;const{option:b}=O.payload.data,M={...b,text:(0,i.QT)(b?.text),value:(0,i.QT)(b?.value)};x.current=M,x.options=x.options.map(A=>{A.value=(0,i.QT)(A.value),A.text=(0,i.QT)(A.text);let R=!1;if(Array.isArray(M.value))for(let B=0;B<M.value.length;B++){const U=M.value[B];if(A.value===U){R=!0;break}}else A.value===M.value&&(R=!0);return A.selected=R,A})},changeVariableProp:(S,O)=>{const x=(0,u.Fs)(S,O.payload.id);x[O.payload.data.propName]=O.payload.data.propValue}},extraReducers:S=>S.addCase(m.FN,(O,x)=>{const b=(0,u.Fs)(O,x.payload.id);b.name=x.payload.data.newName})}),c=p.reducer,{removeVariable:y,addVariable:f,changeVariableProp:P,changeVariableOrder:a,duplicateVariable:E,setCurrentVariableValue:g,changeVariableType:h,variableStateNotStarted:D,variableStateFetching:v,variableStateCompleted:C,variableStateFailed:T}=p.actions},85675:(G,I,e)=>{"use strict";e.d(I,{$O:()=>u,Dd:()=>d,i3:()=>r,kH:()=>l,pu:()=>i});var t=e(65307),n=e(80484),s=e(56968);const r={uid:null,status:n.x8.NotStarted,isDirty:!1},o=(0,t.Z0)({name:"templating/transaction",initialState:r,reducers:{variablesInitTransaction:(p,c)=>{p.uid=c.payload.uid,p.status=n.x8.Fetching},variablesCompleteTransaction:(p,c)=>{p.uid===c.payload.uid&&(p.status=n.x8.Completed)},variablesClearTransaction:(p,c)=>{p.uid=null,p.status=n.x8.NotStarted,p.isDirty=!1}},extraReducers:p=>p.addMatcher(m,(c,y)=>{c.status===n.x8.Completed&&(c.isDirty=!0)})});function m(p){return s.Hr.match(p)||s.QV.match(p)||s.QP.match(p)||s.hj.match(p)||s.ut.match(p)||s.l_.match(p)}const{variablesInitTransaction:l,variablesClearTransaction:i,variablesCompleteTransaction:u}=o.actions,d=o.reducer},83370:(G,I,e)=>{"use strict";e.d(I,{j:()=>t});const t={}},15120:(G,I,e)=>{"use strict";e.d(I,{Y:()=>m,v:()=>o});var t=e(65307),n=e(20601),s=e(56968),r=e(83370);const o=(0,t.VP)("templating/cleanVariables"),m=(l=r.j,i)=>{if(o.match(i)){const u=Object.values(l).filter(p=>p.global);return u?u.reduce((p,c)=>(p[c.id]=c,p),{}):r.j}return i?.payload?.type&&n.B.getIfExists(i?.payload?.type)?n.B.get(i.payload.type).reducer((0,s.qi)(l,i),i):l}},80484:(G,I,e)=>{"use strict";e.d(I,{BS:()=>i,Vg:()=>m,eF:()=>u,og:()=>l,x8:()=>o});var t=e(12470),n=e(39070),s=e(65463),r=e(13344),o=(d=>(d.NotStarted="Not started",d.Fetching="Fetching",d.Completed="Completed",d))(o||{});const m={id:r.qF,rootStateKey:null,name:"",type:"query",global:!1,index:-1,hide:t.zL.dontHide,skipUrlSync:!1,state:n.Gu.NotStarted,error:null,description:null};class l extends s.x{static{this.type="variables-changed"}}class i extends s.x{static{this.type="variables-time-range-process-done"}}class u extends s.x{static{this.type="variables-changed-in-url"}}},75096:(G,I,e)=>{"use strict";e.d(I,{AX:()=>D,Lz:()=>a,ML:()=>f,Nz:()=>P,QT:()=>T,SY:()=>p,Wz:()=>C,iP:()=>g,jX:()=>x,q$:()=>h,q4:()=>O,qD:()=>b,sN:()=>S,t4:()=>c,u7:()=>E,wJ:()=>y});var t=e(2543),n=e.n(t),s=e(12470),r=e(72574),o=e(87490),m=e(99140),l=e(20601),i=e(13344),u=e(87421),d=e(80484);const p=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g,c=A=>(p.lastIndex=0,p.exec(A));function y(...A){const R=A[A.length-1];A[0]=typeof A[0]=="string"?A[0]:(0,o.MA)(A[0]);const U=A.slice(0,-1).join(" ").match(p);return!!(U!==null?U.find(N=>{const w=c(N);return w!==null&&w.indexOf(R)>-1}):!1)}const f=A=>{if(!A||!A.current)return!1;if(A.current.value){const R=Array.isArray(A.current.value);if(R&&A.current.value.length&&A.current.value[0]===i.To||!R&&A.current.value===i.To)return!0}if(A.current.text){const R=Array.isArray(A.current.text);if(R&&A.current.text.length&&A.current.text[0]===i.Zm||!R&&A.current.text===i.Zm)return!0}return!1},P=A=>!A||!A.current||!A.current.text?"":Array.isArray(A.current.text)?A.current.text.toString():typeof A.current.text!="string"?"":A.current.text,a=A=>!A||!A.current||A.current.value===void 0||A.current.value===null?null:Array.isArray(A.current.value)?A.current.value.toString():typeof A.current.value!="string"?null:A.current.value;function E(A,R=(0,r.w)()){return!A||!A.regex?"":R.replace(A.regex,{},"regex")}function g(A,R,B,U){const W={range:void 0,variable:A,searchFilter:R,scopedVars:U};return(A.refresh===s.CO.onTimeRangeChanged||A.refresh===s.CO.onDashboardLoad)&&(W.range=B.timeRange()),W}function h(A){return A?.type==="custom"?s.CO.onDashboardLoad:!A||!("refresh"in A)||A.refresh!==s.CO.onTimeRangeChanged&&A.refresh!==s.CO.onDashboardLoad?s.CO.never:A.refresh}function D(){return l.B.list().filter(A=>A.id!=="system").map(({id:A,name:R,description:B})=>({label:R,value:A,description:B}))}function v(A){return(0,t.isArray)(A)&&(A.length===0?A=void 0:A.length===1&&(A=A[0])),A}function C(A,R){let B=0;const U={};for(const W in A){if(!W.startsWith(i.qz))continue;let N=v(R[W]),w=v(A[W]);(0,t.isEqual)(w,N)||(U[W]={value:A[W]},B++)}for(const W in R){if(!W.startsWith(i.qz))continue;const N=R[W];(0,t.isArray)(N)&&N.length===0||A.hasOwnProperty(W)||(U[W]={value:"",removed:!0},B++)}return B?U:void 0}function T(A){return Array.isArray(A)?A.map(String):A==null?"":typeof A=="number"?A.toString(10):typeof A=="string"?A:typeof A=="boolean"?A.toString():""}function S(A,R=(0,m.Gu)()){return(0,u.nx)(A,R).transaction.status!==d.x8.NotStarted}function O(A){return String(A)}const x=A=>{if(!A.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${A.id}`);return{type:A.type,id:A.id,rootStateKey:A.rootStateKey}};function b(A,R){return{type:A.type,id:A.id,data:R}}function M(){const A=getTemplateSrv().getVariables(),R=locationService.getSearchObject();return Object.keys(R).filter(B=>B.indexOf(VARIABLE_PREFIX)!==-1&&A.some(U=>U.name===B.replace(VARIABLE_PREFIX,""))).reduce((B,U)=>{const W=U.replace(VARIABLE_PREFIX,"");return B[W]=R[U],B},{})}},1819:(G,I,e)=>{"use strict";e.d(I,{e:()=>c});var t=e(32196),n=e(96540),s=e(28240),r=e(83195),o=e(14588),m=e(52622),l=e(40845),i=e(72109),u=e(61994),d=e(74007);function p(f,P,a,E,g){const h=f.fields,D=a!=null?h[a]:null,v=h.filter(b=>!b.config.custom?.hideFrom?.tooltip),C=v.find(b=>b.name==="traceID")||h[0],T=[];if(v.filter(b=>C===b).length>0&&T.push(C),T.push(...v.filter(b=>C!==b)),T.length===0)return null;const S=[],O=[],x=new Set;for(const b of T){if(g===m.$N.Single&&b!==D)continue;const M=b.values[P],A=b.display?b.display(M):{text:`${M}`,numeric:+M};b.getLinks&&b.getLinks({calculatedValue:A,valueRowIndex:P}).forEach(R=>{const B=`${R.title}/${R.href}`;x.has(B)||(O.push(R),x.add(B))}),S.push({name:(0,s.Ct)(b,f),value:M,valueString:(0,r.cN)(A),highlight:b===D})}return E&&E!==m.xB.None&&S.sort((b,M)=>o.sortValues(E)(b.value,M.value)),{displayValues:S,links:O}}const c=({data:f,rowIndex:P,columnIndex:a,sortOrder:E,mode:g,header:h,padding:D=0})=>{const v=(0,l.of)(y,D);if(!f||P==null)return null;const C=p(f,P,a,E,g);if(C==null)return null;const{displayValues:T,links:S}=C;return h==="Exemplar"?n.createElement(d.i,{displayValues:T,links:S,header:h}):n.createElement("div",{className:v.wrapper},h&&n.createElement("div",{className:v.header},n.createElement("span",{className:v.title},h)),n.createElement("table",{className:v.infoWrap},n.createElement("tbody",null,T.map((O,x)=>n.createElement("tr",{key:`${x}/${P}`},n.createElement("th",null,O.name),n.createElement("td",null,(0,u.A)(O.valueString)))),S.map((O,x)=>n.createElement("tr",{key:x},n.createElement("th",null,"Link"),n.createElement("td",{colSpan:2},n.createElement(i.Y,{href:O.href,external:O.target==="_blank",weight:"medium",inline:!1},O.title)))))))},y=(f,P=0)=>({wrapper:(0,t.css)({padding:`${P}px`,background:f.components.tooltip.background,borderRadius:f.shape.borderRadius(2)}),header:(0,t.css)({background:f.colors.background.secondary,alignItems:"center",alignContent:"center",display:"flex",paddingBottom:f.spacing(1)}),title:(0,t.css)({fontWeight:f.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),infoWrap:(0,t.css)({padding:f.spacing(1),background:"transparent",border:"none",th:{fontWeight:f.typography.fontWeightMedium,padding:f.spacing(.25,2,.25,0)},tr:{borderBottom:`1px solid ${f.colors.border.weak}`,"&:last-child":{borderBottom:"none"}}}),link:(0,t.css)({color:f.colors.text.link})})},74007:(G,I,e)=>{"use strict";e.d(I,{i:()=>l});var t=e(32196),n=e(96540),s=e(40845),r=e(14689),o=e(13471),m=e(61994);const l=({displayValues:u,links:d,header:p="Exemplar"})=>{const c=(0,s.of)(i),y=u.find(f=>f.name==="Time");return u=u.filter(f=>f.name!=="Time"),n.createElement("div",{className:c.exemplarWrapper},n.createElement("div",{className:c.exemplarHeader},n.createElement("span",{className:c.title},p),y&&n.createElement("span",{className:c.time},(0,m.A)(y.valueString))),n.createElement("div",{className:c.exemplarContent},u.map((f,P)=>n.createElement(o.B,{key:P,label:f.name,value:(0,m.A)(f.valueString),justify:"space-between",isPinned:!1}))),d&&d.length>0&&n.createElement("div",{className:c.exemplarFooter},d.map((f,P)=>n.createElement(r.R,{link:f,key:P,buttonProps:{size:"md"}}))))},i=(u,d=0)=>({exemplarWrapper:(0,t.css)({display:"flex",flexDirection:"column",flex:1,gap:4,whiteSpace:"pre",borderRadius:u.shape.radius.default,background:u.colors.background.primary,border:`1px solid ${u.colors.border.weak}`,boxShadow:`0 4px 8px ${u.colors.background.primary}`}),exemplarHeader:(0,t.css)({display:"flex",flexDirection:"column",alignItems:"flex-start",gap:u.spacing(.5),color:u.colors.text.secondary,padding:u.spacing(1)}),time:(0,t.css)({color:u.colors.text.primary}),exemplarContent:(0,t.css)({display:"flex",flexDirection:"column",flex:1,gap:4,borderTop:`1px solid ${u.colors.border.medium}`,padding:u.spacing(1)}),exemplarFooter:(0,t.css)({display:"flex",flexDirection:"column",padding:u.spacing(1),borderTop:`1px solid ${u.colors.border.medium}`,gap:4}),linkButton:(0,t.css)({width:"fit-content"}),label:(0,t.css)({color:u.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:u.spacing(.5)}),value:(0,t.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),title:(0,t.css)({fontWeight:u.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1})})},58134:(G,I,e)=>{"use strict";var t=e(6262),n=e(9423),s=e(7452),r=e(78624),o=e(4213),m=e(34796),l=e(13609),i=e(31193),u=e(17493),d=e(14792),p=e(15858),c=e(16495),y=e(16561),f=e(2543),P=e.n(f),a=e(96540),E=e(5338),g=e(47232),h=e(1933),D=e(69550),v=e(97497),C=e(96915),T=e(71733),S=e(17172),O=e(23509),x=e(12131),b=e(96937),M=e(3591),A=e(63639),R=e(89191),B=e(19347),U=e(4402),W=e(3197),N=e(79396),w=e(14778),L=e(63415),V=e(97152),K=e(24308),k=e(46235),j=e(5260),H=e(2913),J=e(94041),X=e(32264),se=e(11261),ae=e(85200),ne=e(1173),q=e(28240),ee=e(18282),z=e(57934),te=e(73376),ie=e(14186),ce=e(94354),ue=e(90613),fe=e(55852),Te=e(91847);function he(F){if(F in Te.uk){const{name:_,getHelperDocs:Q,links:me}=Te.uk[F],De=Q(Te.g_.UIImage),Ce=de(De);if(me?.length){const Ne=me.map(_e=>`
  Or visit <a href="${_e.url}" target="_blank">${_e.title}</a>

  `).join("");return{name:_,helperDocs:`
        ${Ce}
        ${(0,Te.$n)()}
  ${Ne}
        `}}return{name:_,helperDocs:`
      ${Ce}
      ${(0,Te.$n)()}
      `}}return{name:"No documentation found",helperDocs:(0,Te.$n)()}}const de=F=>F.replace(/\[(.*?)\]\(#.*?\)/g,"$1").replace(/\[[^\]]*\]\[\]/g,"");var le=e(39268),pe=e(21594),ve=e(83077),be=e(91890),Oe=e(72574),Me=e(10354),Ue=e(88841),we=e(94397);function Re(F,_){switch(_.type){case se.PU.boolean:return(0,f.isUndefined)(F)?!1:Fe(F);case se.PU.number:return isNaN(F)?0:parseFloat(F);case se.PU.string:return F?String(F):"";default:return F}}const Fe=F=>(0,f.isString)(F)?!(F[0]==="F"||F[0]==="f"||F[0]==="0"):!!F;function xe(F){return function({options:Q,onChange:me,field:De}){const{validator:Ce,converter:Ne=Re}=F,{value:_e}=Q,[Qe,st]=(0,a.useState)(!Ce(_e)),Ct=(0,Oe.w)().getVariables().map(Wt=>({value:Wt.name,label:Wt.label||Wt.name,origin:be.$0.Template})),kt=(0,a.useCallback)(Wt=>{st(!Ce(Wt.currentTarget.value))},[st,Ce]),Ut=(0,a.useCallback)(Wt=>{if(Qe)return;const{value:Sn}=Wt.currentTarget;me({...Q,value:Ne(Sn,De)})},[Q,me,Qe,De,Ne]),Ot=(0,a.useCallback)(Wt=>{st(!Ce(Wt)),me({...Q,value:Wt})},[st,Ce,me,Q]);return X.$.featureToggles.transformationsVariableSupport?a.createElement(Ue.y,{invalid:Qe,value:_e,error:"Value needs to be an integer or a variable",onChange:Ot,placeholder:"Value or variable",suggestions:Ct}):a.createElement(Me.p,{className:"flex-grow-1",invalid:Qe,defaultValue:String(Q.value),placeholder:"Value",onChange:kt,onBlur:Ut})}}const Ve=()=>[{name:"Is greater",id:ne.Js.greater,component:xe({validator:we.N_})},{name:"Is greater or equal",id:ne.Js.greaterOrEqual,component:xe({validator:we.N_})},{name:"Is lower",id:ne.Js.lower,component:xe({validator:we.N_})},{name:"Is lower or equal",id:ne.Js.lowerOrEqual,component:xe({validator:we.N_})},{name:"Is equal",id:ne.Js.equal,component:xe({validator:()=>!0})},{name:"Is not equal",id:ne.Js.notEqual,component:xe({validator:()=>!0})},{name:"Is Substring",id:ne.Js.substring,component:xe({validator:()=>!0})},{name:"Is not substring",id:ne.Js.notSubstring,component:xe({validator:()=>!0})}],$e=()=>null,Xe=()=>[{name:"Is null",id:ne.Js.isNull,component:$e},{name:"Is not null",id:ne.Js.isNotNull,component:$e}];var gt=e(76892);function Dt(F){return function({options:Q,onChange:me,field:De}){const{validator:Ce}=F,[Ne,_e]=(0,a.useState)({from:!Ce(Q.from),to:!Ce(Q.to)}),st=(0,Oe.w)().getVariables().map(Ut=>({value:Ut.name,label:Ut.label||Ut.name,origin:be.$0.Template})),Et=(0,a.useCallback)((Ut,Ot)=>{_e({...Ne,[Ot]:!Ce(Ut.currentTarget.value)})},[_e,Ce,Ne]),Ct=(0,a.useCallback)((Ut,Ot)=>{if(Ne[Ot])return;const{value:Wt}=Ut.currentTarget;me({...Q,[Ot]:Re(Wt,De)})},[Q,me,Ne,De]),kt=(0,a.useCallback)((Ut,Ot)=>{const Wt=!Ce(Ut);_e({...Ne,[Ot]:Wt}),!Wt&&me({...Q,[Ot]:Ut})},[Q,me,Ne,_e,Ce]);return X.$.featureToggles.transformationsVariableSupport?a.createElement(a.Fragment,null,a.createElement(Ue.y,{value:String(Q.from),invalid:Ne.from,error:"Value needs to be an integer or a variable",placeholder:"From",onChange:Ut=>kt(Ut,"from"),suggestions:st}),a.createElement(gt.c,null,"and"),a.createElement(Ue.y,{invalid:Ne.to,error:"Value needs to be an integer or a variable",value:String(Q.to),placeholder:"To",suggestions:st,onChange:Ut=>kt(Ut,"to")})):a.createElement(a.Fragment,null,a.createElement(Me.p,{invalid:Ne.from,defaultValue:String(Q.from),placeholder:"From",onChange:Ut=>Et(Ut,"from"),onBlur:Ut=>Ct(Ut,"from")}),a.createElement(gt.c,null,"and"),a.createElement(Me.p,{invalid:Ne.to,defaultValue:String(Q.to),placeholder:"To",onChange:Ut=>Et(Ut,"to"),onBlur:Ut=>Ct(Ut,"to")}))}}const nt=()=>[{name:"Is between",id:ne.Js.between,component:Dt({validator:we.N_})}];function at(F){return function({options:Q,onChange:me,field:De}){const{validator:Ce,converter:Ne=Re}=F,{value:_e}=Q,[Qe,st]=(0,a.useState)(!Ce(_e)),Et=(0,a.useCallback)(kt=>{st(!Ce(kt.currentTarget.value))},[st,Ce]),Ct=(0,a.useCallback)(kt=>{if(Qe)return;const{value:Ut}=kt.currentTarget;me({...Q,value:Ne(Ut,De)})},[Q,me,Qe,De,Ne]);return a.createElement(Me.p,{className:"flex-grow-1",invalid:Qe,defaultValue:String(Q.value),placeholder:"Value",onChange:Et,onBlur:Ct})}}const Ae=()=>[{name:"Regex",id:ne.Js.regex,component:at({validator:()=>!0,converter:F=>String(F)})}],re=new ve.O(()=>[...Ve(),...Xe(),...nt(),...Ae()]),Z=F=>{const{onDelete:_,onChange:Q,filter:me,fieldsInfo:De}=F,{fieldsAsOptions:Ce,fieldByDisplayName:Ne}=De,_e=ye(me,Ce)??"",Qe=Ne[_e],st=Qe?oe(Qe):[],Et=Ee(me,st),Ct=re.getIfExists(Et),kt=(0,a.useCallback)(Wt=>{Wt?.value&&Q({...me,fieldName:Wt.value})},[Q,me]),Ut=(0,a.useCallback)(Wt=>{if(!Wt?.value)return;const Sn=Wt.value,ha=ae.hI.get(Sn).getDefaultOptions(Qe);Q({...me,config:{id:Sn,options:ha}})},[Q,me,Qe]),Ot=(0,a.useCallback)(Wt=>{Q({...me,config:{...me.config,options:Wt}})},[Q,me]);return!Qe||!Ct||!Ct.component?null:a.createElement(le.C,null,a.createElement(ie.I,{label:"Field",labelWidth:14},a.createElement(pe.l6,{className:"min-width-15 max-width-24",placeholder:"Field Name",options:Ce,value:me.fieldName,onChange:kt})),a.createElement(ie.I,{label:"Match"},a.createElement(pe.l6,{className:"width-12",placeholder:"Select test",options:st,value:Et,onChange:Ut})),a.createElement(ie.I,{label:"Value",grow:!0},a.createElement(Ct.component,{field:Qe,options:me.config.options??{},onChange:Ot})),a.createElement(ue.a,{marginBottom:.5},a.createElement(fe.$n,{icon:"times",onClick:_,variant:"secondary"})))},oe=F=>{const _=[];for(const Q of ae.hI.list())!Q.isApplicable(F)||!re.getIfExists(Q.id)||_.push({value:Q.id,label:Q.name,description:Q.description});return _},Ee=(F,_)=>{const Q=_.find(me=>me.value===F.config.id);if(Q&&Q.value)return Q.value;if(_[0]?.value)return _[0]?.value},ye=(F,_)=>{const Q=_.find(me=>me.value===F.fieldName);if(Q&&Q.value)return Q.value;if(_[0]?.value)return _[0]?.value},Se=[{label:"Include",value:te.j4.include},{label:"Exclude",value:te.j4.exclude}],Be=[{label:"Match all",value:te.Sm.all},{label:"Match any",value:te.Sm.any}],We=F=>{const{input:_,options:Q,onChange:me}=F,De=it(_),Ce=(0,a.useCallback)(()=>{const Et=_[0],Ct=Et.fields.find(Ot=>Ot.type!==se.PU.time);if(!Ct)return;const kt=(0,f.cloneDeep)(Q.filters),Ut=ae.hI.get(ne.Js.isNull);kt.push({fieldName:(0,q.Ct)(Ct,Et,_),config:{id:Ut.id,options:Ut.getDefaultOptions(Ct)}}),me({...Q,filters:kt})},[me,Q,_]),Ne=(0,a.useCallback)(Et=>{let Ct=(0,f.cloneDeep)(Q.filters);Ct.splice(Et,1),me({...Q,filters:Ct})},[Q,me]),_e=(0,a.useCallback)((Et,Ct)=>{let kt=(0,f.cloneDeep)(Q.filters);kt[Ct]=Et,me({...Q,filters:kt})},[Q,me]),Qe=(0,a.useCallback)(Et=>{me({...Q,type:Et??te.j4.include})},[Q,me]),st=(0,a.useCallback)(Et=>{me({...Q,match:Et??te.Sm.all})},[Q,me]);return a.createElement("div",null,a.createElement(ie.I,{label:"Filter type",labelWidth:16},a.createElement("div",{className:"width-15"},a.createElement(ce.z,{options:Se,value:Q.type,onChange:Qe,fullWidth:!0}))),a.createElement(ie.I,{label:"Conditions",labelWidth:16},a.createElement("div",{className:"width-15"},a.createElement(ce.z,{options:Be,value:Q.match,onChange:st,fullWidth:!0}))),a.createElement(ue.a,{paddingLeft:2},Q.filters.map((Et,Ct)=>a.createElement(Z,{key:Ct,filter:Et,fieldsInfo:De,onChange:kt=>_e(kt,Ct),onDelete:()=>Ne(Ct)})),a.createElement(fe.$n,{icon:"plus",size:"sm",onClick:Ce,variant:"secondary"},"Add condition")))},Ke={id:ee.F.filterByValue,editor:We,transformation:z.c.filterByValueTransformer,name:z.c.filterByValueTransformer.name,description:"Removes rows of the query results using user-defined filters. This is useful if you can not filter your data in the data source.",categories:new Set([v.m.Filter]),help:he(ee.F.filterByValue).helperDocs},it=F=>(0,a.useMemo)(()=>{const _={fieldsAsOptions:[],fieldByDisplayName:{}};return Array.isArray(F)?F.reduce((Q,me)=>me.fields.reduce((De,Ce)=>{const Ne=(0,q.Ct)(Ce,me,F);return De.fieldByDisplayName[Ne]||(De.fieldsAsOptions.push({label:Ne,value:Ne,type:Ce.type}),De.fieldByDisplayName[Ne]=Ce),De},Q),_):_},[F]);var rt=e(43429),ft=e(60264),pt=e(48192),Ge=e(66211),qe=e(54612);function bt(F,_){const Q={data:F.input,options:F.options},me=new pt.C({id:"root",title:"root"}),De=Ne=>{if(Ne?.length){const _e=Ne[0];let Qe=me.categories.find(st=>st.props.id===_e);return Qe||(Qe=new pt.C({id:_e,title:_e}),me.categories.push(Qe)),Qe}return me},Ce={getValue:Ne=>(0,f.get)(F.options,Ne),onChange:(Ne,_e)=>{F.onChange((0,qe.Sf)(F.options,Ne,_e))}};return(0,Ge.g5)(_,Ce,De,Q),me}function Ft(F){const _={data:[],options:{}},Q={},me=new ft.pv;F(me,_);for(const De of me.getItems())De.defaultValue!=null&&(0,f.set)(Q,De.path,De.defaultValue);return Q}var Xt=e(27825),Lt=e(3290);const Qt=(F,_)=>{const Q=_.options??{};(0,Xt.J)("",F,Q)},an=F=>{(0,a.useEffect)(()=>{if(!F.options.xBuckets?.mode){const Q=Ft(Qt);F.onChange({...Q,...F.options})}});const _=bt(F,Qt);return a.createElement("div",null,a.createElement("div",null,_.items.map(Q=>Q.render())))},gn={id:Lt.wY.id,editor:an,transformation:Lt.wY,name:Lt.wY.name,description:Lt.wY.description,state:rt.pn.alpha,categories:new Set([v.m.CreateNewVisualization]),help:he(Lt.wY.id).helperDocs};var ut=e(32196),Nt=e(40845),ht=e(84349),Rt=e(75059),_t=e(42734),on=e(24293),ln=e(28802),bn=e(50082),In=e(25019);function Mn(F,_,Q){const me={},De={};for(const Ce of F.fields){const Ne=(0,q.Ct)(Ce,F),_e=Q.index[Ne],Qe=_e.handler;if(!Qe)continue;const st=Ce.values[_];if(st==null)continue;const Et=Qe.processor(st,me,De,_e.handlerArguments);Et!=null&&(me[Qe.targetProperty??Qe.key]=Et)}return De.mappingValues&&(me.mappings=cn(De)),me}var vt=(F=>(F.Name="field.name",F.Value="field.value",F.Label="field.label",F.Ignore="__ignore",F))(vt||{});const nn=[{key:"field.name",name:"Field name",processor:()=>{}},{key:"field.value",name:"Field value",processor:()=>{}},{key:"field.label",name:"Field label",processor:()=>{}},{key:"__ignore",name:"Ignore",processor:()=>{}},{key:"max",processor:Tt},{key:"min",processor:Tt},{key:"unit",processor:F=>F.toString()},{key:"decimals",processor:Tt},{key:"displayName",name:"Display name",processor:F=>F.toString()},{key:"color",processor:F=>({fixedColor:F,mode:on.Y.Fixed})},{key:"threshold1",name:"Threshold",targetProperty:"thresholds",processor:(F,_,Q,me)=>{const De=(0,ln.t)(F);if(!isNaN(De))return _.thresholds||(_.thresholds={mode:bn.O.Absolute,steps:[{value:-1/0,color:"green"}]}),_.thresholds.steps.push({value:De,color:me.threshold?.color??"red"}),_.thresholds}},{key:"mappings.value",name:"Value mappings / Value",targetProperty:"mappings",defaultReducer:Rt.gy.allValues,processor:(F,_,Q)=>{if((0,f.isArray)(F))return Q.mappingValues=F,_.mappings}},{key:"mappings.color",name:"Value mappings / Color",targetProperty:"mappings",defaultReducer:Rt.gy.allValues,processor:(F,_,Q)=>{if((0,f.isArray)(F))return Q.mappingColors=F,_.mappings}},{key:"mappings.text",name:"Value mappings / Display text",targetProperty:"mappings",defaultReducer:Rt.gy.allValues,processor:(F,_,Q)=>{if((0,f.isArray)(F))return Q.mappingTexts=F,_.mappings}}];function cn(F){const _={type:In.d.ValueToText,options:{}};if(!F.mappingValues)return[];for(let Q=0;Q<F.mappingValues.length;Q++){const me=F.mappingValues[Q];me!=null&&(_.options[me.toString()]={color:F.mappingColors&&F.mappingColors[Q],text:F.mappingTexts&&F.mappingTexts[Q],index:Q})}return[_]}let mt=null;function lt(){if(mt===null){mt={};for(const F of nn)mt[F.key]=F}return mt}function Tt(F){const _=(0,ln.t)(F);if(!isNaN(_))return _}function Vt(F,_){for(const Q of _)if(F===Q.fieldName)return Q.handlerKey;return F.toLowerCase()}function zt(F){return F?lt()[F]:null}function rn(F,_,Q){const me={index:{}};let De=_.find(Ne=>Ne.handlerKey==="field.name"),Ce=_.find(Ne=>Ne.handlerKey==="field.value");for(const Ne of F.fields){const _e=(0,q.Ct)(Ne,F),Qe=_.find(Ct=>Ct.fieldName===_e),st=Qe?Qe.handlerKey:_e.toLowerCase();let Et=zt(st);Q&&(Et?(Et.key==="field.name"&&(me.nameField=Ne),Et.key==="field.value"&&(me.valueField=Ne)):Qe||(!me.nameField&&!De&&Ne.type===se.PU.string&&(me.nameField=Ne,Et=zt("field.name")),!me.valueField&&!Ce&&Ne.type===se.PU.number&&(me.valueField=Ne,Et=zt("field.value")))),!Et&&Q&&(Et=zt("field.label")),me.index[_e]={automatic:!Qe,handler:Et,handlerArguments:Qe?.handlerArguments??{},reducerId:Qe?.reducerId??Et?.defaultReducer??Rt.gy.lastNotNull}}return me}var mn=e(83598);function dt(F){switch(F){case"threshold1":return!0;default:return!1}}function wt({handlerArguments:F,handlerKey:_,onChange:Q}){const me=De=>{Q(De?{...F,threshold:{...F.threshold,color:De}}:{...F,threshold:void 0})};return a.createElement(a.Fragment,null,_==="threshold1"&&a.createElement(Me.p,{type:"text",value:"Threshold color","aria-label":"Threshold color",disabled:!0,width:20,prefix:a.createElement(mn.sk,{color:F.threshold?.color??"red",onChange:me,enableNamedColors:!0})}))}function en({frame:F,mappings:_,onChange:Q,withReducers:me,withNameAndValue:De}){const Ce=(0,Nt.of)(At),Ne=En(F,_,De),_e=nn.map(kt=>yt(kt,!1)),Qe=_.reduce((kt,Ut)=>kt||dt(Ut.handlerKey),!1),st=(kt,Ut)=>{const Ot=_.findIndex(Wt=>Wt.fieldName===kt.fieldName);if(Ut)if(Ot!==-1){const Wt=[..._];Wt.splice(Ot,1,{..._[Ot],handlerKey:Ut.value}),Q(Wt)}else Q([..._,{fieldName:kt.fieldName,handlerKey:Ut.value}]);else Q(Ot!==-1?_.filter((Wt,Sn)=>Sn!==Ot):[..._,{fieldName:kt.fieldName,handlerKey:"__ignore"}])},Et=(kt,Ut)=>{const Ot=_.findIndex(Wt=>Wt.fieldName===kt.fieldName);if(Ot!==-1){const Wt=[..._];Wt.splice(Ot,1,{..._[Ot],reducerId:Ut}),Q(Wt)}else Q([..._,{fieldName:kt.fieldName,handlerKey:kt.handlerKey,reducerId:Ut}])},Ct=(kt,Ut)=>{const Ot=_.findIndex(Wt=>Wt.fieldName===kt.fieldName);if(Ot!==-1){const Wt=[..._];Wt.splice(Ot,1,{..._[Ot],handlerArguments:Ut}),Q(Wt)}else Q([..._,{fieldName:kt.fieldName,handlerKey:kt.handlerKey,handlerArguments:Ut}])};return a.createElement("table",{className:Ce.table},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Field"),a.createElement("th",null,"Use as"),me&&a.createElement("th",null,"Select"),Qe&&a.createElement("th",null,"Additional settings"))),a.createElement("tbody",null,Ne.map(kt=>a.createElement("tr",{key:kt.fieldName},a.createElement("td",{className:Ce.labelCell},kt.fieldName),a.createElement("td",{className:Ce.selectCell,"data-testid":`${kt.fieldName}-config-key`},a.createElement(pe.l6,{options:_e,value:kt.configOption,placeholder:kt.placeholder,isClearable:!0,onChange:Ut=>st(kt,Ut)})),me&&a.createElement("td",{"data-testid":`${kt.fieldName}-reducer`,className:Ce.selectCell},a.createElement(_t.S,{stats:[kt.reducerId],defaultStat:kt.reducerId,onChange:Ut=>Et(kt,Ut[0])})),Qe&&a.createElement("td",{"data-testid":`${kt.fieldName}-handler-arg`,className:Ce.selectCell},a.createElement(wt,{handlerKey:kt.handlerKey,handlerArguments:kt.handlerArguments,onChange:Ut=>Ct(kt,Ut)}))))))}function En(F,_,Q){const me=[],De=rn(F,_??[],Q);for(const Ce of F.fields){const Ne=(0,q.Ct)(Ce,F),_e=De.index[Ne],Qe=yt(_e.handler,_e.automatic);me.push({fieldName:Ne,configOption:_e.automatic?null:Qe,placeholder:_e.automatic?Qe?.label:"Choose",handlerKey:_e.handler?.key??null,reducerId:_e.reducerId,handlerArguments:_e.handlerArguments})}for(const Ce of _)if(!me.find(Ne=>Ne.fieldName===Ce.fieldName)){const Ne=zt(Ce.handlerKey);me.push({fieldName:Ce.fieldName,handlerKey:Ce.handlerKey,configOption:yt(Ne,!1),missingInFrame:!0,reducerId:Ce.reducerId??Rt.gy.lastNotNull,handlerArguments:{}})}return Object.values(me)}function yt(F,_){if(!F)return null;let Q=F.name??(0,f.capitalize)(F.key);return _&&(Q=`${Q} (auto)`),{label:Q,value:F.key}}const At=F=>({table:(0,ut.css)`
    margin-top: ${F.spacing(1)};

    td,
    th {
      border-right: 4px solid ${F.colors.background.primary};
      border-bottom: 4px solid ${F.colors.background.primary};
      white-space: nowrap;
    }
    th {
      font-size: ${F.typography.bodySmall.fontSize};
      line-height: ${F.spacing(4)};
      padding: ${F.spacing(0,1)};
    }
  `,labelCell:(0,ut.css)`
    font-size: ${F.typography.bodySmall.fontSize};
    background: ${F.colors.background.secondary};
    padding: ${F.spacing(0,1)};
    max-width: 400px;
    overflow: hidden;
    text-overflow: ellipsis;
    min-width: 140px;
  `,selectCell:(0,ut.css)`
    padding: 0;
    min-width: 161px;
  `});var Kt=e(81160);function Jt(F,_){let Q=null;for(const _e of _)if(_e.refId===F.configRefId){Q=_e;break}if(!Q)return _;const me={fields:[],length:1},De=rn(Q,F.mappings??[],!1);for(const _e of Q.fields){const Qe={..._e},st=(0,q.Ct)(_e,Q),Et=De.index[st],Ct=(0,Rt.Nw)({field:_e,reducers:[Et.reducerId]});Qe.values=[Ct[Et.reducerId]],me.fields.push(Qe)}const Ce=[],Ne=(0,ae.NS)(F.applyTo||{id:ne.Ct.numeric});for(const _e of _){if(_e===Q&&_.length>1)continue;const Qe={fields:[],length:_e.length,refId:_e.refId};for(const st of _e.fields)if(Ne(st,_e,_)){const Et=Mn(me,0,De);Qe.fields.push({...st,config:{...st.config,...Et}})}else Qe.fields.push(st);Ce.push(Qe)}return Ce}const Mt={id:ee.F.configFromData,name:"Config from query results",description:"Set unit, min, max and more from data.",defaultOptions:{configRefId:"config",mappings:[]},operator:F=>_=>_.pipe((0,Kt.T)(Q=>Jt(F,Q)))};function Je({input:F,onChange:_,options:Q}){const me=(0,Nt.of)(xn),De=F.map(Ut=>Ut.refId).filter(Ut=>Ut!=null).map(Ut=>({label:Ut,value:Ut})),Ce=Q.configRefId||"config",Ne=Q.applyTo??{id:ne.Ct.byType,options:"number"},_e=ht.g.get(Ne.id),Qe=F.find(Ut=>Ut.refId===Ce),st=Ut=>{_({...Q,configRefId:Ut.value||"config"})},Et=Ut=>{_({...Q,applyTo:{id:Ut.value}})},Ct=Ut=>{_({...Q,applyTo:{id:Ne.id,options:Ut}})},kt=ht.g.list().filter(Ut=>!Ut.excludeFromPicker).map(Ut=>({label:Ut.name,value:Ut.id,description:Ut.description}));return a.createElement(a.Fragment,null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Config query",labelWidth:20},a.createElement(pe.l6,{onChange:st,options:De,value:Ce,width:30}))),a.createElement(le.C,null,a.createElement(ie.I,{label:"Apply to",labelWidth:20},a.createElement(pe.l6,{onChange:Et,options:kt,value:Ne.id,width:30}))),a.createElement(le.C,null,a.createElement(ie.I,{label:"Apply to options",labelWidth:20,className:me.matcherOptions},a.createElement(_e.component,{matcher:_e.matcher,data:F,options:Ne.options,onChange:Ct}))),a.createElement(le.C,null,Qe&&a.createElement(en,{frame:Qe,mappings:Q.mappings,onChange:Ut=>_({...Q,mappings:Ut}),withReducers:!0})))}const Nn={id:Mt.id,editor:Je,transformation:Mt,name:Mt.name,description:Mt.description,state:rt.pn.beta,categories:new Set([v.m.CalculateNewFields]),help:he(Mt.id).helperDocs},xn=F=>({matcherOptions:(0,ut.css)`
    min-width: 404px;
  `});var Fn=e(62467),wn=e(58307),Wn=e(66350),da=e(15292),oa=e(11710);const _n=16,Wa=F=>{const{options:_,onChange:Q}=F,{binary:me}=_;let De=!me?.left,Ce=!me?.right;const Ne=F.names.map(Ot=>(Ot===me?.left&&(De=!0),Ot===me?.right&&(Ce=!0),{label:Ot,value:Ot})),_e=De?Ne:[...Ne,{label:me?.left,value:me?.left}],Qe=Ce?Ne:[...Ne,{label:me?.right,value:me?.right}],st=oa.b.list().map(Ot=>({label:Ot.binaryOperationID,value:Ot.binaryOperationID})),Et=Ot=>{Q({..._,mode:Wn.UY.BinaryOperation,binary:Ot})},Ct=Ot=>{Et({...me,left:Ot.value})},kt=Ot=>{Et({...me,right:Ot.value})},Ut=Ot=>{Et({...me,operator:Ot.value})};return a.createElement(a.Fragment,null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Operation",labelWidth:_n},a.createElement(pe.l6,{allowCustomValue:!0,placeholder:"Field or number",options:_e,className:"min-width-18",value:me?.left,onChange:Ct})),a.createElement(ie.I,null,a.createElement(pe.l6,{className:"width-4",options:st,value:me?.operator??st[0].value,onChange:Ut})),a.createElement(ie.I,null,a.createElement(pe.l6,{allowCustomValue:!0,placeholder:"Field or number",className:"min-width-10",options:Qe,value:me?.right,onChange:kt}))))},za=F=>{const{names:_,onChange:Q,options:me}=F,{cumulative:De}=me,Ce=_.map(st=>({label:st,value:st})),Ne=st=>{const Et=st.length?st[0]:Rt.gy.sum;_e({...De,reducer:Et})},_e=st=>{Q({...me,mode:Wn.UY.CumulativeFunctions,cumulative:st})},Qe=st=>{_e({...De,field:st.value})};return a.createElement(a.Fragment,null,a.createElement(ie.I,{label:"Field",labelWidth:_n},a.createElement(pe.l6,{placeholder:"Field",options:Ce,className:"min-width-18",value:De?.field,onChange:Qe})),a.createElement(ie.I,{label:"Calculation",labelWidth:_n},a.createElement(_t.S,{allowMultiple:!1,className:"width-18",stats:[De?.reducer||Rt.gy.sum],onChange:Ne,defaultStat:Rt.gy.sum,filterOptions:st=>st.id===Rt.gy.sum||st.id===Rt.gy.mean})))},_a=F=>{const{options:_,onChange:Q}=F,{index:me}=_,De=Ce=>{Q({..._,index:{asPercentile:Ce.currentTarget.checked}})};return a.createElement(a.Fragment,null,a.createElement(ie.I,{labelWidth:_n,label:"As percentile",tooltip:"Transform the row index as a percentile."},a.createElement(da.K,{value:!!me?.asPercentile,onChange:De})))};var Xa=e(66864),Va=e(92174);const Cs=F=>{const{names:_,selected:Q,onChange:me,options:De}=F,{reduce:Ce}=De,Ne=Et=>{me({...De,reduce:Et})},_e=Et=>{Q.indexOf(Et)>-1?Qe(Q.filter(Ct=>Ct!==Et)):Qe([...Q,Et])},Qe=Et=>{Ne({...Ce,include:Et})},st=Et=>{const Ct=Et.length?Et[0]:Rt.gy.sum,{reduce:kt}=De;Ne({...kt,reducer:Ct})};return a.createElement(a.Fragment,null,a.createElement(ie.I,{label:"Operation",labelWidth:_n,grow:!0},a.createElement(Xa.Gy,{spacing:"xs",align:"flex-start",wrap:!0},_.map((Et,Ct)=>a.createElement(Va.m,{key:`${Et}/${Ct}`,onClick:()=>{_e(Et)},label:Et,selected:Q.indexOf(Et)>-1})))),a.createElement(ie.I,{label:"Calculation",labelWidth:_n},a.createElement(_t.S,{allowMultiple:!1,className:"width-18",stats:[Ce?.reducer||Rt.gy.sum],onChange:st,defaultStat:Rt.gy.sum})))};var ns=e(27618);const Is=F=>{const{options:_,onChange:Q}=F,{unary:me}=_,De=Ct=>{Q({..._,mode:Wn.UY.UnaryOperation,unary:Ct})},Ce=Ct=>{De({...me,operator:Ct.value})},Ne=Ct=>{De({...me,fieldName:Ct.value})};let _e=!me?.fieldName;const Qe=F.names.map(Ct=>(Ct===me?.fieldName&&(_e=!0),{label:Ct,value:Ct})),st=ns.j.list().map(Ct=>({label:Ct.unaryOperationID,value:Ct.unaryOperationID})),Et=_e?Qe:[...Qe,{label:me?.fieldName,value:me?.fieldName}];return a.createElement(a.Fragment,null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Operation",labelWidth:_n},a.createElement(pe.l6,{options:st,value:me?.operator??st[0].value,onChange:Ce})),a.createElement(ie.I,{label:"(",labelWidth:2},a.createElement(pe.l6,{placeholder:"Field",className:"min-width-11",options:Et,value:me?.fieldName,onChange:Ne})),a.createElement(gt.c,{width:2},")")))};var ls=e(60188);const ss=F=>{const{options:_,names:Q,onChange:me}=F,{window:De}=_,Ce=Q.map(Ot=>({label:Ot,value:Ot})),Ne=[{label:"Trailing",value:Wn.ip.Trailing},{label:"Centered",value:Wn.ip.Centered}],_e=[{label:"Percentage",value:Wn.Bp.Percentage},{label:"Fixed",value:Wn.Bp.Fixed}],Qe=Ot=>{me({..._,mode:Wn.UY.WindowFunctions,window:Ot})},st=Ot=>{Qe({...De,field:Ot.value})},Et=Ot=>{Qe({...De,windowSize:Ot&&De?.windowSizeMode===Wn.Bp.Percentage?Ot/100:Ot})},Ct=Ot=>{Qe({...De,windowSize:De?.windowSize?Ot===Wn.Bp.Percentage?De.windowSize/100:De.windowSize*100:void 0,windowSizeMode:Ot})},kt=Ot=>{const Wt=Ot.length?Ot[0]:Rt.gy.sum;Qe({...De,reducer:Wt})},Ut=Ot=>{Qe({...De,windowAlignment:Ot})};return a.createElement(a.Fragment,null,a.createElement(ie.I,{label:"Field",labelWidth:_n},a.createElement(pe.l6,{placeholder:"Field",options:Ce,className:"min-width-18",value:De?.field,onChange:st})),a.createElement(ie.I,{label:"Calculation",labelWidth:_n},a.createElement(_t.S,{allowMultiple:!1,className:"width-18",stats:[De?.reducer||Rt.gy.mean],onChange:kt,defaultStat:Rt.gy.mean,filterOptions:Ot=>Ot.id===Rt.gy.mean||Ot.id===Rt.gy.variance||Ot.id===Rt.gy.stdDev})),a.createElement(ie.I,{label:"Type",labelWidth:_n},a.createElement(ce.z,{value:De?.windowAlignment??Wn.ip.Trailing,options:Ne,onChange:Ut})),a.createElement(ie.I,{label:"Window size mode"},a.createElement(ce.z,{value:De?.windowSizeMode??Wn.Bp.Percentage,options:_e,onChange:Ct})),a.createElement(ie.I,{label:De?.windowSizeMode===Wn.Bp.Percentage?"Window size %":"Window size",labelWidth:_n,tooltip:De?.windowSizeMode===Wn.Bp.Percentage?"Set the window size as a percentage of the total data":"Window size"},a.createElement(ls.Q,{placeholder:"Auto",min:.1,value:De?.windowSize&&De.windowSizeMode===Wn.Bp.Percentage?De.windowSize*100:De?.windowSize,onChange:Et})))},Fs=[{value:Wn.UY.BinaryOperation,label:"Binary operation"},{value:Wn.UY.UnaryOperation,label:"Unary operation"},{value:Wn.UY.ReduceRow,label:"Reduce row"},{value:Wn.UY.Index,label:"Row index"}];X.$.featureToggles.addFieldFromCalculationStatFunctions&&Fs.push({value:Wn.UY.CumulativeFunctions,label:"Cumulative functions"},{value:Wn.UY.WindowFunctions,label:"Window functions"});const Ts=new Set([se.PU.time,se.PU.number,se.PU.string]),Es=F=>{const{options:_,onChange:Q,input:me}=F,De=_?.reduce?.include,[Ce,Ne]=(0,a.useState)({names:[],selected:[]});(0,a.useEffect)(()=>{const Ot={interpolate:Sn=>Sn},Wt=(0,Fn.of)(me).pipe(z.c.ensureColumnsTransformer.operator(null,Ot),Qe(),_e(),st(De||[])).subscribe(({selected:Sn,names:ha})=>{Ne({names:ha,selected:Sn})});return()=>{Wt.unsubscribe()}},[me,De]);const _e=()=>{if(!X.$.featureToggles.transformationsVariableSupport)return wn.D;const Ot=(0,Oe.w)();return Wt=>Wt.pipe((0,Kt.T)(Sn=>(Sn.push(...Ot.getVariables().map(ha=>"$"+ha.name)),Sn)))},Qe=()=>Ot=>Ot.pipe((0,Kt.T)(Wt=>{const Sn=[],ha={};for(const wa of Wt)for(const Ua of wa.fields){if(!Ts.has(Ua.type))continue;const Na=(0,q.Ct)(Ua,wa,Wt);ha[Na]||(ha[Na]=!0,Sn.push(Na))}return Sn})),st=Ot=>Wt=>Wt.pipe((0,Kt.T)(Sn=>{if(!Ot.length)return{names:Sn,selected:[]};const ha=[],wa=[];for(const Ua of Sn)Ot.includes(Ua)&&wa.push(Ua),ha.push(Ua);return{names:ha,selected:wa}})),Et=Ot=>{Q({..._,replaceFields:Ot.currentTarget.checked})},Ct=Ot=>{const Wt=Ot.value??Wn.UY.BinaryOperation;Wt===Wn.UY.WindowFunctions&&(_.window=_.window??Wn.Uj),Q({..._,mode:Wt})},kt=Ot=>{Q({..._,alias:Ot.target.value})},Ut=_.mode??Wn.UY.BinaryOperation;return a.createElement(a.Fragment,null,a.createElement(ie.I,{labelWidth:_n,label:"Mode"},a.createElement(pe.l6,{className:"width-18",options:Fs,value:Fs.find(Ot=>Ot.value===Ut),onChange:Ct})),Ut===Wn.UY.BinaryOperation&&a.createElement(Wa,{options:_,names:Ce.names,onChange:F.onChange}),Ut===Wn.UY.UnaryOperation&&a.createElement(Is,{names:Ce.names,options:_,onChange:F.onChange}),Ut===Wn.UY.ReduceRow&&a.createElement(Cs,{names:Ce.names,selected:Ce.selected,options:_,onChange:F.onChange}),Ut===Wn.UY.CumulativeFunctions&&a.createElement(za,{names:Ce.names,options:_,onChange:F.onChange}),Ut===Wn.UY.WindowFunctions&&a.createElement(ss,{names:Ce.names,options:_,onChange:F.onChange}),Ut===Wn.UY.Index&&a.createElement(_a,{options:_,onChange:F.onChange}),a.createElement(ie.I,{labelWidth:_n,label:"Alias"},a.createElement(Me.p,{className:"width-18",value:_.alias??"",placeholder:(0,Wn.sw)(_),onChange:kt})),a.createElement(ie.I,{labelWidth:_n,label:"Replace all fields"},a.createElement(da.K,{value:!!_.replaceFields,onChange:Et})))},gs={id:ee.F.calculateField,editor:Es,transformation:z.c.calculateFieldTransformer,name:z.c.calculateFieldTransformer.name,description:"Use the row values to calculate a new field.",categories:new Set([v.m.CalculateNewFields]),help:he(ee.F.calculateField).helperDocs};var ps=e(82150);const js=[{value:ps.x1.FieldName,label:"Copy frame name to field name"},{value:ps.x1.Label,label:"Add a label with the frame name"},{value:ps.x1.Drop,label:"Ignore the frame name"}];class As extends a.PureComponent{constructor(_){super(_),this.onModeChanged=Q=>{const{options:me,onChange:De}=this.props,Ce=Q.value??ps.x1.FieldName;De({...me,frameNameMode:Ce})},this.onLabelChanged=Q=>{const{options:me}=this.props;this.props.onChange({...me,frameNameLabel:Q.target.value})}}render(){const{options:_}=this.props,Q=_.frameNameMode??ps.x1.FieldName;return a.createElement("div",null,a.createElement(ie.I,{label:"Name",labelWidth:16,grow:!0},a.createElement(pe.l6,{width:36,options:js,value:js.find(me=>me.value===Q),onChange:this.onModeChanged})),Q===ps.x1.Label&&a.createElement(ie.I,{label:"Label",labelWidth:16,grow:!0},a.createElement(Me.p,{width:36,value:_.frameNameLabel??"",placeholder:"frame",onChange:this.onLabelChanged})))}}const Qr={id:ee.F.concatenate,editor:As,transformation:z.c.concatenateTransformer,name:z.c.concatenateTransformer.name,description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",categories:new Set([v.m.Combine]),help:he(ee.F.concatenate).helperDocs};var nr=e(91410),hr=e(76218),ar=e(9988),Yr=e(63577),Qs=e(75494),cs=e(14578),_s=e(72093),Ys=e(29158);const sr=({transformIndex:F,value:_,index:Q,mappedIndex:me,onChangeEnumValue:De,onRemoveEnumRow:Ce,checkIsEnumUniqueValue:Ne})=>{const _e=(0,Nt.of)(Kr),[Qe,st]=(0,a.useState)(_),[Et,Ct]=(0,a.useState)(Qe===""),[kt,Ut]=(0,a.useState)(null),Ot=(0,a.useRef)(null);(0,a.useEffect)(()=>{Ot.current&&Ot.current.focus()},[Ot]);const Wt=Na=>{Na.currentTarget.value!==""&&Ne(Na.currentTarget.value)&&Na.currentTarget.value!==_?Ut("Enum value already exists"):Ut(null),st(Na.currentTarget.value)},Sn=()=>{if(Ct(!1),Ut(null),Qe===""||kt!==null){Ce(me);return}De(me,Qe)},ha=Na=>{Na.key==="Enter"&&(Na.preventDefault(),Sn())},wa=()=>{Ct(!0)},Ua=()=>{Ce(me)};return a.createElement(Qs.sx,{key:`${F}/${_}`,draggableId:`${F}/${_}`,index:Q},Na=>a.createElement("tr",{key:Q,ref:Na.innerRef,...Na.draggableProps},a.createElement("td",null,a.createElement("div",{className:_e.dragHandle,...Na.dragHandleProps},a.createElement(cs.I,{name:"draggabledots",size:"lg"}))),Et?a.createElement("td",null,a.createElement(Me.p,{ref:Ot,type:"text",value:Qe,onChange:Wt,onBlur:Sn,onKeyDown:ha}),kt&&a.createElement(_s.P,null,kt)):a.createElement("td",{onClick:wa,className:_e.clickableTableCell},_&&_!==""?_:"Click to edit"),a.createElement("td",{className:_e.textAlignCenter},a.createElement(Xa.Gy,{spacing:"sm"},a.createElement(Ys.K,{name:"trash-alt",onClick:Ua,"data-testid":"remove-enum-row","aria-label":"Delete enum row",tooltip:"Delete"})))))},Kr=F=>({dragHandle:(0,ut.css)({cursor:"grab"}),textAlignCenter:(0,ut.css)({textAlign:"center"}),clickableTableCell:(0,ut.css)({cursor:"pointer",width:"100px","&:hover":{color:F.colors.text.maxContrast}})}),io=sr,Mo=({input:F,options:_,transformIndex:Q,onChange:me})=>{const De=(0,Nt.of)(cr),[Ce,Ne]=(0,a.useState)(_.conversions[Q].enumConfig?.text??[]);(0,a.useEffect)(()=>{!_.conversions[Q].enumConfig?.text?.length&&F.length&&_e()},[F]),(0,a.useEffect)(()=>{(()=>{const Wt=Ce.map(wa=>wa),Sn=_.conversions,ha={text:Wt};Sn[Q]={...Sn[Q],enumConfig:ha},me({..._,conversions:Sn})})()},[Q,Ce]);const _e=()=>{const Ot=F.flatMap(Sn=>Sn?.fields??[]).find(Sn=>Sn.name===_.conversions[Q].targetField);if(!Ot)return;const Wt=new Set(Ot?.values);Ce.length>0&&!(0,f.isEqual)(Ce,Array.from(Wt))&&!window.confirm("This action will overwrite the existing configuration. Are you sure you want to continue?")||Ne([...Wt])},Qe=(Ot,Wt)=>{const Sn=[...Ce];Sn.splice(Ot,1,Wt),Ne(Sn)},st=Ot=>{const Wt=[...Ce];Wt.splice(Ot,1),Ne(Wt)},Et=()=>{Ne(["",...Ce])},Ct=(Ot,Wt)=>{Ce.includes(Wt)||Qe(Ot,Wt)},kt=Ot=>Ce.includes(Ot),Ut=Ot=>{if(!Ot.destination)return;const Wt=Ce.length-Ot.source.index-1,Sn=Ce.length-Ot.destination.index-1,ha=[...Ce],wa=ha[Wt];ha.splice(Wt,1),ha.splice(Sn,0,wa),Ne(ha)};return a.createElement(le.C,null,a.createElement(Xa.Gy,null,a.createElement(fe.$n,{size:"sm",icon:"plus",onClick:()=>_e(),className:De.button},"Generate enum values from data"),a.createElement(fe.$n,{size:"sm",icon:"plus",onClick:()=>Et(),className:De.button},"Add enum value")),a.createElement(Xa.gW,null,a.createElement("table",{className:De.compactTable},a.createElement(Qs.JY,{onDragEnd:Ut},a.createElement(Qs.gL,{droppableId:"sortable-enum-config-mappings",direction:"vertical"},Ot=>a.createElement("tbody",{ref:Ot.innerRef,...Ot.droppableProps},[...Ce].reverse().map((Wt,Sn)=>{const ha=Ce.length-Sn-1;return a.createElement(io,{key:`${Q}/${Wt}`,transformIndex:Q,value:Wt,index:Sn,mappedIndex:ha,onChangeEnumValue:Ct,onRemoveEnumRow:st,checkIsEnumUniqueValue:kt})}),Ot.placeholder))))))},cr=F=>({compactTable:(0,ut.css)({"tbody td":{padding:F.spacing(.5)},marginTop:F.spacing(1),marginBottom:F.spacing(2)}),button:(0,ut.css)({marginTop:F.spacing(1)})}),lo={settings:{width:24,isClearable:!1}},Jr=({input:F,options:_,onChange:Q})=>{const me=ar.bx.filter(Ut=>Ut.value!==se.PU.trace),De=(0,we.qt)(!0),Ce=(0,nr.P3)();De.push({label:"Browser",value:"browser"}),De.push({label:"UTC",value:"utc"});for(const Ut of Ce)De.push({label:Ut,value:Ut});const Ne=(0,a.useCallback)(Ut=>Ot=>{const Wt=_.conversions;Wt[Ut]={...Wt[Ut],targetField:Ot??"",dateFormat:void 0},Q({..._,conversions:Wt})},[Q,_]),_e=(0,a.useCallback)(Ut=>Ot=>{const Wt=_.conversions;Wt[Ut]={...Wt[Ut],destinationType:Ot.value},Q({..._,conversions:Wt})},[Q,_]),Qe=(0,a.useCallback)(Ut=>Ot=>{const Wt=_.conversions;Wt[Ut]={...Wt[Ut],dateFormat:Ot.currentTarget.value},Q({..._,conversions:Wt})},[Q,_]),st=(0,a.useCallback)(Ut=>Ot=>{const Wt=_.conversions;Wt[Ut]={...Wt[Ut],joinWith:Ot.currentTarget.value},Q({..._,conversions:Wt})},[Q,_]),Et=(0,a.useCallback)(()=>{Q({..._,conversions:[..._.conversions,{targetField:void 0,destinationType:void 0,dateFormat:void 0}]})},[Q,_]),Ct=(0,a.useCallback)(Ut=>{const Ot=_.conversions;Ot.splice(Ut,1),Q({..._,conversions:Ot})},[Q,_]),kt=(0,a.useCallback)(Ut=>Ot=>{const Wt=_.conversions;Wt[Ut]={...Wt[Ut],timezone:Ot?.value},Q({..._,conversions:Wt})},[Q,_]);return a.createElement(a.Fragment,null,_.conversions.map((Ut,Ot)=>{const Wt=(0,Yr.findField)(F?.[0],Ut.targetField);return a.createElement("div",{key:`${Ut.targetField}-${Ot}`},a.createElement(le.C,null,a.createElement(ie.I,{label:"Field"},a.createElement(hr.O,{context:{data:F},value:Ut.targetField??"",onChange:Ne(Ot),item:lo})),a.createElement(ie.I,{label:"as"},a.createElement(pe.l6,{options:me,value:Ut.destinationType,placeholder:"Type",onChange:_e(Ot),width:18})),Ut.destinationType===se.PU.time&&a.createElement(ie.I,{label:"Input format",tooltip:"Specify the format of the input field so Grafana can parse the date string correctly."},a.createElement(Me.p,{value:Ut.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:Qe(Ot),width:24})),Ut.destinationType===se.PU.string&&a.createElement(a.Fragment,null,(Ut.joinWith?.length||Wt?.type===se.PU.other)&&a.createElement(ie.I,{label:"Join with",tooltip:"Use an explicit separator when joining array values"},a.createElement(Me.p,{value:Ut.joinWith,placeholder:"JSON",onChange:st(Ot),width:9})),Ut.dateFormat||Wt?.type===se.PU.time&&a.createElement(a.Fragment,null,a.createElement(ie.I,{label:"Date format",tooltip:"Specify the output format."},a.createElement(Me.p,{value:Ut.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:Qe(Ot),width:24})),a.createElement(ie.I,{label:"Set timezone",tooltip:"Set the timezone of the date manually"},a.createElement(pe.l6,{options:De,value:Ut.timezone,onChange:kt(Ot),isClearable:!0})))),a.createElement(fe.$n,{size:"md",icon:"trash-alt",variant:"secondary",onClick:()=>Ct(Ot),"aria-label":"Remove convert field type transformer"})),Ut.destinationType===se.PU.enum&&a.createElement(Mo,{input:F,options:_,transformIndex:Ot,onChange:Q}))}),a.createElement(fe.$n,{size:"sm",icon:"plus",onClick:Et,variant:"secondary","aria-label":"Add a convert field type transformer"},"Convert field type"))},co={id:ee.F.convertFieldType,editor:Jr,transformation:z.c.convertFieldTypeTransformer,name:z.c.convertFieldTypeTransformer.name,description:z.c.convertFieldTypeTransformer.description,categories:new Set([v.m.Reformat]),help:he(ee.F.convertFieldType).helperDocs};var Rr=e(54479);class Ho extends a.PureComponent{constructor(_){super(_),this.onFieldToggle=Q=>{const{selected:me}=this.state;me.indexOf(Q)>-1?this.onChange(me.filter(De=>De!==Q)):this.onChange([...me,Q])},this.onChange=Q=>{const{regex:me,isRegexValid:De}=this.state,Ce={...this.props.options,include:{names:Q}};me&&De&&(Ce.include=Ce.include??{},Ce.include.pattern=me),this.setState({selected:Q},()=>{this.props.onChange(Ce)})},this.onInputBlur=Q=>{const{selected:me,regex:De}=this.state;let Ce=!0;try{De&&(0,Rr.dO)(De)}catch{Ce=!1}Ce?this.props.onChange({...this.props.options,include:{pattern:De}}):this.props.onChange({...this.props.options,include:{names:me}}),this.setState({isRegexValid:Ce})},this.onVariableChange=Q=>{this.props.onChange({...this.props.options,include:{variable:Q.value}}),this.setState({variable:Q.value})},this.onFromVariableChange=Q=>{const me=Q.currentTarget.checked;this.props.onChange({...this.props.options,byVariable:me}),this.setState({byVariable:me})},this.state={include:_.options.include?.names||[],regex:_.options.include?.pattern,variable:_.options.include?.variable,byVariable:_.options.byVariable||!1,options:[],variables:[],selected:[],isRegexValid:!0}}componentDidMount(){this.initOptions()}componentDidUpdate(_){this.props.input!==_.input&&this.initOptions()}initOptions(){const{input:_,options:Q}=this.props,me=Array.from(Q.include?.names??[]),De=(0,Oe.w)().getVariables().map(_e=>({label:"$"+_e.name,value:"$"+_e.name})),Ce=[],Ne={};for(const _e of _)for(const Qe of _e.fields){const st=(0,q.Ct)(Qe,_e,_);let Et=Ne[st];Et||(Et=Ne[st]={name:st,count:0},Ce.push(Et)),Et.count++}if(Q.include?.pattern)try{const _e=(0,Rr.dO)(Q.include.pattern);for(const Qe of Ce)_e.test(Qe.name)&&me.push(Qe.name)}catch(_e){console.error(_e)}if(me.length){const _e=Ce.filter(Qe=>me.includes(Qe.name));this.setState({options:Ce,selected:_e.map(Qe=>Qe.name),variables:De,byVariable:Q.byVariable||!1,variable:Q.include?.variable,regex:Q.include?.pattern})}else this.setState({options:Ce,selected:Ce.map(_e=>_e.name),variables:De,byVariable:Q.byVariable||!1,variable:Q.include?.variable,regex:Q.include?.pattern})}render(){const{options:_,selected:Q,isRegexValid:me}=this.state;return a.createElement("div",null,a.createElement(le.C,{label:"Use variable"},a.createElement(ie.I,{label:"From variable"},a.createElement(da.K,{value:this.state.byVariable,onChange:this.onFromVariableChange}))),this.state.byVariable?a.createElement(le.C,null,a.createElement(ie.I,{label:"Variable"},a.createElement(pe.l6,{value:this.state.variable,onChange:this.onVariableChange,options:this.state.variables||[]}))):a.createElement(le.C,{label:"Identifier"},a.createElement(ie.I,{label:"Identifier",invalid:!me,error:me?void 0:"Invalid pattern"},a.createElement(Me.p,{placeholder:"Regular expression pattern",value:this.state.regex||"",onChange:De=>this.setState({regex:De.currentTarget.value}),onBlur:this.onInputBlur,width:25})),_.map((De,Ce)=>{const Ne=`${De.name}${De.count>1?" ("+De.count+")":""}`,_e=Q.indexOf(De.name)>-1;return a.createElement(Va.m,{key:`${De.name}/${Ce}`,onClick:()=>{this.onFieldToggle(De.name)},label:Ne,selected:_e})})))}}const Xr={id:ee.F.filterFieldsByName,editor:Ho,transformation:z.c.filterFieldsByNameTransformer,name:z.c.filterFieldsByNameTransformer.name,description:"Removes part of the query results using a regex pattern. The pattern can be inclusive or exclusive.",categories:new Set([v.m.Filter]),help:he(ee.F.filterFieldsByName).helperDocs};class xo extends a.PureComponent{constructor(_){super(_),this.onFieldToggle=Q=>{const{selected:me}=this.state;me.indexOf(Q)>-1?this.onChange(me.filter(De=>De!==Q)):this.onChange([...me,Q])},this.onChange=Q=>{this.setState({selected:Q}),this.props.onChange({...this.props.options,include:Q.join("|")})},this.state={include:_.options.include||"",options:[],selected:[]}}componentDidMount(){this.initOptions()}componentDidUpdate(_){this.props.input!==_.input&&this.initOptions()}initOptions(){const{input:_,options:Q}=this.props,me=Q.include?Q.include.split("|"):[],De=[],Ce={};for(const Ne of _)if(Ne.refId){let _e=Ce[Ne.refId];_e||(_e=Ce[Ne.refId]={refId:Ne.refId,count:0},De.push(_e)),_e.count++}if(me.length){const Ne=[],_e=[];for(const Qe of De)me.includes(Qe.refId)&&_e.push(Qe),Ne.push(Qe);this.setState({options:Ne,selected:_e.map(Qe=>Qe.refId)})}else this.setState({options:De,selected:[]})}render(){const{options:_,selected:Q}=this.state,{input:me}=this.props;return a.createElement(a.Fragment,null,me.length<=1&&a.createElement("div",null,a.createElement(_s.P,null,"Filter data by query expects multiple queries in the input.")),a.createElement(ie.I,{label:"Series refId",labelWidth:16,shrink:!0},a.createElement(Xa.Gy,{spacing:"xs",align:"flex-start",wrap:!0},_.map((De,Ce)=>{const Ne=`${De.refId}${De.count>1?" ("+De.count+")":""}`,_e=Q.indexOf(De.refId)>-1;return a.createElement(Va.m,{key:`${De.refId}/${Ce}`,onClick:()=>{this.onFieldToggle(De.refId)},label:Ne,selected:_e})}))))}}const Ur={id:ee.F.filterByRefId,editor:xo,transformation:z.c.filterFramesByRefIdTransformer,name:z.c.filterFramesByRefIdTransformer.name,description:"Filter data by query. This is useful if you are sharing the results from a different panel that has many queries and you want to only visualize a subset of that in this panel.",categories:new Set([v.m.Filter]),help:he(ee.F.filterByRefId).helperDocs};var Js=e(15400);const uo={settings:{width:30,filter:F=>F.type===se.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null};function mo({input:F,options:_,onChange:Q}){const me=(0,a.useCallback)(Qe=>{Q({..._,stringField:Qe??""})},[Q,_]),De=(0,a.useCallback)(Qe=>{const st=Qe.value??Js.gs.UpperCase;Q({..._,outputFormat:st})},[Q,_]),Ce=(0,a.useCallback)(Qe=>{Q({..._,substringStart:Qe??0})},[Q,_]),Ne=(0,a.useCallback)(Qe=>{Q({..._,substringEnd:Qe??0})},[Q,_]),_e=Object.values(Js.gs).map(Qe=>({label:Qe,value:Qe}));return a.createElement(a.Fragment,null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Field",labelWidth:10},a.createElement(hr.O,{context:{data:F},value:_.stringField??"",onChange:me,item:uo})),a.createElement(ie.I,{label:"Format",labelWidth:10},a.createElement(pe.l6,{options:_e,value:_.outputFormat,onChange:De,width:20}))),_.outputFormat===Js.gs.Substring&&a.createElement(le.C,null,a.createElement(ie.I,{label:"Substring range",labelWidth:15},a.createElement(ls.Q,{min:0,value:_.substringStart??0,onChange:Ce,width:7})),a.createElement(ie.I,null,a.createElement(ls.Q,{min:0,value:_.substringEnd??0,onChange:Ne,width:7}))))}const fo={id:ee.F.formatString,editor:mo,transformation:z.c.formatStringTransformer,name:z.c.formatStringTransformer.name,state:rt.pn.beta,description:z.c.formatStringTransformer.description,categories:new Set([v.m.Reformat])};function Vr({input:F,options:_,onChange:Q}){const me=[],De=(0,we.qt)(!0);for(const Qe of F)for(const st of Qe.fields)if(st.type==="time"){const Et=(0,q.Ct)(st,Qe,F);me.push({label:Et,value:Et})}const Ce=(0,a.useCallback)(Qe=>{const st=Qe?.value!==void 0?Qe.value:"";Q({..._,timeField:st})},[Q,_]),Ne=(0,a.useCallback)(Qe=>{const st=Qe.target.value;Q({..._,outputFormat:st})},[Q,_]),_e=(0,a.useCallback)(Qe=>{const st=Qe?.value!==void 0?Qe.value:"";Q({..._,timezone:st})},[Q,_]);return a.createElement(a.Fragment,null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Time Field",labelWidth:15,grow:!0},a.createElement(pe.l6,{options:me,value:_.timeField,onChange:Ce,placeholder:"time",isClearable:!0})),a.createElement(ie.I,{label:"Format",labelWidth:10,tooltip:a.createElement(a.Fragment,null,"The output format for the field specified as a"," ",a.createElement("a",{href:"https://momentjs.com/docs/#/displaying/",target:"_blank",rel:"noopener noreferrer"},"Moment.js format string"),"."),interactive:!0},a.createElement(Me.p,{onChange:Ne,value:_.outputFormat})),a.createElement(ie.I,{label:"Set Timezone",tooltip:"Set the timezone of the date manually",labelWidth:20},a.createElement(pe.l6,{options:De,value:_.timezone,onChange:_e,isClearable:!0}))))}const Oo={id:ee.F.formatTime,editor:Vr,transformation:z.c.formatTimeTransformer,name:z.c.formatTimeTransformer.name,state:rt.pn.alpha,description:z.c.formatTimeTransformer.description,help:he(ee.F.formatTime).helperDocs};var vr=e(25094),Pt=e(67061),Gt=e(42418);const Pn=({input:F,options:_,onChange:Q})=>{const me=(0,we.ZI)(F),De=(0,a.useCallback)(Qe=>st=>{Q({..._,fields:{..._.fields,[Qe]:st}})},[Q]);let Ce,Ne=!1;for(const Qe of Object.values(_.fields))Qe.aggregations.length>0&&Qe.operation!==null&&(Ne=!0),Qe.operation===vr.R3.groupBy&&(Ce=!0);const _e=Ne&&!Ce;return a.createElement(Pt.B,{direction:"column"},_e&&a.createElement(Gt.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),me.map(Qe=>a.createElement(Ln,{onConfigChange:De(Qe),fieldName:Qe,config:_.fields[Qe],key:Qe})))},hn=[{label:"Group by",value:vr.R3.groupBy},{label:"Calculate",value:vr.R3.aggregate}],Ln=({fieldName:F,config:_,onConfigChange:Q})=>{const me=(0,Nt.$j)(),De=Hn(me),Ce=(0,a.useCallback)(Ne=>{Q({aggregations:_?.aggregations??[],operation:Ne?.value??null})},[_,Q]);return a.createElement(ie.I,{className:De.label,label:F,grow:!0,shrink:!0},a.createElement(Pt.B,{gap:.5,direction:"row"},a.createElement("div",{className:De.operation},a.createElement(pe.l6,{options:hn,value:_?.operation,placeholder:"Ignored",onChange:Ce,isClearable:!0})),_?.operation===vr.R3.aggregate&&a.createElement(_t.S,{className:De.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:_.aggregations,onChange:Ne=>{Q({..._,aggregations:Ne})}})))},Hn=F=>({label:(0,ut.css)`
      label {
        min-width: ${F.spacing(32)};
      }
    `,operation:(0,ut.css)`
      flex-shrink: 0;
      height: 100%;
      width: ${F.spacing(24)};
    `,aggregations:(0,ut.css)`
      flex-grow: 1;
    `}),kn={id:ee.F.groupBy,editor:Pn,transformation:z.c.groupByTransformer,name:z.c.groupByTransformer.name,description:z.c.groupByTransformer.description,categories:new Set([v.m.Combine,v.m.CalculateNewFields,v.m.Reformat]),help:he(ee.F.groupBy).helperDocs};var xa=e(68133),ua=e(46819),ra=e(88575);const os=({input:F,options:_,onChange:Q})=>{const me=(0,we.ZI)(F),De=_.showSubframeHeaders===void 0?xa.l:_.showSubframeHeaders,Ce=(0,a.useCallback)(Et=>Ct=>{Q({..._,fields:{..._.fields,[Et]:Ct}})},[Q]),Ne=(0,a.useCallback)(()=>{const Et=_.showSubframeHeaders===void 0?!xa.l:!_.showSubframeHeaders;Q({showSubframeHeaders:Et,fields:{..._.fields}})},[Q]);let _e,Qe=!1;for(const Et of Object.values(_.fields))Et.aggregations.length>0&&Et.operation!==null&&(Qe=!0),Et.operation===vr.R3.groupBy&&(_e=!0);const st=Qe&&!_e;return a.createElement(ua.B,{direction:"column"},st&&a.createElement(Gt.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),a.createElement("div",null,me.map(Et=>a.createElement(es,{onConfigChange:Ce(Et),fieldName:Et,config:_.fields[Et],key:Et}))),a.createElement(ra.D,{label:"Show field names in nested tables",description:"If enabled nested tables will show field names as a table header"},a.createElement(da.d,{value:De,onChange:Ne})))},Ra=[{label:"Group by",value:vr.R3.groupBy},{label:"Calculate",value:vr.R3.aggregate}],es=({fieldName:F,config:_,onConfigChange:Q})=>{const me=(0,Nt.$j)(),De=zs(me),Ce=(0,a.useCallback)(Ne=>{Q({aggregations:_?.aggregations??[],operation:Ne?.value??null})},[_,Q]);return a.createElement(ie.I,{className:De.label,label:F,grow:!0,shrink:!0},a.createElement(ua.B,{gap:.5,direction:"row",wrap:!1},a.createElement("div",{className:De.operation},a.createElement(pe.l6,{options:Ra,value:_?.operation,placeholder:"Ignored",onChange:Ce,isClearable:!0})),_?.operation===vr.R3.aggregate&&a.createElement(_t.S,{className:De.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:_.aggregations,onChange:Ne=>{Q({..._,aggregations:Ne})}})))},zs=F=>({label:(0,ut.css)({minWidth:F.spacing(32)}),operation:(0,ut.css)({flexShrink:0,height:"100%",width:F.spacing(24)}),aggregations:(0,ut.css)({flexGrow:1})}),Ws={id:ee.F.groupToNestedTable,editor:os,transformation:z.c.groupToNestedTable,name:z.c.groupToNestedTable.name,description:z.c.groupToNestedTable.description,categories:new Set([v.m.Combine,v.m.CalculateNewFields,v.m.Reformat])};var Rs=e(81010);const xr=({input:F,options:_,onChange:Q})=>{const me=(0,we.ZI)(F).map(st=>({label:st,value:st})),De=(0,a.useCallback)(st=>{Q({..._,columnField:st?.value})},[Q,_]),Ce=(0,a.useCallback)(st=>{Q({..._,rowField:st?.value})},[Q,_]),Ne=(0,a.useCallback)(st=>{Q({..._,valueField:st?.value})},[Q,_]),_e=[{label:"Null",value:Rs.N.Null,description:"Null value"},{label:"True",value:Rs.N.True,description:"Boolean true value"},{label:"False",value:Rs.N.False,description:"Boolean false value"},{label:"Empty",value:Rs.N.Empty,description:"Empty string"}],Qe=(0,a.useCallback)(st=>{Q({..._,emptyValue:st?.value})},[Q,_]);return a.createElement(a.Fragment,null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Column",labelWidth:8},a.createElement(pe.l6,{options:me,value:_.columnField,onChange:De,isClearable:!0})),a.createElement(ie.I,{label:"Row",labelWidth:8},a.createElement(pe.l6,{options:me,value:_.rowField,onChange:Ce,isClearable:!0})),a.createElement(ie.I,{label:"Cell Value",labelWidth:10},a.createElement(pe.l6,{options:me,value:_.valueField,onChange:Ne,isClearable:!0})),a.createElement(ie.I,{label:"Empty Value"},a.createElement(pe.l6,{options:_e,value:_.emptyValue,onChange:Qe,isClearable:!0}))))},dr={id:ee.F.groupingToMatrix,editor:xr,transformation:z.c.groupingToMatrixTransformer,name:z.c.groupingToMatrixTransformer.name,description:"Takes a three fields combination and produces a Matrix.",categories:new Set([v.m.Combine,v.m.Reformat]),help:he(ee.F.groupingToMatrix).helperDocs};var Us=e(77678);const $r=({input:F,options:_,onChange:Q})=>{const[De,Ce]=(0,a.useState)({bucketCount:!(0,we.N_)(_.bucketCount||""),bucketSize:!(0,we.N_)(_.bucketSize||""),bucketOffset:!(0,we.N_)(_.bucketOffset||"")}),Ne=(0,a.useCallback)(Wt=>{Q({..._,bucketCount:Wt})},[Q,_]),_e=(0,a.useCallback)(Wt=>{Q({..._,bucketSize:Wt})},[Q,_]),Qe=(0,a.useCallback)(Wt=>{Q({..._,bucketOffset:Wt})},[Q,_]),st=(0,a.useCallback)(Wt=>{Ce({...De,bucketCount:!(0,we.N_)(Wt)}),Q({..._,bucketCount:Number(Wt)===0?void 0:Number(Wt)})},[Q,_,De]),Et=(0,a.useCallback)(Wt=>{Ce({...De,bucketSize:!(0,we.N_)(Wt)}),Q({..._,bucketSize:Wt})},[Q,_,De,Ce]),Ct=(0,a.useCallback)(Wt=>{Ce({...De,bucketOffset:!(0,we.N_)(Wt)}),Q({..._,bucketOffset:Wt})},[Q,_,De,Ce]),kt=(0,a.useCallback)(()=>{Q({..._,combine:!_.combine})},[Q,_]),Ot=(0,Oe.w)().getVariables().map(Wt=>({value:Wt.name,label:Wt.label||Wt.name,origin:be.$0.Template}));if(!X.$.featureToggles.transformationsVariableSupport){let Wt;typeof _.bucketSize=="string"?Wt=parseInt(_.bucketSize,10):Wt=_.bucketSize;let Sn;return typeof _.bucketOffset=="string"?Sn=parseInt(_.bucketOffset,10):Sn=_.bucketOffset,a.createElement("div",null,a.createElement(le.C,null,a.createElement(ie.I,{labelWidth:18,label:Us.Rt.bucketCount.name,tooltip:Us.Rt.bucketCount.description},a.createElement(ls.Q,{value:_.bucketCount,placeholder:"Default: 30",onChange:Ne,min:0}))),a.createElement(le.C,null,a.createElement(ie.I,{labelWidth:18,label:Us.Rt.bucketSize.name,tooltip:Us.Rt.bucketSize.description},a.createElement(ls.Q,{value:Wt,placeholder:"auto",onChange:_e,min:0}))),a.createElement(le.C,null,a.createElement(ie.I,{labelWidth:18,label:Us.Rt.bucketOffset.name,tooltip:Us.Rt.bucketOffset.description},a.createElement(ls.Q,{value:Sn,placeholder:"none",onChange:Qe,min:0}))),a.createElement(le.C,null,a.createElement(ie.I,{labelWidth:18,label:Us.Rt.combine.name,tooltip:Us.Rt.combine.description},a.createElement(da.K,{value:_.combine??!1,onChange:kt}))))}return a.createElement("div",null,a.createElement(le.C,null,a.createElement(ie.I,{invalid:De.bucketCount,error:"Value needs to be an integer or a variable",labelWidth:18,label:Us.Rt.bucketCount.name,tooltip:Us.Rt.bucketCount.description},a.createElement(Ue.y,{suggestions:Ot,value:_.bucketCount,placeholder:"Default: 30",onChange:st}))),a.createElement(le.C,null,a.createElement(ie.I,{invalid:De.bucketSize,error:"Value needs to be an integer or a variable",labelWidth:18,label:Us.Rt.bucketSize.name,tooltip:Us.Rt.bucketSize.description},a.createElement(Ue.y,{suggestions:Ot,value:_.bucketSize,placeholder:"auto",onChange:Et}))),a.createElement(le.C,null,a.createElement(ie.I,{labelWidth:18,label:Us.Rt.bucketOffset.name,tooltip:Us.Rt.bucketOffset.description,invalid:De.bucketOffset,error:"Value needs to be an integer or a variable"},a.createElement(Ue.y,{suggestions:Ot,value:_.bucketOffset,placeholder:"none",onChange:Ct}))),a.createElement(le.C,null,a.createElement(ie.I,{labelWidth:18,label:Us.Rt.combine.name,tooltip:Us.Rt.combine.description},a.createElement(da.K,{value:_.combine??!1,onChange:kt}))))},ks={id:ee.F.histogram,editor:$r,transformation:z.c.histogramTransformer,name:z.c.histogramTransformer.name,description:z.c.histogramTransformer.description,categories:new Set([v.m.CreateNewVisualization]),help:he(ee.F.histogram).helperDocs};var Ka=e(41511),ys=e(64278);const Er=[{value:Ka.W.outer,label:"OUTER (TIME SERIES)",description:"Keep all rows from any table with a value. Join on distinct field values. Performant and best used for time series."},{value:Ka.W.outerTabular,label:"OUTER (TABULAR)",description:"Join on a field value with duplicated values. Non performant outer join best used for tabular(SQL like) data."},{value:Ka.W.inner,label:"INNER",description:"Combine data from two tables whenever there are matching values in a fields common to both tables."}];function ds({input:F,options:_,onChange:Q}){const me=(0,ys.sE)(F),De=(0,ys.m3)(me),Ce=(0,Oe.w)().getVariables().map(Qe=>({value:"$"+Qe.name,label:"$"+Qe.name})),Ne=(0,a.useCallback)(Qe=>{Q({..._,byField:Qe?.value})},[Q,_]),_e=(0,a.useCallback)(Qe=>{Q({..._,mode:Qe?.value})},[Q,_]);return a.createElement(a.Fragment,null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Mode",labelWidth:8,grow:!0},a.createElement(pe.l6,{options:Er,value:_.mode??Ka.W.outer,onChange:_e}))),a.createElement(le.C,null,a.createElement(ie.I,{label:"Field",labelWidth:8,grow:!0},a.createElement(pe.l6,{options:[...De,...Ce],value:_.byField,onChange:Ne,placeholder:"time",isClearable:!0}))))}const Zr={id:ee.F.joinByField,aliasIds:[ee.F.seriesToColumns],editor:ds,transformation:z.c.joinByFieldTransformer,name:z.c.joinByFieldTransformer.name,description:z.c.joinByFieldTransformer.description,categories:new Set([v.m.Combine]),help:he(ee.F.joinByField).helperDocs};var go=e(6829);const Io=[{value:go.n.Columns,label:"Columns"},{value:go.n.Rows,label:"Rows"}],Ao=({input:F,options:_,onChange:Q})=>{const{labelNames:De,selected:Ce}=(0,a.useMemo)(()=>{let Qe=[],st={};for(const Ct of F)for(const kt of Ct.fields)if(kt.labels)for(const Ut of Object.keys(kt.labels))st[Ut]||(Qe.push({value:Ut,label:Ut}),st[Ut]=!0);const Et=new Set(_.keepLabels?.length?_.keepLabels:Object.keys(st));return{labelNames:Qe,selected:Et}},[_.keepLabels,F]),Ne=Qe=>{Q({..._,valueLabel:Qe?.value})},_e=Qe=>{if(Ce.has(Qe)?Ce.delete(Qe):Ce.add(Qe),Ce.size===De.length||!Ce.size){const{keepLabels:st,...Et}=_;Q(Et)}else Q({..._,keepLabels:[...Ce]})};return a.createElement("div",null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Mode",labelWidth:20},a.createElement(ce.z,{options:Io,value:_.mode??go.n.Columns,onChange:Qe=>Q({..._,mode:Qe})}))),a.createElement(le.C,null,a.createElement(ie.I,{label:"Labels",labelWidth:20},a.createElement(Pt.B,{gap:1,wrap:"wrap"},De.map((Qe,st)=>{const Et=Qe.label;return a.createElement(Va.m,{key:`${Et}/${st}`,onClick:()=>_e(Et),label:Et,selected:Ce.has(Et)})})))),_.mode!==go.n.Rows&&a.createElement(le.C,null,a.createElement(ie.I,{label:"Value field name",labelWidth:20,tooltip:"Replace the value field name with a label",htmlFor:"labels-to-fields-as-name"},a.createElement(pe.l6,{inputId:"labels-to-fields-as-name",isClearable:!0,allowCustomValue:!1,placeholder:"(Optional) Select label",options:De,value:_?.valueLabel,onChange:Ne,className:"min-width-16"}))))},Go={id:ee.F.labelsToFields,editor:Ao,transformation:z.c.labelsToFieldsTransformer,name:z.c.labelsToFieldsTransformer.name,description:`Groups series by time and return labels or tags as fields.
                Useful for showing time series with labels in a table where each label key becomes a separate column.`,categories:new Set([v.m.Reformat]),help:he(ee.F.labelsToFields).helperDocs},_i=({options:F,onChange:_})=>{const[Q,me]=(0,a.useState)(!1),De=(0,a.useCallback)(Qe=>{_({...F,limitField:Number(Qe.currentTarget.value)})},[_,F]),Ce=(0,a.useCallback)(Qe=>{me(!(0,we.N_)(Qe)),_({...F,limitField:Qe})},[_,F]),_e=(0,Oe.w)().getVariables().map(Qe=>({value:Qe.name,label:Qe.label||Qe.name,origin:be.$0.Template}));return X.$.featureToggles.transformationsVariableSupport?a.createElement(a.Fragment,null,a.createElement(le.C,null,a.createElement(Ue.y,{invalid:Q,error:"Value needs to be an integer or a variable",value:String(F.limitField),onChange:Ce,placeholder:"Value or variable",suggestions:_e}))):a.createElement(a.Fragment,null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Limit",labelWidth:8},a.createElement(Me.p,{placeholder:"Limit count",pattern:"[0-9]*",value:F.limitField,onChange:De,width:25}))))},bi={id:ee.F.limit,editor:_i,transformation:z.c.limitTransformer,name:z.c.limitTransformer.name,description:"Limit the number of items displayed.",categories:new Set([v.m.Filter]),help:he(ee.F.limit).helperDocs},ur=({input:F,options:_,onChange:Q})=>F.length<=1?a.createElement(_s.P,null,"Merge has no effect when applied on a single frame."):null,ri={id:ee.F.merge,editor:ur,transformation:z.c.mergeTransformer,name:z.c.mergeTransformer.name,description:`Merge many series/tables and return a single table where mergeable values will be combined into the same row.
                Useful for showing multiple series, tables or a combination of both visualized in a table.`,categories:new Set([v.m.Combine]),help:he(ee.F.merge).helperDocs};var zi=e(82280),Ss=e(94753);const po=({options:F,input:_,onChange:Q})=>{const{indexByName:me,excludeByName:De,renameByName:Ce,includeByName:Ne}=F,_e=(0,we.ZI)(_),Qe=(0,a.useMemo)(()=>Bo(_e,me),[_e,me]),st=Ne&&Object.keys(Ne).length>0?"include":"exclude",Et=(0,a.useCallback)((Ot,Wt)=>{Q({...F,excludeByName:{...De,[Ot]:Wt}})},[Q,F,De]),Ct=(0,a.useCallback)((Ot,Wt)=>{const Sn={...F,includeByName:{...Ne,[Ot]:!Wt}};Q(Sn)},[Q,F,Ne]),kt=(0,a.useCallback)(Ot=>{if(!Ot||!Ot.destination)return;const Wt=Ot.source.index,Sn=Ot.destination.index;Wt!==Sn&&Q({...F,indexByName:Lo(_e,Wt,Sn)})},[Q,F,_e]),Ut=(0,a.useCallback)((Ot,Wt)=>{Q({...F,renameByName:{...F.renameByName,[Ot]:Wt}})},[Q,F]);return _.length>1?a.createElement(_s.P,null,"Organize fields only works with a single frame. Consider applying a join transformation or filtering the input first."):a.createElement(Qs.JY,{onDragEnd:kt},a.createElement(Qs.gL,{droppableId:"sortable-fields-transformer",direction:"vertical"},Ot=>a.createElement("div",{ref:Ot.innerRef,...Ot.droppableProps},Qe.map((Wt,Sn)=>{const ha=Ne&&Wt in Ne?Ne[Wt]:!1,wa=st==="include"?ha:!De[Wt],Ua=st==="include"?Ct:Et;return a.createElement(Ro,{fieldName:Wt,renamedFieldName:Ce[Wt],index:Sn,onToggleVisibility:Ua,onRenameField:Ut,visible:wa,key:Wt})}),Ot.placeholder)))};po.displayName="OrganizeFieldsTransformerEditor";const Ro=({fieldName:F,renamedFieldName:_,index:Q,visible:me,onToggleVisibility:De,onRenameField:Ce})=>{const Ne=(0,Nt.of)(Ci);return a.createElement(Qs.sx,{draggableId:F,index:Q},_e=>a.createElement(ue.a,{marginBottom:.5,display:"flex",gap:0,ref:_e.innerRef,..._e.draggableProps},a.createElement(gt.c,{width:60,as:"div"},a.createElement(Pt.B,{gap:0,justifyContent:"flex-start",alignItems:"center",width:"100%"},a.createElement("span",{..._e.dragHandleProps},a.createElement(cs.I,{name:"draggabledots",title:"Drag and drop to reorder",size:"lg",className:Ne.draggable})),a.createElement(Ys.K,{className:Ne.toggle,size:"md",name:me?"eye":"eye-slash",onClick:()=>De(F,me),tooltip:me?"Disable":"Enable"}),a.createElement(Ss.E,{truncate:!0,element:"p",variant:"bodySmall",weight:"bold"},F))),a.createElement(Me.p,{defaultValue:_||"",placeholder:`Rename ${F}`,onBlur:Qe=>Ce(F,Qe.currentTarget.value)})))};Ro.displayName="DraggableFieldName";const Ci=F=>({toggle:(0,ut.css)({margin:F.spacing(0,1),color:F.colors.text.secondary}),draggable:(0,ut.css)({opacity:.4,"&:hover":{color:F.colors.text.maxContrast}})}),Lo=(F,_,Q)=>{const me=Array.from(F),[De]=me.splice(_,1);return me.splice(Q,0,De),me.reduce((Ce,Ne,_e)=>(Ce[Ne]=_e,Ce),{})},Bo=(F,_={})=>{if(!_||Object.keys(_).length===0)return F;const Q=(0,zi.X)(_);return F.sort(Q)},jo={id:ee.F.organize,editor:po,transformation:z.c.organizeFieldsTransformer,name:z.c.organizeFieldsTransformer.name,description:"Allows the user to re-order, hide, or rename fields / columns. Useful when data source doesn't allow overrides for visualizing data.",categories:new Set([v.m.ReorderAndRename]),help:he(ee.F.organize).helperDocs};var Nr=e(21128),Ns=e(13544);const oi=({options:F,onChange:_})=>{const Q=[{label:"Series to rows",value:Nr.rV.SeriesToRows,description:"Create a table with one row for each series value"},{label:"Reduce fields",value:Nr.rV.ReduceFields,description:"Collapse each field into a single value"}],me=(0,a.useCallback)(Ne=>{const _e=Ne.value;_({...F,mode:_e,includeTimeField:_e===Nr.rV.ReduceFields?!!F.includeTimeField:!1})},[_,F]),De=(0,a.useCallback)(()=>{_({...F,includeTimeField:!F.includeTimeField})},[_,F]),Ce=(0,a.useCallback)(()=>{_({...F,labelsToFields:!F.labelsToFields})},[_,F]);return a.createElement(a.Fragment,null,a.createElement(ie.I,{label:"Mode","data-testid":Ns.Tp.components.Transforms.Reduce.modeLabel,grow:!0,labelWidth:16},a.createElement(pe.l6,{options:Q,value:Q.find(Ne=>Ne.value===F.mode)||Q[0],onChange:me})),a.createElement(ie.I,{label:"Calculations","data-testid":Ns.Tp.components.Transforms.Reduce.calculationsLabel,grow:!0,labelWidth:16},a.createElement(_t.S,{placeholder:"Choose Stat",allowMultiple:!0,stats:F.reducers||[],onChange:Ne=>{_({...F,reducers:Ne})}})),F.mode===Nr.rV.ReduceFields&&a.createElement(ie.I,{htmlFor:"include-time-field",labelWidth:16,label:"Include time"},a.createElement(da.K,{id:"include-time-field",value:!!F.includeTimeField,onChange:De})),F.mode!==Nr.rV.ReduceFields&&a.createElement(ie.I,{htmlFor:"labels-to-fields",labelWidth:16,label:"Labels to fields"},a.createElement(da.K,{id:"labels-to-fields",value:!!F.labelsToFields,onChange:Ce})))},ki={id:ee.F.reduce,editor:oi,transformation:z.c.reduceTransformer,name:z.c.reduceTransformer.name,description:z.c.reduceTransformer.description,categories:new Set([v.m.CalculateNewFields]),help:he(ee.F.reduce).helperDocs};class Ti extends a.PureComponent{constructor(_){super(_),this.handleRegexChange=Q=>{const me=Q.currentTarget.value;let De=!0;if(me)try{me&&(0,Rr.dO)(me)}catch{De=!1}this.setState(Ce=>({...Ce,regex:me,isRegexValid:De}))},this.handleRenameChange=Q=>{const me=Q.currentTarget.value;this.setState(De=>({...De,renamePattern:me}))},this.handleRegexBlur=Q=>{const me=Q.currentTarget.value;let De=!0;try{me&&(0,Rr.dO)(me)}catch{De=!1}this.setState({isRegexValid:De},()=>{De&&this.props.onChange({...this.props.options,regex:me})})},this.handleRenameBlur=Q=>{const me=Q.currentTarget.value;this.setState({renamePattern:me},()=>this.props.onChange({...this.props.options,renamePattern:me}))},this.state={regex:_.options.regex,renamePattern:_.options.renamePattern,isRegexValid:!0}}render(){const{regex:_,renamePattern:Q,isRegexValid:me}=this.state;return a.createElement(a.Fragment,null,a.createElement(ie.I,{label:"Match",labelWidth:16,invalid:!me,error:me?void 0:"Invalid pattern"},a.createElement(Me.p,{placeholder:"Regular expression pattern",value:_||"",onChange:this.handleRegexChange,onBlur:this.handleRegexBlur,width:25})),a.createElement(ie.I,{label:"Replace",labelWidth:16},a.createElement(Me.p,{placeholder:"Replacement pattern",value:Q||"",onChange:this.handleRenameChange,onBlur:this.handleRenameBlur,width:25})))}}const Hi={id:ee.F.renameByRegex,editor:Ti,transformation:z.c.renameByRegexTransformer,name:z.c.renameByRegexTransformer.name,description:"Renames part of the query result by using regular expression with placeholders.",categories:new Set([v.m.ReorderAndRename]),help:he(ee.F.renameByRegex).helperDocs},Si=({input:F,options:_,onChange:Q})=>null,Mi={id:ee.F.seriesToRows,editor:Si,transformation:z.c.seriesToRowsTransformer,name:z.c.seriesToRowsTransformer.name,description:`Merge many series and return a single series with time, metric and value as columns.
                Useful for showing multiple time series visualized in a table.`,categories:new Set([v.m.Combine,v.m.Reformat]),help:he(ee.F.seriesToRows).helperDocs},Gi=({input:F,options:_,onChange:Q})=>{const me=(0,we.ZI)(F).map(Qe=>({label:Qe,value:Qe})),Ce=(0,Oe.w)().getVariables().map(Qe=>({label:"$"+Qe.name,value:"$"+Qe.name})),Ne=(0,a.useCallback)((Qe,st)=>{Q({..._,sort:[st]})},[Q,_]),_e=_.sort?.length?_.sort:[{}];return a.createElement("div",null,_e.map((Qe,st)=>a.createElement(le.C,{key:`${Qe.field}/${st}`},a.createElement(ie.I,{label:"Field",labelWidth:10,grow:!0},a.createElement(pe.l6,{options:X.$.featureToggles.transformationsVariableSupport?[...me,...Ce]:me,value:Qe.field,placeholder:"Select field",onChange:Et=>{Ne(st,{...Qe,field:Et.value})}})),a.createElement(ie.I,{label:"Reverse"},a.createElement(da.K,{value:!!Qe.desc,onChange:()=>{Ne(st,{...Qe,desc:!Qe.desc})}})))))},ii={id:ee.F.sortBy,editor:Gi,transformation:z.c.sortByTransformer,name:z.c.sortByTransformer.name,description:z.c.sortByTransformer.description,categories:new Set([v.m.ReorderAndRename]),help:he(ee.F.sortBy).helperDocs};function wr({options:F,onChange:_}){const[Q,me]=(0,a.useState)(F),De=ho(),Ce=Uo(),Ne=()=>{Q.push({path:""}),me([...Q]),st()},_e=Et=>{Q&&(Q.splice(Et,1),me([...Q]),st())},Qe=(Et,Ct,kt)=>{Q&&(kt==="alias"?Q[Ct].alias=Et.currentTarget.value??"":Q[Ct].path=Et.currentTarget.value??"",me([...Q]))},st=()=>{_(Q)};return a.createElement("ol",{className:(0,ut.cx)(Ce.list)},Q&&Q.map((Et,Ct)=>a.createElement("li",{key:Ct},a.createElement(le.C,null,a.createElement(ie.I,{label:"Field",tooltip:De.field,grow:!0},a.createElement(Me.p,{onBlur:st,onChange:kt=>Qe(kt,Ct,"path"),value:Et.path,placeholder:'A valid json path, e.g. "object.value1" or "object.value2[0]"'})),a.createElement(ie.I,{label:"Alias",tooltip:De.alias},a.createElement(Me.p,{width:12,value:Et.alias,onBlur:st,onChange:kt=>Qe(kt,Ct,"alias")})),a.createElement(ie.I,{className:(0,ut.cx)(Ce.removeIcon)},a.createElement(Ys.K,{onClick:()=>_e(Ct),name:"trash-alt",tooltip:"Remove path"}))))),a.createElement(ie.I,null,a.createElement(fe.$n,{icon:"plus",onClick:()=>Ne(),variant:"secondary"},"Add path")))}const ho=()=>{const F=[{path:"object",description:"=> extract fields from object"},{path:"object.value1",description:"=> extract value1"},{path:"object.value2",description:"=> extract value2"},{path:"object.value2[0]",description:"=> extract value2 first element"},{path:"object.value2[1]",description:"=> extract value2 second element"}];return{field:a.createElement("div",null,"A valid path of an json object.",a.createElement("div",null,a.createElement("strong",null,"JSON Value:")),a.createElement("pre",null,a.createElement("code",null,["{",'  "object": {','    "value1": "hello world"','    "value2": [1, 2, 3, 4]',"  }","}"].join(`
`))),a.createElement("strong",null,"Valid Paths:"),F.map((_,Q)=>a.createElement("p",{key:Q},a.createElement("code",null,_.path),a.createElement("i",null,_.description)))),alias:"An alias name for the variable in the dashboard. If left blank the given path will be used."}};function Uo(){return{list:(0,ut.css)`
      margin-left: 20px;
    `,removeIcon:(0,ut.css)`
      margin: 0 0 0 4px;
      align-items: center;
    `}}var Qo=e(14236),qr=(F=>(F.JSON="json",F.KeyValues="kvp",F.Auto="auto",F))(qr||{});const ji={id:qr.JSON,name:"JSON",description:"Parse JSON string",parse:F=>JSON.parse(F)};function No(F){const _=[];let Q="",me="";const De={};for(let Ce=0;Ce<F.length;Ce++){let Ne=F[Ce];Ne===Q&&(Q="",Ne=F[++Ce]);const _e=Ne==="\\";if(_e&&(Ne=F[++Ce]),_e||Q.length){_.push(Ne);continue}switch((Ne==='"'||Ne==="'")&&(Q=Ne),Ne){case":":case"=":_.length&&(me&&(De[me]=""),me=_.join(""),_.length=0);break;case'"':case"'":case" ":case`
`:case"	":case"\r":case`
`:_.length&&me===""&&(De[_.join("")]="",_.length=0);case",":case";":case"&":case"{":case"}":if(_.length){const Qe=_.join("");me.length?(De[me]=Qe,me=""):me=Qe,_.length=0}break;default:_.push(Ne),Ce===F.length-1&&me===""&&_.length&&(De[_.join("")]="",_.length=0)}}return me.length&&(De[me]=_.join("")),De}const xi={id:qr.KeyValues,name:"Key+value pairs",description:"Look for a=b, c: d values in the line",parse:No},Yo=[ji,xi],li={id:qr.Auto,name:"Auto",description:"parse new fields automatically",parse:F=>{for(const _ of Yo)try{const Q=_.parse(F);if(Q!=null)return Q}catch{}}},rr=new ve.O(()=>[...Yo,li]),eo={id:ee.F.extractFields,name:"Extract fields",description:"Parse fields from the contends of another",defaultOptions:{},operator:(F,_)=>Q=>Q.pipe((0,Kt.T)(me=>eo.transformer(F,_)(me))),transformer:F=>_=>_.map(Q=>Lr(Q,F))};function Lr(F,_){if(!_.source)return F;const Q=(0,Yr.findField)(F,_.source);if(!Q)return F;const me=rr.getIfExists(_.format??qr.Auto);if(!me)throw new Error("unkonwn extractor");const De=F.length,Ce=[],Ne=new Map;for(let Qe=0;Qe<De;Qe++){let st=Q.values[Qe];if((0,f.isString)(st))try{st=me.parse(st)}catch{st={}}if(st!=null){if(_.format===qr.JSON&&_.jsonPaths&&_.jsonPaths?.length>0){const Et={},Ct=_.jsonPaths.filter(kt=>kt.path);Ct.length>0&&(Ct.forEach(kt=>{const Ut=kt.alias&&kt.alias.length>0?kt.alias:kt.path;Et[Ut]=(0,f.get)(st,kt.path)??"Not Found"}),st=Et)}for(const[Et,Ct]of Object.entries(st)){let kt=Ne.get(Et);kt==null&&(kt=new Array(De).fill(void 0),Ne.set(Et,kt),Ce.push(Et)),kt[Qe]=Ct}}}const _e=Ce.map(Qe=>{const st=Ne.get(Qe),Et={name:Qe,values:st,type:st?(0,Qo.oE)(st.find(Ct=>Ct!=null)):se.PU.other,config:{}};return X.$.featureToggles.extractFieldsNameDeduplication&&(Et.name=(0,q.fk)(Et,F)),Et});if(_.keepTime){const Qe=(0,Yr.findField)(F,"Time")||(0,Yr.findField)(F,"time");Qe&&_e.unshift(Qe)}return _.replace||_e.unshift(...F.fields),{...F,fields:_e}}const wo={settings:{width:30,placeholderText:"Select field"},name:"",id:"",editor:()=>null},Qi=({input:F,options:_,onChange:Q})=>{const me=st=>{Q({..._,source:st})},De=st=>{Q({..._,format:st?.value})},Ce=st=>{Q({..._,jsonPaths:st})},Ne=()=>{_.replace&&(_.keepTime=!1),Q({..._,replace:!_.replace})},_e=()=>{Q({..._,keepTime:!_.keepTime})},Qe=rr.selectOptions(_.format?[_.format]:void 0);return a.createElement("div",null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Source",labelWidth:16},a.createElement(hr.O,{context:{data:F},value:_.source??"",onChange:me,item:wo}))),a.createElement(le.C,null,a.createElement(ie.I,{label:"Format",labelWidth:16},a.createElement(pe.l6,{value:Qe.current[0],options:Qe.options,onChange:De,width:24,placeholder:"Auto"}))),_.format==="json"&&a.createElement(wr,{options:_.jsonPaths??[],onChange:Ce}),a.createElement(le.C,null,a.createElement(ie.I,{label:"Replace all fields",labelWidth:16},a.createElement(da.K,{value:_.replace??!1,onChange:Ne}))),_.replace&&a.createElement(le.C,null,a.createElement(ie.I,{label:"Keep time",labelWidth:16},a.createElement(da.K,{value:_.keepTime??!1,onChange:_e}))))},_r={id:ee.F.extractFields,editor:Qi,transformation:eo,name:eo.name,description:"Parse fields from content (JSON, labels, etc).",categories:new Set([v.m.Reformat]),help:he(ee.F.extractFields).helperDocs};var Fr=e(51986);const Fo={id:ee.F.joinByLabels,name:"Join by labels",description:"Flatten labeled results into a table joined by labels.",defaultOptions:{},operator:(F,_)=>Q=>Q.pipe((0,Kt.T)(me=>Fo.transformer(F,_)(me))),transformer:F=>_=>!_||!_.length?_:[vo(F,_)]};function vo(F,_){if(!F.value?.length)return mr("No value labele configured");const Q=(0,we.aG)(_);if(Q.size<1)return mr("No labels in result");if(!Q.has(F.value))return mr("Value label not found");let me=F.join?.length?F.join:Array.from(Q);me=me.filter(Ct=>Ct!==F.value);const De=new Set,Ce=new Map,Ne={};for(const Ct of _)for(const kt of Ct.fields)if(kt.labels&&kt.type!==se.PU.time){const Ut=me.map(Ua=>kt.labels[Ua]),Ot=Ut.join(",");let Wt=Ce.get(Ot);Wt||(Wt={keys:Ut,values:{}},Ce.set(Ot,Wt));const Sn=kt.labels[F.value],ha=kt.values,wa=Wt.values[Sn];wa?Wt.values[Sn]=wa.concat(ha):Wt.values[Sn]=ha,Ne[Sn]||(Ne[Sn]=kt),De.add(Sn)}const _e=Array.from(De),Qe=me.map(()=>[]),st=_e.map(()=>[]);for(const Ct of Ce.values()){let kt=-1,Ut=!1;for(;!Ut;){kt++,Ut=!0;for(let Ot=0;Ot<me.length;Ot++)Qe[Ot].push(Ct.keys[Ot]);for(let Ot=0;Ot<_e.length;Ot++){const Wt=_e[Ot],Sn=Ct.values[Wt]??[];st[Ot].push(Sn[kt]),Sn.length>kt+1&&(Ut=!1)}}}const Et={fields:[],length:st[0].length};for(let Ct=0;Ct<me.length;Ct++)Et.fields.push({name:me[Ct],config:{},type:se.PU.string,values:Qe[Ct]});for(let Ct=0;Ct<_e.length;Ct++){const kt=Ne[_e[Ct]];Et.fields.push({name:_e[Ct],config:{},type:kt.type??se.PU.number,values:st[Ct]})}return Et}function mr(F){return{meta:{notices:[{severity:"error",text:F}]},fields:[{name:"Error",type:se.PU.string,config:{},values:[F]}],length:0}}function Jo({input:F,options:_,onChange:Q}){const me=(0,a.useMemo)(()=>{let Qe;const st=(0,we.aG)(F),Et=Array.from(st).map(Sn=>({label:Sn,value:Sn}));let Ct=Et.find(Sn=>Sn.value===_.value);!Ct&&_.value&&(Ct={label:`${_.value} (not found)`,value:_.value},Et.push(Ct)),F.length?st.size===0&&(Qe=a.createElement(Gt.F,{title:"No labels found"},"The input does not contain any labels")):Qe=a.createElement(Gt.F,{title:"No input found"},"No input (or labels) found"),st.delete(_.value);const kt=Array.from(st).map(Sn=>({label:Sn,value:Sn}));let Ut=kt;const Ot=!!_.join?.length;let Wt="Join";return Ot?Ut=kt.filter(Sn=>!_.join.includes(Sn.value)):Wt=kt.map(Sn=>Sn.value).join(", "),{warn:Qe,valueOptions:Et,valueOption:Ct,joinOptions:kt,addOptions:Ut,addText:Wt,hasJoin:Ot,key:Date.now()}},[_,F]),De=(Qe,st)=>{if(!_.join)return;const Et=_.join.slice();if(st)Et[Qe]=st;else if(Et.splice(Qe,1),!Et.length){Q({..._,join:void 0});return}const Ct=new Set(Et);_.value&&Ct.delete(_.value),Q({..._,join:Array.from(Ct)})},Ce=Qe=>{const st=Qe?.value;if(!st)return;const Et=_.join?_.join.slice():[];Et.push(st),Q({..._,join:Et})},Ne=10,_e="No labels found";return a.createElement("div",null,me.warn,a.createElement(le.C,null,a.createElement(ie.I,{error:"required",invalid:!_.value?.length,label:"Value",labelWidth:Ne,tooltip:"Select the label indicating the values name"},a.createElement(pe.l6,{options:me.valueOptions,value:me.valueOption,onChange:Qe=>Q({..._,value:Qe.value}),noOptionsMessage:_e}))),me.hasJoin?_.join.map((Qe,st)=>a.createElement(le.C,{key:Qe+st},a.createElement(ie.I,{label:"Join",labelWidth:Ne,error:"Unable to join by the value label",invalid:Qe===_.value},a.createElement(Xa.Gy,null,a.createElement(pe.l6,{options:me.joinOptions,value:me.joinOptions.find(Et=>Et.value===Qe),isClearable:!0,onChange:Et=>De(st,Et?.value),noOptionsMessage:_e}),!!(me.addOptions.length&&st===_.join.length-1)&&a.createElement(Fr.i,{icon:"plus",label:"",options:me.addOptions,onChange:Ce,variant:"secondary"}))))):a.createElement(a.Fragment,null,!!me.addOptions.length&&a.createElement(le.C,null,a.createElement(ie.I,{label:"Join",labelWidth:Ne},a.createElement(pe.l6,{options:me.addOptions,placeholder:me.addText,onChange:Ce,noOptionsMessage:_e})))))}const Or={id:Fo.id,editor:Jo,transformation:Fo,name:Fo.name,description:Fo.description,state:rt.pn.beta,categories:new Set([v.m.Combine]),help:he(Fo.id).helperDocs};var Yi=e(84350),Wo=e(69862),to=e(65474),Ji=e(67140);const Oi={id:ee.F.fieldLookup,name:"Lookup fields from resource",description:"Retrieve matching data based on specified field",defaultOptions:{},operator:F=>_=>_.pipe((0,Wo.Z)(Q=>(0,to.H)(Eo(Q,F))))};async function Eo(F,_){const Q=ae.sJ.get(ne.Ct.byName).get(_?.lookupField),me=await(0,Ji.q3)(_?.gazetteer??Ji.fx);return me.frame?Xi(F,me,Q):Promise.reject("missing frame in gazetteer")}function Xi(F,_,Q){const me=_.frame()?.fields;return me?F.map(De=>{const Ce=De.length,Ne=[];for(const _e of De.fields)if(Ne.push(_e),Q(_e,De,F)){const Qe=_e.values,st=[];for(const Et of me){const Ct=new Array(Ce);st.push(Ct),Ne.push({...Et,values:Ct})}for(let Et=0;Et<_.count;Et++){const Ct=_.find(Qe[Et]);if(Ct?.index!=null)for(let kt=0;kt<me.length;kt++)st[kt][Et]=me[kt].values[Ct.index]}}return{...De,fields:Ne}}):F}const Zi={settings:{width:30,filter:F=>F.type===se.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null},ci={settings:{}},di=({input:F,options:_,onChange:Q})=>{const me=(0,a.useCallback)(Ce=>{Q({..._,lookupField:Ce})},[Q,_]),De=(0,a.useCallback)(Ce=>{Q({..._,gazetteer:Ce})},[Q,_]);return a.createElement("div",null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Field",labelWidth:12},a.createElement(hr.O,{context:{data:F},value:_?.lookupField??"",onChange:me,item:Zi}))),a.createElement(le.C,null,a.createElement(ie.I,{label:"Lookup",labelWidth:12},a.createElement(Yi.G,{value:_?.gazetteer??"",context:{data:F},item:ci,onChange:De}))))},Ii={id:ee.F.fieldLookup,editor:di,transformation:Oi,name:Oi.name,description:"Use a field value to lookup additional fields from an external source. This currently supports spatial data, but will eventually support more formats.",state:rt.pn.alpha,categories:new Set([v.m.PerformSpatialOperations]),help:he(ee.F.fieldLookup).helperDocs};var ke=e(35602),Ye=e(64586);const Ze=(F,_,Q=[])=>(_===0?Q.push(F):F.forEach(me=>{Ze(me,_-1,Q)}),Q);function ct(F){const _=F[0].length,Q=F.length,me=new Map;for(let De=0;De<_;De++){let Ce=me;for(let Ne=0;Ne<Q;Ne++){let _e=F[Ne][De],Qe=Ce.get(_e);Qe==null&&(Qe=Ne===Q-1?[]:new Map,Ce.set(_e,Qe)),Ce=Qe}Ce.push(De)}return Ze(me,Q)}const It={asLabels:!0,append:!1,withNames:!1,separator1:"=",separator2:" "};function Ht(F,_,Q){return _.map((me,De)=>F.withNames?`${me}${F.separator1}${Q[De]}`:Q[De]).join(F.separator2)}function tn(F,_){const Q={};return F.forEach((me,De)=>{Q[me]=String(_[De])}),Q}const dn={id:ee.F.partitionByValues,name:"Partition by values",description:"Splits a one-frame dataset into multiple series discriminated by unique/enum values in one or more fields.",defaultOptions:{keepFields:!1},operator:(F,_)=>Q=>Q.pipe((0,Kt.T)(me=>dn.transformer(F,_)(me))),transformer:(F,_)=>{const Q=(0,ke.R)(_,{names:F.fields});if(!Q)return Ye.W.transformer({},_);const me=(0,ae.NS)(Q);return De=>De.length?yn(De[0],me,F):De}};function yn(F,_,Q){const me=F.fields.filter(_e=>_(_e,F,[F]));if(!me.length)return[F];const De=me.map(_e=>_e.values),Ce=me.map(_e=>_e.name),Ne={...It,...Q?.naming};return ct(De).map(_e=>{let Qe=F.name,st={};if(Ne.asLabels)st=tn(Ce,me.map((Ct,kt)=>De[kt][_e[0]]));else{let Ct=Ht(Ne,Ce,me.map((kt,Ut)=>De[Ut][_e[0]]));Ne?.append&&F.name&&(Ct=`${F.name} ${Ct}`),Qe=Ct}let Et=F.fields;if(!Q?.keepFields){const Ct=new Set(Ce);Et=F.fields.filter(kt=>!Ct.has(kt.name))}return{name:Qe,meta:F.meta,length:_e.length,fields:Et.map(Ct=>{const kt=Ct.values,Ut=Array(_e.length);for(let Ot=0;Ot<_e.length;Ot++)Ut[Ot]=kt[_e[Ot]];return{name:Ct.name,type:Ct.type,config:Ct.config,labels:{...Ct.labels,...st},values:Ut}})}})}function Rn({input:F,options:_,onChange:Q}){const me=(0,ys.sE)(F),De=(0,ys.m3)(me),Ce=(0,a.useMemo)(()=>{const kt=new Set(_.fields);return kt.size<1?De:De.filter(Ut=>!kt.has(Ut.value))},[De,_]),Ne=(0,a.useCallback)(kt=>{if(!kt.value)return;const Ut=new Set(_.fields);Ut.add(kt.value),Q({..._,fields:[...Ut]})},[Q,_]);let _e;(kt=>{kt[kt.asLabels=0]="asLabels",kt[kt.frameName=1]="frameName"})(_e||(_e={}));const Qe=[{label:"As label",value:0},{label:"As frame name",value:1}],st=[{label:"Yes",value:!0},{label:"No",value:!1}],Et=(0,a.useCallback)(kt=>{if(!kt)return;const Ut=new Set(_.fields);Ut.delete(kt),Q({..._,fields:[...Ut]})},[Q,_]);if(F.length>1)return a.createElement(_s.P,null,"Partition by values only works with a single frame.");const Ct=[...new Set(_.fields)];return a.createElement("div",null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Field",labelWidth:10,grow:!0},a.createElement(Xa.Gy,null,Ct.map(kt=>a.createElement(fe.$n,{key:kt,icon:"times",variant:"secondary",size:"md",onClick:()=>Et(kt)},kt)),Ce.length&&a.createElement(Fr.i,{variant:"secondary",size:"md",options:Ce,onChange:Ne,label:"Select field",icon:"plus"})))),a.createElement(le.C,null,a.createElement(ie.I,{tooltip:"Sets how the names of the selected fields are displayed. As frame name is usually better for tabular data",label:"Naming",labelWidth:10},a.createElement(ce.z,{options:Qe,value:_.naming?.asLabels===void 0||_.naming.asLabels?0:1,onChange:kt=>Q({..._,naming:{..._.naming,asLabels:kt===0}})}))),a.createElement(le.C,null,a.createElement(ie.I,{tooltip:"Keeps the partition fields in the frames.",label:"Keep fields",labelWidth:16},a.createElement(ce.z,{options:st,value:_.keepFields,onChange:kt=>Q({..._,keepFields:kt})}))))}const Yn={id:ee.F.partitionByValues,editor:Rn,transformation:dn,name:dn.name,description:dn.description,state:rt.pn.alpha,categories:new Set([v.m.Reformat]),help:he(ee.F.partitionByValues).helperDocs};var qn=e(41260),Jn=e(37471),ca=e(73060),Oa=(F=>(F.TimeSeriesWide="wide",F.TimeSeriesLong="long",F.TimeSeriesMulti="multi",F.TimeSeriesMany="many",F))(Oa||{});function ma(F){if(!Array.isArray(F)||F.length===0)return F;const _=[];for(const Q of $a(F)){const me=Q.fields[0];if(!me||me.type!==se.PU.time)continue;const De=[],Ce=[];for(const Ne of Q.fields)switch(Ne.type){case se.PU.number:case se.PU.boolean:De.push(Ne);break;case se.PU.string:Ce.push(Ne);break}for(const Ne of De)if(Ce.length){const _e=new Map;for(let Qe=0;Qe<Q.length;Qe++){const st=me.values[Qe],Et=Ne.values[Qe];if(Et===void 0||st==null)continue;const Ct=Ce.map(Ut=>Ut.values[Qe]).join("/");let kt=_e.get(Ct);if(!kt){kt={key:Ct,time:[],value:[],labels:{}};for(const Ut of Ce)kt.labels[Ut.name]=Ut.values[Qe];_e.set(Ct,kt)}kt.time.push(st),kt.value.push(Et)}for(const Qe of _e.values())_.push({name:Q.name,refId:Q.refId,meta:{...Q.meta,type:qn.m.TimeSeriesMulti},fields:[{...me,values:Qe.time},{...Ne,values:Qe.value,labels:Qe.labels}],length:Qe.time.length})}else _.push({name:Q.name,refId:Q.refId,meta:{...Q.meta,type:qn.m.TimeSeriesMulti},fields:[me,Ne],length:Q.length})}return _}function $a(F){if(!Array.isArray(F)||F.length===0)return F;const _=[];for(const Q of F){let me;const De=[],Ce={},Ne={},_e={},Qe={};for(let Ot=0;Ot<Q.fields.length;Ot++){const Wt=Q.fields[Ot];switch(Wt.type){case se.PU.string:case se.PU.boolean:Wt.name in Qe||(Qe[Wt.name]=Ot,Ne[Wt.name]=!0);break;case se.PU.time:if(!me){me=Wt;break}default:if(Wt.name in Ce){const wa=Ce[Wt.name];if(Wt.type!==wa)continue}else Ce[Wt.name]=Wt.type,De.push(Wt.name);const Sn=JSON.stringify(Wt.labels),ha=_e[Sn];if(ha!==void 0?ha.push(Ot):_e[Sn]=[Ot],Wt.labels!=null)for(const wa in Wt.labels)Ne[wa]=!0}}if(!me)continue;const st=[],Et=[],Ct=[],kt=[];for(let Ot=0;Ot<Q.length;Ot++)st.push({time:me.values[Ot],wideRowIndex:Ot});for(const Ot in _e)Et.push(Ot);for(const Ot in Ne)Ct.push(Ot);for(const Ot in Qe)kt.push(Ot);st.sort((Ot,Wt)=>Ot.time-Wt.time),Et.sort(),Ct.sort(),De.sort();const Ut=new Jn.k({...Q,meta:{...Q.meta,type:qn.m.TimeSeriesLong},fields:[{name:me.name,type:me.type}]});for(const Ot of De)Ut.addField({name:Ot,type:Ce[Ot]});for(const Ot of Ct)Ut.addField({name:Ot,type:se.PU.string});for(const Ot of st){const{time:Wt,wideRowIndex:Sn}=Ot;for(const ha of Et){const wa={};for(const Na of kt)wa[Na]=Q.fields[Qe[Na]].values[Sn];let Ua=0;for(const Na of _e[ha]){const pr=Q.fields[Na];if(Ua++===0&&pr.labels!=null)for(const zo in pr.labels)wa[zo]=pr.labels[zo];wa[pr.name]=pr.values[Sn]}wa[me.name]=Wt,Ut.add(wa)}}_.push(Ut)}return _}function He(F){return yn(F,Q=>Q.type===se.PU.string).map(Q=>(Q.meta||(Q.meta={}),Q.meta.type=qn.m.TimeSeriesMulti,Q))}const Ie={id:ee.F.prepareTimeSeries,name:"Prepare time series",description:"Will stretch data frames from the wide format into the long format. This is really helpful to be able to keep backwards compatibility for panels not supporting the new wide format.",defaultOptions:{},operator:(F,_)=>Q=>Q.pipe((0,Kt.T)(me=>Ie.transformer(F,_)(me))),transformer:F=>{const _=F?.format??"wide";if(_==="many"||_==="multi")return ma;if(_==="long")return $a;const Q=ae.sJ.get(ne.Ct.firstTimeField).get({});return me=>{if(!me.length)return[];const De=[];for(const Ne of me)Ne.meta?.type===qn.m.TimeSeriesLong?He(Ne).forEach(_e=>De.push(_e)):De.push(Ne);const Ce=(0,ca.Fd)({frames:De,joinBy:Q,keepOriginIndices:!0});return Ce?(Ce.meta||(Ce.meta={}),Ce.meta.type=qn.m.TimeSeriesWide,[Ce]):[]}}},je={label:"Wide time series",value:Oa.TimeSeriesWide,description:"Creates a single frame joined by time",info:a.createElement("ul",null,a.createElement("li",null,"Single frame"),a.createElement("li",null,"1st field is shared time field"),a.createElement("li",null,"Time in ascending order"),a.createElement("li",null,"Multiple value fields of any type"))},tt={label:"Multi-frame time series",value:Oa.TimeSeriesMulti,description:"Creates a new frame for each time/number pair",info:a.createElement("ul",null,a.createElement("li",null,"Multiple frames"),a.createElement("li",null,"Each frame has two fields: time, value"),a.createElement("li",null,"Time in ascending order"),a.createElement("li",null,"String values are represented as labels"),a.createElement("li",null,"All values are numeric"))},St={label:"Long time series",value:Oa.TimeSeriesLong,description:"Convert each frame to long format",info:a.createElement("ul",null,a.createElement("li",null,"Single frame"),a.createElement("li",null,"1st field is time field"),a.createElement("li",null,"Time in ascending order, but may have duplictes"),a.createElement("li",null,"String values are represented as separate fields rather than as labels"),a.createElement("li",null,"Multiple value fields may exist"))},$t=[je,tt,St];function Yt(F){const{options:_,onChange:Q}=F,me=(0,Nt.of)(pn),De=(0,a.useCallback)(Ce=>{Q({..._,format:Ce.value})},[Q,_]);return a.createElement(a.Fragment,null,a.createElement(le.C,null,a.createElement(ie.I,{label:"Format",labelWidth:12},a.createElement(pe.l6,{width:35,options:$t,value:$t.find(Ce=>Ce.value===Oa.TimeSeriesMulti&&_.format===Oa.TimeSeriesMany?!0:Ce.value===_.format)||$t[0],onChange:De,className:"flex-grow-1"}))),a.createElement(le.C,null,a.createElement(ie.I,{label:"Info",labelWidth:12},a.createElement("div",{className:me.info},($t.find(Ce=>Ce.value===_.format)||$t[0]).info))))}const pn=F=>({info:(0,ut.css)`
    margin-left: 20px;
  `}),Bn={id:Ie.id,editor:Yt,transformation:Ie,name:Ie.name,description:Ie.description,categories:new Set([v.m.Reformat]),help:he(Ie.id).helperDocs};var Cn=e(66648),Xn=e(48817),na=(F=>(F.linear="linear",F.polynomial="polynomial",F))(na||{});const va={predictionCount:100,modelType:"linear",degree:2},ba={id:ee.F.regression,name:"Regression analysis",operator:(F,_)=>Q=>Q.pipe((0,Kt.T)(me=>ba.transformer(F,_)(me))),transformer:(F,_)=>Q=>{const{predictionCount:me,modelType:De,degree:Ce}={...va,...F};if(Q.length===0)return Q;const Ne=ae.sJ.get(ne.Ct.byName).get(F.yFieldName),_e=ae.sJ.get(ne.Ct.byName).get(F.xFieldName);let Qe,st,Et;for(const Na of Q){const pr=Na.fields.find(zo=>Ne(zo,Na,Q));if(pr){st=pr;const zo=Na.fields.find(cp=>_e(cp,Na,Q));if(zo){Qe=zo,Et=Na;break}else throw"X and Y fields must be part of the same frame"}}if(!Qe||!st)return Q;let Ct=Qe.values[0],kt=Qe.values[0];for(let Na=1;Na<Qe.values.length;Na++)Qe.values[Na]<Ct&&(Ct=Qe.values[Na]),Qe.values[Na]>kt&&(kt=Qe.values[Na]);const Ut=(kt-Ct)/(me-1),Ot=[...[...Array(me-1).keys()].map((Na,pr)=>pr*Ut+Ct),kt],Wt=Qe.type===se.PU.time?Ct:0,Sn=[],ha=[];for(let Na=0;Na<Qe.values.length;Na++)st.values[Na]!==null&&!isNaN(st.values[Na])&&(ha.push(Qe.values[Na]-Wt),Sn.push(st.values[Na]));let wa;switch(De){case"linear":wa=new Xn.X(ha,Sn);break;case"polynomial":wa=new Cn.Y(ha,Sn,Ce);break;default:return Q}const Ua={name:`${De} regression`,length:Ot.length,fields:[{name:Qe.name,type:Qe.type,values:Ot,config:{}},{name:`${(0,q.Ct)(st,Et,Q)} predicted`,type:st.type,values:Ot.map(Na=>wa.predict(Na-Wt)),config:{}}]};return[...Q,Ua]}},fa={editor:hr.O,id:"",name:"",settings:{width:24,isClearable:!1}},Ga=20,Ta=({input:F,options:_,onChange:Q})=>{const me=[{label:"Linear",value:na.linear},{label:"Polynomial",value:na.polynomial}];return(0,a.useEffect)(()=>{let De,Ce;if(!_.xFieldName){const Ne=ae.sJ.get(ne.Ct.firstTimeField).get({});for(const _e of F)if(De=_e.fields.find(Qe=>Ne(Qe,_e,F)),De)break;if(!De){const _e=ae.sJ.get(ne.Ct.numeric).get({});for(const Qe of F)if(De=Qe.fields.find(st=>_e(st,Qe,F)),De)break}}if(!_.yFieldName){const Ne=ae.sJ.get(ne.Ct.numeric).get({});for(const _e of F)if(Ce=_e.fields.find(Qe=>Ne(Qe,_e,F)&&Qe!==De),Ce)break}De&&Ce&&Q({..._,xFieldName:De.name,yFieldName:Ce.name})}),a.createElement(a.Fragment,null,a.createElement(ie.I,{labelWidth:Ga,label:"X field"},a.createElement(hr.O,{context:{data:F},value:_.xFieldName??"",item:fa,onChange:De=>{Q({..._,xFieldName:De})}})),a.createElement(ie.I,{labelWidth:Ga,label:"Y field"},a.createElement(hr.O,{context:{data:F},value:_.yFieldName??"",item:fa,onChange:De=>{Q({..._,yFieldName:De})}})),a.createElement(ie.I,{labelWidth:Ga,label:"Model type"},a.createElement(pe.l6,{value:_.modelType??va.modelType,onChange:De=>{Q({..._,modelType:De.value??va.modelType})},options:me})),a.createElement(ie.I,{labelWidth:Ga,label:"Predicted points",tooltip:"Number of X,Y points to predict"},a.createElement(ls.Q,{value:_.predictionCount??va.predictionCount,onChange:De=>{Q({..._,predictionCount:De})}})),_.modelType===na.polynomial&&a.createElement(ie.I,{labelWidth:Ga,label:"Degree"},a.createElement(pe.l6,{value:_.degree??va.degree,options:[{label:"Quadratic",value:2},{label:"Cubic",value:3},{label:"Quartic",value:4},{label:"Quintic",value:5}],onChange:De=>{Q({..._,degree:De.value})}})))},Fa={id:ee.F.regression,editor:Ta,transformation:ba,name:ba.name,description:ba.description,categories:new Set([v.m.CalculateNewFields]),help:he(ee.F.regression).helperDocs},$n={id:ee.F.rowsToFields,name:"Rows to fields",description:"Convert each row into a field with dynamic config.",defaultOptions:{},operator:F=>_=>_.pipe((0,Kt.T)(Q=>Q.map(me=>ta(F,me))))};function ta(F,_){const Q=rn(_,F.mappings??[],!0),{nameField:me,valueField:De}=Q;if(!me||!De)return _;const Ce=[];for(let Ne=0;Ne<me.values.length;Ne++){const _e=me.values[Ne],Qe=De.values[Ne],st=Mn(_,Ne,Q),Et=Zn(_,Ne,Q),Ct={name:`${_e}`,type:De.type,values:[Qe],config:st,labels:Et};Ce.push(Ct)}return{fields:Ce,length:1}}function Zn(F,_,Q){const me={...Q.nameField.labels};for(let De=0;De<F.fields.length;De++){const Ce=F.fields[De],Ne=(0,q.Ct)(Ce,F),_e=Q.index[Ne];if(_e.handler&&_e.handler.key!==vt.Label)continue;const Qe=Ce.values[_];Qe!=null&&(me[Ne]=Qe)}return me}function La({input:F,options:_,onChange:Q}){return F.length===0?null:a.createElement("div",null,a.createElement(en,{frame:F[0],mappings:_.mappings??[],onChange:me=>Q({..._,mappings:me}),withNameAndValue:!0}))}const us={id:$n.id,editor:La,transformation:$n,name:$n.name,description:$n.description,state:rt.pn.beta,categories:new Set([v.m.Reformat]),help:he($n.id).helperDocs};var ts=e(52622),Hs=e(61983),Da=e(9581),fr=e(96606),zr=e(31484),qi=e(78134);const yr={id:ee.F.spatial,name:"Spatial operations",description:"Apply spatial operations to query results.",defaultOptions:{},operator:F=>_=>_.pipe((0,Wo.Z)(Q=>(0,to.H)(no(Q,F))))};function Ds(F){return F.action===Da.dy.Modify&&F.modify?.op===Da.YD.LineBuilder}async function no(F,_){const Q=await(0,zr.nE)(_.source);if(Ds(_)){const me=await(0,zr.nE)(_.modify?.target);return F.map(De=>{const Ce=(0,zr.FM)(De,Q),Ne=(0,zr.FM)(De,me);if(Ce.field&&Ne.field){const _e=[...De.fields],Qe=(0,fr.XR)(Ce.field,Ne.field),st=_e[0];return st.type===se.PU.geo&&st!==Ce.field&&st!==Ne.field?_e[0]=(0,fr.RA)(st,Qe):_e.unshift(Qe),{...De,fields:_e}}return De})}return F.map(me=>{let De=(0,zr.FM)(me,Q);if(De.field){if(_.action===Da.dy.Modify){switch(_.modify?.op){case Da.YD.AsLine:let Ne=De.field.name;return(!Ne||Ne==="Point")&&(Ne="Line"),{...me,length:1,fields:[{...De.field,name:Ne,type:se.PU.geo,values:[(0,qi.tt)(De.field)]}]}}return me}const Ce=De.derived?[De.field,...me.fields]:me.fields.slice(0);if(_.action===Da.dy.Calculate&&(Ce.push((0,qi.pp)(De.field,_.calculate??{})),De.derived=!0),De.derived)return{...me,fields:Ce}}return me})}const Wr=(F,_)=>{const Q=_.options??{};F.addSelect({path:"action",name:"Action",description:"",defaultValue:Da.dy.Prepare,settings:{options:[{value:Da.dy.Prepare,label:"Prepare spatial field",description:"Set a geometry field based on the results of other fields"},{value:Da.dy.Calculate,label:"Calculate value",description:"Use the geometry to define a new field (heading/distance/area)"},{value:Da.dy.Modify,label:"Transform",description:"Apply spatial operations to the geometry"}]}}),Q.action===Da.dy.Calculate?F.addSelect({path:"calculate.calc",name:"Function",description:"",defaultValue:Da.kD.Heading,settings:{options:[{value:Da.kD.Heading,label:"Heading"},{value:Da.kD.Area,label:"Area"},{value:Da.kD.Distance,label:"Distance"}]}}):Q.action===Da.dy.Modify&&F.addSelect({path:"modify.op",name:"Operation",description:"",defaultValue:Da.YD.AsLine,settings:{options:[{value:Da.YD.AsLine,label:"As line",description:"Create a single line feature with a vertex at each row"},{value:Da.YD.LineBuilder,label:"Line builder",description:"Create a line between two points"}]}}),Ds(Q)?(F.addNestedOptions({category:["Source"],path:"source",build:(me,De)=>{const Ce=Q.source??{mode:ts.aG.Auto};(0,Hs.G)("Point","",me,Ce)}}),F.addNestedOptions({category:["Target"],path:"modify",build:(me,De)=>{const Ce=Q.modify?.target??{mode:ts.aG.Auto};(0,Hs.G)("Point","target.",me,Ce)}})):(0,Hs.G)("Location","source.",F,Q.source)},yo=F=>{(0,a.useEffect)(()=>{if(!F.options.source?.mode){const me=Ft(Wr);F.onChange({...me,...F.options}),console.log("geometry useEffect",me)}},[]);const _=jl((0,Nt.$j)()),Q=bt(F,Wr);return a.createElement("div",null,a.createElement("div",null,Q.items.map(me=>me.render())),a.createElement("div",null,Q.categories.map(me=>a.createElement("div",{key:me.props.id,className:_.wrap},a.createElement("h5",null,me.props.title),a.createElement("div",{className:_.item},me.items.map(De=>De.render()))))))},jl=F=>({wrap:(0,ut.css)`
      margin-bottom: 20px;
    `,item:(0,ut.css)`
      border-left: 4px solid ${F.colors.border.strong};
      padding-left: 10px;
    `}),hu={id:ee.F.spatial,editor:yo,transformation:yr,name:yr.name,description:yr.description,state:rt.pn.alpha,categories:new Set([v.m.PerformSpatialOperations]),help:he(ee.F.spatial).helperDocs};var Cl=e(19845);const el={id:ee.F.timeSeriesTable,name:"Time series to table",description:"Convert time series data to table rows so that they can be viewed in tabular or sparkline format.",defaultOptions:{},isApplicable:F=>{for(const _ of F)if((0,Cl.aH)(_))return Rs.M.Applicable;return Rs.M.NotApplicable},isApplicableDescription:"The Time series to table transformation requires at least one time series frame to function. You currently have none.",operator:F=>_=>_.pipe((0,Kt.T)(Q=>Hc(F,Q)))};function Hc(F,_){const Q={},me={},De=[];let Ce=Gc(_);for(const Ne of Object.keys(Ce)){const _e=_.filter(st=>st.refId===Ne);Q[Ne]={},me[Ne]={};const Qe=[];_e.forEach(st=>{st.fields.forEach(Et=>{Et.type===se.PU.number&&Et.labels&&Object.keys(Et.labels).forEach(Ct=>{Qe.includes(Ct)||(me[Ne][Ct]=Xs(Ct,se.PU.string),Qe.push(Ct))})})});for(let st=0;st<_e.length;st++){const Et=_e[st];let Ct=null,kt=F[Ne]?.timeField;if(kt&&kt.length>0?Ct=Et.fields.find(Ut=>Ut.name===kt):Ct=Et.fields.find(Ut=>(0,Cl.hF)(Ut)),!(0,Cl.aH)(Et)){De.push(Et);continue}for(const Ut of Et.fields){if(Ut.type!==se.PU.number)continue;const Ot=F[Ne]?.stat??Rt.gy.lastNotNull,Wt=(0,Rt.Nw)({field:Ut,reducers:[Ot]})[Ot]??null,Sn=new Jn.k;Ct!==void 0&&(Sn.addField(Ct),Sn.addField(Ut),Q[Ne][`Trend #${Ne}`]===void 0&&(Q[Ne][`Trend #${Ne}`]=Xs(`Trend #${Ne}`,se.PU.frame)),Q[Ne][`Trend #${Ne}`].values.push({...Sn,value:Wt,length:Ut.values.length})),Qe.forEach(ha=>{me[Ne][ha].values.push(Ut.labels?.[ha]??"")})}}}for(const Ne of Object.keys(Ce)){const _e={},Qe=new Jn.k;Qe.refId=Ne;const st=me[Ne];if(st!==void 0)for(const[Ct,kt]of Object.entries(st))_e[Ct]===void 0&&(_e[Ct]=kt);for(const Ct of Object.values(_e))Qe.addField(Ct);const Et=Q[Ne];for(const Ct of Object.values(Et))Qe.addField(Ct);Qe.fields.length>0&&De.push(Qe)}return De}function Xs(F,_){return{name:F,type:_,config:{},values:[]}}function Gc(F){let _={};for(const Q of F)Q.refId!==void 0&&(_[Q.refId]===void 0?_[Q.refId]=1:_[Q.refId]++);return _}function vu({input:F,options:_,onChange:Q}){const me=Gc(F),De=(0,a.useCallback)((_e,Qe)=>{const st=Qe?.value!==void 0?Qe.value:"";Q({..._,[_e]:{..._[_e],timeField:st}})},[Q,_]),Ce=(0,a.useCallback)((_e,Qe)=>{const st=Qe[0];st&&(0,Rt.Em)(st)&&Q({..._,[_e]:{..._[_e],stat:st}})},[Q,_]);let Ne=[];for(const _e of Object.keys(me)){const Qe={},st=[];for(const Et of F)if(Et.refId===_e)for(const Ct of Et.fields)(0,Cl.hF)(Ct)&&(Qe[Ct.name]=Ct);for(const Et of Object.values(Qe)){const{name:Ct}=Et;st.push({label:Ct,value:Ct})}Ne.push(a.createElement(le.C,{key:_e},a.createElement(ie.I,null,a.createElement(gt.c,null,`Trend #${_e}`)),a.createElement(ie.I,{label:"Time field",tooltip:"The time field that will be used for the time series. If not selected the first found will be used."},a.createElement(pe.l6,{onChange:De.bind(null,_e),options:st,value:_[_e]?.timeField,isClearable:!0})),a.createElement(ie.I,{label:"Stat",tooltip:"The statistic that should be calculated for this time series."},a.createElement(_t.S,{stats:[_[_e]?.stat??Rt.gy.lastNotNull],onChange:Ce.bind(null,_e),filterOptions:Et=>Et.id!==Rt.gy.allValues&&Et.id!==Rt.gy.uniqueValues}))))}return a.createElement(a.Fragment,null,Ne)}const Eu={id:el.id,editor:vu,transformation:el,name:el.name,description:el.description,state:rt.pn.beta,help:he(el.id).helperDocs},yu=()=>[ki,Xr,Hi,Ur,Ke,jo,Zr,Mi,Qr,gs,Go,kn,ii,ri,ks,us,Nn,Bn,co,hu,Ii,_r,gn,dr,bi,Or,Yn,...X.$.featureToggles.formatString?[fo]:[],...X.$.featureToggles.regressionTransformation?[Fa]:[],...X.$.featureToggles.groupToNestedTableTransformation?[Ws]:[],Oo,Eu];var ui=e(67278);function Du(){return new ui.c(new URL(e.p+e.u(7887),e.b))}function jc(){return[{id:"kusto",name:"kusto",init:Du}]}var or=e(1503),Ko=e(71468),Zs=e(24180),Qc=e(24160),gr=e(14110),Yc=e(66602),Jc=e(17425),Xo=e(71678),Pu=e(17464),ws=e(39070),Xc=e(19361),as=e(8484),bu=e(53153),Dr=e(87570),Cu=e(4691),Ql=e(20851),Yl=e(58649);const Tu=()=>{const F=!!H.Ay.oauth;return{saml:{bgColor:"#464646",enabled:H.Ay.samlEnabled,name:H.Ay.samlName||Yl.En,icon:"key-skeleton-alt"},google:{bgColor:"#e84d3c",enabled:F&&!!H.Ay.oauth.google,name:H.Ay.oauth?.google?.name||"Google",icon:H.Ay.oauth?.google?.icon||"google"},azuread:{bgColor:"#2f2f2f",enabled:F&&!!H.Ay.oauth.azuread,name:H.Ay.oauth?.azuread?.name||"Microsoft",icon:H.Ay.oauth?.azuread?.icon||"microsoft"},github:{bgColor:"#464646",enabled:F&&!!H.Ay.oauth.github,name:H.Ay.oauth?.github?.name||"GitHub",icon:H.Ay.oauth?.github?.icon||"github"},gitlab:{bgColor:"#fc6d26",enabled:F&&!!H.Ay.oauth.gitlab,name:H.Ay.oauth?.gitlab?.name||"GitLab",icon:H.Ay.oauth?.gitlab?.icon||"gitlab"},grafanacom:{bgColor:"#262628",enabled:F&&!!H.Ay.oauth.grafana_com,name:H.Ay.oauth?.grafana_com?.name||"Grafana.com",icon:H.Ay.oauth?.grafana_com?.icon||"grafana",hrefName:"grafana_com"},okta:{bgColor:"#2f2f2f",enabled:F&&!!H.Ay.oauth.okta,name:H.Ay.oauth?.okta?.name||"Okta",icon:H.Ay.oauth?.okta?.icon||"okta"},oauth:{bgColor:"#262628",enabled:F&&!!H.Ay.oauth.generic_oauth,name:H.Ay.oauth?.generic_oauth?.name||"OAuth",icon:H.Ay.oauth?.generic_oauth?.icon||"signin",hrefName:"generic_oauth"}}},tl=F=>({button:(0,ut.css)({color:"#d8d9da",position:"relative"}),buttonIcon:(0,ut.css)({position:"absolute",left:F.spacing(1),top:"50%",transform:"translateY(-50%)"}),divider:{base:(0,ut.css)({color:F.colors.text.primary,display:"flex",marginBottom:F.spacing(1),justifyContent:"space-between",textAlign:"center",width:"100%"}),line:(0,ut.css)({width:100,height:10,borderBottom:`1px solid ${F.colors.text}`})}}),Su=()=>{const F=(0,Nt.of)(tl);return a.createElement(a.Fragment,null,a.createElement("div",{className:F.divider.base},a.createElement("div",null,a.createElement("div",{className:F.divider.line})),a.createElement("div",null,a.createElement("span",null,!H.Ay.disableLoginForm&&a.createElement("span",null,"or"))),a.createElement("div",null,a.createElement("div",{className:F.divider.line}))),a.createElement("div",{className:"clearfix"}))};function Mu(F,_,Q){return(0,ut.cx)(_.button,(0,ut.css)({backgroundColor:F.bgColor,color:Q.colors.getContrastText(F.bgColor),"&:hover":{backgroundColor:Q.colors.emphasize(F.bgColor,.15),boxShadow:Q.shadows.z1}}))}const xu=()=>{const F=(0,f.pickBy)(Tu(),De=>De.enabled),_=Object.keys(F).length>0,Q=(0,Nt.$j)(),me=(0,Nt.of)(tl);return _?a.createElement(Pt.B,{direction:"column",width:"100%"},a.createElement(Su,null),Object.entries(F).map(([De,Ce])=>{const Ne=Ce.name;return a.createElement(fe.z9,{key:De,className:Mu(Ce,me,Q),href:`login/${Ce.hrefName?Ce.hrefName:De}`,target:"_self",fullWidth:!0},a.createElement(cs.I,{className:me.buttonIcon,name:Ce.icon}),a.createElement(as.x6,{i18nKey:"login.services.sing-in-with-prefix"},"Sign in with ",{serviceName:Ne}))})):null},Ou=()=>{const F=(0,H.zj)().verifyEmailEnabled?`${(0,H.zj)().appSubUrl}/verify`:`${(0,H.zj)().appSubUrl}/signup`,_=(0,ut.css)({paddingTop:"16px"});return a.createElement(Pt.B,{direction:"column"},a.createElement("div",{className:_},a.createElement(as.x6,{i18nKey:"login.signup.new-to-question"},"New to Grafana?")),a.createElement(fe.z9,{className:(0,ut.css)({width:"100%",justifyContent:"center"}),href:F,variant:"secondary",fill:"outline"},a.createElement(as.x6,{i18nKey:"login.signup.button-label"},"Sign up")))},Iu=()=>{const F=(0,Nt.of)(Zc);return document.title=Xc.M.AppTitle,a.createElement(Dr.A,null,({loginHint:_,passwordHint:Q,disableLoginForm:me,disableUserSignUp:De,login:Ce,isLoggingIn:Ne,changePassword:_e,skipPasswordChange:Qe,isChangingPassword:st,showDefaultPasswordWarning:Et,loginErrorMessage:Ct})=>a.createElement(Ql.GU,{isChangingPassword:st},!st&&a.createElement(Ql.qm,null,Ct&&a.createElement(Gt.F,{className:F.alert,severity:"error",title:(0,as.t)("login.error.title","Login failed")},Ct),!me&&a.createElement(Cu.Q,{onSubmit:Ce,loginHint:_,passwordHint:Q,isLoggingIn:Ne},a.createElement(Pt.B,{justifyContent:"flex-end"},!X.$.auth.disableLogin&&a.createElement(fe.z9,{className:F.forgottenPassword,fill:"text",href:`${X.$.appSubUrl}/user/password/send-reset-email`},a.createElement(as.x6,{i18nKey:"login.forgot-password"},"Forgot your password?")))),a.createElement(xu,null),!De&&a.createElement(Ou,null)),st&&a.createElement(Ql.qm,null,a.createElement(bu.S,{showDefaultPasswordWarning:Et,onSubmit:_e,onSkip:()=>Qe()}))))},Zc=F=>({forgottenPassword:(0,ut.css)({padding:0,marginTop:F.spacing(.5)}),alert:(0,ut.css)({width:"100%"})});var Pr=e(67608),Au=e(25249),Jl=e(10860);function Tl({description:F,text:_,url:Q}){const me=(0,Nt.of)(Ru);return a.createElement(Jl.Z,{className:me.card,href:Q},a.createElement(Jl.Z.Heading,null,_),a.createElement(Jl.Z.Description,{className:me.description},F))}const Ru=F=>({card:(0,ut.css)({marginBottom:0,gridTemplateRows:"1fr 0 2fr"}),description:(0,ut.css)({WebkitLineClamp:3,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden"})});function Do({navId:F,header:_}){const{node:Q}=(0,Au.C)(F),me=(0,Nt.of)(Lu),De=Q.children?.filter(Ce=>!Ce.hideFromTabs);return a.createElement(Pr.Y,{navId:Q.id},a.createElement(Pr.Y.Contents,null,a.createElement("div",{className:me.content},_,De&&De.length>0&&a.createElement("section",{className:me.grid},De?.map(Ce=>a.createElement(Tl,{key:Ce.id,description:Ce.subTitle,text:Ce.text,url:Ce.url??""}))))))}const Lu=F=>({content:(0,ut.css)({display:"flex",flexDirection:"column",gap:F.spacing(2)}),grid:(0,ut.css)({display:"grid",gap:F.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:F.spacing(2,0)})});var Sl=e(64388),qc=e(7392);function Bu(){return a.createElement(Pr.Y,{navId:"home",layout:Sl.k.Canvas,pageNav:{text:"Page not found"}},a.createElement(qc.L,{entity:"Page"}))}var Ls=e(16233),ed=e(33378),hs=e(10096),Vn=e(31678),Xl=e(72724);const Uu="dddd YYYY-MM-DD HH:mm zz",Nu="/admin/authentication/ldap";class wu extends a.PureComponent{constructor(){super(...arguments),this.onUserSync=()=>{this.props.onUserSync()}}render(){const{ldapSyncInfo:_,user:Q}=this.props,De=_&&_.nextSync?(0,Xl.LE)(_.nextSync,{format:Uu}):"",Ce=`${Nu}?user=${Q&&Q.login}`,Ne=hs.TP.hasPermission(Vn.AccessControlAction.LDAPUsersRead),_e=hs.TP.hasPermission(Vn.AccessControlAction.LDAPUsersSync);return a.createElement(a.Fragment,null,a.createElement("h3",{className:"page-heading"},"LDAP Synchronisation"),a.createElement("div",{className:"gf-form-group"},a.createElement("div",{className:"gf-form"},a.createElement("table",{className:"filter-table form-inline"},a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,"External sync"),a.createElement("td",null,"User synced via LDAP. Some changes must be done in LDAP or mappings."),a.createElement("td",null,a.createElement("span",{className:"label label-tag"},"LDAP"))),a.createElement("tr",null,_.enabled?a.createElement(a.Fragment,null,a.createElement("td",null,"Next scheduled synchronization"),a.createElement("td",{colSpan:2},De)):a.createElement(a.Fragment,null,a.createElement("td",null,"Next scheduled synchronization"),a.createElement("td",{colSpan:2},"Not enabled")))))),a.createElement("div",{className:"gf-form-button-row"},_e&&a.createElement(fe.$n,{variant:"secondary",onClick:this.onUserSync},"Sync user"),Ne&&a.createElement(fe.z9,{variant:"secondary",href:Ce},"Debug LDAP Mapping"))))}}var Ml=e(3911),qs=e(82702),Zl=e(37390),Zo=e(56034),nl=e(89062),xl=e(85927),td=e(41053);function nd({onSelected:F,className:_,inputId:Q,autoFocus:me,excludeOrgs:De}){(0,a.useEffect)(()=>{me&&Q&&document.getElementById(Q)?.focus()},[me,Q]);const[Ce,Ne]=(0,td.A)(async()=>{const Qe=(await(0,S.AI)().get("/api/orgs")).map(st=>({value:{id:st.id,name:st.name},label:st.name}));if(De){let st=De.map(Ct=>Ct.orgId);return Qe.filter(Ct=>!st.includes(Ct.value.id))}else return Qe});return a.createElement(pe.DW,{inputId:Q,className:_,isLoading:Ce.loading,defaultOptions:!0,loadOptions:Ne,filterOption:(_e,Qe)=>{const st=Qe.toLowerCase();return!!_e.value?.name.toLowerCase().includes(st)},onChange:F,placeholder:"Select organization",noOptionsMessage:"No organizations found"})}var ad=e(5133);class Fu extends a.PureComponent{constructor(){super(...arguments),this.addToOrgButtonRef=a.createRef(),this.state={showAddOrgModal:!1},this.showOrgAddModal=()=>{this.setState({showAddOrgModal:!0})},this.dismissOrgAddModal=()=>{this.setState({showAddOrgModal:!1},()=>{this.addToOrgButtonRef.current?.focus()})}}render(){const{user:_,orgs:Q,isExternalUser:me,onOrgRoleChange:De,onOrgRemove:Ce,onOrgAdd:Ne}=this.props,{showAddOrgModal:_e}=this.state,Qe=hs.TP.hasPermission(Vn.AccessControlAction.OrgUsersAdd)&&!me;return a.createElement("div",null,a.createElement("h3",{className:"page-heading"},"Organizations"),a.createElement(Pt.B,{gap:1.5,direction:"column"},a.createElement("table",{className:"filter-table form-inline"},a.createElement("tbody",null,Q.map((st,Et)=>a.createElement(Ku,{key:`${st.orgId}-${Et}`,isExternalUser:me,user:_,org:st,onOrgRoleChange:De,onOrgRemove:Ce})))),a.createElement("div",null,Qe&&a.createElement(fe.$n,{variant:"secondary",onClick:this.showOrgAddModal,ref:this.addToOrgButtonRef},"Add user to organization")),a.createElement($u,{user:_,userOrgs:Q,isOpen:_e,onOrgAdd:Ne,onDismiss:this.dismissOrgAddModal})))}}const Wu=(0,Ml.N)(F=>({removeButton:(0,ut.css)`
      margin-right: 0.6rem;
      text-decoration: underline;
      color: ${F.v1.palette.blue95};
    `,label:(0,ut.css)`
      font-weight: 500;
    `,disabledTooltip:(0,ut.css)`
      display: flex;
    `,tooltipItem:(0,ut.css)`
      margin-left: 5px;
    `,tooltipItemLink:(0,ut.css)`
      color: ${F.v1.palette.blue95};
    `,rolePickerWrapper:(0,ut.css)`
      display: flex;
    `,rolePicker:(0,ut.css)`
      flex: auto;
      margin-right: ${F.spacing(1)};
    `}));class sd extends a.PureComponent{constructor(){super(...arguments),this.state={currentRole:this.props.org.role,isChangingRole:!1,roleOptions:[]},this.onOrgRemove=async()=>{const{org:_}=this.props;this.props.onOrgRemove(_.orgId)},this.onChangeRoleClick=()=>{const{org:_}=this.props;this.setState({isChangingRole:!0,currentRole:_.role})},this.onOrgRoleChange=_=>{this.setState({currentRole:_})},this.onOrgRoleSave=()=>{this.props.onOrgRoleChange(this.props.org.orgId,this.state.currentRole)},this.onCancelClick=()=>{this.setState({isChangingRole:!1})},this.onBasicRoleChange=_=>{this.props.onOrgRoleChange(this.props.org.orgId,_)}}componentDidMount(){hs.TP.licensedAccessControlEnabled()&&hs.TP.hasPermission(Vn.AccessControlAction.ActionRolesList)&&(0,xl.RL)(this.props.org.orgId).then(_=>this.setState({roleOptions:_})).catch(_=>console.error(_))}render(){const{user:_,org:Q,isExternalUser:me,theme:De}=this.props,Ce=_?.authLabels?.length&&_?.authLabels[0],Ne=Ce?`Synced via ${Ce}`:"",{currentRole:_e,isChangingRole:Qe}=this.state,st=Wu(De),Et=(0,ut.cx)("width-16",st.label),Ct=hs.TP.hasPermission(Vn.AccessControlAction.OrgUsersWrite),kt=hs.TP.hasPermission(Vn.AccessControlAction.OrgUsersRemove)&&!me,Ut=me||!Ct,Ot=`${Q.name}-input`;return a.createElement("tr",null,a.createElement("td",{className:Et},a.createElement("label",{htmlFor:Ot},Q.name)),hs.TP.licensedAccessControlEnabled()?a.createElement("td",null,a.createElement("div",{className:st.rolePickerWrapper},a.createElement("div",{className:st.rolePicker},a.createElement(nl.y,{userId:_?.id||0,orgId:Q.orgId,basicRole:Q.role,roleOptions:this.state.roleOptions,onBasicRoleChange:this.onBasicRoleChange,basicRoleDisabled:Ut,basicRoleDisabledMessage:`This user's role is not editable because it is synchronized from your auth provider.
                    Refer to the Grafana authentication docs for details.`})),me&&a.createElement(od,{lockMessage:Ne}))):a.createElement(a.Fragment,null,Qe?a.createElement("td",null,a.createElement(ad.r,{inputId:Ot,value:_e,onChange:this.onOrgRoleChange,autoFocus:!0})):a.createElement("td",{className:"width-25"},Q.role),a.createElement("td",{colSpan:1},a.createElement("div",{className:"pull-right"},Ct&&a.createElement(_u,{lockMessage:Ne,isExternalUser:me,onChangeRoleClick:this.onChangeRoleClick,onCancelClick:this.onCancelClick,onOrgRoleSave:this.onOrgRoleSave})))),a.createElement("td",{colSpan:1},a.createElement("div",{className:"pull-right"},kt&&a.createElement(qs.Z,{confirmText:"Confirm removal",confirmVariant:"destructive",onCancel:this.onCancelClick,onConfirm:this.onOrgRemove},"Remove from organization"))))}}const Ku=(0,Nt.cV)(sd),Vu=(0,Ml.N)(()=>({modal:(0,ut.css)`
    width: 500px;
  `,buttonRow:(0,ut.css)`
    text-align: center;
  `,modalContent:(0,ut.css)`
    overflow: visible;
  `}));class $u extends a.PureComponent{constructor(){super(...arguments),this.state={selectedOrg:null,role:Vn.OrgRole.Viewer,roleOptions:[],pendingOrgId:null,pendingUserId:null,pendingRoles:[]},this.onOrgSelect=_=>{const Q=this.props.userOrgs.find(me=>me.orgId===_.value?.id);this.setState({selectedOrg:_.value,role:Q?.role||Vn.OrgRole.Viewer}),hs.TP.licensedAccessControlEnabled()&&hs.TP.hasPermission(Vn.AccessControlAction.ActionRolesList)&&(0,xl.RL)(_.value?.id).then(me=>this.setState({roleOptions:me})).catch(me=>console.error(me))},this.onOrgRoleChange=_=>{this.setState({role:_})},this.onAddUserToOrg=async()=>{const{selectedOrg:_,role:Q}=this.state;this.props.onOrgAdd(_.id,Q),hs.TP.licensedAccessControlEnabled()&&hs.TP.hasPermission(Vn.AccessControlAction.ActionUserRolesAdd)&&this.state.pendingUserId&&(await(0,xl.eA)(this.state.pendingRoles,this.state.pendingUserId,this.state.pendingOrgId),this.setState({pendingOrgId:null,pendingRoles:[],pendingUserId:null}))},this.onCancel=()=>{this.setState({selectedOrg:null,pendingRoles:[],pendingOrgId:null,pendingUserId:null}),this.props.onDismiss&&this.props.onDismiss()},this.onRoleUpdate=async(_,Q,me)=>{this.setState({pendingRoles:_,pendingOrgId:me,pendingUserId:Q})}}render(){const{isOpen:_,user:Q,userOrgs:me}=this.props,{role:De,roleOptions:Ce,selectedOrg:Ne}=this.state,_e=Vu();return a.createElement(Zl.a,{className:_e.modal,contentClassName:_e.modalContent,title:"Add to an organization",isOpen:_,onDismiss:this.onCancel},a.createElement(ra.D,{label:"Organization"},a.createElement(nd,{inputId:"new-org-input",onSelected:this.onOrgSelect,excludeOrgs:me,autoFocus:!0})),a.createElement(ra.D,{label:"Role",disabled:Ne===null},a.createElement(nl.y,{userId:Q?.id||0,orgId:Ne?.id,basicRole:De,onBasicRoleChange:this.onOrgRoleChange,basicRoleDisabled:!1,roleOptions:Ce,apply:!0,onApplyRoles:this.onRoleUpdate,pendingRoles:this.state.pendingRoles})),a.createElement(Zl.a.ButtonRow,null,a.createElement(Pt.B,{gap:2,justifyContent:"center"},a.createElement(fe.$n,{variant:"secondary",fill:"outline",onClick:this.onCancel},"Cancel"),a.createElement(fe.$n,{variant:"primary",disabled:Ne===null,onClick:this.onAddUserToOrg},"Add to organization"))))}}const rd=F=>({disabledTooltip:(0,ut.css)`
    display: flex;
  `,tooltipItemLink:(0,ut.css)`
    color: ${F.v1.palette.blue95};
  `,lockMessageClass:(0,ut.css)`
    font-style: italic;
    margin-left: 1.8rem;
    margin-right: 0.6rem;
  `,icon:(0,ut.css)`
    line-height: 2;
  `});function _u({lockMessage:F,onChangeRoleClick:_,isExternalUser:Q,onOrgRoleSave:me,onCancelClick:De}){const Ce=(0,Nt.of)(rd);return a.createElement("div",{className:Ce.disabledTooltip},Q?a.createElement(a.Fragment,null,a.createElement("span",{className:Ce.lockMessageClass},F),a.createElement(Zo.m,{placement:"right-end",interactive:!0,content:a.createElement("div",null,"This user's role is not editable because it is synchronized from your auth provider. Refer to the\xA0",a.createElement("a",{className:Ce.tooltipItemLink,href:"https://grafana.com/docs/grafana/latest/auth",rel:"noreferrer",target:"_blank"},"Grafana authentication docs"),"\xA0for details.")},a.createElement("div",{className:Ce.icon},a.createElement(cs.I,{name:"question-circle"})))):a.createElement(qs.Z,{confirmText:"Save",onClick:_,onCancel:De,onConfirm:me,disabled:Q},"Change role"))}const od=({lockMessage:F})=>{const _=(0,Nt.of)(Ai);return a.createElement("div",{className:_.disabledTooltip},a.createElement("span",{className:_.lockMessageClass},F),a.createElement(Zo.m,{placement:"right-end",interactive:!0,content:a.createElement("div",null,"This user's built-in role is not editable because it is synchronized from your auth provider. Refer to the\xA0",a.createElement("a",{className:_.tooltipItemLink,href:"https://grafana.com/docs/grafana/latest/auth",rel:"noreferrer noopener",target:"_blank"},"Grafana authentication docs"),"\xA0for details.")},a.createElement(cs.I,{name:"question-circle"})))},Ai=F=>({disabledTooltip:(0,ut.css)`
    display: flex;
  `,tooltipItemLink:(0,ut.css)`
    color: ${F.v1.palette.blue95};
  `,lockMessageClass:(0,ut.css)`
    font-style: italic;
    margin-left: 1.8rem;
    margin-right: 0.6rem;
  `}),zu=[{label:"Yes",value:!0},{label:"No",value:!1}];function br({isGrafanaAdmin:F,isExternalUser:_,lockMessage:Q,onGrafanaAdminChange:me}){const[De,Ce]=(0,a.useState)(!1),[Ne,_e]=(0,a.useState)(F),Qe=()=>Ce(!0),st=()=>{Ce(!1),_e(F)},Et=()=>me(Ne),Ct=hs.TP.hasPermission(Vn.AccessControlAction.UsersPermissionsUpdate)&&!_,kt=(0,Nt.of)(al);return a.createElement("div",null,a.createElement("h3",{className:"page-heading"},"Permissions"),a.createElement("table",{className:"filter-table form-inline"},a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",{className:"width-16"},"Grafana Admin"),De?a.createElement("td",{colSpan:2},a.createElement(ce.z,{options:zu,value:Ne,onChange:_e,autoFocus:!0})):a.createElement("td",{colSpan:2},F?a.createElement(a.Fragment,null,a.createElement(cs.I,{name:"shield"})," Yes"):a.createElement(a.Fragment,null,"No")),a.createElement("td",null,Ct&&a.createElement(qs.Z,{onClick:Qe,onConfirm:Et,onCancel:st,confirmText:"Change"},"Change"),_&&a.createElement("div",{className:kt.lockMessageClass},a.createElement(od,{lockMessage:Q})))))))}const al=F=>({lockMessageClass:(0,ut.css)`
    display: flex;
    justify-content: flex-end;
    font-style: italic;
    margin-right: ${F.spacing(.6)};
  `});var Ol=e(96374),ql=e(91634);function ku({user:F,onUserUpdate:_,onUserDelete:Q,onUserDisable:me,onUserEnable:De,onPasswordChange:Ce}){const[Ne,_e]=(0,a.useState)(!1),[Qe,st]=(0,a.useState)(!1),Et=(0,a.useRef)(null),Ct=ko=>()=>{_e(ko),!ko&&Et.current&&Et.current.focus()},kt=(0,a.useRef)(null),Ut=ko=>()=>{st(ko),!ko&&kt.current&&kt.current.focus()},Ot=()=>Q(F.id),Wt=()=>me(F.id),Sn=()=>De(F.id),ha=ko=>{_({...F,name:ko})},wa=ko=>{_({...F,email:ko})},Ua=ko=>{_({...F,login:ko})},Na=F.authLabels?.length&&F.authLabels[0],pr=Na?`Synced via ${Na}`:"",zo=F.isExternal||!hs.TP.hasPermissionInMetadata(Vn.AccessControlAction.UsersWrite,F),cp=F.isExternal||!hs.TP.hasPermissionInMetadata(Vn.AccessControlAction.UsersPasswordUpdate,F),xP=hs.TP.hasPermissionInMetadata(Vn.AccessControlAction.UsersDelete,F),OP=hs.TP.hasPermissionInMetadata(Vn.AccessControlAction.UsersDisable,F),IP=hs.TP.hasPermissionInMetadata(Vn.AccessControlAction.UsersEnable,F);return a.createElement("div",null,a.createElement("h3",{className:"page-heading"},"User information"),a.createElement(Pt.B,{direction:"column",gap:1.5},a.createElement("div",null,a.createElement("table",{className:"filter-table form-inline"},a.createElement("tbody",null,a.createElement(Il,{label:"Name",value:F.name,locked:zo,lockMessage:pr,onChange:ha}),a.createElement(Il,{label:"Email",value:F.email,locked:zo,lockMessage:pr,onChange:wa}),a.createElement(Il,{label:"Username",value:F.login,locked:zo,lockMessage:pr,onChange:Ua}),a.createElement(Il,{label:"Password",value:"********",inputType:"password",locked:cp,lockMessage:pr,onChange:Ce})))),a.createElement(Pt.B,{gap:2},xP&&a.createElement(a.Fragment,null,a.createElement(fe.$n,{variant:"destructive",onClick:Ct(!0),ref:Et},"Delete user"),a.createElement(Ol.u,{isOpen:Ne,title:"Delete user",body:"Are you sure you want to delete this user?",confirmText:"Delete user",onConfirm:Ot,onDismiss:Ct(!1)})),F.isDisabled&&IP&&a.createElement(fe.$n,{variant:"secondary",onClick:Sn},"Enable user"),!F.isDisabled&&OP&&a.createElement(a.Fragment,null,a.createElement(fe.$n,{variant:"secondary",onClick:Ut(!0),ref:kt},"Disable user"),a.createElement(Ol.u,{isOpen:Qe,title:"Disable user",body:"Are you sure you want to disable this user?",confirmText:"Disable user",onConfirm:Wt,onDismiss:Ut(!1)})))))}class Il extends a.PureComponent{constructor(){super(...arguments),this.state={editing:!1,value:this.props.value||""},this.setInputElem=_=>{this.inputElem=_},this.onEditClick=()=>{this.props.inputType==="password"?this.setState({editing:!0,value:""},this.focusInput):this.setState({editing:!0},this.focusInput)},this.onCancelClick=()=>{this.setState({editing:!1,value:this.props.value||""})},this.onInputChange=(_,Q)=>{Q!==ql.O.Invalid&&this.setState({value:_.target.value})},this.onInputBlur=(_,Q)=>{Q!==ql.O.Invalid&&this.setState({value:_.target.value})},this.focusInput=()=>{this.inputElem&&this.inputElem.focus&&this.inputElem.focus()},this.onSave=()=>{this.props.onChange&&this.props.onChange(this.state.value)}}static{this.defaultProps={value:"",locked:!1,lockMessage:"",inputType:"text"}}render(){const{label:_,locked:Q,lockMessage:me,inputType:De}=this.props,{value:Ce}=this.state,Ne=(0,ut.cx)("width-16",(0,ut.css)`
        font-weight: 500;
      `);if(Q)return a.createElement(Hu,{label:_,value:Ce,lockMessage:me});const _e=`${_}-input`;return a.createElement("tr",null,a.createElement("td",{className:Ne},a.createElement("label",{htmlFor:_e},_)),a.createElement("td",{className:"width-25",colSpan:2},this.state.editing?a.createElement(Me.p,{id:_e,type:De,defaultValue:Ce,onBlur:this.onInputBlur,onChange:this.onInputChange,ref:this.setInputElem,width:30}):a.createElement("span",null,this.props.value)),a.createElement("td",null,a.createElement(qs.Z,{confirmText:"Save",onClick:this.onEditClick,onConfirm:this.onSave,onCancel:this.onCancelClick},"Edit")))}}const Hu=({label:F,value:_,lockMessage:Q})=>{const me=(0,ut.css)`
    font-style: italic;
    margin-right: 0.6rem;
  `,De=(0,ut.cx)("width-16",(0,ut.css)`
      font-weight: 500;
    `);return a.createElement("tr",null,a.createElement("td",{className:De},F),a.createElement("td",{className:"width-25",colSpan:2},_),a.createElement("td",null,a.createElement("span",{className:me},Q)))};class id extends a.PureComponent{constructor(){super(...arguments),this.forceAllLogoutButton=a.createRef(),this.state={showLogoutModal:!1},this.showLogoutConfirmationModal=()=>{this.setState({showLogoutModal:!0})},this.dismissLogoutConfirmationModal=()=>{this.setState({showLogoutModal:!1},()=>{this.forceAllLogoutButton.current?.focus()})},this.onSessionRevoke=_=>()=>{this.props.onSessionRevoke(_)},this.onAllSessionsRevoke=()=>{this.setState({showLogoutModal:!1}),this.props.onAllSessionsRevoke()}}render(){const{sessions:_}=this.props,{showLogoutModal:Q}=this.state,me=hs.TP.hasPermission(Vn.AccessControlAction.UsersLogout);return a.createElement("div",null,a.createElement("h3",{className:"page-heading"},"Sessions"),a.createElement(Pt.B,{direction:"column",gap:1.5},a.createElement("div",null,a.createElement("table",{className:"filter-table form-inline"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Last seen"),a.createElement("th",null,"Logged on"),a.createElement("th",null,"IP address"),a.createElement("th",{colSpan:2},"Browser and OS"))),a.createElement("tbody",null,_&&_.map((De,Ce)=>a.createElement("tr",{key:`${De.id}-${Ce}`},a.createElement("td",null,De.isActive?"Now":De.seenAt),a.createElement("td",null,(0,as.Xj)(De.createdAt,{dateStyle:"long"})),a.createElement("td",null,De.clientIp),a.createElement("td",null,`${De.browser} on ${De.os} ${De.osVersion}`),a.createElement("td",null,a.createElement("div",{className:"pull-right"},me&&a.createElement(qs.Z,{confirmText:"Confirm logout",confirmVariant:"destructive",onConfirm:this.onSessionRevoke(De.id)},"Force logout")))))))),a.createElement("div",null,me&&_.length>0&&a.createElement(fe.$n,{variant:"secondary",onClick:this.showLogoutConfirmationModal,ref:this.forceAllLogoutButton},"Force logout from all devices"),a.createElement(Ol.u,{isOpen:Q,title:"Force logout from all devices",body:"Are you sure you want to force logout from all devices?",confirmText:"Force logout",onConfirm:this.onAllSessionsRevoke,onDismiss:this.dismissLogoutConfirmationModal}))))}}const Gu=id;var ir=e(57334);class ec extends a.PureComponent{constructor(){super(...arguments),this.onUserUpdate=_=>{this.props.updateUser(_)},this.onPasswordChange=_=>{const{user:Q,setUserPassword:me}=this.props;Q&&me(Q.id,_)},this.onUserDelete=_=>{this.props.deleteUser(_)},this.onUserDisable=_=>{this.props.disableUser(_)},this.onUserEnable=_=>{this.props.enableUser(_)},this.onGrafanaAdminChange=_=>{const{user:Q,updateUserPermissions:me}=this.props;Q&&me(Q.id,_)},this.onOrgRemove=_=>{const{user:Q,deleteOrgUser:me}=this.props;Q&&me(Q.id,_)},this.onOrgRoleChange=(_,Q)=>{const{user:me,updateOrgUserRole:De}=this.props;me&&De(me.id,_,Q)},this.onOrgAdd=(_,Q)=>{const{user:me,addOrgUser:De}=this.props;me&&De(me,_,Q)},this.onSessionRevoke=_=>{const{user:Q,revokeSession:me}=this.props;Q&&me(_,Q.id)},this.onAllSessionsRevoke=()=>{const{user:_,revokeAllSessions:Q}=this.props;_&&Q(_.id)},this.onUserSync=()=>{const{user:_,syncLdapUser:Q}=this.props;_&&Q(_.id)}}async componentDidMount(){const{match:_,loadAdminUserPage:Q}=this.props;Q(parseInt(_.params.id,10))}render(){const{user:_,orgs:Q,sessions:me,ldapSyncInfo:De,isLoading:Ce}=this.props,Ne=_?.isExternal&&_?.authLabels?.includes("LDAP"),_e=hs.TP.hasPermission(Vn.AccessControlAction.UsersAuthTokenList),Qe=hs.TP.hasPermission(Vn.AccessControlAction.LDAPStatusRead),st=_?.authLabels?.[0],Et=st?`Synced via ${st}`:"",Ct={text:_?.login??"",icon:"shield",subTitle:"Manage settings for an individual user."};return a.createElement(Pr.Y,{navId:"global-users",pageNav:Ct},a.createElement(Pr.Y.Contents,{isLoading:Ce},a.createElement(Pt.B,{gap:5,direction:"column"},_&&a.createElement(a.Fragment,null,a.createElement(ku,{user:_,onUserUpdate:this.onUserUpdate,onUserDelete:this.onUserDelete,onUserDisable:this.onUserDisable,onUserEnable:this.onUserEnable,onPasswordChange:this.onPasswordChange}),Ne&&_?.isExternallySynced&&(0,ed.a)("ldapsync")&&De&&Qe&&a.createElement(wu,{ldapSyncInfo:De,user:_,onUserSync:this.onUserSync}),a.createElement(br,{isGrafanaAdmin:_.isGrafanaAdmin,isExternalUser:_?.isGrafanaAdminExternallySynced,lockMessage:Et,onGrafanaAdminChange:this.onGrafanaAdminChange})),Q&&a.createElement(Fu,{user:_,orgs:Q,isExternalUser:_?.isExternallySynced,onOrgRemove:this.onOrgRemove,onOrgRoleChange:this.onOrgRoleChange,onOrgAdd:this.onOrgAdd}),me&&_e&&a.createElement(Gu,{sessions:me,onSessionRevoke:this.onSessionRevoke,onAllSessionsRevoke:this.onAllSessionsRevoke}))))}}const ju=F=>({user:F.userAdmin.user,sessions:F.userAdmin.sessions,orgs:F.userAdmin.orgs,ldapSyncInfo:F.ldap.syncInfo,isLoading:F.userAdmin.isLoading,error:F.userAdmin.error}),mi={loadAdminUserPage:ir.kz,updateUser:ir.TK,setUserPassword:ir.ly,disableUser:ir.MV,enableUser:ir.nr,deleteUser:ir.hG,updateUserPermissions:ir.N6,addOrgUser:ir.nh,updateOrgUserRole:ir.P3,deleteOrgUser:ir.Pi,revokeSession:ir.T$,revokeAllSessions:ir.VR,syncLdapUser:ir.mI},Qu=(0,Ko.connect)(ju,mi)(ec);var Al=e(49785),gi=e(48840);const Yu=({ldapConnectionInfo:F})=>{const _=(0,a.useMemo)(()=>[{id:"host",header:"Host",disableGrow:!0},{id:"port",header:"Port",disableGrow:!0},{id:"available",cell:me=>me.cell.value?a.createElement(Pt.B,{justifyContent:"end"},a.createElement(Zo.m,{content:"Connection is available"},a.createElement(cs.I,{name:"check",className:"pull-right"}))):a.createElement(Pt.B,{justifyContent:"end"},a.createElement(Zo.m,{content:"Connection is not available"},a.createElement(cs.I,{name:"exclamation-triangle"})))}],[]),Q=(0,a.useMemo)(()=>F,[F]);return a.createElement("section",null,a.createElement(Pt.B,{direction:"column",gap:2},a.createElement(Ss.E,{color:"primary",element:"h3"},"LDAP Connection"),a.createElement(gi.j,{data:Q,columns:_,getRowId:me=>me.host+me.port}),a.createElement(Ju,{ldapConnectionInfo:F})))},Ju=({ldapConnectionInfo:F})=>{if(!F.some(De=>De.error))return null;const Q=[];F.forEach(De=>{De.error&&Q.push(De)});const me=Q.map((De,Ce)=>a.createElement("div",{key:Ce},a.createElement("span",{style:{fontWeight:500}},De.host,":",De.port,a.createElement("br",null)),a.createElement("span",null,De.error),Ce!==Q.length-1&&a.createElement(a.Fragment,null,a.createElement("br",null),a.createElement("br",null))));return a.createElement(Gt.F,{title:"Connection error",severity:Vn.AppNotificationSeverity.Error},me)},Xu="dddd YYYY-MM-DD HH:mm zz",Zu=({ldapSyncInfo:F})=>{const _=(0,Xl.LE)(F.nextSync,{format:Xu}),Q=[{id:"syncAttribute"},{id:"syncValue"}],me=[{syncAttribute:"Active synchronization",syncValue:F.enabled?"Enabled":"Disabled"},{syncAttribute:"Scheduled",syncValue:F.schedule},{syncAttribute:"Next synchronization",syncValue:_}];return a.createElement("section",null,a.createElement(Ss.E,{element:"h3"},"LDAP Synchronization"),a.createElement(gi.j,{data:me,columns:Q,getRowId:De=>De.syncAttribute}))},ld=({groups:F})=>{const _=(0,a.useMemo)(()=>F,[F]),Q=(0,a.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:me=>me.value&&me.row.original.orgRole?me.value:""},{id:"orgRole",header:"Role",cell:me=>me.value||a.createElement(a.Fragment,null,"No match"," ",a.createElement(Zo.m,{content:"No matching organizations found"},a.createElement(cs.I,{name:"info-circle"})))}],[]);return a.createElement(gi.j,{headerTooltips:{orgName:{content:"Only the first match for an Organization will be used",iconName:"info-circle"}},columns:Q,data:_,getRowId:me=>me.orgId+me.orgRole+me.groupDN})},tc=({info:F})=>{const _=(0,a.useMemo)(()=>[{id:"userInfo",header:"User Information",disableGrow:!0},{id:"ldapValue"},{id:"cfgAttrValue",header:"LDAP attribute"}],[]),Q=(0,a.useMemo)(()=>[{userInfo:"First name",ldapValue:F.name.ldapValue,cfgAttrValue:F.name.cfgAttrValue},{userInfo:"Surname",ldapValue:F.surname.ldapValue,cfgAttrValue:F.surname.cfgAttrValue},{userInfo:"Username",ldapValue:F.login.ldapValue,cfgAttrValue:F.login.cfgAttrValue},{userInfo:"Email",ldapValue:F.email.ldapValue,cfgAttrValue:F.email.cfgAttrValue}],[F]);return a.createElement(gi.j,{columns:_,data:Q,getRowId:me=>me.userInfo})},Po=({permissions:F})=>{const _=(0,a.useMemo)(()=>[{id:"permission",header:"Permissions",disableGrow:!0},{id:"value"}],[]),Q=(0,a.useMemo)(()=>[{permission:"Grafana admin",value:F.isGrafanaAdmin?a.createElement(a.Fragment,null,a.createElement(cs.I,{name:"shield"})," Yes"):"No"},{permission:"Status",value:F.isDisabled?a.createElement(a.Fragment,null,a.createElement(cs.I,{name:"times"})," Inactive"):a.createElement(a.Fragment,null,a.createElement(cs.I,{name:"check"})," Active")}],[F]);return a.createElement(gi.j,{data:Q,columns:_,getRowId:me=>me.permission})},kr=({teams:F})=>{const _=(0,a.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:({row:{original:{orgName:Q}}})=>a.createElement(a.Fragment,null,Q||"No matching teams found")},{id:"teamName",header:"Team",cell:({row:{original:{teamName:Q,orgName:me}}})=>Q&&me?Q:""}],[]);return a.createElement(gi.j,{data:F,columns:_,getRowId:Q=>Q.teamName})},qu=({ldapUser:F})=>a.createElement(Pt.B,{direction:"column",gap:4},a.createElement(tc,{info:F.info}),a.createElement(Po,{permissions:F.permissions}),F.roles&&F.roles.length>0&&a.createElement(ld,{groups:F.roles}),F.teams&&F.teams.length>0?a.createElement(kr,{teams:F.teams}):a.createElement(ue.a,null,a.createElement(Ss.E,null,"No teams found via LDAP"))),em={text:"LDAP",subTitle:"Verify your LDAP and user mapping configuration.",icon:"book",id:"LDAP"},tm=({clearUserMappingInfo:F,queryParams:_,loadLdapState:Q,loadLdapSyncStatus:me,loadUserMapping:De,clearUserError:Ce,ldapUser:Ne,userError:_e,ldapError:Qe,ldapSyncInfo:st,ldapConnectionInfo:Et})=>{const[Ct,kt]=(0,a.useState)(!0),{register:Ut,handleSubmit:Ot}=(0,Al.mN)(),Wt=(0,a.useCallback)(async Ua=>De(Ua),[De]);(0,a.useEffect)(()=>{const Ua=async()=>Promise.all([Q(),me()]);async function Na(){await F(),await Ua(),_.username&&await Wt(_.username),kt(!1)}Na()},[F,Wt,Q,me,_]);const Sn=({username:Ua})=>{Ua&&Wt(Ua)},ha=()=>{Ce()},wa=hs.TP.hasPermission(Vn.AccessControlAction.LDAPUsersRead);return a.createElement(Pr.Y,{navId:"authentication",pageNav:em},a.createElement(Pr.Y.Contents,{isLoading:Ct},a.createElement(Pt.B,{direction:"column",gap:4},Qe&&Qe.title&&a.createElement(Gt.F,{title:Qe.title,severity:Vn.AppNotificationSeverity.Error},Qe.body),a.createElement(Yu,{ldapConnectionInfo:Et}),(0,ed.a)("ldapsync")&&st&&a.createElement(Zu,{ldapSyncInfo:st}),wa&&a.createElement("section",null,a.createElement("h3",null,"Test user mapping"),a.createElement("form",{onSubmit:Ot(Sn)},a.createElement(ra.D,{label:"Username"},a.createElement(Me.p,{...Ut("username",{required:!0}),width:34,id:"username",type:"text",defaultValue:_.username,addonAfter:a.createElement(fe.$n,{variant:"primary",type:"submit"},"Run")}))),_e&&_e.title&&a.createElement(Gt.F,{title:_e.title,severity:Vn.AppNotificationSeverity.Error,onRemove:ha},_e.body),Ne&&a.createElement(qu,{ldapUser:Ne})))))},nm=F=>({ldapConnectionInfo:F.ldap.connectionInfo,ldapUser:F.ldap.user,ldapSyncInfo:F.ldap.syncInfo,userError:F.ldap.userError,ldapError:F.ldap.ldapError}),pi={loadLdapState:ir.JI,loadLdapSyncStatus:ir.pm,loadUserMapping:ir.Kg,clearUserError:ir.DX,clearUserMappingInfo:ir.Jc},am=(0,Ko.connect)(nm,pi)(tm);var Pa=e(27921),er=e(75471);function sm(F=H.config){return[{path:"/alerting",component:Vs(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/home",exact:!1,component:Vs(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/list",roles:(0,er.C0)([Vn.AccessControlAction.AlertingRuleRead,Vn.AccessControlAction.AlertingRuleExternalRead]),component:Vs(()=>Promise.all([e.e(6552),e.e(3511)]).then(e.bind(e,76543)))},{path:"/alerting/routes",roles:(0,er.C0)([Vn.AccessControlAction.AlertingNotificationsRead,Vn.AccessControlAction.AlertingNotificationsExternalRead]),component:Vs(()=>Promise.all([e.e(3932),e.e(6719)]).then(e.bind(e,34708)))},{path:"/alerting/routes/mute-timing/new",roles:(0,er.C0)([Vn.AccessControlAction.AlertingNotificationsWrite,Vn.AccessControlAction.AlertingNotificationsExternalWrite]),component:Vs(()=>e.e(4501).then(e.bind(e,39349)))},{path:"/alerting/routes/mute-timing/edit",roles:(0,er.C0)([Vn.AccessControlAction.AlertingNotificationsWrite,Vn.AccessControlAction.AlertingNotificationsExternalWrite]),component:Vs(()=>e.e(4501).then(e.bind(e,39349)))},{path:"/alerting/silences",roles:(0,er.C0)([Vn.AccessControlAction.AlertingInstanceRead,Vn.AccessControlAction.AlertingInstancesExternalRead,Vn.AccessControlAction.AlertingSilenceRead]),component:Vs(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/new",roles:(0,er.C0)([Vn.AccessControlAction.AlertingInstanceCreate,Vn.AccessControlAction.AlertingInstancesExternalWrite]),component:Vs(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/:id/edit",component:Vs(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/notifications",roles:(0,er.C0)([Vn.AccessControlAction.AlertingNotificationsRead,Vn.AccessControlAction.AlertingNotificationsExternalRead]),component:Vs(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/templates/*",roles:(0,er.C0)([Vn.AccessControlAction.AlertingNotificationsRead,Vn.AccessControlAction.AlertingNotificationsExternalRead]),component:Vs(()=>e.e(9224).then(e.bind(e,35868)))},{path:"/alerting/notifications/:type/new",roles:(0,er.C0)([Vn.AccessControlAction.AlertingNotificationsWrite,Vn.AccessControlAction.AlertingNotificationsExternalWrite]),component:Vs(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/receivers/:id/edit",roles:(0,er.C0)([Vn.AccessControlAction.AlertingNotificationsWrite,Vn.AccessControlAction.AlertingNotificationsExternalWrite,Vn.AccessControlAction.AlertingNotificationsRead,Vn.AccessControlAction.AlertingNotificationsExternalRead]),component:Vs(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/edit",roles:(0,er.C0)([Vn.AccessControlAction.AlertingNotificationsWrite,Vn.AccessControlAction.AlertingNotificationsExternalWrite]),component:Vs(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/duplicate",roles:(0,er.C0)([Vn.AccessControlAction.AlertingNotificationsWrite,Vn.AccessControlAction.AlertingNotificationsExternalWrite]),component:Vs(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type",roles:(0,er.C0)([Vn.AccessControlAction.AlertingNotificationsWrite,Vn.AccessControlAction.AlertingNotificationsExternalWrite]),component:Vs(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/groups/",roles:(0,er.C0)([Vn.AccessControlAction.AlertingInstanceRead,Vn.AccessControlAction.AlertingInstancesExternalRead]),component:Vs(()=>e.e(8427).then(e.bind(e,12564)))},{path:"/alerting/new/:type?",pageClass:"page-alerting",roles:(0,er.C0)([Vn.AccessControlAction.AlertingRuleCreate,Vn.AccessControlAction.AlertingRuleExternalWrite]),component:Vs(()=>Promise.all([e.e(3932),e.e(3726),e.e(9947),e.e(6552),e.e(4009)]).then(e.bind(e,50166)))},{path:"/alerting/:id/edit",pageClass:"page-alerting",roles:(0,er.C0)([Vn.AccessControlAction.AlertingRuleUpdate,Vn.AccessControlAction.AlertingRuleExternalWrite]),component:Vs(()=>Promise.all([e.e(3932),e.e(3726),e.e(9947),e.e(6552),e.e(4009)]).then(e.bind(e,50166)))},{path:"/alerting/:id/modify-export",pageClass:"page-alerting",roles:(0,er.C0)([Vn.AccessControlAction.AlertingRuleRead]),component:Vs(()=>Promise.all([e.e(3932),e.e(3726),e.e(9947),e.e(6552),e.e(4009)]).then(e.bind(e,69179)))},{path:"/alerting/:sourceName/:id/view",pageClass:"page-alerting",roles:(0,er.C0)([Vn.AccessControlAction.AlertingRuleRead,Vn.AccessControlAction.AlertingRuleExternalRead]),component:Vs(()=>Promise.resolve().then(e.bind(e,79741)))},{path:"/alerting/:sourceName/:name/find",pageClass:"page-alerting",roles:(0,er.C0)([Vn.AccessControlAction.AlertingRuleRead,Vn.AccessControlAction.AlertingRuleExternalRead]),component:Vs(()=>e.e(5516).then(e.bind(e,6165)))},{path:"/alerting/admin",roles:()=>["Admin"],component:Vs(()=>e.e(9438).then(e.bind(e,53191)))}]}function Vs(F){const _=()=>e.e(9029).then(e.bind(e,5961));return(0,Pa.A)(H.config.unifiedAlertingEnabled?F:_)}var sl=e(56361),hi=e(6320);const cd=F=>({alertContent:(0,ut.css)`
    display: flex;
    flex-direction: row;
    padding: 0;
    justify-content: space-between;
    align-items: center;
  `,alertParagraph:(0,ut.css)`
    margin: 0 ${F.spacing(1)} 0 0;
    line-height: ${F.spacing(F.components.height.sm)};
  `});function rm(){const F=(0,Nt.of)(cd),[_,Q]=(0,a.useState)(!0);return _?a.createElement(Gt.F,{severity:"info",title:"",onRemove:()=>Q(!1)},a.createElement("div",{className:F.alertContent},a.createElement("p",{className:F.alertParagraph},"Data sources have a new home! You can discover new data sources or manage existing ones in the Connections page, accessible from the main menu."),a.createElement(fe.z9,{"aria-label":"Link to Connections",icon:"arrow-right",href:hi.b.DataSources,fill:"text"},"Go to connections"))):a.createElement(a.Fragment,null)}function om(){return[{path:`/${hi.q}`,exact:!1,component:(0,Pa.A)(()=>Promise.all([e.e(6359),e.e(3418),e.e(2154)]).then(e.bind(e,19514)))}]}var Ri=e(83883),rl=e(57220),ol=(F=>(F.ViewIRMMainPage="grafana_irm_configuration_tracker_main_page_view",F.OpenEssentials="grafana_irm_configuration_tracker_essentials_open",F.CloseEssentials="grafana_irm_configuration_tracker_essentials_closed",F.ClickDataSources="grafana_irm_configuration_tracker_data_sources_clicked",F))(ol||{});function Rl(F,_){(0,gr.rR)(F,{..._})}var nc=e(3704),im=e(79938),dd=e(82843),ud=e(37534),lm=e(730);function cm(){const[F,{data:_,isLoading:Q}]=im.hK.endpoints.rulerRules.useLazyQuery({refetchOnFocus:!0,refetchOnReconnect:!0}),{dsFeatures:me,isLoadingDsFeatures:De}=(0,lm.O3)(rl.hY),Ce=me?.rulerConfig;return(0,a.useEffect)(()=>{Ce&&F({rulerConfig:Ce})},[Ce,F]),{isDone:(_?Object.entries(_).flatMap(([Qe,st])=>st.flatMap(Et=>Et.rules)):[]).length>0,isLoading:Q||De}}function md(F){return F.some(_=>_.grafana_managed_receiver_configs?.some(Q=>Q.type===ud.J4.OnCall))}function dm(){const F=dd.m.endpoints.getAlertmanagerConfiguration.useQuery(rl.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{contactPoints:F.data?.alertmanager_config?.receivers??[],isLoading:F.isLoading}}function um(){const F=dd.m.endpoints.getAlertmanagerConfiguration.useQuery(rl.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{defaultContactpoint:F.data?.alertmanager_config?.route?.receiver??"",isLoading:F.isLoading}}const mm="<example@email.com>";function fm(F,_){return _.some(me=>me.name===F&&me.grafana_managed_receiver_configs?.some(De=>De.name===F&&De.settings?.address!==mm))}var ac=e(99494),Ll=e(49962);const gm=F=>`/api/plugins/${ac.W.Incident}/resources${F}`,pm=Ll.H.injectEndpoints({endpoints:F=>({getIncidentsPluginConfig:F.query({query:()=>({url:gm("/api/ConfigurationTrackerService.GetConfigurationTracker"),data:{},method:"POST",showErrorAlert:!1})})})});var fd=e(12210);function sc(){const{installed:F,loading:_}=(0,fd._)(ac.W.Incident),{data:Q,isLoading:me}=pm.endpoints.getIncidentsPluginConfig.useQuery();return{isInstalled:F??!1,isChatOpsInstalled:Q?.isChatOpsInstalled??!1,isIncidentCreated:Q?.isIncidentCreated??!1,isLoading:_||me}}var gd=e(26423);function hm(){const{installed:F}=(0,fd._)(ac.W.OnCall),{data:_}=gd.WG.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!F,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return _??[]}function vm(){const{data:F,isLoading:_}=gd.WG.endpoints.onCallConfigChecks.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:_,onCallConfigChecks:F??{is_chatops_connected:!1,is_integration_chatops_connected:!1}}}function Em(){return hm().map(_=>({label:_.display_name,value:_.value}))}function ym(){const{onCallConfigChecks:{is_chatops_connected:F,is_integration_chatops_connected:_},isLoading:Q}=vm();return{is_chatops_connected:F,is_integration_chatops_connected:_,isLoading:Q}}function Dm(){const{contactPoints:F,isLoading:_}=dm(),{defaultContactpoint:Q,isLoading:me}=um(),{isDone:De,isLoading:Ce}=cm(),{isChatOpsInstalled:Ne,isInstalled:_e,isLoading:Qe}=sc(),st=Em(),{is_chatops_connected:Et,is_integration_chatops_connected:Ct,isLoading:kt}=ym();return{alerting:{contactPoints:F,defaultContactpoint:Q,isCreateAlertRuleDone:De},incidents:{isChatOpsInstalled:Ne,isIncidentsInstalled:_e},onCall:{onCallOptions:st,is_chatops_connected:Et,is_integration_chatops_connected:Ct},isLoading:_||me||Ce||Qe||kt}}function Vo(){const{alerting:{contactPoints:F,defaultContactpoint:_,isCreateAlertRuleDone:Q},incidents:{isChatOpsInstalled:me,isIncidentsInstalled:De},onCall:{onCallOptions:Ce,is_chatops_connected:Ne,is_integration_chatops_connected:_e},isLoading:Qe}=Dm();function st(Ut,Ot){const Wt=(0,nc.c)(Ot+Ut,{returnTo:location.pathname+location.search});x.Ny.push(Wt)}const Et={sections:[{title:"Detect",description:"Configure Grafana Alerting",steps:[{title:"Update default email contact point",description:"Add a valid email to the default email contact point.",button:{type:"openLink",urlLink:{url:`/alerting/notifications/receivers/${_}/edit`,queryParams:{alertmanager:"grafana"}},label:"Edit",labelOnDone:"View",urlLinkOnDone:{url:"/alerting/notifications"}},done:fm(_,F)},{title:"Connect alerting to OnCall",description:"Create an OnCall integration for an alerting contact point.",button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:"Connect",urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:md(F)},{title:"Create alert rule",description:"Create an alert rule to monitor your system.",button:{type:"openLink",urlLink:{url:"/alerting/new"},label:"Create",urlLinkOnDone:{url:"/alerting/list"},labelOnDone:"View"},done:Q}]},{title:"Respond",description:"Configure OnCall and Incident",steps:[{title:"Initialize Incident plugin",description:"Initialize the Incident plugin to declare and manage incidents.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/walkthrough/generate-key"},label:"Initialize",urlLinkOnDone:{url:"/a/grafana-incident-app"},labelOnDone:"View"},done:De},{title:"Connect your Messaging workspace to OnCall",description:"Receive alerts and oncall notifications within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps",chatOpsTab:"Slack"}},label:"Connect",urlLinkOnDone:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps"}},labelOnDone:"View"},done:Ne},{title:"Connect your Messaging workspace to Incident",description:"Automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/integrations/grate.slack"},label:"Connect",urlLinkOnDone:{url:"/a/grafana-incident-app/integrations"}},done:me},{title:"Add Messaging workspace channel to OnCall Integration",description:"Select ChatOps channels to route notifications",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/integrations/"},label:"Add",urlLinkOnDone:{url:"/a/grafana-oncall-app/integrations/"},labelOnDone:"View"},done:_e}]},{title:"Test your configuration",description:"",steps:[{title:"Send OnCall demo alert via Alerting integration",description:"In the integration page, click Send demo alert, to review your notification",button:{type:"dropDown",label:"Select integration",options:Ce,onClickOption:Ut=>st(Ut,"/a/grafana-oncall-app/integrations/"),stepNotAvailableText:"No integrations available"}},{title:"Create Incident drill",description:"Practice solving an Incident",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app",queryParams:{declare:"new",drill:"1"}},label:"Start drill"}}]}]},{stepsDone:Ct,totalStepsToDo:kt}=Et.sections.reduce((Ut,Ot)=>{const Wt=Ot.steps.filter(ha=>ha.done).length,Sn=Ot.steps.reduce((ha,wa)=>wa.done!==void 0?ha+1:ha,0);return{stepsDone:Ut.stepsDone+Wt,totalStepsToDo:Ut.totalStepsToDo+Sn}},{stepsDone:0,totalStepsToDo:0});return{essentialContent:Et,stepsDone:Ct,totalStepsToDo:kt,isLoading:Qe}}const Hr=({dataSourceConfigurationData:{dataSourceCompatibleWithAlerting:F},essentialsConfigurationData:{stepsDone:_,totalStepsToDo:Q}})=>(0,a.useMemo)(()=>{function me(){const De=F?"You have connected a datasource.":"Connect at least one data source to start receiving data.",Ce=F?"View":"Connect";return{id:ic.CONNECT_DATASOURCE,title:"Connect data source",description:De,actionButtonTitle:Ce,isDone:F}}return[me(),{id:ic.ESSENTIALS,title:"Essentials",titleIcon:"star",description:"Configure the features you need to start using Grafana IRM workflows",actionButtonTitle:"Start",stepsDone:_,totalStepsToDo:Q}]},[F,_,Q]);var qo=e(39558);function Pm({stepsDone:F,totalStepsToDo:_}){const Q=(0,Nt.of)(pd);return _===0?null:a.createElement("div",{className:Q.containerStyles,role:"progressbar","aria-valuenow":F,"aria-valuemax":_},a.createElement("div",{className:Q.fillerStyles(F/_*100)}))}function bm({stepsDone:F,totalStepsToDo:_}){return a.createElement("div",null,a.createElement(Ss.E,{color:"success"},F)," of ",_)}function pd(F){return{containerStyles:(0,ut.css)({height:F.spacing(2),borderRadius:F.shape.radius.pill,backgroundColor:F.colors.border.weak,flex:"auto"}),fillerStyles:_=>(0,ut.css)({height:"100%",width:`${_}%`,backgroundColor:F.colors.success.main,borderRadius:F.shape.radius.pill,textAlign:"right"})}}function hd({config:F,handleActionClick:_,isLoading:Q=!1}){const me=(0,Nt.of)(Cm);return a.createElement(Pt.B,{direction:"column",gap:1,justifyContent:"space-around"},a.createElement("div",{className:me.cardContent},a.createElement(Pt.B,{direction:"column",gap:1},a.createElement(Pt.B,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1},a.createElement(Pt.B,{direction:"row",gap:1,alignItems:"center"},F.title,F.titleIcon&&a.createElement(cs.I,{name:F.titleIcon}),F.isDone&&!Q&&a.createElement(cs.I,{name:"check-circle",color:"green",size:"lg"})),F.stepsDone&&F.totalStepsToDo&&!Q&&a.createElement(Pt.B,{direction:"row",gap:.5},a.createElement(bm,{stepsDone:F.stepsDone,totalStepsToDo:F.totalStepsToDo}),"complete")),a.createElement(Pt.B,{direction:"column"},Q?a.createElement(qo._,{text:"Loading configuration...."}):F.description,!Q&&F.stepsDone&&F.totalStepsToDo&&a.createElement(Pm,{stepsDone:F.stepsDone,totalStepsToDo:F.totalStepsToDo}))),a.createElement(Pt.B,{direction:"row",gap:1,justifyContent:"flex-start",alignItems:"flex-end"},a.createElement(fe.$n,{variant:"secondary",onClick:()=>_(F.id,F.isDone)},F.actionButtonTitle))))}const Cm=F=>({cardTitle:(0,ut.css)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"}),cardContent:(0,ut.css)({background:F.colors.background.secondary,padding:F.spacing(2),borderRadius:F.shape.radius.default,height:"100%",gap:F.spacing(1),display:"flex",flexDirection:"column",justifyContent:"space-between"})});var rc=e(87978),Bl=e(83122),il=e(38138);function Tm({onClose:F,essentialsConfig:_,stepsDone:Q,totalStepsToDo:me}){return a.createElement(rc._,{title:"Essentials",subtitle:"Complete the following configuration tasks",onClose:F},a.createElement(Sm,{essentialContent:_,stepsDone:Q,totalStepsToDo:me}))}function Sm({essentialContent:F,stepsDone:_,totalStepsToDo:Q}){return a.createElement(Pt.B,{direction:"column",gap:1},a.createElement(oc,{stepsDone:_,totalStepsToDo:Q}),F.sections.map(me=>a.createElement(Mm,{key:me.title,section:me})))}function Mm({section:F}){const _=(0,Nt.of)(Im);return a.createElement("div",{className:_.wrapper},a.createElement(Ss.E,{element:"h4"},F.title),a.createElement(Ss.E,{color:"secondary"},F.description),a.createElement(Pt.B,{direction:"column",gap:2},F.steps.map((Q,me)=>a.createElement(Om,{key:me,step:Q}))))}function xm({done:F}){return F?a.createElement(cs.I,{name:"check-circle",color:"green","data-testid":"checked-step"}):a.createElement(cs.I,{name:"circle","data-testid":"unckecked-step"})}function Om({step:F}){return a.createElement(Pt.B,{direction:"row",justifyContent:"space-between","data-testid":"step"},a.createElement(Pt.B,{direction:"row",alignItems:"center"},F.done!==void 0&&a.createElement(xm,{done:F.done}),a.createElement(Ss.E,{variant:"body"},F.title),a.createElement(Zo.m,{content:F.description,placement:"right"},a.createElement(cs.I,{name:"question-circle"}))),a.createElement(Ed,{...F.button,done:F.done,"data-testid":"step-button"}))}function vd(F){const{urlLink:_,label:Q,urlLinkOnDone:me,labelOnDone:De,done:Ce}=F,Ne=_?.url?(0,nc.c)(_.url,{returnTo:location.pathname+location.search,..._.queryParams}):"",_e=me?.url?(0,nc.c)(me.url,{returnTo:location.pathname+location.search,...me.queryParams}):"",Qe=Ce?_e:Ne;return a.createElement(fe.z9,{href:Qe,variant:"secondary"},Ce?De??Q:Q)}function Ed({type:F,urlLink:_,urlLinkOnDone:Q,label:me,labelOnDone:De,options:Ce,onClickOption:Ne,done:_e,stepNotAvailableText:Qe}){switch(F){case"openLink":return a.createElement(vd,{urlLink:_,label:me,urlLinkOnDone:Q,labelOnDone:De,done:_e});case"dropDown":return Ce?.length?a.createElement(Bl.m,{overlay:a.createElement(il.W,null,Ce?.map(st=>a.createElement(il.W.Item,{label:st.label,key:st.value,onClick:()=>{Ne?.(st.value)}})))},a.createElement(fe.$n,{variant:"secondary",size:"md"},me,a.createElement(cs.I,{name:"angle-down"}))):a.createElement(Ss.E,null,Qe??"No options available"," ")}}function oc({stepsDone:F,totalStepsToDo:_}){return a.createElement(Pt.B,{direction:"row",gap:1,alignItems:"center"},"Your progress",a.createElement(Pm,{stepsDone:F,totalStepsToDo:_}),a.createElement(bm,{stepsDone:F,totalStepsToDo:_}))}const Im=F=>({wrapper:(0,ut.css)({margin:F.spacing(2,0),padding:F.spacing(2),border:`1px solid ${F.colors.border.medium}`,borderRadius:F.shape.radius.default,display:"flex",flexDirection:"column",gap:F.spacing(2)})});var ic=(F=>(F[F.CONNECT_DATASOURCE=0]="CONNECT_DATASOURCE",F[F.ESSENTIALS=1]="ESSENTIALS",F))(ic||{});function Am(){return{dataSourceCompatibleWithAlerting:!!(0,rl.k5)()}}function Rm(){const F=(0,Nt.of)(Lm),_=(0,Zs.W6)(),Q=Am(),me=Vo(),De=Hr({dataSourceConfigurationData:Q,essentialsConfigurationData:me});(0,a.useEffect)(()=>{Rl(ol.ViewIRMMainPage,{essentialStepsDone:0,essentialStepsToDo:0,dataSourceCompatibleWithAlerting:Q.dataSourceCompatibleWithAlerting})},[Q.dataSourceCompatibleWithAlerting]);const[Ce,Ne]=(0,a.useState)(!1),_e=(st,Et)=>{switch(Rl(ol.ClickDataSources,{essentialStepsDone:me.stepsDone,essentialStepsToDo:me.totalStepsToDo,dataSourceCompatibleWithAlerting:Q.dataSourceCompatibleWithAlerting}),st){case 0:Et?_.push(Ri.I.List):_.push(Ri.I.New);break;case 1:Ne(!0),Rl(ol.OpenEssentials,{essentialStepsDone:me.stepsDone,essentialStepsToDo:me.totalStepsToDo,dataSourceCompatibleWithAlerting:Q.dataSourceCompatibleWithAlerting});break;default:return}};function Qe(){Ne(!1),Rl(ol.CloseEssentials,{essentialStepsDone:me.stepsDone,essentialStepsToDo:me.totalStepsToDo,dataSourceCompatibleWithAlerting:Q.dataSourceCompatibleWithAlerting})}return a.createElement(a.Fragment,null,a.createElement(Ss.E,{element:"h4",variant:"h4"},"Configure"),a.createElement("section",{className:F.container},De.map(st=>a.createElement(hd,{key:st.id,config:st,handleActionClick:_e,isLoading:me.isLoading})),Ce&&a.createElement(Tm,{onClose:Qe,essentialsConfig:me.essentialContent,stepsDone:me.stepsDone,totalStepsToDo:me.totalStepsToDo})),a.createElement(Ss.E,{element:"h4",variant:"h4"},"IRM apps"))}const Lm=F=>({container:(0,ut.css)({marginBottom:0,display:"grid",gap:F.spacing(3),gridTemplateColumns:" 1fr 1fr"})});var lc=e(66253);const Bm=[{path:"/plugins",navId:"plugins",roles:cc([Vn.AccessControlAction.PluginsInstall,Vn.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:lc.vk.Home,component:(0,Pa.A)(()=>e.e(4519).then(e.bind(e,65965)))},{path:"/plugins/browse",navId:"plugins",roles:cc([Vn.AccessControlAction.PluginsInstall,Vn.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:lc.vk.Browse,component:(0,Pa.A)(()=>e.e(4519).then(e.bind(e,65965)))},{path:"/plugins/:pluginId/",navId:"plugins",roles:cc([Vn.AccessControlAction.PluginsInstall,Vn.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:lc.vk.Details,component:(0,Pa.A)(()=>Promise.all([e.e(6359),e.e(3418),e.e(7891)]).then(e.bind(e,86400)))}];function cc(F,_){return()=>F.some(Q=>hs.TP.hasPermission(Q))?[]:_}function Um(){return Bm}var yd=e(17422),ao=e(65307),Dd=e(13834),dc=e(62625),Li=e(26272),Nm=e(39419),bo=e(76888);function up(F){return console.error(F),Ul("Exception thrown","See console for details")}function Pd(){return Ul("Page not found","404 Error")}function Ul(F,_){const Q={text:F,subTitle:_,icon:"exclamation-triangle"};return{node:Q,main:Q}}var bd=e(94954),Cd=e(27716),ll=e(54427),uc=e(60677);const mc=a.createContext(Td());mc.displayName="PluginPageContext";function Td(){return{sectionNav:{main:{text:"Plugin page"},node:{text:"Plugin page"}}}}function wm(F){return{sectionNav:F??Td().sectionNav}}const Fm={loading:!0,loadingError:!1,pluginNav:null,plugin:null};function Sd({pluginId:F,pluginNavSection:_}){const Q=(0,Zs.W5)(),me=(0,Zs.zy)(),[De,Ce]=(0,a.useReducer)(cl.reducer,Fm),Ne=X.$.appSubUrl+me.pathname+me.search,{plugin:_e,loading:Qe,loadingError:st,pluginNav:Et}=De,Ct=(0,uc.Wy)(_,Et,Ne),kt=(0,a.useMemo)(()=>(0,x.SE)(me.search),[me.search]),Ut=(0,a.useMemo)(()=>wm(Ct),[Ct]),Ot=(0,bo.Il)();(0,a.useEffect)(()=>{Wm(F,Ce)},[F]);const Wt=(0,a.useCallback)(Ua=>Ce(cl.actions.changeNav(Ua)),[]);if(!_e||F!==_e.meta.id){const Ua=Ot.chrome.state.getValue().layout;return a.createElement(Pr.Y,{navModel:Ct,pageNav:{text:""},layout:Ua},Qe&&a.createElement(Nm.A,null),!Qe&&st&&a.createElement(qc.L,{entity:"App"}))}if(!_e.root)return a.createElement(Pr.Y,{navModel:Ct??Ul("Plugin load error")},a.createElement("div",null,"No root app page component found"));const Sn=_e.root&&a.createElement(Dd.a,{meta:_e.meta},a.createElement(_e.root,{meta:_e.meta,basename:Q.url,onNavChanged:Wt,query:kt,path:me.pathname})),ha=()=>{if(!_e.meta?.includes)return!0;const Ua=_e.meta?.includes.find(pr=>pr.path===me.pathname);if(!Ua)return!0;if(Ua?.action&&X.$.featureToggles.accessControlOnCall)return hs.TP.hasPermission(Ua.action);if(hs.TP.isGrafanaAdmin||hs.TP.user.orgRole===dc.X.Admin)return!0;const Na=Ua?.role||"";return!Na||hs.TP.isEditor&&Na===dc.X.Viewer?!0:hs.TP.hasRole(Na)},wa=()=>a.createElement(Gt.F,{severity:"warning",title:"Access denied"},"You do not have permission to see this page.");return ha()?Et?a.createElement(a.Fragment,null,Ct?a.createElement(Pr.Y,{navModel:Ct,pageNav:Et?.node},a.createElement(Pr.Y.Contents,{isLoading:Qe},Sn)):a.createElement(Pr.Y,null,Sn)):a.createElement(mc.Provider,{value:Ut},Sn):a.createElement(wa,null)}const cl=(0,ao.Z0)({name:"prom-builder-container",initialState:Fm,reducers:{setState:(F,_)=>{Object.assign(F,_.payload)},changeNav:(F,_)=>{let Q=_.payload;Q&&Q.node.children&&(Q={...Q,node:{...Q.main,hideFromBreadcrumbs:!0}}),F.pluginNav=Q}}});async function Wm(F,_){try{const Q=await(0,Cd.x)(F).then(me=>{const De=Km(me);return De?(hs.lE.emit(Li.r1.alertError,[De]),_(cl.actions.setState({pluginNav:Ul(De)})),null):(0,ll.ui)(me)});_(cl.actions.setState({plugin:Q,loading:!1,loadingError:!1,pluginNav:null}))}catch(Q){_(cl.actions.setState({plugin:null,loading:!1,loadingError:!0,pluginNav:Pd()}));const me=Q instanceof Error?Q:new Error((0,bd.q)(Q));uc.z4.logError(me),console.error(me)}}function Km(F){return F?F.type!==rt.QE.app?"Plugin must be an app":F.enabled?null:"Application Not Enabled":"Unknown Plugin"}const Bi=Sd;var bs=e(99140);function Vm(){const F=(0,bs.Gu)(),{navIndex:_}=F,Q=Ce=>Ce.startsWith("standalone-plugin-page-/"),me=Ce=>"pluginId"in Ce&&"id"in Ce;return[...Object.values(_).filter(me).map(Ce=>{const Ne=(0,yd.rH)(Ce),_e=`/a/${Ce.pluginId}`,Qe=Q(Ce.id)&&Ce.url||_e,st=Q(Ce.id)&&!Ce.url?.startsWith("/a/");return{path:Qe,exact:!1,sensitive:st,component:()=>a.createElement(Bi,{pluginId:Ce.pluginId,pluginNavSection:Ne})}}),{path:"/a/:pluginId",exact:!1,component:({match:Ce})=>a.createElement(Bi,{pluginId:Ce.params.pluginId,pluginNavSection:_.home})}]}const fc=[{path:"/profile",component:(0,Pa.A)(()=>e.e(2472).then(e.bind(e,48357)))},{path:"/profile/password",component:(0,Pa.A)(()=>e.e(8107).then(e.bind(e,28107)))},{path:"/profile/select-org",component:(0,Pa.A)(()=>e.e(7430).then(e.bind(e,44613)))},{path:"/profile/notifications",component:(0,Pa.A)(()=>e.e(4140).then(e.bind(e,78015)))}];function $m(F=H.config){return F.profileEnabled?fc:(0,f.uniq)(fc.map(Q=>Q.path)).map(Q=>({path:Q,component:(0,Pa.A)(()=>e.e(5173).then(e.bind(e,35208)))}))}const _m=()=>!H.config.publicDashboardsEnabled||!H.config.featureToggles.publicDashboards?[]:[{path:"/dashboard/public",pageClass:"page-dashboard",routeName:Vn.DashboardRoutes.Public,component:(0,Pa.A)(()=>e.e(5761).then(e.bind(e,53371)))},{path:"/public-dashboards/:accessToken",pageClass:"page-dashboard",routeName:Vn.DashboardRoutes.Public,chromeless:!0,component:(0,Pa.A)(()=>Promise.all([e.e(9569),e.e(6263),e.e(7197)]).then(e.bind(e,20302)))}],zm=[];function km(){return[...Vm(),{path:"/",pageClass:"page-dashboard",routeName:Vn.DashboardRoutes.Home,component:(0,Pa.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136)]).then(e.bind(e,63392)))},{path:"/d/:uid/:slug?",pageClass:"page-dashboard",routeName:Vn.DashboardRoutes.Normal,component:(0,Pa.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136)]).then(e.bind(e,63392)))},{path:"/dashboard/new",roles:()=>Ls.TP.evaluatePermission([Vn.AccessControlAction.DashboardsCreate]),pageClass:"page-dashboard",routeName:Vn.DashboardRoutes.New,component:(0,Pa.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,63392)))},{path:"/dashboard/new-with-ds/:datasourceUid",roles:()=>Ls.TP.evaluatePermission([Vn.AccessControlAction.DashboardsCreate]),component:(0,Pa.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,30798)))},{path:"/dashboard/:type/:slug",pageClass:"page-dashboard",routeName:Vn.DashboardRoutes.Normal,component:(0,Pa.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,63392)))},{path:"/dashboards/embedding-test",component:(0,Pa.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,14962)))},{path:"/d-solo/:uid/:slug?",pageClass:"dashboard-solo",routeName:Vn.DashboardRoutes.Normal,chromeless:!0,component:(0,Pa.A)(()=>H.Ay.featureToggles.dashboardSceneSolo?Promise.all([e.e(9569),e.e(7849)]).then(e.bind(e,24880)):Promise.all([e.e(9569),e.e(4492)]).then(e.bind(e,55087)))},{path:"/dashboard-solo/:type/:slug",pageClass:"dashboard-solo",routeName:Vn.DashboardRoutes.Normal,chromeless:!0,component:(0,Pa.A)(()=>Promise.all([e.e(9569),e.e(7849)]).then(e.bind(e,55087)))},{path:"/dashboard/import",component:(0,Pa.A)(()=>e.e(2550).then(e.bind(e,23390)))},{path:Ri.I.List,component:()=>a.createElement(Zs.rd,{to:hi.b.DataSources})},{path:Ri.I.Edit,component:F=>a.createElement(Zs.rd,{to:hi.b.DataSourcesEdit.replace(":uid",F.match.params.uid)})},{path:Ri.I.Dashboards,component:F=>a.createElement(Zs.rd,{to:hi.b.DataSourcesDashboards.replace(":uid",F.match.params.uid)})},{path:Ri.I.New,component:()=>a.createElement(Zs.rd,{to:hi.b.DataSourcesNew})},{path:"/datasources/correlations",component:(0,Pa.A)(()=>H.Ay.featureToggles.correlations?e.e(9981).then(e.bind(e,32429)):e.e(8014).then(e.bind(e,55244)))},{path:"/dashboards",component:(0,Pa.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid/:slug",component:(0,Pa.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid",component:(0,Pa.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/explore",pageClass:"page-explore",roles:()=>Ls.TP.evaluatePermission([Vn.AccessControlAction.DataSourcesExplore]),component:(0,Pa.A)(()=>H.Ay.exploreEnabled?Promise.all([e.e(660),e.e(1698),e.e(5511),e.e(9604)]).then(e.bind(e,52379)):e.e(4422).then(e.bind(e,53518)))},{path:"/apps",component:()=>a.createElement(Do,{navId:"apps"})},{path:"/alerts-and-incidents",component:()=>a.createElement(Do,{navId:"alerts-and-incidents",header:!(0,sl.y$)()&&(0,sl.qc)()||(0,sl.ES)()?a.createElement(Rm,null):void 0})},{path:"/testing-and-synthetics",component:()=>a.createElement(Do,{navId:"testing-and-synthetics"})},{path:"/monitoring",component:()=>a.createElement(Do,{navId:"monitoring"})},{path:"/infrastructure",component:()=>a.createElement(Do,{navId:"infrastructure"})},{path:"/frontend",component:()=>a.createElement(Do,{navId:"frontend"})},{path:"/admin/general",component:()=>a.createElement(Do,{navId:"cfg/general"})},{path:"/admin/plugins",component:()=>a.createElement(Do,{navId:"cfg/plugins"})},{path:"/admin/access",component:()=>a.createElement(Do,{navId:"cfg/access"})},{path:"/org",component:(0,Pa.A)(()=>e.e(1510).then(e.bind(e,69047)))},{path:"/org/new",component:(0,Pa.A)(()=>e.e(7930).then(e.bind(e,25913)))},{path:"/org/users",component:(0,Pa.A)(()=>e.e(9856).then(e.bind(e,31083)))},{path:"/org/users/invite",component:(0,Pa.A)(()=>e.e(7720).then(e.bind(e,91230)))},{path:"/org/apikeys",roles:()=>Ls.TP.evaluatePermission([Vn.AccessControlAction.ActionAPIKeysRead]),component:(0,Pa.A)(()=>e.e(4196).then(e.bind(e,9699)))},{path:"/org/serviceaccounts",roles:()=>Ls.TP.evaluatePermission([Vn.AccessControlAction.ServiceAccountsRead,Vn.AccessControlAction.ServiceAccountsCreate]),component:(0,Pa.A)(()=>e.e(6777).then(e.bind(e,23645)))},{path:"/org/serviceaccounts/create",component:(0,Pa.A)(()=>e.e(4176).then(e.bind(e,63606)))},{path:"/org/serviceaccounts/:id",component:(0,Pa.A)(()=>e.e(6576).then(e.bind(e,82936)))},{path:"/org/teams",roles:()=>Ls.TP.evaluatePermission([Vn.AccessControlAction.ActionTeamsRead,Vn.AccessControlAction.ActionTeamsCreate]),component:(0,Pa.A)(()=>e.e(1036).then(e.bind(e,52576)))},{path:"/org/teams/new",roles:()=>Ls.TP.evaluatePermission([Vn.AccessControlAction.ActionTeamsCreate]),component:(0,Pa.A)(()=>e.e(5436).then(e.bind(e,80011)))},{path:"/org/teams/edit/:id/:page?",roles:()=>Ls.TP.evaluatePermission([Vn.AccessControlAction.ActionTeamsRead,Vn.AccessControlAction.ActionTeamsCreate]),component:(0,Pa.A)(()=>e.e(2212).then(e.bind(e,92886)))},{path:"/admin",component:()=>a.createElement(Do,{navId:"cfg",header:a.createElement(rm,null)})},{path:"/admin/authentication",roles:()=>Ls.TP.evaluatePermission([Vn.AccessControlAction.SettingsWrite]),component:H.Ay.licenseInfo.enabledFeatures?.saml||H.Ay.ldapEnabled||H.Ay.featureToggles.ssoSettingsApi?(0,Pa.A)(()=>e.e(5592).then(e.bind(e,51332))):()=>a.createElement(Zs.rd,{to:"/admin"})},{path:"/admin/authentication/ldap",component:am},{path:"/admin/authentication/:provider",roles:()=>Ls.TP.evaluatePermission([Vn.AccessControlAction.SettingsWrite]),component:H.Ay.featureToggles.ssoSettingsApi?(0,Pa.A)(()=>e.e(5592).then(e.bind(e,22468))):()=>a.createElement(Zs.rd,{to:"/admin"})},{path:"/admin/settings",component:(0,Pa.A)(()=>e.e(7659).then(e.bind(e,98493)))},{path:"/admin/upgrading",component:(0,Pa.A)(()=>e.e(5356).then(e.bind(e,55356)))},{path:"/admin/users",component:(0,Pa.A)(()=>e.e(1743).then(e.bind(e,20972)))},{path:"/admin/users/create",component:(0,Pa.A)(()=>e.e(9239).then(e.bind(e,64665)))},{path:"/admin/users/edit/:id",component:Qu},{path:"/admin/orgs",component:(0,Pa.A)(()=>e.e(9736).then(e.bind(e,24870)))},{path:"/admin/orgs/edit/:id",component:(0,Pa.A)(()=>e.e(9119).then(e.bind(e,57582)))},{path:"/admin/featuretoggles",component:H.Ay.featureToggles.featureToggleAdminPage?(0,Pa.A)(()=>e.e(7024).then(e.bind(e,47295))):()=>a.createElement(Zs.rd,{to:"/admin"})},{path:"/admin/storage/:path*",roles:()=>["Admin"],component:(0,Pa.A)(()=>e.e(1927).then(e.bind(e,68932)))},{path:"/admin/stats",component:(0,Pa.A)(()=>e.e(9299).then(e.bind(e,51372)))},H.Ay.featureToggles.onPremToCloudMigrations&&{path:"/admin/migrate-to-cloud",roles:()=>["Admin"],component:(0,Pa.A)(()=>e.e(3704).then(e.bind(e,44953)))},{path:"/login",component:Iu,pageClass:"login-page",chromeless:!0},{path:"/invite/:code",component:(0,Pa.A)(()=>e.e(8576).then(e.bind(e,14383))),chromeless:!0},{path:"/verify",component:H.Ay.verifyEmailEnabled?(0,Pa.A)(()=>e.e(8786).then(e.bind(e,78786))):()=>a.createElement(Zs.rd,{to:"/signup"}),pageClass:"login-page",chromeless:!0},{path:"/signup",component:H.Ay.disableUserSignUp?()=>a.createElement(Zs.rd,{to:"/login"}):(0,Pa.A)(()=>e.e(7914).then(e.bind(e,27914))),pageClass:"login-page",chromeless:!0},{path:"/user/password/send-reset-email",chromeless:!0,component:(0,Pa.A)(()=>e.e(3818).then(e.bind(e,2713)))},{path:"/user/password/reset",component:(0,Pa.A)(()=>e.e(641).then(e.bind(e,37344))),pageClass:"login-page",chromeless:!0},{path:"/dashboard/snapshots",component:(0,Pa.A)(()=>e.e(6590).then(e.bind(e,72602)))},H.Ay.featureToggles.dashboardRestore&&{path:"/dashboard/recentlyDeleted",roles:()=>Ls.TP.evaluatePermission([Vn.AccessControlAction.DashboardsDelete]),component:(0,Pa.A)(()=>Promise.all([e.e(6359),e.e(6299)]).then(e.bind(e,92126)))},{path:"/playlists",component:(0,Pa.A)(()=>e.e(1168).then(e.bind(e,44450)))},{path:"/playlists/play/:uid",component:(0,Pa.A)(()=>e.e(1374).then(e.bind(e,93129)))},{path:"/playlists/new",component:(0,Pa.A)(()=>e.e(7616).then(e.bind(e,62579)))},{path:"/playlists/edit/:uid",component:(0,Pa.A)(()=>e.e(7620).then(e.bind(e,84535)))},{path:"/sandbox/benchmarks",component:(0,Pa.A)(()=>e.e(9354).then(e.bind(e,98351)))},{path:"/sandbox/test",component:(0,Pa.A)(()=>e.e(5354).then(e.bind(e,65802)))},{path:"/dashboards/f/:uid/:slug/library-panels",component:(0,Pa.A)(()=>e.e(5804).then(e.bind(e,15111)))},{path:"/dashboards/f/:uid/:slug/alerting",roles:()=>Ls.TP.evaluatePermission([Vn.AccessControlAction.AlertingRuleRead]),component:(0,Pa.A)(()=>e.e(4333).then(e.bind(e,30027)))},{path:"/library-panels",component:(0,Pa.A)(()=>e.e(8516).then(e.bind(e,45434)))},{path:"/notifications",component:(0,Pa.A)(()=>e.e(4140).then(e.bind(e,78015)))},{path:"/explore/metrics",chromeless:!1,exact:!1,component:(0,Pa.A)(()=>e.e(4785).then(e.bind(e,89858)))},...Um(),...Hm(),...sm(),...$m(),...zm,..._m(),...om(),{path:"/*",component:Bu}].filter(ws.zz)}function Hm(F=H.Ay){return F.supportBundlesEnabled?[{path:"/support-bundles",component:(0,Pa.A)(()=>e.e(123).then(e.bind(e,21821)))},{path:"/support-bundles/create",component:(0,Pa.A)(()=>e.e(1515).then(e.bind(e,33809)))}]:[]}const Md=a.forwardRef((F,_)=>a.createElement("div",{id:"ngRoot",ref:_,dangerouslySetInnerHTML:{__html:"<grafana-app ng-cloak></grafana-app>"}}));Md.displayName="AngularRoot";var ei=e(95344),xd=e(7376),Gm=e(81634),ti=e(74856),jm=e(71500),Qm=e(6923);async function Ym(){if(X.$.angularSupportEnabled){const{AngularApp:F}=await Promise.all([e.e(9362),e.e(7808),e.e(8888)]).then(e.bind(e,27808)),_=new F;_.init(),_.bootstrap()}else(0,xd.w)({load:(F,_,Q)=>({destroy:()=>{},digest:()=>{},getScope:()=>({})})}),(0,Gm.j)({get:F=>{switch(F){case"backendSrv":return(0,ei.l)("getLegacyAngularInjector","backendSrv","use getBackendSrv() in @grafana/runtime"),(0,S.AI)();case"contextSrv":return(0,ei.l)("getLegacyAngularInjector","contextSrv"),hs.TP;case"dashboardSrv":return(0,ei.l)("getLegacyAngularInjector","getDashboardSrv"),(0,d.UA)();case"datasourceSrv":return(0,ei.l)("getLegacyAngularInjector","datasourceSrv","use getDataSourceSrv() in @grafana/runtime"),(0,B.l)();case"linkSrv":return(0,ei.l)("getLegacyAngularInjector","linkSrv"),(0,Qm.mQ)();case"validationSrv":return(0,ei.l)("getLegacyAngularInjector","validationSrv"),jm.P;case"timeSrv":return(0,ei.l)("getLegacyAngularInjector","timeSrv"),(0,ti.jG)();case"templateSrv":return(0,ei.l)("getLegacyAngularInjector","templateSrv","use getTemplateSrv() in @grafana/runtime"),(0,Oe.w)()}throw"Angular is disabled.  Unable to expose: "+F}})}var Od=e(46942),Id=e.n(Od),dl=e(60619),so=e(33390),Ad=e(18828),ul=e(85690),gc=e(93225),Jm=e(57514),Xm=e(69529),Rd=e(65178),Zm=e(35822);const Nl=0,Cr=F=>{const _=a.useRef(null),Q=a.useRef(null),me=a.useRef(F.items);me.current=F.items;const De=(0,Zm.useVirtual)({size:me.current.length,parentRef:Q}),{query:Ce,search:Ne,currentRootActionId:_e,activeIndex:Qe,options:st}=(0,or.useKBar)(Ut=>({search:Ut.searchQuery,currentRootActionId:Ut.currentRootActionId,activeIndex:Ut.activeIndex}));a.useEffect(()=>{const Ut=Ot=>{Ot.key==="ArrowUp"||Ot.ctrlKey&&Ot.key==="p"?(Ot.preventDefault(),Ce.setActiveIndex(Wt=>{let Sn=Wt>Nl?Wt-1:Wt;if(typeof me.current[Sn]=="string"){if(Sn===0)return Wt;Sn-=1}return Sn})):Ot.key==="ArrowDown"||Ot.ctrlKey&&Ot.key==="n"?(Ot.preventDefault(),Ce.setActiveIndex(Wt=>{let Sn=Wt<me.current.length-1?Wt+1:Wt;if(typeof me.current[Sn]=="string"){if(Sn===me.current.length-1)return Wt;Sn+=1}return Sn})):Ot.key==="Enter"&&(Ot.preventDefault(),_.current?.click())};return window.addEventListener("keydown",Ut),()=>window.removeEventListener("keydown",Ut)},[Ce]);const{scrollToIndex:Et}=De;a.useEffect(()=>{Et(Qe,{align:Qe<=1?"end":"auto"})},[Qe,Et]),a.useEffect(()=>{Ce.setActiveIndex(typeof F.items[Nl]=="string"?Nl+1:Nl)},[Ne,_e,F.items,Ce]);const Ct=a.useCallback((Ut,Ot)=>{if(typeof Ot=="string")return;const Wt=Ot.url;Ot.command?(Ot.command.perform(Ot),Ce.toggle()):Wt?Ut.ctrlKey||Ut.metaKey||Ut.shiftKey||Ce.toggle():(Ce.setSearch(""),Ce.setCurrentRootAction(Ot.id)),st.callbacks?.onSelectAction?.(Ot)},[Ce,st]),kt=(0,Rd.usePointerMovedSinceMount)();return a.createElement("div",{ref:Q,style:{maxHeight:F.maxHeight||400,position:"relative",overflow:"auto"}},a.createElement("div",{role:"listbox",id:or.KBAR_LISTBOX,style:{height:`${De.totalSize}px`,width:"100%"}},De.virtualItems.map(Ut=>{const Ot=me.current[Ut.index],{target:Wt,url:Sn}=Ot,ha=typeof Ot!="string"&&{onPointerMove:()=>kt&&Qe!==Ut.index&&Ce.setActiveIndex(Ut.index),onPointerDown:()=>Ce.setActiveIndex(Ut.index),onClick:pr=>Ct(pr,Ot)},wa=Ut.index===Qe,Ua={id:(0,or.getListboxItemId)(Ut.index),role:"option","aria-selected":wa,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${Ut.start}px)`},...ha},Na=a.cloneElement(F.onRender({item:Ot,active:wa}),{ref:Ut.measureRef});return Sn?a.createElement("a",{key:Ut.index,href:typeof Sn=="function"?Sn(Ne):Sn,target:Wt,ref:wa?_:null,...Ua},Na):a.createElement("div",{key:Ut.index,ref:wa?_:null,...Ua},Na)})))},pc=a.forwardRef(({action:F,active:_,currentRootActionId:Q},me)=>{const De=a.useMemo(()=>{if(!Q)return F.ancestors;const Qe=F.ancestors.findIndex(st=>st.id===Q);return F.ancestors.slice(Qe+1)},[F.ancestors,Q]),Ce=(0,Nt.of)(mp);let Ne=F.name;const _e=Qe=>!!(Qe.command?.perform||Qe.url);return F.children.length&&!_e(F)&&!Ne.endsWith("...")&&(Ne+="..."),a.createElement("div",{ref:me,className:(0,ut.cx)(Ce.row,_&&Ce.activeRow)},a.createElement("div",{className:Ce.actionContainer},F.icon,a.createElement("div",{className:Ce.textContainer},De.map(Qe=>a.createElement(a.Fragment,{key:Qe.id},!_e(Qe)&&a.createElement(a.Fragment,null,a.createElement("span",{className:Ce.breadcrumbAncestor},Qe.name),a.createElement("span",{className:Ce.breadcrumbSeparator},"\u203A")))),a.createElement("span",null,Ne)),F.subtitle&&a.createElement("span",{className:Ce.subtitleText},F.subtitle)))});pc.displayName="ResultItem";const mp=F=>({row:(0,ut.css)({padding:F.spacing(1,2),display:"flex",alightItems:"center",justifyContent:"space-between",cursor:"pointer",position:"relative",borderRadius:F.shape.radius.default,margin:F.spacing(0,1)}),activeRow:(0,ut.css)({color:F.colors.text.maxContrast,background:F.colors.emphasize(F.colors.background.primary,.03),"&:before":{display:"block",content:'" "',position:"absolute",left:0,top:0,bottom:0,width:F.spacing(.5),borderRadius:F.shape.radius.default,backgroundImage:F.colors.gradients.brandVertical}}),actionContainer:(0,ut.css)({display:"flex",gap:F.spacing(1),alignItems:"baseline",fontSize:F.typography.fontSize,width:"100%"}),textContainer:(0,ut.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),breadcrumbAncestor:(0,ut.css)({color:F.colors.text.secondary}),breadcrumbSeparator:(0,ut.css)({color:F.colors.text.secondary,marginLeft:F.spacing(1),marginRight:F.spacing(1)}),subtitleText:(0,ut.css)({...F.typography.bodySmall,color:F.colors.text.secondary,display:"block",flexBasis:"20%",flexGrow:1,flexShrink:0,maxWidth:"fit-content",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});var ml=e(76459),Ld=e.n(ml),qm=e(62301),hc=e(24439);const ef=6,tf=5,nf=4,vc=3,af=2,sf=1,rf=100,Bd=5,of=Ld()(cf,200);async function lf(){if(!Ls.TP.user.isSignedIn)return[];const F=(await qm.A.getDashboardOpened()).slice(0,Bd),Q=(await(0,hc.getGrafanaSearcher)().search({kind:["dashboard"],limit:Bd,uid:F})).view.toArray();return Q.sort((De,Ce)=>{const Ne=F.indexOf(De.uid),_e=F.indexOf(Ce.uid);return Ne-_e}),Q.map(De=>{const{url:Ce,name:Ne}=De;return{id:`recent-dashboards${Ce}`,name:`${Ne}`,section:(0,as.t)("command-palette.section.recent-dashboards","Recent dashboards"),priority:ef,url:Ce}})}async function cf(F){if(F.length===0||!Ls.TP.user.isSignedIn&&!X.$.bootData.settings.anonymousEnabled)return[];const _=await(0,hc.getGrafanaSearcher)().search({kind:["dashboard","folder"],query:F,limit:rf});return _.view.map(me=>{const{url:De,name:Ce,kind:Ne,location:_e}=me;return{id:`go/${Ne}${De}`,name:`${Ce}`,section:Ne==="dashboard"?(0,as.t)("command-palette.section.dashboard-search-results","Dashboards"):(0,as.t)("command-palette.section.folder-search-results","Folders"),priority:sf,url:De,subtitle:_.view.dataFrame.meta?.custom?.locationInfo[_e]?.name}})}function df(F,_){const[Q,me]=(0,a.useState)([]),[De,Ce]=(0,a.useState)(!1),Ne=(0,a.useRef)(0);return(0,a.useEffect)(()=>{const _e=Date.now();_&&F.length>0?(Ce(!0),of(F).then(Qe=>{_e>Ne.current&&(me(Qe),Ce(!1),Ne.current=_e)})):(me([]),Ce(!1),Ne.current=_e)},[_,F]),{searchResults:Q,isFetchingSearchResults:De}}var Ui=e(28215),Tr=e(28444),tr=e(28138),uf=e(38645),Ud=e(93522);const Nd=F=>{let _=F.children||[];if(F.id==="help"){const Q=()=>{tr.A.publish(new Tr.S8({component:Ud.N}))};F.children=[..._,...(0,uf.Dd)(),...mf(),{id:"keyboard-shortcuts",text:(0,as.t)("nav.help/keyboard-shortcuts","Keyboard shortcuts"),icon:"keyboard",onClick:Q}]}return F},Ec=(F,_)=>{const Q={...F},me=Q.onClick;return Q.onClick=()=>{(0,gr.rR)("grafana_navigation_item_clicked",{path:Q.url??Q.id,menuIsDocked:_}),me?.()},Q.children&&(Q.children=Q.children.map(De=>Ec(De,_))),Q},wd=(F,_)=>!!F.children?.some(Q=>Q===_?!0:wd(Q,_)),yc=(F,_,Q)=>{const{id:me,parentItem:De}=_;if(Q==="/")return F.find(Ce=>Ce.id===Ui.Id);if(_.id!=="profile"){for(const Ce of F){const Ne=!!(Ce.id&&Ce.id===me),_e=Ce.text===_.text&&Ce.url===_.url;if(Ne||_e)return Ce;if(Ce.children){const Qe=yc(Ce.children,_);if(Qe)return Qe}}if(De)return yc(F,De)}};function mf(){const{buildInfo:F,licenseInfo:_}=X.$,Q=_.stateInfo?` (${_.stateInfo})`:"",me=[];return me.push({target:"_blank",id:"version",text:`${F.edition}${Q}`,url:_.licenseUrl,icon:"external-link-alt"}),F.hasUpdate&&me.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),me}var Ni=e(2769);function Fd(F){return"navModel."+F.id}function Wd(F,_=[]){const Q=[];for(let me of F){me.id==="help"&&(me=Nd({...me}),delete me.url);const{url:De,target:Ce,text:Ne,isCreateAction:_e,children:Qe,onClick:st,keywords:Et}=me,Ct=!!Qe?.length;if(!(De||st||Ct))continue;let kt=De;De&&(me.id==="connections-add-new-connection"||me.id==="standalone-plugin-page-/connections/add-new-connection")&&(kt=ha=>{const wa=Et?.find(Ua=>Ua.toLowerCase().includes(ha.toLowerCase()));return wa?`${De}?search=${wa}`:De});const Ut=_e?(0,as.t)("command-palette.section.actions","Actions"):(0,as.t)("command-palette.section.pages","Pages"),Ot=_e?tf:nf,Wt=_.map(ha=>ha.text).join(" > "),Sn={id:Fd(me),name:Ne,section:Ut,url:kt,target:Ce,parent:_.length>0&&!_e?Fd(_[_.length-1]):void 0,perform:st,keywords:Et?.join(" "),priority:Ot,subtitle:_e?void 0:Wt};if(Q.push(Sn),Qe?.length){const ha=Wd(Qe,[..._,me]);Q.push(...ha)}}return Q}const Dc=(F,_)=>{const Q=[{id:"preferences/theme",name:(0,as.t)("command-palette.action.change-theme","Change theme..."),keywords:"interface color dark light",section:(0,as.t)("command-palette.section.preferences","Preferences"),priority:vc},{id:"preferences/dark-theme",name:(0,as.t)("command-palette.action.dark-theme","Dark"),keywords:"dark theme",perform:()=>(0,Ni.K)("dark"),parent:"preferences/theme",priority:vc},{id:"preferences/light-theme",name:(0,as.t)("command-palette.action.light-theme","Light"),keywords:"light theme",perform:()=>(0,Ni.K)("light"),parent:"preferences/theme",priority:vc}],me=Wd(F);return[...Q,..._,...me]};var wi=e(74135);const ff={};function Pc(){const{extensions:F}=(0,W.vl)({extensionPointId:wi.S.CommandPalette,context:ff,limitPerPlugin:3});return(0,a.useMemo)(()=>F.map(_=>({section:_.category??"Extensions",priority:af,id:_.id,name:_.title,target:_.path,perform:()=>_.onClick&&_.onClick()})),[F])}function gf(F){const[_,Q]=(0,a.useState)([]),[me,De]=(0,a.useState)([]),Ce=Pc(),Ne=(0,Vn.useSelector)(_e=>_e.navBarTree);return(0,a.useEffect)(()=>{const _e=Dc(Ne,Ce);Q(_e)},[Ne,Ce]),(0,a.useEffect)(()=>{F||lf().then(_e=>De(_e)).catch(_e=>{console.error("Error loading recent dashboard actions",_e)})},[F]),F?_:[...me,..._]}var pf=e(53076);const bc={name:"none",priority:or.Priority.NORMAL};function Cc(F,_){return _.priority-F.priority}function hf(){const{search:F,actions:_,rootActionId:Q}=(0,or.useKBar)(Et=>({search:Et.searchQuery,actions:Et.actions,rootActionId:Et.currentRootActionId})),me=a.useMemo(()=>Object.keys(_).reduce((Et,Ct)=>{const kt=_[Ct];if(!kt.parent&&!Q&&Et.push(kt),kt.id===Q)for(let Ut=0;Ut<kt.children.length;Ut++)Et.push(kt.children[Ut]);return Et},[]).sort(Cc),[_,Q]),De=a.useCallback(Et=>{let Ct=[];for(let kt=0;kt<Et.length;kt++)Ct.push(Et[kt]);return function kt(Ut,Ot=Ct){for(let Wt=0;Wt<Ut.length;Wt++)if(Ut[Wt].children.length>0){let Sn=Ut[Wt].children;for(let ha=0;ha<Sn.length;ha++)Ot.push(Sn[ha]);kt(Ut[Wt].children,Ot)}return Ot}(Et)},[]),Ce=!F,Ne=a.useMemo(()=>Ce?me:De(me),[De,me,Ce]),_e=vf(Ne,F),Qe=a.useMemo(()=>{let Et={},Ct=[],kt=[];for(let Ot=0;Ot<_e.length;Ot++){const Wt=_e[Ot],Sn=Wt.action,ha=Wt.score||or.Priority.NORMAL,wa={name:typeof Sn.section=="string"?Sn.section:Sn.section?.name||bc.name,priority:typeof Sn.section=="string"?ha:Sn.section?.priority||0+ha};Et[wa.name]||(Et[wa.name]=[],Ct.push(wa)),Et[wa.name].push({priority:Sn.priority+ha,action:Sn})}kt=Ct.sort(Cc).map(Ot=>({name:Ot.name,actions:Et[Ot.name].sort(Cc).map(Wt=>Wt.action)}));let Ut=[];for(let Ot=0;Ot<kt.length;Ot++){let Wt=kt[Ot];Wt.name!==bc.name&&Ut.push(Wt.name);for(let Sn=0;Sn<Wt.actions.length;Sn++)Ut.push(Wt.actions[Sn])}return Ut},[_e]),st=a.useMemo(()=>Q,[Qe]);return a.useMemo(()=>({results:Qe,rootActionId:st}),[st,Qe])}function vf(F,_){const Q=yf(),me=a.useMemo(()=>({filtered:F,search:_}),[F,_]),{filtered:De,search:Ce}=(0,Rd.useThrottledValue)(me);return a.useMemo(()=>{if(Ce.trim()==="")return De.map(Qe=>({score:0,action:Qe}));const Ne=De.map(({name:Qe,keywords:st})=>`${Qe} ${st??""}`.toLowerCase()),_e=[];if(Ce.length>Ef){const Qe=Ce.toLowerCase();for(let st=0;st<Ne.length;st++){const Ct=Ne[st].indexOf(Qe);if(Ct>-1){const kt=Ct*-1,Ut=De[st];_e.push({score:kt,action:Ut})}}}else{const Qe=Q.split(Ce).length,st=1/0,Et=Qe<5?4:0,[,Ct,kt]=Q.search(Ne,Ce,Et,st);if(Ct&&kt)for(let Ut=0;Ut<kt.length;Ut++){const Ot=kt[Ut],Wt=kt.length-Ut,Sn=De[Ct.idx[Ot]];_e.push({score:Wt,action:Sn})}}return _e},[De,Ce,Q])}const Ef=25;function yf(){const F=a.useRef();return F.current||(F.current=new pf.A({intraMode:0,intraIns:0})),F.current}function Kd(){const F=(0,Nt.of)(Vd),{query:_,showing:Q,searchQuery:me}=(0,or.useKBar)(Et=>({showing:Et.visualState===or.VisualState.showing,searchQuery:Et.searchQuery})),De=gf(me);(0,or.useRegisterActions)(De,[De]);const{searchResults:Ce,isFetchingSearchResults:Ne}=df(me,Q),_e=(0,a.useRef)(null),{overlayProps:Qe}=(0,gc.e)({isOpen:Q,onClose:()=>_.setVisualState(or.VisualState.animatingOut)},_e),{dialogProps:st}=(0,Ad.s)({},_e);return(0,a.useEffect)(()=>{Q&&(0,gr.rR)("command_palette_opened")},[Q]),De.length>0?a.createElement(or.KBarPortal,null,a.createElement(or.KBarPositioner,{className:F.positioner},a.createElement(or.KBarAnimator,{className:F.animator},a.createElement(ul.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},a.createElement("div",{...Qe,...st},a.createElement("div",{className:F.searchContainer},a.createElement(cs.I,{name:"search",size:"md"}),a.createElement(or.KBarSearch,{defaultPlaceholder:(0,as.t)("command-palette.search-box.placeholder","Search or jump to..."),className:F.search}),a.createElement("div",{className:F.loadingBarContainer},Ne&&a.createElement(Jm.G,{width:500,delay:0}))),a.createElement("div",{className:F.resultsContainer},a.createElement(Df,{isFetchingSearchResults:Ne,searchResults:Ce}))))))):null}const Df=({isFetchingSearchResults:F,searchResults:_})=>{const{results:Q,rootActionId:me}=hf(),De=(0,Nt.of)(Vd),Ce=(0,as.t)("command-palette.section.dashboard-search-results","Dashboards"),Ne=(0,as.t)("command-palette.section.folder-search-results","Folders"),_e=(0,a.useMemo)(()=>_.filter(Ct=>Ct.id.startsWith("go/dashboard")).map(Ct=>new or.ActionImpl(Ct,{store:{}})),[_]),Qe=(0,a.useMemo)(()=>_.filter(Ct=>Ct.id.startsWith("go/folder")).map(Ct=>new or.ActionImpl(Ct,{store:{}})),[_]),st=(0,a.useMemo)(()=>{const Ct=[...Q];return Qe.length>0&&(Ct.push(Ne),Ct.push(...Qe)),_e.length>0&&(Ct.push(Ce),Ct.push(..._e)),Ct},[Q,Ce,_e,Ne,Qe]);return!F&&st.length===0?a.createElement(Xm.p,{variant:"not-found",role:"alert",message:(0,as.t)("command-palette.empty-state.message","No results found")}):a.createElement(Cr,{items:st,maxHeight:650,onRender:({item:Ct,active:kt})=>{const Ut=st[0]===Ct;return typeof Ct=="string"?a.createElement("div",{className:(0,ut.cx)(De.sectionHeader,Ut&&De.sectionHeaderFirst)},Ct):a.createElement(pc,{action:Ct,active:kt,currentRootActionId:me})}})},Vd=F=>({positioner:(0,ut.css)({zIndex:F.zIndex.portal,marginTop:"0px",paddingTop:"4px !important","&::before":{content:'""',position:"fixed",top:0,right:0,bottom:0,left:0,background:F.components.overlay.background,backdropFilter:"blur(1px)"}}),animator:(0,ut.css)({maxWidth:F.breakpoints.values.md,width:"100%",background:F.colors.background.primary,color:F.colors.text.primary,borderRadius:F.shape.radius.default,border:`1px solid ${F.colors.border.weak}`,overflow:"hidden",boxShadow:F.shadows.z3}),loadingBarContainer:(0,ut.css)({position:"absolute",left:0,right:0,bottom:0}),searchContainer:(0,ut.css)({alignItems:"center",background:F.components.input.background,borderBottom:`1px solid ${F.colors.border.weak}`,display:"flex",gap:F.spacing(1),padding:F.spacing(1,2),position:"relative"}),search:(0,ut.css)({fontSize:F.typography.fontSize,width:"100%",boxSizing:"border-box",outline:"none",border:"none",color:F.components.input.text}),spinner:(0,ut.css)({height:"22px"}),resultsContainer:(0,ut.css)({paddingBottom:F.spacing(1)}),sectionHeader:(0,ut.css)({padding:F.spacing(1.5,2,2,2),fontSize:F.typography.bodySmall.fontSize,fontWeight:F.typography.fontWeightMedium,color:F.colors.text.secondary,borderTop:`1px solid ${F.colors.border.weak}`,marginTop:F.spacing(1)}),sectionHeaderFirst:(0,ut.css)({paddingBottom:F.spacing(1),borderTop:"none",marginTop:0})});var Pf=e(59875),$d=e(86634),bf=e(40276),Cf=e(78685),Tf=e(8887),Sf=e(18759);const Mf=({children:F})=>{const _=(0,Nt.of)(xf);return a.createElement(a.Fragment,null,F,a.createElement("span",{className:_.highlight}))},xf=F=>({highlight:(0,ut.css)({backgroundColor:F.colors.success.main,borderRadius:F.shape.radius.circle,width:"6px",height:"6px",display:"inline-block;",position:"absolute",top:"50%",transform:"translateY(-50%)"})});var Of=e(50720);function _d({children:F,isActive:_,onClick:Q,target:me,url:De}){const Ce=(0,Nt.$j)(),Ne=fp(Ce,_),_e=!me&&De.startsWith("/")?Of.N:"a",Qe=a.createElement("div",{className:Ne.linkContent},F,me==="_blank"&&a.createElement(cs.I,{"data-testid":"external-link-icon",name:"external-link-alt"}));return a.createElement(_e,{"data-testid":Ns.Tp.components.NavMenu.item,className:(0,ut.cx)(Ne.container,{[Ne.containerActive]:_}),href:De,target:me,onClick:Q,..._&&{"aria-current":"page"}},Qe)}_d.displayName="MegaMenuItemText";const fp=(F,_)=>({container:(0,ut.css)({alignItems:"center",color:_?F.colors.text.primary:F.colors.text.secondary,height:"100%",position:"relative",width:"100%","&:hover, &:focus-visible":{color:F.colors.text.primary,textDecoration:"underline"},"&:focus-visible":{boxShadow:"none",outline:`2px solid ${F.colors.primary.main}`,outlineOffset:"-2px",transition:"none"}}),containerActive:(0,ut.css)({backgroundColor:F.colors.background.secondary,borderTopRightRadius:F.shape.radius.default,borderBottomRightRadius:F.shape.radius.default,position:"relative","&::before":{backgroundImage:F.colors.gradients.brandVertical,borderRadius:F.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:F.spacing(.5)}}),linkContent:(0,ut.css)({alignItems:"center",display:"flex",gap:"0.5rem",height:"100%",width:"100%"})}),Tc=2;function If({link:F,activeItem:_,level:Q=0,onClick:me}){const{chrome:De}=(0,bo.Il)(),Ne=De.useState().megaMenuDocked,_e=(0,Zs.zy)(),Qe=F.highlightText?Mf:a.Fragment,st=wd(F,_),Et=F===_||Q===Tc&&st,[Ct,kt]=(0,Cf.A)(`grafana.navigation.expanded[${F.text}]`,!!st),Ut=Q<Tc&&!!(Af(F)||F.emptyMessage),Ot=(0,a.useRef)(null),Wt=(0,Nt.of)(gp);if((0,a.useEffect)(()=>{st&&kt(!0)},[st,_e,Ne,kt]),(0,a.useEffect)(()=>{Et&&Ot.current&&pp(Ot.current)&&Ot.current.scrollIntoView({block:"center"})},[Et]),!F.url)return null;let Sn=null;return F.icon?Sn=a.createElement(cs.I,{className:Wt.icon,name:(0,Tf.Uo)(F.icon)??"link",size:"lg"}):F.img&&(Sn=a.createElement(Pt.B,{width:3,justifyContent:"center"},a.createElement("img",{className:Wt.img,src:F.img,alt:""}))),a.createElement("li",{ref:Ot,className:Wt.listItem},a.createElement("div",{className:(0,ut.cx)(Wt.menuItem,{[Wt.menuItemWithIcon]:!!(Q===0&&Sn)})},Q!==0&&a.createElement(Sf.T,{level:Q===Tc?Q-1:Q,spacing:3}),Q===Tc&&a.createElement("div",{className:Wt.itemConnector}),a.createElement("div",{className:Wt.collapseButtonWrapper},Ut&&a.createElement(Ys.K,{"aria-label":`${Ct?"Collapse":"Expand"} section ${F.text}`,className:Wt.collapseButton,onClick:()=>kt(!Ct),name:Ct?"angle-down":"angle-right",size:"md",variant:"secondary"})),a.createElement("div",{className:Wt.collapsibleSectionWrapper},a.createElement(_d,{isActive:Et,onClick:()=>{F.onClick?.(),me?.()},target:F.target,url:F.url},a.createElement("div",{className:(0,ut.cx)(Wt.labelWrapper,{[Wt.hasActiveChild]:st,[Wt.labelWrapperWithIcon]:!!(Q===0&&Sn)})},Q===0&&Sn&&a.createElement(Qe,null,Sn),a.createElement(Ss.E,{truncate:!0},F.text))))),Ut&&Ct&&a.createElement("ul",{className:Wt.children},Af(F)?F.children.filter(ha=>!ha.isCreateAction).map(ha=>a.createElement(If,{key:`${F.text}-${ha.text}`,link:ha,activeItem:_,onClick:me,level:Q+1})):a.createElement("div",{className:Wt.emptyMessage,"aria-live":"polite"},F.emptyMessage)))}const gp=F=>({icon:(0,ut.css)({width:F.spacing(3)}),img:(0,ut.css)({height:F.spacing(2),width:F.spacing(2)}),listItem:(0,ut.css)({flex:1,maxWidth:"100%"}),menuItem:(0,ut.css)({display:"flex",alignItems:"center",gap:F.spacing(1),height:F.spacing(4),paddingLeft:F.spacing(.5),position:"relative"}),menuItemWithIcon:(0,ut.css)({paddingLeft:F.spacing(0)}),collapseButtonWrapper:(0,ut.css)({display:"flex",justifyContent:"center",width:F.spacing(3),flexShrink:0}),itemConnector:(0,ut.css)({position:"relative",height:"100%",width:F.spacing(1.5),"&::before":{borderLeft:`1px solid ${F.colors.border.medium}`,content:'""',height:"100%",right:0,position:"absolute",transform:"translateX(50%)"}}),collapseButton:(0,ut.css)({margin:0}),collapsibleSectionWrapper:(0,ut.css)({alignItems:"center",display:"flex",flex:1,height:"100%",minWidth:0}),labelWrapper:(0,ut.css)({display:"flex",alignItems:"center",gap:F.spacing(2),minWidth:0,paddingLeft:F.spacing(1)}),labelWrapperWithIcon:(0,ut.css)({paddingLeft:F.spacing(.5)}),hasActiveChild:(0,ut.css)({color:F.colors.text.primary}),children:(0,ut.css)({display:"flex",listStyleType:"none",flexDirection:"column"}),emptyMessage:(0,ut.css)({color:F.colors.text.secondary,fontStyle:"italic",padding:F.spacing(1,1.5,1,7)})});function Af(F){return!!(F.children&&F.children.length>0)}function pp(F){const _=F.getBoundingClientRect();return _.bottom<0||_.top>=window.innerHeight}const Rf="300px",zd=a.memo((0,a.forwardRef)(({onClose:F,..._},Q)=>{const me=(0,Vn.useSelector)(Ct=>Ct.navBarTree),De=(0,Nt.of)(hp),Ce=(0,Zs.zy)(),{chrome:Ne}=(0,bo.Il)(),_e=Ne.useState(),Qe=me.filter(Ct=>Ct.id!=="profile"&&Ct.id!=="help").map(Ct=>Ec(Ct,_e.megaMenuDocked)),st=yc(Qe,_e.sectionNav.node,Ce.pathname),Et=()=>{Ne.setMegaMenuDocked(!_e.megaMenuDocked),_e.megaMenuDocked&&Ne.setMegaMenuOpen(!1),setTimeout(()=>{document.getElementById(_e.megaMenuDocked?"mega-menu-toggle":"dock-menu-button")?.focus()})};return a.createElement("div",{"data-testid":Ns.Tp.components.NavMenu.Menu,ref:Q,..._},a.createElement("div",{className:De.mobileHeader},a.createElement(cs.I,{name:"bars",size:"xl"}),a.createElement(Ys.K,{tooltip:(0,as.t)("navigation.megamenu.close","Close menu"),name:"times",onClick:F,size:"xl",variant:"secondary"})),a.createElement("nav",{className:De.content},a.createElement(bf.E,{showScrollIndicators:!0,hideHorizontalTrack:!0},a.createElement("ul",{className:De.itemList,"aria-label":(0,as.t)("navigation.megamenu.list-label","Navigation")},Qe.map((Ct,kt)=>a.createElement(Pt.B,{key:Ct.text,direction:kt===0?"row-reverse":"row",alignItems:"center"},kt===0&&a.createElement(Ys.K,{id:"dock-menu-button",className:De.dockMenuButton,tooltip:_e.megaMenuDocked?(0,as.t)("navigation.megamenu.undock","Undock menu"):(0,as.t)("navigation.megamenu.dock","Dock menu"),name:"web-section-alt",onClick:Et,variant:"secondary"}),a.createElement(If,{link:Ct,onClick:_e.megaMenuDocked?void 0:F,activeItem:st})))))))}));zd.displayName="MegaMenu";const hp=F=>({content:(0,ut.css)({display:"flex",flexDirection:"column",height:"100%",minHeight:0,position:"relative"}),mobileHeader:(0,ut.css)({display:"flex",justifyContent:"space-between",padding:F.spacing(1,1,1,2),borderBottom:`1px solid ${F.colors.border.weak}`,[F.breakpoints.up("md")]:{display:"none"}}),itemList:(0,ut.css)({boxSizing:"border-box",display:"flex",flexDirection:"column",listStyleType:"none",padding:F.spacing(1,1,2,1),[F.breakpoints.up("md")]:{width:Rf}}),dockMenuButton:(0,ut.css)({display:"none",[F.breakpoints.up("xl")]:{display:"inline-flex"}})});var Sc=e(13390),Fi=e(27746);function vp({href:F,isCurrent:_,text:Q,index:me,flexGrow:De}){const Ce=(0,Nt.of)(Ep),Ne=()=>{(0,gr.rR)("grafana_breadcrumb_clicked",{url:F})};return a.createElement("li",{className:Ce.breadcrumbWrapper,style:{flexGrow:De}},_?a.createElement("span",{"data-testid":Sc.X.Breadcrumbs.breadcrumb(Q),className:Ce.breadcrumb,"aria-current":"page",title:Q},Q):a.createElement(a.Fragment,null,a.createElement("a",{onClick:Ne,"data-testid":Sc.X.Breadcrumbs.breadcrumb(Q),className:(0,ut.cx)(Ce.breadcrumb,Ce.breadcrumbLink),title:Q,href:F},Q),a.createElement("div",{className:Ce.separator,"aria-hidden":!0},a.createElement(cs.I,{name:"angle-right"}))))}const Ep=F=>({breadcrumb:(0,ut.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",padding:F.spacing(0,.5),whiteSpace:"nowrap",color:F.colors.text.secondary}),breadcrumbLink:(0,ut.css)({color:F.colors.text.primary,"&:hover":{textDecoration:"underline"}}),breadcrumbWrapper:(0,ut.css)({alignItems:"center",color:F.colors.text.primary,display:"flex",flex:1,minWidth:0,maxWidth:"max-content",[F.breakpoints.down("sm")]:{display:"none","&:nth-last-child(2)":{display:"flex",minWidth:"40px"},"&:last-child":{display:"flex"}}}),separator:(0,ut.css)({color:F.colors.text.secondary})});function yp({breadcrumbs:F,className:_}){const Q=(0,Nt.of)(Pp);return a.createElement("nav",{"aria-label":"Breadcrumbs",className:_},a.createElement("ol",{className:Q.breadcrumbs},F.map((me,De)=>a.createElement(vp,{...me,isCurrent:De===F.length-1,key:De,index:De,flexGrow:Dp(De,F.length)}))))}function Dp(F,_){return _<5&&F>0&&F<_-2||_>6&&F>1&&F<_-3?4:10}const Pp=F=>({breadcrumbs:(0,ut.css)({display:"flex",alignItems:"center",flexWrap:"nowrap",overflow:"hidden"})});var bp=e(3984),vi=e(57571),Lf=e(10804);const Bf="mega-menu-toggle";function Uf({actions:F,searchBarHidden:_,sectionNav:Q,pageNav:me,onToggleMegaMenu:De,onToggleSearchBar:Ce,onToggleKioskMode:Ne}){const{chrome:_e}=(0,bo.Il)(),Qe=_e.useState(),st=(0,Vn.useSelector)(kt=>kt.navIndex)[Ui.Id],Et=(0,Nt.of)(fl),Ct=(0,bp.Z)(Q,me,st);return a.createElement("div",{"data-testid":Sc.X.NavToolbar.container,className:Et.pageToolbar},a.createElement("div",{className:Et.menuButton},a.createElement(Ys.K,{id:Bf,name:"bars",tooltip:Qe.megaMenuOpen?(0,as.t)("navigation.toolbar.close-menu","Close menu"):(0,as.t)("navigation.toolbar.open-menu","Open menu"),tooltipPlacement:"bottom",size:"xl",onClick:De,"data-testid":Sc.X.NavBar.Toggle.button})),a.createElement(yp,{breadcrumbs:Ct,className:Et.breadcrumbsWrapper}),a.createElement("div",{className:Et.actions},F,_&&a.createElement(Fi.I,{onClick:Ne,narrow:!0,title:(0,as.t)("navigation.toolbar.enable-kiosk","Enable kiosk mode"),icon:"monitor"}),F&&a.createElement(Lf.K,null),a.createElement(Fi.I,{onClick:Ce,narrow:!0,title:(0,as.t)("navigation.toolbar.toggle-search-bar","Toggle top search bar")},a.createElement(cs.I,{name:_?"angle-down":"angle-up",size:"xl"}))))}const fl=F=>({breadcrumbsWrapper:(0,ut.css)({display:"flex",overflow:"hidden",[F.breakpoints.down("sm")]:{minWidth:"50%"}}),pageToolbar:(0,ut.css)({height:vi.l,display:"flex",padding:F.spacing(0,1,0,2),alignItems:"center",borderBottom:`1px solid ${F.colors.border.weak}`}),menuButton:(0,ut.css)({display:"flex",alignItems:"center",marginRight:F.spacing(1)}),actions:(0,ut.css)({label:"NavToolbar-actions",display:"flex",alignItems:"center",flexWrap:"nowrap",justifyContent:"flex-end",paddingLeft:F.spacing(1),flexGrow:1,gap:F.spacing(1),minWidth:0,".body-drawer-open &":{display:"none"}})});function wl({}){const F=(0,Nt.$j)(),{chrome:_}=(0,bo.Il)(),Q=_.useState(),me=Q.searchBarHidden||Q.kioskMode===Vn.KioskMode.TV,De=(0,a.useRef)(null),Ce=(0,a.useRef)(null),Ne=F.transitions.duration.shortest,_e=(0,Nt.of)(wf,Ne),Qe=Q.megaMenuOpen&&!Q.megaMenuDocked,st=()=>_.setMegaMenuOpen(!1),{overlayProps:Et,underlayProps:Ct}=(0,gc.e)({isDismissable:!0,isOpen:!0,onClose:st,shouldCloseOnInteractOutside:Ot=>!document.getElementById(Bf)?.contains(Ot)},De),{dialogProps:kt}=(0,Ad.s)({},De),Ut=(0,Nt.of)(Nf,me);return a.createElement("div",{className:Ut.wrapper},a.createElement(Pf.Sf,null,a.createElement($d.A,{nodeRef:De,in:Qe,unmountOnExit:!0,classNames:_e.overlay,timeout:{enter:Ne,exit:0}},a.createElement(ul.n1,{contain:!0,autoFocus:!0,restoreFocus:!0},a.createElement(zd,{className:Ut.menu,onClose:st,ref:De,...Et,...kt}))),a.createElement($d.A,{nodeRef:Ce,in:Qe,unmountOnExit:!0,classNames:_e.backdrop,timeout:{enter:Ne,exit:0}},a.createElement("div",{ref:Ce,className:Ut.backdrop,...Ct}))))}const Nf=(F,_)=>{const Q=_?vi.l:vi.l*2;return{backdrop:(0,ut.css)({backdropFilter:"blur(1px)",backgroundColor:F.components.overlay.background,bottom:0,left:0,position:"fixed",right:0,top:_?0:vi.l,zIndex:F.zIndex.modalBackdrop,[F.breakpoints.up("md")]:{top:Q}}),menu:(0,ut.css)({display:"flex",bottom:0,flexDirection:"column",left:0,right:0,zIndex:F.zIndex.modal,position:"fixed",top:_?0:vi.l,backgroundColor:F.colors.background.primary,boxSizing:"content-box",flex:"1 1 0",[F.breakpoints.up("md")]:{right:"unset",borderRight:`1px solid ${F.colors.border.weak}`,top:Q}}),wrapper:(0,ut.css)({position:"fixed",display:"grid",gridAutoFlow:"column",height:"100%",zIndex:F.zIndex.sidemenu})}},wf=(F,_)=>{const Q={[F.transitions.handleMotion("no-preference")]:{transitionDuration:`${_}ms`,transitionTimingFunction:F.transitions.easing.easeInOut},[F.breakpoints.down("md")]:{overflow:"hidden"}},me={...Q,transitionProperty:"box-shadow, width",".scrollbar-view":{overflow:"hidden !important"}},De={...Q,transitionProperty:"opacity"},Ce={width:"100%",[F.breakpoints.up("md")]:{boxShadow:F.shadows.z3,width:Rf}},Ne={boxShadow:"none",width:0},_e={opacity:1},Qe={opacity:0};return{backdrop:{enter:(0,ut.css)(Qe),enterActive:(0,ut.css)(De,_e),enterDone:(0,ut.css)(_e)},overlay:{enter:(0,ut.css)(Ne),enterActive:(0,ut.css)(me,Ce),enterDone:(0,ut.css)(Ce)}}};var Mc=e(24120),Ff=e(49426);function Wf(F,_){if(F===_)return!0;if(!(F instanceof Object)||!(_ instanceof Object))return!1;const Q=Object.keys(F),me=Q.length;for(let De=0;De<me;De++)if(!(Q[De]in _))return!1;for(let De=0;De<me;De++)if(F[Q[De]]!==_[Q[De]])return!1;return me===Object.keys(_).length}const xc="grafana.navigation.docked",Oc="grafana.navigation.open";class Kf{constructor(){this.searchBarStorageKey="SearchBar_Hidden",this.routeChangeHandled=!0,this.megaMenuDocked=!!(window.innerWidth>=X.$.theme2.breakpoints.values.xl&&so.A.getBool(xc,window.innerWidth>=X.$.theme2.breakpoints.values.xxl)),this.sessionStorageData=window.sessionStorage.getItem("returnToPrevious"),this.returnToPreviousData=this.sessionStorageData?JSON.parse(this.sessionStorageData):void 0,this.state=new Ff.t({chromeless:!0,sectionNav:{node:{text:(0,as.t)("nav.home.title","Home")},main:{text:""}},searchBarHidden:so.A.getBool(this.searchBarStorageKey,!1),megaMenuOpen:this.megaMenuDocked&&so.A.getBool(Oc,!0),megaMenuDocked:this.megaMenuDocked,kioskMode:null,layout:Sl.k.Canvas,returnToPrevious:this.returnToPreviousData}),this.setReturnToPrevious=_=>{const Q=this.state.getValue().returnToPrevious;(0,gr.rR)("grafana_return_to_previous_button_created",{page:_.href,previousPage:Q?.href}),this.update({returnToPrevious:_}),window.sessionStorage.setItem("returnToPrevious",JSON.stringify(_))},this.clearReturnToPrevious=_=>{const Q=this.state.getValue().returnToPrevious;Q&&(0,gr.rR)("grafana_return_to_previous_button_dismissed",{action:_,page:Q.href}),this.update({returnToPrevious:void 0}),window.sessionStorage.removeItem("returnToPrevious")},this.setMegaMenuOpen=_=>{const{megaMenuDocked:Q}=this.state.getValue();Q&&so.A.set(Oc,_),(0,gr.rR)("grafana_mega_menu_open",{state:_}),this.update({megaMenuOpen:_})},this.setMegaMenuDocked=(_,Q=!0)=>{Q&&so.A.set(xc,_),(0,gr.rR)("grafana_mega_menu_docked",{state:_}),this.update({megaMenuDocked:_})},this.onToggleSearchBar=()=>{const{searchBarHidden:_,kioskMode:Q}=this.state.getValue(),me=!_;so.A.set(this.searchBarStorageKey,me),Q&&x.Ny.partial({kiosk:null}),this.update({searchBarHidden:me,kioskMode:null})},this.onToggleKioskMode=()=>{const _=this.getNextKioskMode();this.update({kioskMode:_}),x.Ny.partial({kiosk:this.getKioskUrlValue(_)})}}setMatchedRoute(_){this.currentRoute!==_&&(this.currentRoute=_,this.routeChangeHandled=!1)}update(_){const Q=this.state.getValue(),me={...Q};this.routeChangeHandled||(me.actions=void 0,me.pageNav=void 0,me.sectionNav={node:{text:(0,as.t)("nav.home.title","Home")},main:{text:""}},me.chromeless=this.currentRoute?.chromeless,me.layout=Sl.k.Standard,this.routeChangeHandled=!0),Object.assign(me,_),me.chromeless=me.kioskMode===Vn.KioskMode.Full||this.currentRoute?.chromeless,this.ignoreStateUpdate(me,Q)||this.state.next(me)}ignoreStateUpdate(_,Q){return!!(Wf(_,Q)||(_.sectionNav!==Q.sectionNav||_.pageNav!==Q.pageNav)&&_.actions===Q.actions&&_.layout===Q.layout&&Ic(_.sectionNav.node,Q.sectionNav.node)&&Ic(_.pageNav,Q.pageNav))}useState(){return(0,Mc.A)(this.state,this.state.getValue())}exitKioskMode(){this.update({kioskMode:void 0}),x.Ny.partial({kiosk:null})}setKioskModeFromUrl(_){let Q;switch(_){case"tv":Q=Vn.KioskMode.TV;break;case"1":case!0:Q=Vn.KioskMode.Full}Q&&Q!==this.state.getValue().kioskMode&&this.update({kioskMode:Q})}getKioskUrlValue(_){switch(_){case Vn.KioskMode.TV:return"tv";case Vn.KioskMode.Full:return!0;default:return null}}getNextKioskMode(){const{kioskMode:_,searchBarHidden:Q}=this.state.getValue();return Q||_===Vn.KioskMode.TV?(tr.A.emit(Li.r1.alertSuccess,[(0,as.t)("navigation.kiosk.tv-alert","Press ESC to exit kiosk mode")]),Vn.KioskMode.Full):_?null:Vn.KioskMode.TV}}function Ic(F,_){if(F===_)return!0;const Q=F?.children?.find(De=>De.active),me=_?.children?.find(De=>De.active);return F?.text===_?.text&&F?.url===_?.url&&Q?.url===me?.url&&Ic(F?.parentItem,_?.parentItem)}var kd=e(19727);const Hd=({label:F,onClick:_,onDismiss:Q})=>{const me=(0,Nt.of)(Vf);return a.createElement(kd.e,{className:me.buttonGroup},a.createElement(fe.$n,{icon:"angle-left",size:"sm",variant:"primary",fill:"outline",onClick:_,title:F,className:me.mainDismissableButton,"data-testid":Ns.Tp.components.ReturnToPrevious.backButton},F),a.createElement(fe.$n,{icon:"times","aria-label":(0,as.t)("return-to-previous.dismissable-button","Close"),variant:"primary",fill:"outline",size:"sm",onClick:Q,"data-testid":Ns.Tp.components.ReturnToPrevious.dismissButton}))},Vf=F=>({mainDismissableButton:(0,ut.css)({width:"100%","> span":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"270px",display:"inline-block"}}),buttonGroup:(0,ut.css)({width:"fit-content",backgroundColor:F.colors.background.secondary})});Hd.displayName="DismissableButton";const Gd=({href:F,title:_})=>{const Q=(0,Nt.of)($f),{chrome:me}=(0,bo.Il)(),De=(0,a.useCallback)(()=>{x.Ny.push(F),me.clearReturnToPrevious("clicked")},[F,me]),Ce=(0,a.useCallback)(()=>{me.clearReturnToPrevious("dismissed")},[me]);return a.createElement("div",{className:Q.returnToPrevious,"data-testid":Ns.Tp.components.ReturnToPrevious.buttonGroup},a.createElement(Hd,{label:(0,as.t)("return-to-previous.button.label","Back to {{title}}",{title:_}),onClick:De,onDismiss:Ce}))},$f=F=>({returnToPrevious:(0,ut.css)({label:"return-to-previous",display:"flex",justifyContent:"center",left:"50%",transform:"translateX(-50%)",zIndex:F.zIndex.tooltip,position:"fixed",bottom:F.spacing.x4,boxShadow:F.shadows.z3})});Gd.displayName="ReturnToPrevious";var Ac=e(40672),_f=e(42941),zf=e(62372),kf=e(49185),Wi=e(69386),Hf=e(4172);function jd({feedUrl:F}){const _=(0,Nt.of)(Cp),{state:Q,getNews:me}=(0,Hf.n)(F),[De,Ce]=(0,kf.A)();return(0,a.useEffect)(()=>{me()},[me]),Q.error?a.createElement("div",{className:_.innerWrapper},Q.error&&Q.error.message):a.createElement("div",{ref:De},Q.loading?a.createElement(a.Fragment,null,a.createElement(Wi.K.Skeleton,{showImage:!0,width:Ce.width}),a.createElement(Wi.K.Skeleton,{showImage:!0,width:Ce.width}),a.createElement(Wi.K.Skeleton,{showImage:!0,width:Ce.width}),a.createElement(Wi.K.Skeleton,{showImage:!0,width:Ce.width}),a.createElement(Wi.K.Skeleton,{showImage:!0,width:Ce.width})):a.createElement(a.Fragment,null,Ce.width>0&&Q.value?.map((Ne,_e)=>a.createElement(Wi.K,{key:_e,index:_e,showImage:!0,width:Ce.width,data:Q.value}))),a.createElement("div",{className:_.grot},a.createElement("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog"},a.createElement("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"}))))}const Cp=F=>({innerWrapper:(0,ut.css)({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),grot:(0,ut.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:F.spacing(5,0),img:{width:"186px",height:"186px"}})});function Tp({className:F}){const[_,Q]=(0,_f.A)(!1),me=(0,Nt.of)(Sp);return a.createElement(a.Fragment,null,a.createElement(Fi.I,{className:F,onClick:Q,iconOnly:!0,icon:"rss","aria-label":"News"}),_&&a.createElement(rc._,{title:a.createElement("div",{className:me.title},a.createElement(Ss.E,{element:"h2"},(0,as.t)("news.title","Latest from the blog")),a.createElement("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",className:me.grot},a.createElement("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})),a.createElement("div",{className:me.actions},a.createElement(Ys.K,{name:"times",variant:"secondary",onClick:Q,"data-testid":Ns.Tp.components.Drawer.General.close,tooltip:(0,as.t)("news.drawer.close","Close Drawer")}))),onClose:Q,size:"md"},a.createElement(jd,{feedUrl:zf.$})))}const Sp=F=>({title:(0,ut.css)({display:"flex",alignItems:"center",justifyContent:"center",gap:F.spacing(2),borderBottom:`1px solid ${F.colors.border.weak}`}),grot:(0,ut.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:F.spacing(2,0),img:{width:"75px",height:"75px"}}),actions:(0,ut.css)({position:"absolute",right:F.spacing(1),top:F.spacing(2)})});var Gf=e(32931);function Mp({orgs:F,onSelectChange:_}){const Q=(0,Nt.of)(xp);return a.createElement(Fr.i,{"aria-label":"Change organization",variant:"secondary",buttonCss:Q.buttonCss,size:"md",label:"",fill:"text",isFullWidth:!1,options:F.map(me=>({label:me.name,description:me.role,value:me})),onChange:_,icon:"building"})}const xp=F=>({buttonCss:(0,ut.css)({color:F.colors.text.secondary,"&:hover":{color:F.colors.text.primary}})});function Op({orgs:F,onSelectChange:_}){const Q=(0,Nt.of)(Ip),{orgName:me,orgId:De,orgRole:Ce}=Ls.TP.user,[Ne,_e]=(0,a.useState)(()=>({label:me,value:{role:Ce,orgId:De,name:me},description:Ce})),Qe=st=>{_e(st),_(st)};return a.createElement(pe.l6,{"aria-label":"Change organization",width:"auto",value:Ne,prefix:a.createElement(cs.I,{className:"prefix-icon",name:"building"}),className:Q.select,options:F.map(st=>({label:st.name,description:st.role,value:st})),onChange:Qe})}const Ip=F=>({select:(0,ut.css)({border:"none",background:"none",color:F.colors.text.secondary,"&:hover":{color:F.colors.text.primary,"& .prefix-icon":(0,ut.css)({color:F.colors.text.primary})}})});function Ap(){const F=(0,Nt.$j)(),_=(0,Vn.useDispatch)(),Q=(0,Vn.useSelector)(Qe=>Qe.organization.userOrgs),me=Qe=>{Qe.value&&((0,Gf.bA)(Qe.value.orgId),x.Ny.push(`/?orgId=${Qe.value.orgId}`),window.location.reload())};(0,a.useEffect)(()=>{Ls.TP.isSignedIn&&_((0,Gf.wV)())},[_]);const De=F.breakpoints.values.sm,[Ce,Ne]=(0,a.useState)(!window.matchMedia(`(min-width: ${De}px)`).matches);if((0,dl.Y)({breakpoint:De,onChange:Qe=>{Ne(!Qe.matches)}}),Q?.length<=1)return null;const _e=Ce?Mp:Op;return a.createElement(_e,{orgs:Q,onSelectChange:me})}function Qd(F){const _=[];for(const Q of F)Q.isCreateAction&&_.push(Q),Q.children&&_.push(...Qd(Q.children));return _}const jf=({})=>{const F=(0,Nt.of)(Qf),_=(0,Nt.$j)(),Q=(0,Vn.useSelector)(Et=>Et.navBarTree),me=_.breakpoints.values.sm,[De,Ce]=(0,a.useState)(!1),[Ne,_e]=(0,a.useState)(!window.matchMedia(`(min-width: ${me}px)`).matches),Qe=(0,a.useMemo)(()=>Qd(Q),[Q]);(0,dl.Y)({breakpoint:me,onChange:Et=>{_e(!Et.matches)}});const st=()=>a.createElement(il.W,null,Qe.map((Et,Ct)=>a.createElement(il.W.Item,{key:Ct,url:Et.url,label:Et.text,onClick:()=>(0,gr.rR)("grafana_menu_item_clicked",{url:Et.url,from:"quickadd"})})));return Qe.length>0?a.createElement(a.Fragment,null,a.createElement(Bl.m,{overlay:st,placement:"bottom-end",onVisibleChange:Ce},a.createElement(Fi.I,{iconOnly:!0,icon:Ne?"plus-circle":"plus",isOpen:Ne?void 0:De,"aria-label":"New"})),a.createElement(Lf.K,{className:F.separator})):null},Qf=F=>({buttonContent:(0,ut.css)({alignItems:"center",display:"flex"}),buttonText:(0,ut.css)({[F.breakpoints.down("md")]:{display:"none"}}),separator:(0,ut.css)({[F.breakpoints.down("sm")]:{display:"none"}})});function Yf(){const F=(0,Zs.zy)(),_=(0,Nt.of)(Jf);let Q=Ac.sQ.sanitizeUrl(T.I.getUrlForPartial(F,{forceLogin:"true"}));return Q.startsWith("//")&&(Q=Q.replace(/\/+/g,"/")),a.createElement("a",{className:_.link,href:Q,target:"_self"},"Sign in")}const Jf=F=>({link:(0,ut.css)({paddingRight:F.spacing(1),whiteSpace:"nowrap","&:hover":{textDecoration:"underline"}})});var Rc=e(64539);function Yd({node:F}){const _=(0,Nt.of)(Xf),Q=Ec((0,f.cloneDeep)(F),!1);return Q?a.createElement(il.W,{header:a.createElement("div",{onClick:me=>me.stopPropagation(),className:_.header},a.createElement("div",null,Q.text),Q.subTitle&&a.createElement("div",{className:_.subTitle},Q.subTitle))},Q.children?.map(me=>me.url?a.createElement(Rc.D,{url:me.url,label:me.text,icon:me.icon,target:me.target,key:me.id}):a.createElement(Rc.D,{icon:me.icon,onClick:me.onClick,label:me.text,key:me.id}))):null}const Xf=F=>({header:(0,ut.css)({fontSize:F.typography.h5.fontSize,fontWeight:F.typography.h5.fontWeight,padding:F.spacing(.5,1),whiteSpace:"nowrap"}),subTitle:(0,ut.css)({color:F.colors.text.secondary,fontSize:F.typography.bodySmall.fontSize})});var Zf=e(16797),gl=e(63917);function qf(){const F=(0,Nt.$j)(),{query:_}=(0,or.useKBar)(Ne=>({kbarSearchQuery:Ne.searchQuery,kbarIsOpen:Ne.visualState===or.VisualState.showing})),Q=F.breakpoints.values.sm,[me,De]=(0,a.useState)(!window.matchMedia(`(min-width: ${Q}px)`).matches);(0,dl.Y)({breakpoint:Q,onChange:Ne=>{De(!Ne.matches)}});const Ce=()=>{_.toggle()};return me?a.createElement(Fi.I,{iconOnly:!0,icon:"search","aria-label":(0,as.t)("nav.search.placeholderCommandPalette","Search or jump to..."),onClick:Ce}):a.createElement(eg,{onClick:Ce})}function eg({onClick:F}){const _=(0,Nt.of)(pl),Q=(0,a.useMemo)(()=>(0,gl.gn)(),[]);return a.createElement("div",{className:_.wrapper},a.createElement("div",{className:_.inputWrapper},a.createElement("div",{className:_.prefix},a.createElement(cs.I,{name:"search"})),a.createElement("button",{className:_.fakeInput,onClick:F},(0,as.t)("nav.search.placeholderCommandPalette","Search or jump to...")),a.createElement("div",{className:_.suffix},a.createElement(cs.I,{name:"keyboard"}),a.createElement(Ss.E,{variant:"bodySmall"},Q,"+k"))))}const pl=F=>{const _=(0,Me.n)({theme:F});return{wrapper:_.wrapper,inputWrapper:_.inputWrapper,prefix:_.prefix,suffix:(0,ut.css)([_.suffix,{display:"flex",gap:F.spacing(.5)}]),fakeInput:(0,ut.css)([_.input,{textAlign:"left",paddingLeft:28,color:F.colors.text.disabled,"&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,ut.css)`
          ${(0,Zf.focusCss)(F)}
        `}]),button:(0,ut.css)({width:"100%",textAlign:"center","> *":{width:"100%",textAlign:"center",justifyContent:"center",gap:"1ch"}})}};function hl({children:F,align:_="left"}){const Q=(0,Nt.of)(ni),De=(0,Nt.$j)().breakpoints.values.sm,[Ce,Ne]=(0,a.useState)(!window.matchMedia(`(min-width: ${De}px)`).matches);return(0,dl.Y)({breakpoint:De,onChange:_e=>{Ne(!_e.matches)}}),Ce?a.createElement(a.Fragment,null,F):a.createElement("div",{"data-testid":"wrapper",className:(0,ut.cx)(Q.wrapper,{[Q[_]]:_==="right"})},F)}const ni=F=>({wrapper:(0,ut.css)({display:"flex",gap:F.spacing(.5),alignItems:"center"}),right:(0,ut.css)({justifyContent:"flex-end"}),left:(0,ut.css)({}),center:(0,ut.css)({})}),tg=a.memo(function(){const _=(0,Nt.of)(ng),Q=(0,Vn.useSelector)(Qe=>Qe.navIndex),me=(0,Zs.zy)(),De=(0,f.cloneDeep)(Q.help),Ce=De?Nd(De):void 0,Ne=Q.profile;let _e=H.config.appSubUrl||"/";return!H.config.bootData.user.isSignedIn&&!H.config.anonymousEnabled&&(_e=Ac.sQ.sanitizeUrl(T.I.getUrlForPartial(me,{forceLogin:"true"}))),a.createElement("div",{className:_.layout},a.createElement(hl,null,a.createElement("a",{className:_.logo,href:_e,title:"Go to home"},a.createElement(Xc.M.MenuLogo,{className:_.img})),a.createElement(Ap,null)),a.createElement(hl,null,a.createElement(qf,null)),a.createElement(hl,{align:"right"},a.createElement(jf,null),Ce&&a.createElement(Bl.m,{overlay:()=>a.createElement(Yd,{node:Ce}),placement:"bottom-end"},a.createElement(Fi.I,{iconOnly:!0,icon:"question-circle","aria-label":"Help"})),H.config.newsFeedEnabled&&a.createElement(Tp,null),!hs.TP.user.isSignedIn&&a.createElement(Yf,null),Ne&&a.createElement(Bl.m,{overlay:()=>a.createElement(Yd,{node:Ne}),placement:"bottom-end"},a.createElement(Fi.I,{className:_.profileButton,imgSrc:hs.TP.user.gravatarUrl,imgAlt:"User avatar","aria-label":"Profile"}))))}),ng=F=>({layout:(0,ut.css)({height:vi.l,display:"flex",gap:F.spacing(1),alignItems:"center",padding:F.spacing(0,1,0,2),borderBottom:`1px solid ${F.colors.border.weak}`,justifyContent:"space-between",[F.breakpoints.up("sm")]:{gridTemplateColumns:"1.5fr minmax(240px, 1fr) 1.5fr",display:"grid",justifyContent:"flex-start"}}),img:(0,ut.css)({height:F.spacing(3),width:F.spacing(3)}),logo:(0,ut.css)({display:"flex"}),profileButton:(0,ut.css)({padding:F.spacing(0,.25),img:{borderRadius:F.shape.radius.circle,height:"24px",marginRight:0,width:"24px"}})});function ag({children:F}){const{chrome:_}=(0,bo.Il)(),Q=_.useState(),me=Q.searchBarHidden||Q.kioskMode===Vn.KioskMode.TV,De=(0,Nt.$j)(),Ce=(0,Nt.of)(sg),Ne=De.breakpoints.values.xl,_e=so.A.getBool(xc,!0);(0,dl.Y)({breakpoint:Ne,onChange:Ot=>{_e&&(_.setMegaMenuDocked(Ot.matches,!1),_.setMegaMenuOpen(Ot.matches?so.A.getBool(Oc,Q.megaMenuOpen):!1))}});const Qe=(0,ut.cx)({[Ce.content]:!0,[Ce.contentNoSearchBar]:me,[Ce.contentChromeless]:Q.chromeless}),st=()=>{_.setMegaMenuOpen(!Q.megaMenuOpen)},{pathname:Et,search:Ct}=x.Ny.getLocation(),kt=Et+Ct,Ut=Q.returnToPrevious&&kt!==Q.returnToPrevious.href;return(0,a.useEffect)(()=>{Q.returnToPrevious&&kt===Q.returnToPrevious.href&&_.clearReturnToPrevious("auto_dismissed")},[_,kt]),(0,a.useEffect)(()=>{const Ot=(0,x.SE)(Ct);_.setKioskModeFromUrl(Ot.kiosk)},[_,Ct]),a.createElement("div",{className:Id()("main-view",{"main-view--search-bar-hidden":me&&!Q.chromeless,"main-view--chrome-hidden":Q.chromeless})},!Q.chromeless&&a.createElement(a.Fragment,null,a.createElement(fe.z9,{className:Ce.skipLink,href:"#pageContent"},"Skip to main content"),a.createElement("header",{className:(0,ut.cx)(Ce.topNav)},!me&&a.createElement(tg,null),a.createElement(Uf,{searchBarHidden:me,sectionNav:Q.sectionNav.node,pageNav:Q.pageNav,actions:Q.actions,onToggleSearchBar:_.onToggleSearchBar,onToggleMegaMenu:st,onToggleKioskMode:_.onToggleKioskMode}))),a.createElement("div",{className:Qe},a.createElement("div",{className:Ce.panes},!Q.chromeless&&Q.megaMenuDocked&&Q.megaMenuOpen&&a.createElement(zd,{className:Ce.dockedMegaMenu,onClose:()=>_.setMegaMenuOpen(!1)}),a.createElement("main",{className:Ce.pageContainer,id:"pageContent"},F))),!Q.chromeless&&!Q.megaMenuDocked&&a.createElement(wl,null),!Q.chromeless&&a.createElement(Kd,null),Ut&&Q.returnToPrevious&&a.createElement(Gd,{href:Q.returnToPrevious.href,title:Q.returnToPrevious.title}))}const sg=F=>({content:(0,ut.css)({display:"flex",flexDirection:"column",paddingTop:vi.l*2,flexGrow:1,height:"100%"}),contentNoSearchBar:(0,ut.css)({paddingTop:vi.l}),contentChromeless:(0,ut.css)({paddingTop:0}),dockedMegaMenu:(0,ut.css)({background:F.colors.background.primary,borderRight:`1px solid ${F.colors.border.weak}`,display:"none",zIndex:F.zIndex.navbarFixed,[F.breakpoints.up("xl")]:{display:"block"}}),topNav:(0,ut.css)({display:"flex",position:"fixed",zIndex:F.zIndex.navbarFixed,left:0,right:0,background:F.colors.background.primary,flexDirection:"column"}),panes:(0,ut.css)({label:"page-panes",display:"flex",height:"100%",width:"100%",flexGrow:1,minHeight:0,flexDirection:"column",[F.breakpoints.up("md")]:{flexDirection:"row"}}),pageContainer:(0,ut.css)({label:"page-container",display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,minWidth:0,overflow:"auto","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0}}),skipLink:(0,ut.css)({position:"absolute",top:-1e3,":focus":{left:F.spacing(1),top:F.spacing(1),zIndex:F.zIndex.portal}})});var Fl=e(82467),Jd=e(16001),Wl=e(3169),vl=e(94701);function rg({appNotification:F,onClearNotification:_}){const Q=(0,Nt.of)(og);(0,vl.A)(()=>{setTimeout(()=>{_(F.id)},Vn.timeoutMap[F.severity])});const me=F.component||F.text||F.traceId;return a.createElement(Gt.F,{severity:F.severity,title:F.title,onRemove:()=>_(F.id),elevated:!0},me&&a.createElement("div",{className:Q.wrapper},a.createElement("span",null,F.component||F.text),F.traceId&&a.createElement("span",{className:Q.trace},"Trace ID: ",F.traceId)))}function og(F){return{wrapper:(0,ut.css)({display:"flex",flexDirection:"column"}),trace:(0,ut.css)({fontSize:F.typography.pxToRem(10)})}}function ig(){const F=(0,Vn.useSelector)(De=>(0,Jd.fX)(De.appNotifications)),_=(0,Vn.useDispatch)(),Q=(0,Nt.of)(Xd);(0,a.useEffect)(()=>{tr.A.on(Li.r1.alertWarning,De=>_((0,Fl.dx)((0,Wl.q8)(...De)))),tr.A.on(Li.r1.alertSuccess,De=>_((0,Fl.dx)((0,Wl.tZ)(...De)))),tr.A.on(Li.r1.alertError,De=>_((0,Fl.dx)((0,Wl.gi)(...De))))},[_]);const me=De=>{_((0,Fl.Do)(De))};return a.createElement("div",{className:Q.wrapper},a.createElement(Pt.B,{direction:"column"},F.map((De,Ce)=>a.createElement(rg,{key:`${De.id}-${Ce}`,appNotification:De,onClearNotification:me}))))}function Xd(F){return{wrapper:(0,ut.css)({label:"app-notifications-list",zIndex:F.zIndex.portal,minWidth:400,maxWidth:600,position:"fixed",right:6,top:88})}}function lg(F){const[_,Q]=(0,a.useState)({component:null,props:{}}),me=(0,a.useMemo)(()=>{function De(Ne,_e){Q({component:Ne,props:_e})}function Ce(){Q({component:null,props:{}})}return{component:_.component,props:{..._.props,isOpen:!0,onDismiss:Ce},showModal:De,hideModal:Ce}},[_]);return(0,a.useEffect)(()=>{tr.A.subscribe(Tr.S8,({payload:Ce})=>{Q({component:Ce.component,props:Ce.props})}),tr.A.subscribe(Tr.bY,Ce=>{cg(Ce,Q)});let De="";x.Ny.getHistory().listen(Ce=>{Ce.pathname!==De&&Q({component:null,props:{}}),De=Ce.pathname})},[]),a.createElement(Xo.wE.Provider,{value:me},F.children)}function cg({payload:F},_){const{confirmText:Q,onConfirm:me=()=>{},onDismiss:De,text2:Ce,altActionText:Ne,onAltAction:_e,noText:Qe,text:st,text2htmlBind:Et,yesText:Ct="Yes",icon:kt,title:Ut="Confirm",yesButtonVariant:Ot}=F,Wt=()=>_({component:null,props:{}}),Sn={confirmText:Ct,confirmButtonVariant:Ot,confirmationText:Q,icon:kt,title:Ut,body:st,description:Ce&&Et?Ac.sQ.sanitize(Ce):Ce,isOpen:!0,dismissText:Qe,onConfirm:()=>{me(),Wt()},onDismiss:()=>{De?.(),Wt()},onAlternative:_e?()=>{_e(),Wt()}:void 0,alternativeText:Ne};_({component:Ol.u,props:Sn})}var ai=e(66899),Lc=e.n(ai),Zd=e(52446);function dg({error:F,errorInfo:_}){const Q=(0,Zs.zy)(),me=F?.name==="ChunkLoadError",De=(0,Nt.of)(ug);return(0,a.useEffect)(()=>{me&&Q.search.indexOf("chunkNotFound")===-1&&(window.location.href=T.I.getUrlForPartial(Q,{chunkNotFound:!0}))},[Q,me]),a.createElement(Pr.Y,{navId:"error",layout:Sl.k.Canvas},a.createElement("div",{className:De.container},me&&a.createElement("div",null,a.createElement("h2",null,"Unable to find application file"),a.createElement("br",null),a.createElement("h2",{className:"page-heading"},"Grafana has likely been updated. Please try reloading the page."),a.createElement("br",null),a.createElement(fe.$n,{size:"md",variant:"secondary",icon:"repeat",onClick:()=>window.location.reload()},"Reload"),a.createElement(Zd.D,{title:"Error details",error:F,errorInfo:_})),!me&&a.createElement(Zd.D,{title:"An unexpected error happened",error:F,errorInfo:_})))}const ug=F=>({container:(0,ut.css)({width:"500px",margin:F.spacing(8,"auto")})});function mg(){const F=(0,Nt.of)(ro);return a.createElement("div",{className:F.container,"aria-live":"polite",role:"status","aria-label":(0,as.t)("bouncing-loader.label","Loading")},a.createElement("div",{className:F.bounce},a.createElement("img",{alt:"",src:"public/img/grafana_icon.svg",className:F.logo})))}const fg=(0,ut.keyframes)({"0%":{opacity:0,animationTimingFunction:"cubic-bezier(0, 0, 0.5, 1)"},"100%":{opacity:1}}),Rp=(0,ut.keyframes)({"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}),Bc=(0,ut.keyframes)({"from, to":{transform:"translateY(0px)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"50%":{transform:"translateY(-50px)",animationTimingFunction:"cubic-bezier(0.9, 0, 0.7, 1)"}}),gg=(0,ut.keyframes)({"0%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"15%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 0.75)"},"55%":{transform:"scaleX(1.05) scaleY(0.95)",animationTimingFunction:"cubic-bezier(0.9, 0, 1, 1)"},"95%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0, 1)"},"100%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 1)"}}),ro=F=>({container:(0,ut.css)({opacity:0,[F.transitions.handleMotion("no-preference")]:{animationName:fg,animationIterationCount:1,animationDuration:"0.9s",animationDelay:"0.5s",animationFillMode:"forwards"},[F.transitions.handleMotion("reduce")]:{animationName:Rp,animationIterationCount:"infinite",animationDuration:"4s",animationDelay:"0.5s"}}),bounce:(0,ut.css)({textAlign:"center",[F.transitions.handleMotion("no-preference")]:{animationName:Bc,animationDuration:"0.9s",animationIterationCount:"infinite"}}),logo:(0,ut.css)({display:"inline-block",[F.transitions.handleMotion("no-preference")]:{animationName:gg,animationDuration:"0.9s",animationIterationCount:"infinite"},width:"60px",height:"60px"})});function El(){const F=(0,Nt.of)(qd);return a.createElement("div",{className:F.loadingPage},a.createElement(mg,null))}const qd=F=>({loadingPage:(0,ut.css)({backgroundColor:F.colors.background.primary,height:"100%",flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"})});function pg(F){const{chrome:_,keybindings:Q}=(0,bo.Il)();return _.setMatchedRoute(F.route),(0,a.useLayoutEffect)(()=>{Q.clearAndInitGlobalBindings(F.route)},[Q,F.route]),(0,a.useEffect)(()=>(Kl(F.route),Vl(),(0,x.Lc)("GrafanaRoute",!1,"Mounted",F.match),()=>{(0,x.Lc)("GrafanaRoute",!1,"Unmounted",F.route),Kl(F.route,!0)}),[]),(0,a.useEffect)(()=>{Vl(),(0,gr.Jy)(),(0,x.Lc)("GrafanaRoute",!1,"Updated",F)}),(0,x.Lc)("GrafanaRoute",!1,"Rendered",F.route),a.createElement(Yc.tH,null,({error:me,errorInfo:De})=>me?a.createElement(dg,{error:me,errorInfo:De}):a.createElement(a.Suspense,{fallback:a.createElement(El,null)},a.createElement(F.route.component,{...F,queryParams:(0,x.SE)(F.location.search)})))}function hg(F){return F.pageClass?F.pageClass.split(" "):[]}function Kl(F,_=!1){for(const Q of hg(F))_?document.body.classList.remove(Q):document.body.classList.add(Q)}function Vl(){document.body.classList.remove("sidemenu-open--xs");const F=document.getElementById("tooltip");F?.parentElement?.removeChild(F);const _=document.querySelectorAll(".tooltip");for(let Q=0;Q<_.length;Q++){const me=_[Q];me.parentElement?.removeChild(me)}for(const Q of Lc().drops)Q.destroy()}var si=e(96378),$l=e(78731);class vg extends a.PureComponent{constructor(){super(...arguments),this.styles=Eg(X.$.theme2),this.state={},this.initListener=()=>{const _=(0,$l.oF)();_&&(this.subscription=_.getConnectionState().subscribe({next:Q=>{this.setState({show:!Q})}}))}}componentDidMount(){}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}render(){const{show:_}=this.state;return _?!Ls.TP.isSignedIn||!X.$.liveEnabled||Ls.TP.user.orgRole===dc.X.None?null:a.createElement("div",{className:this.styles.foot},a.createElement(Gt.F,{severity:"warning",className:this.styles.warn,title:"connection to server is lost..."})):null}}const Eg=(0,Ml.N)(F=>({foot:(0,ut.css)`
      position: absolute;
      bottom: 0px;
      left: 0px;
      right: 0px;
      z-index: 10000;
      cursor: wait;
      margin: 16px;
    `,warn:(0,ut.css)`
      max-width: 400px;
      margin: auto;
    `}));let eu=[],_l=[];function yg(F){eu.push(F)}function Lp(F){_l.push(F)}class Dg extends a.Component{constructor(_){super(_),this.renderRoute=Q=>{const me=Q.roles?Q.roles():[];return a.createElement(Qc.CompatRoute,{exact:Q.exact===void 0?!0:Q.exact,sensitive:Q.sensitive===void 0?!1:Q.sensitive,path:Q.path,key:Q.path,render:De=>me?.length&&!me.some(Ce=>Ls.TP.hasRole(Ce))?a.createElement(Zs.rd,{to:"/"}):a.createElement(pg,{...De,route:Q})})},this.state={}}async componentDidMount(){await Ym(),this.setState({ready:!0}),$(".preloader").remove()}renderRoutes(){return a.createElement(Zs.dO,null,km().map(_=>this.renderRoute(_)))}render(){const{app:_}=this.props,{ready:Q}=this.state;(0,x.Lc)("AppWrapper",!1,"rendering");const me=De=>{(0,gr.rR)("command_palette_action_selected",{actionId:De.id,actionName:De.name})};return a.createElement(Ko.Provider,{store:bs.M_},a.createElement(Yc.Xw,{style:"page"},a.createElement(bo.YE.Provider,{value:_.context},a.createElement(si.N,{value:X.$.theme2},a.createElement(or.KBarProvider,{actions:[],options:{enableHistory:!0,callbacks:{onSelectAction:me}}},a.createElement(Zs.Ix,{history:x.Ny.getHistory()},a.createElement(Qc.CompatRouter,null,a.createElement(lg,null,a.createElement(Jc.k,null),a.createElement("div",{className:"grafana-app"},a.createElement(ag,null,a.createElement(Md,null),a.createElement(ig,null),a.createElement(Pt.B,{gap:0,grow:1,direction:"column"},_l.map((De,Ce)=>a.createElement(De,{key:Ce.toString()})),Q&&this.renderRoutes()),eu.map((De,Ce)=>a.createElement(De,{key:Ce.toString()})))),a.createElement(vg,null),a.createElement(Xo.EO,null),a.createElement(Pu.qB,null)))))))))}}var tu=e(33919);function Gr({actions:F,children:_,info:Q,pageNav:me,layout:De,renderTitle:Ce,subTitle:Ne}){const _e=(0,a.useContext)(mc);return a.createElement(Pr.Y,{navModel:_e.sectionNav,pageNav:me,layout:De,actions:F,renderTitle:Ce,info:Q,subTitle:Ne},a.createElement(Pr.Y.Contents,null,_))}var Bp=e(8867),nu=e(91324),Pg=e(23227),bg=e(83712),Cg=e(93455),Ir=e(99443),Co=e(70699),au=e(63997),Tg=e(5798),zl=e(61061),Sg=e(85346),Mg=e(41731),xg=e(36294),Og=e(62575),Ig=e(27798),Ag=e(53392),Rg=e(17694),Lg=e(27743),Bg=e(66509),su=e(98368),Ug=e(67341),Ng=e(51472),wg=e(90517),Fg=e(78412),Wg=e(24548),yl=e(41366),Uc=e(63892),ru=e(22965),Kg=e(19336),Vg=e(66163),$g=e(30259),_g=e(96725),$o=e(30283),zg=e(53141),kg=e(69382),Hg=e(88790),Nc=e(388),Gg=e(58689),jg=e(29342),Y=e(27583),ge=e(34153),Pe=e(13852),Le=e(5614),ze=e(34715),et=e(25853),ot=e(98020),xt=e(90088),Bt=e(79764),jt=e(5422),qt=e(61987),sn=e(88225),un=e(13896),Zt=e(68018),vn=e(63023),zn=e(32437),Un=e(99996),Kn=e(99641),Tn=e(70649),Dn=e(98828),On=e(79151),ga=e(53663),ea=e(27193),aa=e(53123),Gn=e(4458),An=e(28643),ia=e(33311),Qn=e(90841),jn=e(49018),ka=e(63738),Qa=e(63263),Ya=e(29340),Ba=e(45937),Ia=e(29339),Ea=e(6820),ja=e(77444),fs=e(3327),Bs=e(70794),Sa=e(11273),ya=e(80641),pa=e(28867),Ma=e(11220),Za=e(23544),rs=e(48339),vs=e(4240),is=e(95224),Ms=e(82382),xs=e(87048),$s=e(53007),la=e(12179),sa=e(17226),Ca=e(42982),Ja=e(42806),Ha=e(50459),qa=e(84879),ms=e(52664),Gs=e(26868),Br=e(72805),Ei=e(73575),jr=e(56811),yi=e(53896),Dl=e(97918),kl=e(81422),oo=e(29130),Di=e(45376),Ki=e(73642),Sr=e(83267),Pl=e(80021),wc=e(41684),Ih=e(72215),Ah=e(81656),Rh=e(29424),Lh=e(7682),Bh=e(51764),Uh=e(76151),Nh=e(30781),wh=e(65972),Fh=e(90756),Wh=e(24289),Kh=e(84472),Vh=e(71533),$h=e(45298),_h=e(96906),zh=e(95311),kh=e(82349),Hh=e(43482),Gh=e(49935),jh=e(48761),Qh=e(97231),Yh=e(13835),Jh=e(91381),Xh=e(52859),Zh=e(25928),qh=e(36714),ev=e(30815),tv=e(3465),nv=e(39012),av=e(94675),sv=e(40051),rv=e(4543),ov=e(89579),iv=e(82524),lv=e(31115),cv=e(99003),dv=e(95684),uv=e(1624),mv=e(93644),fv=e(96619),gv=e(61748),pv=e(57169),hv=e(11769),vv=e(26551),Ev=e(40295),yv=e(38514),Dv=e(81312),Pv=e(64298),bv=e(70866),Cv=e(30587),Tv=e(44850),Sv=e(54556),Mv=e(81615),xv=e(82798),Ov=e(8687),Iv=e(77270),Av=e(10742),Rv=e(41404),Lv=e(72579),Bv=e(39973),Uv=e(56963),Nv=e(8807),wv=e(24109),Fv=e(46255),Wv=e(68636),Kv=e(74305);let Up=!1;function fn(F,_){Bp.cacheStore[_]={content:F,status:"loaded"}}function Vv(){let F="public/img/icons/";const _=typeof window<"u"&&window.__grafana_public_path__;return _&&(F=_+"img/icons/"),Q=>F+Q}function $v(){if(Up)return;Up=!0;const F=Vv();fn(nu,F("unicons/at.svg")),fn(Pg,F("unicons/adjust-circle.svg")),fn(bg,F("unicons/align-left.svg")),fn(Cg,F("unicons/align-right.svg")),fn(Ir,F("unicons/angle-double-down.svg")),fn(Co,F("unicons/angle-double-right.svg")),fn(au,F("unicons/angle-down.svg")),fn(Tg,F("unicons/angle-left.svg")),fn(zl,F("unicons/angle-right.svg")),fn(Sg,F("unicons/angle-up.svg")),fn(Mg,F("unicons/apps.svg")),fn(xg,F("unicons/arrow.svg")),fn(Og,F("unicons/arrow-down.svg")),fn(Ig,F("unicons/arrow-from-right.svg")),fn(Ag,F("unicons/arrow-left.svg")),fn(Rg,F("unicons/arrow-random.svg")),fn(Lg,F("unicons/arrow-right.svg")),fn(Bg,F("unicons/arrow-to-right.svg")),fn(su,F("unicons/arrow-up.svg")),fn(Ug,F("unicons/arrows-h.svg")),fn(Ng,F("unicons/backward.svg")),fn(wg,F("unicons/bars.svg")),fn(Fg,F("unicons/bell.svg")),fn(Wg,F("unicons/bell-slash.svg")),fn(yl,F("unicons/bolt.svg")),fn(Uc,F("unicons/book.svg")),fn(ru,F("unicons/book-open.svg")),fn(Kg,F("unicons/brackets-curly.svg")),fn(Vg,F("unicons/bug.svg")),fn($g,F("unicons/building.svg")),fn(_g,F("unicons/calculator-alt.svg")),fn($o,F("unicons/calendar-alt.svg")),fn(zg,F("unicons/calendar-slash.svg")),fn(kg,F("unicons/camera.svg")),fn(Hg,F("unicons/channel-add.svg")),fn(Nc,F("unicons/chart-line.svg")),fn(Gg,F("unicons/check.svg")),fn(jg,F("unicons/check-circle.svg")),fn(Y,F("unicons/circle.svg")),fn(ge,F("unicons/clipboard-alt.svg")),fn(Pe,F("unicons/clock-nine.svg")),fn(Le,F("unicons/cloud.svg")),fn(ze,F("unicons/cloud-download.svg")),fn(et,F("unicons/code-branch.svg")),fn(ot,F("unicons/cog.svg")),fn(xt,F("unicons/columns.svg")),fn(Bt,F("unicons/comment-alt.svg")),fn(jt,F("unicons/comment-alt-share.svg")),fn(qt,F("unicons/comments-alt.svg")),fn(sn,F("unicons/compass.svg")),fn(un,F("unicons/copy.svg")),fn(Zt,F("unicons/corner-down-right-alt.svg")),fn(vn,F("unicons/cube.svg")),fn(zn,F("unicons/dashboard.svg")),fn(Un,F("unicons/database.svg")),fn(Kn,F("unicons/document-info.svg")),fn(Tn,F("unicons/download-alt.svg")),fn(Dn,F("unicons/draggabledots.svg")),fn(On,F("unicons/edit.svg")),fn(ga,F("unicons/ellipsis-v.svg")),fn(ea,F("unicons/ellipsis-h.svg")),fn(aa,F("unicons/envelope.svg")),fn(Gn,F("unicons/exchange-alt.svg")),fn(An,F("unicons/exclamation-circle.svg")),fn(ia,F("unicons/exclamation-triangle.svg")),fn(Qn,F("unicons/external-link-alt.svg")),fn(jn,F("unicons/eye.svg")),fn(ka,F("unicons/eye-slash.svg")),fn(Qa,F("unicons/file-alt.svg")),fn(Ya,F("unicons/file-blank.svg")),fn(Ba,F("unicons/filter.svg")),fn(Ia,F("unicons/folder.svg")),fn(Ea,F("unicons/folder-open.svg")),fn(ja,F("unicons/folder-plus.svg")),fn(fs,F("unicons/folder-upload.svg")),fn(Bs,F("unicons/forward.svg")),fn(Sa,F("unicons/graph-bar.svg")),fn(ya,F("unicons/history.svg")),fn(pa,F("unicons/history-alt.svg")),fn(Ma,F("unicons/home-alt.svg")),fn(Za,F("unicons/import.svg")),fn(rs,F("unicons/info.svg")),fn(vs,F("unicons/info-circle.svg")),fn(is,F("unicons/k6.svg")),fn(Ms,F("unicons/key-skeleton-alt.svg")),fn(xs,F("unicons/keyboard.svg")),fn($s,F("unicons/link.svg")),fn(la,F("unicons/list-ul.svg")),fn(sa,F("unicons/lock.svg")),fn(Ca,F("unicons/minus.svg")),fn(Ja,F("unicons/minus-circle.svg")),fn(Ha,F("unicons/mobile-android.svg")),fn(qa,F("unicons/monitor.svg")),fn(ms,F("unicons/pause.svg")),fn(Gs,F("unicons/pen.svg")),fn(Br,F("unicons/play.svg")),fn(Ei,F("unicons/plug.svg")),fn(jr,F("unicons/plus.svg")),fn(yi,F("unicons/plus-circle.svg")),fn(Dl,F("unicons/power.svg")),fn(kl,F("unicons/presentation-play.svg")),fn(oo,F("unicons/process.svg")),fn(Di,F("unicons/question-circle.svg")),fn(Ki,F("unicons/repeat.svg")),fn(Sr,F("unicons/rocket.svg")),fn(Pl,F("unicons/rss.svg")),fn(wc,F("unicons/save.svg")),fn(Ih,F("unicons/search.svg")),fn(Ah,F("unicons/search-minus.svg")),fn(Rh,F("unicons/search-plus.svg")),fn(Lh,F("unicons/share-alt.svg")),fn(Bh,F("unicons/shield.svg")),fn(Uh,F("unicons/signal.svg")),fn(Nh,F("unicons/signin.svg")),fn(wh,F("unicons/signout.svg")),fn(Fh,F("unicons/sitemap.svg")),fn(Wh,F("unicons/slack.svg")),fn(Kh,F("unicons/sliders-v-alt.svg")),fn(Vh,F("unicons/sort-amount-down.svg")),fn($h,F("unicons/sort-amount-up.svg")),fn(_h,F("unicons/square-shape.svg")),fn(zh,F("unicons/star.svg")),fn(kh,F("unicons/step-backward.svg")),fn(Hh,F("unicons/sync.svg")),fn(Gh,F("unicons/stopwatch.svg")),fn(jh,F("unicons/table.svg")),fn(Qh,F("unicons/tag-alt.svg")),fn(Yh,F("unicons/times.svg")),fn(Jh,F("unicons/trash-alt.svg")),fn(Xh,F("unicons/unlock.svg")),fn(Zh,F("unicons/upload.svg")),fn(qh,F("unicons/user.svg")),fn(ev,F("unicons/users-alt.svg")),fn(tv,F("unicons/wrap-text.svg")),fn(nv,F("unicons/cloud-upload.svg")),fn(av,F("unicons/credit-card.svg")),fn(sv,F("unicons/file-copy-alt.svg")),fn(rv,F("unicons/fire.svg")),fn(ov,F("unicons/hourglass.svg")),fn(iv,F("unicons/layer-group.svg")),fn(lv,F("unicons/layers-alt.svg")),fn(cv,F("unicons/line-alt.svg")),fn(dv,F("unicons/list-ui-alt.svg")),fn(uv,F("unicons/message.svg")),fn(mv,F("unicons/palette.svg")),fn(fv,F("unicons/percentage.svg")),fn(gv,F("unicons/shield-exclamation.svg")),fn(pv,F("unicons/plus-square.svg")),fn(hv,F("unicons/x.svg")),fn(vv,F("unicons/capture.svg")),fn(Ev,F("custom/gf-grid.svg")),fn(yv,F("custom/gf-landscape.svg")),fn(Dv,F("custom/gf-layout-simple.svg")),fn(Pv,F("custom/gf-portrait.svg")),fn(bv,F("custom/gf-show-context.svg")),fn(Cv,F("custom/gf-bar-alignment-after.svg")),fn(Tv,F("custom/gf-bar-alignment-before.svg")),fn(Sv,F("custom/gf-bar-alignment-center.svg")),fn(Mv,F("custom/gf-interpolation-linear.svg")),fn(xv,F("custom/gf-interpolation-smooth.svg")),fn(Ov,F("custom/gf-interpolation-step-after.svg")),fn(Iv,F("custom/gf-interpolation-step-before.svg")),fn(Av,F("custom/gf-logs.svg")),fn(Rv,F("custom/gf-movepane-left.svg")),fn(Lv,F("custom/gf-movepane-right.svg")),fn(Bv,F("mono/favorite.svg")),fn(Uv,F("mono/grafana.svg")),fn(Nv,F("mono/heart.svg")),fn(wv,F("mono/heart-break.svg")),fn(Fv,F("mono/panel-add.svg")),fn(Wv,F("mono/library-panel.svg")),fn(Kv,F("unicons/record-audio.svg"))}function _v(){self.MonacoEnvironment={getWorker(F,_){const Q=C.l.getIfExists(_);return Q?Q.init():_==="json"?new ui.c(new URL(e.p+e.u(1162),e.b)):_==="css"||_==="scss"||_==="less"?new ui.c(new URL(e.p+e.u(9044),e.b)):_==="html"||_==="handlebars"||_==="razor"?new ui.c(new URL(e.p+e.u(4064),e.b)):_==="typescript"||_==="javascript"?new ui.c(new URL(e.p+e.u(2150),e.b)):new ui.c(new URL(e.p+e.u(1821),e.b))}}}var Qg=e(76885);function zv(F){const _=F.target instanceof Element&&kv(F.target);if(!(F.ctrlKey||F.metaKey||F.defaultPrevented)&&_){let Q=_.getAttribute("href");const me=_.getAttribute("target");if(Q&&!me){const De=Qg.kM.parseKeyValue(Q.split("?")[1]),Ce=De.orgId&&Number(De.orgId)!==H.config.bootData.user.orgId;if((0,x.Lc)("utils",!1,"intercepting link click",F),F.preventDefault(),Q=T.I.stripBaseFromUrl(Q),Q[0]!=="/"||Ce)if(Q.indexOf("://")>0||Q.indexOf("mailto:")===0||Ce){window.location.href=Q;return}else if(Q.indexOf("#")===0){window.location.hash=Q;return}else Q=`/${Q}`;x.Ny.push(Q)}}}function kv(F){for(;F!==null&&F.tagName;){if(F.tagName.toUpperCase()==="A")return F;F=F.parentElement}return null}class Hv{constructor(_){this.hasUpdates=!1,this.checked=Date.now(),this.prevLocationPath="",this.interval=_??1e3*60*5}start(){const _=(0,$l.oF)();_&&_.getConnectionState().subscribe(Q=>{Q&&this._checkForUpdates()}),x.Ny.getHistory().listen(this.locationUpdated.bind(this)),this.prevLocationPath=x.Ny.getLocation().pathname}locationUpdated(_){if(this.prevLocationPath===_.pathname)return;const Q=_.pathname.split("/");Q[1]==="/"&&this.prevLocationPath!=="/"?this.reloadIfUpdateDetected():Q[1]==="d"?this.reloadIfUpdateDetected():this.hasUpdates&&(0,gr.rR)("new_frontend_assets_reload_ignored",{newLocation:_.pathname,prevLocation:this.prevLocationPath}),this.prevLocationPath=_.pathname}async _checkForUpdates(){if(this.hasUpdates||Date.now()-this.checked<this.interval)return;this.checked=Date.now();const _=this.previous,Q=await(0,S.AI)().get("/api/frontend/assets");_&&!(0,f.isEqual)(_,Q)&&(this.hasUpdates=!0,(0,gr.rR)("new_frontend_assets_detected",{assets:_.assets!==Q.assets,plugins:_.plugins!==Q.plugins,version:_.version!==Q.version,flags:_.flags!==Q.flags})),this.previous=Q}reloadIfUpdateDetected(){this.hasUpdates&&((0,gr.rR)("new_frontend_assets_reload",{}),window.location.reload()),this._checkForUpdates()}}var Yg=e(27677),Gv=e(91040),jv=e(40621);function ou(F,_=!1){return new Promise(Q=>{const me=document.createElement("script");me.onload=Q,me.src=F,me.async=_,document.head.appendChild(me)})}const Np=(0,Gv.h)("EchoSrv"),wp=Np.logger;(0,jv.h)("echo",void 0,Np);class Qv{constructor(_){this.config={flushInterval:1e4,debug:!1},this.backends=[],this.flush=()=>{for(const Q of this.backends)Q.flush()},this.addBackend=Q=>{wp("Adding backend",!1,Q),this.backends.push(Q)},this.addEvent=(Q,me)=>{const De=this.getMeta(),Ce={...Q,meta:{...De,...me}};for(const Ne of this.backends)(Ne.supportedEvents.length===0||Ne.supportedEvents.indexOf(Ce.type)>-1)&&Ne.addEvent(Ce);wp(`${Q.type} event`,!1,{...Q.payload,meta:Ce.meta})},this.getMeta=()=>({sessionId:"",userId:Ls.TP.user.id,userLogin:Ls.TP.user.login,userSignedIn:Ls.TP.user.isSignedIn,screenSize:{width:window.innerWidth,height:window.innerHeight},windowSize:{width:window.screen.width,height:window.screen.height},userAgent:window.navigator.userAgent,ts:new Date().getTime(),timeSinceNavigationStart:performance.now(),path:window.location.pathname,url:window.location.href}),this.config={...this.config,..._},setInterval(this.flush,this.config.flushInterval)}}var Yv=e(42614);class Jv{constructor(_){this.options=_,this.buffer=[],this.supportedEvents=[L.on.Performance],this.addEvent=Q=>{this.buffer.push(Q.payload)},this.flush=()=>{this.buffer.length!==0&&(Yg.IB.post("/api/frontend-metrics",{events:this.buffer}),this.buffer=[])}}}var Fc=e(61298);class Xv{constructor(_){this.options=_,this.supportedEvents=[L.on.Pageview,L.on.Interaction],this.addEvent=De=>{window.applicationInsights&&((0,Fc.nB)(De)&&window.applicationInsights.trackPageView?.(),(0,Fc.fX)(De)&&window.applicationInsights.trackEvent?.({name:De.payload.interactionName,properties:De.payload.properties}))},this.flush=()=>{};const Q={config:{connectionString:_.connectionString,endpointUrl:_.endpointUrl}};ou("https://js.monitor.azure.com/scripts/b/ai.2.min.js").then(()=>{const De=new window.Microsoft.ApplicationInsights.ApplicationInsights(Q);window.applicationInsights=De.loadAppInsights()})}}class Zv{constructor(_){this.options=_,this.supportedEvents=[L.on.Pageview],this.googleAnalytics4SendManualPageViews=!1,this.addEvent=De=>{window.gtag&&this.googleAnalytics4SendManualPageViews&&window.gtag("event","page_view",{page_path:De.payload.page})},this.flush=()=>{};const Q=`https://www.googletagmanager.com/gtag/js?id=${_.googleAnalyticsId}`;ou(Q,!0),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date);const me={page_path:window.location.pathname};_.user&&(me.user_id=_.user.analytics.identifier),this.googleAnalytics4SendManualPageViews=_.googleAnalytics4SendManualPageViews,window.gtag("config",_.googleAnalyticsId,me)}}class qv{constructor(_){this.options=_,this.supportedEvents=[L.on.Pageview],this.trackedUserId=null,this.addEvent=De=>{if(!window.ga)return;window.ga("set",{page:De.payload.page}),window.ga("send","pageview");const{userSignedIn:Ce,userId:Ne}=De.meta;Ce&&Ne!==this.trackedUserId&&(this.trackedUserId=Ne,window.ga("set","userId",Ne))},this.flush=()=>{};const Q=`https://www.google-analytics.com/analytics${_.debug?"_debug":""}.js`;ou(Q);const me=window.ga=window.ga||function(){(me.q=me.q||[]).push(arguments)};me.l=+new Date,me("create",_.googleAnalyticsId,"auto"),me("set","anonymizeIp",!0)}}class e0{constructor(_){this.options=_,this.supportedEvents=[L.on.Pageview,L.on.Interaction,L.on.ExperimentView],this.addEvent=Ce=>{window.rudderanalytics&&((0,Fc.nB)(Ce)&&window.rudderanalytics.page?.(),(0,Fc.fX)(Ce)&&window.rudderanalytics.track?.(Ce.payload.interactionName,Ce.payload.properties),(0,Fc.p6)(Ce)&&window.rudderanalytics.track?.("experiment_viewed",{experiment_id:Ce.payload.experimentId,experiment_group:Ce.payload.experimentGroup,experiment_variant:Ce.payload.experimentVariant}))},this.flush=()=>{};const Q=_.sdkUrl||"https://cdn.rudderlabs.com/v1/rudder-analytics.min.js";ou(Q);const me=window.rudderanalytics=[],De=["load","page","track","identify","alias","group","ready","reset","getAnonymousId","setAnonymousId"];for(let Ce=0;Ce<De.length;Ce++){const Ne=De[Ce];me[Ne]=function(_e){return function(){me.push([_e].concat(Array.prototype.slice.call(arguments)))}}(Ne)}if(window.rudderanalytics?.load?.(_.writeKey,_.dataPlaneUrl,{configUrl:_.configUrl,destSDKBaseURL:_.integrationsUrl}),_.user){const{identifier:Ce,intercomIdentifier:Ne}=_.user.analytics,_e={};Ne&&(_e.Intercom={user_hash:Ne}),window.rudderanalytics?.identify?.(Ce,{email:_.user.email,orgId:_.user.orgId,language:_.user.language,version:_.buildInfo.version,edition:_.buildInfo.edition},_e)}}}var t0=e(35896),n0=e(88285),a0=e(74940),s0=e(36043),r0=e(8593),o0=e(26539),i0=e(21736),l0=e(20467);class c0 extends l0.j{constructor(){super(...arguments),this.name="EchoSrvTransport",this.version=X.$.buildInfo.version}send(_){(0,L.x$)().addEvent({type:L.on.GrafanaJavascriptAgent,payload:_})}isBatched(){return!0}getIgnoreUrls(){return[]}}class d0{constructor(_){this.options=_,this.supportedEvents=[L.on.GrafanaJavascriptAgent],this.addEvent=Ce=>{},this.flush=()=>{};const Q=[],me=[new c0];_.customEndpoint&&me.push(new n0.m({url:_.customEndpoint,apiKey:_.apiKey})),_.errorInstrumentalizationEnabled&&Q.push(new a0.W),_.consoleInstrumentalizationEnabled&&Q.push(new s0._),_.webVitalsInstrumentalizationEnabled&&Q.push(new r0.I),Q.push(new o0.D);const De={globalObjectKey:_.globalObjectKey||"faro",preventGlobalExposure:_.preventGlobalExposure||!1,app:{version:_.buildInfo.version,environment:_.buildInfo.env},instrumentations:Q,transports:me,ignoreErrors:["ResizeObserver loop limit exceeded","ResizeObserver loop completed","Non-Error exception captured with keys"],sessionTracking:{persistent:!0},batching:{sendTimeout:1e3},internalLoggerLevel:_.internalLoggerLevel||t0.vI};this.faroInstance=(0,i0.p)(De),_.user&&this.faroInstance.api.setUser({id:_.user.id,attributes:{orgId:String(_.user.orgId)||""}})}}var u0=e(69129),m0=e(87490),f0=e(70497),g0=e(1702),iu=e(4898);class p0{constructor(_,Q){this.locationService=_,this.chromeService=Q,this.panelId=null,tr.A.subscribe(u0.Tp,me=>{this.panelId=me.payload.panelId})}clearAndInitGlobalBindings(_){iu.R.reset(),_.chromeless||(this.bind("?",this.showHelpModal),this.bind("g h",this.goToHome),this.bind("g d",this.goToDashboards),this.bind("g e",this.goToExplore),this.bind("g a",this.openAlerting),this.bind("g p",this.goToProfile),this.bind("esc",this.exit),this.bindGlobalEsc()),this.bind("c t",()=>(0,Ni.O)(!1)),this.bind("c r",()=>(0,Ni.O)(!0))}bindGlobalEsc(){this.bindGlobal("esc",this.globalEsc)}globalEsc(){const Q=document.activeElement;if(!(document.querySelectorAll(".slate-typeahead--open").length>0)){if(Q&&Q instanceof HTMLElement&&(Q.nodeName==="INPUT"||Q.nodeName==="TEXTAREA"||Q.hasAttribute("data-slate-editor"))){Q.blur();return}this.exit()}}closeSearch(){this.locationService.partial({search:null})}openAlerting(){this.locationService.push("/alerting")}goToDashboards(){this.locationService.push("/dashboards")}goToHome(){this.locationService.push("/")}goToProfile(){this.locationService.push("/profile")}goToExplore(){this.locationService.push("/explore")}showHelpModal(){tr.A.publish(new Tr.S8({component:Ud.N}))}exit(){const _=this.locationService.getSearchObject();if(_.editview){this.locationService.partial({editview:null,editIndex:null});return}if(_.inspect){this.locationService.partial({inspect:null,inspectTab:null});return}if(_.editPanel){this.locationService.partial({editPanel:null,tab:null});return}if(_.viewPanel){this.locationService.partial({viewPanel:null,tab:null});return}const{kioskMode:Q}=this.chromeService.state.getValue();Q&&this.chromeService.exitKioskMode(),_.search&&this.closeSearch()}showDashEditView(){this.locationService.partial({editview:"settings"})}bind(_,Q){iu.R.bind(_,me=>{me.preventDefault(),me.stopPropagation(),me.returnValue=!1,Q.call(this)},"keydown")}bindGlobal(_,Q){iu.R.bindGlobal(_,me=>{me.preventDefault(),me.stopPropagation(),me.returnValue=!1,Q.call(this)},"keydown")}unbind(_,Q){iu.R.unbind(_,Q)}bindWithPanelId(_,Q){this.bind(_,this.withFocusedPanel(Q))}withFocusedPanel(_){return()=>{if(typeof this.panelId=="number"){_(this.panelId);return}}}setupTimeRangeBindings(_=!0){this.bind("t a",()=>{tr.A.publish(new Tr.Rh({updateUrl:_}))}),this.bind("t z",()=>{tr.A.publish(new Tr.U0({scale:2,updateUrl:_}))}),this.bind("ctrl+z",()=>{tr.A.publish(new Tr.U0({scale:2,updateUrl:_}))}),this.bind("t left",()=>{tr.A.publish(new Tr.Io({direction:Tr.xL.Left,updateUrl:_}))}),this.bind("t right",()=>{tr.A.publish(new Tr.Io({direction:Tr.xL.Right,updateUrl:_}))}),this.bind("t c",()=>{tr.A.publish(new Tr.Bt)}),this.bind("t v",()=>{tr.A.publish(new Tr.VZ({updateUrl:_}))})}setupDashboardBindings(_){this.bind("mod+o",()=>{_.graphTooltip=(_.graphTooltip+1)%3,_.events.publish(new Li.Tq),_.startRefresh()}),this.bind("mod+s",()=>{_.meta.canSave&&tr.A.publish(new Tr.S8({component:f0.$,props:{dashboard:_}}))}),this.setupTimeRangeBindings(),this.bindWithPanelId("e",Q=>{if(_.canEditPanelById(Q)){const me=this.locationService.getSearchObject().editPanel!==void 0;this.locationService.partial({editPanel:me?null:Q})}}),this.bindWithPanelId("v",Q=>{const me=this.locationService.getSearchObject().viewPanel!==void 0;this.locationService.partial({viewPanel:me?null:Q})}),this.bindWithPanelId("p l",Q=>{const me=_.getPanelById(Q),De={...me.options};De.legend.showLegend?De.legend.showLegend=!1:De.legend.showLegend=!0,me.updateOptions(De)}),this.bindWithPanelId("i",Q=>{this.locationService.partial({inspect:Q})}),hs.TP.hasAccessToExplore()&&this.bindWithPanelId("p x",async Q=>{const me=_.getPanelById(Q),De=await(0,m0.Xe)({queries:me.targets,dsRef:me.datasource,scopedVars:me.scopedVars,timeRange:(0,ti.jG)().timeRange()});if(De){const Ce=T.I.stripBaseFromUrl(De);Ce&&this.locationService.push(Ce)}}),this.bindWithPanelId("p r",Q=>{_.canEditPanelById(Q)&&!(_.panelInView||_.panelInEdit)&&tr.A.publish(new Tr.Vz(Q))}),this.bindWithPanelId("p d",Q=>{if(_.canEditPanelById(Q)){const me=_.getPanelInfoById(Q).index;_.duplicatePanel(_.panels[me])}}),this.bindWithPanelId("p s",Q=>{const me=_.getPanelInfoById(Q);tr.A.publish(new Tr.S8({component:g0.ShareModal,props:{dashboard:_,panel:me?.panel}}))}),this.bind("d l",()=>{_.toggleLegendsForAll()}),this.bind("d x",()=>{_.toggleExemplarsForAll()}),this.bind("d shift+c",()=>{_.collapseRows()}),this.bind("d shift+e",()=>{_.expandRows()}),this.bind("d n",()=>{this.locationService.push("/dashboard/new")}),this.bind("d r",()=>{_.startRefresh()}),this.bind("d s",()=>{this.showDashEditView()}),this.bind("d k",()=>{this.chromeService.onToggleKioskMode()}),this.bind("d a",()=>{const me=this.locationService.getSearchObject().autofitpanels?"":"&autofitpanels";window.location.href=window.location.href+me})}}var Hl=e(78160);async function AP(){if(window.location.search.indexOf("why-render")!==-1){const{default:F}=await e.e(3718).then(e.t.bind(e,13718,23));F(React,{trackAllPureComponents:!0})}}var h0=e(20120);const v0=a.lazy(()=>e.e(192).then(e.bind(e,57029)));function E0(){const F=(0,er.Wd)(rl.hY);Ls.TP.hasPermission(F.read)&&(0,h0.fP)({show:()=>X.$.unifiedAlertingEnabled,component:({dashboard:_})=>a.createElement(a.Suspense,{fallback:null,key:"alert-rules-button"},_&&a.createElement(v0,{dashboardUid:_.uid})),index:-2})}var y0=e(73399);function D0(F){return a.createElement(P0,{...F})}const P0=a.lazy(async()=>{const{EmbeddedDashboard:F}=await e.e(2859).then(e.bind(e,13251));return{default:F}});var b0=e(61582),C0=e(67027),T0=e(97527),RP=e(99355),Wc=e(14590),S0=e(19895),M0=e(44838);const x0=()=>new ui.c(new URL(e.p+e.u(5358),e.b));var O0=e(88483),Fp=e(63720);const I0=F=>new O0.c(_=>{const Q=F.subscribe(Wc.BX(me=>{_.next(me)}),Wc.BX(me=>{_.error(me)}),Wc.BX(()=>{_.complete()}));return{unsubscribe:()=>{Q.then(me=>me.unsubscribe())}}}),Jg=F=>(0,to.H)(F).pipe((0,Fp.n)(_=>I0(_)));class A0{constructor(_){this.getConnectionState=()=>Jg(this.centrifugeWorker.getConnectionState()),this.getDataStream=Q=>Jg(this.centrifugeWorker.getDataStream(Q)).pipe((0,S0.Q)(M0.E)),this.getQueryData=async Q=>{const me=JSON.parse(JSON.stringify(Q));return this.centrifugeWorker.getQueryData(me)},this.getPresence=Q=>this.centrifugeWorker.getPresence(Q),this.getStream=Q=>Jg(this.centrifugeWorker.getStream(Q)),this.centrifugeWorker=Wc.LV(x0()),this.centrifugeWorker.initialize(_,Wc.BX(_.dataStreamSubscriberReadiness))}}var Wp=e(9631),R0=e(55004),L0=e(47773),Kp=e(26657),lu=e(47118);class B0{constructor(_){this.deps=_,this.getConnectionState=()=>this.deps.centrifugeSrv.getConnectionState(),this.getDataStream=Q=>{let me;const De=Ce=>{const Ne=Ce.data[0];if(!me&&!(0,lu.ot)(Ne,lu._w.FullFrame)){console.warn(`expected first packet to contain a full frame, received ${Ne?.type}`);return}switch(Ne.type){case lu._w.FullFrame:{me=Wp.k9.deserialize(Ne.frame);return}case lu._w.NewValuesSameSchema:{me.pushNewValues(Ne.values);return}}};return this.deps.centrifugeSrv.getDataStream(Q).pipe((0,Kt.T)(Ce=>(De(Ce),{...Ce,data:[me??Wp.k9.empty()]})))},this.getStream=Q=>this.deps.centrifugeSrv.getStream(Q),this.getQueryData=Q=>(0,to.H)(this.deps.centrifugeSrv.getQueryData(Q)).pipe((0,Fp.n)(me=>{const De=(0,L0.bE)(me,Q.request.targets);return De.data?.length&&De.data.find(Ne=>Ne.meta?.channel)?(0,Kp.x7)(De,Q.request,Kp.ph):(0,Fn.of)(De)})),this.publish=async(Q,me)=>this.deps.backendSrv.post("api/live/publish",{channel:(0,R0.Qp)(Q),data:me}),this.getPresence=Q=>this.deps.centrifugeSrv.getPresence(Q)}}function U0(){const F={appUrl:`${window.location.origin}${X.$.appSubUrl}`,orgId:Ls.TP.user.orgId,orgRole:Ls.TP.user.orgRole,liveEnabled:X.$.liveEnabled,dataStreamSubscriberReadiness:b0.a.ok.asObservable(),grafanaAuthToken:(0,C0.r)()},_=X.$.featureToggles["live-service-web-worker"]?new A0(F):new T0.w(F);(0,$l.S8)(new B0({centrifugeSrv:_,backendSrv:(0,S.AI)()}))}function LP(){return getGrafanaLiveSrv()}var N0=e(17888),w0=e(20726),Ks=e(75462),Vp=e(29436),F0=e(23994),W0=e(11140),K0=e(12881);function V0(){try{return[(0,Ks.io)({title:"Add to dashboard",description:"Use the query and panel from explore and create/add it to a dashboard",extensionPointId:wi.S.ExploreToolbarAction,icon:"apps",category:"Dashboards",configure:()=>{if(hs.TP.hasPermission(Vn.AccessControlAction.DashboardsCreate)||hs.TP.hasPermission(Vn.AccessControlAction.DashboardsWrite))return{}},onClick:(F,{context:_,openModal:Q})=>{Q({title:(0,K0.t)(),body:({onDismiss:me})=>a.createElement(W0.v,{onClose:me,exploreId:_?.exploreId})})}}),(0,Ks.io)({title:"Add correlation",description:"Create a correlation from this query",extensionPointId:wi.S.ExploreToolbarAction,icon:"link",configure:F=>F?.shouldShowAddCorrelation?{}:void 0,onClick:(F,{context:_})=>{(0,bs.JD)((0,Vp.am)({editorMode:!0})),(0,bs.JD)((0,F0.Od)({exploreId:_.exploreId}))}})]}catch(F){return(0,Ks.FF)(`Could not configure extensions for Explore due to: "${F}"`),[]}}function $0(){return[...V0()]}function BP(F,_="extension is not a link extension"){if(!isPluginExtensionLink(F))throw new Error(_)}function UP(F,_="extension is not a command extension config"){if(!isPluginExtensionLinkConfig(F))throw new Error(_)}function $p(F,_){if(!H0(F,_))throw new Error(`Invalid link extension. The "path" is required and should start with "/a/${F}/" (currently: "${_}"). Skipping the extension.`)}function _p(F){if(!J0(F))throw new Error('Invalid component extension, the "component" property needs to be a valid React component.')}function _0(F,_){if(!G0(F,_))throw new Error(`Invalid extension "${_.title}". The extensionPointId should start with either "grafana/", "plugins/" or "capabilities/${F}" (currently: "${_.extensionPointId}"). Skipping the extension.`)}function z0(F){if(!j0(F))throw new Error(`Invalid extension "${F.title}". The "configure" property must be a function. Skipping the extension.`)}function zp(F,_){for(const Q of _)if(!Q0(F[Q]))throw new Error(`Invalid extension "${F.title}". Property "${Q}" must be a string and cannot be empty. Skipping the extension.`)}function k0(F,_="The provided value is a Promise."){if(kp(F))throw new Error(_)}function H0(F,_){return!!(typeof _=="string"&&_.length>0&&_.startsWith(`/a/${F}/`))}function G0(F,_){return!!(_.extensionPointId?.startsWith("grafana/")||_.extensionPointId?.startsWith("plugins/")||_.extensionPointId?.startsWith(`capabilities/${F}/`))}function j0(F){return F.configure?typeof F.configure=="function":!0}function Q0(F){return typeof F=="string"&&F.length>0}function Y0(F,_){try{if(zp(_,["title","description","extensionPointId"]),_0(F,_),(0,Ks.z1)(_)){if(z0(_),!_.path&&!_.onClick)return(0,Ks.FF)(`Invalid extension "${_.title}". Either "path" or "onClick" is required.`),!1;_.path&&$p(F,_.path)}return(0,Ks.yS)(_)&&_p(_.component),!0}catch(Q){return Q instanceof Error&&(0,Ks.FF)(Q.message),!1}}function kp(F){return F instanceof Promise||typeof F=="object"&&F!==null&&"then"in F&&"catch"in F}function J0(F){const _=me=>typeof me=="object"&&me!==null&&"$$typeof"in me;return typeof F=="function"||(me=>_(me)&&me.$$typeof===Symbol.for("react.memo"))(F)}function X0(F){let _={id:"",extensions:{}};return F.asObservable().subscribe(Q=>{_=Q}),Q=>Hp({...Q,registry:_})}const Hp=({context:F,extensionPointId:_,limitPerPlugin:Q,registry:me})=>{const De=F?(0,Ks.$Y)(F):{},Ce=me.extensions[_]??[],Ne=[],_e={};for(const Qe of Ce)try{const st=Qe.config,{pluginId:Et}=Qe;if(Q&&_e[Et]>=Q)continue;if(_e[Et]===void 0&&(_e[Et]=0),(0,Ks.z1)(st)){const Ct=Z0(Et,st,De);if(st.configure&&Ct===void 0)continue;const kt=Ct?.path||st.path,Ut={id:(0,Ks.yt)(Et,st),type:wi.u.link,pluginId:Et,onClick:q0(Et,st,De),icon:Ct?.icon||st.icon,title:Ct?.title||st.title,description:Ct?.description||st.description,path:(0,f.isString)(kt)?eE(Et,kt,st):void 0,category:Ct?.category||st.category};Ne.push(Ut),_e[Et]+=1}if((0,Ks.yS)(st)){_p(st.component);const Ct={id:(0,Ks.yt)(Qe.pluginId,st),type:wi.u.component,pluginId:Qe.pluginId,title:st.title,description:st.description,component:(0,Ks.nv)(Et,st.component)};Ne.push(Ct),_e[Et]+=1}}catch(st){st instanceof Error&&(0,Ks.FF)(st.message)}return{extensions:Ne}};function Z0(F,_,Q){try{const me=_.configure?.(Q);if(me===void 0)return;let{title:De=_.title,description:Ce=_.description,path:Ne=_.path,icon:_e=_.icon,category:Qe=_.category,...st}=me;return k0(me,`The configure() function for "${_.title}" returned a promise, skipping updates.`),Ne&&$p(F,Ne),zp({title:De,description:Ce},["title","description"]),Object.keys(st).length>0&&(0,Ks.FF)(`Extension "${_.title}", is trying to override restricted properties: ${Object.keys(st).join(", ")} which will be ignored.`),{title:De,description:Ce,path:Ne,icon:_e,category:Qe}}catch(me){me instanceof Error&&(0,Ks.FF)(me.message);return}}function q0(F,_,Q){const{onClick:me}=_;if(me)return function(Ce){try{(0,gr.rR)("ui_extension_link_clicked",{pluginId:F,extensionPointId:_.extensionPointId,title:_.title,category:_.category});const Ne=me(Ce,(0,Ks.yb)(F,Q));kp(Ne)&&Ne.catch(_e=>{_e instanceof Error&&(0,Ks.FF)(_e.message)})}catch(Ne){Ne instanceof Error&&(0,Ks.FF)(Ne.message)}}}function eE(F,_,Q){return Qg.kM.appendQueryToUrl(_,Qg.kM.toUrlParams({uel_pid:F,uel_epid:Q.extensionPointId}))}var cu=e(13752),Gp=e(39741),tE=e(29405),nE=e(96222),aE=e(72985),jp=e(62938);class sE{constructor(){this.resultSubject=new cu.B,this.registrySubject=new Gp.m(1),this.resultSubject.pipe((0,tE.S)(rE,{id:"",extensions:{}}),(0,nE.Z)({id:"",extensions:{}}),(0,Kt.T)(_=>(0,Ks.ol)(_))).subscribe(this.registrySubject)}register(_){this.resultSubject.next(_)}asObservable(){return this.registrySubject.asObservable()}getRegistry(){return(0,aE._)(this.asObservable())}}function rE(F,_){const{pluginId:Q,extensionConfigs:me,error:De}=_;if(De)return(0,Ks.FF)(`"${Q}" plugin failed to load, skip registering its extensions.`),F;for(const Ce of me){const{extensionPointId:Ne}=Ce;if((0,Ks.WW)(Ce)){const st=/capabilities\/([a-zA-Z0-9_.\-\/]+)$/.exec(Ne);if(!st){(0,Ks.FF)(`"${Q}" plugin has an invalid capability ID: ${Ne.replace("capabilities/","")} (It must be a string)`);continue}Ce.extensionPointId=`capabilities/${st[1]}`}if(!Ce||!Y0(Q,Ce))return F;let _e={config:Ce,pluginId:Q};(0,Ks.WW)(Ce)?F.extensions[Ne]=[_e]:Array.isArray(F.extensions[Ne])?F.extensions[Ne].push(_e):F.extensions[Ne]=[_e]}return F.id=(0,jp.A)(),F}function oE(F){const _=F.asObservable();return function(me){const De=(0,Mc.A)(_);return(0,a.useMemo)(()=>{if(!De)return{isLoading:!1,component:null};const Ce=`capabilities/${me}`,Ne=De.extensions[Ce],_e=Array.isArray(Ne)?Ne[0]:null;return _e&&(0,Ks.yS)(_e.config)?{isLoading:!1,component:(0,Ks.nv)(_e.pluginId,_e.config.component)}:{isLoading:!1,component:null}},[me,De])}}function iE(F){const _=F.asObservable(),Q={id:"",extensions:{}};return function(De){const Ce=(0,Mc.A)(_);if(!Ce)return{extensions:[],isLoading:!1};Ce.id!==Q.id&&(Q.id=Ce.id,Q.extensions={});const Ne=`${De.extensionPointId}-${De.limitPerPlugin}`;if(Q.extensions[Ne]&&Q.extensions[Ne].context===De.context)return{extensions:Q.extensions[Ne].extensions,isLoading:!1};const{extensions:_e}=Hp({...De,registry:Ce});return Q.extensions[Ne]={context:De.context,extensions:_e},{extensions:_e,isLoading:!1}}}var Qp=e(15162);async function Yp(F=[],_,Q="frontend_plugins_preload"){(0,Hl.j)(Q);const me=F.filter(Ce=>Ce.preload).map(Ce=>lE(Ce)),De=await Promise.all(me);for(const Ce of De)_.register(Ce);(0,Hl.z)(Q)}async function lE(F){const{path:_,version:Q,id:me}=F;try{(0,Hl.j)(`frontend_plugin_preload_${me}`);const{plugin:De}=await ll.j4({path:_,version:Q,isAngular:F.angular.detected,pluginId:me}),{extensionConfigs:Ce=[]}=De;return(0,Cd.x)(me),{pluginId:me,extensionConfigs:Ce}}catch(De){return console.error(`[Plugins] Failed to preload plugin: ${_} (version: ${Q})`,De),{pluginId:me,extensionConfigs:[],error:De}}finally{(0,Hl.z)(`frontend_plugin_preload_${me}`)}}var cE=e(57532),Jp=e(41987),Xp=e(65879),dE=e(80924),uE=e(72955),Xg=e(39374);class mE{constructor(){this.subject=new Gp.m(1)}get(){return this.subject.asObservable()}run(_){const{queries:Q,timezone:me,datasource:De,panelId:Ce,app:Ne,dashboardUID:_e,timeRange:Qe,timeInfo:st,cacheTimeout:Et,queryCachingTTL:Ct,maxDataPoints:kt,scopedVars:Ut,minInterval:Ot}=_;this.subscription&&this.subscription.unsubscribe();const Wt={app:Ne??Jp.Jk.Unknown,requestId:(0,dE.S)(),timezone:me,panelId:Ce,dashboardUID:_e,range:Qe,timeInfo:st,interval:"",intervalMs:0,targets:(0,f.cloneDeep)(Q),maxDataPoints:kt,scopedVars:Ut||{},cacheTimeout:Et,queryCachingTTL:Ct,startTime:Date.now()};Wt.rangeRaw=Qe.raw,(0,to.H)(fE(De,Wt.scopedVars)).pipe((0,cE.$)()).subscribe({next:Sn=>{Wt.targets=Wt.targets.map(Ua=>(Ua.datasource||(Ua.datasource=Sn.getRef()),Ua));const ha=Ot?(0,Oe.w)().replace(Ot,Wt.scopedVars):Sn.interval,wa=Xp.calculateInterval(Qe,kt,ha);Wt.scopedVars=Object.assign({},Wt.scopedVars,{__interval:{text:wa.interval,value:wa.interval},__interval_ms:{text:wa.intervalMs.toString(),value:wa.intervalMs}}),Wt.interval=wa.interval,Wt.intervalMs=wa.intervalMs,this.subscription=(0,Xg.BN)(Sn,Wt).subscribe({next:Ua=>{const Na=(0,Qo.N$)(Ua,this.lastResult);this.lastResult=(0,uE.B)(Na,this.lastResult),this.subject.next(this.lastResult)}})},error:Sn=>console.error("PanelQueryRunner Error",Sn)})}cancel(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&this.lastResult.state===ws.Gu.Loading&&this.subject.next({...this.lastResult,state:ws.Gu.Done}))}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}}async function fE(F,_){return F&&"query"in F?F:(0,i.tR)().get(F,_)}function gE(){window.grafanaRuntime={getDashboardSaveModel:()=>{const F=(0,d.UA)().getCurrent();if(F)return F.getSaveModelCloneOld()},getDashboardTimeRange:()=>{const F=(0,ti.jG)().timeRange();return{from:F.from.valueOf(),to:F.to.valueOf(),raw:F.raw}},getPanelData:()=>{const F=(0,d.UA)().getCurrent();if(F)return F.panels.reduce((_,Q)=>(_[Q.id]=Q.getQueryRunner().getLastResult(),_),{})}}}var pE=e(16757),Kc=e(20601),Aa=e(75096),Zp=e(22391),hE=e(27803),Pi=e(3843);function qp(F){return F.extended&&"infoText"in F.extended?F.extended:null}function eh(F){return F.extended&&"dataSourceTypes"in F.extended?F.extended:null}function Zg(F){return F.extended&&"dataSource"in F.extended?F.extended:null}var Ps=e(87421),Vc=e(26260);const vE=(F,_)=>{const{rootStateKey:Q}=_.variable;if(!Q)return console.error("AdHocVariableEditor: variable has no rootStateKey"),{extended:qp(Pi.nS)};const{editor:me}=(0,Ps.nx)(Q,F);return{extended:qp(me)}},EE={changeVariableDatasource:Vc.Iv},yE=(0,Ko.connect)(vE,EE);class DE extends a.PureComponent{constructor(){super(...arguments),this.onDatasourceChanged=_=>{this.props.changeVariableDatasource((0,Aa.jX)(this.props.variable),(0,Zp.p$)(_))}}componentDidMount(){const{rootStateKey:_}=this.props.variable;if(!_){console.error("AdHocVariableEditor: variable has no rootStateKey");return}}render(){const{variable:_,extended:Q}=this.props;return a.createElement(hE.Q,{datasource:_.datasource??void 0,onDataSourceChange:this.onDatasourceChanged,infoText:Q?.infoText})}}const PE=yE(DE);var th=e(38401),qg=e(83684);const nh=90,ah=({datasource:F,onChange:_,disabled:Q,filterKey:me,allFilters:De})=>{const Ce=()=>sh(F,me,De),Ne=()=>TE(F,me,De);return me===null?a.createElement("div",{className:"gf-form","data-testid":"AdHocFilterKey-add-key-wrapper"},a.createElement(qg.s,{disabled:Q,className:"query-segment-key",Component:CE,value:me,onChange:_,loadOptions:Ce,inputMinWidth:nh})):a.createElement("div",{className:"gf-form","data-testid":"AdHocFilterKey-key-wrapper"},a.createElement(qg.s,{disabled:Q,className:"query-segment-key",value:me,onChange:_,loadOptions:Ne,inputMinWidth:nh}))},du="-- remove filter --",bE={label:du,value:du},CE=a.createElement("span",{className:"gf-form-label query-part","aria-label":"Add Filter"},a.createElement(cs.I,{name:"plus"})),sh=async(F,_,Q)=>{const me=await(0,i.tR)().get(F);if(!me||!me.getTagKeys)return[];const De=Q.filter(Ne=>Ne.key!==_);return(await me.getTagKeys({filters:De})).map(Ne=>({label:Ne.text,value:Ne.text}))},TE=async(F,_,Q)=>{const me=await sh(F,_,Q);return[bE,...me]},SE=({datasource:F,disabled:_,onChange:Q,filterKey:me,filterValue:De,placeHolder:Ce,allFilters:Ne})=>{const _e=(0,Nt.of)(xE),Qe=()=>ME(F,me,Ne);return a.createElement("div",{className:"gf-form","data-testid":"AdHocFilterValue-value-wrapper"},a.createElement(qg.s,{className:_e.segment,disabled:_,placeholder:Ce,value:De,onChange:Q,loadOptions:Qe}))},ME=async(F,_,Q)=>{const me=await(0,i.tR)().get(F);if(!me||!me.getTagValues)return[];const De=(0,ti.jG)().timeRange(),Ce=Q.filter(_e=>_e.key!==_);return(await me.getTagValues({key:_,filters:Ce,timeRange:De})).map(_e=>({label:_e.text,value:_e.text}))};function xE(){return{segment:(0,ut.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"500px"})}}const OE=["=","!=","<",">","=~","!~"].map(F=>({label:F,value:F})),IE=({value:F,disabled:_,onChange:Q})=>a.createElement(th.Y,{className:"query-segment-operator",value:F,disabled:_,options:OE,onChange:Q}),rh=({datasource:F,filter:{key:_,operator:Q,value:me},onKeyChange:De,onOperatorChange:Ce,onValueChange:Ne,placeHolder:_e,allFilters:Qe,disabled:st})=>a.createElement(a.Fragment,null,a.createElement(ah,{disabled:st,datasource:F,filterKey:_,onChange:De,allFilters:Qe}),a.createElement("div",{className:"gf-form"},a.createElement(IE,{disabled:st,value:Q,onChange:Ce})),a.createElement(SE,{disabled:st,datasource:F,filterKey:_,filterValue:me,allFilters:Qe,onChange:Ne,placeHolder:_e})),AE=({datasource:F,appendBefore:_,onCompleted:Q,allFilters:me})=>{const[De,Ce]=(0,a.useState)(null),[Ne,_e]=(0,a.useState)("="),Qe=(0,a.useCallback)(Ct=>{if(Ct.value!==du){Ce(Ct.value??"");return}Ce(null)},[Ce]),st=(0,a.useCallback)(Ct=>_e(Ct.value??""),[_e]),Et=(0,a.useCallback)(Ct=>{Q({value:Ct.value??"",operator:Ne,key:De}),Ce(null),_e("=")},[Q,Ne,De]);return De===null?a.createElement(ah,{datasource:F,filterKey:De,onChange:Qe,allFilters:me}):a.createElement(a.Fragment,{key:"filter-builder"},_,a.createElement(rh,{datasource:F,filter:{key:De,value:"",operator:Ne},placeHolder:(0,as.t)("variable.adhoc.placeholder","Select value"),onKeyChange:Qe,onOperatorChange:st,onValueChange:Et,allFilters:me}))},oh=({label:F})=>a.createElement("div",{className:"gf-form"},a.createElement("span",{className:"gf-form-label query-keyword"},F));class RE extends a.PureComponent{constructor(){super(...arguments),this.onChange=(_,Q)=>me=>{const{filters:De}=this.props,{value:Ce}=me;return me.value===du?this.props.removeFilter(_):this.props.changeFilter(_,{...De[_],[Q]:Ce})},this.appendFilterToVariable=_=>{this.props.addFilter(_)}}render(){const{filters:_,disabled:Q}=this.props;return a.createElement("div",{className:"gf-form-inline"},this.renderFilters(_,Q),!Q&&a.createElement(AE,{datasource:this.props.datasource,appendBefore:_.length>0?a.createElement(oh,{label:"AND"}):null,onCompleted:this.appendFilterToVariable,allFilters:this.getAllFilters()}))}getAllFilters(){return this.props.baseFilters?this.props.baseFilters.concat(this.props.filters):this.props.filters}renderFilters(_,Q){return _.length===0&&Q?a.createElement(th.Y,{disabled:Q,value:"No filters",options:[],onChange:()=>{}}):_.reduce((me,De,Ce)=>(me.length>0&&me.push(a.createElement(oh,{label:"AND",key:`condition-${Ce}`})),me.push(this.renderFilterSegments(De,Ce,Q)),me),[])}renderFilterSegments(_,Q,me){return a.createElement(a.Fragment,{key:`filter-${Q}`},a.createElement(rh,{disabled:me,datasource:this.props.datasource,filter:_,onKeyChange:this.onChange(Q,"key"),onOperatorChange:this.onChange(Q,"operator"),onValueChange:this.onChange(Q,"value"),allFilters:this.getAllFilters()}))}}const LE={addFilter:Vc.U2,removeFilter:Vc.VT,changeFilter:Vc.$u},BE=(0,Ko.connect)(null,LE);class UE extends a.PureComponent{constructor(){super(...arguments),this.addFilter=_=>{this.props.addFilter((0,Aa.jX)(this.props.variable),_)},this.removeFilter=_=>{this.props.removeFilter((0,Aa.jX)(this.props.variable),_)},this.changeFilter=(_,Q)=>{this.props.changeFilter((0,Aa.jX)(this.props.variable),{index:_,filter:Q})}}render(){const{filters:_,datasource:Q,baseFilters:me}=this.props.variable;return a.createElement(RE,{datasource:Q,filters:_,baseFilters:me,disabled:this.props.readOnly,addFilter:this.addFilter,removeFilter:this.removeFilter,changeFilter:this.changeFilter})}}const ih=BE(UE);ih.displayName="AdHocPicker";var lh=e(53699);const NE=F=>F.map(_=>KE(_).map(FE).join("|")),wE=F=>{if((0,f.isArray)(F))return F.map(ch).filter(VE);const _=ch(F);return _===null?[]:[_]};function FE(F){return F==null?"":/\|/g[Symbol.replace](F,"__gfp__")}function WE(F){return F==null?"":/__gfp__/g[Symbol.replace](F,"|")}function KE(F){return[F.key,F.operator,F.value]}function ch(F){if(!(0,f.isString)(F)||F.length===0)return null;const _=F.split("|").map(WE);return{key:_[0],operator:_[1],value:_[2]}}function VE(F){return F!==null&&(0,f.isString)(F.value)}const dh=async()=>{},$E=()=>({id:"adhoc",description:"Add key/value filters on the fly.",name:"Ad hoc filters",initialState:lh.MK,reducer:lh.AA,picker:ih,editor:PE,dependsOn:()=>!1,setValue:dh,setValueFromUrl:async(F,_)=>{const Q=wE(_);await(0,bs.JD)((0,Vc.D4)((0,Aa.jX)(F),Q))},updateOptions:dh,getSaveModel:F=>{const{index:_,id:Q,state:me,global:De,rootStateKey:Ce,...Ne}=(0,f.cloneDeep)(F);return Ne},getValueForUrl:F=>{const _=F?.filters??[];return NE(_)}});var uu=e(14644),_E=e(8866),Ar=e(13344),Mr=e(24240),uh=e(13288),zE=e(44240),mu=e(16126),kE=e(38975),HE=e(67791),GE=e(66847),jE=e(69850),lr=e(72401),Os=e(48594),bl=e(12470),$c=e(83370),Gl=e(80484);const QE={...Gl.Vg,type:"query",datasource:null,query:"",regex:"",sort:bl.ZG.disabled,refresh:bl.CO.onDashboardLoad,multi:!1,includeAll:!1,allValue:null,options:[],current:{},definition:""},YE=(F,_)=>{if(_===bl.ZG.disabled)return F;const Q=Math.ceil(_/2),me=_%2===0;return Q===1?F=(0,f.sortBy)(F,"text"):Q===2?F=(0,f.sortBy)(F,De=>{if(!De.text)return-1;const Ce=De.text.match(/.*?(\d+).*/);return!Ce||Ce.length<2?-1:parseInt(Ce[1],10)}):Q===3?F=(0,f.sortBy)(F,De=>(0,f.toLower)(De.text)):Q===4&&F.sort((De,Ce)=>De.text?Ce.text?De.text.localeCompare(Ce.text,void 0,{numeric:!0}):1:-1),me&&(F=F.reverse()),F},JE=(F,_)=>{const Q=[];let me=null;_.lastIndex=0;do me=_.exec(F),me&&Q.push(me);while(_.global&&me&&me[0]!==""&&me[0]!==void 0);return Q},XE=(F,_,Q)=>{let me,De=[];F&&(me=(0,Rr.dO)(F));for(let Ce=0;Ce<Q.length;Ce++){const Ne=Q[Ce];let _e=Ne.text===void 0||Ne.text===null?Ne.value:Ne.text,Qe=Ne.value===void 0||Ne.value===null?Ne.text:Ne.value;if((0,f.isNumber)(Qe)&&(Qe=Qe.toString()),(0,f.isNumber)(_e)&&(_e=_e.toString()),me){const st=JE(Qe,me);if(!st.length)continue;const Et=st.find(Ot=>Ot.groups&&Ot.groups.value),Ct=st.find(Ot=>Ot.groups&&Ot.groups.text),kt=st.find(Ot=>Ot.length>1),Ut=st.length>1&&kt;if(Et||Ct)Qe=Et?.groups?.value??Ct?.groups?.text,_e=Ct?.groups?.text??Et?.groups?.value;else if(Ut){for(let Ot=0;Ot<st.length;Ot++){const Wt=st[Ot];De.push({text:Wt[1],value:Wt[1],selected:!1})}continue}else kt&&(_e=kt[1],Qe=kt[1])}De.push({text:_e,value:Qe,selected:!1})}return De=(0,f.uniqBy)(De,"value"),YE(De,_)},mh=(0,ao.Z0)({name:"templating/query",initialState:$c.j,reducers:{updateVariableOptions:(F,_)=>{const{results:Q,templatedRegex:me}=_.payload.data,De=(0,Ps.Fs)(F,_.payload.id);if(De.type!=="query")return;const{includeAll:Ce,sort:Ne}=De,_e=XE(me,Ne,Q);Ce&&_e.unshift({text:Ar.Zm,value:Ar.To,selected:!1}),_e.length||_e.push({text:Ar.ou,value:Ar.Ek,isNone:!0,selected:!1}),De.options=_e}}}),ZE=mh.reducer,{updateVariableOptions:qE}=mh.actions;function ey(){return F=>F.pipe((0,Kt.T)(ty))}function ty(F){const _=F.series;if(!_||!_.length)return[];if(sy(_))return _;const Q=(0,Qo.Bt)(_),me=[];let De=-1,Ce=-1,Ne=-1,_e=-1;for(const Qe of Q)for(let st=0;st<Qe.fields.length;st++){const Et=Qe.fields[st],Ct=(0,q.Ct)(Et,Qe,_).toLowerCase();Et.type===se.PU.string&&Ne===-1&&(Ne=st),Ct==="text"&&Et.type===se.PU.string&&Ce===-1&&(Ce=st),Ct==="value"&&Et.type===se.PU.string&&De===-1&&(De=st),Ct==="expandable"&&(Et.type===se.PU.boolean||Et.type===se.PU.number)&&_e===-1&&(_e=st)}if(Ne===-1)throw new Error("Couldn't find any field of type string in the results.");for(const Qe of Q)for(let st=0;st<Qe.length;st++){const Et=_e!==-1?Qe.fields[_e].values[st]:void 0,Ct=Qe.fields[Ne].values[st],kt=Ce!==-1?Qe.fields[Ce].values[st]:null,Ut=De!==-1?Qe.fields[De].values[st]:null;if(De===-1&&Ce===-1){me.push({text:Ct,value:Ct,expandable:Et});continue}if(De===-1&&Ce!==-1){me.push({text:kt,value:kt,expandable:Et});continue}if(De!==-1&&Ce===-1){me.push({text:Ut,value:Ut,expandable:Et});continue}me.push({text:kt,value:Ut,expandable:Et})}return me}function ny(F){return _=>_.pipe((0,Kt.T)(Q=>{const{variable:me,dispatch:De,getTemplatedRegexFunc:Ce}=F;if(!me.rootStateKey){console.error("updateOptionsState: variable.rootStateKey is not defined");return}const Ne=Ce(me),_e=(0,Aa.qD)(me,{results:Q,templatedRegex:Ne});De((0,Os.kb)(me.rootStateKey,qE(_e)))}))}function ay(F){return _=>_.pipe((0,Wo.Z)(()=>{const{dispatch:Q,variable:me,searchFilter:De}=F;return De?(0,Fn.of)():(0,to.H)(Q((0,lr.kl)((0,Aa.jX)(me))))}))}function sy(F){if(!F)return!1;if(!F.length)return!0;const _=F[0];if((0,Qo.ci)(_))return!1;for(const Q in _){if(!_.hasOwnProperty(Q)||_[Q]!==null&&typeof _[Q]!="string"&&typeof _[Q]!="number")continue;const me=Q.toLowerCase();if(me==="text"||me==="value")return!0}return!1}var fu=e(29505),ry=e(43127);class oy{constructor(){this.runners=[new iy,new ly,new cy,new uy]}getRunnerForDatasource(_){const Q=this.runners.find(me=>me.canRun(_));if(Q)return Q;throw new Error("Couldn't find a query runner that matches supplied arguments.")}isQueryRunnerAvailableForDatasource(_){return this.runners.some(Q=>Q.canRun(_))}}class iy{constructor(){this.type=fu.Qz.Legacy}canRun(_){return(0,Mr.d5)(_)}getTarget({datasource:_,variable:Q}){if((0,Mr.d5)(_))return Q.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:_,variable:Q,searchFilter:me,timeSrv:De},Ce){if(!(0,Mr.d5)(_))return _c();const Ne=(0,Aa.iP)(Q,me,De,Ce.scopedVars);return(0,to.H)(_.metricFindQuery(Q.query,Ne)).pipe((0,Wo.Z)(_e=>{if(!_e||!_e.length)return _c();const Qe=_e;return(0,Fn.of)({series:Qe,state:ws.Gu.Done,timeRange:Ne.range})}))}}class ly{constructor(){this.type=fu.Qz.Standard}canRun(_){return(0,Mr.Hf)(_)}getTarget({datasource:_,variable:Q}){if((0,Mr.Hf)(_))return _.variables.toDataQuery(Q.query);throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:_,runRequest:Q},me){return(0,Mr.Hf)(_)?_.variables.query?Q(_,me,_.variables.query.bind(_.variables)):Q(_,me):_c()}}class cy{constructor(){this.type=fu.Qz.Custom}canRun(_){return(0,Mr.zs)(_)}getTarget({datasource:_,variable:Q}){if((0,Mr.zs)(_))return Q.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:_,runRequest:Q},me){return(0,Mr.zs)(_)?Q(_,me,_.variables.query.bind(_.variables)):_c()}}const dy="variable-query";class uy{constructor(){this.type=fu.Qz.Datasource}canRun(_){return(0,Mr.X3)(_)}getTarget({datasource:_,variable:Q}){if((0,Mr.X3)(_))return{...Q.query,refId:Q.query.refId??dy};throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:_,runRequest:Q},me){return(0,Mr.X3)(_)?Q(_,me):_c()}}function _c(){return(0,Fn.of)({state:ws.Gu.Done,series:[],timeRange:(0,ry.E2)()})}class my{constructor(_={dispatch:bs.JD,getState:bs.Gu,getVariable:Ps.dn,getTemplatedRegex:Aa.u7,getTimeSrv:ti.jG,queryRunners:new oy,runRequest:Xg.BN}){this.dependencies=_,this.updateOptionsRequests=new cu.B,this.updateOptionsResults=new cu.B,this.cancelRequests=new cu.B,this.onNewRequest=this.onNewRequest.bind(this),this.subscription=this.updateOptionsRequests.subscribe(this.onNewRequest)}queueRequest(_){this.updateOptionsRequests.next(_)}getResponse(_){return this.updateOptionsResults.asObservable().pipe((0,mu.p)(Q=>Q.identifier===_))}cancelRequest(_){this.cancelRequests.next({identifier:_})}destroy(){this.subscription.unsubscribe()}onNewRequest(_){const{datasource:Q,identifier:me,searchFilter:De}=_;try{const{dispatch:Ce,runRequest:Ne,getTemplatedRegex:_e,getVariable:Qe,queryRunners:st,getTimeSrv:Et,getState:Ct}=this.dependencies,kt=(0,Ps.y7)(Ct());this.updateOptionsResults.next({identifier:me,state:ws.Gu.Loading});const Ut=Qe(me,Ct());if(Ut.type!=="query")return;const Ot=Et(),Wt={variable:Ut,datasource:Q,searchFilter:De,timeSrv:Ot,runRequest:Ne};if(!st.isQueryRunnerAvailableForDatasource(Q)){const Ua=new Error("Query Runner is not available for datasource.");this.updateOptionsResults.next({identifier:me,state:ws.Gu.Error,error:Ua});return}const Sn=st.getRunnerForDatasource(Q),ha=Sn.getTarget({datasource:Q,variable:Ut}),wa=this.getRequest(Ut,_,ha);Sn.runRequest(Wt,wa).pipe((0,mu.p)(()=>{const Ua=(0,Ps.y7)(Ct());return kt===Ua}),(0,mu.p)(Ua=>Ua.state===ws.Gu.Done||Ua.state===ws.Gu.Error),(0,kE.s)(1),(0,Wo.Z)(Ua=>Ua.state===ws.Gu.Error?(0,uh.$)(()=>Ua.error):(0,Fn.of)(Ua)),ey(),ny({variable:Ut,dispatch:Ce,getTemplatedRegexFunc:_e}),ay({variable:Ut,dispatch:Ce,searchFilter:De}),(0,HE.Q)((0,zE.h)(this.updateOptionsRequests,this.cancelRequests).pipe((0,mu.p)(Ua=>{let Na=!1;return Ua.identifier.id===me.id&&(Na=!0,this.updateOptionsResults.next({identifier:me,state:ws.Gu.Loading,cancelled:Na})),Na}))),(0,GE.W)(Ua=>Ua.cancelled?(0,Fn.of)({}):(this.updateOptionsResults.next({identifier:me,state:ws.Gu.Error,error:Ua}),(0,uh.$)(()=>Ua))),(0,jE.j)(()=>{this.updateOptionsResults.next({identifier:me,state:ws.Gu.Done})})).subscribe()}catch(Ce){this.updateOptionsResults.next({identifier:me,state:ws.Gu.Error,error:Ce})}}getRequest(_,Q,me){const{searchFilter:De}=Q,Ce={variable:{text:_.current.text,value:_.current.value}},Qe={...De?{searchFilter:{text:De,value:De}}:{},...Ce},st=this.dependencies.getTimeSrv().timeRange();return{app:Jp.Jk.Dashboard,requestId:(0,jp.A)(),timezone:"",range:st,interval:"",intervalMs:0,targets:[me],scopedVars:Qe,startTime:Date.now()}}}let fh;function fy(F){fh=F}function ep(){return fh}const gy=F=>{if(!py(F))return F.name;const{current:_}=F;return Array.isArray(_.text)?_.text.join(" + "):_.text},py=F=>Array.isArray(F?.options)||typeof F?.current=="object";var Vi=(F=>(F[F.moveUp=38]="moveUp",F[F.moveDown=40]="moveDown",F[F.select=32]="select",F[F.cancel=27]="cancel",F[F.selectAndClose=13]="selectAndClose",F))(Vi||{});class hy extends a.PureComponent{constructor(){super(...arguments),this.onKeyDown=_=>{if(Vi[_.keyCode]&&_.keyCode!==Vi.select){const Q=_.ctrlKey||_.metaKey||_.shiftKey;this.props.onNavigate(_.keyCode,Q),_.preventDefault()}},this.onChange=_=>{this.props.onChange(_.target.value)}}render(){const{value:_,id:Q,onNavigate:me,...De}=this.props;return a.createElement("input",{...De,ref:Ce=>{Ce&&(Ce.focus(),Ce.setAttribute("style",`width:${Math.max(Ce.width,150)}px`))},id:Q,type:"text",className:"gf-form-input",value:_??"",onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:(0,as.t)("variable.dropdown.placeholder","Enter variable value")})}}var vy=e(89963);const Ey=({loading:F,disabled:_,onClick:Q,text:me,onCancel:De,id:Ce})=>{const Ne=(0,Nt.of)(ph),_e=(0,a.useCallback)(Qe=>{Qe.stopPropagation(),Qe.preventDefault(),Q()},[Q]);return F?a.createElement("div",{className:Ne.container,"data-testid":Ns.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${me}`),title:me,id:Ce},a.createElement(gh,{text:me}),a.createElement(vy.I,{loading:!0,onCancel:De})):a.createElement("button",{onClick:_e,className:Ne.container,"data-testid":Ns.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${me}`),"aria-expanded":!1,"aria-controls":`options-${Ce}`,id:Ce,title:me,disabled:_},a.createElement(gh,{text:me}),a.createElement(cs.I,{"aria-hidden":!0,name:"angle-down",size:"sm"}))},gh=({text:F})=>{const _=(0,Nt.of)(ph);return a.createElement("span",{className:_.textAndTags},F===Ar.Zm?(0,as.t)("variable.picker.link-all","All"):F)},ph=F=>({container:(0,ut.css)`
    max-width: 500px;
    padding-right: 10px;
    padding: 0 ${F.spacing(1)};
    background-color: ${F.components.input.background};
    border: 1px solid ${F.components.input.borderColor};
    border-radius: ${F.shape.radius.default};
    display: flex;
    align-items: center;
    color: ${F.colors.text};
    height: ${F.spacing(F.components.height.md)};

    .label-tag {
      margin: 0 5px;
    }

    &:disabled {
      background-color: ${F.colors.action.disabledBackground};
      color: ${F.colors.action.disabledText};
      border: 1px solid ${F.colors.action.disabledBackground};
    }
  `,textAndTags:(0,ut.css)`
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    margin-right: ${F.spacing(.25)};
    user-select: none;
  `});class yy extends a.PureComponent{constructor(){super(...arguments),this.onToggle=_=>Q=>{const me=Q.shiftKey||Q.ctrlKey||Q.metaKey;this.handleEvent(Q),this.props.onToggle(_,me)},this.onToggleAll=_=>{this.handleEvent(_),this.props.onToggleAll()}}handleEvent(_){_.preventDefault(),_.stopPropagation()}render(){const{multi:_,values:Q,highlightIndex:me,selectedValues:De,onToggle:Ce,onToggleAll:Ne,theme:_e,...Qe}=this.props,st=tp(_e);return a.createElement("div",{className:st.variableValueDropdown},a.createElement("div",{className:st.variableOptionsWrapper},a.createElement("ul",{className:st.variableOptionsColumn,"aria-label":Ns.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownDropDown,...Qe},this.renderMultiToggle(),Q.map((Et,Ct)=>this.renderOption(Et,Ct)))))}renderOption(_,Q){const{highlightIndex:me,multi:De,theme:Ce}=this.props,Ne=tp(Ce),_e=_.value===Ar.To;return a.createElement("li",{key:`${_.value}`},a.createElement("button",{"data-testid":Ns.Tp.components.Variables.variableOption,role:"checkbox",type:"button","aria-checked":_.selected,className:(0,ut.cx)((0,fe.my)(Ce),Ne.variableOption,{[Ne.highlighted]:Q===me,[Ne.variableAllOption]:_e},Ne.noStyledButton),onClick:this.onToggle(_)},a.createElement("span",{className:(0,ut.cx)(Ne.variableOptionIcon,{[Ne.variableOptionIconSelected]:_.selected,[Ne.hideVariableOptionIcon]:!De})}),a.createElement("span",{"data-testid":Ns.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(`${_.text}`)},_e?(0,as.t)("variable.picker.option-all","All"):_.text)))}renderMultiToggle(){const{multi:_,selectedValues:Q,theme:me,values:De}=this.props,Ce=tp(me),Ne=De.some(Qe=>Qe.value===Ar.To);if(!_)return null;const _e=()=>a.createElement(as.x6,{i18nKey:"variable.picker.option-tooltip"},"Clear selections");return a.createElement(Zo.m,{content:_e,placement:"top"},a.createElement("button",{className:(0,ut.cx)((0,fe.my)(me),Ce.variableOption,Ce.variableOptionColumnHeader,Ce.noStyledButton,{[Ce.noPaddingBotton]:Ne}),role:"checkbox","aria-checked":Q.length>1?"mixed":"false",onClick:this.onToggleAll,"aria-label":"Toggle all values","data-placement":"top"},a.createElement("span",{className:(0,ut.cx)(Ce.variableOptionIcon,{[Ce.variableOptionIconManySelected]:Q.length>1})}),a.createElement(as.x6,{i18nKey:"variable.picker.option-selected-values"},"Selected")," (",Q.length,")"))}}const tp=(0,Ml.N)(F=>{const _=F.isDark?"public/img/checkbox.png":"public/img/checkbox_white.png";return{hideVariableOptionIcon:(0,ut.css)({display:"none"}),highlighted:(0,ut.css)({backgroundColor:F.colors.action.hover}),noStyledButton:(0,ut.css)({width:"100%",textAlign:"left"}),variableOption:(0,ut.css)({display:"block",padding:"2px 27px 0 8px",position:"relative",whiteSpace:"nowrap",minWidth:"115px","&:hover":{backgroundColor:F.colors.action.hover}}),variableOptionColumnHeader:(0,ut.css)({paddingTop:"5px",paddingBottom:"5px",marginBottom:"5px"}),variableOptionIcon:(0,ut.css)({display:"inline-block",width:"24px",height:"18px",position:"relative",top:"4px",background:`url(${_}) left top no-repeat`}),variableOptionIconManySelected:(0,ut.css)({background:`url(${_}) 0px -36px no-repeat`}),variableOptionIconSelected:(0,ut.css)({background:`url(${_}) 0px -18px no-repeat`}),variableValueDropdown:(0,ut.css)({backgroundColor:F.colors.background.primary,border:`1px solid ${F.colors.border.weak}`,borderRadius:F.shape.borderRadius(2),boxShadow:F.shadows.z2,position:"absolute",top:F.spacing(F.components.height.md),maxHeight:"400px",minHeight:"150px",minWidth:"150px",overflowY:"auto",overflowX:"hidden",zIndex:F.zIndex.typeahead}),variableOptionsColumn:(0,ut.css)({maxHeight:"350px",display:"table-cell",lineHeight:"26px",listStyleType:"none"}),variableOptionsWrapper:(0,ut.css)({display:"table",width:"100%"}),variableAllOption:(0,ut.css)({borderBottom:`1px solid ${F.colors.border.weak}`,paddingBottom:F.spacing(1)}),noPaddingBotton:(0,ut.css)({paddingBottom:0})}}),Dy=(0,Nt.cV)(yy);var Py=e(92053),hh=e(92041),$i=e(56968),_o=e(24300);const by=(F,_,Q)=>async(me,De)=>{if(_===Vi.cancel)return await me(gu(F));if(_===Vi.select)return me(np(F,Q));if(_===Vi.selectAndClose)return(0,Ps.nx)(F,De()).optionsPicker.multi?me(np(F,Q)):(me(np(F,Q,!0)),me(gu(F)));if(_===Vi.moveDown)return me((0,Os.kb)(F,(0,_o.O$)(1)));if(_===Vi.moveUp)return me((0,Os.kb)(F,(0,_o.O$)(-1)))},Cy=(F,_="")=>async(Q,me)=>{const{rootStateKey:De}=F,{id:Ce,queryValue:Ne}=(0,Ps.nx)(De,me()).optionsPicker,_e={id:Ce,rootStateKey:De,type:"query"},Qe=(0,Ps.dn)(_e,me());if(!("options"in Qe)||(Q((0,Os.kb)(De,(0,_o.S8)(_))),(0,f.trim)(Ne)===(0,f.trim)(_)))return;const{query:st,options:Et}=Qe,Ct=typeof st=="string"?st:st.target;return(0,Py.E)(Ct)?xy(Q,me,_,De):Q((0,Os.kb)(De,(0,_o.fx)(Et)))},Ty=async F=>{if((0,hh.R)(F.current))return;await Kc.B.get(F.type).setValue(F,F.current,!0)},gu=(F,_)=>async(Q,me)=>{const De=(0,Ps.nx)(F,me()).optionsPicker,Ce={id:De.id,rootStateKey:F,type:"query"},Ne=(0,Ps.dn)(Ce,me());if(!(0,Mr.SP)(Ne))return;const _e={option:Oy(De)},Qe={propName:"queryValue",propValue:De.queryValue};Q((0,Os.kb)(F,(0,$i.dE)((0,Aa.qD)(Ne,_e)))),Q((0,Os.kb)(F,(0,$i.QP)((0,Aa.qD)(Ne,Qe))));const st=(0,Ps.dn)(Ce,me());if((0,Mr.SP)(st)&&(Q((0,Os.kb)(F,(0,_o.Fu)())),(0,Aa.Lz)(Ne)!==(0,Aa.Lz)(st)))return _?_(st):await Ty(st)},Sy=(F,_)=>async(Q,me)=>{const{id:De,rootStateKey:Ce}=F,Ne=(0,Ps.nx)(Ce,me()).optionsPicker;Ne.id&&Ne.id!==De&&await Q(gu(Ce,_));const _e=(0,Ps.dn)(F,me());(0,Mr.SP)(_e)&&Q((0,Os.kb)(Ce,(0,_o.MO)(_e)))},np=(F,_,Q=!1)=>(me,De)=>{const{highlightIndex:Ce,options:Ne}=(0,Ps.nx)(F,De()).optionsPicker,_e=Ne[Ce];me((0,Os.kb)(F,(0,_o.U9)({option:_e,forceSelect:Q,clearOthers:_})))},My=async(F,_,Q,me)=>{try{const{id:De}=(0,Ps.nx)(me,_()).optionsPicker,Ce={id:De,rootStateKey:me,type:"query"},Ne=(0,Ps.dn)(Ce,_());if(!(0,Mr.SP)(Ne))return;await Kc.B.get(Ne.type).updateOptions(Ne,Q);const Qe=(0,Ps.dn)(Ce,_());if(!(0,Mr.SP)(Qe))return;F((0,Os.kb)(me,(0,_o.qh)(Qe.options)))}catch(De){console.error(De)}},xy=(0,f.debounce)(My,500);function Oy(F){const{options:_,selectedValues:Q,queryValue:me,multi:De}=F;if(_.length===0&&me&&me.length>0)return{text:me,value:me,selected:!1};if(!De)return Q.find(_e=>_e.selected);const Ce=[],Ne=[];for(const _e of Q)_e.selected&&(Ce.push(_e.text.toString()),Ne.push(_e.value.toString()));return{value:Ne,text:Ce,selected:!0}}const zc=()=>{const F=Ce=>({...(0,uu.bindActionCreators)({openOptions:Sy,commitChangesToVariable:gu,navigateOptions:by},Ce),filterOrSearchOptions:(Ne,_e="")=>{Ce(Cy(Ne,_e))},toggleAllOptions:Ne=>Ce((0,Os.kb)(Ne.rootStateKey,(0,_o.an)())),toggleOption:(Ne,_e,Qe,st)=>Ce((0,Os.kb)(Ne.rootStateKey,(0,_o.U9)({option:_e,clearOthers:Qe,forceSelect:st})))}),_=(Ce,Ne)=>{const{rootStateKey:_e}=Ne.variable;return _e?{picker:(0,Ps.nx)(_e,Ce).optionsPicker}:(console.error("OptionPickerFactory: variable has no rootStateKey"),{picker:_o.$z})},Q=(0,Ko.connect)(_,F);class me extends a.PureComponent{constructor(){super(...arguments),this.onShowOptions=()=>this.props.openOptions((0,Aa.jX)(this.props.variable),this.props.onVariableChange),this.onHideOptions=()=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.commitChangesToVariable(this.props.variable.rootStateKey,this.props.onVariableChange)},this.onToggleOption=(Ne,_e)=>{((0,Mr.iv)(this.props.variable)&&this.props.variable.multi?this.onToggleMultiValueVariable:this.onToggleSingleValueVariable)(Ne,_e)},this.onToggleSingleValueVariable=(Ne,_e)=>{this.props.toggleOption((0,Aa.jX)(this.props.variable),Ne,_e,!1),this.onHideOptions()},this.onToggleMultiValueVariable=(Ne,_e)=>{this.props.toggleOption((0,Aa.jX)(this.props.variable),Ne,_e,!1)},this.onToggleAllOptions=()=>{this.props.toggleAllOptions((0,Aa.jX)(this.props.variable))},this.onFilterOrSearchOptions=Ne=>{this.props.filterOrSearchOptions((0,Aa.jX)(this.props.variable),Ne)},this.onNavigate=(Ne,_e)=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.navigateOptions(this.props.variable.rootStateKey,Ne,_e)},this.onCancel=()=>{ep().cancelRequest((0,Aa.jX)(this.props.variable))}}render(){const{variable:Ne,picker:_e}=this.props,Qe=_e.id===Ne.id;return a.createElement("div",{className:"variable-link-wrapper"},Qe?this.renderOptions(_e):this.renderLink(Ne))}renderLink(Ne){const _e=gy(Ne),Qe=Ne.state===ws.Gu.Loading;return a.createElement(Ey,{id:Ar.qz+Ne.id,text:_e,onClick:this.onShowOptions,loading:Qe,onCancel:this.onCancel,disabled:this.props.readOnly})}renderOptions(Ne){const{id:_e}=this.props.variable;return a.createElement(_E.N,{onClick:this.onHideOptions},a.createElement(hy,{id:Ar.qz+_e,value:Ne.queryValue,onChange:this.onFilterOrSearchOptions,onNavigate:this.onNavigate,"aria-expanded":!0,"aria-controls":`options-${_e}`}),a.createElement(Dy,{values:Ne.options,onToggle:this.onToggleOption,onToggleAll:this.onToggleAllOptions,highlightIndex:Ne.highlightIndex,multi:Ne.multi,selectedValues:Ne.selectedValues,id:`options-${_e}`}))}}const De=Q(me);return De.displayName="OptionsPicker",De};var Iy=e(95802);class Ay extends a.PureComponent{constructor(){super(...arguments),this.onChange=_=>{this.props.onPropChange({propName:"query",propValue:_.currentTarget.value,updateOptions:!0})}}render(){return a.createElement(Iy.d,{constantValue:this.props.variable.query,onChange:this.onChange})}}const Ry={...Gl.Vg,type:"constant",hide:bl.zL.hideVariable,query:"",current:{},options:[]},vh=(0,ao.Z0)({name:"templating/constant",initialState:$c.j,reducers:{createConstantOptionsFromQuery:(F,_)=>{const Q=(0,Ps.Fs)(F,_.payload.id);Q.type==="constant"&&(Q.options=[{text:Q.query.trim(),value:Q.query.trim(),selected:!1}])}}}),Ly=vh.reducer,{createConstantOptionsFromQuery:By}=vh.actions,Uy=F=>async _=>{const{rootStateKey:Q}=F;await _((0,Os.kb)(Q,By((0,Aa.qD)(F)))),await _((0,lr.kl)(F))},Ny=()=>({id:"constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share.",name:"Constant",initialState:Ry,reducer:Ly,picker:zc(),editor:Ay,dependsOn:()=>!1,setValue:async(F,_,Q=!1)=>{await(0,bs.JD)((0,lr.t9)((0,Aa.jX)(F),_,Q))},setValueFromUrl:async(F,_)=>{await(0,bs.JD)((0,lr.x7)((0,Aa.jX)(F),_))},updateOptions:async F=>{await(0,bs.JD)(Uy((0,Aa.jX)(F)))},getSaveModel:F=>{const{index:_,id:Q,state:me,global:De,current:Ce,options:Ne,rootStateKey:_e,...Qe}=(0,f.cloneDeep)(F);return Qe},getValueForUrl:F=>F.current.value,beforeAdding:F=>{const{current:_,options:Q,query:me,...De}=(0,f.cloneDeep)(F),Ce={selected:!0,text:me,value:me};return{...De,current:Ce,options:[Ce],query:me}}});function wy(F,..._){const Q=(0,Ko.connect)(..._)(F);return me=>a.createElement(Q,{...me,store:bs.M_})}function NP(F,..._){const Q=connect(..._)(F);return me=>React.createElement(Provider,{store},React.createElement(Q,{...me,store}))}var Fy=e(58711);class Wy extends a.PureComponent{constructor(){super(...arguments),this.onSelectionOptionsChange=async({propName:_,propValue:Q})=>{this.props.onPropChange({propName:_,propValue:Q,updateOptions:!0})},this.onQueryChange=_=>{this.props.onPropChange({propName:"query",propValue:_.currentTarget.value,updateOptions:!0})}}render(){return a.createElement(Fy.w,{query:this.props.variable.query,multi:this.props.variable.multi,allValue:this.props.variable.allValue,includeAll:this.props.variable.includeAll,onQueryChange:this.onQueryChange,onMultiChange:_=>this.onSelectionOptionsChange({propName:"multi",propValue:_.currentTarget.checked}),onIncludeAllChange:_=>this.onSelectionOptionsChange({propName:"includeAll",propValue:_.currentTarget.checked}),onAllValueChange:_=>this.onSelectionOptionsChange({propName:"allValue",propValue:_.currentTarget.value})})}}const Ky=(F,_)=>({}),Vy={changeVariableMultiValue:lr.TI},$y=wy(Wy,Ky,Vy),_y={...Gl.Vg,type:"custom",multi:!1,includeAll:!1,allValue:null,query:"",options:[],current:{}},Eh=(0,ao.Z0)({name:"templating/custom",initialState:$c.j,reducers:{createCustomOptionsFromQuery:(F,_)=>{const Q=(0,Ps.Fs)(F,_.payload.id);if(Q.type!=="custom")return;const{includeAll:me}=Q,Ne=(_.payload.data.match(/(?:\\,|[^,])+/g)??[]).map(_e=>{_e=_e.replace(/\\,/g,",");const Qe=/^(.+)\s:\s(.+)$/g.exec(_e)??[];if(Qe.length===3){const[,st,Et]=Qe;return{text:st.trim(),value:Et.trim(),selected:!1}}else return{text:_e.trim(),value:_e.trim(),selected:!1}});me&&Ne.unshift({text:Ar.Zm,value:Ar.To,selected:!1}),Q.options=Ne}}}),zy=Eh.reducer,{createCustomOptionsFromQuery:ky}=Eh.actions,Hy=F=>async(_,Q)=>{const{rootStateKey:me}=F,De=(0,Ps.dn)(F,Q());if(De.type!=="custom")return;const Ce=(0,Oe.w)().replace(De.query);await _((0,Os.kb)(me,ky((0,Aa.qD)(F,Ce)))),await _((0,lr.kl)(F))},Gy=()=>({id:"custom",description:"Define variable values manually",name:"Custom",initialState:_y,reducer:zy,picker:zc(),editor:$y,dependsOn:(F,_)=>(0,Aa.wJ)(F.query,_.name),setValue:async(F,_,Q=!1)=>{await(0,bs.JD)((0,lr.t9)((0,Aa.jX)(F),_,Q))},setValueFromUrl:async(F,_)=>{await(0,bs.JD)((0,lr.x7)((0,Aa.jX)(F),_))},updateOptions:async F=>{await(0,bs.JD)(Hy((0,Aa.jX)(F)))},getSaveModel:F=>{const{index:_,id:Q,state:me,global:De,rootStateKey:Ce,...Ne}=(0,f.cloneDeep)(F);return Ne},getValueForUrl:F=>(0,Aa.ML)(F)?Ar.Zm:F.current.value});var jy=e(98917),Qy=e(80147);const Yy={...Gl.Vg,type:"datasource",current:{},regex:"",options:[],query:"",multi:!1,includeAll:!1,refresh:bl.CO.onDashboardLoad},yh=(0,ao.Z0)({name:"templating/datasource",initialState:$c.j,reducers:{createDataSourceOptions:(F,_)=>{const{sources:Q,regex:me}=_.payload.data,De=[],Ce=(0,Ps.Fs)(F,_.payload.id);if(Ce.type==="datasource"){for(let Ne=0;Ne<Q.length;Ne++){const _e=Q[Ne];(0,Qy._)(Ce.query,_e.meta)&&(Jy(_e,me)&&De.push({text:_e.name,value:_e.uid,selected:!1}),Xy(_e,me)&&De.push({text:"default",value:"default",selected:!1}))}De.length===0&&De.push({text:"No data sources found",value:"",selected:!1}),Ce.includeAll&&De.unshift({text:Ar.Zm,value:Ar.To,selected:!1}),Ce.options=De}}}});function Jy(F,_){return _?_.exec(F.name):!0}function Xy(F,_){return F.isDefault?_?_.exec("default"):!0:!1}const Zy=yh.reducer,{createDataSourceOptions:qy}=yh.actions,eD=(F,_={getDatasourceSrv:i.tR})=>async(Q,me)=>{const{rootStateKey:De}=F,Ce=_.getDatasourceSrv().getList({metrics:!0,variables:!1}),Ne=(0,Ps.dn)(F,me());if(Ne.type!=="datasource")return;let _e;Ne.regex&&(_e=(0,Oe.w)().replace(Ne.regex,void 0,"regex"),_e=(0,Rr.dO)(_e)),Q((0,Os.kb)(De,qy((0,Aa.qD)(F,{sources:Ce,regex:_e})))),await Q((0,lr.kl)(F))},tD=(F,_={getDatasourceSrv:i.tR})=>Q=>{const me=_.getDatasourceSrv().getList({metrics:!0,variables:!0}),De=(0,f.chain)(me).uniqBy("meta.id").map(Ce=>({text:Ce.meta.name,value:Ce.meta.id})).value();De.unshift({text:"",value:""}),Q((0,Os.kb)(F,(0,Pi.BC)({dataSourceTypes:De})))},nD=(F,_)=>{const{variable:{rootStateKey:Q}}=_;if(!Q)return console.error("DataSourceVariableEditor: variable has no rootStateKey"),{extended:eh(Pi.nS)};const{editor:me}=(0,Ps.nx)(Q,F);return{extended:eh(me)}},aD={initDataSourceVariableEditor:tD,changeVariableMultiValue:lr.TI},sD=(0,Ko.connect)(nD,aD);class rD extends a.PureComponent{constructor(){super(...arguments),this.onRegExBlur=_=>{this.props.onPropChange({propName:"regex",propValue:_.currentTarget.value,updateOptions:!0})},this.onSelectionOptionsChange=async({propValue:_,propName:Q})=>{this.props.onPropChange({propName:Q,propValue:_,updateOptions:!0})},this.onMultiChanged=_=>{this.props.changeVariableMultiValue((0,Aa.jX)(this.props.variable),_.currentTarget.checked)},this.onIncludeAllChanged=_=>{this.onSelectionOptionsChange({propName:"includeAll",propValue:_.currentTarget.checked})},this.onAllValueChanged=_=>{this.onSelectionOptionsChange({propName:"allValue",propValue:_.currentTarget.value})},this.getSelectedDataSourceTypeValue=()=>{const{extended:_}=this.props;if(!_?.dataSourceTypes.length)return"";const Q=_.dataSourceTypes.find(De=>De.value===this.props.variable.query);return(Q?Q.value:_.dataSourceTypes[0].value)??""},this.onDataSourceTypeChanged=_=>{this.props.onPropChange({propName:"query",propValue:_.value,updateOptions:!0})}}componentDidMount(){const{rootStateKey:_}=this.props.variable;if(!_){console.error("DataSourceVariableEditor: variable has no rootStateKey");return}this.props.initDataSourceVariableEditor(_)}render(){const{variable:_,extended:Q}=this.props,me=Q?.dataSourceTypes?.length?Q.dataSourceTypes?.map(De=>({value:De.value??"",label:De.text})):[];return a.createElement(jy.y,{query:_.query,regex:_.regex,multi:_.multi,includeAll:_.includeAll,optionTypes:me,onChange:this.onDataSourceTypeChanged,onRegExBlur:this.onRegExBlur,onMultiChange:this.onMultiChanged,onIncludeAllChange:this.onIncludeAllChanged,onAllValueChange:this.onAllValueChanged})}}const oD=sD(rD),iD=()=>({id:"datasource",description:"Enables you to dynamically switch the data source for multiple panels.",name:"Data source",initialState:Yy,reducer:Zy,picker:zc(),editor:oD,dependsOn:(F,_)=>F.regex?(0,Aa.wJ)(F.regex,_.name):!1,setValue:async(F,_,Q=!1)=>{await(0,bs.JD)((0,lr.t9)((0,Aa.jX)(F),_,Q))},setValueFromUrl:async(F,_)=>{await(0,bs.JD)((0,lr.x7)((0,Aa.jX)(F),_))},updateOptions:async F=>{await(0,bs.JD)(eD((0,Aa.jX)(F)))},getSaveModel:F=>{const{index:_,id:Q,state:me,global:De,rootStateKey:Ce,...Ne}=(0,f.cloneDeep)(F);return{...Ne,options:[]}},getValueForUrl:F=>(0,Aa.ML)(F)?Ar.Zm:F.current.value});var lD=e(25304),cD=e(49317);const Dh=a.memo(({onPropChange:F,variable:_})=>{const Q=Ne=>{F({propName:"auto",propValue:Ne.target.checked,updateOptions:!0})},me=Ne=>{F({propName:"query",propValue:Ne.currentTarget.value,updateOptions:!0})},De=Ne=>{F({propName:"auto_count",propValue:Ne.value,updateOptions:!0})},Ce=Ne=>{F({propName:"auto_min",propValue:Ne.currentTarget.value,updateOptions:!0})};return a.createElement(cD.s,{intervals:_.query,autoStepCount:_.auto_count,autoEnabled:_.auto,onAutoCountChanged:De,onIntervalsChange:me,onAutoEnabledChange:Q,onAutoMinIntervalChanged:Ce,autoMinInterval:_.auto_min})});Dh.displayName="IntervalVariableEditor";var dD=e(23989),ap=e(81515);const uD=F=>async _=>{const{rootStateKey:Q}=F;await _((0,Os.kb)(Q,(0,ap.mn)((0,Aa.qD)(F)))),await _(sp(F)),await _((0,lr.kl)(F))},sp=(F,_={calculateInterval:Xp.calculateInterval,getTimeSrv:ti.jG,templateSrv:(0,dD.w)()})=>(Q,me)=>{const De=(0,Ps.dn)(F,me());if(De.type==="interval"&&De.auto){const Ce=_.calculateInterval(_.getTimeSrv().timeRange(),De.auto_count,De.auto_min);_.templateSrv.setGrafanaVariable("$__auto_interval_"+De.name,Ce.interval),_.templateSrv.setGrafanaVariable("$__auto_interval",Ce.interval)}},mD=()=>({id:"interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",name:"Interval",initialState:ap.Ez,reducer:ap.E5,picker:zc(),editor:Dh,dependsOn:()=>!1,setValue:async(F,_,Q=!1)=>{await(0,bs.JD)(sp((0,Aa.jX)(F))),await(0,bs.JD)((0,lr.t9)((0,Aa.jX)(F),_,Q))},setValueFromUrl:async(F,_)=>{await(0,bs.JD)(sp((0,Aa.jX)(F))),await(0,bs.JD)((0,lr.x7)((0,Aa.jX)(F),_))},updateOptions:async F=>{await(0,bs.JD)(uD((0,Aa.jX)(F)))},getSaveModel:F=>{const{index:_,id:Q,state:me,global:De,rootStateKey:Ce,...Ne}=(0,f.cloneDeep)(F);return Ne},getValueForUrl:F=>F.current.value});var fD=e(44890),gD=e(64423),pD=e(12091),hD=e(70766);function vD(F,_,Q){return{next:De=>{if(De.state===ws.Gu.Error){Q.unsubscribe(),_(De.error);return}if(De.state===ws.Gu.Done){Q.unsubscribe(),F();return}},error:De=>{Q.unsubscribe(),_(De)},complete:()=>{Q.unsubscribe(),F()}}}const ED=(F,_)=>async(Q,me)=>{try{const{rootStateKey:De}=F;if(!(0,Aa.sN)(De,me()))return;const Ce=(0,Ps.dn)(F,me());if(Ce.type!=="query")return;(0,Ps.nx)(De,me()).editor.id===Ce.id&&Q((0,Os.kb)(De,(0,Pi.Eo)({errorProp:"update"})));const Ne=await(0,B.l)().get(Ce.datasource??"");await new Promise((_e,Qe)=>{const st=new gD.yU,Et=vD(_e,Qe,st),Ct=ep().getResponse(F).subscribe(Et);st.add(Ct),ep().queueRequest({identifier:F,datasource:Ne,searchFilter:_})})}catch(De){if(De instanceof Error){const Ce=(0,pD.u)(De),{rootStateKey:Ne}=F;throw(0,Ps.nx)(Ne,me()).editor.id===F.id&&Q((0,Os.kb)(Ne,(0,Pi.NY)({errorProp:"update",errorText:Ce.message}))),Ce}}},yD=F=>async(_,Q)=>{const me=(0,Ps.dn)(F,Q());me.type==="query"&&await _(Ph((0,Aa.jX)(me),me.datasource))},Ph=(F,_)=>async(Q,me)=>{try{const{rootStateKey:De}=F,{editor:Ce}=(0,Ps.nx)(De,me()),_e=Zg(Ce)?.dataSource,Qe=await(0,B.l)().get(_??"");_e&&_e.type!==Qe?.type&&Q((0,Os.kb)(De,(0,$i.QP)((0,Aa.qD)(F,{propName:"query",propValue:""}))));const st=await(0,hD.y)(Qe);Q((0,Os.kb)(De,(0,Pi.BC)({dataSource:Qe,VariableQueryEditor:st})))}catch(De){console.error(De)}},DD=(F,_,Q)=>async(me,De)=>{const{rootStateKey:Ce}=F,Ne=(0,Ps.dn)(F,De());if(Ne.type==="query"){if(PD(Ne.name,_)){const _e="Query cannot contain a reference to itself. Variable: $"+Ne.name;me((0,Os.kb)(Ce,(0,Pi.NY)({errorProp:"query",errorText:_e})));return}me((0,Os.kb)(Ce,(0,Pi.Eo)({errorProp:"query"}))),me((0,Os.kb)(Ce,(0,$i.QP)((0,Aa.qD)(F,{propName:"query",propValue:_})))),Q!==void 0?me((0,Os.kb)(Ce,(0,$i.QP)((0,Aa.qD)(F,{propName:"definition",propValue:Q})))):typeof _=="string"&&me((0,Os.kb)(Ce,(0,$i.QP)((0,Aa.qD)(F,{propName:"definition",propValue:_})))),await me((0,lr.mZ)(F))}};function PD(F,_){if(typeof _=="string"&&_.match(new RegExp("\\$"+F+"(/| |$)")))return!0;const Q=bh(_);for(let me in Q)if(Q.hasOwnProperty(me)){const De=Q[me];if(typeof De=="string"&&De.match(new RegExp("\\$"+F+"(/| |$)")))return!0}return!1}function bh(F){return typeof F!="object"||F===null?{query:F}:Object.keys(F).reduce((me,De)=>{const Ce=F[De];if(typeof Ce!="object"||Ce===null)return me[De]=Ce,me;const Ne=bh(Ce);for(let _e in Ne)Ne.hasOwnProperty(_e)&&(me[`${De}_${_e}`]=Ne[_e]);return me},{})}const bD=(F,_)=>{const{rootStateKey:Q}=_.variable;if(!Q)return console.error("QueryVariableEditor: variable has no rootStateKey"),{extended:Zg(Pi.nS)};const{editor:me}=(0,Ps.nx)(Q,F);return{extended:Zg(me)}},CD={initQueryVariableEditor:yD,changeQueryVariableDataSource:Ph,changeQueryVariableQuery:DD,changeVariableMultiValue:lr.TI},TD=(0,Ko.connect)(bD,CD);class SD extends a.PureComponent{constructor(){super(...arguments),this.state={regex:null,tagsQuery:null,tagValuesQuery:null},this.onDataSourceChange=_=>{this.props.onPropChange({propName:"datasource",propValue:_.isDefault?null:(0,Zp.p$)(_)})},this.onLegacyQueryChange=async(_,Q)=>{this.props.variable.query!==_&&this.props.changeQueryVariableQuery((0,Aa.jX)(this.props.variable),_,Q)},this.onQueryChange=async _=>{if(this.props.variable.query!==_){let Q="";_&&_.hasOwnProperty("query")&&typeof _.query=="string"&&(Q=_.query),this.props.changeQueryVariableQuery((0,Aa.jX)(this.props.variable),_,Q)}},this.onRegExBlur=async _=>{const Q=_.currentTarget.value;this.props.variable.regex!==Q&&this.props.onPropChange({propName:"regex",propValue:Q,updateOptions:!0})},this.onRefreshChange=_=>{this.props.onPropChange({propName:"refresh",propValue:_})},this.onSortChange=async _=>{this.props.onPropChange({propName:"sort",propValue:_.value,updateOptions:!0})},this.onMultiChange=_=>{this.props.onPropChange({propName:"multi",propValue:_.currentTarget.checked})},this.onIncludeAllChange=_=>{this.props.onPropChange({propName:"includeAll",propValue:_.currentTarget.checked})},this.onAllValueChange=_=>{this.props.onPropChange({propName:"allValue",propValue:_.currentTarget.value})}}async componentDidMount(){await this.props.initQueryVariableEditor((0,Aa.jX)(this.props.variable))}componentDidUpdate(_){_.variable.datasource!==this.props.variable.datasource&&this.props.changeQueryVariableDataSource((0,Aa.jX)(this.props.variable),this.props.variable.datasource)}render(){const{extended:_,variable:Q}=this.props;if(!_||!_.dataSource)return null;const me=(0,ti.jG)().timeRange();return a.createElement(fD.u,{datasource:Q.datasource??void 0,onDataSourceChange:this.onDataSourceChange,query:Q.query,onQueryChange:this.onQueryChange,onLegacyQueryChange:this.onLegacyQueryChange,timeRange:me,regex:Q.regex,onRegExChange:this.onRegExBlur,sort:Q.sort,onSortChange:this.onSortChange,refresh:Q.refresh,onRefreshChange:this.onRefreshChange,isMulti:Q.multi,includeAll:Q.includeAll,allValue:Q.allValue??"",onMultiChange:this.onMultiChange,onIncludeAllChange:this.onIncludeAllChange,onAllValueChange:this.onAllValueChange})}}const MD=TD(SD),xD=()=>({id:"query",description:"Variable values are fetched from a datasource query",name:"Query",initialState:QE,reducer:ZE,picker:zc(),editor:MD,dependsOn:(F,_)=>(0,Aa.wJ)(F.query,F.datasource?.uid,F.regex,_.name),setValue:async(F,_,Q=!1)=>{await(0,bs.JD)((0,lr.t9)((0,Aa.jX)(F),_,Q))},setValueFromUrl:async(F,_)=>{await(0,bs.JD)((0,lr.x7)((0,Aa.jX)(F),_))},updateOptions:async(F,_)=>{await(0,bs.JD)(ED((0,Aa.jX)(F),_))},getSaveModel:F=>{const{index:_,id:Q,state:me,global:De,queryValue:Ce,rootStateKey:Ne,..._e}=(0,f.cloneDeep)(F);return F.refresh!==bl.CO.never?{..._e,options:[]}:_e},getValueForUrl:F=>(0,Aa.ML)(F)?Ar.Zm:F.current.value}),OD=()=>({id:"system",description:"",name:"system",initialState:{...Gl.Vg,type:"system",hide:bl.zL.hideVariable,skipUrlSync:!0,current:{value:{toString:()=>""}},state:ws.Gu.Done},reducer:F=>F,picker:null,editor:null,dependsOn:()=>!1,setValue:async(F,_,Q=!1)=>{},setValueFromUrl:async(F,_)=>{},updateOptions:async F=>{},getSaveModel:F=>({}),getValueForUrl:F=>""});var ID=e(58975),AD=e(14329);function RD({onPropChange:F,variable:{query:_}}){const Q=(0,a.useCallback)((Ce,Ne)=>{Ce.preventDefault(),F({propName:"originalQuery",propValue:Ce.currentTarget.value,updateOptions:!1}),F({propName:"query",propValue:Ce.currentTarget.value,updateOptions:Ne})},[F]),me=(0,a.useCallback)(Ce=>Q(Ce,!1),[Q]),De=(0,a.useCallback)(Ce=>Q(Ce,!0),[Q]);return a.createElement(a.Fragment,null,a.createElement(ID.Y,null,"Text options"),a.createElement(AD._,{value:_,name:"Default value",placeholder:"default value, if any",onChange:me,onBlur:De,width:30,testId:Ns.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2}))}function LD({variable:F,onVariableChange:_,readOnly:Q}){const me=(0,Vn.useDispatch)(),[De,Ce]=(0,a.useState)(F.current.value);(0,a.useEffect)(()=>{Ce(F.current.value)},[F]);const Ne=(0,a.useCallback)(()=>{if(!F.rootStateKey){console.error("Cannot update variable without rootStateKey");return}if(F.current.value!==De){if(me((0,Os.kb)(F.rootStateKey,(0,$i.QP)((0,Aa.qD)({id:F.id,type:F.type},{propName:"query",propValue:De})))),_){_({...F,current:(0,hh.R)(F.current)?{}:{...F.current,value:De}});return}Kc.B.get(F.type).updateOptions(F)}},[F,De,me,_]),_e=(0,a.useCallback)(Et=>Ce(Et.target.value),[Ce]),Qe=Et=>Ne(),st=Et=>{Et.keyCode===13&&(Et.preventDefault(),Ne())};return a.createElement(Me.p,{type:"text",value:De,onChange:_e,onBlur:Qe,disabled:Q,onKeyDown:st,placeholder:(0,as.t)("variable.textbox.placeholder","Enter variable value"),id:Ar.qz+F.id})}const BD={...Gl.Vg,type:"textbox",query:"",current:{},options:[],originalQuery:null},Ch=(0,ao.Z0)({name:"templating/textbox",initialState:$c.j,reducers:{createTextBoxOptions:(F,_)=>{const Q=(0,Ps.Fs)(F,_.payload.id);if(Q.type!=="textbox")return;const me={text:Q.query.trim(),value:Q.query.trim(),selected:!1};Q.options=[me],Q.current=me}}}),UD=Ch.reducer,{createTextBoxOptions:ND}=Ch.actions,wD=F=>async(_,Q)=>{const{rootStateKey:me,type:De}=F;_((0,Os.kb)(me,ND((0,Aa.qD)(F))));const Ce=(0,Ps.dn)(F,Q());Ce.type==="textbox"&&await Kc.B.get(De).setValue(Ce,Ce.options[0],!0)},FD=(F,_)=>async(Q,me)=>{const{rootStateKey:De}=F,Ce=(0,Ps.dn)(F,me());if(Ce.type!=="textbox")return;const Ne=(0,Aa.QT)(_);Q((0,Os.kb)(De,(0,$i.QP)((0,Aa.qD)(Ce,{propName:"query",propValue:Ne})))),await Q((0,lr.x7)((0,Aa.jX)(Ce),Ne))},WD=()=>({id:"textbox",description:"Define a textbox variable, where users can enter any arbitrary string",name:"Text box",initialState:BD,reducer:UD,picker:LD,editor:RD,dependsOn:(F,_)=>!1,setValue:async(F,_,Q=!1)=>{await(0,bs.JD)((0,lr.t9)((0,Aa.jX)(F),_,Q))},setValueFromUrl:async(F,_)=>{await(0,bs.JD)(FD((0,Aa.jX)(F),_))},updateOptions:async F=>{await(0,bs.JD)(wD((0,Aa.jX)(F)))},getSaveModel:(F,_)=>{const{index:Q,id:me,state:De,global:Ce,originalQuery:Ne,rootStateKey:_e,...Qe}=(0,f.cloneDeep)(F);if(F.query!==Ne&&!_){const st=Ne??"",Et={selected:!1,text:st,value:st};return{...Qe,query:st,current:Et,options:[Et]}}return Qe},getValueForUrl:F=>F.current.value,beforeAdding:F=>({...(0,f.cloneDeep)(F),originalQuery:F.query})});var KD=e(10378),rp=e(55314),op=e(72686),ip=e(59120),VD=e(91219);const $D={navBarTree:VD.I_,navIndex:Ui._h,appNotifications:Jd.g5};var _D=e(44672),To=e(88467),So=e(23770);const zD=(0,uu.combineReducers)({dataSources:(0,To.Xw)("dataSources",So.DC,({rulesSourceName:F})=>F).reducer,promRules:(0,To.Xw)("promRules",So.mB,({rulesSourceName:F})=>F).reducer,rulerRules:(0,To.Xw)("rulerRules",So.eB,({rulesSourceName:F})=>F).reducer,ruleForm:(0,uu.combineReducers)({saveRule:(0,To.J7)("saveRule",So._$).reducer}),grafanaNotifiers:(0,To.J7)("grafanaNotifiers",So.mF).reducer,saveAMConfig:(0,To.J7)("saveAMConfig",So.RW).reducer,deleteAMConfig:(0,To.J7)("deleteAMConfig",So.nO).reducer,folders:(0,To.Xw)("folders",So.Tp,F=>F).reducer,amAlertGroups:(0,To.Xw)("amAlertGroups",So.D3,F=>F).reducer,testReceivers:(0,To.J7)("testReceivers",So.bO).reducer,updateLotexNamespaceAndGroup:(0,To.J7)("updateLotexNamespaceAndGroup",So.LU).reducer,managedAlertStateHistory:(0,To.J7)("managedAlertStateHistory",So.JH).reducer});var kD=e(55907);const HD={items:[],searchQuery:"",isLoading:!1},GD={notificationChannelTypes:[],notificationChannel:{},notifiers:[]};function jD(F,_){const Q=kD.A.getStateDisplayModel(_),me={...F,stateText:Q.text,stateIcon:Q.iconClass,stateClass:Q.stateClass,stateAge:(0,g.KQ)(F.newStateDate).fromNow(!0)};return me.state!=="paused"&&(me.executionError&&(me.info="Execution Error: "+me.executionError),me.evalData&&me.evalData.noData&&(me.info="Query returned no data")),me}const Th=(0,ao.Z0)({name:"alertRules",initialState:HD,reducers:{loadAlertRules:F=>({...F,isLoading:!0}),loadedAlertRules:(F,_)=>{const me=_.payload.map(De=>jD(De,De.state));return{...F,items:me,isLoading:!1}},setSearchQuery:(F,_)=>({...F,searchQuery:_.payload})}}),Sh=(0,ao.Z0)({name:"notificationChannel",initialState:GD,reducers:{setNotificationChannels:(F,_)=>({...F,notificationChannelTypes:ZD(_.payload),notifiers:_.payload}),notificationChannelLoaded:(F,_)=>{const Q=_.payload,De=F.notifiers.find(Ce=>Ce.type===Q.type).options.filter(Ce=>Ce.secure);return De.length>0&&De.some(Ce=>Q.settings[Ce.propertyName]!=="")?XD(F,_.payload,De):{...F,notificationChannel:Q}},resetSecureField:(F,_)=>({...F,notificationChannel:{...F.notificationChannel,secureFields:{...F.notificationChannel.secureFields,[_.payload]:!1}}})}}),{loadAlertRules:FP,loadedAlertRules:WP,setSearchQuery:KP}=Th.actions,{setNotificationChannels:VP,notificationChannelLoaded:$P,resetSecureField:_P}=Sh.actions,QD=Th.reducer,YD=Sh.reducer,JD={alertRules:QD,notificationChannel:YD,unifiedAlerting:zD};function XD(F,_,Q){const me={},De={};return Q.forEach(Ce=>{De[Ce.propertyName]=_.settings[Ce.propertyName],me[Ce.propertyName]=""}),{...F,notificationChannel:{..._,settings:{..._.settings,...me},secureSettings:{...De}}}}function ZD(F){return F.map(_=>({value:_.type,label:_.name,..._,typeName:_.type})).sort((_,Q)=>_.name>Q.name?1:-1)}var qD=e(93584),eP=e(20604),tP=e(79763),nP=e(53466),aP=e(28601),sP=e(36227),rP=e(54650),oP=e(40823),iP=e(88264),lP=e(10943),cP=e(80095),dP=e(31326),uP=e(81862),mP=e(1936),fP=e(8212),gP=e(34655),pP=e(87617),lp=e(82537),hP=e(97007);const vP={...$D,...JD,...gP.Ay,...qD.Ay,...rP.Ay,...aP.Ay,...Vp.Ay,...sP.Ay,...pP.Ay,...mP.Ay,...uP.Ay,...oP.Ay,...lP.Ay,...tP.Ay,..._D.Ay,...iP.Ay,...nP.Ay,...cP.Ay,...Os.Ay,...fP.Ay,...eP.Ay,plugins:dP.Ff,[Ll.H.reducerPath]:Ll.H.reducer,[op.Sm.reducerPath]:op.Sm.reducer,[rp.cU.reducerPath]:rp.cU.reducer,[ip.O5.reducerPath]:ip.O5.reducer,[lp.g.reducerPath]:lp.g.reducer},Mh={},zP=F=>{Object.assign(Mh,F)},EP=()=>{const F=(0,uu.combineReducers)({...vP,...Mh});return(_,Q)=>{if(Q.type!==hP.N.type)return F(_,Q);const{cleanupAction:me}=Q.payload;return me(_),F(_,Q)}};function kP(F){addReducer(F)}const yP=(0,ao.Nc)(),xh=[];function HP(F){xh.push(F)}function DP(F){const _=(0,ao.U1)({reducer:EP(),middleware:Q=>Q({thunk:!0,serializableCheck:!1,immutableCheck:!1}).concat(yP.middleware,Ll.H.middleware,op.Sm.middleware,rp.cU.middleware,ip.O5.middleware,lp.g.middleware,...xh),devTools:!1,preloadedState:{navIndex:(0,Ui.s2)(),...F}});return(0,KD.$k)(_.dispatch),(0,bs.k3)(_),_}P().move=J.b;const Oh=e(39572),pu=Oh.keys().map(F=>Oh(F));class PP{async init(){try{parent.postMessage("GrafanaAppInit","*");const _=(0,as.JL)(H.Ay.bootData.user.language);_.then(({language:st})=>(0,H._R)({language:st})),(0,S.u5)(Yg.IB),TP(),$v(),(0,Hl.j)("frontend_app_init"),H.Ay.featureToggles.betterPageScrolling||SP(),(0,g.xS)(H.Ay.bootData.user.locale),(0,g.$D)(H.Ay.bootData.user.weekStart),(0,K.Y)(w0.m),(0,k.l)(Gr),(0,V.e)(N0.a),(0,O.T)(x.Ny),(0,b.p)(D0),(0,h.G)(()=>H.Ay.bootData.user.timezone),U0(),(0,y0.initAuthConfig)(),(0,M.H8)(tr.A),await _,bP(),DP(),CP(),E0(),D.D.setInit(tu.H),D.G.setInit(tu.u),v.h.setInit(yu),Kc.B.setInit(()=>[xD(),Gy(),WD(),Ny(),iD(),mD(),$E(),OD()]),C.l.setInit(jc),_v(),(0,A.HC)(()=>new mE),fy(new my),(0,A.pC)(Xg.BN),(0,R.se)({importPanelPlugin:Qp.TV,getPanelPluginFromCache:Qp.PY}),T.I.initialize({config:H.Ay,getTimeRangeForUrl:(0,ti.jG)().timeRangeForUrl,getVariablesUrlParams:lD.z}),document.addEventListener("click",zv);const Q=new i.xq;Q.init(H.Ay.datasources,H.Ay.defaultDatasource),(0,B.h)(Q),gE();const me=new sE;if(me.register({pluginId:"grafana",extensionConfigs:$0()}),Ls.TP.user.orgRole!==""){const st=["cloud-home-app"],Et=Object.values(H.Ay.apps).filter(kt=>st.includes(kt.id)),Ct=Object.values(H.Ay.apps).filter(kt=>!st.includes(kt.id));Yp(Ct,me),await Yp(Et,me,"frontend_awaited_plugins_preload")}(0,U.cE)(X0(me)),(0,W.Vu)(iE(me)),(0,N.A)(oE(me));const De=x.Ny.getSearchObject(),Ce=new Kf,Ne=new p0(x.Ny,Ce),_e=new Hv;_e.start(),Ce.setKioskModeFromUrl(De.kiosk);try{(0,pE.W1)()}catch(st){console.warn("Failed to clean up old expanded folders",st)}this.context={backend:Yg.IB,location:x.Ny,chrome:Ce,keybindings:Ne,newAssetsChecker:_e,config:H.Ay},(0,w._)(bo.ni),(0,E.H)(document.getElementById("reactRoot")).render(a.createElement(Dg,{app:this}))}catch(_){console.error("Failed to start Grafana",_),window.__grafana_load_failed()}finally{(0,Hl.z)("frontend_app_init")}}}function bP(){pu.length>0&&pu[0].addExtensionReducers()}function CP(){pu.length>0&&pu[0].init()}function TP(){(0,L.H2)(new Qv({debug:!1})),window.addEventListener("load",F=>{const _="frontend_boot_load_time_seconds";performance&&(performance.mark(_),kc("first-paint","frontend_boot_","_time_seconds"),kc("first-contentful-paint","frontend_boot_","_time_seconds"),kc(_),kc("frontend_boot_js_done_time_seconds"),kc("frontend_boot_css_time_seconds"))}),Ls.TP.user.orgRole!==""&&(0,L.pl)(new Jv({})),H.Ay.grafanaJavascriptAgent.enabled&&(0,L.pl)(new d0({...H.Ay.grafanaJavascriptAgent,app:{version:H.Ay.buildInfo.version,environment:H.Ay.buildInfo.env},buildInfo:H.Ay.buildInfo,user:{id:String(H.Ay.bootData.user?.id),email:H.Ay.bootData.user?.email}})),H.Ay.googleAnalyticsId&&(0,L.pl)(new qv({googleAnalyticsId:H.Ay.googleAnalyticsId})),H.Ay.googleAnalytics4Id&&(0,L.pl)(new Zv({googleAnalyticsId:H.Ay.googleAnalytics4Id,googleAnalytics4SendManualPageViews:H.Ay.googleAnalytics4SendManualPageViews})),H.Ay.rudderstackWriteKey&&H.Ay.rudderstackDataPlaneUrl&&(0,L.pl)(new e0({writeKey:H.Ay.rudderstackWriteKey,dataPlaneUrl:H.Ay.rudderstackDataPlaneUrl,user:H.Ay.bootData.user,sdkUrl:H.Ay.rudderstackSdkUrl,configUrl:H.Ay.rudderstackConfigUrl,integrationsUrl:H.Ay.rudderstackIntegrationsUrl,buildInfo:H.Ay.buildInfo})),H.Ay.applicationInsightsConnectionString&&(0,L.pl)(new Xv({connectionString:H.Ay.applicationInsightsConnectionString,endpointUrl:H.Ay.applicationInsightsEndpointUrl}))}function SP(){(0,j.X)()>0&&document.body.classList.add("no-overlay-scrollbar")}function kc(F,_="",Q=""){const me=P().first(performance.getEntriesByName(F));if(me){const De=me.name.replace(/-/g,"_");(0,Yv.n)(`${_}${De}${Q}`,Math.round(me.startTime)/1e3)}}const MP=new PP;window.public_cdn_path&&(e.p=window.public_cdn_path),window.__grafana_public_path__=e.p.substring(0,e.p.lastIndexOf("build/"))||e.p,window.nonce&&(e.nc=window.nonce),window.__grafana_app_bundle_loaded=!0,MP.init()},60021:(G,I,e)=>{"use strict";e.d(I,{Or:()=>n,Oz:()=>o,RC:()=>t,ho:()=>s,nA:()=>r});var t=(m=>(m.Active="active",m.Expired="expired",m.Pending="pending",m))(t||{}),n=(m=>(m.Unprocessed="unprocessed",m.Active="active",m.Suppressed="suppressed",m))(n||{}),s=(m=>(m.equal="=",m.notEqual="!=",m.regex="=~",m.notRegex="!~",m))(s||{}),r=(m=>(m.Internal="internal",m.External="external",m.All="all",m))(r||{}),o=(m=>(m.cortex="cortex",m.mimir="mimir",m.prometheus="prometheus",m))(o||{})},91621:(G,I,e)=>{"use strict";e.d(I,{Dw:()=>m,Rx:()=>s,_W:()=>o,d$:()=>n});const t={statistics:[]};var n=(i=>(i[i.Query=1]="Query",i[i.Search=0]="Search",i))(n||{}),s=(i=>(i[i.Builder=0]="Builder",i[i.Code=1]="Code",i))(s||{});const r={parameters:[]};var o=(i=>(i.And="and",i.Function="function",i.FunctionParameter="functionParameter",i.GroupBy="groupBy",i.Operator="operator",i.Or="or",i.Property="property",i))(o||{}),m=(i=>(i.String="string",i))(m||{});const l={logGroupNames:[],logGroups:[],statsGroups:[]}},25640:(G,I,e)=>{"use strict";e.d(I,{Rx:()=>t.Rx,YZ:()=>n,b4:()=>s,d$:()=>t.d$});var t=e(91621),n=(r=>(r.Scheduled="Scheduled",r.Running="Running",r.Complete="Complete",r.Failed="Failed",r.Cancelled="Cancelled",r.Timeout="Timeout",r))(n||{}),s=(r=>(r.Regions="regions",r.Namespaces="namespaces",r.Metrics="metrics",r.DimensionKeys="dimensionKeys",r.DimensionValues="dimensionValues",r.EBSVolumeIDs="ebsVolumeIDs",r.EC2InstanceAttributes="ec2InstanceAttributes",r.ResourceArns="resourceARNs",r.Statistics="statistics",r.LogGroups="logGroups",r.Accounts="accounts",r))(s||{})},36666:(G,I,e)=>{"use strict";e.d(I,{A:()=>O});var t=e(32196),n=e(92145),s=e(55127),r=e.n(s),o=e(96540),m=e(16817),l=e(52622),i=e(21103),u=e(40845),d=e(67061),p=e(88575),c=e(21594),y=e(94354),f=e(15292),P=e(62930),a=e(2913),E=e(14792),g=e(24283),h=e(31193),D=e(65160),v=e(45994);function C(b){return JSON.stringify(b)}function T(b,M){let A=M;return window.__grafanaSceneContext&&window.__grafanaSceneContext instanceof g.H$&&(A=window.__grafanaSceneContext.state.editPanel?.state.panelId),b===A}const S=[{label:"All data",value:!1},{label:"Annotations",value:!0,description:"Include annotations as regular data"}];function O({data:b,query:M,onChange:A,onRunQuery:R}){const{value:B}=(0,m.A)(()=>(0,h.tR)().get()),U=(0,o.useMemo)(()=>(0,E.UA)().getCurrent()?.getPanelById(M.panelId??-124134),[M.panelId]),{value:W,loading:N}=(0,m.A)(async()=>{if(!U||!b)return[];const ne=await(0,h.tR)().get(U.datasource);return Promise.all(U.targets.map(async q=>{const ee=q.datasource?await(0,h.tR)().get(q.datasource):ne,z=ee.getQueryDisplayText||C,te=(0,D.E)(b,q.refId)??b;return{refId:q.refId,query:z(q),name:ee.name,img:ee.meta.info.logos.small,data:te.series,error:te.error}}))},[b,U]),w=(0,o.useCallback)(ne=>{A(ne),R()},[A,R]),L=(0,o.useCallback)(ne=>{w({...M,panelId:ne})},[M,w]),V=(0,o.useCallback)(()=>{w({...M,withTransforms:!M.withTransforms})},[M,w]),K=(0,o.useCallback)(ne=>{w({...M,topic:ne?l.QR.Annotations:void 0})},[M,w]),k=(0,o.useCallback)(ne=>{const q=ne.datasource??B,ee=(0,h.tR)().getInstanceSettings(q)?.name,z=ne.targets.length;return`${z} ${r()("query",z)} to ${ee}`},[B]),j=(0,E.UA)().getCurrent(),H=!!(M.withTransforms||U?.transformations?.length),J=(0,o.useMemo)(()=>j?.panels.filter(ne=>a.Ay.panels[ne.type]&&ne.targets&&!T(ne.id,j.panelInEdit?.id)&&ne.datasource?.uid!==v.K).map(ne=>({value:ne.id,label:ne.title??"Panel "+ne.id,description:k(ne),imgUrl:a.Ay.panels[ne.type].info.logos.small}))??[],[j,k]),X=(0,u.of)(x),se=(0,n.Bi)();if(!j)return null;if(J.length<1)return o.createElement("p",{className:X.noQueriesText},"This dashboard does not have any other panels. Add queries to other panels and try again.");const ae=J.find(ne=>ne.value===M.panelId);return o.createElement(i.i,null,o.createElement(d.B,{direction:"column"},o.createElement(d.B,{gap:3},o.createElement(p.D,{label:"Source panel",description:"Use query results from another panel"},o.createElement(c.l6,{inputId:se,placeholder:"Choose panel",isSearchable:!0,options:J,value:ae,onChange:ne=>L(ne.value)})),o.createElement(p.D,{label:"Data",description:"Use data or annotations from the panel"},o.createElement(y.z,{options:S,value:M.topic===l.QR.Annotations,onChange:K})),H&&o.createElement(p.D,{label:"Transform",description:"Apply transformations from the source panel"},o.createElement(f.K,{value:!!M.withTransforms,onChange:V}))),N?o.createElement(P.y,null):o.createElement(o.Fragment,null,W&&!!W.length&&o.createElement(p.D,{label:"Queries from panel"},o.createElement(d.B,{direction:"column"},W.map((ne,q)=>o.createElement(d.B,{key:q,alignItems:"center",gap:1},o.createElement("div",null,ne.refId),o.createElement("img",{src:ne.img,alt:ne.name,title:ne.name,width:16}),o.createElement("div",null,ne.query))))))))}function x(b){return{noQueriesText:(0,t.css)({padding:b.spacing(1.25)})}}},14348:(G,I,e)=>{"use strict";e.d(I,{K:()=>l.K,kN:()=>i,mw:()=>u});var t=e(88483),n=e(52622),s=e(39070),r=e(43127),o=e(14792),m=e(34214),l=e(45994);function i(y){return y?typeof y=="string"?y===l.K:"meta"in y&&y.meta.name===l.K||y.uid===l.K:!1}function u(y,f){return new t.c(P=>{const a=(0,o.UA)().getCurrent(),E=d(y.queries);if(!E){P.next(p("Missing panel reference ID"));return}let g=a?.getPanelById(E,!0);if(g instanceof m.a||(g=new m.a(g)),!g){P.next(p("Unknown Panel: "+E));return}const h=g.getQueryRunner(),D=h.getData({withTransforms:!!f?.withTransforms,withFieldConfig:!1}).subscribe({next:v=>{f?.topic===n.QR.Annotations&&(v={...v,series:v.annotations??[],annotations:void 0}),P.next(v)}});if(!g.isInView&&g.refreshWhenInView||a?.otherPanelInFullscreen(g)){const{datasource:v,targets:C}=g,T={...y,datasource:v,panelId:E,queries:C};g.refreshWhenInView=!1,h.run(T)}return()=>{D.unsubscribe()}})}function d(y){if(!(!y||!y.length))return y[0].panelId}function p(y){return{state:s.Gu.Error,series:[],request:{},error:{message:y},timeRange:(0,r.E2)()}}var c=e(36666)},45994:(G,I,e)=>{"use strict";e.d(I,{K:()=>t});const t="-- Dashboard --",n="dashboard"},90183:(G,I,e)=>{"use strict";e.d(I,{i:()=>pe,o:()=>ve});var t=e(2543),n=e(65474),s=e(62467),r=e(44240),o=e(81160),m=e(89667),l=e(39070),i=e(55004),u=e(37471),d=e(78368),p=e(14236),c=e(26657),y=e(72574),f=e(78731),P=e(17172),a=e(19347),E=e(79056),g=e(14792),h=e(32196),D=e(96540),v=e(40845),C=e(84167),T=e(88575),S=e(21594),O=e(15292),x=e(99818),b=e(10154),M=e(68706),A=e(95093),R=e.n(A),B=e(91410),U=e(20333),W=e(55852),N=e(67061),w=e(17624),L=e(67459),V=e(57389),K=e(14578),k=e(87266),j=e(16797);const H="time-of-day-picker-panel",J=({minuteStep:be=1,showHour:Oe=!0,showSeconds:Me=!1,onChange:Ue,value:we,size:Re="auto",disabled:Fe,disabledHours:xe,disabledMinutes:Ve,disabledSeconds:$e,placeholder:Xe,format:gt="HH:mm",defaultValue:Dt=void 0,allowEmpty:nt=!1,width:at})=>{const Ae=(0,v.of)(se),re=()=>at?(0,h.css)`
        width: ${at}px;
      `:(0,k.lH)()[Re];return D.createElement(V.A,{value:we,defaultValue:Dt,onChange:Z=>Ue(Z),showHour:Oe,showSecond:Me,format:gt,allowEmpty:nt,className:(0,h.cx)(re(),Ae.input),popupClassName:(0,h.cx)(Ae.picker,H),minuteStep:be,inputIcon:D.createElement(X,{wrapperStyle:Ae.caretWrapper}),disabled:Fe,disabledHours:xe,disabledMinutes:Ve,disabledSeconds:$e,placeholder:Xe})},X=({wrapperStyle:be=""})=>D.createElement("div",{className:be},D.createElement(K.I,{name:"angle-down"})),se=be=>{const Oe=be.components.input.background,Me=be.v1.palette.black,Ue=be.colors.background.secondary,we=be.shape.radius.default,Re=be.components.input.borderColor;return{caretWrapper:(0,h.css)`
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      display: inline-block;
      text-align: right;
      color: ${be.colors.text.secondary};
    `,picker:(0,h.css)`
      .rc-time-picker-panel-select {
        font-size: 14px;
        background-color: ${Oe};
        border-color: ${Re};
        li {
          outline-width: 2px;
          &.rc-time-picker-panel-select-option-selected {
            background-color: inherit;
            border: 1px solid ${be.v1.palette.orange};
            border-radius: ${we};
          }

          &:hover {
            background: ${Ue};
          }

          &.rc-time-picker-panel-select-option-disabled {
            color: ${be.colors.action.disabledText};
          }
        }
      }

      .rc-time-picker-panel-inner {
        box-shadow: 0px 4px 4px ${Me};
        background-color: ${Oe};
        border-color: ${Re};
        border-radius: ${we};
        margin-top: 3px;

        .rc-time-picker-panel-input-wrap {
          margin-right: 2px;

          &,
          .rc-time-picker-panel-input {
            background-color: ${Oe};
            padding-top: 2px;
          }
        }

        .rc-time-picker-panel-combobox {
          display: flex;
        }
      }
    `,input:(0,h.css)`
      .rc-time-picker-input {
        background-color: ${Oe};
        border-radius: ${we};
        border-color: ${Re};
        height: ${be.spacing(4)};

        &:focus {
          ${(0,j.focusCss)(be)}
        }

        &:disabled {
          background-color: ${be.colors.action.disabledBackground};
          color: ${be.colors.action.disabledText};
          border: 1px solid ${be.colors.action.disabledBackground};
          &:focus {
            box-shadow: none;
          }
        }
      }

      .rc-time-picker-clear {
        position: absolute;
        right: 20px;
        top: 50%;
        cursor: pointer;
        overflow: hidden;
        transform: translateY(-50%);
        color: ${be.colors.text.secondary};
      }
    `}},ae=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map((be,Oe)=>({label:be,value:Oe+1})),ne=({value:be,onChange:Oe})=>{const Me=(0,v.of)(q),Ue=Date.now(),we=(0,B.QZ)(be.timezone??"utc",Ue),Re=(0,g.UA)().getCurrent()?.getTimezone()===be.timezone,[Fe,xe]=(0,D.useState)(!1),Ve=()=>{xe(!Fe)},$e=Z=>{if(!Z)return;const oe=R()();if(Z){const Ee=Z.split(":");oe.set("hour",parseInt(Ee[0],10)),oe.set("minute",parseInt(Ee[1],10))}return oe},Xe=()=>{let Z="Everyday";return be.fromDayOfWeek&&!be.toDayOfWeek&&(Z=ae[be.fromDayOfWeek-1].label),Z},gt=()=>{const Z=D.createElement(D.Fragment,null,D.createElement(L.U,{title:we?.name}),D.createElement(w.X,{timeZone:be.timezone,timestamp:Ue}));return Re?D.createElement(D.Fragment,null,"Dashboard timezone (",Z,")"):Z},Dt=(Z,oe)=>{const Ee=Z?Z.format("HH:mm"):void 0;Oe(oe==="from"?{...be,from:Ee}:{...be,to:Ee})},nt=Z=>{Oe({...be,timezone:Z})},at=Z=>{const oe=Z?Z.value:void 0,Ee=Z?be.toDayOfWeek:void 0;Oe({...be,fromDayOfWeek:oe,toDayOfWeek:Ee})},Ae=Z=>{Oe({...be,toDayOfWeek:Z?Z.value:void 0})},re=()=>Fe?D.createElement(U.U,{value:be.timezone,includeInternal:!0,onChange:Z=>nt(Z),onBlur:()=>xe(!1),openMenuOnFocus:!1,width:100,autoFocus:!0}):D.createElement("div",{className:Me.timezoneContainer},D.createElement("div",{className:Me.timezone},gt()),D.createElement(W.$n,{variant:"secondary",onClick:Ve,size:"sm"},"Change timezone"));return D.createElement(C.n,{className:Me.wrapper},D.createElement(T.D,{label:"From"},D.createElement(N.B,{gap:.5},D.createElement(S.l6,{options:ae,isClearable:!0,placeholder:"Everyday",value:be.fromDayOfWeek??null,onChange:Z=>at(Z),width:20}),D.createElement(J,{value:$e(be.from),onChange:Z=>Dt(Z,"from"),allowEmpty:!0,placeholder:"HH:mm",width:100}))),D.createElement(T.D,{label:"To"},D.createElement(N.B,{gap:.5},(be.fromDayOfWeek||be.toDayOfWeek)&&D.createElement(S.l6,{options:ae,isClearable:!0,placeholder:Xe(),value:be.toDayOfWeek??null,onChange:Z=>Ae(Z),width:20}),D.createElement(J,{value:$e(be.to),onChange:Z=>Dt(Z,"to"),allowEmpty:!0,placeholder:"HH:mm",width:100}))),D.createElement(T.D,{label:"Timezone"},re()))},q=be=>({wrapper:(0,h.css)({maxWidth:be.spacing(60),marginBottom:be.spacing(2)}),timezoneContainer:(0,h.css)`
      padding: 5px;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
    `,timezone:(0,h.css)`
      margin-right: 5px;
    `}),ee="Enabling this returns annotations that match any of the tags specified below",z=D.createElement("div",null,"Specify a list of tags to match. To specify a key and value tag use `key:value` syntax."),te=[{label:"Dashboard",value:M.St.Dashboard,description:"Query for events created on this dashboard and show them in the panels where they where created"},{label:"Tags",value:M.St.Tags,description:"This will fetch any annotation events that match the tags filter"}],ie=[{label:"Annotations & Alerts",value:M.nj.Annotations,description:"Show annotations or alerts managed by grafana"},{label:"Time regions",value:M.nj.TimeRegions,description:"Configure a repeating time region"}],ce=[10,50,100,200,300,500,1e3,2e3].map(be=>({label:String(be),value:be}));function ue({query:be,onChange:Oe}){const Me=be,{limit:Ue,matchAny:we,tags:Re,type:Fe,queryType:xe}=Me;let Ve=xe??M.nj.Annotations;const $e=(0,D.useMemo)(()=>(0,g.UA)().dashboard?.getTimezone(),[]),Xe=(0,v.of)(fe),gt=Z=>Oe({...Me,type:Z.value}),Dt=Z=>Oe({...Me,limit:Z.value}),nt=Z=>Oe({...Me,matchAny:Z.target.checked}),at=Z=>Oe({...Me,tags:Z}),Ae=Z=>{const oe={...Me,queryType:Z.value};oe.queryType===M.nj.TimeRegions?oe.timeRegion||(oe.timeRegion={timezone:$e}):delete oe.timeRegion,Oe(oe)},re=Z=>{Oe({...Me,timeRegion:Z})};return D.createElement(C.n,{className:Xe.container},D.createElement(T.D,{label:"Query type"},D.createElement(S.l6,{inputId:"grafana-annotations__query-type",options:ie,value:Ve,onChange:Ae})),Ve===M.nj.Annotations&&D.createElement(D.Fragment,null,D.createElement(T.D,{label:"Filter by"},D.createElement(S.l6,{inputId:"grafana-annotations__filter-by",options:te,value:Fe,onChange:gt})),D.createElement(T.D,{label:"Max limit"},D.createElement(S.l6,{inputId:"grafana-annotations__limit",width:16,options:ce,value:Ue,onChange:Dt})),Fe===M.St.Tags&&D.createElement(D.Fragment,null,D.createElement(T.D,{label:"Match any",description:ee},D.createElement(O.d,{id:"grafana-annotations__match-any",value:we,onChange:nt})),D.createElement(T.D,{label:"Tags",description:z},D.createElement(x.$,{allowCustomValue:!0,inputId:"grafana-annotations__tags",onChange:at,tagOptions:b.vy,tags:Re??[]})))),Ve===M.nj.TimeRegions&&Me.timeRegion&&D.createElement(ne,{value:Me.timeRegion,onChange:re}))}const fe=be=>({container:(0,h.css)({maxWidth:be.spacing(60),marginBottom:be.spacing(2)})});var Te=e(11261),he=e(94515);function de(be,Oe,Me,Ue){if(!Oe)return;const we=(0,he.iU)(Oe,Me);if(!we.length)return;const Re=[],Fe=[],xe=[],Ve=Oe.timezone??Ue;for(const $e of we){let Xe=$e.from,gt=$e.to;const Dt=(0,B.QZ)(Ve,Xe);if(Dt){const nt=Dt.offsetInMins*60*1e3;Xe+=nt,gt+=nt}Re.push(Xe),Fe.push(gt),xe.push(be)}return{fields:[{name:"time",type:Te.PU.time,values:Re,config:{}},{name:"timeEnd",type:Te.PU.time,values:Fe,config:{}},{name:"text",type:Te.PU.string,values:xe,config:{}}],length:Re.length}}let le=100;class pe extends c.iy{constructor(Oe){super(Oe),this.annotations={QueryEditor:ue,prepareAnnotation(Me){return Me.target=Me.target??{type:Me.type??M.St.Dashboard,limit:Me.limit??100,tags:Me.tags??[],matchAny:Me.matchAny??!1},Me},prepareQuery(Me){let Ue;if((0,t.isString)(Me.datasource)){const Fe=(0,E.og)(Me.datasource,{returnDefaultAsNull:!1});Fe&&(Ue=Fe)}else Ue=Me.datasource;const{filter:we,...Re}=Me;return{...Re,refId:Me.name,queryType:M.nj.Annotations,datasource:Ue}}}}getDefaultQuery(){return{queryType:M.nj.RandomWalk}}query(Oe){const Me=[],Ue=[],we=(0,y.w)();for(const Re of Oe.targets){if(Re.queryType===M.nj.Annotations)return(0,n.H)(this.getAnnotations({range:Oe.range,rangeRaw:Oe.range.raw,annotation:Re,dashboard:(0,g.UA)().getCurrent()}));if(!Re.hide){if(Re.queryType===M.nj.Snapshot){Me.push((0,s.of)({data:(Re.snapshot??[]).map(Fe=>(0,m.or)(Fe)),state:l.Gu.Done}));continue}if(Re.queryType===M.nj.TimeRegions){const Fe=de("",Re.timeRegion,Oe.range,Oe.timezone);Me.push((0,s.of)({data:Fe?[Fe]:[],state:l.Gu.Done}));continue}if(Re.queryType===M.nj.LiveMeasurements){let Fe=we.replace(Re.channel,Oe.scopedVars);const{filter:xe}=Re,Ve=(0,i.DG)(Fe);if(!(0,i.aj)(Ve))continue;const $e={maxLength:Oe.maxDataPoints??500};Re.buffer?($e.maxDelta=Re.buffer,$e.maxLength=$e.maxLength*2):Oe.rangeRaw?.to==="now"&&($e.maxDelta=Oe.range.to.valueOf()-Oe.range.from.valueOf()),Me.push((0,f.oF)().getDataStream({key:`${Oe.requestId}.${le++}`,addr:Ve,filter:xe,buffer:$e}))}else Re.queryType||(Re.queryType=M.nj.RandomWalk),Ue.push(Re)}}return Ue.length&&Me.push(super.query({...Oe,targets:Ue})),Me.length?Me.length===1?Me[0]:(0,r.h)(...Me):(0,s.of)()}listFiles(Oe,Me){return this.query({targets:[{refId:"A",queryType:M.nj.List,path:Oe}],maxDataPoints:Me}).pipe((0,o.T)(Ue=>{const we=Ue.data[0]??new u.k;return new d.R(we)}))}metricFindQuery(){return Promise.resolve([])}async getAnnotations(Oe){const Me=Oe.annotation.target;if(Me?.queryType===M.nj.TimeRegions){const xe=de(Oe.annotation.name,Me.timeRegion,Oe.range,(0,g.UA)().getCurrent()?.timezone);return Promise.resolve({data:xe?[xe]:[]})}const Ue=Oe.annotation,we=Ue.target,Re={from:Oe.range.from.valueOf(),to:Oe.range.to.valueOf(),limit:we.limit,tags:we.tags,matchAny:we.matchAny};if(we.type===M.St.Dashboard){if(!Oe.dashboard?.uid)return Promise.resolve({data:[]});Re.dashboardUID=Oe.dashboard.uid,delete Re.tags}else{if(!Array.isArray(we.tags)||we.tags.length===0)return Promise.resolve({data:[]});const xe=(0,y.w)(),Ve="__delimiter__",$e=[];for(const Xe of Re.tags){const gt=xe.replace(Xe,{},Dt=>typeof Dt=="string"?Dt:Dt.join(Ve));for(const Dt of gt.split(Ve))$e.push(Dt)}Re.tags=$e}const Fe=await(0,P.AI)().get("/api/annotations",Re,`grafana-data-source-annotations-${Ue.name}-${Oe.dashboard?.uid}`);return{data:[(0,p.Vc)(Fe)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}async function ve(){return await(0,a.l)().get("-- Grafana --")}},68706:(G,I,e)=>{"use strict";e.d(I,{St:()=>r,dx:()=>s,nj:()=>t,uJ:()=>n});var t=(o=>(o.LiveMeasurements="measurements",o.Annotations="annotations",o.Snapshot="snapshot",o.TimeRegions="timeRegions",o.RandomWalk="randomWalk",o.List="list",o.Read="read",o.Search="search",o))(t||{});const n={refId:"A",queryType:"randomWalk"},s={refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:"snapshot",snapshot:[]};var r=(o=>(o.Dashboard="dashboard",o.Tags="tags",o))(r||{})},90478:(G,I,e)=>{"use strict";e.d(I,{H:()=>l,j:()=>u});var t=e(89667),n=e(28138),s=e(57220),r=e(40489),o=e(28444),m=e(68706);function l(d,p){return new Promise(c=>{if(d.datasource?.uid===s.vv){i(p,d),c(!0);return}n.A.publish(new o.bY({title:"Change to panel embedded data",text:"If you want to change the data shown in this panel Grafana will need to remove the panels current query and replace it with a snapshot of the current data. This enables you to edit the data.",yesText:"Continue",icon:"pen",onConfirm:()=>{i(p,d),c(!0)},onDismiss:()=>{c(!1)}}))})}function i(d,p){const c=d.map(f=>(0,t.Nw)(f)),y={refId:"A",queryType:m.nj.Snapshot,snapshot:c,datasource:{uid:s.vv}};p.updateQueries({dataSource:{uid:s.vv},queries:[y]}),p.refresh()}function u(d){return(p,c,y)=>{r.vI(p).subscribe(async f=>{const P=[];f.dataFrames.forEach(a=>{const E=(0,t.Nw)(a);P.push(E)}),d({...m.dx,snapshot:P,file:f.file},c)})}}},71713:(G,I,e)=>{"use strict";e.d(I,{AW:()=>m,Ay:()=>i,RQ:()=>r,dZ:()=>t,fV:()=>o,vB:()=>l});const t=[{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"}],n=[{label:"json",insertText:"json",documentation:"Extracting labels from the log line using json parser."},{label:"regexp",insertText:'regexp ""',documentation:"Extracting labels from the log line using regexp parser.",move:-1},{label:"logfmt",insertText:"logfmt",documentation:"Extracting labels from the log line using logfmt parser."},{label:"pattern",insertText:"pattern",documentation:"Extracting labels from the log line using pattern parser. Only available in Loki 2.3+."},{label:"unpack",insertText:"unpack",detail:"unpack identifier",documentation:'Parses a JSON log line, unpacking all embedded labels in the pack stage. A special property "_entry" will also be used to replace the original log line. Only available in Loki 2.2+.'}],s=[{label:"unwrap",insertText:"unwrap",detail:"unwrap identifier",documentation:"Take labels and use the values as sample data for metric aggregations."},{label:"label_format",insertText:"label_format",documentation:"Use to rename, modify or add labels. For example, | label_format foo=bar ."},{label:"line_format",insertText:"line_format",documentation:'Rewrites log line content. For example, | line_format "{{.query}} {{.duration}}" .'}],r=[{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average of all values in the specified interval."},{insertText:"bytes_over_time",label:"bytes_over_time",detail:"bytes_over_time(range-vector)",documentation:"Counts the amount of bytes used by each log stream for a given range"},{insertText:"bytes_rate",label:"bytes_rate",detail:"bytes_rate(range-vector)",documentation:"Calculates the number of bytes per second for each stream."},{insertText:"first_over_time",label:"first_over_time",detail:"first_over_time(range-vector)",documentation:"The first of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The last of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum of all values in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the number of entries per second."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}],o=[{insertText:"vector",label:"vector",detail:"vector(scalar)",documentation:"Returns the scalar as a vector with no labels."}],m=[...t,...r,...o],l={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((without|by)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-zA-Z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},"context-pipe":{pattern:/\s\|[^=~]\s?\w*/i,inside:{"pipe-operator":{pattern:/\|/i,alias:"operator"},"pipe-operations":{pattern:new RegExp(`${[...n,...s].map(u=>u.label).join("|")}`,"i"),alias:"keyword"}}},function:new RegExp(`\\b(?:${m.map(u=>u.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=\])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],quote:{pattern:/"(?:\\.|[^\\"])*"/,alias:"string",greedy:!0},backticks:{pattern:/`(?:\\.|[^\\`])*`/,alias:"string",greedy:!0},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:/\s?(\|[=~]?|!=?|<(?:=>?|<|>)?|>[>=]?)\s?/i,punctuation:/[{}(),.]/},i=l},65650:(G,I,e)=>{"use strict";e.d(I,{HD:()=>m,ti:()=>r,U3:()=>n,ie:()=>l,Q$:()=>s});var t=(i=>(i.Builder="builder",i.Code="code",i))(t||{}),n=(i=>(i.Instant="instant",i.Range="range",i.Stream="stream",i))(n||{}),s=(i=>(i.DataSample="dataSample",i.InfiniteScroll="infiniteScroll",i.LogsSample="logsSample",i.LogsVolume="logsVolume",i))(s||{}),r=(i=>(i.Backward="backward",i.Forward="forward",i))(r||{}),o=(i=>(i.Stream="streams",i.Vector="vector",i.Matrix="matrix",i))(o||{}),m=(i=>(i.Indexed="I",i.StructuredMetadata="S",i.Parsed="P",i))(m||{}),l=(i=>(i[i.LabelNames=0]="LabelNames",i[i.LabelValues=1]="LabelValues",i))(l||{})},14678:(G,I,e)=>{"use strict";e.d(I,{N8:()=>h,qM:()=>g,uv:()=>E});var t=e(2543),n=e.n(t),s=e(62467),r=e(65474),o=e(45650),m=e(69862),l=e(81160),i=e(9084),u=e(66847),d=e(93031),p=e(71030),c=e(40187),y=e(39070),f=e(72574),P=e(19347),a=e(12091);const E="-- Mixed --",g=(v,C)=>`mixed-${v}-${C||""}`;class h extends c.mA{constructor(C){super(C)}query(C){const T=C.targets.filter(x=>x.datasource?.uid!==E);if(!T.length)return(0,s.of)({data:[]});const S=(0,t.groupBy)(T,"datasource.uid"),O=[];for(const x in S)O.push(...this.getBatchesForQueries(S[x],C));return O.length?this.batchQueries(O,C):(0,s.of)({data:[]})}getBatchesForQueries(C,T){const S=C[0].datasource,O=[],x=(0,f.w)().replace(S?.uid,T.scopedVars,(b,M)=>{if(!Array.isArray(b))return b;for(const A of b){if(A==="default")continue;const R=(0,P.l)().getInstanceSettings(A);O.push({datasource:(0,P.l)().get(A),queries:(0,t.cloneDeep)(C),scopedVars:{...T.scopedVars,[M.name]:{value:A,text:R?.name}}})}return""});return x!==""&&O.push({datasource:(0,P.l)().get(x),queries:(0,t.cloneDeep)(C),scopedVars:{...T.scopedVars}}),O}batchQueries(C,T){const S=C.filter(this.isQueryable).map((O,x)=>(0,r.H)(O.datasource).pipe((0,m.Z)(b=>{const M=(0,t.cloneDeep)(T);return M.requestId=g(x,M.requestId),M.targets=O.queries,M.scopedVars=O.scopedVars,(0,r.H)(b.query(M)).pipe((0,l.T)(A=>({...A,data:A.data||[],state:y.Gu.Loading,key:g(x,A.key)})),(0,i.$)(),(0,u.W)(A=>(A=(0,a.u)(A),A.message=`${b.name}: ${A.message}`,(0,s.of)([{data:[],state:y.Gu.Error,error:A,key:g(x,M.requestId)}]))))})));return(0,o.p)(S).pipe(D(),(0,l.T)(this.finalizeResponses),(0,d.U)())}testDatasource(){return Promise.resolve({message:"",status:""})}isQueryable(C){return C&&Array.isArray(C.queries)&&C.queries.length>0}finalizeResponses(C){const{length:T}=C;if(T===0)return C;const S=C.find(O=>O.state===y.Gu.Error);return S?C.push(S):C[T-1].state=y.Gu.Done,C}}function D(){return(0,p.T)((v,C)=>C.reduce((T,S)=>(T.push.apply(T,S),T),v),[])}},19071:(G,I,e)=>{"use strict";e.d(I,{cd:()=>k,xw:()=>U});var t=e(37471),n=e(11261);const s={filters:[],groupBy:[]};var r=(ce=>(ce.Done="done",ce.Error="error",ce.Pending="pending",ce.Streaming="streaming",ce))(r||{}),o=(ce=>(ce.Raw="raw",ce.Spans="spans",ce.Traces="traces",ce))(o||{}),m=(ce=>(ce.Intrinsic="intrinsic",ce.Resource="resource",ce.Span="span",ce.Unscoped="unscoped",ce))(m||{});function l(ce){const{nodes:ue,edges:fe}=i(ce),[Te,he]=makeFrames();for(const de of ue)Te.add(de);for(const de of fe)he.add(de);return[Te,he]}function i(ce){const ue=[],fe=[],Te=new DataFrameView(ce),he=u(Te),de=makeSpanMap(le=>{if(le>=ce.length)return;const pe=Te.get(le);return{span:{...pe},id:pe.spanID,parentIds:pe.parentSpanID?[pe.parentSpanID]:[]}});for(let le=0;le<Te.length;le++){const pe=Te.get(le),ve=de[pe.spanID].children.map(Ue=>{const we=de[Ue].span;return[we.startTime,we.startTime+we.duration]}),be=getNonOverlappingDuration(ve),Oe=pe.duration-be,Me=getStats(pe.duration,he,Oe);ue.push({[Fields.id]:pe.spanID,[Fields.title]:pe.serviceName??"",[Fields.subTitle]:pe.operationName,[Fields.mainStat]:Me.main,[Fields.secondaryStat]:Me.secondary,[Fields.color]:Oe/he}),pe.parentSpanID&&de[pe.parentSpanID].span&&fe.push({[Fields.id]:pe.parentSpanID+"--"+pe.spanID,[Fields.target]:pe.spanID,[Fields.source]:pe.parentSpanID})}return{nodes:ue,edges:fe}}function u(ce){let ue=0,fe=1/0;for(let Te=0;Te<ce.length;Te++){const he=ce.get(Te);he.startTime<fe&&(fe=he.startTime),he.startTime+he.duration>ue&&(ue=he.startTime+he.duration)}return ue-fe}const d="traces_service_graph_request_server_seconds_sum",p="traces_service_graph_request_total",c="traces_service_graph_request_failed_total",y="traces_service_graph_request_server_seconds_bucket",f={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:[]},P={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:['status_code="STATUS_CODE_ERROR"']},a={expr:"histogram_quantile(.9, sum(rate(traces_spanmetrics_latency_bucket{}[$__range])) by (le))",params:[]},E='span_kind="SPAN_KIND_SERVER"',g=[d,p,c,y];function h(ce,ue){const fe=v(ce),Te={},he={};return T(fe[p],"total",p,Te,he),T(fe[d],"seconds",d,Te,he),T(fe[c],"failed",c,Te,he),S(Te,he,ue)}function D(){function ce(Te,he){return new MutableDataFrame({name:Te,fields:he,meta:{preferredVisualisationType:"nodeGraph"}})}const ue=ce("Nodes",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.title,type:FieldType.string,config:{displayName:"Service name"},values:[]},{name:Fields.subTitle,type:FieldType.string,config:{displayName:"Service namespace"},values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]},{name:Fields.arc+"success",type:FieldType.number,config:{displayName:"Success",color:{fixedColor:"green",mode:FieldColorModeId.Fixed}},values:[]},{name:Fields.arc+"failed",type:FieldType.number,config:{displayName:"Failed",color:{fixedColor:"red",mode:FieldColorModeId.Fixed}},values:[]}]),fe=ce("Edges",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.source,type:FieldType.string,values:[]},{name:"sourceName",type:FieldType.string,values:[]},{name:"sourceNamespace",type:FieldType.string,values:[]},{name:Fields.target,type:FieldType.string,values:[]},{name:"targetName",type:FieldType.string,values:[]},{name:"targetNamespace",type:FieldType.string,values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]}]);return[ue,fe]}function v(ce){return(ce[0]?.data||[]).reduce((ue,fe)=>{const Te=toDataFrame(fe);return ue[Te.refId??"A"]=new DataFrameView(Te),ue},{})}var C=(ce=>(ce.sourceName="sourceName",ce.sourceNamespace="sourceNamespace",ce.targetName="targetName",ce.targetNamespace="targetNamespace",ce))(C||{});function T(ce,ue,fe,Te,he){if(!ce)return;const de=`Value #${fe}`;for(let le=0;le<ce.length;le++){const pe=ce.get(le),ve=pe.server_service_namespace?`${pe.server_service_namespace}/${pe.server}`:pe.server,be=pe.client_service_namespace?`${pe.client_service_namespace}/${pe.client}`:pe.client,Oe=`${be}_${ve}`;he[Oe]?he[Oe][ue]=(he[Oe][ue]||0)+pe[de]:he[Oe]={target:ve,targetName:pe.server,targetNamespace:pe.server_service_namespace,source:be,sourceName:pe.client,sourceNamespace:pe.client_service_namespace,[ue]:pe[de]},Te[ve]?Te[ve][ue]=(Te[ve][ue]||0)+pe[de]:Te[ve]={name:pe.server,namespace:pe.server_service_namespace,[ue]:pe[de]},Te[be]||(Te[be]={name:pe.client,namespace:pe.client_service_namespace,[ue]:0})}}function S(ce,ue,fe){const[Te,he]=D();for(const de of Object.keys(ce)){const le=ce[de];Te.add({[Fields.id]:de,[Fields.title]:le.name,[Fields.subTitle]:le.namespace,[Fields.mainStat]:le.total?le.seconds/le.total*1e3:Number.NaN,[Fields.secondaryStat]:le.total?Math.round(le.total*100)/100:Number.NaN,[Fields.arc+"success"]:le.total?(le.total-Math.min(le.failed||0,le.total))/le.total:1,[Fields.arc+"failed"]:le.total?Math.min(le.failed||0,le.total)/le.total:0})}for(const de of Object.keys(ue)){const le=ue[de];he.add({[Fields.id]:de,[Fields.source]:le.source,sourceName:le.sourceName,sourceNamespace:le.sourceNamespace,[Fields.target]:le.target,targetName:le.targetName,targetNamespace:le.targetNamespace,[Fields.mainStat]:le.total?le.seconds/le.total*1e3:Number.NaN,[Fields.secondaryStat]:le.total?Math.round(le.total*100)/100:Number.NaN})}return{nodes:Te,edges:he}}function O(ce){if(ce.stringValue)return ce.stringValue;if(ce.boolValue!==void 0)return!!ce.boolValue;if(ce.intValue!==void 0)return Number.parseInt(ce.intValue,10);if(ce.doubleValue)return Number.parseFloat(ce.doubleValue);if(ce.arrayValue){const ue=[];for(const fe of ce.arrayValue.values)ue.push(O(fe));return ue}return""}function x(ce){const ue=[];let fe="OTLPResourceNoServiceName";if(!ce)return{serviceName:fe,serviceTags:ue};for(const Te of ce.attributes)Te.key===SemanticResourceAttributes.SERVICE_NAME&&(fe=Te.value.stringValue||fe),ue.push({key:Te.key,value:O(Te.value)});return{serviceName:fe,serviceTags:ue}}function b(ce){const ue=[];if(ce.attributes)for(const fe of ce.attributes)ue.push({key:fe.key,value:O(fe.value)});return ue}function M(ce){let ue;if(ce.kind){const fe=ce.kind.toString().toLowerCase().split("_");ue=fe.length?fe[fe.length-1]:ce.kind.toString()}return ue}function A(ce){const ue=[];if(ce.links)for(const fe of ce.links){const{traceId:Te,spanId:he}=fe,de=[];if(fe.attributes)for(const le of fe.attributes)de.push({key:le.key,value:O(le.value)});ue.push({traceID:Te,spanID:he,tags:de})}return ue}function R(ce){const ue=[];if(ce.events)for(const fe of ce.events){const Te=[];if(fe.attributes)for(const he of fe.attributes)Te.push({key:he.key,value:O(he.value)});ue.push({fields:Te,timestamp:fe.timeUnixNano/1e6})}return ue}function B(ce,ue=!1){const fe=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"kind",type:FieldType.string,values:[]},{name:"statusCode",type:FieldType.number,values:[]},{name:"statusMessage",type:FieldType.string,values:[]},{name:"instrumentationLibraryName",type:FieldType.string,values:[]},{name:"instrumentationLibraryVersion",type:FieldType.string,values:[]},{name:"traceState",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}});try{for(const he of ce){const{serviceName:de,serviceTags:le}=x(he.resource);for(const pe of he.instrumentationLibrarySpans)for(const ve of pe.spans)fe.add({traceID:ve.traceId.length>16?ve.traceId.slice(16):ve.traceId,spanID:ve.spanId,parentSpanID:ve.parentSpanId||"",operationName:ve.name||"",serviceName:de,kind:M(ve),statusCode:ve.status?.code,statusMessage:ve.status?.message,instrumentationLibraryName:pe.instrumentationLibrary?.name,instrumentationLibraryVersion:pe.instrumentationLibrary?.version,traceState:ve.traceState,serviceTags:le,startTime:ve.startTimeUnixNano/1e6,duration:(ve.endTimeUnixNano-ve.startTimeUnixNano)/1e6,tags:b(ve),logs:R(ve),references:A(ve)})}}catch(he){return console.error(he),{error:{message:"JSON is not valid OpenTelemetry format: "+he},data:[]}}let Te=[fe];return ue&&Te.push(...createGraphFrames(fe)),{data:Te}}function U(ce){let ue={batches:[]},fe={};for(let Te=0;Te<ce.length;Te++){const he=ce.get(Te);fe[he.serviceName]||(fe[he.serviceName]=ue.batches.length,ue.batches.push({resource:{attributes:[],droppedAttributesCount:0},instrumentationLibrarySpans:[{spans:[]}]}));let de=fe[he.serviceName];ue.batches[de].resource.attributes.length===0&&(ue.batches[de].resource.attributes=N(he.serviceTags)),ue.batches[de].instrumentationLibrarySpans[0].instrumentationLibrary||he.instrumentationLibraryName&&(ue.batches[de].instrumentationLibrarySpans[0].instrumentationLibrary={name:he.instrumentationLibraryName,version:he.instrumentationLibraryVersion?he.instrumentationLibraryVersion:""}),ue.batches[de].instrumentationLibrarySpans[0].spans.push({traceId:he.traceID.padStart(32,"0"),spanId:he.spanID,parentSpanId:he.parentSpanID||"",traceState:he.traceState||"",name:he.operationName,kind:W(he.kind),startTimeUnixNano:he.startTime*1e6,endTimeUnixNano:(he.startTime+he.duration)*1e6,attributes:he.tags?N(he.tags):[],droppedAttributesCount:0,droppedEventsCount:0,droppedLinksCount:0,status:L(he),events:V(he.logs),links:K(he.references)})}return ue}function W(ce){let ue;if(ce)switch(ce){case"server":ue="SPAN_KIND_SERVER";break;case"client":ue="SPAN_KIND_CLIENT";break;case"producer":ue="SPAN_KIND_PRODUCER";break;case"consumer":ue="SPAN_KIND_CONSUMER";break;case"internal":ue="SPAN_KIND_INTERNAL";break}return ue}function N(ce){return ce.reduce((ue,fe)=>[...ue,{key:fe.key,value:w(fe)}],[])}function w(ce){if(typeof ce.value=="string")return{stringValue:ce.value};if(typeof ce.value=="boolean")return{boolValue:ce.value};if(typeof ce.value=="number")return ce.value%1===0?{intValue:ce.value}:{doubleValue:ce.value};if(typeof ce.value=="object"&&Array.isArray(ce.value)){const ue=[];for(const fe of ce.value)ue.push(w(fe));return{arrayValue:{values:ue}}}return{stringValue:ce.value}}function L(ce){let ue;return ce.statusCode!==void 0&&(ue={code:ce.statusCode,message:ce.statusMessage?ce.statusMessage:""}),ue}function V(ce){if(!ce||!ce.length)return;let ue=[];for(const fe of ce){let Te={timeUnixNano:fe.timestamp*1e6,attributes:[],droppedAttributesCount:0,name:""};for(const he of fe.fields)Te.attributes.push({key:he.key,value:w(he)});ue.push(Te)}return ue}function K(ce){if(!ce||!ce.length)return;let ue=[];for(const fe of ce){let Te={traceId:fe.traceID,spanId:fe.spanID,attributes:[],droppedAttributesCount:0};if(fe.tags?.length)for(const he of fe.tags)Te.attributes?.push({key:he.key,value:w(he)});ue.push(Te)}return ue}const k="Related profiles";function j(ce,ue,fe=!1){const Te=ce.data[0];if(!Te)return ie;const de=ue?.jsonData?.tracesToProfiles;let le;if(de?.datasourceUid&&(le=getDataSourceSrv().getInstanceSettings(de.datasourceUid)),de&&le){const ve=de.customQuery?de.query:void 0,be={title:k,url:"",internal:{datasourceUid:le.uid,datasourceName:le.name,query:{labelSelector:ve||"{${__tags}}",groupBy:[],profileTypeId:de.profileTypeId??"",queryType:"profile",spanSelector:['${__span.tags["pyroscope.profile.id"]}'],refId:"profile"}},origin:DataLinkConfigOrigin.Datasource};Te.fields.forEach(Oe=>{Oe.name==="tags"&&(Oe.config.links=[be])})}let pe=[...ce.data];return fe&&pe.push(...createGraphFrames(toDataFrame(Te))),{...ce,data:pe}}function H(ce){return{traceID:ce.traceID,startTime:parseInt(ce.startTimeUnixNano,10)/1e6,traceDuration:ce.durationMs,traceService:ce.rootServiceName||"",traceName:ce.rootTraceName||""}}const J=ce=>ce.stringValue?`"${ce.stringValue}"`:""+(ce.intValue||ce.doubleValue||ce.boolValue||'""');function X(ce,ue){return ue.series.map((Te,he)=>{const de={};Te.labels?.forEach(pe=>{de[pe.key]=J(pe.value)});let le=ue.series.length===1?ce:"";return Te.labels&&(Te.labels.length===1?le=J(Te.labels[0].value):le=`{${Te.labels.map(pe=>`${pe.key}=${J(pe.value)}`).join(", ")}}`),createDataFrame({refId:le||`A${he}`,fields:[{name:"time",type:FieldType.time,values:Te.samples.map(pe=>parseInt(pe.timestampMs,10))},{name:le,labels:de,type:FieldType.number,values:Te.samples.map(pe=>pe.value),config:{displayNameFromDS:le}}],meta:{preferredVisualisationType:"graph"}})})}function se(ce,ue,fe){switch(fe){case SearchTableType.Spans:return q(ce,ue);case SearchTableType.Raw:return ae(ce);default:return ne(ce,ue)}}function ae(ce){return[createDataFrame({name:"Raw response",refId:"raw",fields:[{name:"response",type:FieldType.string,values:[JSON.stringify(ce,null,2)]}]})]}function ne(ce,ue){const fe=createDataFrame({name:"Traces",refId:"traces",fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",custom:{width:200},links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:ue.uid,datasourceName:ue.name,query:{query:"${__value.raw}",queryType:"traceql"}}}]}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Service"}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Name"}},{name:"traceDuration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ms",custom:{width:120}}},{name:"nested",type:FieldType.nestedFrames}],meta:{preferredVisualisationType:"table",uniqueRowIdFields:[0]}});return ce?.length?(fe.length=ce.length,ce.sort((Te,he)=>parseInt(he?.startTimeUnixNano,10)/1e6-parseInt(Te?.startTimeUnixNano,10)/1e6).forEach(Te=>{const he=H(Te);fe.fields[0].values.push(he.traceID),fe.fields[1].values.push(he.startTime),fe.fields[2].values.push(he.traceService),fe.fields[3].values.push(he.traceName),fe.fields[4].values.push(he.traceDuration?he.traceDuration:"<1ms"),Te.spanSets?fe.fields[5].values.push(Te.spanSets.map(de=>z(Te,de,ue))):Te.spanSet&&fe.fields[5].values.push([z(Te,Te.spanSet,ue)])}),[fe]):[fe]}function q(ce,ue){const fe={};let Te=!1;ce?.forEach(de=>ee(de).forEach(le=>{le.attributes?.forEach(pe=>{fe[pe.key]={name:pe.key,type:FieldType.string,config:{displayNameFromDS:pe.key}}}),le.spans.forEach(pe=>{pe.name&&(Te=!0),pe.attributes?.forEach(ve=>{fe[ve.key]={name:ve.key,type:FieldType.string,config:{displayNameFromDS:ve.key}}})})}));const he=new MutableDataFrame({name:"Spans",refId:"traces",fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Trace Service",custom:{width:200}}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace Name",custom:{width:200}}},{name:"spanID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:ue.uid,datasourceName:ue.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"name",type:FieldType.string,config:{displayNameFromDS:"Name",custom:{hidden:!Te}}},...Object.values(fe).sort((de,le)=>de.name.localeCompare(le.name)),{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}});return!ce||!ce.length?[he]:(ce.sort((de,le)=>parseInt(le?.startTimeUnixNano,10)/1e6-parseInt(de?.startTimeUnixNano,10)/1e6).forEach(de=>{ee(de).forEach(le=>{le.spans.forEach(pe=>{he.add(te(pe,le,de))})})}),[he])}const ee=ce=>ce.spanSets||(ce.spanSet?[ce.spanSet]:[]),z=(ce,ue,fe)=>{const Te={};let he=!1;ue.attributes?.map(pe=>{Te[pe.key]={name:pe.key,type:FieldType.string,config:{displayNameFromDS:pe.key},values:[]}}),ue.spans.forEach(pe=>{pe.name&&(he=!0),pe.attributes?.forEach(ve=>{Te[ve.key]={name:ve.key,type:FieldType.string,config:{displayNameFromDS:ve.key},values:[]}})});const de=new MutableDataFrame({fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}},values:[]},{name:"spanID",type:FieldType.string,values:[],config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:fe.uid,datasourceName:fe.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"name",type:FieldType.string,values:[],config:{displayNameFromDS:"Name",custom:{hidden:!he}}},...Object.values(Te).sort((pe,ve)=>pe.name.localeCompare(ve.name)),{name:"duration",type:FieldType.number,values:[],config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}}),le=createTheme();for(const pe of de.fields)pe.display=getDisplayProcessor({field:pe,theme:le});return ue.spans.forEach(pe=>{de.add(te(pe,ue,ce))}),de};function te(ce,ue,fe){const Te=parseInt(ce.startTimeUnixNano,10)/1e6,he={traceIdHidden:fe.traceID,traceService:fe.rootServiceName||"",traceName:fe.rootTraceName||"",spanID:ce.spanID,time:Te,duration:parseInt(ce.durationNanos,10),name:ce.name};let de=[];return ue.attributes&&(de=de.concat(ue.attributes)),ce.attributes&&(de=de.concat(ce.attributes)),de.forEach(le=>{(le.value.boolValue||le.value.Value?.bool_value)&&(he[le.key]=le.value.boolValue||le.value.Value?.bool_value),(le.value.doubleValue||le.value.Value?.double_value)&&(he[le.key]=le.value.doubleValue||le.value.Value?.double_value),(le.value.intValue||le.value.Value?.int_value)&&(he[le.key]=le.value.intValue||le.value.Value?.int_value),(le.value.stringValue||le.value.Value?.string_value)&&(he[le.key]=le.value.stringValue||le.value.Value?.string_value)}),he}const ie={data:[new t.k({fields:[{name:"trace",type:n.PU.trace,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}})]}},64861:(G,I,e)=>{"use strict";e.d(I,{nE:()=>r,r6:()=>s,xB:()=>t});var t=(o=>(o[o.AlphaAsc=1]="AlphaAsc",o[o.AlphaDesc=2]="AlphaDesc",o[o.Importance=3]="Importance",o[o.TimeAsc=4]="TimeAsc",o[o.TimeDesc=5]="TimeDesc",o))(t||{}),n=(o=>(o.Current="current",o.RecentChanges="changes",o))(n||{}),s=(o=>(o.Default="default",o.Custom="custom",o))(s||{}),r=(o=>(o.List="list",o.Stat="stat",o))(r||{})},39758:(G,I,e)=>{"use strict";e.d(I,{mn:()=>m,ur:()=>n});var t=e(97706);const n=1,s=2,r=3,o=(l,i,u,d)=>(0,t.h)(i+l*(u+d),6);function m(l,i,u,d,p){let c=1-i,y=u===n?c/(l-1):u===s?c/l:u===r?c/(l+1):0;(isNaN(y)||y===1/0)&&(y=0);let f=u===n?0:u===s?y/2:u===r?y:0,P=i/l,a=(0,t.h)(P,6);if(d==null)for(let E=0;E<l;E++)p(E,o(E,f,P,y),a);else p(d,o(d,f,P,y),a)}},4134:(G,I,e)=>{"use strict";e.d(I,{C$:()=>m,HY:()=>o,Tr:()=>r,ur:()=>s});const t=10,n=4;function s(l,i,u,d,p,c){return l>=u&&l<=p&&i>=d&&i<=c}function r(l,i,u){let d=[];if(l.o.length&&d.push(...l.o.filter(p=>(i==null||p.sidx===i)&&(u==null||p.didx===u))),l.q)for(let p=0;p<l.q.length;p++)d.push(...r(l.q[p],i,u));return d}function o(l,i){return l.x<=i.x+i.w&&l.x+l.w>=i.x&&l.y+l.h>=i.y&&l.y<=i.y+i.h}class m{constructor(i,u,d,p,c=0){this.x=i,this.y=u,this.w=d,this.h=p,this.l=c,this.o=[],this.q=null}split(){let i=this,u=i.x,d=i.y,p=i.w/2,c=i.h/2,y=i.l+1;i.q=[new m(u+p,d,p,c,y),new m(u,d,p,c,y),new m(u,d+c,p,c,y),new m(u+p,d+c,p,c,y)]}quads(i,u,d,p,c){let y=this,f=y.q,P=y.x+y.w/2,a=y.y+y.h/2,E=u<a,g=i<P,h=i+d>P,D=u+p>a;E&&h&&c(f[0]),g&&E&&c(f[1]),g&&D&&c(f[2]),h&&D&&c(f[3])}add(i){let u=this;if(u.q!=null)u.quads(i.x,i.y,i.w,i.h,d=>{d.add(i)});else{let d=u.o;if(d.push(i),d.length>t&&u.l<n){u.split();for(let p=0;p<d.length;p++){let c=d[p];u.quads(c.x,c.y,c.w,c.h,y=>{y.add(c)})}u.o.length=0}}}get(i,u,d,p,c){let y=this,f=y.o;for(let P=0;P<f.length;P++)c(f[P]);y.q!=null&&y.quads(i,u,d,p,P=>{P.get(i,u,d,p,c)})}clear(){this.o.length=0,this.q=null}}},58384:(G,I,e)=>{"use strict";e.d(I,{d:()=>c,l:()=>y});var t=e(2543),n=e.n(t),s=e(96540),r=e(47070),o=e(56323),m=e(52622),l=e(97696),i=e(59796),u=e(12509),d=e(2913),p=e(17516);class c extends s.PureComponent{constructor(){super(...arguments),this.renderComponent=(P,a)=>{const{options:E,fieldConfig:g}=this.props,{value:h,alignmentFactors:D,orientation:v,width:C,height:T,count:S}=P,{field:O,display:x,view:b,colIndex:M}=h,{openMenu:A,targetClassName:R}=a;let B;return b&&(0,t.isNumber)(M)&&(B=b.getFieldDisplayProcessor(M)),s.createElement(l.xE,{value:y(S,g.defaults,x),width:C,height:T,orientation:v,field:O,text:E.text,display:B,theme:d.config.theme2,itemSpacing:this.getItemSpacing(),displayMode:E.displayMode,onClick:A,className:R,alignmentFactors:S>1?D:void 0,showUnfilled:E.showUnfilled,valueDisplayMode:E.valueMode,namePlacement:E.namePlacement})},this.renderValue=P=>{const{value:a,orientation:E}=P,{hasLinks:g,getLinks:h}=a;return g&&h?s.createElement("div",{style:{width:"100%",display:E===r.wV.Vertical?"flex":"initial"}},s.createElement(i.e,{style:{height:"100%"},links:h},D=>this.renderComponent(P,D))):this.renderComponent(P,{})},this.getValues=()=>{const{data:P,options:a,replaceVariables:E,fieldConfig:g,timeZone:h}=this.props;return(0,o.PI)({fieldConfig:g,reduceOptions:a.reduceOptions,replaceVariables:E,theme:d.config.theme2,data:P.series,timeZone:h})}}getItemSpacing(){return this.props.options.displayMode==="lcd"?2:10}getOrientation(){const{options:P,width:a,height:E}=this.props,{orientation:g}=P;return g===r.wV.Auto?a>E?r.wV.Vertical:r.wV.Horizontal:g}calcBarSize(){const{options:P}=this.props,a=this.getOrientation(),E=P.sizing===m.T6.Manual,g=a===r.wV.Vertical,h=a===r.wV.Horizontal,D=E&&g?P.minVizWidth:p.K.minVizWidth,v=E&&h?P.minVizHeight:p.K.minVizHeight,C=E&&h?P.maxVizHeight:p.K.maxVizHeight;return{minVizWidth:D,minVizHeight:v,maxVizHeight:C}}render(){const{height:P,width:a,options:E,data:g,renderCounter:h}=this.props,{minVizWidth:D,minVizHeight:v,maxVizHeight:C}=this.calcBarSize();return s.createElement(u.S,{source:g,getAlignmentFactors:o.XS,getValues:this.getValues,renderValue:this.renderValue,renderCounter:h,width:a,height:P,maxVizHeight:C,minVizWidth:D,minVizHeight:v,itemSpacing:this.getItemSpacing(),orientation:E.orientation})}}function y(f,P,a){return f===1&&!P.displayName?{...a,title:void 0}:a}},17516:(G,I,e)=>{"use strict";e.d(I,{K:()=>n});var t=e(52622);const n={displayMode:t.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:t.TZ.Auto,showUnfilled:!0,sizing:t.T6.Auto,valueMode:t.$l.Color}},14738:(G,I,e)=>{"use strict";e.r(I),e.d(I,{plugin:()=>v});var t=e(65158),n=e(52622),s=e(71242),r=e(23799),o=e(63250);const m=C=>(0,o._$)(C),l=(C,T,S)=>{const O=(0,o.gl)(C,T,S);if(T==="singlestat"&&S.angular){const x=S.angular.gauge;x&&(O.showThresholdMarkers=x.thresholdMarkers,O.showThresholdLabels=x.thresholdLabels)}return O};var i=e(96540),u=e(57875),d=e(56323),p=e(95164),c=e(59796),y=e(12509),f=e(2913),P=e(58384);const a={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:n.T6.Auto};class E extends i.PureComponent{constructor(){super(...arguments),this.renderComponent=(T,S)=>{const{options:O,fieldConfig:x}=this.props,{width:b,height:M,count:A,value:R}=T,{field:B,display:U}=R,{openMenu:W,targetClassName:N}=S;return i.createElement(p._,{value:(0,P.l)(A,x.defaults,U),width:b,height:M,field:B,text:O.text,showThresholdLabels:O.showThresholdLabels,showThresholdMarkers:O.showThresholdMarkers,theme:f.config.theme2,onClick:W,className:N,orientation:O.orientation})},this.renderValue=T=>{const{value:S}=T,{getLinks:O,hasLinks:x}=S;return x&&O?i.createElement(c.e,{links:O,style:{flexGrow:1}},b=>this.renderComponent(T,b)):this.renderComponent(T,{})},this.getValues=()=>{const{data:T,options:S,replaceVariables:O,fieldConfig:x,timeZone:b}=this.props;for(let M of T.series)for(let A of M.fields)if(A.config.unit==="percent"||A.config.unit==="percentunit"){const R=A.config.min??0,B=A.config.max??(A.config.unit==="percent"?100:1);A.state=A.state??{},A.state.range={min:R,max:B,delta:B-R},A.display=(0,u.J)({field:A,theme:f.config.theme2})}return(0,d.PI)({fieldConfig:x,reduceOptions:S.reduceOptions,replaceVariables:O,theme:f.config.theme2,data:T.series,timeZone:b})},this.calculateGaugeSize=()=>{const{options:T}=this.props,S=T.orientation,O=T.sizing===n.T6.Manual,x=S===n.wV.Vertical,b=S===n.wV.Horizontal,M=O&&x?T.minVizWidth:a.minVizWidth,A=O&&b?T.minVizHeight:a.minVizHeight;return{minVizWidth:M,minVizHeight:A}}}render(){const{height:T,width:S,data:O,renderCounter:x,options:b}=this.props,{minVizHeight:M,minVizWidth:A}=this.calculateGaugeSize();return i.createElement(y.S,{getValues:this.getValues,renderValue:this.renderValue,width:S,height:T,source:O,autoGrid:!0,renderCounter:x,orientation:b.orientation,minVizHeight:M,minVizWidth:A})}}var g=e(50082),h=e(38824);class D{getSuggestionsForData(T){const{dataSummary:S}=T;if(!S.hasData||!S.hasNumberField||S.numberFieldCount>=50)return;const O=T.getListAppender({name:h.m.Gauge,pluginId:"gauge",options:{},fieldConfig:{defaults:{thresholds:{steps:[{value:-1/0,color:"green"},{value:70,color:"orange"},{value:85,color:"red"}],mode:g.O.Percentage},custom:{}},overrides:[]},cardOptions:{previewModifier:x=>{x.options.reduceOptions.values&&(x.options.reduceOptions.limit=2)}}});S.hasStringField&&S.frameCount===1&&S.rowCountTotal<10?(O.append({name:h.m.Gauge,options:{reduceOptions:{values:!0,calcs:[]}}}),O.append({name:h.m.GaugeNoThresholds,options:{reduceOptions:{values:!0,calcs:[]},showThresholdMarkers:!1}})):(O.append({name:h.m.Gauge,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),O.append({name:h.m.GaugeNoThresholds,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},showThresholdMarkers:!1}}))}}const v=new t.m(E).useFieldConfig({useCustomConfig:C=>{C.addNumberInput({path:"neutral",name:"Neutral",description:"Leave empty to use Min as neutral point",category:["Gauge"],settings:{placeholder:"auto"}})}}).setPanelOptions(C=>{(0,r.L)(C),(0,r.h)(C),C.addBooleanSwitch({path:"showThresholdLabels",name:"Show threshold labels",description:"Render the threshold values around the gauge bar",defaultValue:a.showThresholdLabels}).addBooleanSwitch({path:"showThresholdMarkers",name:"Show threshold markers",description:"Renders the thresholds as an outer bar",defaultValue:a.showThresholdMarkers}).addRadio({path:"sizing",name:"Gauge size",settings:{options:[{value:n.T6.Auto,label:"Auto"},{value:n.T6.Manual,label:"Manual"}]},defaultValue:a.sizing,showIf:T=>T.orientation!==n.wV.Auto}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:a.minVizWidth,settings:{min:0,max:600,step:1},showIf:T=>T.sizing===n.T6.Manual&&T.orientation===n.wV.Vertical}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:a.minVizHeight,settings:{min:0,max:600,step:1},showIf:T=>T.sizing===n.T6.Manual&&T.orientation===n.wV.Horizontal}),s.I(C)}).setPanelChangeHandler(l).setSuggestionsSupplier(new D).setMigrationHandler(m)},19743:(G,I,e)=>{"use strict";e.d(I,{x:()=>r});var t=e(96540),n=e(1173),s=e(74668);const r=({value:o,context:m,onChange:l})=>{const i=(0,t.useCallback)(u=>{l(u?.length?{id:n.jR.byRefId,options:u}:void 0)},[l]);return t.createElement(s.X,{value:o?.options,onChange:i,data:m.data,placeholder:"Change filter"})}},33744:(G,I,e)=>{"use strict";e.d(I,{DY:()=>r,G4:()=>l,Sq:()=>u,T5:()=>i,W_:()=>n,_7:()=>s,fX:()=>o,wq:()=>m,yQ:()=>d,yu:()=>p});var t=e(52622),n=(c=>(c.Point="point",c.Line="line",c.Polygon="polygon",c.Any="*any*",c))(n||{});const s=5;var r=(c=>(c.Left="left",c.Center="center",c.Right="right",c))(r||{}),o=(c=>(c.Top="top",c.Middle="middle",c.Bottom="bottom",c))(o||{}),m=(c=>(c.Left="left",c.Center="center",c.Right="right",c))(m||{}),l=(c=>(c.Top="top",c.Center="center",c.Bottom="bottom",c))(l||{});const i=Object.freeze({size:{fixed:s,min:2,max:15},color:{fixed:"dark-green"},opacity:.4,symbol:{mode:t.q_.Fixed,fixed:"img/icons/marker/circle.svg"},symbolAlign:{horizontal:"center",vertical:"center"},textConfig:{fontSize:12,textAlign:"center",textBaseline:"middle",offsetX:0,offsetY:0},rotation:{fixed:0,mode:t.WQ.Mod,min:-360,max:360}});var u=(c=>(c.color="fill",c.opacity="fill-opacity",c.lineWidth="stroke-width",c))(u||{}),d=(c=>(c.color="marker-color",c.size="marker-size",c))(d||{}),p=(c=>(c.color="stroke",c.lineWidth="stroke-width",c))(p||{})},61994:(G,I,e)=>{"use strict";e.d(I,{A:()=>r});var t=e(32196),n=e(96540),s=e(5636);const r=o=>(0,s.gU)(o)?n.createElement("a",{href:o,target:"_blank",className:(0,t.cx)("external-link"),rel:"noreferrer"},o):o},5636:(G,I,e)=>{"use strict";e.d(I,{Bz:()=>c,G_:()=>i,cA:()=>p,gU:()=>P,o3:()=>f,q:()=>y,rd:()=>d,ue:()=>m});var t=e(92347),n=e(40239),s=e(63577),r=e(90183),o=e(33744);function m(a,E,g,h){const D={};return h&&Object.keys(h).length?(D.color=(0,s.getColorDimension)(a,h.color??o.T5.color,g),D.size=(0,s.getScaledDimension)(a,h.size??o.T5.size),D.rotation=(0,s.getScalarDimension)(a,h.rotation??o.T5.rotation),h.text&&(h.text.field||h.text.fixed)&&(D.text=(0,s.getTextDimension)(a,h.text))):E.fields&&(E.fields.color&&(D.color=(0,s.getColorDimension)(a,E.config.color??o.T5.color,g)),E.fields.size&&(D.size=(0,s.getScaledDimension)(a,E.config.size??o.T5.size)),E.fields.text&&(D.text=(0,s.getTextDimension)(a,E.config.text)),E.fields.rotation&&(D.rotation=(0,s.getScalarDimension)(a,E.config.rotation??o.T5.rotation))),D}let l;function i(){return l||(l=[],u()),l}async function u(){const a=await(0,r.o)();for(let E of["maps","gazetteer"])a.listFiles(E).subscribe({next:g=>{g.forEach(h=>{if(h.name.endsWith(".geojson")){const D=`public/${E}/${h.name}`;l.push({value:D,label:D})}})}})}const d=(a,E,g)=>{const h=a.initMapView(E.view);return a.map=new t.A({view:h,pixelRatio:1,layers:[],controls:[],target:g,interactions:(0,n.N)({mouseWheelZoom:!1})})},p=(a,E)=>{a.initControls(E.controls),a.forceUpdate()},c=(a,E,g)=>{a.panelContext&&a.panelContext.onInstanceStateChange&&a.panelContext.onInstanceStateChange({map:a.map,layers:E,selected:g,actions:a.actions})},y=a=>{let E=a.layers.length;for(;E<100;){const g=`Layer ${E++}`;if(!a.byName.has(g))return g}return`Layer ${Date.now()}`};function f(a,E,g,h){const D=a.getPixelFromCoordinate(g),v=a.getPixelFromCoordinate(h),C=Math.abs(D[0]-v[0]),T=Math.abs(D[1]-v[1]);return C>E||T>E}const P=a=>{try{return new URL(a).protocol.includes("http")}catch{return!1}}},52995:(G,I,e)=>{"use strict";e.d(I,{P7:()=>n,uM:()=>s,iS:()=>r,KQ:()=>m});var t=e(52622),n=(l=>(l.Opacity="opacity",l.Scheme="scheme",l))(n||{}),s=(l=>(l.Exponential="exponential",l.Linear="linear",l))(s||{}),r=(l=>(l.X="x",l.Xy="xy",l.Y="y",l))(r||{});const o={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:t.yL.Auto,tooltip:{mode:t.$N.Single,yHistogram:!1,showColorScale:!1}},m={...o,color:{...o.color,mode:n.Scheme,scale:s.Exponential},yAxis:{...o.yAxis,axisPlacement:t.vM.Left},rowsFrame:{...o.rowsFrame,layout:t.D7.auto}}},69386:(G,I,e)=>{"use strict";e.d(I,{K:()=>d});var t=e(32196),n=e(96540),s=e(70255),r=e(40672),o=e(72724),m=e(40845),l=e(72129);function i({width:c,showImage:y,data:f,index:P}){const a=(0,m.of)(p),E=c>600,g=f.get(P),h=encodeURI(g.title);return n.createElement("article",{"aria-labelledby":h,className:(0,t.cx)(a.item,E&&a.itemWide)},y&&g.ogImage&&n.createElement("a",{tabIndex:-1,href:r.sQ.sanitizeUrl(g.link),target:"_blank",rel:"noopener noreferrer",className:(0,t.cx)(a.socialImage,E&&a.socialImageWide),"aria-hidden":!0},n.createElement("img",{src:g.ogImage,alt:g.title})),n.createElement("div",{className:a.body},n.createElement("time",{className:a.date,dateTime:(0,o.LE)(g.date,{format:"MMM DD"})},(0,o.LE)(g.date,{format:"MMM DD"})," "),n.createElement("a",{className:a.link,href:r.sQ.sanitizeUrl(g.link),target:"_blank",rel:"noopener noreferrer"},n.createElement("h3",{className:a.title,id:h},g.title)),n.createElement("div",{className:a.content,dangerouslySetInnerHTML:{__html:r.sQ.sanitize(g.content)}})))}const u=({width:c,showImage:y,rootProps:f})=>{const P=(0,m.of)(p),a=c>600;return n.createElement("div",{className:(0,t.cx)(P.item,a&&P.itemWide),...f},y&&n.createElement(s.A,{containerClassName:(0,t.cx)(P.socialImage,a&&P.socialImageWide),width:a?"250px":"100%",height:a?"150px":c*.5}),n.createElement("div",{className:P.body},n.createElement(s.A,{containerClassName:P.date,width:60}),n.createElement(s.A,{containerClassName:P.title,width:250}),n.createElement(s.A,{containerClassName:P.content,width:"100%",count:6})))},d=(0,l.j)(i,u),p=c=>({container:(0,t.css)({height:"100%"}),item:(0,t.css)({display:"flex",padding:c.spacing(1),position:"relative",marginBottom:c.spacing(.5),marginRight:c.spacing(1),borderBottom:`2px solid ${c.colors.border.weak}`,background:c.colors.background.primary,flexDirection:"column",flexShrink:0}),itemWide:(0,t.css)({flexDirection:"row"}),body:(0,t.css)({display:"flex",flexDirection:"column",flex:1}),socialImage:(0,t.css)({display:"flex",alignItems:"center",marginBottom:c.spacing(1),"> img":{width:"100%",borderRadius:`${c.shape.radius.default} ${c.shape.radius.default} 0 0`}}),socialImageWide:(0,t.css)({marginRight:c.spacing(2),marginBottom:0,"> img":{width:"250px",borderRadius:c.shape.radius.default}}),link:(0,t.css)({color:c.colors.text.link,display:"inline-block","&:hover":{color:c.colors.text.link,textDecoration:"underline"}}),title:(0,t.css)({fontSize:"16px",marginBottom:c.spacing(.5)}),content:(0,t.css)({p:{marginBottom:c.spacing(.5),color:c.colors.text.primary}}),date:(0,t.css)({marginBottom:c.spacing(.5),fontWeight:500,borderRadius:`0 0 0 ${c.shape.radius.default}`,color:c.colors.text.secondary})})},62372:(G,I,e)=>{"use strict";e.d(I,{$:()=>t});const t="https://grafana.com/blog/news.xml"},4172:(G,I,e)=>{"use strict";e.d(I,{n:()=>c});var t=e(41053),n=e(78368);function s(y){const P=new DOMParser().parseFromString(y,"text/xml");return{items:Array.from(P.querySelectorAll("entry")).map(E=>({title:l(E,"title"),link:E.querySelector("link")?.getAttribute("href")??"",content:l(E,"content"),pubDate:l(E,"published"),ogImage:E.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}function r(y){const P=new DOMParser().parseFromString(y,"text/xml");return{items:Array.from(P.querySelectorAll("item")).map(E=>({title:l(E,"title"),link:l(E,"link"),content:l(E,"description"),pubDate:l(E,"pubDate"),ogImage:E.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}async function o(y){return await(await fetch(y)).text()}function m(y){return new DOMParser().parseFromString(y,"text/xml").querySelector("feed")!==null}function l(y,f){return y.querySelector(f)?.textContent??""}async function i(y){const f=await o(y);return m(f)?s(f):r(f)}var u=e(47232),d=e(11261);function p(y){const f=[],P=[],a=[],E=[],g=[];for(const h of y.items){const D=(0,u.KQ)(h.pubDate);try{if(f.push(D.valueOf()),P.push(h.title),a.push(h.link),g.push(h.ogImage),h.content){const v=h.content.replace(/<\/?[^>]+(>|$)/g,"");E.push(v)}}catch(v){console.warn("Error reading news item:",v,h)}}return{fields:[{name:"date",type:d.PU.time,config:{displayName:"Date"},values:f},{name:"title",type:d.PU.string,config:{},values:P},{name:"link",type:d.PU.string,config:{},values:a},{name:"content",type:d.PU.string,config:{},values:E},{name:"ogImage",type:d.PU.string,config:{},values:g}],length:f.length}}function c(y){const[f,P]=(0,t.A)(async()=>{const a=await i(y),E=p(a);return new n.R(E)},[y],{loading:!0});return{state:f,getNews:P}}},23799:(G,I,e)=>{"use strict";e.d(I,{L:()=>m,h:()=>l});var t=e(69550),n=e(75059),s=e(28240),r=e(54479),o=e(52622);function m(i,u=!0){const d=["Value options"];i.addRadio({path:"reduceOptions.values",name:"Show",description:"Calculate a single value per column or series or show each row",settings:{options:[{value:!1,label:"Calculate"},{value:!0,label:"All values"}]},category:d,defaultValue:!1}),i.addNumberInput({path:"reduceOptions.limit",name:"Limit",description:"Max number of rows to display",category:d,settings:{placeholder:"25",integer:!0,min:1,max:5e3},showIf:p=>p.reduceOptions.values===!0}),i.addCustomEditor({id:"reduceOptions.calcs",path:"reduceOptions.calcs",name:"Calculation",description:"Choose a reducer function / calculation",category:d,editor:t.D.get("stats-picker").editor,defaultValue:[n.gy.lastNotNull],showIf:p=>p.reduceOptions.values===!1}),u&&i.addSelect({path:"reduceOptions.fields",name:"Fields",description:"Select the fields that should be included in the panel",category:d,settings:{allowCustomValue:!0,options:[],getOptions:async p=>{const c=[{value:"",label:"Numeric Fields"},{value:"/.*/",label:"All Fields"}];if(p&&p.data)for(const y of p.data)for(const f of y.fields){const P=(0,s.Ct)(f,y,p.data),a=`/^${(0,r.jD)(P)}$/`;c.push({value:a,label:P})}return Promise.resolve(c)}},defaultValue:""})}function l(i,u){i.addRadio({path:"orientation",name:"Orientation",description:"Layout orientation",category:u,settings:{options:[{value:o.wV.Auto,label:"Auto"},{value:o.wV.Horizontal,label:"Horizontal"},{value:o.wV.Vertical,label:"Vertical"}]},defaultValue:o.wV.Auto})}},36373:(G,I,e)=>{"use strict";e.r(I),e.d(I,{plugin:()=>v});var t=e(65158),n=e(52622),s=e(71242),r=e(63250),o=e(24293);const m=(C,T,S)=>{const O=(0,r.gl)(C,T,S);if(S.angular&&(T==="singlestat"||T==="grafana-singlestat-panel")){const x=S.angular;if(O.graphMode=n.$p.None,x.sparkline&&x.sparkline.show&&(O.graphMode=n.$p.Area),x.colorBackground)O.colorMode=n.yp.Background;else if(x.colorValue)O.colorMode=n.yp.Value;else if(O.colorMode=n.yp.None,x.sparkline?.lineColor&&O.graphMode===n.$p.Area){const b=C.fieldConfig??{};b.defaults.color={mode:o.Y.Fixed,fixedColor:x.sparkline.lineColor},C.fieldConfig=b}x.valueName==="name"&&(O.textMode=n.SV.Name)}return O};var l=e(2543),i=e(96540),u=e(11261),d=e(56323),p=e(90708),c=e(37494),y=e(59796),f=e(12509),P=e(2913);class a extends i.PureComponent{constructor(){super(...arguments),this.renderComponent=(T,S)=>{const{timeRange:O,options:x}=this.props,{value:b,alignmentFactors:M,width:A,height:R,count:B}=T,{openMenu:U,targetClassName:W}=S;let N=b.sparkline;return N&&(N.timeRange=O),i.createElement(c.yV,{value:b.display,count:B,sparkline:N,colorMode:x.colorMode,graphMode:x.graphMode,justifyMode:x.justifyMode,textMode:this.getTextMode(),alignmentFactors:M,text:x.text,width:A,height:R,theme:P.config.theme2,onClick:U,className:W,disableWideLayout:!x.wideLayout,percentChangeColorMode:x.percentChangeColorMode})},this.renderValue=T=>{const{value:S}=T,{getLinks:O,hasLinks:x}=S;return x&&O?i.createElement(y.e,{links:O},b=>this.renderComponent(T,b)):this.renderComponent(T,{})},this.getValues=()=>{const{data:T,options:S,replaceVariables:O,fieldConfig:x,timeZone:b}=this.props;let M;for(let A of T.series)for(let R of A.fields){let{config:B}=R;if(R.type===u.PU.number){if(R.state?.range)continue;!M&&(!(0,l.isNumber)(B.min)||!(0,l.isNumber)(B.max))&&(M=(0,p.nJ)(T.series));const U=B.min??M.min,W=B.max??M.max;R.state=R.state??{},R.state.range={min:U,max:W,delta:W-U}}}return(0,d.PI)({fieldConfig:x,reduceOptions:S.reduceOptions,replaceVariables:O,theme:P.config.theme2,data:T.series,sparkline:S.graphMode!==n.$p.None,percentChange:S.showPercentChange,timeZone:b})}}getTextMode(){const{options:T,fieldConfig:S,title:O}=this.props;return T.textMode===n.SV.Auto&&(S.defaults.displayName||!O)?n.SV.ValueAndName:T.textMode}render(){const{height:T,options:S,width:O,data:x,renderCounter:b}=this.props;return i.createElement(f.S,{getValues:this.getValues,getAlignmentFactors:d.XS,renderValue:this.renderValue,width:O,height:T,source:x,itemSpacing:3,renderCounter:b,autoGrid:!0,orientation:S.orientation})}}var E=e(23799);const g={colorMode:n.yp.Value,graphMode:n.$p.Area,justifyMode:n.F8.Auto,percentChangeColorMode:n.CD.Standard,showPercentChange:!1,textMode:n.SV.Auto,wideLayout:!0};var h=e(38824);class D{getSuggestionsForData(T){const{dataSummary:S}=T;if(!S.hasData)return;const O=T.getListAppender({name:h.m.Stat,pluginId:"stat",options:{},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:x=>{x.options.reduceOptions.values&&(x.options.reduceOptions.limit=1)}}});S.hasStringField&&S.hasNumberField&&S.frameCount===1&&S.rowCountTotal<10&&(O.append({name:h.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"}}}),O.append({name:h.m.StatColoredBackground,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:n.yp.Background}})),S.stringFieldCount===1&&S.frameCount===1&&S.rowCountTotal<10&&S.fieldCount===1&&O.append({name:h.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:n.yp.None}}),S.hasNumberField&&S.hasTimeField&&(O.append({options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),O.append({name:h.m.StatColoredBackground,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},graphMode:n.$p.None,colorMode:n.yp.Background}}))}}const v=new t.m(a).useFieldConfig().setPanelOptions(C=>{const T=["Stat styles"];(0,E.L)(C),(0,E.h)(C,T),s.I(C),C.addSelect({path:"textMode",name:"Text mode",description:"Control if name and value is displayed or just name",category:T,settings:{options:[{value:n.SV.Auto,label:"Auto"},{value:n.SV.Value,label:"Value"},{value:n.SV.ValueAndName,label:"Value and name"},{value:n.SV.Name,label:"Name"},{value:n.SV.None,label:"None"}]},defaultValue:g.textMode}).addRadio({path:"wideLayout",name:"Wide layout",category:T,settings:{options:[{value:!0,label:"On"},{value:!1,label:"Off"}]},defaultValue:g.wideLayout,showIf:S=>S.textMode===n.SV.ValueAndName}),C.addSelect({path:"colorMode",name:"Color mode",defaultValue:n.yp.Value,category:T,settings:{options:[{value:n.yp.None,label:"None"},{value:n.yp.Value,label:"Value"},{value:n.yp.Background,label:"Background Gradient"},{value:n.yp.BackgroundSolid,label:"Background Solid"}]}}).addRadio({path:"graphMode",name:"Graph mode",description:"Stat panel graph / sparkline mode",category:T,defaultValue:g.graphMode,settings:{options:[{value:n.$p.None,label:"None"},{value:n.$p.Area,label:"Area"}]}}).addRadio({path:"justifyMode",name:"Text alignment",defaultValue:g.justifyMode,category:T,settings:{options:[{value:n.F8.Auto,label:"Auto"},{value:n.F8.Center,label:"Center"}]}}).addBooleanSwitch({path:"showPercentChange",name:"Show percent change",defaultValue:g.showPercentChange,category:T,showIf:S=>!S.reduceOptions.values}).addSelect({path:"percentChangeColorMode",name:"Percent change color mode",defaultValue:g.percentChangeColorMode,category:T,settings:{options:[{value:n.CD.Standard,label:"Standard"},{value:n.CD.Inverted,label:"Inverted"},{value:n.CD.SameAsValue,label:"Same as Value"}]},showIf:S=>S.showPercentChange})}).setNoPadding().setPanelChangeHandler(m).setSuggestionsSupplier(new D).setMigrationHandler(r._$)},21164:(G,I,e)=>{"use strict";e.d(I,{u:()=>t});const t=(n,s)=>{const r=[],o=new Set;if((n.config.links?.length??0)>0&&n.getLinks!=null){const m=n.values[s],l=n.display?n.display(m):{text:`${m}`,numeric:+m};n.getLinks({calculatedValue:l,valueRowIndex:s}).forEach(i=>{const u=`${i.title}/${i.href}`;o.has(u)||(r.push(i),o.add(u))})}return r}},65885:(G,I,e)=>{"use strict";e.d(I,{S5:()=>a,fq:()=>m,gy:()=>E,l1:()=>f});var t=e(2543),n=e.n(t),s=e(1173),r=e(50082),o=e(11261);const m=g=>(!g.pluginVersion&&"columns"in g&&console.log("Was angular table",g),g.options),l={timeseries_to_rows:"seriesToRows",timeseries_to_columns:"seriesToColumns",timeseries_aggregations:"reduce",table:"merge"},i={avg:"mean",min:"min",max:"max",total:"sum",current:"lastNotNull",count:"count"},u={cell:"color-background",row:"color-background",value:"color-text"},d=(g,h)=>[-1/0,...g].map((D,v)=>({color:h[v],value:(0,t.isNumber)(D)?D:parseInt(D,10)})),p=(g,h)=>{const D=g.transformations??[];if(Object.keys(l).includes(h.transform)){const v={reducers:[]};h.transform==="timeseries_aggregations"&&(v.includeTimeField=!1,v.reducers=h.columns.map(C=>i[C.value])),D.push({id:l[h.transform],options:v})}return D},c=g=>{const D={matcher:{id:/^\/.*\/$/.test(g.pattern)?s.Ct.byRegexp:s.Ct.byName,options:g.pattern},properties:[]};return g.alias&&D.properties.push({id:"displayName",value:g.alias}),g.unit&&D.properties.push({id:"unit",value:g.unit}),g.decimals&&D.properties.push({id:"decimals",value:g.decimals}),g.type==="date"&&D.properties.push({id:"unit",value:`time: ${g.dateFormat}`}),g.type==="hidden"&&D.properties.push({id:"custom.hidden",value:!0}),g.link&&D.properties.push({id:"links",value:[{title:(0,t.defaultTo)(g.linkTooltip,""),url:(0,t.defaultTo)(g.linkUrl,""),targetBlank:(0,t.defaultTo)(g.linkTargetBlank,!1)}]}),g.colorMode&&D.properties.push({id:"custom.cellOptions",value:{type:u[g.colorMode]}}),g.align&&D.properties.push({id:"custom.align",value:g.align==="auto"?null:g.align}),g.thresholds?.length&&D.properties.push({id:"thresholds",value:{mode:r.O.Absolute,steps:d(g.thresholds,g.colors)}}),D},y=g=>{let h={custom:{}};if(g){if(h=(0,t.omitBy)({unit:g.unit,decimals:g.decimals,displayName:g.alias,custom:{align:g.align==="auto"?null:g.align}},t.isNil),g.thresholds.length){const D={mode:r.O.Absolute,steps:d(g.thresholds,g.colors)};h.thresholds=D}g.colorMode&&(h.custom.cellOptions={type:u[g.colorMode]})}return h},f=(g,h,D)=>{if(h==="table-old"&&D.angular){const v=D.angular,C=p(g,v),T=v.styles.find(x=>x.pattern==="/.*/"),S=y(T),O=v.styles.filter(x=>x.pattern!=="/.*/").map(c);g.transformations=C,g.fieldConfig={defaults:S,overrides:O}}return{}},P=g=>g?.filter(h=>h.meta?.custom?.parentRowIndex===void 0)||[g?.[0]],a=g=>{const h=[];return P(g).filter(v=>!!v&&v.length!==0)?.forEach(v=>{const C=g?.filter(x=>v.refId===x.refId&&x.meta?.custom?.parentRowIndex!==void 0),T=(0,t.groupBy)(C,x=>x.meta?.custom?.parentRowIndex),S=Object.keys(T).map(x=>T[x]),O={...v};C&&C.length>0&&O.fields.push({name:"nested",type:o.PU.nestedFrames,config:{},values:S}),h.push(O)}),h},E=g=>g?.some(h=>h.meta?.custom?.parentRowIndex!==void 0)},11082:(G,I,e)=>{"use strict";e.d(I,{Z:()=>m});var t=e(96540),n=e(66864),s=e(94354),r=e(51275);const o=[{label:"Never",value:!1},{label:"Threshold",value:36e5}],m=({value:l,onChange:i,item:u})=>{const d=typeof l=="number";return o[1].value=d?l:36e5,t.createElement(n.Gy,null,t.createElement(s.z,{value:l,options:o,onChange:i}),d&&t.createElement(r.g,{value:l,onChange:i,inputPrefix:r.F.GreaterThan,isTime:u.settings?.isTime??!1}))}},43228:(G,I,e)=>{"use strict";e.d(I,{F:()=>u});var t=e(96540),n=e(66864),s=e(94354),r=e(21594),o=e(29158);const m=[{label:"Solid",value:"solid"},{label:"Dash",value:"dash"},{label:"Dots",value:"dot"}],l=["10, 10","10, 15","10, 20","10, 25","10, 30","10, 40","15, 10","20, 10","25, 10","30, 10","40, 10","50, 10","5, 10","30, 3, 3"].map(p=>({label:p,value:p})),i=["0, 10","0, 20","0, 30","0, 40","0, 3, 3"].map(p=>({label:p,value:p})),u=({value:p,onChange:c})=>{const y=(0,t.useMemo)(()=>p?.fill==="dash"?l:i,[p]),f=(0,t.useMemo)(()=>{if(!p?.dash?.length)return y[0];const P=p.dash?.join(", "),a=y.find(E=>E.value===P);return a||{label:P,value:P}},[p,y]);return t.createElement(n.Gy,null,t.createElement(s.z,{value:p?.fill||"solid",options:m,onChange:P=>{let a;P==="dot"?a=d(i[0].value):P==="dash"&&(a=d(l[0].value)),c({...p,fill:P,dash:a})}}),p?.fill&&p?.fill!=="solid"&&t.createElement(t.Fragment,null,t.createElement(r.l6,{allowCustomValue:!0,options:y,value:f,width:20,onChange:P=>{c({...p,dash:d(P.value??"")})},formatCreateLabel:P=>`Segments: ${d(P).join(", ")}`}),t.createElement("div",null,"\xA0",t.createElement("a",{title:"The input expects a segment list",href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Parameters",target:"_blank",rel:"noreferrer"},t.createElement(o.K,{name:"question-circle",tooltip:"Help"})))))};function d(p){const c=[];for(const y of p.split(/(?:,| )+/)){const f=Number.parseInt(y,10);isNaN(f)||c.push(f)}return c}},51275:(G,I,e)=>{"use strict";e.d(I,{F:()=>r,g:()=>o});var t=e(96540),n=e(65879),s=e(10354),r=(m=>(m.LessThan="lessthan",m.GreaterThan="greaterthan",m))(r||{});const o=({value:m,onChange:l,inputPrefix:i,isTime:u})=>{let d=n.secondsToHms(m/1e3);u||(d="10");const p=P=>{let a=!1;if(P)try{u&&n.isValidTimeSpan(P)?a=n.intervalToMs(P):a=Number(P)}catch(E){console.warn("ERROR",E)}l(a)},c=P=>{P.key==="Enter"&&p(P.currentTarget.value)},y=P=>{p(P.currentTarget.value)},f=i==="greaterthan"?t.createElement("div",null,">"):i==="lessthan"?t.createElement("div",null,"<"):null;return t.createElement(s.p,{autoFocus:!1,placeholder:"never",width:10,defaultValue:d,onKeyDown:c,onBlur:y,prefix:f,spellCheck:!1})}},34163:(G,I,e)=>{"use strict";e.d(I,{e:()=>m});var t=e(96540),n=e(66864),s=e(94354),r=e(51275);const o=[{label:"Never",value:!1},{label:"Always",value:!0},{label:"Threshold",value:36e5}],m=({value:l,onChange:i,item:u})=>{const d=typeof l=="number";return o[2].value=d?l:36e5,t.createElement(n.Gy,null,t.createElement(s.z,{value:l,options:o,onChange:i}),d&&t.createElement(r.g,{value:l,onChange:i,inputPrefix:r.F.LessThan,isTime:u.settings?.isTime??!1}))}},24882:(G,I,e)=>{"use strict";e.d(I,{D:()=>s});var t=e(96540),n=e(21594);const s=({item:r,value:o,onChange:m,id:l})=>{const i=(0,t.useCallback)(u=>{m({mode:u.value})},[m]);return t.createElement(n.l6,{inputId:l,value:o.mode,options:r.settings?.options??[],onChange:i})}},22731:(G,I,e)=>{"use strict";e.d(I,{$:()=>P,k:()=>f});var t=e(32196),n=e(96540),s=e(83195),r=e(11261),o=e(52622),m=e(40845),l=e(11389),i=e(58749),u=e(52415),d=e(10875),p=e(21164),c=e(5514),y=e(82915);const f=({series:a,_rest:E,dataIdxs:g,seriesIdx:h,mode:D=o.$N.Single,sortOrder:v=o.xB.None,isPinned:C,annotate:T,maxHeight:S})=>{const O=(0,m.of)(P),x=a.fields[0],b=(0,s.cN)(x.display(x.values[g[0]])),M=(0,d.cp)(a.fields,x,g,h,D,v,B=>B.type===r.PU.number||B.type===r.PU.enum);E?.forEach(B=>{B.config.custom?.hideFrom?.tooltip||M.push({label:B.state?.displayName??B.name,value:(0,c.S)(B,B.values[g[0]])})});let A;if(C&&h!=null){const B=a.fields[h],U=g[h],W=(0,p.u)(B,U);A=n.createElement(i.S,{dataLinks:W,annotate:T})}const R=x.config.custom?.hideFrom?.tooltip?null:{label:x.type===r.PU.time?"":x.state?.displayName??x.name,value:b};return n.createElement("div",{className:O.wrapper},R!=null&&n.createElement(u.A,{item:R,isPinned:C}),n.createElement(l.o,{items:M,isPinned:C,scrollable:(0,y.T5)({mode:D,maxHeight:S}),maxHeight:S}),A)},P=()=>({wrapper:(0,t.css)({display:"flex",flexDirection:"column"})})},41706:(G,I,e)=>{"use strict";e.d(I,{S:()=>f,V:()=>a});var t=e(37055),n=e(24293),s=e(11261),r=e(27310),o=e(52622),m=e(52198),l=e(56675),i=e(38248),u=e(11404),d=e(11082),p=e(43228),c=e(34163),y=e(24882);const f={drawStyle:o.GR.Line,lineInterpolation:o.dx.Linear,lineWidth:1,fillOpacity:0,gradientMode:o.on.None,barAlignment:o.Nj.Center,stacking:{mode:o.gs.None,group:"A"},axisGridShow:!0,axisCenteredZero:!1,axisBorderShow:!1},P=["Graph styles"];function a(E,g=!0){return{standardOptions:{[t.uo.Color]:{settings:{byValueSupport:!0,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:n.Y.PaletteClassic}}},useCustomConfig:h=>{h.addRadio({path:"drawStyle",name:"Style",category:P,defaultValue:E.drawStyle,settings:{options:m.t.drawStyle}}).addRadio({path:"lineInterpolation",name:"Line interpolation",category:P,defaultValue:E.lineInterpolation,settings:{options:m.t.lineInterpolation},showIf:D=>D.drawStyle===o.GR.Line}).addRadio({path:"barAlignment",name:"Bar alignment",category:P,defaultValue:E.barAlignment,settings:{options:m.t.barAlignment},showIf:D=>D.drawStyle===o.GR.Bars}).addSliderInput({path:"lineWidth",name:"Line width",category:P,defaultValue:E.lineWidth,settings:{min:0,max:10,step:1,ariaLabelForHandle:"Line width"},showIf:D=>D.drawStyle!==o.GR.Points}).addSliderInput({path:"fillOpacity",name:"Fill opacity",category:P,defaultValue:E.fillOpacity,settings:{min:0,max:100,step:1,ariaLabelForHandle:"Fill opacity"},showIf:D=>D.drawStyle!==o.GR.Points}).addRadio({path:"gradientMode",name:"Gradient mode",category:P,defaultValue:m.t.fillGradient[0].value,settings:{options:m.t.fillGradient},showIf:D=>D.drawStyle!==o.GR.Points}).addFieldNamePicker({path:"fillBelowTo",name:"Fill below to",category:P,hideFromDefaults:!0,settings:{filter:D=>D.type===s.PU.number}}).addCustomEditor({id:"lineStyle",path:"lineStyle",name:"Line style",category:P,showIf:D=>D.drawStyle===o.GR.Line,editor:p.F,override:p.F,process:r.hS,shouldApply:D=>D.type===s.PU.number}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",category:P,defaultValue:!1,editor:c.e,override:c.e,showIf:D=>D.drawStyle===o.GR.Line,shouldApply:D=>D.type!==s.PU.time,process:r.hS,settings:{isTime:g}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",category:P,defaultValue:!1,editor:d.Z,override:d.Z,showIf:D=>D.drawStyle===o.GR.Line,shouldApply:D=>D.type!==s.PU.time,process:r.hS,settings:{isTime:g}}).addRadio({path:"showPoints",name:"Show points",category:P,defaultValue:m.t.showPoints[0].value,settings:{options:m.t.showPoints},showIf:D=>D.drawStyle!==o.GR.Points}).addSliderInput({path:"pointSize",name:"Point size",category:P,defaultValue:5,settings:{min:1,max:40,step:1,ariaLabelForHandle:"Point size"},showIf:D=>D.showPoints!==o.yL.Never||D.drawStyle===o.GR.Points}),l.I(h,E.stacking,P),h.addSelect({category:P,name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:o.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:o.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),i.r(h,E),u.e(h),h.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:o.Ly.Off},settings:{options:m.t.thresholdsDisplayModes},editor:y.D,override:y.D,process:r.hS,shouldApply:()=>!0})}}}},62567:(G,I,e)=>{"use strict";e.d(I,{W:()=>ne});var t=e(32196),n=e(96540),s=e(40961),r=e(84140),o=e(36613),m=e(33948),l=e(52622),i=e(23596),u=e(24284),d=e(17464),p=e(40845),c=e(7315),y=e(36376),f=e(13544),P=e(49785),a=e(29647),E=e(41053),g=e(72724),h=e(42994),D=e(79041),v=e(67061),C=e(88575),T=e(21744),S=e(55852),O=e(72235),x=e(99818),b=e(10154);const M=({annoVals:ee,annoIdx:z,dismiss:te,timeZone:ie,...ce})=>{const ue=(0,p.of)(A),{onAnnotationCreate:fe,onAnnotationUpdate:Te}=(0,D.d2)(),he=(0,n.useRef)(null);(0,a.A)(he,te);const[de,le]=(0,E.A)(async xe=>{const Ve=await fe(xe);return te(),Ve}),[pe,ve]=(0,E.A)(async xe=>{const Ve=await Te(xe);return te(),Ve}),be=xe=>(0,g.LE)(xe,{format:h.WC.fullDate,timeZone:ie}),Oe=ee.id?.[z]!=null,Me=ee.isRegion?.[z],Ue=Oe?ve:le,we=Oe?pe:de,Re=Me?`${be(ee.time[z])} - ${be(ee.timeEnd[z])}`:be(ee.time[z]),Fe=({tags:xe,description:Ve})=>{Ue({id:ee.id?.[z]??void 0,tags:xe,description:Ve,from:Math.round(ee.time[z]),to:Math.round(ee.timeEnd?.[z]??ee.time[z])})};return n.createElement("div",{ref:he,className:ue.editor,...ce},n.createElement("div",{className:ue.header},n.createElement(v.B,{justifyContent:"space-between",alignItems:"center"},n.createElement("div",null,Oe?"Edit annotation":"Add annotation"),n.createElement("div",null,Re))),n.createElement(O.l,{onSubmit:Fe,defaultValues:{description:ee.text?.[z],tags:ee.tags?.[z]||[]}},({register:xe,errors:Ve,control:$e})=>n.createElement(n.Fragment,null,n.createElement("div",{className:ue.content},n.createElement(C.D,{label:"Description",invalid:!!Ve.description,error:Ve?.description?.message},n.createElement(T.f,{className:ue.textarea,...xe("description",{required:"Annotation description is required"})})),n.createElement(C.D,{label:"Tags"},n.createElement(P.xI,{control:$e,name:"tags",render:({field:{ref:Xe,onChange:gt,...Dt}})=>n.createElement(x.$,{allowCustomValue:!0,placeholder:"Add tags",onChange:gt,tagOptions:b.vy,tags:Dt.value})}))),n.createElement("div",{className:ue.footer},n.createElement(v.B,{justifyContent:"flex-end"},n.createElement(S.$n,{size:"sm",variant:"secondary",onClick:te,fill:"outline"},"Cancel"),n.createElement(S.$n,{size:"sm",type:"submit",disabled:we?.loading},we?.loading?"Saving":"Save"))))))},A=ee=>({editor:(0,t.css)({background:ee.colors.background.primary,border:`1px solid ${ee.colors.border.weak}`,borderRadius:ee.shape.radius.default,boxShadow:ee.shadows.z3,userSelect:"text",width:"460px"}),content:(0,t.css)({padding:ee.spacing(1)}),header:(0,t.css)({borderBottom:`1px solid ${ee.colors.border.weak}`,padding:ee.spacing(.5,1),fontWeight:ee.typography.fontWeightBold,fontSize:ee.typography.fontSize,color:ee.colors.text.primary}),footer:(0,t.css)({borderTop:`1px solid ${ee.colors.border.weak}`,padding:ee.spacing(1,1)}),textarea:(0,t.css)({color:ee.colors.text.secondary,fontSize:ee.typography.bodySmall.fontSize})});var R=e(40672),B=e(66864),U=e(29158),W=e(78369),N=e(55907);const w=()=>!1,L=({annoVals:ee,annoIdx:z,timeZone:te,onEdit:ie})=>{const ce=ee.id?.[z],ue=(0,p.of)(V),{canEditAnnotations:fe=w,canDeleteAnnotations:Te=w,onAnnotationDelete:he}=(0,D.d2)(),de=ee.dashboardUID?.[z],le=fe(de),pe=Te(de)&&he!=null,ve=Re=>(0,g.LE)(Re,{format:h.WC.fullDate,timeZone:te});let be=ve(ee.time[z]),Oe=ee.text?.[z]??"";ee.isRegion?.[z]&&(be+=" - "+ve(ee.timeEnd[z]));let Me;ee.login?.[z]&&ee.avatarUrl?.[z]&&(Me=n.createElement("img",{className:ue.avatar,alt:"Annotation avatar",src:ee.avatarUrl[z]}));let Ue=null,we="";if(ee.alertId?.[z]!==void 0&&ee.newState?.[z]){const Re=N.A.getStateDisplayModel(ee.newState[z]);Ue=n.createElement("div",{className:ue.alertState},n.createElement("i",{className:Re.stateClass},Re.text)),we=ee.data?.[z]?N.A.getAlertAnnotationText(ee.data[z]):""}else ee.title?.[z]&&(Oe=ee.title[z]+(Oe?`<br />${Oe}`:""));return n.createElement("div",{className:ue.wrapper},n.createElement("div",{className:ue.header},n.createElement(B.Gy,{justify:"space-between",align:"center",spacing:"md"},n.createElement("div",{className:ue.meta},n.createElement("span",null,Me,Ue),be),(le||pe)&&n.createElement("div",{className:ue.editControls},le&&n.createElement(U.K,{name:"pen",size:"sm",onClick:ie,tooltip:"Edit"}),pe&&n.createElement(U.K,{name:"trash-alt",size:"sm",onClick:()=>he(ce),tooltip:"Delete"})))),n.createElement("div",{className:ue.body},Oe&&n.createElement("div",{className:ue.text,dangerouslySetInnerHTML:{__html:R.sQ.sanitize(Oe)}}),we,n.createElement("div",null,n.createElement(B.Gy,{spacing:"xs",wrap:!0},ee.tags?.[z]?.map((Re,Fe)=>n.createElement(W.v,{name:Re,key:`${Re}-${Fe}`}))))))},V=ee=>({wrapper:(0,t.css)({zIndex:ee.zIndex.tooltip,whiteSpace:"initial",borderRadius:ee.shape.radius.default,background:ee.colors.background.primary,border:`1px solid ${ee.colors.border.weak}`,boxShadow:ee.shadows.z2,userSelect:"text"}),header:(0,t.css)({padding:ee.spacing(.5,1),borderBottom:`1px solid ${ee.colors.border.weak}`,fontWeight:ee.typography.fontWeightBold,fontSize:ee.typography.fontSize,color:ee.colors.text.primary,display:"flex"}),meta:(0,t.css)({display:"flex",justifyContent:"space-between",color:ee.colors.text.primary,fontWeight:400}),editControls:(0,t.css)({display:"flex",alignItems:"center","> :last-child":{marginLeft:0}}),body:(0,t.css)({padding:ee.spacing(1),fontSize:ee.typography.bodySmall.fontSize,color:ee.colors.text.secondary,fontWeight:400,a:{color:ee.colors.text.link,"&:hover":{textDecoration:"underline"}}}),text:(0,t.css)({paddingBottom:ee.spacing(1)}),avatar:(0,t.css)({borderRadius:ee.shape.radius.circle,width:16,height:16,marginRight:ee.spacing(1)}),alertState:(0,t.css)({paddingRight:ee.spacing(1),fontWeight:ee.typography.fontWeightMedium})}),K=0,k=1,j=2,H=({annoVals:ee,annoIdx:z,className:te,style:ie,exitWipEdit:ce,timeZone:ue,portalRoot:fe})=>{const Te=(0,p.of)(J),[he,de]=(0,n.useState)(ce!=null?k:K),{refs:le,floatingStyles:pe}=(0,y.we)({open:!0,placement:"bottom",middleware:[(0,c.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,c.BN)()],whileElementsMounted:c.ll,strategy:"fixed"}),ve=he===j?n.createElement(L,{annoIdx:z,annoVals:ee,timeZone:ue,onEdit:()=>de(k)}):he===k?n.createElement(M,{annoIdx:z,annoVals:ee,timeZone:ue,dismiss:()=>{ce?.(),de(K)}}):null;return n.createElement("div",{ref:le.setReference,className:te,style:ie,onMouseEnter:()=>he!==k&&de(j),onMouseLeave:()=>he!==k&&de(K),"data-testid":f.Tp.pages.Dashboard.Annotations.marker},ve&&(0,s.createPortal)(n.createElement("div",{ref:le.setFloating,className:Te.annoBox,style:pe,"data-testid":"annotation-marker"},ve),fe))},J=ee=>({annoBox:(0,t.css)({top:0,left:0,zIndex:ee.zIndex.tooltip,borderRadius:ee.shape.radius.default,position:"absolute",background:ee.colors.background.primary,border:`1px solid ${ee.colors.border.weak}`,boxShadow:ee.shadows.z2,userSelect:"text",minWidth:"300px"})}),X=(ee,z,te,ie,ce)=>{ee.beginPath(),ee.moveTo(ie,z),ee.lineTo(ie,te),ee.strokeStyle=ce,ee.stroke()},se=(0,r.A)(u.Mk).toHex8String();function ae(ee){let z={};return ee.fields.forEach(te=>{z[te.name]=te.values}),z}const ne=({annotations:ee,timeZone:z,config:te,newRange:ie,setNewRange:ce,canvasRegionRendering:ue=!0})=>{const[fe,Te]=(0,n.useState)(),[he]=(0,n.useState)(()=>(0,d.gF)()),de=(0,p.of)(q),le=(0,p.$j)().visualization.getColorByName,[pe,ve]=(0,n.useReducer)(Re=>Re+1,0),be=(0,n.useMemo)(()=>{let Re=ee.filter(Fe=>Fe.name!=="exemplar"&&Fe.length>0&&Fe.fields.some(xe=>xe.name==="time"));if(ie){let Fe=ie.to>ie.from;const xe=(0,m.I)([{time:ie.from,timeEnd:Fe?ie.to:null,isRegion:Fe,color:se}]);xe.meta={dataTopic:l.QR.Annotations,custom:{isWip:!0}},Re.push(xe)}return Re},[ee,ie]),Oe=(0,n.useCallback)(()=>{ce(null)},[ce]),Me=(0,n.useRef)(be);Me.current=be;const Ue=(0,n.useRef)(ie);Ue.current=ie;const we=(0,n.useRef)();if((0,n.useLayoutEffect)(()=>{te.addHook("ready",Re=>{let Fe=Re.root.querySelector(".u-axis");we.current=Fe,Te(Re)}),te.addHook("draw",Re=>{let Fe=Me.current;const xe=Re.ctx;xe.save(),xe.beginPath(),xe.rect(Re.bbox.left,Re.bbox.top,Re.bbox.width,Re.bbox.height),xe.clip(),Fe.forEach(Ve=>{let $e=ae(Ve);if(Ve.name==="xymark"){let Xe=te.scales[0].props.scaleKey,gt=te.scales[1].props.scaleKey;for(let Dt=0;Dt<Ve.length;Dt++){let nt=le($e.color?.[Dt]||se),at=Re.valToPos($e.xMin[Dt],Xe,!0),Ae=Re.valToPos($e.xMax[Dt],Xe,!0),re=Re.valToPos($e.yMax[Dt],gt,!0),Z=Re.valToPos($e.yMin[Dt],gt,!0);xe.fillStyle=i.alpha(nt,$e.fillOpacity[Dt]),xe.fillRect(at,re,Ae-at,Z-re),xe.lineWidth=Math.round($e.lineWidth[Dt]*o.A.pxRatio),$e.lineStyle[Dt]==="dash"?xe.setLineDash([5,5]):xe.setLineDash([]),xe.strokeStyle=nt,xe.strokeRect(at,re,Ae-at,Z-re)}}else{let Xe=Re.bbox.top,gt=Xe+Re.bbox.height;xe.lineWidth=2,xe.setLineDash([5,5]);for(let Dt=0;Dt<$e.time.length;Dt++){let nt=le($e.color?.[Dt]||se),at=Re.valToPos($e.time[Dt],"x",!0);if(!$e.isRegion?.[Dt])X(xe,Xe,gt,at,nt);else if(ue){X(xe,Xe,gt,at,nt);let Ae=Re.valToPos($e.timeEnd[Dt],"x",!0);X(xe,Xe,gt,Ae,nt),xe.fillStyle=i.alpha(nt,.1),xe.fillRect(at,Xe,Ae-at,Re.bbox.height)}}}}),xe.restore()})},[te,ue,le]),(0,n.useEffect)(()=>{fe&&(fe.redraw(),setTimeout(()=>{ve()},0))},[be,fe]),fe){let Re=be.flatMap((Fe,xe)=>{let Ve=ae(Fe),$e=[];for(let Xe=0;Xe<Ve.time.length;Xe++){let gt=le(Ve.color?.[Xe]||u.Mk),Dt=Math.round(fe.valToPos(Ve.time[Xe],"x"))||0,nt=null,at="",Ae=!0;if(Ve.isRegion?.[Xe]){let re=Math.round(fe.valToPos(Ve.timeEnd?.[Xe],"x"))||0;if(Ae=Dt<fe.rect.width&&re>0,Ae){let Z=Math.max(0,Dt),oe=Math.min(fe.rect.width,re);nt={left:Z,background:gt,width:oe-Z},at=de.annoRegion}}else Ae=Dt>=0&&Dt<=fe.rect.width,Ae&&(nt={left:Dt,borderBottomColor:gt},at=de.annoMarker);if(Ae){let re=Fe.meta?.custom?.isWip;$e.push(n.createElement(H,{annoIdx:Xe,annoVals:Ve,className:at,style:nt,timeZone:z,key:`${xe}:${Xe}`,exitWipEdit:re?Oe:null,portalRoot:he}))}}return $e});return(0,s.createPortal)(Re,we.current)}return null},q=()=>({annoMarker:(0,t.css)({position:"absolute",width:0,height:0,borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottomWidth:"5px",borderBottomStyle:"solid",transform:"translateX(-50%)",cursor:"pointer",zIndex:1}),annoRegion:(0,t.css)({position:"absolute",height:"5px",cursor:"pointer",zIndex:1})})},7874:(G,I,e)=>{"use strict";e.d(I,{U:()=>s});var t=e(96540),n=e(55852);const s=({config:r,onChangeTimeRange:o})=>{const m=(0,t.useRef)(),[l,i]=(0,t.useState)([]),[u,d]=(0,t.useState)();if((0,t.useLayoutEffect)(()=>{r.addHook("init",E=>{m.current=E}),r.addHook("setScale",E=>{i(E.data?.[0]??[]),d(E.scales.x??void 0)})},[r]),l.length<2||!o||!u||!u.time||!u.min||!u.max)return null;let p=0,c=l.length-1;for(;p<=c&&l[p]==null;)p++;for(;c>=0&&l[c]==null;)c--;const y=l[p],f=l[c],P=u.min,a=u.max;return y==null||f==null||y<=a&&f>=P?null:t.createElement("div",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)",width:"100%",textAlign:"center"}},t.createElement("div",null,t.createElement("div",null,"Data outside time range"),t.createElement(n.$n,{onClick:E=>o({from:y,to:f}),variant:"secondary","data-testid":"time-series-zoom-to-data"},"Zoom to data")))};s.displayName="OutsideRangePlugin"},82915:(G,I,e)=>{"use strict";e.d(I,{B_:()=>p,Fg:()=>f,O2:()=>y,T5:()=>P});var t=e(11261),n=e(28240),s=e(83195),r=e(57875),o=e(50311),m=e(46294),l=e(39624),i=e(52622),u=e(55129);function d(a){let E=new Map;return a.map(h=>({...h,fields:h.fields.map(D=>{if(D.type===t.PU.enum){let v=(0,u.M)(D.config,D.type),C=E.get(v);C||(C=[],E.set(v,C));let T=D.values.toArray().slice(),S=D.config.type.enum.text;if(C.length>0)for(let O=0;O<T.length;O++)T[O]+=C.length;return C.push(...S),D.config.type.enum.text=C,{...D,values:T}}return D})}))}function p(a,E,g,h){if(!a?.length)return null;(0,n.Fm)(a);let D=h!=null;h!=null&&h>0&&(a=[{...a[0],fields:[a[0].fields[h],...a[0].fields.filter((S,O)=>O!==h)]}]);for(let S of a)for(let O of S.fields)O.type===t.PU.time&&typeof O.values[0]!="number"&&(O.values=(0,o.s7)(O,{destinationType:t.PU.time}).values);let v=0;e:for(let S of a)for(let O of S.fields)if(O.type===t.PU.enum&&++v>1){a=d(a);break e}let C;const T=[];for(let S of a){const O=[];let x=!1,b=!1,M=D?S:(0,m.M)({frame:S,refFieldPseudoMin:g?.from.valueOf(),refFieldPseudoMax:g?.to.valueOf()});const A=(0,l.C)(M).fields;for(let R=0;R<A?.length;R++){const B=A[R];switch(B.type){case t.PU.time:x=!0,O.push(B);break;case t.PU.number:b=D?R>0:!0,C={...B,values:B.values.map(N=>Number.isFinite(N)||N==null?N:null)},O.push(C);break;case t.PU.enum:b=!0;case t.PU.string:C={...B,values:B.values},O.push(C);break;case t.PU.boolean:b=!0;const U=B.config?.custom??{},W={...B.config,max:1,min:0,custom:U};U.lineInterpolation!==i.dx.StepBefore&&(U.lineInterpolation=i.dx.StepAfter),C={...B,config:W,type:t.PU.number,values:B.values.map(N=>N==null?N:N?1:0)},(0,s.j9)(W.unit)||(W.unit="bool",C.display=(0,r.J)({field:C,theme:E})),O.push(C);break}}(D||x)&&b&&T.push({...S,length:M.length,fields:O})}return T.length?(y(T,E,0),c(T,E),T):null}const c=(a,E)=>{const{palette:g}=E.visualization;for(const h of a)for(const D of h.fields)if(D.type===t.PU.enum){const v=g[D.state?.seriesIndex%g.length],C=E.visualization.getColorByName(v),T=D.config.type.enum;T.color=Array(T.text.length).fill(C),D.display=(0,r.J)({field:D,theme:E})}},y=(a,E,g)=>{let h=0;a.forEach(D=>{D.fields.forEach((v,C)=>{C!==g&&(v.type===t.PU.number||v.type===t.PU.boolean||v.type===t.PU.enum)&&(v.state={...v.state,seriesIndex:h++},v.display=(0,r.J)({field:v,theme:E}))})})};function f(a,E){return!a||!a.length?[E]:a.map(g=>g?.length?g:E)}const P=a=>a.mode===i.$N.Multi&&a.maxHeight!=null},5514:(G,I,e)=>{"use strict";e.d(I,{S:()=>n});var t=e(83195);function n(s,r){return s.display?(0,t.cN)(s.display(r)):`${r}`}},99140:(G,I,e)=>{"use strict";e.d(I,{Gu:()=>r,JD:()=>o,M_:()=>n,k3:()=>s});var t=e(48594);let n;function s(m){n=m}function r(){return!n||!n.getState?{templating:{...t.L1,lastKey:"key"}}:n.getState()}function o(m){if(!(!n||!n.getState))return n.dispatch(m)}},24897:(G,I,e)=>{"use strict";e.d(I,{RG:()=>s,Vz:()=>r,XT:()=>t.X,Xe:()=>n});var t=e(62625),n=(o=>(o[o.Admin=4]="Admin",o[o.Editor=2]="Editor",o[o.Member=0]="Member",o[o.Viewer=1]="Viewer",o))(n||{}),s=(o=>(o.View="View",o.Edit="Edit",o.Admin="Admin",o))(s||{}),r=(o=>(o.Folder="dash-folder",o.Dashboard="dash-db",o.AlertFolder="dash-folder-alerting",o))(r||{})},50271:()=>{"use strict"},18625:()=>{"use strict"},14276:()=>{"use strict"},95425:(G,I,e)=>{"use strict";e.d(I,{Z4:()=>t,_g:()=>n,d9:()=>s});var t=(r=>(r.Home="home-dashboard",r.New="new-dashboard",r.Normal="normal-dashboard",r.Path="path-dashboard",r.Scripted="scripted-dashboard",r.Public="public-dashboard",r.Embedded="embedded-dashboard",r.Report="report-dashboard",r))(t||{}),n=(r=>(r.NotStarted="Not started",r.Fetching="Fetching",r.Services="Services",r.Failed="Failed",r.Completed="Completed",r))(n||{}),s=(r=>(r.TV="tv",r.Full="full",r))(s||{})},62543:()=>{"use strict"},28444:(G,I,e)=>{"use strict";e.d(I,{Bt:()=>g,Cf:()=>c,Eu:()=>x,Io:()=>E,JI:()=>u,PR:()=>d,Ps:()=>C,Q$:()=>p,Rh:()=>D,S8:()=>S,U0:()=>P,VZ:()=>h,Vz:()=>v,XM:()=>f,Yn:()=>m,aP:()=>O,bG:()=>o,bY:()=>T,i0:()=>R,sL:()=>A,u4:()=>l,vk:()=>y,xL:()=>a,xc:()=>b,yj:()=>M,zq:()=>i});var t=e(89550),n=e(65463);const s=(0,t.R)("ds-request-response"),r=(0,t.R)("ds-request-error"),o=(0,t.R)("template-variable-value-updated"),m=(0,t.R)("graph-click"),l=(0,t.R)("threshold-changed");class i extends n.a{static{this.type="panel-queries-changed"}}class u extends n.a{static{this.type="panel-transformations-changed"}}class d extends n.a{static{this.type="panels-options-changed"}}class p extends n.a{static{this.type="dashboard-panels-changed"}}class c extends n.a{static{this.type="dashboard-meta-changed"}}class y extends n.a{static{this.type="panel-directive-ready"}}class f extends n.a{static{this.type="render"}}class P extends n.x{static{this.type="zoom-out"}}var a=(B=>(B[B.Left=-1]="Left",B[B.Right=1]="Right",B))(a||{});class E extends n.x{static{this.type="shift-time"}}class g extends n.a{static{this.type="copy-time"}}class h extends n.x{static{this.type="paste-time"}}class D extends n.x{static{this.type="absolute-time"}}class v extends n.x{static{this.type="remove-panel"}}class C extends n.x{static{this.type="show-modal"}}class T extends n.x{static{this.type="show-confirm-modal"}}class S extends n.x{static{this.type="show-react-modal"}}class O extends n.a{static{this.type="hide-modal"}}class x extends n.a{static{this.type="dashboard-saved"}}class b extends n.x{static{this.type="annotation-query-started"}}class M extends n.x{static{this.type="annotation-query-finished"}}class A extends n.x{static{this.type="panel-edit-started"}}class R extends n.x{static{this.type="panel-edit-finished"}}},76698:(G,I,e)=>{"use strict";e.d(I,{IW:()=>t,aA:()=>s,jH:()=>r,sG:()=>n});var t=(o=>(o[o.CLOSE_PANE=0]="CLOSE_PANE",o[o.CHANGE_DATASOURCE=1]="CHANGE_DATASOURCE",o[o.CLOSE_EDITOR=2]="CLOSE_EDITOR",o))(t||{});const n=["lines","bars","points","stacked_lines","stacked_bars"];var s=(o=>(o.table="table",o.raw="raw",o))(s||{});const r=["table","raw"]},8904:()=>{"use strict"},31678:(G,I,e)=>{"use strict";e.d(I,{AccessControlAction:()=>D,AppNotificationSeverity:()=>c,CORRELATION_EDITOR_POST_CONFIRM_ACTION:()=>P.IW,CoreEvents:()=>v,DashboardInitPhase:()=>r._g,DashboardRoutes:()=>r.Z4,EXPLORE_GRAPH_STYLES:()=>P.sG,KioskMode:()=>r.d9,OrgRole:()=>o.XT,PermissionLevelString:()=>o.RG,SearchQueryType:()=>o.Vz,ServiceAccountStateFilter:()=>i,TABLE_RESULTS_STYLE:()=>P.aA,TeamPermissionLevel:()=>o.Xe,addListener:()=>a.ch,createAsyncThunk:()=>a.zD,timeoutMap:()=>f,useDispatch:()=>a.wA,useSelector:()=>a.d4});var t=e(50271),n=e(54034),s=e(8904),r=e(95425),o=e(24897),m=e(18625),l=e(64998),i=(C=>(C.All="All",C.WithExpiredTokens="WithExpiredTokens",C.External="External",C.Disabled="Disabled",C))(i||{}),u=e(62543),d=e(77237),p=e(75330),c=(C=>(C.Success="success",C.Warning="warning",C.Error="error",C.Info="info",C))(c||{}),y=(C=>(C[C.Success=3e3]="Success",C[C.Warning=5e3]="Warning",C[C.Error=7e3]="Error",C))(y||{});const f={success:3e3,warning:5e3,error:7e3,info:3e3};var P=e(76698),a=e(64756),E=e(13868),g=e(14276),h=e(90697),D=(C=>(C.UsersRead="users:read",C.UsersWrite="users:write",C.UsersAuthTokenList="users.authtoken:read",C.UsersAuthTokenUpdate="users.authtoken:write",C.UsersPasswordUpdate="users.password:write",C.UsersDelete="users:delete",C.UsersCreate="users:create",C.UsersEnable="users:enable",C.UsersDisable="users:disable",C.UsersPermissionsUpdate="users.permissions:write",C.UsersLogout="users:logout",C.UsersQuotasList="users.quotas:read",C.UsersQuotasUpdate="users.quotas:write",C.ServiceAccountsRead="serviceaccounts:read",C.ServiceAccountsCreate="serviceaccounts:create",C.ServiceAccountsWrite="serviceaccounts:write",C.ServiceAccountsDelete="serviceaccounts:delete",C.ServiceAccountsPermissionsRead="serviceaccounts.permissions:read",C.ServiceAccountsPermissionsWrite="serviceaccounts.permissions:write",C.OrgsRead="orgs:read",C.OrgsPreferencesRead="orgs.preferences:read",C.OrgsWrite="orgs:write",C.OrgsPreferencesWrite="orgs.preferences:write",C.OrgsCreate="orgs:create",C.OrgsDelete="orgs:delete",C.OrgUsersRead="org.users:read",C.OrgUsersAdd="org.users:add",C.OrgUsersRemove="org.users:remove",C.OrgUsersWrite="org.users:write",C.LDAPUsersRead="ldap.user:read",C.LDAPUsersSync="ldap.user:sync",C.LDAPStatusRead="ldap.status:read",C.DataSourcesExplore="datasources:explore",C.DataSourcesRead="datasources:read",C.DataSourcesCreate="datasources:create",C.DataSourcesWrite="datasources:write",C.DataSourcesDelete="datasources:delete",C.DataSourcesPermissionsRead="datasources.permissions:read",C.DataSourcesCachingRead="datasources.caching:read",C.DataSourcesInsightsRead="datasources.insights:read",C.ActionServerStatsRead="server.stats:read",C.ActionTeamsCreate="teams:create",C.ActionTeamsDelete="teams:delete",C.ActionTeamsRead="teams:read",C.ActionTeamsWrite="teams:write",C.ActionTeamsPermissionsRead="teams.permissions:read",C.ActionTeamsPermissionsWrite="teams.permissions:write",C.ActionRolesList="roles:read",C.ActionTeamsRolesList="teams.roles:read",C.ActionTeamsRolesAdd="teams.roles:add",C.ActionTeamsRolesRemove="teams.roles:remove",C.ActionUserRolesList="users.roles:read",C.ActionUserRolesAdd="users.roles:add",C.ActionUserRolesRemove="users.roles:remove",C.DashboardsRead="dashboards:read",C.DashboardsWrite="dashboards:write",C.DashboardsDelete="dashboards:delete",C.DashboardsCreate="dashboards:create",C.DashboardsPermissionsRead="dashboards.permissions:read",C.DashboardsPermissionsWrite="dashboards.permissions:write",C.DashboardsPublicWrite="dashboards.public:write",C.FoldersRead="folders:read",C.FoldersWrite="folders:write",C.FoldersDelete="folders:delete",C.FoldersCreate="folders:create",C.FoldersPermissionsRead="folders.permissions:read",C.FoldersPermissionsWrite="folders.permissions:write",C.ActionSupportBundlesCreate="support.bundles:create",C.ActionSupportBundlesRead="support.bundles:read",C.ActionSupportBundlesDelete="support.bundles:delete",C.AlertingRuleCreate="alert.rules:create",C.AlertingRuleRead="alert.rules:read",C.AlertingRuleUpdate="alert.rules:write",C.AlertingRuleDelete="alert.rules:delete",C.AlertingInstanceCreate="alert.instances:create",C.AlertingInstanceUpdate="alert.instances:write",C.AlertingInstanceRead="alert.instances:read",C.AlertingSilenceCreate="alert.silences:create",C.AlertingSilenceUpdate="alert.silences:write",C.AlertingSilenceRead="alert.silences:read",C.AlertingNotificationsRead="alert.notifications:read",C.AlertingNotificationsWrite="alert.notifications:write",C.AlertingRuleExternalWrite="alert.rules.external:write",C.AlertingRuleExternalRead="alert.rules.external:read",C.AlertingInstancesExternalWrite="alert.instances.external:write",C.AlertingInstancesExternalRead="alert.instances.external:read",C.AlertingNotificationsExternalWrite="alert.notifications.external:write",C.AlertingNotificationsExternalRead="alert.notifications.external:read",C.AlertingProvisioningReadSecrets="alert.provisioning.secrets:read",C.AlertingProvisioningRead="alert.provisioning:read",C.AlertingProvisioningWrite="alert.provisioning:write",C.ActionAPIKeysRead="apikeys:read",C.ActionAPIKeysCreate="apikeys:create",C.ActionAPIKeysDelete="apikeys:delete",C.PluginsInstall="plugins:install",C.PluginsWrite="plugins:write",C.SettingsRead="settings:read",C.SettingsWrite="settings:write",C))(D||{}),v=e(28444)},13868:()=>{"use strict"},54034:()=>{"use strict"},75330:()=>{"use strict"},77237:()=>{"use strict"},90697:()=>{"use strict"},64756:(G,I,e)=>{"use strict";e.d(I,{ch:()=>m,d4:()=>r,wA:()=>s,zD:()=>o});var t=e(65307),n=e(71468);const s=n.useDispatch,r=n.useSelector,o=(l,i,u)=>(0,t.zD)(l,i,u),m=t.ch},38824:(G,I,e)=>{"use strict";e.d(I,{m:()=>t});var t=(n=>(n.LineChart="Line chart",n.LineChartSmooth="Line chart smooth",n.LineChartGradientColorScheme="Line chart with gradient color scheme",n.AreaChart="Area chart",n.AreaChartStacked="Area chart stacked",n.AreaChartStackedPercent="Area chart 100% stacked",n.BarChart="Bar chart",n.BarChartGradientColorScheme="Bar chart with gradient color scheme",n.BarChartStacked="Bar chart stacked",n.BarChartStackedPercent="Bar chart 100% stacked",n.BarChartHorizontal="Bar chart horizontal",n.BarChartHorizontalStacked="Bar chart horizontal stacked",n.BarChartHorizontalStackedPercent="Bar chart horizontal 100% stacked",n.Candlestick="Candlestick",n.PieChart="Pie chart",n.PieChartDonut="Pie chart donut",n.Stat="Stat",n.StatColoredBackground="Stat colored background",n.Gauge="Gauge",n.GaugeNoThresholds="Gauge no thresholds",n.BarGaugeBasic="Bar gauge basic",n.BarGaugeLCD="Bar gauge LCD",n.Table="Table",n.StateTimeline="State timeline",n.StatusHistory="Status history",n.TextPanel="Text",n.DashboardList="Dashboard list",n.Logs="Logs",n.FlameGraph="Flame graph",n.Trace="Trace",n.NodeGraph="Node graph",n))(t||{})},94822:(G,I,e)=>{"use strict";e.d(I,{Gi:()=>n,JS:()=>l,N1:()=>i,Q8:()=>u,Si:()=>s,cF:()=>t,lh:()=>m,s1:()=>r});var t=(d=>(d.Firing="firing",d.Inactive="inactive",d.Pending="pending",d))(t||{}),n=(d=>(d.Normal="Normal",d.Alerting="Alerting",d.Pending="Pending",d.NoData="NoData",d.Error="Error",d))(n||{});function s(d){return Object.values(t).includes(d)}function r(d){return Object.values(n).some(p=>p===d)}function o(d){const p=Object.values(t);return d!=null&&!p.includes(d)}function m(d){return o(d)?d.split(" ")[0]:d}var l=(d=>(d.Alerting="alerting",d.Recording="recording",d))(l||{}),i=(d=>(d.Cortex="Cortex",d.Mimir="Mimir",d.Prometheus="Prometheus",d.Thanos="Thanos",d))(i||{}),u=(d=>(d.Alerting="Alerting",d.NoData="NoData",d.KeepLast="KeepLast",d.OK="OK",d.Error="Error",d))(u||{})},54317:(G,I,e)=>{"use strict";e.d(I,{$:()=>r,S:()=>n});var t=e(94822);function n(o,m){return(0,t.lh)(o.state)===m}var s=(o=>(o.Firing="firing",o))(s||{}),r=(o=>(o.Alerting="alerting",o.Pending="pending",o.Normal="inactive",o.NoData="nodata",o.Error="error",o))(r||{})},64998:()=>{"use strict"},72834:G=>{const I="    ";function e(r){let o="";return r&&Object.keys(r).forEach(function(m){o+=m+":"+r[m]+";"}),o}function t(r){function o(l){return'class="'+l+'"'}function m(l){return'style="'+e(r["."+l])+'"'}return r?m:o}function n(r){return r===null?"null":Array.isArray(r)?"array":typeof r=="string"&&/^https?:/.test(r)?"link":typeof r=="object"&&typeof r.toISOString=="function"?"date":typeof r}function s(r){return r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}G.exports=function(r,o){let m="";const l=t(o);let i=function(d,p,c,y){if(!d.length)return p+" "+c;let f=p+`
`;return m+=I,d.forEach(function(P,a){f+=m+y(P)+(a<d.length-1?",":"")+`
`}),m=m.slice(0,-I.length),f+m+c};function u(d){if(d===void 0)return"";switch(n(d)){case"boolean":return"<span "+l("json-markup-bool")+">"+d+"</span>";case"number":return"<span "+l("json-markup-number")+">"+d+"</span>";case"date":return'<span class="json-markup-string">"'+s(d.toISOString())+'"</span>';case"null":return"<span "+l("json-markup-null")+">null</span>";case"string":return"<span "+l("json-markup-string")+'>"'+s(d.replace(/\n/g,`
`+m))+'"</span>';case"link":return"<span "+l("json-markup-string")+'>"<a href="'+encodeURI(d)+'">'+s(d)+'</a>"</span>';case"array":return i(d,"[","]",u);case"object":const p=Object.keys(d).filter(function(c){return d[c]!==void 0});return i(p,"{","}",function(c){return"<span "+l("json-markup-key")+'>"'+s(c)+'":</span> '+u(d[c])})}return""}return"<div "+l("json-markup")+">"+u(r)+"</div>"}},13609:()=>{(function(G){"use strict";G(function(){G.support.transition=function(){var I=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==void 0)return t[n]}();return I&&{end:I}}()})})(window.jQuery),function(G){"use strict";var I="[data-toggle=dropdown]",e=function(r){var o=G(r).on("click.dropdown.data-api",this.toggle);G("html").on("click.dropdown.data-api",function(){o.parent().removeClass("open")})};e.prototype={constructor:e,toggle:function(r){var o=G(this),m,l;if(!o.is(".disabled, :disabled"))return m=n(o),l=m.hasClass("open"),t(),l||("ontouchstart"in document.documentElement&&G('<div class="dropdown-backdrop"/>').insertBefore(G(this)).on("click",t),m.toggleClass("open")),o.focus(),!1},keydown:function(r){var o,m,l,i,u,d;if(/(38|40|27)/.test(r.keyCode)&&(o=G(this),r.preventDefault(),r.stopPropagation(),!o.is(".disabled, :disabled"))){if(i=n(o),u=i.hasClass("open"),!u||u&&r.keyCode==27)return r.which==27&&i.find(I).focus(),o.click();m=G("[role=menu] li:not(.divider):visible a",i),m.length&&(d=m.index(m.filter(":focus")),r.keyCode==38&&d>0&&d--,r.keyCode==40&&d<m.length-1&&d++,~d||(d=0),m.eq(d).focus())}}};function t(){G(".dropdown-backdrop").remove(),G(I).each(function(){n(G(this)).removeClass("open")})}function n(r){var o=r.attr("data-target"),m;return o||(o=r.attr("href"),o=o&&/#[A-Za-z]/.test(o)&&o.replace(/.*(?=#[^\s]*$)/,"")),m=o&&G.find(o),(!m||!m.length)&&(m=r.parent()),m}var s=G.fn.dropdown;G.fn.dropdown=function(r){return this.each(function(){var o=G(this),m=o.data("dropdown");m||o.data("dropdown",m=new e(this)),typeof r=="string"&&m[r].call(o)})},G.fn.dropdown.Constructor=e,G.fn.dropdown.noConflict=function(){return G.fn.dropdown=s,this},G(document).on("click.dropdown.data-api",t).on("click.dropdown.data-api",".dropdown form",function(r){r.stopPropagation()}).on("click.dropdown.data-api",I,e.prototype.toggle).on("keydown.dropdown.data-api",I+", [role=menu]",e.prototype.keydown)}(window.jQuery),function(G){"use strict";var I=function(t,n){this.options=n,this.$element=G(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",G.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};I.prototype={constructor:I,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=G.Event("show");this.$element.trigger(n),!(this.isShown||n.isDefaultPrevented())&&(this.isShown=!0,this.escape(),this.backdrop(function(){var s=G.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),s&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),s?t.$element.one(G.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")}))},hide:function(t){t&&t.preventDefault();var n=this;t=G.Event("hide"),this.$element.trigger(t),!(!this.isShown||t.isDefaultPrevented())&&(this.isShown=!1,this.escape(),G(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),G.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var t=this;G(document).on("focusin.modal",function(n){t.$element[0]!==n.target&&!t.$element.has(n.target).length&&t.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(n){n.which==27&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(G.support.transition.end),t.hideModal()},500);this.$element.one(G.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,s=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=G.support.transition&&s;if(this.$backdrop=G('<div class="modal-backdrop '+s+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?G.proxy(this.$element[0].focus,this.$element[0]):G.proxy(this.hide,this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;r?this.$backdrop.one(G.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),G.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(G.support.transition.end,t):t()):t&&t()}};var e=G.fn.modal;G.fn.modal=function(t){return this.each(function(){var n=G(this),s=n.data("modal"),r=G.extend({},G.fn.modal.defaults,n.data(),typeof t=="object"&&t);s||n.data("modal",s=new I(this,r)),typeof t=="string"?s[t]():r.show&&s.show()})},G.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},G.fn.modal.Constructor=I,G.fn.modal.noConflict=function(){return G.fn.modal=e,this},G(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=G(this),s=n.attr("href"),r=G.find(n.attr("data-target")||s&&s.replace(/.*(?=#[^\s]+$)/,"")),o=r.data("modal")?"toggle":G.extend({remote:!/#/.test(s)&&s},r.data(),n.data());t.preventDefault(),r.modal(o).one("hide",function(){n.focus()})})}(window.jQuery),function(G){"use strict";var I=function(t,n){this.init("tooltip",t,n)};I.prototype={constructor:I,init:function(t,n,s){var r,o,m,l,i;for(this.type=t,this.$element=G(n),this.options=this.getOptions(s),this.enabled=!0,m=this.options.trigger.split(" "),i=m.length;i--;)l=m[i],l=="click"?this.$element.on("click."+this.type,this.options.selector,G.proxy(this.toggle,this)):l!="manual"&&(r=l=="hover"?"mouseenter":"focus",o=l=="hover"?"mouseleave":"blur",this.$element.on(r+"."+this.type,this.options.selector,G.proxy(this.enter,this)),this.$element.on(o+"."+this.type,this.options.selector,G.proxy(this.leave,this)));this.options.selector?this._options=G.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=G.extend({},G.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=G.fn[this.type].defaults,s={},r;if(this._options&&G.each(this._options,function(o,m){n[o]!=m&&(s[o]=m)},this),r=G(t.currentTarget)[this.type](s).data(this.type),!r.options.delay||!r.options.delay.show)return r.show();clearTimeout(this.timeout),r.hoverState="in",this.timeout=setTimeout(function(){r.hoverState=="in"&&r.show()},r.options.delay.show)},leave:function(t){var n=G(t.currentTarget)[this.type](this._options).data(this.type);if(this.timeout&&clearTimeout(this.timeout),!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,s,r,o,m,l=G.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(l),l.isDefaultPrevented())return;switch(t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),o=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(G.find(this.options.container)):t.insertAfter(this.$element),n=this.getPosition(),s=t[0].offsetWidth,r=t[0].offsetHeight,o){case"bottom":m={top:n.top+n.height,left:n.left+n.width/2-s/2};break;case"top":m={top:n.top-r,left:n.left+n.width/2-s/2};break;case"left":m={top:n.top+n.height/2-r/2,left:n.left-s};break;case"right":m={top:n.top+n.height/2-r/2,left:n.left+n.width};break;case"topLeft":m={top:n.top-r,left:n.left+n.width/2-s*.1};break;case"topRight":m={top:n.top-r,left:n.left+n.width/2-s*.9};break;case"rightTop":m={top:n.top+n.height/2-r*.1,left:n.left+n.width};break;case"rightBottom":m={top:n.top+n.height/2-r*.9,left:n.left+n.width};break;case"bottomLeft":m={top:n.top+n.height,left:n.left+n.width/2-s*.1};break;case"bottomRight":m={top:n.top+n.height,left:n.left+n.width/2-s*.9};break;case"leftTop":m={top:n.top+n.height/2-r*.1,left:n.left-s};break;case"leftBottom":m={top:n.top+n.height/2-r*.9,left:n.left-s};break}this.applyPlacement(m,o),this.$element.trigger("shown")}},applyPlacement:function(t,n){var s=this.tip(),r=s[0].offsetWidth,o=s[0].offsetHeight,m,l,i,u;s.offset(t).addClass(n).addClass("in"),m=s[0].offsetWidth,l=s[0].offsetHeight,n=="top"&&l!=o&&(t.top=t.top+o-l,u=!0),n=="bottom"||n=="top"?(i=0,t.left<0&&(i=t.left*-2,t.left=0,s.offset(t),m=s[0].offsetWidth,l=s[0].offsetHeight),this.replaceArrow(i-r+m,m,"left")):this.replaceArrow(l-o,l,"top"),u&&s.offset(t)},replaceArrow:function(t,n,s){this.arrow().css(s,t?50*(1-t/n)+"%":"")},setContent:function(){var t=this.tip(),n=this.getTitle();t.find(".tooltip-inner").text(n),t.removeClass("fade in top bottom left right")},hide:function(){var t=this,n=this.tip(),s=G.Event("hide");if(this.$element.trigger(s),s.isDefaultPrevented())return;n.removeClass("in");function r(){var o=setTimeout(function(){n.off(G.support.transition.end).detach()},500);n.one(G.support.transition.end,function(){clearTimeout(o),n.detach()})}return G.support.transition&&this.$tip.hasClass("fade")?r():n.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var t=this.$element;(t.attr("title")||typeof t.attr("data-original-title")!="string")&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return G.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var t,n=this.$element,s=this.options;return t=n.attr("data-original-title")||(typeof s.title=="function"?s.title.call(n[0]):s.title),t},tip:function(){return this.$tip=this.$tip||G(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?G(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass("in")?n.hide():n.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var e=G.fn.tooltip;G.fn.tooltip=function(t){return this.each(function(){var n=G(this),s=n.data("tooltip"),r=typeof t=="object"&&t;s||n.data("tooltip",s=new I(this,r)),typeof t=="string"&&s[t]()})},G.fn.tooltip.Constructor=I,G.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},G.fn.tooltip.noConflict=function(){return G.fn.tooltip=e,this}}(window.jQuery),function(G){"use strict";var I=function(t){this.element=G(t)};I.prototype={constructor:I,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),s=t.attr("data-target"),r,o,m;s||(s=t.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")&&(r=n.find(".active:last a")[0],m=G.Event("show",{relatedTarget:r}),t.trigger(m),!m.isDefaultPrevented()&&(o=G.find(s),this.activate(t.parent("li"),n),this.activate(o,o.parent(),function(){t.trigger({type:"shown",relatedTarget:r})})))},activate:function(t,n,s){var r=n.find("> .active"),o=s&&G.support.transition&&r.hasClass("fade");function m(){r.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),o?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),s&&s()}o?r.one(G.support.transition.end,m):m(),r.removeClass("in")}};var e=G.fn.tab;G.fn.tab=function(t){return this.each(function(){var n=G(this),s=n.data("tab");s||n.data("tab",s=new I(this)),typeof t=="string"&&s[t]()})},G.fn.tab.Constructor=I,G.fn.tab.noConflict=function(){return G.fn.tab=e,this},G(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),G(this).tab("show")})}(window.jQuery),function(G){"use strict";var I=function(t,n){this.$element=G(t),this.options=G.extend({},G.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=G(this.options.menu),this.shown=!1,this.listen()};I.prototype={constructor:I,select:function(){var t=this.$menu.find(".active").attr("data-value")||this.$element.val();return this.$element.val(this.updater(t)).change(),this.hide()},updater:function(t){return t},show:function(){var t=G.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=G.isFunction(this.source)?this.source(this.query,G.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=G.grep(t,function(s){return n.matcher(s)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(t){return~t.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(t){for(var n=[],s=[],r=[],o;o=t.shift();)o.toLowerCase().indexOf(this.query.toLowerCase())?~o.indexOf(this.query)?s.push(o):r.push(o):n.push(o);return n.concat(s,r)},highlighter:function(t){var n=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return n?t.replace(new RegExp("("+n+")","ig"),function(s,r){return"<strong>"+r+"</strong>"}):t},render:function(t){var n=this;return t=G(t).map(function(s,r){return s=G(n.options.item).attr("data-value",r),s.find("a").html(n.highlighter(r)),s[0]}),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),s=n.next();s.length||(s=G(this.$menu.find("li")[0])),s.addClass("active")},prev:function(t){var n=this.$menu.find(".active").removeClass("active"),s=n.prev();s.length||(s=this.$menu.find("li").last()),s.addClass("active")},listen:function(){this.$element.on("focus",G.proxy(this.focus,this)).on("blur",G.proxy(this.blur,this)).on("keypress",G.proxy(this.keypress,this)).on("keyup",G.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",G.proxy(this.keydown,this)),this.$menu.on("click",G.proxy(this.click,this)).on("mouseenter","li",G.proxy(this.mouseenter,this)).on("mouseleave","li",G.proxy(this.mouseleave,this))},destroy:function(){this.$element.off().removeData("typeahead"),this.$menu.off()},eventSupported:function(t){var n=t in this.$element;return n||(this.$element.setAttribute(t,"return;"),n=typeof this.$element[t]=="function"),n},move:function(t){if(this.shown&&!(t.shiftKey&&t.keyCode===40)){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:t.preventDefault(),this.prev();break;case 40:t.preventDefault(),this.next();break}t.stopPropagation()}},keydown:function(t){this.suppressKeyPressRepeat=~G.inArray(t.keyCode,[40,38,9,13,27,57]),this.move(t)},keypress:function(t){this.suppressKeyPressRepeat||this.move(t)},keyup:function(t){switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}t.keyCode===13&&typeof this.$menu.find(".active").attr("data-value")>"u"?this.$element.submit():(t.stopPropagation(),t.preventDefault())},focus:function(t){this.focused=!0},blur:function(t){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(t){t.stopPropagation(),t.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),G(t.currentTarget).addClass("active")},mouseleave:function(t){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var e=G.fn.typeahead;G.fn.typeahead=function(t){return this.each(function(){var n=G(this),s=n.data("typeahead"),r=typeof t=="object"&&t;s||n.data("typeahead",s=new I(this,r)),typeof t=="string"&&s[t]()})},G.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},G.fn.typeahead.Constructor=I,G.fn.typeahead.noConflict=function(){return G.fn.typeahead=e,this},G(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=G(this);n.data("typeahead")||n.typeahead(n.data())})}(window.jQuery),function(G){"use strict";var I=function(t,n){this.options=G.extend({},G.fn.affix.defaults,n),this.$window=G(window).on("scroll.affix.data-api",G.proxy(this.checkPosition,this)).on("click.affix.data-api",G.proxy(function(){setTimeout(G.proxy(this.checkPosition,this),1)},this)),this.$element=G(t),this.checkPosition()};I.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=G(document).height(),n=this.$window.scrollTop(),s=this.$element.offset(),r=this.options.offset,o=r.bottom,m=r.top,l="affix affix-top affix-bottom",i;typeof r!="object"&&(o=m=r),typeof m=="function"&&(m=r.top()),typeof o=="function"&&(o=r.bottom()),i=this.unpin!=null&&n+this.unpin<=s.top?!1:o!=null&&s.top+this.$element.height()>=t-o?"bottom":m!=null&&n<=m?"top":!1,this.affixed!==i&&(this.affixed=i,this.unpin=i=="bottom"?s.top-n:null,this.$element.removeClass(l).addClass("affix"+(i?"-"+i:"")))}};var e=G.fn.affix;G.fn.affix=function(t){return this.each(function(){var n=G(this),s=n.data("affix"),r=typeof t=="object"&&t;s||n.data("affix",s=new I(this,r)),typeof t=="string"&&s[t]()})},G.fn.affix.Constructor=I,G.fn.affix.defaults={offset:0},G.fn.affix.noConflict=function(){return G.fn.affix=e,this},G(window).on("load",function(){G('[data-spy="affix"]').each(function(){var t=G(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery)},82013:()=>{(function(G){var I={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};function e(t){var n={x:-1,y:-1,locked:!1};t.setCrosshair=function(m){if(!m)n.x=-1;else{var l=t.p2c(m);n.x=Math.max(0,Math.min(l.left,t.width())),n.y=Math.max(0,Math.min(l.top,t.height()))}t.triggerRedrawOverlay()},t.clearCrosshair=t.setCrosshair,t.lockCrosshair=function(m){m&&t.setCrosshair(m),n.locked=!0},t.unlockCrosshair=function(){n.locked=!1};function s(o){n.locked||n.x!=-1&&(n.x=-1,t.triggerRedrawOverlay())}function r(o){if(!n.locked){if(t.getSelection&&t.getSelection()){n.x=-1;return}var m=t.offset();n.x=Math.max(0,Math.min(o.pageX-m.left,t.width())),n.y=Math.max(0,Math.min(o.pageY-m.top,t.height())),t.triggerRedrawOverlay()}}t.hooks.bindEvents.push(function(o,m){o.getOptions().crosshair.mode&&(m.mouseout(s),m.mousemove(r))}),t.hooks.drawOverlay.push(function(o,m){var l=o.getOptions().crosshair;if(l.mode){var i=o.getPlotOffset();if(m.save(),m.translate(i.left,i.top),n.x!=-1){var u=o.getOptions().crosshair.lineWidth%2?.5:0;if(m.strokeStyle=l.color,m.lineWidth=l.lineWidth,m.lineJoin="round",m.beginPath(),l.mode.indexOf("x")!=-1){var d=Math.floor(n.x)+u;m.moveTo(d,0),m.lineTo(d,o.height())}if(l.mode.indexOf("y")!=-1){var p=Math.floor(n.y)+u;m.moveTo(0,p),m.lineTo(o.width(),p)}m.stroke()}m.restore()}}),t.hooks.shutdown.push(function(o,m){m.unbind("mouseout",s),m.unbind("mousemove",r)})}G.plot.plugins.push({init:e,options:I,name:"crosshair",version:"1.0"})})(jQuery)},2341:()=>{(function(G){function I(e){e.hooks.processDatapoints.push(function(t,n,s){n.dashes.show&&t.hooks.draw.push(function(r,o){var m=r.getPlotOffset(),l=n.xaxis,i=n.yaxis;function u(y,f){var P=s.points,a=s.pointsize,E=null,g=null,h=0,D=!0,v,C;n.dashes.dashLength[0]?(v=n.dashes.dashLength[0],n.dashes.dashLength[1]?C=n.dashes.dashLength[1]:C=v):C=v=n.dashes.dashLength,o.beginPath();for(var T=a;T<P.length;T+=a){let N=function(w){var L=Math.sqrt(Math.pow(R-M,2)+Math.pow(B-A,2));if(L<=w)return{deltaX:R-M,deltaY:B-A,distance:L,remainder:w-L};var V=R>M?1:-1,K=B>A?1:-1;return{deltaX:V*Math.sqrt(Math.pow(w,2)/(1+Math.pow((B-A)/(R-M),2))),deltaY:K*Math.sqrt(Math.pow(w,2)-Math.pow(w,2)/(1+Math.pow((B-A)/(R-M),2))),distance:w,remainder:0}};var W=N,S=P[T-a],O=P[T-a+1],x=P[T],b=P[T+1];if(!(S==null||x==null)){if(O<=b&&O<i.min){if(b<i.min)continue;S=(i.min-O)/(b-O)*(x-S)+S,O=i.min}else if(b<=O&&b<i.min){if(O<i.min)continue;x=(i.min-O)/(b-O)*(x-S)+S,b=i.min}if(O>=b&&O>i.max){if(b>i.max)continue;S=(i.max-O)/(b-O)*(x-S)+S,O=i.max}else if(b>=O&&b>i.max){if(O>i.max)continue;x=(i.max-O)/(b-O)*(x-S)+S,b=i.max}if(S<=x&&S<l.min){if(x<l.min)continue;O=(l.min-S)/(x-S)*(b-O)+O,S=l.min}else if(x<=S&&x<l.min){if(S<l.min)continue;b=(l.min-S)/(x-S)*(b-O)+O,x=l.min}if(S>=x&&S>l.max){if(x>l.max)continue;O=(l.max-S)/(x-S)*(b-O)+O,S=l.max}else if(x>=S&&x>l.max){if(S>l.max)continue;b=(l.max-S)/(x-S)*(b-O)+O,x=l.max}(S!=E||O!=g)&&o.moveTo(l.p2c(S)+y,i.p2c(O)+f);var M=l.p2c(S)+y,A=i.p2c(O)+f,R=l.p2c(x)+y,B=i.p2c(b)+f,U;do U=N(h>0?h:D?v:C),(U.deltaX!=0||U.deltaY!=0)&&(D?o.lineTo(M+U.deltaX,A+U.deltaY):o.moveTo(M+U.deltaX,A+U.deltaY)),D=!D,h=U.remainder,M+=U.deltaX,A+=U.deltaY;while(U.distance>0);E=x,g=b}}o.stroke()}o.save(),o.translate(m.left,m.top),o.lineJoin="round";var d=n.dashes.lineWidth,p=n.shadowSize;if(d>0&&p>0){o.lineWidth=p,o.strokeStyle="rgba(0,0,0,0.1)";var c=Math.PI/18;u(Math.sin(c)*(d/2+p/2),Math.cos(c)*(d/2+p/2)),o.lineWidth=p/2,u(Math.sin(c)*(d/2+p/4),Math.cos(c)*(d/2+p/4))}o.lineWidth=d,o.strokeStyle=n.color,d>0&&u(0,0),o.restore()})})}G.plot.plugins.push({init:I,options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})})(jQuery)},92275:()=>{(function(G){"use strict";var I={series:{fillBelowTo:null}};function e(t){function n(o,m){var l;for(l=0;l<m.length;++l)if(m[l].id===o.fillBelowTo)return m[l];return null}function s(o,m,l,i,u,d,p,c){var y,f,P,a,E,g;return y=l-o,f=i-m,P=p-u,a=c-d,E=(-f*(o-u)+y*(m-d))/(-P*f+y*a),g=(P*(m-d)-a*(o-u))/(-P*f+y*a),E>=0&&E<=1&&g>=0&&g<=1?[o+g*y,m+g*f]:null}function r(o,m,l){if(l.fillBelowTo===null)return;var i,u,d,p,c,y,f;function P(C,T){m.beginPath(),m.moveTo(l.xaxis.p2c(C)+y.left,l.yaxis.p2c(T)+y.top)}function a(){m.closePath(),m.fill()}function E(){if(d.length/u!==c.length/p)return console.error("Refusing to graph inconsistent number of points"),!1;var C;for(C=0;C<d.length/u;C++)if(d[C*u]!==null&&c[C*p]!==null&&d[C*u]!==c[C*p])return console.error("Refusing to graph points without matching value"),!1;return!0}function g(C,T){console.assert(T>C,"expects the end index to be greater than the start index");var S=C===0||d[C-1]===null||c[C-1]===null,O=!1,x,b;for(x=C;x<T;x++)if(d[x*u+1]===null||c[x*u+1]===null)O=!1,S=!0;else if(d[x*u+1]===c[x*p+1])O=!0,S=!1;else if(d[x*u+1]>c[x*p+1]){S?P(d[x*u],d[x*u+1]):O?P(d[(x-1)*u],d[(x-1)*u+1]):(b=h(x),P(b[0],b[1])),v(x,T);return}else S=!1,O=!1}function h(C){console.assert(C>0,"expects the second point in the series line segment");var T,S;for(T=1;T<c.length/p;T++)if(S=s(d[(C-1)*u],d[(C-1)*u+1],d[C*u],d[C*u+1],c[(T-1)*p],c[(T-1)*p+1],c[T*p],c[T*p+1]),S!==null)return S;console.error("intersectionPoint() should only be called when an intersection happens")}function D(C,T){console.assert(C>=T,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var S;for(S=C;S>=T;S--)m.lineTo(i.xaxis.p2c(c[S*p])+y.left,i.yaxis.p2c(c[S*p+1])+y.top);a()}function v(C,T){console.assert(C<=T,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var S,O;for(S=C;S<T;S++)if(d[S*u+1]===null&&S>C){D(S-1,C),g(S,T);return}else if(d[S*u+1]===c[S*p+1]){D(S,C),g(S,T);return}else if(d[S*u+1]<c[S*p+1]){O=h(S),m.lineTo(l.xaxis.p2c(O[0])+y.left,l.yaxis.p2c(O[1])+y.top),D(S,C),g(S,T);return}else m.lineTo(l.xaxis.p2c(d[S*u])+y.left,l.yaxis.p2c(d[S*u+1])+y.top);D(T,C)}i=n(l,o.getData()),i&&(u=l.datapoints.pointsize,d=l.datapoints.points,p=i.datapoints.pointsize,c=i.datapoints.points,y=o.getPlotOffset(),E()&&(f=G.color.parse(l.color),f.a=.4,f.normalize(),m.fillStyle=f.toString(),g(0,d.length/u)))}t.hooks.drawSeries.push(r)}G.plot.plugins.push({init:e,options:I,name:"fillbelow",version:"0.1.0"})})(jQuery)},19538:()=>{/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */(function(G){var I=function(){var l,i,u,d,p,c,y=function(C,T){l=T,i=C.getPlaceholder(),u=C.getOptions(),d=u.series.gauges,p=C.getData(),c=e(d.debug)};y.prototype.calculateLayout=function(){var C=i.width(),T=i.height(),S=Math.min(p.length,d.layout.columns),O=Math.ceil(p.length/S),x=d.layout.margin,b=d.layout.hMargin,M=d.layout.vMargin,A=(C-x*2-b*(S-1))/S,R=(T-x*2-M*(O-1))/O;if(d.layout.square){var B=Math.min(A,R);A=B,R=B}f(d,A);var U=d.cell.margin,W=0,N=0;d.label.show&&(W=d.label.margin,N=d.label.font.size);var w=0,L=0;d.value.show&&(w=d.value.margin,L=d.value.font.size);var V=0;d.threshold.show&&(V=d.threshold.width);var K=0,k=0;d.threshold.label.show&&(K=d.threshold.label.margin,k=d.threshold.label.font.size);for(var j=A/2-U-V-K*2-k,H=d.gauge.startAngle,J=d.gauge.endAngle,X=(J-H)/100,se=-1,ae=H;ae<J;ae+=X)se=Math.max(se,Math.sin(s(ae)));se=Math.max(se,Math.sin(s(J)));var ne=(R-U*2-W*2-N)/(1+se);ne*se<w+L/2&&(ne=R-U*2-W*2-N-w-L/2);var q=ne-K*2-k-V,ee=Math.min(j,q),z=d.gauge.width;z>=ee&&(z=Math.max(3,ee/3));var te=K*2+k+V+ee,ie=Math.max(te*(1+se),te+w+L/2);return{canvasWidth:C,canvasHeight:T,margin:x,hMargin:b,vMargin:M,columns:S,rows:O,cellWidth:A,cellHeight:R,cellMargin:U,labelMargin:W,labelFontSize:N,valueMargin:w,valueFontSize:L,width:z,radius:ee,thresholdWidth:V,thresholdLabelMargin:K,thresholdLabelFontSize:k,gaugeOuterHeight:ie}};function f(C,T){C.gauge.width==="auto"&&(C.gauge.width=Math.max(5,T/8)),C.label.margin==="auto"&&(C.label.margin=Math.max(1,T/20)),C.label.font.size==="auto"&&(C.label.font.size=Math.max(5,T/8)),C.value.margin==="auto"&&(C.value.margin=Math.max(1,T/30)),C.value.font.size==="auto"&&(C.value.font.size=Math.max(5,T/9)),C.threshold.width==="auto"&&(C.threshold.width=Math.max(3,T/100)),C.threshold.label.margin==="auto"&&(C.threshold.label.margin=Math.max(3,T/40)),C.threshold.label.font.size==="auto"&&(C.threshold.label.font.size=Math.max(5,T/15))}y.prototype.calculateAutoValues=f,y.prototype.calculateCellLayout=function(C,T,S){var O=t(T.columns,S),x=n(T.columns,S),b=T.margin+(T.cellWidth+T.hMargin)*O,M=T.margin+(T.cellHeight+T.vMargin)*x,A=b+T.cellWidth/2,R=M+T.cellMargin+T.labelMargin*2+T.labelFontSize+T.thresholdWidth+T.thresholdLabelFontSize+T.thresholdLabelMargin*2+T.radius,B=T.cellHeight-T.cellMargin*2-T.labelMargin*2-T.labelFontSize-T.gaugeOuterHeight,U=0;return C.cell.vAlign==="middle"?U=B/2:C.cell.vAlign==="bottom"&&(U=B),R+=U,{col:O,row:x,x:b,y:M,offsetY:U,cellWidth:T.cellWidth,cellHeight:T.cellHeight,cellMargin:T.cellMargin,cx:A,cy:R}},y.prototype.drawBackground=function(C){d.frame.show&&(l.save(),l.strokeStyle=u.grid.borderColor,l.lineWidth=u.grid.borderWidth,l.strokeRect(0,0,C.canvasWidth,C.canvasHeight),u.grid.backgroundColor&&(l.fillStyle=u.grid.backgroundColor,l.fillRect(0,0,C.canvasWidth,C.canvasHeight)),l.restore())},y.prototype.drawCellBackground=function(C,T){l.save(),C.cell.border&&C.cell.border.show&&C.cell.border.color&&C.cell.border.width&&(l.strokeStyle=C.cell.border.color,l.lineWidth=C.cell.border.width,l.strokeRect(T.x,T.y,T.cellWidth,T.cellHeight)),C.cell.background&&C.cell.background.color&&(l.fillStyle=C.cell.background.color,l.fillRect(T.x,T.y,T.cellWidth,T.cellHeight)),l.restore()},y.prototype.drawGauge=function(C,T,S,O,x){var b=C.gauge.shadow.show?C.gauge.shadow.blur:0,M=E(C,x),A=P(C,T,x);h(S.cx,S.cy,T.radius,T.width,s(C.gauge.startAngle),s(C.gauge.endAngle),C.gauge.border.color,C.gauge.border.width,C.gauge.background.color,b),h(S.cx,S.cy,T.radius-1,T.width-2,s(A.a1),s(A.a2),M,1,M,b),C.gauge.neutralValue!=null&&a(C,T,S,M)};function P(C,T,S){let O={};var x=C.gauge.neutralValue;return x!=null?S<x?(O.a1=g(C,T,S),O.a2=g(C,T,x)):(O.a1=g(C,T,x),O.a2=g(C,T,S)):(O.a1=C.gauge.startAngle,O.a2=g(C,T,S)),O}function a(C,T,S,O){var x=(C.gauge.max-C.gauge.min)/600;r(l,S.cx,S.cy,T.radius-2,T.width-4,s(g(C,T,C.gauge.neutralValue-x)),s(g(C,T,C.gauge.neutralValue+x)),O,2,C.gauge.background.color)}function E(C,T){for(var S,O=0;O<C.threshold.values.length;O++){var x=C.threshold.values[O];if(S=x.color,T<x.value)break}return S}function g(C,T,S){var O=C.gauge.startAngle+(C.gauge.endAngle-C.gauge.startAngle)*((S-C.gauge.min)/(C.gauge.max-C.gauge.min));return O<C.gauge.startAngle?O=C.gauge.startAngle:O>C.gauge.endAngle&&(O=C.gauge.endAngle),O}y.prototype.drawThreshold=function(C,T,S){for(var O=C.gauge.startAngle,x=0;x<C.threshold.values.length;x++){var b=C.threshold.values[x];c1=b.color,a2=g(C,T,b.value),r(l,S.cx,S.cy,T.radius+T.thresholdWidth,T.thresholdWidth-2,s(O),s(a2),c1,1,c1),O=a2}};function h(C,T,S,O,x,b,M,A,R,B){x!==b&&(l.save(),r(l,C,T,S,O,x,b,M,A,R),B&&(r(l,C,T,S,O,x,b),l.clip(),l.shadowOffsetX=0,l.shadowOffsetY=0,l.shadowBlur=10,l.shadowColor="gray",r(l,C,T,S+1,O+2,x,b,M,1)),l.restore())}y.prototype.drawLable=function(C,T,S,O,x){v(S.cx,S.y+S.cellMargin+T.labelMargin+S.offsetY,"flotGaugeLabel"+O,C.label.formatter?C.label.formatter(x.label,x.data[0][1]):text,C.label)},y.prototype.drawValue=function(C,T,S,O,x){v(S.cx,S.cy-C.value.font.size/2,"flotGaugeValue"+O,C.value.formatter?C.value.formatter(x.label,x.data[0][1]):text,C.value)},y.prototype.drawThresholdValues=function(C,T,S,O){D(C,T,S,"Min"+O,C.gauge.min,C.gauge.startAngle),D(C,T,S,"Max"+O,C.gauge.max,C.gauge.endAngle);for(var x=0;x<C.threshold.values.length;x++){var b=C.threshold.values[x];if(b.value>C.gauge.min&&b.value<C.gauge.max){var M=g(C,T,b.value);D(C,T,S,O+"_"+x,b.value,M)}}var A=C.gauge.neutralValue;A!=null&&A>C.gauge.min&&A<C.gauge.max&&D(C,T,S,"Neutral"+O,A,g(C,T,A))};function D(C,T,S,O,x,b){v(S.cx+(T.thresholdLabelMargin+T.thresholdLabelFontSize/2+T.radius)*Math.cos(s(b)),S.cy+(T.thresholdLabelMargin+T.thresholdLabelFontSize/2+T.radius)*Math.sin(s(b)),"flotGaugeThresholdValue"+O,C.threshold.label.formatter?C.threshold.label.formatter(x):x,C.threshold.label,b)}function v(C,T,S,O,x,b){var M=G(i).find("#"+S),A=M.length;A||(M=G("<span></span>"),M.attr("id",S),M.attr("class","flot-temp-elem"),i.append(M)),M.css("position","absolute"),M.css("top",T+"px"),M.css("white-space","nowrap"),x.font.size&&M.css("font-size",x.font.size+"px"),x.font.family&&M.css("font-family",x.font.family),x.color&&M.css("color",x.color),x.background.color&&M.css("background-color",x.background.color),x.background.opacity&&M.css("opacity",x.background.opacity),M.text(O),M.css("left",C+"px"),M.css("left",parseInt(M.css("left"))-M.width()/2+"px"),!A&&b&&(M.css("top",parseInt(M.css("top"))-M.height()/2+"px"),M.css("transform","rotate("+(180*b+90)+"deg)"))}return y}();function e(l){return typeof Logger<"u"?new Logger(l):null}function t(l,i){return i%l}function n(l,i){return Math.floor(i/l)}function s(l){return l*Math.PI}function r(l,i,u,d,p,c,y,f,P,a){if(c!==y){var E=!1;l.save(),l.beginPath(),l.arc(i,u,d,c,y,E),l.lineTo(i+(d-p)*Math.cos(y),u+(d-p)*Math.sin(y)),l.arc(i,u,d-p,y,c,!E),l.closePath(),P&&(l.lineWidth=P),f&&(l.strokeStyle=f,l.stroke()),a&&(l.fillStyle=a,l.fill()),l.restore()}}function o(l){l.hooks.processOptions.push(function(i,u){var d=e(u.series.gauges.debug);u.series.gauges.show&&(u.grid.show=!1,u.legend.show=!1);var p=u.series.gauges.threshold.values;p.sort(function(c,y){return c.value<y.value?-1:c.value>y.value?1:0})}),l.hooks.draw.push(function(i,u){var d=i.getOptions(),p=d.series.gauges,c=e(p.debug);if(p.show){var y=i.getData();if(!(!y||!y.length)){var f=new I(i,u),P=f.calculateLayout();p.debug.layout,f.drawBackground(P);for(var a=0;a<y.length;a++){var E=y[a],g=G.extend({},p,E.gauges);E.gauges&&f.calculateAutoValues(g,P.cellWidth);var h=f.calculateCellLayout(g,P,a);f.drawCellBackground(g,h),g.debug.layout,g.label.show&&f.drawLable(g,P,h,a,E),f.drawGauge(g,P,h,E.label,E.data[0][1]),g.threshold.show&&f.drawThreshold(g,P,h),g.threshold.label.show&&f.drawThresholdValues(g,P,h,a),g.value.show&&f.drawValue(g,P,h,a,E)}}}})}var m={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(l,i){return l}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(l,i){return parseInt(i)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(l){return l}},values:[]}}}};G.plot.plugins.push({init:o,options:m,name:"gauge",version:"1.1.0"})})(jQuery)},54087:()=>{(function(G){G.color={},G.color.make=function(e,t,n,s){var r={};return r.r=e||0,r.g=t||0,r.b=n||0,r.a=s??1,r.add=function(o,m){for(var l=0;l<o.length;++l)r[o.charAt(l)]+=m;return r.normalize()},r.scale=function(o,m){for(var l=0;l<o.length;++l)r[o.charAt(l)]*=m;return r.normalize()},r.toString=function(){return r.a>=1?"rgb("+[r.r,r.g,r.b].join(",")+")":"rgba("+[r.r,r.g,r.b,r.a].join(",")+")"},r.normalize=function(){function o(m,l,i){return l<m?m:l>i?i:l}return r.r=o(0,parseInt(r.r),255),r.g=o(0,parseInt(r.g),255),r.b=o(0,parseInt(r.b),255),r.a=o(0,r.a,1),r},r.clone=function(){return G.color.make(r.r,r.b,r.g,r.a)},r.normalize()},G.color.extract=function(e,t){var n;do{if(n=e.css(t).toLowerCase(),n!=""&&n!="transparent")break;e=e.parent()}while(e.length&&!G.nodeName(e.get(0),"body"));return n=="rgba(0, 0, 0, 0)"&&(n="transparent"),G.color.parse(n)},G.color.parse=function(e){var t,n=G.color.make;if(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10));if(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4]));if(t=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55);if(t=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55,parseFloat(t[4]));if(t=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return n(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16));if(t=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return n(parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16));var s=G.trim(e).toLowerCase();return s=="transparent"?n(255,255,255,0):(t=I[s]||[0,0,0],n(t[0],t[1],t[2]))};var I={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery),function(G){var I=Object.prototype.hasOwnProperty;G.fn.detach||(G.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})});function e(s,r){var o=r.children("."+s)[0];if(o==null&&(o=document.createElement("canvas"),o.className=s,G(o).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(r),!o.getContext))if(window.G_vmlCanvasManager)o=window.G_vmlCanvasManager.initElement(o);else throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=o;var m=this.context=o.getContext("2d"),l=window.devicePixelRatio||1,i=m.webkitBackingStorePixelRatio||m.mozBackingStorePixelRatio||m.msBackingStorePixelRatio||m.oBackingStorePixelRatio||m.backingStorePixelRatio||1;this.pixelRatio=l/i,this.resize(r.width(),r.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}e.prototype.resize=function(s,r){if(s<=0||r<=0)throw new Error("Invalid dimensions for plot, width = "+s+", height = "+r);var o=this.element,m=this.context,l=this.pixelRatio;this.width!=s&&(o.width=s*l,o.style.width=s+"px",this.width=s),this.height!=r&&(o.height=r*l,o.style.height=r+"px",this.height=r),m.restore(),m.save(),m.scale(l,l)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var s=this._textCache;for(var r in s)if(I.call(s,r)){var o=this.getTextLayer(r),m=s[r];o.hide();for(var l in m)if(I.call(m,l)){var i=m[l];for(var u in i)if(I.call(i,u)){for(var d=i[u].positions,p=0,c;c=d[p];p++)c.active?c.rendered||(o.append(c.element),c.rendered=!0):(d.splice(p--,1),c.rendered&&c.element.detach());d.length==0&&delete i[u]}}o.show()}},e.prototype.getTextLayer=function(s){var r=this.text[s];return r==null&&(this.textContainer==null&&(this.textContainer=G("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),r=this.text[s]=G("<div></div>").addClass(s).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),r},e.prototype.getTextInfo=function(s,r,o,m,l){var i,u,d,p;if(r=""+r,typeof o=="object"?i=o.style+" "+o.variant+" "+o.weight+" "+o.size+"px/"+o.lineHeight+"px "+o.family:i=o,u=this._textCache[s],u==null&&(u=this._textCache[s]={}),d=u[i],d==null&&(d=u[i]={}),p=d[r],p==null){var c=G("<div></div>").html(r).css({position:"absolute","max-width":l,top:-9999}).appendTo(this.getTextLayer(s));typeof o=="object"?c.css({font:i,color:o.color}):typeof o=="string"&&c.addClass(o),p=d[r]={element:c,positions:[]};var y=this._textSizeCache[r];y?(p.width=y.width,p.height=y.height):(p.width=c.outerWidth(!0),p.height=c.outerHeight(!0),this._textSizeCache[r]={width:p.width,height:p.height}),c.detach()}return p},e.prototype.addText=function(s,r,o,m,l,i,u,d,p){var c=this.getTextInfo(s,m,l,i,u),y=c.positions;d=="center"?r-=c.width/2:d=="right"&&(r-=c.width),p=="middle"?o-=c.height/2:p=="bottom"&&(o-=c.height);for(var f=0,P;P=y[f];f++)if(P.x==r&&P.y==o){P.active=!0;return}P={active:!0,rendered:!1,element:y.length?c.element.clone():c.element,x:r,y:o},y.push(P),P.element.css({top:Math.round(o),left:Math.round(r),"text-align":d})},e.prototype.removeText=function(s,r,o,m,l,i){if(m==null){var u=this._textCache[s];if(u!=null){for(var d in u)if(I.call(u,d)){var p=u[d];for(var c in p)if(I.call(p,c))for(var y=p[c].positions,f=0,P;P=y[f];f++)P.active=!1}}}else for(var y=this.getTextInfo(s,m,l,i).positions,f=0,P;P=y[f];f++)P.x==r&&P.y==o&&(P.active=!1)};function t(s,r,o,m){var l=[],i={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:16.666666666666668},hooks:{}},u=null,d=null,p=null,c=null,y=null,f=[],P=[],a={left:0,right:0,top:0,bottom:0},E=0,g=0,h={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],processRange:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},D=this;D.setData=S,D.setupGrid=H,D.draw=q,D.getPlaceholder=function(){return s},D.getCanvas=function(){return u.element},D.getPlotOffset=function(){return a},D.width=function(){return E},D.height=function(){return g},D.offset=function(){var re=p.offset();return re.left+=a.left,re.top+=a.top,re},D.getData=function(){return l},D.getAxes=function(){var re={},Z;return G.each(f.concat(P),function(oe,Ee){Ee&&(re[Ee.direction+(Ee.n!=1?Ee.n:"")+"axis"]=Ee)}),re},D.getXAxes=function(){return f},D.getYAxes=function(){return P},D.c2p=M,D.p2c=A,D.getOptions=function(){return i},D.highlight=Xe,D.unhighlight=gt,D.triggerRedrawOverlay=Ve,D.pointOffset=function(re){return{left:parseInt(f[x(re,"x")-1].p2c(+re.x)+a.left,10),top:parseInt(P[x(re,"y")-1].p2c(+re.y)+a.top,10)}},D.shutdown=w,D.destroy=function(){w(),s.removeData("plot").empty(),l=[],i=null,u=null,d=null,p=null,c=null,y=null,f=[],P=[],h=null,ve=[],D=null},D.resize=function(){var re=s.width(),Z=s.height();u.resize(re,Z),d.resize(re,Z)},D.hooks=h,C(D),T(o),W(),S(r),H(),q(),N();function v(re,Z){Z=[D].concat(Z);for(var oe=0;oe<re.length;++oe)re[oe].apply(this,Z)}function C(){for(var re={Canvas:e},Z=0;Z<m.length;++Z){var oe=m[Z];oe.init(D,re),oe.options&&G.extend(!0,i,oe.options)}}function T(re){G.extend(!0,i,re),re&&re.colors&&(i.colors=re.colors),i.xaxis.color==null&&(i.xaxis.color=G.color.parse(i.grid.color).scale("a",.22).toString()),i.yaxis.color==null&&(i.yaxis.color=G.color.parse(i.grid.color).scale("a",.22).toString()),i.xaxis.tickColor==null&&(i.xaxis.tickColor=i.grid.tickColor||i.xaxis.color),i.yaxis.tickColor==null&&(i.yaxis.tickColor=i.grid.tickColor||i.yaxis.color),i.grid.borderColor==null&&(i.grid.borderColor=i.grid.color),i.grid.tickColor==null&&(i.grid.tickColor=G.color.parse(i.grid.color).scale("a",.22).toString());var Z,oe,Ee,ye=s.css("font-size"),Se=ye?+ye.replace("px",""):13,Be={style:s.css("font-style"),size:Math.round(.8*Se),variant:s.css("font-variant"),weight:s.css("font-weight"),family:s.css("font-family")};for(Ee=i.xaxes.length||1,Z=0;Z<Ee;++Z)oe=i.xaxes[Z],oe&&!oe.tickColor&&(oe.tickColor=oe.color),oe=G.extend(!0,{},i.xaxis,oe),i.xaxes[Z]=oe,oe.font&&(oe.font=G.extend({},Be,oe.font),oe.font.color||(oe.font.color=oe.color),oe.font.lineHeight||(oe.font.lineHeight=Math.round(oe.font.size*1.15)));for(Ee=i.yaxes.length||1,Z=0;Z<Ee;++Z)oe=i.yaxes[Z],oe&&!oe.tickColor&&(oe.tickColor=oe.color),oe=G.extend(!0,{},i.yaxis,oe),i.yaxes[Z]=oe,oe.font&&(oe.font=G.extend({},Be,oe.font),oe.font.color||(oe.font.color=oe.color),oe.font.lineHeight||(oe.font.lineHeight=Math.round(oe.font.size*1.15)));for(i.xaxis.noTicks&&i.xaxis.ticks==null&&(i.xaxis.ticks=i.xaxis.noTicks),i.yaxis.noTicks&&i.yaxis.ticks==null&&(i.yaxis.ticks=i.yaxis.noTicks),i.x2axis&&(i.xaxes[1]=G.extend(!0,{},i.xaxis,i.x2axis),i.xaxes[1].position="top",i.x2axis.min==null&&(i.xaxes[1].min=null),i.x2axis.max==null&&(i.xaxes[1].max=null)),i.y2axis&&(i.yaxes[1]=G.extend(!0,{},i.yaxis,i.y2axis),i.yaxes[1].position="right",i.y2axis.min==null&&(i.yaxes[1].min=null),i.y2axis.max==null&&(i.yaxes[1].max=null)),i.grid.coloredAreas&&(i.grid.markings=i.grid.coloredAreas),i.grid.coloredAreasColor&&(i.grid.markingsColor=i.grid.coloredAreasColor),i.lines&&G.extend(!0,i.series.lines,i.lines),i.points&&G.extend(!0,i.series.points,i.points),i.bars&&G.extend(!0,i.series.bars,i.bars),i.shadowSize!=null&&(i.series.shadowSize=i.shadowSize),i.highlightColor!=null&&(i.series.highlightColor=i.highlightColor),Z=0;Z<i.xaxes.length;++Z)R(f,Z+1).options=i.xaxes[Z];for(Z=0;Z<i.yaxes.length;++Z)R(P,Z+1).options=i.yaxes[Z];for(var We in h)i.hooks[We]&&i.hooks[We].length&&(h[We]=h[We].concat(i.hooks[We]));v(h.processOptions,[i])}function S(re){l=O(re),B(),U()}function O(re){for(var Z=[],oe=0;oe<re.length;++oe){var Ee=G.extend(!0,{},i.series);re[oe].data!=null?(Ee.data=re[oe].data,delete re[oe].data,G.extend(!0,Ee,re[oe]),re[oe].data=Ee.data):Ee.data=re[oe],Z.push(Ee)}return Z}function x(re,Z){var oe=re[Z+"axis"];return typeof oe=="object"&&(oe=oe.n),typeof oe!="number"&&(oe=1),oe}function b(){return G.grep(f.concat(P),function(re){return re})}function M(re){var Z={},oe,Ee;for(oe=0;oe<f.length;++oe)Ee=f[oe],Ee&&(Z["x"+Ee.n]=Ee.c2p(re.left));for(oe=0;oe<P.length;++oe)Ee=P[oe],Ee&&(Z["y"+Ee.n]=Ee.c2p(re.top));return Z.x1!==void 0&&(Z.x=Z.x1),Z.y1!==void 0&&(Z.y=Z.y1),Z}function A(re){var Z={},oe,Ee,ye;for(oe=0;oe<f.length;++oe)if(Ee=f[oe],Ee&&Ee.used&&(ye="x"+Ee.n,re[ye]==null&&Ee.n==1&&(ye="x"),re[ye]!=null)){Z.left=Ee.p2c(re[ye]);break}for(oe=0;oe<P.length;++oe)if(Ee=P[oe],Ee&&Ee.used&&(ye="y"+Ee.n,re[ye]==null&&Ee.n==1&&(ye="y"),re[ye]!=null)){Z.top=Ee.p2c(re[ye]);break}return Z}function R(re,Z){return re[Z-1]||(re[Z-1]={n:Z,direction:re==f?"x":"y",options:G.extend(!0,{},re==f?i.xaxis:i.yaxis)}),re[Z-1]}function B(){var re=l.length,Z=-1,oe;for(oe=0;oe<l.length;++oe){var Ee=l[oe].color;Ee!=null&&(re--,typeof Ee=="number"&&Ee>Z&&(Z=Ee))}re<=Z&&(re=Z+1);var ye,Se=[],Be=i.colors,We=Be.length,Ke=0;for(oe=0;oe<re;oe++)ye=G.color.parse(Be[oe%We]||"#666"),oe%We==0&&oe&&(Ke>=0?Ke<.5?Ke=-Ke-.2:Ke=0:Ke=-Ke),Se[oe]=ye.scale("rgb",1+Ke);var it=0,rt;for(oe=0;oe<l.length;++oe){if(rt=l[oe],rt.color==null?(rt.color=Se[it].toString(),++it):typeof rt.color=="number"&&(rt.color=Se[rt.color].toString()),rt.lines.show==null){var ft,pt=!0;for(ft in rt)if(rt[ft]&&rt[ft].show){pt=!1;break}pt&&(rt.lines.show=!0)}rt.lines.zero==null&&(rt.lines.zero=!!rt.lines.fill),rt.xaxis=R(f,x(rt,"x")),rt.yaxis=R(P,x(rt,"y"))}}function U(){var re=Number.POSITIVE_INFINITY,Z=Number.NEGATIVE_INFINITY,oe=Number.MAX_VALUE,Ee,ye,Se,Be,We,Ke,it,rt,ft,pt,Ge,qe,bt,Ft,Xt,Lt;function Qt(ln,bn,In){bn<ln.datamin&&bn!=-oe&&(ln.datamin=bn),In>ln.datamax&&In!=oe&&(ln.datamax=In)}for(G.each(b(),function(ln,bn){bn.datamin=re,bn.datamax=Z,bn.used=!1}),Ee=0;Ee<l.length;++Ee)Ke=l[Ee],Ke.datapoints={points:[]},v(h.processRawData,[Ke,Ke.data,Ke.datapoints]);for(Ee=0;Ee<l.length;++Ee){if(Ke=l[Ee],Xt=Ke.data,Lt=Ke.datapoints.format,!Lt){if(Lt=[],Lt.push({x:!0,number:!0,required:!0}),Lt.push({y:!0,number:!0,required:!0}),Ke.stack||Ke.bars.show||Ke.lines.show&&Ke.lines.fill){var an=!!(Ke.bars.show&&Ke.bars.zero||Ke.lines.show&&Ke.lines.zero);Lt.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:an}),Ke.bars.horizontal&&(delete Lt[Lt.length-1].y,Lt[Lt.length-1].x=!0)}Ke.datapoints.format=Lt}if(Ke.datapoints.pointsize==null){Ke.datapoints.pointsize=Lt.length,rt=Ke.datapoints.pointsize,it=Ke.datapoints.points;var gn=Ke.lines.show&&Ke.lines.steps;for(Ke.xaxis.used=Ke.yaxis.used=!0,ye=Se=0;ye<Xt.length;++ye,Se+=rt){Ft=Xt[ye];var ut=Ft==null;if(!ut)for(Be=0;Be<rt;++Be)qe=Ft[Be],bt=Lt[Be],bt&&(bt.number&&qe!=null&&(qe=+qe,isNaN(qe)?qe=null:qe==1/0?qe=oe:qe==-1/0&&(qe=-oe)),qe==null&&(bt.required&&(ut=!0),bt.defaultValue!=null&&(qe=bt.defaultValue))),it[Se+Be]=qe;if(ut)for(Be=0;Be<rt;++Be)qe=it[Se+Be],qe!=null&&(bt=Lt[Be],bt.autoscale!==!1&&(bt.x&&Qt(Ke.xaxis,qe,qe),bt.y&&Qt(Ke.yaxis,qe,qe))),it[Se+Be]=null;if(gn&&Se>0&&(!ut||it[Se-rt]!=null)){for(Be=0;Be<rt;++Be)it[Se+rt+Be]=it[Se+Be];it[Se+1]=it[Se-rt+1]||0,ut&&(it[Se]=Ft[0]),Se+=rt}}}}for(Ee=0;Ee<l.length;++Ee){if(Ke=l[Ee],it=Ke.datapoints.points,rt=Ke.datapoints.pointsize,Ke.transform==="negative-Y")for(ye=0;ye<it.length;ye+=rt)it[ye]!=null&&(qe=it[ye+1],it[ye+1]=-qe);v(h.processDatapoints,[Ke,Ke.datapoints])}for(Ee=0;Ee<l.length;++Ee){Ke=l[Ee],it=Ke.datapoints.points,rt=Ke.datapoints.pointsize,Lt=Ke.datapoints.format;var Nt=re,ht=re,Rt=Z,_t=Z;for(ye=0;ye<it.length;ye+=rt)if(it[ye]!=null)for(Be=0;Be<rt;++Be)qe=it[ye+Be],bt=Lt[Be],!(!bt||bt.autoscale===!1||qe==oe||qe==-oe)&&(bt.x&&(qe<Nt&&(Nt=qe),qe>Rt&&(Rt=qe)),bt.y&&(qe<ht&&(ht=qe),qe>_t&&(_t=qe)));if(Ke.bars.show){var on;switch(Ke.bars.align){case"left":on=0;break;case"right":on=-Ke.bars.barWidth;break;default:on=-Ke.bars.barWidth/2}Ke.bars.horizontal?(ht+=on,_t+=on+Ke.bars.barWidth):(Nt+=on,Rt+=on+Ke.bars.barWidth)}Qt(Ke.xaxis,Nt,Rt),Qt(Ke.yaxis,ht,_t)}G.each(b(),function(ln,bn){bn.datamin==re&&(bn.datamin=null),bn.datamax==Z&&(bn.datamax=null)})}function W(){s.find(".flot-temp-elem").remove(),s.css("position")=="static"&&s.css("position","relative"),u=new e("flot-base",s),d=new e("flot-overlay",s),c=u.context,y=d.context,p=G(d.element).unbind();var re=s.data("plot");re&&(re.shutdown(),d.clear()),s.data("plot",D)}function N(){i.grid.hoverable&&(p.mousemove(Me),p.bind("mouseleave",Ue),G(document).bind("touchend",Re)),i.grid.clickable&&p.click(we),v(h.bindEvents,[p])}function w(){be&&clearTimeout(be),p.unbind("mousemove",Me),p.unbind("mouseleave",Ue),p.unbind("click",we),G(document).unbind("touchend",Re),v(h.shutdown,[p])}function L(re){function Z(Be){return Be}var oe,Ee,ye=re.options.transform||Z,Se=re.options.inverseTransform;re.direction=="x"?(oe=re.scale=E/Math.abs(ye(re.max)-ye(re.min)),Ee=Math.min(ye(re.max),ye(re.min))):(oe=re.scale=g/Math.abs(ye(re.max)-ye(re.min)),oe=-oe,Ee=Math.max(ye(re.max),ye(re.min))),ye==Z?re.p2c=function(Be){return(Be-Ee)*oe}:re.p2c=function(Be){return(ye(Be)-Ee)*oe},Se?re.c2p=function(Be){return Se(Ee+Be/oe)}:re.c2p=function(Be){return Ee+Be/oe}}function V(re){for(var Z=re.options,oe=re.ticks||[],Ee=Z.labelWidth||0,ye=Z.labelHeight||0,Se=Ee||(re.direction=="x"?Math.floor(u.width/(oe.length||1)):null),Be=re.direction+"Axis "+re.direction+re.n+"Axis",We="flot-"+re.direction+"-axis flot-"+re.direction+re.n+"-axis "+Be,Ke=Z.font||"flot-tick-label tickLabel",it=0;it<oe.length;++it){var rt=oe[it];if(rt.label){var ft=u.getTextInfo(We,rt.label,Ke,null,Se);Ee=Math.max(Ee,ft.width+1),ye=Math.max(ye,ft.height)}}re.labelWidth=Z.labelWidth||Ee,re.labelHeight=Z.labelHeight||ye}function K(re){var Z=re.labelWidth,oe=re.labelHeight,Ee=re.options.position,ye=re.direction==="x",Se=re.options.tickLength,Be=i.grid.axisMargin,We=i.grid.labelMargin,Ke=i.grid.eventSectionHeight,it=!0,rt=!0,ft=!0,pt=!1;G.each(ye?f:P,function(Ge,qe){qe&&(qe.show||qe.reserveSpace)&&(qe===re?pt=!0:qe.options.position===Ee&&(pt?rt=!1:it=!1),pt||(ft=!1))}),rt&&(Be=0),Se==null&&(Se=ft?"full":5),isNaN(+Se)||(We+=+Se),ye?(oe+=We,oe+=Ke,Ee=="bottom"?(a.bottom+=oe+Be,re.box={top:u.height-a.bottom,height:oe}):(re.box={top:a.top+Be,height:oe},a.top+=oe+Be)):(Z+=We,Ee=="left"?(re.box={left:a.left+Be,width:Z},a.left+=Z+Be):(a.right+=Z+Be,re.box={left:u.width-a.right,width:Z})),re.position=Ee,re.tickLength=Se,re.box.padding=We,re.box.eventSectionPadding=Ke,re.innermost=it}function k(re){re.direction=="x"?(re.box.left=a.left-re.labelWidth/2,re.box.width=u.width-a.left-a.right+re.labelWidth):(re.box.top=a.top-re.labelHeight/2,re.box.height=u.height-a.bottom-a.top+re.labelHeight)}function j(){var re=i.grid.minBorderMargin,Z,oe;if(re==null)for(re=0,oe=0;oe<l.length;++oe)re=Math.max(re,2*(l[oe].points.radius+l[oe].points.lineWidth/2));var Ee={left:re,right:re,top:re,bottom:re};G.each(b(),function(ye,Se){Se.reserveSpace&&Se.ticks&&Se.ticks.length&&(Se.direction==="x"?(Ee.left=Math.max(Ee.left,Se.labelWidth/2),Ee.right=Math.max(Ee.right,Se.labelWidth/2)):(Ee.bottom=Math.max(Ee.bottom,Se.labelHeight/2),Ee.top=Math.max(Ee.top,Se.labelHeight/2)))}),a.left=Math.ceil(Math.max(Ee.left,a.left)),a.right=Math.ceil(Math.max(Ee.right,a.right)),a.top=Math.ceil(Math.max(Ee.top,a.top)),a.bottom=Math.ceil(Math.max(Ee.bottom,a.bottom))}function H(){var re,Z=b(),oe=i.grid.show;for(var Ee in a){var ye=i.grid.margin||0;a[Ee]=typeof ye=="number"?ye:ye[Ee]||0}v(h.processOffset,[a]);for(var Ee in a)typeof i.grid.borderWidth=="object"?a[Ee]+=oe?i.grid.borderWidth[Ee]:0:a[Ee]+=oe?i.grid.borderWidth:0;if(G.each(Z,function(We,Ke){var it=Ke.options;Ke.show=it.show==null?Ke.used:it.show,Ke.reserveSpace=it.reserveSpace==null?Ke.show:it.reserveSpace,J(Ke)}),v(h.processRange,[]),oe){for(var Se=G.grep(Z,function(We){return We.show||We.reserveSpace}),Be=!1,re=0;re<2&&(G.each(Se,function(Ke,it){se(it),ae(it),Be=ne(it,it.ticks)||Be,V(it)}),Be&&h.processRange.length>0);re++)v(h.processRange,[]),Be=!1;for(re=Se.length-1;re>=0;--re)K(Se[re]);j(),G.each(Se,function(We,Ke){k(Ke)})}E=u.width-a.left-a.right,g=u.height-a.bottom-a.top,G.each(Z,function(We,Ke){L(Ke)}),oe&&ie(),pe()}function J(re){var Z=re.options,oe=+(Z.min!=null?Z.min:re.datamin),Ee=+(Z.max!=null?Z.max:re.datamax),ye=Ee-oe;if(ye==0){var Se=.25,Be=Math.abs(Ee==0?1:Ee*Se);Z.min==null&&(oe-=Be),(Z.max==null||Z.min!=null)&&(Ee+=Be)}else{var We=Z.autoscaleMargin;We!=null&&(Z.min==null&&(oe-=ye*We,oe<0&&re.datamin!=null&&re.datamin>=0&&(oe=0)),Z.max==null&&(Ee+=ye*We,Ee>0&&re.datamax!=null&&re.datamax<=0&&(Ee=0)))}re.min=oe,re.max=Ee}function X(re){if(re=Math.abs(String(re).replace(".","")),re==0)return 0;for(;re!=0&&re%10==0;)re/=10;return Math.floor(Math.log(re)/Math.LN10)+1}function se(re){var Z=re.options,oe;typeof Z.ticks=="number"&&Z.ticks>0?oe=Z.ticks:oe=.3*Math.sqrt(re.direction=="x"?u.width:u.height);var Ee=(re.max-re.min)/oe,ye=-Math.floor(Math.log(Ee)/Math.LN10),Se=Z.tickDecimals;Se!=null&&ye>Se&&(ye=Se);var Be=Math.pow(10,-ye),We=Ee/Be,Ke;if(We<1.5?Ke=1:We<3?(Ke=2,We>2.25&&(Se==null||ye+1<=Se)&&(Ke=2.5,++ye)):We<7.5?Ke=5:Ke=10,Ke*=Be,Z.minTickSize!=null&&Ke<Z.minTickSize&&(Ke=Z.minTickSize),re.delta=Ee,re.tickDecimals=Math.max(0,Se??ye),re.tickSize=Z.tickSize||Ke,Z.mode=="time"&&!re.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(re.tickGenerator||(re.tickGenerator=function(Ge){var qe=[],bt=n(Ge.min,Ge.tickSize),Ft=0,Xt=Number.NaN,Lt;do Lt=Xt,Xt=bt+Ft*Ge.tickSize,qe.push(Xt),++Ft;while(Xt<Ge.max&&Xt!=Lt);return qe},re.tickFormatter=function(Ge,qe){var bt=qe.tickDecimals?Math.pow(10,qe.tickDecimals):1,Ft=""+Math.round(Ge*bt)/bt;if(qe.tickDecimals!=null){var Xt=Ft.indexOf("."),Lt=Xt==-1?0:Ft.length-Xt-1;if(Lt<qe.tickDecimals)return(Lt?Ft:Ft+".")+(""+bt).substr(1,qe.tickDecimals-Lt)}return Ft}),G.isFunction(Z.tickFormatter)&&(re.tickFormatter=function(Ge,qe){return""+Z.tickFormatter(Ge,qe)}),Z.alignTicksWithAxis!=null){var it=(re.direction=="x"?f:P)[Z.alignTicksWithAxis-1];if(it&&it.used&&it!=re){var rt=re.tickGenerator(re);if(rt.length>0&&(Z.min==null&&(re.min=Math.min(re.min,rt[0])),Z.max==null&&rt.length>1&&(re.max=Math.max(re.max,rt[rt.length-1]))),re.tickGenerator=function(Ge){var qe=[],bt,Ft;for(Ft=0;Ft<it.ticks.length;++Ft)bt=(it.ticks[Ft].v-it.min)/(it.max-it.min),bt=Ge.min+bt*(Ge.max-Ge.min),qe.push(bt);return qe},!re.mode&&Z.tickDecimals==null){var ft=Math.max(0,-Math.floor(Math.log(re.delta)/Math.LN10)+1),pt=re.tickGenerator(re);pt.length>1&&/\..*0$/.test((pt[1]-pt[0]).toFixed(ft))||(re.tickDecimals=ft)}}}}function ae(re){var Z=re.options.ticks,oe=[];Z==null||typeof Z=="number"&&Z>0?oe=re.tickGenerator(re):Z&&(G.isFunction(Z)?oe=Z(re):oe=Z);var Ee,ye;for(re.ticks=[],Ee=0;Ee<oe.length;++Ee){var Se=null,Be=oe[Ee];typeof Be=="object"?(ye=+Be[0],Be.length>1&&(Se=Be[1])):ye=+Be,Se==null&&(Se=re.tickFormatter(ye,re)),isNaN(ye)||re.ticks.push({v:ye,label:Se})}}function ne(re,Z){var oe=!1;return re.options.autoscaleMargin&&Z.length>0&&(re.options.min==null&&(re.min=Math.min(re.min,Z[0].v),oe=!0),re.options.max==null&&Z.length>1&&(re.max=Math.max(re.max,Z[Z.length-1].v),oe=!0)),oe}function q(){u.clear(),v(h.drawBackground,[c]);var re=i.grid;re.show&&re.backgroundColor&&z(),re.show&&!re.aboveData&&te();for(var Z=0;Z<l.length;++Z)v(h.drawSeries,[c,l[Z]]),ue(l[Z]);v(h.draw,[c]),re.show&&re.aboveData&&te(),u.render(),Ve()}function ee(re,Z){for(var oe,Ee,ye,Se,Be=b(),We=0;We<Be.length;++We)if(oe=Be[We],oe.direction==Z&&(Se=Z+oe.n+"axis",!re[Se]&&oe.n==1&&(Se=Z+"axis"),re[Se])){Ee=re[Se].from,ye=re[Se].to;break}if(re[Se]||(oe=Z=="x"?f[0]:P[0],Ee=re[Z+"1"],ye=re[Z+"2"]),Ee!=null&&ye!=null&&Ee>ye){var Ke=Ee;Ee=ye,ye=Ke}return{from:Ee,to:ye,axis:oe}}function z(){c.save(),c.translate(a.left,a.top),c.fillStyle=Ae(i.grid.backgroundColor,g,0,"rgba(255, 255, 255, 0)"),c.fillRect(0,0,E,g),c.restore()}function te(){var re,Z,oe,Ee;c.save(),c.translate(a.left,a.top);var ye=i.grid.markings;if(ye)for(G.isFunction(ye)&&(Z=D.getAxes(),Z.xmin=Z.xaxis.min,Z.xmax=Z.xaxis.max,Z.ymin=Z.yaxis.min,Z.ymax=Z.yaxis.max,ye=ye(Z)),re=0;re<ye.length;++re){var Se=ye[re],Be=ee(Se,"x"),We=ee(Se,"y");if(Be.from==null&&(Be.from=Be.axis.min),Be.to==null&&(Be.to=Be.axis.max),We.from==null&&(We.from=We.axis.min),We.to==null&&(We.to=We.axis.max),!(Be.to<Be.axis.min||Be.from>Be.axis.max||We.to<We.axis.min||We.from>We.axis.max)){Be.from=Math.max(Be.from,Be.axis.min),Be.to=Math.min(Be.to,Be.axis.max),We.from=Math.max(We.from,We.axis.min),We.to=Math.min(We.to,We.axis.max);var Ke=Be.from===Be.to,it=We.from===We.to;if(!(Ke&&it))if(Be.from=Math.floor(Be.axis.p2c(Be.from)),Be.to=Math.floor(Be.axis.p2c(Be.to)),We.from=Math.floor(We.axis.p2c(We.from)),We.to=Math.floor(We.axis.p2c(We.to)),Ke||it){var rt=Se.lineWidth||i.grid.markingsLineWidth,ft=rt%2?.5:0;c.beginPath(),c.strokeStyle=Se.color||i.grid.markingsColor,c.lineWidth=rt,Ke?(c.moveTo(Be.to+ft,We.from),c.lineTo(Be.to+ft,We.to)):(c.moveTo(Be.from,We.to+ft),c.lineTo(Be.to,We.to+ft)),c.stroke()}else c.fillStyle=Se.color||i.grid.markingsColor,c.fillRect(Be.from,We.to,Be.to-Be.from,We.from-We.to)}}Z=b(),oe=i.grid.borderWidth;for(var pt=0;pt<Z.length;++pt){var Ge=Z[pt],qe=Ge.box,bt=Ge.tickLength,Ft,Xt,Lt,Qt;if(!(!Ge.show||Ge.ticks.length==0)){for(c.lineWidth=1,Ge.direction=="x"?(Ft=0,bt=="full"?Xt=Ge.position=="top"?0:g:Xt=qe.top-a.top+(Ge.position=="top"?qe.height:0)):(Xt=0,bt=="full"?Ft=Ge.position=="left"?0:E:Ft=qe.left-a.left+(Ge.position=="left"?qe.width:0)),Ge.innermost||(c.strokeStyle=Ge.options.color,c.beginPath(),Lt=Qt=0,Ge.direction=="x"?Lt=E+1:Qt=g+1,c.lineWidth==1&&(Ge.direction=="x"?Xt=Math.floor(Xt)+.5:Ft=Math.floor(Ft)+.5),c.moveTo(Ft,Xt),c.lineTo(Ft+Lt,Xt+Qt),c.stroke()),c.strokeStyle=Ge.options.tickColor,c.beginPath(),re=0;re<Ge.ticks.length;++re){var an=Ge.ticks[re].v;Lt=Qt=0,!(isNaN(an)||an<Ge.min||an>Ge.max||bt=="full"&&(typeof oe=="object"&&oe[Ge.position]>0||oe>0)&&(an==Ge.min||an==Ge.max))&&(Ge.direction=="x"?(Ft=Ge.p2c(an),Qt=bt=="full"?-g:bt,Ge.position=="top"&&(Qt=-Qt)):(Xt=Ge.p2c(an),Lt=bt=="full"?-E:bt,Ge.position=="left"&&(Lt=-Lt)),c.lineWidth==1&&(Ge.direction=="x"?Ft=Math.floor(Ft)+.5:Xt=Math.floor(Xt)+.5),c.moveTo(Ft,Xt),c.lineTo(Ft+Lt,Xt+Qt))}c.stroke()}}oe&&(Ee=i.grid.borderColor,typeof oe=="object"||typeof Ee=="object"?(typeof oe!="object"&&(oe={top:oe,right:oe,bottom:oe,left:oe}),typeof Ee!="object"&&(Ee={top:Ee,right:Ee,bottom:Ee,left:Ee}),oe.top>0&&(c.strokeStyle=Ee.top,c.lineWidth=oe.top,c.beginPath(),c.moveTo(0-oe.left,0-oe.top/2),c.lineTo(E,0-oe.top/2),c.stroke()),oe.right>0&&(c.strokeStyle=Ee.right,c.lineWidth=oe.right,c.beginPath(),c.moveTo(E+oe.right/2,0-oe.top),c.lineTo(E+oe.right/2,g),c.stroke()),oe.bottom>0&&(c.strokeStyle=Ee.bottom,c.lineWidth=oe.bottom,c.beginPath(),c.moveTo(E+oe.right,g+oe.bottom/2),c.lineTo(0,g+oe.bottom/2),c.stroke()),oe.left>0&&(c.strokeStyle=Ee.left,c.lineWidth=oe.left,c.beginPath(),c.moveTo(0-oe.left/2,g+oe.bottom),c.lineTo(0-oe.left/2,0),c.stroke())):(c.lineWidth=oe,c.strokeStyle=i.grid.borderColor,c.strokeRect(-oe/2,-oe/2,E+oe,g+oe))),c.restore()}function ie(){G.each(b(),function(re,Z){var oe=Z.box,Ee=Z.direction+"Axis "+Z.direction+Z.n+"Axis",ye="flot-"+Z.direction+"-axis flot-"+Z.direction+Z.n+"-axis "+Ee,Se=Z.options.font||"flot-tick-label tickLabel",Be,We,Ke,it,rt;if(u.removeText(ye),!(!Z.show||Z.ticks.length==0))for(var ft=0;ft<Z.ticks.length;++ft)Be=Z.ticks[ft],!(!Be.label||Be.v<Z.min||Be.v>Z.max)&&(Z.direction=="x"?(it="center",We=a.left+Z.p2c(Be.v),Z.position=="bottom"?Ke=oe.top+oe.padding+oe.eventSectionPadding:(Ke=oe.top+oe.height-oe.padding,rt="bottom")):(rt="middle",Ke=a.top+Z.p2c(Be.v),Z.position=="left"?(We=oe.left+oe.width-oe.padding,it="right"):We=oe.left+oe.padding),u.addText(ye,We,Ke,Be.label,Se,null,null,it,rt))})}function ce(re){for(var Z=[],oe=null,Ee=null,ye=re.datapoints,Se=[],Be=0;Be<ye.pointsize-2;Be++)Se.push(0);for(var We=0;We<ye.points.length;We+=ye.pointsize){var Ke=ye.points[We],it=ye.points[We+1];We===ye.points.length-ye.pointsize?Ee=null:Ee=ye.points[We+ye.pointsize],Ke!==null&&it!==null&&oe===null&&Ee===null&&(Z.push(Ke),Z.push(it),Z.push.apply(Z,Se)),oe=Ke}var rt=ye.points;ye.points=Z,re.points.radius=re.lines.lineWidth/2,Te(re),ye.points=rt}function ue(re){re.lines.show&&(fe(re),!re.points.show&&!re.bars.show&&ce(re)),re.bars.show&&de(re),re.points.show&&Te(re)}function fe(re){function Z(We,Ke,it,rt,ft){var pt=We.points,Ge=We.pointsize,qe=null,bt=null;c.beginPath();for(var Ft=Ge;Ft<pt.length;Ft+=Ge){var Xt=pt[Ft-Ge],Lt=pt[Ft-Ge+1],Qt=pt[Ft],an=pt[Ft+1];if(!(Xt==null||Qt==null)){if(Lt<=an&&Lt<ft.min){if(an<ft.min)continue;Xt=(ft.min-Lt)/(an-Lt)*(Qt-Xt)+Xt,Lt=ft.min}else if(an<=Lt&&an<ft.min){if(Lt<ft.min)continue;Qt=(ft.min-Lt)/(an-Lt)*(Qt-Xt)+Xt,an=ft.min}if(Lt>=an&&Lt>ft.max){if(an>ft.max)continue;Xt=(ft.max-Lt)/(an-Lt)*(Qt-Xt)+Xt,Lt=ft.max}else if(an>=Lt&&an>ft.max){if(Lt>ft.max)continue;Qt=(ft.max-Lt)/(an-Lt)*(Qt-Xt)+Xt,an=ft.max}if(Xt<=Qt&&Xt<rt.min){if(Qt<rt.min)continue;Lt=(rt.min-Xt)/(Qt-Xt)*(an-Lt)+Lt,Xt=rt.min}else if(Qt<=Xt&&Qt<rt.min){if(Xt<rt.min)continue;an=(rt.min-Xt)/(Qt-Xt)*(an-Lt)+Lt,Qt=rt.min}if(Xt>=Qt&&Xt>rt.max){if(Qt>rt.max)continue;Lt=(rt.max-Xt)/(Qt-Xt)*(an-Lt)+Lt,Xt=rt.max}else if(Qt>=Xt&&Qt>rt.max){if(Xt>rt.max)continue;an=(rt.max-Xt)/(Qt-Xt)*(an-Lt)+Lt,Qt=rt.max}(Xt!=qe||Lt!=bt)&&c.moveTo(rt.p2c(Xt)+Ke,ft.p2c(Lt)+it),qe=Qt,bt=an,c.lineTo(rt.p2c(Qt)+Ke,ft.p2c(an)+it)}}c.stroke()}function oe(We,Ke,it){for(var rt=We.points,ft=We.pointsize,pt=Math.min(Math.max(0,it.min),it.max),Ge=0,qe,bt=!1,Ft=1,Xt=0,Lt=0;!(ft>0&&Ge>rt.length+ft);){Ge+=ft;var Qt=rt[Ge-ft],an=rt[Ge-ft+Ft],gn=rt[Ge],ut=rt[Ge+Ft];if(bt){if(ft>0&&Qt!=null&&gn==null){Lt=Ge,ft=-ft,Ft=2;continue}if(ft<0&&Ge==Xt+ft){c.fill(),bt=!1,ft=-ft,Ft=1,Ge=Xt=Lt+ft;continue}}if(!(Qt==null||gn==null)){if(Qt<=gn&&Qt<Ke.min){if(gn<Ke.min)continue;an=(Ke.min-Qt)/(gn-Qt)*(ut-an)+an,Qt=Ke.min}else if(gn<=Qt&&gn<Ke.min){if(Qt<Ke.min)continue;ut=(Ke.min-Qt)/(gn-Qt)*(ut-an)+an,gn=Ke.min}if(Qt>=gn&&Qt>Ke.max){if(gn>Ke.max)continue;an=(Ke.max-Qt)/(gn-Qt)*(ut-an)+an,Qt=Ke.max}else if(gn>=Qt&&gn>Ke.max){if(Qt>Ke.max)continue;ut=(Ke.max-Qt)/(gn-Qt)*(ut-an)+an,gn=Ke.max}if(bt||(c.beginPath(),c.moveTo(Ke.p2c(Qt),it.p2c(pt)),bt=!0),an>=it.max&&ut>=it.max){c.lineTo(Ke.p2c(Qt),it.p2c(it.max)),c.lineTo(Ke.p2c(gn),it.p2c(it.max));continue}else if(an<=it.min&&ut<=it.min){c.lineTo(Ke.p2c(Qt),it.p2c(it.min)),c.lineTo(Ke.p2c(gn),it.p2c(it.min));continue}var Nt=Qt,ht=gn;an<=ut&&an<it.min&&ut>=it.min?(Qt=(it.min-an)/(ut-an)*(gn-Qt)+Qt,an=it.min):ut<=an&&ut<it.min&&an>=it.min&&(gn=(it.min-an)/(ut-an)*(gn-Qt)+Qt,ut=it.min),an>=ut&&an>it.max&&ut<=it.max?(Qt=(it.max-an)/(ut-an)*(gn-Qt)+Qt,an=it.max):ut>=an&&ut>it.max&&an<=it.max&&(gn=(it.max-an)/(ut-an)*(gn-Qt)+Qt,ut=it.max),Qt!=Nt&&c.lineTo(Ke.p2c(Nt),it.p2c(an)),c.lineTo(Ke.p2c(Qt),it.p2c(an)),c.lineTo(Ke.p2c(gn),it.p2c(ut)),gn!=ht&&(c.lineTo(Ke.p2c(gn),it.p2c(ut)),c.lineTo(Ke.p2c(ht),it.p2c(ut)))}}}c.save(),c.translate(a.left,a.top),c.lineJoin="round";var Ee=re.lines.lineWidth,ye=re.shadowSize;if(Ee>0&&ye>0){c.lineWidth=ye,c.strokeStyle="rgba(0,0,0,0.1)";var Se=Math.PI/18;Z(re.datapoints,Math.sin(Se)*(Ee/2+ye/2),Math.cos(Se)*(Ee/2+ye/2),re.xaxis,re.yaxis),c.lineWidth=ye/2,Z(re.datapoints,Math.sin(Se)*(Ee/2+ye/4),Math.cos(Se)*(Ee/2+ye/4),re.xaxis,re.yaxis)}c.lineWidth=Ee,c.strokeStyle=re.color;var Be=le(re.lines,re.color,0,g);Be&&(c.fillStyle=Be,oe(re.datapoints,re.xaxis,re.yaxis)),Ee>0&&Z(re.datapoints,0,0,re.xaxis,re.yaxis),c.restore()}function Te(re){function Z(We,Ke,it,rt,ft,pt,Ge,qe){for(var bt=We.points,Ft=We.pointsize,Xt=0;Xt<bt.length;Xt+=Ft){var Lt=bt[Xt],Qt=bt[Xt+1];Lt==null||Lt<pt.min||Lt>pt.max||Qt<Ge.min||Qt>Ge.max||(c.beginPath(),Lt=pt.p2c(Lt),Qt=Ge.p2c(Qt)+rt,qe=="circle"?c.arc(Lt,Qt,Ke,0,ft?Math.PI:Math.PI*2,!1):qe(c,Lt,Qt,Ke,ft),c.closePath(),it&&(c.fillStyle=it,c.fill()),c.stroke())}}c.save(),c.translate(a.left,a.top);var oe=re.points.lineWidth,Ee=re.shadowSize,ye=re.points.radius,Se=re.points.symbol;if(oe==0&&(oe=1e-4),oe>0&&Ee>0){var Be=Ee/2;c.lineWidth=Be,c.strokeStyle="rgba(0,0,0,0.1)",Z(re.datapoints,ye,null,Be+Be/2,!0,re.xaxis,re.yaxis,Se),c.strokeStyle="rgba(0,0,0,0.2)",Z(re.datapoints,ye,null,Be/2,!0,re.xaxis,re.yaxis,Se)}c.lineWidth=oe,c.strokeStyle=re.color,Z(re.datapoints,ye,le(re.points,re.color),0,!1,re.xaxis,re.yaxis,Se),c.restore()}function he(re,Z,oe,Ee,ye,Se,Be,We,Ke,it,rt){var ft,pt,Ge,qe,bt,Ft,Xt,Lt,Qt;it?(Lt=Ft=Xt=!0,bt=!1,ft=oe,pt=re,qe=Z+Ee,Ge=Z+ye,pt<ft&&(Qt=pt,pt=ft,ft=Qt,bt=!0,Ft=!1)):(bt=Ft=Xt=!0,Lt=!1,ft=re+Ee,pt=re+ye,Ge=oe,qe=Z,qe<Ge&&(Qt=qe,qe=Ge,Ge=Qt,Lt=!0,Xt=!1)),!(pt<Be.min||ft>Be.max||qe<We.min||Ge>We.max)&&(ft<Be.min&&(ft=Be.min,bt=!1),pt>Be.max&&(pt=Be.max,Ft=!1),Ge<We.min&&(Ge=We.min,Lt=!1),qe>We.max&&(qe=We.max,Xt=!1),ft=Be.p2c(ft),Ge=We.p2c(Ge),pt=Be.p2c(pt),qe=We.p2c(qe),Se&&(Ke.fillStyle=Se(Ge,qe),Ke.fillRect(ft,qe,pt-ft,Ge-qe)),rt>0&&(bt||Ft||Xt||Lt)&&(Ke.beginPath(),Ke.moveTo(ft,Ge),bt?Ke.lineTo(ft,qe):Ke.moveTo(ft,qe),Xt?Ke.lineTo(pt,qe):Ke.moveTo(pt,qe),Ft?Ke.lineTo(pt,Ge):Ke.moveTo(pt,Ge),Lt?Ke.lineTo(ft,Ge):Ke.moveTo(ft,Ge),Ke.stroke()))}function de(re){function Z(ye,Se,Be,We,Ke,it){for(var rt=ye.points,ft=ye.pointsize,pt=0;pt<rt.length;pt+=ft)rt[pt]!=null&&he(rt[pt],rt[pt+1],rt[pt+2],Se,Be,We,Ke,it,c,re.bars.horizontal,re.bars.lineWidth)}c.save(),c.translate(a.left,a.top),c.lineWidth=re.bars.lineWidth,c.strokeStyle=re.color;var oe;switch(re.bars.align){case"left":oe=0;break;case"right":oe=-re.bars.barWidth;break;default:oe=-re.bars.barWidth/2}var Ee=re.bars.fill?function(ye,Se){return le(re.bars,re.color,ye,Se)}:null;Z(re.datapoints,oe,oe+re.bars.barWidth,Ee,re.xaxis,re.yaxis),c.restore()}function le(re,Z,oe,Ee){var ye=re.fill;if(!ye)return null;if(re.fillColor)return Ae(re.fillColor,oe,Ee,Z);var Se=G.color.parse(Z);return Se.a=typeof ye=="number"?ye:.4,Se.normalize(),Se.toString()}function pe(){if(i.legend.container!=null?G.find(i.legend.container).html(""):s.find(".legend").remove(),!!i.legend.show){for(var re=[],Z=[],oe=!1,Ee=i.legend.labelFormatter,ye,Se,Be=0;Be<l.length;++Be)ye=l[Be],ye.label&&(Se=Ee?Ee(ye.label,ye):ye.label,Se&&Z.push({label:Se,color:ye.color}));if(i.legend.sorted)if(G.isFunction(i.legend.sorted))Z.sort(i.legend.sorted);else if(i.legend.sorted=="reverse")Z.reverse();else{var We=i.legend.sorted!="descending";Z.sort(function(Ft,Xt){return Ft.label==Xt.label?0:Ft.label<Xt.label!=We?1:-1})}for(var Be=0;Be<Z.length;++Be){var Ke=Z[Be];Be%i.legend.noColumns==0&&(oe&&re.push("</tr>"),re.push("<tr>"),oe=!0),re.push('<td class="legendColorBox"><div style="border:1px solid '+i.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+Ke.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+Ke.label+"</td>")}if(oe&&re.push("</tr>"),re.length!=0){var it='<table style="font-size:smaller;color:'+i.grid.color+'">'+re.join("")+"</table>";if(i.legend.container!=null)G(i.legend.container).html(it);else{var rt="",ft=i.legend.position,pt=i.legend.margin;pt[0]==null&&(pt=[pt,pt]),ft.charAt(0)=="n"?rt+="top:"+(pt[1]+a.top)+"px;":ft.charAt(0)=="s"&&(rt+="bottom:"+(pt[1]+a.bottom)+"px;"),ft.charAt(1)=="e"?rt+="right:"+(pt[0]+a.right)+"px;":ft.charAt(1)=="w"&&(rt+="left:"+(pt[0]+a.left)+"px;");var Ge=G('<div class="legend">'+it.replace('style="','style="position:absolute;'+rt+";")+"</div>").appendTo(s);if(i.legend.backgroundOpacity!=0){var qe=i.legend.backgroundColor;qe==null&&(qe=i.grid.backgroundColor,qe&&typeof qe=="string"?qe=G.color.parse(qe):qe=G.color.extract(Ge,"background-color"),qe.a=1,qe=qe.toString());var bt=Ge.children();G('<div style="position:absolute;width:'+bt.width()+"px;height:"+bt.height()+"px;"+rt+"background-color:"+qe+';"> </div>').prependTo(Ge).css("opacity",i.legend.backgroundOpacity)}}}}}var ve=[],be=null;function Oe(re,Z,oe){var Ee=i.grid.mouseActiveRadius,ye=Ee*Ee+1,Se=null,Be=!1,We,Ke,it;for(We=l.length-1;We>=0;--We)if(oe(l[We])){var rt=l[We],ft=rt.xaxis,pt=rt.yaxis,Ge=rt.datapoints.points,qe=ft.c2p(re),bt=pt.c2p(Z),Ft=Ee/ft.scale,Xt=Ee/pt.scale;if(it=rt.datapoints.pointsize,ft.options.inverseTransform&&(Ft=Number.MAX_VALUE),pt.options.inverseTransform&&(Xt=Number.MAX_VALUE),rt.lines.show||rt.points.show)for(Ke=0;Ke<Ge.length;Ke+=it){var Lt=Ge[Ke],Qt=Ge[Ke+1];if(Lt!=null&&!(Lt-qe>Ft||Lt-qe<-Ft||Qt-bt>Xt||Qt-bt<-Xt)){var an=Math.abs(ft.p2c(Lt)-re),gn=Math.abs(pt.p2c(Qt)-Z),ut=an*an+gn*gn;ut<ye&&(ye=ut,Se=[We,Ke/it])}}if(rt.bars.show&&!Se){var Nt,ht;switch(rt.bars.align){case"left":Nt=0;break;case"right":Nt=-rt.bars.barWidth;break;default:Nt=-rt.bars.barWidth/2}for(ht=Nt+rt.bars.barWidth,Ke=0;Ke<Ge.length;Ke+=it){var Lt=Ge[Ke],Qt=Ge[Ke+1],Rt=Ge[Ke+2];Lt!=null&&(l[We].bars.horizontal?qe<=Math.max(Rt,Lt)&&qe>=Math.min(Rt,Lt)&&bt>=Qt+Nt&&bt<=Qt+ht:qe>=Lt+Nt&&qe<=Lt+ht&&bt>=Math.min(Rt,Qt)&&bt<=Math.max(Rt,Qt))&&(Se=[We,Ke/it])}}}return Se?(We=Se[0],Ke=Se[1],it=l[We].datapoints.pointsize,{datapoint:l[We].datapoints.points.slice(Ke*it,(Ke+1)*it),dataIndex:Ke,series:l[We],seriesIndex:We}):null}function Me(re){i.grid.hoverable&&xe("plothover",re,function(Z){return Z.hoverable!=!1})}function Ue(re){i.grid.hoverable&&xe("plothover",re,function(Z){return!1})}function we(re){D.isSelecting||xe("plotclick",re,function(Z){return Z.clickable!=!1})}function Re(re){if(re.cancelable){if(!p.is(re.target)&&p.has(re.target).length===0){xe("plotleave",re,function(Z){});return}Me(Fe(re)),re.preventDefault()}}function Fe(re){if(!re||!re.originalEvent||re.pageX&&re.pageY)return re;var Z=re.originalEvent;if(Z.changedTouches.length===0)return re;var oe=Z.changedTouches[0];return re.pageX=oe.pageX,re.pageY=oe.pageY,re}function xe(re,Z,oe){var Ee=p.offset(),ye=Z.pageX-Ee.left-a.left,Se=Z.pageY-Ee.top-a.top,Be=M({left:ye,top:Se});Be.pageX=Z.pageX,Be.pageY=Z.pageY,Be.ctrlKey=Z.ctrlKey,Be.metaKey=Z.metaKey;var We=Oe(ye,Se,oe);if(We&&(We.pageX=parseInt(We.series.xaxis.p2c(We.datapoint[0])+Ee.left+a.left,10),We.pageY=parseInt(We.series.yaxis.p2c(We.datapoint[1])+Ee.top+a.top,10)),i.grid.autoHighlight){for(var Ke=0;Ke<ve.length;++Ke){var it=ve[Ke];it.auto==re&&!(We&&it.series==We.series&&it.point[0]==We.datapoint[0]&&it.point[1]==We.datapoint[1])&&gt(it.series,it.point)}We&&Xe(We.series,We.datapoint,re)}s.trigger(re,[Be,We])}function Ve(){var re=i.interaction.redrawOverlayInterval;if(re==-1){$e();return}be||(be=setTimeout($e,re))}function $e(){be=null,y.save(),d.clear(),y.translate(a.left,a.top);var re,Z;for(re=0;re<ve.length;++re)Z=ve[re],Z.series.bars.show?at(Z.series,Z.point):nt(Z.series,Z.point);y.restore(),v(h.drawOverlay,[y])}function Xe(re,Z,oe){if(typeof re=="number"&&(re=l[re]),typeof Z=="number"){var Ee=re.datapoints.pointsize;Z=re.datapoints.points.slice(Ee*Z,Ee*(Z+1))}var ye=Dt(re,Z);ye==-1?(ve.push({series:re,point:Z,auto:oe}),Ve()):oe||(ve[ye].auto=!1)}function gt(re,Z){if(re==null&&Z==null){ve=[],Ve();return}if(typeof re=="number"&&(re=l[re]),typeof Z=="number"){var oe=re.datapoints.pointsize;Z=re.datapoints.points.slice(oe*Z,oe*(Z+1))}var Ee=Dt(re,Z);Ee!=-1&&(ve.splice(Ee,1),Ve())}function Dt(re,Z){for(var oe=0;oe<ve.length;++oe){var Ee=ve[oe];if(Ee.series==re&&Ee.point[0]==Z[0]&&Ee.point[1]==Z[1])return oe}return-1}function nt(re,Z){var oe=Z[0],Ee=Z[1],ye=re.xaxis,Se=re.yaxis,Be=typeof re.highlightColor=="string"?re.highlightColor:G.color.parse(re.color).scale("a",.5).toString();if(!(oe<ye.min||oe>ye.max||Ee<Se.min||Ee>Se.max)){var We=re.points.radius+re.points.lineWidth/2;y.lineWidth=We,y.strokeStyle=Be;var Ke=1.5*We;oe=ye.p2c(oe),Ee=Se.p2c(Ee),y.beginPath(),re.points.symbol=="circle"?y.arc(oe,Ee,Ke,0,2*Math.PI,!1):re.points.symbol(y,oe,Ee,Ke,!1),y.closePath(),y.stroke()}}function at(re,Z){var oe=typeof re.highlightColor=="string"?re.highlightColor:G.color.parse(re.color).scale("a",.5).toString(),Ee=oe,ye;switch(re.bars.align){case"left":ye=0;break;case"right":ye=-re.bars.barWidth;break;default:ye=-re.bars.barWidth/2}y.lineWidth=re.bars.lineWidth,y.strokeStyle=oe,he(Z[0],Z[1],Z[2]||0,ye,ye+re.bars.barWidth,function(){return Ee},re.xaxis,re.yaxis,y,re.bars.horizontal,re.bars.lineWidth)}function Ae(re,Z,oe,Ee){if(typeof re=="string")return re;for(var ye=c.createLinearGradient(0,oe,0,Z),Se=0,Be=re.colors.length;Se<Be;++Se){var We=re.colors[Se];if(typeof We!="string"){var Ke=G.color.parse(Ee);We.brightness!=null&&(Ke=Ke.scale("rgb",We.brightness)),We.opacity!=null&&(Ke.a*=We.opacity),We=Ke.toString()}ye.addColorStop(Se/(Be-1),We)}return ye}}G.plot=function(s,r,o){var m=new t(G(s),r,o,G.plot.plugins);return m},G.plot.version="0.8.3",G.plot.plugins=[],G.fn.plot=function(s,r){return this.each(function(){G.plot(this,s,r)})};function n(s,r){return r*Math.floor(s/r)}}(jQuery)},80851:()=>{(function(G){function I(e){var t={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},n={},s=null;function r(a){t.active&&(p(a),e.getPlaceholder().trigger("plotselecting",[l()]))}function o(a){a.which==1&&(document.body.focus(),document.onselectstart!==void 0&&n.onselectstart==null&&(n.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),document.ondrag!==void 0&&n.ondrag==null&&(n.ondrag=document.ondrag,document.ondrag=function(){return!1}),d(t.first,a),t.active=!0,s=function(E){m(E)},G(document).one("mouseup",s))}function m(a){return s=null,document.onselectstart!==void 0&&(document.onselectstart=n.onselectstart),document.ondrag!==void 0&&(document.ondrag=n.ondrag),t.active=!1,p(a),P()?i(a):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),setTimeout(function(){e.isSelecting=!1},10),!1}function l(){if(!P()||!t.show)return null;var a={},E=t.first,g=t.second,h=e.getAxes(),D=!0;return G.each(h,function(v,C){C.used&&(anyUsed=!1)}),G.each(h,function(v,C){if(C.used||D){var T=C.c2p(E[C.direction]),S=C.c2p(g[C.direction]);a[v]={from:Math.min(T,S),to:Math.max(T,S)}}}),a}function i(a){var E=l();E.ctrlKey=a.ctrlKey,E.metaKey=a.metaKey,e.getPlaceholder().trigger("plotselected",[E]),E.xaxis&&E.yaxis&&e.getPlaceholder().trigger("selected",[{x1:E.xaxis.from,y1:E.yaxis.from,x2:E.xaxis.to,y2:E.yaxis.to}])}function u(a,E,g){return E<a?a:E>g?g:E}function d(a,E){var g=e.getOptions(),h=e.getPlaceholder().offset(),D=e.getPlotOffset();a.x=u(0,E.pageX-h.left-D.left,e.width()),a.y=u(0,E.pageY-h.top-D.top,e.height()),g.selection.mode=="y"&&(a.x=a==t.first?0:e.width()),g.selection.mode=="x"&&(a.y=a==t.first?0:e.height())}function p(a){a.pageX!=null&&(d(t.second,a),P()?(e.isSelecting=!0,t.show=!0,e.triggerRedrawOverlay()):c(!0))}function c(a){t.show&&(t.show=!1,e.triggerRedrawOverlay(),a||e.getPlaceholder().trigger("plotunselected",[]))}function y(a,E){var g,h,D,v,C=e.getAxes();for(var T in C)if(g=C[T],g.direction==E&&(v=E+g.n+"axis",!a[v]&&g.n==1&&(v=E+"axis"),a[v])){h=a[v].from,D=a[v].to;break}if(a[v]||(g=E=="x"?e.getXAxes()[0]:e.getYAxes()[0],h=a[E+"1"],D=a[E+"2"]),h!=null&&D!=null&&h>D){var S=h;h=D,D=S}return{from:h,to:D,axis:g}}function f(a,E){var g,h,D=e.getOptions();D.selection.mode=="y"?(t.first.x=0,t.second.x=e.width()):(h=y(a,"x"),t.first.x=h.axis.p2c(h.from),t.second.x=h.axis.p2c(h.to)),D.selection.mode=="x"?(t.first.y=0,t.second.y=e.height()):(h=y(a,"y"),t.first.y=h.axis.p2c(h.from),t.second.y=h.axis.p2c(h.to)),t.show=!0,e.triggerRedrawOverlay(),!E&&P()&&i()}function P(){var a=e.getOptions().selection.minSize;return Math.abs(t.second.x-t.first.x)>=a&&Math.abs(t.second.y-t.first.y)>=a}e.clearSelection=c,e.setSelection=f,e.getSelection=l,e.hooks.bindEvents.push(function(a,E){var g=a.getOptions();g.selection.mode!=null&&(E.mousemove(r),E.mousedown(o))}),e.hooks.drawOverlay.push(function(a,E){if(t.show&&P()){var g=a.getPlotOffset(),h=a.getOptions();E.save(),E.translate(g.left,g.top);var D=G.color.parse(h.selection.color);E.strokeStyle=D.scale("a",.8).toString(),E.lineWidth=1,E.lineJoin=h.selection.shape,E.fillStyle=D.scale("a",.4).toString();var v=Math.min(t.first.x,t.second.x)+.5,C=Math.min(t.first.y,t.second.y)+.5,T=Math.abs(t.second.x-t.first.x)-1,S=Math.abs(t.second.y-t.first.y)-1;E.fillRect(v,C,T,S),E.strokeRect(v,C,T,S),E.restore()}}),e.hooks.shutdown.push(function(a,E){E.unbind("mousemove",r),E.unbind("mousedown",o),s&&(G(document).unbind("mouseup",s),document.onselectstart!==void 0&&(document.onselectstart=n.onselectstart),document.ondrag!==void 0&&(document.ondrag=n.ondrag))})}G.plot.plugins.push({init:I,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})})(jQuery)},31221:()=>{(function(G){var I={series:{stack:null}};function e(t){function n(r,o){for(var m=null,l=0;l<o.length&&r!=o[l];++l)o[l].stack==r.stack&&(m=o[l]);return m}function s(r,o,m){if(!(o.stack==null||o.stack===!1)){var l=n(o,r.getData());if(l){for(var i=m.pointsize,u=m.points,d=l.datapoints.pointsize,p=l.datapoints.points,c=[],y,f,P,a,E,g,h=o.lines.show,D=o.bars.horizontal,v=i>2&&(D?m.format[2].x:m.format[2].y),C=h&&o.lines.steps,T=D?1:0,S=D?0:1,O=0,x=0,b,M;!(O>=u.length&&x>=p.length);){if(b=c.length,O<u.length&&u[O]==null){for(M=0;M<i;++M)c.push(u[O+M]);O+=i}else if(O>=u.length){for(M=0;M<i;++M)c.push(p[x+M]);v&&(c[b+2]=p[x+S]),x+=d}else if(x>=p.length){for(M=0;M<i;++M)c.push(u[O+M]);O+=i}else if(x<p.length&&p[x]==null)x+=d;else{if(y=u[O+T],f=u[O+S],a=p[x+T],E=p[x+S],g=0,y==a){for(M=0;M<i;++M)c.push(u[O+M]);c[b+S]+=E,g=E,O+=i,x+=d}else if(y>a){if(O==0){for(M=0;M<i;++M)c.push(p[x+M]);g=E}if(O>0&&u[O-i]!=null){for(P=0,c.push(a),c.push(P+E),M=2;M<i;++M)c.push(u[O+M]);g=E}x+=d}else{for(M=0;M<i;++M)c.push(u[O+M]);x>0&&p[x-d]!=null&&(g=0),c[b+S]+=g,O+=i}fromgap=!1,b!=c.length&&v&&(c[b+2]=g)}if(C&&b!=c.length&&b>0&&c[b]!=null&&c[b]!=c[b-i]&&c[b+1]!=c[b-i+1]){for(M=0;M<i;++M)c[b+i+M]=c[b+M];c[b+1]=c[b-i+1]}}m.points=c}}}t.hooks.processDatapoints.push(s)}G.plot.plugins.push({init:e,options:I,name:"stack",version:"1.2"})})(jQuery)},91520:()=>{(function(G){var I={series:{stackpercent:null}};function e(t){var n={},s=!1,r={};function o(i,u,d,p){if(s||(s=!0,r=m(i.getData())),u.stackpercent==!0){var c=d.length;u.percents=[];var y=0,f=1;u.bars&&u.bars.horizontal&&u.bars.horizontal===!0&&(y=1,f=0);for(var P=0;P<c;P++){var a=r[d[P][y]+""];a>0?u.percents.push(d[P][f]*100/a):u.percents.push(0)}}}function m(i){var u=i.length,d={};if(u>0){for(var p=0;p<u;p++)if(i[p].stackpercent){var c=0,y=1;i[p].bars&&i[p].bars.horizontal&&i[p].bars.horizontal===!0&&(c=1,y=0);for(var f=i[p].data.length,P=0;P<f;P++){var a=0;i[p].data[P][1]!=null&&(a=i[p].data[P][y]),d[i[p].data[P][c]+""]?d[i[p].data[P][c]+""]+=a:d[i[p].data[P][c]+""]=a}}}return d}function l(i,u,d){if(u.stackpercent){s||(r=m(i.getData()));var p=[],c=0,y=1;u.bars&&u.bars.horizontal&&u.bars.horizontal===!0&&(c=1,y=0);for(var f=0;f<d.points.length;f+=3)n[d.points[f+c]]||(n[d.points[f+c]]=0),p[f+c]=d.points[f+c],p[f+y]=d.points[f+y]+n[d.points[f+c]],p[f+2]=n[d.points[f+c]],n[d.points[f+c]]+=d.points[f+y],r[p[f+c]+""]>0?(p[f+y]=p[f+y]*100/r[p[f+c]+""],p[f+2]=p[f+2]*100/r[p[f+c]+""]):(p[f+y]=0,p[f+2]=0);d.points=p}}t.hooks.processRawData.push(o),t.hooks.processDatapoints.push(l)}G.plot.plugins.push({init:e,options:I,name:"stackpercent",version:"0.1"})})(jQuery)},32176:()=>{(function(G){var I={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}};function e(u,d){return d*Math.floor(u/d)}function t(u,d,p,c){if(typeof u.strftime=="function")return u.strftime(d);var y=function(v,C){return v=""+v,C=""+(C??"0"),v.length==1?C+v:v},f=[],P=!1,a=u.getHours(),E=a<12;p==null&&(p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),c==null&&(c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var g;a>12?g=a-12:a==0?g=12:g=a;for(var h=0;h<d.length;++h){var D=d.charAt(h);if(P){switch(D){case"a":D=""+c[u.getDay()];break;case"b":D=""+p[u.getMonth()];break;case"d":D=y(u.getDate(),"");break;case"e":D=y(u.getDate()," ");break;case"h":case"H":D=y(a);break;case"I":D=y(g);break;case"l":D=y(g," ");break;case"m":D=y(u.getMonth()+1,"");break;case"M":D=y(u.getMinutes());break;case"q":D=""+(Math.floor(u.getMonth()/3)+1);break;case"S":D=y(u.getSeconds());break;case"y":D=y(u.getFullYear()%100);break;case"Y":D=""+u.getFullYear();break;case"p":D=E?"am":"pm";break;case"P":D=E?"AM":"PM";break;case"w":D=""+u.getDay();break}f.push(D),P=!1}else D=="%"?P=!0:f.push(D)}return f.join("")}function n(u){function d(f,P,a,E){f[P]=function(){return a[E].apply(a,arguments)}}var p={date:u};u.strftime!=null&&d(p,"strftime",u,"strftime"),d(p,"getTime",u,"getTime"),d(p,"setTime",u,"setTime");for(var c=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],y=0;y<c.length;y++)d(p,"get"+c[y],u,"getUTC"+c[y]),d(p,"set"+c[y],u,"setUTC"+c[y]);return p}function s(u,d){if(d.timezone=="browser")return new Date(u);if(!d.timezone||d.timezone=="utc")return n(new Date(u));if(typeof timezoneJS<"u"&&typeof timezoneJS.Date<"u"){var p=new timezoneJS.Date;return p.setTimezone(d.timezone),p.setTime(u),p}else return n(new Date(u))}var r={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:30*24*60*60*1e3,quarter:3*30*24*60*60*1e3,year:365.2425*24*60*60*1e3},o=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],m=o.concat([[3,"month"],[6,"month"],[1,"year"]]),l=o.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);function i(u){u.hooks.processOptions.push(function(d,p){G.each(d.getAxes(),function(c,y){var f=y.options;f.mode=="time"&&(y.tickGenerator=function(P){var a=[],E=s(P.min,f),g=0,h=f.tickSize&&f.tickSize[1]==="quarter"||f.minTickSize&&f.minTickSize[1]==="quarter"?l:m;f.minTickSize!=null&&(typeof f.tickSize=="number"?g=f.tickSize:g=f.minTickSize[0]*r[f.minTickSize[1]]);for(var D=0;D<h.length-1&&!(P.delta<(h[D][0]*r[h[D][1]]+h[D+1][0]*r[h[D+1][1]])/2&&h[D][0]*r[h[D][1]]>=g);++D);var v=h[D][0],C=h[D][1];if(C=="year"){if(f.minTickSize!=null&&f.minTickSize[1]=="year")v=Math.floor(f.minTickSize[0]);else{var T=Math.pow(10,Math.floor(Math.log(P.delta/r.year)/Math.LN10)),S=P.delta/r.year/T;S<1.5?v=1:S<3?v=2:S<7.5?v=5:v=10,v*=T}v<1&&(v=1)}P.tickSize=f.tickSize||[v,C];var O=P.tickSize[0];C=P.tickSize[1];var x=O*r[C];C=="second"?E.setSeconds(e(E.getSeconds(),O)):C=="minute"?E.setMinutes(e(E.getMinutes(),O)):C=="hour"?E.setHours(e(E.getHours(),O)):C=="month"?E.setMonth(e(E.getMonth(),O)):C=="quarter"?E.setMonth(3*e(E.getMonth()/3,O)):C=="year"&&E.setFullYear(e(E.getFullYear(),O)),E.setMilliseconds(0),x>=r.minute&&E.setSeconds(0),x>=r.hour&&E.setMinutes(0),x>=r.day&&E.setHours(0),x>=r.day*4&&E.setDate(1),x>=r.month*2&&E.setMonth(e(E.getMonth(),3)),x>=r.quarter*2&&E.setMonth(e(E.getMonth(),6)),x>=r.year&&E.setMonth(0);var b=0,M=Number.NaN,A;do if(A=M,M=E.getTime(),a.push(M),C=="month"||C=="quarter")if(O<1){E.setDate(1);var R=E.getTime();E.setMonth(E.getMonth()+(C=="quarter"?3:1));var B=E.getTime();E.setTime(M+b*r.hour+(B-R)*O),b=E.getHours(),E.setHours(0)}else E.setMonth(E.getMonth()+O*(C=="quarter"?3:1));else C=="year"?E.setFullYear(E.getFullYear()+O):E.setTime(M+x);while(M<P.max&&M!=A);return a},y.tickFormatter=function(P,a){var E=s(P,a.options);if(f.timeformat!=null)return t(E,f.timeformat,f.monthNames,f.dayNames);var g=a.options.tickSize&&a.options.tickSize[1]=="quarter"||a.options.minTickSize&&a.options.minTickSize[1]=="quarter",h=a.tickSize[0]*r[a.tickSize[1]],D=a.max-a.min,v=f.twelveHourClock?" %p":"",C=f.twelveHourClock?"%I":"%H",T;h<r.minute?T=C+":%M:%S"+v:h<r.day?D<2*r.day?T=C+":%M"+v:T="%b %d "+C+":%M"+v:h<r.month?T="%b %d":g&&h<r.quarter||!g&&h<r.year?D<r.year?T="%b":T="%b %Y":g&&h<r.year?D<r.year?T="Q%q":T="Q%q %Y":T="%Y";var S=t(E,T,f.monthNames,f.dayNames);return S})})})}G.plot.plugins.push({init:i,options:I,name:"time",version:"1.0"}),G.plot.formatDate=t})(jQuery)}}]);

//# sourceMappingURL=9778.aeed2343301c3e5780fc.js.map