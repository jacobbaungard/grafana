"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7523],{58313:(Cf,$n,K)=>{K.d($n,{r:()=>Xe});var ua=K(96540),da=K(51986);const Xe=({onChange:Oe,options:y,label:pt})=>ua.createElement(da.i,{icon:"plus",label:pt,variant:"secondary",options:y,onChange:Oe,isFullWidth:!0})},68432:(Cf,$n,K)=>{K.r($n),K.d($n,{addStandardCanvasEditorOptions:()=>As,plugin:()=>db});var ua=K(65158),da=K(37055),Xe=K(32264),Oe=K(2543),y=K(96540),pt=(t=>(t.Center="center",t.Left="left",t.LeftRight="leftright",t.Right="right",t.Scale="scale",t))(pt||{}),ht=(t=>(t.Bottom="bottom",t.Center="center",t.Scale="scale",t.Top="top",t.TopBottom="topbottom",t))(ht||{}),le=(t=>(t.Contain="contain",t.Cover="cover",t.Fill="fill",t.Original="original",t.Tile="tile",t))(le||{}),ce=(t=>(t.GET="GET",t.POST="POST",t.PUT="PUT",t))(ce||{}),Sf=(t=>(t.Straight="straight",t))(Sf||{});const mb={connections:[]},yb={infinitePan:!0,inlineEditing:!0,panZoom:!0,showAdvancedTypes:!0};var ue=(t=>(t.Top="top",t.Bottom="bottom",t.Left="left",t.Right="right",t.HorizontalCenter="hcenter",t.VerticalCenter="vcenter",t))(ue||{}),Ct=(t=>(t.Left="left",t.Center="center",t.Right="right",t))(Ct||{}),kt=(t=>(t.Top="top",t.Middle="middle",t.Bottom="bottom",t))(kt||{}),ve=K(2913),Rs=(t=>(t.Straight="straight",t))(Rs||{});const Vt="#D9D9D9",fa="#000000",xf="#F0F4FD",Df=ve.$W.theme2.colors.text.primary;var wf=K(83077),rt=K(32196),_s=K(43429),en=K(52622),Pt=K(40845),rn=K(55852),Tf=K(62930),Yt=K(78437),nn=K(86640),Af=K(24022),Ar=K(39268),Mr=K(14186),Ns=K(94354),jn=K(88323),an=K(88575),Ls=K(29286),De=K(66864),on=K(10354),we=K(29158);const zs=({value:t,onChange:e})=>{const[r,n]=(0,y.useState)(""),[i,a]=(0,y.useState)(""),s=({currentTarget:d})=>{a(d.value)},o=({currentTarget:d})=>{n(d.value)},l=d=>()=>{const f=t.filter(p=>p[0]!==d);e(f)},c=()=>{const d=r;let f;t?f=t.filter(p=>p[0]!==d):f=[],f.push([d,i]),f.sort((p,v)=>p[0].localeCompare(v[0])),n(""),a(""),e(f)},u=!r&&!i;return y.createElement("div",null,y.createElement(De.Gy,null,y.createElement(on.p,{placeholder:"Key",value:r,onChange:o}),y.createElement(on.p,{placeholder:"Value",value:i,onChange:s}),y.createElement(we.K,{"aria-label":"add",name:"plus-circle",onClick:c,disabled:u})),y.createElement(De.gW,null,Array.from(t||[]).map(d=>y.createElement(De.Gy,{key:d[0]},y.createElement(on.p,{disabled:!0,value:d[0]}),y.createElement(on.p,{disabled:!0,value:d[1]}),y.createElement(we.K,{"aria-label":"delete",onClick:l(d[0]),name:"trash-alt"})))))};var sn=K(26272),Mf=K(17172),kf=K(72574),pa=K(10096),Pf=K(14792);const Is=(t,e)=>{if(t&&t.endpoint){if(_f(t.endpoint)){pa.lE.emit(sn.r1.alertError,["Cannot call API at Grafana origin."]),e&&e(!1);return}const r=Of(t);(0,Mf.AI)().fetch(r).subscribe({error:n=>{pa.lE.emit(sn.r1.alertError,["An error has occurred. Check console output for more details."]),console.error("API call error: ",n),e&&e(!1)},complete:()=>{pa.lE.emit(sn.r1.alertSuccess,["API call was successful"]),e&&e(!1)}})}},ar=t=>{const e=(0,Pf.UA)().getCurrent()?.panelInEdit;return(0,kf.w)().replace(t,e?.scopedVars)},Of=t=>{const e=[],r=new URL(ar(t.endpoint));let n={url:r.toString(),method:t.method,data:Rf(t),headers:e};return t.headerParams&&t.headerParams.forEach(i=>{e.push([ar(i[0]),ar(i[1])])}),t.queryParams&&(t.queryParams?.forEach(i=>{r.searchParams.append(ar(i[0]),ar(i[1]))}),n.url=r.toString()),t.method===ce.POST&&e.push(["Content-Type",t.contentType]),n.headers=e,n},Rf=t=>{let e=t.data?ar(t.data):"{}";return t.method===ce.GET&&(e=void 0),e},_f=t=>{const e=new URL(t),r=new URL(window.location.origin);return e.origin===r.origin},Bs={settings:{}},Nf=[{label:ce.GET,value:ce.GET},{label:ce.POST,value:ce.POST},{label:ce.PUT,value:ce.PUT}],Lf=[{label:"JSON",value:"application/json"},{label:"Text",value:"text/plain"},{label:"JavaScript",value:"application/javascript"},{label:"HTML",value:"text/html"},{label:"XML",value:"application/XML"},{label:"x-www-form-urlencoded",value:"application/x-www-form-urlencoded"}];function zf({value:t,context:e,onChange:r}){t||(t=ln);const i=(0,y.useCallback)((p="")=>{r({...t,endpoint:p})},[r,t]),a=(0,y.useCallback)(p=>{r({...t,data:p})},[r,t]),s=(0,y.useCallback)(p=>{r({...t,method:p})},[r,t]),o=(0,y.useCallback)(p=>{r({...t,contentType:p?.value})},[r,t]),l=p=>p,c=(0,y.useCallback)(p=>{r({...t,queryParams:p})},[r,t]),u=(0,y.useCallback)(p=>{r({...t,headerParams:p})},[r,t]),d=p=>{try{const v=JSON.parse(ar(p));return y.createElement(Af.B,{json:v})}catch(v){return v instanceof Error?`Invalid JSON provided: ${v.message}`:"Invalid JSON provided"}},f=p=>{if(p&&p.endpoint)return y.createElement(rn.$n,{onClick:()=>Is(p),title:"Test API"},"Test API")};return y.createElement(y.Fragment,null,y.createElement(Ar.C,null,y.createElement(Mr.I,{label:"Endpoint",labelWidth:13,grow:!0},y.createElement(Ls.g,{context:e,value:t?.endpoint,onChange:i,item:Bs}))),y.createElement(Ar.C,null,y.createElement(Mr.I,{label:"Method",labelWidth:13,grow:!0},y.createElement(Ns.z,{value:t?.method,options:Nf,onChange:s,fullWidth:!0}))),t?.method!==ce.GET&&y.createElement(Ar.C,null,y.createElement(Mr.I,{label:"Content-Type",labelWidth:13,grow:!0},y.createElement(jn.l6,{options:Lf,allowCustomValue:!0,formatCreateLabel:l,value:t?.contentType,onChange:o}))),y.createElement("br",null),y.createElement(an.D,{label:"Query parameters"},y.createElement(zs,{value:t?.queryParams??[],onChange:c})),y.createElement(an.D,{label:"Header parameters"},y.createElement(zs,{value:t?.headerParams??[],onChange:u})),t?.method!==ce.GET&&t?.contentType&&y.createElement(an.D,{label:"Payload"},y.createElement(Ls.g,{context:e,value:t?.data??"{}",onChange:a,item:{...Bs,settings:{useTextarea:!0}}})),f(t),y.createElement("br",null),t?.method!==ce.GET&&t?.contentType===ln.contentType&&d(t?.data??"{}"))}const If=[{label:"primary",value:"primary"},{label:"secondary",value:"secondary"},{label:"success",value:"success"},{label:"destructive",value:"destructive"}],Bf=({value:t,onChange:e})=>{t||(t=Un);const r=(0,y.useCallback)(n=>{e({...t,variant:n?.value??Un.variant})},[e,t]);return y.createElement(y.Fragment,null,y.createElement(Ar.C,null,y.createElement(Mr.I,{label:"Variant",grow:!0},y.createElement(jn.l6,{options:If,value:t?.variant,onChange:r}))))},ln={endpoint:"",method:ce.POST,data:"{}",contentType:"application/json",queryParams:[],headerParams:[]},Un={variant:"primary"},Gf=({data:t})=>{const e=(0,Pt.of)(Ff,t),[r,n]=y.useState(!1),i=s=>{n(s)},a=()=>{t?.api&&t?.api?.endpoint&&(n(!0),Is(t.api,i))};return y.createElement(rn.$n,{type:"submit",variant:t?.style?.variant,onClick:a,className:e.button},y.createElement("span",null,r&&y.createElement(Tf.y,{inline:!0,className:e.buttonSpinner}),t?.text))},Ff=(t,e)=>({button:(0,rt.css)({height:"100%",width:"100%",display:"grid","> span":{display:"inline-grid",gridAutoFlow:"column",textAlign:e?.align,fontSize:`${e?.size}px`,color:e?.color}}),buttonSpinner:(0,rt.css)({marginRight:t.spacing(.5)})}),Kf={id:"button",name:"Button",description:"Button",state:_s.pn.beta,standardEditorConfig:{background:!1},display:Gf,defaultSize:{width:150,height:45},getNewOptions:t=>({...t,config:{text:{mode:en.RU.Fixed,fixed:"Button"},align:Ct.Center,color:{fixed:xf},size:14,api:ln,style:Un},background:{color:{fixed:"transparent"}},placement:{width:t?.placement?.width??32,height:t?.placement?.height??78,top:t?.placement?.top??100,left:t?.placement?.left??100}}),prepareData:(t,e)=>{const r=()=>{if(e?.api)return e.api={...e.api,method:e.api.method??ln.method,contentType:e.api.contentType??ln.contentType},e.api},n={text:e?.text?t.getText(e.text).value():"",align:e.align??Ct.Center,size:e.size??14,api:r(),style:e?.style??Un};return e.color&&(n.color=t.getColor(e.color).value()),n},registerOptionsUI:t=>{const e=["Button"];t.addCustomEditor({category:e,id:"styleSelector",path:"config.style",name:"Style",editor:Bf}).addCustomEditor({category:e,id:"textSelector",path:"config.text",name:"Text",editor:nn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:"Text color",editor:Yt.NO,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:"Align text",settings:{options:[{value:Ct.Left,label:"Left"},{value:Ct.Center,label:"Center"},{value:Ct.Right,label:"Right"}]},defaultValue:Ct.Left}).addNumberInput({category:e,path:"config.size",name:"Text size",settings:{placeholder:"Auto"}}).addCustomEditor({category:e,id:"apiSelector",path:"config.api",name:"API",editor:zf})}},Wf={id:"droneFront",name:"Drone Front",description:"Drone front",display:({data:t})=>{const e=(0,Pt.of)(Yf),r=`rotate(${t?.rollAngle?t.rollAngle:0}deg)`;return y.createElement("svg",{className:e.droneFront,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 1300 290",style:{transform:r,stroke:Vt}},y.createElement("g",{className:"arms",stroke:Vt,strokeWidth:"28px"},y.createElement("line",{x1:"510",x2:"320",y1:"100",y2:"150"}),y.createElement("line",{x1:"510",x2:"320",y1:"190",y2:"210"}),y.createElement("line",{x1:"790",x2:"980",y1:"190",y2:"210"}),y.createElement("line",{x1:"790",x2:"980",y1:"100",y2:"150"})),y.createElement("g",{className:"body",stroke:Vt,strokeWidth:"28px"},y.createElement("path",{fill:"none",d:" M 510 130 C 510 124 510 110 510 100 C 510 90 530 71 540 70 C 640 61 670 60 760 70 C 770 71 790 90 790 100 Q 790 120 790 130 L 790 130 Q 790 177 790 196 C 790 207 770 225 760 226 C 670 236 640 236 540 226 C 530 226 510 206 510 196 Q 510 177 510 130 Q 510 133 510 130 Z "}),y.createElement("circle",{cx:"650",cy:"160",r:"40",fill:"none"})),y.createElement("g",{className:"motors",stroke:Vt,strokeWidth:"28px"},y.createElement("path",{className:"motor",fill:"none",d:" M 320 60 L 250 60 L 250 230 L 260 290 L 310 290 L 320 230 L 320 60 Z "}),y.createElement("path",{className:"motor",fill:"none",d:" M 1050 60 L 980 60 L 980 230 L 990 290 L 1040 290 L 1050 230 L 1050 60 Z "})),y.createElement("g",{className:"propellers",fill:Vt},y.createElement("path",{className:"prop",d:" M 270 60 L 300 60 L 300 20 Q 311 30 330 30 Q 349 30 570 10 L 300 10 Q 300 0 290 0 C 286 0 284 0 280 0 Q 270 0 270 10 L 0 10 Q 220 30 240 30 Q 260 30 270 20 L 270 60 Z "}),y.createElement("path",{className:"prop",d:" M 1000 60 L 1030 60 L 1030 20 Q 1041 30 1060 30 Q 1079 30 1300 10 L 1030 10 Q 1030 0 1020 0 C 1016 0 1014 0 1010 0 Q 1000 0 1000 10 L 730 10 Q 950 30 970 30 Q 990 30 1000 20 L 1000 60 Z "})))},defaultSize:{width:100,height:26},getNewOptions:t=>({...t,background:{color:{fixed:"transparent"}},placement:{width:t?.placement?.width??100,height:t?.placement?.height??26,top:t?.placement?.top,left:t?.placement?.left}}),prepareData:(t,e)=>({rollAngle:e?.rollAngle?t.getScalar(e.rollAngle).value():0}),registerOptionsUI:t=>{const e=["Drone Front"];t.addCustomEditor({category:e,id:"rollAngle",path:"config.rollAngle",name:"Roll Angle",editor:Yt.AW})}},Yf=t=>({droneFront:(0,rt.css)({transition:"transform 0.4s"})}),Xf={id:"droneSide",name:"Drone Side",description:"Drone Side",display:({data:t})=>{const e=(0,Pt.of)(Hf),r=`rotate(${t?.pitchAngle?t.pitchAngle:0}deg)`;return y.createElement("svg",{className:e.droneSide,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 1300 290",style:{transform:r,stroke:Vt}},y.createElement("g",{className:"arms",stroke:Vt,strokeWidth:"28px"},y.createElement("line",{x1:"510",x2:"320",y1:"100",y2:"150"}),y.createElement("line",{x1:"510",x2:"320",y1:"190",y2:"210"}),y.createElement("line",{x1:"790",x2:"980",y1:"190",y2:"210"}),y.createElement("line",{x1:"790",x2:"980",y1:"100",y2:"150"})),y.createElement("g",{className:"body",stroke:Vt,strokeWidth:"28px"},y.createElement("path",{fill:"none",d:" M 510 130 C 510 124 510 110 510 100 C 510 90 530 71 540 70 C 640 61 670 60 760 70 C 770 71 790 90 790 100 Q 790 120 790 130 L 790 130 Q 790 177 790 196 C 790 207 770 225 760 226 C 670 236 640 236 540 226 C 530 226 510 206 510 196 Q 510 177 510 130 Q 510 133 510 130 Z "})),y.createElement("g",{className:"motors",stroke:Vt,strokeWidth:"28px"},y.createElement("path",{className:"motor",fill:"none",d:" M 320 60 L 250 60 L 250 230 L 260 290 L 310 290 L 320 230 L 320 60 Z "}),y.createElement("path",{className:"motor",fill:"none",d:" M 1050 60 L 980 60 L 980 230 L 990 290 L 1040 290 L 1050 230 L 1050 60 Z "})),y.createElement("g",{className:"propellers",fill:Vt},y.createElement("path",{className:"prop",d:" M 270 60 L 300 60 L 300 20 Q 311 30 330 30 Q 349 30 570 10 L 300 10 Q 300 0 290 0 C 286 0 284 0 280 0 Q 270 0 270 10 L 0 10 Q 220 30 240 30 Q 260 30 270 20 L 270 60 Z "}),y.createElement("path",{className:"prop",d:" M 1000 60 L 1030 60 L 1030 20 Q 1041 30 1060 30 Q 1079 30 1300 10 L 1030 10 Q 1030 0 1020 0 C 1016 0 1014 0 1010 0 Q 1000 0 1000 10 L 730 10 Q 950 30 970 30 Q 990 30 1000 20 L 1000 60 Z "})))},defaultSize:{width:100,height:26},getNewOptions:t=>({...t,background:{color:{fixed:"transparent"}},placement:{width:t?.placement?.width??100,height:t?.placement?.height??26,top:t?.placement?.top,left:t?.placement?.left}}),prepareData:(t,e)=>({pitchAngle:e?.pitchAngle?t.getScalar(e.pitchAngle).value():0}),registerOptionsUI:t=>{const e=["Drone Side"];t.addCustomEditor({category:e,id:"pitchAngle",path:"config.pitchAngle",name:"Pitch Angle",editor:Yt.AW})}},Hf=t=>({droneSide:(0,rt.css)({transition:"transform 0.4s"})}),Vf={id:"droneTop",name:"Drone Top",description:"Drone top",display:({data:t})=>{const e=(0,Pt.of)($f),r=`spin ${t?.fRightRotorRPM?60/Math.abs(t.fRightRotorRPM):0}s linear infinite`,n=`spin ${t?.fLeftRotorRPM?60/Math.abs(t.fLeftRotorRPM):0}s linear infinite`,i=`spin ${t?.bRightRotorRPM?60/Math.abs(t.bRightRotorRPM):0}s linear infinite`,a=`spin ${t?.bLeftRotorRPM?60/Math.abs(t.bLeftRotorRPM):0}s linear infinite`,s=`rotate(${t?.yawAngle?t.yawAngle:0}deg)`;return y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"-43 -43 640 640",xmlSpace:"preserve",style:{transform:s,fill:Vt}},y.createElement("path",{fillRule:"evenodd",d:" M 137.95 127.967 C 137.14 127.157 136.189 126.58 135.178 126.218 C 138.173 121.545 139.967 116.036 140.125 110.123 L 217.64 151.862 C 214.049 157.411 211.8 163.922 211.386 170.95 L 209.694 199.712 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 Z  M 134.268 426.981 C 130.211 421.314 124.328 417.045 117.482 415.041 L 201.999 330.523 L 201.385 340.955 C 200.67 353.107 202.829 364.914 207.563 375.673 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 Z  M 324.765 373.673 L 228.527 373.673 Q 215.374 358.611 216.361 341.835 L 226.361 171.832 C 226.825 163.94 231.012 157.096 237.146 152.957 L 316.146 152.957 C 322.28 157.096 326.466 163.94 326.931 171.832 L 336.931 341.835 Q 337.918 358.611 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 Z  M 435.81 415.041 C 428.964 417.045 423.081 421.314 419.024 426.981 L 345.727 375.673 C 350.461 364.914 352.62 353.107 351.905 340.955 L 351.291 330.523 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 Z  M 343.596 199.713 L 341.904 170.951 C 341.49 163.923 339.242 157.411 335.651 151.863 L 413.167 110.124 C 413.325 116.037 415.119 121.546 418.114 126.219 C 417.103 126.581 416.152 127.158 415.342 127.968 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 Z  M 444.646 92.771 C 453.744 92.771 461.146 100.172 461.146 109.271 C 461.146 118.369 453.744 125.771 444.646 125.771 C 435.548 125.771 428.146 118.369 428.146 109.271 C 428.146 100.172 435.548 92.771 444.646 92.771 L 444.646 92.771 L 444.646 92.771 L 444.646 92.771 Z  M 108.647 92.771 C 117.745 92.771 125.147 100.172 125.147 109.271 C 125.147 118.369 117.745 125.771 108.647 125.771 C 99.549 125.771 92.147 118.369 92.147 109.271 C 92.147 100.172 99.549 92.771 108.647 92.771 L 108.647 92.771 L 108.647 92.771 Z  M 108.647 461.771 C 99.549 461.771 92.147 454.369 92.147 445.271 C 92.147 436.172 99.549 428.771 108.647 428.771 C 117.745 428.771 125.147 436.172 125.147 445.271 C 125.147 454.369 117.745 461.771 108.647 461.771 L 108.647 461.771 Z  M 92.322 136.202 C 97.086 139.1 102.675 140.771 108.647 140.771 C 114.883 140.771 120.697 138.941 125.594 135.802 C 125.956 136.813 126.534 137.764 127.343 138.573 L 207.342 218.573 C 207.711 218.942 208.109 219.264 208.528 219.54 L 203.212 309.908 C 201.794 310.182 200.44 310.869 199.342 311.967 L 95.343 415.967 C 94.954 416.356 94.62 416.779 94.335 417.224 C 93.651 417.575 92.976 417.942 92.322 418.34 Q 84.615 424.182 81.716 428.946 C 78.817 433.71 77.147 439.299 77.147 445.271 C 77.147 462.64 91.278 476.771 108.647 476.771 C 114.619 476.771 120.208 475.1 124.972 472.202 C 129.736 469.304 132.678 466.36 135.577 461.596 C 138.476 456.832 140.147 451.243 140.147 445.271 C 140.147 443.943 140.055 442.637 139.895 441.352 L 214.997 388.78 C 217.05 391.677 336.242 391.678 338.295 388.78 L 413.398 441.352 C 413.238 442.637 413.146 443.943 413.146 445.271 C 413.146 451.243 414.817 456.832 417.715 461.596 C 420.613 466.36 423.557 469.304 428.321 472.202 C 433.085 475.1 438.674 476.771 444.646 476.771 C 462.015 476.771 476.146 462.64 476.146 445.271 C 476.146 439.299 474.475 433.71 471.577 428.946 C 468.679 424.182 459.642 417.575 458.958 417.224 C 458.672 416.779 458.339 416.356 457.95 415.967 L 353.95 311.967 C 352.852 310.869 351.498 310.182 350.08 309.908 L 344.764 219.54 C 345.183 219.264 345.581 218.942 345.95 218.573 L 425.95 138.573 C 426.76 137.763 427.337 136.812 427.699 135.802 C 432.596 138.941 438.409 140.771 444.646 140.771 C 450.618 140.771 456.207 139.1 460.971 136.202 C 465.735 133.304 468.679 130.36 471.577 125.596 C 474.475 120.832 476.146 115.243 476.146 109.271 C 476.146 91.903 462.015 77.772 444.646 77.772 C 438.674 77.772 433.085 79.442 428.321 82.34 L 416.215 91.446 L 324.765 140.688 C 318.402 136.324 310.718 133.771 302.473 133.771 L 250.819 133.771 C 242.574 133.771 234.89 136.324 228.527 140.688 L 137.078 91.446 L 124.972 82.34 C 120.208 79.442 114.619 77.772 108.647 77.772 C 91.278 77.772 77.147 91.903 77.147 109.271 C 77.147 115.243 78.818 120.832 81.716 125.595 C 84.614 130.358 87.558 133.304 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 Z  M 444.646 461.771 C 435.548 461.771 428.146 454.369 428.146 445.271 C 428.146 436.172 435.548 428.771 444.646 428.771 C 453.744 428.771 461.146 436.172 461.146 445.271 C 461.146 454.369 453.744 461.771 444.646 461.771 Z "}),y.createElement("path",{fillRule:"evenodd",d:" M 259.458 334.235 L 259.458 337.211 L 254.514 337.211 L 254.514 350.795 L 250.842 350.795 L 250.842 337.211 L 245.898 337.211 L 245.898 334.235 L 259.458 334.235 Z  M 266.226 347.939 L 272.586 347.939 L 272.754 350.627 L 272.754 350.627 Q 270.498 350.867 265.074 350.867 L 265.074 350.867 L 265.074 350.867 Q 263.418 350.867 262.434 349.967 L 262.434 349.967 L 262.434 349.967 Q 261.45 349.067 261.426 347.531 L 261.426 347.531 L 261.426 337.499 L 261.426 337.499 Q 261.45 335.963 262.434 335.063 L 262.434 335.063 L 262.434 335.063 Q 263.418 334.163 265.074 334.163 L 265.074 334.163 L 265.074 334.163 Q 270.498 334.163 272.754 334.403 L 272.754 334.403 L 272.586 337.115 L 266.226 337.115 L 266.226 337.115 Q 265.626 337.115 265.362 337.403 L 265.362 337.403 L 265.362 337.403 Q 265.098 337.691 265.098 338.339 L 265.098 338.339 L 265.098 340.859 L 271.698 340.859 L 271.698 343.499 L 265.098 343.499 L 265.098 346.691 L 265.098 346.691 Q 265.098 347.363 265.362 347.651 L 265.362 347.651 L 265.362 347.651 Q 265.626 347.939 266.226 347.939 L 266.226 347.939 Z  M 275.202 333.995 L 278.73 333.995 L 278.73 346.931 L 278.73 346.931 Q 278.73 348.131 280.074 348.131 L 280.074 348.131 L 281.034 348.131 L 281.442 350.603 L 281.442 350.603 Q 280.53 351.083 278.61 351.083 L 278.61 351.083 L 278.61 351.083 Q 277.026 351.083 276.114 350.231 L 276.114 350.231 L 276.114 350.231 Q 275.202 349.379 275.202 347.819 L 275.202 347.819 L 275.202 333.995 Z  M 283.05 333.995 L 286.578 333.995 L 286.578 346.931 L 286.578 346.931 Q 286.578 348.131 287.922 348.131 L 287.922 348.131 L 288.882 348.131 L 289.29 350.603 L 289.29 350.603 Q 288.378 351.083 286.458 351.083 L 286.458 351.083 L 286.458 351.083 Q 284.874 351.083 283.962 350.231 L 283.962 350.231 L 283.962 350.231 Q 283.05 349.379 283.05 347.819 L 283.05 347.819 L 283.05 333.995 Z  M 292.086 335.759 L 292.086 335.759 L 292.086 335.759 Q 293.634 333.923 297.618 333.923 L 297.618 333.923 L 297.618 333.923 Q 301.602 333.923 303.162 335.759 L 303.162 335.759 L 303.162 335.759 Q 304.722 337.595 304.722 342.515 L 304.722 342.515 L 304.722 342.515 Q 304.722 347.435 303.162 349.271 L 303.162 349.271 L 303.162 349.271 Q 301.602 351.107 297.618 351.107 L 297.618 351.107 L 297.618 351.107 Q 293.634 351.107 292.086 349.271 L 292.086 349.271 L 292.086 349.271 Q 290.538 347.435 290.538 342.515 L 290.538 342.515 L 290.538 342.515 Q 290.538 337.595 292.086 335.759 Z  M 300.174 338.051 L 300.174 338.051 L 300.174 338.051 Q 299.49 336.875 297.618 336.875 L 297.618 336.875 L 297.618 336.875 Q 295.746 336.875 295.062 338.051 L 295.062 338.051 L 295.062 338.051 Q 294.378 339.227 294.378 342.515 L 294.378 342.515 L 294.378 342.515 Q 294.378 345.803 295.062 346.979 L 295.062 346.979 L 295.062 346.979 Q 295.746 348.155 297.618 348.155 L 297.618 348.155 L 297.618 348.155 Q 299.49 348.155 300.174 346.979 L 300.174 346.979 L 300.174 346.979 Q 300.858 345.803 300.858 342.515 L 300.858 342.515 L 300.858 342.515 Q 300.858 339.227 300.174 338.051 Z "}),y.createElement("g",{className:"propeller-group"},y.createElement("path",{className:`${e.propeller} ${e.propellerCW}`,style:{animation:i},d:" M 461.563 418.77 L 463.992 416.34 Q 465.495 407.116 466.461 400.395 C 467.426 393.675 469.363 388.087 474.731 383.284 Q 533.862 341.514 538.196 338.859 C 542.529 336.203 548.345 334.299 551.492 338.29 C 554.639 342.282 553.481 346.02 549.419 350.082 L 471.147 428.354 L 461.563 418.77 Z  M 427.729 471.772 L 425.299 474.202 Q 423.797 483.426 422.831 490.146 C 421.866 496.867 419.929 502.454 414.561 507.257 Q 355.43 549.028 351.096 551.683 C 346.763 554.338 340.947 556.243 337.8 552.251 C 334.653 548.26 335.811 544.522 339.873 540.46 L 418.145 462.187 L 427.729 471.772 Z "}),y.createElement("path",{className:`${e.propeller} ${e.propellerCCW}`,style:{animation:r},d:" M 461.563 135.773 L 463.992 138.203 Q 465.495 147.426 466.461 154.147 C 467.426 160.868 469.363 166.455 474.731 171.258 Q 533.862 213.028 538.196 215.684 C 542.529 218.339 548.345 220.244 551.492 216.252 C 554.639 212.26 553.481 208.523 549.419 204.46 L 471.147 126.188 L 461.563 135.773 Z  M 427.729 82.77 L 425.299 80.34 Q 423.797 71.117 422.831 64.396 C 421.866 57.675 419.929 52.088 414.561 47.285 Q 355.43 5.515 351.096 2.859 C 346.763 0.204 340.947 -1.701 337.8 2.291 C 334.653 6.282 335.811 10.02 339.873 14.082 L 418.145 92.355 L 427.729 82.77 Z "}),y.createElement("path",{className:`${e.propeller} ${e.propellerCCW}`,style:{animation:a},d:" M 125.563 471.772 L 127.993 474.202 Q 129.496 483.426 130.461 490.146 C 131.427 496.867 133.363 502.454 138.731 507.257 Q 197.863 549.028 202.196 551.683 C 206.53 554.338 212.345 556.243 215.492 552.251 C 218.639 548.26 217.482 544.522 213.419 540.46 L 135.148 462.187 L 125.563 471.772 Z  M 91.73 418.77 L 89.3 416.34 Q 87.797 407.116 86.832 400.395 C 85.866 393.675 83.93 388.087 78.562 383.284 Q 19.431 341.514 15.097 338.859 C 10.763 336.203 4.948 334.299 1.801 338.29 C -1.346 342.282 -0.189 346.02 3.874 350.082 L 82.146 428.354 L 91.73 418.77 Z "}),y.createElement("path",{className:`${e.propeller} ${e.propellerCW}`,style:{animation:n},d:" M 125.563 82.77 L 127.993 80.34 Q 129.496 71.117 130.461 64.396 C 131.427 57.675 133.363 52.088 138.731 47.285 Q 197.863 5.515 202.196 2.859 C 206.53 0.204 212.345 -1.701 215.492 2.291 C 218.639 6.282 217.482 10.02 213.419 14.083 L 135.147 92.355 L 125.563 82.77 Z  M 91.73 135.773 L 89.3 138.203 Q 87.797 147.426 86.832 154.147 C 85.866 160.868 83.93 166.455 78.562 171.258 Q 19.431 213.028 15.097 215.684 C 10.763 218.339 4.948 220.243 1.801 216.252 C -1.346 212.26 -0.189 208.523 3.874 204.46 L 82.146 126.188 L 91.73 135.773 Z "})))},defaultSize:{width:100,height:100},getNewOptions:t=>({...t,background:{color:{fixed:"transparent"}}}),prepareData:(t,e)=>({bRightRotorRPM:e?.bRightRotorRPM?t.getScalar(e.bRightRotorRPM).value():0,bLeftRotorRPM:e?.bLeftRotorRPM?t.getScalar(e.bLeftRotorRPM).value():0,fRightRotorRPM:e?.fRightRotorRPM?t.getScalar(e.fRightRotorRPM).value():0,fLeftRotorRPM:e?.fLeftRotorRPM?t.getScalar(e.fLeftRotorRPM).value():0,yawAngle:e?.yawAngle?t.getScalar(e.yawAngle).value():0}),registerOptionsUI:t=>{const e=["Drone Top"];t.addCustomEditor({category:e,id:"yawAngle",path:"config.yawAngle",name:"Yaw Angle",editor:Yt.AW}).addCustomEditor({category:e,id:"fRightRotorRPM",path:"config.fRightRotorRPM",name:"Front Right Rotor RPM",editor:Yt.AW}).addCustomEditor({category:e,id:"fLeftRotorRPM",path:"config.fLeftRotorRPM",name:"Front Left Rotor RPM",editor:Yt.AW}).addCustomEditor({category:e,id:"bRightRotorRPM",path:"config.bRightRotorRPM",name:"Back Right Rotor RPM",editor:Yt.AW}).addCustomEditor({category:e,id:"bLeftRotorRPM",path:"config.bLeftRotorRPM",name:"Back Left Rotor RPM",editor:Yt.AW})}},$f=t=>({propeller:(0,rt.css)({transformOrigin:"50% 50%",transformBox:"fill-box",display:"block","@keyframes spin":{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}}),propellerCW:(0,rt.css)({animationDirection:"normal"}),propellerCCW:(0,rt.css)({animationDirection:"reverse"})});var kr=K(21934);class jf extends y.PureComponent{render(){const{data:e}=this.props,r=Uf(ve.$W.theme2,e);return y.createElement("div",{className:r.container},y.createElement("span",{className:r.span},e?.text))}}const Uf=(t,e)=>({container:(0,rt.css)({display:"table",position:"absolute",top:"50%",transform:"translateY(-50%)",width:"100%",height:"100%",backgroundColor:e?.backgroundColor,border:`${e?.width}px solid ${e?.borderColor}`,borderRadius:"50%"}),span:(0,rt.css)({display:"table-cell",verticalAlign:e?.valign,textAlign:e?.align,fontSize:`${e?.size}px`,color:e?.color})}),Zf={id:"ellipse",name:"Ellipse",description:"Ellipse",display:jf,defaultSize:{width:160,height:160},getNewOptions:t=>({...t,config:{backgroundColor:{fixed:Vt},borderColor:{fixed:"transparent"},width:1,align:Ct.Center,valign:kt.Middle,color:{fixed:fa}},background:{color:{fixed:"transparent"}}}),prepareData:(t,e)=>{const r={width:e.width,text:e.text?t.getText(e.text).value():"",align:e.align??Ct.Center,valign:e.valign??kt.Middle,size:e.size};return e.backgroundColor&&(r.backgroundColor=t.getColor(e.backgroundColor).value()),e.borderColor&&(r.borderColor=t.getColor(e.borderColor).value()),e.color&&(r.color=t.getColor(e.color).value()),r},registerOptionsUI:t=>{const e=["Ellipse"];t.addCustomEditor({category:e,id:"textSelector",path:"config.text",name:"Text",editor:nn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:"Text color",editor:kr.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:"Align text",settings:{options:[{value:Ct.Left,label:"Left"},{value:Ct.Center,label:"Center"},{value:Ct.Right,label:"Right"}]},defaultValue:Ct.Left}).addCustomEditor({category:e,id:"config.borderColor",path:"config.borderColor",name:"Ellipse border color",editor:kr.N,settings:{},defaultValue:{}}).addNumberInput({category:e,path:"config.width",name:"Ellipse border width",settings:{placeholder:"Auto"}}).addCustomEditor({category:e,id:"config.backgroundColor",path:"config.backgroundColor",name:"Ellipse background color",editor:kr.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.valign",name:"Vertical align",settings:{options:[{value:kt.Top,label:"Top"},{value:kt.Middle,label:"Middle"},{value:kt.Bottom,label:"Bottom"}]},defaultValue:kt.Middle}).addNumberInput({category:e,path:"config.size",name:"Text size",settings:{placeholder:"Auto"}})}};var Qf=K(47694),va=K(63577);const qf=(0,rt.css)({path:{vectorEffect:"non-scaling-stroke"}});function Jf(t){const{data:e}=t;if(!e?.path)return null;const r={fill:e?.fill,stroke:e?.strokeColor,strokeWidth:e?.stroke,height:"100%",width:"100%"};return y.createElement(Qf.y,{src:e.path,style:r,className:r.strokeWidth?qf:void 0})}const tp={id:"icon",name:"Icon",description:"SVG Icon display",display:Jf,getNewOptions:t=>({...t,config:{path:{mode:en.q_.Fixed,fixed:"img/icons/unicons/question-circle.svg"},fill:{fixed:Vt}},background:{color:{fixed:"transparent"}},placement:{width:t?.placement?.width??100,height:t?.placement?.height??100,top:t?.placement?.top??100,left:t?.placement?.left??100}}),prepareData:(t,e)=>{let r;e.path&&(r=t.getResource(e.path).value()),(!r||!(0,Oe.isString)(r))&&(r=(0,va.getPublicOrAbsoluteUrl)("img/icons/unicons/question-circle.svg"));const n={path:r,fill:e.fill?t.getColor(e.fill).value():Vt};return e.stroke?.width&&e.stroke.color&&e.stroke.width>0&&(n.stroke=e.stroke?.width,n.strokeColor=t.getColor(e.stroke.color).value()),n},registerOptionsUI:t=>{const e=["Icon"];t.addCustomEditor({category:e,id:"iconSelector",path:"config.path",name:"SVG Path",editor:Yt.mj,settings:{resourceType:"icon",maxFiles:2e3}}).addCustomEditor({category:e,id:"config.fill",path:"config.fill",name:"Fill color",editor:Yt.NO,settings:{},defaultValue:{fixed:"grey"}})}};var Zn=K(24120),Gs=K(62467),cn=K(79041),ep=K(76218),Fs=K(64278),Ks=K(28240),Ws=K(28138);class rp extends y.PureComponent{render(){const{config:e}=this.props;return y.createElement("div",null,y.createElement("h3",null,"NOT FOUND:"),y.createElement("pre",null,JSON.stringify(e,null,2)))}}const ha={id:"not-found",name:"Not found",description:"Display when element type is not found in the registry",display:rp,defaultSize:{width:100,height:100},getNewOptions:()=>({config:{}})};let np=0;class Qn{constructor(e,r,n){this.item=e,this.options=r,this.parent=n,this.UID=np++,this.revId=0,this.sizeStyle={},this.dataStyle={},this.initElement=s=>{this.div=s,this.applyLayoutStylesToDiv()},this.applyDrag=s=>{const o=this.options.constraint?.horizontal===pt.Center,l=this.options.constraint?.vertical===ht.Center;if((o||l)&&!((this.getScene()?.selecto?.getSelectedTargets().length??0)>1)){const f=this.div?.getBoundingClientRect()?.height??100,p=l?f/4:0;s.target.style.transform=`translate(${s.translate[0]}px, ${s.translate[1]-p}px)`;return}s.target.style.transform=s.transform},this.applyResize=(s,o=1)=>{const l=this.options.placement,c=s.target.style,u=s.delta[0]/o,d=s.delta[1]/o,f=s.direction[0],p=s.direction[1];f===1?(l.width=s.width,c.width=`${l.width}px`):f===-1&&(l.left-=u,l.width=s.width,c.left=`${l.left}px`,c.width=`${l.width}px`),p===-1?(l.top-=d,l.height=s.height,c.top=`${l.top}px`,c.height=`${l.height}px`):p===1&&(l.height=s.height,c.height=`${l.height}px`)},this.handleMouseEnter=(s,o)=>{const l=this.getScene();!l?.isEditingEnabled&&!l?.tooltip?.isOpen?this.handleTooltip(s):o||l?.connections.handleMouseEnter(s)},this.handleTooltip=s=>{const o=this.getScene();if(o?.tooltipCallback){const l=this.div?.getBoundingClientRect();o.tooltipCallback({anchorPoint:{x:l?.right??s.pageX,y:l?.top??s.pageY},element:this,isOpen:!1})}},this.handleMouseLeave=s=>{const o=this.getScene();o?.tooltipCallback&&!o?.tooltip?.isOpen&&o.tooltipCallback(void 0)},this.onElementClick=s=>{this.onTooltipCallback()},this.onElementKeyDown=s=>{s.key==="Enter"&&(s.currentTarget instanceof HTMLElement||s.currentTarget instanceof SVGElement)&&this.getScene()?.select({targets:[s.currentTarget]})},this.onTooltipCallback=()=>{const s=this.getScene();s?.tooltipCallback&&s.tooltip?.anchorPoint&&s.tooltipCallback({anchorPoint:{x:s.tooltip.anchorPoint.x,y:s.tooltip.anchorPoint.y},element:this,isOpen:!0})};const i=`Element ${Date.now()}`;r||(this.options={type:e.id,name:i}),r.constraint=r.constraint??{vertical:ht.Top,horizontal:pt.Left},r.placement=r.placement??{width:100,height:100,top:0,left:0},r.background=r.background??{color:{fixed:"transparent"}},r.border=r.border??{color:{fixed:"dark-green"}};const a=this.getScene();if(!r.name){const s=a?.getNextElementName();r.name=s??i}a?.byName.set(r.name,this)}getScene(){let e=this.parent;for(;e;){if(e.isRoot())return e.scene;e=e.parent}}getName(){return this.options.name}applyLayoutStylesToDiv(e){if(this.isRoot())return;const{constraint:r}=this.options,{vertical:n,horizontal:i}=r??{},a=this.options.placement??{},o={cursor:this.getScene()?.isEditingEnabled?"grab":"auto",pointerEvents:e?"none":"auto",position:"absolute",minWidth:"10px",minHeight:"10px"},l=["0px","0px"];switch(n){case ht.Top:a.top=a.top??0,a.height=a.height??100,o.top=`${a.top}px`,o.height=`${a.height}px`,delete a.bottom;break;case ht.Bottom:a.bottom=a.bottom??0,a.height=a.height??100,o.bottom=`${a.bottom}px`,o.height=`${a.height}px`,delete a.top;break;case ht.TopBottom:a.top=a.top??0,a.bottom=a.bottom??0,o.top=`${a.top}px`,o.bottom=`${a.bottom}px`,delete a.height,o.height="";break;case ht.Center:a.top=a.top??0,a.height=a.height??100,l[1]="-50%",o.top=`calc(50% - ${a.top}px)`,o.height=`${a.height}px`,delete a.bottom;break;case ht.Scale:a.top=a.top??0,a.bottom=a.bottom??0,o.top=`${a.top}%`,o.bottom=`${a.bottom}%`,delete a.height,o.height="";break}switch(i){case pt.Left:a.left=a.left??0,a.width=a.width??100,o.left=`${a.left}px`,o.width=`${a.width}px`,delete a.right;break;case pt.Right:a.right=a.right??0,a.width=a.width??100,o.right=`${a.right}px`,o.width=`${a.width}px`,delete a.left;break;case pt.LeftRight:a.left=a.left??0,a.right=a.right??0,o.left=`${a.left}px`,o.right=`${a.right}px`,delete a.width,o.width="";break;case pt.Center:a.left=a.left??0,a.width=a.width??100,l[0]="-50%",o.left=`calc(50% - ${a.left}px)`,o.width=`${a.width}px`,delete a.right;break;case pt.Scale:a.left=a.left??0,a.right=a.right??0,o.left=`${a.left}%`,o.right=`${a.right}%`,delete a.width,o.width="";break}if(o.transform=`translate(${l[0]}, ${l[1]})`,this.options.placement=a,this.sizeStyle=o,this.div){for(const c in this.sizeStyle)this.div.style[c]=this.sizeStyle[c];for(const c in this.dataStyle)this.div.style[c]=this.dataStyle[c]}}setPlacementFromConstraint(e,r,n=1){const{constraint:i}=this.options,{vertical:a,horizontal:s}=i??{};e||(e=this.div&&this.div.getBoundingClientRect());let o=0;r||(r=this.div&&this.div.parentElement?.getBoundingClientRect(),o=this.parent?.isRoot()?0:parseFloat(getComputedStyle(this.div?.parentElement).borderWidth));const l=e&&r?Math.round(e.top-r.top-o)/n:0,c=e&&r?Math.round(r.bottom-o-e.bottom)/n:0,u=e&&r?Math.round(e.left-r.left-o)/n:0,d=e&&r?Math.round(r.right-o-e.right)/n:0,f={},p=(e?.width??100)/n,v=(e?.height??100)/n;switch(a){case ht.Top:f.top=l,f.height=v;break;case ht.Bottom:f.bottom=c,f.height=v;break;case ht.TopBottom:f.top=l,f.bottom=c;break;case ht.Center:const h=e?l+v/2:0,m=(r?r.height/2:0)-h;f.top=m,f.height=v;break;case ht.Scale:f.top=l/(r?.height??v)*100,f.bottom=c/(r?.height??v)*100;break}switch(s){case pt.Left:f.left=u,f.width=p;break;case pt.Right:f.right=d,f.width=p;break;case pt.LeftRight:f.left=u,f.right=d;break;case pt.Center:const h=e?u+p/2:0,m=(r?r.width/2:0)-h;f.left=m,f.width=p;break;case pt.Scale:f.left=u/(r?.width??p)*100,f.right=d/(r?.width??p)*100;break}this.options.placement=f,this.applyLayoutStylesToDiv(),this.revId++,this.getScene()?.save()}updateData(e){this.item.prepareData&&(this.data=this.item.prepareData(e,this.options.config),this.revId++);const{background:r,border:n}=this.options,i={};if(r){if(r.color){const a=e.getColor(r.color);i.backgroundColor=a.value()}if(r.image){const a=e.getResource(r.image);if(a){const s=a.value();if(s)switch(i.backgroundImage=`url("${s}")`,r.size??le.Contain){case le.Contain:i.backgroundSize="contain",i.backgroundRepeat="no-repeat";break;case le.Cover:i.backgroundSize="cover",i.backgroundRepeat="no-repeat";break;case le.Original:i.backgroundRepeat="no-repeat";break;case le.Tile:i.backgroundRepeat="repeat";break;case le.Fill:i.backgroundSize="100% 100%";break}else i.backgroundImage=""}}}if(n&&n.color&&n.width!==void 0){const a=e.getColor(n.color);i.borderWidth=`${n.width}px`,i.borderStyle="solid",i.borderColor=a.value(),i.backgroundImage&&(i.backgroundOrigin="padding-box")}this.dataStyle=i,this.applyLayoutStylesToDiv()}isRoot(){return!1}visit(e){e(this)}onChange(e){this.item.id!==e.type&&(this.item=fn.getIfExists(e.type)??ha);const r=this.options.name,n=e.name;this.revId++,this.options={...e};let i=this.parent;for(;i;){if(i.isRoot()){i.scene.save();break}i.revId++,i=i.parent}const a=this.getScene();r!==n&&a&&(Vs(this,a.byName)&&js(this,a).forEach(s=>{s.info.targetName=n}),a.byName.delete(r),a.byName.set(n,this))}getSaveModel(){return{...this.options}}render(){const{item:e,div:r}=this,n=this.getScene(),i=r&&n&&n.selecto&&n.selecto.getSelectedTargets().includes(r);return y.createElement("div",{key:this.UID,ref:this.initElement,onMouseEnter:a=>this.handleMouseEnter(a,i),onMouseLeave:n?.isEditingEnabled?void 0:this.handleMouseLeave,onClick:n?.isEditingEnabled?void 0:this.onElementClick,onKeyDown:n?.isEditingEnabled?void 0:this.onElementKeyDown,role:"button",tabIndex:0},y.createElement(e.display,{key:`${this.UID}/${this.revId}`,config:this.options.config,data:this.data,isSelected:i}))}}function Ys(t,e){try{let r={targets:[]};if(e instanceof ie){const n=[];n.push(e?.div),r.targets=n,r.frame=e,t.select(r)}else t.currentLayer=e.parent,r.targets=[e?.div],t.select(r)}catch{Ws.A.emit(sn.r1.alertError,["Unable to select element, try selecting element in panel instead"])}}function qn(t,e){return Xs(t?[...ti,...Js]:[...ti],e)}function Xs(t,e){const r={options:[],current:[]},n=[];for(const i of t){const a={label:i.name,value:i.id,description:i.description};if(i.state===_s.pn.alpha){if(!ve.yn)continue;a.label=`${i.name} (Alpha)`,n.push(a)}else r.options.push(a);i.id===e&&r.current.push(a)}for(const i of n)r.options.push(i);return r}function ga(t,e,r){const n=fn.getIfExists(t.value)??ha,i={...n.getNewOptions(),type:n.id,name:""};if(r&&(i.placement={...i.placement,top:r.y,left:r.x}),n.defaultSize&&(i.placement={...i.placement,...n.defaultSize}),e){const a=new Qn(n,i,e);a.updateData(e.scene.context),e.elements.push(a),e.scene.save(),e.reinitializeMoveable(),setTimeout(()=>Ys(e.scene,a))}}function Hs(t,e,r){const i=t.getPanelData()?.series,a=[],s=new Set;return i?.forEach(o=>{const l=o.fields.filter(c=>!c.config.custom?.hideFrom?.tooltip);if(e.text?.field&&l.some(c=>(0,Ks.Ct)(c,o)===e.text?.field)){const c=l.filter(u=>(0,Ks.Ct)(u,o)===e.text?.field)[0];if(c?.getLinks){const u=c.display?c.display(r):{text:`${r}`,numeric:+r};c.getLinks({calculatedValue:u}).forEach(d=>{const f=`${d.title}/${d.href}`;s.has(f)||(a.push(d),s.add(f))})}}}),a}function ip(t){return t.options.connections&&t.options.connections.length>0}function Vs(t,e){return $s(e).some(n=>n.target===t)}function $s(t){const e=[];for(let r of t.values())r.options.connections&&r.options.connections.forEach((n,i)=>{(0,Oe.isString)(n.color)&&(n.color={fixed:n.color}),(0,Oe.isNumber)(n.size)&&(n.size={fixed:2,min:1,max:10});const a=n.targetName?t.get(n.targetName):r.parent;a&&e.push({index:i,source:r,target:a,info:n})});return e}function js(t,e){return e.connections.state.filter(r=>r.target===t)}function ap(t,e){js(t,e).forEach(n=>{const a=(n.source.options.connections?.splice(0)??[]).filter(s=>s.targetName!==t.getName());n.source.onChange({...n.source.options,connections:a})})}const op=(t,e,r,n,i)=>{const a=t.left-e.left+t.width/2,s=t.top-e.top+t.height/2,o=(a+r.source.x*t.width/2)/i,l=(s-r.source.y*t.height/2)/i;let c,u;const d=n.div?.getBoundingClientRect();if(r.targetName&&d){const f=d.left-e.left+d.width/2,p=d.top-e.top+d.height/2;c=f+r.target.x*d.width/2,u=p-r.target.y*d.height/2}else{const f=e.width/2,p=e.height/2;c=f+r.target.x*e.width/2,u=p-r.target.y*e.height/2}return c/=i,u/=i,{x1:o,y1:l,x2:c,y2:u}},sp=(t,e)=>{if(t){const i=e.context.getPanelData()?.series[0]?.fields.find(a=>a.name=t)?.values;return i?i.length-1:0}return 0},lp=(t,e,r)=>{const n=ve.$W.theme2.colors.text.primary,i=sp(t.size?.field,e),a=t.color?e.context.getColor(t.color).value():n,s=t.size?e.context.getScale(t.size).get(i):r;return{strokeColor:a,strokeWidth:s}},un=t=>ve.$W.featureToggles.canvasPanelPanZoom?t.transformComponentRef?.current?.instance.contentComponent?.getBoundingClientRect():t.div?.getBoundingClientRect(),cp=t=>{if(ve.$W.featureToggles.canvasPanelPanZoom)return t.transformComponentRef?.current?.instance},up=t=>ve.$W.featureToggles.canvasPanelPanZoom?t.transformComponentRef?.current?.instance.contentComponent:t.div,dp={settings:{}},fp=t=>{const{data:e,isSelected:r,config:n}=t,i=(0,Pt.of)(Us(e)),a=(0,cn.d2)(),s=a.instanceState?.scene;let o;o=a.instanceState?.scene?.data.series;const l=(0,Zn.A)(s?.editModeEnabled??(0,Gs.of)(!1)),c=()=>o&&n.text?.field&&u()?"Field not found":o&&n.text?.field&&!e?.text?"No data":e?.text?e.text:"Double click to set field",u=()=>{const d=(0,Fs.BP)(o);return!(0,Fs.v3)(n.text?.field,d)};return l&&r?y.createElement(pp,{...t}):y.createElement("div",{className:i.container},y.createElement("span",{className:i.span},c()))},pp=t=>{let{data:e,config:r}=t;const n=(0,cn.d2)();let i;i=n.instanceState?.scene?.data.series;const a=(0,y.useCallback)(o=>{let l;if(l=n.instanceState?.selected[0],l){const c=l.options;l.onChange({...c,config:{...c.config,text:{fixed:"",field:o,mode:en.RU.Field}},background:{color:{field:o,fixed:c.background?.color?.fixed??""}}});const u=n.instanceState?.scene;u&&(u.editModeEnabled.next(!1),u.updateData(u.data))}},[n.instanceState?.scene,n.instanceState?.selected]),s=(0,Pt.of)(Us(e));return y.createElement("div",{className:s.inlineEditorContainer},i&&y.createElement(ep.O,{context:{data:i},value:r.text?.field??"",onChange:a,item:dp}))},Us=t=>e=>({container:(0,rt.css)({position:"absolute",height:"100%",width:"100%",display:"table"}),inlineEditorContainer:(0,rt.css)({height:"100%",width:"100%",display:"flex",alignItems:"center",padding:e.spacing(1)}),span:(0,rt.css)({display:"table-cell",verticalAlign:t?.valign,textAlign:t?.align,fontSize:`${t?.size}px`,color:t?.color})}),dn={id:"metric-value",name:"Metric Value",description:"Display a field value",display:fp,hasEditMode:!0,defaultSize:{width:260,height:50},getNewOptions:t=>({...t,config:{align:Ct.Center,valign:kt.Middle,color:{fixed:fa},text:{mode:en.RU.Field,fixed:"",field:""},size:20},background:{color:{fixed:Vt}},placement:{width:t?.placement?.width,height:t?.placement?.height,top:t?.placement?.top??100,left:t?.placement?.left??100}}),prepareData:(t,e)=>{const r={text:e.text?t.getText(e.text).value():"",align:e.align??Ct.Center,valign:e.valign??kt.Middle,size:e.size};return e.color&&(r.color=t.getColor(e.color).value()),r.links=Hs(t,e,r.text),r},registerOptionsUI:t=>{const e=["Metric value"];t.addCustomEditor({category:e,id:"textSelector",path:"config.text",name:"Text",editor:nn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:"Text color",editor:kr.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:"Align text",settings:{options:[{value:Ct.Left,label:"Left"},{value:Ct.Center,label:"Center"},{value:Ct.Right,label:"Right"}]},defaultValue:Ct.Left}).addRadio({category:e,path:"config.valign",name:"Vertical align",settings:{options:[{value:kt.Top,label:"Top"},{value:kt.Middle,label:"Middle"},{value:kt.Bottom,label:"Bottom"}]},defaultValue:kt.Middle}).addNumberInput({category:e,path:"config.size",name:"Text size",settings:{placeholder:"Auto"}})}};var Zs=K(3911);class vp extends y.PureComponent{render(){const{data:e}=this.props,r=hp(ve.$W.theme2,e);return y.createElement("div",{className:r.container},y.createElement("span",{className:r.span},e?.text))}}const hp=(0,Zs.N)((t,e)=>({container:(0,rt.css)({position:"absolute",height:"100%",width:"100%",display:"table"}),span:(0,rt.css)({display:"table-cell",verticalAlign:e?.valign,textAlign:e?.align,fontSize:`${e?.size}px`,color:e?.color})})),gp={id:"rectangle",name:"Rectangle",description:"Rectangle",display:vp,defaultSize:{width:240,height:160},getNewOptions:t=>({...t,config:{align:Ct.Center,valign:kt.Middle,color:{fixed:fa}},background:{color:{fixed:Vt}}}),prepareData:(t,e)=>{const r={text:e.text?t.getText(e.text).value():"",align:e.align??Ct.Center,valign:e.valign??kt.Middle,size:e.size};return e.color&&(r.color=t.getColor(e.color).value()),r},registerOptionsUI:t=>{const e=["Rectangle"];t.addCustomEditor({category:e,id:"textSelector",path:"config.text",name:"Text",editor:nn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:"Text color",editor:kr.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:"Align text",settings:{options:[{value:Ct.Left,label:"Left"},{value:Ct.Center,label:"Center"},{value:Ct.Right,label:"Right"}]},defaultValue:Ct.Left}).addRadio({category:e,path:"config.valign",name:"Vertical align",settings:{options:[{value:kt.Top,label:"Top"},{value:kt.Middle,label:"Middle"},{value:kt.Bottom,label:"Bottom"}]},defaultValue:kt.Middle}).addNumberInput({category:e,path:"config.size",name:"Text size",settings:{placeholder:"Auto"}})}},mp=t=>{const e=(0,Pt.of)(Jn(t));return y.createElement("g",{className:e.outline},y.createElement("g",{className:e.server},y.createElement("path",{d:"m2.6953 37.5v20.883c0 7.6725 15.592 13.922 34.805 13.922s34.805-6.2493 34.805-13.922v-20.883"}),y.createElement("path",{d:"m2.6953 16.617v20.883c0 7.7035 15.592 13.922 34.805 13.922s34.805-6.2184 34.805-13.922v-20.883"}),y.createElement("path",{d:"m37.5 30.539c19.212 0 34.805-6.2185 34.805-13.922 0-7.7034-15.592-13.922-34.805-13.922s-34.805 6.2184-34.805 13.922c0 7.7035 15.592 13.922 34.805 13.922z"})),y.createElement("g",{className:e.circleBack},y.createElement("path",{transform:"matrix(2.7868 0 0 2.7868 -132.86 -110.58)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),y.createElement("path",{transform:"matrix(2.7868 0 0 2.7868 -122.04 -111.7)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),y.createElement("path",{transform:"matrix(2.7868 0 0 2.7868 -111.21 -114.77)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"})),y.createElement("g",{className:e.circle},y.createElement("path",{transform:"matrix(1.4922 0 0 1.4922 -52.337 -30.65)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),y.createElement("path",{transform:"matrix(1.4922 0 0 1.4922 -41.518 -31.769)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),y.createElement("path",{transform:"matrix(1.4922 0 0 1.4922 -30.688 -34.842)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"})))},yp=t=>{const e=(0,Pt.of)(Jn(t));return y.createElement("g",null,y.createElement("g",{className:e.outline,transform:"matrix(1.01 0 0 1.01 -.375 -.375)"},y.createElement("g",{className:e.server},y.createElement("path",{d:"m3.2812 55.659 9.125-52.377h50.188l9.125 52.377"}),y.createElement("path",{d:"m3.2812 56.328c0-2.5246 2.0379-4.5625 4.5625-4.5625h59.313c2.5245 0 4.5625 2.0379 4.5625 4.5625v10.828c0 2.5245-2.038 4.5625-4.5625 4.5625h-59.313c-2.5246 0-4.5625-2.038-4.5625-4.5625z"})),y.createElement("path",{d:"m12.406 61.742h30.69"}),y.createElement("path",{d:"m52.8 51.765v19.953"}),y.createElement("path",{className:e.circleBack,transform:"matrix(2.7592 0 0 2.7592 -109.42 -108.61)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),y.createElement("path",{className:e.circle,transform:"matrix(1.4775 0 0 1.4775 -29.697 -29.479)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"})))},bp=t=>{const e=(0,Pt.of)(Jn(t));return y.createElement("g",{className:e.outline,transform:"translate(.5 .49865)"},y.createElement("g",{className:e.server},y.createElement("path",{d:"m3.4834 21.768 8.0783-19.456h50.875l8.0784 19.456"}),y.createElement("path",{d:"m2.3125 24.852c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z"}),y.createElement("path",{d:"m2.3125 42.031c0-2.5592 2.0658-4.6251 4.625-4.6251h60.125c2.5592 0 4.625 2.0659 4.625 4.6251v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z"}),y.createElement("path",{d:"m2.3125 59.172c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z"})),y.createElement("path",{d:"m11.562 28.797h31.111"}),y.createElement("path",{d:"m52.508 20.227v17.143"}),y.createElement("path",{d:"m11.562 63.117h31.111"}),y.createElement("path",{d:"m52.508 54.547v17.143"}),y.createElement("path",{d:"m11.562 45.977h31.111"}),y.createElement("path",{d:"m52.508 37.406v17.143"}),y.createElement("g",{className:e.circleBack},y.createElement("path",{transform:"matrix(2.7868 0 0 2.7868 -111.31 -143.2)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),y.createElement("path",{transform:"matrix(2.7868 0 0 2.7868 -111.31 -126.14)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),y.createElement("path",{transform:"matrix(2.7868 0 0 2.7868 -111.31 -108.86)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"})),y.createElement("g",{className:e.circle},y.createElement("path",{transform:"matrix(1.4922 0 0 1.4922 -30.794 -63.277)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),y.createElement("path",{transform:"matrix(1.4922 0 0 1.4922 -30.794 -46.209)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),y.createElement("path",{transform:"matrix(1.4922 0 0 1.4922 -30.794 -28.93)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"})))},Ep=t=>{const e=(0,Pt.of)(Jn(t));return y.createElement("g",{className:e.outline},y.createElement("g",{className:e.server},y.createElement("path",{d:"m5.3125 9.6562c0-3.5621 2.8754-6.4375 6.4375-6.4375h51.5c3.5621 0 6.4375 2.8754 6.4375 6.4375v28.625c0 3.5621-2.8754 6.4375-6.4375 6.4375h-51.5c-3.5621 0-6.4375-2.8754-6.4375-6.4375z"}),y.createElement("path",{d:"m2.8125 59.859c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z"})),y.createElement("path",{d:"m37.5 46.719v2.875"}),y.createElement("path",{d:"m24.625 51.343h25.75"}),y.createElement("path",{d:"m12.062 63.804h31.111"}),y.createElement("path",{d:"m53.008 55.234v17.143"}),y.createElement("path",{className:e.circleBack,transform:"matrix(2.7868 0 0 2.7868 -110.81 -108.2)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),y.createElement("path",{className:e.circle,transform:"matrix(1.4922 0 0 1.4922 -30.294 -28.27)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}))};var Cp=(t=>(t.Single="Single",t.Stack="Stack",t.Database="Database",t.Terminal="Terminal",t))(Cp||{});const Qs=ve.Ay.theme2.colors.text.primary,Sp={id:"server",name:"Server",description:"Basic server with status",display:({data:t})=>t?y.createElement("svg",{viewBox:"0 0 75 75"},t.type==="Single"?y.createElement(yp,{...t}):t.type==="Stack"?y.createElement(bp,{...t}):t.type==="Database"?y.createElement(mp,{...t}):t.type==="Terminal"?y.createElement(Ep,{...t}):null):null,defaultSize:{width:100,height:100},getNewOptions:t=>({...t,background:{color:{fixed:"transparent"}},placement:{width:t?.placement?.width??100,height:t?.placement?.height??100,top:t?.placement?.top,left:t?.placement?.left},config:{type:"Single"}}),prepareData:(t,e)=>({blinkRate:e?.blinkRate?t.getScalar(e.blinkRate).value():0,statusColor:e?.statusColor?t.getColor(e.statusColor).value():"transparent",bulbColor:e?.bulbColor?t.getColor(e.bulbColor).value():"green",type:e.type}),registerOptionsUI:t=>{const e=["Server"];t.addSelect({category:e,path:"config.type",name:"Type",settings:{options:[{value:"Single",label:"Single"},{value:"Stack",label:"Stack"},{value:"Database",label:"Database"},{value:"Terminal",label:"Terminal"}]},defaultValue:"Single"}).addCustomEditor({category:e,id:"statusColor",path:"config.statusColor",name:"Status color",editor:Yt.NO,settings:{},defaultValue:{fixed:"transparent"}}).addCustomEditor({category:e,id:"bulbColor",path:"config.bulbColor",name:"Bulb color",editor:Yt.NO,settings:{},defaultValue:{fixed:"green"}}).addCustomEditor({category:e,id:"blinkRate",path:"config.blinkRate",name:"Blink rate [hz] (0 = off)",editor:Yt.AW,settings:{min:0,max:100}})}},Jn=t=>e=>({bulb:(0,rt.css)({"@keyframes blink":{"0%":{fillOpacity:0},"50%":{fillOpacity:1},"100%":{fillOpacity:0}}}),server:(0,rt.css)({fill:t?.statusColor??"transparent"}),circle:(0,rt.css)({animation:`blink ${t?.blinkRate?1/t.blinkRate:0}s infinite step-end`,fill:t?.bulbColor,stroke:"none"}),circleBack:(0,rt.css)({fill:Qs,stroke:"none",opacity:1}),outline:(0,rt.css)({stroke:Qs,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"4px"})}),xp=t=>{const{data:e,isSelected:r}=t,n=(0,Pt.of)(qs(e)),a=(0,cn.d2)().instanceState?.scene;return(0,Zn.A)(a?.editModeEnabled??(0,Gs.of)(!1))&&r?y.createElement(Dp,{...t}):y.createElement("div",{className:n.container},y.createElement("span",{className:n.span},e?.text?e.text:"Double click to set text"))},Dp=t=>{let{data:e,config:r}=t;const n=(0,cn.d2)();let i;i=n.instanceState?.scene?.data.series;const a=(0,y.useRef)(r.text?.fixed??"");(0,y.useEffect)(()=>()=>{l(a.current)});const s=u=>{if(u.key==="Enter"){u.preventDefault();const d=n.instanceState?.scene;d&&d.editModeEnabled.next(!1)}},o=u=>{a.current=u.currentTarget.value},l=(0,y.useCallback)(u=>{let d;if(d=n.instanceState?.selected[0],d){const f=d.options;d.onChange({...f,config:{...f.config,text:{...d.options.config.text,fixed:u}}});const p=n.instanceState?.scene;p&&p.updateData(p.data)}},[n.instanceState?.scene,n.instanceState?.selected]),c=(0,Pt.of)(qs(e));return y.createElement("div",{className:c.inlineEditorContainer},i&&y.createElement(on.p,{defaultValue:r.text?.fixed??"",onKeyDown:s,onKeyUp:o,autoFocus:!0}))},qs=t=>e=>({container:(0,rt.css)({position:"absolute",height:"100%",width:"100%",display:"table"}),inlineEditorContainer:(0,rt.css)({height:"100%",width:"100%",display:"flex",alignItems:"center",padding:e.spacing(1)}),span:(0,rt.css)({display:"table-cell",verticalAlign:t?.valign,textAlign:t?.align,fontSize:`${t?.size}px`,color:t?.color})}),wp={id:"text",name:"Text",description:"Display text",display:xp,hasEditMode:!0,defaultSize:{width:100,height:50},getNewOptions:t=>({...t,config:{align:Ct.Center,valign:kt.Middle,color:{fixed:Df},size:16},placement:{width:t?.placement?.width??100,height:t?.placement?.height??100,top:t?.placement?.top,left:t?.placement?.left}}),prepareData:(t,e)=>{const r={text:e.text?t.getText(e.text).value():"",align:e.align??Ct.Center,valign:e.valign??kt.Middle,size:e.size};return e.color&&(r.color=t.getColor(e.color).value()),r.links=Hs(t,e,r.text),r},registerOptionsUI:t=>{const e=["Text"];t.addCustomEditor({category:e,id:"textSelector",path:"config.text",name:"Text",editor:nn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:"Text color",editor:kr.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:"Align text",settings:{options:[{value:Ct.Left,label:"Left"},{value:Ct.Center,label:"Center"},{value:Ct.Right,label:"Right"}]},defaultValue:Ct.Left}).addRadio({category:e,path:"config.valign",name:"Vertical align",settings:{options:[{value:kt.Top,label:"Top"},{value:kt.Middle,label:"Middle"},{value:kt.Bottom,label:"Bottom"}]},defaultValue:kt.Middle}).addNumberInput({category:e,path:"config.size",name:"Text size",settings:{placeholder:"Auto"}})}},Tp={id:"windTurbine",name:"Wind Turbine",description:"Spinny spinny",display:({data:t})=>{const e=(0,Pt.of)(Ap),r=`spin ${t?.rpm?60/Math.abs(t.rpm):0}s linear infinite`;return y.createElement("svg",{viewBox:"0 0 189.326 283.989",preserveAspectRatio:"xMidYMid meet",style:{fill:Vt}},y.createElement("symbol",{id:"blade"},y.createElement("path",{fill:"#e6e6e6",id:"blade-front",d:"M14.6491879,1.85011601 C14.2684455,-0.0535962877 10.7150812,-0.815081206 9.06473318,3.37308585 L0.434338747,70.7658933 L8.93805104,91.9607889 L15.4106729,90.437819 L17.5684455,78.3807425 L14.5218097,1.97679814 L14.6491879,1.85011601 Z"}),y.createElement("path",{fill:"#d0d6d7",id:"blade-side",d:"M11.0951276,0.581206497 C10.3336427,0.961948956 9.57215777,1.85011601 8.93735499,3.24640371 L0.306960557,70.6392111 L8.81067285,91.8341067 L3.35359629,70.0044084 L11.0951276,0.581206497 Z"})),y.createElement("g",null,y.createElement("g",{id:"structure",transform:"translate(58.123, 82.664)",fillRule:"nonzero"},y.createElement("polygon",{id:"tower",fill:"#e6e6e6",points:"33.111,10.984 39.965,10.984 44.28,196.176 28.796,196.176"}),y.createElement("path",{id:"yaw",fill:"rgba(0,0,0,0.25)",d:"M40.3454756,23.2948956 L40.7262181,34.8445476 C38.8225058,35.0986079 35.7765661,35.0986079 32.349884,34.337123 L32.7306265,23.2955916 L40.3454756,23.2955916 L40.3454756,23.2948956 Z"}),y.createElement("path",{id:"base",fill:"#d0d6d7",transform:"translate(0 42)",d:"M26.3846868,150.591647 L46.5640371,150.591647 C48.8484919,150.591647 50.7522042,152.49536 50.7522042,154.779814 L50.7522042,158.967981 L22.0691415,158.967981 L22.0691415,154.779814 C22.0691415,152.49536 23.9728538,150.591647 26.2573086,150.591647 L26.3846868,150.591647 Z"}),y.createElement("circle",{id:"nacelle",fill:"#e6e6e6",cx:"36.54",cy:"12",r:"11.93"}),y.createElement("circle",{id:"gearbox",fill:"none",stroke:"#d0d6d7",strokeWidth:"2.75",cx:"36.538",cy:"11.999",r:"5.8"})),y.createElement("g",{className:e.blade,style:{animation:r}},y.createElement("use",{id:"blade1",href:"#blade",x:"83.24",y:"0"}),y.createElement("use",{id:"blade2",href:"#blade",x:"83.24",y:"0",transform:"rotate(120 94.663 94.663)"}),y.createElement("use",{id:"blade3",href:"#blade",x:"83.24",y:"0",transform:"rotate(-120 94.663 94.663)"}))))},defaultSize:{width:100,height:155},getNewOptions:t=>({...t,background:{color:{fixed:"transparent"}},placement:{width:t?.placement?.width??100,height:t?.placement?.height??155,top:t?.placement?.top,left:t?.placement?.left}}),prepareData:(t,e)=>({rpm:e?.rpm?t.getScalar(e.rpm).value():0}),registerOptionsUI:t=>{const e=["Wind Turbine"];t.addCustomEditor({category:e,id:"rpm",path:"config.rpm",name:"RPM",editor:Yt.AW})}},Ap=t=>({blade:(0,rt.css)({transformOrigin:"94.663px 94.663px",transform:"rotate(15deg)","@keyframes spin":{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}})}),ma={...dn.getNewOptions(),placement:{...dn.getNewOptions().placement,...dn.defaultSize},type:dn.id,name:"Element 1"},ti=[dn,wp,Zf,gp,tp,Sp],Js=[Kf,Tp,Vf,Wf,Xf],fn=new wf.O(()=>[...ti,...Js]);var Qt=(t=>(t.Delete="delete",t.Duplicate="duplicate",t.MoveTop="move-top",t.MoveBottom="move-bottom",t))(Qt||{}),He=(t=>(t.ElementManagement="element-management",t.SelectedElement="selected-element",t.SelectedConnection="selected-connection",t))(He||{});const Re=10,ei=50,Mp={id:"frame",name:"Frame",description:"Frame",getNewOptions:()=>({config:{}}),display:()=>y.createElement("div",null,"FRAME!")};class ie extends Qn{constructor(e,r,n){super(Mp,e,n),this.options=e,this.parent=n,this.elements=[],this.doAction=(a,s,o=!0,l=!0)=>{switch(a){case Qt.Delete:this.elements=this.elements.filter(d=>d!==s),ap(s,this.scene),this.scene.byName.delete(s.options.name),this.scene.save(),this.reinitializeMoveable();break;case Qt.Duplicate:if(s.item.id==="frame"){console.log("Can not duplicate frames (yet)",a,s);return}const c=(0,Oe.cloneDeep)(s.options);if(l){const{constraint:d,placement:f}=s.options,{vertical:p,horizontal:v}=d??{},h={...f};switch(p){case ht.Top:h.top==null?h.top=25:h.top+=Re;break;case ht.Bottom:h.bottom==null?h.bottom=100:h.bottom-=Re;break;case ht.TopBottom:h.top==null?h.top=25:h.top+=Re,h.bottom==null?h.bottom=100:h.bottom-=Re;break;case ht.Center:h.top!=null&&(h.top-=Re);break}switch(v){case pt.Left:h.left==null?h.left=ei:h.left+=Re;break;case pt.Right:h.right==null?h.right=ei:h.right-=Re;break;case pt.LeftRight:h.left==null?h.left=ei:h.left+=Re,h.right==null?h.right=ei:h.right-=Re;break;case pt.Center:h.left!=null&&(h.left-=Re);break}c.placement=h}c.connections=void 0;const u=new Qn(s.item,c,this);u.updateData(this.scene.context),o&&(u.options.name=this.scene.getNextElementName()),this.elements.push(u),this.scene.byName.set(u.options.name,u),this.scene.byName.set(s.options.name,s),this.scene.save(),this.reinitializeMoveable(),setTimeout(()=>{this.scene.targetsToSelect.add(u.div)});break;case Qt.MoveTop:case Qt.MoveBottom:s.parent?.doMove(s,a);break;default:console.log("DO action",a,s);return}},this.scene=r;let{elements:i}=this.options;i||(this.options.elements=i=[]);for(const a of i)if(a.type==="frame")this.elements.push(new ie(a,r,this));else{const s=fn.getIfExists(a.type)??ha;this.elements.push(new Qn(s,a,this))}}isRoot(){return!1}updateData(e){super.updateData(e);for(const r of this.elements)r.updateData(e)}reorder(e,r){const n=Array.from(this.elements),[i]=n.splice(e,1);n.splice(r,0,i),this.elements=n,this.reinitializeMoveable()}reorderTree(e,r,n=!1){const i=Array.from(this.elements),a=this.elements.indexOf(e),s=n?this.elements.length-1:this.elements.indexOf(r),[o]=i.splice(a,1);i.splice(s,0,o),this.elements=i,this.reinitializeMoveable()}doMove(e,r){const n=this.elements.filter(i=>i!==e);r===Qt.MoveBottom?n.unshift(e):n.push(e),this.elements=n,this.scene.save(),this.reinitializeMoveable()}reinitializeMoveable(){this.scene.clearCurrentSelection(),setTimeout(()=>this.scene.initMoveable(!0,this.scene.isEditingEnabled))}render(){return y.createElement("div",{key:this.UID,ref:this.initElement},this.elements.map(e=>e.render()))}visit(e){super.visit(e);for(const r of this.elements)e(r)}getSaveModel(){return{...this.options,elements:this.elements.map(e=>e.getSaveModel())}}}var tl=K(39741),kp=K(64423),el=K(12131);function Pp(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.map(function(n){return n.split(" ").map(function(i){return i?""+t+i:""}).join(" ")}).join(" ")}function Op(t,e){return e.replace(/([^}{]*){/gm,function(r,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"})}function Ge(t,e){return function(r){r&&(t[e]=r)}}function rl(t,e,r){return function(n){n&&(t[e][r]=n)}}function ya(t,e){return function(r){var n=r.prototype;t.forEach(function(i){e(n,i)})}}function Rp(t,e){return e===void 0&&(e={}),function(r,n){t.forEach(function(i){var a=e[i]||i;a in r||(r[a]=function(){for(var s,o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];var c=(s=this[n])[i].apply(s,o);return c===this[n]?this:c})})}}var nl="rgb",il="rgba",al="hsl",ol="hsla",Db=[nl,il,al,ol],_p="function",wb="property",Tb="array",Np="object",Lp="string",zp="number",pn="undefined",sl=typeof window!==pn,or=typeof document!==pn&&document,ll=null,Ab=function(t){if(!or)return"";var e=(or.body||or.documentElement).style,r=ll.length;if(typeof e[t]!==pn)return t;for(var n=0;n<r;++n){var i="-"+ll[n]+"-"+t;if(typeof e[i]!==pn)return i}return""},Mb=null,kb=null,Pb=null,Ob=null,Ip=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],zt=1e-7,Rb=1/zt,ri={cm:function(t){return t*96/2.54},mm:function(t){return t*96/254},in:function(t){return t*96},pt:function(t){return t*96/72},pc:function(t){return t*96/6},"%":function(t,e){return t*e/100},vw:function(t,e){return e===void 0&&(e=window.innerWidth),t/100*e},vh:function(t,e){return e===void 0&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Bp(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function ni(t,e,r,n){return(t*n+e*r)/(r+n)}function ii(t){return typeof t===pn}function de(t){return t&&typeof t===Np}function Lt(t){return Array.isArray(t)}function $t(t){return typeof t===Lp}function Pr(t){return typeof t===zp}function ai(t){return typeof t===_p}function Gp(t,e){var r=t===""||t==" ",n=e===""||e==" ";return n&&r||t===e}function cl(t,e,r,n,i){var a=ba(t,e,r);return a?r:Fp(t,e,r+1,n,i)}function ba(t,e,r){if(!t.ignore)return null;var n=e.slice(Math.max(r-3,0),r+3).join("");return new RegExp(t.ignore).exec(n)}function Fp(t,e,r,n,i){for(var a=function(c){var u=e[c].trim();if(u===t.close&&!ba(t,e,c))return{value:c};var d=c,f=ae(i,function(p){var v=p.open;return v===u});if(f&&(d=cl(f,e,c,n,i)),d===-1)return s=c,"break";c=d,s=c},s,o=r;o<n;++o){var l=a(o);if(o=s,typeof l=="object")return l.value;if(l==="break")break}return-1}function Ea(t,e){var r=$t(e)?{separator:e}:e,n=r.separator,i=n===void 0?",":n,a=r.isSeparateFirst,s=r.isSeparateOnlyOpenClose,o=r.isSeparateOpenClose,l=o===void 0?s:o,c=r.openCloseCharacters,u=c===void 0?Ip:c,d=u.map(function(w){var D=w.open,T=w.close;return D===T?D:D+"|"+T}).join("|"),f="(\\s*"+i+"\\s*|"+d+"|\\s+)",p=new RegExp(f,"g"),v=t.split(p).filter(function(w){return w&&w!=="undefined"}),h=v.length,g=[],m=[];function b(){return m.length?(g.push(m.join("")),m=[],!0):!1}for(var E=function(w){var D=v[w].trim(),T=w,A=ae(u,function(k){var _=k.open;return _===D}),M=ae(u,function(k){var _=k.close;return _===D});if(A){if(T=cl(A,v,w,h,u),T!==-1&&l)return b()&&a||(g.push(v.slice(w,T+1).join("")),w=T,a)?(C=w,"break"):(C=w,"continue")}else if(M&&!ba(M,v,w)){var P=Bp(u);return P.splice(u.indexOf(M),1),{value:Ea(t,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:s,isSeparateOpenClose:l,openCloseCharacters:P})}}else if(Gp(D,i)&&!s)return b(),a?(C=w,"break"):(C=w,"continue");T===-1&&(T=h-1),m.push(v.slice(w,T+1).join("")),w=T,C=w},C,x=0;x<h;++x){var S=E(x);if(x=C,typeof S=="object")return S.value;if(S==="break")break}return m.length&&g.push(m.join("")),g}function Ve(t){return Ea(t,"")}function $e(t){return Ea(t,",")}function Ca(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function sr(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var r=e[1],n=e[2],i=e[3];return{prefix:r,unit:i,value:parseFloat(n)}}function Sa(t){return t.replace(/[\s-_]+([^\s-_])/g,function(e,r){return r.toUpperCase()})}function oi(t,e){return e===void 0&&(e="-"),t.replace(/([a-z])([A-Z])/g,function(r,n,i){return""+n+e+i.toLowerCase()})}function _b(t){return[].slice.call(t)}function vn(){return Date.now?Date.now():new Date().getTime()}function Fe(t,e,r){r===void 0&&(r=-1);for(var n=t.length,i=0;i<n;++i)if(e(t[i],i,t))return i;return r}function Kp(t,e,r){r===void 0&&(r=-1);for(var n=t.length,i=n-1;i>=0;--i)if(e(t[i],i,t))return i;return r}function Nb(t,e,r){var n=Kp(t,e);return n>-1?t[n]:r}function ae(t,e,r){var n=Fe(t,e);return n>-1?t[n]:r}var ul=function(){var t=vn(),e=sl&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(r){var n=vn(),i=setTimeout(function(){r(n-t)},1e3/60);return i}}(),Wp=function(){var t=sl&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(e){clearTimeout(e)}}();function _e(t){return Object.keys(t)}function Yp(t){var e=_e(t);return e.map(function(r){return t[r]})}function Lb(t){var e=_e(t);return e.map(function(r){return[r,t[r]]})}function zb(t,e){e===void 0&&(e=[]),t.sort(function(r,n){var i=e.indexOf(r),a=e.indexOf(n);return a===-1&&i===-1?0:i===-1?1:a===-1?-1:i-a})}function xt(t,e){var r=sr(t),n=r.value,i=r.unit;if(de(e)){var a=e[i];if(a){if(ai(a))return a(n);if(ri[i])return ri[i](n,a)}}else if(i==="%")return n*e/100;return ri[i]?ri[i](n):n}function si(t,e,r){return Math.max(e,Math.min(t,r))}function dl(t,e,r,n){return n===void 0&&(n=t[0]/t[1]),[[ct(e[0],zt),ct(e[0]/n,zt)],[ct(e[1]*n,zt),ct(e[1],zt)]].filter(function(i){return i.every(function(a,s){var o=e[s],l=ct(o,zt);return r?a<=o||a<=l:a>=o||a>=l})})[0]||t}function xa(t,e,r,n){if(!n)return t.map(function(p,v){return si(p,e[v],r[v])});var i=t[0],a=t[1],s=n===!0?i/a:n,o=dl(t,e,!1,s),l=o[0],c=o[1],u=dl(t,r,!0,s),d=u[0],f=u[1];return i<l||a<c?(i=l,a=c):(i>d||a>f)&&(i=d,a=f),[i,a]}function Xp(t){for(var e=t.length,r=0,n=e-1;n>=0;--n)r+=t[n];return r}function Da(t){for(var e=t.length,r=0,n=e-1;n>=0;--n)r+=t[n];return e?r/e:0}function It(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return i>=0?i:i+Math.PI*2}function Hp(t){return[0,1].map(function(e){return Da(t.map(function(r){return r[e]}))})}function fl(t){var e=Hp(t),r=It(e,t[0]),n=It(e,t[1]);return r<n&&n-r<Math.PI||r>n&&n-r<-Math.PI?1:-1}function Ne(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function ct(t,e){if(!e)return t;var r=1/e;return Math.round(t/e)/r}function pl(t,e){return t.forEach(function(r,n){t[n]=ct(t[n],e)}),t}function Vp(t){for(var e=[],r=0;r<t;++r)e.push(r);return e}function Ib(t,e,r){var n=!1;return t.replace(e,function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return n?i[0]:(n=!0,$t(r)?r:r.apply(void 0,i))})}function vl(t){return t.reduce(function(e,r){return e.concat(r)},[])}function $p(t){return t.reduce(function(e,r){return Lt(r)?e.push.apply(e,$p(r)):e.push(r),e},[])}function hl(t,e){t.indexOf(e)===-1&&t.push(e)}function jp(t){return t.replace("#","")}function gl(t){var e=jp(t),r=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),i=parseInt(e.substring(4,6),16),a=parseInt(e.substring(6,8),16)/255;return isNaN(a)&&(a=1),[r,n,i,a]}function Up(t){var e=t.charAt(1),r=t.charAt(2),n=t.charAt(3),i=t.charAt(4),a=["#",e,e,r,r,n,n,i,i];return a.join("")}function Zp(t){var e,r=t[0],n=t[1],i=t[2];r<0&&(r+=Math.floor((Math.abs(r)+360)/360)*360),r%=360;var a=(1-Math.abs(2*i-1))*n,s=a*(1-Math.abs(r/60%2-1)),o=i-a/2,l;return r<60?l=[a,s,0]:r<120?l=[s,a,0]:r<180?l=[0,a,s]:r<240?l=[0,s,a]:r<300?l=[s,0,a]:r<360?l=[a,0,s]:l=[0,0,0],[Math.round((l[0]+o)*255),Math.round((l[1]+o)*255),Math.round((l[2]+o)*255),(e=t[3])!==null&&e!==void 0?e:1]}function Bb(t){if(t.charAt(0)==="#")return t.length===4||t.length===5?gl(Up(t)):gl(t);if(t.indexOf("(")!==-1){var e=Ca(t),r=e.prefix,n=e.value;if(!r||!n)return;var i=$e(n),a=[0,0,0,1],s=i.length;switch(r){case nl:case il:for(var o=0;o<s;++o)a[o]=parseFloat(i[o]);return a;case al:case ol:for(var o=0;o<s;++o)i[o].indexOf("%")!==-1?a[o]=parseFloat(i[o])/100:a[o]=parseFloat(i[o]);return Zp(a)}}}function Gb(t,e){return or?e?or.querySelectorAll(t):or.querySelector(t):e?[]:null}function Gt(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function wa(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function ml(t,e){if(t.classList)t.classList.remove(e);else{var r=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(r," ")}}function Fb(t,e){if(!t||!e||!e.length)return{};var r;if(t instanceof Element)r=t;else if(t.length)r=t[0];else return{};for(var n={},i=fe(r).getComputedStyle(r),a=e.length,s=0;s<a;++s)n[e[s]]=i[e[s]];return n}function Ht(t,e,r,n){t.addEventListener(e,r,n)}function Ft(t,e,r,n){t.removeEventListener(e,r,n)}function oe(t){return t?.ownerDocument||or}function Ta(t){return oe(t).documentElement}function je(t){return oe(t).body}function fe(t){var e;return((e=t?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function yl(t){return t&&"postMessage"in t&&"blur"in t&&"self"in t}function Ue(t){return de(t)&&t.nodeName&&t.nodeType&&"ownerDocument"in t}var Qp=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(r){return this.values[this.keys.indexOf(r)]},e.set=function(r,n){var i=this.keys,a=this.values,s=i.indexOf(r),o=s===-1?i.length:s;i[o]=r,a[o]=n},t}(),qp=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(r){return this.object[r]},e.set=function(r,n){this.object[r]=n},t}(),Jp=typeof Map=="function",tv=function(){function t(){}var e=t.prototype;return e.connect=function(r,n){this.prev=r,this.next=n,r&&(r.next=this),n&&(n.prev=this)},e.disconnect=function(){var r=this.prev,n=this.next;r&&(r.next=n),n&&(n.prev=r)},e.getIndex=function(){for(var r=this,n=-1;r;)r=r.prev,++n;return n},t}();function ev(t,e){var r=[],n=[];return t.forEach(function(i){var a=i[0],s=i[1],o=new tv;r[a]=o,n[s]=o}),r.forEach(function(i,a){i.connect(r[a-1])}),t.filter(function(i,a){return!e[a]}).map(function(i,a){var s=i[0],o=i[1];if(s===o)return[0,0];var l=r[s],c=n[o-1],u=l.getIndex();l.disconnect(),c?l.connect(c,c.next):l.connect(void 0,r[0]);var d=l.getIndex();return[u,d]})}var rv=function(){function t(r,n,i,a,s,o,l,c){this.prevList=r,this.list=n,this.added=i,this.removed=a,this.changed=s,this.maintained=o,this.changedBeforeAdded=l,this.fixed=c}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var r=ev(this.changedBeforeAdded,this.fixed),n=this.changed,i=[];this.cacheOrdered=r.filter(function(a,s){var o=a[0],l=a[1],c=n[s],u=c[0],d=c[1];if(o!==l)return i.push([u,d]),!0}),this.cachePureChanged=i},t}();function hn(t,e,r){var n=Jp?Map:r?qp:Qp,i=r||function(b){return b},a=[],s=[],o=[],l=t.map(i),c=e.map(i),u=new n,d=new n,f=[],p=[],v={},h=[],g=0,m=0;return l.forEach(function(b,E){u.set(b,E)}),c.forEach(function(b,E){d.set(b,E)}),l.forEach(function(b,E){var C=d.get(b);typeof C>"u"?(++m,s.push(E)):v[C]=m}),c.forEach(function(b,E){var C=u.get(b);typeof C>"u"?(a.push(E),++g):(o.push([C,E]),m=v[E]||0,f.push([C-m,E-g]),p.push(E===C),C!==E&&h.push([C,E]))}),s.reverse(),new rv(t,e,a,s,h,o,f,p)}var nv=function(){function t(r,n){r===void 0&&(r=[]),this.findKeyCallback=n,this.list=[].slice.call(r)}var e=t.prototype;return e.update=function(r){var n=[].slice.call(r),i=hn(this.list,n,this.findKeyCallback);return this.list=n,i},t}();const iv=nv;var Aa=function(t,e){return Aa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Aa(t,e)};function gn(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Aa(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var he=function(){return he=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},he.apply(this,arguments)};function bl(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Ma(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))}function El(t){var e=0;return t.map(function(r){return r==null?"$compat".concat(++e):"".concat(r)})}function Cl(t){var e=[];return t.forEach(function(r){e=e.concat(Lt(r)?Cl(r):r)}),e}function ka(t,e){if(!e)return t;for(var r in e)ii(t[r])&&(t[r]=e[r]);return t}function li(t,e){if(t===e)return!1;for(var r in t)if(!(r in e))return!0;for(var r in e)if(t[r]!==e[r])return!0;return!1}function Sl(t){var e=t.className,r=bl(t,["className"]);return e!=null&&(r.class=e),delete r.style,delete r.children,r}function xl(t){var e={},r={};for(var n in t)n.indexOf("on")===0?r[n]=t[n]:e[n]=t[n];return[e,r]}function ci(t){if(!t)return null;var e=t.b;return Ue(e)?e:ci(t.c)}function Dl(t){var e=t.parentNode;e&&e.removeChild(t)}function wl(t){t.forEach(function(e){e()})}function av(){return this.constructor(this.props,this.context)}var Pa=0,ui=function(){function t(r,n,i,a,s,o,l){l===void 0&&(l={}),this.t=r,this.d=n,this.k=i,this.i=a,this.c=s,this.ref=o,this.ps=l,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=t.prototype;return e.s=function(){return!0},e.u=function(r,n,i,a,s){var o=this,l=o.d,c=Yp(n).filter(function(v){return v.$_req}),u=Cl(c.map(function(v){return v.$_subs})),d=ae(u,function(v){return v.d===l});if(o.b&&!$t(i)&&!s&&!o.s(i.props,a)&&!d){var f=u.reduce(function(v,h){var g=h.d;return v[0]?v[0].d===g&&v.push(h):g>l&&v.push(h),v},[]);return f.forEach(function(v){yn(v,v._ps,[v.o],r,n,!0)}),!1}o.o=i,o.ss(a);var p=o.ps;return $t(i)||(o.ps=i.props,o.ref=i.ref),fi(this),o.r(r,n,o.b?p:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var r=this,n=r.ref,i=r.fr;n&&n(i?i.current:r.b)},t}();function di(){return Object.__CROACT_CURRENT_INSTNACE__}function Tl(){return Pa}function ov(t){Pa=t}function fi(t){return Object.__CROACT_CURRENT_INSTNACE__=t,Pa=0,t}var Oa=function(){function t(r,n){r===void 0&&(r={}),this.props=r,this.context=n,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=t.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(r,n){return this.props!==r||this.state!==n},e.setState=function(r,n,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=he(he({},a.$_state),r),i?a.$_setState(n,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(n,i)})},e.forceUpdate=function(r){this.setState({},r,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(r,n){},e.componentWillUnmount=function(){},e.$_setState=function(r,n){var i=[],a=this.$_p,s=yn(a.c,[a],[a.o],i,a._cs,he(he({},this.state),this.$_state),n);s&&(r&&i.push(r),wl(i),fi(null))},t}(),Al=function(t){gn(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}var r=e.prototype;return r.shouldComponentUpdate=function(n,i){return li(this.props,n)||li(this.state,i)},e}(Oa);function Ml(t){var e=function(r){e.current=r};return e.current=t,e}function sv(t){return t._fr=!0,t}function kl(t,e,r,n){var i,a;return!((i=t?.prototype)===null||i===void 0)&&i.render?a=new t(e,r):(a=new Oa(e,r),a.constructor=t,t._fr?(n.fr=Ml(),a.render=function(){return this.constructor(this.props,n.fr)}):a.render=av),a.$_p=n,a}var lv=function(t){gn(e,t);function e(n,i,a,s,o,l,c){c===void 0&&(c={});var u=t.call(this,n,i,a,s,o,l,ka(c,n.defaultProps))||this;return u.typ="comp",u._usefs=[],u._uefs=[],u._defs=[],u}var r=e.prototype;return r.s=function(n,i){var a=this.b;return a.shouldComponentUpdate(ka(n,this.t.defaultProps),i||a.state)!==!1},r.r=function(n,i,a){var s,o,l=this,c=l.t;l.ps=ka(l.ps,l.t.defaultProps);var u=l.ps,d=!l.b,f=c.contextType,p=l.b,v=f?.get(l);l._cs=i,d?(p=kl(c,u,v,l),l.b=p):(p.props=u,p.context=v);var h=p.state;l._usefs=[],l._uefs=[];var g=p.render();((o=(s=g?.props)===null||s===void 0?void 0:s.children)===null||o===void 0?void 0:o.length)===0&&(g.props.children=l.ps.children);var m=he(he({},i),p.$_cs);yn(l,l._ps,g?[g]:[],n,m),d?l._uefs.push(function(){f?.register(l),p.componentDidMount()}):l._uefs.push(function(){p.componentDidUpdate(a,h)}),n.push(function(){l._usefs.forEach(function(b){b()}),d?l.md():l.ud(),l._defs=l._uefs.map(function(b){return b()})})},r.ss=function(n){var i=this.b;!i||!n||(i.state=n)},r.un=function(){var n,i=this;i._ps.forEach(function(s){s.un()});var a=i.t;(n=a.contextType)===null||n===void 0||n.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(s){s&&s()}),i.b.componentWillUnmount()},e}(ui);function cv(t,e,r){var n=Ra(Sl(t),Sl(e)),i=n.added,a=n.removed,s=n.changed;for(var o in i)r.setAttribute(o,i[o]);for(var l in s)r.setAttribute(l,s[l][1]);for(var c in a)r.removeAttribute(c)}function uv(t,e,r){var n=Ra(t,e),i=n.added,a=n.removed;for(var s in a)r.e(s,!0);for(var o in i)r.e(o)}function Ra(t,e){var r=_e(t),n=_e(e),i=hn(r,n,function(l){return l}),a={},s={},o={};return i.added.forEach(function(l){var c=n[l];a[c]=e[c]}),i.removed.forEach(function(l){var c=r[l];s[c]=t[c]}),i.maintained.forEach(function(l){var c=l[0],u=r[c],d=[t[u],e[u]];t[u]!==e[u]&&(o[u]=d)}),{added:a,removed:s,changed:o}}function dv(t,e,r){var n=r.style,i=Ra(t,e),a=i.added,s=i.removed,o=i.changed;for(var l in a){var c=oi(l,"-");n.setProperty(c,a[l])}for(var l in o){var u=oi(l,"-");n.setProperty(u,o[l][1])}for(var l in s){var d=oi(l,"-");n.removeProperty(d)}}function fv(t){return t.replace(/^on/g,"").toLowerCase()}var pv=function(t){gn(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.typ="elem",n._es={},n._svg=!1,n}var r=e.prototype;return r.e=function(n,i){var a=this,s=a._es,o=a.b,l=fv(n);i?(Ft(o,l,s[n]),delete s[n]):(s[n]=function(c){var u,d;(d=(u=a.ps)[n])===null||d===void 0||d.call(u,c)},Ht(o,l,s[n]))},r.s=function(n){return li(this.ps,n)},r.r=function(n,i,a){var s,o=this,l=!o.b,c=o.ps;if(l){var u=ci(o.c),d=!1;o._svg||o.t==="svg"?d=!0:d=u&&u.ownerSVGElement,o._svg=d;var f=(s=o._hyd)===null||s===void 0?void 0:s.splice(0,1)[0],p=o.t;if(f)o._hyd=[].slice.call(f.children||[]);else{var v=oe(u);d?f=v.createElementNS("http://www.w3.org/2000/svg",p):f=v.createElement(p)}o.b=f}yn(o,o._ps,c.children,n,i);var h=o.b,g=xl(a),m=g[0],b=g[1],E=xl(c),C=E[0],x=E[1];return cv(m,C,h),uv(b,x,o),dv(a.style||{},c.style||{},h),n.push(function(){l?o.md():o.ud()}),!0},r.un=function(){var n=this,i=n._es,a=n.b;for(var s in i)Ft(a,s,i[s]);n._ps.forEach(function(o){o.un()}),n._es={},n._sel||Dl(a)},e}(ui);function mn(t){if(!t||Ue(t))return t;var e=t.$_p._ps;return e.length?mn(e[0].b):null}function Pl(t){if(t){if(t.b&&Ue(t.b))return t;var e=t._ps;return e.length?Pl(e[0]):null}}function ge(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=e||{},a=i.key,s=i.ref,o=bl(i,["key","ref"]);return{type:t,key:a,ref:s,props:he(he({},o),{children:vl(r).filter(function(l){return l!=null&&l!==!1})})}}var Ol=function(t){gn(e,t);function e(n,i){i===void 0&&(i=0);var a=t.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=n,a}var r=e.prototype;return r.r=function(){return!0},r.un=function(){},e}(ui),vv=function(t){gn(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.typ="text",n}var r=e.prototype;return r.r=function(n){var i,a=this,s=!a.b;if(s){var o=ci(a.c),l=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=l||oe(o).createTextNode(a.t.replace("text_",""))}return n.push(function(){s?a.md():a.ud()}),!0},r.un=function(){Dl(this.b)},e}(ui);function hv(t,e,r){var n=r.map(function(l){return $t(l)?null:l.key}),i=El(e.map(function(l){return l.k})),a=El(n),s=hn(i,a,function(l){return l});s.removed.forEach(function(l){e.splice(l,1)[0].un()}),s.ordered.forEach(function(l){var c=l[0],u=l[1],d=e.splice(c,1)[0];e.splice(u,0,d);var f=mn(d.b),p=mn(e[u+1]&&e[u+1].b);f&&f.parentNode.insertBefore(f,p)}),s.added.forEach(function(l){e.splice(l,0,Rl(r[l],n[l],l,t))});var o=s.maintained.filter(function(l){l[0];var c=l[1],u=r[c],d=e[c],f=$t(u)?"text_".concat(u):u.type;return f!==d.t?(d.un(),e.splice(c,1,Rl(u,n[c],c,t)),!0):(d.i=c,!1)});return Ma(Ma([],s.added,!0),o.map(function(l){l[0];var c=l[1];return c}),!0)}function gv(t,e){for(var r=t._ps,n=r.length,i=e.i+1;i<n;++i){var a=mn(r[i].b);if(a)return a}return null}function Rl(t,e,r,n){var i=n.d+1;if($t(t)||Pr(t))return new vv("text_".concat(t),i,e,r,n,null,{});var a=t.type,s=typeof a=="string"?pv:lv;return new s(a,i,e,r,n,t.ref,t.props)}function yn(t,e,r,n,i,a,s){var o=hv(t,e,r),l=t._hyd,c=e.filter(function(d,f){return d._hyd=l,d.u(n,i,r[f],a,s)});t.typ==="container"&&t._sel&&e.forEach(function(d){var f=Pl(d);f&&(f._sel=!0)}),t._hyd=null;var u=ci(t);return u&&o.reverse().forEach(function(d){var f=e[d],p=mn(f.b);if(p&&u!==p&&!p.parentNode){var v=gv(t,f);u.insertBefore(p,v)}}),c.length>0}function _l(t,e,r,n){r===void 0&&(r=e.__CROACT__),n===void 0&&(n={});var i=!!r;r||(r=new Ol(e));var a=[];return yn(r,r._ps,t?[t]:[],a,n,void 0,void 0),wl(a),fi(null),i||(e.__CROACT__=r),r}function Kb(t,e,r){var n=e.__CROACT__;t&&!n&&(e.innerHTML=""),_l(t,e,n),r&&r()}function Nl(t,e,r){return!r&&t&&(r=new Ol(e.parentElement),r._hyd=[e],r._sel=!0),_l(t,e,r),r}var mv=0;function Wb(t){var e="c".concat(++mv);function r(s){var o=this;if(!o.$_cs[e]){o.$_cs[e]=o;var l=[];o.shouldComponentUpdate=function(c){c.value!==o.props.value&&(o.$_req=!0)},o.render=function(){return o.props.children[0]},o.$_subs=l}return s.children[0]}function n(s,o){return s.children(o)}function i(s){return s._cs[e]}var a={$_id:e,$_dv:t,Consumer:n,Provider:r,get:function(s){var o,l;return(l=(o=i(s))===null||o===void 0?void 0:o.props.value)!==null&&l!==void 0?l:t},register:function(s){var o=i(s);o&&pushSet(o.$_subs,s)},unregister:function(s){var o=i(s);if(o){var l=o.$_subs,c=l.indexOf(s);c>-1&&l.splice(c,1)}}};return n.contextType=a,a}var yv=null;function Yb(t,e){return ge(yv,{element:t,container:e})}function pi(t,e,r){if(t==null)return"";if(isString(t)||isNumber(t)||isFunction(t))return t;var n=t.type,i=t.props;if(isString(n)){var a={};getEntries(i).forEach(function(p){var v=p[0],h=p[1];if(v==="style")a[v]=getEntries(h).map(function(g){var m=g[0],b=g[1];return"".concat(decamelize(m),": ").concat(b,";")}).join("");else{if(v==="children")return;v.match(/^on[^a-z]/g)||(a[v]="".concat(h))}});var s=i.children.map(function(p){return pi(p,e)}).join("");if(r)return{tagName:n,props:a,children:s};var o=Ma([n],getEntries(a).map(function(p){var v=p[0],h=p[1];return"".concat(v,'="').concat(h.replace(/"/g,'\\"'),'"')}),!0);return"<".concat(o.join(" "),">").concat(s,"</").concat(n,">")}else if(isFunction(n)){var l=n.contextType,c={b:null,_hs:[],_usefs:[],_uefs:[],_defs:[],_cs:e};fi(c);var u=l?.get(c),d=kl(n,i,u,{}),f=he(he({},e),d.$_cs);return c.b=d,pi(d.render(),f,r)}return""}function Xb(t){return pi(t,{})}function Hb(t){return pi(t,{},!0)}function _a(t){var e=di(),r=e._hs||(e._hs=[]),n=Tl(),i=r[n];if(ov(n+1),i){if(!li(i.deps,t.deps))return i.updated=!1,i;r[n]=t}else r.push(t);return t.value=t.func(),t.updated=!0,t}function bv(t,e){var r=_a({func:t,deps:e});return r.value}function Ev(t){return bv(function(){return Ml(t)},[])}function Vb(t){var e=di(),r=t.$_id,n=e._cs,i;return r in n?(i=n[r],i.props.value):t.$_dv,Na(function(){return t.register(e),function(){t.unregister(e)}},[]),t.get(e)}function $b(t){var e=di(),r=Tl(),n=e.b;return _a({func:function(){n.state[r]=isFunction(t)?t():t},deps:[]}),[n.state[r],function(i){var a;return n.setState((a={},a[r]=i,a))}]}function Na(t,e,r){var n=di(),i=_a({func:function(){return t},deps:e}),a=r?n._usefs:n._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=t(),i.effect}):a.push(function(){return i.effect})}function Cv(t,e,r){Na(function(){t?.(e())},r,!0)}var jb="simple-1.0.0";function La(t,e){for(var r=t.length,n=0;n<r;++n)if(e(t[n],n))return!0;return!1}function Ll(t,e){for(var r=t.length,n=0;n<r;++n)if(e(t[n],n))return t[n];return null}function Sv(t){var e=t;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function za(t,e){try{return new RegExp(t,"g").exec(e)}catch{return null}}function zl(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!!(e&&e.length)}function xv(t,e){var r=za("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return r?r[3]:""}function Ia(t){return t.replace(/_/g,".")}function bn(t,e){var r=null,n="-1";return La(t,function(i){var a=za("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(r=i,n=a[3]||"-1",i.versionAlias?n=i.versionAlias:i.versionTest&&(n=xv(i.versionTest.toLowerCase(),e)||n),n=Ia(n),!0)}),{preset:r,version:n}}function vi(t,e){var r={brand:"",version:"-1"};return La(t,function(n){var i=Il(e,n);return i?(r.brand=n.id,r.version=n.versionAlias||i.version,r.version!=="-1"):!1}),r}function Il(t,e){return Ll(t,function(r){var n=r.brand;return za(""+e.test,n.toLowerCase())})}var Bl=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],Gl=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],Ba=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],Fl=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],Kl=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"mac os x",id:"mac"},{test:"android",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function Wl(t){var e=navigator.userAgentData,r=(e.uaList||e.brands).slice(),n=e.mobile||!1,i=r[0],a={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!vi(Fl,r).brand},s={name:"unknown",version:"-1",majorVersion:-1};a.webkit=!a.chromium&&La(Ba,function(f){return Il(r,f)});var o=vi(Gl,r);if(a.chromium=!!o.brand,a.chromiumVersion=o.version,!a.chromium){var l=vi(Ba,r);a.webkit=!!l.brand,a.webkitVersion=l.version}if(t){var c=t.platform.toLowerCase(),u=Ll(Kl,function(f){return new RegExp(""+f.test,"g").exec(c)});s.name=u?u.id:c,s.version=t.platformVersion}var d=vi(Bl,r);return d.brand&&(a.name=d.brand,a.version=t?t.uaFullVersion:d.version),navigator.platform==="Linux armv8l"?s.name="android":a.webkit&&(s.name=n?"ios":"mac"),s.name==="ios"&&a.webview&&(a.version="-1"),s.version=Ia(s.version),a.version=Ia(a.version),s.majorVersion=parseInt(s.version,10),a.majorVersion=parseInt(a.version,10),{browser:a,os:s,isMobile:n,isHints:!0}}function Dv(t){var e=Sv(t),r=!!/mobi/g.exec(e),n={name:"unknown",version:"-1",majorVersion:-1,webview:!!bn(Fl,e).preset,chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=bn(Bl,e),s=a.preset,o=a.version,l=bn(Kl,e),c=l.preset,u=l.version,d=bn(Gl,e);if(n.chromium=!!d.preset,n.chromiumVersion=d.version,!n.chromium){var f=bn(Ba,e);n.webkit=!!f.preset,n.webkitVersion=f.version}return c&&(i.name=c.id,i.version=u,i.majorVersion=parseInt(u,10)),s&&(n.name=s.id,n.version=o,n.webview&&i.name==="ios"&&n.name!=="safari"&&(n.webview=!1)),n.majorVersion=parseInt(n.version,10),{browser:n,os:i,isMobile:r,isHints:!1}}function Ub(t){return zl()?navigator.userAgentData.getHighEntropyValues(["architecture","model","platform","platformVersion","uaFullVersion"]).then(function(e){var r=Wl(e);return t&&t(r),r}):(t&&t(Ga()),typeof Promise>"u"||!Promise?null:Promise.resolve(Ga()))}function Ga(t){return typeof t>"u"&&zl()?Wl():Dv(t)}const wv=Ga;function Tv(t,e,r,n,i,a){for(var s=0;s<i;++s){var o=r+s*i,l=n+s*i;t[o]+=t[l]*a,e[o]+=e[l]*a}}function Av(t,e,r,n,i){for(var a=0;a<i;++a){var s=r+a*i,o=n+a*i,l=t[s],c=e[s];t[s]=t[o],t[o]=l,e[s]=e[o],e[o]=c}}function Mv(t,e,r,n,i){for(var a=0;a<n;++a){var s=r+a*n;t[s]/=i,e[s]/=i}}function Yl(t,e,r){r===void 0&&(r=Math.sqrt(t.length));for(var n=t.slice(),i=0;i<r;++i)n[i*r+e-1]=0,n[(e-1)*r+i]=0;return n[(e-1)*(r+1)]=1,n}function Te(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=t.slice(),n=Ot(e),i=0;i<e;++i){var a=e*i+i;if(!ct(r[a],zt)){for(var s=i+1;s<e;++s)if(r[e*i+s]){Av(r,n,i,s,e);break}}if(!ct(r[a],zt))return[];Mv(r,n,i,e,r[a]);for(var s=0;s<e;++s){var o=s,l=s+i*e,c=r[l];!ct(c,zt)||i===s||Tv(r,n,o,i,e,-c)}}return n}function kv(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=[],n=0;n<e;++n)for(var i=0;i<e;++i)r[i*e+n]=t[e*n+i];return r}function Xl(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=[],n=t[e*e-1],i=0;i<e-1;++i)r[i]=t[e*(e-1)+i]/n;return r[e-1]=0,r}function Pv(t,e){for(var r=Ot(e),n=0;n<e-1;++n)r[e*(e-1)+n]=t[n]||0;return r}function lr(t,e){for(var r=t.slice(),n=t.length;n<e-1;++n)r[n]=0;return r[e-1]=1,r}function Ae(t,e,r){if(e===void 0&&(e=Math.sqrt(t.length)),e===r)return t;for(var n=Ot(r),i=Math.min(e,r),a=0;a<i-1;++a){for(var s=0;s<i-1;++s)n[a*r+s]=t[a*e+s];n[(a+1)*r-1]=t[(a+1)*e-1],n[(r-1)*r+a]=t[(e-1)*e+a]}return n[r*r-1]=t[e*e-1],n}function hi(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=Ot(t);return e.forEach(function(i){n=Dt(n,i,t)}),n}function Dt(t,e,r){r===void 0&&(r=Math.sqrt(t.length));var n=[],i=t.length/r,a=e.length/i;if(i){if(!a)return t}else return e;for(var s=0;s<r;++s)for(var o=0;o<a;++o){n[o*r+s]=0;for(var l=0;l<i;++l)n[o*r+s]+=t[l*r+s]*e[o*i+l]}return n}function yt(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]+e[i];return n}function it(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]-e[i];return n}function Ov(t,e){return e===void 0&&(e=t.length===6),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function Hl(t,e){return e===void 0&&(e=t.length===9),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function jt(t,e,r){r===void 0&&(r=e.length);var n=Dt(t,e,r),i=n[r-1];return n.map(function(a){return a/i})}function Rv(t,e){return Dt(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function _v(t,e){return Dt(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function Nv(t,e){return Dt(t,Cn(e,4))}function gi(t,e){var r=e[0],n=r===void 0?1:r,i=e[1],a=i===void 0?1:i,s=e[2],o=s===void 0?1:s;return Dt(t,[n,0,0,0,0,a,0,0,0,0,o,0,0,0,0,1],4)}function En(t,e){return jt(Cn(e,3),lr(t,3))}function Fa(t,e){var r=e[0],n=r===void 0?0:r,i=e[1],a=i===void 0?0:i,s=e[2],o=s===void 0?0:s;return Dt(t,[1,0,0,0,0,1,0,0,0,0,1,0,n,a,o,1],4)}function Ka(t,e){return Dt(t,e,4)}function Cn(t,e){var r=Math.cos(t),n=Math.sin(t),i=Ot(e);return i[0]=r,i[1]=n,i[e]=-n,i[e+1]=r,i}function Ot(t){for(var e=t*t,r=[],n=0;n<e;++n)r[n]=n%(t+1)?0:1;return r}function Wa(t,e){for(var r=Ot(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[(e+1)*i]=t[i];return r}function cr(t,e){for(var r=Ot(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[e*(e-1)+i]=t[i];return r}function Ya(t,e,r,n,i,a,s,o){var l=t[0],c=t[1],u=e[0],d=e[1],f=r[0],p=r[1],v=n[0],h=n[1],g=i[0],m=i[1],b=a[0],E=a[1],C=s[0],x=s[1],S=o[0],w=o[1],D=[l,0,u,0,f,0,v,0,c,0,d,0,p,0,h,0,1,0,1,0,1,0,1,0,0,l,0,u,0,f,0,v,0,c,0,d,0,p,0,h,0,1,0,1,0,1,0,1,-g*l,-m*l,-b*u,-E*u,-C*f,-x*f,-S*v,-w*v,-g*c,-m*c,-b*d,-E*d,-C*p,-x*p,-S*h,-w*h],T=Te(D,8);if(!T.length)return[];var A=Dt(T,[g,m,b,E,C,x,S,w],8);return A[8]=1,Ae(kv(A),3,4)}function Zb(t){return[0,1].map(function(e){return average(t.map(function(r){return r[e]}))})}var Sn=function(){return Sn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Sn.apply(this,arguments)};function Xa(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ur(t,e){return e===void 0&&(e=0),Or(Rr(t,e))}function Qb(t){return ur(getComputedStyle(t).transform)}function mi(t,e){var r=jt(t,[e[0],e[1]||0,e[2]||0,1],4),n=r[3]||1;return[r[0]/n,r[1]/n,r[2]/n]}function Lv(t,e){e===void 0&&(e=document.body);for(var r=t,n=Xa();r;){var i=getComputedStyle(r).transform;if(n=Ka(ur(i),n),r===e)break;r=r.parentElement}return n=Te(n,4),n[12]=0,n[13]=0,n[14]=0,n}function Or(t){var e=Xa();return t.forEach(function(r){var n=r.matrixFunction,i=r.functionValue;n&&(e=n(e,i))}),e}function Rr(t,e){e===void 0&&(e=0);var r=Lt(t)?t:Ve(t);return r.map(function(n){var i=Ca(n),a=i.prefix,s=i.value,o=null,l=a,c="";if(a==="translate"||a==="translateX"||a==="translate3d"){var u=de(e)?Sn(Sn({},e),{"o%":e["%"]}):{"%":e,"o%":e},d=$e(s).map(function(k,_){return _===0&&"x%"in u?u["%"]=e["x%"]:_===1&&"y%"in u?u["%"]=e["y%"]:u["%"]=e["o%"],xt(k,u)}),f=d[0],p=d[1],v=p===void 0?0:p,h=d[2],g=h===void 0?0:h;o=Fa,c=[f,v,g]}else if(a==="translateY"){var m=de(e)?Sn({"%":e["y%"]},e):{"%":e},v=xt(s,m);o=Fa,c=[0,v,0]}else if(a==="translateZ"){var g=parseFloat(s);o=Fa,c=[0,0,g]}else if(a==="scale"||a==="scale3d"){var b=$e(s).map(function(k){return parseFloat(k)}),E=b[0],C=b[1],x=C===void 0?E:C,S=b[2],w=S===void 0?1:S;o=gi,c=[E,x,w]}else if(a==="scaleX"){var E=parseFloat(s);o=gi,c=[E,1,1]}else if(a==="scaleY"){var x=parseFloat(s);o=gi,c=[1,x,1]}else if(a==="scaleZ"){var w=parseFloat(s);o=gi,c=[1,1,w]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var D=sr(s),T=D.unit,A=D.value,M=T==="rad"?A:A*Math.PI/180;a==="rotate"||a==="rotateZ"?(l="rotateZ",o=Nv):a==="rotateX"?o=Rv:a==="rotateY"&&(o=_v),c=M}else if(a==="matrix3d")o=Ka,c=$e(s).map(function(k){return parseFloat(k)});else if(a==="matrix"){var P=$e(s).map(function(k){return parseFloat(k)});o=Ka,c=[P[0],P[1],0,0,P[2],P[3],0,0,0,0,1,0,P[4],P[5],0,1]}else l="";return{name:a,functionName:l,value:s,matrixFunction:o,functionValue:c}})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ha=function(t,e){return Ha=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Ha(t,e)};function zv(t,e){Ha(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Vl=typeof Map=="function"?void 0:function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}}(),Iv=function(t){zv(e,t);function e(r){return r===void 0&&(r=[]),t.call(this,r,Vl)||this}return e}(iv);function _r(t,e){return hn(t,e,Vl)}const $l=Iv;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Va=function(){return Va=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Va.apply(this,arguments)};function Bv(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}var Gv=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(r,n){if(de(r))for(var i in r)this.on(i,r[i]);else this._addEvent(r,n,{});return this},e.off=function(r,n){if(!r)this._events={};else if(de(r))for(var i in r)this.off(i);else if(!n)this._events[r]=[];else{var a=this._events[r];if(a){var s=Fe(a,function(o){return o.listener===n});s>-1&&a.splice(s,1)}}return this},e.once=function(r,n){var i=this;return n&&this._addEvent(r,n,{once:!0}),new Promise(function(a){i._addEvent(r,a,{once:!0})})},e.emit=function(r,n){var i=this;n===void 0&&(n={});var a=this._events[r];if(!r||!a)return!0;var s=!1;return n.eventType=r,n.stop=function(){s=!0},n.currentTarget=this,Bv(a).forEach(function(o){o.listener(n),o.once&&i.off(r,o.listener)}),!s},e.trigger=function(r,n){return n===void 0&&(n={}),this.emit(r,n)},e._addEvent=function(r,n,i){var a=this._events;a[r]=a[r]||[];var s=a[r];s.push(Va({listener:n},i))},t}();const xn=Gv;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var $a=function(t,e){return $a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},$a(t,e)};function Fv(t,e){$a(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Nr=function(){return Nr=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Nr.apply(this,arguments)};function Kv(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function jl(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function yi(t){if(t){if($t(t))return document.querySelector(t)}else return null;if(ai(t))return t();if(t instanceof Element)return t;if("current"in t)return t.current;if("value"in t)return t.value}var Wv=function(t){Fv(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n._startRect=null,n._startPos=[],n._prevTime=0,n._timer=0,n._prevScrollPos=[0,0],n._isWait=!1,n._flag=!1,n._currentOptions=null,n._lock=!1,n._unregister=null,n._onScroll=function(){var i=n._currentOptions;n._lock||!i||n.emit("scrollDrag",{next:function(a){n.checkScroll({container:i.container,inputEvent:a})}})},n}var r=e.prototype;return r.dragStart=function(n,i){var a=yi(i.container);if(!a){this._flag=!1;return}var s=0,o=0,l=0,c=0;if(a===document.body)l=window.innerWidth,c=window.innerHeight;else{var u=a.getBoundingClientRect();s=u.top,o=u.left,l=u.width,c=u.height}this._flag=!0,this._startPos=[n.clientX,n.clientY],this._startRect={top:s,left:o,width:l,height:c},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},r.drag=function(n,i){if(clearTimeout(this._timer),!!this._flag){var a=n.clientX,s=n.clientY,o=i.threshold,l=o===void 0?0:o,c=this,u=c._startRect,d=c._startPos;this._currentOptions=i;var f=[0,0];return u.top>s-l?(d[1]>u.top||s<d[1])&&(f[1]=-1):u.top+u.height<s+l&&(d[1]<u.top+u.height||s>d[1])&&(f[1]=1),u.left>a-l?(d[0]>u.left||a<d[0])&&(f[0]=-1):u.left+u.width<a+l&&(d[0]<u.left+u.width||a>d[0])&&(f[0]=1),!f[0]&&!f[1]?!1:this._continueDrag(Nr(Nr({},i),{direction:f,inputEvent:n,isDrag:!0}))}},r.checkScroll=function(n){var i=this;if(this._isWait)return!1;var a=n.prevScrollPos,s=a===void 0?this._prevScrollPos:a,o=n.direction,l=n.throttleTime,c=l===void 0?0:l,u=n.inputEvent,d=n.isDrag,f=this._getScrollPosition(o||[0,0],n),p=f[0]-s[0],v=f[1]-s[1],h=o||[p?Math.abs(p)/p:0,v?Math.abs(v)/v:0];return this._prevScrollPos=f,this._lock=!1,!p&&!v?!1:(this.emit("move",{offsetX:h[0]?p:0,offsetY:h[1]?v:0,inputEvent:u}),c&&d&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(n)},c)),!0)},r.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},r._getScrollPosition=function(n,i){var a=i.container,s=i.getScrollPosition,o=s===void 0?Kv:s;return o({container:yi(a),direction:n})},r._continueDrag=function(n){var i=this,a,s=n.container,o=n.direction,l=n.throttleTime,c=n.useScroll,u=n.isDrag,d=n.inputEvent;if(!(!this._flag||u&&this._isWait)){var f=vn(),p=Math.max(l+this._prevTime-f,0);if(p>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(n)},p),!1;this._prevTime=f;var v=this._getScrollPosition(o,n);this._prevScrollPos=v,u&&(this._isWait=!0),c||(this._lock=!0);var h={container:yi(s),direction:o,inputEvent:d};return(a=n.requestScroll)===null||a===void 0||a.call(n,h),this.emit("scroll",h),this._isWait=!1,c||this.checkScroll(Nr(Nr({},n),{prevScrollPos:v,direction:o,inputEvent:d}))}},r._registerScrollEvent=function(n){this._unregisterScrollEvent();var i=n.checkScrollEvent;if(i){var a=i===!0?jl:i,s=yi(n.container);i===!0&&(s===document.body||s===document.documentElement)?this._unregister=jl(window,this._onScroll):this._unregister=a(s,this._onScroll)}},r._unregisterScrollEvent=function(){var n;(n=this._unregister)===null||n===void 0||n.call(this),this._unregister=null},e}(xn);const Ul=Wv;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function dr(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function qt(t){return ct(t,zt)}function Yv(t,e){return t.every(function(r,n){return qt(r-e[n])===0})}function Xv(t,e){return!qt(t[0]-e[0])&&!qt(t[1]-e[1])}function Hv(t){return t.reduce(function(e,r){return e.push.apply(e,r),e},[])}function Dn(t){return t.length<3?0:Math.abs(Xp(t.map(function(e,r){var n=t[r+1]||t[0];return e[0]*n[1]-n[0]*e[1]})))/2}function ja(t,e){var r=e.width,n=e.height,i=e.left,a=e.top,s=fr(t),o=s.minX,l=s.minY,c=s.maxX,u=s.maxY,d=r/(c-o),f=n/(u-l);return t.map(function(p){return[i+(p[0]-o)*d,a+(p[1]-l)*f]})}function fr(t){var e=t.map(function(n){return n[0]}),r=t.map(function(n){return n[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,r),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,r)}}function bi(t,e,r){var n=t[0],i=t[1],a=fr(e),s=a.minX,o=a.maxX,l=[[s,i],[o,i]],c=pr(l[0],l[1]),u=Za(e),d=[];if(u.forEach(function(v){var h=pr(v[0],v[1]),g=v[0];if(Yv(c,h))d.push({pos:t,line:v,type:"line"});else{var m=Ua(Ei(c,h),[l,v]);m.forEach(function(b){v.some(function(E){return Xv(E,b)})?d.push({pos:b,line:v,type:"point"}):qt(g[1]-i)!==0&&d.push({pos:b,line:v,type:"intersection"})})}}),!r&&ae(d,function(v){return v[0]===n}))return!0;var f=0,p={};return d.forEach(function(v){var h=v.pos,g=v.type,m=v.line;if(!(h[0]>n))if(g==="intersection")++f;else{if(g==="line")return;if(g==="point"){var b=ae(m,function(x){return x[1]!==i}),E=p[h[0]],C=b[1]>i?1:-1;E?E!==C&&++f:p[h[0]]=C}}}),f%2===1}function Vv(t,e){var r=t[0],n=t[1],i=t[2];return(r*e[0]+n*e[1]+i)/(r*r+n*n)}function pr(t,e){var r=t[0],n=t[1],i=e[0],a=e[1],s=i-r,o=a-n;Math.abs(s)<zt&&(s=0),Math.abs(o)<zt&&(o=0);var l=0,c=0,u=0;return s?o?(l=-o/s,c=1,u=-l*r-n):(c=1,u=-n):o&&(l=-1,u=r),[l,c,u]}function Ei(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2],l=r===0&&a===0,c=n===0&&s===0,u=[];if(l&&c)return[];if(l){var d=-i/n,f=-o/s;return d!==f?[]:[[-1/0,d],[1/0,d]]}else if(c){var p=-i/r,v=-o/a;return p!==v?[]:[[p,-1/0],[p,1/0]]}else if(r===0){var h=-i/n,g=-(s*h+o)/a;u=[[g,h]]}else if(a===0){var h=-o/s,g=-(n*h+i)/r;u=[[g,h]]}else if(n===0){var g=-i/r,h=-(a*g+o)/s;u=[[g,h]]}else if(s===0){var g=-o/a,h=-(r*g+i)/n;u=[[g,h]]}else{var g=(n*o-s*i)/(s*r-n*a),h=-(r*g+i)/n;u=[[g,h]]}return u.map(function(m){return[m[0],m[1]]})}function qb(t,e,r){var n=Ei(pr(t[0],t[1]),pr(e[0],e[1]));return r?Ua(n,[t,e]):n}function $v(t,e){var r=pr(e[0],e[1]);return qt(Vv(r,t))===0}function Ua(t,e){var r=e.map(function(d){return[0,1].map(function(f){return[Math.min(d[0][f],d[1][f]),Math.max(d[0][f],d[1][f])]})}),n=[];if(t.length===2){var i=t[0],a=i[0],s=i[1];if(qt(a-t[1][0])){if(!qt(s-t[1][1])){var c=Math.max.apply(Math,r.map(function(d){return d[0][0]})),u=Math.min.apply(Math,r.map(function(d){return d[0][1]}));if(qt(c-u)>0)return[];n=[[c,s],[u,s]]}}else{var o=Math.max.apply(Math,r.map(function(d){return d[1][0]})),l=Math.min.apply(Math,r.map(function(d){return d[1][1]}));if(qt(o-l)>0)return[];n=[[a,o],[a,l]]}}return n.length||(n=t.filter(function(d){var f=d[0],p=d[1];return r.every(function(v){return 0<=qt(f-v[0][0])&&0<=qt(v[0][1]-f)&&0<=qt(p-v[1][0])&&0<=qt(v[1][1]-p)})})),n.map(function(d){return[qt(d[0]),qt(d[1])]})}function Za(t){return dr(t.slice(1),[t[0]]).map(function(e,r){return[t[r],e]})}function Qa(t,e){var r=t.slice(),n=e.slice();fl(r)===-1&&r.reverse(),fl(n)===-1&&n.reverse();var i=Za(r),a=Za(n),s=i.map(function(u){return pr(u[0],u[1])}),o=a.map(function(u){return pr(u[0],u[1])}),l=[];s.forEach(function(u,d){var f=i[d],p=[];o.forEach(function(v,h){var g=Ei(u,v),m=Ua(g,[f,a[h]]);p.push.apply(p,m.map(function(b){return{index1:d,index2:h,pos:b,type:"intersection"}}))}),p.sort(function(v,h){return Ne(f[0],v.pos)-Ne(f[0],h.pos)}),l.push.apply(l,p),bi(f[1],n)&&l.push({index1:d,index2:-1,pos:f[1],type:"inside"})}),a.forEach(function(u,d){if(bi(u[1],r)){var f=!1,p=Fe(l,function(v){var h=v.index2;return h===d?(f=!0,!1):!!f});p===-1&&(f=!1,p=Fe(l,function(v){var h=v.index1,g=v.index2;return h===-1&&g+1===d?(f=!0,!1):!!f})),p===-1?l.push({index1:-1,index2:d,pos:u[1],type:"inside"}):l.splice(p,0,{index1:-1,index2:d,pos:u[1],type:"inside"})}});var c={};return l.filter(function(u){var d=u.pos,f=d[0]+"x"+d[1];return c[f]?!1:(c[f]=!0,!0)})}function qa(t,e){var r=Qa(t,e);return r.map(function(n){var i=n.pos;return i})}function jv(t){var e=t[0],r=e.index1,n=e.index2,i=t[1],a=i.index1,s=i.index2;return r!==-1&&(r===a||r+1===a)||n!==-1&&(n===s||n+1===s)}function Uv(t,e){var r=Qa(t,e),n=[],i;return Qa(t,e).forEach(function(a,s,o){s===0||!jv([o[s-1],a])?(i=[a],n.push(i)):i.push(a)}),n.map(function(a){return a.map(function(s){var o=s.pos;return o})})}function Ci(t,e,r,n){r===void 0&&(r=0),n===void 0&&(n=[]);for(var i=n.length===0,a=t.length,s=t[r]?r:0,o=dr(t.slice(s),t.slice(0,s)),l=function(d){var f=o[d];if(find(e,function(m){return m[0]===f[0]&&m[1]===f[1]}))return"continue";if(n.some(function(m){return find(m,function(b){return b[0]===f[0]&&b[1]===f[1]})}))return i?"continue":"break";var p=void 0;i?(p=[],n.push(p)):p=n[n.length-1],p.push(f);var v=[f,t[r+1]||t[0]],h=e.filter(function(m){return $v(m,v)}).sort(function(m,b){return getDist(f,m)-getDist(f,b)})[0];if(h){var g=e.indexOf(h);if(Ci(e,t,g,n),!i)return"break"}else return Ci(o,e,d+1,n),"break"},c=0;c<a;++c){var u=l(c);if(u==="break")break}return n}function Jb(t,e){return Ci(t,dr(e).reverse())}function tE(t,e){if(!e.length)return[dr(t)];var r=Uv(t,e),n=[t];return r.forEach(function(i){var a=dr(i).reverse();n=Hv(n.map(function(s){var o=Ci(s,a),l=o[0];if(o.length===1&&a.every(function(f){return l.indexOf(f)===-1})){var c=l[l.length-1],u=dr(a).sort(function(f,p){return getDist(c,f)-getDist(c,p)})[0],d=a.indexOf(u);l.push.apply(l,dr(a.slice(d),a.slice(0,d),[a[d],c]))}return o}))}),n}function Zv(t,e){var r=qa(t,e);return Dn(r)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ja=function(t,e){return Ja=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Ja(t,e)};function Qv(t,e){Ja(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Kt=function(){return Kt=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Kt.apply(this,arguments)};function qv(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return i>=0?i:i+Math.PI*2}function to(t){return qv([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function Jv(t){return t.touches&&t.touches.length>=2}function Si(t){return t?t.touches?eh(t.touches):[Ql(t)]:[]}function th(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}function Zl(t,e,r){var n=r.length,i=wn(t,n),a=i.clientX,s=i.clientY,o=i.originalClientX,l=i.originalClientY,c=wn(e,n),u=c.clientX,d=c.clientY,f=wn(r,n),p=f.clientX,v=f.clientY,h=a-u,g=s-d,m=a-p,b=s-v;return{clientX:o,clientY:l,deltaX:h,deltaY:g,distX:m,distY:b}}function eo(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function eh(t){for(var e=Math.min(t.length,2),r=[],n=0;n<e;++n)r.push(Ql(t[n]));return r}function Ql(t){return{clientX:t.clientX,clientY:t.clientY}}function wn(t,e){e===void 0&&(e=t.length);for(var r={clientX:0,clientY:0,originalClientX:0,originalClientY:0},n=Math.min(t.length,e),i=0;i<n;++i){var a=t[i];r.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,r.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,r.clientX+=a.clientX,r.clientY+=a.clientY}return e?{clientX:r.clientX/e,clientY:r.clientY/e,originalClientX:r.originalClientX/e,originalClientY:r.originalClientY/e}:r}var ro=function(){function t(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return t.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),to(e)},t.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),to(e)-to(this.startClients)},t.prototype.getPosition=function(e,r){e===void 0&&(e=this.prevClients);var n=Zl(e||this.prevClients,this.prevClients,this.startClients),i=n.deltaX,a=n.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,n},t.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var r=this.prevClients,n=this.startClients,i=Math.min(this.length,r.length),a=[],s=0;s<i;++s)a[s]=Zl([e[s]],[r[s]],[n[s]]);return a},t.prototype.getMovement=function(e){var r=this.movement;if(!e)return r;var n=wn(e,this.length),i=wn(this.prevClients,this.length),a=n.clientX-i.clientX,s=n.clientY-i.clientY;return Math.sqrt(a*a+s*s)+r},t.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),eo(e)},t.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),eo(e)/eo(this.startClients)},t.prototype.move=function(e,r){this.startClients.forEach(function(n){n.clientX-=e,n.clientY-=r}),this.prevClients.forEach(function(n){n.clientX-=e,n.clientY-=r})},t}(),ql=["textarea","input"],Jl=function(t){Qv(e,t);function e(r,n){n===void 0&&(n={});var i=t.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(f,p){if(p===void 0&&(p=!0),!(!i.flag&&f.cancelable===!1)){var v=f.type.indexOf("drag")>=-1;if(!(i.flag&&v)){i._isDragAPI=!0;var h=i.options,g=h.container,m=h.pinchOutside,b=h.preventWheelClick,E=h.preventRightClick,C=h.preventDefault,x=h.checkInput,S=h.dragFocusedInput,w=h.preventClickEventOnDragStart,D=h.preventClickEventOnDrag,T=h.preventClickEventByCondition,A=i._useTouch,M=!i.flag;if(i._isSecondaryButton=f.which===3||f.button===2,b&&(f.which===2||f.button===1)||E&&(f.which===3||f.button===2))return i.stop(),!1;if(M){var P=i._window.document.activeElement,k=f.target;if(k){var _=k.tagName.toLowerCase(),N=ql.indexOf(_)>-1,I=k.isContentEditable;if(N||I){if(x||!S&&P===k)return!1;if(P&&(P===k||I&&P.isContentEditable&&P.contains(k)))if(S)k.blur();else return!1}else if((C||f.type==="touchstart")&&P){var B=P.tagName.toLowerCase();(P.isContentEditable||ql.indexOf(B)>-1)&&P.blur()}(w||D||T)&&Ht(i._window,"click",i._onClick,!0)}i.clientStores=[new ro(Si(f))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=p,i._dragFlag=!0,i._prevInputEvent=f,i.data={},i.doubleFlag=vn()-i.prevTime<200,i._isMouseEvent=th(f),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var L=i._preventMouseEvent||i.emit("dragStart",Kt(Kt({data:i.data,datas:i.data,inputEvent:f,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:p,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){f.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));L===!1&&i.stop(),i._isMouseEvent&&i.flag&&C&&f.preventDefault()}if(!i.flag)return!1;var G=0;if(M?(i._attchDragEvent(),A&&m&&(G=setTimeout(function(){Ht(g,"touchstart",i.onDragStart,{passive:!1})}))):A&&m&&Ft(g,"touchstart",i.onDragStart),i.flag&&Jv(f)){if(clearTimeout(G),M&&f.touches.length!==f.changedTouches.length)return;i.pinchFlag||i.onPinchStart(f)}}}},i.onDrag=function(f,p){if(i.flag){var v=i.options.preventDefault;!i._isMouseEvent&&v&&f.preventDefault(),i._prevInputEvent=f;var h=Si(f),g=i.moveClients(h,f,!1);if(i._dragFlag){if(i.pinchFlag||g.deltaX||g.deltaY){var m=i._preventMouseEvent||i.emit("drag",Kt(Kt({},g),{isScroll:!!p,inputEvent:f}));if(m===!1){i.stop();return}}i.pinchFlag&&i.onPinch(f,h)}i.getCurrentStore().getPosition(h,!0)}},i.onDragEnd=function(f){if(i.flag){var p=i.options,v=p.pinchOutside,h=p.container,g=p.preventClickEventOnDrag,m=p.preventClickEventOnDragStart,b=p.preventClickEventByCondition,E=i.isDrag;(g||m||b)&&requestAnimationFrame(function(){i._allowClickEvent()}),!b&&!m&&g&&!E&&i._allowClickEvent(),i._useTouch&&v&&Ft(h,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(f);var C=f?.touches?Si(f):[],x=C.length;x===0||!i.options.keepDragging?i.flag=!1:i._addStore(new ro(C));var S=i._getPosition(),w=vn(),D=!E&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=E||D?0:w,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",Kt({data:i.data,datas:i.data,isDouble:D,isDrag:E,isClick:!E,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:f,isTrusted:i._isTrusted},S)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){Ft(i._window,"click",i._onClick,!0)},i._onClick=function(f){i._allowClickEvent(),i._allowMouseEvent();var p=i.options.preventClickEventByCondition;p?.(f)||(f.stopPropagation(),f.preventDefault())},i._onContextMenu=function(f){var p=i.options;p.preventRightClick?i.onDragEnd(f):f.preventDefault()},i._passCallback=function(){};var a=[].concat(r),s=a[0];i._window=yl(s)?s:fe(s),i.options=Kt({checkInput:!1,container:s&&!("document"in s)?fe(s):s,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var o=i.options,l=o.container,c=o.events,u=o.checkWindowBlur;if(i._useDrag=c.indexOf("drag")>-1,i._useTouch=c.indexOf("touch")>-1,i._useMouse=c.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(f){Ht(f,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(f){Ht(f,"mousedown",i.onDragStart),Ht(f,"mousemove",i._passCallback)}),Ht(l,"contextmenu",i._onContextMenu)),u&&Ht(fe(),"blur",i.onBlur),i._useTouch){var d={passive:!1};a.forEach(function(f){Ht(f,"touchstart",i.onDragStart,d),Ht(f,"touchmove",i._passCallback,d)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(r){return this.getCurrentStore().getMovement(r)+this.clientStores.slice(1).reduce(function(n,i){return n+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(r,n,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(r,n),a&&this.onDrag(i,!0))},e.prototype.move=function(r,n){var i=r[0],a=r[1],s=this.getCurrentStore(),o=s.prevClients;return this.moveClients(o.map(function(l){var c=l.clientX,u=l.clientY;return{clientX:c+i,clientY:u+a,originalClientX:c,originalClientY:u}}),n,!0)},e.prototype.triggerDragStart=function(r){this.onDragStart(r,!1)},e.prototype.setEventData=function(r){var n=this.data;for(var i in r)n[i]=r[i];return this},e.prototype.setEventDatas=function(r){return this.setEventData(r)},e.prototype.getCurrentEvent=function(r){return r===void 0&&(r=this._prevInputEvent),Kt(Kt({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:r})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var r=this,n=this.targets,i=this.options.container;this.off(),Ft(this._window,"blur",this.onBlur),this._useDrag&&n.forEach(function(a){Ft(a,"dragstart",r.onDragStart)}),this._useMouse&&(n.forEach(function(a){Ft(a,"mousedown",r.onDragStart)}),Ft(i,"contextmenu",this._onContextMenu)),this._useTouch&&(n.forEach(function(a){Ft(a,"touchstart",r.onDragStart)}),Ft(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(r){var n=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new ro(Si(r));this.pinchFlag=!0,this._addStore(a);var s=this.emit("pinchStart",Kt(Kt({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:r,isTrusted:this._isTrusted,preventDefault:function(){r.preventDefault()},preventDrag:function(){n._dragFlag=!1}}));s===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(r,n){if(!(!this.flag||!this.pinchFlag||n.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Kt(Kt({data:this.data,datas:this.data,movement:this.getMovement(n),angle:i.getAngle(n),rotation:i.getRotation(n),touches:i.getPositions(n),scale:i.getScale(n),distance:i.getDistance(n)},i.getPosition(n)),{inputEvent:r,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(r){if(this.pinchFlag){var n=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",Kt(Kt({data:this.data,datas:this.data,isPinch:n,touches:i.getPositions()},i.getPosition()),{inputEvent:r}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(r,n,i){var a=this._getPosition(r,i),s=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var o=!1;return!s&&this.isDrag&&(o=!0),Kt(Kt({data:this.data,datas:this.data},a),{movement:this.getMovement(r),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:n,isTrusted:this._isTrusted,isFirstDrag:o})},e.prototype._addStore=function(r){this.clientStores.splice(0,0,r)},e.prototype._getPosition=function(r,n){var i=this.getCurrentStore(),a=i.getPosition(r,n),s=this.clientStores.slice(1).reduce(function(c,u){var d=u.getPosition();return c.distX+=d.distX,c.distY+=d.distY,c},a),o=s.distX,l=s.distY;return Kt(Kt({},a),{distX:o,distY:l})},e.prototype._attchDragEvent=function(){var r=this._window,n=this.options.container,i={passive:!1};this._isDragAPI&&(Ht(n,"dragover",this.onDrag,i),Ht(r,"dragend",this.onDragEnd)),this._useMouse&&(Ht(n,"mousemove",this.onDrag),Ht(r,"mouseup",this.onDragEnd)),this._useTouch&&(Ht(n,"touchmove",this.onDrag,i),Ht(r,"touchend",this.onDragEnd,i),Ht(r,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var r=this._window,n=this.options.container;this._isDragAPI&&(Ft(n,"dragover",this.onDrag),Ft(r,"dragend",this.onDragEnd)),this._useMouse&&(Ft(n,"mousemove",this.onDrag),Ft(r,"mouseup",this.onDragEnd)),this._useTouch&&(Ft(n,"touchstart",this.onDragStart),Ft(n,"touchmove",this.onDrag),Ft(r,"touchend",this.onDragEnd),Ft(r,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e}(xn);function rh(t){for(var e=5381,r=t.length;r;)e=e*33^t.charCodeAt(--r);return e>>>0}var nh=rh;function ih(t){return nh(t).toString(36)}function ah(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function oh(t,e,r){return r.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(n,i){var a=i.trim();return(a?$e(a):[""]).map(function(s){var o=s.trim();return o.indexOf("@")===0?o:o.indexOf(":global")>-1?o.replace(/\:global/g,""):o.indexOf(":host")>-1?"".concat(o.replace(/\:host/g,".".concat(t))):o?".".concat(t," ").concat(o):".".concat(t)}).join(", ")+" {"})}function sh(t,e,r,n,i){var a=oe(n),s=a.createElement("style");return s.setAttribute("type","text/css"),s.setAttribute("data-styled-id",t),s.setAttribute("data-styled-count","1"),r.nonce&&s.setAttribute("nonce",r.nonce),s.innerHTML=oh(t,e,r),(i||a.head||a.body).appendChild(s),s}function lh(t){var e="rCS"+ih(t);return{className:e,inject:function(r,n){n===void 0&&(n={});var i=ah(r),a=(i||r.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=sh(e,t,n,r,i);else{var s=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(s+1))}return{destroy:function(){var o,l=parseFloat(a.getAttribute("data-styled-count"))||0;l<=1?(a.remove?a.remove():(o=a.parentNode)===null||o===void 0||o.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(l-1))}}}}}const tc=lh;var no=function(t,e){return no=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},no(t,e)};function ch(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");no(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var io=function(){return io=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},io.apply(this,arguments)};function uh(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}var dh=null;function eE(t,e){var r=cssStyled(e);return function(n){ch(i,n);function i(){var a=n!==null&&n.apply(this,arguments)||this;return a.injector=r,a.tag=t,a}return i}(dh)}function ec(t,e){var r=tc(e),n=r.className;return sv(function(i,a){var s=i.className,o=s===void 0?"":s,l=i.cspNonce,c=uh(i,["className","cspNonce"]),u=Ev();return Cv(a,function(){return u.current},[]),Na(function(){var d=r.inject(u.current,{nonce:i.cspNonce});return function(){d.destroy()}},[]),ge(t,io({ref:u,"data-styled-id":n,className:"".concat(o," ").concat(n)},c))})}const rE=null;var ao=function(t,e){return ao=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},ao(t,e)};function Lr(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ao(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var O=function(){return O=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},O.apply(this,arguments)};function fh(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function ph(t,e,r,n){var i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(a=(i<3?s(a):i>3?s(e,r,a):s(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}function vh(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function R(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,a=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(o){s={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return a}function $(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))}function Tn(t,e){return O({events:[],props:[],name:t},e)}var hh=["n","w","s","e"],oo=["n","w","s","e","nw","ne","sw","se"];function gh(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function mh(t){var e=gh(1,t),r=Math.round(t/45)*45%180,n="ns-resize";return r===135?n="nwse-resize":r===45?n="nesw-resize":r===90&&(n="ew-resize"),"cursor:".concat(n,";cursor: url('").concat(e,"') 16 16, ").concat(n,";")}var zr=wv(),rc=zr.browser.webkit,nc=rc&&function(){var t=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1}(),ic=zr.browser.name,ac=parseInt(zr.browser.version,10),yh=ic==="chrome",bh=zr.browser.chromium,Eh=parseInt(zr.browser.chromiumVersion,10)||0,Ch=yh&&ac>=109||bh&&Eh>=109,Sh=ic==="firefox",xh=parseInt(zr.browser.webkitVersion,10)>=612||ac>=15,so="moveable-",Dh=oo.map(function(t){var e="",r="",n="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",i="top"),t.indexOf("w")>-1&&(r="left: ".concat(a,";"),n="right"),t.indexOf("e")>-1&&(r="left: 0px;",n="left"),'.around-control[data-direction*="'.concat(t,`"] {
        `).concat(r).concat(e,`
        transform-origin: `).concat(n," ").concat(i,`;
    }`)}).join(`
`),wh=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(Dh,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return`
.direction[data-rotation="`.concat(t,'"], :global .view-control-rotation').concat(t,` {
`).concat(mh(t),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(nc?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),Th=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],lo=1e-4,Jt=1e-7,xi=1e-9,co=Math.pow(10,10),oc=-co,Ah={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},uo={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},sc={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},lc=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function An(t,e,r,n,i,a){var s,o;a===void 0&&(a="draggable");var l=(o=(s=e.gestos[a])===null||s===void 0?void 0:s.move(r,t.inputEvent))!==null&&o!==void 0?o:{},c=l.originalDatas||l.datas,u=c[a]||(c[a]={});return O(O({},i?vu(e,l):l),{isPinch:!!n,parentEvent:!0,datas:u,originalDatas:t.originalDatas})}var Ir=function(){function t(e){var r;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(r={},r[e]={},r)}return t.prototype.dragStart=function(e,r){this.isDrag=!1,this.isFlag=!1;var n=r.originalDatas;return this.datas=n,n[this.ableName]||(n[this.ableName]={}),O(O({},this.move(e,r.inputEvent)),{type:"dragstart"})},t.prototype.drag=function(e,r){return this.move([e[0]-this.prevX,e[1]-this.prevY],r)},t.prototype.move=function(e,r){var n,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],n=e[0],i=e[1],this.isFlag=!0;else{var s=this.isDrag;n=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!s&&this.isDrag&&(a=!0)}return this.prevX=n,this.prevY=i,{type:"drag",clientX:n,clientY:i,inputEvent:r,isFirstDrag:a,isDrag:this.isDrag,distX:n-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t}();function Br(t,e,r,n){var i=t.length===16,a=i?4:3,s=mr(t,r,n,a),o=R(s,4),l=R(o[0],2),c=l[0],u=l[1],d=R(o[1],2),f=d[0],p=d[1],v=R(o[2],2),h=v[0],g=v[1],m=R(o[3],2),b=m[0],E=m[1],C=R(Nt(t,e,a),2),x=C[0],S=C[1],w=Math.min(c,f,h,b),D=Math.min(u,p,g,E),T=Math.max(c,f,h,b),A=Math.max(u,p,g,E);c=c-w||0,f=f-w||0,h=h-w||0,b=b-w||0,u=u-D||0,p=p-D||0,g=g-D||0,E=E-D||0,x=x-w||0,S=S-D||0;var M=t[0],P=t[a+1],k=re(M*P);return{left:w,top:D,right:T,bottom:A,origin:[x,S],pos1:[c,u],pos2:[f,p],pos3:[h,g],pos4:[b,E],direction:k}}function cc(t,e){var r=e.clientX,n=e.clientY,i=e.datas,a=t.state,s=a.moveableClientRect,o=a.rootMatrix,l=a.is3d,c=a.pos1,u=s.left,d=s.top,f=l?4:3,p=R(it(Vr(o,[r-u,n-d],f),c),2),v=p[0],h=p[1],g=R(Le({datas:i,distX:v,distY:h}),2),m=g[0],b=g[1];return[m,b]}function vr(t,e){var r=e.datas,n=t.state,i=n.allMatrix,a=n.beforeMatrix,s=n.is3d,o=n.left,l=n.top,c=n.origin,u=n.offsetMatrix,d=n.targetMatrix,f=n.transformOrigin,p=s?4:3;r.is3d=s,r.matrix=i,r.targetMatrix=d,r.beforeMatrix=a,r.offsetMatrix=u,r.transformOrigin=f,r.inverseMatrix=Te(i,p),r.inverseBeforeMatrix=Te(a,p),r.absoluteOrigin=lr(yt([o,l],c),p),r.startDragBeforeDist=jt(r.inverseBeforeMatrix,r.absoluteOrigin,p),r.startDragDist=jt(r.inverseMatrix,r.absoluteOrigin,p)}function Mh(t){return Br(t.datas.beforeTransform,[50,50],100,100).direction}function Di(t,e,r){var n=e.datas,i=e.originalDatas.beforeRenderable,a=n.transformIndex,s=i.nextTransforms,o=s.length,l=i.nextTransformAppendedIndexes,c=-1;a===-1?(r==="translate"?c=0:r==="rotate"&&(c=Fe(s,function(p){return p.match(/scale\(/g)})),c===-1&&(c=s.length),n.transformIndex=c):ae(l,function(p){return p.index===a&&p.functionName===r})?c=a:c=a+l.filter(function(p){return p.index<a}).length;var u=Jg(s,t.state,c),d=u.targetFunction,f=r==="rotate"?"rotateZ":r;n.beforeFunctionTexts=u.beforeFunctionTexts,n.afterFunctionTexts=u.afterFunctionTexts,n.beforeTransform=u.beforeFunctionMatrix,n.beforeTransform2=u.beforeFunctionMatrix2,n.targetTansform=u.targetFunctionMatrix,n.afterTransform=u.afterFunctionMatrix,n.afterTransform2=u.afterFunctionMatrix2,n.targetAllTransform=u.allFunctionMatrix,d.functionName===f?(n.afterFunctionTexts.splice(0,1),n.isAppendTransform=!1):o>c&&(n.isAppendTransform=!0,i.nextTransformAppendedIndexes=$($([],R(l),!1),[{functionName:r,index:c,isAppend:!0}],!1))}function wi(t,e,r){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?r:e," ").concat(t.afterFunctionTexts.join(" "))}function kh(t){var e=t.datas,r=t.distX,n=t.distY,i=R(dc({datas:e,distX:r,distY:n}),2),a=i[0],s=i[1],o=uc(e,Pv([a,s],4));return jt(o,lr([0,0,0],4),4)}function uc(t,e,r){var n=t.beforeTransform,i=t.afterTransform,a=t.beforeTransform2,s=t.afterTransform2,o=t.targetAllTransform,l=r?Dt(o,e,4):Dt(e,o,4),c=Dt(Te(r?a:n,4),l,4),u=Dt(c,Te(r?s:i,4),4);return u}function dc(t){var e=t.datas,r=t.distX,n=t.distY,i=e.inverseBeforeMatrix,a=e.is3d,s=e.startDragBeforeDist,o=e.absoluteOrigin,l=a?4:3;return it(jt(i,yt(o,[r,n]),l),s)}function Le(t,e){var r=t.datas,n=t.distX,i=t.distY,a=r.inverseBeforeMatrix,s=r.inverseMatrix,o=r.is3d,l=r.startDragBeforeDist,c=r.startDragDist,u=r.absoluteOrigin,d=o?4:3;return it(jt(e?a:s,yt(u,[n,i]),d),e?l:c)}function Ph(t,e){var r=t.datas,n=t.distX,i=t.distY,a=r.beforeMatrix,s=r.matrix,o=r.is3d,l=r.startDragBeforeDist,c=r.startDragDist,u=r.absoluteOrigin,d=o?4:3;return it(jt(e?a:s,yt(e?l:c,[n,i]),d),u)}function Oh(t,e,r,n,i,a){return n===void 0&&(n=e),i===void 0&&(i=r),a===void 0&&(a=[0,0]),t?t.map(function(s,o){var l=sr(s),c=l.value,u=l.unit,d=o?i:n,f=o?r:e;if(s==="%"||isNaN(c)){var p=d?a[o]/d:0;return f*p}else if(u!=="%")return c;return f*c/100}):a}function fc(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function Rh(t,e){return fc(e).map(function(r){return t[r]})}function fo(t,e){var r=(e+1)/2;return[ni(t[0][0],t[1][0],r,1-r),ni(t[0][1],t[1][1],r,1-r)]}function Xt(t,e){var r=fo([t[0],t[1]],e[0]),n=fo([t[2],t[3]],e[0]);return fo([r,n],e[1])}function _h(t,e,r,n,i,a){var s=mr(e,r,n,i),o=Xt(s,a),l=t[0]-o[0],c=t[1]-o[1];return[l,c]}function Mn(t,e,r,n){return Dt(t,Rn(e,n,r),n)}function Nh(t,e,r,n){var i=t.transformOrigin,a=t.offsetMatrix,s=t.is3d,o=s?4:3,l;if($t(r)){var c=e.beforeTransform,u=e.afterTransform;n?l=Ae(ur(r),4,o):l=Ae(Dt(Dt(c,ur([r]),4),u,4),4,o)}else l=r;return Mn(a,l,i,o)}function Lh(t,e){var r=t.transformOrigin,n=t.offsetMatrix,i=t.is3d,a=t.targetMatrix,s=t.targetAllTransform,o=i?4:3;return Mn(n,Dt(s||a,Wa(e,o),o),r,o)}function Ti(t,e){var r=Gr(e);return{setTransform:function(n,i){i===void 0&&(i=-1),r.startTransforms=Lt(n)?n:Ve(n),po(t,e,i)},setTransformIndex:function(n){po(t,e,n)}}}function Ai(t,e,r){var n=Gr(e),i=n.startTransforms;po(t,e,Fe(i,function(a){return a.indexOf("".concat(r,"("))===0}))}function po(t,e,r){var n=Gr(e),i=e.datas;if(i.transformIndex=r,r!==-1){var a=n.startTransforms[r];if(a){var s=t.state,o=Rr([a],{"x%":function(l){return l/100*s.offsetWidth},"y%":function(l){return l/100*s.offsetHeight}});i.startValue=o[0].functionValue}}}function vo(t,e){var r=Gr(t);r.nextTransforms=Ve(e)}function Gr(t){return t.originalDatas.beforeRenderable}function Mi(t){var e=t.originalDatas.beforeRenderable;return e.nextTransforms}function ki(t){return(Mi(t)||[]).join(" ")}function Pi(t){return Gr(t).nextStyle}function pc(t,e,r,n,i){vo(i,e);var a=te.drag(t,An(i,t.state,r,n,!1)),s=a?a.transform:e;return O(O({transform:e,drag:a},ee({transform:s},i)),{afterTransform:s})}function ho(t,e,r,n,i,a){var s=Nh(t.state,i,e,a),o=Bh(t,r,n,s);return o}function vc(t,e,r,n,i,a,s){var o=ho(t,e,r,i,a,s),l=t.state,c=l.left,u=l.top,d=t.props.groupable,f=d?c:0,p=d?u:0,v=it(n,o);return it(v,[f,p])}function zh(t,e,r,n,i,a,s){var o=vc(t,e,r,n,i,a,s);return o}function Ih(t,e,r){return[e?-1+t[0]/(e/2):0,r?-1+t[1]/(r/2):0]}function Bh(t,e,r,n){n===void 0&&(n=t.state.allMatrix);var i=t.state,a=i.width,s=i.height,o=i.is3d,l=o?4:3,c=[a/2*(1+e[0])+r[0],s/2*(1+e[1])+r[1]];return Nt(n,c,l)}function Gh(t,e,r){var n=r.fixedDirection,i=r.fixedPosition,a=r.fixedOffset;return vc(t,"rotate(".concat(e,"deg)"),n,i,a,r)}function Fh(t,e,r,n,i,a){var s=t.props.groupable,o=t.state,l=o.transformOrigin,c=o.offsetMatrix,u=o.is3d,d=o.width,f=o.height,p=o.left,v=o.top,h=a.fixedDirection,g=a.nextTargetMatrix||o.targetMatrix,m=u?4:3,b=Oh(i,e,r,d,f,l),E=s?p:0,C=s?v:0,x=Mn(c,g,b,m),S=_h(n,x,e,r,m,h);return it(S,[E,C])}function Kh(t,e){return Xt(be(t.state),e)}function Wh(t,e){var r=t.targetGesto,n=t.controlGesto,i;return r?.isFlag()&&(i=r.getEventData()[e]),!i&&n?.isFlag()&&(i=n.getEventData()[e]),i||{}}function Yh(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function Xh(t){var e=t("scale"),r=t("rotate"),n=t("translate"),i=[];return n&&n!=="0px"&&n!=="none"&&i.push("translate(".concat(n.split(/\s+/).join(","),")")),r&&r!=="1"&&r!=="none"&&i.push("rotate(".concat(r,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function hc(t,e,r){for(var n=t,i=[],a=Ta(t)||je(t),s=!r&&t===e||t===a,o=s,l=!1,c=3,u,d,f,p=!1,v=_n(e,e,!0).offsetParent,h=1;n&&!o;){o=s;var g=se(n),m=g("position"),b=eu(n),E=m==="fixed",C=Xh(g),x=Ov(Kg(b)),S=void 0,w=!1,D=!1,T=0,A=0,M=0,P=0,k={hasTransform:!1,fixedContainer:null};E&&(p=!0,k=Vg(n),v=k.fixedContainer);var _=x.length;!l&&(_===16||C.length)&&(l=!0,c=4,Ro(i),f&&(f=Ae(f,3,4))),l&&_===9&&(x=Ae(x,3,4));var N=Hg(n,t),I=N.tagName,B=N.hasOffset,L=N.isSVG,G=N.origin,W=N.targetOrigin,z=N.offset,X=R(z,2),j=X[0],Y=X[1];I==="svg"&&!n.ownerSVGElement&&f&&(i.push({type:"target",target:n,matrix:$g(n,c)}),i.push({type:"offset",target:n,matrix:Ot(c)}));var Z=parseFloat(g("zoom"))||1;if(E)S=k.fixedContainer,w=!0;else{var U=_n(n,e,!1,!0,g),q=U.offsetZoom;if(S=U.offsetParent,w=U.isEnd,D=U.isStatic,h*=q,(U.isCustomElement||q!==1)&&D)j-=S.offsetLeft,Y-=S.offsetTop;else if(Sh||Ch){var et=U.parentSlotElement;if(et){for(var at=S,ot=0,V=0;at&&Yh(at);)ot+=at.offsetLeft,V+=at.offsetTop,at=at.offsetParent;j-=ot,Y-=V}}}if(rc&&!xh&&B&&!L&&D&&(m==="relative"||m==="static")&&(j-=S.offsetLeft,Y-=S.offsetTop,s=s||w),E)B&&k.hasTransform&&(M=S.clientLeft,P=S.clientTop);else if(B&&v!==S&&(T=S.clientLeft,A=S.clientTop),B&&S===a){var tt=ru(n,!1);j+=tt[0],Y+=tt[1]}if(i.push({type:"target",target:n,matrix:Rn(x,c,G)}),C.length&&(i.push({type:"offset",target:n,matrix:Ot(c)}),i.push({type:"target",target:n,matrix:Rn(ur(C),c,G)})),B){var gt=n===t,st=gt?0:n.scrollLeft,lt=gt?0:n.scrollTop;i.push({type:"offset",target:n,matrix:cr([j-st+T-M,Y-lt+A-P],c)})}else i.push({type:"offset",target:n,origin:G});if(Z!==1&&i.push({type:"zoom",target:n,matrix:Rn(Wa([Z,Z],c),c,[0,0])}),f||(f=x),u||(u=G),d||(d=W),o||E)break;n=S,s=w,(!r||n===a)&&(o=s)}return f||(f=Ot(c)),u||(u=[0,0]),d||(d=[0,0]),{zoom:h,offsetContainer:v,matrixes:i,targetMatrix:f,transformOrigin:u,targetOrigin:d,is3d:l,hasFixed:p}}var hr=null,gr=null,Fr=null;function Kr(t){t?(window.Map&&(hr=new Map,gr=new Map),Fr=[]):(hr=null,Fr=null,gr=null)}function Hh(t){var e=gr?.get(t);if(e)return e;var r=Ln(t,!0);return gr&&gr.set(t,r),r}function Vh(t,e){if(Fr){var r=ae(Fr,function(i){return i[0][0]==t&&i[0][1]==e});if(r)return r[1]}var n=hc(t,e,!0);return Fr&&Fr.push([[t,e],n]),n}function se(t){var e=hr?.get(t);if(!e){var r=fe(t).getComputedStyle(t);if(!hr)return function(a){return r[a]};e={style:r,cached:{}},hr.set(t,e)}var n=e.cached,i=e.style;return function(a){return a in n||(n[a]=i[a]),n[a]}}function Me(t,e,r){var n=r.originalDatas;n.groupable=n.groupable||{};var i=n.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return t.moveables.map(function(s,o){return a[o]=a[o]||{},a[o][e]=a[o][e]||{},O(O({},r),{isRequestChild:!0,datas:a[o][e],originalDatas:a[o]})})}function go(t,e,r,n,i,a,s){var o=!!r.match(/Start$/g),l=!!r.match(/End$/g),c=i.isPinch,u=i.datas,d=Me(t,e.name,i),f=t.moveables,p=[],v=d.map(function(h,g){var m=f[g],b=m.state,E=b.gestos,C=h;if(o)C=new Ir(s).dragStart(n,h),p.push(C);else{if(E[s]||(E[s]=u.childGestos[g]),!E[s])return;C=An(h,b,n,c,a,s),p.push(C)}var x=e[r](m,O(O({},C),{parentFlag:!0}));return l&&(E[s]=null),x});return o&&(u.childGestos=f.map(function(h){return h.state.gestos[s]})),{eventParams:v,childEvents:p}}function Ke(t,e,r,n,i,a){i===void 0&&(i=function(u,d){return d});var s=!!r.match(/End$/g),o=Me(t,e.name,n),l=t.moveables,c=o.map(function(u,d){var f=l[d],p=u;p=i(f,u);var v=e[r](f,O(O({},p),{parentFlag:!0}));return v&&a&&a(f,u,v,d),s&&(f.state.gestos={}),v});return c}function Oi(t,e,r,n){var i=r.fixedDirection,a=r.fixedPosition,s=n.datas.startPositions||be(e.state),o=Xt(s,i),l=R(jt(Cn(-t.rotation/180*Math.PI,3),[o[0]-a[0],o[1]-a[1],1],3),2),c=l[0],u=l[1];return n.datas.originalX=c,n.datas.originalY=u,n}function gc(t,e,r,n){var i=t.getState(),a=i.renderPoses,s=i.rotation,o=i.direction,l=yr(t.props,e).zoom,c=On(s/Math.PI*180),u={},d=t.renderState;d.renderDirectionMap||(d.renderDirectionMap={});var f=d.renderDirectionMap;r.forEach(function(v){var h=v.dir;u[h]=!0});var p=re(o);return r.map(function(v){var h=v.data,g=v.classNames,m=v.dir,b=uo[m];if(!b||!u[m])return null;f[m]=!0;var E=(ct(c,15)+p*sc[m]+720)%180,C={};return _e(h).forEach(function(x){C["data-".concat(x)]=h[x]}),n.createElement("div",O({className:nt.apply(void 0,$(["control","direction",m,e],R(g),!1)),"data-rotation":E,"data-direction":m},C,{key:"direction-".concat(m),style:Ki.apply(void 0,$([s,l],R(b.map(function(x){return a[x]})),!1))}))})}function mc(t,e,r,n){var i=yr(t.props,r),a=i.renderDirections,s=a===void 0?e:a,o=i.displayAroundControls;if(!s)return[];var l=s===!0?oo:s;return $($([],R(o?Cc(t,n,r,l):[]),!1),R(gc(t,r,l.map(function(c){return{data:{},classNames:[],dir:c}}),n)),!1)}function kn(t,e,r,n,i,a){for(var s=[],o=6;o<arguments.length;o++)s[o-6]=arguments[o];var l=It(r,n),c=e?ct(l/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(a),className:nt.apply(void 0,$(["line","direction",e?"edge":"",e],R(s),!1)),"data-rotation":c,"data-line-key":a,"data-direction":e,style:Nn(r,n,i,l)})}function yc(t,e,r,n,i){var a=r===!0?hh:r;return a.map(function(s,o){var l=R(uo[s],2),c=l[0],u=l[1];if(u!=null)return kn(t,s,n[c],n[u],i,"".concat(e,"Edge").concat(o),e)}).filter(Boolean)}function bc(t){return function(e,r){var n=yr(e.props,t).edge;return n&&(n===!0||n.length)?$($([],R(yc(r,t,n,e.getState().renderPoses,e.props.zoom)),!1),R($h(e,t,r)),!1):Ec(e,t,r)}}function Ec(t,e,r){return mc(t,oo,e,r)}function $h(t,e,r){return mc(t,["nw","ne","sw","se"],e,r)}function Cc(t,e,r,n){var i=t.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=t.getState(),s=a.renderPoses,o=a.rotation,l=a.direction,c=i.renderDirectionMap,u=t.props.zoom,d=re(l),f=o/Math.PI*180;return(n||_e(c)).map(function(p){var v=uo[p];if(!v)return null;var h=(ct(f,15)+d*sc[p]+720)%180,g=["around-control"];return r&&g.push("direction",r),e.createElement("div",{className:nt.apply(void 0,$([],R(g),!1)),"data-rotation":h,"data-direction":p,key:"direction-around-".concat(p),style:Ki.apply(void 0,$([o,u],R(v.map(function(m){return s[m]})),!1))})})}function mo(t,e,r){var n=t||{},i=n.position,a=i===void 0?"client":i,s=n.left,o=s===void 0?-1/0:s,l=n.top,c=l===void 0?-1/0:l,u=n.right,d=u===void 0?1/0:u,f=n.bottom,p=f===void 0?1/0:f,v={position:a,left:o,top:c,right:d,bottom:p};return{vertical:Sc(v,e,!0),horizontal:Sc(v,r,!1)}}function Ri(t,e){var r=t.state,n=r.containerClientRect,i=n.clientHeight,a=n.clientWidth,s=n.clientLeft,o=n.clientTop,l=r.snapOffset,c=l.left,u=l.top,d=l.right,f=l.bottom,p=e||t.props.bounds||{},v=p.position||"client",h=v==="css",g=p.left,m=g===void 0?-1/0:g,b=p.top,E=b===void 0?-1/0:b,C=p.right,x=C===void 0?h?-1/0:1/0:C,S=p.bottom,w=S===void 0?h?-1/0:1/0:S;return h&&(x=a+d-c-x,w=i+f-u-w),{left:m+c-s,right:x+c-s,top:E+u-o,bottom:w+u-o}}function jh(t,e,r){var n=Ri(t),i=n.left,a=n.top,s=n.right,o=n.bottom,l=R(r,2),c=l[0],u=l[1],d=R(it(r,e),2),f=d[0],p=d[1];F(f)<Jt&&(f=0),F(p)<Jt&&(p=0);var v=p>0,h=f>0,g={isBound:!1,offset:0,pos:0},m={isBound:!1,offset:0,pos:0};if(f===0&&p===0)return{vertical:g,horizontal:m};if(f===0)v?o<u&&(m.pos=o,m.offset=u-o):a>u&&(m.pos=a,m.offset=u-a);else if(p===0)h?s<c&&(g.pos=s,g.offset=c-s):i>c&&(g.pos=i,g.offset=c-i);else{var b=p/f,E=r[1]-b*c,C=0,x=0,S=!1;h&&s<=c?(C=b*s+E,x=s,S=!0):!h&&c<=i&&(C=b*i+E,x=i,S=!0),S&&(C<a||C>o)&&(S=!1),S||(v&&o<=u?(C=o,x=(C-E)/b,S=!0):!v&&u<=a&&(C=a,x=(C-E)/b,S=!0)),S&&(g.isBound=!0,g.pos=x,g.offset=c-x,m.isBound=!0,m.pos=C,m.offset=u-C)}return{vertical:g,horizontal:m}}function Sc(t,e,r){var n=t[r?"left":"top"],i=t[r?"right":"bottom"],a=Math.min.apply(Math,$([],R(e),!1)),s=Math.max.apply(Math,$([],R(e),!1)),o=[];return n+1>a&&o.push({direction:"start",isBound:!0,offset:a-n,pos:n}),i-1<s&&o.push({direction:"end",isBound:!0,offset:s-i,pos:i}),o.length||o.push({isBound:!1,offset:0,pos:0}),o.sort(function(l,c){return F(c.offset)-F(l.offset)})}function xc(t,e,r){var n=r?t.map(function(i){return En(i,r)}):t;return n.some(function(i){return i[0]<e.left&&F(i[0]-e.left)>.1||i[0]>e.right&&F(i[0]-e.right)>.1||i[1]<e.top&&F(i[1]-e.top)>.1||i[1]>e.bottom&&F(i[1]-e.bottom)>.1})}function Uh(t,e,r){var n=ye(t),i=Math.sqrt(n*n-e*e)||0;return[i,-i].sort(function(a,s){return F(a-t[r?0:1])-F(s-t[r?0:1])}).map(function(a){return It([0,0],r?[a,e]:[e,a])})}function Zh(t,e,r,n,i){if(!t.props.bounds)return[];var a=i*Math.PI/180,s=Ri(t),o=s.left,l=s.top,c=s.right,u=s.bottom,d=o-n[0],f=c-n[0],p=l-n[1],v=u-n[1],h={left:d,top:p,right:f,bottom:v};if(!xc(r,h,0))return[];var g=[];return[[d,0],[f,0],[p,1],[v,1]].forEach(function(m){var b=R(m,2),E=b[0],C=b[1];r.forEach(function(x){var S=It([0,0],x);g.push.apply(g,$([],R(Uh(x,E,C).map(function(w){return a+w-S}).filter(function(w){return!xc(e,h,w)}).map(function(w){return ct(w*180/Math.PI,Jt)})),!1))})}),g}var Qh=["left","right","center"],qh=["top","bottom","middle"],Dc={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},Ze={start:"left",end:"right",center:"center"},Qe={start:"top",end:"bottom",center:"middle"};function Wr(){return{left:!1,top:!1,right:!1,bottom:!1}}function Yr(t,e){var r=t.props,n=r.snappable,i=r.bounds,a=r.innerBounds,s=r.verticalGuidelines,o=r.horizontalGuidelines,l=r.snapGridWidth,c=r.snapGridHeight,u=t.state,d=u.guidelines,f=u.enableSnap;return!n||!f||e&&n!==!0&&n.indexOf(e)<0?!1:!!(l||c||i||a||d&&d.length||s&&s.length||o&&o.length)}function yo(t){return t===!1?{}:t===!0||!t?{left:!0,right:!0,top:!0,bottom:!0}:t}function Jh(t,e){var r=yo(t),n={};for(var i in r)i in e&&r[i]&&(n[i]=e[i]);return n}function bo(t,e){var r=Jh(t,e),n=qh.filter(function(a){return a in r}),i=Qh.filter(function(a){return a in r});return{horizontalNames:n,verticalNames:i,horizontal:n.map(function(a){return r[a]}),vertical:i.map(function(a){return r[a]})}}function tg(t,e,r){var n=Nt(t,[e.clientLeft,e.clientTop],r);return[e.left+n[0],e.top+n[1]]}function eg(t){var e=R(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];Math.abs(i)<zt&&(i=0),Math.abs(a)<zt&&(a=0);var s=0,o=0,l=0;return i?a?(s=-a/i,o=1,l=s*r[0]-r[1]):(o=1,l=-r[1]):(s=-1,l=r[0]),[s,o,l].map(function(c){return ct(c,zt)})}var wc="snapRotationThreshold",Tc="snapRotationDegrees",Ac="snapHorizontalThreshold",Mc="snapVerticalThreshold";function _i(t,e,r,n,i,a,s){var o;n===void 0&&(n=[]),i===void 0&&(i=[]);var l=t.props,c=((o=t.state.snapThresholdInfo)===null||o===void 0?void 0:o.multiples)||[1,1],u=du(s,l[Ac],5),d=du(a,l[Mc],5);return kc(t.state.guidelines,e,r,n,i,u,d,c)}function kc(t,e,r,n,i,a,s,o){return{vertical:Oc(t,"vertical",e,s*o[0],n),horizontal:Oc(t,"horizontal",r,a*o[1],i)}}function rg(t,e,r){var n=R(r,2),i=n[0],a=n[1],s=R(e,2),o=s[0],l=s[1],c=R(it(r,e),2),u=c[0],d=c[1],f=d>0,p=u>0;u=Hi(u),d=Hi(d);var v={isSnap:!1,offset:0,pos:0},h={isSnap:!1,offset:0,pos:0};if(u===0&&d===0)return{vertical:v,horizontal:h};var g=_i(t,u?[i]:[],d?[a]:[],[],[],void 0,void 0),m=g.vertical,b=g.horizontal;m.posInfos.filter(function(I){var B=I.pos;return p?B>=o:B<=o}),b.posInfos.filter(function(I){var B=I.pos;return f?B>=l:B<=l}),m.isSnap=m.posInfos.length>0,b.isSnap=b.posInfos.length>0;var E=Eo(m),C=E.isSnap,x=E.guideline,S=Eo(b),w=S.isSnap,D=S.guideline,T=w?D.pos[1]:0,A=C?x.pos[0]:0;if(u===0)w&&(h.isSnap=!0,h.pos=D.pos[1],h.offset=a-h.pos);else if(d===0)C&&(v.isSnap=!0,v.pos=A,v.offset=i-A);else{var M=d/u,P=r[1]-M*i,k=0,_=0,N=!1;C?(_=A,k=M*_+P,N=!0):w&&(k=T,_=(k-P)/M,N=!0),N&&(v.isSnap=!0,v.pos=_,v.offset=i-_,h.isSnap=!0,h.pos=k,h.offset=a-k)}return{vertical:v,horizontal:h}}function qe(t){var e="";return t===-1||t==="top"||t==="left"?e="start":t===0||t==="center"||t==="middle"?e="center":(t===1||t==="right"||t==="bottom")&&(e="end"),e}function Pc(t,e,r,n){var i=bo(t.props.snapDirections,e),a=_i(t,i.vertical,i.horizontal,i.verticalNames.map(function(l){return qe(l)}),i.horizontalNames.map(function(l){return qe(l)}),r,n),s=qe(i.horizontalNames[a.horizontal.index]),o=qe(i.verticalNames[a.vertical.index]);return{vertical:O(O({},a.vertical),{direction:o}),horizontal:O(O({},a.horizontal),{direction:s})}}function Eo(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var r=t.posInfos[0],n=r.guidelineInfos[0],i=n.offset,a=n.dist,s=n.guideline;return{isSnap:e,offset:i,dist:a,pos:r.pos,guideline:s}}function Oc(t,e,r,n,i){var a,s;if(i===void 0&&(i=[]),!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var o=e==="vertical",l=o?0:1,c=r.map(function(d,f){var p=i[f]||"",v=t.map(function(h){var g=h.pos,m=d-g[l];return{offset:m,dist:F(m),guideline:h,direction:p}}).filter(function(h){var g=h.guideline,m=h.dist,b=g.type;return!(b!==e||m>n)}).sort(function(h,g){return h.dist-g.dist});return{pos:d,index:f,guidelineInfos:v,direction:p}}).filter(function(d){return d.guidelineInfos.length>0}).sort(function(d,f){return d.guidelineInfos[0].dist-f.guidelineInfos[0].dist}),u=c.length>0;return{isSnap:u,index:u?c[0].index:-1,direction:(s=(a=c[0])===null||a===void 0?void 0:a.direction)!==null&&s!==void 0?s:"",posInfos:c}}function ng(t,e,r,n,i){var a=[];r[0]&&r[1]?a=[r,[-r[0],r[1]],[r[0],-r[1]]]:!r[0]&&!r[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(f,p,v){var h=v[p+1]||v[0];a.push(f),a.push([(f[0]+h[0])/2,(f[1]+h[1])/2])}):t.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],r):(a.push.apply(a,$([],R(Rh([[-1,-1],[1,-1],[-1,-1],[1,1]],r)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var s=a.map(function(f){return Xt(e,f)}),o=s.map(function(f){return f[0]}),l=s.map(function(f){return f[1]}),c=_i(t,o,l,a.map(function(f){return qe(f[0])}),a.map(function(f){return qe(f[1])}),n,i),u=qe(a.map(function(f){return f[0]})[c.vertical.index]),d=qe(a.map(function(f){return f[1]})[c.horizontal.index]);return{vertical:O(O({},c.vertical),{direction:u}),horizontal:O(O({},c.horizontal),{direction:d})}}function Rc(t,e){var r=F(t.offset),n=F(e.offset);return t.isBound&&e.isBound?n-r:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?n-r:t.isSnap?-1:e.isSnap||r<Jt?1:n<Jt?-1:r-n}function Ni(t,e){return t.slice().sort(function(r,n){var i=r.sign[e],a=n.sign[e],s=r.offset[e],o=n.offset[e];if(i){if(!a)return-1}else return 1;return Rc({isBound:r.isBound,isSnap:r.isSnap,offset:s},{isBound:n.isBound,isSnap:n.isSnap,offset:o})})[0]}function ig(t,e,r){var n=[];if(r)F(e[0])!==1||F(e[1])!==1?n.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):n.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),n.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var i=t[0]?t:[1,1];[1,-1].forEach(function(s){[1,-1].forEach(function(o){var l=[s*i[0],o*i[1]];e[0]===l[0]&&e[1]===l[1]||n.push([e,l])})})}else if(t[0]){var a=F(e[0])===1?[1]:[1,-1];a.forEach(function(s){n.push([[e[0],-1],[s*t[0],-1]],[[e[0],0],[s*t[0],0]],[[e[0],1],[s*t[0],1]])})}else if(t[1]){var a=F(e[1])===1?[1]:[1,-1];a.forEach(function(o){n.push([[-1,e[1]],[-1,o*t[1]]],[[0,e[1]],[0,o*t[1]]],[[1,e[1]],[1,o*t[1]]])})}return n}function _c(t,e){var r=Da([e[0][0],e[1][0]]),n=Da([e[0][1],e[1][1]]);return{vertical:r<=t[0],horizontal:n<=t[1]}}function Co(t,e){var r=R(e,2),n=r[0],i=r[1],a=i[0]-n[0],s=i[1]-n[1];F(a)<Jt&&(a=0),F(s)<Jt&&(s=0);var o,l;if(!a)o=n[0],l=t[0];else if(!s)o=n[1],l=t[1];else{var c=s/a;o=c*(t[0]-n[0])+n[1],l=t[1]}return o-l}function Nc(t,e,r,n){return n===void 0&&(n=Jt),t.every(function(i){var a=Co(i,e),s=a<=0;return s===r||F(a)<=n})}function Lc(t,e,r,n,i){return i===void 0&&(i=0),n&&e-i<=t||!n&&t<=r+i?{isBound:!0,offset:n?e-t:r-t}:{isBound:!1,offset:0}}function ag(t,e){var r=e.line,n=e.centerSign,i=e.verticalSign,a=e.horizontalSign,s=e.lineConstants,o=t.props.innerBounds;if(!o)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var l=o.left,c=o.top,u=o.width,d=o.height,f=[[l,c],[l,c+d]],p=[[l,c],[l+u,c]],v=[[l+u,c],[l+u,c+d]],h=[[l,c+d],[l+u,c+d]];if(Nc([[l,c],[l+u,c],[l,c+d],[l+u,c+d]],r,n))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var g=Je(r,s,p,i),m=Je(r,s,h,i),b=Je(r,s,f,a),E=Je(r,s,v,a),C=g.isBound&&m.isBound,x=g.isBound||m.isBound,S=b.isBound&&E.isBound,w=b.isBound||E.isBound,D=Hr(g.offset,m.offset),T=Hr(b.offset,E.offset),A=[0,0],M=!1,P=!1;return F(T)<F(D)?(A=[D,0],M=x,P=C):(A=[0,T],M=w,P=S),{isAllBound:P,isVerticalBound:x,isHorizontalBound:w,isBound:M,offset:A}}function Je(t,e,r,n,i,a){var s=R(e,2),o=s[0],l=s[1],c=t[0],u=r[0],d=r[1],f=Hi(d[1]-u[1]),p=Hi(d[0]-u[0]),v=l,h=o,g=-o/l;if(p){if(!f){if(a&&!v)return{isBound:!1,offset:0};if(h){var C=(u[1]-c[1])/g+c[0];return Lc(C,u[0],d[0],n,i)}else{var b=u[1]-c[1],E=F(b)<=(i||0);return{isBound:E,offset:E?b:0}}}}else{if(a&&!h)return{isBound:!1,offset:0};if(v){var m=g*(u[0]-c[0])+c[1];return Lc(m,u[1],d[1],n,i)}else{var b=u[0]-c[0],E=F(b)<=(i||0);return{isBound:E,offset:E?b:0}}}return{isBound:!1,offset:0}}function zc(t,e,r){return e.map(function(n){var i=ag(t,n),a=i.isBound,s=i.offset,o=i.isVerticalBound,l=i.isHorizontalBound,c=n.multiple,u=Le({datas:r,distX:s[0],distY:s[1]}).map(function(d,f){return d*(c[f]?2/c[f]:0)});return{sign:c,isBound:a,isVerticalBound:o,isHorizontalBound:l,isSnap:!1,offset:u}})}function og(t,e,r){var n,i=So(t,e,[0,0],!1).map(function(f){return O(O({},f),{multiple:f.multiple.map(function(p){return F(p)*2})})}),a=zc(t,i,r),s=Ni(a,0),o=Ni(a,1),l=0,c=0,u=s.isVerticalBound||o.isVerticalBound,d=s.isHorizontalBound||o.isHorizontalBound;return(u||d)&&(n=R(Ph({datas:r,distX:-s.offset[0],distY:-o.offset[1]}),2),l=n[0],c=n[1]),{vertical:{isBound:u,offset:l},horizontal:{isBound:d,offset:c}}}function sg(t,e){var r=[],n=t[0],i=t[1];return n&&i?r.push([[0,i*2],t,[-n,i]],[[n*2,0],t,[n,-i]]):n?(r.push([[n*2,0],[n,1],[n,-1]]),e&&r.push([[0,-1],[n,-1],[-n,-1]],[[0,1],[n,1],[-n,1]])):i?(r.push([[0,i*2],[1,i],[-1,i]]),e&&r.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):r.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),r}function So(t,e,r,n){var i=t.state,a=i.allMatrix,s=i.is3d,o=mr(a,100,100,s?4:3),l=Xt(o,[0,0]);return sg(r,n).map(function(c){var u=R(c,3),d=u[0],f=u[1],p=u[2],v=[Xt(o,f),Xt(o,p)],h=eg(v),g=_c(l,v),m=g.vertical,b=g.horizontal,E=Co(l,v)<=0;return{multiple:d,centerSign:E,verticalSign:m,horizontalSign:b,lineConstants:h,line:[Xt(e,f),Xt(e,p)]}})}function Ic(t,e,r,n){var i=n?t.map(function(a){return En(a,n)}):t;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var s=Co(r,a)<=0;return!Nc(e,a,s)})}function lg(t){var e=R(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];if(!i)return F(r[0]);if(!a)return F(r[1]);var s=a/i;return F((-s*r[0]+r[1])/Math.sqrt(Math.pow(s,2)+1))}function cg(t){var e=R(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];if(!i)return[r[0],0];if(!a)return[0,r[1]];var s=a/i,o=-s*r[0]+r[1];return[-o/(s+1/s),o/(s*s+1)]}function ug(t,e,r,n,i){var a=t.props.innerBounds,s=i*Math.PI/180;if(!a)return[];var o=a.left,l=a.top,c=a.width,u=a.height,d=o-n[0],f=o+c-n[0],p=l-n[1],v=l+u-n[1],h=[[d,p],[f,p],[d,v],[f,v]],g=Xt(r,[0,0]);if(!Ic(r,h,g,0))return[];var m=[],b=h.map(function(E){return[ye(E),It([0,0],E)]});return[[r[0],r[1]],[r[1],r[3]],[r[3],r[2]],[r[2],r[0]]].forEach(function(E){var C=It([0,0],cg(E)),x=lg(E);m.push.apply(m,$([],R(b.filter(function(S){var w=R(S,1),D=w[0];return D&&x<=D}).map(function(S){var w=R(S,2),D=w[0],T=w[1],A=Math.acos(D?x/D:0),M=T+A,P=T-A;return[s+M-C,s+P-C]}).reduce(function(S,w){return S.push.apply(S,$([],R(w),!1)),S},[]).filter(function(S){return!Ic(e,h,g,S)}).map(function(S){return ct(S*180/Math.PI,Jt)})),!1))}),m}function dg(t){var e=t.props.innerBounds,r=Wr();if(!e)return{boundMap:r,vertical:[],horizontal:[]};var n=t.getRect(),i=n.pos1,a=n.pos2,s=n.pos3,o=n.pos4,l=[i,a,s,o],c=Xt(l,[0,0]),u=e.left,d=e.top,f=e.width,p=e.height,v=[[u,d],[u,d+p]],h=[[u,d],[u+f,d]],g=[[u+f,d],[u+f,d+p]],m=[[u,d+p],[u+f,d+p]],b=So(t,l,[0,0],!1),E=[],C=[];return b.forEach(function(x){var S=x.line,w=x.lineConstants,D=_c(c,S),T=D.horizontal,A=D.vertical,M=Je(S,w,h,A,1,!0),P=Je(S,w,m,A,1,!0),k=Je(S,w,v,T,1,!0),_=Je(S,w,g,T,1,!0);M.isBound&&!r.top&&(E.push(d),r.top=!0),P.isBound&&!r.bottom&&(E.push(d+p),r.bottom=!0),k.isBound&&!r.left&&(C.push(u),r.left=!0),_.isBound&&!r.right&&(C.push(u+f),r.right=!0)}),{boundMap:r,horizontal:E,vertical:C}}function fg(t,e,r,n){var i=e[0]-t[0],a=e[1]-t[1];if(F(i)<zt&&(i=0),F(a)<zt&&(a=0),!i)return n?[0,0]:[0,r];if(!a)return n?[r,0]:[0,0];var s=a/i,o=t[1]-s*t[0];if(n){var l=s*(e[0]+r)+o;return[r,l-e[1]]}else{var c=(e[1]+r-o)/s;return[c-e[0],r]}}function xo(t,e,r,n,i){var a=fg(t,e,r,n);if(!a)return{isOutside:!1,offset:[0,0]};var s=Ne(t,e),o=Ne(a,t),l=Ne(a,e),c=o>s||l>s,u=R(Le({datas:i,distX:a[0],distY:a[1]}),2),d=u[0],f=u[1];return{offset:[d,f],isOutside:c}}function Li(t,e){return t.isBound?t.offset:e.isSnap?Eo(e).offset:0}function pg(t,e,r,n,i){var a=R(e,2),s=a[0],o=a[1],l=R(r,2),c=l[0],u=l[1],d=R(n,2),f=d[0],p=d[1],v=R(i,2),h=v[0],g=v[1],m=-h,b=-g;if(t&&s&&o){m=0,b=0;var E=[];if(c&&u?E.push([0,g],[h,0]):c?E.push([h,0]):u?E.push([0,g]):f&&p?E.push([0,g],[h,0]):f?E.push([h,0]):p&&E.push([0,g]),E.length){E.sort(function(w,D){return ye(it([s,o],w))-ye(it([s,o],D))});var C=E[0];if(C[0]&&F(s)>zt)m=-C[0],b=o*F(s+m)/F(s)-o;else if(C[1]&&F(o)>zt){var x=o;b=-C[1],m=s*F(o+b)/F(x)-s}if(t&&u&&c)if(F(m)>zt&&F(m)<F(h)){var S=F(h)/F(m);m*=S,b*=S}else if(F(b)>zt&&F(b)<F(g)){var S=F(g)/F(b);m*=S,b*=S}else m=Hr(-h,m),b=Hr(-g,b)}}else m=s||c?-h:0,b=o||u?-g:0;return[m,b]}function vg(t,e,r,n,i,a){if(!Yr(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var s=Lo(a.absolutePoses,[e,r]),o=me(s),l=o.left,c=o.right,u=o.top,d=o.bottom,f={horizontal:s.map(function(_){return _[1]}),vertical:s.map(function(_){return _[0]})},p=yo(t.props.snapDirections),v=bo(p,{left:l,right:c,top:u,bottom:d,center:(l+c)/2,middle:(u+d)/2}),h=zi(t,i,v,f),g=h.vertical,m=h.horizontal,b=og(t,s,a),E=b.vertical,C=b.horizontal,x=g.isSnap,S=m.isSnap,w=g.isBound||E.isBound,D=m.isBound||C.isBound,T=Hr(g.offset,E.offset),A=Hr(m.offset,C.offset),M=R(pg(n,[e,r],[w,D],[x,S],[T,A]),2),P=M[0],k=M[1];return[{isBound:w,isSnap:x,offset:P},{isBound:D,isSnap:S,offset:k}]}function zi(t,e,r,n){n===void 0&&(n=r);var i=mo(Ri(t),n.vertical,n.horizontal),a=i.horizontal,s=i.vertical,o=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:_i(t,r.vertical,r.horizontal,void 0,void 0,void 0,void 0),l=o.horizontal,c=o.vertical,u=Li(a[0],l),d=Li(s[0],c),f=F(u),p=F(d);return{horizontal:{isBound:a[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:u,dist:f,bounds:a,snap:l},vertical:{isBound:s[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:d,dist:p,bounds:s,snap:c}}}function Bc(t,e,r,n,i,a,s){s===void 0&&(s=[1,1]);var o=mo(e,r,n),l=o.horizontal,c=o.vertical,u=kc(t,r,n,[],[],i,a,s),d=u.horizontal,f=u.vertical,p=Li(l[0],d),v=Li(c[0],f),h=F(p),g=F(v);return{horizontal:{isBound:l[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:p,dist:h,bounds:l,snap:d},vertical:{isBound:c[0].isBound,isSnap:f.isSnap,snapIndex:f.index,offset:v,dist:g,bounds:c,snap:f}}}function hg(t,e,r,n){var i=It(t,e)/Math.PI*180,a=r.vertical,s=a.isBound,o=a.isSnap,l=a.dist,c=r.horizontal,u=c.isBound,d=c.isSnap,f=c.dist,p=i%180,v=p<3||p>177,h=p>87&&p<93;return f<l&&(s||o&&!h&&(!n||!v))?"vertical":u||d&&!v&&(!n||!h)?"horizontal":""}function gg(t,e,r,n,i,a){return r.map(function(s){var o=R(s,2),l=o[0],c=o[1],u=Xt(e,l),d=Xt(e,c),f=n?mg(t,u,d,i):zi(t,i,{vertical:[d[0]],horizontal:[d[1]]}),p=f.horizontal,v=p.offset,h=p.isBound,g=p.isSnap,m=f.vertical,b=m.offset,E=m.isBound,C=m.isSnap,x=it(c,l);if(!b&&!v)return{isBound:E||h,isSnap:C||g,sign:x,offset:[0,0]};var S=hg(u,d,f,n);if(!S)return{sign:x,isBound:!1,isSnap:!1,offset:[0,0]};var w=S==="vertical",D=[0,0];return!n&&F(c[0])===1&&F(c[1])===1&&l[0]!==c[0]&&l[1]!==c[1]?D=Le({datas:a,distX:-b,distY:-v}):D=xo(u,d,-(w?b:v),w,a).offset,D=D.map(function(T,A){return T*(x[A]?2/x[A]:0)}),{sign:x,isBound:w?E:h,isSnap:w?C:g,offset:D}})}function Gc(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function mg(t,e,r,n){var i=jh(t,e,r),a=i.horizontal,s=i.vertical,o=n?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:rg(t,e,r),l=o.horizontal,c=o.vertical,u=Gc(a,l),d=Gc(s,c),f=F(u),p=F(d);return{horizontal:{isBound:a.isBound,isSnap:l.isSnap,offset:u,dist:f},vertical:{isBound:s.isBound,isSnap:c.isSnap,offset:d,dist:p}}}function yg(t,e,r,n,i){var a=[-r[0],-r[1]],s=t.state,o=s.width,l=s.height,c=t.props.bounds,u=1/0,d=1/0;if(c){var f=[[r[0],-r[1]],[-r[0],r[1]]],p=c.left,v=p===void 0?-1/0:p,h=c.top,g=h===void 0?-1/0:h,m=c.right,b=m===void 0?1/0:m,E=c.bottom,C=E===void 0?1/0:E;f.forEach(function(x){var S=x[0]!==a[0],w=x[1]!==a[1],D=Xt(e,x),T=It(n,D)*360/Math.PI;if(w){var A=D.slice();(F(T-360)<2||F(T-180)<2)&&(A[1]=n[1]);var M=xo(n,A,(n[1]<D[1]?C:g)-D[1],!1,i),P=R(M.offset,2),k=P[1],_=M.isOutside;isNaN(k)||(d=l+(_?1:-1)*F(k))}if(S){var A=D.slice();(F(T-90)<2||F(T-270)<2)&&(A[0]=n[0]);var N=xo(n,A,(n[0]<D[0]?b:v)-D[0],!0,i),I=R(N.offset,1),B=I[0],L=N.isOutside;isNaN(B)||(u=o+(L?1:-1)*F(B))}})}return{maxWidth:u,maxHeight:d}}var te={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(t,e){var r=t.props,n=r.hideThrottleDragRotateLine,i=r.throttleDragRotate,a=r.zoom,s=t.getState(),o=s.dragInfo,l=s.beforeOrigin;if(n||!i||!o)return[];var c=o.dist;if(!c[0]&&!c[1])return[];var u=ye(c),d=It(c,[0,0]);return[e.createElement("div",{className:nt("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(u,"px"),transform:"translate(".concat(l[0],"px, ").concat(l[1],"px) rotate(").concat(d,"rad) scaleY(").concat(a,")")}})]},dragStart:function(t,e){var r=e.datas,n=e.parentEvent,i=e.parentGesto,a=t.state,s=a.gestos,o=a.style;if(s.draggable)return!1;s.draggable=i||t.targetGesto,r.datas={},r.left=parseFloat(o.left||"")||0,r.top=parseFloat(o.top||"")||0,r.bottom=parseFloat(o.bottom||"")||0,r.right=parseFloat(o.right||"")||0,r.startValue=[0,0],vr(t,e),Ai(t,e,"translate"),Ig(t,r),r.prevDist=[0,0],r.prevBeforeDist=[0,0],r.isDrag=!1,r.deltaOffset=[0,0];var l=dt(t,e,O({set:function(u){r.startValue=u}},Ti(t,e))),c=n||J(t,"onDragStart",l);return c!==!1?(r.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(s.draggable=null,r.isPinch=!1),r.isDrag?l:!1},drag:function(t,e){if(e){Di(t,e,"translate");var r=e.datas,n=e.parentEvent,i=e.parentFlag,a=e.isPinch,s=e.deltaOffset,o=e.useSnap,l=e.isRequest,c=e.isGroup,u=e.parentThrottleDrag,d=e.distX,f=e.distY,p=r.isDrag,v=r.prevDist,h=r.prevBeforeDist,g=r.startValue;if(p){s&&(d+=s[0],f+=s[1]);var m=t.props,b=m.parentMoveable,E=c?0:m.throttleDrag||u||0,C=n?0:m.throttleDragRotate||0,x=0,S=!1,w=!1,D=!1,T=!1;if(!n&&C>0&&(d||f)){var A=m.startDragRotate||0,M=ct(A+It([0,0],[d,f])*180/Math.PI,C)-A,P=f*Math.abs(Math.cos((M-90)/180*Math.PI)),k=d*Math.abs(Math.cos(M/180*Math.PI)),_=ye([k,P]);x=M*Math.PI/180,d=_*Math.cos(x),f=_*Math.sin(x)}if(!a&&!n&&!i){var N=R(vg(t,d,f,C,!o&&l||s,r),2),I=N[0],B=N[1];S=I.isSnap,w=I.isBound,D=B.isSnap,T=B.isBound;var L=I.offset,G=B.offset;d+=L,f+=G}var W=yt(dc({datas:r,distX:d,distY:f}),g),z=yt(kh({datas:r,distX:d,distY:f}),g);pl(z,Jt),pl(W,Jt),C||(!S&&!w&&(z[0]=ct(z[0],E),W[0]=ct(W[0],E)),!D&&!T&&(z[1]=ct(z[1],E),W[1]=ct(W[1],E)));var X=it(W,g),j=it(z,g),Y=it(j,v),Z=it(X,h);r.prevDist=j,r.prevBeforeDist=X,r.passDelta=Y,r.passDist=j;var U=r.left+X[0],q=r.top+X[1],et=r.right-X[0],at=r.bottom-X[1],ot=wi(r,"translate(".concat(z[0],"px, ").concat(z[1],"px)"),"translate(".concat(j[0],"px, ").concat(j[1],"px)"));if(vo(e,ot),t.state.dragInfo.dist=n?[0,0]:j,!(!n&&!b&&Y.every(function(lt){return!lt})&&Z.some(function(lt){return!lt}))){var V=t.state,tt=V.width,gt=V.height,st=dt(t,e,O({transform:ot,dist:j,delta:Y,translate:z,beforeDist:X,beforeDelta:Z,beforeTranslate:W,left:U,top:q,right:et,bottom:at,width:tt,height:gt,isPinch:a},ee({transform:ot},e)));return!n&&J(t,"onDrag",st),st}}}},dragAfter:function(t,e){var r=e.datas,n=r.deltaOffset;return n[0]||n[1]?(r.deltaOffset=[0,0],this.drag(t,O(O({},e),{deltaOffset:n}))):!1},dragEnd:function(t,e){var r=e.parentEvent,n=e.datas;if(t.state.dragInfo=null,!!n.isDrag){n.isDrag=!1;var i=pe(t,e,{});return!r&&J(t,"onDragEnd",i),i}},dragGroupStart:function(t,e){var r,n,i=e.datas,a=e.clientX,s=e.clientY,o=this.dragStart(t,e);if(!o)return!1;var l=go(t,this,"dragStart",[a||0,s||0],e,!1,"draggable"),c=l.childEvents,u=l.eventParams,d=O(O({},o),{targets:t.props.targets,events:u}),f=J(t,"onDragGroupStart",d);i.isDrag=f!==!1;var p=(n=(r=c[0])===null||r===void 0?void 0:r.datas.startValue)!==null&&n!==void 0?n:[0,0];return i.throttleOffset=[p[0]%1,p[1]%1],i.isDrag?o:!1},dragGroup:function(t,e){var r=e.datas;if(r.isDrag){var n=this.drag(t,O(O({},e),{parentThrottleDrag:t.props.throttleDrag})),i=e.datas.passDelta,a=go(t,this,"drag",i,e,!1,"draggable").eventParams;if(n){var s=O({targets:t.props.targets,events:a},n);return J(t,"onDragGroup",s),s}}},dragGroupEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isDrag){this.dragEnd(t,e);var i=go(t,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return J(t,"onDragGroupEnd",pe(t,e,{targets:t.props.targets,events:i})),r}},request:function(t){var e={},r=t.getRect(),n=0,i=0,a=!1;return{isControl:!1,requestStart:function(s){return a=s.useSnap,{datas:e,useSnap:a}},request:function(s){return"x"in s?n=s.x-r.left:"deltaX"in s&&(n+=s.deltaX),"y"in s?i=s.y-r.top:"deltaY"in s&&(i+=s.deltaY),{datas:e,distX:n,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function Fc(t,e){var r=Xt(t,e),n=[0,0];return{fixedPosition:r,fixedDirection:e,fixedOffset:n}}function bg(t,e){var r=t.allMatrix,n=t.is3d,i=t.width,a=t.height,s=n?4:3,o=[i/2*(1+e[0]),a/2*(1+e[1])],l=Nt(r,o,s),c=[0,0];return{fixedPosition:l,fixedDirection:e,fixedOffset:c}}function Kc(t,e){var r=t.allMatrix,n=t.is3d,i=t.width,a=t.height,s=n?4:3,o=Ih(e,i,a),l=Nt(r,e,s),c=[i?0:e[0],a?0:e[1]];return{fixedPosition:l,fixedDirection:o,fixedOffset:c}}var Wc=Fo("resizable"),Do={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:bc("resizable"),dragControlCondition:Wc,viewClassName:Go("resizable"),dragControlStart:function(t,e){var r,n=e.inputEvent,i=e.isPinch,a=e.isGroup,s=e.parentDirection,o=e.parentGesto,l=e.datas,c=e.parentFixedDirection,u=e.parentEvent,d=lu(s,i,n,l),f=t.state,p=f.target,v=f.width,h=f.height,g=f.gestos;if(!d||!p||g.resizable)return!1;g.resizable=o||t.controlGesto,!i&&vr(t,e),l.datas={},l.direction=d,l.startOffsetWidth=v,l.startOffsetHeight=h,l.prevWidth=0,l.prevHeight=0,l.minSize=[0,0],l.startWidth=f.inlineCSSWidth||f.cssWidth,l.startHeight=f.inlineCSSHeight||f.cssHeight,l.maxSize=[1/0,1/0],a||(l.minSize=[f.minOffsetWidth,f.minOffsetHeight],l.maxSize=[f.maxOffsetWidth,f.maxOffsetHeight]);var m=t.props.transformOrigin||"% %";l.transformOrigin=m&&$t(m)?m.split(" "):m,l.startOffsetMatrix=f.offsetMatrix,l.startTransformOrigin=f.transformOrigin,l.isWidth=(r=e?.parentIsWidth)!==null&&r!==void 0?r:!d[0]&&!d[1]||d[0]||!d[1];function b(T){l.ratio=T&&isFinite(T)?T:0}l.startPositions=be(t.state);function E(T){var A=Fc(l.startPositions,T);l.fixedDirection=A.fixedDirection,l.fixedPosition=A.fixedPosition,l.fixedOffset=A.fixedOffset}function C(T){var A=Kc(t.state,T);l.fixedDirection=A.fixedDirection,l.fixedPosition=A.fixedPosition,l.fixedOffset=A.fixedOffset}function x(T){l.minSize=[xt("".concat(T[0]),0)||0,xt("".concat(T[1]),0)||0]}function S(T){var A=[T[0]||1/0,T[1]||1/0];(!Pr(A[0])||isFinite(A[0]))&&(A[0]=xt("".concat(A[0]),0)||1/0),(!Pr(A[1])||isFinite(A[1]))&&(A[1]=xt("".concat(A[1]),0)||1/0),l.maxSize=A}b(v/h),E(c||[-d[0],-d[1]]),l.setFixedDirection=E,l.setFixedPosition=C,l.setMin=x,l.setMax=S;var w=dt(t,e,{direction:d,startRatio:l.ratio,set:function(T){var A=R(T,2),M=A[0],P=A[1];l.startWidth=M,l.startHeight=P},setMin:x,setMax:S,setRatio:b,setFixedDirection:E,setFixedPosition:C,setOrigin:function(T){l.transformOrigin=T},dragStart:te.dragStart(t,new Ir().dragStart([0,0],e))}),D=u||J(t,"onResizeStart",w);return l.startFixedDirection=l.fixedDirection,l.startFixedPosition=l.fixedPosition,D!==!1&&(l.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:d}),l.isResize?w:!1},dragControl:function(t,e){var r,n=e.datas,i=e.parentFlag,a=e.isPinch,s=e.parentKeepRatio,o=e.dragClient,l=e.parentDist,c=e.useSnap,u=e.isRequest,d=e.isGroup,f=e.parentEvent,p=e.resolveMatrix,v=n.isResize,h=n.transformOrigin,g=n.startWidth,m=n.startHeight,b=n.prevWidth,E=n.prevHeight,C=n.minSize,x=n.maxSize,S=n.ratio,w=n.startOffsetWidth,D=n.startOffsetHeight,T=n.isWidth;if(!v)return;if(p){var A=t.state.is3d,M=n.startOffsetMatrix,P=n.startTransformOrigin,k=A?4:3,_=ur(Mi(e)),N=Math.sqrt(_.length);k!==N&&(_=Ae(_,N,k));var I=Mn(M,_,P,k),B=mr(I,w,D,k);n.startPositions=B,n.nextTargetMatrix=_,n.nextAllMatrix=I}var L=yr(t.props,"resizable"),G=L.resizeFormat,W=L.throttleResize,z=W===void 0?i?0:1:W,X=L.parentMoveable,j=L.keepRatioFinally,Y=n.direction,Z=Y,U=0,q=0;!Y[0]&&!Y[1]&&(Z=[1,1]);var et=S&&(s??L.keepRatio)||!1;function at(){var wt=n.fixedDirection,At=mu(Z,et,n,e);U=At.distWidth,q=At.distHeight;var Ut=Z[0]-wt[0]||et?Math.max(w+U,Jt):w,Zt=Z[1]-wt[1]||et?Math.max(D+q,Jt):D;return et&&w&&D&&(T?Zt=Ut/S:Ut=Zt*S),[Ut,Zt]}var ot=R(at(),2),V=ot[0],tt=ot[1];f||(n.setFixedDirection(n.fixedDirection),J(t,"onBeforeResize",dt(t,e,{startFixedDirection:n.startFixedDirection,startFixedPosition:n.startFixedPosition,setFixedDirection:function(wt){var At;return n.setFixedDirection(wt),At=R(at(),2),V=At[0],tt=At[1],[V,tt]},setFixedPosition:function(wt){var At;return n.setFixedPosition(wt),At=R(at(),2),V=At[0],tt=At[1],[V,tt]},boundingWidth:V,boundingHeight:tt,setSize:function(wt){var At;At=R(wt,2),V=At[0],tt=At[1]}},!0)));var gt=o;o||(!i&&a?gt=Kh(t,[0,0]):gt=n.fixedPosition);var st=[0,0];a||(st=Lg(t,V,tt,Y,gt,!c&&u,n)),l&&(!l[0]&&(st[0]=0),!l[1]&&(st[1]=0));function lt(){var wt;G&&(wt=R(G([V,tt]),2),V=wt[0],tt=wt[1]),V=ct(V,z),tt=ct(tt,z)}if(et){Z[0]&&Z[1]&&st[0]&&st[1]&&(F(st[0])>F(st[1])?st[1]=0:st[0]=0);var ft=!st[0]&&!st[1];ft&&lt(),Z[0]&&!Z[1]||st[0]&&!st[1]||ft&&T?(V+=st[0],tt=V/S):(!Z[0]&&Z[1]||!st[0]&&st[1]||ft&&!T)&&(tt+=st[1],V=tt*S)}else V+=st[0],tt+=st[1],V=Math.max(0,V),tt=Math.max(0,tt);r=R(xa([V,tt],C,x,et?S:!1),2),V=r[0],tt=r[1],lt(),et&&(d||j)&&(T?tt=V/S:V=tt*S),U=V-w,q=tt-D;var bt=[U-b,q-E];n.prevWidth=U,n.prevHeight=q;var St=Fh(t,V,tt,gt,h,n);if(!(!X&&bt.every(function(wt){return!wt})&&St.every(function(wt){return!wt}))){var ut=te.drag(t,An(e,t.state,St,!!a,!1,"draggable")),Et=ut.transform,Bt=g+U,vt=m+q,Rt=dt(t,e,O({width:Bt,height:vt,offsetWidth:Math.round(V),offsetHeight:Math.round(tt),startRatio:S,boundingWidth:V,boundingHeight:tt,direction:Y,dist:[U,q],delta:bt,isPinch:!!a,drag:ut},uu({style:{width:"".concat(Bt,"px"),height:"".concat(vt,"px")},transform:Et},ut,e)));return!f&&J(t,"onResize",Rt),Rt}},dragControlAfter:function(t,e){var r=e.datas,n=r.isResize,i=r.startOffsetWidth,a=r.startOffsetHeight,s=r.prevWidth,o=r.prevHeight;if(!(!n||t.props.checkResizableError===!1)){var l=t.state,c=l.width,u=l.height,d=c-(i+s),f=u-(a+o),p=F(d)>3,v=F(f)>3;if(p&&(r.startWidth+=d,r.startOffsetWidth+=d,r.prevWidth+=d),v&&(r.startHeight+=f,r.startOffsetHeight+=f,r.prevHeight+=f),p||v)return this.dragControl(t,e)}},dragControlEnd:function(t,e){var r=e.datas,n=e.parentEvent;if(r.isResize){r.isResize=!1;var i=pe(t,e,{});return!n&&J(t,"onResizeEnd",i),i}},dragGroupControlCondition:Wc,dragGroupControlStart:function(t,e){var r=e.datas,n=this.dragControlStart(t,O(O({},e),{isGroup:!0}));if(!n)return!1;var i=Me(t,"resizable",e),a=r.startOffsetWidth,s=r.startOffsetHeight;function o(){var p=r.minSize;i.forEach(function(v){var h=v.datas,g=h.minSize,m=h.startOffsetWidth,b=h.startOffsetHeight,E=a*(m?g[0]/m:0),C=s*(b?g[1]/b:0);p[0]=Math.max(p[0],E),p[1]=Math.max(p[1],C)})}function l(){var p=r.maxSize;i.forEach(function(v){var h=v.datas,g=h.maxSize,m=h.startOffsetWidth,b=h.startOffsetHeight,E=a*(m?g[0]/m:0),C=s*(b?g[1]/b:0);p[0]=Math.min(p[0],E),p[1]=Math.min(p[1],C)})}var c=Ke(t,this,"dragControlStart",e,function(p,v){return Oi(t,p,r,v)});o(),l();var u=function(p){n.setFixedDirection(p),c.forEach(function(v,h){v.setFixedDirection(p),Oi(t,v.moveable,r,i[h])})};r.setFixedDirection=u;var d=O(O({},n),{targets:t.props.targets,events:c.map(function(p){return O(O({},p),{setMin:function(v){p.setMin(v),o()},setMax:function(v){p.setMax(v),l()}})}),setFixedDirection:u,setMin:function(p){n.setMin(p),o()},setMax:function(p){n.setMax(p),l()}}),f=J(t,"onResizeGroupStart",d);return r.isResize=f!==!1,r.isResize?n:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isResize){var n=yr(t.props,"resizable");Yi(t,"onBeforeResize",function(p){J(t,"onBeforeResizeGroup",dt(t,e,O(O({},p),{targets:n.targets}),!0))});var i=this.dragControl(t,O(O({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,s=i.boundingHeight,o=i.dist,l=n.keepRatio,c=[a/(a-o[0]),s/(s-o[1])],u=r.fixedPosition,d=Ke(t,this,"dragControl",e,function(p,v){var h=R(jt(Cn(t.rotation/180*Math.PI,3),[v.datas.originalX*c[0],v.datas.originalY*c[1],1],3),2),g=h[0],m=h[1];return O(O({},v),{parentDist:null,parentScale:c,dragClient:yt(u,[g,m]),parentKeepRatio:l})}),f=O({targets:n.targets,events:d},i);return J(t,"onResizeGroup",f),f}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isResize){this.dragControlEnd(t,e);var i=Ke(t,this,"dragControlEnd",e),a=pe(t,e,{targets:t.props.targets,events:i});return J(t,"onResizeGroupEnd",a),r}},request:function(t){var e={},r=0,n=0,i=!1,a=t.getRect();return{isControl:!0,requestStart:function(s){var o;return i=s.useSnap,{datas:e,parentDirection:s.direction||[1,1],parentIsWidth:(o=s?.horizontal)!==null&&o!==void 0?o:!0,useSnap:i}},request:function(s){return"offsetWidth"in s?r=s.offsetWidth-a.offsetWidth:"deltaWidth"in s&&(r+=s.deltaWidth),"offsetHeight"in s?n=s.offsetHeight-a.offsetHeight:"deltaHeight"in s&&(n+=s.deltaHeight),{datas:e,parentDist:[r,n],parentKeepRatio:s.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(t){t.state.gestos.resizable=null}};function wo(t,e,r,n,i){var a=t.props.groupable,s=t.state,o=s.is3d?4:3,l=e.origin,c=Nt(t.state.rootMatrix,it([l[0],l[1]],a?[0,0]:[s.left,s.top]),o),u=yt([i.left,i.top],c);e.startAbsoluteOrigin=u,e.prevDeg=It(u,[r,n])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=Ne(u,[r,n])}function Ii(t,e,r){var n=r.defaultDeg,i=r.prevDeg,a=i%360,s=Math.floor(i/360);a<0&&(a+=360),a>t&&a>270&&t<90?++s:a<t&&a<90&&t>270&&--s;var o=e*(s*360+t-n);return r.prevDeg=n+o,o}function To(t,e,r,n){return Ii(It(n.startAbsoluteOrigin,[t,e])/Math.PI*180,r,n)}function Ao(t,e,r,n,i,a){var s=t.props.throttleRotate,o=s===void 0?0:s,l=r.prevSnapDeg,c=0,u=!1;if(a){var d=Ng(t,e,n,i+n);u=d.isSnap,c=i+d.dist}u||(c=ct(i+n,o));var f=c-i;return r.prevSnapDeg=f,[f-l,f,c]}function Yc(t,e,r){var n=R(e,4),i=n[0],a=n[1],s=n[2],o=n[3];if(t==="none")return[];if(Lt(t))return t.map(function(g){return Yc(g,[i,a,s,o],r)[0]});var l=R((t||"top").split("-"),2),c=l[0],u=l[1],d=[i,a];c==="left"?d=[s,i]:c==="right"?d=[a,o]:c==="bottom"&&(d=[o,s]);var f=[(d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2],p=ou(d,r);if(u){var v=u==="top"||u==="left",h=c==="bottom"||c==="left";f=d[v&&!h||!v&&h?0:1]}return[[f,p]]}function Mo(t,e){if(e.isRequest)return e.requestAble==="rotatable";var r=e.inputEvent.target;if(Gt(r,nt("rotation-control"))||t.props.rotateAroundControls&&Gt(r,nt("around-control"))||Gt(r,nt("control"))&&Gt(r,nt("rotatable")))return!0;var n=t.props.rotationTarget;return n?Ko(n,!0).some(function(i){return i?r===i||r.contains(i):!1}):!1}var Eg=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,Cg={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[Eg],viewClassName:function(t){return t.isDragging("rotatable")?nt("view-rotation-dragging"):""},render:function(t,e){var r=yr(t.props,"rotatable"),n=r.rotatable,i=r.rotationPosition,a=r.zoom,s=r.renderDirections,o=r.rotateAroundControls,l=r.resolveAblesWithRotatable,c=t.getState(),u=c.renderPoses,d=c.direction;if(!n)return null;var f=Yc(i,u,d),p=[];if(f.forEach(function(m,b){var E=R(m,2),C=E[0],x=E[1];p.push(e.createElement("div",{key:"rotation".concat(b),className:nt("rotation"),style:{transform:"translate(-50%) translate(".concat(C[0],"px, ").concat(C[1],"px) rotate(").concat(x,"rad)")}},e.createElement("div",{className:nt("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:nt("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),s){var v=_e(l||{}),h={};v.forEach(function(m){l[m].forEach(function(b){h[b]=m})});var g=[];Lt(s)&&(g=s.map(function(m){var b=h[m];return{data:b?{resolve:b}:{},classNames:b?["move"]:[],dir:m}})),p.push.apply(p,$([],R(gc(t,"rotatable",g,e)),!1))}return o&&p.push.apply(p,$([],R(Cc(t,e)),!1)),p},dragControlCondition:Mo,dragControlStart:function(t,e){var r,n,i=e.datas,a=e.clientX,s=e.clientY,o=e.parentRotate,l=e.parentFlag,c=e.isPinch,u=e.isRequest,d=t.state,f=d.target,p=d.left,v=d.top,h=d.direction,g=d.beforeDirection,m=d.targetTransform,b=d.moveableClientRect,E=d.offsetMatrix,C=d.targetMatrix,x=d.allMatrix,S=d.width,w=d.height;if(!u&&!f)return!1;var D=t.getRect();i.rect=D,i.transform=m,i.left=p,i.top=v;var T=function(Z){var U=Kc(t.state,Z);i.fixedDirection=U.fixedDirection,i.fixedOffset=U.fixedOffset,i.fixedPosition=U.fixedPosition,z&&z.setFixedPosition(Z)},A=function(Z){var U=bg(t.state,Z);i.fixedDirection=U.fixedDirection,i.fixedOffset=U.fixedOffset,i.fixedPosition=U.fixedPosition,z&&z.setFixedDirection(Z)},M=a,P=s;if(u||c||l){var k=o||0;i.beforeInfo={origin:D.beforeOrigin,prevDeg:k,defaultDeg:k,prevSnapDeg:0,startDist:0},i.afterInfo=O(O({},i.beforeInfo),{origin:D.origin}),i.absoluteInfo=O(O({},i.beforeInfo),{origin:D.origin,startValue:k})}else{var _=(n=e.inputEvent)===null||n===void 0?void 0:n.target;if(_){var N=_.getAttribute("data-direction")||"",I=Ah[N];if(I){i.isControl=!0,i.isAroundControl=Gt(_,nt("around-control")),i.controlDirection=I;var B=_.getAttribute("data-resolve");B&&(i.resolveAble=B);var L=Zg(d.rootMatrix,d.renderPoses,b);r=R(Xt(L,I),2),M=r[0],P=r[1]}}i.beforeInfo={origin:D.beforeOrigin},i.afterInfo={origin:D.origin},i.absoluteInfo={origin:D.origin,startValue:D.rotation};var G=T;T=function(Z){var U=d.is3d?4:3,q=R(yt(Xl(C,U),Z),2),et=q[0],at=q[1],ot=jt(E,lr([et,at],U)),V=jt(x,lr([Z[0],Z[1]],U));G(Z);var tt=d.posDelta;i.beforeInfo.origin=it(ot,tt),i.afterInfo.origin=it(V,tt),i.absoluteInfo.origin=it(V,tt),wo(t,i.beforeInfo,M,P,b),wo(t,i.afterInfo,M,P,b),wo(t,i.absoluteInfo,M,P,b)},A=function(Z){var U=Xt([[0,0],[S,0],[0,w],[S,w]],Z);T(U)}}i.startClientX=M,i.startClientY=P,i.direction=h,i.beforeDirection=g,i.startValue=0,i.datas={},Ai(t,e,"rotate");var W=!1,z=!1;if(i.isControl&&i.resolveAble){var X=i.resolveAble;X==="resizable"&&(z=Do.dragControlStart(t,O(O({},new Ir("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}z||(W=te.dragStart(t,new Ir().dragStart([0,0],e))),T(Qg(t));var j=dt(t,e,O(O({set:function(Z){i.startValue=Z*Math.PI/180},setFixedDirection:A,setFixedPosition:T},Ti(t,e)),{dragStart:W,resizeStart:z})),Y=J(t,"onRotateStart",j);return i.isRotate=Y!==!1,d.snapRenderInfo={request:e.isRequest},i.isRotate?j:!1},dragControl:function(t,e){var r,n,i,a=e.datas,s=e.clientDistX,o=e.clientDistY,l=e.parentRotate,c=e.parentFlag,u=e.isPinch,d=e.groupDelta,f=e.resolveMatrix,p=a.beforeDirection,v=a.beforeInfo,h=a.afterInfo,g=a.absoluteInfo,m=a.isRotate,b=a.startValue,E=a.rect,C=a.startClientX,x=a.startClientY;if(m){Di(t,e,"rotate");var S=Mh(e),w=p*S,D=t.props.parentMoveable,T=0,A,M,P=0,k,_,N=0,I,B,L=180/Math.PI*b,G=g.startValue,W=!1,z=C+s,X=x+o;if(!c&&"parentDist"in e){var j=e.parentDist;A=j,k=j,I=j}else u||c?(A=Ii(l,p,v),k=Ii(l,w,h),I=Ii(l,w,g)):(A=To(z,X,p,v),k=To(z,X,w,h),I=To(z,X,w,g),W=!0);if(M=L+A,_=L+k,B=G+I,J(t,"onBeforeRotate",dt(t,e,{beforeRotation:M,rotation:_,absoluteRotation:B,setRotation:function(gt){k=gt-L,A=k,I=k}},!0)),r=R(Ao(t,E,v,A,L,W),3),T=r[0],A=r[1],M=r[2],n=R(Ao(t,E,h,k,L,W),3),P=n[0],k=n[1],_=n[2],i=R(Ao(t,E,g,I,G,W),3),N=i[0],I=i[1],B=i[2],!(!N&&!P&&!T&&!D&&!f)){var Y=wi(a,"rotate(".concat(_,"deg)"),"rotate(".concat(k,"deg)"));f&&(a.fixedPosition=ho(t,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var Z=Gh(t,k,a),U=it(yt(d||[0,0],Z),a.prevInverseDist||[0,0]);a.prevInverseDist=Z,a.requestValue=null;var q=pc(t,Y,U,u,e),et=q,at=Ne([z,X],g.startAbsoluteOrigin)-g.startDist,ot=void 0;if(a.resolveAble==="resizable"){var V=Do.dragControl(t,O(O({},An(e,t.state,[e.deltaX,e.deltaY],!!u,!1,"resizable")),{resolveMatrix:!0,parentDistance:at}));V&&(ot=V,et=uu(et,V,e))}var tt=dt(t,e,O(O({delta:P,dist:k,rotate:_,rotation:_,beforeDist:A,beforeDelta:T,beforeRotate:M,beforeRotation:M,absoluteDist:I,absoluteDelta:N,absoluteRotate:B,absoluteRotation:B,isPinch:!!u,resize:ot},q),et));return J(t,"onRotate",tt),tt}}},dragControlEnd:function(t,e){var r=e.datas;if(r.isRotate){r.isRotate=!1;var n=pe(t,e,{});return J(t,"onRotateEnd",n),n}},dragGroupControlCondition:Mo,dragGroupControlStart:function(t,e){var r=e.datas,n=t.state,i=n.left,a=n.top,s=n.beforeOrigin,o=this.dragControlStart(t,e);if(!o)return!1;o.set(r.beforeDirection*t.rotation);var l=Ke(t,this,"dragControlStart",e,function(d,f){var p=d.state,v=p.left,h=p.top,g=p.beforeOrigin,m=yt(it([v,h],[i,a]),it(g,s));return f.datas.startGroupClient=m,f.datas.groupClient=m,O(O({},f),{parentRotate:0})}),c=O(O({},o),{targets:t.props.targets,events:l}),u=J(t,"onRotateGroupStart",c);return r.isRotate=u!==!1,r.isRotate?o:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isRotate){Yi(t,"onBeforeRotate",function(c){J(t,"onBeforeRotateGroup",dt(t,e,O(O({},c),{targets:t.props.targets}),!0))});var n=this.dragControl(t,e);if(n){var i=r.beforeDirection,a=n.beforeDist,s=a/180*Math.PI,o=Ke(t,this,"dragControl",e,function(c,u){var d=u.datas.startGroupClient,f=R(u.datas.groupClient,2),p=f[0],v=f[1],h=R(En(d,s*i),2),g=h[0],m=h[1],b=[g-p,m-v];return u.datas.groupClient=[g,m],O(O({},u),{parentRotate:a,groupDelta:b})});t.rotation=i*n.beforeRotation;var l=O({targets:t.props.targets,events:o,set:function(c){t.rotation=c},setGroupRotation:function(c){t.rotation=c}},n);return J(t,"onRotateGroup",l),l}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isRotate){this.dragControlEnd(t,e);var i=Ke(t,this,"dragControlEnd",e),a=pe(t,e,{targets:t.props.targets,events:i});return J(t,"onRotateGroupEnd",a),r}},request:function(t){var e={},r=0,n=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?r+=i.deltaRotate:"rotate"in i&&(r=i.rotate-n),{datas:e,parentDist:r}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function Sg(t,e){var r,n=t.direction,i=t.classNames,a=t.size,s=t.pos,o=t.zoom,l=t.key,c=n==="horizontal",u=c?"Y":"X";return e.createElement("div",{key:l,className:i.join(" "),style:(r={},r[c?"width":"height"]="".concat(a),r.transform="translate(".concat(s[0],", ").concat(s[1],") translate").concat(u,"(-50%) scale").concat(u,"(").concat(o,")"),r)})}function ko(t,e){return Sg(O(O({},t),{classNames:$([nt("line","guideline",t.direction)],R(t.classNames),!1).filter(function(r){return r}),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map(function(r){return"".concat(ct(r,.1),"px")})}),e)}function Xc(t,e,r,n,i,a,s,o){var l=t.props.zoom;return r.map(function(c,u){var d=c.type,f=c.pos,p=[0,0];return p[s]=n,p[s?0:1]=-i+f,ko({key:"".concat(e,"TargetGuideline").concat(u),classNames:[nt("target","bold",d)],posValue:p,sizeValue:a,zoom:l,direction:e},o)})}function Hc(t,e,r,n,i,a){var s=t.props,o=s.zoom,l=s.isDisplayInnerSnapDigit,c=e==="horizontal"?Ze:Qe,u=i[c.start],d=i[c.end];return r.filter(function(f){var p=f.hide,v=f.elementRect;if(p)return!1;if(l&&v){var h=v.rect;if(h[c.start]<=u&&d<=h[c.end])return!1}return!0}).map(function(f,p){var v=f.pos,h=f.size,g=f.element,m=f.className,b=[-n[0]+v[0],-n[1]+v[1]];return ko({key:"".concat(e,"-default-guideline-").concat(p),classNames:g?[nt("bold"),m]:[nt("normal"),m],direction:e,posValue:b,sizeValue:h,zoom:o},a)})}function Pn(t,e,r,n,i,a,s,o){var l,c=t.props,u=c.snapDigit,d=u===void 0?0:u,f=c.isDisplaySnapDigit,p=f===void 0?!0:f,v=c.snapDistFormat,h=v===void 0?function(x,S){return x}:v,g=c.zoom,m=e==="horizontal"?"X":"Y",b=e==="vertical"?"height":"width",E=Math.abs(i),C=p?parseFloat(E.toFixed(d)):0;return o.createElement("div",{key:"".concat(e,"-").concat(r,"-guideline-").concat(n),className:nt("guideline-group",e),style:(l={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},l[b]="".concat(E,"px"),l)},ko({direction:e,classNames:[nt(r),s],size:"100%",posValue:[0,0],sizeValue:E,zoom:g},o),o.createElement("div",{className:nt("size-value","gap"),style:{transform:"translate".concat(m,"(-50%) scale(").concat(g,")")}},C>0?h(C,e):""))}function xg(t,e,r,n){var i=t==="vertical"?0:1,a=t==="vertical"?1:0,s=i?Ze:Qe,o=r[s.start],l=r[s.end];return fu(e,function(c){return c.pos[i]}).map(function(c){var u=[],d=[],f=[];return c.forEach(function(p){var v,h,g=p.element,m=p.elementRect.rect;if(m[s.end]<o)u.push(p);else if(l<m[s.start])d.push(p);else if(m[s.start]<=o&&l<=m[s.end]&&n){var b=p.pos,E={element:g,rect:O(O({},m),(v={},v[s.end]=m[s.start],v))},C={element:g,rect:O(O({},m),(h={},h[s.start]=m[s.end],h))},x=[0,0],S=[0,0];x[i]=b[i],x[a]=b[a],S[i]=b[i],S[a]=b[a]+p.size,u.push({type:t,pos:x,size:0,elementRect:E,direction:"",elementDirection:"end"}),d.push({type:t,pos:S,size:0,elementRect:C,direction:"",elementDirection:"start"})}}),u.sort(function(p,v){return v.pos[a]-p.pos[a]}),d.sort(function(p,v){return p.pos[a]-v.pos[a]}),{total:c,start:u,end:d,inner:f}})}function Dg(t,e,r,n,i){var a=t.props.isDisplayInnerSnapDigit,s=[];return["vertical","horizontal"].forEach(function(o){var l=e.filter(function(g){return g.type===o}),c=o==="vertical"?1:0,u=c?0:1,d=xg(o,l,n,a),f=c?Qe:Ze,p=c?Ze:Qe,v=n[f.start],h=n[f.end];d.forEach(function(g){var m=g.total,b=g.start,E=g.end,C=g.inner,x=r[u]+m[0].pos[u]-n[p.start],S=n;b.forEach(function(w){var D=w.elementRect.rect,T=S[f.start]-D[f.end];if(T>0){var A=[0,0];A[c]=r[c]+S[f.start]-v-T,A[u]=x,s.push(Pn(t,o,"dashed",s.length,T,A,w.className,i))}S=D}),S=n,E.forEach(function(w){var D=w.elementRect.rect,T=D[f.start]-S[f.end];if(T>0){var A=[0,0];A[c]=r[c]+S[f.end]-v,A[u]=x,s.push(Pn(t,o,"dashed",s.length,T,A,w.className,i))}S=D}),C.forEach(function(w){var D=w.elementRect.rect,T=v-D[f.start],A=D[f.end]-h,M=[0,0],P=[0,0];M[c]=r[c]-T,M[u]=x,P[c]=r[c]+h-v,P[u]=x,s.push(Pn(t,o,"dashed",s.length,T,M,w.className,i)),s.push(Pn(t,o,"dashed",s.length,A,P,w.className,i))})})}),s}function wg(t,e,r,n,i){var a=[];return["horizontal","vertical"].forEach(function(s){var o=e.filter(function(g){return g.type===s}).slice(0,1),l=s==="vertical"?0:1,c=l?0:1,u=l?Qe:Ze,d=l?Ze:Qe,f=n[u.start],p=n[u.end],v=n[d.start],h=n[d.end];o.forEach(function(g){var m=g.gap,b=g.gapRects,E=Math.max.apply(Math,$([v],R(b.map(function(S){var w=S.rect;return w[d.start]})),!1)),C=Math.min.apply(Math,$([h],R(b.map(function(S){var w=S.rect;return w[d.end]})),!1)),x=(E+C)/2;E===C||x===(v+h)/2||b.forEach(function(S){var w=S.rect,D=S.className,T=[r[0],r[1]];if(w[u.end]<f)T[l]+=w[u.end]-f;else if(p<w[u.start])T[l]+=w[u.start]-f-m;else return;T[c]+=x-v,a.push(Pn(t,l?"vertical":"horizontal","gap",a.length,m,T,D,i))})})}),a}function Po(t){var e,r,n=t.state,i=n.containerClientRect,a=n.hasFixed,s=i.overflow,o=i.scrollHeight,l=i.scrollWidth,c=i.clientHeight,u=i.clientWidth,d=i.clientLeft,f=i.clientTop,p=t.props,v=p.snapGap,h=v===void 0?!0:v,g=p.verticalGuidelines,m=p.horizontalGuidelines,b=p.snapThreshold,E=b===void 0?5:b,C=p.maxSnapElementGuidelineDistance,x=C===void 0?1/0:C,S=p.isDisplayGridGuidelines,w=me(be(t.state)),D=w.top,T=w.left,A=w.bottom,M=w.right,P={top:D,left:T,bottom:A,right:M,center:(T+M)/2,middle:(D+A)/2},k=kg(t),_=$([],R(k),!1),N=((r=(e=n.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&r!==void 0?r:[1,1]).map(function(G){return G*E});h&&_.push.apply(_,$([],R(Tg(t,P,N)),!1));var I=O({},n.snapOffset||{left:0,top:0,bottom:0,right:0});if(_.push.apply(_,$([],R(Mg(t,s?l:u,s?o:c,d,f,I,S)),!1)),a){var B=i.left,L=i.top;I.left+=B,I.top+=L,I.right+=B,I.bottom+=L}return _.push.apply(_,$([],R(jc(m||!1,g||!1,s?l:u,s?o:c,d,f,I)),!1)),_=_.filter(function(G){var W=G.element,z=G.elementRect,X=G.type;if(!W||!z)return!0;var j=z.rect;return Vc(P,j,X,x)}),_}function Tg(t,e,r){var n=t.props,i=n.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,s=n.maxSnapElementGapDistance,o=s===void 0?1/0:s,l=t.state.elementRects,c=[];return[["vertical",Ze,Qe],["horizontal",Qe,Ze]].forEach(function(u){var d=R(u,3),f=d[0],p=d[1],v=d[2],h=e[p.start],g=e[p.end],m=e[p.center],b=e[v.start],E=e[v.end],C={left:r[0],top:r[1]};function x(D){var T=D.rect,A=C[p.start];return T[p.end]<h+A?h-T[p.end]:g-A<T[p.start]?T[p.start]-g:-1}var S=l.filter(function(D){var T=D.rect;return T[v.start]>E||T[v.end]<b?!1:x(D)>0}).sort(function(D,T){return x(D)-x(T)}),w=[];S.forEach(function(D){S.forEach(function(T){if(D!==T){var A=D.rect,M=T.rect,P=A[v.start],k=A[v.end],_=M[v.start],N=M[v.end];P>N||_>k||w.push([D,T])}})}),w.forEach(function(D){var T=R(D,2),A=T[0],M=T[1],P=A.rect,k=M.rect,_=P[p.start],N=P[p.end],I=k[p.start],B=k[p.end],L=C[p.start],G=0,W=0,z=!1,X=!1,j=!1;if(N<=h&&g<=I){if(X=!0,G=(I-N-(g-h))/2,W=N+G+(g-h)/2,F(W-m)>L)return}else if(N<I&&B<h+L){if(z=!0,G=I-N,W=B+G,F(W-h)>L)return}else if(N<I&&g-L<_){if(j=!0,G=I-N,W=_-G,F(W-g)>L)return}else return;G&&Vc(e,k,f,a)&&(G>o||c.push({type:f,pos:f==="vertical"?[W,0]:[0,W],element:M.element,size:0,className:M.className,isStart:z,isCenter:X,isEnd:j,gap:G,hide:!0,gapRects:[A,M],direction:"",elementDirection:""}))})}),c}function Ag(t,e,r,n){var i,a,s=t.props,o=t.state,l=s.snapGridAll,c=s.snapGridWidth,u=c===void 0?0:c,d=s.snapGridHeight,f=d===void 0?0:d,p=o.snapRenderInfo,v=p&&(((i=p.direction)===null||i===void 0?void 0:i[0])||((a=p.direction)===null||a===void 0?void 0:a[1])),h=t.moveables;if(l&&h&&v&&(u||f)){if(o.snapThresholdInfo)return;o.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var g=t.getRect(),m=g.children,b=p.direction;if(m){var E=b.map(function(x,S){var w=S===0?{snapSize:u,posName:"left",sizeName:"width",clientOffset:n.left-e}:{snapSize:f,posName:"top",sizeName:"height",clientOffset:n.top-r},D=w.snapSize,T=w.posName,A=w.sizeName,M=w.clientOffset;if(!D)return{dir:x,multiple:1,snapSize:D,snapOffset:0};var P=g[A],k=g[T],_=vl(m.map(function(z){return[z[T]-k,z[A],P-z[A]-z[T]+k]})).filter(function(z){return z}).sort(function(z,X){return z-X}),N=_[0],I=_.map(function(z){return ct(z/N,.1)*D}),B=1,L=ct(P/N,.1);for(B=1;B<=10&&!I.every(function(z){return z*B%1===0});++B);var G=(-x+1)/2,W=ni(k-M,k-M+P,G,1-G);return{multiple:L*B,dir:x,snapSize:D,snapOffset:Math.round(W/D)}}),C=E.map(function(x){return x.multiple||1});o.snapThresholdInfo.multiples=C,o.snapThresholdInfo.offset=E.map(function(x){return x.snapOffset}),E.forEach(function(x,S){x.snapSize})}}else o.snapThresholdInfo=null}function Mg(t,e,r,n,i,a,s){n===void 0&&(n=0),i===void 0&&(i=0);var o=t.props,l=t.state,c=o.snapGridWidth,u=c===void 0?0:c,d=o.snapGridHeight,f=d===void 0?0:d,p=[],v=a.left,h=a.top,g=[0,0];Ag(t,n,i,a);var m=l.snapThresholdInfo,b=u,E=f;if(m&&(u*=m.multiples[0]||1,f*=m.multiples[1]||1,g=m.offset),f){for(var C=function(S){p.push({type:"horizontal",pos:[v,ct(g[1]*E+S-i+h,.1)],className:nt("grid-guideline"),size:e,hide:!s,direction:"",grid:!0})},x=0;x<=r*2;x+=f)C(x);for(var x=-f;x>=-r;x-=f)C(x)}if(u){for(var C=function(w){p.push({type:"vertical",pos:[ct(g[0]*b+w-n+v,.1),h],className:nt("grid-guideline"),size:r,hide:!s,direction:"",grid:!0})},x=0;x<=e*2;x+=u)C(x);for(var x=-u;x>=-e;x-=u)C(x)}return p}function Vc(t,e,r,n){return r==="horizontal"?F(t.right-e.left)<=n||F(t.left-e.right)<=n||t.left<=e.right&&e.left<=t.right:r==="vertical"?F(t.bottom-e.top)<=n||F(t.top-e.bottom)<=n||t.top<=e.bottom&&e.top<=t.bottom:!0}function kg(t){var e=t.state,r=t.props.elementGuidelines,n=r===void 0?[]:r;if(!n.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(f){return!f.refresh}),a=n.map(function(f){return de(f)&&"element"in f?O(O({},f),{element:ze(f.element,!0)}):{element:ze(f,!0)}}).filter(function(f){return f.element}),s=_r(i.map(function(f){return f.element}),a.map(function(f){return f.element})),o=s.maintained,l=s.added,c=[];o.forEach(function(f){var p=R(f,2),v=p[0],h=p[1];c[h]=i[v]}),Pg(t,l.map(function(f){return a[f]})).map(function(f,p){c[l[p]]=f}),e.elementRects=c;var u=yo(t.props.elementSnapDirections),d=[];return c.forEach(function(f){var p=f.element,v=f.top,h=v===void 0?u.top:v,g=f.left,m=g===void 0?u.left:g,b=f.right,E=b===void 0?u.right:b,C=f.bottom,x=C===void 0?u.bottom:C,S=f.center,w=S===void 0?u.center:S,D=f.middle,T=D===void 0?u.middle:D,A=f.className,M=f.rect,P=bo({top:h,right:E,left:m,bottom:x,center:w,middle:T},M),k=P.horizontal,_=P.vertical,N=P.horizontalNames,I=P.verticalNames,B=M.top,L=M.left,G=M.right-L,W=M.bottom-B,z=[G,W];_.forEach(function(X,j){d.push({type:"vertical",element:p,pos:[ct(X,.1),B],size:W,sizes:z,className:A,elementRect:f,elementDirection:Dc[I[j]]||I[j],direction:""})}),k.forEach(function(X,j){d.push({type:"horizontal",element:p,pos:[L,ct(X,.1)],size:G,sizes:z,className:A,elementRect:f,elementDirection:Dc[N[j]]||N[j],direction:""})})}),d}function $c(t,e){return t?t.map(function(r){var n=de(r)?r:{pos:r},i=n.pos;return Pr(i)?n:O(O({},n),{pos:xt(i,e)})}):[]}function jc(t,e,r,n,i,a,s){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s={left:0,top:0,right:0,bottom:0});var o=[],l=s.left,c=s.top,u=s.bottom,d=s.right,f=r+d-l,p=n+u-c;return $c(t,p).forEach(function(v){o.push({type:"horizontal",pos:[l,ct(v.pos-a+c,.1)],size:f,className:v.className,direction:""})}),$c(e,f).forEach(function(v){o.push({type:"vertical",pos:[ct(v.pos-i+l,.1),c],size:p,className:v.className,direction:""})}),o}function Pg(t,e){if(!e.length)return[];var r=t.props.groupable,n=t.state,i=n.containerClientRect,a=n.rootMatrix,s=n.is3d,o=n.offsetDelta,l=s?4:3,c=R(tg(a,i,l),2),u=c[0],d=c[1],f=r?0:o[0],p=r?0:o[1];return e.map(function(v){var h=v.element.getBoundingClientRect(),g=h.left-u-f,m=h.top-d-p,b=m+h.height,E=g+h.width,C=R(Vr(a,[g,m],l),2),x=C[0],S=C[1],w=R(Vr(a,[E,b],l),2),D=w[0],T=w[1];return O(O({},v),{rect:{left:x,right:D,top:S,bottom:T,center:(x+D)/2,middle:(S+T)/2}})})}function Bi(t){var e=t.state,r=e.container,n=t.props.snapContainer||r;if(e.snapContainer===n&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(r!==n){var s=ze(n,!0);if(s){var o=Ln(s),l=hu(e,[o.left-i.left,o.top-i.top]),c=hu(e,[o.right-i.right,o.bottom-i.bottom]);a.left=ct(l[0],1e-5),a.top=ct(l[1],1e-5),a.right=ct(c[0],1e-5),a.bottom=ct(c[1],1e-5)}}return e.snapContainer=n,e.snapOffset=a,e.guidelines=Po(t),e.enableSnap=!0,!0}function Uc(t,e,r,n,i,a){var s=mr(t,e,r,a?4:3),o=Xt(s,n);return Lo(s,it(i,o))}function Zc(t){return t?t/F(t):0}function Og(t,e,r,n,i,a){var s=a.fixedDirection,o=ig(r,s,n),l=So(t,e,r,n),c=$($([],R(gg(t,e,o,n,i,a)),!1),R(zc(t,l,a)),!1),u=Ni(c,0),d=Ni(c,1);return{width:{isBound:u.isBound,offset:u.offset[0]},height:{isBound:d.isBound,offset:d.offset[1]}}}function Rg(t,e,r,n,i,a,s,o,l){var c=Xt(e,s),u=zi(t,o,{vertical:[c[0]],horizontal:[c[1]]}),d=u.horizontal.offset,f=u.vertical.offset;if(ct(f,lo)||ct(d,lo)){var p=R(Le({datas:l,distX:-f,distY:-d}),2),v=p[0],h=p[1],g=Math.min(i||1/0,r+s[0]*v),m=Math.min(a||1/0,n+s[1]*h);return[g-r,m-n]}return[0,0]}function Qc(t,e,r,n,i,a,s,o){for(var l=be(t.state),c=t.props.keepRatio,u=0,d=0,f=0;f<2;++f){var p=e(u,d),v=Og(t,p,i,c,s,o),h=v.width,g=v.height,m=h.isBound,b=g.isBound,E=h.offset,C=g.offset;if(f===1&&(m||(E=0),b||(C=0)),f===0&&s&&!m&&!b)return[0,0];if(c){var x=F(E)*(r?1/r:1),S=F(C)*(n?1/n:1),w=m&&b?x<S:b||!m&&x<S;w?E=r*C/n:C=n*E/r}u+=E,d+=C}if(!c&&i[0]&&i[1]){var D=yg(t,l,i,a,o),T=D.maxWidth,A=D.maxHeight,M=R(Rg(t,e(u,d).map(function(_){return _.map(function(N){return ct(N,lo)})}),r+u,n+d,T,A,i,s,o),2),E=M[0],C=M[1];u+=E,d+=C}return[u,d]}function On(t){return t<0&&(t=t%360+360),t%=360,t}function _g(t,e){e=On(e);var r=Math.floor(t/360),n=r*360+360-e,i=r*360+e;return F(t-n)<F(t-i)?n:i}function Oo(t,e){t=On(t),e=On(e);var r=On(t-e);return Math.min(r,360-r)}function Ng(t,e,r,n){var i,a=t.props,s=(i=a[wc])!==null&&i!==void 0?i:5,o=a[Tc];if(Yr(t,"rotatable")){var l=e.pos1,c=e.pos2,u=e.pos3,d=e.pos4,f=e.origin,p=r*Math.PI/180,v=[l,c,u,d].map(function(C){return it(C,f)}),h=v.map(function(C){return En(C,p)}),g=$($([],R(Zh(t,v,h,f,r)),!1),R(ug(t,v,h,f,r)),!1);g.sort(function(C,x){return F(C-r)-F(x-r)});var m=g.length>0;if(m)return{isSnap:m,dist:m?g[0]:r}}if(o?.length&&s){var b=o.slice().sort(function(C,x){return Oo(C,n)-Oo(x,n)}),E=b[0];if(Oo(E,n)<=s)return{isSnap:!0,dist:r+_g(n,E)-n}}return{isSnap:!1,dist:r}}function Lg(t,e,r,n,i,a,s){if(!Yr(t,"resizable"))return[0,0];var o=s.fixedDirection,l=s.nextAllMatrix,c=t.state,u=c.allMatrix,d=c.is3d;return Qc(t,function(f,p){return Uc(l||u,e+f,r+p,o,i,d)},e,r,n,i,a,s)}function zg(t,e,r,n,i){if(!Yr(t,"scalable"))return[0,0];var a=i.startOffsetWidth,s=i.startOffsetHeight,o=i.fixedPosition,l=i.fixedDirection,c=i.is3d,u=Qc(t,function(d,f){return Uc(Lh(i,yt(e,[d/a,f/s])),a,s,l,o,c)},a,s,r,o,n,i);return[u[0]/a,u[1]/s]}function Ig(t,e){e.absolutePoses=be(t.state)}function qc(t){var e=[];return t.forEach(function(r){r.guidelineInfos.forEach(function(n){var i=n.guideline;ae(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:r}))})}),e.map(function(r){var n=r.guideline,i=r.posInfo;return O(O({},n),{direction:i.direction})})}function Jc(t,e,r,n,i,a){var s=mo(Ri(t,a),e,r),o=s.vertical,l=s.horizontal,c=Wr();o.forEach(function(v){v.isBound&&(v.direction==="start"&&(c.left=!0),v.direction==="end"&&(c.right=!0),n.push({type:"bounds",pos:v.pos}))}),l.forEach(function(v){v.isBound&&(v.direction==="start"&&(c.top=!0),v.direction==="end"&&(c.bottom=!0),i.push({type:"bounds",pos:v.pos}))});var u=dg(t),d=u.boundMap,f=u.vertical,p=u.horizontal;return f.forEach(function(v){Fe(n,function(h){var g=h.type,m=h.pos;return g==="bounds"&&m===v})>=0||n.push({type:"bounds",pos:v})}),p.forEach(function(v){Fe(i,function(h){var g=h.type,m=h.pos;return g==="bounds"&&m===v})>=0||i.push({type:"bounds",pos:v})}),{boundMap:c,innerBoundMap:d}}var Bg=Fo("",["resizable","scalable"]),Gg={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",wc,Tc,Ac,Mc,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(t,e){var r=t.state,n=r.top,i=r.left,a=r.pos1,s=r.pos2,o=r.pos3,l=r.pos4,c=r.snapRenderInfo,u=t.props.snapRenderThreshold,d=u===void 0?1:u;if(!c||!c.render||!Yr(t,""))return $r(t,"boundMap",Wr(),function(Y){return JSON.stringify(Y)}),$r(t,"innerBoundMap",Wr(),function(Y){return JSON.stringify(Y)}),[];r.guidelines=Po(t);var f=Math.min(a[0],s[0],o[0],l[0]),p=Math.min(a[1],s[1],o[1],l[1]),v=c.externalPoses||[],h=be(t.state),g=[],m=[],b=[],E=[],C=[],x=me(h),S=x.width,w=x.height,D=x.top,T=x.left,A=x.bottom,M=x.right,P={left:T,right:M,top:D,bottom:A,center:(T+M)/2,middle:(D+A)/2},k=v.length>0,_=k?me(v):{};if(!c.request){if(c.direction&&C.push(ng(t,h,c.direction,d,d)),c.snap){var N=me(h);c.center&&(N.middle=(N.top+N.bottom)/2,N.center=(N.left+N.right)/2),C.push(Pc(t,N,d,d))}k&&(c.center&&(_.middle=(_.top+_.bottom)/2,_.center=(_.left+_.right)/2),C.push(Pc(t,_,d,d))),C.forEach(function(Y){var Z=Y.vertical.posInfos,U=Y.horizontal.posInfos;g.push.apply(g,$([],R(Z.filter(function(q){var et=q.guidelineInfos;return et.some(function(at){var ot=at.guideline;return!ot.hide})}).map(function(q){return{type:"snap",pos:q.pos}})),!1)),m.push.apply(m,$([],R(U.filter(function(q){var et=q.guidelineInfos;return et.some(function(at){var ot=at.guideline;return!ot.hide})}).map(function(q){return{type:"snap",pos:q.pos}})),!1)),b.push.apply(b,$([],R(qc(Z)),!1)),E.push.apply(E,$([],R(qc(U)),!1))})}var I=Jc(t,[T,M],[D,A],g,m),B=I.boundMap,L=I.innerBoundMap;k&&Jc(t,[_.left,_.right],[_.top,_.bottom],g,m,c.externalBounds);var G=$($([],R(b),!1),R(E),!1),W=G.filter(function(Y){return Y.element&&!Y.gapRects}),z=G.filter(function(Y){return Y.gapRects}).sort(function(Y,Z){return Y.gap-Z.gap});J(t,"onSnap",{guidelines:G.filter(function(Y){var Z=Y.element;return!Z}),elements:W,gaps:z},!0);var X=$r(t,"boundMap",B,function(Y){return JSON.stringify(Y)},Wr()),j=$r(t,"innerBoundMap",L,function(Y){return JSON.stringify(Y)},Wr());return(B===X||L===j)&&J(t,"onBound",{bounds:B,innerBounds:L},!0),$($($($($($([],R(Dg(t,W,[f,p],P,e)),!1),R(wg(t,z,[f,p],P,e)),!1),R(Hc(t,"horizontal",E,[i,n],P,e)),!1),R(Hc(t,"vertical",b,[i,n],P,e)),!1),R(Xc(t,"horizontal",m,f,n,S,0,e)),!1),R(Xc(t,"vertical",g,p,i,w,1,e)),!1)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Bi(t)},drag:function(t){var e=t.state;Bi(t)||(e.guidelines=Po(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){if(Bg(t,e)||Mo(t,e))return!0;if(!e.isRequest&&e.inputEvent)return Gt(e.inputEvent.target,nt("snap-control"))},dragControlStart:function(t){t.state.snapRenderInfo=null,Bi(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,Bi(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function Fg(t,e){return[t[0]*e[0],t[1]*e[1]]}function nt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Pp.apply(void 0,$([so],R(t),!1))}function tu(t){t()}function Kg(t){return!t||t==="none"?[1,0,0,1,0,0]:de(t)?t:ur(t)}function Rn(t,e,r){return hi(e,cr(r,e),t,cr(r.map(function(n){return-n}),e))}function Wg(t,e,r){if(e==="%"){var n=_o(t.ownerSVGElement);return n[r?"width":"height"]/100}return 1}function Yg(t){var e=Xg(Io(t,":before"));return e.map(function(r,n){var i=sr(r),a=i.value,s=i.unit;return a*Wg(t,s,n===0)})}function Gi(t){return t?t.split(" "):["0","0"]}function Xg(t){return Gi(t.transformOrigin)}function eu(t){var e=se(t),r=e("transform");if(r&&r!=="none")return r;if("transform"in t){var n=t.transform,i=n.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var s=[],o=function(c){var u=i[c].matrix;s.push("matrix(".concat(["a","b","c","d","e","f"].map(function(d){return u[d]}).join(", "),")"))},l=0;l<a;++l)o(l);return s.join(" ")}return""}function _n(t,e,r,n,i){var a,s,o=Ta(t)||je(t),l=!1,c,u;if(!t||r)c=t;else{var d=(a=t?.assignedSlot)===null||a===void 0?void 0:a.parentElement,f=t.parentElement;d?(l=!0,u=f,c=d):c=f}for(var p=!1,v=t===e||c===e,h="relative",g=1,m=parseFloat(i?.("zoom"))||1,b=i?.("position");c&&c!==o;){e===c&&(v=!0);var E=se(c),C=c.tagName.toLowerCase(),x=eu(c),S=E("willChange"),w=parseFloat(E("zoom"))||1;if(h=E("position"),n&&w!==1){g=w;break}if(!r&&n&&m!==1&&b&&b!=="absolute"||C==="svg"||C==="foreignobject"||h!=="static"||x&&x!=="none"||S==="transform")break;var D=(s=t?.assignedSlot)===null||s===void 0?void 0:s.parentNode,T=c.parentNode;D&&(l=!0,u=T);var A=T;if(A&&A.nodeType===11){c=A.host,p=!0,h=se(c)("position");break}c=A,h="relative"}return{offsetZoom:g,hasSlot:l,parentSlotElement:u,isCustomElement:p,isStatic:h==="static",isEnd:v||!c||c===o,offsetParent:c||o}}function Hg(t,e){var r,n=t.tagName.toLowerCase(),i=t.offsetLeft,a=t.offsetTop,s=se(t),o=ii(i),l=!o,c,u;return!l&&(n!=="svg"||t.ownerSVGElement)?(c=nc?Yg(t):Gi(s("transformOrigin")).map(function(d){return parseFloat(d)}),u=c.slice(),l=!0,n==="svg"?(i=0,a=0):(r=R(jg(t,c,t===e&&e.tagName.toLowerCase()==="g"),4),i=r[0],a=r[1],c[0]=r[2],c[1]=r[3])):(c=Gi(s("transformOrigin")).map(function(d){return parseFloat(d)}),u=c.slice()),{tagName:n,isSVG:o,hasOffset:l,offset:[i||0,a||0],origin:c,targetOrigin:u}}function ru(t,e){var r=se(t),n=se(je(t)),i=n("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(n("marginLeft"),10),s=parseInt(n("marginTop"),10);return r("position")==="absolute"&&((r("top")!=="auto"||r("bottom")!=="auto")&&(s=0),(r("left")!=="auto"||r("right")!=="auto")&&(a=0)),[a,s]}function Ro(t){t.forEach(function(e){var r=e.matrix;r&&(e.matrix=Ae(r,3,4))})}function Vg(t){for(var e=t.parentElement,r=!1,n=je(t);e;){var i=Io(e).transform;if(i&&i!=="none"){r=!0;break}if(e===n)break;e=e.parentElement}return{fixedContainer:e||n,hasTransform:r}}function Fi(t,e){return e===void 0&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat(Hl(t,!e).join(","),")")}function _o(t){var e=t.clientWidth,r=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:r};var n=t.viewBox,i=n&&n.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||r,clientWidth:e,clientHeight:r}}function $g(t,e){var r,n=_o(t),i=n.width,a=n.height,s=n.clientWidth,o=n.clientHeight,l=s/i,c=o/a,u=t.preserveAspectRatio.baseVal,d=u.align,f=u.meetOrSlice,p=[0,0],v=[l,c],h=[0,0];if(d!==1){var g=(d-2)%3,m=Math.floor((d-2)/3);p[0]=i*g/2,p[1]=a*m/2;var b=f===2?Math.max(c,l):Math.min(l,c);v[0]=b,v[1]=b,h[0]=(s-i)/2*g,h[1]=(o-a)/2*m}var E=Wa(v,e);return r=R(h,2),E[e*(e-1)]=r[0],E[e*(e-1)+1]=r[1],Rn(E,e,p)}function jg(t,e,r){var n=t.tagName.toLowerCase();if(!t.getBBox||!r&&n==="g")return[0,0,0,0];var i=se(t),a=i("transform-box")==="fill-box",s=t.getBBox(),o=_o(t.ownerSVGElement),l=s.x,c=s.y;n==="foreignobject"&&!l&&!c&&(l=parseFloat(t.getAttribute("x"))||0,c=parseFloat(t.getAttribute("y"))||0);var u=l-o.x,d=c-o.y,f=a?e[0]:e[0]-u,p=a?e[1]:e[1]-d;return[u,d,f,p]}function Nt(t,e,r){return jt(t,lr(e,r),r)}function mr(t,e,r,n){return[[0,0],[e,0],[0,r],[e,r]].map(function(i){return Nt(t,i,n)})}function me(t){var e=t.map(function(c){return c[0]}),r=t.map(function(c){return c[1]}),n=Math.min.apply(Math,$([],R(e),!1)),i=Math.min.apply(Math,$([],R(r),!1)),a=Math.max.apply(Math,$([],R(e),!1)),s=Math.max.apply(Math,$([],R(r),!1)),o=a-n,l=s-i;return{left:n,top:i,right:a,bottom:s,width:o,height:l}}function nu(t,e,r,n){var i=mr(t,e,r,n);return me(i)}function Ug(t,e,r,n,i){var a,s=t.target,o=t.origin,l=e.matrix,c=au(s),u=c.offsetWidth,d=c.offsetHeight,f=r.getBoundingClientRect(),p=[0,0];r===je(r)&&(p=ru(s,!0));for(var v=s.getBoundingClientRect(),h=v.left-f.left+r.scrollLeft-(r.clientLeft||0)+p[0],g=v.top-f.top+r.scrollTop-(r.clientTop||0)+p[1],m=v.width,b=v.height,E=hi(n,i,l),C=nu(E,u,d,n),x=C.left,S=C.top,w=C.width,D=C.height,T=Nt(E,o,n),A=it(T,[x,S]),M=[h+A[0]*m/w,g+A[1]*b/D],P=[0,0],k=0;++k<10;){var _=Te(i,n);a=R(it(Nt(_,M,n),Nt(_,T,n)),2),P[0]=a[0],P[1]=a[1];var N=hi(n,i,cr(P,n),l),I=nu(N,u,d,n),B=I.left,L=I.top,G=B-h,W=L-g;if(F(G)<2&&F(W)<2)break;M[0]-=G,M[1]-=W}return P.map(function(z){return Math.round(z)})}function Zg(t,e,r){var n=t.length===16,i=n?4:3,a=e.map(function(l){return Nt(t,l,i)}),s=r.left,o=r.top;return a.map(function(l){return[l[0]+s,l[1]+o]})}function ye(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function iu(t,e){return ye([e[0]-t[0],e[1]-t[1]])}function Nn(t,e,r,n){r===void 0&&(r=1),n===void 0&&(n=It(t,e));var i=iu(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(n,"rad) scaleY(").concat(r,")"),width:"".concat(i,"px")}}function Ki(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=r.length,a=r.reduce(function(o,l){return o+l[0]},0)/i,s=r.reduce(function(o,l){return o+l[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(s,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function yr(t,e){var r=t[e];return de(r)?O(O({},t),r):t}function au(t){var e=t&&!ii(t.offsetWidth),r=0,n=0,i=0,a=0,s=0,o=0,l=0,c=0,u=0,d=0,f=0,p=0,v=1/0,h=1/0,g=1/0,m=1/0,b=0,E=0,C=!1;if(t)if(!e&&t.ownerSVGElement){var x=t.getBBox();C=!0,r=x.width,n=x.height,s=r,o=n,l=r,c=n,i=r,a=n}else{var S=se(t),w=t.style,D=S("boxSizing")==="border-box",T=parseFloat(S("borderLeftWidth"))||0,A=parseFloat(S("borderRightWidth"))||0,M=parseFloat(S("borderTopWidth"))||0,P=parseFloat(S("borderBottomWidth"))||0,k=parseFloat(S("paddingLeft"))||0,_=parseFloat(S("paddingRight"))||0,N=parseFloat(S("paddingTop"))||0,I=parseFloat(S("paddingBottom"))||0,B=k+_,L=N+I,G=T+A,W=M+P,z=B+G,X=L+W,j=S("position"),Y=0,Z=0;if("clientLeft"in t){var U=null;if(j==="absolute"){var q=_n(t,je(t));U=q.offsetParent}else U=t.parentElement;if(U){var et=se(U);Y=parseFloat(et("width")),Z=parseFloat(et("height"))}}u=Math.max(B,xt(S("minWidth"),Y)||0),d=Math.max(L,xt(S("minHeight"),Z)||0),v=xt(S("maxWidth"),Y),h=xt(S("maxHeight"),Z),isNaN(v)&&(v=1/0),isNaN(h)&&(h=1/0),b=xt(w.width,0)||0,E=xt(w.height,0)||0,s=parseFloat(S("width"))||0,o=parseFloat(S("height"))||0,l=F(s-b)<1?si(u,b||s,v):s,c=F(o-E)<1?si(d,E||o,h):o,r=l,n=c,i=l,a=c,D?(g=v,m=h,f=u,p=d,l=r-z,c=n-X):(g=v+z,m=h+X,f=u+z,p=d+X,r=l+z,n=c+X),i=l+B,a=c+L}return{svg:C,offsetWidth:r,offsetHeight:n,clientWidth:i,clientHeight:a,contentWidth:l,contentHeight:c,inlineCSSWidth:b,inlineCSSHeight:E,cssWidth:s,cssHeight:o,minWidth:u,minHeight:d,maxWidth:v,maxHeight:h,minOffsetWidth:f,minOffsetHeight:p,maxOffsetWidth:g,maxOffsetHeight:m}}function ou(t,e){return It(e>0?t[0]:t[1],e>0?t[1]:t[0])}function Wi(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function su(t,e){var r=t===je(t)||t===Ta(t),n={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return r&&(n.clientHeight=Math.max(e.height,n.clientHeight),n.scrollHeight=Math.max(e.height,n.scrollHeight)),n.overflow=se(t)("overflow")!=="visible",O(O({},e),n)}function No(t,e,r,n){var i=t.left,a=t.right,s=t.top,o=t.bottom,l=e.top,c=e.left,u={left:c+i,top:l+s,right:c+a,bottom:l+o,width:a-i,height:o-s};return r&&n?su(r,u):u}function Ln(t,e){var r=0,n=0,i=0,a=0;if(t){var s=t.getBoundingClientRect();r=s.left,n=s.top,i=s.width,a=s.height}var o={left:r,top:n,width:i,height:a,right:r+i,bottom:n+a};return t&&e?su(t,o):o}function Qg(t){var e=t.props,r=e.groupable,n=e.svgOrigin,i=t.getState(),a=i.offsetWidth,s=i.offsetHeight,o=i.svg,l=i.transformOrigin;return!r&&o&&n?Yo(n,a,s):l}function lu(t,e,r,n){var i;if(t)i=t;else if(e)i=[0,0];else{var a=r.target;i=cu(a,n)}return i}function cu(t,e){if(t){var r=t.getAttribute("data-rotation")||"",n=t.getAttribute("data-direction");if(e.deg=r,!!n){var i=[0,0];return n.indexOf("w")>-1&&(i[0]=-1),n.indexOf("e")>-1&&(i[0]=1),n.indexOf("n")>-1&&(i[1]=-1),n.indexOf("s")>-1&&(i[1]=1),i}}}function Lo(t,e){return[yt(e,t[0]),yt(e,t[1]),yt(e,t[2]),yt(e,t[3])]}function be(t){var e=t.left,r=t.top,n=t.pos1,i=t.pos2,a=t.pos3,s=t.pos4;return Lo([n,i,a,s],[e,r])}function zo(t,e){t[e?"controlAbles":"targetAbles"].forEach(function(r){r.unset&&r.unset(t)})}function Xr(t,e){var r=e?"controlGesto":"targetGesto",n=t[r];n?.isIdle()===!1&&zo(t,e),n?.unset(),t[r]=null}function ee(t,e){if(e){var r=Gr(e);r.nextStyle=O(O({},r.nextStyle),t)}return{style:t,cssText:_e(t).map(function(n){return"".concat(oi(n,"-"),": ").concat(t[n],";")}).join("")}}function uu(t,e,r){var n=e.afterTransform||e.transform;return O(O({},ee(O(O(O({},t.style),e.style),{transform:n}),r)),{afterTransform:n,transform:t.transform})}function dt(t,e,r,n){var i=e.datas;i.datas||(i.datas={});var a=O(O({},r),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var s;(s=e.stop)===null||s===void 0||s.call(e)}});return i.isStartEvent?n||(i.lastEvent=a):i.isStartEvent=!0,a}function pe(t,e,r){var n=e.datas,i="isDrag"in r?r.isDrag:e.isDrag;return n.datas||(n.datas={}),O(O({isDrag:i},r),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:n.lastEvent,isDouble:e.isDouble,datas:n.datas,isFirstDrag:!!e.isFirstDrag})}function Yi(t,e,r){t._emitter.on(e,r)}function J(t,e,r,n,i){return t.triggerEvent(e,r,n,i)}function Io(t,e){return fe(t).getComputedStyle(t,e)}function Xi(t,e,r){var n={},i={};return t.filter(function(a){var s=a.name;if(n[s]||!e.some(function(o){return a[o]}))return!1;if(!r&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return n[s]=!0,!0})}function Bo(t,e){return t===e||t==null&&e==null}function du(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length-1,n=0;n<r;++n){var i=t[n];if(!ii(i))return i}return t[r]}function fu(t,e){var r=[],n=[];return t.forEach(function(i,a){var s=e(i,a,t),o=n.indexOf(s),l=r[o]||[];o===-1&&(n.push(s),r.push(l)),l.push(i)}),r}function qg(t,e){var r=[],n={};return t.forEach(function(i,a){var s=e(i,a,t),o=n[s];o||(o=[],n[s]=o,r.push(o)),o.push(i)}),r}function pu(t){return t.reduce(function(e,r){return e.concat(r)},[])}function Hr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort(function(r,n){return F(n)-F(r)}),t[0]}function Vr(t,e,r){return jt(Te(t,r),lr(e,r),r)}function vu(t,e){var r,n=t.is3d,i=t.rootMatrix,a=n?4:3;return r=R(Vr(i,[e.distX,e.distY],a),2),e.distX=r[0],e.distY=r[1],e}function Ee(t,e,r,n){if(!r[0]&&!r[1])return e;var i=Nt(t,[Zc(r[0]||1),0],n),a=Nt(t,[0,Zc(r[1]||1)],n),s=Nt(t,[r[0]/ye(i),r[1]/ye(a)],n);return yt(e,s)}function ke(t,e,r){return r?"".concat(t/e*100,"%"):"".concat(t,"px")}function Hi(t){return F(t)<=Jt?0:t}function Go(t){return function(e){if(!e.isDragging(t))return"";var r=Wh(e,t),n=r.deg;return n?nt("view-control-rotation".concat(n)):""}}function Fo(t,e){return e===void 0&&(e=[t]),function(r,n){if(n.isRequest)return e.some(function(a){return n.requestAble===a})?n.parentDirection:!1;var i=n.inputEvent.target;return Gt(i,nt("direction"))&&(!t||Gt(i,nt(t)))}}function Jg(t,e,r){var n,i=Rr(t,{"x%":function(x){return x/100*e.offsetWidth},"y%":function(x){return x/100*e.offsetHeight}}),a=t.slice(0,r<0?void 0:r),s=t.slice(0,r<0?void 0:r+1),o=t[r]||"",l=r<0?[]:t.slice(r),c=r<0?[]:t.slice(r+1),u=i.slice(0,r<0?void 0:r),d=i.slice(0,r<0?void 0:r+1),f=(n=i[r])!==null&&n!==void 0?n:Rr([""])[0],p=r<0?[]:i.slice(r),v=r<0?[]:i.slice(r+1),h=f?[f]:[],g=Or(u),m=Or(d),b=Or(p),E=Or(v),C=Dt(g,b,4);return{transforms:t,beforeFunctionMatrix:g,beforeFunctionMatrix2:m,targetFunctionMatrix:Or(h),afterFunctionMatrix:b,afterFunctionMatrix2:E,allFunctionMatrix:C,beforeFunctions:u,beforeFunctions2:d,targetFunction:h[0],afterFunctions:p,afterFunctions2:v,beforeFunctionTexts:a,beforeFunctionTexts2:s,targetFunctionText:o,afterFunctionTexts:l,afterFunctionTexts2:c}}function t0(t){return!t||!de(t)||Ue(t)?!1:Lt(t)||"length"in t}function ze(t,e){return t?Ue(t)?t:$t(t)?e?document.querySelector(t):t:ai(t)?t():yl(t)?t:"current"in t?t.current:t:null}function Ko(t,e){if(!t)return[];var r=t0(t)?[].slice.call(t):[t];return r.reduce(function(n,i){return $t(i)&&e?$($([],R(n),!1),R([].slice.call(document.querySelectorAll(i))),!1):(Lt(i)?n.push(Ko(i,e)):n.push(ze(i,e)),n)},[])}function e0(t,e,r){var n=It(t,e)/Math.PI*180;return n=r>=0?n:180-n,n=n>=0?n:360+n,n}function hu(t,e){var r=t.rootMatrix,n=t.is3d,i=n?4:3,a=Te(r,i);return n||(a=Ae(a,3,4)),a[12]=0,a[13]=0,a[14]=0,mi(a,e)}function gu(t,e,r,n,i){var a=R(t,2),s=a[0],o=a[1],l=0,c=0;if(i&&s&&o){var u=It([0,0],e),d=It([0,0],n),f=ye(e),p=Math.cos(u-d)*f;if(!n[0])c=p,l=c*r;else if(!n[1])l=p,c=l/r;else{var v=n[0]*s,h=n[1]*o,g=Math.atan2(v+e[0],h+e[1]),m=Math.atan2(v,h);g<0&&(g+=Math.PI*2),m<0&&(m+=Math.PI*2);var b=0;F(g-m)<Math.PI/2||F(g-m)>Math.PI/2*3||(m+=Math.PI),b=g-m,b>Math.PI*2?b-=Math.PI*2:b>Math.PI?b=2*Math.PI-b:b<-Math.PI&&(b=-2*Math.PI-b);var E=ye([v+e[0],h+e[1]])*Math.cos(b);l=E*Math.sin(m)-v,c=E*Math.cos(m)-h,n[0]<0&&(l*=-1),n[1]<0&&(c*=-1)}}else l=n[0]*e[0],c=n[1]*e[1];return[l,c]}function mu(t,e,r,n){var i,a=r.ratio,s=r.startOffsetWidth,o=r.startOffsetHeight,l=0,c=0,u=n.distX,d=n.distY,f=n.pinchScale,p=n.parentDistance,v=n.parentDist,h=n.parentScale,g=r.fixedDirection,m=[0,1].map(function(w){return F(t[w]-g[w])}),b=[0,1].map(function(w){var D=m[w];return D!==0&&(D=2/D),D});if(v)l=v[0],c=v[1],e&&(l?c||(c=l/a):l=c*a);else if(Pr(f))l=(f-1)*s,c=(f-1)*o;else if(h)l=(h[0]-1)*s,c=(h[1]-1)*o;else if(p){var E=s*m[0],C=o*m[1],x=ye([E,C]);l=p/x*E*b[0],c=p/x*C*b[1]}else{var S=Le({datas:r,distX:u,distY:d});S=b.map(function(w,D){return S[D]*w}),i=R(gu([s,o],S,a,t,e),2),l=i[0],c=i[1]}return{distWidth:l,distHeight:c}}function Wo(t,e){if(e){if(t==="left")return{x:"0%",y:"50%"};if(t==="top")return{x:"50%",y:"50%"};if(t==="center")return{x:"50%",y:"50%"};if(t==="right")return{x:"100%",y:"50%"};if(t==="bottom")return{x:"50%",y:"100%"};var r=R(t.split(" "),2),n=r[0],i=r[1],a=Wo(n||""),s=Wo(i||""),o=O(O({},a),s),l={x:"50%",y:"50%"};return o.x&&(l.x=o.x),o.y&&(l.y=o.y),o.value&&(o.x&&!o.y&&(l.y=o.value),!o.x&&o.y&&(l.x=o.value)),l}return t==="left"?{x:"0%"}:t==="right"?{x:"100%"}:t==="top"?{y:"0%"}:t==="bottom"?{y:"100%"}:t?t==="center"?{value:"50%"}:{value:t}:{}}function Yo(t,e,r){var n=Wo(t,!0),i=n.x,a=n.y;return[xt(i,e)||0,xt(a,r)||0]}function r0(t,e,r){var n=t.map(function(a){return it(a,e)}),i=n.map(function(a){return En(a,r)});return{prev:n,next:i,result:i.map(function(a){return yt(a,e)})}}function yu(t,e){return t.length===e.length&&t.every(function(r,n){var i=e[n],a=Lt(r),s=Lt(i);return a&&s?yu(r,i):!a&&!s?r===i:!1})}function $r(t,e,r,n,i){var a=t._store,s=a[e];if(!(e in a))if(i!=null)a[e]=i,s=i;else return a[e]=r,r;return s===r||n(s)===n(r)?s:(a[e]=r,r)}function re(t){return t>=0?1:-1}function F(t){return Math.abs(t)}function Xo(t,e){return Vp(t).map(function(r){return e(r)})}function bu(t){return Pr(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}var n0=Tn("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(t,e){var r=e.datas,n=e.targets,i=e.angle,a=e.originalDatas,s=t.props,o=s.pinchable,l=s.ables;if(!o)return!1;var c="onPinch".concat(n?"Group":"","Start"),u="drag".concat(n?"Group":"","ControlStart"),d=(o===!0?t.controlAbles:l.filter(function(h){return o.indexOf(h.name)>-1})).filter(function(h){return h.canPinch&&h[u]}),f=dt(t,e,{});n&&(f.targets=n);var p=J(t,c,f);r.isPinch=p!==!1,r.ables=d;var v=r.isPinch;return v?(d.forEach(function(h){if(a[h.name]=a[h.name]||{},!!h[u]){var g=O(O({},e),{datas:a[h.name],parentRotate:i,isPinch:!0});h[u](t,g)}}),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},v):!1},pinch:function(t,e){var r=e.datas,n=e.scale,i=e.distance,a=e.originalDatas,s=e.inputEvent,o=e.targets,l=e.angle;if(r.isPinch){var c=i*(1-1/n),u=dt(t,e,{});o&&(u.targets=o);var d="onPinch".concat(o?"Group":"");J(t,d,u);var f=r.ables,p="drag".concat(o?"Group":"","Control");return f.forEach(function(v){v[p]&&v[p](t,O(O({},e),{datas:a[v.name],inputEvent:s,resolveMatrix:!0,pinchScale:n,parentDistance:c,parentRotate:l,isPinch:!0}))}),u}},pinchEnd:function(t,e){var r=e.datas,n=e.isPinch,i=e.inputEvent,a=e.targets,s=e.originalDatas;if(r.isPinch){var o="onPinch".concat(a?"Group":"","End"),l=pe(t,e,{isDrag:n});a&&(l.targets=a),J(t,o,l);var c=r.ables,u="drag".concat(a?"Group":"","ControlEnd");return c.forEach(function(d){d[u]&&d[u](t,O(O({},e),{isDrag:n,datas:s[d.name],inputEvent:i,isPinch:!0}))}),n}},pinchGroupStart:function(t,e){return this.pinchStart(t,O(O({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,O(O({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,O(O({},e),{targets:t.props.targets}))}}),Eu=Fo("scalable"),i0={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:bc("scalable"),dragControlCondition:Eu,viewClassName:Go("scalable"),dragControlStart:function(t,e){var r=e.datas,n=e.isPinch,i=e.inputEvent,a=e.parentDirection,s=lu(a,n,i,r),o=t.state,l=o.width,c=o.height,u=o.targetTransform,d=o.target,f=o.pos1,p=o.pos2,v=o.pos4;if(!s||!d)return!1;n||vr(t,e),r.datas={},r.transform=u,r.prevDist=[1,1],r.direction=s,r.startOffsetWidth=l,r.startOffsetHeight=c,r.startValue=[1,1];var h=!s[0]&&!s[1]||s[0]||!s[1];Ai(t,e,"scale"),r.isWidth=h;function g(S){r.ratio=S&&isFinite(S)?S:0}r.startPositions=be(t.state);function m(S){var w=Fc(r.startPositions,S);r.fixedDirection=w.fixedDirection,r.fixedPosition=w.fixedPosition,r.fixedOffset=w.fixedOffset}r.setFixedDirection=m,g(Ne(f,p)/Ne(p,v)),m([-s[0],-s[1]]);var b=function(S){r.minScaleSize=S},E=function(S){r.maxScaleSize=S};b([-1/0,-1/0]),E([1/0,1/0]);var C=dt(t,e,O(O({direction:s,set:function(S){r.startValue=S},setRatio:g,setFixedDirection:m,setMinScaleSize:b,setMaxScaleSize:E},Ti(t,e)),{dragStart:te.dragStart(t,new Ir().dragStart([0,0],e))})),x=J(t,"onScaleStart",C);return r.startFixedDirection=r.fixedDirection,x!==!1&&(r.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:s}),r.isScale?C:!1},dragControl:function(t,e){Di(t,e,"scale");var r=e.datas,n=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,s=e.dragClient,o=e.isRequest,l=e.useSnap,c=e.resolveMatrix,u=r.prevDist,d=r.direction,f=r.startOffsetWidth,p=r.startOffsetHeight,v=r.isScale,h=r.startValue,g=r.isWidth,m=r.ratio;if(!v)return!1;var b=t.props,E=b.throttleScale,C=b.parentMoveable,x=d;!d[0]&&!d[1]&&(x=[1,1]);var S=m&&(n??b.keepRatio)||!1,w=t.state,D=[h[0],h[1]];function T(){var V=mu(x,S,r,e),tt=V.distWidth,gt=V.distHeight,st=f?(f+tt)/f:1,lt=p?(p+gt)/p:1;h[0]||(D[0]=tt/f),h[1]||(D[1]=gt/p);var ft=(x[0]||S?st:1)*D[0],bt=(x[1]||S?lt:1)*D[1];return ft===0&&(ft=re(u[0])*xi),bt===0&&(bt=re(u[1])*xi),[ft,bt]}var A=T();if(!a&&t.props.groupable){var M=w.snapRenderInfo||{},P=M.direction;Lt(P)&&(P[0]||P[1])&&(w.snapRenderInfo={direction:d,request:e.isRequest})}J(t,"onBeforeScale",dt(t,e,{scale:A,setFixedDirection:function(V){return r.setFixedDirection(V),A=T(),A},startFixedDirection:r.startFixedDirection,setScale:function(V){A=V}},!0));var k=[A[0]/D[0],A[1]/D[1]],_=s,N=[0,0],I=re(k[0]*k[1]),B=!s&&!i&&a;if(B||c?_=ho(t,r.targetAllTransform,[0,0],[0,0],r):s||(_=r.fixedPosition),a||(N=zg(t,k,d,!l&&o,r)),S){x[0]&&x[1]&&N[0]&&N[1]&&(Math.abs(N[0]*f)>Math.abs(N[1]*p)?N[1]=0:N[0]=0);var L=!N[0]&&!N[1];if(L&&(g?k[0]=ct(k[0]*D[0],E)/D[0]:k[1]=ct(k[1]*D[1],E)/D[1]),x[0]&&!x[1]||N[0]&&!N[1]||L&&g){k[0]+=N[0];var G=f*k[0]*D[0]/m;k[1]=re(I*k[0])*F(G/p/D[1])}else if(!x[0]&&x[1]||!N[0]&&N[1]||L&&!g){k[1]+=N[1];var W=p*k[1]*D[1]*m;k[0]=re(I*k[1])*F(W/f/D[0])}}else k[0]+=N[0],k[1]+=N[1],N[0]||(k[0]=ct(k[0]*D[0],E)/D[0]),N[1]||(k[1]=ct(k[1]*D[1],E)/D[1]);k[0]===0&&(k[0]=re(u[0])*xi),k[1]===0&&(k[1]=re(u[1])*xi),A=Fg(k,[D[0],D[1]]);var z=[f,p],X=[f*A[0],p*A[1]];X=xa(X,r.minScaleSize,r.maxScaleSize,S?m:!1),A=Xo(2,function(V){return z[V]?X[V]/z[V]:X[V]}),k=Xo(2,function(V){return A[V]/D[V]});var j=Xo(2,function(V){return u[V]?k[V]/u[V]:k[V]}),Y="scale(".concat(k.join(", "),")"),Z="scale(".concat(A.join(", "),")"),U=wi(r,Z,Y),q=!h[0]||!h[1],et=zh(t,q?Z:Y,r.fixedDirection,_,r.fixedOffset,r,q),at=B?et:it(et,r.prevInverseDist||[0,0]);if(r.prevDist=k,r.prevInverseDist=et,A[0]===u[0]&&A[1]===u[1]&&at.every(function(V){return!V})&&!C&&!B)return!1;var ot=dt(t,e,O({offsetWidth:f,offsetHeight:p,direction:d,scale:A,dist:k,delta:j,isPinch:!!a},pc(t,U,at,a,e)));return J(t,"onScale",ot),ot},dragControlEnd:function(t,e){var r=e.datas;if(!r.isScale)return!1;r.isScale=!1;var n=pe(t,e,{});return J(t,"onScaleEnd",n),n},dragGroupControlCondition:Eu,dragGroupControlStart:function(t,e){var r=e.datas,n=this.dragControlStart(t,e);if(!n)return!1;var i=Me(t,"resizable",e);r.moveableScale=t.scale;var a=Ke(t,this,"dragControlStart",e,function(c,u){return Oi(t,c,r,u)}),s=function(c){n.setFixedDirection(c),a.forEach(function(u,d){u.setFixedDirection(c),Oi(t,u.moveable,r,i[d])})};r.setFixedDirection=s;var o=O(O({},n),{targets:t.props.targets,events:a,setFixedDirection:s}),l=J(t,"onScaleGroupStart",o);return r.isScale=l!==!1,r.isScale?o:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isScale){Yi(t,"onBeforeScale",function(u){J(t,"onBeforeScaleGroup",dt(t,e,O(O({},u),{targets:t.props.targets}),!0))});var n=this.dragControl(t,e);if(n){var i=n.dist,a=r.moveableScale;t.scale=[i[0]*a[0],i[1]*a[1]];var s=t.props.keepRatio,o=r.fixedPosition,l=Ke(t,this,"dragControl",e,function(u,d){var f=R(jt(Cn(t.rotation/180*Math.PI,3),[d.datas.originalX*i[0],d.datas.originalY*i[1],1],3),2),p=f[0],v=f[1];return O(O({},d),{parentDist:null,parentScale:i,parentKeepRatio:s,dragClient:yt(o,[p,v])})}),c=O({targets:t.props.targets,events:l},n);return J(t,"onScaleGroup",c),c}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isScale){this.dragControlEnd(t,e);var i=Ke(t,this,"dragControlEnd",e),a=pe(t,e,{targets:t.props.targets,events:i});return J(t,"onScaleGroupEnd",a),r}},request:function(){var t={},e=0,r=0,n=!1;return{isControl:!0,requestStart:function(i){return n=i.useSnap,{datas:t,parentDirection:i.direction||[1,1],useSnap:n}},request:function(i){return e+=i.deltaWidth,r+=i.deltaHeight,{datas:t,parentDist:[e,r],parentKeepRatio:i.keepRatio,useSnap:n}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:n}}}}};function tr(t,e){return t.map(function(r,n){return ni(r,e[n],1,2)})}function Cu(t,e,r){var n=It(t,e),i=It(t,r),a=i-n;return a>=0?a:a+2*Math.PI}function a0(t,e){var r=Cu(t[0],t[1],t[2]),n=Cu(e[0],e[1],e[2]),i=Math.PI;return!(r>=i&&n<=i||r<=i&&n>=i)}var o0={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:Go("warpable"),render:function(t,e){var r=t.props,n=r.resizable,i=r.scalable,a=r.warpable,s=r.zoom;if(n||i||!a)return[];var o=t.state,l=o.pos1,c=o.pos2,u=o.pos3,d=o.pos4,f=tr(l,c),p=tr(c,l),v=tr(l,u),h=tr(u,l),g=tr(u,d),m=tr(d,u),b=tr(c,d),E=tr(d,c);return $([e.createElement("div",{className:nt("line"),key:"middeLine1",style:Nn(f,g,s)}),e.createElement("div",{className:nt("line"),key:"middeLine2",style:Nn(p,m,s)}),e.createElement("div",{className:nt("line"),key:"middeLine3",style:Nn(v,b,s)}),e.createElement("div",{className:nt("line"),key:"middeLine4",style:Nn(h,E,s)})],R(Ec(t,"warpable",e)),!1)},dragControlCondition:function(t,e){if(e.isRequest)return!1;var r=e.inputEvent.target;return Gt(r,nt("direction"))&&Gt(r,nt("warpable"))},dragControlStart:function(t,e){var r=e.datas,n=e.inputEvent,i=t.props.target,a=n.target,s=cu(a,r);if(!s||!i)return!1;var o=t.state,l=o.transformOrigin,c=o.is3d,u=o.targetTransform,d=o.targetMatrix,f=o.width,p=o.height,v=o.left,h=o.top;r.datas={},r.targetTransform=u,r.warpTargetMatrix=c?d:Ae(d,3,4),r.targetInverseMatrix=Yl(Te(r.warpTargetMatrix,4),3,4),r.direction=s,r.left=v,r.top=h,r.poses=[[0,0],[f,0],[0,p],[f,p]].map(function(b){return it(b,l)}),r.nextPoses=r.poses.map(function(b){var E=R(b,2),C=E[0],x=E[1];return jt(r.warpTargetMatrix,[C,x,0,1],4)}),r.startValue=Ot(4),r.prevMatrix=Ot(4),r.absolutePoses=be(o),r.posIndexes=fc(s),vr(t,e),Ai(t,e,"matrix3d"),o.snapRenderInfo={request:e.isRequest,direction:s};var g=dt(t,e,O({set:function(b){r.startValue=b}},Ti(t,e))),m=J(t,"onWarpStart",g);return m!==!1&&(r.isWarp=!0),r.isWarp},dragControl:function(t,e){var r=e.datas,n=e.isRequest,i=e.distX,a=e.distY,s=r.targetInverseMatrix,o=r.prevMatrix,l=r.isWarp,c=r.startValue,u=r.poses,d=r.posIndexes,f=r.absolutePoses;if(!l)return!1;if(Di(t,e,"matrix3d"),Yr(t,"warpable")){var p=d.map(function(T){return f[T]});p.length>1&&p.push([(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2]);var v=zi(t,n,{horizontal:p.map(function(T){return T[1]+a}),vertical:p.map(function(T){return T[0]+i})}),h=v.horizontal,g=v.vertical;a-=h.offset,i-=g.offset}var m=Le({datas:r,distX:i,distY:a},!0),b=r.nextPoses.slice();if(d.forEach(function(T){b[T]=yt(b[T],m)}),!Th.every(function(T){return a0(T.map(function(A){return u[A]}),T.map(function(A){return b[A]}))}))return!1;var E=Ya(u[0],u[2],u[1],u[3],b[0],b[2],b[1],b[3]);if(!E.length)return!1;var C=Dt(s,E,4),x=uc(r,C,!0),S=Dt(Te(o,4),x,4);r.prevMatrix=x;var w=Dt(c,x,4),D=wi(r,"matrix3d(".concat(w.join(", "),")"),"matrix3d(".concat(x.join(", "),")"));return vo(e,D),J(t,"onWarp",dt(t,e,O({delta:S,matrix:w,dist:x,multiply:Dt,transform:D},ee({transform:D},e)))),!0},dragControlEnd:function(t,e){var r=e.datas,n=e.isDrag;return r.isWarp?(r.isWarp=!1,J(t,"onWarpEnd",pe(t,e,{})),n):!1}},s0=nt("area-pieces"),Vi=nt("area-piece"),Su=nt("avoid"),l0=nt("view-dragging");function Ho(t){var e=t.areaElement;if(e){var r=t.state,n=r.width,i=r.height;ml(e,Su),e.style.cssText+="left: 0px; top: 0px; width: ".concat(n,"px; height: ").concat(i,"px")}}function xu(t){return t.createElement("div",{key:"area_pieces",className:s0},t.createElement("div",{className:Vi}),t.createElement("div",{className:Vi}),t.createElement("div",{className:Vi}),t.createElement("div",{className:Vi}))}var Du={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(t,e){var r=t.props,n=r.target,i=r.dragArea,a=r.groupable,s=r.passDragArea,o=t.getState(),l=o.width,c=o.height,u=o.renderPoses,d=s?nt("area","pass"):nt("area");if(a)return[e.createElement("div",{key:"area",ref:Ge(t,"areaElement"),className:d}),xu(e)];if(!n||!i)return[];var f=Ya([0,0],[l,0],[0,c],[l,c],u[0],u[1],u[2],u[3]),p=f.length?Fi(f,!0):"none";return[e.createElement("div",{key:"area",ref:Ge(t,"areaElement"),className:d,style:{top:"0px",left:"0px",width:"".concat(l,"px"),height:"".concat(c,"px"),transformOrigin:"0 0",transform:p}}),xu(e)]},dragStart:function(t,e){var r=e.datas,n=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;r.isDragArea=!1;var s=t.areaElement,o=t.state,l=o.moveableClientRect,c=o.renderPoses,u=o.rootMatrix,d=o.is3d,f=l.left,p=l.top,v=me(c),h=v.left,g=v.top,m=v.width,b=v.height,E=d?4:3,C=R(Vr(u,[n-f,i-p],E),2),x=C[0],S=C[1];x-=h,S-=g;var w=[{left:h,top:g,width:m,height:S-10},{left:h,top:g,width:x-10,height:b},{left:h,top:g+S+10,width:m,height:b-S-10},{left:h+x+10,top:g,width:m-x-10,height:b}],D=[].slice.call(s.nextElementSibling.children);w.forEach(function(T,A){D[A].style.cssText="left: ".concat(T.left,"px;top: ").concat(T.top,"px; width: ").concat(T.width,"px; height: ").concat(T.height,"px;")}),wa(s,Su),o.disableNativeEvent=!0},drag:function(t,e){var r=e.datas,n=e.inputEvent;if(this.enableNativeEvent(t),!n)return!1;r.isDragArea||(r.isDragArea=!0,Ho(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var r=e.inputEvent,n=e.datas;if(!r)return!1;n.isDragArea||Ho(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){Ho(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&ul(function(){e.disableNativeEvent=!1})}},c0=Tn("origin",{props:["origin","svgOrigin"],render:function(t,e){var r=t.props,n=r.zoom,i=r.svgOrigin,a=r.groupable,s=t.getState(),o=s.beforeOrigin,l=s.rotation,c=s.svg,u=s.allMatrix,d=s.is3d,f=s.left,p=s.top,v=s.offsetWidth,h=s.offsetHeight,g;if(!a&&c&&i){var m=R(Yo(i,v,h),2),b=m[0],E=m[1],C=d?4:3,x=Nt(u,[b,E],C);g=Ki(l,n,it(x,[f,p]))}else g=Ki(l,n,o);return[e.createElement("div",{className:nt("control","origin"),style:g,key:"beforeOrigin"})]}});function u0(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var d0={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(t,e){var r=t.props,n=r.scrollContainer,i=n===void 0?t.getContainer():n,a=r.scrollOptions,s=new Ul,o=ze(i,!0);e.datas.dragScroll=s,t.state.dragScroll=s;var l=e.isControl?"controlGesto":"targetGesto",c=e.targets;s.on("scroll",function(u){var d=u.container,f=u.direction,p=dt(t,e,{scrollContainer:d,direction:f}),v=c?"onScrollGroup":"onScroll";c&&(p.targets=c),J(t,v,p)}).on("move",function(u){var d=u.offsetX,f=u.offsetY,p=u.inputEvent;t[l].scrollBy(d,f,p.inputEvent,!1)}).on("scrollDrag",function(u){var d=u.next;d(t[l].getCurrentEvent())}),s.dragStart(e,O({container:o},a))},checkScroll:function(t,e){var r=e.datas.dragScroll;if(r){var n=t.props,i=n.scrollContainer,a=i===void 0?t.getContainer():i,s=n.scrollThreshold,o=s===void 0?0:s,l=n.scrollThrottleTime,c=l===void 0?0:l,u=n.getScrollPosition,d=u===void 0?u0:u,f=n.scrollOptions;return r.drag(e,O({container:a,threshold:o,throttleTime:c,getScrollPosition:function(p){return d({scrollContainer:p.container,direction:p.direction})}},f)),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,O(O({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,O(O({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,O(O({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,O(O({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,O(O({},e),{targets:t.props.targets,isControl:!0}))},dragGroupControl:function(t,e){return this.drag(t,O(O({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,O(O({},e),{targets:t.props.targets}))},unset:function(t){var e,r=t.state;(e=r.dragScroll)===null||e===void 0||e.dragEnd(),r.dragScroll=null}},wu={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},f0=Tn("padding",{props:["padding"],render:function(t,e){var r=t.props;if(r.dragArea)return[];var n=bu(r.padding||{}),i=n.left,a=n.top,s=n.right,o=n.bottom,l=t.getState(),c=l.renderPoses,u=l.pos1,d=l.pos2,f=l.pos3,p=l.pos4,v=[u,d,f,p],h=[];return i>0&&h.push([0,2]),a>0&&h.push([0,1]),s>0&&h.push([1,3]),o>0&&h.push([2,3]),h.map(function(g,m){var b=R(g,2),E=b[0],C=b[1],x=v[E],S=v[C],w=c[E],D=c[C],T=Ya([0,0],[100,0],[0,100],[100,100],x,S,w,D);if(T.length)return e.createElement("div",{key:"padding".concat(m),className:nt("padding"),style:{transform:Fi(T,!0)}})})}}),Tu=["nw","ne","se","sw"];function $i(t,e){var r=t[0]+t[1],n=r>e?e/r:1;return t[0]*=n,t[1]=e-t[1]*n,t}var p0=[1,2,5,6],v0=[0,3,4,7],br=[1,-1,-1,1],Er=[1,1,-1,-1];function Vo(t,e,r,n,i,a,s,o){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=r),o===void 0&&(o=n);var l=[],c=!1,u=t.filter(function(f){return!f.virtual}),d=u.map(function(f){var p=f.horizontal,v=f.vertical,h=f.pos;if(v&&!c&&(c=!0,l.push("/")),c){var g=Math.max(0,v===1?h[1]-a:o-h[1]);return l.push(ke(g,n,e)),g}else{var g=Math.max(0,p===1?h[0]-i:s-h[0]);return l.push(ke(g,r,e)),g}});return{radiusPoses:u,styles:l,raws:d}}function Au(t){for(var e=[0,0],r=[0,0],n=t.length,i=0;i<n;++i){var a=t[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,r[0]=i+1),a.vertical&&(r[1]===0&&(r[0]=i),r[1]=i-r[0]+1))}return{horizontalRange:e,verticalRange:r}}function Mu(t,e,r,n,i,a,s){var o,l,c,u;a===void 0&&(a=[0,0]),s===void 0&&(s=!1);var d=t.indexOf("/"),f=(d>-1?t.slice(0,d):t).length,p=t.slice(0,f),v=t.slice(f+1),h=p.length,g=v.length,m=g>0,b=R(p,4),E=b[0],C=E===void 0?"0px":E,x=b[1],S=x===void 0?C:x,w=b[2],D=w===void 0?C:w,T=b[3],A=T===void 0?S:T,M=R(v,4),P=M[0],k=P===void 0?C:P,_=M[1],N=_===void 0?m?k:S:_,I=M[2],B=I===void 0?m?k:D:I,L=M[3],G=L===void 0?m?N:A:L,W=[C,S,D,A].map(function(U){return xt(U,e)}),z=[k,N,B,G].map(function(U){return xt(U,r)}),X=W.slice(),j=z.slice();o=R($i([X[0],X[1]],e),2),X[0]=o[0],X[1]=o[1],l=R($i([X[3],X[2]],e),2),X[3]=l[0],X[2]=l[1],c=R($i([j[0],j[3]],r),2),j[0]=c[0],j[3]=c[1],u=R($i([j[1],j[2]],r),2),j[1]=u[0],j[2]=u[1];var Y=s?X:X.slice(0,Math.max(a[0],h)),Z=s?j:j.slice(0,Math.max(a[1],g));return $($([],R(Y.map(function(U,q){var et=Tu[q];return{virtual:q>=h,horizontal:br[q],vertical:0,pos:[n+U,i+(Er[q]===-1?r:0)],sub:!0,raw:W[q],direction:et}})),!1),R(Z.map(function(U,q){var et=Tu[q];return{virtual:q>=g,horizontal:0,vertical:Er[q],pos:[n+(br[q]===-1?e:0),i+U],sub:!0,raw:z[q],direction:et}})),!1)}function h0(t,e,r,n,i){i===void 0&&(i=e.length);var a=Au(t.slice(n)),s=a.horizontalRange,o=a.verticalRange,l=r-n,c=0;if(l===0)c=i;else if(l>0&&l<s[1])c=s[1]-l;else if(l>=o[0])c=o[0]+o[1]-l;else return;t.splice(r,c),e.splice(r,c)}function g0(t,e,r,n,i,a,s,o,l,c,u){c===void 0&&(c=0),u===void 0&&(u=0);var d=Au(t.slice(r)),f=d.horizontalRange,p=d.verticalRange;if(n>-1)for(var v=br[n]===1?a-c:o-a,h=f[1];h<=n;++h){var g=Er[h]===1?u:l,m=0;if(n===h?m=a:h===0?m=c+v:br[h]===-1&&(m=o-(e[r][0]-c)),t.splice(r+h,0,{horizontal:br[h],vertical:0,pos:[m,g]}),e.splice(r+h,0,[m,g]),h===0)break}else if(i>-1){var b=Er[i]===1?s-u:l-s;if(f[1]===0&&p[1]===0){var E=[c+b,u];t.push({horizontal:br[0],vertical:0,pos:E}),e.push(E)}for(var C=p[0],h=p[1];h<=i;++h){var m=br[h]===1?c:o,g=0;if(i===h?g=s:h===0?g=u+b:Er[h]===1?g=e[r+C][1]:Er[h]===-1&&(g=l-(e[r+C][1]-u)),t.push({horizontal:0,vertical:Er[h],pos:[m,g]}),e.push([m,g]),h===0)break}}}function m0(t,e){e===void 0&&(e=t.map(function(i){return i.raw}));var r=t.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),n=t.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:r,verticals:n}}var y0=[[0,-1,"n"],[1,0,"e"]],b0=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function $o(t,e,r){var n=t.props.clipRelative,i=t.state,a=i.width,s=i.height,o=e,l=o.type,c=o.poses,u=l==="rect",d=l==="circle";if(l==="polygon")return r.map(function(S){return"".concat(ke(S[0],a,n)," ").concat(ke(S[1],s,n))});if(u||l==="inset"){var f=r[1][1],p=r[3][0],v=r[7][0],h=r[5][1];if(u)return[f,p,h,v].map(function(S){return"".concat(S,"px")});var g=[f,a-p,s-h,v].map(function(S,w){return ke(S,w%2?a:s,n)});if(r.length>8){var m=R(it(r[4],r[0]),2),b=m[0],E=m[1];g.push.apply(g,$(["round"],R(Vo(c.slice(8).map(function(S,w){return O(O({},S),{pos:r[w]})}),n,b,E,v,f,p,h).styles),!1))}return g}else if(d||l==="ellipse"){var C=r[0],x=ke(F(r[1][1]-C[1]),d?Math.sqrt((a*a+s*s)/2):s,n),g=d?[x]:[ke(F(r[2][0]-C[0]),a,n),x];return g.push("at",ke(C[0],a,n),ke(C[1],s,n)),g}}function ji(t,e,r,n){var i=[n,(n+e)/2,e],a=[t,(t+r)/2,r];return b0.map(function(s){var o=R(s,3),l=o[0],c=o[1],u=o[2],d=i[l+1],f=a[c+1];return{vertical:F(c),horizontal:F(l),direction:u,pos:[d,f]}})}function ku(t){var e=[1/0,-1/0],r=[1/0,-1/0];return t.forEach(function(n){var i=n.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),r[0]=Math.min(r[0],i[1]),r[1]=Math.max(r[1],i[1])}),[F(e[1]-e[0]),F(r[1]-r[0])]}function Pu(t,e,r,n,i){var a,s,o,l,c,u,d,f,p;if(t){var v=i;if(!v){var h=se(t),g=h("clipPath");v=g!=="none"?g:h("clip")}if(!((!v||v==="none"||v==="auto")&&(v=n,!v))){var m=Ca(v),b=m.prefix,E=b===void 0?v:b,C=m.value,x=C===void 0?"":C,S=E==="circle",w=" ";if(E==="polygon"){var D=$e(x||"0% 0%, 100% 0%, 100% 100%, 0% 100%");w=",";var T=D.map(function(Bt){var vt=R(Bt.split(" "),2),Rt=vt[0],wt=vt[1];return{vertical:1,horizontal:1,pos:[xt(Rt,e),xt(wt,r)]}}),A=fr(T.map(function(Bt){return Bt.pos}));return{type:E,clipText:v,poses:T,splitter:w,left:A.minX,right:A.maxX,top:A.minY,bottom:A.maxY}}else if(S||E==="ellipse"){var M="",P="",k=0,_=0,D=Ve(x);if(S){var N="";a=R(D,4),s=a[0],N=s===void 0?"50%":s,o=a[2],M=o===void 0?"50%":o,l=a[3],P=l===void 0?"50%":l,k=xt(N,Math.sqrt((e*e+r*r)/2)),_=k}else{var I="",B="";c=R(D,5),u=c[0],I=u===void 0?"50%":u,d=c[1],B=d===void 0?"50%":d,f=c[3],M=f===void 0?"50%":f,p=c[4],P=p===void 0?"50%":p,k=xt(I,e),_=xt(B,r)}var L=[xt(M,e),xt(P,r)],T=$([{vertical:1,horizontal:1,pos:L,direction:"nesw"}],R(y0.slice(0,S?1:2).map(function(Rt){return{vertical:F(Rt[1]),horizontal:Rt[0],direction:Rt[2],sub:!0,pos:[L[0]+Rt[0]*k,L[1]+Rt[1]*_]}})),!1);return{type:E,clipText:v,radiusX:k,radiusY:_,left:L[0]-k,top:L[1]-_,right:L[0]+k,bottom:L[1]+_,poses:T,splitter:w}}else if(E==="inset"){var D=Ve(x||"0 0 0 0"),G=D.indexOf("round"),W=(G>-1?D.slice(0,G):D).length,z=D.slice(W+1),X=R(D.slice(0,W),4),j=X[0],Y=X[1],Z=Y===void 0?j:Y,U=X[2],q=U===void 0?j:U,et=X[3],at=et===void 0?Z:et,ot=R([j,q].map(function(Rt){return xt(Rt,r)}),2),V=ot[0],tt=ot[1],gt=R([at,Z].map(function(Rt){return xt(Rt,e)}),2),st=gt[0],lt=gt[1],ft=e-lt,bt=r-tt,St=Mu(z,ft-st,bt-V,st,V),T=$($([],R(ji(V,ft,bt,st)),!1),R(St),!1);return{type:"inset",clipText:v,poses:T,top:V,left:st,right:ft,bottom:bt,radius:z,splitter:w}}else if(E==="rect"){var D=$e(x||"0px, ".concat(e,"px, ").concat(r,"px, 0px"));w=",";var ut=R(D.map(function(Ut){var Zt=sr(Ut).value;return Zt}),4),Et=ut[0],lt=ut[1],tt=ut[2],st=ut[3],T=ji(Et,lt,tt,st);return{type:"rect",clipText:v,poses:T,top:Et,right:lt,bottom:tt,left:st,values:D,splitter:w}}}}}function E0(t,e,r,n,i){var a=t[e],s=a.direction,o=a.sub,l=t.map(function(){return[0,0]}),c=s?s.split(""):[];if(n&&e<8){var u=c.filter(function(k){return k==="w"||k==="e"}),d=c.filter(function(k){return k==="n"||k==="s"}),f=u[0],p=d[0];l[e]=r;var v=R(ku(t),2),h=v[0],g=v[1],m=h&&g?h/g:0;if(m&&i){var b=(e+4)%8,E=t[b].pos,C=[0,0];s.indexOf("w")>-1?C[0]=-1:s.indexOf("e")>-1&&(C[0]=1),s.indexOf("n")>-1?C[1]=-1:s.indexOf("s")>-1&&(C[1]=1);var x=gu([h,g],r,m,C,!0),S=h+x[0],w=g+x[1],D=E[1],T=E[1],A=E[0],M=E[0];C[0]===-1?A=M-S:C[0]===1?M=A+S:(A=A-S/2,M=M+S/2),C[1]===-1?D=T-w:(C[1]===1||(D=T-w/2),T=D+w);var P=ji(D,M,T,A);t.forEach(function(k,_){l[_][0]=P[_].pos[0]-k.pos[0],l[_][1]=P[_].pos[1]-k.pos[1]})}else t.forEach(function(k,_){var N=k.direction;N&&(N.indexOf(f)>-1&&(l[_][0]=r[0]),N.indexOf(p)>-1&&(l[_][1]=r[1]))}),f&&(l[1][0]=r[0]/2,l[5][0]=r[0]/2),p&&(l[3][1]=r[1]/2,l[7][1]=r[1]/2)}else s&&!o?c.forEach(function(k){var _=k==="n"||k==="s";t.forEach(function(N,I){var B=N.direction,L=N.horizontal,G=N.vertical;!B||B.indexOf(k)===-1||(l[I]=[_||!L?0:r[0],!_||!G?0:r[1]])})}):l[e]=r;return l}function C0(t,e){var r=R(cc(t,e),2),n=r[0],i=r[1],a=e.datas,s=a.clipPath,o=a.clipIndex,l=s,c=l.type,u=l.poses,d=l.splitter,f=u.map(function(b){return b.pos});if(c==="polygon")f.splice(o,0,[n,i]);else if(c==="inset"){var p=p0.indexOf(o),v=v0.indexOf(o),h=u.length;if(g0(u,f,8,p,v,n,i,f[4][0],f[4][1],f[0][0],f[0][1]),h===u.length)return}else return;var g=$o(t,s,f),m="".concat(c,"(").concat(g.join(d),")");J(t,"onClip",dt(t,e,O({clipEventType:"added",clipType:c,poses:f,clipStyles:g,clipStyle:m,distX:0,distY:0},ee({clipPath:m},e))))}function S0(t,e){var r=e.datas,n=r.clipPath,i=r.clipIndex,a=n,s=a.type,o=a.poses,l=a.splitter,c=o.map(function(p){return p.pos}),u=c.length;if(s==="polygon")o.splice(i,1),c.splice(i,1);else if(s==="inset"){if(i<8||(h0(o,c,i,8,u),u===o.length))return}else return;var d=$o(t,n,c),f="".concat(s,"(").concat(d.join(l),")");J(t,"onClip",dt(t,e,O({clipEventType:"removed",clipType:s,poses:c,clipStyles:d,clipStyle:f,distX:0,distY:0},ee({clipPath:f},e))))}var x0={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(t,e){var r=t.props,n=r.customClipPath,i=r.defaultClipPath,a=r.clipArea,s=r.zoom,o=r.groupable,l=t.getState(),c=l.target,u=l.width,d=l.height,f=l.allMatrix,p=l.is3d,v=l.left,h=l.top,g=l.pos1,m=l.pos2,b=l.pos3,E=l.pos4,C=l.clipPathState,x=l.snapBoundInfos,S=l.rotation;if(!c||o)return[];var w=Pu(c,u,d,i||"inset",C||n);if(!w)return[];var D=p?4:3,T=w.type,A=w.poses,M=A.map(function(lt){var ft=Nt(f,lt.pos,D);return[ft[0]-v,ft[1]-h]}),P=[],k=[],_=T==="rect",N=T==="inset",I=T==="polygon";if(_||N||I){var B=N?M.slice(0,8):M;k=B.map(function(lt,ft){var bt=ft===0?B[B.length-1]:B[ft-1],St=It(bt,lt),ut=iu(bt,lt);return e.createElement("div",{key:"clipLine".concat(ft),className:nt("line","clip-line","snap-control"),"data-clip-index":ft,style:{width:"".concat(ut,"px"),transform:"translate(".concat(bt[0],"px, ").concat(bt[1],"px) rotate(").concat(St,"rad) scaleY(").concat(s,")")}})})}if(P=M.map(function(lt,ft){return e.createElement("div",{key:"clipControl".concat(ft),className:nt("control","clip-control","snap-control"),"data-clip-index":ft,style:{transform:"translate(".concat(lt[0],"px, ").concat(lt[1],"px) rotate(").concat(S,"rad) scale(").concat(s,")")}})}),N&&P.push.apply(P,$([],R(M.slice(8).map(function(lt,ft){return e.createElement("div",{key:"clipRadiusControl".concat(ft),className:nt("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+ft,style:{transform:"translate(".concat(lt[0],"px, ").concat(lt[1],"px) rotate(").concat(S,"rad) scale(").concat(s,")")}})})),!1)),T==="circle"||T==="ellipse"){var L=w.left,G=w.top,W=w.radiusX,z=w.radiusY,X=R(it(Nt(f,[L,G],D),Nt(f,[0,0],D)),2),j=X[0],Y=X[1],Z="none";if(!a){for(var U=Math.max(10,W/5,z/5),q=[],et=0;et<=U;++et){var at=Math.PI*2/U*et;q.push([W+(W-s)*Math.cos(at),z+(z-s)*Math.sin(at)])}q.push([W,-2]),q.push([-2,-2]),q.push([-2,z*2+2]),q.push([W*2+2,z*2+2]),q.push([W*2+2,-2]),q.push([W,-2]),Z="polygon(".concat(q.map(function(lt){return"".concat(lt[0],"px ").concat(lt[1],"px")}).join(", "),")")}P.push(e.createElement("div",{key:"clipEllipse",className:nt("clip-ellipse","snap-control"),style:{width:"".concat(W*2,"px"),height:"".concat(z*2,"px"),clipPath:Z,transform:"translate(".concat(-v+j,"px, ").concat(-h+Y,"px) ").concat(Fi(f))}}))}if(a){var ot=me($([g,m,b,E],R(M),!1)),V=ot.width,tt=ot.height,gt=ot.left,st=ot.top;if(I||_||N){var q=N?M.slice(0,8):M;P.push(e.createElement("div",{key:"clipArea",className:nt("clip-area","snap-control"),style:{width:"".concat(V,"px"),height:"".concat(tt,"px"),transform:"translate(".concat(gt,"px, ").concat(st,"px)"),clipPath:"polygon(".concat(q.map(function(ft){return"".concat(ft[0]-gt,"px ").concat(ft[1]-st,"px")}).join(", "),")")}}))}}return x&&["vertical","horizontal"].forEach(function(lt){var ft=x[lt],bt=lt==="horizontal";ft.isSnap&&k.push.apply(k,$([],R(ft.snap.posInfos.map(function(St,ut){var Et=St.pos,Bt=it(Nt(f,bt?[0,Et]:[Et,0],D),[v,h]),vt=it(Nt(f,bt?[u,Et]:[Et,d],D),[v,h]);return kn(e,"",Bt,vt,s,"clip".concat(lt,"snap").concat(ut),"guideline")})),!1)),ft.isBound&&k.push.apply(k,$([],R(ft.bounds.map(function(St,ut){var Et=St.pos,Bt=it(Nt(f,bt?[0,Et]:[Et,0],D),[v,h]),vt=it(Nt(f,bt?[u,Et]:[Et,d],D),[v,h]);return kn(e,"",Bt,vt,s,"clip".concat(lt,"bounds").concat(ut),"guideline","bounds","bold")})),!1))}),$($([],R(P),!1),R(k),!1)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var r=t.props,n=r.dragWithClip,i=n===void 0?!0:n;return i?!1:this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,O(O({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var r=t.state,n=t.props,i=n.defaultClipPath,a=n.customClipPath,s=r.target,o=r.width,l=r.height,c=e.inputEvent?e.inputEvent.target:null,u=c&&c.getAttribute("class")||"",d=e.datas,f=Pu(s,o,l,i||"inset",a);if(!f)return!1;var p=f.clipText,v=f.type,h=f.poses,g=J(t,"onClipStart",dt(t,e,{clipType:v,clipStyle:p,poses:h.map(function(m){return m.pos})}));return g===!1?(d.isClipStart=!1,!1):(d.isControl=u&&u.indexOf("clip-control")>-1,d.isLine=u.indexOf("clip-line")>-1,d.isArea=u.indexOf("clip-area")>-1||u.indexOf("clip-ellipse")>-1,d.clipIndex=c?parseInt(c.getAttribute("data-clip-index"),10):-1,d.clipPath=f,d.isClipStart=!0,r.clipPathState=p,vr(t,e),!0)},dragControl:function(t,e){var r,n,i,a=e.datas,s=e.originalDatas,o=e.isDragTarget;if(!a.isClipStart)return!1;var l=a,c=l.isControl,u=l.isLine,d=l.isArea,f=l.clipIndex,p=l.clipPath;if(!p)return!1;var v=yr(t.props,"clippable"),h=v.keepRatio,g=0,m=0,b=s.draggable,E=Le(e);o&&b?(r=R(b.prevBeforeDist,2),g=r[0],m=r[1]):(n=R(E,2),g=n[0],m=n[1]);var C=[g,m],x=t.state,S=x.width,w=x.height,D=!d&&!c&&!u,T=p.type,A=p.poses,M=p.splitter,P=A.map(function(Mt){return Mt.pos});D&&(g=-g,m=-m);var k=!c||A[f].direction==="nesw",_=T==="inset"||T==="rect",N=A.map(function(){return[0,0]});if(c&&!k){var I=A[f],B=I.horizontal,L=I.vertical,G=[g*F(B),m*F(L)];N=E0(A,f,G,_,h)}else k&&(N=P.map(function(){return[g,m]}));var W=P.map(function(Mt,ne){return yt(Mt,N[ne])}),z=$([],R(W),!1);x.snapBoundInfos=null;var X=p.type==="circle",j=p.type==="ellipse";if(X||j){var Y=me(W),Z=F(Y.bottom-Y.top),U=F(j?Y.right-Y.left:Z),q=W[0][1]+Z,et=W[0][0]-U,at=W[0][0]+U;X&&(z.push([at,Y.bottom]),N.push([1,0])),z.push([Y.left,q]),N.push([0,1]),z.push([et,Y.bottom]),N.push([1,0])}var ot=jc((v.clipHorizontalGuidelines||[]).map(function(Mt){return xt("".concat(Mt),w)}),(v.clipVerticalGuidelines||[]).map(function(Mt){return xt("".concat(Mt),S)}),S,w),V=[],tt=[];if(X||j)V=[z[4][0],z[2][0]],tt=[z[1][1],z[3][1]];else if(_){var gt=[z[0],z[2],z[4],z[6]],st=[N[0],N[2],N[4],N[6]];V=gt.filter(function(Mt,ne){return st[ne][0]}).map(function(Mt){return Mt[0]}),tt=gt.filter(function(Mt,ne){return st[ne][1]}).map(function(Mt){return Mt[1]})}else V=z.filter(function(Mt,ne){return N[ne][0]}).map(function(Mt){return Mt[0]}),tt=z.filter(function(Mt,ne){return N[ne][1]}).map(function(Mt){return Mt[1]});var lt=[0,0],ft=Bc(ot,v.clipTargetBounds&&{left:0,top:0,right:S,bottom:w},V,tt,5,5),bt=ft.horizontal,St=ft.vertical,ut=bt.offset,Et=St.offset;if(bt.isBound&&(lt[1]+=ut),St.isBound&&(lt[0]+=Et),(j||X)&&N[0][0]===0&&N[0][1]===0){var Y=me(W),Bt=Y.bottom-Y.top,vt=j?Y.right-Y.left:Bt,Rt=St.isBound?F(Et):St.snapIndex===0?-Et:Et,wt=bt.isBound?F(ut):bt.snapIndex===0?-ut:ut;vt-=Rt,Bt-=wt,X&&(Bt=Rc(St,bt)>0?Bt:vt,vt=Bt);var At=z[0];z[1][1]=At[1]-Bt,z[2][0]=At[0]+vt,z[3][1]=At[1]+Bt,z[4][0]=At[0]-vt}else if(_&&h&&c){var Ut=R(ku(A),2),Zt=Ut[0],wr=Ut[1],ir=Zt&&wr?Zt/wr:0,Tr=A[f],Vn=Tr.direction||"",Ms=z[1][1],q=z[5][1],et=z[7][0],at=z[3][0];F(ut)<=F(Et)?ut=re(ut)*F(Et)/ir:Et=re(Et)*F(ut)*ir,Vn.indexOf("w")>-1?et-=Et:Vn.indexOf("e")>-1?at-=Et:(et+=Et/2,at-=Et/2),Vn.indexOf("n")>-1?Ms-=ut:Vn.indexOf("s")>-1?q-=ut:(Ms+=ut/2,q-=ut/2);var fb=ji(Ms,at,q,et);z.forEach(function(Ef,gb){var Os;Os=R(fb[gb].pos,2),Ef[0]=Os[0],Ef[1]=Os[1]})}else z.forEach(function(Mt,ne){var bf=N[ne];bf[0]&&(Mt[0]-=Et),bf[1]&&(Mt[1]-=ut)});var yf=$o(t,p,W),ks="".concat(T,"(").concat(yf.join(M),")");if(x.clipPathState=ks,X||j)V=[z[4][0],z[2][0]],tt=[z[1][1],z[3][1]];else if(_){var gt=[z[0],z[2],z[4],z[6]];V=gt.map(function(ne){return ne[0]}),tt=gt.map(function(ne){return ne[1]})}else V=z.map(function(Mt){return Mt[0]}),tt=z.map(function(Mt){return Mt[1]});if(x.snapBoundInfos=Bc(ot,v.clipTargetBounds&&{left:0,top:0,right:S,bottom:w},V,tt,1,1),b){var pb=x.is3d,vb=x.allMatrix,hb=pb?4:3,Ps=lt;o&&(Ps=[C[0]+lt[0]-E[0],C[1]+lt[1]-E[1]]),b.deltaOffset=Dt(vb,[Ps[0],Ps[1],0,0],hb)}return J(t,"onClip",dt(t,e,O({clipEventType:"changed",clipType:T,poses:W,clipStyle:ks,clipStyles:yf,distX:g,distY:m},ee((i={},i[T==="rect"?"clip":"clipPath"]=ks,i),e)))),!0},dragControlEnd:function(t,e){this.unset(t);var r=e.isDrag,n=e.datas,i=e.isDouble,a=n.isLine,s=n.isClipStart,o=n.isControl;return s?(J(t,"onClipEnd",pe(t,e,{})),i&&(o?S0(t,e):a&&C0(t,e)),i||r):!1},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},D0={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(t,e){return e.isRequest?e.requestAble==="originDraggable":Gt(e.inputEvent.target,nt("origin"))},dragControlStart:function(t,e){var r=e.datas;vr(t,e);var n=dt(t,e,{dragStart:te.dragStart(t,new Ir().dragStart([0,0],e))}),i=J(t,"onDragOriginStart",n);return r.startOrigin=t.state.transformOrigin,r.startTargetOrigin=t.state.targetOrigin,r.prevOrigin=[0,0],r.isDragOrigin=!0,i===!1?(r.isDragOrigin=!1,!1):n},dragControl:function(t,e){var r=e.datas,n=e.isPinch,i=e.isRequest;if(!r.isDragOrigin)return!1;var a=R(Le(e),2),s=a[0],o=a[1],l=t.state,c=l.width,u=l.height,d=l.offsetMatrix,f=l.targetMatrix,p=l.is3d,v=t.props.originRelative,h=v===void 0?!0:v,g=p?4:3,m=[s,o];if(i){var b=e.distOrigin;(b[0]||b[1])&&(m=b)}var E=yt(r.startOrigin,m),C=yt(r.startTargetOrigin,m),x=it(m,r.prevOrigin),S=Mn(d,f,E,g),w=t.getRect(),D=me(mr(S,c,u,g)),T=[w.left-D.left,w.top-D.top];r.prevOrigin=m;var A=[ke(C[0],c,h),ke(C[1],u,h)].join(" "),M=te.drag(t,An(e,t.state,T,!!n,!1)),P=dt(t,e,O(O({width:c,height:u,origin:E,dist:m,delta:x,transformOrigin:A,drag:M},ee({transformOrigin:A,transform:M.transform},e)),{afterTransform:M.transform}));return J(t,"onDragOrigin",P),P},dragControlEnd:function(t,e){var r=e.datas;return r.isDragOrigin?(J(t,"onDragOriginEnd",pe(t,e,{})),!0):!1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){var r=this.dragControlStart(t,e);return!!r},dragGroupControl:function(t,e){var r=this.dragControl(t,e);return r?(t.transformOrigin=r.transformOrigin,!0):!1},request:function(t){var e={},r=t.getRect(),n=0,i=0,a=r.transformOrigin,s=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(o){return"deltaOrigin"in o?(s[0]+=o.deltaOrigin[0],s[1]+=o.deltaOrigin[1]):"origin"in o?(s[0]=o.origin[0]-a[0],s[1]=o.origin[1]-a[1]):("x"in o?n=o.x-r.left:"deltaX"in o&&(n+=o.deltaX),"y"in o?i=o.y-r.top:"deltaY"in o&&(i+=o.deltaY)),{datas:e,distX:n,distY:i,distOrigin:s}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function w0(t,e,r,n){var i=t.filter(function(l){var c=l.virtual,u=l.horizontal;return u&&!c}).length,a=t.filter(function(l){var c=l.virtual,u=l.vertical;return u&&!c}).length,s=-1;if(e===0&&(i===0?s=0:i===1&&(s=1)),e===2&&(i<=2?s=2:i<=3&&(s=3)),e===3&&(a===0?s=4:a<4&&(s=7)),e===1&&(a<=1?s=5:a<=2&&(s=6)),!(s===-1||!t[s].virtual)){var o=t[s];T0(t,s),s<4?o.pos[0]=r:o.pos[1]=n}}function T0(t,e){e<4?t.slice(0,e+1).forEach(function(r){r.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach(function(r){r.virtual=!1}))}function A0(t,e){e<4?t.slice(e,4).forEach(function(r){r.virtual=!0}):t.slice(e).forEach(function(r){r.virtual=!0})}function Ou(t,e,r,n,i){n===void 0&&(n=[0,0]);var a=[];return!t||t==="0px"?a=[]:a=Ve(t),Mu(a,e,r,0,0,n,i)}function Ru(t,e,r,n,i){var a=t.state,s=a.width,o=a.height,l=Vo(i,t.props.roundRelative,s,o),c=l.raws,u=l.styles,d=l.radiusPoses,f=m0(d,c),p=f.horizontals,v=f.verticals,h=u.join(" ");a.borderRadiusState=h;var g=dt(t,e,O({horizontals:p,verticals:v,borderRadius:h,width:s,height:o,delta:n,dist:r},ee({borderRadius:h},e)));return J(t,"onRound",g),g}function _u(t){var e,r,n=t.getState().style,i=n.borderRadius||"";if(!i&&t.props.groupable){var a=t.moveables[0],s=t.getTargets()[0];s&&(a?.props.target===s?(i=(r=(e=t.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&r!==void 0?r:"",n.borderRadius=i):(i=Io(s).borderRadius,n.borderRadius=i))}return i}var M0={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(t){var e=t.props.roundClickable;return e===!0||e==="line"?nt("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(t,e){var r=t.getState(),n=r.target,i=r.width,a=r.height,s=r.allMatrix,o=r.is3d,l=r.left,c=r.top,u=r.borderRadiusState,d=t.props,f=d.minRoundControls,p=f===void 0?[0,0]:f,v=d.maxRoundControls,h=v===void 0?[4,4]:v,g=d.zoom,m=d.roundPadding,b=m===void 0?0:m,E=d.isDisplayShadowRoundControls,C=d.groupable;if(!n)return null;var x=u||_u(t),S=o?4:3,w=Ou(x,i,a,p,!0);if(!w)return null;var D=0,T=0,A=C?[0,0]:[l,c];return w.map(function(M,P){var k=M.horizontal,_=M.vertical,N=M.direction||"",I=$([],R(M.pos),!1);T+=Math.abs(k),D+=Math.abs(_),k&&N.indexOf("n")>-1&&(I[1]-=b),_&&N.indexOf("w")>-1&&(I[0]-=b),k&&N.indexOf("s")>-1&&(I[1]+=b),_&&N.indexOf("e")>-1&&(I[0]+=b);var B=it(Nt(s,I,S),A),L=E&&E!=="horizontal",G=M.vertical?D<=h[1]&&(L||!M.virtual):T<=h[0]&&(E||!M.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(P),className:nt("control","border-radius",M.vertical?"vertical":"",M.virtual?"virtual":""),"data-radius-index":P,style:{display:G?"block":"none",transform:"translate(".concat(B[0],"px, ").concat(B[1],"px) scale(").concat(g,")")}})})},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var r=e.inputEvent.target.getAttribute("class")||"";return r.indexOf("border-radius")>-1||r.indexOf("moveable-line")>-1&&r.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragControlStart:function(t,e){var r=e.inputEvent,n=e.datas,i=r.target,a=i.getAttribute("class")||"",s=a.indexOf("border-radius")>-1,o=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,l=s?parseInt(i.getAttribute("data-radius-index"),10):-1,c=-1;if(o){var u=i.getAttribute("data-line-key")||"";u&&(c=parseInt(u.replace(/render-line-/g,""),10),isNaN(c)&&(c=-1))}if(!s&&!o)return!1;var d=dt(t,e,{}),f=J(t,"onRoundStart",d);if(f===!1)return!1;n.lineIndex=c,n.controlIndex=l,n.isControl=s,n.isLine=o,vr(t,e);var p=t.props,v=p.roundRelative,h=p.minRoundControls,g=h===void 0?[0,0]:h,m=t.state,b=m.width,E=m.height;n.isRound=!0,n.prevDist=[0,0];var C=_u(t),x=Ou(C||"",b,E,g,!0)||[];return n.controlPoses=x,m.borderRadiusState=Vo(x,v,b,E).styles.join(" "),d},dragControl:function(t,e){var r=e.datas,n=r.controlPoses;if(!r.isRound||!r.isControl||!n.length)return!1;var i=r.controlIndex,a=R(Le(e),2),s=a[0],o=a[1],l=[s,o],c=it(l,r.prevDist),u=t.props.maxRoundControls,d=u===void 0?[4,4]:u,f=t.state,p=f.width,v=f.height,h=n[i],g=h.vertical,m=h.horizontal,b=n.map(function(C){var x=C.horizontal,S=C.vertical,w=[x*m*l[0],S*g*l[1]];if(x){if(d[0]===1)return w;if(d[0]<4&&x!==m)return w}else{if(d[1]===0)return w[1]=S*m*l[0]/p*v,w;if(g){if(d[1]===1)return w;if(d[1]<4&&S!==g)return w}}return[0,0]});b[i]=l;var E=n.map(function(C,x){return O(O({},C),{pos:yt(C.pos,b[x])})});return i<4?E.slice(0,i+1).forEach(function(C){C.virtual=!1}):E.slice(4,i+1).forEach(function(C){C.virtual=!1}),r.prevDist=[s,o],Ru(t,e,l,c,E)},dragControlEnd:function(t,e){var r=t.state;r.borderRadiusState="";var n=e.datas,i=e.isDouble;if(!n.isRound)return!1;var a=n.isControl,s=n.controlIndex,o=n.isLine,l=n.lineIndex,c=n.controlPoses,u=c.filter(function(m){var b=m.virtual;return b}).length,d=t.props.roundClickable,f=d===void 0?!0:d;if(i&&f){if(a&&(f===!0||f==="control"))A0(c,s);else if(o&&(f===!0||f==="line")){var p=R(cc(t,e),2),v=p[0],h=p[1];w0(c,l,v,h)}u!==c.filter(function(m){var b=m.virtual;return b}).length&&Ru(t,e,[0,0],[0,0],c)}var g=pe(t,e,{});return J(t,"onRoundEnd",g),r.borderRadiusState="",g},dragGroupControlStart:function(t,e){var r=this.dragControlStart(t,e);if(!r)return!1;var n=t.moveables,i=t.props.targets,a=Me(t,"roundable",e),s=O({targets:t.props.targets,events:a.map(function(o,l){return O(O({},o),{target:i[l],moveable:n[l],currentTarget:n[l]})})},r);return J(t,"onRoundGroupStart",s),r},dragGroupControl:function(t,e){var r=this.dragControl(t,e);if(!r)return!1;var n=t.moveables,i=t.props.targets,a=Me(t,"roundable",e),s=O({targets:t.props.targets,events:a.map(function(o,l){return O(O(O({},o),{target:i[l],moveable:n[l],currentTarget:n[l]}),ee({borderRadius:r.borderRadius},o))})},r);return J(t,"onRoundGroup",s),s},dragGroupControlEnd:function(t,e){var r=t.moveables,n=t.props.targets,i=Me(t,"roundable",e);Yi(t,"onRound",function(o){var l=O({targets:t.props.targets,events:i.map(function(c,u){return O(O(O({},c),{target:n[u],moveable:r[u],currentTarget:r[u]}),ee({borderRadius:o.borderRadius},c))})},o);J(t,"onRoundGroup",l)});var a=this.dragControlEnd(t,e);if(!a)return!1;var s=O({targets:t.props.targets,events:i.map(function(o,l){var c;return O(O({},o),{target:n[l],moveable:r[l],currentTarget:r[l],lastEvent:(c=o.datas)===null||c===void 0?void 0:c.lastEvent})})},a);return J(t,"onRoundGroupEnd",s),s},unset:function(t){t.state.borderRadiusState=""}};function k0(t,e){var r=e?4:3,n=Ot(r),i="matrix".concat(e?"3d":"","(").concat(n.join(","),")");return t===i||t==="matrix(1,0,0,1,0,0)"}var Nu={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(t,e){var r=t.state,n=r.is3d,i=r.targetMatrix,a=r.inlineTransform,s=n?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(Hl(i,!0),")"),o=!a||a==="none"?s:a;e.datas.startTransforms=k0(o,n)?[]:Ve(o)},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return dt(t,e,{setTransform:function(r){e.datas.startTransforms=Lt(r)?r:Ve(r)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return dt(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),this.resetStyle(e),J(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){e.datas.startTransforms||this.setTransform(t,e),this.resetStyle(e),J(t,"onBeforeRender",dt(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){e.datas.startTransforms||(this.setTransform(t,e),this.resetStyle(e)),J(t,"onBeforeRenderEnd",dt(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var r=this;this.dragStart(t,e);var n=Me(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var l=i[o];return r.setTransform(l,s),r.resetStyle(s),r.fillDragStartParams(l,s)});J(t,"onBeforeRenderGroupStart",dt(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:a}))},dragGroup:function(t,e){var r=this;this.drag(t,e);var n=Me(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var l=i[o];return r.resetStyle(s),r.fillDragParams(l,s)});J(t,"onBeforeRenderGroup",dt(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:a}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),J(t,"onBeforeRenderGroupEnd",dt(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},Lu={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(t,e){J(t,"onRenderStart",dt(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){J(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){return this.drag(t,e)},dragEnd:function(t,e){J(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){J(t,"onRenderGroupStart",dt(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var r=this,n=Me(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var l=i[o];return r.fillDragParams(l,s)});J(t,"onRenderGroup",dt(t,e,O(O({isPinch:!!e.isPinch,targets:t.props.targets,transform:ki(e),transformObject:{}},ee(Pi(e))),{events:a})))},dragGroupEnd:function(t,e){var r=this,n=Me(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var l=i[o];return r.fillDragEndParams(l,s)});J(t,"onRenderGroupEnd",dt(t,e,O({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:a,transformObject:{},transform:ki(e)},ee(Pi(e)))))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){var r={};return Rr(Mi(e)||[]).forEach(function(n){r[n.name]=n.functionValue}),dt(t,e,O({isPinch:!!e.isPinch,transformObject:r,transform:ki(e)},ee(Pi(e))))},fillDragEndParams:function(t,e){var r={};return Rr(Mi(e)||[]).forEach(function(n){r[n.name]=n.functionValue}),dt(t,e,O({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:r,transform:ki(e)},ee(Pi(e))))}};function zn(t,e,r,n,i,a,s){a.clientDistX=a.distX,a.clientDistY=a.distY;var o=i==="Start",l=i==="End",c=i==="After",u=t.state.target,d=a.isRequest,f=n.indexOf("Control")>-1;if(!u||o&&f&&!d&&t.areaElement===a.inputEvent.target)return!1;var p=$([],R(e),!1);if(d){var v=a.requestAble;p.some(function(P){return P.name===v})||p.push.apply(p,$([],R(t.props.ables.filter(function(P){return P.name===v})),!1))}if(!p.length||p.every(function(P){return P.dragRelation}))return!1;var h=a.inputEvent,g;l&&h&&(g=document.elementFromPoint(a.clientX,a.clientY)||h.target);var m=!1,b=function(){var P;m=!0,(P=a.stop)===null||P===void 0||P.call(a)},E=o&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());E&&t.updateRect(i,!0,!1);var C=a.datas,x=f?"controlGesto":"targetGesto",S=t[x],w=function(P,k,_){if(!(k in P)||S!==t[x])return!1;var N=P.name,I=C[N]||(C[N]={});if(o&&(I.isEventStart=!_||!P[_]||P[_](t,a)),!I.isEventStart)return!1;var B=P[k](t,O(O({},a),{stop:b,datas:I,originalDatas:C,inputTarget:g}));return t._emitter.off(),o&&B===!1&&(I.isEventStart=!1),B};E&&p.forEach(function(P){P.unset&&P.unset(t)}),w(Nu,"drag".concat(n).concat(i));var D=0,T=0;r.forEach(function(P){if(m)return!1;var k="".concat(P).concat(n).concat(i),_="".concat(P).concat(n,"Condition");i===""&&!d&&vu(t.state,a);var N=p.filter(function(L){return L[k]});N=N.filter(function(L,G){return L.name&&N.indexOf(L)===G});var I=N.filter(function(L){return w(L,k,_)}),B=I.length;m&&++D,B&&++T,!m&&o&&N.length&&!B&&(D+=N.filter(function(L){var G=L.name,W=C[G];return W.isEventStart?L.dragRelation!=="strong":!1}).length?1:0)}),(!c||T)&&w(Lu,"drag".concat(n).concat(i));var A=S!==t[x]||D===r.length;if((l||m||A)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(function(P){P.state.gestos={}}),p.forEach(function(P){P.unset&&P.unset(t)})),o&&!A&&!d&&T&&t.props.preventDefault&&a?.preventDefault(),t.isUnmounted||A)return!1;if(!o&&T&&!s||l){var M=t.props.flushSync||tu;M(function(){t.updateRect(l?i:"",!0,!1),t.forceUpdate()})}return!o&&!l&&!c&&T&&!s&&zn(t,e,r,n,i+"After",a),!0}function jo(t,e){return function(r,n){var i;n===void 0&&(n=r.inputEvent.target);var a=n,s=t.areaElement,o=t._dragTarget;return!o||!e&&(!((i=t.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===o||o.contains(a)||a===s||!t.isMoveableElement(a)&&!t.controlBox.contains(a)||Gt(a,"moveable-area")||Gt(a,"moveable-padding")||Gt(a,"moveable-edgeDraggable")}}function zu(t,e,r){var n=t.controlBox,i=[],a=t.props,s=a.dragArea,o=t.state.target,l=a.dragTarget;i.push(n),(!s||l)&&i.push(e),!s&&l&&o&&e!==o&&a.dragTargetSelf&&i.push(o);var c=jo(t);return Bu(t,i,"targetAbles",r,{dragStart:c,pinchStart:c})}function Iu(t,e){var r=t.controlBox,n=[];n.push(r);var i=jo(t,!0),a=function(s,o){if(o===void 0&&(o=s.inputEvent.target),o===r)return!0;var l=i(s,o);return!l};return Bu(t,n,"controlAbles",e,{dragStart:a,pinchStart:a})}function Bu(t,e,r,n,i){i===void 0&&(i={});var a=r==="targetAbles",s=t.props,o=s.pinchOutside,l=s.pinchThreshold,c=s.preventClickEventOnDrag,u=s.preventClickDefault,d=s.checkInput,f=s.dragFocusedInput,p=s.preventDefault,v=p===void 0?!0:p,h=s.preventRightClick,g=h===void 0?!0:h,m=s.preventWheelClick,b=m===void 0?!0:m,E=s.dragContainer,C=ze(E,!0),x={preventDefault:v,preventRightClick:g,preventWheelClick:b,container:C||fe(t.getControlBoxElement()),pinchThreshold:l,pinchOutside:o,preventClickEventOnDrag:a?c:!1,preventClickEventOnDragStart:a?u:!1,preventClickEventByCondition:a?null:function(D){return t.controlBox.contains(D.target)},checkInput:a?d:!1,dragFocusedInput:f},S=new Jl(e,x),w=n==="Control";return["drag","pinch"].forEach(function(D){["Start","","End"].forEach(function(T){S.on("".concat(D).concat(T),function(A){var M,P=A.eventType,k=D==="drag"&&A.isPinch;if(i[P]&&!i[P](A)){A.stop();return}if(!k){var _=D==="drag"?[D]:["drag",D],N=$([],R(t[r]),!1),I=zn(t,N,_,n,T,A);I?(t.props.stopPropagation||T==="Start"&&w)&&((M=A?.inputEvent)===null||M===void 0||M.stopPropagation()):A.stop()}})})}),S}var P0=function(){function t(e,r,n){var i=this;this.target=e,this.moveable=r,this.eventName=n,this.ables=[],this._onEvent=function(a){var s=i.eventName,o=i.moveable;o.state.disableNativeEvent||i.ables.forEach(function(l){l[s](o,{inputEvent:a})})},e.addEventListener(n.toLowerCase(),this._onEvent)}return t.prototype.setAbles=function(e){this.ables=e},t.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t}();function O0(t,e,r,n){var i;r===void 0&&(r=e);var a=hc(t,e),s=a.matrixes,o=a.is3d,l=a.targetMatrix,c=a.transformOrigin,u=a.targetOrigin,d=a.offsetContainer,f=a.hasFixed,p=a.zoom,v=Vh(d,r),h=v.matrixes,g=v.is3d,m=v.offsetContainer,b=v.zoom,E=n||g||o,C=E?4:3,x=t.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in t,S=l,w=Ot(C),D=Ot(C),T=Ot(C),A=Ot(C),M=s.length,P=h.map(function(G){return O(O({},G),{matrix:G.matrix?$([],R(G.matrix),!1):void 0})}).reverse();s.reverse(),!o&&E&&(S=Ae(S,3,4),Ro(s)),!g&&E&&Ro(P),P.forEach(function(G){D=Dt(D,G.matrix,C)});var k=r||je(t),_=((i=P[0])===null||i===void 0?void 0:i.target)||_n(k,k,!0).offsetParent,N=P.slice(1).reduce(function(G,W){return Dt(G,W.matrix,C)},Ot(C));s.forEach(function(G,W){if(M-2===W&&(T=w.slice()),M-1===W&&(A=w.slice()),!G.matrix){var z=s[W+1],X=Ug(G,z,_,C,Dt(N,w,C));G.matrix=cr(X,C)}w=Dt(w,G.matrix,C)});var I=!x&&o;S||(S=Ot(I?4:3));var B=Fi(x&&S.length===16?Ae(S,4,3):S,I),L=D;return D=Yl(D,C,C),{hasZoom:p!==1||b!==1,hasFixed:f,matrixes:s,rootMatrix:D,originalRootMatrix:L,beforeMatrix:T,offsetMatrix:A,allMatrix:w,targetMatrix:S,targetTransform:B,inlineTransform:t.style.transform,transformOrigin:c,targetOrigin:u,is3d:E,offsetContainer:d,offsetRootContainer:m}}function Gu(t,e,r,n){r===void 0&&(r=e);var i=0,a=0,s=0,o={},l=au(t);if(t&&(i=l.offsetWidth,a=l.offsetHeight),t){var c=O0(t,e,r,n),u=Br(c.allMatrix,c.transformOrigin,i,a);o=O(O({},c),u);var d=Br(c.allMatrix,[50,50],100,100);s=ou([d.pos1,d.pos2],d.direction)}var f=n?4:3;return O(O(O({hasZoom:!1,width:i,height:a,rotation:s},l),{originalRootMatrix:Ot(f),rootMatrix:Ot(f),beforeMatrix:Ot(f),offsetMatrix:Ot(f),allMatrix:Ot(f),targetMatrix:Ot(f),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!n,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),o)}function nE(t,e,r){return r===void 0&&(r=e),Gu(t,e,r,!0)}function Uo(t,e,r,n,i,a){a===void 0&&(a=[]);var s=1,o=[0,0],l=Wi(),c=Wi(),u=Wi(),d=Wi(),f=[0,0],p={},v=Gu(e,r,i,!0);if(e){var h=se(e);a.forEach(function(P){p[P]=h(P)});var g=v.is3d?4:3,m=Br(v.offsetMatrix,yt(v.transformOrigin,Xl(v.targetMatrix,g)),v.width,v.height);s=m.direction,o=yt(m.origin,[m.left-v.left,m.top-v.top]),d=Ln(v.offsetRootContainer);var b=_n(n,n,!0).offsetParent||v.offsetRootContainer;if(v.hasZoom){var E=Br(Dt(v.originalRootMatrix,v.allMatrix),v.transformOrigin,v.width,v.height),C=Br(v.originalRootMatrix,Gi(se(b)("transformOrigin")).map(function(P){return parseFloat(P)}),b.offsetWidth,b.offsetHeight);if(l=No(E,d),u=No(C,d,b,!0),t){var x=E.left,S=E.top;c=No({left:x,top:S,bottom:S,right:S},d)}}else{l=Ln(e),u=Hh(b),t&&(c=Ln(t));var w=u.left,D=u.top,T=u.clientLeft,A=u.clientTop,M=[l.left-w,l.top-D];f=it(Vr(v.rootMatrix,M,4),[T+v.left,A+v.top])}}return O({targetClientRect:l,containerClientRect:u,moveableClientRect:c,rootContainerClientRect:d,beforeDirection:s,beforeOrigin:o,originalBeforeOrigin:o,target:e,style:p,offsetDelta:f},v)}function Fu(t){var e=t.pos1,r=t.pos2,n=t.pos3,i=t.pos4;if(!e||!r||!n||!i)return null;var a=fr([e,r,n,i]),s=[a.minX,a.minY],o=it(t.origin,s);return e=it(e,s),r=it(r,s),n=it(n,s),i=it(i,s),O(O({},t),{left:t.left,top:t.top,posDelta:s,pos1:e,pos2:r,pos3:n,pos4:i,origin:o,beforeOrigin:o,isPersisted:!0})}var jr=function(t){Lr(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.state=O({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},Uo(null)),r.renderState={},r.enabledAbles=[],r.targetAbles=[],r.controlAbles=[],r.rotation=0,r.scale=[1,1],r.isMoveableMounted=!1,r.isUnmounted=!1,r.events={mouseEnter:null,mouseLeave:null},r._emitter=new xn,r._prevOriginalDragTarget=null,r._originalDragTarget=null,r._prevDragTarget=null,r._dragTarget=null,r._prevPropTarget=null,r._propTarget=null,r._prevDragArea=!1,r._isPropTargetChanged=!1,r._hasFirstTarget=!1,r._reiszeObserver=null,r._observerId=0,r._mutationObserver=null,r._rootContainer=null,r._viewContainer=null,r._viewClassNames=[],r._store={},r.checkUpdateRect=function(){if(!r.isDragging()){var n=r.props.parentMoveable;if(n){n.checkUpdateRect();return}Wp(r._observerId),r._observerId=ul(function(){r.isDragging()||r.updateRect()})}},r._onPreventClick=function(n){n.stopPropagation(),n.preventDefault()},r}return e.prototype.render=function(){var r=this.props,n=this.getState(),i=r.parentPosition,a=r.className,s=r.target,o=r.zoom,l=r.cspNonce,c=r.translateZ,u=r.cssStyled,d=r.groupable,f=r.linePadding,p=r.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var v=R(i||[0,0],2),h=v[0],g=v[1],m=n.left,b=n.top,E=n.target,C=n.direction,x=n.hasFixed,S=n.offsetDelta,w=r.targets,D=this.isDragging(),T={};this.getEnabledAbles().forEach(function(N){T["data-able-".concat(N.name.toLowerCase())]=!0});var A=this._getAbleClassName(),M=w&&w.length&&(E||d)||s||!this._hasFirstTarget&&this.state.isPersisted,P=this.controlBox||this.props.firstRenderState||this.props.persistData,k=[m-h,b-g];!d&&r.useAccuratePosition&&(k[0]+=S[0],k[1]+=S[1]);var _={position:x?"fixed":"absolute",display:M?"block":"none",visibility:P?"visible":"hidden",transform:"translate3d(".concat(k[0],"px, ").concat(k[1],"px, ").concat(c,")"),"--zoom":o,"--zoompx":"".concat(o,"px")};return f&&(_["--moveable-line-padding"]=f),p&&(_["--moveable-control-padding"]=p),ge(u,O({cspNonce:l,ref:Ge(this,"controlBox"),className:"".concat(nt("control-box",C===-1?"reverse":"",D?"dragging":"")," ").concat(A," ").concat(a)},T,{onClick:this._onPreventClick,style:_}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var r=this.props,n=r.parentMoveable,i=r.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!n&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(r){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(r)},e.prototype.componentWillUnmount=function(){var r,n;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(r=this._reiszeObserver)===null||r===void 0||r.disconnect(),(n=this._mutationObserver)===null||n===void 0||n.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Xr(this,!1),Xr(this,!0);var a=this.events;for(var s in a){var o=a[s];o&&o.destroy()}},e.prototype.getTargets=function(){var r=this.props.target;return r?[r]:[]},e.prototype.getAble=function(r){var n=this.props.ables||[];return ae(n,function(i){return i.name===r})},e.prototype.getContainer=function(){var r=this.props,n=r.parentMoveable,i=r.wrapperMoveable,a=r.container;return a||i&&i.getContainer()||n&&n.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(r){var n;return r&&(((n=r.getAttribute)===null||n===void 0?void 0:n.call(r,"class"))||"").indexOf(so)>-1},e.prototype.dragStart=function(r,n){n===void 0&&(n=r.target);var i=this.targetGesto,a=this.controlGesto;return i&&jo(this)({inputEvent:r},n)?i.isFlag()||i.triggerDragStart(r):a&&this.isMoveableElement(n)&&(a.isFlag()||a.triggerDragStart(r)),this},e.prototype.hitTest=function(r){var n=this.state,i=n.target,a=n.pos1,s=n.pos2,o=n.pos3,l=n.pos4,c=n.targetClientRect;if(!i)return 0;var u;if(Ue(r)){var d=r.getBoundingClientRect();u={left:d.left,top:d.top,width:d.width,height:d.height}}else u=O({width:0,height:0},r);var f=u.left,p=u.top,v=u.width,h=u.height,g=ja([a,s,l,o],c),m=Zv(g,[[f,p],[f+v,p],[f+v,p+h],[f,p+h]]),b=Dn(g);return!m||!b?0:Math.min(100,m/b*100)},e.prototype.isInside=function(r,n){var i=this.state,a=i.target,s=i.pos1,o=i.pos2,l=i.pos3,c=i.pos4,u=i.targetClientRect;return a?bi([r,n],ja([s,o,c,l],u)):!1},e.prototype.updateRect=function(r,n,i){i===void 0&&(i=!0);var a=this.props,s=!a.parentPosition&&!a.wrapperMoveable;s&&Kr(!0);var o=a.parentMoveable,l=this.state,c=l.target||a.target,u=this.getContainer(),d=o?o._rootContainer:this._rootContainer,f=Uo(this.controlBox,c,u,u,d||u,this._getRequestStyles());if(!c&&this._hasFirstTarget&&a.persistData){var p=Fu(a.persistData);for(var v in p)f[v]=p[v]}s&&Kr(),this.updateState(f,o?!1:i)},e.prototype.isDragging=function(r){var n,i,a=this.targetGesto,s=this.controlGesto;if(a?.isFlag()){if(!r)return!0;var o=a.getEventData();return!!(!((n=o[r])===null||n===void 0)&&n.isEventStart)}if(s?.isFlag()){if(!r)return!0;var o=s.getEventData();return!!(!((i=o[r])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(r){this.updateRect(r,!0)},e.prototype.getRect=function(){var r=this.state,n=be(this.state),i=R(n,4),a=i[0],s=i[1],o=i[2],l=i[3],c=me(n),u=r.width,d=r.height,f=c.width,p=c.height,v=c.left,h=c.top,g=[r.left,r.top],m=yt(g,r.origin),b=yt(g,r.beforeOrigin),E=r.transformOrigin;return{width:f,height:p,left:v,top:h,pos1:a,pos2:s,pos3:o,pos4:l,offsetWidth:u,offsetHeight:d,beforeOrigin:b,origin:m,transformOrigin:E,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(r){if(!r||r==="target"){var n=this.targetGesto;n?.isIdle()===!1&&zo(this,!1),n?.stop()}if(!r||r==="control"){var n=this.controlGesto;n?.isIdle()===!1&&zo(this,!0),n?.stop()}},e.prototype.getRotation=function(){var r=this.state,n=r.pos1,i=r.pos2,a=r.direction;return e0(n,i,a)},e.prototype.request=function(r,n,i){n===void 0&&(n={});var a=this,s=a.props,o=s.parentMoveable||s.wrapperMoveable||a,l=o.props.ables,c=s.groupable,u=ae(l,function(m){return m.name===r});if(this.isDragging()||!u||!u.request)return{request:function(){return this},requestEnd:function(){return this}};var d=u.request(a),f=i||n.isInstant,p=d.isControl?"controlAbles":"targetAbles",v="".concat(c?"Group":"").concat(d.isControl?"Control":""),h=$([],R(o[p]),!1),g={request:function(m){return zn(a,h,["drag"],v,"",O(O({},d.request(m)),{requestAble:r,isRequest:!0}),f),g},requestEnd:function(){return zn(a,h,["drag"],v,"End",O(O({},d.requestEnd()),{requestAble:r,isRequest:!0}),f),g}};return zn(a,h,["drag"],v,"Start",O(O({},d.requestStart(n)),{requestAble:r,isRequest:!0}),f),f?g.request(n).requestEnd():g},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var r=this.getState(),n=this.props,i=n.padding,a=r.originalBeforeOrigin,s=r.transformOrigin,o=r.allMatrix,l=r.is3d,c=r.pos1,u=r.pos2,d=r.pos3,f=r.pos4,p=r.left,v=r.top,h=r.isPersisted,g=n.zoom||1;if(!i&&g<=1){r.renderPoses=[c,u,d,f],r.renderLines=[[c,u],[u,f],[f,d],[d,c]];return}var m=bu(i||{}),b=m.left,E=m.top,C=m.bottom,x=m.right,S=l?4:3,w=[];h?w=s:this.controlBox&&n.groupable?w=a:w=yt(a,[p,v]);var D=hi(S,cr(w.map(function(_){return-_}),S),o,cr(s,S)),T=Ee(D,c,[-b,-E],S),A=Ee(D,u,[x,-E],S),M=Ee(D,d,[-b,C],S),P=Ee(D,f,[x,C],S);if(r.renderPoses=[T,A,M,P],r.renderLines=[[T,A],[A,P],[P,M],[M,T]],g){var k=g/2;r.renderLines=[[Ee(D,c,[-b-k,-E],S),Ee(D,u,[x+k,-E],S)],[Ee(D,u,[x,-E-k],S),Ee(D,f,[x,C+k],S)],[Ee(D,f,[x+k,C],S),Ee(D,d,[-b-k,C],S)],[Ee(D,d,[-b,C+k],S),Ee(D,c,[-b,-E-k],S)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var r=this.props,n=r.target,i=r.container,a=r.parentMoveable,s=this.state,o=s.target,l=s.container;if(!(!o&&!n)){this.updateAbles();var c=!Bo(o,n),u=c||!Bo(l,i);if(u){var d=i||this.controlBox;d&&this.unsetAbles(),this.updateState({target:n,container:i}),!a&&d&&this.updateRect("End",!1,!1),this._isPropTargetChanged=c}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(r,n){var i=this.props;if(this._emitter.trigger(r,n),i.parentMoveable&&n.isRequest&&!n.isRequestChild)return i.parentMoveable.triggerEvent(r,n,!0);var a=i[r];return a&&a(n)},e.prototype.useCSS=function(r,n){var i=this.props.customStyledMap,a=r+n;return i[a]||(i[a]=ec(r,n)),i[a]},e.prototype.getState=function(){var r,n=this.props;(n.target||!((r=n.targets)===null||r===void 0)&&r.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=n.persistData,s=n.firstRenderState;if(s&&!i)return s;if(!this._hasFirstTarget&&a){var o=Fu(a);if(o)return this.updateState(o,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var r=this;this.targetAbles.forEach(function(n){n.unset&&n.unset(r)})},e.prototype.updateAbles=function(r,n){r===void 0&&(r=this.props.ables),n===void 0&&(n="");var i=this.props,a=i.triggerAblesSimultaneously,s=this.getEnabledAbles(r),o="drag".concat(n,"Start"),l="pinch".concat(n,"Start"),c="drag".concat(n,"ControlStart"),u=Xi(s,[o,l],a),d=Xi(s,[c],a);this.enabledAbles=s,this.targetAbles=u,this.controlAbles=d},e.prototype.updateState=function(r,n){if(n){if(this.isUnmounted)return;this.setState(r)}else{var i=this.state;for(var a in r)i[a]=r[a]}},e.prototype.getEnabledAbles=function(r){r===void 0&&(r=this.props.ables);var n=this.props;return r.filter(function(i){return i&&(i.always&&n[i.name]!==!1||n[i.name])})},e.prototype.renderAbles=function(){var r=this,n=this.props,i=n.triggerAblesSimultaneously,a={createElement:ge};return this.renderState={},qg(pu(Xi(this.getEnabledAbles(),["render"],i).map(function(s){var o=s.render;return o(r,a)||[]})).filter(function(s){return s}),function(s){var o=s.key;return o}).map(function(s){return s[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var r=this.getEnabledAbles().reduce(function(n,i){var a,s,o=(s=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return $($([],R(n),!1),R(o),!1)},$([],R(this.props.requestStyles||[]),!1));return r},e.prototype._updateObserver=function(r){this._updateResizeObserver(r),this._updateMutationObserver(r)},e.prototype._updateEvents=function(){var r=this.targetAbles.length,n=this.controlAbles.length,i=this._dragTarget,a=!r&&this.targetGesto||this._isTargetChanged(!0);a&&(Xr(this,!1),this.updateState({gestos:{}})),n||Xr(this,!0),i&&r&&!this.targetGesto&&(this.targetGesto=zu(this,i,"")),!this.controlGesto&&n&&(this.controlGesto=Iu(this,"Control"))},e.prototype._updateTargets=function(){var r=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=r.dragArea,this._propTarget=r.target,this._originalDragTarget=r.dragTarget||r.target,this._dragTarget=ze(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var r=this.props,n=r,i=n.zoom,a=n.hideDefaultLines,s=n.hideChildMoveableDefaultLines,o=n.parentMoveable;if(a||o&&s)return[];var l=this.getState(),c={createElement:ge};return l.renderLines.map(function(u,d){return kn(c,"",u[0],u[1],i,"render-line-".concat(d))})},e.prototype._isTargetChanged=function(r){var n=this.props,i=n.dragTarget||n.target,a=this._prevOriginalDragTarget,s=this._prevDragArea,o=n.dragArea,l=!o&&a!==i,c=(r||o)&&s!==o;return l||c||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var r=this,n=this.props,i=n.dragArea?this.areaElement:this.state.target,a=this.events,s=_e(a);if(this._isTargetChanged())for(var o in a){var l=a[o];l&&l.destroy(),a[o]=null}if(i){var c=this.enabledAbles;s.forEach(function(u){var d=Xi(c,[u]),f=d.length>0,p=a[u];if(!f){p&&(p.destroy(),a[u]=null);return}p||(p=new P0(i,r,u),a[u]=p),p.setAbles(d)})}},e.prototype._checkUpdateRootContainer=function(){var r=this.props.rootContainer;!this._rootContainer&&r&&(this._rootContainer=ze(r,!0))},e.prototype._checkUpdateViewContainer=function(){var r=this.props.viewContainer;!this._viewContainer&&r&&(this._viewContainer=ze(r,!0));var n=this._viewContainer;n&&this._changeAbleViewClassNames($($([],R(this._getAbleViewClassNames()),!1),[this.isDragging()?l0:""],!1))},e.prototype._changeAbleViewClassNames=function(r){var n=this._viewContainer,i=fu(r.filter(Boolean),function(c){return c}).map(function(c){var u=R(c,1),d=u[0];return d}),a=this._viewClassNames,s=hn(a,i),o=s.removed,l=s.added;o.forEach(function(c){ml(n,a[c])}),l.forEach(function(c){wa(n,i[c])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var r=this;return(this.getEnabledAbles().map(function(n){var i;return((i=n.viewClassName)===null||i===void 0?void 0:i.call(n,r))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(r){var n=this;r===void 0&&(r="");var i=this.getEnabledAbles(),a=this.targetGesto,s=this.controlGesto,o=a?.isFlag()?a.getEventData():{},l=s?.isFlag()?s.getEventData():{};return i.map(function(c){var u,d,f,p=c.name,v=((u=c.className)===null||u===void 0?void 0:u.call(c,n))||"";return(!((d=o[p])===null||d===void 0)&&d.isEventStart||!((f=l[p])===null||f===void 0)&&f.isEventStart)&&(v+=" ".concat(nt("".concat(p).concat(r,"-dragging")))),v.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(r){var n,i=this.props,a=i.target,s=fe(this.getControlBoxElement());if(!s.ResizeObserver||!a||!i.useResizeObserver){(n=this._reiszeObserver)===null||n===void 0||n.disconnect();return}if(!(r.target===a&&this._reiszeObserver)){var o=new s.ResizeObserver(this.checkUpdateRect);o.observe(a,{box:"border-box"}),this._reiszeObserver=o}},e.prototype._updateMutationObserver=function(r){var n=this,i,a=this.props,s=a.target,o=fe(this.getControlBoxElement());if(!o.MutationObserver||!s||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(r.target===s&&this._mutationObserver)){var l=new o.MutationObserver(function(c){var u,d;try{for(var f=vh(c),p=f.next();!p.done;p=f.next()){var v=p.value;v.type==="attributes"&&v.attributeName==="style"&&n.checkUpdateRect()}}catch(h){u={error:h}}finally{try{p&&!p.done&&(d=f.return)&&d.call(f)}finally{if(u)throw u.error}}});l.observe(s,{attributes:!0}),this._mutationObserver=l}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:tu,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e}(Al),Zo={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(t,e){var r,n=t.props,i=n.targets||[],a=t.getState(),s=a.left,o=a.top,l=a.isPersisted,c=n.zoom||1,u=t.renderGroupRects,d=((r=n.persistData)===null||r===void 0?void 0:r.children)||[];l?i=d.map(function(){return null}):d=[];var f=$r(t,"parentPosition",[s,o],function(v){return v.join(",")}),p=$r(t,"requestStyles",t.getRequestChildStyles(),function(v){return v.join(",")});return t.moveables=t.moveables.slice(0,i.length),$($([],R(i.map(function(v,h){return e.createElement(jr,{key:"moveable"+h,ref:rl(t,"moveables",h),target:v,origin:!1,requestStyles:p,cssStyled:n.cssStyled,customStyledMap:n.customStyledMap,useResizeObserver:n.useResizeObserver,useMutationObserver:n.useMutationObserver,hideChildMoveableDefaultLines:n.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[s,o],persistData:d[h],zoom:c})})),!1),R(pu(u.map(function(v,h){var g=v.pos1,m=v.pos2,b=v.pos3,E=v.pos4,C=[g,m,b,E];return[[0,1],[1,3],[3,2],[2,0]].map(function(x,S){var w=R(x,2),D=w[0],T=w[1];return kn(e,"",it(C[D],f),it(C[T],f),c,"group-rect-".concat(h,"-").concat(S))})}))),!1)}},R0=Tn("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var r=t.props.target,n=e.inputEvent,i=e.inputTarget,a=t.isMoveableElement(i),s=!a&&t.controlBox.contains(i);if(!(!n||!i||e.isDrag||t.isMoveableElement(i)||s)){var o=r.contains(i);J(t,"onClick",dt(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:r===i,moveableTarget:t.props.target,containsTarget:o}))}},dragGroupEnd:function(t,e){var r=e.inputEvent,n=e.inputTarget;if(!(!r||!n||e.isDrag||t.isMoveableElement(n)||e.datas.inputTarget===n)){var i=t.props.targets,a=i.indexOf(n),s=a>-1,o=!1;a===-1&&(a=Fe(i,function(l){return l.contains(n)}),o=a>-1),J(t,"onClickGroup",dt(t,e,{isDouble:e.isDouble,targets:i,inputTarget:n,targetIndex:a,isTarget:s,containsTarget:o,moveableTarget:i[a]}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function Ur(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),O(O({},t),{datas:e})}var _0=Tn("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(t,e){var r=t.props,n=r.edgeDraggable;return n?yc(e,"edgeDraggable",n,t.getState().renderPoses,r.zoom):[]},dragCondition:function(t,e){var r,n=t.props,i=(r=e.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!i?!1:!n.draggable&&Gt(i,nt("direction"))&&Gt(i,nt("edge"))&&Gt(i,nt("edgeDraggable"))},dragStart:function(t,e){return te.dragStart(t,Ur(e))},drag:function(t,e){return te.drag(t,Ur(e))},dragEnd:function(t,e){return te.dragEnd(t,Ur(e))},dragGroupCondition:function(t,e){var r,n=t.props,i=(r=e.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!i?!1:!n.draggable&&Gt(i,nt("direction"))&&Gt(i,nt("line"))},dragGroupStart:function(t,e){return te.dragGroupStart(t,Ur(e))},dragGroup:function(t,e){return te.dragGroup(t,Ur(e))},dragGroupEnd:function(t,e){return te.dragGroupEnd(t,Ur(e))},unset:function(t){return te.unset(t)}}),Ku={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},Qo=[Nu,wu,Gg,n0,te,_0,Do,i0,o0,Cg,d0,f0,c0,D0,x0,M0,Zo,Ku,R0,Du,Lu],N0=Qo.reduce(function(t,e){return(e.events||[]).forEach(function(r){hl(t,r)}),t},[]),L0=Qo.reduce(function(t,e){return(e.props||[]).forEach(function(r){hl(t,r)}),t},[]);function Wu(t,e){var r=R(t,3),n=r[0],i=r[1],a=r[2];return(n*e[0]+i*e[1]+a)/Math.sqrt(n*n+i*i)}function Ui(t,e){var r=R(t,2),n=r[0],i=r[1];return-n*e[0]-i*e[1]}function Yu(t,e){return Math.max.apply(Math,$([],R(t.map(function(r){var n=R(r,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.max(i[e],a[e],s[e],o[e])})),!1))}function Xu(t,e){return Math.min.apply(Math,$([],R(t.map(function(r){var n=R(r,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.min(i[e],a[e],s[e],o[e])})),!1))}function z0(t,e){var r,n,i,a=[0,0],s=[0,0],o=[0,0],l=[0,0],c=0,u=0;if(!t.length)return{pos1:a,pos2:s,pos3:o,pos4:l,minX:0,minY:0,maxX:0,maxY:0,width:c,height:u,rotation:e};var d=ct(e,Jt);if(d%90){var f=d/180*Math.PI,p=Math.tan(f),v=-1/p,h=[co,oc],g=[[0,0],[0,0]],m=[co,oc],b=[[0,0],[0,0]];t.forEach(function(j){j.forEach(function(Y){var Z=Wu([-p,1,0],Y),U=Wu([-v,1,0],Y);h[0]>Z&&(g[0]=Y,h[0]=Z),h[1]<Z&&(g[1]=Y,h[1]=Z),m[0]>U&&(b[0]=Y,m[0]=U),m[1]<U&&(b[1]=Y,m[1]=U)})});var E=R(g,2),C=E[0],x=E[1],S=R(b,2),w=S[0],D=S[1],T=[-p,1,Ui([-p,1],C)],A=[-p,1,Ui([-p,1],x)],M=[-v,1,Ui([-v,1],w)],P=[-v,1,Ui([-v,1],D)];r=R([[T,M],[T,P],[A,M],[A,P]].map(function(j){var Y=R(j,2),Z=Y[0],U=Y[1];return Ei(Z,U)[0]}),4),a=r[0],s=r[1],o=r[2],l=r[3],c=m[1]-m[0],u=h[1]-h[0]}else{var k=Xu(t,0),_=Xu(t,1),N=Yu(t,0),I=Yu(t,1);if(a=[k,_],s=[N,_],o=[k,I],l=[N,I],c=N-k,u=I-_,d%180){var B=[o,a,l,s];n=R(B,4),a=n[0],s=n[1],o=n[2],l=n[3],c=I-_,u=N-k}}if(d%360>180){var B=[l,o,s,a];i=R(B,4),a=i[0],s=i[1],o=i[2],l=i[3]}var L=fr([a,s,o,l]),G=L.minX,W=L.minY,z=L.maxX,X=L.maxY;return{pos1:a,pos2:s,pos3:o,pos4:l,width:c,height:u,minX:G,minY:W,maxX:z,maxY:X,rotation:e}}function Hu(t,e){var r=e.map(function(n){if(Lt(n)){var i=Hu(t,n),a=i.length;return a>1?i:a===1?i[0]:null}else{var s=ae(t,function(o){var l=o.manager;return l.props.target===n});return s?(s.finded=!0,s.manager):null}}).filter(Boolean);return r.length===1&&Lt(r[0])?r[0]:r}var I0=function(t){Lr(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.differ=new $l,r.moveables=[],r.transformOrigin="50% 50%",r.renderGroupRects=[],r._targetGroups=[],r._hasFirstTargets=!1,r}return e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(r,n,i){var a;i===void 0&&(i=!0);var s=this.state;if(!this.controlBox||s.isPersisted)return;Kr(!0),this.moveables.forEach(function(et){et.updateRect(r,!1,!1)});var o=this.props,l=this.moveables,c=s.target||o.target,u=l.map(function(et){return{finded:!1,manager:et}}),d=this.props.targetGroups||[],f=Hu(u,d),p=o.useDefaultGroupRotate;f.push.apply(f,$([],R(u.filter(function(et){var at=et.finded;return!at}).map(function(et){var at=et.manager;return at})),!1));var v=[],h=!n||r!==""&&o.updateGroup,g=o.defaultGroupRotate||0;if(!this._hasFirstTargets){var m=(a=o.persistData)===null||a===void 0?void 0:a.rotation;m!=null&&(g=m)}function b(et,at,ot){var V=et.map(function(St){if(Lt(St)){var ut=b(St,at),Et=[ut.pos1,ut.pos2,ut.pos3,ut.pos4];return v.push(ut),{poses:Et,rotation:ut.rotation}}else return{poses:be(St.state),rotation:St.getRotation()}}),tt=V.map(function(St){var ut=St.rotation;return ut}),gt=0,st=tt[0],lt=tt.every(function(St){return Math.abs(st-St)<.1});h?gt=!p&&lt?st:g:gt=!p&&!ot&&lt?st:at;var ft=V.map(function(St){var ut=St.poses;return ut}),bt=z0(ft,gt);return bt}var E=b(f,this.rotation,!0);h&&(this.rotation=E.rotation,this.transformOrigin=o.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=d,this.renderGroupRects=v;var C=this.transformOrigin,x=this.rotation,S=this.scale,w=E.width,D=E.height,T=E.minX,A=E.minY,M=r0([[0,0],[w,0],[0,D],[w,D]],Yo(C,w,D),this.rotation/180*Math.PI),P=fr(M.result),k=P.minX,_=P.minY,N=" rotate(".concat(x,"deg)")+" scale(".concat(re(S[0]),", ").concat(re(S[1]),")"),I="translate(".concat(-k,"px, ").concat(-_,"px)").concat(N);this.controlBox.style.transform="translate3d(".concat(T,"px, ").concat(A,"px, ").concat(this.props.translateZ||0,")"),c.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(C,";")+"width:".concat(w,"px;height:").concat(D,"px;")+"transform: ".concat(I),s.width=w,s.height=D;var B=this.getContainer(),L=Uo(this.controlBox,c,this.controlBox,this.getContainer(),this._rootContainer||B,[]),G=[L.left,L.top],W=R(be(L),4),z=W[0],X=W[1],j=W[2],Y=W[3],Z=fr([z,X,j,Y]),U=[Z.minX,Z.minY],q=re(S[0]*S[1]);L.pos1=it(z,U),L.pos2=it(X,U),L.pos3=it(j,U),L.pos4=it(Y,U),L.left=T-L.left+U[0],L.top=A-L.top+U[1],L.origin=it(yt(G,L.origin),U),L.beforeOrigin=it(yt(G,L.beforeOrigin),U),L.originalBeforeOrigin=yt(G,L.originalBeforeOrigin),L.transformOrigin=it(yt(G,L.transformOrigin),U),c.style.transform="translate(".concat(-k-U[0],"px, ").concat(-_-U[1],"px)")+N,Kr(),this.updateState(O(O({},L),{posDelta:U,direction:q,beforeDirection:q}),i)},e.prototype.getRect=function(){return O(O({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(r){return r.getRect()})})},e.prototype.triggerEvent=function(r,n,i){if(i||r.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,r,n);this._emitter.trigger(r,n)},e.prototype.getRequestChildStyles=function(){var r=this.getEnabledAbles().reduce(function(n,i){var a,s,o=(s=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return $($([],R(n),!1),R(o),!1)},[]);return r},e.prototype.getMoveables=function(){return $([],R(this.moveables),!1)},e.prototype.updateAbles=function(){t.prototype.updateAbles.call(this,$($([],R(this.props.ables),!1),[Zo],!1),"Group")},e.prototype._updateTargets=function(){t.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=ze(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var r=this.state,n=this.props,i=this._prevDragTarget,a=n.dragTarget||this.areaElement,s=n.targets,o=this.differ.update(s),l=o.added,c=o.changed,u=o.removed,d=l.length||u.length;(d||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Xr(this,!1),Xr(this,!0),this.updateState({gestos:{}})),i!==a&&(r.target=null),r.target||(r.target=this.areaElement,this.controlBox.style.display="block"),r.target&&(this.targetGesto||(this.targetGesto=zu(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=Iu(this,"GroupControl")));var f=!Bo(r.container,n.container);f&&(r.container=n.container),(f||d||this.transformOrigin!==(n.defaultGroupOrigin||"50% 50%")||c.length||s.length&&!yu(this._targetGroups,n.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!d},e.prototype._updateObserver=function(){},e.defaultProps=O(O({},jr.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e}(jr),B0=function(t){Lr(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.moveables=[],r}return e.prototype.render=function(){var r=this,n,i=this.props,a=i.cspNonce,s=i.cssStyled,o=i.persistData,l=i.targets||[],c=l.length,u=this.isUnmounted||!c,d=(n=o?.children)!==null&&n!==void 0?n:[];return u&&!c&&d.length?l=d.map(function(){return null}):u||(d=[]),ge(s,{cspNonce:a,ref:Ge(this,"controlBox"),className:nt("control-box")},l.map(function(f,p){var v,h,g=(h=(v=i.individualGroupableProps)===null||v===void 0?void 0:v.call(i,f,p))!==null&&h!==void 0?h:{};return ge(jr,O({key:"moveable"+p,ref:rl(r,"moveables",p)},i,g,{target:f,wrapperMoveable:r,isWrapperMounted:r.isMoveableMounted,persistData:d[p]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(r,n,i){i===void 0&&(i=!0),Kr(!0),this.moveables.forEach(function(a){a.updateRect(r,n,i)}),Kr()},e.prototype.getRect=function(){return O(O({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(r){return r.getRect()})})},e.prototype.request=function(r,n,i){n===void 0&&(n={});var a=this.moveables.map(function(l){return l.request(r,O(O({},n),{isInstant:!1}),!1)}),s=i||n.isInstant,o={request:function(l){return a.forEach(function(c){return c.request(l)}),this},requestEnd:function(){return a.forEach(function(l){return l.requestEnd()}),this}};return s?o.request(n).requestEnd():o},e.prototype.dragStart=function(r,n){n===void 0&&(n=r.target);var i=n,a=ae(this.moveables,function(s){var o=s.getTargets()[0],l=s.getControlBoxElement(),c=s.getDragElement();return!o||!c?!1:c===i||c.contains(i)||c!==o&&o===i||o.contains(i)||l===i||l.contains(i)});return a&&a.dragStart(r,n),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return $([],R(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e}(jr);function Vu(t,e){var r=[];return t.forEach(function(n){if(n){if($t(n)){e[n]&&r.push.apply(r,$([],R(e[n]),!1));return}Lt(n)?r.push.apply(r,$([],R(Vu(n,e)),!1)):r.push(n)}}),r}function $u(t,e){var r=[];return t.forEach(function(n){if(n){if($t(n)){e[n]&&r.push.apply(r,$([],R(e[n]),!1));return}Lt(n)?r.push($u(n,e)):r.push(n)}}),r}function ju(t,e){return t.length!==e.length||t.some(function(r,n){var i=e[n];return!r&&!i?!1:r!=i?Lt(r)&&Lt(i)?ju(r,i):!0:!1})}var Uu=function(t){Lr(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.refTargets=[],r.selectorMap={},r._differ=new $l,r._elementTargets=[],r._tmpRefTargets=[],r._tmpSelectorMap={},r._onChangeTargets=null,r}return e.makeStyled=function(){var r={},n=this.getTotalAbles();n.forEach(function(a){var s=a.css;s&&s.forEach(function(o){r[o]=!0})});var i=_e(r).join(`
`);this.defaultStyled=ec("div",Op(so,wh+i))},e.getTotalAbles=function(){return $([wu,Zo,Ku,Du],R(this.defaultAbles),!1)},e.prototype.render=function(){var r,n=this.constructor;n.defaultStyled||n.makeStyled();var i=this.props,a=i.ables,s=i.props,o=fh(i,["ables","props"]),l=R(this._updateRefs(!0),2),c=l[0],u=l[1],d=Vu(c,u),f=d.length>1,p=n.getTotalAbles(),v=$($([],R(p),!1),R(a||[]),!1),h=O(O(O({},o),s||{}),{ables:v,cssStyled:n.defaultStyled,customStyledMap:n.customStyledMap});this._elementTargets=d;var g=null,m=this.moveable,b=o.persistData;if(b?.children&&(f=!0),o.individualGroupable)return ge(B0,O({key:"individual-group",ref:Ge(this,"moveable")},h,{target:null,targets:d}));if(f){var E=$u(c,u);if(m&&!m.props.groupable&&!m.props.individualGroupable){var C=m.props.target;C&&d.indexOf(C)>-1&&(g=O({},m.state))}return ge(I0,O({key:"group",ref:Ge(this,"moveable")},h,(r=o.groupableProps)!==null&&r!==void 0?r:{},{target:null,targets:d,targetGroups:E,firstRenderState:g}))}else{var x=d[0];if(m&&(m.props.groupable||m.props.individualGroupable)){var S=m.moveables||[],w=ae(S,function(D){return D.props.target===x});w&&(g=O({},w.state))}return ge(jr,O({key:"single",ref:Ge(this,"moveable")},h,{target:x,firstRenderState:g}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var r,n;return(n=(r=this.moveable)===null||r===void 0?void 0:r.getTargets())!==null&&n!==void 0?n:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var r=this,n;return this._onChangeTargets=function(){r._onChangeTargets=null,n()},new Promise(function(i){n=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(r){var n=this.refTargets,i=Ko(this.props.target||this.props.targets),a=typeof document<"u",s=ju(n,i),o=this.selectorMap,l={};return this.refTargets.forEach(function c(u){if($t(u)){var d=o[u];d?l[u]=o[u]:a&&(s=!0,l[u]=[].slice.call(document.querySelectorAll(u)))}else Lt(u)&&u.forEach(c)}),this._tmpRefTargets=i,this._tmpSelectorMap=l,[i,l,!r&&s]},e.prototype._checkChangeTargets=function(){var r,n,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),s=a.added,o=a.removed,l=s.length||o.length;l&&((n=(r=this.props).onChangeTargets)===null||n===void 0||n.call(r,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var c=R(this._updateRefs(),3),u=c[0],d=c[1],f=c[2];this.refTargets=u,this.selectorMap=d,f&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,ph([Rp(lc)],e.prototype,"moveable",void 0),e}(Al),G0=function(t){Lr(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.defaultAbles=Qo,e}(Uu);function iE(t){var e;return e=function(r){Lr(n,r);function n(){return r!==null&&r.apply(this,arguments)||this}return n}(Uu),e.defaultAbles=t,e}var qo=function(t,e){return qo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},qo(t,e)};function Jo(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");qo(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var In=function(){return In=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},In.apply(this,arguments)};function F0(t,e,r,n){var i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(a=(i<3?s(a):i>3?s(e,r,a):s(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}var K0=function(t){Jo(e,t);function e(n){var i=t.call(this,n)||this;return i.state={},i.state=i.props,i}var r=e.prototype;return r.render=function(){return ge(G0,In({ref:Ge(this,"moveable")},this.state))},e}(Oa),W0=L0,Y0=lc,X0=N0,H0=function(t){Jo(e,t);function e(n,i){i===void 0&&(i={});var a=t.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var s=In({},i),o={};X0.forEach(function(u){o[Sa("on ".concat(u))]=function(d){return a.trigger(u,d)}});var l;i.warpSelf?(delete i.warpSelf,a._warp=!0,l=n):(l=oe(n).createElement("div"),n.appendChild(l)),a.containerProvider=Nl(ge(K0,In({ref:Ge(a,"innerMoveable")},s,o)),l),a.selfElement=l;var c=s.target;return Lt(c)&&c.length>1&&a.updateRect(),a}var r=e.prototype;return r.setState=function(n,i){this.innerMoveable.setState(n,i)},r.forceUpdate=function(n){this.innerMoveable.forceUpdate(n)},r.dragStart=function(n,i){i===void 0&&(i=n.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(n,i)},r.destroy=function(){var n,i=this.selfElement;Nl(null,i,this.containerProvider),this._warp||(n=i?.parentElement)===null||n===void 0||n.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},r.getMoveable=function(){return this.innerMoveable.moveable},e=F0([ya(Y0,function(n,i){n[i]||(n[i]=function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var o=this.getMoveable();if(!(!o||!o[i]))return o[i].apply(o,a)})}),ya(W0,function(n,i){Object.defineProperty(n,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var s;this.setState((s={},s[i]=a,s))},enumerable:!0,configurable:!0})})],e),e}(xn),V0=function(t){Jo(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(H0);function aE(t,e,r){return getElementInfo$1(t,e,r)}function oE(t,e){return makeAble$1(t,e)}var Zu=K(13752),Qu=K(49426),qu=K(57532),ts=function(t,e){return ts=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},ts(t,e)};function $0(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ts(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var j0="object",U0="string";function Ju(t){return t&&typeof t===j0}function td(t){return Array.isArray(t)}function ed(t){return typeof t===U0}function Z0(t,e,r){r===void 0&&(r=-1);for(var n=t.length,i=0;i<n;++i)if(e(t[i],i,t))return i;return r}function es(t,e,r,n){t.addEventListener(e,r,n)}function rs(t,e,r,n){t.removeEventListener(e,r,n)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ns=function(){return ns=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ns.apply(this,arguments)};function Q0(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}var q0=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(r,n){if(Ju(r))for(var i in r)this.on(i,r[i]);else this._addEvent(r,n,{});return this},e.off=function(r,n){if(!r)this._events={};else if(Ju(r))for(var i in r)this.off(i);else if(!n)this._events[r]=[];else{var a=this._events[r];if(a){var s=Z0(a,function(o){return o.listener===n});s>-1&&a.splice(s,1)}}return this},e.once=function(r,n){var i=this;return n&&this._addEvent(r,n,{once:!0}),new Promise(function(a){i._addEvent(r,a,{once:!0})})},e.emit=function(r,n){var i=this;n===void 0&&(n={});var a=this._events[r];if(!r||!a)return!0;var s=!1;return n.eventType=r,n.stop=function(){s=!0},n.currentTarget=this,Q0(a).forEach(function(o){o.listener(n),o.once&&i.off(r,o.listener)}),!s},e.trigger=function(r,n){return n===void 0&&(n={}),this.emit(r,n)},e._addEvent=function(r,n,i){var a=this._events;a[r]=a[r]||[];var s=a[r];s.push(ns({listener:n},i))},t}();function J0(t,e){return e={exports:{}},t(e,e.exports),e.exports}var Bn=J0(function(t,e){function r(l){if(l&&typeof l=="object"){var c=l.which||l.keyCode||l.charCode;c&&(l=c)}if(typeof l=="number")return s[l];var u=String(l),d=n[u.toLowerCase()];if(d)return d;var d=i[u.toLowerCase()];if(d)return d;if(u.length===1)return u.charCodeAt(0)}r.isEventKey=function(c,u){if(c&&typeof c=="object"){var d=c.which||c.keyCode||c.charCode;if(d==null)return!1;if(typeof u=="string"){var f=n[u.toLowerCase()];if(f)return f===d;var f=i[u.toLowerCase()];if(f)return f===d}else if(typeof u=="number")return u===d;return!1}},e=t.exports=r;var n=e.code=e.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=e.aliases={windows:91,"\u21E7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */for(a=97;a<123;a++)n[String.fromCharCode(a)]=a-32;for(var a=48;a<58;a++)n[a-48]=a;for(a=1;a<13;a++)n["f"+a]=a+111;for(a=0;a<10;a++)n["numpad "+a]=a+96;var s=e.names=e.title={};for(a in n)s[n[a]]=a;for(var o in i)n[o]=i[o]}),sE=Bn.code,lE=Bn.codes,cE=Bn.aliases,tm=Bn.names,uE=Bn.title,rd={"+":"plus","left command":"meta","right command":"meta"},nd={shift:1,ctrl:2,alt:3,meta:4};function id(t,e){var r=(tm[t]||e||"").toLowerCase();for(var n in rd)r=r.replace(n,rd[n]);return r.replace(/\s/g,"")}function ad(t,e){e===void 0&&(e=id(t.keyCode,t.key));var r=em(t);return r.indexOf(e)===-1&&r.push(e),r.filter(Boolean)}function em(t){var e=[t.shiftKey&&"shift",t.ctrlKey&&"ctrl",t.altKey&&"alt",t.metaKey&&"meta"];return e.filter(Boolean)}function od(t){var e=t.slice();return e.sort(function(r,n){var i=nd[r]||5,a=nd[n]||5;return i-a}),e}var sd,rm=function(t){$0(e,t);function e(n){n===void 0&&(n=window);var i=t.call(this)||this;return i.container=n,i.ctrlKey=!1,i.altKey=!1,i.shiftKey=!1,i.metaKey=!1,i.clear=function(){return i.ctrlKey=!1,i.altKey=!1,i.shiftKey=!1,i.metaKey=!1,i},i.keydownEvent=function(a){i.triggerEvent("keydown",a)},i.keyupEvent=function(a){i.triggerEvent("keyup",a)},i.blur=function(){i.clear(),i.trigger("blur")},es(n,"blur",i.blur),es(n,"keydown",i.keydownEvent),es(n,"keyup",i.keyupEvent),i}var r=e.prototype;return Object.defineProperty(e,"global",{get:function(){return sd||(sd=new e)},enumerable:!1,configurable:!0}),e.setGlobal=function(){return this.global},r.destroy=function(){var n=this.container;this.clear(),this.off(),rs(n,"blur",this.blur),rs(n,"keydown",this.keydownEvent),rs(n,"keyup",this.keyupEvent)},r.keydown=function(n,i){return this.addEvent("keydown",n,i)},r.offKeydown=function(n,i){return this.removeEvent("keydown",n,i)},r.offKeyup=function(n,i){return this.removeEvent("keyup",n,i)},r.keyup=function(n,i){return this.addEvent("keyup",n,i)},r.addEvent=function(n,i,a){return td(i)?this.on(n+"."+od(i).join("."),a):ed(i)?this.on(n+"."+i,a):this.on(n,i),this},r.removeEvent=function(n,i,a){return td(i)?this.off(n+"."+od(i).join("."),a):ed(i)?this.off(n+"."+i,a):this.off(n,i),this},r.triggerEvent=function(n,i){this.ctrlKey=i.ctrlKey,this.shiftKey=i.shiftKey,this.altKey=i.altKey,this.metaKey=i.metaKey;var a=id(i.keyCode,i.key),s=a==="ctrl"||a==="shift"||a==="meta"||a==="alt",o={key:a,isToggle:s,inputEvent:i,keyCode:i.keyCode,ctrlKey:i.ctrlKey,altKey:i.altKey,shiftKey:i.shiftKey,metaKey:i.metaKey};this.trigger(n,o),this.trigger(n+"."+a,o);var l=ad(i,a);l.length>1&&this.trigger(n+"."+l.join("."),o)},e}(q0);const nm=rm;var is=function(t,e){return is=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},is(t,e)};function ld(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");is(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Wt=function(){return Wt=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Wt.apply(this,arguments)};function im(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function am(t,e,r,n){var i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(a=(i<3?s(a):i>3?s(e,r,a):s(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}function Gn(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))}function om(t){if("touches"in t){var e=t.touches[0]||t.changedTouches[0];return{clientX:e.clientX,clientY:e.clientY}}else return{clientX:t.clientX,clientY:t.clientY}}function sm(t){if(typeof Map>"u")return t.filter(function(r,n){return t.indexOf(r)===n});var e=new Map;return t.filter(function(r){return e.has(r)?!1:(e.set(r,!0),!0)})}function lm(t,e,r){var n=oe(t);return n.elementFromPoint&&n.elementFromPoint(e,r)||null}function cd(t,e,r){var n=t.tag,i=t.children,a=t.attributes,s=t.className,o=t.style,l=e||oe(r).createElement(n);for(var c in a)l.setAttribute(c,a[c]);var u=l.children;if(i.forEach(function(f,p){cd(f,u[p],l)}),s&&s.split(/\s+/g).forEach(function(f){f&&!Gt(l,f)&&wa(l,f)}),o){var d=l.style;for(var c in o)d[c]=o[c]}return!e&&r&&r.appendChild(l),l}function cm(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=e||{},a=i.className,s=a===void 0?"":a,o=i.style,l=o===void 0?{}:o,c=im(i,["className","style"]);return{tag:t,className:s,style:l,attributes:c,children:r}}function as(t,e,r){t!==e&&r(t,e)}function ud(t,e,r){var n;r===void 0&&(r=t.data.boundArea);var i=t.distX,a=i===void 0?0:i,s=t.distY,o=s===void 0?0:s,l=t.data,c=l.startX,u=l.startY;if(e>0){var d=Math.sqrt((a*a+o*o)/(1+e*e)),f=e*d;a=(a>=0?1:-1)*f,o=(o>=0?1:-1)*d}var p=Math.abs(a),v=Math.abs(o),h=a<0?c-r.left:r.right-c,g=o<0?u-r.top:r.bottom-u;n=xa([p,v],[0,0],[h,g],!!e),p=n[0],v=n[1],a=(a>=0?1:-1)*p,o=(o>=0?1:-1)*v;var m=Math.min(0,a),b=Math.min(0,o),E=c+m,C=u+b;return{left:E,top:C,right:E+p,bottom:C+v,width:p,height:v}}function Zi(t){var e=t.getBoundingClientRect(),r=e.left,n=e.top,i=e.width,a=e.height;return{pos1:[r,n],pos2:[r+i,n],pos3:[r,n+a],pos4:[r+i,n+a]}}function dd(t,e,r){var n=_r(t,e),i=n.list,a=n.prevList,s=n.added,o=n.removed,l=n.maintained;return Gn(Gn(Gn([],s.map(function(c){return i[c]}),!0),o.map(function(c){return a[c]}),!0),r?l.map(function(c){var u=c[1];return i[u]}):[],!0)}function fd(t){for(var e=0,r=t.length,n=1;n<r;++n)e=Math.max(Ne(t[n],t[n-1]),e);return e}var pd=tc(`
:host {
    position: fixed;
    display: none;
    border: 1px solid #4af;
    background: rgba(68, 170, 255, 0.5);
    pointer-events: none;
    will-change: transform;
    z-index: 100;
}
`),vd="selecto-selection ".concat(pd.className),hd=["className","boundContainer","selectableTargets","selectByClick","selectFromInside","continueSelect","continueSelectWithoutDeselect","toggleContinueSelect","toggleContinueSelectWithoutDeselect","keyContainer","hitRate","scrollOptions","checkInput","preventDefault","ratio","getElementRect","preventDragFromInside","rootContainer","dragCondition","clickBySelectEnd","checkOverflow","innerScrollOptions"],dE=Gn(["dragContainer","cspNonce","preventClickEventOnDrag","preventClickEventOnDragStart","preventRightClick"],hd,!0),fE={className:String,boundContainer:null,portalContainer:null,container:null,dragContainer:null,selectableTargets:Array,selectByClick:Boolean,selectFromInside:Boolean,continueSelect:Boolean,toggleContinueSelect:Array,toggleContinueSelectWithoutDeselect:Array,keyContainer:null,hitRate:Number,scrollOptions:Object,checkInput:Boolean,preventDefault:Boolean,cspNonce:String,ratio:Number,getElementRect:Function,preventDragFromInside:Boolean,rootContainer:Object,dragCondition:Function,clickBySelectEnd:Boolean,continueSelectWithoutDeselect:Boolean,preventClickEventOnDragStart:Boolean,preventClickEventOnDrag:Boolean,checkOverflow:Boolean,innerScrollOptions:Object},pE=null,vE=null,um=function(t){ld(e,t);function e(n){n===void 0&&(n={});var i=t.call(this)||this;i.selectedTargets=[],i.dragScroll=new Ul,i._onDragStart=function(o,l){var c=o.data,u=o.clientX,d=o.clientY,f=o.inputEvent,p=i.options,v=p.selectFromInside,h=p.selectByClick,g=p.rootContainer,m=p.boundContainer,b=p.preventDragFromInside,E=b===void 0?!0:b,C=p.clickBySelectEnd,x=p.dragCondition;if(x&&!x(o)){o.stop();return}c.data={};var S=fe(i.container);c.innerWidth=S.innerWidth,c.innerHeight=S.innerHeight,i.findSelectableTargets(c),c.startSelectedTargets=i.selectedTargets,c.scaleMatrix=Xa(),c.containerX=0,c.containerY=0;var w=i.container,D={left:-1/0,top:-1/0,right:1/0,bottom:1/0};if(g){var T=i.container.getBoundingClientRect();c.containerX=T.left,c.containerY=T.top,c.scaleMatrix=Lv(i.container,g)}if(m){var A=de(m)&&"element"in m?Wt({left:!0,top:!0,bottom:!0,right:!0},m):{element:m,left:!0,top:!0,bottom:!0,right:!0},M=A.element,P=void 0;if(M){$t(M)?P=oe(w).querySelector(M):M===!0?P=i.container:P=M;var k=P.getBoundingClientRect();A.left&&(D.left=k.left),A.top&&(D.top=k.top),A.right&&(D.right=k.right),A.bottom&&(D.bottom=k.bottom)}}c.boundArea=D;var _={left:u,top:d,right:u,bottom:d,width:0,height:0},N=[],I=h&&!C,B=!1;if(!v||I){var L=i._findElement(l||f.target,c.selectableTargets);B=!!L,I&&(N=L?[L]:[])}var G=!v&&B;if(G&&!h)return o.stop(),!1;var W=f.type,z=W==="mousedown"||W==="touchstart",X=!o.isClick&&z?i.emit("dragStart",Wt(Wt({},o),{data:c.data})):!0;if(!X)return o.stop(),!1;if(i.continueSelect?(N=dd(i.selectedTargets,N,i.continueSelectWithoutDeselect),c.startPassedTargets=i.selectedTargets):c.startPassedTargets=[],i._select(N,_,o,!0,G&&h&&!C&&E),c.startX=u,c.startY=d,c.selectFlag=!1,c.preventDragFromInside=!1,f.target){var j=mi(c.scaleMatrix,[u-c.containerX,d-c.containerY]);i.target.style.cssText+="position: ".concat(g?"absolute":"fixed",";")+"left:0px;top:0px;"+"transform: translate(".concat(j[0],"px, ").concat(j[1],"px)")}if(G&&h&&!C)f.preventDefault(),E&&(i._selectEnd(c.startSelectedTargets,c.startPassedTargets,_,o,!0),c.preventDragFromInside=!0);else{c.selectFlag=!0;var Y=i.options,Z=Y.scrollOptions,U=Y.innerScrollOptions,q=!1;if(U){for(var et=o.inputEvent,at=et.target,ot=null,V=at;V&&V!==oe(w).body;){var tt=getComputedStyle(V).overflow!=="visible";if(tt){ot=V;break}V=V.parentElement}ot&&(c.innerScrollOptions=Wt({container:ot,checkScrollEvent:!0},U===!0?{}:U),i.dragScroll.dragStart(o,c.innerScrollOptions),q=!0)}!q&&Z&&Z.container&&i.dragScroll.dragStart(o,Z),G&&h&&C&&(c.selectFlag=!1,o.preventDrag())}return!0},i._onDrag=function(o){if(o.data.selectFlag){var l=i.scrollOptions,c=o.data.innerScrollOptions,u=c||l?.container;if(u&&!o.isScroll&&i.dragScroll.drag(o,c||l))return}i._checkSelected(o)},i._onDragEnd=function(o){var l=o.data,c=o.inputEvent,u=ud(o,i.options.ratio),d=l.selectFlag,f=i.container;if(c&&i.emit("dragEnd",Wt(Wt({isDouble:!!o.isDouble,isClick:!!o.isClick,isDrag:!1,isSelect:d},o),{data:l.data,rect:u})),i.target.style.cssText+="display: none;",d)l.selectFlag=!1,i.dragScroll.dragEnd();else if(i.selectByClick&&i.clickBySelectEnd){var p=i._findElement(c?.target||lm(f,o.clientX,o.clientY),l.selectableTargets);i._select(p?[p]:[],u,o)}l.preventDragFromInside||i._selectEnd(l.startSelectedTargets,l.startPassedTargets,u,o)},i._onKeyDown=function(o){var l=i.options,c=!1;if(!i._keydownContinueSelect){var u=i._sameCombiKey(o,l.toggleContinueSelect);i._keydownContinueSelect=u,c||(c=u)}if(!i._keydownContinueSelectWithoutDeselection){var u=i._sameCombiKey(o,l.toggleContinueSelectWithoutDeselect);i._keydownContinueSelectWithoutDeselection=u,c||(c=u)}c&&i.emit("keydown",{keydownContinueSelect:i._keydownContinueSelect,keydownContinueSelectWithoutDeselection:i._keydownContinueSelectWithoutDeselection})},i._onKeyUp=function(o){var l=i.options,c=!1;if(i._keydownContinueSelect){var u=i._sameCombiKey(o,l.toggleContinueSelect,!0);i._keydownContinueSelect=!u,c||(c=u)}if(i._keydownContinueSelectWithoutDeselection){var u=i._sameCombiKey(o,l.toggleContinueSelectWithoutDeselect,!0);i._keydownContinueSelectWithoutDeselection=!u,c||(c=u)}c&&i.emit("keyup",{keydownContinueSelect:i._keydownContinueSelect,keydownContinueSelectWithoutDeselection:i._keydownContinueSelectWithoutDeselection})},i._onBlur=function(){(i._keydownContinueSelect||i._keydownContinueSelectWithoutDeselection)&&(i._keydownContinueSelect=!1,i._keydownContinueSelectWithoutDeselection=!1,i.emit("keyup",{keydownContinueSelect:i._keydownContinueSelect,keydownContinueSelectWithoutDeselection:i._keydownContinueSelectWithoutDeselection}))},i._onDocumentSelectStart=function(o){var l=oe(i.container);if(i.gesto.isFlag()){var c=i.dragContainer;c===fe(i.container)&&(c=l.documentElement);var u=Ue(c)?[c]:[].slice.call(c),d=o.target;u.some(function(f){if(f===d||f.contains(d))return o.preventDefault(),!0})}},i.target=n.portalContainer;var a=n.container;i.options=Wt({className:"",portalContainer:null,container:null,dragContainer:null,selectableTargets:[],selectByClick:!0,selectFromInside:!0,clickBySelectEnd:!1,hitRate:100,continueSelect:!1,continueSelectWithoutDeselect:!1,toggleContinueSelect:null,toggleContinueSelectWithoutDeselect:null,keyContainer:null,scrollOptions:null,checkInput:!1,preventDefault:!1,boundContainer:!1,preventDragFromInside:!0,dragCondition:null,rootContainer:null,checkOverflow:!1,innerScrollOptions:!1,getElementRect:Zi,cspNonce:"",ratio:0},n);var s=i.options.portalContainer;return s&&(a=s.parentElement),i.container=a||document.body,i.initElement(),i.initDragScroll(),i.setKeyController(),i}var r=e.prototype;return r.setSelectedTargets=function(n){var i=this.selectedTargets,a=_r(i,n),s=a.added,o=a.removed,l=a.prevList,c=a.list;return this.selectedTargets=n,{added:s.map(function(u){return c[u]}),removed:o.map(function(u){return l[u]}),beforeSelected:i,selected:n}},r.setSelectedTargetsByPoints=function(n,i){var a=Math.min(n[0],i[0]),s=Math.min(n[1],i[1]),o=Math.max(n[0],i[0]),l=Math.max(n[1],i[1]),c={left:a,top:s,right:o,bottom:l,width:o-a,height:l-s},u={ignoreClick:!0};this.findSelectableTargets(u);var d=this.hitTest(c,u,!0,null),f=this.setSelectedTargets(d);return Wt(Wt({},f),{rect:c})},r.selectTargetsByPoints=function(n,i){var a=new MouseEvent("mousedown",{clientX:n[0],clientY:n[1],cancelable:!0,bubbles:!0}),s=new MouseEvent("mousemove",{clientX:i[0],clientY:i[1],cancelable:!0,bubbles:!0}),o=new MouseEvent("mousemove",{clientX:i[0],clientY:i[1],cancelable:!0,bubbles:!0}),l=this.gesto,c=l.onDragStart(a);c!==!1&&(l.onDrag(s),l.onDragEnd(o))},r.getSelectedTargets=function(){return this.selectedTargets},r.triggerDragStart=function(n){return this.gesto.triggerDragStart(n),this},r.destroy=function(){var n;this.off(),this.keycon&&this.keycon.destroy(),this.gesto.unset(),this.injectResult.destroy(),this.dragScroll.dragEnd(),Ft(document,"selectstart",this._onDocumentSelectStart),this.options.portalContainer||(n=this.target.parentElement)===null||n===void 0||n.removeChild(this.target),this.keycon=null,this.gesto=null,this.injectResult=null,this.target=null,this.container=null,this.options=null},r.getElementPoints=function(n){var i=this.getElementRect||Zi,a=i(n),s=[a.pos1,a.pos2,a.pos4,a.pos3];if(i!==Zi){var o=n.getBoundingClientRect();return ja(s,o)}return s},r.getSelectableElements=function(){var n=this.container,i=[];return this.options.selectableTargets.forEach(function(a){if(ai(a)){var s=a();s&&i.push.apply(i,[].slice.call(s))}else if(Ue(a))i.push(a);else if(de(a))i.push(a.value||a.current);else{var o=[].slice.call(oe(n).querySelectorAll(a));i.push.apply(i,o)}}),i},r.checkScroll=function(){if(this.gesto.isFlag()){var n=this.scrollOptions,i=this.gesto.getEventData().innerScrollOptions,a=i||n?.container;a&&this.dragScroll.checkScroll(Wt({inputEvent:this.gesto.getCurrentEvent()},i||n))}},r.findSelectableTargets=function(n){var i=this;n===void 0&&(n=this.gesto.getEventData());var a=this.getSelectableElements(),s=a.map(function(d){return i.getElementPoints(d)});n.selectableTargets=a,n.selectablePoints=s,n.selectableParentMap=null;var o=this.options,l=o.checkOverflow||o.innerScrollOptions,c=oe(this.container);if(l){var u=new Map;n.selectableInnerScrollParentMap=u,n.selectableInnerScrollPathsList=a.map(function(d,f){for(var p=d.parentElement,v=[],h=[],g=function(){var m=u.get(p);if(!m){var b=getComputedStyle(p).overflow!=="visible";if(b){var E=Zi(p);m={parentElement:p,indexes:[],points:[E.pos1,E.pos2,E.pos4,E.pos3],paths:Gn([],h,!0)},v.push(p),v.forEach(function(C){u.set(C,m)}),v=[]}}m?(p=m.parentElement,u.get(p).indexes.push(f),h.push(p)):v.push(p),p=p.parentElement};p&&p!==c.body;)g();return h})}return o.checkOverflow||(n.selectableInners=a.map(function(){return!0})),this._refreshGroups(n),a},r.clickTarget=function(n,i){var a=om(n),s=a.clientX,o=a.clientY,l={data:{selectFlag:!1},clientX:s,clientY:o,inputEvent:n,isClick:!0,isTrusted:!1,stop:function(){return!1}};return this._onDragStart(l,i)&&this._onDragEnd(l),this},r.setKeyController=function(){var n=this.options,i=n.keyContainer,a=n.toggleContinueSelect,s=n.toggleContinueSelectWithoutDeselect;this.keycon&&(this.keycon.destroy(),this.keycon=null),(a||s)&&(this.keycon=new nm(i||fe(this.container)),this.keycon.keydown(this._onKeyDown).keyup(this._onKeyUp).on("blur",this._onBlur))},r.setClassName=function(n){this.options.className=n,this.target.setAttribute("class","".concat(vd," ").concat(n||""))},r.setKeyEvent=function(){var n=this.options,i=n.toggleContinueSelect,a=n.toggleContinueSelectWithoutDeselect;!i&&!a||this.keycon||this.setKeyController()},r.setKeyContainer=function(n){var i=this,a=this.options;as(a.keyContainer,n,function(){a.keyContainer=n,i.setKeyController()})},r.getContinueSelect=function(){var n=this.options,i=n.continueSelect,a=n.toggleContinueSelect;return!a||!this._keydownContinueSelect?i:!i},r.getContinueSelectWithoutDeselect=function(){var n=this.options,i=n.continueSelectWithoutDeselect,a=n.toggleContinueSelectWithoutDeselect;return!a||!this._keydownContinueSelectWithoutDeselection?i:!i},r.setToggleContinueSelect=function(n){var i=this,a=this.options;as(a.toggleContinueSelect,n,function(){a.toggleContinueSelect=n,i.setKeyEvent()})},r.setToggleContinueSelectWithoutDeselect=function(n){var i=this,a=this.options;as(a.toggleContinueSelectWithoutDeselect,n,function(){a.toggleContinueSelectWithoutDeselect=n,i.setKeyEvent()})},r.setPreventDefault=function(n){this.gesto.options.preventDefault=n},r.setCheckInput=function(n){this.gesto.options.checkInput=n},r.initElement=function(){var n=this.options,i=n.dragContainer,a=n.checkInput,s=n.preventDefault,o=n.preventClickEventOnDragStart,l=n.preventClickEventOnDrag,c=n.preventClickEventByCondition,u=n.preventRightClick,d=u===void 0?!0:u,f=n.className,p=this.container;this.target=cd(cm("div",{className:"".concat(vd," ").concat(f||"")}),this.target,p);var v=this.target;this.dragContainer=typeof i=="string"?[].slice.call(oe(p).querySelectorAll(i)):i||this.target.parentNode,this.gesto=new Jl(this.dragContainer,{checkWindowBlur:!0,container:fe(p),checkInput:a,preventDefault:s,preventClickEventOnDragStart:o,preventClickEventOnDrag:l,preventClickEventByCondition:c,preventRightClick:d}).on({dragStart:this._onDragStart,drag:this._onDrag,dragEnd:this._onDragEnd}),Ht(document,"selectstart",this._onDocumentSelectStart),this.injectResult=pd.inject(v,{nonce:this.options.cspNonce})},r.hitTest=function(n,i,a,s){var o=this.options,l=o.hitRate,c=o.selectByClick,u=n.left,d=n.top,f=n.right,p=n.bottom,v=i.innerGroups,h=i.innerWidth,g=i.innerHeight,m=s?.clientX,b=s?.clientY,E=i.ignoreClick,C=[[u,d],[f,d],[f,p],[u,p]],x=function(L,G){var W=sr(typeof l=="function"?"".concat(l(G)):"".concat(l)),z=E?!1:bi([m,b],L);if(!a&&c&&z)return!0;var X=qa(C,L);if(!X.length)return!1;var j=Dn(X),Y=0;if(j===0&&Dn(L)===0?(Y=fd(L),j=fd(X)):Y=Dn(L),W.unit==="px")return j>=W.value;var Z=si(Math.round(j/Y*100),0,100);return Z>=Math.min(100,W.value)},S=i.selectableTargets,w=i.selectablePoints,D=i.selectableInners;if(!v)return S.filter(function(L,G){return D[G]?x(w[G],S[G]):!1});for(var T=[],A=Math.floor(u/h),M=Math.floor(f/h),P=Math.floor(d/g),k=Math.floor(p/g),_=A;_<=M;++_){var N=v[_];if(N)for(var I=P;I<=k;++I){var B=N[I];B&&B.forEach(function(L){var G=w[L],W=D[L],z=S[L];W&&x(G,z)&&T.push(z)})}}return sm(T)},r.initDragScroll=function(){var n=this;this.dragScroll.on("scrollDrag",function(i){var a=i.next;a(n.gesto.getCurrentEvent())}).on("scroll",function(i){var a=i.container,s=i.direction,o=n.gesto.getEventData().innerScrollOptions;o?n.emit("innerScroll",{container:a,direction:s}):n.emit("scroll",{container:a,direction:s})}).on("move",function(i){var a=i.offsetX,s=i.offsetY,o=i.inputEvent,l=n.gesto;if(!(!l||!l.isFlag())){var c=n.gesto.getEventData(),u=c.boundArea;c.startX-=a,c.startY-=s;var d=n.gesto.getEventData().innerScrollOptions,f=d?.container,p=!1;if(f){var v=c.selectableInnerScrollParentMap,h=v.get(f);h&&(h.paths.forEach(function(g){var m=v.get(g);m.points.forEach(function(b){b[0]-=a,b[1]-=s})}),h.indexes.forEach(function(g){c.selectablePoints[g].forEach(function(m){m[0]-=a,m[1]-=s})}),p=!0)}p||c.selectablePoints.forEach(function(g){g.forEach(function(m){m[0]-=a,m[1]-=s})}),n._refreshGroups(c),u.left-=a,u.right-=a,u.top-=s,u.bottom-=s,n.gesto.scrollBy(a,s,o.inputEvent),n._checkSelected(n.gesto.getCurrentEvent())}})},r._select=function(n,i,a,s,o){o===void 0&&(o=!1);var l=a.inputEvent,c=a.data,u=this.setSelectedTargets(n),d=_r(c.startSelectedTargets,n),f=d.added,p=d.removed,v=d.prevList,h=d.list,g={startSelected:v,startAdded:f.map(function(m){return h[m]}),startRemoved:p.map(function(m){return v[m]})};s&&this.emit("selectStart",Wt(Wt(Wt({},u),g),{rect:i,inputEvent:l,data:c.data,isTrusted:a.isTrusted,isDragStartEnd:o})),(u.added.length||u.removed.length)&&this.emit("select",Wt(Wt(Wt({},u),g),{rect:i,inputEvent:l,data:c.data,isTrusted:a.isTrusted,isDragStartEnd:o}))},r._selectEnd=function(n,i,a,s,o){o===void 0&&(o=!1);var l=s.inputEvent,c=s.isDouble,u=s.data,d=l&&l.type,f=d==="mousedown"||d==="touchstart",p=_r(n,this.selectedTargets),v=p.added,h=p.removed,g=p.prevList,m=p.list,b=_r(i,this.selectedTargets),E=b.added,C=b.removed,x=b.prevList,S=b.list;this.emit("selectEnd",{startSelected:n,beforeSelected:i,selected:this.selectedTargets,added:v.map(function(w){return m[w]}),removed:h.map(function(w){return g[w]}),afterAdded:E.map(function(w){return S[w]}),afterRemoved:C.map(function(w){return x[w]}),isDragStart:f&&o,isDragStartEnd:f&&o,isClick:!!s.isClick,isDouble:!!c,rect:a,inputEvent:l,data:u.data,isTrusted:s.isTrusted})},r._checkSelected=function(n,i){i===void 0&&(i=ud(n,this.options.ratio));var a=n.data,s=i.top,o=i.left,l=i.width,c=i.height,u=a.selectFlag,d=a.containerX,f=a.containerY,p=a.scaleMatrix,v=mi(p,[o-d,s-f]),h=mi(p,[l,c]),g=[];if(u){this.target.style.cssText+="display: block;left:0px;top:0px;"+"transform: translate(".concat(v[0],"px, ").concat(v[1],"px);")+"width:".concat(h[0],"px;height:").concat(h[1],"px;");var m=this.hitTest(i,a,!0,n);g=dd(a.startPassedTargets,m,this.continueSelect&&this.continueSelectWithoutDeselect)}var b=this.emit("drag",Wt(Wt({},n),{data:a.data,isSelect:u,rect:i}));if(b===!1){this.target.style.cssText+="display: none;",n.stop();return}u&&this._select(g,i,n)},r._sameCombiKey=function(n,i,a){if(!i)return!1;var s=ad(n.inputEvent,n.key),o=[].concat(i),l=Lt(o[0])?o:[o];if(a){var c=n.key;return l.some(function(u){return u.some(function(d){return d===c})})}return l.some(function(u){return u.every(function(d){return s.indexOf(d)>-1})})},r._findElement=function(n,i){for(var a=n;a&&!(i.indexOf(a)>-1);)a=a.parentElement;return a},r._refreshGroups=function(n){var i,a=n.innerWidth,s=n.innerHeight,o=n.selectablePoints;if(this.options.checkOverflow){var l=(i=this.gesto.getEventData().innerScrollOptions)===null||i===void 0?void 0:i.container,c=n.selectableInnerScrollParentMap,u=n.selectableInnerScrollPathsList;n.selectableInners=u.map(function(p,v){var h=!1;return p.every(function(g){if(h)return!0;if(g===l)return h=!0,!0;var m=c.get(g);if(m){var b=o[v],E=m.points,C=qa(b,E);if(!C.length)return!1}return!0})})}if(!a||!s)n.innerGroups=null;else{var d=n.selectablePoints,f={};d.forEach(function(p,v){var h=1/0,g=-1/0,m=1/0,b=-1/0;p.forEach(function(x){var S=Math.floor(x[0]/a),w=Math.floor(x[1]/s);h=Math.min(S,h),g=Math.max(S,g),m=Math.min(w,m),b=Math.max(w,b)});for(var E=h;E<=g;++E)for(var C=m;C<=b;++C)f[E]=f[E]||{},f[E][C]=f[E][C]||[],f[E][C].push(v)}),n.innerGroups=f}},e=am([ya(hd,function(n,i){var a={enumerable:!0,configurable:!0,get:function(){return this.options[i]}},s=Sa("get ".concat(i));n[s]?a.get=function(){return this[s]()}:a.get=function(){return this.options[i]};var o=Sa("set ".concat(i));n[o]?a.set=function(l){this[o](l)}:a.set=function(l){this.options[i]=l},Object.defineProperty(n,i,a)})],e),e}(xn),dm=function(t){ld(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(um);const fm=dm;var Fn=K(17464),Kn=K(33924),We=K(64539),pm=K(28122);const vm=({scene:t,panel:e,onVisibilityChange:r})=>{const n=e.state.openInlineEdit,[i,a]=(0,y.useState)(!1),[s,o]=(0,y.useState)({x:0,y:0}),l=hm(),c=t.selecto?.getSelectedTargets(),u=e.context?.instanceState?.layer,d=(0,y.useCallback)(h=>{if(!(h instanceof MouseEvent)||h.ctrlKey)return;h.preventDefault(),e.setActivePanel(),h.currentTarget!==t.div&&(h.currentTarget instanceof HTMLElement||h.currentTarget instanceof SVGElement)&&t.select({targets:[h.currentTarget]}),o({x:h.pageX,y:h.pageY}),a(!0),r(!0)},[t,e,r]);(0,y.useEffect)(()=>{t.selecto&&t.selecto.getSelectableElements().forEach(h=>{h.addEventListener("contextmenu",d)})},[d,t.selecto]),(0,y.useEffect)(()=>{t.div&&t.div.addEventListener("contextmenu",d)},[d,t.div]);const f=()=>{a(!1),r(!1)},p=()=>{const h=!t.isPanelEditing&&y.createElement(We.D,{label:n?"Close Editor":"Open Editor",onClick:()=>{t.inlineEditingCallback&&(n?e.closeInlineEdit():t.inlineEditingCallback()),f()},className:l.menuItem}),g=()=>{if(c?.length===1){const x=()=>{t.editModeEnabled.next(!0),f()},S=t.findElementByTarget(c[0]);return S&&S.item.hasEditMode&&y.createElement(We.D,{label:"Edit",onClick:x,className:l.menuItem})}return null},m=qn(t.shouldShowAdvancedTypes).options,b=()=>{const x=[],S=w=>{let D=s.y,T=s.x;if(t.div){const A=t.scale,M=t.div.getBoundingClientRect();D=(D-M.top)/A,T=(T-M.left)/A}ga(w,u,{...s,y:D,x:T})};return m.map(w=>{x.push(y.createElement(We.D,{key:w.value,label:w.label??"Canvas item",onClick:()=>S(w)}))}),x},E=y.createElement(We.D,{label:"Add item",className:l.menuItem,childItems:b(),customSubMenuContainerStyles:{maxHeight:"150px",overflowY:"auto"}}),C=y.createElement(We.D,{label:"Set background",onClick:()=>{t.setBackgroundCallback&&t.setBackgroundCallback(s),f()},className:l.menuItem});return c&&c.length>=1?y.createElement(y.Fragment,null,g(),y.createElement(We.D,{label:"Delete",onClick:()=>{v(Qt.Delete),f()},className:l.menuItem}),y.createElement(We.D,{label:"Duplicate",onClick:()=>{v(Qt.Duplicate),f()},className:l.menuItem}),y.createElement(We.D,{label:"Bring to front",onClick:()=>{v(Qt.MoveTop),f()},className:l.menuItem}),y.createElement(We.D,{label:"Send to back",onClick:()=>{v(Qt.MoveBottom),f()},className:l.menuItem}),h):y.createElement(y.Fragment,null,h,C,E)},v=h=>{t.selection.pipe((0,qu.$)()).subscribe(g=>{const m=g[0].parent;g.forEach(b=>{m.doAction(h,b)})}),setTimeout(()=>{t.addToSelection(),t.targetsToSelect.clear()})};return i?y.createElement("div",{onContextMenu:h=>{h.preventDefault(),f()}},y.createElement(pm.t,{x:s.x,y:s.y,onClose:f,renderMenuItems:p,focusOnOpen:!1})):y.createElement(y.Fragment,null)},hm=()=>({menuItem:(0,rt.css)({maxWidth:"200px"})});var gm=K(80279),mm=K(82148),ym=K(69503),bm=K(25469);const Em=({scene:t})=>{const e=(0,Pt.of)(Cm),r=()=>{t?.tooltipCallback&&t.tooltip&&t.tooltipCallback(void 0)},n=(0,y.createRef)(),{overlayProps:i}=(0,mm.e)({onClose:r,isDismissable:!0},n),{dialogProps:a}=(0,gm.s)({},n),s=t.tooltip?.element;if(!s)return y.createElement(y.Fragment,null);const o=()=>s.data?.links&&s.data?.links.length>0&&y.createElement("div",null,y.createElement(De.gW,null,s.data?.links?.map((l,c)=>y.createElement(rn.z9,{key:c,icon:"external-link-alt",target:l.target,href:l.href,onClick:l.onClick,fill:"text",style:{width:"100%"}},l.title))));return y.createElement(y.Fragment,null,t.tooltip?.element&&t.tooltip.anchorPoint&&y.createElement(Fn.ZL,null,y.createElement(ym.o,{position:{x:t.tooltip.anchorPoint.x,y:t.tooltip.anchorPoint.y},offset:{x:5,y:0},allowPointerEvents:t.tooltip.isOpen},y.createElement("section",{ref:n,...i,...a},t.tooltip.isOpen&&y.createElement(bm.J,{style:{zIndex:1},onClick:r}),y.createElement("div",{className:e.wrapper},o())))))},Cm=t=>({wrapper:(0,rt.css)({marginTop:"20px",background:t.colors.background.primary})}),gd="connectionControl",md="connection anchor",os=8,Cr=3,Sm=({setRef:t,handleMouseLeave:e})=>{const r=(0,y.useRef)(null),n=(0,Pt.of)(xm),i=2.5,a=5.5,s="data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1cHgiIGhlaWdodD0iNXB4IiB2ZXJzaW9uPSIxLjEiPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2Utd2lkdGg9IjIiIHN0eWxlPSJzdHJva2Utb3BhY2l0eTowLjQiIHN0cm9rZT0iI2ZmZmZmZiIvPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2U9IiMyOWI2ZjIiLz48L3N2Zz4=",o=f=>{f.target instanceof HTMLImageElement&&r.current&&f.target.style&&(r.current.style.display="block",r.current.style.top=`calc(${f.target.style.top} - ${a}px + ${Cr}px)`,r.current.style.left=`calc(${f.target.style.left} - ${a}px + ${Cr}px)`)},l=()=>{r.current&&(r.current.style.display="none")},c=f=>{e(f)&&l()},u=[{x:-1,y:1},{x:-.5,y:1},{x:0,y:1},{x:.5,y:1},{x:1,y:1},{x:1,y:.5},{x:1,y:0},{x:1,y:-.5},{x:1,y:-1},{x:.5,y:-1},{x:0,y:-1},{x:-.5,y:-1},{x:-1,y:-1},{x:-1,y:-.5},{x:-1,y:0},{x:-1,y:.5}],d=(f=u)=>f.map(p=>{const v=`${p.x},${p.y}`,h={top:`calc(${-p.y*50+50}% - ${i}px - ${Cr}px)`,left:`calc(${p.x*50+50}% - ${i}px - ${Cr}px)`};return y.createElement("img",{id:v,ref:g=>{g&&g.style.setProperty("pointer-events","auto","important")},key:v,alt:md,className:n.anchor,style:h,src:s,onMouseEnter:o})});return y.createElement("div",{className:n.root,ref:t},y.createElement("div",{className:n.mouseoutDiv,onMouseOut:c,onBlur:c}),y.createElement("div",{id:gd,ref:r,className:n.highlightElement,onMouseLeave:l}),d())},xm=t=>({root:(0,rt.css)({position:"absolute",display:"none"}),mouseoutDiv:(0,rt.css)({position:"absolute",margin:"-30px",width:"calc(100% + 60px)",height:"calc(100% + 60px)"}),anchor:(0,rt.css)({padding:`${Cr}px`,position:"absolute",cursor:"cursor",width:`calc(5px + 2 * ${Cr}px)`,height:`calc(5px + 2 * ${Cr}px)`,zIndex:100}),highlightElement:(0,rt.css)({backgroundColor:"#00ff00",opacity:.3,position:"absolute",cursor:"cursor",pointerEvents:"auto",width:"16px",height:"16px",borderRadius:t.shape.radius.circle,display:"none",zIndex:110})});let Dm=0;const wm=["input","textarea"],Tm=({setSVGRef:t,setLineRef:e,scene:r})=>{const n=(0,Pt.of)(Am),i=Date.now()+"_"+Dm++,a=(0,y.useMemo)(()=>`connectionLineId-${i}`,[i]),s=(0,y.useMemo)(()=>`editorHead-${i}`,[i]),o=ve.$W.theme2.colors.text.primary,l=2,[c,u]=(0,y.useState)(void 0),d=(0,y.useRef)(c);(0,y.useEffect)(()=>{d.current=c}),(0,y.useEffect)(()=>{r.panel.context.instanceState?.selectedConnection&&u(r.panel.context.instanceState?.selectedConnection)},[r.panel.context.instanceState?.selectedConnection]);const f=g=>{const m=g.target;if(m instanceof HTMLElement&&!(wm.indexOf(m.nodeName.toLowerCase())>-1)){if(g.keyCode===8||g.keyCode===46)d.current&&d.current.source&&(d.current.source.options.connections=d.current.source.options.connections?.filter(b=>b!==d.current?.info),d.current.source.onChange(d.current.source.options),u(void 0),r.connections.select(void 0),r.connections.updateState(),r.save());else return;document.removeEventListener("keyup",f),r.selecto.rootContainer.removeEventListener("click",p)}},p=g=>{const m=g.target;!(m instanceof SVGLineElement&&m.id===a)&&(u(void 0),r.connections.select(void 0))},v=g=>{r.isEditingEnabled&&(u(g),r.connections.select(g),document.addEventListener("keyup",f),r.selecto.rootContainer.addEventListener("click",p))},h=()=>r.connections.state.map((g,m)=>{const{source:b,target:E,info:C}=g,x=b.div?.getBoundingClientRect(),S=b.div?.parentElement,w=r.scale,D=un(r);if(!x||!S||!D)return;const{x1:T,y1:A,x2:M,y2:P}=op(x,D,C,E,w),{strokeColor:k,strokeWidth:_}=lp(C,r,l),N=c===g&&r.panel.context.instanceState.selectedConnection,I=r.isEditingEnabled?"grab":"",B={stroke:"#44aaff",strokeOpacity:.6,strokeWidth:_+5},L=`connectionHead-${i+Math.random()}`;return y.createElement("svg",{className:n.connection,key:m},y.createElement("g",{onClick:()=>v(g)},y.createElement("defs",null,y.createElement("marker",{id:L,markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto",stroke:k},y.createElement("polygon",{points:"0 0, 10 3.5, 0 7",fill:k}))),y.createElement("line",{id:`${a}_transparent`,cursor:I,pointerEvents:"auto",stroke:"transparent",strokeWidth:15,style:N?B:{},x1:T,y1:A,x2:M,y2:P}),y.createElement("line",{id:a,stroke:k,pointerEvents:"auto",strokeWidth:_,markerEnd:`url(#${L})`,x1:T,y1:A,x2:M,y2:P,cursor:I})))});return y.createElement(y.Fragment,null,y.createElement("svg",{ref:t,className:n.editorSVG},y.createElement("defs",null,y.createElement("marker",{id:s,markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto",stroke:o},y.createElement("polygon",{points:"0 0, 10 3.5, 0 7",fill:o}))),y.createElement("line",{ref:e,stroke:o,strokeWidth:2,markerEnd:`url(#${s})`})),h())},Am=t=>({editorSVG:(0,rt.css)({position:"absolute",pointerEvents:"none",width:"100%",height:"100%",zIndex:1e3,display:"none"}),connection:(0,rt.css)({position:"absolute",width:"100%",height:"100%",zIndex:1e3,pointerEvents:"none"})});class Mm{constructor(e){this.state=[],this.selection=new Qu.t(void 0),this.select=r=>{r!==this.selection.value&&this.selection.next(r)},this.updateState=()=>{const r=this.selection.value;if(this.state=$s(this.scene.byName),r){for(let n of this.state)if(n.source===r.source&&n.index===r.index){this.selection.next(n);break}}},this.setConnectionAnchorRef=r=>{this.connectionAnchorDiv=r},this.setConnectionSVGRef=r=>{this.connectionSVG=r},this.setConnectionLineRef=r=>{this.connectionLine=r},this.findElementTarget=r=>{let n;if(r!==this.scene.div)return n=this.scene.findElementByTarget(r),!n&&r.parentElement&&(n=this.findElementTarget(r.parentElement)),n},this.handleMouseEnter=r=>{if(!(r.target instanceof Element)||!this.scene.isEditingEnabled)return;let n=this.findElementTarget(r.target);if(!n){console.log("no element");return}if(this.isDrawingConnection)this.connectionTarget=n;else if(this.connectionSource=n,!this.connectionSource){console.log("no connection source");return}const i=n.div.getBoundingClientRect(),a=this.scene.scale,s=un(this.scene),o=i.top-(s?.top??0),l=i.left-(s?.left??0);this.connectionAnchorDiv&&(this.connectionAnchorDiv.style.display="none",this.connectionAnchorDiv.style.display="block",this.connectionAnchorDiv.style.top=`${o/a}px`,this.connectionAnchorDiv.style.left=`${l/a}px`,this.connectionAnchorDiv.style.height=`${i.height/a}px`,this.connectionAnchorDiv.style.width=`${i.width/a}px`)},this.handleMouseLeave=r=>r.relatedTarget instanceof HTMLImageElement&&r.relatedTarget.getAttribute("alt")===md?!1:(this.connectionTarget=void 0,this.connectionAnchorDiv.style.display="none",!0),this.connectionListener=r=>{if(r.preventDefault(),!(this.connectionLine&&this.scene.div&&this.scene.div.parentElement))return;const n=this.scene.scale,i=un(this.scene);if(!i)return;const a=r.pageX-i.x,s=r.pageY-i.y;this.connectionLine.setAttribute("x2",`${a/n}`),this.connectionLine.setAttribute("y2",`${s/n}`);const o=this.connectionLine.x1.baseVal.value,l=this.connectionLine.y1.baseVal.value;if(this.didConnectionLeaveHighlight||Math.hypot(a-o,s-l)>os&&this.connectionSVG&&(this.didConnectionLeaveHighlight=!0,this.connectionSVG.style.display="block",this.isDrawingConnection=!0),!r.buttons){if(this.connectionSource&&this.connectionSource.div&&this.connectionSource.div.parentElement){const c=this.connectionSource.div.getBoundingClientRect(),u=this.scene.scale,d=un(this.scene);if(!d)return;const f=(c.top-d.top+c.height/2)/u,p=(c.left-d.left+c.width/2)/u,v=(o-p)/(c.width/2/u),h=(f-l)/(c.height/2/u);let g,m,b;if(this.connectionTarget&&this.connectionTarget.div){const x=this.connectionTarget.div.getBoundingClientRect(),S=x.top-d.top+x.height/2,w=x.left-d.left+x.width/2;g=(a-w)/(x.width/2),m=(S-s)/(x.height/2),b=this.connectionTarget.options.name}else{const x=d.height/2,S=d.width/2;g=(a-S)/(d.width/2),m=(x-s)/(d.height/2)}const E={source:{x:v,y:h},target:{x:g,y:m},targetName:b,color:{fixed:Xe.$.theme2.colors.text.primary},size:{fixed:2,min:1,max:10},path:Rs.Straight},{options:C}=this.connectionSource;C.connections||(C.connections=[]),this.didConnectionLeaveHighlight&&(this.connectionSource.options.connections=[...C.connections,E],this.connectionSource.onChange(this.connectionSource.options))}this.connectionSVG&&(this.connectionSVG.style.display="none"),this.scene.selecto&&this.scene.selecto.rootContainer&&(this.scene.selecto.rootContainer.style.cursor="default",this.scene.selecto.rootContainer.removeEventListener("mousemove",this.connectionListener)),this.isDrawingConnection=!1,this.updateState(),this.scene.save()}},this.handleConnectionDragStart=(r,n,i)=>{if(this.scene.selecto.rootContainer.style.cursor="crosshair",this.connectionSVG&&this.connectionLine&&this.scene.div&&this.scene.div.parentElement){const a=r.getBoundingClientRect(),s=this.scene.scale,o=un(this.scene);if(!o)return;const l=os*s,c=os*s,u=(a.x-o.x+l)/s,d=(a.y-o.y+c)/s,f=n-o.x,p=i-o.y;this.connectionLine.setAttribute("x1",`${u}`),this.connectionLine.setAttribute("y1",`${d}`),this.connectionLine.setAttribute("x2",`${f}`),this.connectionLine.setAttribute("y2",`${p}`),this.didConnectionLeaveHighlight=!1}this.scene.selecto?.rootContainer?.addEventListener("mousemove",this.connectionListener)},this.onChange=(r,n)=>{const i=r.source.options.connections?.splice(0)??[];i[r.index]=n,r.source.onChange({...r.source.options,connections:i}),this.updateState()},this.connectionsNeedUpdate=r=>ip(r)||Vs(r,this.scene.byName),this.scene=e,this.updateState()}render(){return y.createElement(y.Fragment,null,y.createElement(Sm,{setRef:this.setConnectionAnchorRef,handleMouseLeave:this.handleMouseLeave}),y.createElement(Tm,{setSVGRef:this.setConnectionSVGRef,setLineRef:this.setConnectionLineRef,scene:this.scene}))}}var Ce=function(t,e){return Number(t.toFixed(e))},km=function(t,e){return typeof t=="number"?t:e},_t=function(t,e,r){r&&typeof r=="function"&&r(t,e)},Pm=function(t){return-Math.cos(t*Math.PI)/2+.5},Om=function(t){return t},Rm=function(t){return t*t},_m=function(t){return t*(2-t)},Nm=function(t){return t<.5?2*t*t:-1+(4-2*t)*t},Lm=function(t){return t*t*t},zm=function(t){return--t*t*t+1},Im=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},Bm=function(t){return t*t*t*t},Gm=function(t){return 1- --t*t*t*t},Fm=function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},Km=function(t){return t*t*t*t*t},Wm=function(t){return 1+--t*t*t*t*t},Ym=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},yd={easeOut:Pm,linear:Om,easeInQuad:Rm,easeOutQuad:_m,easeInOutQuad:Nm,easeInCubic:Lm,easeOutCubic:zm,easeInOutCubic:Im,easeInQuart:Bm,easeOutQuart:Gm,easeInOutQuart:Fm,easeInQuint:Km,easeOutQuint:Wm,easeInOutQuint:Ym},bd=function(t){typeof t=="number"&&cancelAnimationFrame(t)},Ie=function(t){t.mounted&&(bd(t.animation),t.animate=!1,t.animation=null,t.velocity=null)};function Ed(t,e,r,n){if(t.mounted){var i=new Date().getTime(),a=1;Ie(t),t.animation=function(){if(!t.mounted)return bd(t.animation);var s=new Date().getTime()-i,o=s/r,l=yd[e],c=l(o);s>=r?(n(a),t.animation=null):t.animation&&(n(c),requestAnimationFrame(t.animation))},requestAnimationFrame(t.animation)}}function Xm(t){var e=t.scale,r=t.positionX,n=t.positionY;return!(Number.isNaN(e)||Number.isNaN(r)||Number.isNaN(n))}function er(t,e,r,n){var i=Xm(e);if(!(!t.mounted||!i)){var a=t.setTransformState,s=t.transformState,o=s.scale,l=s.positionX,c=s.positionY,u=e.scale-o,d=e.positionX-l,f=e.positionY-c;r===0?a(e.scale,e.positionX,e.positionY):Ed(t,n,r,function(p){var v=o+u*p,h=l+d*p,g=c+f*p;a(v,h,g)})}}function Hm(t,e,r){var n=t.offsetWidth,i=t.offsetHeight,a=e.offsetWidth,s=e.offsetHeight,o=a*r,l=s*r,c=n-o,u=i-l;return{wrapperWidth:n,wrapperHeight:i,newContentWidth:o,newDiffWidth:c,newContentHeight:l,newDiffHeight:u}}var Vm=function(t,e,r,n,i,a,s){var o=t>e?r*(s?1:.5):0,l=n>i?a*(s?1:.5):0,c=t-e-o,u=o,d=n-i-l,f=l;return{minPositionX:c,maxPositionX:u,minPositionY:d,maxPositionY:f}},ss=function(t,e){var r=t.wrapperComponent,n=t.contentComponent,i=t.setup.centerZoomedOut;if(!r||!n)throw new Error("Components are not mounted");var a=Hm(r,n,e),s=a.wrapperWidth,o=a.wrapperHeight,l=a.newContentWidth,c=a.newDiffWidth,u=a.newContentHeight,d=a.newDiffHeight,f=Vm(s,l,c,o,u,d,!!i);return f},ls=function(t,e,r,n){return n?t<e?Ce(e,2):t>r?Ce(r,2):Ce(t,2):Ce(t,2)},Zr=function(t,e){var r=ss(t,e);return t.bounds=r,r};function Qi(t,e,r,n,i,a,s){var o=r.minPositionX,l=r.minPositionY,c=r.maxPositionX,u=r.maxPositionY,d=0,f=0;s&&(d=i,f=a);var p=ls(t,o-d,c+d,n),v=ls(e,l-f,u+f,n);return{x:p,y:v}}function qi(t,e,r,n,i,a){var s=t.transformState,o=s.scale,l=s.positionX,c=s.positionY,u=n-o;if(typeof e!="number"||typeof r!="number")return console.error("Mouse X and Y position were not provided!"),{x:l,y:c};var d=l-e*u,f=c-r*u,p=Qi(d,f,i,a,0,0,null);return p}function Wn(t,e,r,n,i){var a=i?n:0,s=e-a;return!Number.isNaN(r)&&t>=r?r:!Number.isNaN(e)&&t<=s?s:t}var Cd=function(t,e){var r=t.setup.panning.excluded,n=t.isInitialized,i=t.wrapperComponent,a=e.target,s="shadowRoot"in a&&"composedPath"in e,o=s?e.composedPath().some(function(u){return u instanceof Element?i?.contains(u):!1}):i?.contains(a),l=n&&a&&o;if(!l)return!1;var c=ra(a,r);return!c},Sd=function(t){var e=t.isInitialized,r=t.isPanning,n=t.setup,i=n.panning.disabled,a=e&&r&&!i;return!!a},$m=function(t,e){var r=t.transformState,n=r.positionX,i=r.positionY;t.isPanning=!0;var a=e.clientX,s=e.clientY;t.startCoords={x:a-n,y:s-i}},jm=function(t,e){var r=e.touches,n=t.transformState,i=n.positionX,a=n.positionY;t.isPanning=!0;var s=r.length===1;if(s){var o=r[0].clientX,l=r[0].clientY;t.startCoords={x:o-i,y:l-a}}};function Um(t){var e=t.transformState,r=e.positionX,n=e.positionY,i=e.scale,a=t.setup,s=a.disabled,o=a.limitToBounds,l=a.centerZoomedOut,c=t.wrapperComponent;if(!(s||!c||!t.bounds)){var u=t.bounds,d=u.maxPositionX,f=u.minPositionX,p=u.maxPositionY,v=u.minPositionY,h=r>d||r<f,g=n>p||n<v,m=r>d?c.offsetWidth:t.setup.minPositionX||0,b=n>p?c.offsetHeight:t.setup.minPositionY||0,E=qi(t,m,b,i,t.bounds,o||l),C=E.x,x=E.y;return{scale:i,positionX:h?C:r,positionY:g?x:n}}}function xd(t,e,r,n,i){var a=t.setup.limitToBounds,s=t.wrapperComponent,o=t.bounds,l=t.transformState,c=l.scale,u=l.positionX,d=l.positionY;if(!(s===null||o===null||e===u&&r===d)){var f=Qi(e,r,o,a,n,i,s),p=f.x,v=f.y;t.setTransformState(c,p,v)}}var Zm=function(t,e,r){var n=t.startCoords,i=t.transformState,a=t.setup.panning,s=a.lockAxisX,o=a.lockAxisY,l=i.positionX,c=i.positionY;if(!n)return{x:l,y:c};var u=e-n.x,d=r-n.y,f=s?l:u,p=o?c:d;return{x:f,y:p}},Qr=function(t,e){var r=t.setup,n=t.transformState,i=n.scale,a=r.minScale,s=r.disablePadding;return e>0&&i>=a&&!s?e:0},Qm=function(t){var e=t.mounted,r=t.setup,n=r.disabled,i=r.velocityAnimation,a=t.transformState.scale,s=i.disabled,o=!s||a>1||!n||e;return!!o},qm=function(t){var e=t.mounted,r=t.velocity,n=t.bounds,i=t.setup,a=i.disabled,s=i.velocityAnimation,o=t.transformState.scale,l=s.disabled,c=!l||o>1||!a||e;return!(!c||!r||!n)};function Jm(t,e){var r=t.setup.velocityAnimation,n=r.equalToMove,i=r.animationTime,a=r.sensitivity;return n?i*e*a:i}function Dd(t,e,r,n,i,a,s,o,l,c){if(i){if(e>s&&r>s){var u=s+(t-s)*c;return u>l?l:u<s?s:u}if(e<a&&r<a){var u=a+(t-a)*c;return u<o?o:u>a?a:u}}return n?e:ls(t,a,s,i)}function t1(t,e){var r=1;return e?Math.min(r,t.offsetWidth/window.innerWidth):r}function e1(t,e){var r=Qm(t);if(r){var n=t.lastMousePosition,i=t.velocityTime,a=t.setup,s=t.wrapperComponent,o=a.velocityAnimation.equalToMove,l=Date.now();if(n&&i&&s){var c=t1(s,o),u=e.x-n.x,d=e.y-n.y,f=u/c,p=d/c,v=l-i,h=u*u+d*d,g=Math.sqrt(h)/v;t.velocity={velocityX:f,velocityY:p,total:g}}t.lastMousePosition=e,t.velocityTime=l}}function r1(t){var e=t.velocity,r=t.bounds,n=t.setup,i=t.wrapperComponent,a=qm(t);if(!(!a||!e||!r||!i)){var s=e.velocityX,o=e.velocityY,l=e.total,c=r.maxPositionX,u=r.minPositionX,d=r.maxPositionY,f=r.minPositionY,p=n.limitToBounds,v=n.alignmentAnimation,h=n.zoomAnimation,g=n.panning,m=g.lockAxisY,b=g.lockAxisX,E=h.animationType,C=v.sizeX,x=v.sizeY,S=v.velocityAlignmentTime,w=S,D=Jm(t,l),T=Math.max(D,w),A=Qr(t,C),M=Qr(t,x),P=A*i.offsetWidth/100,k=M*i.offsetHeight/100,_=c+P,N=u-P,I=d+k,B=f-k,L=t.transformState,G=new Date().getTime();Ed(t,E,T,function(W){var z=t.transformState,X=z.scale,j=z.positionX,Y=z.positionY,Z=new Date().getTime()-G,U=Z/w,q=yd[v.animationType],et=1-q(Math.min(1,U)),at=1-W,ot=j+s*at,V=Y+o*at,tt=Dd(ot,L.positionX,j,b,p,u,c,N,_,et),gt=Dd(V,L.positionY,Y,m,p,f,d,B,I,et);(j!==ot||Y!==V)&&t.setTransformState(X,tt,gt)})}}function wd(t,e){var r=t.transformState.scale;Ie(t),Zr(t,r),window.TouchEvent!==void 0&&e instanceof TouchEvent?jm(t,e):$m(t,e)}function Td(t){var e=t.transformState.scale,r=t.setup,n=r.minScale,i=r.alignmentAnimation,a=i.disabled,s=i.sizeX,o=i.sizeY,l=i.animationTime,c=i.animationType,u=a||e<n||!s&&!o;if(!u){var d=Um(t);d&&er(t,d,l,c)}}function Ad(t,e,r){var n=t.startCoords,i=t.setup,a=i.alignmentAnimation,s=a.sizeX,o=a.sizeY;if(n){var l=Zm(t,e,r),c=l.x,u=l.y,d=Qr(t,s),f=Qr(t,o);e1(t,{x:c,y:u}),xd(t,c,u,d,f)}}function n1(t){if(t.isPanning){var e=t.setup.panning.velocityDisabled,r=t.velocity,n=t.wrapperComponent,i=t.contentComponent;t.isPanning=!1,t.animate=!1,t.animation=null;var a=n?.getBoundingClientRect(),s=i?.getBoundingClientRect(),o=a?.width||0,l=a?.height||0,c=s?.width||0,u=s?.height||0,d=o<c||l<u,f=!e&&r&&r?.total>.1&&d;f?r1(t):Td(t)}}function cs(t,e,r,n){var i=t.setup,a=i.minScale,s=i.maxScale,o=i.limitToBounds,l=Wn(Ce(e,2),a,s,0,!1),c=Zr(t,l),u=qi(t,r,n,l,c,o),d=u.x,f=u.y;return{scale:l,positionX:d,positionY:f}}function Md(t,e,r){var n=t.transformState.scale,i=t.wrapperComponent,a=t.setup,s=a.minScale,o=a.limitToBounds,l=a.zoomAnimation,c=l.disabled,u=l.animationTime,d=l.animationType,f=c||n>=s;if((n>=1||o)&&Td(t),!(f||!i||!t.mounted)){var p=e||i.offsetWidth/2,v=r||i.offsetHeight/2,h=cs(t,s,p,v);h&&er(t,h,u,d)}}var Se=function(){return Se=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Se.apply(this,arguments)};function i1(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function us(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))}var Ji={previousScale:1,scale:1,positionX:0,positionY:0},Yn={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},kd=function(t){var e,r,n,i;return{previousScale:(e=t.initialScale)!==null&&e!==void 0?e:Ji.scale,scale:(r=t.initialScale)!==null&&r!==void 0?r:Ji.scale,positionX:(n=t.initialPositionX)!==null&&n!==void 0?n:Ji.positionX,positionY:(i=t.initialPositionY)!==null&&i!==void 0?i:Ji.positionY}},Pd=function(t){var e=Se({},Yn);return Object.keys(t).forEach(function(r){var n=typeof t[r]<"u",i=typeof Yn[r]<"u";if(i&&n){var a=Object.prototype.toString.call(Yn[r]),s=a==="[object Object]",o=a==="[object Array]";s?e[r]=Se(Se({},Yn[r]),t[r]):o?e[r]=us(us([],Yn[r],!0),t[r],!0):e[r]=t[r]}}),e},Od=function(t,e,r){var n=t.transformState.scale,i=t.wrapperComponent,a=t.setup,s=a.maxScale,o=a.minScale,l=a.zoomAnimation,c=a.smooth,u=l.size;if(!i)throw new Error("Wrapper is not mounted");var d=c?n*Math.exp(e*r):n+e*r,f=Wn(Ce(d,3),o,s,u,!1);return f};function Rd(t,e,r,n,i){var a=t.wrapperComponent,s=t.transformState,o=s.scale,l=s.positionX,c=s.positionY;if(!a)return console.error("No WrapperComponent found");var u=a.offsetWidth,d=a.offsetHeight,f=(u/2-l)/o,p=(d/2-c)/o,v=Od(t,e,r),h=cs(t,v,f,p);if(!h)return console.error("Error during zoom event. New transformation state was not calculated.");er(t,h,n,i)}function _d(t,e,r,n){var i=t.setup,a=t.wrapperComponent,s=i.limitToBounds,o=kd(t.props),l=t.transformState,c=l.scale,u=l.positionX,d=l.positionY;if(a){var f=ss(t,o.scale),p=Qi(o.positionX,o.positionY,f,s,0,0,a),v={scale:o.scale,positionX:p.x,positionY:p.y};c===o.scale&&u===o.positionX&&d===o.positionY||(n?.(),er(t,v,e,r))}}function a1(t,e,r,n){var i=t.getBoundingClientRect(),a=e.getBoundingClientRect(),s=r.getBoundingClientRect(),o=a.x*n.scale,l=a.y*n.scale;return{x:(i.x-s.x+o)/n.scale,y:(i.y-s.y+l)/n.scale}}function o1(t,e,r){var n=t.wrapperComponent,i=t.contentComponent,a=t.transformState,s=t.setup,o=s.limitToBounds,l=s.minScale,c=s.maxScale;if(!n||!i)return a;var u=n.getBoundingClientRect(),d=e.getBoundingClientRect(),f=a1(e,n,i,a),p=f.x,v=f.y,h=d.width/a.scale,g=d.height/a.scale,m=n.offsetWidth/h,b=n.offsetHeight/g,E=Wn(r||Math.min(m,b),l,c,0,!1),C=(u.width-h*E)/2,x=(u.height-g*E)/2,S=(u.left-p)*E+C,w=(u.top-v)*E+x,D=ss(t,E),T=Qi(S,w,D,o,0,0,n),A=T.x,M=T.y;return{positionX:A,positionY:M,scale:E}}var s1=function(t){return function(e,r,n){e===void 0&&(e=.5),r===void 0&&(r=300),n===void 0&&(n="easeOut"),Rd(t,1,e,r,n)}},l1=function(t){return function(e,r,n){e===void 0&&(e=.5),r===void 0&&(r=300),n===void 0&&(n="easeOut"),Rd(t,-1,e,r,n)}},c1=function(t){return function(e,r,n,i,a){i===void 0&&(i=300),a===void 0&&(a="easeOut");var s=t.transformState,o=s.positionX,l=s.positionY,c=s.scale,u=t.wrapperComponent,d=t.contentComponent,f=t.setup.disabled;if(!(f||!u||!d)){var p={positionX:Number.isNaN(e)?o:e,positionY:Number.isNaN(r)?l:r,scale:Number.isNaN(n)?c:n};er(t,p,i,a)}}},u1=function(t){return function(e,r){e===void 0&&(e=200),r===void 0&&(r="easeOut"),_d(t,e,r)}},d1=function(t){return function(e,r,n){r===void 0&&(r=200),n===void 0&&(n="easeOut");var i=t.transformState,a=t.wrapperComponent,s=t.contentComponent;if(a&&s){var o=Nd(e||i.scale,a,s);er(t,o,r,n)}}},f1=function(t){return function(e,r,n,i){n===void 0&&(n=600),i===void 0&&(i="easeOut"),Ie(t);var a=t.wrapperComponent,s=typeof e=="string"?document.getElementById(e):e;if(a&&s&&a.contains(s)){var o=o1(t,s,r);er(t,o,n,i)}}},ta=function(t){return{instance:t,zoomIn:s1(t),zoomOut:l1(t),setTransform:c1(t),resetTransform:u1(t),centerView:d1(t),zoomToElement:f1(t)}},ea=function(t){return{instance:t,state:t.transformState}},Tt=function(t){var e={};return Object.assign(e,ea(t)),Object.assign(e,ta(t)),e},ds=!1;function fs(){try{var t={get passive(){return ds=!0,!1}};return t}catch{return ds=!1,ds}}var ra=function(t,e){return e.some(function(r){return t.matches("".concat(r,", .").concat(r,", ").concat(r," *, .").concat(r," *"))})},ps=function(t){t&&clearTimeout(t)},p1=function(t,e,r){return"translate(".concat(t,"px, ").concat(e,"px) scale(").concat(r,")")},hE=function(t,e,r){var n=r,i=0,a=0,s=r,o=t,l=e;return"matrix3d(".concat(n,", ").concat(i,", 0, 0, ").concat(a,", ").concat(s,", 0, 0, 0, 0, 1, 0, ").concat(o,", ").concat(l,", 0, 1)")},Nd=function(t,e,r){var n=r.offsetWidth*t,i=r.offsetHeight*t,a=(e.offsetWidth-n)/2,s=(e.offsetHeight-i)/2;return{scale:t,positionX:a,positionY:s}};function v1(t){return function(e){t.forEach(function(r){typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var h1=function(t,e){var r=t.setup.wheel,n=r.disabled,i=r.wheelDisabled,a=r.touchPadDisabled,s=r.excluded,o=t.isInitialized,l=t.isPanning,c=e.target,u=o&&!l&&!n&&c;if(!u||i&&!e.ctrlKey||a&&e.ctrlKey)return!1;var d=ra(c,s);return!d},g1=function(t){return t?t.deltaY<0?1:-1:0};function m1(t,e){var r=g1(t),n=km(e,r);return n}function Ld(t,e,r){var n=e.getBoundingClientRect(),i=0,a=0;if("clientX"in t)i=(t.clientX-n.left)/r,a=(t.clientY-n.top)/r;else{var s=t.touches[0];i=(s.clientX-n.left)/r,a=(s.clientY-n.top)/r}return(Number.isNaN(i)||Number.isNaN(a))&&console.error("No mouse or touch offset found"),{x:i,y:a}}var y1=function(t,e,r,n,i){var a=t.transformState.scale,s=t.wrapperComponent,o=t.setup,l=o.maxScale,c=o.minScale,u=o.zoomAnimation,d=o.disablePadding,f=u.size,p=u.disabled;if(!s)throw new Error("Wrapper is not mounted");var v=a+e*r;if(i)return v;var h=n?!1:!p,g=Wn(Ce(v,3),c,l,f,h&&!d);return g},b1=function(t,e){var r=t.previousWheelEvent,n=t.transformState.scale,i=t.setup,a=i.maxScale,s=i.minScale;return r?n<a||n>s||Math.sign(r.deltaY)!==Math.sign(e.deltaY)||r.deltaY>0&&r.deltaY<e.deltaY||r.deltaY<0&&r.deltaY>e.deltaY||Math.sign(r.deltaY)!==Math.sign(e.deltaY):!1},E1=function(t,e){var r=t.setup.pinch,n=r.disabled,i=r.excluded,a=t.isInitialized,s=e.target,o=a&&!n&&s;if(!o)return!1;var l=ra(s,i);return!l},C1=function(t){var e=t.setup.pinch.disabled,r=t.isInitialized,n=t.pinchStartDistance,i=r&&!e&&n;return!!i},S1=function(t,e,r){var n=r.getBoundingClientRect(),i=t.touches,a=Ce(i[0].clientX-n.left,5),s=Ce(i[0].clientY-n.top,5),o=Ce(i[1].clientX-n.left,5),l=Ce(i[1].clientY-n.top,5);return{x:(a+o)/2/e,y:(s+l)/2/e}},zd=function(t){return Math.sqrt(Math.pow(t.touches[0].pageX-t.touches[1].pageX,2)+Math.pow(t.touches[0].pageY-t.touches[1].pageY,2))},x1=function(t,e){var r=t.pinchStartScale,n=t.pinchStartDistance,i=t.setup,a=i.maxScale,s=i.minScale,o=i.zoomAnimation,l=i.disablePadding,c=o.size,u=o.disabled;if(!r||n===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return t.transformState.scale;var d=e/n,f=d*r;return Wn(Ce(f,2),s,a,c,!u&&!l)},D1=160,w1=100,T1=function(t,e){var r=t.props,n=r.onWheelStart,i=r.onZoomStart;t.wheelStopEventTimer||(Ie(t),_t(Tt(t),e,n),_t(Tt(t),e,i))},A1=function(t,e){var r=t.props,n=r.onWheel,i=r.onZoom,a=t.contentComponent,s=t.setup,o=t.transformState,l=o.scale,c=s.limitToBounds,u=s.centerZoomedOut,d=s.zoomAnimation,f=s.wheel,p=s.disablePadding,v=s.smooth,h=d.size,g=d.disabled,m=f.step,b=f.smoothStep;if(!a)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var E=m1(e,null),C=v?b*Math.abs(e.deltaY):m,x=y1(t,E,C,!e.ctrlKey);if(l!==x){var S=Zr(t,x),w=Ld(e,a,l),D=g||h===0||u||p,T=c&&D,A=qi(t,w.x,w.y,x,S,T),M=A.x,P=A.y;t.previousWheelEvent=e,t.setTransformState(x,M,P),_t(Tt(t),e,n),_t(Tt(t),e,i)}},M1=function(t,e){var r=t.props,n=r.onWheelStop,i=r.onZoomStop;ps(t.wheelAnimationTimer),t.wheelAnimationTimer=setTimeout(function(){t.mounted&&(Md(t,e.x,e.y),t.wheelAnimationTimer=null)},w1);var a=b1(t,e);a&&(ps(t.wheelStopEventTimer),t.wheelStopEventTimer=setTimeout(function(){t.mounted&&(t.wheelStopEventTimer=null,_t(Tt(t),e,n),_t(Tt(t),e,i))},D1))},k1=function(t,e){var r=zd(e);t.pinchStartDistance=r,t.lastDistance=r,t.pinchStartScale=t.transformState.scale,t.isPanning=!1,Ie(t)},P1=function(t,e){var r=t.contentComponent,n=t.pinchStartDistance,i=t.transformState.scale,a=t.setup,s=a.limitToBounds,o=a.centerZoomedOut,l=a.zoomAnimation,c=l.disabled,u=l.size;if(!(n===null||!r)){var d=S1(e,i,r);if(!(!Number.isFinite(d.x)||!Number.isFinite(d.y))){var f=zd(e),p=x1(t,f);if(p!==i){var v=Zr(t,p),h=c||u===0||o,g=s&&h,m=qi(t,d.x,d.y,p,v,g),b=m.x,E=m.y;t.pinchMidpoint=d,t.lastDistance=f,t.setTransformState(p,b,E)}}}},O1=function(t){var e=t.pinchMidpoint;t.velocity=null,t.lastDistance=null,t.pinchMidpoint=null,t.pinchStartScale=null,t.pinchStartDistance=null,Md(t,e?.x,e?.y)},Id=function(t,e){var r=t.props.onZoomStop,n=t.setup.doubleClick.animationTime;ps(t.doubleClickStopEventTimer),t.doubleClickStopEventTimer=setTimeout(function(){t.doubleClickStopEventTimer=null,_t(Tt(t),e,r)},n)},R1=function(t,e){var r=t.props,n=r.onZoomStart,i=r.onZoom,a=t.setup.doubleClick,s=a.animationTime,o=a.animationType;_t(Tt(t),e,n),_d(t,s,o,function(){return _t(Tt(t),e,i)}),Id(t,e)};function _1(t,e){return t==="toggle"?e===1?1:-1:t==="zoomOut"?-1:1}function N1(t,e){var r=t.setup,n=t.doubleClickStopEventTimer,i=t.transformState,a=t.contentComponent,s=i.scale,o=t.props,l=o.onZoomStart,c=o.onZoom,u=r.doubleClick,d=u.disabled,f=u.mode,p=u.step,v=u.animationTime,h=u.animationType;if(!d&&!n){if(f==="reset")return R1(t,e);if(!a)return console.error("No ContentComponent found");var g=_1(f,t.transformState.scale),m=Od(t,g,p);if(s!==m){_t(Tt(t),e,l);var b=Ld(e,a,s),E=cs(t,m,b.x,b.y);if(!E)return console.error("Error during zoom event. New transformation state was not calculated.");_t(Tt(t),e,c),er(t,E,v,h),Id(t,e)}}}var L1=function(t,e){var r=t.isInitialized,n=t.setup,i=t.wrapperComponent,a=n.doubleClick,s=a.disabled,o=a.excluded,l=e.target,c=i?.contains(l),u=r&&l&&c&&!s;if(!u)return!1;var d=ra(l,o);return!d},z1=function(){function t(e){var r=this;this.mounted=!0,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){r.initializeWindowEvents()},this.unmount=function(){r.cleanupWindowEvents()},this.update=function(n){r.props=n,Zr(r,r.transformState.scale),r.setup=Pd(n)},this.initializeWindowEvents=function(){var n,i,a=fs(),s=(n=r.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,o=s?.defaultView;(i=r.wrapperComponent)===null||i===void 0||i.addEventListener("wheel",r.onWheelPanning,a),o?.addEventListener("mousedown",r.onPanningStart,a),o?.addEventListener("mousemove",r.onPanning,a),o?.addEventListener("mouseup",r.onPanningStop,a),s?.addEventListener("mouseleave",r.clearPanning,a),o?.addEventListener("keyup",r.setKeyUnPressed,a),o?.addEventListener("keydown",r.setKeyPressed,a)},this.cleanupWindowEvents=function(){var n,i,a=fs(),s=(n=r.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,o=s?.defaultView;o?.removeEventListener("mousedown",r.onPanningStart,a),o?.removeEventListener("mousemove",r.onPanning,a),o?.removeEventListener("mouseup",r.onPanningStop,a),s?.removeEventListener("mouseleave",r.clearPanning,a),o?.removeEventListener("keyup",r.setKeyUnPressed,a),o?.removeEventListener("keydown",r.setKeyPressed,a),document.removeEventListener("mouseleave",r.clearPanning,a),Ie(r),(i=r.observer)===null||i===void 0||i.disconnect()},this.handleInitializeWrapperEvents=function(n){var i=fs();n.addEventListener("wheel",r.onWheelZoom,i),n.addEventListener("dblclick",r.onDoubleClick,i),n.addEventListener("touchstart",r.onTouchPanningStart,i),n.addEventListener("touchmove",r.onTouchPanning,i),n.addEventListener("touchend",r.onTouchPanningStop,i)},this.handleInitialize=function(n){var i=r.setup.centerOnInit;r.applyTransformation(),r.onInitCallbacks.forEach(function(a){return a(Tt(r))}),i&&(r.setCenter(),r.observer=new ResizeObserver(function(){var a;r.onInitCallbacks.forEach(function(s){return s(Tt(r))}),r.setCenter(),(a=r.observer)===null||a===void 0||a.disconnect()}),r.observer.observe(n))},this.onWheelZoom=function(n){var i=r.setup.disabled;if(!i){var a=h1(r,n);if(a){var s=r.isPressingKeys(r.setup.wheel.activationKeys);s&&(T1(r,n),A1(r,n),M1(r,n))}}},this.onWheelPanning=function(n){var i=r.setup,a=i.disabled,s=i.wheel,o=i.panning;if(!(!r.wrapperComponent||!r.contentComponent||a||!s.wheelDisabled||o.disabled||!o.wheelPanning||n.ctrlKey)){n.preventDefault(),n.stopPropagation();var l=r.transformState,c=l.positionX,u=l.positionY,d=c-n.deltaX,f=u-n.deltaY,p=o.lockAxisX?c:d,v=o.lockAxisY?u:f,h=r.setup.alignmentAnimation,g=h.sizeX,m=h.sizeY,b=Qr(r,g),E=Qr(r,m);p===c&&v===u||xd(r,p,v,b,E)}},this.onPanningStart=function(n){var i=r.setup.disabled,a=r.props.onPanningStart;if(!i){var s=Cd(r,n);if(s){var o=r.isPressingKeys(r.setup.panning.activationKeys);o&&(n.button===0&&!r.setup.panning.allowLeftClickPan||n.button===1&&!r.setup.panning.allowMiddleClickPan||n.button===2&&!r.setup.panning.allowRightClickPan||(n.preventDefault(),n.stopPropagation(),Ie(r),wd(r,n),_t(Tt(r),n,a)))}}},this.onPanning=function(n){var i=r.setup.disabled,a=r.props.onPanning;if(!i){var s=Sd(r);if(s){var o=r.isPressingKeys(r.setup.panning.activationKeys);o&&(n.preventDefault(),n.stopPropagation(),Ad(r,n.clientX,n.clientY),_t(Tt(r),n,a))}}},this.onPanningStop=function(n){var i=r.props.onPanningStop;r.isPanning&&(n1(r),_t(Tt(r),n,i))},this.onPinchStart=function(n){var i=r.setup.disabled,a=r.props,s=a.onPinchingStart,o=a.onZoomStart;if(!i){var l=E1(r,n);l&&(k1(r,n),Ie(r),_t(Tt(r),n,s),_t(Tt(r),n,o))}},this.onPinch=function(n){var i=r.setup.disabled,a=r.props,s=a.onPinching,o=a.onZoom;if(!i){var l=C1(r);l&&(n.preventDefault(),n.stopPropagation(),P1(r,n),_t(Tt(r),n,s),_t(Tt(r),n,o))}},this.onPinchStop=function(n){var i=r.props,a=i.onPinchingStop,s=i.onZoomStop;r.pinchStartScale&&(O1(r),_t(Tt(r),n,a),_t(Tt(r),n,s))},this.onTouchPanningStart=function(n){var i=r.setup.disabled,a=r.props.onPanningStart;if(!i){var s=Cd(r,n);if(s){var o=r.lastTouch&&+new Date-r.lastTouch<200;if(o&&n.touches.length===1)r.onDoubleClick(n);else{r.lastTouch=+new Date,Ie(r);var l=n.touches,c=l.length===1,u=l.length===2;c&&(Ie(r),wd(r,n),_t(Tt(r),n,a)),u&&r.onPinchStart(n)}}}},this.onTouchPanning=function(n){var i=r.setup.disabled,a=r.props.onPanning;if(r.isPanning&&n.touches.length===1){if(i)return;var s=Sd(r);if(!s)return;n.preventDefault(),n.stopPropagation();var o=n.touches[0];Ad(r,o.clientX,o.clientY),_t(Tt(r),n,a)}else n.touches.length>1&&r.onPinch(n)},this.onTouchPanningStop=function(n){r.onPanningStop(n),r.onPinchStop(n)},this.onDoubleClick=function(n){var i=r.setup.disabled;if(!i){var a=L1(r,n);a&&N1(r,n)}},this.clearPanning=function(n){r.isPanning&&r.onPanningStop(n)},this.setKeyPressed=function(n){r.pressedKeys[n.key]=!0},this.setKeyUnPressed=function(n){r.pressedKeys[n.key]=!1},this.isPressingKeys=function(n){return n.length?!!n.find(function(i){return r.pressedKeys[i]}):!0},this.setTransformState=function(n,i,a){var s=r.props.onTransformed;if(!Number.isNaN(n)&&!Number.isNaN(i)&&!Number.isNaN(a)){n!==r.transformState.scale&&(r.transformState.previousScale=r.transformState.scale,r.transformState.scale=n),r.transformState.positionX=i,r.transformState.positionY=a,r.applyTransformation();var o=Tt(r);r.onChangeCallbacks.forEach(function(l){return l(o)}),_t(o,{scale:n,positionX:i,positionY:a},s)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(r.wrapperComponent&&r.contentComponent){var n=Nd(r.transformState.scale,r.wrapperComponent,r.contentComponent);r.setTransformState(n.scale,n.positionX,n.positionY)}},this.handleTransformStyles=function(n,i,a){return r.props.customTransform?r.props.customTransform(n,i,a):p1(n,i,a)},this.applyTransformation=function(){if(!(!r.mounted||!r.contentComponent)){var n=r.transformState,i=n.scale,a=n.positionX,s=n.positionY,o=r.handleTransformStyles(a,s,i);r.contentComponent.style.transform=o}},this.getContext=function(){return Tt(r)},this.onChange=function(n){return r.onChangeCallbacks.has(n)||r.onChangeCallbacks.add(n),function(){r.onChangeCallbacks.delete(n)}},this.onInit=function(n){return r.onInitCallbacks.has(n)||r.onInitCallbacks.add(n),function(){r.onInitCallbacks.delete(n)}},this.init=function(n,i){r.cleanupWindowEvents(),r.wrapperComponent=n,r.contentComponent=i,Zr(r,r.transformState.scale),r.handleInitializeWrapperEvents(n),r.handleInitialize(i),r.initializeWindowEvents(),r.isInitialized=!0;var a=Tt(r);_t(a,void 0,r.props.onInit)},this.props=e,this.setup=Pd(this.props),this.transformState=kd(this.props)}return t}(),na=y.createContext(null),I1=function(t,e){return typeof t=="function"?t(e):t},B1=y.forwardRef(function(t,e){var r=(0,y.useRef)(new z1(t)).current,n=I1(t.children,ta(r));return(0,y.useImperativeHandle)(e,function(){return ta(r)},[r]),(0,y.useEffect)(function(){r.update(t)},[r,t]),y.createElement(na.Provider,{value:r},n)}),gE=y.forwardRef(function(t,e){var r=(0,y.useRef)(null),n=(0,y.useContext)(na);return(0,y.useEffect)(function(){return n.onChange(function(i){if(r.current){var a=0,s=0;r.current.style.transform=n.handleTransformStyles(a,s,1/i.instance.transformState.scale)}})},[n]),y.createElement("div",Se({},t,{ref:v1([r,e])}))}),G1={width:0,height:0,y:0,x:0,top:0,bottom:0,left:0,right:0},F1=function(t,e,r){var n=useRef(),i=useRef(G1),a=useRef(!1);useLayoutEffect(function(){var s;return a.current=!1,t&&(n.current=new ResizeObserver(function(o){var l=t.getBoundingClientRect();!Array.isArray(o)||!o.length||a.current||l.width===i.current.width&&l.height===i.current.height||(e(l,t),i.current=l)}),(s=n.current)===null||s===void 0||s.observe(t)),function(){var o;a.current=!0,t&&((o=n.current)===null||o===void 0||o.unobserve(t))}},us([e,t],r,!0))},K1={position:"absolute",zIndex:2,top:"0px",left:"0px",boxSizing:"border-box",border:"3px solid red",transformOrigin:"0% 0%",boxShadow:"rgba(0,0,0,0.2) 0 0 0 10000000px"},mE=function(t){var e=t.width,r=e===void 0?200:e,n=t.height,i=n===void 0?200:n,a=t.borderColor,s=a===void 0?"red":a,o=t.children,l=i1(t,["width","height","borderColor","children"]),c=useState(!1),u=c[0],d=c[1],f=ia(),p=useRef(null),v=useRef(null),h=useRef(null),g=useRef(null),m=useCallback(function(){if(f.contentComponent){var D=f.contentComponent.getBoundingClientRect();return{width:D.width/f.transformState.scale,height:D.height/f.transformState.scale}}return{width:0,height:0}},[f.contentComponent,f.transformState.scale]),b=useCallback(function(){var D=m(),T=r/D.width,A=i/D.height,M=A>T?T:A;return M},[m,i,r]),E=function(){var D=m(),T=r/D.width,A=i/D.height;return A>T?{width:r,height:D.height*T}:{width:D.width*A,height:i}},C=function(){var D=b(),T={transform:"scale(".concat(D||1,")"),transformOrigin:"0% 0%",position:"absolute",boxSizing:"border-box",zIndex:1,overflow:"hidden"};Object.keys(T).forEach(function(A){h.current&&(h.current.style[A]=T[A])})},x=function(){C();var D=E(),T=m();if(h.current&&(h.current.style.width="".concat(T.width,"px"),h.current.style.height="".concat(T.height,"px")),v.current&&(v.current.style.width="".concat(D.width,"px"),v.current.style.height="".concat(D.height,"px")),g.current){var A=m(),M=b(),P=M*(1/f.transformState.scale),k=f.handleTransformStyles(-f.transformState.positionX*P,-f.transformState.positionY*P,1);g.current.style.transform=k,g.current.style.width="".concat(A.width*P,"px"),g.current.style.height="".concat(A.height*P,"px")}},S=function(){x()};V1(function(){x()}),H1(function(){S(),d(!0)}),F1(f.contentComponent,S,[u]),useEffect(function(){return f.onChange(function(D){var T=b();p.current&&(p.current.instance.transformState.scale=D.instance.transformState.scale,p.current.instance.transformState.positionX=D.instance.transformState.positionX*T,p.current.instance.transformState.positionY=D.instance.transformState.positionY*T)})},[b,f,p]);var w=useMemo(function(){return{position:"relative",zIndex:2,overflow:"hidden"}},[]);return React.createElement("div",Se({},l,{ref:v,style:w,className:"rzpp-mini-map ".concat(l.className||"")}),React.createElement("div",Se({},l,{ref:h,className:"rzpp-wrapper"}),o),React.createElement("div",{className:"rzpp-preview",ref:g,style:Se(Se({},K1),{borderColor:s})}))};function W1(t,e){e===void 0&&(e={});var r=e.insertAt;if(!(!t||typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",r==="top"&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}var Y1=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,Bd={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};W1(Y1);var X1=function(t){var e=t.children,r=t.wrapperClass,n=r===void 0?"":r,i=t.contentClass,a=i===void 0?"":i,s=t.wrapperStyle,o=t.contentStyle,l=t.wrapperProps,c=l===void 0?{}:l,u=t.contentProps,d=u===void 0?{}:u,f=(0,y.useContext)(na),p=f.init,v=f.cleanupWindowEvents,h=(0,y.useRef)(null),g=(0,y.useRef)(null);return(0,y.useEffect)(function(){var m=h.current,b=g.current;return m!==null&&b!==null&&p&&p?.(m,b),function(){v?.()}},[]),y.createElement("div",Se({},c,{ref:h,className:"react-transform-wrapper ".concat(Bd.wrapper," ").concat(n),style:s}),y.createElement("div",Se({},d,{ref:g,className:"react-transform-component ".concat(Bd.content," ").concat(a),style:o}),e))},ia=function(){var t=useContext(na);if(!t)throw new Error("Transform context must be placed inside TransformWrapper");return t},yE=function(){var t=ia();return ta(t)},H1=function(t){var e=ia();useEffect(function(){var r,n;return e.contentComponent&&e.wrapperComponent?r=t(ea(e)):n=e.onInit(function(i){r=t(ea(i.instance))}),function(){n?.(),r?.()}},[])},V1=function(t){var e=ia();useEffect(function(){var r,n=e.onChange(function(i){r=t(ea(i.instance))});return function(){n(),r?.()}},[t,e])};const $1=({scene:t,children:e})=>{const r=l=>{const c=l.state.scale;t.scale=c,t.shouldInfinitePan&&c<1&&(t.updateSize(t.width/c,t.height/c),t.panel.forceUpdate())},n=l=>{const c=l.state.scale;t.scale=c,s(c)},i=(l,c)=>{if(t.shouldInfinitePan&&c instanceof MouseEvent){let u=c.movementX,d=c.movementY;u>0&&(u=0),d>0&&(d=0),t.updateSize(t.width-u,t.height-d),t.panel.forceUpdate()}},a=(l,c)=>{const u=c.scale;t.scale=u,s(u)},s=l=>{t.moveable&&l>0&&(t.moveable.zoom=1/l,l===1?t.moveable.snappable=!0:t.moveable.snappable=!1)},o=l=>{(!t.shouldPanZoom||t.contextMenuVisible)&&(l.button===1||l.button===2&&l.ctrlKey)&&(l.preventDefault(),l.stopPropagation()),!t.contextMenuVisible&&!t.isPanelEditing&&l.button===2&&!l.ctrlKey&&(l.preventDefault(),l.stopPropagation())};return t.div?.parentElement?.parentElement?.parentElement?.parentElement?.setAttribute("style","overflow: hidden"),y.createElement(B1,{doubleClick:{mode:"reset"},ref:t.transformComponentRef,onZoom:r,onZoomStop:n,onTransformed:a,disabled:!Xe.$.featureToggles.canvasPanelPanZoom||!t.shouldPanZoom,panning:{allowLeftClickPan:!1},limitToBounds:!t.shouldInfinitePan,minScale:t.shouldInfinitePan?.1:void 0,onPanning:i},y.createElement(X1,null,y.createElement("div",{onMouseDown:o},e)))},j1=t=>({name:"settingsViewable",props:[],events:[],render(e,r){if(t.selecto?.getSelectedTargets()&&t.selecto?.getSelectedTargets().length>1)return;const n=(o,l)=>{const c=e.getContainer(),u=new PointerEvent("contextmenu",{clientX:o,clientY:l});c.dispatchEvent(u)},i=o=>{n(o.clientX,o.clientY)},a=o=>{if(o.key==="Enter"){const l=o.currentTarget.getBoundingClientRect();n(l.x,l.y)}},s=e.getRect();return r.createElement("div",{key:"settings-viewable",className:"moveable-settings",style:{position:"absolute",left:`${s.width+18}px`,top:"0px",color:"white",fontSize:"18px",cursor:"pointer",userSelect:"none",willChange:"transform",transform:"translate(-50%, 0px)",zIndex:100},onClick:i,onKeyDown:a,role:"button",tabIndex:0},"","\u2699\uFE0F","")}}),U1={name:"dimensionViewable",props:[],events:[],render(t,e){const r=t.getRect();return e.createElement("div",{key:"dimension-viewable",className:"moveable-dimension",style:{position:"absolute",left:`${r.width/2}px`,top:`${r.height+20}px`,background:"#4af",borderRadius:"2px",padding:"2px 4px",color:"white",fontSize:"13px",whiteSpace:"nowrap",fontWeight:"bold",willChange:"transform",transform:"translate(-50%, 0px)",zIndex:100}},Math.round(r.offsetWidth)," x ",Math.round(r.offsetHeight))}},Z1=t=>({name:"constraintViewable",props:[],events:[],render(e,r){const n=e.getRect(),i=t.findElementByTarget(e.state.target);if(t.selecto?.getSelectedTargets()&&t.selecto?.getSelectedTargets().length>1)return;let a=null,s=null;const o=i?.tempConstraint??i?.options.constraint??{},l="1px dashed #4af",c=r.createElement("div",{style:{position:"absolute",left:`${n.width/2}px`,top:`${n.height/2-n.height/16}px`,borderLeft:l,height:`${n.height/8}px`,transform:"rotate(45deg)"}}),u=r.createElement("div",{style:{position:"absolute",left:`${n.width/2}px`,top:`${n.height/2-n.height/16}px`,borderLeft:l,height:`${n.height/8}px`,transform:"rotate(-45deg)"}}),d=r.createElement("div",{},[c,u]),f=r.createElement("div",{style:{position:"absolute",left:`${n.width/2}px`,bottom:"0px",borderLeft:l,height:"100vh"}}),p=r.createElement("div",{style:{position:"absolute",left:`${n.width/2}px`,top:`${n.height}px`,borderLeft:l,height:"100vh"}}),v=r.createElement("div",{},[f,p]),h=r.createElement("div",{style:{position:"absolute",left:`${n.width/2}px`,top:`${n.height/4}px`,borderLeft:l,height:`${n.height/2}px`}}),g=r.createElement("div",{},[h,d]);switch(o.vertical){case ht.Top:a=f;break;case ht.Bottom:a=p;break;case ht.TopBottom:a=v;break;case ht.Center:a=g;break}const m=r.createElement("div",{style:{position:"absolute",right:"0px",top:`${n.height/2}px`,borderTop:l,width:"100vw"}}),b=r.createElement("div",{style:{position:"absolute",left:`${n.width}px`,top:`${n.height/2}px`,borderTop:l,width:"100vw"}}),E=r.createElement("div",{},[m,b]),C=r.createElement("div",{style:{position:"absolute",left:`${n.width/4}px`,top:`${n.height/2}px`,borderTop:l,width:`${n.width/2}px`}}),x=r.createElement("div",{},[C,d]);switch(o.horizontal){case pt.Left:s=m;break;case pt.Right:s=b;break;case pt.LeftRight:s=E;break;case pt.Center:s=x;break}return r.createElement("div",{},[a,s])}});class Q1 extends ie{constructor(e,r,n){super(e,r),this.options=e,this.scene=r,this.changeCallback=n,this.setRootRef=i=>{this.div=i},this.sizeStyle={height:"100%",width:"100%"}}isRoot(){return!0}onChange(e){this.revId++,this.options={...e},this.changeCallback()}getSaveModel(){const{placement:e,constraint:r,...n}=this.options;return{...n,elements:this.elements.map(i=>i.getSaveModel())}}render(){return y.createElement("div",{onContextMenu:e=>e.preventDefault(),key:this.UID,ref:this.setRootRef,style:{...this.sizeStyle,...this.dataStyle}},this.elements.map(e=>e.render()))}}class q1{constructor(e,r,n,i,a,s,o){this.onSave=s,this.styles=J1(ve.$W.theme2),this.selection=new tl.m(1),this.moved=new Zu.B,this.byName=new Map,this.revId=0,this.width=0,this.height=0,this.scale=1,this.style={},this.skipNextSelectionBroadcast=!1,this.ignoreDataUpdate=!1,this.contextMenuOnVisibilityChange=l=>{this.contextMenuVisible=l;const c=cp(this);c&&(l?c.setup.disabled=!0:c.setup.disabled=!1)},this.isPanelEditing=el.Ny.getSearchObject().editPanel!==void 0,this.editModeEnabled=new Qu.t(!1),this.targetsToSelect=new Set,this.getNextElementName=(l=!1)=>{const c=l?"Frame":"Element";let u=this.byName.size+1;const d=u+100;for(;u<d;){const f=`${c} ${u++}`;if(!this.byName.has(f))return f}return`${c} ${Date.now()}`},this.canRename=l=>!this.byName.has(l),this.context={getColor:l=>(0,Kn.Wb)(this.data,l),getScale:l=>(0,Kn.XV)(this.data,l),getScalar:l=>(0,Kn.b5)(this.data,l),getText:l=>(0,Kn.wv)(this.data,l),getResource:l=>(0,Kn.B_)(this.data,l),getPanelData:()=>this.data},this.generateFrameContainer=l=>{let c=1/0,u=1/0,d=0,f=0;return l.forEach(p=>{const v=p.div?.getBoundingClientRect();v&&(c>v.top&&(c=v.top),u>v.left&&(u=v.left),d<v.right&&(d=v.right),f<v.bottom&&(f=v.bottom))}),{top:c,left:u,width:d-u,height:f-c}},this.save=(l=!1)=>{this.onSave(this.root.getSaveModel()),l&&setTimeout(()=>{this.div&&this.initMoveable(!0,this.isEditingEnabled)})},this.findElementByTarget=l=>{const c=[...this.root.elements];for(;c.length>0;){const u=c.shift();if(u&&u.div&&u.div===l)return u;const d=u instanceof ie?u.elements:[];for(const f of d)c.unshift(f)}},this.setNonTargetPointerEvents=(l,c)=>{const u=[...this.root.elements];for(;u.length>0;){const d=u.shift();d&&d.div&&d.div!==l&&d.applyLayoutStylesToDiv(c);const f=d instanceof ie?d.elements:[];for(const p of f)u.unshift(p)}},this.setRef=l=>{this.div=l},this.select=l=>{this.selecto&&(this.selecto.setSelectedTargets(l.targets),this.updateSelection(l),this.editModeEnabled.next(!1),this.connections.connectionAnchorDiv&&(this.connections.connectionAnchorDiv.style.display="none"))},this.updateSelection=l=>{if(this.moveable.target=l.targets,this.skipNextSelectionBroadcast){this.skipNextSelectionBroadcast=!1;return}if(l.frame)this.selection.next([l.frame]);else{const c=l.targets.map(u=>this.findElementByTarget(u));this.selection.next(c)}},this.generateTargetElements=l=>{let c=[];const u=[...l];for(;u.length>0;){const d=u.shift();d&&d.div&&c.push(d.div);const f=d instanceof ie?d.elements:[];for(const p of f)u.unshift(p)}return c},this.initMoveable=(l=!1,c=!0)=>{const u=this.generateTargetElements(this.root.elements);l&&this.selecto&&this.selecto.destroy(),this.selecto=new fm({container:this.div,rootContainer:up(this),selectableTargets:u,toggleContinueSelect:"shift",selectFromInside:!1,hitRate:0});const d={top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},f={top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0};this.moveable=new V0(this.div,{draggable:c&&!this.editModeEnabled.getValue(),resizable:c,snappable:c,snapDirections:d,elementSnapDirections:f,elementGuidelines:u,ables:[U1,Z1(this),j1(this)],props:{dimensionViewable:c,constraintViewable:c,settingsViewable:c},origin:!1,className:this.styles.selected}).on("click",v=>{const h=this.findElementByTarget(v.target);let g=!1;h&&(g=h.item.hasEditMode??!1),v.isDouble&&c&&!this.editModeEnabled.getValue()&&g&&this.editModeEnabled.next(!0)}).on("clickGroup",v=>{this.selecto.clickTarget(v.inputEvent,v.inputTarget)}).on("dragStart",v=>{if(this.ignoreDataUpdate=!0,this.setNonTargetPointerEvents(v.target,!0),this.moveable&&this.moveable.elementGuidelines){const h=this.moveable.elementGuidelines.indexOf(v.target);h>-1&&this.moveable.elementGuidelines.splice(h,1)}}).on("dragGroupStart",v=>{if(this.ignoreDataUpdate=!0,this.moveable&&this.moveable.elementGuidelines)for(let h of v.events){const g=this.moveable.elementGuidelines.indexOf(h.target);g>-1&&this.moveable.elementGuidelines.splice(g,1)}}).on("drag",v=>{const h=this.findElementByTarget(v.target);h&&(h.applyDrag(v),this.connections.connectionsNeedUpdate(h)&&this.moveableActionCallback&&this.moveableActionCallback(!0))}).on("dragGroup",v=>{let h=!1;for(let g of v.events){const m=this.findElementByTarget(g.target);m&&(m.applyDrag(g),h||(h=this.connections.connectionsNeedUpdate(m)))}h&&this.moveableActionCallback&&this.moveableActionCallback(!0)}).on("dragGroupEnd",v=>{v.events.forEach(h=>{const g=this.findElementByTarget(h.target);g&&(g&&g.setPlacementFromConstraint(void 0,void 0,this.scale),this.moveable&&this.moveable.elementGuidelines&&this.moveable.elementGuidelines.push(h.target))}),this.moved.next(Date.now()),this.ignoreDataUpdate=!1}).on("dragEnd",v=>{const h=this.findElementByTarget(v.target);h&&h.setPlacementFromConstraint(void 0,void 0,this.scale),this.moved.next(Date.now()),this.ignoreDataUpdate=!1,this.setNonTargetPointerEvents(v.target,!1),this.moveable&&this.moveable.elementGuidelines&&this.moveable.elementGuidelines.push(v.target)}).on("resizeStart",v=>{const h=this.findElementByTarget(v.target);if(h){if(this.moveable&&this.moveable.elementGuidelines){const g=this.moveable.elementGuidelines.indexOf(v.target);g>-1&&this.moveable.elementGuidelines.splice(g,1)}h.tempConstraint={...h.options.constraint},h.options.constraint={vertical:ht.Top,horizontal:pt.Left},h.setPlacementFromConstraint(void 0,void 0,this.scale)}}).on("resizeGroupStart",v=>{if(this.moveable&&this.moveable.elementGuidelines)for(let h of v.events){const g=this.moveable.elementGuidelines.indexOf(h.target);g>-1&&this.moveable.elementGuidelines.splice(g,1)}}).on("resize",v=>{const h=this.findElementByTarget(v.target);h&&(h.applyResize(v,this.scale),this.connections.connectionsNeedUpdate(h)&&this.moveableActionCallback&&this.moveableActionCallback(!0)),this.moved.next(Date.now())}).on("resizeGroup",v=>{let h=!1;for(let g of v.events){const m=this.findElementByTarget(g.target);m&&(m.applyResize(g),h||(h=this.connections.connectionsNeedUpdate(m)))}h&&this.moveableActionCallback&&this.moveableActionCallback(!0),this.moved.next(Date.now())}).on("resizeEnd",v=>{const h=this.findElementByTarget(v.target);h&&(h.tempConstraint&&(h.options.constraint=h.tempConstraint,h.tempConstraint=void 0),h.setPlacementFromConstraint(void 0,void 0,this.scale),this.moveable&&this.moveable.elementGuidelines&&this.moveable.elementGuidelines.push(v.target))}).on("resizeGroupEnd",v=>{if(this.moveable&&this.moveable.elementGuidelines)for(let h of v.events)this.moveable.elementGuidelines.push(h.target)});let p=[];this.selecto.on("dragStart",v=>{const h=v.inputEvent.target;if(h.id===gd){this.connections.handleConnectionDragStart(h,v.inputEvent.clientX,v.inputEvent.clientY),v.stop();return}const g=this.moveable.isMoveableElement(h)||p.some(b=>b===h||b.contains(h)),m=this.selecto?.getSelectedTargets().includes(h.parentElement.parentElement);this.isEditingEnabled&&!this.editModeEnabled.getValue()&&g&&this.selecto?.getSelectedTargets().length&&(this.selecto.getSelectedTargets()[0].style.cursor="grabbing"),(g||m||!this.isEditingEnabled)&&v.stop()}).on("select",()=>{this.editModeEnabled.next(!1),this.connections.connectionAnchorDiv&&(this.connections.connectionAnchorDiv.style.display="none")}).on("selectEnd",v=>{p=v.selected,this.updateSelection({targets:p}),v.isDragStart&&(this.isEditingEnabled&&!this.editModeEnabled.getValue()&&this.selecto?.getSelectedTargets().length&&(this.selecto.getSelectedTargets()[0].style.cursor="grabbing"),v.inputEvent.preventDefault(),v.data.timer=setTimeout(()=>{this.moveable.dragStart(v.inputEvent)}))}).on("dragEnd",v=>{clearTimeout(v.data.timer)})},this.reorderElements=(l,c,u,d)=>{switch(u){case!0:switch(d){case-1:l.parent instanceof ie?c.parent&&(this.updateElements(l,c.parent,c.parent.elements.length),l.updateData(c.parent.scene.context)):c.parent?.reorderTree(l,c,!0);break;default:c.parent&&(this.updateElements(l,c.parent,c.parent.elements.indexOf(c)),l.updateData(c.parent.scene.context));break}break;case!1:c instanceof ie?l.parent===c?l.parent?.reorderTree(l,c,!0):(this.updateElements(l,c),l.updateData(c.scene.context)):l.parent===c.parent?l.parent?.reorderTree(l,c):c.parent&&(this.updateElements(l,c.parent),l.updateData(c.parent.scene.context));break}},this.updateElements=(l,c,u=null)=>{l.parent?.doAction(Qt.Delete,l),l.parent=c;const d=l.div?.getBoundingClientRect();l.setPlacementFromConstraint(d,c.div?.getBoundingClientRect());const f=u??c.elements.length-1;c.elements.splice(f,0,l),c.scene.save(),c.reinitializeMoveable()},this.addToSelection=()=>{try{let l={targets:[]};l.targets=[...this.targetsToSelect],this.select(l)}catch{Ws.A.emit(sn.r1.alertError,["Unable to add to selection"])}},this.root=this.load(e,r,n,i,a),this.subscription=this.editModeEnabled.subscribe(l=>{!this.moveable||!this.isEditingEnabled||(this.moveable.draggable=!l)}),this.panel=o,this.connections=new Mm(this),this.transformComponentRef=(0,y.createRef)()}load(e,r,n,i,a){return this.root=new Q1(e??{type:"frame",elements:[ma]},this,this.save),this.isEditingEnabled=r,this.shouldShowAdvancedTypes=n,this.shouldPanZoom=i,this.shouldInfinitePan=a,setTimeout(()=>{if(this.div){const s=r;this.initMoveable(s,r),this.currentLayer=this.root,this.selection.next([]),this.connections.select(void 0),this.connections.updateState()}}),this.root}updateData(e){this.data=e,this.root.updateData(this.context)}updateSize(e,r){this.width=e,this.height=r,this.style={width:e,height:r},this.selecto?.getSelectedTargets().length&&this.clearCurrentSelection()}frameSelection(){this.selection.pipe((0,qu.$)()).subscribe(e=>{const r=e[0].parent,n=new ie({type:"frame",name:this.getNextElementName(!0),elements:[]},this,e[0].parent),i=this.generateFrameContainer(e);n.options.placement=i,e.forEach(a=>{const s=a.div?.getBoundingClientRect();a.setPlacementFromConstraint(s,i),r.doAction(Qt.Delete,a),n.doAction(Qt.Duplicate,a,!1,!1)}),n.setPlacementFromConstraint(i,r.div?.getBoundingClientRect()),r.elements.push(n),this.byName.set(n.getName(),n),this.save()})}clearCurrentSelection(e=!1){this.skipNextSelectionBroadcast=e;let r=new MouseEvent("click");this.selecto?.clickTarget(r,this.div)}updateCurrentLayer(e){this.currentLayer=e,this.clearCurrentSelection(),this.save()}render(){const e=(this.tooltip?.element?.data?.links?.length??0)>0,r=!this.isEditingEnabled&&e,n=y.createElement("div",{key:this.revId,className:this.styles.wrap,style:this.style,ref:this.setRef},this.connections.render(),this.root.render(),this.isEditingEnabled&&y.createElement(Fn.ZL,null,y.createElement(vm,{scene:this,panel:this.panel,onVisibilityChange:this.contextMenuOnVisibilityChange})),r&&y.createElement(Fn.ZL,null,y.createElement(Em,{scene:this})));return ve.$W.featureToggles.canvasPanelPanZoom?y.createElement($1,{scene:this},n):n}}const J1=(0,Zs.N)(t=>({wrap:(0,rt.css)`
    overflow: hidden;
    position: relative;
  `,selected:(0,rt.css)`
    z-index: 999 !important;
  `}));var Gd=K(28444),ty=K(19448);function ey({onClose:t,scene:e,anchorPoint:r}){const n=e.root.options.background?.image?.fixed??"",[i,a]=(0,y.useState)(n),s=(0,Pt.$j)(),o=ry(s,r),l=c=>{c&&(a(c),e.root&&(e.root.options.background={...e.root.options.background,image:{mode:en.q_.Fixed,fixed:c}},e.revId++,e.save(),e.root.reinitializeMoveable()),e&&e.updateData(e.data)),t()};return y.createElement(Fn.ZL,{className:o.portalWrapper},y.createElement(ty.i,{onChange:l,value:i,mediaType:va.MediaType.Image,folderName:va.ResourceFolderName.IOT}))}const ry=(t,e)=>({portalWrapper:(0,rt.css)({width:"315px",height:"445px",transform:`translate(${e.x}px, ${e.y-200}px)`})});var ny=K(55794),iy=K.n(ny),ay=K(66036),Fd=K(33390),Kd=K(58313),oy=K(57755),vs=K(48192),sy=K(7600),aa=K(54612);const ly=[{value:le.Original,label:"Original"},{value:le.Contain,label:"Contain"},{value:le.Cover,label:"Cover"},{value:le.Fill,label:"Fill"},{value:le.Tile,label:"Tile"}],cy=({value:t,onChange:e})=>{const r=t??le.Cover,n=(0,y.useCallback)(i=>{e(i)},[e]);return y.createElement(Ar.C,null,y.createElement(Mr.I,{grow:!0},y.createElement(Ns.z,{value:r,options:ly,onChange:n,fullWidth:!0})))},Wd=(t,e)=>e!=="frame"&&e!==void 0?[t+` (${e})`]:[t],qr={addBackground:(t,e)=>{const r=Wd("Background",e.options?.type);t.addCustomEditor({category:r,id:"background.color",path:"background.color",name:"Color",editor:Yt.NO,settings:{},defaultValue:{fixed:""}}).addCustomEditor({category:r,id:"background.image",path:"background.image",name:"Image",editor:Yt.mj,settings:{resourceType:"image"}}).addCustomEditor({category:r,id:"background.size",path:"background.size",name:"Image size",editor:cy,settings:{resourceType:"image"}})},addBorder:(t,e)=>{const r=Wd("Border",e.options?.type);t.addSliderInput({category:r,path:"border.width",name:"Width",defaultValue:2,settings:{min:0,max:20}}),e.options?.border?.width&&t.addCustomEditor({category:r,id:"border.color",path:"border.color",name:"Color",editor:Yt.NO,settings:{},defaultValue:{fixed:""}})},addColor:(t,e)=>{const r=["Color"];t.addCustomEditor({category:r,id:"color",path:"color",name:"Color",editor:Yt.NO,settings:{},defaultValue:{fixed:""}})},addSize:(t,e)=>{const r=["Size"];t.addCustomEditor({category:r,id:"size",path:"size",name:"Size",editor:Yt.gm,settings:{min:1,max:10},defaultValue:{fixed:2,min:1,max:10}})}};var oa=K(14578),uy=K(60188);const dy=({onVerticalConstraintChange:t,onHorizontalConstraintChange:e,currentConstraints:r})=>{const n=(0,Pt.of)(fy(r)),i=()=>{t(ht.Top)},a=()=>{t(ht.Bottom)},s=()=>{t(ht.Center)},o=()=>{e(pt.Left)},l=()=>{e(pt.Right)},c=()=>{e(pt.Center)};return y.createElement("svg",{version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"75.000000pt",height:"75.000000pt",viewBox:"0 0 228.000000 228.000000",preserveAspectRatio:"xMidYMid meet",style:{marginBottom:"4.8px"}},y.createElement("g",{transform:"translate(0.000000,228.000000) scale(0.100000,-0.100000)",fill:"#000000",stroke:"none"},y.createElement("path",{fill:"#e5e5e5",d:`M198 2028 l-28 -32 0 -912 0 -912 31 -31 31 -31 915 0 915 0 29 29
29 29 0 917 0 917 -27 29 -28 29 -920 0 -920 0 -27 -32z m1876 -17 c15 -16 16
-98 16 -927 0 -860 -1 -909 -18 -926 -17 -17 -66 -18 -927 -18 -862 0 -910 1
-927 18 -17 17 -18 65 -18 926 0 832 1 911 16 927 16 18 45 19 468 21 248 2
659 2 912 0 431 -2 462 -4 478 -21z`}),y.createElement("rect",{className:n.topConstraint,height:"228",width:"46",y:"1735",x:"1123"}),y.createElement("rect",{className:n.constraintHover,onClick:i,height:"350",width:"300",y:"1680",x:"995",fill:"transparent"}),y.createElement("rect",{className:n.bottomConstraint,height:"228",width:"46",y:"210",x:"1123"}),y.createElement("rect",{className:n.constraintHover,onClick:a,height:"350",width:"300",y:"135",x:"995",fill:"transparent"}),y.createElement("rect",{className:n.leftConstraint,height:"46",width:"228",y:"1060",x:"265"}),y.createElement("rect",{className:n.constraintHover,onClick:o,height:"300",width:"350",y:"925",x:"200",fill:"transparent"}),y.createElement("rect",{className:n.rightConstraint,height:"46",width:"228",y:"1060",x:"1795"}),y.createElement("rect",{className:n.constraintHover,onClick:l,height:"300",width:"350",y:"925",x:"1730",fill:"transparent"}),y.createElement("path",{className:n.box,d:`M568 1669 c-17 -9 -18 -48 -18 -584 0 -558 1 -575 19 -585 27 -14
1125 -14 1152 0 18 10 19 27 19 580 0 504 -2 570 -16 584 -14 14 -80 16 -577
16 -363 -1 -568 -4 -579 -11z m1119 -42 c4 -5 4 -1079 0 -1084 -5 -4 -1079 -4
-1084 0 -5 6 -4 1077 1 1085 4 7 1076 6 1083 -1z`}),y.createElement("rect",{className:n.verticalCenterConstraint,height:"456",width:"46",y:"855",x:"1123"}),y.createElement("rect",{className:n.constraintHover,onClick:s,height:"660",width:"300",y:"750",x:"995",fill:"transparent"}),y.createElement("rect",{className:n.horizontalCenterConstraint,height:"46",width:"456",y:"1060",x:"918"}),y.createElement("rect",{className:n.constraintHover,onClick:c,height:"300",width:"660",y:"925",x:"815",fill:"transparent"})))},fy=t=>e=>{const r="#daebf7",n="0.6",i="#0d99ff",a=e.isDark?"#ffffff":"#000000";return{constraintHover:(0,rt.css)({"&:hover":{fill:r,fillOpacity:n}}),topConstraint:(0,rt.css)({...t.vertical===ht.Top||t.vertical===ht.TopBottom?{width:"92pt",x:"1085",fill:i}:{fill:a}}),bottomConstraint:(0,rt.css)({...t.vertical===ht.Bottom||t.vertical===ht.TopBottom?{width:"92pt",x:"1085",fill:i}:{fill:a}}),leftConstraint:(0,rt.css)({...t.horizontal===pt.Left||t.horizontal===pt.LeftRight?{height:"92pt",y:"1014",fill:i}:{fill:a}}),rightConstraint:(0,rt.css)({...t.horizontal===pt.Right||t.horizontal===pt.LeftRight?{height:"92pt",y:"1014",fill:i}:{fill:a}}),horizontalCenterConstraint:(0,rt.css)({...t.horizontal===pt.Center?{height:"92pt",y:"1014",fill:i}:{fill:a}}),verticalCenterConstraint:(0,rt.css)({...t.vertical===ht.Center?{width:"92pt",x:"1085",fill:i}:{fill:a}}),box:(0,rt.css)({fill:a})}},py=({onPositionChange:t,element:e,settings:r})=>{const n=(0,Pt.of)(vy),i=o=>{const l={vertical:ht.Top,horizontal:pt.Left},c={...e.options.constraint};switch(e.options.constraint=l,e.setPlacementFromConstraint(),o){case ue.Top:t(0,"top");break;case ue.Bottom:t(s(e.options.placement?.height??0,"bottom"),"top");break;case ue.VerticalCenter:t(a(e.options.placement?.height??0,"v"),"top");break;case ue.Left:t(0,"left");break;case ue.Right:t(s(e.options.placement?.width??0,"right"),"left");break;case ue.HorizontalCenter:t(a(e.options.placement?.width??0,"h"),"left");break}e.options.constraint=c,e.setPlacementFromConstraint()},a=(o,l)=>((l==="h"?r.scene.width:r.scene.height)-o)/2,s=(o,l)=>(l==="right"?r.scene.width:r.scene.height)-o;return y.createElement("div",{className:n.buttonGroup},y.createElement(we.K,{name:"horizontal-align-left",onClick:()=>i(ue.Left),className:n.button,size:"lg",tooltip:"Align left"}),y.createElement(we.K,{name:"horizontal-align-center",onClick:()=>i(ue.HorizontalCenter),className:n.button,size:"lg",tooltip:"Align horizontal centers"}),y.createElement(we.K,{name:"horizontal-align-right",onClick:()=>i(ue.Right),className:n.button,size:"lg",tooltip:"Align right"}),y.createElement(we.K,{name:"vertical-align-top",onClick:()=>i(ue.Top),size:"lg",tooltip:"Align top"}),y.createElement(we.K,{name:"vertical-align-center",onClick:()=>i(ue.VerticalCenter),className:n.button,size:"lg",tooltip:"Align vertical centers"}),y.createElement(we.K,{name:"vertical-align-bottom",onClick:()=>i(ue.Bottom),className:n.button,size:"lg",tooltip:"Align bottom"}))},vy=t=>({buttonGroup:(0,rt.css)({display:"flex",flexWrap:"wrap",padding:"12px 0 12px 0"}),button:(0,rt.css)({marginLeft:"5px",marginRight:"5px"})}),hy=["top","left","bottom","right","width","height"],gy=[{label:"Left",value:pt.Left},{label:"Right",value:pt.Right},{label:"Left & right",value:pt.LeftRight},{label:"Center",value:pt.Center},{label:"Scale",value:pt.Scale}],my=[{label:"Top",value:ht.Top},{label:"Bottom",value:ht.Bottom},{label:"Top & bottom",value:ht.TopBottom},{label:"Center",value:ht.Center},{label:"Scale",value:ht.Scale}];function Yd({item:t}){const e=t.settings;if((0,Zn.A)(e?.scene?e.scene.moved:new Zu.B),!e)return y.createElement("div",null,"Loading...");const r=e.element;if(!r)return y.createElement("div",null,"???");const{options:n}=r,{placement:i,constraint:a}=n,s=()=>{setTimeout(()=>{e.scene.select({targets:[r.div]})})},o=p=>{l(p.value)},l=p=>{r.options.constraint.horizontal=p,r.setPlacementFromConstraint(),e.scene.revId++,e.scene.save(!0),s()},c=p=>{u(p.value)},u=p=>{r.options.constraint.vertical=p,r.setPlacementFromConstraint(),e.scene.revId++,e.scene.save(!0),s()},d=(p,v)=>{r.options.placement[v]=p??r.options.placement[v],r.applyLayoutStylesToDiv(),e.scene.clearCurrentSelection(!0),s()},f=r.tempConstraint??a??{};return y.createElement("div",null,y.createElement(py,{onPositionChange:d,settings:e,element:r}),y.createElement("br",null),y.createElement(an.D,{label:"Constraints"},y.createElement(De.Gy,null,y.createElement(dy,{onVerticalConstraintChange:u,onHorizontalConstraintChange:l,currentConstraints:f}),y.createElement(De.gW,null,y.createElement(De.Gy,null,y.createElement(oa.I,{name:"arrows-h"}),y.createElement(jn.l6,{options:gy,onChange:o,value:f.horizontal})),y.createElement(De.Gy,null,y.createElement(oa.I,{name:"arrows-v"}),y.createElement(jn.l6,{options:my,onChange:c,value:f.vertical}))))),y.createElement("br",null),y.createElement(an.D,{label:"Position"},y.createElement(y.Fragment,null,hy.map(p=>{const v=i[p];return v==null?null:y.createElement(Ar.C,{key:p},y.createElement(Mr.I,{label:p,labelWidth:8,grow:!0},y.createElement(uy.Q,{value:v,onChange:h=>d(h,p)})))}))))}function Xd(t){return{category:t.category,path:"--",values:e=>({getValue:r=>(0,Oe.get)(t.element.options,r),onChange:(r,n)=>{let i=t.element.options;if(r==="type"&&n){const a=fn.getIfExists(n);if(!a){console.warn("layer does not exist",n);return}i={...i,...a.getNewOptions(i),type:a.id}}else i=(0,aa.Sf)(i,r,n);t.element.onChange(i),t.element.updateData(t.scene.context)}}),build:(e,r)=>{const{options:n}=t.element,i=n?.type?n.type:ma.type,a=qn(t.scene.shouldShowAdvancedTypes,i).options,s=!t.scene.shouldShowAdvancedTypes&&!ti.filter(p=>p.id===n?.type).length;e.addSelect({path:"type",name:void 0,settings:{options:a},description:s?"Selected element type is not supported by current settings. Please enable advanced element types.":""});const o=fn.getIfExists(n?.type??ma.type);let l=n;l||(l={...o.getNewOptions(n),type:o.id,name:`Element ${Date.now()}.${Math.floor(Math.random()*100)}`});const c={...r,options:l};o?.registerOptionsUI&&o.registerOptionsUI(e,c),(t.element.item.standardEditorConfig?.layout??!0)&&e.addCustomEditor({category:["Layout"],id:"content",path:"__",name:"Quick placement",editor:Yd,settings:t}),(t.element.item.standardEditorConfig?.background??!0)&&qr.addBackground(e,c),(t.element.item.standardEditorConfig?.border??!0)&&qr.addBorder(e,c)}}}var Hd=K(94659),rr=K(58168),Vd=K(82284),xe=K(89379),hs=K(60436),$d=K(23029),jd=K(92901),Q=K(9417),Ud=K(85501),Zd=K(88293),H=K(64467),yy=K(46942),Be=K.n(yy),Jr=K(16928),Qd=K(72065),Xn=K(68210),gs=y.createContext(null);function by(t){var e=t.dropPosition,r=t.dropLevelOffset,n=t.indent,i={pointerEvents:"none",position:"absolute",right:0,backgroundColor:"red",height:2};switch(e){case-1:i.top=0,i.left=-r*n;break;case 1:i.bottom=0,i.left=-r*n;break;case 0:i.bottom=0,i.left=n;break}return y.createElement("div",{style:i})}function qd(t){if(t==null)throw new TypeError("Cannot destructure "+t)}var Sr=K(5544),ms=K(80045),sa=K(30981),Ey=K(79889),Cy=K(80979),Sy=function(e){for(var r=e.prefixCls,n=e.level,i=e.isStart,a=e.isEnd,s="".concat(r,"-indent-unit"),o=[],l=0;l<n;l+=1)o.push(y.createElement("span",{key:l,className:Be()(s,(0,H.A)((0,H.A)({},"".concat(s,"-start"),i[l]),"".concat(s,"-end"),a[l]))}));return y.createElement("span",{"aria-hidden":"true",className:"".concat(r,"-indent")},o)};const xy=y.memo(Sy);var Pe=K(84963),mt=K(7974),Dy=["eventKey","className","style","dragOver","dragOverGapTop","dragOverGapBottom","isLeaf","isStart","isEnd","expanded","selected","checked","halfChecked","loading","domRef","active","data","onMouseMove","selectable"],Jd="open",tf="close",wy="---",Ty=function(t){(0,Ud.A)(r,t);var e=(0,Zd.A)(r);function r(){var n;(0,$d.A)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=e.call.apply(e,[this].concat(a)),(0,H.A)((0,Q.A)(n),"state",{dragNodeHighlight:!1}),(0,H.A)((0,Q.A)(n),"selectHandle",void 0),(0,H.A)((0,Q.A)(n),"cacheIndent",void 0),(0,H.A)((0,Q.A)(n),"onSelectorClick",function(o){var l=n.props.context.onNodeClick;l(o,(0,mt.Hj)(n.props)),n.isSelectable()?n.onSelect(o):n.onCheck(o)}),(0,H.A)((0,Q.A)(n),"onSelectorDoubleClick",function(o){var l=n.props.context.onNodeDoubleClick;l(o,(0,mt.Hj)(n.props))}),(0,H.A)((0,Q.A)(n),"onSelect",function(o){if(!n.isDisabled()){var l=n.props.context.onNodeSelect;l(o,(0,mt.Hj)(n.props))}}),(0,H.A)((0,Q.A)(n),"onCheck",function(o){if(!n.isDisabled()){var l=n.props,c=l.disableCheckbox,u=l.checked,d=n.props.context.onNodeCheck;if(!(!n.isCheckable()||c)){var f=!u;d(o,(0,mt.Hj)(n.props),f)}}}),(0,H.A)((0,Q.A)(n),"onMouseEnter",function(o){var l=n.props.context.onNodeMouseEnter;l(o,(0,mt.Hj)(n.props))}),(0,H.A)((0,Q.A)(n),"onMouseLeave",function(o){var l=n.props.context.onNodeMouseLeave;l(o,(0,mt.Hj)(n.props))}),(0,H.A)((0,Q.A)(n),"onContextMenu",function(o){var l=n.props.context.onNodeContextMenu;l(o,(0,mt.Hj)(n.props))}),(0,H.A)((0,Q.A)(n),"onDragStart",function(o){var l=n.props.context.onNodeDragStart;o.stopPropagation(),n.setState({dragNodeHighlight:!0}),l(o,(0,Q.A)(n));try{o.dataTransfer.setData("text/plain","")}catch{}}),(0,H.A)((0,Q.A)(n),"onDragEnter",function(o){var l=n.props.context.onNodeDragEnter;o.preventDefault(),o.stopPropagation(),l(o,(0,Q.A)(n))}),(0,H.A)((0,Q.A)(n),"onDragOver",function(o){var l=n.props.context.onNodeDragOver;o.preventDefault(),o.stopPropagation(),l(o,(0,Q.A)(n))}),(0,H.A)((0,Q.A)(n),"onDragLeave",function(o){var l=n.props.context.onNodeDragLeave;o.stopPropagation(),l(o,(0,Q.A)(n))}),(0,H.A)((0,Q.A)(n),"onDragEnd",function(o){var l=n.props.context.onNodeDragEnd;o.stopPropagation(),n.setState({dragNodeHighlight:!1}),l(o,(0,Q.A)(n))}),(0,H.A)((0,Q.A)(n),"onDrop",function(o){var l=n.props.context.onNodeDrop;o.preventDefault(),o.stopPropagation(),n.setState({dragNodeHighlight:!1}),l(o,(0,Q.A)(n))}),(0,H.A)((0,Q.A)(n),"onExpand",function(o){var l=n.props,c=l.loading,u=l.context.onNodeExpand;c||u(o,(0,mt.Hj)(n.props))}),(0,H.A)((0,Q.A)(n),"setSelectHandle",function(o){n.selectHandle=o}),(0,H.A)((0,Q.A)(n),"getNodeState",function(){var o=n.props.expanded;return n.isLeaf()?null:o?Jd:tf}),(0,H.A)((0,Q.A)(n),"hasChildren",function(){var o=n.props.eventKey,l=n.props.context.keyEntities,c=(0,Pe.A)(l,o)||{},u=c.children;return!!(u||[]).length}),(0,H.A)((0,Q.A)(n),"isLeaf",function(){var o=n.props,l=o.isLeaf,c=o.loaded,u=n.props.context.loadData,d=n.hasChildren();return l===!1?!1:l||!u&&!d||u&&c&&!d}),(0,H.A)((0,Q.A)(n),"isDisabled",function(){var o=n.props.disabled,l=n.props.context.disabled;return!!(l||o)}),(0,H.A)((0,Q.A)(n),"isCheckable",function(){var o=n.props.checkable,l=n.props.context.checkable;return!l||o===!1?!1:l}),(0,H.A)((0,Q.A)(n),"syncLoadData",function(o){var l=o.expanded,c=o.loading,u=o.loaded,d=n.props.context,f=d.loadData,p=d.onNodeLoad;c||f&&l&&!n.isLeaf()&&!n.hasChildren()&&!u&&p((0,mt.Hj)(n.props))}),(0,H.A)((0,Q.A)(n),"isDraggable",function(){var o=n.props,l=o.data,c=o.context.draggable;return!!(c&&(!c.nodeDraggable||c.nodeDraggable(l)))}),(0,H.A)((0,Q.A)(n),"renderDragHandler",function(){var o=n.props.context,l=o.draggable,c=o.prefixCls;return l!=null&&l.icon?y.createElement("span",{className:"".concat(c,"-draggable-icon")},l.icon):null}),(0,H.A)((0,Q.A)(n),"renderSwitcherIconDom",function(o){var l=n.props.switcherIcon,c=n.props.context.switcherIcon,u=l||c;return typeof u=="function"?u((0,xe.A)((0,xe.A)({},n.props),{},{isLeaf:o})):u}),(0,H.A)((0,Q.A)(n),"renderSwitcher",function(){var o=n.props.expanded,l=n.props.context.prefixCls;if(n.isLeaf()){var c=n.renderSwitcherIconDom(!0);return c!==!1?y.createElement("span",{className:Be()("".concat(l,"-switcher"),"".concat(l,"-switcher-noop"))},c):null}var u=Be()("".concat(l,"-switcher"),"".concat(l,"-switcher_").concat(o?Jd:tf)),d=n.renderSwitcherIconDom(!1);return d!==!1?y.createElement("span",{onClick:n.onExpand,className:u},d):null}),(0,H.A)((0,Q.A)(n),"renderCheckbox",function(){var o=n.props,l=o.checked,c=o.halfChecked,u=o.disableCheckbox,d=n.props.context.prefixCls,f=n.isDisabled(),p=n.isCheckable();if(!p)return null;var v=typeof p!="boolean"?p:null;return y.createElement("span",{className:Be()("".concat(d,"-checkbox"),l&&"".concat(d,"-checkbox-checked"),!l&&c&&"".concat(d,"-checkbox-indeterminate"),(f||u)&&"".concat(d,"-checkbox-disabled")),onClick:n.onCheck},v)}),(0,H.A)((0,Q.A)(n),"renderIcon",function(){var o=n.props.loading,l=n.props.context.prefixCls;return y.createElement("span",{className:Be()("".concat(l,"-iconEle"),"".concat(l,"-icon__").concat(n.getNodeState()||"docu"),o&&"".concat(l,"-icon_loading"))})}),(0,H.A)((0,Q.A)(n),"renderSelector",function(){var o=n.state.dragNodeHighlight,l=n.props,c=l.title,u=c===void 0?wy:c,d=l.selected,f=l.icon,p=l.loading,v=l.data,h=n.props.context,g=h.prefixCls,m=h.showIcon,b=h.icon,E=h.loadData,C=h.titleRender,x=n.isDisabled(),S="".concat(g,"-node-content-wrapper"),w;if(m){var D=f||b;w=D?y.createElement("span",{className:Be()("".concat(g,"-iconEle"),"".concat(g,"-icon__customize"))},typeof D=="function"?D(n.props):D):n.renderIcon()}else E&&p&&(w=n.renderIcon());var T;typeof u=="function"?T=u(v):C?T=C(v):T=u;var A=y.createElement("span",{className:"".concat(g,"-title")},T);return y.createElement("span",{ref:n.setSelectHandle,title:typeof u=="string"?u:"",className:Be()("".concat(S),"".concat(S,"-").concat(n.getNodeState()||"normal"),!x&&(d||o)&&"".concat(g,"-node-selected")),onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,onContextMenu:n.onContextMenu,onClick:n.onSelectorClick,onDoubleClick:n.onSelectorDoubleClick},w,A,n.renderDropIndicator())}),(0,H.A)((0,Q.A)(n),"renderDropIndicator",function(){var o=n.props,l=o.disabled,c=o.eventKey,u=n.props.context,d=u.draggable,f=u.dropLevelOffset,p=u.dropPosition,v=u.prefixCls,h=u.indent,g=u.dropIndicatorRender,m=u.dragOverNodeKey,b=u.direction,E=!!d,C=!l&&E&&m===c,x=h??n.cacheIndent;return n.cacheIndent=h,C?g({dropPosition:p,dropLevelOffset:f,indent:x,prefixCls:v,direction:b}):null}),n}return(0,jd.A)(r,[{key:"componentDidMount",value:function(){this.syncLoadData(this.props)}},{key:"componentDidUpdate",value:function(){this.syncLoadData(this.props)}},{key:"isSelectable",value:function(){var i=this.props.selectable,a=this.props.context.selectable;return typeof i=="boolean"?i:a}},{key:"render",value:function(){var i,a=this.props,s=a.eventKey,o=a.className,l=a.style,c=a.dragOver,u=a.dragOverGapTop,d=a.dragOverGapBottom,f=a.isLeaf,p=a.isStart,v=a.isEnd,h=a.expanded,g=a.selected,m=a.checked,b=a.halfChecked,E=a.loading,C=a.domRef,x=a.active,S=a.data,w=a.onMouseMove,D=a.selectable,T=(0,ms.A)(a,Dy),A=this.props.context,M=A.prefixCls,P=A.filterTreeNode,k=A.keyEntities,_=A.dropContainerKey,N=A.dropTargetKey,I=A.draggingNodeKey,B=this.isDisabled(),L=(0,Qd.A)(T,{aria:!0,data:!0}),G=(0,Pe.A)(k,s)||{},W=G.level,z=v[v.length-1],X=this.isDraggable(),j=!B&&X,Y=I===s,Z=D!==void 0?{"aria-selected":!!D}:void 0;return y.createElement("div",(0,rr.A)({ref:C,className:Be()(o,"".concat(M,"-treenode"),(i={},(0,H.A)((0,H.A)((0,H.A)((0,H.A)((0,H.A)((0,H.A)((0,H.A)((0,H.A)((0,H.A)((0,H.A)(i,"".concat(M,"-treenode-disabled"),B),"".concat(M,"-treenode-switcher-").concat(h?"open":"close"),!f),"".concat(M,"-treenode-checkbox-checked"),m),"".concat(M,"-treenode-checkbox-indeterminate"),b),"".concat(M,"-treenode-selected"),g),"".concat(M,"-treenode-loading"),E),"".concat(M,"-treenode-active"),x),"".concat(M,"-treenode-leaf-last"),z),"".concat(M,"-treenode-draggable"),X),"dragging",Y),(0,H.A)((0,H.A)((0,H.A)((0,H.A)((0,H.A)((0,H.A)(i,"drop-target",N===s),"drop-container",_===s),"drag-over",!B&&c),"drag-over-gap-top",!B&&u),"drag-over-gap-bottom",!B&&d),"filter-node",P&&P((0,mt.Hj)(this.props))))),style:l,draggable:j,"aria-grabbed":Y,onDragStart:j?this.onDragStart:void 0,onDragEnter:X?this.onDragEnter:void 0,onDragOver:X?this.onDragOver:void 0,onDragLeave:X?this.onDragLeave:void 0,onDrop:X?this.onDrop:void 0,onDragEnd:X?this.onDragEnd:void 0,onMouseMove:w},Z,L),y.createElement(xy,{prefixCls:M,level:W,isStart:p,isEnd:v}),this.renderDragHandler(),this.renderSwitcher(),this.renderCheckbox(),this.renderSelector())}}]),r}(y.Component),ys=function(e){return y.createElement(gs.Consumer,null,function(r){return y.createElement(Ty,(0,rr.A)({},e,{context:r}))})};ys.displayName="TreeNode",ys.isTreeNode=1;const bs=ys;function Ay(t,e){var r=y.useState(!1),n=(0,Sr.A)(r,2),i=n[0],a=n[1];(0,sa.A)(function(){if(i)return t(),function(){e()}},[i]),(0,sa.A)(function(){return a(!0),function(){a(!1)}},[])}var My=["className","style","motion","motionNodes","motionType","onMotionStart","onMotionEnd","active","treeNodeRequiredProps"],ef=function(e,r){var n=e.className,i=e.style,a=e.motion,s=e.motionNodes,o=e.motionType,l=e.onMotionStart,c=e.onMotionEnd,u=e.active,d=e.treeNodeRequiredProps,f=(0,ms.A)(e,My),p=y.useState(!0),v=(0,Sr.A)(p,2),h=v[0],g=v[1],m=y.useContext(gs),b=m.prefixCls,E=s&&o!=="hide";(0,sa.A)(function(){s&&E!==h&&g(E)},[s]);var C=function(){s&&l()},x=y.useRef(!1),S=function(){s&&!x.current&&(x.current=!0,c())};Ay(C,S);var w=function(T){E===T&&S()};return s?y.createElement(Cy.A,(0,rr.A)({ref:r,visible:h},a,{motionAppear:o==="show",onVisibleChanged:w}),function(D,T){var A=D.className,M=D.style;return y.createElement("div",{ref:T,className:Be()("".concat(b,"-treenode-motion"),A),style:M},s.map(function(P){var k=Object.assign({},(qd(P.data),P.data)),_=P.title,N=P.key,I=P.isStart,B=P.isEnd;delete k.children;var L=(0,mt.N5)(N,d);return y.createElement(bs,(0,rr.A)({},k,L,{title:_,active:u,data:P.data,key:N,isStart:I,isEnd:B}))}))}):y.createElement(bs,(0,rr.A)({domRef:r,className:n,style:i},f,{active:u}))};ef.displayName="MotionTreeNode";var ky=y.forwardRef(ef);const Py=ky;function Oy(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=t.length,n=e.length;if(Math.abs(r-n)!==1)return{add:!1,key:null};function i(a,s){var o=new Map;a.forEach(function(c){o.set(c,!0)});var l=s.filter(function(c){return!o.has(c)});return l.length===1?l[0]:null}return r<n?{add:!0,key:i(t,e)}:{add:!1,key:i(e,t)}}function rf(t,e,r){var n=t.findIndex(function(o){return o.key===r}),i=t[n+1],a=e.findIndex(function(o){return o.key===r});if(i){var s=e.findIndex(function(o){return o.key===i.key});return e.slice(a+1,s)}return e.slice(a+1)}var Ry=["prefixCls","data","selectable","checkable","expandedKeys","selectedKeys","checkedKeys","loadedKeys","loadingKeys","halfCheckedKeys","keyEntities","disabled","dragging","dragOverNodeKey","dropPosition","motion","height","itemHeight","virtual","focusable","activeItem","focused","tabIndex","onKeyDown","onFocus","onBlur","onActiveChange","onListChangeStart","onListChangeEnd"],nf={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},_y=function(){},xr="RC_TREE_MOTION_".concat(Math.random()),Es={key:xr},af={key:xr,level:0,index:0,pos:"0",node:Es,nodes:[Es]},of={parent:null,children:[],pos:af.pos,data:Es,title:null,key:xr,isStart:[],isEnd:[]};function sf(t,e,r,n){return e===!1||!r?t:t.slice(0,Math.ceil(r/n)+1)}function lf(t){var e=t.key,r=t.pos;return(0,mt.i7)(e,r)}function Ny(t){for(var e=String(t.data.key),r=t;r.parent;)r=r.parent,e="".concat(r.data.key," > ").concat(e);return e}var cf=y.forwardRef(function(t,e){var r=t.prefixCls,n=t.data,i=t.selectable,a=t.checkable,s=t.expandedKeys,o=t.selectedKeys,l=t.checkedKeys,c=t.loadedKeys,u=t.loadingKeys,d=t.halfCheckedKeys,f=t.keyEntities,p=t.disabled,v=t.dragging,h=t.dragOverNodeKey,g=t.dropPosition,m=t.motion,b=t.height,E=t.itemHeight,C=t.virtual,x=t.focusable,S=t.activeItem,w=t.focused,D=t.tabIndex,T=t.onKeyDown,A=t.onFocus,M=t.onBlur,P=t.onActiveChange,k=t.onListChangeStart,_=t.onListChangeEnd,N=(0,ms.A)(t,Ry),I=y.useRef(null),B=y.useRef(null);y.useImperativeHandle(e,function(){return{scrollTo:function(Rt){I.current.scrollTo(Rt)},getIndentWidth:function(){return B.current.offsetWidth}}});var L=y.useState(s),G=(0,Sr.A)(L,2),W=G[0],z=G[1],X=y.useState(n),j=(0,Sr.A)(X,2),Y=j[0],Z=j[1],U=y.useState(n),q=(0,Sr.A)(U,2),et=q[0],at=q[1],ot=y.useState([]),V=(0,Sr.A)(ot,2),tt=V[0],gt=V[1],st=y.useState(null),lt=(0,Sr.A)(st,2),ft=lt[0],bt=lt[1],St=y.useRef(n);St.current=n;function ut(){var vt=St.current;Z(vt),at(vt),gt([]),bt(null),_()}(0,sa.A)(function(){z(s);var vt=Oy(W,s);if(vt.key!==null)if(vt.add){var Rt=Y.findIndex(function(ir){var Tr=ir.key;return Tr===vt.key}),wt=sf(rf(Y,n,vt.key),C,b,E),At=Y.slice();At.splice(Rt+1,0,of),at(At),gt(wt),bt("show")}else{var Ut=n.findIndex(function(ir){var Tr=ir.key;return Tr===vt.key}),Zt=sf(rf(n,Y,vt.key),C,b,E),wr=n.slice();wr.splice(Ut+1,0,of),at(wr),gt(Zt),bt("hide")}else Y!==n&&(Z(n),at(n))},[s,n]),y.useEffect(function(){v||ut()},[v]);var Et=m?et:n,Bt={expandedKeys:s,selectedKeys:o,loadedKeys:c,loadingKeys:u,checkedKeys:l,halfCheckedKeys:d,dragOverNodeKey:h,dropPosition:g,keyEntities:f};return y.createElement(y.Fragment,null,w&&S&&y.createElement("span",{style:nf,"aria-live":"assertive"},Ny(S)),y.createElement("div",null,y.createElement("input",{style:nf,disabled:x===!1||p,tabIndex:x!==!1?D:null,onKeyDown:T,onFocus:A,onBlur:M,value:"",onChange:_y,"aria-label":"for screen reader"})),y.createElement("div",{className:"".concat(r,"-treenode"),"aria-hidden":!0,style:{position:"absolute",pointerEvents:"none",visibility:"hidden",height:0,overflow:"hidden",border:0,padding:0}},y.createElement("div",{className:"".concat(r,"-indent")},y.createElement("div",{ref:B,className:"".concat(r,"-indent-unit")}))),y.createElement(Ey.A,(0,rr.A)({},N,{data:Et,itemKey:lf,height:b,fullHeight:!1,virtual:C,itemHeight:E,prefixCls:"".concat(r,"-list"),ref:I,onVisibleChange:function(Rt,wt){var At=new Set(Rt),Ut=wt.filter(function(Zt){return!At.has(Zt)});Ut.some(function(Zt){return lf(Zt)===xr})&&ut()}}),function(vt){var Rt=vt.pos,wt=Object.assign({},(qd(vt.data),vt.data)),At=vt.title,Ut=vt.key,Zt=vt.isStart,wr=vt.isEnd,ir=(0,mt.i7)(Ut,Rt);delete wt.key,delete wt.children;var Tr=(0,mt.N5)(ir,Bt);return y.createElement(Py,(0,rr.A)({},wt,Tr,{title:At,active:!!S&&Ut===S.key,pos:Rt,data:vt.data,isStart:Zt,isEnd:wr,motion:m,motionNodes:Ut===xr?tt:null,motionType:ft,onMotionStart:k,onMotionEnd:ut,treeNodeRequiredProps:Bt,onMouseMove:function(){P(null)}}))}))});cf.displayName="NodeList";const Ly=cf;var zy=null;function Ye(t,e){if(!t)return[];var r=t.slice(),n=r.indexOf(e);return n>=0&&r.splice(n,1),r}function nr(t,e){var r=(t||[]).slice();return r.indexOf(e)===-1&&r.push(e),r}function Cs(t){return t.split("-")}function Iy(t,e){var r=[],n=(0,Pe.A)(e,t);function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];a.forEach(function(s){var o=s.key,l=s.children;r.push(o),i(l)})}return i(n.children),r}function By(t){if(t.parent){var e=Cs(t.pos);return Number(e[e.length-1])===t.parent.children.length-1}return!1}function Gy(t){var e=Cs(t.pos);return Number(e[e.length-1])===0}function uf(t,e,r,n,i,a,s,o,l,c){var u,d=t.clientX,f=t.clientY,p=t.target.getBoundingClientRect(),v=p.top,h=p.height,g=(c==="rtl"?-1:1)*((i?.x||0)-d),m=(g-12)/n,b=l.filter(function(I){var B;return(B=o[I])===null||B===void 0||(B=B.children)===null||B===void 0?void 0:B.length}),E=(0,Pe.A)(o,r.props.eventKey);if(f<v+h/2){var C=s.findIndex(function(I){return I.key===E.key}),x=C<=0?0:C-1,S=s[x].key;E=(0,Pe.A)(o,S)}var w=E.key,D=E,T=E.key,A=0,M=0;if(!b.includes(w))for(var P=0;P<m&&By(E);P+=1)E=E.parent,M+=1;var k=e.props.data,_=E.node,N=!0;return Gy(E)&&E.level===0&&f<v+h/2&&a({dragNode:k,dropNode:_,dropPosition:-1})&&E.key===r.props.eventKey?A=-1:(D.children||[]).length&&b.includes(T)?a({dragNode:k,dropNode:_,dropPosition:0})?A=0:N=!1:M===0?m>-1.5?a({dragNode:k,dropNode:_,dropPosition:1})?A=1:N=!1:a({dragNode:k,dropNode:_,dropPosition:0})?A=0:a({dragNode:k,dropNode:_,dropPosition:1})?A=1:N=!1:a({dragNode:k,dropNode:_,dropPosition:1})?A=1:N=!1,{dropPosition:A,dropLevelOffset:M,dropTargetKey:E.key,dropTargetPos:E.pos,dragOverNodeKey:T,dropContainerKey:A===0?null:((u=E.parent)===null||u===void 0?void 0:u.key)||null,dropAllowed:N}}function df(t,e){if(t){var r=e.multiple;return r?t.slice():t.length?[t[0]]:t}}var Fy=function(e){return e};function Ky(t,e){if(!t)return[];var r=e||{},n=r.processProps,i=n===void 0?Fy:n,a=Array.isArray(t)?t:[t];return a.map(function(s){var o=s.children,l=_objectWithoutProperties(s,zy),c=Ky(o,e);return React.createElement(TreeNode,_extends({key:l.key},i(l)),c)})}function Ss(t){if(!t)return null;var e;if(Array.isArray(t))e={checkedKeys:t,halfCheckedKeys:void 0};else if((0,Vd.A)(t)==="object")e={checkedKeys:t.checked||void 0,halfCheckedKeys:t.halfChecked||void 0};else return(0,Xn.Ay)(!1,"`checkedKeys` is not an array or an object"),null;return e}function ff(t,e){var r=new Set;function n(i){if(!r.has(i)){var a=(0,Pe.A)(e,i);if(a){r.add(i);var s=a.parent,o=a.node;o.disabled||s&&n(s.key)}}}return(t||[]).forEach(function(i){n(i)}),(0,hs.A)(r)}var xs=K(38820),Wy=10,Ds=function(t){(0,Ud.A)(r,t);var e=(0,Zd.A)(r);function r(){var n;(0,$d.A)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=e.call.apply(e,[this].concat(a)),(0,H.A)((0,Q.A)(n),"destroyed",!1),(0,H.A)((0,Q.A)(n),"delayedDragEnterLogic",void 0),(0,H.A)((0,Q.A)(n),"loadingRetryTimes",{}),(0,H.A)((0,Q.A)(n),"state",{keyEntities:{},indent:null,selectedKeys:[],checkedKeys:[],halfCheckedKeys:[],loadedKeys:[],loadingKeys:[],expandedKeys:[],draggingNodeKey:null,dragChildrenKeys:[],dropTargetKey:null,dropPosition:null,dropContainerKey:null,dropLevelOffset:null,dropTargetPos:null,dropAllowed:!0,dragOverNodeKey:null,treeData:[],flattenNodes:[],focused:!1,activeKey:null,listChanging:!1,prevProps:null,fieldNames:(0,mt.AZ)()}),(0,H.A)((0,Q.A)(n),"dragStartMousePosition",null),(0,H.A)((0,Q.A)(n),"dragNode",void 0),(0,H.A)((0,Q.A)(n),"currentMouseOverDroppableNodeKey",null),(0,H.A)((0,Q.A)(n),"listRef",y.createRef()),(0,H.A)((0,Q.A)(n),"onNodeDragStart",function(o,l){var c=n.state,u=c.expandedKeys,d=c.keyEntities,f=n.props.onDragStart,p=l.props.eventKey;n.dragNode=l,n.dragStartMousePosition={x:o.clientX,y:o.clientY};var v=Ye(u,p);n.setState({draggingNodeKey:p,dragChildrenKeys:Iy(p,d),indent:n.listRef.current.getIndentWidth()}),n.setExpandedKeys(v),window.addEventListener("dragend",n.onWindowDragEnd),f?.({event:o,node:(0,mt.Hj)(l.props)})}),(0,H.A)((0,Q.A)(n),"onNodeDragEnter",function(o,l){var c=n.state,u=c.expandedKeys,d=c.keyEntities,f=c.dragChildrenKeys,p=c.flattenNodes,v=c.indent,h=n.props,g=h.onDragEnter,m=h.onExpand,b=h.allowDrop,E=h.direction,C=l.props,x=C.pos,S=C.eventKey,w=(0,Q.A)(n),D=w.dragNode;if(n.currentMouseOverDroppableNodeKey!==S&&(n.currentMouseOverDroppableNodeKey=S),!D){n.resetDragState();return}var T=uf(o,D,l,v,n.dragStartMousePosition,b,p,d,u,E),A=T.dropPosition,M=T.dropLevelOffset,P=T.dropTargetKey,k=T.dropContainerKey,_=T.dropTargetPos,N=T.dropAllowed,I=T.dragOverNodeKey;if(f.indexOf(P)!==-1||!N){n.resetDragState();return}if(n.delayedDragEnterLogic||(n.delayedDragEnterLogic={}),Object.keys(n.delayedDragEnterLogic).forEach(function(B){clearTimeout(n.delayedDragEnterLogic[B])}),D.props.eventKey!==l.props.eventKey&&(o.persist(),n.delayedDragEnterLogic[x]=window.setTimeout(function(){if(n.state.draggingNodeKey!==null){var B=(0,hs.A)(u),L=(0,Pe.A)(d,l.props.eventKey);L&&(L.children||[]).length&&(B=nr(u,l.props.eventKey)),"expandedKeys"in n.props||n.setExpandedKeys(B),m?.(B,{node:(0,mt.Hj)(l.props),expanded:!0,nativeEvent:o.nativeEvent})}},800)),D.props.eventKey===P&&M===0){n.resetDragState();return}n.setState({dragOverNodeKey:I,dropPosition:A,dropLevelOffset:M,dropTargetKey:P,dropContainerKey:k,dropTargetPos:_,dropAllowed:N}),g?.({event:o,node:(0,mt.Hj)(l.props),expandedKeys:u})}),(0,H.A)((0,Q.A)(n),"onNodeDragOver",function(o,l){var c=n.state,u=c.dragChildrenKeys,d=c.flattenNodes,f=c.keyEntities,p=c.expandedKeys,v=c.indent,h=n.props,g=h.onDragOver,m=h.allowDrop,b=h.direction,E=(0,Q.A)(n),C=E.dragNode;if(C){var x=uf(o,C,l,v,n.dragStartMousePosition,m,d,f,p,b),S=x.dropPosition,w=x.dropLevelOffset,D=x.dropTargetKey,T=x.dropContainerKey,A=x.dropAllowed,M=x.dropTargetPos,P=x.dragOverNodeKey;u.indexOf(D)!==-1||!A||(C.props.eventKey===D&&w===0?n.state.dropPosition===null&&n.state.dropLevelOffset===null&&n.state.dropTargetKey===null&&n.state.dropContainerKey===null&&n.state.dropTargetPos===null&&n.state.dropAllowed===!1&&n.state.dragOverNodeKey===null||n.resetDragState():S===n.state.dropPosition&&w===n.state.dropLevelOffset&&D===n.state.dropTargetKey&&T===n.state.dropContainerKey&&M===n.state.dropTargetPos&&A===n.state.dropAllowed&&P===n.state.dragOverNodeKey||n.setState({dropPosition:S,dropLevelOffset:w,dropTargetKey:D,dropContainerKey:T,dropTargetPos:M,dropAllowed:A,dragOverNodeKey:P}),g?.({event:o,node:(0,mt.Hj)(l.props)}))}}),(0,H.A)((0,Q.A)(n),"onNodeDragLeave",function(o,l){n.currentMouseOverDroppableNodeKey===l.props.eventKey&&!o.currentTarget.contains(o.relatedTarget)&&(n.resetDragState(),n.currentMouseOverDroppableNodeKey=null);var c=n.props.onDragLeave;c?.({event:o,node:(0,mt.Hj)(l.props)})}),(0,H.A)((0,Q.A)(n),"onWindowDragEnd",function(o){n.onNodeDragEnd(o,null,!0),window.removeEventListener("dragend",n.onWindowDragEnd)}),(0,H.A)((0,Q.A)(n),"onNodeDragEnd",function(o,l){var c=n.props.onDragEnd;n.setState({dragOverNodeKey:null}),n.cleanDragState(),c?.({event:o,node:(0,mt.Hj)(l.props)}),n.dragNode=null,window.removeEventListener("dragend",n.onWindowDragEnd)}),(0,H.A)((0,Q.A)(n),"onNodeDrop",function(o,l){var c,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,d=n.state,f=d.dragChildrenKeys,p=d.dropPosition,v=d.dropTargetKey,h=d.dropTargetPos,g=d.dropAllowed;if(g){var m=n.props.onDrop;if(n.setState({dragOverNodeKey:null}),n.cleanDragState(),v!==null){var b=(0,xe.A)((0,xe.A)({},(0,mt.N5)(v,n.getTreeNodeRequiredProps())),{},{active:((c=n.getActiveItem())===null||c===void 0?void 0:c.key)===v,data:(0,Pe.A)(n.state.keyEntities,v).node}),E=f.indexOf(v)!==-1;(0,Xn.Ay)(!E,"Can not drop to dragNode's children node. This is a bug of rc-tree. Please report an issue.");var C=Cs(h),x={event:o,node:(0,mt.Hj)(b),dragNode:n.dragNode?(0,mt.Hj)(n.dragNode.props):null,dragNodesKeys:[n.dragNode.props.eventKey].concat(f),dropToGap:p!==0,dropPosition:p+Number(C[C.length-1])};u||m?.(x),n.dragNode=null}}}),(0,H.A)((0,Q.A)(n),"cleanDragState",function(){var o=n.state.draggingNodeKey;o!==null&&n.setState({draggingNodeKey:null,dropPosition:null,dropContainerKey:null,dropTargetKey:null,dropLevelOffset:null,dropAllowed:!0,dragOverNodeKey:null}),n.dragStartMousePosition=null,n.currentMouseOverDroppableNodeKey=null}),(0,H.A)((0,Q.A)(n),"triggerExpandActionExpand",function(o,l){var c=n.state,u=c.expandedKeys,d=c.flattenNodes,f=l.expanded,p=l.key,v=l.isLeaf;if(!(v||o.shiftKey||o.metaKey||o.ctrlKey)){var h=d.filter(function(m){return m.key===p})[0],g=(0,mt.Hj)((0,xe.A)((0,xe.A)({},(0,mt.N5)(p,n.getTreeNodeRequiredProps())),{},{data:h.data}));n.setExpandedKeys(f?Ye(u,p):nr(u,p)),n.onNodeExpand(o,g)}}),(0,H.A)((0,Q.A)(n),"onNodeClick",function(o,l){var c=n.props,u=c.onClick,d=c.expandAction;d==="click"&&n.triggerExpandActionExpand(o,l),u?.(o,l)}),(0,H.A)((0,Q.A)(n),"onNodeDoubleClick",function(o,l){var c=n.props,u=c.onDoubleClick,d=c.expandAction;d==="doubleClick"&&n.triggerExpandActionExpand(o,l),u?.(o,l)}),(0,H.A)((0,Q.A)(n),"onNodeSelect",function(o,l){var c=n.state.selectedKeys,u=n.state,d=u.keyEntities,f=u.fieldNames,p=n.props,v=p.onSelect,h=p.multiple,g=l.selected,m=l[f.key],b=!g;b?h?c=nr(c,m):c=[m]:c=Ye(c,m);var E=c.map(function(C){var x=(0,Pe.A)(d,C);return x?x.node:null}).filter(function(C){return C});n.setUncontrolledState({selectedKeys:c}),v?.(c,{event:"select",selected:b,node:l,selectedNodes:E,nativeEvent:o.nativeEvent})}),(0,H.A)((0,Q.A)(n),"onNodeCheck",function(o,l,c){var u=n.state,d=u.keyEntities,f=u.checkedKeys,p=u.halfCheckedKeys,v=n.props,h=v.checkStrictly,g=v.onCheck,m=l.key,b,E={event:"check",node:l,checked:c,nativeEvent:o.nativeEvent};if(h){var C=c?nr(f,m):Ye(f,m),x=Ye(p,m);b={checked:C,halfChecked:x},E.checkedNodes=C.map(function(M){return(0,Pe.A)(d,M)}).filter(function(M){return M}).map(function(M){return M.node}),n.setUncontrolledState({checkedKeys:C})}else{var S=(0,xs.p)([].concat((0,hs.A)(f),[m]),!0,d),w=S.checkedKeys,D=S.halfCheckedKeys;if(!c){var T=new Set(w);T.delete(m);var A=(0,xs.p)(Array.from(T),{checked:!1,halfCheckedKeys:D},d);w=A.checkedKeys,D=A.halfCheckedKeys}b=w,E.checkedNodes=[],E.checkedNodesPositions=[],E.halfCheckedKeys=D,w.forEach(function(M){var P=(0,Pe.A)(d,M);if(P){var k=P.node,_=P.pos;E.checkedNodes.push(k),E.checkedNodesPositions.push({node:k,pos:_})}}),n.setUncontrolledState({checkedKeys:w},!1,{halfCheckedKeys:D})}g?.(b,E)}),(0,H.A)((0,Q.A)(n),"onNodeLoad",function(o){var l=o.key,c=new Promise(function(u,d){n.setState(function(f){var p=f.loadedKeys,v=p===void 0?[]:p,h=f.loadingKeys,g=h===void 0?[]:h,m=n.props,b=m.loadData,E=m.onLoad;if(!b||v.indexOf(l)!==-1||g.indexOf(l)!==-1)return null;var C=b(o);return C.then(function(){var x=n.state.loadedKeys,S=nr(x,l);E?.(S,{event:"load",node:o}),n.setUncontrolledState({loadedKeys:S}),n.setState(function(w){return{loadingKeys:Ye(w.loadingKeys,l)}}),u()}).catch(function(x){if(n.setState(function(w){return{loadingKeys:Ye(w.loadingKeys,l)}}),n.loadingRetryTimes[l]=(n.loadingRetryTimes[l]||0)+1,n.loadingRetryTimes[l]>=Wy){var S=n.state.loadedKeys;(0,Xn.Ay)(!1,"Retry for `loadData` many times but still failed. No more retry."),n.setUncontrolledState({loadedKeys:nr(S,l)}),u()}d(x)}),{loadingKeys:nr(g,l)}})});return c.catch(function(){}),c}),(0,H.A)((0,Q.A)(n),"onNodeMouseEnter",function(o,l){var c=n.props.onMouseEnter;c?.({event:o,node:l})}),(0,H.A)((0,Q.A)(n),"onNodeMouseLeave",function(o,l){var c=n.props.onMouseLeave;c?.({event:o,node:l})}),(0,H.A)((0,Q.A)(n),"onNodeContextMenu",function(o,l){var c=n.props.onRightClick;c&&(o.preventDefault(),c({event:o,node:l}))}),(0,H.A)((0,Q.A)(n),"onFocus",function(){var o=n.props.onFocus;n.setState({focused:!0});for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];o?.apply(void 0,c)}),(0,H.A)((0,Q.A)(n),"onBlur",function(){var o=n.props.onBlur;n.setState({focused:!1}),n.onActiveChange(null);for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];o?.apply(void 0,c)}),(0,H.A)((0,Q.A)(n),"getTreeNodeRequiredProps",function(){var o=n.state,l=o.expandedKeys,c=o.selectedKeys,u=o.loadedKeys,d=o.loadingKeys,f=o.checkedKeys,p=o.halfCheckedKeys,v=o.dragOverNodeKey,h=o.dropPosition,g=o.keyEntities;return{expandedKeys:l||[],selectedKeys:c||[],loadedKeys:u||[],loadingKeys:d||[],checkedKeys:f||[],halfCheckedKeys:p||[],dragOverNodeKey:v,dropPosition:h,keyEntities:g}}),(0,H.A)((0,Q.A)(n),"setExpandedKeys",function(o){var l=n.state,c=l.treeData,u=l.fieldNames,d=(0,mt.$9)(c,o,u);n.setUncontrolledState({expandedKeys:o,flattenNodes:d},!0)}),(0,H.A)((0,Q.A)(n),"onNodeExpand",function(o,l){var c=n.state.expandedKeys,u=n.state,d=u.listChanging,f=u.fieldNames,p=n.props,v=p.onExpand,h=p.loadData,g=l.expanded,m=l[f.key];if(!d){var b=c.indexOf(m),E=!g;if((0,Xn.Ay)(g&&b!==-1||!g&&b===-1,"Expand state not sync with index check"),E?c=nr(c,m):c=Ye(c,m),n.setExpandedKeys(c),v?.(c,{node:l,expanded:E,nativeEvent:o.nativeEvent}),E&&h){var C=n.onNodeLoad(l);C&&C.then(function(){var x=(0,mt.$9)(n.state.treeData,c,f);n.setUncontrolledState({flattenNodes:x})}).catch(function(){var x=n.state.expandedKeys,S=Ye(x,m);n.setExpandedKeys(S)})}}}),(0,H.A)((0,Q.A)(n),"onListChangeStart",function(){n.setUncontrolledState({listChanging:!0})}),(0,H.A)((0,Q.A)(n),"onListChangeEnd",function(){setTimeout(function(){n.setUncontrolledState({listChanging:!1})})}),(0,H.A)((0,Q.A)(n),"onActiveChange",function(o){var l=n.state.activeKey,c=n.props,u=c.onActiveChange,d=c.itemScrollOffset,f=d===void 0?0:d;l!==o&&(n.setState({activeKey:o}),o!==null&&n.scrollTo({key:o,offset:f}),u?.(o))}),(0,H.A)((0,Q.A)(n),"getActiveItem",function(){var o=n.state,l=o.activeKey,c=o.flattenNodes;return l===null?null:c.find(function(u){var d=u.key;return d===l})||null}),(0,H.A)((0,Q.A)(n),"offsetActiveKey",function(o){var l=n.state,c=l.flattenNodes,u=l.activeKey,d=c.findIndex(function(v){var h=v.key;return h===u});d===-1&&o<0&&(d=c.length),d=(d+o+c.length)%c.length;var f=c[d];if(f){var p=f.key;n.onActiveChange(p)}else n.onActiveChange(null)}),(0,H.A)((0,Q.A)(n),"onKeyDown",function(o){var l=n.state,c=l.activeKey,u=l.expandedKeys,d=l.checkedKeys,f=l.fieldNames,p=n.props,v=p.onKeyDown,h=p.checkable,g=p.selectable;switch(o.which){case Jr.A.UP:{n.offsetActiveKey(-1),o.preventDefault();break}case Jr.A.DOWN:{n.offsetActiveKey(1),o.preventDefault();break}}var m=n.getActiveItem();if(m&&m.data){var b=n.getTreeNodeRequiredProps(),E=m.data.isLeaf===!1||!!(m.data[f.children]||[]).length,C=(0,mt.Hj)((0,xe.A)((0,xe.A)({},(0,mt.N5)(c,b)),{},{data:m.data,active:!0}));switch(o.which){case Jr.A.LEFT:{E&&u.includes(c)?n.onNodeExpand({},C):m.parent&&n.onActiveChange(m.parent.key),o.preventDefault();break}case Jr.A.RIGHT:{E&&!u.includes(c)?n.onNodeExpand({},C):m.children&&m.children.length&&n.onActiveChange(m.children[0].key),o.preventDefault();break}case Jr.A.ENTER:case Jr.A.SPACE:{h&&!C.disabled&&C.checkable!==!1&&!C.disableCheckbox?n.onNodeCheck({},C,!d.includes(c)):!h&&g&&!C.disabled&&C.selectable!==!1&&n.onNodeSelect({},C);break}}}v?.(o)}),(0,H.A)((0,Q.A)(n),"setUncontrolledState",function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!n.destroyed){var u=!1,d=!0,f={};Object.keys(o).forEach(function(p){if(p in n.props){d=!1;return}u=!0,f[p]=o[p]}),u&&(!l||d)&&n.setState((0,xe.A)((0,xe.A)({},f),c))}}),(0,H.A)((0,Q.A)(n),"scrollTo",function(o){n.listRef.current.scrollTo(o)}),n}return(0,jd.A)(r,[{key:"componentDidMount",value:function(){this.destroyed=!1,this.onUpdated()}},{key:"componentDidUpdate",value:function(){this.onUpdated()}},{key:"onUpdated",value:function(){var i=this.props,a=i.activeKey,s=i.itemScrollOffset,o=s===void 0?0:s;a!==void 0&&a!==this.state.activeKey&&(this.setState({activeKey:a}),a!==null&&this.scrollTo({key:a,offset:o}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("dragend",this.onWindowDragEnd),this.destroyed=!0}},{key:"resetDragState",value:function(){this.setState({dragOverNodeKey:null,dropPosition:null,dropLevelOffset:null,dropTargetKey:null,dropContainerKey:null,dropTargetPos:null,dropAllowed:!1})}},{key:"render",value:function(){var i=this.state,a=i.focused,s=i.flattenNodes,o=i.keyEntities,l=i.draggingNodeKey,c=i.activeKey,u=i.dropLevelOffset,d=i.dropContainerKey,f=i.dropTargetKey,p=i.dropPosition,v=i.dragOverNodeKey,h=i.indent,g=this.props,m=g.prefixCls,b=g.className,E=g.style,C=g.showLine,x=g.focusable,S=g.tabIndex,w=S===void 0?0:S,D=g.selectable,T=g.showIcon,A=g.icon,M=g.switcherIcon,P=g.draggable,k=g.checkable,_=g.checkStrictly,N=g.disabled,I=g.motion,B=g.loadData,L=g.filterTreeNode,G=g.height,W=g.itemHeight,z=g.virtual,X=g.titleRender,j=g.dropIndicatorRender,Y=g.onContextMenu,Z=g.onScroll,U=g.direction,q=g.rootClassName,et=g.rootStyle,at=(0,Qd.A)(this.props,{aria:!0,data:!0}),ot;return P&&((0,Vd.A)(P)==="object"?ot=P:typeof P=="function"?ot={nodeDraggable:P}:ot={}),y.createElement(gs.Provider,{value:{prefixCls:m,selectable:D,showIcon:T,icon:A,switcherIcon:M,draggable:ot,draggingNodeKey:l,checkable:k,checkStrictly:_,disabled:N,keyEntities:o,dropLevelOffset:u,dropContainerKey:d,dropTargetKey:f,dropPosition:p,dragOverNodeKey:v,indent:h,direction:U,dropIndicatorRender:j,loadData:B,filterTreeNode:L,titleRender:X,onNodeClick:this.onNodeClick,onNodeDoubleClick:this.onNodeDoubleClick,onNodeExpand:this.onNodeExpand,onNodeSelect:this.onNodeSelect,onNodeCheck:this.onNodeCheck,onNodeLoad:this.onNodeLoad,onNodeMouseEnter:this.onNodeMouseEnter,onNodeMouseLeave:this.onNodeMouseLeave,onNodeContextMenu:this.onNodeContextMenu,onNodeDragStart:this.onNodeDragStart,onNodeDragEnter:this.onNodeDragEnter,onNodeDragOver:this.onNodeDragOver,onNodeDragLeave:this.onNodeDragLeave,onNodeDragEnd:this.onNodeDragEnd,onNodeDrop:this.onNodeDrop}},y.createElement("div",{role:"tree",className:Be()(m,b,q,(0,H.A)((0,H.A)((0,H.A)({},"".concat(m,"-show-line"),C),"".concat(m,"-focused"),a),"".concat(m,"-active-focused"),c!==null)),style:et},y.createElement(Ly,(0,rr.A)({ref:this.listRef,prefixCls:m,style:E,data:s,disabled:N,selectable:D,checkable:!!k,motion:I,dragging:l!==null,height:G,itemHeight:W,virtual:z,focusable:x,focused:a,tabIndex:w,activeItem:this.getActiveItem(),onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onActiveChange:this.onActiveChange,onListChangeStart:this.onListChangeStart,onListChangeEnd:this.onListChangeEnd,onContextMenu:Y,onScroll:Z},this.getTreeNodeRequiredProps(),at))))}}],[{key:"getDerivedStateFromProps",value:function(i,a){var s=a.prevProps,o={prevProps:i};function l(S){return!s&&S in i||s&&s[S]!==i[S]}var c,u=a.fieldNames;if(l("fieldNames")&&(u=(0,mt.AZ)(i.fieldNames),o.fieldNames=u),l("treeData")?c=i.treeData:l("children")&&((0,Xn.Ay)(!1,"`children` of Tree is deprecated. Please use `treeData` instead."),c=(0,mt.vH)(i.children)),c){o.treeData=c;var d=(0,mt.cG)(c,{fieldNames:u});o.keyEntities=(0,xe.A)((0,H.A)({},xr,af),d.keyEntities)}var f=o.keyEntities||a.keyEntities;if(l("expandedKeys")||s&&l("autoExpandParent"))o.expandedKeys=i.autoExpandParent||!s&&i.defaultExpandParent?ff(i.expandedKeys,f):i.expandedKeys;else if(!s&&i.defaultExpandAll){var p=(0,xe.A)({},f);delete p[xr],o.expandedKeys=Object.keys(p).map(function(S){return p[S].key})}else!s&&i.defaultExpandedKeys&&(o.expandedKeys=i.autoExpandParent||i.defaultExpandParent?ff(i.defaultExpandedKeys,f):i.defaultExpandedKeys);if(o.expandedKeys||delete o.expandedKeys,c||o.expandedKeys){var v=(0,mt.$9)(c||a.treeData,o.expandedKeys||a.expandedKeys,u);o.flattenNodes=v}if(i.selectable&&(l("selectedKeys")?o.selectedKeys=df(i.selectedKeys,i):!s&&i.defaultSelectedKeys&&(o.selectedKeys=df(i.defaultSelectedKeys,i))),i.checkable){var h;if(l("checkedKeys")?h=Ss(i.checkedKeys)||{}:!s&&i.defaultCheckedKeys?h=Ss(i.defaultCheckedKeys)||{}:c&&(h=Ss(i.checkedKeys)||{checkedKeys:a.checkedKeys,halfCheckedKeys:a.halfCheckedKeys}),h){var g=h,m=g.checkedKeys,b=m===void 0?[]:m,E=g.halfCheckedKeys,C=E===void 0?[]:E;if(!i.checkStrictly){var x=(0,xs.p)(b,!0,f);b=x.checkedKeys,C=x.halfCheckedKeys}o.checkedKeys=b,o.halfCheckedKeys=C}}return l("loadedKeys")&&(o.loadedKeys=i.loadedKeys),o}}]),r}(y.Component);(0,H.A)(Ds,"defaultProps",{prefixCls:"rc-tree",showLine:!1,showIcon:!0,selectable:!0,multiple:!1,checkable:!1,disabled:!1,checkStrictly:!1,draggable:!1,defaultExpandParent:!0,autoExpandParent:!1,defaultExpandAll:!1,defaultExpandedKeys:[],defaultCheckedKeys:[],defaultSelectedKeys:[],dropIndicatorRender:by,allowDrop:function(){return!0},expandAction:!1}),(0,H.A)(Ds,"TreeNode",bs);const Yy=Ds;function Xy(t){return(0,Hd.css)`
    .moveable-control-box {
      z-index: 999;
    }
    ,
    .rc-tree {
      margin: 0;
      margin-bottom: 15px;
      border: 1px solid transparent;

      &-focused:not(&-active-focused) {
        border-color: cyan;
      }

      .rc-tree-title {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
      }

      .rc-tree-treenode {
        margin: 0;
        padding: 1px;
        line-height: 24px;
        white-space: nowrap;
        list-style: none;
        outline: 0;

        display: flex;
        margin-bottom: 3px;
        cursor: pointer;

        .draggable {
          color: #333;
          -moz-user-select: none;
          -khtml-user-select: none;
          -webkit-user-select: none;
          user-select: none;
          /* Required to make elements draggable in old WebKit */
          // -khtml-user-drag: element;
          // -webkit-user-drag: element;
        }

        &.drop-container {
          > .draggable::after {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            box-shadow: inset 0 0 0 2px blue;
            content: '';
          }
          & ~ .rc-tree-treenode {
            border-left: 2px solid ${t.components.input.borderColor};
          }
        }
        &.drop-target {
          & ~ .rc-tree-treenode {
            border-left: none;
          }
        }
        &.filter-node {
          > .rc-tree-node-content-wrapper {
            color: #a60000 !important;
            font-weight: bold !important;
          }
        }
        ul {
          margin: 0;
          padding: 0 0 0 18px;
        }
        .rc-tree-node-content-wrapper {
          position: relative;
          display: inline-block;
          height: 24px;
          margin: 0;
          padding: 0;
          text-decoration: none;
          vertical-align: top;
          cursor: grab;
          flex-grow: 1;
          display: flex;

          border: 1px solid ${t.components.input.borderColor};
          border-radius: ${t.shape.radius.default};
          background: ${t.colors.background.secondary};
          min-height: ${t.spacing.gridSize*4}px;

          &:hover {
            border: 1px solid ${t.components.input.borderHover};
          }

          &.rc-tree-node-selected {
            border: 1px solid ${t.colors.primary.border};
            opacity: 1;
          }
        }

        span {
          &.rc-tree-checkbox,
          &.rc-tree-iconEle {
            display: inline-block;
            width: 16px;
            height: 16px;
            margin-right: 2px;
            line-height: 16px;
            vertical-align: -0.125em;
            background-color: transparent;
            background-repeat: no-repeat;
            background-attachment: scroll;
            border: 0 none;
            outline: none;
            cursor: pointer;

            &.rc-tree-icon__customize {
              background-image: none;
            }
          }
          &.rc-tree-switcher {
            display: flex;
            align-items: center;
            width: 16px;
            background-color: transparent;
            background-repeat: no-repeat;
            background-attachment: scroll;
            border: 0 none;
            outline: none;
            cursor: pointer;

            &.rc-tree-icon__customize {
              background-image: none;
            }
          }
          &.rc-tree-icon_loading {
            margin-right: 2px;
            vertical-align: top;
            background: url('data:image/gif;base64,R0lGODlhEAAQAKIGAMLY8YSx5HOm4Mjc88/g9Ofw+v///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgAGACwAAAAAEAAQAAADMGi6RbUwGjKIXCAA016PgRBElAVlG/RdLOO0X9nK61W39qvqiwz5Ls/rRqrggsdkAgAh+QQFCgAGACwCAAAABwAFAAADD2hqELAmiFBIYY4MAutdCQAh+QQFCgAGACwGAAAABwAFAAADD1hU1kaDOKMYCGAGEeYFCQAh+QQFCgAGACwKAAIABQAHAAADEFhUZjSkKdZqBQG0IELDQAIAIfkEBQoABgAsCgAGAAUABwAAAxBoVlRKgyjmlAIBqCDCzUoCACH5BAUKAAYALAYACgAHAAUAAAMPaGpFtYYMAgJgLogA610JACH5BAUKAAYALAIACgAHAAUAAAMPCAHWFiI4o1ghZZJB5i0JACH5BAUKAAYALAAABgAFAAcAAAMQCAFmIaEp1motpDQySMNFAgA7')
              no-repeat scroll 0 0 transparent;
          }
          &.rc-tree-switcher {
            &.rc-tree-switcher-noop {
              cursor: auto;
            }
            &.rc-tree-switcher_open {
              background-position: -93px -56px;
            }
            &.rc-tree-switcher_close {
              background-position: -75px -56px;
            }
          }
          &.rc-tree-checkbox {
            width: 13px;
            height: 13px;
            margin: 0 3px;
            background-position: 0 0;
            &-checked {
              background-position: -14px 0;
            }
            &-indeterminate {
              background-position: -14px -28px;
            }
            &-disabled {
              background-position: 0 -56px;
            }
            &.rc-tree-checkbox-checked.rc-tree-checkbox-disabled {
              background-position: -14px -56px;
            }
            &.rc-tree-checkbox-indeterminate.rc-tree-checkbox-disabled {
              position: relative;
              background: #ccc;
              border-radius: 3px;
              &::after {
                position: absolute;
                top: 5px;
                left: 3px;
                width: 5px;
                height: 0;
                border: 2px solid #fff;
                border-top: 0;
                border-left: 0;
                -webkit-transform: scale(1);
                transform: scale(1);
                content: ' ';
              }
            }
          }
        }
      }
      &:not(.rc-tree-show-line) {
        .rc-tree-treenode {
          .rc-tree-switcher-noop {
            background: none;
          }
        }
      }
      &.rc-tree-show-line {
        .rc-tree-treenode:not(:last-child) {
          > ul {
            background: url('data:image/gif;base64,R0lGODlhCQACAIAAAMzMzP///yH5BAEAAAEALAAAAAAJAAIAAAIEjI9pUAA7') 0 0
              repeat-y;
          }
          > .rc-tree-switcher-noop {
            background-position: -56px -18px;
          }
        }
        .rc-tree-treenode:last-child {
          > .rc-tree-switcher-noop {
            background-position: -56px -36px;
          }
        }
      }
      &-child-tree {
        display: none;
        &-open {
          display: block;
        }
      }
      &-treenode-disabled {
        > span:not(.rc-tree-switcher),
        > a,
        > a span {
          color: #767676;
          cursor: not-allowed;
        }
      }
      &-treenode-active {
        background: rgba(0, 0, 0, 0.1);
      }
      &-node-selected {
        opacity: 0.8;
      }
      &-icon__open {
        margin-right: 2px;
        vertical-align: top;
        background-position: -110px -16px;
      }
      &-icon__close {
        margin-right: 2px;
        vertical-align: top;
        background-position: -110px 0;
      }
      &-icon__docu {
        margin-right: 2px;
        vertical-align: top;
        background-position: -110px -32px;
      }
      &-icon__customize {
        margin-right: 2px;
        vertical-align: top;
      }
      &-title {
        display: inline-block;
      }
      &-indent {
        display: inline-block;
        height: 0;
        vertical-align: bottom;
      }
      &-indent-unit {
        display: inline-block;
        width: 16px;
      }

      &-draggable-icon {
        display: inline-flex;
        justify-content: center;
        width: 16px;
      }
    }
  `}var Hy=K(54391);const Vy=({settings:t,nodeData:e,setAllowSelection:r})=>{const n=e.dataRef,i=e.dataRef.getName(),a=(0,Pt.of)($y),s=t.layer,o=()=>{if(t?.layer)return t.layer.scene},l=p=>{(p.parent??s).doAction(Qt.Delete,p),r(!1)},c=p=>{(p.parent??s).doAction(Qt.Duplicate,p),r(!1)},u=(p,v)=>{p.onChange({...p.options,name:v})},d=p=>!!o()?.canRename(p),f=p=>p.options.type;return y.createElement(y.Fragment,null,y.createElement(Hy.R,{name:i,onChange:p=>u(n,p),verifyLayerNameUniqueness:d??void 0}),y.createElement("div",{className:a.textWrapper},"\xA0 ",f(n)),!e.children&&y.createElement("div",{className:a.actionButtonsWrapper},y.createElement(we.K,{name:"copy",title:"Duplicate",className:a.actionIcon,onClick:()=>c(n),tooltip:"Duplicate"}),y.createElement(we.K,{name:"trash-alt",title:"remove",className:a.actionIcon,onClick:()=>l(n),tooltip:"Remove"})))},$y=t=>({actionButtonsWrapper:(0,rt.css)({display:"flex",alignItems:"flex-end"}),actionIcon:(0,rt.css)({color:t.colors.text.secondary,cursor:"pointer","&:hover":{color:t.colors.text.primary}}),textWrapper:(0,rt.css)({display:"flex",alignItems:"center",flexGrow:1,overflow:"hidden",marginRight:t.spacing(1)}),layerName:(0,rt.css)({fontWeight:t.typography.fontWeightMedium,color:t.colors.primary.text,cursor:"pointer",overflow:"hidden",marginLeft:t.spacing(.5)})});function ws(t,e,r){let n=[];if(t)for(let i=t.elements.length;i--;i>=0){const a=t.elements[i],s={key:a.UID,title:a.getName(),selectable:!0,dataRef:a};a instanceof ie&&(s.children=ws(a,e,r)),n.push(s)}return n}function jy(t,e){const r=t.node.key,n=t.dragNode.key,i=t.node.pos.split("-"),a=t.dropPosition-Number(i[i.length-1]),s=(c,u,d)=>{c.forEach((f,p,v)=>{if(f.key===u){d(f,p,v);return}f.children&&s(f.children,u,d)})},o=[...e];let l;if(s(o,n,(c,u,d)=>{d.splice(u,1),l=c}),a===0)s(o,r,c=>{c.children=c.children||[],c.children.unshift(l)});else{let c=[],u=0;s(o,r,(d,f,p)=>{c=p,u=f}),a===-1?c.splice(u,0,l):c.splice(u+1,0,l)}return o}let pf=!0;const Uy=({item:t})=>{const[e,r]=(0,y.useState)(ws(t?.settings?.scene.root)),[n,i]=(0,y.useState)(!0),[a,s]=(0,y.useState)([]),[o,l]=(0,y.useState)([]),c=(0,Pt.$j)(),u=Xy(c),d=(0,Pt.of)(Zy),f=c.colors.primary.border,{settings:p}=t,v=(0,y.useMemo)(()=>p?.selected?p.selected.map(M=>M?.getName()):[],[p?.selected]),h=(0,y.useMemo)(()=>p?.selected?p.selected.map(M=>M?.UID):[],[p?.selected]);if((0,y.useEffect)(()=>{r(ws(t?.settings?.scene.root,v,f)),l(h),S()},[t?.settings?.scene.root,f,v,h]),!p)return y.createElement("div",null,"No settings");const g=p.layer;if(!g)return y.createElement("div",null,"Missing layer?");const m=(M,P)=>{pf&&t.settings?.scene&&Ys(t.settings.scene,P.node.dataRef)},b=()=>!0,E=M=>{const P=M.node.pos.split("-"),k=M.dropPosition-Number(P[P.length-1]),_=M.dragNode.dataRef,N=M.node.dataRef,I=jy(M,e);r(I),N.parent?.scene.reorderElements(_,N,M.dropToGap,k)},C=M=>{s(M),i(!1)},x=M=>M.isLeaf?y.createElement(y.Fragment,null):y.createElement(oa.I,{name:"angle-right",title:"Node Icon",style:{transform:`rotate(${M.expanded?90:0}deg)`,fill:c.colors.text.primary}}),S=(M=!0)=>{pf=M},w=()=>{g.scene.clearCurrentSelection()},D=M=>y.createElement(Vy,{nodeData:M,setAllowSelection:S,settings:p}),T=()=>{g.scene?g.scene.frameSelection():console.warn("no scene!")},A=qn(p.scene.shouldShowAdvancedTypes).options;return y.createElement(y.Fragment,null,y.createElement(Hd.Global,{styles:u}),y.createElement(Yy,{selectable:!0,onSelect:m,draggable:!0,defaultExpandAll:!0,autoExpandParent:n,showIcon:!1,allowDrop:b,onDrop:E,expandedKeys:a,onExpand:C,treeData:e,titleRender:D,switcherIcon:x,selectedKeys:o,multiple:!0}),y.createElement(De.Gy,{justify:"space-between"},y.createElement("div",{className:d.addLayerButton},y.createElement(Kd.r,{onChange:M=>ga(M,g),options:A,label:"Add item"})),v.length>0&&y.createElement(rn.$n,{size:"sm",variant:"secondary",onClick:w},"Clear selection"),v.length>1&&Xe.$.featureToggles.canvasPanelNesting&&y.createElement(rn.$n,{size:"sm",variant:"secondary",onClick:T},"Frame selection")))},Zy=t=>({addLayerButton:(0,rt.css)({marginLeft:"18px",minWidth:"150px"})});function vf(t){const{selected:e,scene:r}=t;if(r.currentLayer||(r.currentLayer=r.root),e)for(const i of e){if(i instanceof ie){r.currentLayer=i;break}if(i&&i.parent){r.currentLayer=i.parent;break}}const n=r.currentLayer.options||{elements:[]};return{category:["Layer"],path:"--",values:i=>({getValue:a=>(0,Oe.get)(n,a),onChange:(a,s)=>{if(a==="type"&&s){console.warn("unable to change layer type");return}const o=(0,aa.Sf)(n,a,s);r.currentLayer?.onChange(o),r.currentLayer?.updateData(r.context)}}),build:(i,a)=>{const s=r.currentLayer;s&&s.isRoot(),i.addCustomEditor({id:"content",path:"root",name:"Elements",editor:Uy,settings:{scene:r,layer:r.currentLayer,selected:e}});const o={...a,options:n};qr.addBackground(i,o),qr.addBorder(i,o),s&&!s.isRoot()&&i.addCustomEditor({category:["Layout"],id:"content",path:"__",name:"Constraints",editor:Yd,settings:{scene:t.scene,element:s}})}}}var Qy=K(63021),qy=K(40675);const Jy=({onTabChange:t})=>{const[e,r]=(0,y.useState)(He.SelectedElement),n=[{label:"Selected Element",value:He.SelectedElement},{label:"Element Management",value:He.ElementManagement}],i=a=>{t(a),r(a)};return y.createElement(y.Fragment,null,y.createElement(Qy.U,null,n.map((a,s)=>y.createElement(qy.o,{key:`${a.value}-${s}`,label:a.label,active:a.value===e,onChangeTab:()=>i(a.value)}))))};function tb(){const t=(0,Zn.A)(tn),e=t?.panel.context?.instanceState,r=(0,Pt.of)(rb),[n,i]=(0,y.useState)(He.SelectedElement),a=(0,y.useMemo)(()=>{const d=t?.panel,f=e;if(!f||!d)return new vs.C({id:"root",title:"root"});const p=v=>{n===He.ElementManagement&&v.addNestedOptions(vf(e));const h=f.selected;if(h?.length===1&&n===He.SelectedElement){const g=h[0];g&&!(g instanceof ie)&&v.addNestedOptions(Xd({category:[`Selected element (${g.options.name})`],element:g,scene:f.scene}))}As(v)};return eb({options:d.props.options,onChange:d.props.onOptionsChange,data:d.props.data?.series},p)},[e,t,n]),s={marginLeft:15,marginTop:10},o=d=>{i(d)},l=qn(e?.scene.shouldShowAdvancedTypes).options,c=e?.layer,u=e&&n===He.SelectedElement&&e.selected.length===0;return y.createElement(y.Fragment,null,y.createElement("div",{style:s},a.items.map(d=>d.render())),y.createElement("div",{style:s},y.createElement(Kd.r,{onChange:d=>ga(d,c),options:l,label:"Add item"})),y.createElement("div",{style:s},y.createElement(Jy,{onTabChange:o}),a.categories.map(d=>hf(d)),u&&y.createElement("div",{className:r.selectElement},"Please select an element")))}function hf(t){return y.createElement(oy.D,{...t.props,key:t.props.id},y.createElement("div",null,t.items.map(e=>e.render())),t.categories.map(e=>hf(e)))}function eb(t,e){const r={data:t.data??[],options:t.options},n=new vs.C({id:"root",title:"root"}),i=s=>{if(s?.length){const o=s[0];let l=n.categories.find(c=>c.props.id===o);return l||(l=new vs.C({id:o,title:o}),n.categories.push(l)),l}return n},a={getValue:s=>(0,Oe.get)(t.options,s),onChange:(s,o)=>{t.onChange((0,aa.Sf)(t.options,s,o))}};return(0,sy.g5)(e,a,i,r),n}const rb=t=>({selectElement:(0,rt.css)({color:t.colors.text.secondary,padding:t.spacing(2)})}),Ts=10,gf=32;function nb({onClose:t,id:e,scene:r}){const n=r.root.div?.getBoundingClientRect(),i=window.innerHeight,a=window.innerWidth,s=(0,y.useRef)(null),o=(0,Pt.of)(ib),l="inlineEditPanel"+e.toString(),c={width:400,height:400},u=n?.width??c.width+Ts*2,d=n?.x??0+u-c.width-Ts,f=n?.y??0+gf,p=Fd.A.getObject(l,{x:d,y:f,w:c.width,h:c.height}),[v,h]=(0,y.useState)({width:p.w,height:p.h}),[g,m]=(0,y.useState)({x:p.x,y:p.y});(0,y.useEffect)(()=>{const x=a-v.width-Ts,S=i-v.height-gf;x<g.x&&x>0&&m({...g,x}),S<g.y&&S>0&&m({...g,y:S})},[i,a,g,v]);const b=(x,S)=>{let w=S.x<0?0:S.x,D=S.y<0?0:S.y;m({x:w,y:D}),C(w,D,v.width,v.height)},E=(x,S)=>{const{size:w}=S;h({width:w.width,height:w.height}),C(g.x,g.y,w.width,w.height)},C=(x,S,w,D)=>{Fd.A.setObject(l,{x,y:S,w,h:D})};return y.createElement(Fn.ZL,null,y.createElement("div",{className:o.draggableWrapper},y.createElement(iy(),{handle:"strong",onStop:b,position:{x:g.x,y:g.y}},y.createElement(ay.Resizable,{height:v.height,width:v.width,onResize:E},y.createElement("div",{className:o.inlineEditorContainer,style:{height:`${v.height}px`,width:`${v.width}px`},ref:s},y.createElement("strong",{className:o.inlineEditorHeader},y.createElement("div",{className:o.placeholder}),y.createElement("div",null,"Canvas Inline Editor"),y.createElement(we.K,{name:"times",size:"xl",className:o.inlineEditorClose,onClick:t,tooltip:"Close inline editor"})),y.createElement("div",{className:o.inlineEditorContentWrapper},y.createElement("div",{className:o.inlineEditorContent},y.createElement(tb,null))))))))}const ib=t=>({inlineEditorContainer:(0,rt.css)({display:"flex",flexDirection:"column",background:t.components.panel.background,border:`1px solid ${t.colors.border.weak}`,boxShadow:t.shadows.z3,zIndex:1e3,opacity:1,minWidth:"400px"}),draggableWrapper:(0,rt.css)({width:0,height:0}),inlineEditorHeader:(0,rt.css)({display:"flex",alignItems:"center",justifyContent:"center",background:t.colors.background.canvas,borderBottom:`1px solid ${t.colors.border.weak}`,height:"40px",cursor:"move"}),inlineEditorContent:(0,rt.css)({whiteSpace:"pre-wrap",padding:"10px"}),inlineEditorClose:(0,rt.css)({marginLeft:"auto"}),placeholder:(0,rt.css)({width:"24px",height:"24px",visibility:"hidden",marginRight:"auto"}),inlineEditorContentWrapper:(0,rt.css)({overflow:"scroll"})});let Hn=[],Dr,la=!1,ca=!1;const tn=new tl.m(1);class mf extends y.Component{constructor(e){super(e),this.subs=new kp.yU,this.needsReload=!1,this.isEditing=el.Ny.getSearchObject().editPanel!==void 0,this.onUpdateScene=r=>{const{onOptionsChange:n,options:i}=this.props;n({...i,root:r}),this.setState({refresh:this.state.refresh+1}),tn.next({panel:this})},this.openInlineEdit=()=>{if(la){this.forceUpdate(),this.setActivePanel();return}this.setActivePanel(),this.setState({openInlineEdit:!0}),la=!0},this.openSetBackground=r=>{if(ca){this.forceUpdate(),this.setActivePanel();return}this.setActivePanel(),this.setState({openSetBackground:!0}),this.setState({contextMenuAnchorPoint:r}),ca=!0},this.tooltipCallback=r=>{this.scene.tooltip=r,this.forceUpdate()},this.moveableActionCallback=r=>{this.setState({moveableAction:r}),this.forceUpdate()},this.closeInlineEdit=()=>{this.setState({openInlineEdit:!1}),la=!1},this.closeSetBackground=()=>{this.setState({openSetBackground:!1}),ca=!1},this.setActivePanel=()=>{Dr=this,tn.next({panel:this})},this.renderInlineEdit=()=>y.createElement(nb,{onClose:()=>this.closeInlineEdit(),id:this.props.id,scene:this.scene}),this.renderSetBackground=()=>y.createElement(ey,{onClose:()=>this.closeSetBackground(),scene:this.scene,anchorPoint:this.state.contextMenuAnchorPoint}),this.state={refresh:0,openInlineEdit:!1,openSetBackground:!1,contextMenuAnchorPoint:{x:0,y:0},moveableAction:!1},this.scene=new q1(this.props.options.root,this.props.options.inlineEditing,this.props.options.showAdvancedTypes,this.props.options.panZoom,this.props.options.infinitePan,this.onUpdateScene,this),this.scene.updateSize(e.width,e.height),this.scene.updateData(e.data),this.scene.inlineEditingCallback=this.openInlineEdit,this.scene.setBackgroundCallback=this.openSetBackground,this.scene.tooltipCallback=this.tooltipCallback,this.scene.moveableActionCallback=this.moveableActionCallback,this.subs.add(this.props.eventBus.subscribe(Gd.sL,r=>{this.scene.clearCurrentSelection(),this.closeInlineEdit()})),this.subs.add(this.props.eventBus.subscribe(Gd.i0,r=>{this.props.id===r.payload&&(this.needsReload=!0,this.scene.clearCurrentSelection())}))}componentDidMount(){Dr=this,tn.next({panel:this}),this.panelContext=this.context,this.panelContext.onInstanceStateChange&&(this.panelContext.onInstanceStateChange({scene:this.scene,layer:this.scene.root}),this.subs.add(this.scene.selection.subscribe({next:e=>{e.length&&(Dr=this,tn.next({panel:this})),Hn.forEach(r=>{r!==Dr&&(r.scene.clearCurrentSelection(!0),r.scene.connections.select(void 0))}),this.panelContext?.onInstanceStateChange({scene:this.scene,selected:e,layer:this.scene.root})}})),this.subs.add(this.scene.connections.selection.subscribe({next:e=>{this.context.instanceState&&(this.panelContext?.onInstanceStateChange({scene:this.scene,selected:this.context.instanceState.selected,selectedConnection:e,layer:this.scene.root}),e&&(Dr=this,tn.next({panel:this})),Hn.forEach(r=>{r!==Dr&&(r.scene.clearCurrentSelection(!0),r.scene.connections.select(void 0))}),setTimeout(()=>{this.forceUpdate()}))}}))),Hn.push(this)}componentWillUnmount(){this.scene.subscription.unsubscribe(),this.subs.unsubscribe(),la=!1,ca=!1,Hn=Hn.filter(e=>e.props.id!==Dr?.props.id)}shouldComponentUpdate(e,r){const{width:n,height:i,data:a,options:s}=this.props;let o=!1;(n!==e.width||i!==e.height)&&(this.scene.updateSize(e.width,e.height),o=!0),a!==e.data&&!this.scene.ignoreDataUpdate&&(this.scene.updateData(e.data),o=!0),s!==e.options&&!this.scene.ignoreDataUpdate&&(this.scene.updateData(e.data),o=!0),this.state.refresh!==r.refresh&&(o=!0),this.state.openInlineEdit!==r.openInlineEdit&&(o=!0),this.state.openSetBackground!==r.openSetBackground&&(o=!0),this.state.moveableAction!==r.moveableAction&&(o=!0);const l=this.props.options.inlineEditing!==e.options.inlineEditing,c=this.props.options.showAdvancedTypes!==e.options.showAdvancedTypes,u=this.props.options.panZoom!==e.options.panZoom,d=this.props.options.infinitePan!==e.options.infinitePan;return(this.needsReload||l||c||u||d)&&(l&&this.scene.revId++,this.needsReload=!1,this.scene.load(e.options.root,e.options.inlineEditing,e.options.showAdvancedTypes,e.options.panZoom,e.options.infinitePan),this.scene.updateSize(e.width,e.height),this.scene.updateData(e.data),o=!0),o}render(){return y.createElement(y.Fragment,null,this.scene.render(),this.state.openInlineEdit&&this.renderInlineEdit(),this.state.openSetBackground&&this.renderSetBackground())}}mf.contextType=cn.e4;function ab(t){return{category:t.category,path:"--",values:e=>({getValue:r=>(0,Oe.get)(t.connection.info,r),onChange:(r,n)=>{let i=t.connection.info;i=(0,aa.Sf)(i,r,n),t.scene.connections.onChange(t.connection,i)}}),build:(e,r)=>{const n={...r,options:t.connection.info};qr.addColor(e,n),qr.addSize(e,n)}}}var ob=K(42418);const sb="https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/canvas/",lb=({})=>{const t=(0,Pt.of)(cb);return y.createElement(y.Fragment,null,y.createElement(De.Gy,{className:t.hGroup},y.createElement(ob.F,{title:"Pan and zoom controls",severity:"info",buttonContent:y.createElement(oa.I,{name:"question-circle",size:"xl"}),className:t.alert,onRemove:()=>{const e=window.open(sb,"_blank","noopener,noreferrer");e&&(e.opener=null)}},y.createElement(De.gW,null,y.createElement("ul",null,y.createElement("li",null,"Pan:",y.createElement("ul",null,y.createElement("li",null,"Middle mouse"),y.createElement("li",null,"CTRL + right mouse"))),y.createElement("li",null,"Zoom: Scroll wheel"),y.createElement("li",null,"Reset: Double click"))))))},cb=t=>({alert:(0,rt.css)({"& div":{padding:"4px",alignItems:"start"},marginBottom:"0px",marginTop:"5px",padding:"2px","ul > li":{marginLeft:"10px"}}),hGroup:(0,rt.css)({"& div":{width:"100%"}})}),ub=t=>{if((t?.pluginVersion??"")===""){const r=t.options?.root;if(r?.elements)for(const n of r.elements)n.type==="text-box"&&(n.type="rectangle")}return t.options},As=t=>{t.addBooleanSwitch({path:"inlineEditing",name:"Inline editing",description:"Enable editing the panel directly",defaultValue:!0}),t.addBooleanSwitch({path:"showAdvancedTypes",name:"Experimental element types",description:"Enable selection of experimental element types",defaultValue:!0}),t.addBooleanSwitch({path:"panZoom",name:"Pan and zoom",description:"Enable pan and zoom",defaultValue:!1,showIf:e=>Xe.$.featureToggles.canvasPanelPanZoom}),t.addCustomEditor({id:"panZoomHelp",path:"panZoomHelp",name:"",editor:lb,showIf:e=>Xe.$.featureToggles.canvasPanelPanZoom&&e.panZoom}),t.addBooleanSwitch({path:"infinitePan",name:"Infinite panning",description:"Enable infinite panning - useful for expansive canvases. Warning: this an experimental feature and currently only works well with elements that are top / left constrained",defaultValue:!1,showIf:e=>Xe.$.featureToggles.canvasPanelPanZoom&&e.panZoom})},db=new ua.m(mf).setNoPadding().useFieldConfig({standardOptions:{[da.uo.Mappings]:{settings:{icon:!0}}}}).setMigrationHandler(ub).setPanelOptions((t,e)=>{const r=e.instanceState;if(As(t),r){t.addNestedOptions(vf(r));const n=r.selected,i=r.selectedConnection;if(n?.length===1){const a=n[0];a instanceof ie||t.addNestedOptions(Xd({category:[`Selected element (${a.options.name})`],element:a,scene:r.scene}))}i&&t.addNestedOptions(ab({category:["Selected connection"],connection:i,scene:r.scene}))}})}}]);

//# sourceMappingURL=canvasPanel.a46aa5e57d26b1fcc380.js.map