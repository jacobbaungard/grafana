{"version":3,"file":"1347.8ad23b870a6e21306189.js","mappings":"4FAAA,EAA2C,CAAC,MAAM,EAAE,EAAG,IAAIA,EAAE,EAAQ,KAAe,EAAEC,EAAE,EAAQ,IAAa,EAAEC,EAAE,EAAQ,KAAO,EAAEC,GAAE,EAAQ,IAAQ,EAAE,SAASC,EAAEJ,EAAE,CAAC,OAAOA,GAAa,OAAOA,GAAjB,UAAoB,YAAYA,EAAEA,EAAE,CAAC,QAAQA,CAAC,CAAC,CAAC,IAAIK,EAAED,EAAEF,CAAC,EAAE,MAAMI,EAAE,CAAC,IAAI,MAAM,IAAI,KAAK,EAAEC,GAAE,yBAAyBC,GAAE,0BAA0BC,EAAE,0BAA0BC,EAAE,mBAAmBC,EAAE,oBAAoBC,GAAE,WAAWC,GAAE,aAAaC,GAAE,aAAaC,EAAE,yBAAyBC,EAAE,oBAAoBC,EAAE,yBAAyBC,EAAE,8BAA8BC,EAAE,yBAAyBC,EAAE,CAAC,cAAc,YAAY,eAAe,YAAY,EAAEC,EAAE,CAAC,CAAC,SAASrB,EAAE,iBAAiBG,EAAE,UAAUC,EAAE,WAAWE,EAAE,UAAUC,EAAE,YAAYK,CAAC,IAAI,CAAC,KAAK,CAACC,EAAEC,CAAC,EAAEZ,EAAE,SAAS,EAAEa,EAAEd,EAAE,UAAU,EAAEe,EAAEd,EAAE,YAAaF,GAAG,CAACc,EAAE,IAAI,EAAEV,EAAE,CAAC,EAAG,CAACA,CAAC,CAAC,EAAEc,EAAEhB,EAAE,YAAaF,GAAG,CAACM,EAAE,EAAEQ,EAAE,IAAI,CAAC,EAAG,CAACR,CAAC,CAAC,EAAEa,EAAEjB,EAAE,YAAaD,GAAG,CAAC,GAAQA,EAAE,KAAK,IAAZ,GAAc,CAAC,IAAIC,EAAE,GAAG,CAACA,EAAE,KAAK,MAAMD,CAAC,CAAC,MAAC,CAASa,EAAE,mBAAmB,CAAC,CAAC,MAAMV,EAAEkB,EAAEpB,CAAC,EAAEE,EAAE,SAASD,EAAE,EAAEH,EAAE,CAAC,WAAWE,EAAE,YAAY,SAASA,EAAE,UAAU,YAAYA,EAAE,aAAa,UAAUA,EAAE,UAAU,CAAC,GAAGY,EAAEV,EAAE,KAAK,EAAE,EAAG,CAACU,EAAEd,EAAEG,CAAC,CAAC,EAAE,OAAOE,EAAE,QAAQ,cAAcA,EAAE,QAAQ,SAAS,KAAKA,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,MAAM,YAAY,QAAQ,EAAQY,EAAG,YAAYN,EAAE,wBAAwB,mCAAmC,MAAMM,CAAC,EAAER,EAAE,QAAQ,cAAcA,EAAE,QAAQ,SAAS,KAAKO,GAAGP,EAAE,QAAQ,cAAc,MAAM,CAAC,cAAcG,EAAC,EAAEP,EAAE,cAAcI,EAAE,QAAQ,cAAcJ,EAAE,aAAa,CAAC,QAAQ,CAAC,SAAS,GAAG,OAAO,OAAO,EAAE,OAAO,aAAa,OAAOD,GAAG,CAACmB,EAAEnB,CAAC,CAAC,CAAC,EAAEK,EAAE,QAAQ,cAAc,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,SAAS,GAAGU,EAAE,WAAW,GAAG,WAAW,UAAU,QAAQ,CAAC,EAAE,gCAAgCV,EAAE,QAAQ,cAAc,KAAK,IAAI,EAAEA,EAAE,QAAQ,cAAc,KAAK,IAAI,EAAEA,EAAE,QAAQ,cAAcJ,EAAE,OAAO,CAAC,KAAK,SAAS,EAAE,uBAAuB,CAAC,CAAC,CAAC,EAAEM,GAAGF,EAAE,QAAQ,cAAcJ,EAAE,SAAS,CAAC,cAAcQ,EAAE,UAAU,GAAG,QAAQ,EAAQI,EAAG,YAAY,8BAA8B,OAAOb,GAAGmB,EAAEnB,EAAE,cAAc,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,EAAE,CAACO,GAAGF,EAAE,QAAQ,cAAcA,EAAE,QAAQ,SAAS,KAAKA,EAAE,QAAQ,cAAcJ,EAAE,OAAO,CAAC,cAAcS,EAAE,KAAK,SAAS,KAAK,UAAU,MAAM,CAAC,MAAM,GAAGK,EAAE,OAAO,QAAQ,MAAM,EAAE,QAAQC,CAAC,EAAE,iBAAiB,EAAEX,EAAE,QAAQ,cAAc,OAAO,CAAC,MAAM,CAAC,aAAa,OAAO,YAAY,MAAM,CAAC,EAAE,IAAI,CAAC,EAAEE,GAAGF,EAAE,QAAQ,cAAcA,EAAE,QAAQ,SAAS,KAAKA,EAAE,QAAQ,cAAcJ,EAAE,OAAO,CAAC,cAAcU,EAAE,KAAK,SAAS,KAAK,UAAU,MAAM,CAAC,MAAM,GAAGI,EAAE,OAAO,QAAQ,MAAM,EAAE,QAAQ,IAAI,CAACT,EAAE,CAAC,CAAC,EAAE,kBAAkB,EAAED,EAAE,QAAQ,cAAc,OAAO,CAAC,MAAM,CAAC,aAAa,OAAO,YAAY,MAAM,CAAC,EAAE,IAAI,CAAC,EAAEA,EAAE,QAAQ,cAAcJ,EAAE,OAAO,CAAC,cAAcgB,EAAE,KAAK,SAAS,KAAK,UAAU,MAAM,CAAC,MAAM,GAAGF,EAAE,OAAO,QAAQ,MAAM,EAAE,QAAQZ,CAAC,EAAE,4BAA4B,EAAEI,GAAGM,GAAGR,EAAE,QAAQ,cAAcJ,EAAE,MAAM,KAAKI,EAAE,QAAQ,cAAcJ,EAAE,OAAO,CAAC,KAAK,SAAS,KAAK,UAAU,MAAM,CAAC,MAAM,GAAGc,EAAE,OAAO,QAAQ,MAAM,EAAE,QAAQG,CAAC,EAAE,kBAAkB,CAAC,CAAC,CAAC,EAAEI,EAAEtB,GAAG,CAAC,GAAG,CAACG,GAAE,SAASH,CAAC,EAAE,MAAM,CAAC,QAAQ,GAAG,MAAM,mBAAmB,EAAE,MAAMC,EAAEmB,EAAE,OAAQnB,GAAG,CAACD,EAAEC,CAAC,CAAE,EAAE,OAAOA,EAAE,OAAO,EAAE,CAAC,QAAQ,GAAG,MAAM,iBAAiBA,EAAE,KAAK,IAAI,GAAG,EAAE,CAAC,QAAQ,EAAE,CAAC,EAAE,CAAC,gBAAgBsB,CAAC,EAAEtB,EAAE,YAAY,IAAIuB,GAAG,SAASxB,EAAE,CAACA,EAAE,KAAK,OAAOA,EAAE,IAAI,KAAK,GAAEwB,IAAIA,EAAE,CAAC,EAAE,EAAE,MAAMC,EAAE,CAAC,CAAC,QAAQvB,EAAE,QAAQC,EAAE,gBAAgBC,EAAE,UAAUE,EAAE,WAAWC,CAAC,IAAI,CAAC,IAAIC,EAAE,KAAK,CAACC,EAAEI,CAAC,EAAER,EAAE,QAAQ,UAAUL,GAAG,mBAAmBA,GAAQA,EAAE,iBAAP,GAAsBwB,EAAE,KAAKA,EAAE,KAAKtB,EAAE,QAAQ,CAAC,EAAEY,EAAEb,GAAGD,EAAE,iCAAiC,CAAC,QAAQE,EAAE,gBAAgBE,CAAC,EAAEH,CAAC,EAAEgB,EAAE,IAAI,CAACR,IAAIe,EAAE,IAAIX,EAAEW,EAAE,IAAI,EAAEX,EAAEW,EAAE,GAAG,CAAC,EAAEJ,EAAEnB,EAAE,UAAU,EAAEoB,EAAEhB,EAAE,QAAQ,cAAc,OAAO,KAAKI,IAAIe,EAAE,KAAKnB,EAAE,QAAQ,cAAc,IAAI,CAAC,UAAU,gBAAgB,QAAQY,EAAE,cAAcE,CAAC,EAAE,mBAAmB,EAAE,oBAAoB,IAAI,UAAOV,IAAIe,EAAE,IAAInB,EAAE,QAAQ,cAAc,IAAI,CAAC,UAAU,gBAAgB,QAAQY,EAAE,cAAcC,CAAC,EAAE,8BAA8B,EAAE,kCAAkC,EAAEI,EAAE,CAAC,aAAa,EAAQpB,EAAE,iBAAiB,WAAY,QAAeM,EAAEN,EAAE,kBAAZ,MAAsCM,IAAT,OAAW,OAAOA,EAAE,aAAa,GAAG,YAAY,oBAAoB,QAAQ,IAAIL,EAAE,EAAE,SAASH,EAAE,uCAAuC,CAAC,QAAQE,EAAE,gBAAgBE,CAAC,EAAE,YAAY,EAAE,cAAcY,CAAC,EAAE,OAAOX,EAAE,QAAQ,cAAc,MAAM,CAAC,cAAcO,EAAC,EAAEP,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,MAAM,YAAY,EAAEI,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,GAAG,iBAAiB,MAAM,GAAG,MAAMC,EAAE,SAAS,gBAAgB,GAAG,SAASY,EAAE,gBAAgB,CAAC,CAAC,CAAC,EAAET,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,MAAM,cAAc,EAAEI,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,MAAM,GAAG,GAAG,cAAc,MAAMC,EAAE,SAAS,aAAa,GAAG,SAASY,EAAE,aAAa,CAAC,CAAC,CAAC,EAAET,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,MAAM,WAAW,EAAEI,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,MAAM,GAAG,GAAG,WAAW,MAAMC,EAAE,SAAS,UAAU,GAAG,SAASY,EAAE,UAAU,CAAC,CAAC,CAAC,EAAEL,IAAIe,EAAE,MAAMnB,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,MAAM,mBAAmB,YAAYoB,CAAC,EAAEhB,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,MAAM,GAAG,GAAG,iBAAiB,MAAMC,EAAE,SAAS,gBAAgB,GAAG,YAAY,gEAAgE,SAASY,EAAE,gBAAgB,EAAE,cAAcC,CAAC,CAAC,CAAC,EAAEN,IAAIe,EAAE,KAAKnB,EAAE,QAAQ,cAAcA,EAAE,QAAQ,SAAS,KAAKJ,EAAE,YAAYI,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,MAAM,cAAc,YAAYoB,CAAC,EAAEhB,EAAE,QAAQ,cAAcJ,EAAE,YAAY,OAAO,OAAO,CAAC,EAAEqB,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,EAAEjB,EAAE,QAAQ,cAAckB,EAAE,OAAO,OAAO,CAAC,EAAED,EAAE,CAAC,MAAM,cAAc,WAAW,GAAG,WAAW,EAAE,CAAC,CAAC,CAAC,EAAEjB,EAAE,QAAQ,cAAcA,EAAE,QAAQ,SAAS,KAAKA,EAAE,QAAQ,cAAcJ,EAAE,OAAO,CAAC,cAAcS,EAAE,KAAK,SAAS,KAAK,UAAU,MAAM,CAAC,MAAM,GAAGU,EAAE,OAAO,QAAQ,MAAM,EAAE,QAAQd,CAAC,EAAE,iBAAiB,EAAED,EAAE,QAAQ,cAAc,OAAO,CAAC,MAAM,CAAC,aAAa,OAAO,YAAY,MAAM,CAAC,EAAE,IAAI,EAAEA,EAAE,QAAQ,cAAcJ,EAAE,OAAO,CAAC,cAAcU,EAAE,KAAK,SAAS,KAAK,UAAU,MAAM,CAAC,MAAM,GAAGS,EAAE,OAAO,QAAQ,MAAM,EAAE,QAAQb,CAAC,EAAE,kBAAkB,CAAC,CAAC,CAAC,EAAE,SAASmB,EAAEvB,EAAE,CAAC,KAAK,CAAC,QAAQC,EAAE,gBAAgBG,EAAE,YAAYC,CAAC,EAAEL,EAAE,CAAC,SAASM,EAAE,iBAAiBC,EAAE,eAAeC,CAAC,EAAEP,EAAEQ,EAAE,IAAI,GAAQH,EAAE,aAAaA,EAAE,gBAAgBA,EAAE,WAAWC,GAAGA,EAAE,YAAYD,EAAE,iBAAiBA,EAAE,qBAAqBA,EAAE,mBAAmBH,EAAE,KAAK,KAAK,CAACO,EAAEC,CAAC,EAAEZ,EAAE,SAASyB,GAAElB,EAAE,kBAAkB,CAAC,EAAE,CAACM,EAAEC,CAAC,EAAEd,EAAE,SAASU,EAAE,CAAC,EAAE,CAACK,EAAEC,CAAC,EAAEhB,EAAE,SAAS,EAAE,EAAE,CAACiB,EAAEC,CAAC,EAAElB,EAAE,SAAS,EAAE,EAAEoB,GAAE,IAAI,CAACJ,EAAE,EAAE,EAAEE,EAAE,EAAE,EAAEJ,EAAE,EAAE,CAAC,EAAEO,GAAE,IAAI,CAACL,EAAE,EAAE,EAAEE,EAAE,EAAE,EAAEJ,EAAE,EAAE,CAAC,EAAE,OAAOX,EAAE,QAAQ,cAAcA,EAAE,QAAQ,SAAS,KAAKA,EAAE,QAAQ,cAAcJ,EAAE,SAAS,CAAC,MAAM,gBAAgB,EAAEI,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,MAAM,qBAAqB,EAAEI,EAAE,QAAQ,cAAcJ,EAAE,iBAAiB,CAAC,QAAQO,EAAE,MAAMC,EAAE,oBAAoBH,EAAE,IAAI,SAASN,GAAG,CAACgB,EAAEJ,EAAE,CAAC,EAAEL,EAAE,OAAO,OAAO,OAAO,OAAO,CAAC,EAAEH,CAAC,EAAE,CAAC,SAAS,OAAO,OAAO,OAAO,OAAO,CAAC,EAAEA,EAAE,QAAQ,EAAE,CAAC,mBAAmBJ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAEc,EAAEa,GAAE3B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAEa,GAAGR,EAAE,QAAQ,cAAcJ,EAAE,SAAS,CAAC,MAAM,iBAAiB,EAAEc,EAAEV,EAAE,QAAQ,cAAcoB,EAAE,CAAC,QAAQrB,EAAE,QAAQ,KAAKJ,GAAG,CAAC,MAAMC,EAAE,OAAO,OAAO,CAAC,EAAEU,CAAC,EAAET,EAAEF,EAAE,OAAO,OAAO,OAAO,OAAO,CAAC,EAAEI,EAAE,QAAQ,EAAEJ,CAAC,EAAE,OAAO,OAAO,CAAC,EAAEI,EAAE,QAAQ,EAAE,OAAOF,EAAE,YAAY,OAAOA,EAAE,eAAe,OAAOA,EAAE,SAAS,OAAOA,EAAE,eAAe,OAAOD,EAAE,WAAWa,EAAE,EAAE,EAAEE,EAAE,EAAE,EAAET,EAAE,OAAO,OAAO,OAAO,OAAO,CAAC,EAAEH,CAAC,EAAE,CAAC,iBAAiB,OAAO,OAAO,OAAO,OAAO,CAAC,EAAEA,EAAE,gBAAgB,EAAE,CAAC,WAAW,EAAE,CAAC,EAAE,eAAeH,EAAE,SAASC,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,gBAAgBK,EAAE,WAAWe,GAAE,UAAUC,EAAC,CAAC,EAAElB,EAAE,QAAQ,cAAcgB,EAAE,CAAC,iBAAiB,IAAI,CAACL,EAAE,EAAE,CAAC,EAAE,WAAWM,GAAE,UAAUC,GAAE,UAAUN,EAAE,YAAYE,EAAE,SAASnB,GAAG,CAACO,EAAE,OAAO,OAAO,OAAO,OAAO,CAAC,EAAEH,CAAC,EAAE,CAAC,iBAAiB,OAAO,OAAO,OAAO,OAAO,CAAC,EAAEM,CAAC,EAAE,CAAC,WAAW,EAAE,CAAC,EAAE,eAAe,OAAO,OAAO,OAAO,OAAO,CAAC,EAAEC,CAAC,EAAE,CAAC,WAAWX,EAAE,UAAU,CAAC,EAAE,SAAS,OAAO,OAAO,OAAO,OAAO,CAAC,EAAES,CAAC,EAAE,CAAC,YAAYT,EAAE,YAAY,eAAeA,EAAE,UAAU,SAASA,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,GAAG,EAAES,EAAE,qBAAqBH,EAAE,KAAKD,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,MAAM,iBAAiB,EAAEI,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,GAAG,iBAAiB,MAAM,GAAG,MAAMG,EAAE,SAAS,gBAAgB,GAAG,SAASJ,EAAE,iCAAiCG,EAAE,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAMwB,GAAE3B,GAAGA,IAAIM,EAAE,KAAcN,IAAT,OAAW4B,GAAE,CAAC,CAAC,MAAM,kBAAkB,MAAMtB,EAAE,IAAI,UAAUO,EAAC,EAAE,CAAC,MAAM,8BAA8B,MAAMP,EAAE,IAAI,UAAUQ,EAAC,CAAC,EAAE,EAAmBY,EAAEG,EAAQ,iBAAiB7B,GAAG,CAAC,KAAK,CAAC,QAAQ,CAAC,SAASE,CAAC,CAAC,EAAEF,EAAEE,EAAE,qBAAqBA,EAAE,mBAAmBI,EAAE,KAAK,MAAMH,EAAED,EAAE,qBAAqBI,EAAE,KAAcJ,EAAE,qBAAX,OAA8B,OAAOG,EAAE,QAAQ,cAAcA,EAAE,QAAQ,SAAS,KAAKA,EAAE,QAAQ,cAAcqB,EAAE,OAAO,OAAO,CAAC,YAAYE,EAAC,EAAE5B,CAAC,CAAC,EAAEK,EAAE,QAAQ,cAAc,MAAM,CAAC,UAAU,mBAAmB,MAAM,CAAC,UAAU,MAAM,EAAE,cAAcE,EAAC,EAAEF,EAAE,QAAQ,cAAc,IAAI,KAAK,+FAA0F,IAAIA,EAAE,QAAQ,cAAc,IAAI,CAAC,UAAU,gBAAgB,OAAO,SAAS,IAAI,sBAAsB,KAAK,oGAAoG,EAAE,uBAAuB,CAAC,CAAC,EAAE,CAACF,GAAGE,EAAE,QAAQ,cAAcJ,EAAE,MAAM,CAAC,MAAM,GAAG,SAAS,MAAM,EAAE,4DAA4D,CAAC,CAAC,EAAE,EAAiC2B,GAAE,EAAuBtB,EAAE,EAAwBe,EAAE,EAAgBI,C,gCCGrxRK,GAAO,QAAU,EAAjB,K,mICIa,MAAMC,UAAkC,eAGrD,CACA,QAAS,CACP,OACE,gBAAC,WACC,gBAAC,UAAG,iCAA+B,EACnC,gBAAC,WACC,gBAAC,SAAE,mIAGH,EAAI,WAEJ,gBAAC,YAAM,kDAAwD,EAC/D,gBAAC,SAAG,EAAE,mBACc,gBAAC,YAAK,wCAAsC,EAChE,gBAAC,SAAG,EACJ,gBAAC,SAAG,EACJ,gBAAC,YAAK,WAAS,EACf,gBAAC,SAAG,EACJ,gBAAC,MACC,aAAW;AAAA;AAAA,eAIX,gBAAC,UACC,gBAAC,YAAM,iBAAuB,EAAO,oEACvC,EACA,gBAAC,UACC,gBAAC,YAAM,iBAAuB,EAAO,qDACvC,EACA,gBAAC,UACC,gBAAC,YAAM,oBAA0B,EAAO,wCAC1C,EACA,gBAAC,UACC,gBAAC,YAAM,6BAAmC,EAAO,0DACnD,EACA,gBAAC,UACC,gBAAC,YAAM,+BAAqC,EAAO,qDACrD,EACA,gBAAC,UACC,gBAAC,YAAM,iCAAuC,EAAO,yHAEvD,EACA,gBAAC,UACC,gBAAC,YAAM,+BAAqC,EAAO,qHAErD,EACA,gBAAC,UACC,gBAAC,YAAM,YAAkB,EAAO,6EAElC,EACA,gBAAC,UACC,gBAAC,YAAM,aAAmB,EAAO,4DACnC,EACA,gBAAC,UACC,gBAAC,YAAM,aAAmB,EAAO,8DACnC,EACA,gBAAC,UACC,gBAAC,YAAM,SAAe,EAAO,0DAC/B,EACA,gBAAC,UACC,gBAAC,YAAM,cAAoB,EAAO,qEACpC,CACF,CACF,CACF,CAEJ,CACF,C,oFCjEO,MAAMC,WAAqB,eAAqB,CAAhD,kCACL,2BAAyBC,GAA8B,EACjDA,EAAQ,SAAS,gBAAkBA,EAAQ,iBAAiB,gBAC9D,MAAkB,0CAA2C,CAC3D,mBAAoB,MACpB,WAAYA,EAAQ,iBAAiB,WACrC,eAAgB,CAAC,CAACA,EAAQ,SAAS,cACrC,CAAC,EAEH,KAAK,MAAM,gBAAgBA,CAAO,CACpC,EAEA,QAAS,CACP,KAAM,CAAE,QAAAA,EAAS,gBAAAC,CAAgB,EAAI,KAAK,MAC1C,OACE,gCACE,gBAACC,EAAA,GACC,eAAe,0BACf,SAAS,+EACT,kBAAiB,GACnB,EACA,gBAACC,EAAA,EAAO,IAAC,EACT,gBAAC,oBAAgB,CAAE,GAAG,KAAK,MAAO,gBAAiB,KAAK,sBAAuB,EAC9EC,EAAA,EAAO,2BACN,gCACE,gBAACD,EAAA,EAAO,IAAC,EACT,gBAACE,GAAA,GACC,MAAM,sBACN,YAAY,6IACZ,cAAe,GACf,gBAAiBL,EAAQ,SAAS,yBAA2B,QAE7D,gBAACM,GAAA,EAAwB,CAAC,QAAAN,EAAkB,gBAAAC,CAAA,CAAkC,CAChF,CACF,CAEJ,CAEJ,CACF,C,4DC3BO,MAAMM,UAA2C,eAAwC,CAgC9F,YAAYC,EAAc,CACxB,MAAMA,CAAK,EAhCb,gBAAsD,CACpD,CAAE,MAAO,KAAqB,SAAU,MAAO,UAAW,EAC1D,CAAE,MAAO,KAAqB,SAAU,MAAO,UAAW,EAC1D,CAAE,MAAO,KAAqB,YAAa,MAAO,cAAe,EACjE,CAAE,MAAO,KAAqB,UAAW,MAAO,YAAa,EAC7D,CAAE,MAAO,KAAqB,YAAa,MAAO,cAAe,EACjE,CAAE,MAAO,KAAqB,cAAe,MAAO,gBAAiB,EACrE,CAAE,MAAO,KAAqB,aAAc,MAAO,cAAe,EAClE,CAAE,MAAO,KAAqB,SAAU,MAAO,UAAW,EAC1D,CAAE,MAAO,KAAqB,iBAAkB,MAAO,mBAAoB,EAC3E,CAAE,MAAO,KAAqB,UAAW,MAAO,WAAY,EAC5D,CAAE,MAAO,KAAqB,YAAa,MAAO,cAAe,EACjE,CAAE,MAAO,KAAqB,IAAK,MAAO,gCAAiC,CAC7E,EAEA,cAA8B,CAC5B,kBAAmB,KAAK,WAAW,CAAC,EAAE,MACtC,kBAAmB,CAAC,EACpB,gBAAiB,GACjB,mBAAoB,GACpB,OAAQ,CAAC,EACT,SAAU,GACV,YAAa,CAAC,EACd,SAAU,CAAC,EACX,YAAa,CAAC,EACd,mBAAoB,GACpB,SAAU,CAAC,EACX,YAAa,GACb,QAAS,EACX,EAkDA,mBAAgB,IAAM,CACpB,KAAM,CAAE,kBAAAC,EAAmB,OAAAC,EAAQ,YAAAC,EAAa,SAAAC,EAAU,GAAGC,CAAW,EAAI,KAAK,MACjF,KAAK,MAAM,SAAS,CAAE,GAAGA,EAAY,MAAO,kDAAmD,CAAC,CAClG,EAjDE,KAAK,MAAQ,OAAO,OAAO,KAAK,SAAU,KAAK,MAAM,KAAK,CAC5D,CAEA,MAAM,mBAAoB,CACxB,MAAM,KAAK,MAAM,WAAW,wBAAwB,EACpD,MAAMC,EAAc,KAAK,MAAM,MAAM,aAAe,KAAK,MAAM,WAAW,kBAAkB,EACtFC,EAAY,MAAM,KAAK,MAAM,WAAW,YAAY,EACpDN,EAAoB,MAAM,KAAK,MAAM,WAAW,eACpD,KAAK,MAAM,MAAM,aAAe,KAAK,MAAM,WAAW,kBAAkB,CAC1E,EACMG,KAAW,MAAqCH,CAAiB,EAAE,IAAK5B,IAAO,CACnF,MAAOA,EAAE,QACT,MAAOA,EAAE,gBACX,EAAE,EAEF,IAAImC,EAAkB,GAClBJ,EAAS,KAAMrC,GAAMA,EAAE,WAAU,KAAe,EAAE,QAAQ,KAAK,MAAM,eAAe,CAAC,EACvFyC,EAAkB,KAAK,MAAM,gBACpBJ,GAAYA,EAAS,OAAS,IACvCI,EAAkBJ,EAAS,CAAC,EAAE,OAGhC,KAAM,CAAE,YAAAD,EAAa,mBAAAM,CAAmB,KAAI,MAC1CR,EACA,KAAK,MAAM,sBACX,KAAe,EAAE,QAAQ,KAAK,MAAM,kBAAkB,KACtD,KAAe,EAAE,QAAQO,CAAe,CAC1C,EAEME,EAAc,MAAM,KAAK,MAAM,WAAW,eAAeJ,CAAW,EAEpEK,EAAQ,CACZ,SAAAP,EACA,gBAAAI,EACA,YAAAL,EACA,mBAAAM,EACA,kBAAAR,EACA,SAAAM,EACA,GAAI,MAAM,KAAK,UAAUE,EAAoBH,CAAW,EACxD,YAAAI,EACA,QAAS,GACT,YAAAJ,CACF,EACA,KAAK,SAASK,EAAO,IAAM,KAAK,cAAc,CAAC,CACjD,CAOA,MAAM,kBAAkBC,EAAmB,CACzC,MAAMD,EAAQ,CACZ,kBAAmBC,EACnB,GAAI,MAAM,KAAK,UAAU,KAAK,MAAM,mBAAoB,KAAK,MAAM,YAAaA,CAAS,CAC3F,EAEA,KAAK,SAASD,CAAK,CACrB,CAEA,MAAM,gBAAgBL,EAAqB,CACzC,MAAML,EAAoB,MAAM,KAAK,MAAM,WAAW,eAAeK,CAAW,EAC1EJ,EAAS,MAAM,KAAK,UAAU,KAAK,MAAM,mBAAoBI,CAAW,EACxE,CAAE,YAAAH,EAAa,mBAAAM,CAAmB,KAAI,MAC1CR,EACA,KAAK,MAAM,sBACX,KAAe,EAAE,QAAQ,KAAK,MAAM,kBAAkB,KACtD,KAAe,EAAE,QAAQ,KAAK,MAAM,eAAe,CACrD,EAEMS,EAAc,MAAM,KAAK,MAAM,WAAW,eAAeJ,CAAW,EAE1E,KAAK,SACH,CACE,GAAGJ,EACH,YAAAC,EACA,mBAAAM,EACA,kBAAAR,EACA,YAAAK,EACA,YAAAI,CACF,EACA,IAAM,KAAK,cAAc,CAC3B,CACF,CAEA,MAAM,gBAAgBG,EAAiB,CACrC,KAAM,CAAE,YAAAV,EAAa,mBAAAM,CAAmB,KAAI,MAC1C,KAAK,MAAM,kBACX,KAAK,MAAM,sBACX,KAAe,EAAE,QAAQ,KAAK,MAAM,kBAAkB,KACtD,KAAe,EAAE,QAAQI,CAAO,CAClC,EACMF,EAAQ,CACZ,gBAAiBE,EACjB,YAAAV,EACA,mBAAAM,EACA,GAAI,MAAM,KAAK,UAAUA,EAAoB,KAAK,MAAM,WAAW,CACrE,EACA,KAAK,SAASE,EAAO,IAAM,KAAK,cAAc,CAAC,CACjD,CAEA,MAAM,mBAAmBG,EAAoB,CAC3C,MAAMH,EAAQ,CACZ,mBAAoBG,EACpB,GAAI,MAAM,KAAK,UAAUA,EAAY,KAAK,MAAM,WAAW,CAC7D,EACA,KAAK,SAASH,EAAO,IAAM,KAAK,cAAc,CAAC,CACjD,CAEA,iBAAiBI,EAAkB,CACjC,KAAK,SAAS,CAAE,SAAAA,CAAS,EAAG,IAAM,KAAK,cAAc,CAAC,CACxD,CAEA,mBAAmBC,EAA4BC,EAAwC,CACrF,MAAMC,EAAwBD,EAAU,oBAAsB,KAAK,MAAM,kBACnEE,EAA0B,KAAK,MAAM,qBAAuBF,EAAU,oBACxEC,GAAyBC,IAC3B,KAAK,cAAc,CAEvB,CAEA,MAAM,UAAUV,EAA4BH,EAAqBc,EAAoB,KAAK,MAAM,kBAAmB,CACjH,IAAIC,EAAS,CAAE,OAAQ,KAAK,MAAM,OAAQ,SAAU,KAAK,MAAM,QAAS,EACxE,GAAIZ,GAAsBW,IAAsB,KAAqB,YAAa,CAChF,MAAMlB,EAAS,QAAM,MAAa,KAAK,MAAM,WAAYO,EAAoBH,CAAW,EAClFS,EAAWb,EAAO,KAAMvC,GAAMA,OAAM,KAAe,EAAE,QAAQ,KAAK,MAAM,QAAQ,CAAC,EACnF,KAAK,MAAM,SACXuC,EAAO,CAAC,EACZmB,EAAS,CAAE,OAAAnB,EAAQ,SAAAa,CAAS,EAE9B,OAAOM,CACT,CAEA,sBAAsBT,EAAmB,CACvC,MAAMU,EAAsB,CAC1B,MAAO,qBACP,SAAU,GACV,WAAS,KAAe,EACrB,aAAa,EACb,IAAK3C,IAAO,CACX,MAAO,IAAIA,EAAE,OACb,MAAO,IAAIA,EAAE,MACf,EAAE,CACN,EAEA,OAAQiC,EAAW,CACjB,KAAK,KAAqB,YACxB,OACE,gCACE,gBAAC,MACC,iBAAkB,GAClB,MAAO,KAAK,MAAM,YAClB,QAAS,CAACU,EAAqB,GAAG,KAAK,MAAM,QAAQ,EACrD,SAAWC,GAAU,KAAK,gBAAgBA,CAAK,EAC/C,MAAM,UACR,EACA,gBAAC,MACC,MAAO,KAAK,MAAM,gBAClB,QAAS,CAACD,EAAqB,GAAG,KAAK,MAAM,QAAQ,EACrD,SAAWC,GAAU,KAAK,gBAAgBA,CAAK,EAC/C,MAAM,UACR,CACF,EAEJ,KAAK,KAAqB,UAC1B,KAAK,KAAqB,YAC1B,KAAK,KAAqB,cACxB,OACE,gCACE,gBAAC,MACC,iBAAkB,GAClB,MAAO,KAAK,MAAM,YAClB,QAAS,CAACD,EAAqB,GAAG,KAAK,MAAM,QAAQ,EACrD,SAAWC,GAAU,KAAK,gBAAgBA,CAAK,EAC/C,MAAM,UACR,EACA,gBAAC,MACC,MAAO,KAAK,MAAM,gBAClB,QAAS,CAACD,EAAqB,GAAG,KAAK,MAAM,QAAQ,EACrD,SAAWC,GAAU,KAAK,gBAAgBA,CAAK,EAC/C,MAAM,UACR,EACA,gBAAC,MACC,MAAO,KAAK,MAAM,mBAClB,QAAS,CACPD,EACA,GAAG,KAAK,MAAM,YAAY,IAAI,CAAC,CAAE,MAAAC,EAAO,KAAAC,CAAK,KAAO,CAAE,MAAAD,EAAO,MAAOC,CAAK,EAAE,CAC7E,EACA,SAAWD,GAAU,KAAK,mBAAmBA,CAAK,EAClD,MAAM,cACR,EACCX,IAAc,KAAqB,aAClC,gBAAC,MACC,MAAO,KAAK,MAAM,SAClB,QAAS,CAACU,EAAqB,GAAG,KAAK,MAAM,OAAO,IAAK3D,IAAO,CAAE,MAAOA,EAAG,MAAOA,CAAE,EAAE,CAAC,EACxF,SAAW4D,GAAU,KAAK,iBAAiBA,CAAK,EAChD,MAAM,YACR,CAEJ,EAEJ,KAAK,KAAqB,SAC1B,KAAK,KAAqB,aACxB,OACE,gCACE,gBAAC,MACC,MAAO,KAAK,MAAM,gBAClB,QAAS,CAACD,EAAqB,GAAG,KAAK,MAAM,QAAQ,EACrD,SAAWC,GAAU,KAAK,gBAAgBA,CAAK,EAC/C,MAAM,UACR,EACA,gBAAC,MACC,MAAO,KAAK,MAAM,mBAClB,QAAS,CACPD,EACA,GAAG,KAAK,MAAM,YAAY,IAAI,CAAC,CAAE,MAAAC,EAAO,KAAAC,CAAK,KAAO,CAAE,MAAAD,EAAO,MAAOC,CAAK,EAAE,CAC7E,EACA,SAAWD,GAAU,KAAK,mBAAmBA,CAAK,EAClD,MAAM,cACR,CACF,EAEJ,KAAK,KAAqB,YACxB,OACE,gCACE,gBAAC,MACC,iBAAkB,GAClB,MAAO,KAAK,MAAM,YAClB,QAAS,CAACD,EAAqB,GAAG,KAAK,MAAM,QAAQ,EACrD,SAAWC,GAAU,KAAK,gBAAgBA,CAAK,EAC/C,MAAM,UACR,CACF,EAGJ,KAAK,KAAqB,IACxB,OACE,gCACE,gBAAC,MACC,iBAAkB,GAClB,MAAO,KAAK,MAAM,YAClB,QAAS,CAACD,EAAqB,GAAG,KAAK,MAAM,QAAQ,EACrD,SAAWC,GAAU,KAAK,gBAAgBA,CAAK,EAC/C,MAAM,UACR,EACA,gBAAC,MACC,MAAO,KAAK,MAAM,mBAClB,QAAS,CAACD,EAAqB,GAAG,KAAK,MAAM,WAAW,EACxD,SAAWC,GAAU,CACnB,KAAK,SAAS,CACZ,GAAG,KAAK,MACR,mBAAoBA,CACtB,CAAC,CACH,EACA,MAAM,cACR,CACF,EAEJ,QACE,MAAO,EACX,CACF,CAEA,QAAS,CACP,OAAI,KAAK,MAAM,QAEX,gBAAC,MACC,MAAO,UACP,QAAS,CAAC,CAAE,MAAO,UAAW,MAAO,YAAa,CAAC,EACnD,SAAWA,GAAU,KACrB,MAAM,aACR,EAKF,gCACE,gBAAC,MACC,MAAO,KAAK,MAAM,kBAClB,QAAS,KAAK,WACd,SAAWA,GAAU,KAAK,kBAAkBA,CAAK,EACjD,MAAM,aACR,EACC,KAAK,sBAAsB,KAAK,MAAM,iBAAiB,CAC1D,CAEJ,CACF,C,2KCxUO,MAAME,EAA2EC,IAAgB,CACtG,MAAG,MAAsBA,CAAU,EACnC,MAAO,GACP,KAAM,EACR,GAEaC,EAAyB3B,GAAiB,CACrD,KAAM,CAAE,WAAA0B,EAAY,MAAAE,EAAO,WAAAC,EAAY,KAAAC,EAAM,SAAAC,EAAU,MAAAC,CAAM,EAAIhC,EAE3DiC,GADOH,GAAM,OAAO,OAASA,GAAM,OAAO,CAAC,EAAE,KAAO,CAAC,IAC9B,QAAU,CAAC,EAClCI,EAAiB,CAAE,GAAGT,EAAaC,CAAU,EAAG,GAAGE,EAAM,cAAe,EACxE,CAACO,EAAOC,CAAQ,KAAI,YAASF,EAAe,OAAS,EAAE,EACvD,CAACG,EAAMC,CAAO,KAAI,YAASJ,EAAe,MAAQ,EAAE,EACpDZ,GAAsB,CAC1B,MAAO,qBACP,QAASI,EAAW,aAAa,EAAE,IAAI,GAAQ,CACjD,EAEMa,GAAqBhF,IAA2C,CACpE6E,EAAS7E,GAAE,OAAO,KAAK,CACzB,EACMiF,GAAoBjF,IAA2C,CACnE+E,EAAQ/E,GAAE,OAAO,KAAK,CACxB,EAEA,SAAAkF,EAAA,GACE,IAAM,CACJV,EAAS,CAAE,GAAGH,EAAO,eAAgB,CAAE,GAAGM,EAAgB,MAAAC,CAAM,CAAE,CAAC,CACrE,EACA,IACA,CAACA,EAAOJ,CAAQ,CAClB,KACAU,EAAA,GACE,IAAM,CACJV,EAAS,CAAE,GAAGH,EAAO,eAAgB,CAAE,GAAGM,EAAgB,KAAAG,CAAK,CAAE,CAAC,CACpE,EACA,IACA,CAACA,EAAMN,CAAQ,CACjB,KAGA,aAAU,IAAM,EACV,CAACH,EAAM,WAAa,CAAC,OAAO,OAAO,IAAS,EAAE,SAASA,EAAM,SAAS,IACxEG,EAAS,CAAE,GAAGH,EAAO,UAAW,KAAU,gBAAiB,CAAC,CAEhE,CAAC,EAGC,gBAACc,EAAA,EAAU,KACT,gCACE,gBAACC,EAAA,IACC,MAAOf,EAAM,MACb,oBAAAN,GACA,eAAAW,EACA,SAAAF,EACA,WAAAF,EACA,WAAAH,EACA,MAAAE,EACA,MAAOI,MAAS,MAAoB,EACtC,EACA,gBAACY,EAAA,EAAW,CAAC,MAAM,QAAQ,QAAQ,0BACjC,gBAACC,EAAA,EAAK,CAAC,GAAG,yBAAyB,MAAOV,EAAO,SAAUI,EAAA,CAAmB,CAChF,EACA,gBAACK,EAAA,EAAW,CAAC,MAAM,OAAO,QAAQ,yBAChC,gBAACC,EAAA,EAAK,CAAC,GAAG,wBAAwB,MAAOR,EAAM,SAAUG,EAAA,CAAkB,CAC7E,CACF,EACA,gBAAC,KAAe,IAAC,CACnB,CAEJ,EC9EMM,EACJlB,GAECA,EAAgE,QAAQ,QAAU,QAClFA,EAAgE,QAAQ,OAAS,OAEvEmB,EAEmCC,IACvC,CACL,kBACEpB,GAC0C,CAC1C,GAAI,CAACkB,EAAkClB,CAAK,EAC1C,OAAOA,EAGT,KAAM,CAAE,OAAAqB,EAAQ,KAAAzB,EAAM,UAAA0B,CAAU,EAAItB,EAC9B,CAAE,OAAAuB,CAAO,EAAIvB,EAoBnB,MAnBsD,CACpD,WAAYA,EAAM,WAClB,OAAAqB,EACA,KAAAzB,EACA,UAAA0B,EACA,OAAQ,CACN,WAAYF,EAAG,WACf,MAAOG,GAAQ,OAAS,kBACxB,UAAW,KAAU,WACrB,eAAgB,CACd,YAAaA,GAAQ,aAAeH,EAAG,kBAAkB,EACzD,QAASG,GAAQ,SAAW,CAAC,EAC7B,mBAAoB,cACpB,iBAAkB,KAAe,WACjC,MAAOA,GAAQ,OAAS,GACxB,KAAMA,GAAQ,MAAQ,EACxB,CACF,CACF,CAEF,EACA,aAAeC,GAAgD,CAC7D,GAAKA,EAAK,OAIV,MAAO,CACL,GAAGA,EAAK,OACR,UAAW,KAAU,WACrB,KAAM,iBACR,CACF,EACA,YAAazB,CACf,G,0BC/Ca,MAAM0B,CAA+B,CAClD,YAAoB3B,EAAuC,CAAvC,gBAAAA,CAAwC,CAE5D,MAAM,QAAQE,EAAqC,CACjD,GAAI,CAKF,OAJKA,EAAM,cACTA,EAAM,YAAc,KAAK,WAAW,kBAAkB,GAGhDA,EAAM,kBAAmB,CAC/B,KAAK,KAAqB,SACxB,OAAO,KAAK,oBAAoB,EAClC,KAAK,KAAqB,SACxB,OAAO,KAAK,mBAAmBA,CAAK,EACtC,KAAK,KAAqB,YACxB,OAAO,KAAK,uBAAuBA,CAAK,EAC1C,KAAK,KAAqB,UACxB,OAAO,KAAK,qBAAqBA,CAAK,EACxC,KAAK,KAAqB,YACxB,OAAO,KAAK,uBAAuBA,CAAK,EAC1C,KAAK,KAAqB,cACxB,OAAO,KAAK,wBAAwBA,CAAK,EAC3C,KAAK,KAAqB,SACxB,OAAO,KAAK,oBAAoBA,CAAK,EACvC,KAAK,KAAqB,iBACxB,OAAO,KAAK,2BAA2B,EACzC,KAAK,KAAqB,aACxB,OAAO,KAAK,uBAAuBA,CAAK,EAC1C,KAAK,KAAqB,YACxB,OAAO,KAAK,uBAAuBA,CAAK,EAC1C,KAAK,KAAqB,IACxB,OAAO,KAAK,eAAeA,CAAK,EAClC,KAAK,KAAqB,UACxB,OAAO,KAAK,oBAAoB,EAClC,QACE,MAAO,CAAC,CACZ,CACF,OAAS0B,EAAP,CACA,eAAQ,MAAM,gDAAgD1B,IAAS0B,CAAK,EACrE,CAAC,CACV,CACF,CAEA,MAAM,qBAAsB,CAE1B,OADiB,MAAM,KAAK,WAAW,YAAY,GACnC,IAAKvF,IAAO,CAC1B,KAAMA,EAAE,MACR,MAAOA,EAAE,MACT,WAAY,EACd,EAAE,CACJ,CAEA,MAAM,mBAAmB,CAAE,YAAAuC,CAAY,EAAiC,CACtE,MAAML,EAAoB,MAAM,KAAK,WAAW,eAAeK,CAAW,EAE1E,SADqC,MAAqCL,CAAiB,EAC3E,IAAKlC,IAAO,CAC1B,KAAMA,EAAE,iBACR,MAAOA,EAAE,QACT,WAAY,EACd,EAAE,CACJ,CAEA,MAAM,uBAAuB,CAAE,gBAAAyC,EAAiB,YAAAF,CAAY,EAAiC,CAC3F,GAAI,CAACE,EACH,MAAO,CAAC,EAEV,MAAMP,EAAoB,MAAM,KAAK,WAAW,eAAeK,CAAW,EAC1E,SAAO,MAAwBL,EAAmB,KAAK,WAAW,YAAY,QAAQO,CAAe,CAAC,EAAE,IACrGzC,IAAO,CACN,KAAMA,EAAE,YACR,MAAOA,EAAE,KACT,WAAY,EACd,EACF,CACF,CAEA,MAAM,qBAAqB,CAAE,mBAAA0C,EAAoB,YAAAH,CAAY,EAAiC,CAC5F,OAAKG,GAGa,QAAM,MAAa,KAAK,WAAYA,EAAoBH,CAAW,GACpE,IAAI,KAAK,iBAAiB,EAHlC,CAAC,CAIZ,CAEA,MAAM,uBAAuB,CAAE,mBAAAG,EAAoB,SAAAM,EAAU,YAAAT,CAAY,EAAiC,CACxG,GAAI,CAACG,EACH,MAAO,CAAC,EAEV,MAAM8C,EAAQ,yBAERrD,EAAS,MAAM,KAAK,WAAW,UAAUO,EAAoB8C,EAAOjD,EAAa,CACrF,SAAU,CAACS,CAAQ,EACnB,mBAAoB,aACtB,CAAC,EACKyC,EAAkB,KAAK,WAAW,YAAY,QAAQzC,CAAQ,EAEpE,OADeb,EAAO,eAAesD,CAAe,EAAItD,EAAOsD,CAAe,EAAI,CAAC,GACrE,IAAI,KAAK,iBAAiB,CAC1C,CAEA,MAAM,wBAAwB,CAAE,mBAAA/C,EAAoB,YAAAH,CAAY,EAAiC,CAC/F,GAAI,CAACG,EACH,MAAO,CAAC,EAEV,MAAM8C,EAAQ,mCAEd,OADe,MAAM,KAAK,WAAW,UAAU9C,EAAoB8C,EAAOjD,CAAW,GACvE,eAAe,GAAG,IAAI,KAAK,iBAAiB,GAAK,CAAC,CAClE,CAEA,MAAM,oBAAoB,CAAE,mBAAAG,EAAoB,YAAAH,CAAY,EAAiC,CAC3F,GAAI,CAACG,EACH,MAAO,CAAC,EAGV,MAAMgD,GADoB,MAAM,KAAK,WAAW,eAAenD,CAAW,GACrC,KAClCjC,GAAMA,EAAE,OAAS,KAAK,WAAW,YAAY,QAAQoC,CAAkB,CAC1E,EAEA,OAAKgD,KAIE,MAA4BA,EAAW,UAAWA,EAAW,UAAU,EAAE,IAAI,KAAK,iBAAiB,EAHjG,CAAC,CAIZ,CAEA,MAAM,uBAAuB,CAAE,mBAAAhD,EAAoB,YAAAH,CAAY,EAAiC,CAC9F,GAAI,CAACG,EACH,MAAO,CAAC,EAIV,MAAMgD,GADoB,MAAM,KAAK,WAAW,eAAenD,CAAW,GACrC,KAClCjC,GAAMA,EAAE,OAAS,KAAK,WAAW,YAAY,QAAQoC,CAAkB,CAC1E,EAEA,OAAKgD,KAIE,MAA8BA,EAAW,UAAyBA,EAAW,UAAU,EAAE,IAC9F,KAAK,iBACP,EALS,CAAC,CAMZ,CAEA,MAAM,uBAAuB,CAAE,YAAAnD,CAAY,EAAiC,CAE1E,OADiB,MAAM,KAAK,WAAW,eAAeA,CAAW,GACjD,IAAI,KAAK,iBAAiB,CAC5C,CAEA,MAAM,eAAe,CAAE,mBAAAoD,EAAoB,YAAApD,CAAY,EAAiC,CAEtF,OADa,MAAM,KAAK,WAAW,0BAA0BA,EAAaoD,CAAkB,GAChF,IAAI,KAAK,iBAAiB,CACxC,CAEA,MAAM,qBAAsB,CAC1B,OAAO,KAAU,IAAI,KAAK,iBAAiB,CAC7C,CAEA,4BAA6B,CAC3B,OAAO,KAAkB,IAAI,KAAK,iBAAiB,CACrD,CAEA,kBAAkBC,EAAQ,CACxB,SAAO,YAASA,CAAC,EAAI,CAAE,KAAMA,EAAG,WAAY,EAAK,EAAI,CAAE,GAAGA,EAAG,WAAY,EAAK,CAChF,CACF,CCxKO,MAAMC,UAAuC,IAGlD,CAGA,YAA6BlC,EAAuC,CAClE,MAAM,EADqB,gBAAAA,EAK7B,YAAS3B,EAHP,KAAK,gBAAkB,IAAIsD,EAA+B3B,CAAU,CACtE,CAIA,MAAMmC,EAAwF,CAC5F,MAAMC,KAAoBC,EAAA,GAAK,KAAK,gBAAgB,QAAQF,EAAQ,QAAQ,CAAC,CAAC,CAAC,EAC/E,SAAOE,EAAA,GAAK,KAAK,WAAW,wBAAwB,CAAC,EAAE,QACrDC,EAAA,GAAS,IAAMF,CAAiB,KAChCG,EAAA,GAAKnC,IAAU,CAAE,KAAAA,CAAK,EAAE,CAC1B,CACF,CACF,CCDe,MAAMoC,UAAkCC,EAAA,EAGrD,CAKA,YACUC,EACDC,KAA2B,KAAe,EACjD,CACA,MAAMD,CAAgB,EAHd,sBAAAA,EACD,iBAAAC,EAGP,KAAK,mBAAqBD,EAAiB,SAAS,oBAAsB,MAC1E,KAAK,UAAY,IAAIR,EAA+B,IAAI,EACxD,KAAK,WAAa,EAClB,KAAK,YAAcb,EAAiC,IAAI,EACxD,KAAK,cAAa,OAAc,CAClC,CAEA,cAAe,CACb,OAAO,KAAK,YAAY,aAAa,EAAE,IAAKpE,GAAM,IAAIA,EAAE,MAAM,CAChE,CAEA,MAAMkF,EAAgF,CACpF,OAAAA,EAAQ,QAAUA,EAAQ,QAAQ,IAAK,IAAO,CAC5C,GAAG,KAAK,aAAa,CAAC,EACtB,WAAYA,EAAQ,UACtB,EAAE,EACK,MAAM,MAAMA,CAAO,CAC5B,CAEA,uBAAuBV,EAA8BmB,EAAwB,CAC3E,KAAM,CAAE,eAAApC,EAAgB,gBAAAqC,EAAiB,SAAAC,EAAU,YAAAC,CAAY,EAAItB,EAEnE,MAAO,CACL,GAAGA,EACH,WAAY,KAAK,OAAO,EACxB,WAAY,KAAK,WACjB,eAAgBjB,GAAkB,CAChC,GAAG,KAAK,iBAAiBA,EAAgBoC,CAAU,EACnD,YAAa,KAAK,YAAY,QAC5BpC,EAAe,YAAcA,EAAe,YAAc,KAAK,kBAAkB,EACjFoC,CACF,EACA,QAAS,KAAK,mBAAmBpC,EAAe,SAAW,CAAC,EAAGoC,CAAU,EACzE,SAAU,KAAK,oBAAoBpC,EAAe,UAAY,CAAC,EAAGoC,CAAU,EAC5E,KAAMpC,EAAe,MAAQ,MAC/B,EACA,gBAAiBqC,GAAmB,CAClC,GAAG,KAAK,iBAAiBA,EAAiBD,CAAU,EACpD,YAAa,KAAK,YAAY,QAC5BC,EAAgB,YAAcA,EAAgB,YAAc,KAAK,kBAAkB,EACnFD,CACF,CACF,EACA,SAAUE,GAAY,KAAK,iBAAiBA,EAAUF,CAAU,EAChE,YAAaG,GAAe,KAAK,iBAAiBA,EAAaH,CAAU,CAC3E,CACF,CAEA,MAAM,UACJxD,EACAyC,EACAjD,EACAoE,EACAC,EACoC,CACpC,MAAMnF,EAAU,CACd,QAAS,CACP,CACE,MAAA+D,EACA,WAAY,KAAK,OAAO,EACxB,UAAW,KAAU,iBACrB,kBAAgB,MACd,CACE,YAAa,KAAK,YAAY,QAAQjD,CAAW,EACjD,SAAU,KAAK,oBAAoBoE,GAAa,UAAY,CAAC,EAAG,CAAC,CAAC,EAClE,mBAAoBA,GAAa,oBAAsB,cACvD,KAAM,SACR,EACA5D,CACF,CACF,CACF,EACA,MAAO6D,MAAa,MAAoB,CAC1C,EAEMC,EAAUpF,EAAQ,QAExB,OAAKoF,EAAQ,UAINC,EAAA,MACLd,EAAA,GAAK,KAAK,wBAAwB,CAAC,EAAE,QACnCC,EAAA,GAAS,IACA,KAAK,WAAW,MAAoB,CACzC,IAAK,gBACL,OAAQ,OACR,QAAS,KAAK,kBAAkB,EAChC,KAAM,CACJ,KAAMxE,EAAQ,MAAM,KAAK,QAAQ,EAAE,SAAS,EAC5C,GAAIA,EAAQ,MAAM,GAAG,QAAQ,EAAE,SAAS,EACxC,QAAAoF,CACF,CACF,CAAC,CACF,KAEDX,EAAA,GAAI,CAAC,CAAE,KAAAnC,CAAK,IAAM,CAKhB,MAAM5B,KAJoB,OAAoB,CAC5C,KAAA4B,CACF,CAAC,GAE8D,KAC5D,IAAK1D,GAAMA,EAAE,MAAM,QAAQ,MAAM,EACjC,OAAQD,GAAM,CAAC,CAACA,CAAC,EACjB,OAAO,CAAC2G,EAAK5E,IAAW,CACvB,QAAS6E,KAAO7E,EACT4E,EAAIC,CAAG,IACVD,EAAIC,CAAG,EAAI,IAAI,KAEb7E,EAAO6E,CAAG,GACZD,EAAIC,CAAG,EAAE,IAAI7E,EAAO6E,CAAG,CAAC,EAG5B,OAAOD,CACT,EAAG,CAAC,CAAC,EAEP,OAAO,OAAO,YACZ,OAAO,QAAQ5E,CAAM,EAAE,IAAI,CAAC,CAAC6E,EAAKxD,CAAK,IAAM,CAC3C,MAAMyD,EAAU,MAAM,KAAKzD,CAAK,EAChC,MAAO,CAACwD,EAAKC,CAAO,CACtB,CAAC,CACH,CACF,CAAC,CACH,CACF,KA9CSH,EAAA,MAAcI,EAAA,IAAG,CAAE,QAAS,CAAC,CAAE,CAAC,CAAC,CA+C5C,CAEA,MAAM,sBAAuB,CAC3B,OAAO,KAAK,YAAY,mBAAmB,CAC7C,CAEA,mBAA4B,CAC1B,KAAM,CAAE,eAAAC,EAAgB,mBAAAC,EAAoB,kBAAAC,CAAkB,EAAI,KAAK,iBAAiB,SACxF,OAAID,IAAuB,MAClBC,GAAqB,GAGvBF,GAAkB,EAC3B,CAEA,MAAM,yBAA0B,CAC9B,KAAM,CAAE,mBAAAC,EAAoB,kBAAAC,CAAkB,EAAI,KAAK,iBAAiB,SACpED,IAAuB,OAAS,CAACC,IACnC,KAAK,iBAAiB,SAAS,kBAAoB,MAAM,KAAK,qBAAqB,EAEvF,CAEA,MAAM,eAAe9E,EAAkD,CACrE,OAAKA,EAIE,KAAK,YAAY,iCAAiC,KAAK,YAAY,QAAQA,CAAW,qBAAqB,EAHzG,CAAC,CAIZ,CAEA,MAAM,oBAAoBA,EAAqB+E,EAA6C,CAC1F,OAAK/E,EAIE,KAAK,YACV,iCAAiC,KAAK,YAAY,QAAQA,CAAW,sBACrE,CAAE,OAAQ,kBAAkB+E,IAAU,CACxC,EANS,CAAC,CAOZ,CAEA,MAAM,eAAe/E,EAA8D,CACjF,OAAO,KAAK,YAAY,wBAAwB,KAAK,YAAY,QAAQA,CAAW,0BAA0B,CAChH,CAEA,MAAM,0BAA0BA,EAAqBgF,EAA4D,CAC/G,GAAI,CAACA,EACH,OAAO,QAAQ,QAAQ,CAAC,CAAC,EAE3B,GAAI,CAAE,YAAanH,EAAG,UAAWJ,CAAE,EAAI,KAAK,iBAAiB,CAAE,YAAAuC,EAAa,UAAAgF,CAAU,CAAC,EACvF,OAAO,KAAK,YAAY,4BAA4BnH,cAAcJ,0BAA0B,CAC9F,CAEA,aAAuD,CACrD,OAAO,KAAK,YAAY,UAAU,CACpC,CAEA,wBAAwB+C,EAAoByE,EAAoB,CAC9D,MAAMC,EAAwB,CAAC,cAAe,IAAK1E,CAAU,EAC7D,OAAIyE,GAAS,OACJA,EAAQ,OAAO,MAAOC,CAAqB,EAE7CA,CACT,CAIA,aAAa5D,EAAmD,CAC9D,KAAM,CAAE,KAAA6D,EAAM,MAAAlC,EAAO,WAAA7B,EAAY,IAAAqD,EAAK,UAAAnE,EAAW,SAAA8E,EAAU,OAAAC,EAAQ,WAAAC,EAAY,KAAAC,EAAM,GAAGC,CAAK,EAAIlE,EACjG,GACE,CAACA,EAAM,eAAe,aAAa,GACnC,CAACA,EAAM,eAAe,UAAU,GAChC,CAACA,EAAM,eAAe,iBAAiB,GACvC,CAACA,EAAM,eAAe,gBAAgB,EACtC,CACA,IAAI2D,EAAUO,EAAK,SAAW,CAAC,EAC/B,OAAIA,EAAK,aACPP,EAAU,KAAK,wBAAwBO,EAAK,WAAYP,CAAO,GAG1D,CACL,WAAA7D,EACA,IAAAqD,EACA,MAAAxB,EACA,WAAAqC,EACA,KAAAH,EACA,UAAWI,IAAS,kBAAoB,KAAU,WAAa,KAAU,iBACzE,eAAgB,CACd,GAAGC,EACH,eAAa,OAAIlE,EAAO,aAAa,GAAK,KAAK,kBAAkB,EACjE,QAAA2D,EACA,KAAMO,EAAK,MAAQ,MACrB,CACF,EAGF,MAAI,OAAIlE,EAAO,aAAa,GAAK,CAAC,UAAW,KAAU,UAAU,EAAE,SAASA,EAAM,WAAa,EAAE,EAAG,CAClG,MAAMmE,KAA2B,OAAInE,EAAO,aAAa,EACrDmE,EAAY,aAAe,OAC7BnE,EAAM,gBAAkB,CACtB,YAAamE,EAAY,YACzB,MAAOA,EAAY,MACnB,YAAaA,EAAY,WAC3B,EACAnE,EAAM,UAAY,KAAU,oBAE5BA,EAAM,eAAiB,CACrB,YAAamE,EAAY,aAAe,KAAK,kBAAkB,EAC/D,mBAAoBA,EAAY,mBAChC,gBAAiBA,EAAY,gBAC7B,iBAAkBA,EAAY,iBAC9B,SAAUA,EAAY,SACtB,QAASA,EAAY,QACrB,KAAMA,EAAY,KAClB,aAAcA,EAAY,YAC5B,EACAnE,EAAM,UAAY,KAAU,iBACxBmE,EAAY,aACdnE,EAAM,eAAe,QAAU,KAAK,wBAClCmE,EAAY,WACZnE,EAAM,eAAe,OACvB,IAGJA,EAAM,QAAUmE,EAAY,QAC5BnE,KAAQ,QAAKA,EAAO,aAAa,EAGnC,OAAIA,EAAM,YAAc,KAAU,QAAO,OAAIA,EAAO,kBAAkB,IACpEA,EAAM,WAAU,OAAIA,EAAO,kBAAkB,EAC7CA,KAAQ,QAAKA,EAAO,kBAAkB,GAGjCA,CACT,CAEA,iBAAgDoE,EAAW1B,EAAyB,CAAC,EAAM,CACzF,OAAO,OAAO,QAAQ0B,CAAM,EAAE,OAAO,CAAClB,EAAK,CAACC,EAAKxD,CAAK,KAC7C,CACL,GAAGuD,EACH,CAACC,CAAG,EAAGxD,MAAS,YAASA,CAAK,EAAI,KAAK,YAAY,QAAQA,EAAO+C,CAAU,EAAI/C,CAClF,GACC,CAAC,CAAM,CACZ,CAEA,YAAYK,EAAsC,CAChD,GAAIA,EAAM,KACR,MAAO,GAGT,GAAIA,EAAM,YAAc,KAAU,IAAK,CACrC,GAAI,CAACA,EAAM,SACT,MAAO,GAET,KAAM,CAAE,aAAAqE,EAAc,UAAAX,EAAW,MAAAY,EAAO,YAAA5F,EAAa,eAAA6F,CAAe,EAAIvE,EAAM,SAC9E,MACE,CAAC,CAACqE,GACF,CAAC,CAACX,GACF,CAAC,CAACY,GACF,CAAC,CAAC5F,IACD2F,IAAiB,MAA+B,CAAC,CAACE,GAIvD,OAAIvE,EAAM,YAAc,KAAU,kBACzB,CAAC,CAACA,EAAM,iBAAmB,CAAC,CAACA,EAAM,gBAAgB,aAAe,CAAC,CAACA,EAAM,gBAAgB,MAG/FA,EAAM,WAAa,CAAC,KAAU,iBAAkB,KAAU,UAAU,EAAE,SAASA,EAAM,SAAS,EACzF,CAAC,CAACA,EAAM,gBAAkB,CAAC,CAACA,EAAM,eAAe,aAAe,CAAC,IAAC,MAAcA,EAAM,cAAc,EAGzGA,EAAM,YAAc,KAAU,OAE9B,CAAC,CAACA,EAAM,aAAe,CAAC,CAACA,EAAM,YAAY,aAAe,CAAC,CAACA,EAAM,YAAY,MAAQ,CAAC,CAACA,EAAM,YAAY,KAIvG,EACT,CAEA,8BAA8BgD,EAAiCN,EAAgD,CAC7G,OAAOM,EAAQ,IAAKhD,GAAU,KAAK,uBAAuB,KAAK,aAAaA,CAAK,EAAG0C,CAAU,CAAC,CACjG,CAEA,mBAAmBiB,EAAmBjB,EAAwB,CAC5D,MAAM8B,KAA2B,SAAMb,EAAS,CAAC,EAC9C,IAAI,CAAC,CAACR,EAAKsB,EAAU9E,EAAO+E,CAAS,KAAO,CAC3C,IAAAvB,EACA,SAAAsB,EACA,MAAA9E,EACA,GAAI+E,GAAa,CAAE,UAAAA,CAAU,CAC/B,EAAE,EACD,OAAQC,GAASA,EAAK,KAAK,EAa9B,SAXoB,WAClBH,EAAe,IAAI,CAAC,CAAE,IAAArB,EAAK,SAAAsB,EAAU,MAAA9E,EAAO,UAAA+E,CAAU,IAAc,CAClE,KAAK,YAAY,QAAQvB,EAAKT,GAAc,CAAC,CAAC,EAC9C+B,EACA,KAAK,YAAY,QAAQ9E,EAAO+C,GAAc,CAAC,EAAI/C,MAC1C,WAAQA,CAAK,GAAKA,EAAM,OAAS,IAAIA,EAAM,KAAK,GAAG,KAAOA,CAClE,EACD,GAAI+E,EAAY,CAACA,CAAS,EAAI,CAAC,CACjC,CAAC,CACH,GAEsB,CAAC,CACzB,CAEA,oBAAoBE,EAAoBlC,EAA0B,CAChE,IAAImC,EAAiC,CAAC,EACtC,OAACD,GAAY,CAAC,GAAG,QAASE,GAAO,CAC/B,MAAMC,EAAe,KAAK,YAAY,QAAQD,EAAIpC,GAAc,CAAC,EAAG,KAAK,EAAE,MAAM,GAAG,EAChF,MAAM,QAAQqC,CAAY,EAC5BF,EAAuBA,EAAqB,OAAOE,CAAY,EAE/DF,EAAqB,KAAKE,CAAY,CAE1C,CAAC,EACMF,CACT,CACF,C,eC9XO,MAAMG,GAAuC5G,GAA+C,IACjG,MAAkB,8CAA+CA,CAAK,CACxE,ECMa,GAAS,IAAI,KAAkEkE,CAAyB,EAClH,mBAAmB5E,CAAyB,EAC5C,eAAeuH,GAAA,CAAW,EAC1B,gBAAgBtH,EAAY,EAC5B,uBAAuBQ,CAAkC,KAG5D,MAAa,EAAE,UACb,KACA,CAAC,CAAE,QAAS,CAAE,YAAA+G,EAAa,MAAAC,EAAO,eAAAC,EAAgB,QAAApC,CAAQ,CAAE,IAAM,CAChE,MAAMqC,EAAsBrC,EAAQ,IAAa,EACjD,IAAIsC,EAAQ,CACV,CAAC,KAAU,iBAAiB,EAAG,EAC/B,CAAC,KAAU,gBAAgB,EAAG,EAC9B,CAAC,KAAU,GAAG,EAAG,EACjB,CAAC,KAAU,UAAU,EAAG,EACxB,CAAC,KAAU,MAAM,EAAG,CACtB,EACAD,EAAoB,QAASrF,GAAU,CAEnCA,EAAM,YAAc,KAAU,mBAC9BA,EAAM,YAAc,KAAU,kBAC9BA,EAAM,YAAc,KAAU,KAC9BA,EAAM,YAAc,KAAU,YAC9BA,EAAM,YAAc,KAAU,OAE9BsF,EAAMtF,EAAM,SAAS,IACZA,EAAM,YAAc,YACzBA,EAAM,eAAe,MAAM,MAAK,OAAIA,EAAO,MAAM,IAAM,mBACzDsF,EAAM,gBAEJ,OAAItF,EAAO,wBAAwB,IAAM,MAC3CsF,EAAM,kBAENA,EAAM,iBAGZ,CAAC,EAEGD,GAAuBA,EAAoB,OAAS,GACtDL,GAAoC,CAClC,gBAAiBI,EACjB,aAAcF,EACd,OAAQC,EACR,YAAaG,EAAM,KAAU,iBAAiB,EAC9C,2BAA4BA,EAAM,KAAU,gBAAgB,EAC5D,YAAaA,EAAM,KAAU,GAAG,EAChC,mBAAoBA,EAAM,KAAU,UAAU,EAC9C,eAAgBA,EAAM,KAAU,MAAM,CACxC,CAAC,CAEL,CACF,C","sources":["webpack://grafana/./node_modules/@grafana/google-sdk/dist/index.production.js","webpack://grafana/./node_modules/@grafana/google-sdk/index.js","webpack://grafana/./public/app/plugins/datasource/cloud-monitoring/components/CloudMonitoringCheatSheet.tsx","webpack://grafana/./public/app/plugins/datasource/cloud-monitoring/components/ConfigEditor/ConfigEditor.tsx","webpack://grafana/./public/app/plugins/datasource/cloud-monitoring/components/VariableQueryEditor.tsx","webpack://grafana/./public/app/plugins/datasource/cloud-monitoring/components/AnnotationQueryEditor.tsx","webpack://grafana/./public/app/plugins/datasource/cloud-monitoring/annotationSupport.ts","webpack://grafana/./public/app/plugins/datasource/cloud-monitoring/CloudMonitoringMetricFindQuery.ts","webpack://grafana/./public/app/plugins/datasource/cloud-monitoring/variables.ts","webpack://grafana/./public/app/plugins/datasource/cloud-monitoring/datasource.ts","webpack://grafana/./public/app/plugins/datasource/cloud-monitoring/tracking.ts","webpack://grafana/./public/app/plugins/datasource/cloud-monitoring/module.ts"],"sourcesContent":["Object.defineProperty(exports,\"__esModule\",{value:!0});var e=require(\"@grafana/data\"),t=require(\"@grafana/ui\"),a=require(\"react\"),n=require(\"lodash\");function l(e){return e&&\"object\"==typeof e&&\"default\"in e?e:{default:e}}var o=l(a);const i={JWT:\"jwt\",GCE:\"gce\"},r=\"Configuration help box\",s=\"Configuration drop zone\",u=\"Configuration text area\",c=\"Paste JWT button\",d=\"Upload JWT button\",p=\"JWT form\",f=\"JWT button\",m=\"GCE button\",g=\"Private Key Path Input\",h=\"Private Key Input\",y=\"Fill JWT info manually\",E=\"Show private key path input\",T=\"Show private key input\",v=[\"private_key\",\"token_uri\",\"client_email\",\"project_id\"],b=({onChange:e,showConfigEditor:n,showPaste:l,showUpload:i,isPasting:r,isUploading:p})=>{const[f,m]=a.useState(),g=t.useTheme2(),h=a.useCallback((e=>{m(null),l()}),[l]),E=a.useCallback((e=>{i(),m(null)}),[i]),T=a.useCallback((t=>{if(\"\"!==t.trim()){let a;try{a=JSON.parse(t)}catch(e){m(\"Invalid JWT token\")}const l=j(a);l.isValid?(n(),e({privateKey:a.private_key,tokenUri:a.token_uri,clientEmail:a.client_email,projectId:a.project_id})):m(l.error)}}),[m,e,n]);return o.default.createElement(o.default.Fragment,null,o.default.createElement(t.Field,{label:\"JWT token\",invalid:Boolean(f),description:r?\"Paste JWT token below\":\"Upload or paste Google JWT token\",error:f},o.default.createElement(o.default.Fragment,null,p&&o.default.createElement(\"div\",{\"data-testid\":s},t.FileDropzone&&o.default.createElement(t.FileDropzone,{options:{multiple:!1,accept:\".json\"},readAs:\"readAsText\",onLoad:e=>{T(e)}},o.default.createElement(\"p\",{style:{margin:0,fontSize:`${g.typography.h4.fontSize}`,textAlign:\"center\"}},\"Drop the Google JWT file here\",o.default.createElement(\"br\",null),o.default.createElement(\"br\",null),o.default.createElement(t.Button,{fill:\"outline\"},\"Click to browse files\")))),r&&o.default.createElement(t.TextArea,{\"data-testid\":u,autoFocus:!0,invalid:Boolean(f),placeholder:\"Paste Google JWT token here\",onBlur:e=>T(e.currentTarget.value),rows:12}))),!r&&o.default.createElement(o.default.Fragment,null,o.default.createElement(t.Button,{\"data-testid\":c,type:\"button\",fill:\"outline\",style:{color:`${g.colors.primary.text}`},onClick:h},\"Paste JWT Token\"),o.default.createElement(\"span\",{style:{paddingRight:\"10px\",paddingLeft:\"10px\"}},\"or\")),r&&o.default.createElement(o.default.Fragment,null,o.default.createElement(t.Button,{\"data-testid\":d,type:\"button\",fill:\"outline\",style:{color:`${g.colors.primary.text}`},onClick:()=>{i()}},\"Upload JWT Token\"),o.default.createElement(\"span\",{style:{paddingRight:\"10px\",paddingLeft:\"10px\"}},\"or\")),o.default.createElement(t.Button,{\"data-testid\":y,type:\"button\",fill:\"outline\",style:{color:`${g.colors.primary.text}`},onClick:n},\"Fill In JWT Token manually\"),r&&f&&o.default.createElement(t.Field,null,o.default.createElement(t.Button,{type:\"button\",fill:\"outline\",style:{color:`${g.colors.primary.text}`},onClick:E},\"Upload JWT Token\")))},j=e=>{if(!n.isObject(e))return{isValid:!1,error:\"Invalid JWT token\"};const t=v.filter((t=>!e[t]));return t.length>0?{isValid:!1,error:`Missing keys: ${t.join(\", \")}`}:{isValid:!0}},{SecretFormField:k}=t.LegacyForms;var J;!function(e){e.PATH=\"path\",e.JWT=\"jwt\"}(J||(J={}));const P=({options:a,onReset:n,onOptionsChange:l,showPaste:i,showUpload:r})=>{var s;const[u,f]=o.default.useState((e=>\"privateKeyPath\"in e&&\"\"!==e.privateKeyPath?J.PATH:J.JWT)(a.jsonData)),m=t=>e.onUpdateDatasourceJsonDataOption({options:a,onOptionsChange:l},t),y=()=>{u===J.JWT?f(J.PATH):f(J.JWT)},v=t.useTheme2(),b=o.default.createElement(\"span\",null,u===J.PATH?o.default.createElement(\"a\",{className:\"external-link\",onClick:y,\"data-testid\":T},\"Paste private key\"):\"Paste private key\",\" \",\"or  \",u===J.JWT?o.default.createElement(\"a\",{className:\"external-link\",onClick:y,\"data-testid\":E},\"provide path to private file\"):\"provide path to private key file\"),j={isConfigured:Boolean(a.secureJsonFields.privateKey),value:(null===(s=a.secureJsonData)||void 0===s?void 0:s.privateKey)||\"\",placeholder:\"Enter Private key\",onReset:()=>n(),onChange:e.onUpdateDatasourceSecureJsonDataOption({options:a,onOptionsChange:l},\"privateKey\"),\"data-testid\":h};return o.default.createElement(\"div\",{\"data-testid\":p},o.default.createElement(t.Field,{label:\"Project ID\"},o.default.createElement(t.Input,{id:\"defaultProject\",width:60,value:a.jsonData.defaultProject||\"\",onChange:m(\"defaultProject\")})),o.default.createElement(t.Field,{label:\"Client email\"},o.default.createElement(t.Input,{width:60,id:\"clientEmail\",value:a.jsonData.clientEmail||\"\",onChange:m(\"clientEmail\")})),o.default.createElement(t.Field,{label:\"Token URI\"},o.default.createElement(t.Input,{width:60,id:\"tokenUri\",value:a.jsonData.tokenUri||\"\",onChange:m(\"tokenUri\")})),u===J.PATH&&o.default.createElement(t.Field,{label:\"Private key path\",description:b},o.default.createElement(t.Input,{width:60,id:\"privateKeyPath\",value:a.jsonData.privateKeyPath||\"\",placeholder:\"File location of your private key (e.g. /etc/secrets/gce.pem)\",onChange:m(\"privateKeyPath\"),\"data-testid\":g})),u===J.JWT&&o.default.createElement(o.default.Fragment,null,t.SecretInput?o.default.createElement(t.Field,{label:\"Private key\",description:b},o.default.createElement(t.SecretInput,Object.assign({},j,{width:60}))):o.default.createElement(k,Object.assign({},j,{label:\"Private key\",labelWidth:10,inputWidth:20}))),o.default.createElement(o.default.Fragment,null,o.default.createElement(t.Button,{\"data-testid\":c,type:\"button\",fill:\"outline\",style:{color:`${v.colors.primary.text}`},onClick:i},\"Paste JWT Token\"),o.default.createElement(\"span\",{style:{paddingRight:\"10px\",paddingLeft:\"10px\"}},\"or\"),o.default.createElement(t.Button,{\"data-testid\":d,type:\"button\",fill:\"outline\",style:{color:`${v.colors.primary.text}`},onClick:r},\"Upload JWT Token\")))};function C(n){const{options:l,onOptionsChange:r,authOptions:s}=n,{jsonData:u,secureJsonFields:c,secureJsonData:d}=l,p=()=>Boolean(u.clientEmail&&u.defaultProject&&u.tokenUri&&(c&&c.privateKey||u.privateKeyPath));u.authenticationType||(u.authenticationType=i.JWT);const[f,m]=a.useState(O(u.authenticationType)),[g,h]=a.useState(p()),[y,E]=a.useState(!1),[T,v]=a.useState(!0),j=()=>{E(!1),v(!0),h(!1)},k=()=>{E(!0),v(!1),h(!1)};return o.default.createElement(o.default.Fragment,null,o.default.createElement(t.FieldSet,{label:\"Authentication\"},o.default.createElement(t.Field,{label:\"Authentication type\"},o.default.createElement(t.RadioButtonGroup,{options:s,value:u.authenticationType||i.JWT,onChange:e=>{h(p()),r(Object.assign(Object.assign({},l),{jsonData:Object.assign(Object.assign({},l.jsonData),{authenticationType:e})})),m(O(e))}}))),f&&o.default.createElement(t.FieldSet,{label:\"JWT Key Details\"},g?o.default.createElement(P,{options:l,onReset:()=>(e=>{const t=Object.assign({},d),a=e?Object.assign(Object.assign({},l.jsonData),e):Object.assign({},l.jsonData);delete a.clientEmail,delete a.defaultProject,delete a.tokenUri,delete a.privateKeyPath,delete t.privateKey,m(!0),h(!1),r(Object.assign(Object.assign({},l),{secureJsonFields:Object.assign(Object.assign({},l.secureJsonFields),{privateKey:!1}),secureJsonData:t,jsonData:a}))})(),onOptionsChange:r,showUpload:j,showPaste:k}):o.default.createElement(b,{showConfigEditor:()=>{h(!0)},showUpload:j,showPaste:k,isPasting:y,isUploading:T,onChange:e=>{r(Object.assign(Object.assign({},l),{secureJsonFields:Object.assign(Object.assign({},c),{privateKey:!0}),secureJsonData:Object.assign(Object.assign({},d),{privateKey:e.privateKey}),jsonData:Object.assign(Object.assign({},u),{clientEmail:e.clientEmail,defaultProject:e.projectId,tokenUri:e.tokenUri})}))}}),\" \"),u.authenticationType===i.GCE&&o.default.createElement(t.Field,{label:\"Default project\"},o.default.createElement(t.Input,{id:\"defaultProject\",width:60,value:l.jsonData.defaultProject||\"\",onChange:e.onUpdateDatasourceJsonDataOption(n,\"defaultProject\")})))}const O=e=>e===i.JWT||void 0===e,W=[{label:\"Google JWT File\",value:i.JWT,ariaLabel:f},{label:\"GCE Default Service Account\",value:i.GCE,ariaLabel:m}];exports.AuthConfig=C,exports.ConnectionConfig=e=>{const{options:{jsonData:a}}=e;a.authenticationType||(a.authenticationType=i.JWT);const n=a.authenticationType===i.JWT||void 0===a.authenticationType;return o.default.createElement(o.default.Fragment,null,o.default.createElement(C,Object.assign({authOptions:W},e)),o.default.createElement(\"div\",{className:\"grafana-info-box\",style:{marginTop:\"16px\"},\"data-testid\":r},o.default.createElement(\"p\",null,\"Don’t know how to get a service account key file or create a service account? Read more\",\" \",o.default.createElement(\"a\",{className:\"external-link\",target:\"_blank\",rel:\"noopener noreferrer\",href:\"https://grafana.com/docs/grafana/latest/datasources/google-cloud-monitoring/google-authentication/\"},\"in the documentation.\"))),!n&&o.default.createElement(t.Alert,{title:\"\",severity:\"info\"},\"Verify GCE default service account by clicking Save & Test\"))},exports.GOOGLE_AUTH_TYPE_OPTIONS=W,exports.GoogleAuthType=i,exports.JWTConfigEditor=b,exports.JWTForm=P;\n//# sourceMappingURL=index.production.js.map\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./dist/index.production.js');\n} else {\n  module.exports = require('./dist/index.development.js');\n}\n","import { css } from '@emotion/css';\nimport React, { PureComponent } from 'react';\n\nimport { QueryEditorHelpProps } from '@grafana/data';\n\nimport { CloudMonitoringQuery } from '../types/query';\n\nexport default class CloudMonitoringCheatSheet extends PureComponent<\n  QueryEditorHelpProps<CloudMonitoringQuery>,\n  { userExamples: string[] }\n> {\n  render() {\n    return (\n      <div>\n        <h2>Cloud Monitoring alias patterns</h2>\n        <div>\n          <p>\n            Format the legend keys any way you want by using alias patterns. Format the legend keys any way you want by\n            using alias patterns.\n          </p>\n          Example:\n          <code>{`${'{{metric.name}} - {{metric.label.instance_name}}'}`}</code>\n          <br />\n          Result: &nbsp;&nbsp;<code>cpu/usage_time - server1-europe-west-1</code>\n          <br />\n          <br />\n          <span>Patterns:</span>\n          <br />\n          <ul\n            className={css`\n              list-style: none;\n            `}\n          >\n            <li>\n              <code>{`${'{{metric.type}}'}`}</code> = metric type e.g. compute.googleapis.com/instance/cpu/usage_time\n            </li>\n            <li>\n              <code>{`${'{{metric.name}}'}`}</code> = name part of metric e.g. instance/cpu/usage_time\n            </li>\n            <li>\n              <code>{`${'{{metric.service}}'}`}</code> = service part of metric e.g. compute\n            </li>\n            <li>\n              <code>{`${'{{metric.label.label_name}}'}`}</code> = Metric label metadata e.g. metric.label.instance_name\n            </li>\n            <li>\n              <code>{`${'{{resource.label.label_name}}'}`}</code> = Resource label metadata e.g. resource.label.zone\n            </li>\n            <li>\n              <code>{`${'{{metadata.system_labels.name}}'}`}</code> = Meta data system labels e.g.\n              metadata.system_labels.name. For this to work, the needs to be included in the group by\n            </li>\n            <li>\n              <code>{`${'{{metadata.user_labels.name}}'}`}</code> = Meta data user labels e.g.\n              metadata.user_labels.name. For this to work, the needs to be included in the group by\n            </li>\n            <li>\n              <code>{`${'{{bucket}}'}`}</code> = bucket boundary for distribution metrics when using a heatmap in\n              Grafana\n            </li>\n            <li>\n              <code>{`${'{{project}}'}`}</code> = The project name that was specified in the query editor\n            </li>\n            <li>\n              <code>{`${'{{service}}'}`}</code> = The service id that was specified in the SLO query editor\n            </li>\n            <li>\n              <code>{`${'{{slo}}'}`}</code> = The SLO id that was specified in the SLO query editor\n            </li>\n            <li>\n              <code>{`${'{{selector}}'}`}</code> = The Selector function that was specified in the SLO query editor\n            </li>\n          </ul>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\n\nimport { DataSourcePluginOptionsEditorProps } from '@grafana/data';\nimport { ConfigSection, DataSourceDescription } from '@grafana/experimental';\nimport { ConnectionConfig } from '@grafana/google-sdk';\nimport { reportInteraction, config } from '@grafana/runtime';\nimport { Divider, SecureSocksProxySettings } from '@grafana/ui';\n\nimport { CloudMonitoringOptions, CloudMonitoringSecureJsonData } from '../../types/types';\n\nexport type Props = DataSourcePluginOptionsEditorProps<CloudMonitoringOptions, CloudMonitoringSecureJsonData>;\n\nexport class ConfigEditor extends PureComponent<Props> {\n  handleOnOptionsChange = (options: Props['options']) => {\n    if (options.jsonData.privateKeyPath || options.secureJsonFields['privateKey']) {\n      reportInteraction('grafana_cloud_monitoring_config_changed', {\n        authenticationType: 'JWT',\n        privateKey: options.secureJsonFields['privateKey'],\n        privateKeyPath: !!options.jsonData.privateKeyPath,\n      });\n    }\n    this.props.onOptionsChange(options);\n  };\n\n  render() {\n    const { options, onOptionsChange } = this.props;\n    return (\n      <>\n        <DataSourceDescription\n          dataSourceName=\"Google Cloud Monitoring\"\n          docsLink=\"https://grafana.com/docs/grafana/latest/datasources/google-cloud-monitoring/\"\n          hasRequiredFields\n        />\n        <Divider />\n        <ConnectionConfig {...this.props} onOptionsChange={this.handleOnOptionsChange}></ConnectionConfig>\n        {config.secureSocksDSProxyEnabled && (\n          <>\n            <Divider />\n            <ConfigSection\n              title=\"Additional settings\"\n              description=\"Additional settings are optional settings that can be configured for more control over your data source. This includes Secure Socks Proxy.\"\n              isCollapsible={true}\n              isInitiallyOpen={options.jsonData.enableSecureSocksProxy !== undefined}\n            >\n              <SecureSocksProxySettings options={options} onOptionsChange={onOptionsChange} />\n            </ConfigSection>\n          </>\n        )}\n      </>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\n\nimport { QueryEditorProps } from '@grafana/data';\nimport { getTemplateSrv } from '@grafana/runtime';\n\nimport CloudMonitoringDatasource from '../datasource';\nimport { extractServicesFromMetricDescriptors, getLabelKeys, getMetricTypes } from '../functions';\nimport { CloudMonitoringQuery, MetricFindQueryTypes } from '../types/query';\nimport {\n  CloudMonitoringOptions,\n  CloudMonitoringVariableQuery,\n  MetricDescriptor,\n  VariableQueryData,\n} from '../types/types';\n\nimport { VariableQueryField } from './';\n\nexport type Props = QueryEditorProps<\n  CloudMonitoringDatasource,\n  CloudMonitoringQuery,\n  CloudMonitoringOptions,\n  CloudMonitoringVariableQuery\n>;\n\nexport class CloudMonitoringVariableQueryEditor extends PureComponent<Props, VariableQueryData> {\n  queryTypes: Array<{ value: string; label: string }> = [\n    { value: MetricFindQueryTypes.Projects, label: 'Projects' },\n    { value: MetricFindQueryTypes.Services, label: 'Services' },\n    { value: MetricFindQueryTypes.MetricTypes, label: 'Metric Types' },\n    { value: MetricFindQueryTypes.LabelKeys, label: 'Label Keys' },\n    { value: MetricFindQueryTypes.LabelValues, label: 'Label Values' },\n    { value: MetricFindQueryTypes.ResourceTypes, label: 'Resource Types' },\n    { value: MetricFindQueryTypes.Aggregations, label: 'Aggregations' },\n    { value: MetricFindQueryTypes.Aligners, label: 'Aligners' },\n    { value: MetricFindQueryTypes.AlignmentPeriods, label: 'Alignment Periods' },\n    { value: MetricFindQueryTypes.Selectors, label: 'Selectors' },\n    { value: MetricFindQueryTypes.SLOServices, label: 'SLO Services' },\n    { value: MetricFindQueryTypes.SLO, label: 'Service Level Objectives (SLO)' },\n  ];\n\n  defaults: VariableQueryData = {\n    selectedQueryType: this.queryTypes[0].value,\n    metricDescriptors: [],\n    selectedService: '',\n    selectedMetricType: '',\n    labels: [],\n    labelKey: '',\n    metricTypes: [],\n    services: [],\n    sloServices: [],\n    selectedSLOService: '',\n    projects: [],\n    projectName: '',\n    loading: true,\n  };\n\n  constructor(props: Props) {\n    super(props);\n    this.state = Object.assign(this.defaults, this.props.query);\n  }\n\n  async componentDidMount() {\n    await this.props.datasource.ensureGCEDefaultProject();\n    const projectName = this.props.query.projectName || this.props.datasource.getDefaultProject();\n    const projects = (await this.props.datasource.getProjects()) as MetricDescriptor[];\n    const metricDescriptors = await this.props.datasource.getMetricTypes(\n      this.props.query.projectName || this.props.datasource.getDefaultProject()\n    );\n    const services = extractServicesFromMetricDescriptors(metricDescriptors).map((m) => ({\n      value: m.service,\n      label: m.serviceShortName,\n    }));\n\n    let selectedService = '';\n    if (services.some((s) => s.value === getTemplateSrv().replace(this.state.selectedService))) {\n      selectedService = this.state.selectedService;\n    } else if (services && services.length > 0) {\n      selectedService = services[0].value;\n    }\n\n    const { metricTypes, selectedMetricType } = getMetricTypes(\n      metricDescriptors,\n      this.state.selectedMetricType,\n      getTemplateSrv().replace(this.state.selectedMetricType),\n      getTemplateSrv().replace(selectedService)\n    );\n\n    const sloServices = await this.props.datasource.getSLOServices(projectName);\n\n    const state = {\n      services,\n      selectedService,\n      metricTypes,\n      selectedMetricType,\n      metricDescriptors,\n      projects,\n      ...(await this.getLabels(selectedMetricType, projectName)),\n      sloServices,\n      loading: false,\n      projectName,\n    };\n    this.setState(state, () => this.onPropsChange());\n  }\n\n  onPropsChange = () => {\n    const { metricDescriptors, labels, metricTypes, services, ...queryModel } = this.state;\n    this.props.onChange({ ...queryModel, refId: 'CloudMonitoringVariableQueryEditor-VariableQuery' });\n  };\n\n  async onQueryTypeChange(queryType: string) {\n    const state = {\n      selectedQueryType: queryType,\n      ...(await this.getLabels(this.state.selectedMetricType, this.state.projectName, queryType)),\n    };\n\n    this.setState(state);\n  }\n\n  async onProjectChange(projectName: string) {\n    const metricDescriptors = await this.props.datasource.getMetricTypes(projectName);\n    const labels = await this.getLabels(this.state.selectedMetricType, projectName);\n    const { metricTypes, selectedMetricType } = getMetricTypes(\n      metricDescriptors,\n      this.state.selectedMetricType,\n      getTemplateSrv().replace(this.state.selectedMetricType),\n      getTemplateSrv().replace(this.state.selectedService)\n    );\n\n    const sloServices = await this.props.datasource.getSLOServices(projectName);\n\n    this.setState(\n      {\n        ...labels,\n        metricTypes,\n        selectedMetricType,\n        metricDescriptors,\n        projectName,\n        sloServices,\n      },\n      () => this.onPropsChange()\n    );\n  }\n\n  async onServiceChange(service: string) {\n    const { metricTypes, selectedMetricType } = getMetricTypes(\n      this.state.metricDescriptors,\n      this.state.selectedMetricType,\n      getTemplateSrv().replace(this.state.selectedMetricType),\n      getTemplateSrv().replace(service)\n    );\n    const state = {\n      selectedService: service,\n      metricTypes,\n      selectedMetricType,\n      ...(await this.getLabels(selectedMetricType, this.state.projectName)),\n    };\n    this.setState(state, () => this.onPropsChange());\n  }\n\n  async onMetricTypeChange(metricType: string) {\n    const state = {\n      selectedMetricType: metricType,\n      ...(await this.getLabels(metricType, this.state.projectName)),\n    };\n    this.setState(state, () => this.onPropsChange());\n  }\n\n  onLabelKeyChange(labelKey: string) {\n    this.setState({ labelKey }, () => this.onPropsChange());\n  }\n\n  componentDidUpdate(prevProps: Readonly<Props>, prevState: Readonly<VariableQueryData>) {\n    const selecQueryTypeChanged = prevState.selectedQueryType !== this.state.selectedQueryType;\n    const selectSLOServiceChanged = this.state.selectedSLOService !== prevState.selectedSLOService;\n    if (selecQueryTypeChanged || selectSLOServiceChanged) {\n      this.onPropsChange();\n    }\n  }\n\n  async getLabels(selectedMetricType: string, projectName: string, selectedQueryType = this.state.selectedQueryType) {\n    let result = { labels: this.state.labels, labelKey: this.state.labelKey };\n    if (selectedMetricType && selectedQueryType === MetricFindQueryTypes.LabelValues) {\n      const labels = await getLabelKeys(this.props.datasource, selectedMetricType, projectName);\n      const labelKey = labels.some((l) => l === getTemplateSrv().replace(this.state.labelKey))\n        ? this.state.labelKey\n        : labels[0];\n      result = { labels, labelKey };\n    }\n    return result;\n  }\n\n  renderQueryTypeSwitch(queryType: string) {\n    const variableOptionGroup = {\n      label: 'Template Variables',\n      expanded: false,\n      options: getTemplateSrv()\n        .getVariables()\n        .map((v) => ({\n          value: `$${v.name}`,\n          label: `$${v.name}`,\n        })),\n    };\n\n    switch (queryType) {\n      case MetricFindQueryTypes.MetricTypes:\n        return (\n          <>\n            <VariableQueryField\n              allowCustomValue={true}\n              value={this.state.projectName}\n              options={[variableOptionGroup, ...this.state.projects]}\n              onChange={(value) => this.onProjectChange(value)}\n              label=\"Project\"\n            />\n            <VariableQueryField\n              value={this.state.selectedService}\n              options={[variableOptionGroup, ...this.state.services]}\n              onChange={(value) => this.onServiceChange(value)}\n              label=\"Service\"\n            />\n          </>\n        );\n      case MetricFindQueryTypes.LabelKeys:\n      case MetricFindQueryTypes.LabelValues:\n      case MetricFindQueryTypes.ResourceTypes:\n        return (\n          <>\n            <VariableQueryField\n              allowCustomValue={true}\n              value={this.state.projectName}\n              options={[variableOptionGroup, ...this.state.projects]}\n              onChange={(value) => this.onProjectChange(value)}\n              label=\"Project\"\n            />\n            <VariableQueryField\n              value={this.state.selectedService}\n              options={[variableOptionGroup, ...this.state.services]}\n              onChange={(value) => this.onServiceChange(value)}\n              label=\"Service\"\n            />\n            <VariableQueryField\n              value={this.state.selectedMetricType}\n              options={[\n                variableOptionGroup,\n                ...this.state.metricTypes.map(({ value, name }) => ({ value, label: name })),\n              ]}\n              onChange={(value) => this.onMetricTypeChange(value)}\n              label=\"Metric Type\"\n            />\n            {queryType === MetricFindQueryTypes.LabelValues && (\n              <VariableQueryField\n                value={this.state.labelKey}\n                options={[variableOptionGroup, ...this.state.labels.map((l) => ({ value: l, label: l }))]}\n                onChange={(value) => this.onLabelKeyChange(value)}\n                label=\"Label Key\"\n              />\n            )}\n          </>\n        );\n      case MetricFindQueryTypes.Aligners:\n      case MetricFindQueryTypes.Aggregations:\n        return (\n          <>\n            <VariableQueryField\n              value={this.state.selectedService}\n              options={[variableOptionGroup, ...this.state.services]}\n              onChange={(value) => this.onServiceChange(value)}\n              label=\"Service\"\n            />\n            <VariableQueryField\n              value={this.state.selectedMetricType}\n              options={[\n                variableOptionGroup,\n                ...this.state.metricTypes.map(({ value, name }) => ({ value, label: name })),\n              ]}\n              onChange={(value) => this.onMetricTypeChange(value)}\n              label=\"Metric Type\"\n            />\n          </>\n        );\n      case MetricFindQueryTypes.SLOServices:\n        return (\n          <>\n            <VariableQueryField\n              allowCustomValue={true}\n              value={this.state.projectName}\n              options={[variableOptionGroup, ...this.state.projects]}\n              onChange={(value) => this.onProjectChange(value)}\n              label=\"Project\"\n            />\n          </>\n        );\n\n      case MetricFindQueryTypes.SLO:\n        return (\n          <>\n            <VariableQueryField\n              allowCustomValue={true}\n              value={this.state.projectName}\n              options={[variableOptionGroup, ...this.state.projects]}\n              onChange={(value) => this.onProjectChange(value)}\n              label=\"Project\"\n            />\n            <VariableQueryField\n              value={this.state.selectedSLOService}\n              options={[variableOptionGroup, ...this.state.sloServices]}\n              onChange={(value) => {\n                this.setState({\n                  ...this.state,\n                  selectedSLOService: value,\n                });\n              }}\n              label=\"SLO Service\"\n            />\n          </>\n        );\n      default:\n        return '';\n    }\n  }\n\n  render() {\n    if (this.state.loading) {\n      return (\n        <VariableQueryField\n          value={'loading'}\n          options={[{ value: 'loading', label: 'Loading...' }]}\n          onChange={(value) => null}\n          label=\"Query Type\"\n        />\n      );\n    }\n\n    return (\n      <>\n        <VariableQueryField\n          value={this.state.selectedQueryType}\n          options={this.queryTypes}\n          onChange={(value) => this.onQueryTypeChange(value)}\n          label=\"Query Type\"\n        />\n        {this.renderQueryTypeSwitch(this.state.selectedQueryType)}\n      </>\n    );\n  }\n}\n","import React, { useEffect, useState } from 'react';\nimport { useDebounce } from 'react-use';\n\nimport { QueryEditorProps, getDefaultTimeRange, toOption } from '@grafana/data';\nimport { EditorField, EditorRows } from '@grafana/experimental';\nimport { Input } from '@grafana/ui';\n\nimport CloudMonitoringDatasource from '../datasource';\nimport { TimeSeriesList, CloudMonitoringQuery, QueryType } from '../types/query';\nimport { CloudMonitoringOptions } from '../types/types';\n\nimport { MetricQueryEditor, defaultTimeSeriesList } from './MetricQueryEditor';\n\nimport { AnnotationsHelp } from './';\n\nexport type Props = QueryEditorProps<CloudMonitoringDatasource, CloudMonitoringQuery, CloudMonitoringOptions>;\n\nexport const defaultQuery: (datasource: CloudMonitoringDatasource) => TimeSeriesList = (datasource) => ({\n  ...defaultTimeSeriesList(datasource),\n  title: '',\n  text: '',\n});\n\nexport const AnnotationQueryEditor = (props: Props) => {\n  const { datasource, query, onRunQuery, data, onChange, range } = props;\n  const meta = data?.series.length ? data?.series[0].meta : {};\n  const customMetaData = meta?.custom ?? {};\n  const timeSeriesList = { ...defaultQuery(datasource), ...query.timeSeriesList };\n  const [title, setTitle] = useState(timeSeriesList.title || '');\n  const [text, setText] = useState(timeSeriesList.text || '');\n  const variableOptionGroup = {\n    label: 'Template Variables',\n    options: datasource.getVariables().map(toOption),\n  };\n\n  const handleTitleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setTitle(e.target.value);\n  };\n  const handleTextChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setText(e.target.value);\n  };\n\n  useDebounce(\n    () => {\n      onChange({ ...query, timeSeriesList: { ...timeSeriesList, title } });\n    },\n    1000,\n    [title, onChange]\n  );\n  useDebounce(\n    () => {\n      onChange({ ...query, timeSeriesList: { ...timeSeriesList, text } });\n    },\n    1000,\n    [text, onChange]\n  );\n\n  // Use a known query type\n  useEffect(() => {\n    if (!query.queryType || !Object.values(QueryType).includes(query.queryType)) {\n      onChange({ ...query, queryType: QueryType.TIME_SERIES_LIST });\n    }\n  });\n\n  return (\n    <EditorRows>\n      <>\n        <MetricQueryEditor\n          refId={query.refId}\n          variableOptionGroup={variableOptionGroup}\n          customMetaData={customMetaData}\n          onChange={onChange}\n          onRunQuery={onRunQuery}\n          datasource={datasource}\n          query={query}\n          range={range || getDefaultTimeRange()}\n        />\n        <EditorField label=\"Title\" htmlFor=\"annotation-query-title\">\n          <Input id=\"annotation-query-title\" value={title} onChange={handleTitleChange} />\n        </EditorField>\n        <EditorField label=\"Text\" htmlFor=\"annotation-query-text\">\n          <Input id=\"annotation-query-text\" value={text} onChange={handleTextChange} />\n        </EditorField>\n      </>\n      <AnnotationsHelp />\n    </EditorRows>\n  );\n};\n","import { AnnotationSupport, AnnotationQuery } from '@grafana/data';\n\nimport { AnnotationQueryEditor } from './components/AnnotationQueryEditor';\nimport CloudMonitoringDatasource from './datasource';\nimport { AlignmentTypes, CloudMonitoringQuery, QueryType, LegacyCloudMonitoringAnnotationQuery } from './types/query';\n\n// The legacy query format sets the title and text values to empty strings by default.\n// If the title or text is not undefined at the top-level of the annotation target,\n// then it is a legacy query.\nconst isLegacyCloudMonitoringAnnotation = (\n  query: unknown\n): query is AnnotationQuery<LegacyCloudMonitoringAnnotationQuery> =>\n  (query as AnnotationQuery<LegacyCloudMonitoringAnnotationQuery>).target?.title !== undefined ||\n  (query as AnnotationQuery<LegacyCloudMonitoringAnnotationQuery>).target?.text !== undefined;\n\nexport const CloudMonitoringAnnotationSupport: (\n  ds: CloudMonitoringDatasource\n) => AnnotationSupport<CloudMonitoringQuery> = (ds: CloudMonitoringDatasource) => {\n  return {\n    prepareAnnotation: (\n      query: AnnotationQuery<LegacyCloudMonitoringAnnotationQuery> | AnnotationQuery<CloudMonitoringQuery>\n    ): AnnotationQuery<CloudMonitoringQuery> => {\n      if (!isLegacyCloudMonitoringAnnotation(query)) {\n        return query;\n      }\n\n      const { enable, name, iconColor } = query;\n      const { target } = query;\n      const result: AnnotationQuery<CloudMonitoringQuery> = {\n        datasource: query.datasource,\n        enable,\n        name,\n        iconColor,\n        target: {\n          intervalMs: ds.intervalMs,\n          refId: target?.refId || 'annotationQuery',\n          queryType: QueryType.ANNOTATION,\n          timeSeriesList: {\n            projectName: target?.projectName || ds.getDefaultProject(),\n            filters: target?.filters || [],\n            crossSeriesReducer: 'REDUCE_NONE',\n            perSeriesAligner: AlignmentTypes.ALIGN_NONE,\n            title: target?.title || '',\n            text: target?.text || '',\n          },\n        },\n      };\n      return result;\n    },\n    prepareQuery: (anno: AnnotationQuery<CloudMonitoringQuery>) => {\n      if (!anno.target) {\n        return undefined;\n      }\n\n      return {\n        ...anno.target,\n        queryType: QueryType.ANNOTATION,\n        type: 'annotationQuery',\n      };\n    },\n    QueryEditor: AnnotationQueryEditor,\n  };\n};\n","import { isString } from 'lodash';\n\nimport { ALIGNMENT_PERIODS, SELECTORS } from './constants';\nimport CloudMonitoringDatasource from './datasource';\nimport {\n  extractServicesFromMetricDescriptors,\n  getAggregationOptionsByMetric,\n  getAlignmentOptionsByMetric,\n  getLabelKeys,\n  getMetricTypesByService,\n} from './functions';\nimport { ValueTypes, MetricFindQueryTypes } from './types/query';\nimport { CloudMonitoringVariableQuery, MetricDescriptor } from './types/types';\n\nexport default class CloudMonitoringMetricFindQuery {\n  constructor(private datasource: CloudMonitoringDatasource) {}\n\n  async execute(query: CloudMonitoringVariableQuery) {\n    try {\n      if (!query.projectName) {\n        query.projectName = this.datasource.getDefaultProject();\n      }\n\n      switch (query.selectedQueryType) {\n        case MetricFindQueryTypes.Projects:\n          return this.handleProjectsQuery();\n        case MetricFindQueryTypes.Services:\n          return this.handleServiceQuery(query);\n        case MetricFindQueryTypes.MetricTypes:\n          return this.handleMetricTypesQuery(query);\n        case MetricFindQueryTypes.LabelKeys:\n          return this.handleLabelKeysQuery(query);\n        case MetricFindQueryTypes.LabelValues:\n          return this.handleLabelValuesQuery(query);\n        case MetricFindQueryTypes.ResourceTypes:\n          return this.handleResourceTypeQuery(query);\n        case MetricFindQueryTypes.Aligners:\n          return this.handleAlignersQuery(query);\n        case MetricFindQueryTypes.AlignmentPeriods:\n          return this.handleAlignmentPeriodQuery();\n        case MetricFindQueryTypes.Aggregations:\n          return this.handleAggregationQuery(query);\n        case MetricFindQueryTypes.SLOServices:\n          return this.handleSLOServicesQuery(query);\n        case MetricFindQueryTypes.SLO:\n          return this.handleSLOQuery(query);\n        case MetricFindQueryTypes.Selectors:\n          return this.handleSelectorQuery();\n        default:\n          return [];\n      }\n    } catch (error) {\n      console.error(`Could not run CloudMonitoringMetricFindQuery ${query}`, error);\n      return [];\n    }\n  }\n\n  async handleProjectsQuery() {\n    const projects = await this.datasource.getProjects();\n    return projects.map((s) => ({\n      text: s.label,\n      value: s.value,\n      expandable: true,\n    }));\n  }\n\n  async handleServiceQuery({ projectName }: CloudMonitoringVariableQuery) {\n    const metricDescriptors = await this.datasource.getMetricTypes(projectName);\n    const services: MetricDescriptor[] = extractServicesFromMetricDescriptors(metricDescriptors);\n    return services.map((s) => ({\n      text: s.serviceShortName,\n      value: s.service,\n      expandable: true,\n    }));\n  }\n\n  async handleMetricTypesQuery({ selectedService, projectName }: CloudMonitoringVariableQuery) {\n    if (!selectedService) {\n      return [];\n    }\n    const metricDescriptors = await this.datasource.getMetricTypes(projectName);\n    return getMetricTypesByService(metricDescriptors, this.datasource.templateSrv.replace(selectedService)).map(\n      (s) => ({\n        text: s.displayName,\n        value: s.type,\n        expandable: true,\n      })\n    );\n  }\n\n  async handleLabelKeysQuery({ selectedMetricType, projectName }: CloudMonitoringVariableQuery) {\n    if (!selectedMetricType) {\n      return [];\n    }\n    const labelKeys = await getLabelKeys(this.datasource, selectedMetricType, projectName);\n    return labelKeys.map(this.toFindQueryResult);\n  }\n\n  async handleLabelValuesQuery({ selectedMetricType, labelKey, projectName }: CloudMonitoringVariableQuery) {\n    if (!selectedMetricType) {\n      return [];\n    }\n    const refId = 'handleLabelValuesQuery';\n    // REDUCE_MEAN is needed so the groupBy is not ignored\n    const labels = await this.datasource.getLabels(selectedMetricType, refId, projectName, {\n      groupBys: [labelKey],\n      crossSeriesReducer: 'REDUCE_MEAN',\n    });\n    const interpolatedKey = this.datasource.templateSrv.replace(labelKey);\n    const values = labels.hasOwnProperty(interpolatedKey) ? labels[interpolatedKey] : [];\n    return values.map(this.toFindQueryResult);\n  }\n\n  async handleResourceTypeQuery({ selectedMetricType, projectName }: CloudMonitoringVariableQuery) {\n    if (!selectedMetricType) {\n      return [];\n    }\n    const refId = 'handleResourceTypeQueryQueryType';\n    const labels = await this.datasource.getLabels(selectedMetricType, refId, projectName);\n    return labels['resource.type']?.map(this.toFindQueryResult) ?? [];\n  }\n\n  async handleAlignersQuery({ selectedMetricType, projectName }: CloudMonitoringVariableQuery) {\n    if (!selectedMetricType) {\n      return [];\n    }\n    const metricDescriptors = await this.datasource.getMetricTypes(projectName);\n    const descriptor = metricDescriptors.find(\n      (m) => m.type === this.datasource.templateSrv.replace(selectedMetricType)\n    );\n\n    if (!descriptor) {\n      return [];\n    }\n\n    return getAlignmentOptionsByMetric(descriptor.valueType, descriptor.metricKind).map(this.toFindQueryResult);\n  }\n\n  async handleAggregationQuery({ selectedMetricType, projectName }: CloudMonitoringVariableQuery) {\n    if (!selectedMetricType) {\n      return [];\n    }\n\n    const metricDescriptors = await this.datasource.getMetricTypes(projectName);\n    const descriptor = metricDescriptors.find(\n      (m) => m.type === this.datasource.templateSrv.replace(selectedMetricType)\n    );\n\n    if (!descriptor) {\n      return [];\n    }\n\n    return getAggregationOptionsByMetric(descriptor.valueType as ValueTypes, descriptor.metricKind).map(\n      this.toFindQueryResult\n    );\n  }\n\n  async handleSLOServicesQuery({ projectName }: CloudMonitoringVariableQuery) {\n    const services = await this.datasource.getSLOServices(projectName);\n    return services.map(this.toFindQueryResult);\n  }\n\n  async handleSLOQuery({ selectedSLOService, projectName }: CloudMonitoringVariableQuery) {\n    const slos = await this.datasource.getServiceLevelObjectives(projectName, selectedSLOService);\n    return slos.map(this.toFindQueryResult);\n  }\n\n  async handleSelectorQuery() {\n    return SELECTORS.map(this.toFindQueryResult);\n  }\n\n  handleAlignmentPeriodQuery() {\n    return ALIGNMENT_PERIODS.map(this.toFindQueryResult);\n  }\n\n  toFindQueryResult(x: any) {\n    return isString(x) ? { text: x, expandable: true } : { ...x, expandable: true };\n  }\n}\n","import { from, Observable } from 'rxjs';\nimport { map, mergeMap } from 'rxjs/operators';\n\nimport { CustomVariableSupport, DataQueryRequest, DataQueryResponse } from '@grafana/data';\n\nimport CloudMonitoringMetricFindQuery from './CloudMonitoringMetricFindQuery';\nimport { CloudMonitoringVariableQueryEditor } from './components/VariableQueryEditor';\nimport CloudMonitoringDatasource from './datasource';\nimport { CloudMonitoringVariableQuery } from './types/types';\n\nexport class CloudMonitoringVariableSupport extends CustomVariableSupport<\n  CloudMonitoringDatasource,\n  CloudMonitoringVariableQuery\n> {\n  private readonly metricFindQuery: CloudMonitoringMetricFindQuery;\n\n  constructor(private readonly datasource: CloudMonitoringDatasource) {\n    super();\n    this.metricFindQuery = new CloudMonitoringMetricFindQuery(datasource);\n  }\n\n  editor = CloudMonitoringVariableQueryEditor;\n\n  query(request: DataQueryRequest<CloudMonitoringVariableQuery>): Observable<DataQueryResponse> {\n    const executeObservable = from(this.metricFindQuery.execute(request.targets[0]));\n    return from(this.datasource.ensureGCEDefaultProject()).pipe(\n      mergeMap(() => executeObservable),\n      map((data) => ({ data }))\n    );\n  }\n}\n","import { chunk, flatten, isString, isArray, has, get, omit } from 'lodash';\nimport { from, lastValueFrom, Observable, of } from 'rxjs';\nimport { map, mergeMap } from 'rxjs/operators';\n\nimport {\n  DataQueryRequest,\n  DataQueryResponse,\n  DataSourceInstanceSettings,\n  ScopedVars,\n  SelectableValue,\n  TimeRange,\n  getDefaultTimeRange,\n} from '@grafana/data';\nimport {\n  DataSourceWithBackend,\n  getBackendSrv,\n  toDataQueryResponse,\n  BackendSrv,\n  getTemplateSrv,\n  TemplateSrv,\n} from '@grafana/runtime';\n\nimport { CloudMonitoringAnnotationSupport } from './annotationSupport';\nimport { SLO_BURN_RATE_SELECTOR_NAME } from './constants';\nimport { getMetricType, setMetricType } from './functions';\nimport { CloudMonitoringQuery, QueryType, MetricQuery, Filter } from './types/query';\nimport { CloudMonitoringOptions, MetricDescriptor, PostResponse, Aggregation } from './types/types';\nimport { CloudMonitoringVariableSupport } from './variables';\n\nexport default class CloudMonitoringDatasource extends DataSourceWithBackend<\n  CloudMonitoringQuery,\n  CloudMonitoringOptions\n> {\n  authenticationType: string;\n  intervalMs: number;\n  backendSrv: BackendSrv;\n\n  constructor(\n    private instanceSettings: DataSourceInstanceSettings<CloudMonitoringOptions>,\n    public templateSrv: TemplateSrv = getTemplateSrv()\n  ) {\n    super(instanceSettings);\n    this.authenticationType = instanceSettings.jsonData.authenticationType || 'jwt';\n    this.variables = new CloudMonitoringVariableSupport(this);\n    this.intervalMs = 0;\n    this.annotations = CloudMonitoringAnnotationSupport(this);\n    this.backendSrv = getBackendSrv();\n  }\n\n  getVariables() {\n    return this.templateSrv.getVariables().map((v) => `$${v.name}`);\n  }\n\n  query(request: DataQueryRequest<CloudMonitoringQuery>): Observable<DataQueryResponse> {\n    request.targets = request.targets.map((t) => ({\n      ...this.migrateQuery(t),\n      intervalMs: request.intervalMs,\n    }));\n    return super.query(request);\n  }\n\n  applyTemplateVariables(target: CloudMonitoringQuery, scopedVars: ScopedVars) {\n    const { timeSeriesList, timeSeriesQuery, sloQuery, promQLQuery } = target;\n\n    return {\n      ...target,\n      datasource: this.getRef(),\n      intervalMs: this.intervalMs,\n      timeSeriesList: timeSeriesList && {\n        ...this.interpolateProps(timeSeriesList, scopedVars),\n        projectName: this.templateSrv.replace(\n          timeSeriesList.projectName ? timeSeriesList.projectName : this.getDefaultProject(),\n          scopedVars\n        ),\n        filters: this.interpolateFilters(timeSeriesList.filters || [], scopedVars),\n        groupBys: this.interpolateGroupBys(timeSeriesList.groupBys || [], scopedVars),\n        view: timeSeriesList.view || 'FULL',\n      },\n      timeSeriesQuery: timeSeriesQuery && {\n        ...this.interpolateProps(timeSeriesQuery, scopedVars),\n        projectName: this.templateSrv.replace(\n          timeSeriesQuery.projectName ? timeSeriesQuery.projectName : this.getDefaultProject(),\n          scopedVars\n        ),\n      },\n      sloQuery: sloQuery && this.interpolateProps(sloQuery, scopedVars),\n      promQLQuery: promQLQuery && this.interpolateProps(promQLQuery, scopedVars),\n    };\n  }\n\n  async getLabels(\n    metricType: string,\n    refId: string,\n    projectName: string,\n    aggregation?: Aggregation,\n    timeRange?: TimeRange\n  ): Promise<{ [k: string]: string[] }> {\n    const options = {\n      targets: [\n        {\n          refId,\n          datasource: this.getRef(),\n          queryType: QueryType.TIME_SERIES_LIST,\n          timeSeriesList: setMetricType(\n            {\n              projectName: this.templateSrv.replace(projectName),\n              groupBys: this.interpolateGroupBys(aggregation?.groupBys || [], {}),\n              crossSeriesReducer: aggregation?.crossSeriesReducer ?? 'REDUCE_NONE',\n              view: 'HEADERS',\n            },\n            metricType\n          ),\n        },\n      ],\n      range: timeRange || getDefaultTimeRange(),\n    };\n\n    const queries = options.targets;\n\n    if (!queries.length) {\n      return lastValueFrom(of({ results: [] }));\n    }\n\n    return lastValueFrom(\n      from(this.ensureGCEDefaultProject()).pipe(\n        mergeMap(() => {\n          return this.backendSrv.fetch<PostResponse>({\n            url: '/api/ds/query',\n            method: 'POST',\n            headers: this.getRequestHeaders(),\n            data: {\n              from: options.range.from.valueOf().toString(),\n              to: options.range.to.valueOf().toString(),\n              queries,\n            },\n          });\n        }),\n\n        map(({ data }) => {\n          const dataQueryResponse = toDataQueryResponse({\n            data: data,\n          });\n\n          const labels: Record<string, Set<string>> = dataQueryResponse?.data\n            .map((f) => f.meta?.custom?.labels)\n            .filter((p) => !!p)\n            .reduce((acc, labels) => {\n              for (let key in labels) {\n                if (!acc[key]) {\n                  acc[key] = new Set<string>();\n                }\n                if (labels[key]) {\n                  acc[key].add(labels[key]);\n                }\n              }\n              return acc;\n            }, {});\n\n          return Object.fromEntries(\n            Object.entries(labels).map(([key, value]) => {\n              const fromArr = Array.from(value);\n              return [key, fromArr];\n            })\n          );\n        })\n      )\n    );\n  }\n\n  async getGCEDefaultProject() {\n    return this.getResource(`gceDefaultProject`);\n  }\n\n  getDefaultProject(): string {\n    const { defaultProject, authenticationType, gceDefaultProject } = this.instanceSettings.jsonData;\n    if (authenticationType === 'gce') {\n      return gceDefaultProject || '';\n    }\n\n    return defaultProject || '';\n  }\n\n  async ensureGCEDefaultProject() {\n    const { authenticationType, gceDefaultProject } = this.instanceSettings.jsonData;\n    if (authenticationType === 'gce' && !gceDefaultProject) {\n      this.instanceSettings.jsonData.gceDefaultProject = await this.getGCEDefaultProject();\n    }\n  }\n\n  async getMetricTypes(projectName: string): Promise<MetricDescriptor[]> {\n    if (!projectName) {\n      return [];\n    }\n\n    return this.getResource(`metricDescriptors/v3/projects/${this.templateSrv.replace(projectName)}/metricDescriptors`);\n  }\n\n  async filterMetricsByType(projectName: string, filter: string): Promise<MetricDescriptor[]> {\n    if (!projectName) {\n      return [];\n    }\n\n    return this.getResource(\n      `metricDescriptors/v3/projects/${this.templateSrv.replace(projectName)}/metricDescriptors`,\n      { filter: `metric.type : \"${filter}\"` }\n    );\n  }\n\n  async getSLOServices(projectName: string): Promise<Array<SelectableValue<string>>> {\n    return this.getResource(`services/v3/projects/${this.templateSrv.replace(projectName)}/services?pageSize=1000`);\n  }\n\n  async getServiceLevelObjectives(projectName: string, serviceId: string): Promise<Array<SelectableValue<string>>> {\n    if (!serviceId) {\n      return Promise.resolve([]);\n    }\n    let { projectName: p, serviceId: s } = this.interpolateProps({ projectName, serviceId });\n    return this.getResource(`slo-services/v3/projects/${p}/services/${s}/serviceLevelObjectives`);\n  }\n\n  getProjects(): Promise<Array<SelectableValue<string>>> {\n    return this.getResource(`projects`);\n  }\n\n  migrateMetricTypeFilter(metricType: string, filters?: string[]) {\n    const metricTypeFilterArray = ['metric.type', '=', metricType];\n    if (filters?.length) {\n      return filters.concat('AND', metricTypeFilterArray);\n    }\n    return metricTypeFilterArray;\n  }\n\n  // This is a manual port of the migration code in cloudmonitoring.go\n  // DO NOT UPDATE THIS CODE WITHOUT UPDATING THE BACKEND CODE\n  migrateQuery(query: CloudMonitoringQuery): CloudMonitoringQuery {\n    const { hide, refId, datasource, key, queryType, maxLines, metric, intervalMs, type, ...rest } = query as any;\n    if (\n      !query.hasOwnProperty('metricQuery') &&\n      !query.hasOwnProperty('sloQuery') &&\n      !query.hasOwnProperty('timeSeriesQuery') &&\n      !query.hasOwnProperty('timeSeriesList')\n    ) {\n      let filters = rest.filters || [];\n      if (rest.metricType) {\n        filters = this.migrateMetricTypeFilter(rest.metricType, filters);\n      }\n\n      return {\n        datasource,\n        key,\n        refId,\n        intervalMs,\n        hide,\n        queryType: type === 'annotationQuery' ? QueryType.ANNOTATION : QueryType.TIME_SERIES_LIST,\n        timeSeriesList: {\n          ...rest,\n          projectName: get(query, 'projectName') || this.getDefaultProject(),\n          filters,\n          view: rest.view || 'FULL',\n        },\n      };\n    }\n\n    if (has(query, 'metricQuery') && ['metrics', QueryType.ANNOTATION].includes(query.queryType ?? '')) {\n      const metricQuery: MetricQuery = get(query, 'metricQuery')!;\n      if (metricQuery.editorMode === 'mql') {\n        query.timeSeriesQuery = {\n          projectName: metricQuery.projectName,\n          query: metricQuery.query,\n          graphPeriod: metricQuery.graphPeriod,\n        };\n        query.queryType = QueryType.TIME_SERIES_QUERY;\n      } else {\n        query.timeSeriesList = {\n          projectName: metricQuery.projectName || this.getDefaultProject(),\n          crossSeriesReducer: metricQuery.crossSeriesReducer,\n          alignmentPeriod: metricQuery.alignmentPeriod,\n          perSeriesAligner: metricQuery.perSeriesAligner,\n          groupBys: metricQuery.groupBys,\n          filters: metricQuery.filters,\n          view: metricQuery.view,\n          preprocessor: metricQuery.preprocessor,\n        };\n        query.queryType = QueryType.TIME_SERIES_LIST;\n        if (metricQuery.metricType) {\n          query.timeSeriesList.filters = this.migrateMetricTypeFilter(\n            metricQuery.metricType,\n            query.timeSeriesList.filters\n          );\n        }\n      }\n      query.aliasBy = metricQuery.aliasBy;\n      query = omit(query, 'metricQuery');\n    }\n\n    if (query.queryType === QueryType.SLO && has(query, 'sloQuery.aliasBy')) {\n      query.aliasBy = get(query, 'sloQuery.aliasBy');\n      query = omit(query, 'sloQuery.aliasBy');\n    }\n\n    return query;\n  }\n\n  interpolateProps<T extends Record<string, any>>(object: T, scopedVars: ScopedVars = {}): T {\n    return Object.entries(object).reduce((acc, [key, value]) => {\n      return {\n        ...acc,\n        [key]: value && isString(value) ? this.templateSrv.replace(value, scopedVars) : value,\n      };\n    }, {} as T);\n  }\n\n  filterQuery(query: CloudMonitoringQuery): boolean {\n    if (query.hide) {\n      return false;\n    }\n\n    if (query.queryType === QueryType.SLO) {\n      if (!query.sloQuery) {\n        return false;\n      }\n      const { selectorName, serviceId, sloId, projectName, lookbackPeriod } = query.sloQuery;\n      return (\n        !!selectorName &&\n        !!serviceId &&\n        !!sloId &&\n        !!projectName &&\n        (selectorName !== SLO_BURN_RATE_SELECTOR_NAME || !!lookbackPeriod)\n      );\n    }\n\n    if (query.queryType === QueryType.TIME_SERIES_QUERY) {\n      return !!query.timeSeriesQuery && !!query.timeSeriesQuery.projectName && !!query.timeSeriesQuery.query;\n    }\n\n    if (query.queryType && [QueryType.TIME_SERIES_LIST, QueryType.ANNOTATION].includes(query.queryType)) {\n      return !!query.timeSeriesList && !!query.timeSeriesList.projectName && !!getMetricType(query.timeSeriesList);\n    }\n\n    if (query.queryType === QueryType.PROMQL) {\n      return (\n        !!query.promQLQuery && !!query.promQLQuery.projectName && !!query.promQLQuery.expr && !!query.promQLQuery.step\n      );\n    }\n\n    return false;\n  }\n\n  interpolateVariablesInQueries(queries: CloudMonitoringQuery[], scopedVars: ScopedVars): CloudMonitoringQuery[] {\n    return queries.map((query) => this.applyTemplateVariables(this.migrateQuery(query), scopedVars));\n  }\n\n  interpolateFilters(filters: string[], scopedVars: ScopedVars) {\n    const completeFilter: Filter[] = chunk(filters, 4)\n      .map(([key, operator, value, condition]) => ({\n        key,\n        operator,\n        value,\n        ...(condition && { condition }),\n      }))\n      .filter((item) => item.value);\n\n    const filterArray = flatten(\n      completeFilter.map(({ key, operator, value, condition }: Filter) => [\n        this.templateSrv.replace(key, scopedVars || {}),\n        operator,\n        this.templateSrv.replace(value, scopedVars || {}, (value: string | string[]) => {\n          return isArray(value) && value.length ? `(${value.join('|')})` : value;\n        }),\n        ...(condition ? [condition] : []),\n      ])\n    );\n\n    return filterArray || [];\n  }\n\n  interpolateGroupBys(groupBys: string[], scopedVars: {}): string[] {\n    let interpolatedGroupBys: string[] = [];\n    (groupBys || []).forEach((gb) => {\n      const interpolated = this.templateSrv.replace(gb, scopedVars || {}, 'csv').split(',');\n      if (Array.isArray(interpolated)) {\n        interpolatedGroupBys = interpolatedGroupBys.concat(interpolated);\n      } else {\n        interpolatedGroupBys.push(interpolated);\n      }\n    });\n    return interpolatedGroupBys;\n  }\n}\n","import { reportInteraction } from '@grafana/runtime';\n\n/**\n * Loaded the first time a dashboard containing Cloudmonitoring queries is loaded (not on every render)\n * Note: The queries used here are the ones pre-migration and pre-filterQuery\n */\nexport const trackCloudMonitoringDashboardLoaded = (props: CloudMonitoringDashboardLoadedProps) => {\n  reportInteraction('grafana_ds_cloudmonitoring_dashboard_loaded', props);\n};\n\nexport type CloudMonitoringDashboardLoadedProps = {\n  grafana_version?: string;\n  dashboard_id: string;\n  org_id?: number;\n  /** number of non hidden queries of type TimeSeriesQuery (MQL) if any  */\n  mql_queries: number;\n  /** number of non hidden queries of type TimeSeriesFilter (Builder) if any  */\n  time_series_filter_queries: number;\n  /** number of non hidden queries of type SLO if any  */\n  slo_queries: number;\n  /** number of non hidden queries of type annotation if any  */\n  annotation_queries: number;\n  /** number of non hidden queries of type PromQL if any  */\n  promQL_queries: number;\n};\n","import { get } from 'lodash';\n\nimport { DataSourcePlugin, DashboardLoadedEvent } from '@grafana/data';\nimport { getAppEvents } from '@grafana/runtime';\n\nimport CloudMonitoringCheatSheet from './components/CloudMonitoringCheatSheet';\nimport { ConfigEditor } from './components/ConfigEditor/ConfigEditor';\nimport { QueryEditor } from './components/QueryEditor';\nimport { CloudMonitoringVariableQueryEditor } from './components/VariableQueryEditor';\nimport CloudMonitoringDatasource from './datasource';\nimport pluginJson from './plugin.json';\nimport { trackCloudMonitoringDashboardLoaded } from './tracking';\nimport { CloudMonitoringQuery, QueryType } from './types/query';\n\nexport const plugin = new DataSourcePlugin<CloudMonitoringDatasource, CloudMonitoringQuery>(CloudMonitoringDatasource)\n  .setQueryEditorHelp(CloudMonitoringCheatSheet)\n  .setQueryEditor(QueryEditor)\n  .setConfigEditor(ConfigEditor)\n  .setVariableQueryEditor(CloudMonitoringVariableQueryEditor);\n\n// Track dashboard loads to RudderStack\ngetAppEvents().subscribe<DashboardLoadedEvent<CloudMonitoringQuery>>(\n  DashboardLoadedEvent,\n  ({ payload: { dashboardId, orgId, grafanaVersion, queries } }) => {\n    const cloudmonitorQueries = queries[pluginJson.id];\n    let stats = {\n      [QueryType.TIME_SERIES_QUERY]: 0,\n      [QueryType.TIME_SERIES_LIST]: 0,\n      [QueryType.SLO]: 0,\n      [QueryType.ANNOTATION]: 0,\n      [QueryType.PROMQL]: 0,\n    };\n    cloudmonitorQueries.forEach((query) => {\n      if (\n        query.queryType === QueryType.TIME_SERIES_QUERY ||\n        query.queryType === QueryType.TIME_SERIES_LIST ||\n        query.queryType === QueryType.SLO ||\n        query.queryType === QueryType.ANNOTATION ||\n        query.queryType === QueryType.PROMQL\n      ) {\n        stats[query.queryType]++;\n      } else if (query.queryType === 'metrics') {\n        if (query.hasOwnProperty('type') && get(query, 'type') === 'annotationQuery') {\n          stats.annotation++;\n        }\n        if (get(query, 'metricQuery.editorMode') === 'mql') {\n          stats.timeSeriesQuery++;\n        } else {\n          stats.timeSeriesList++;\n        }\n      }\n    });\n\n    if (cloudmonitorQueries && cloudmonitorQueries.length > 0) {\n      trackCloudMonitoringDashboardLoaded({\n        grafana_version: grafanaVersion,\n        dashboard_id: dashboardId,\n        org_id: orgId,\n        mql_queries: stats[QueryType.TIME_SERIES_QUERY],\n        time_series_filter_queries: stats[QueryType.TIME_SERIES_LIST],\n        slo_queries: stats[QueryType.SLO],\n        annotation_queries: stats[QueryType.ANNOTATION],\n        promQL_queries: stats[QueryType.PROMQL],\n      });\n    }\n  }\n);\n"],"names":["e","t","a","n","l","o","i","r","s","u","c","d","p","f","m","g","h","y","E","T","v","b","j","k","J","P","C","O","W","exports","module","CloudMonitoringCheatSheet","ConfigEditor","options","onOptionsChange","DataSourceDescription","Divider","config","ConfigSection","SecureSocksProxySettings","CloudMonitoringVariableQueryEditor","props","metricDescriptors","labels","metricTypes","services","queryModel","projectName","projects","selectedService","selectedMetricType","sloServices","state","queryType","service","metricType","labelKey","prevProps","prevState","selecQueryTypeChanged","selectSLOServiceChanged","selectedQueryType","result","variableOptionGroup","value","name","defaultQuery","datasource","AnnotationQueryEditor","query","onRunQuery","data","onChange","range","customMetaData","timeSeriesList","title","setTitle","text","setText","handleTitleChange","handleTextChange","useDebounce","EditorRows","MetricQueryEditor","EditorField","Input","isLegacyCloudMonitoringAnnotation","CloudMonitoringAnnotationSupport","ds","enable","iconColor","target","anno","CloudMonitoringMetricFindQuery","error","refId","interpolatedKey","descriptor","selectedSLOService","x","CloudMonitoringVariableSupport","request","executeObservable","from","mergeMap","map","CloudMonitoringDatasource","DataSourceWithBackend","instanceSettings","templateSrv","scopedVars","timeSeriesQuery","sloQuery","promQLQuery","aggregation","timeRange","queries","lastValueFrom","acc","key","fromArr","of","defaultProject","authenticationType","gceDefaultProject","filter","serviceId","filters","metricTypeFilterArray","hide","maxLines","metric","intervalMs","type","rest","metricQuery","object","selectorName","sloId","lookbackPeriod","completeFilter","operator","condition","item","groupBys","interpolatedGroupBys","gb","interpolated","trackCloudMonitoringDashboardLoaded","QueryEditor","dashboardId","orgId","grafanaVersion","cloudmonitorQueries","stats"],"sourceRoot":""}