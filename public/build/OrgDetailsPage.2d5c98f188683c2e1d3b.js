"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1510],{39745:(N,u,e)=>{e.d(u,{A:()=>h,u:()=>C});var r=e(32196),t=e(96540),y=e(97594),p=e(41987),f=e(13544),l=e(14110),U=e(32264),d=e(84167),c=e(88575),P=e(88323),D=e(60029),A=e(20333),I=e(15648),W=e(86460),_=e(55852),S=e(3911),O=e(59429),n=e(44836),v=e(74513),L=e(65615),R=e(2769);function x(){const o=v.Yj.map(a=>({value:a.code,label:a.name}));return[{value:"",label:(0,n.t)("common.locale.default","Default")},...o]}class C extends t.PureComponent{constructor(s){super(s),this.onSubmitForm=async a=>{if(a.preventDefault(),this.props.onConfirm?await this.props.onConfirm():!0){const{homeDashboardUID:K,theme:z,timezone:B,weekStart:E,language:M,queryHistory:b}=this.state;await this.service.update({homeDashboardUID:K,theme:z,timezone:B,weekStart:E,language:M,queryHistory:b}),window.location.reload()}},this.onThemeChanged=a=>{this.setState({theme:a.value}),a.value&&(0,R.K)(a.value,!0)},this.onTimeZoneChanged=a=>{typeof a=="string"&&this.setState({timezone:a})},this.onWeekStartChanged=a=>{this.setState({weekStart:a})},this.onHomeDashboardChanged=a=>{this.setState({homeDashboardUID:a})},this.onLanguageChanged=a=>{this.setState({language:a}),(0,l.rR)("grafana_preferences_language_changed",{toLanguage:a,preferenceType:this.props.preferenceType})},this.service=new L.W(s.resourceUri),this.state={theme:"",timezone:"",weekStart:"",language:"",queryHistory:{homeTab:""}},this.themeOptions=(0,y.k)(U.$.featureToggles.extraThemes).map(a=>({value:a.id,label:g(a)})),this.themeOptions.unshift({value:"",label:(0,n.t)("shared-preferences.theme.default-label","Default")})}async componentDidMount(){const s=await this.service.load();this.setState({homeDashboardUID:s.homeDashboardUID,theme:s.theme,timezone:s.timezone,weekStart:s.weekStart,language:s.language,queryHistory:s.queryHistory})}render(){const{theme:s,timezone:a,weekStart:T,homeDashboardUID:K,language:z}=this.state,{disabled:B}=this.props,E=i(),M=x(),b=this.themeOptions.find(m=>m.value===s)??this.themeOptions[0];return t.createElement("form",{onSubmit:this.onSubmitForm,className:E.form},t.createElement(d.n,{label:t.createElement(n.x6,{i18nKey:"shared-preferences.title"},"Preferences"),disabled:B},t.createElement(c.D,{label:(0,n.t)("shared-preferences.fields.theme-label","Interface theme")},t.createElement(P.l6,{options:this.themeOptions,value:b,onChange:this.onThemeChanged,inputId:"shared-preferences-theme-select"})),t.createElement(c.D,{label:t.createElement(D.J,{htmlFor:"home-dashboard-select"},t.createElement("span",{className:E.labelText},t.createElement(n.x6,{i18nKey:"shared-preferences.fields.home-dashboard-label"},"Home Dashboard"))),"data-testid":"User preferences home dashboard drop down"},t.createElement(O.b,{value:K,onChange:m=>this.onHomeDashboardChanged(m?.uid??""),defaultOptions:!0,isClearable:!0,placeholder:(0,n.t)("shared-preferences.fields.home-dashboard-placeholder","Default dashboard"),inputId:"home-dashboard-select"})),t.createElement(c.D,{label:(0,n.t)("shared-dashboard.fields.timezone-label","Timezone"),"data-testid":f.Tp.components.TimeZonePicker.containerV2},t.createElement(A.U,{includeInternal:!0,value:a,onChange:this.onTimeZoneChanged,inputId:"shared-preferences-timezone-picker"})),t.createElement(c.D,{label:(0,n.t)("shared-preferences.fields.week-start-label","Week start"),"data-testid":f.Tp.components.WeekStartPicker.containerV2},t.createElement(I.l,{value:T||"",onChange:this.onWeekStartChanged,inputId:"shared-preferences-week-start-picker"})),t.createElement(c.D,{label:t.createElement(D.J,{htmlFor:"locale-select"},t.createElement("span",{className:E.labelText},t.createElement(n.x6,{i18nKey:"shared-preferences.fields.locale-label"},"Language")),t.createElement(W.y,{featureState:p.Ay.beta})),"data-testid":"User preferences language drop down"},t.createElement(P.l6,{value:M.find(m=>m.value===z),onChange:m=>this.onLanguageChanged(m.value??""),options:M,placeholder:(0,n.t)("shared-preferences.fields.locale-placeholder","Choose language"),inputId:"locale-select"}))),t.createElement(_.$n,{type:"submit",variant:"primary","data-testid":f.Tp.components.UserProfile.preferencesSaveButton},t.createElement(n.x6,{i18nKey:"common.save"},"Save")))}}const h=C,i=(0,S.N)(()=>({labelText:(0,r.css)({marginRight:"6px"}),form:(0,r.css)({width:"100%",maxWidth:"600px"})}));function g(o){switch(o.id){case"dark":return(0,n.t)("shared.preferences.theme.dark-label","Dark");case"light":return(0,n.t)("shared.preferences.theme.light-label","Light");case"system":return(0,n.t)("shared.preferences.theme.system-label","System preference");default:return o.name}}},69047:(N,u,e)=>{e.r(u),e.d(u,{OrgDetailsPage:()=>v,default:()=>C});var r=e(96540),t=e(69733),y=e(66864),p=e(36830),f=e(39745),l=e(10096),U=e(17422),d=e(80348),c=e(28444),P=e(51253),D=e(84167),A=e(88575),I=e(10354),W=e(55852);const S=({onSubmit:h,orgName:i})=>{const g=l.TP.hasPermission(d.AccessControlAction.OrgsWrite);return r.createElement(P.l,{defaultValues:{orgName:i},onSubmit:({orgName:o})=>h(o)},({register:o})=>r.createElement(D.n,{label:"Organization profile",disabled:!g},r.createElement(A.D,{label:"Organization name"},r.createElement(I.p,{id:"org-name-input",type:"text",...o("orgName",{required:!0})})),r.createElement(W.$n,{type:"submit"},"Update organization name")))};var O=e(32931),n=e(10943);class v extends r.PureComponent{constructor(){super(...arguments),this.onUpdateOrganization=i=>{this.props.setOrganizationName(i),this.props.updateOrganization()},this.handleConfirm=()=>new Promise(i=>{l.lE.publish(new c.bY({title:"Confirm preferences update",text:"This will update the preferences for the whole organization. Are you sure you want to update the preferences?",yesText:"Save",yesButtonVariant:"primary",onConfirm:async()=>i(!0),onDismiss:async()=>i(!1)}))})}async componentDidMount(){await this.props.loadOrganization()}render(){const{navModel:i,organization:g}=this.props,o=Object.keys(g).length===0,s=l.TP.hasPermission(d.AccessControlAction.OrgsRead),a=l.TP.hasPermission(d.AccessControlAction.OrgsPreferencesRead),T=l.TP.hasPermission(d.AccessControlAction.OrgsPreferencesWrite);return r.createElement(p.Y,{navModel:i},r.createElement(p.Y.Contents,{isLoading:o},!o&&r.createElement(y.gW,{spacing:"lg"},s&&r.createElement(S,{onSubmit:this.onUpdateOrganization,orgName:g.name}),a&&r.createElement(f.A,{resourceUri:"org",disabled:!T,preferenceType:"org",onConfirm:this.handleConfirm}))))}}function L(h){return{navModel:(0,U.tc)(h.navIndex,"org-settings"),organization:h.organization.organization}}const R={loadOrganization:O.YS,setOrganizationName:n.n,updateOrganization:O.L_},C=(0,t.connect)(L,R)(v)}}]);

//# sourceMappingURL=OrgDetailsPage.2d5c98f188683c2e1d3b.js.map